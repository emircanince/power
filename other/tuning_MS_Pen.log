===== SWEEP for MS_Pen =====
>>> MS_Pen LR=1e-3 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1933613
	speed: 0.0234s/iter; left time: 264.0721s
	iters: 200, epoch: 1 | loss: 0.1988981
	speed: 0.0113s/iter; left time: 126.6337s
	iters: 300, epoch: 1 | loss: 0.1390803
	speed: 0.0113s/iter; left time: 125.8215s
	iters: 400, epoch: 1 | loss: 0.1835486
	speed: 0.0113s/iter; left time: 124.2379s
	iters: 500, epoch: 1 | loss: 0.2114241
	speed: 0.0113s/iter; left time: 123.1320s
Epoch: 1 cost time: 7.695542335510254
Epoch: 1, Steps: 570 | Train Loss: 0.2028562 Vali Loss: 0.0448778 Test Loss: 0.1422099
Validation loss decreased (inf --> 0.044878).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3092295
	speed: 0.0380s/iter; left time: 407.7892s
	iters: 200, epoch: 2 | loss: 0.2824721
	speed: 0.0113s/iter; left time: 120.1106s
	iters: 300, epoch: 2 | loss: 0.1547327
	speed: 0.0113s/iter; left time: 118.5887s
	iters: 400, epoch: 2 | loss: 0.1442560
	speed: 0.0113s/iter; left time: 117.9129s
	iters: 500, epoch: 2 | loss: 0.1561607
	speed: 0.0113s/iter; left time: 116.2854s
Epoch: 2 cost time: 6.739848375320435
Epoch: 2, Steps: 570 | Train Loss: 0.1818021 Vali Loss: 0.0538022 Test Loss: 0.1665610
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1408853
	speed: 0.0366s/iter; left time: 371.9117s
	iters: 200, epoch: 3 | loss: 0.2677668
	speed: 0.0100s/iter; left time: 100.8894s
	iters: 300, epoch: 3 | loss: 0.1296267
	speed: 0.0100s/iter; left time: 99.7654s
	iters: 400, epoch: 3 | loss: 0.1308769
	speed: 0.0100s/iter; left time: 98.9164s
	iters: 500, epoch: 3 | loss: 0.1873083
	speed: 0.0100s/iter; left time: 98.0797s
Epoch: 3 cost time: 5.97617506980896
Epoch: 3, Steps: 570 | Train Loss: 0.1638960 Vali Loss: 0.0400159 Test Loss: 0.1370480
Validation loss decreased (0.044878 --> 0.040016).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1816106
	speed: 0.0367s/iter; left time: 351.8151s
	iters: 200, epoch: 4 | loss: 0.0869919
	speed: 0.0101s/iter; left time: 95.6983s
	iters: 300, epoch: 4 | loss: 0.1230730
	speed: 0.0101s/iter; left time: 94.7241s
	iters: 400, epoch: 4 | loss: 0.1637607
	speed: 0.0101s/iter; left time: 93.5341s
	iters: 500, epoch: 4 | loss: 0.1066960
	speed: 0.0101s/iter; left time: 92.6527s
Epoch: 4 cost time: 6.064181089401245
Epoch: 4, Steps: 570 | Train Loss: 0.1305410 Vali Loss: 0.0379029 Test Loss: 0.1386857
Validation loss decreased (0.040016 --> 0.037903).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1237444
	speed: 0.0362s/iter; left time: 326.6115s
	iters: 200, epoch: 5 | loss: 0.1145866
	speed: 0.0101s/iter; left time: 90.4440s
	iters: 300, epoch: 5 | loss: 0.0847194
	speed: 0.0101s/iter; left time: 89.3965s
	iters: 400, epoch: 5 | loss: 0.1352161
	speed: 0.0101s/iter; left time: 88.3994s
	iters: 500, epoch: 5 | loss: 0.0861844
	speed: 0.0101s/iter; left time: 87.4121s
Epoch: 5 cost time: 6.082877159118652
Epoch: 5, Steps: 570 | Train Loss: 0.1155328 Vali Loss: 0.0379452 Test Loss: 0.1391891
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1157222
	speed: 0.0359s/iter; left time: 303.4666s
	iters: 200, epoch: 6 | loss: 0.0735332
	speed: 0.0101s/iter; left time: 84.0860s
	iters: 300, epoch: 6 | loss: 0.1310323
	speed: 0.0101s/iter; left time: 83.0592s
	iters: 400, epoch: 6 | loss: 0.1287394
	speed: 0.0101s/iter; left time: 82.1649s
	iters: 500, epoch: 6 | loss: 0.1266173
	speed: 0.0101s/iter; left time: 80.9416s
Epoch: 6 cost time: 6.033543109893799
Epoch: 6, Steps: 570 | Train Loss: 0.1062760 Vali Loss: 0.0374476 Test Loss: 0.1397292
Validation loss decreased (0.037903 --> 0.037448).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0962381
	speed: 0.0369s/iter; left time: 290.5554s
	iters: 200, epoch: 7 | loss: 0.0808531
	speed: 0.0101s/iter; left time: 78.5401s
	iters: 300, epoch: 7 | loss: 0.1013519
	speed: 0.0101s/iter; left time: 77.4465s
	iters: 400, epoch: 7 | loss: 0.0860427
	speed: 0.0101s/iter; left time: 76.2835s
	iters: 500, epoch: 7 | loss: 0.0848474
	speed: 0.0100s/iter; left time: 75.0192s
Epoch: 7 cost time: 6.062681674957275
Epoch: 7, Steps: 570 | Train Loss: 0.1008633 Vali Loss: 0.0376188 Test Loss: 0.1415005
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0927209
	speed: 0.0360s/iter; left time: 263.2439s
	iters: 200, epoch: 8 | loss: 0.1141037
	speed: 0.0102s/iter; left time: 73.3161s
	iters: 300, epoch: 8 | loss: 0.0949905
	speed: 0.0102s/iter; left time: 72.1844s
	iters: 400, epoch: 8 | loss: 0.1421025
	speed: 0.0102s/iter; left time: 71.2519s
	iters: 500, epoch: 8 | loss: 0.0945800
	speed: 0.0101s/iter; left time: 70.0059s
Epoch: 8 cost time: 6.09170937538147
Epoch: 8, Steps: 570 | Train Loss: 0.0970870 Vali Loss: 0.0377705 Test Loss: 0.1430901
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0744602
	speed: 0.0356s/iter; left time: 239.7171s
	iters: 200, epoch: 9 | loss: 0.1046552
	speed: 0.0100s/iter; left time: 66.6143s
	iters: 300, epoch: 9 | loss: 0.0506251
	speed: 0.0101s/iter; left time: 65.7415s
	iters: 400, epoch: 9 | loss: 0.0868260
	speed: 0.0100s/iter; left time: 64.6446s
	iters: 500, epoch: 9 | loss: 0.0882789
	speed: 0.0100s/iter; left time: 63.6444s
Epoch: 9 cost time: 6.00791597366333
Epoch: 9, Steps: 570 | Train Loss: 0.0951259 Vali Loss: 0.0381816 Test Loss: 0.1437499
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13988716900348663, mae:0.2346835732460022
>>> MS_Pen LR=1e-3 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1974219
	speed: 0.0226s/iter; left time: 255.8323s
	iters: 200, epoch: 1 | loss: 0.1684513
	speed: 0.0110s/iter; left time: 122.6594s
	iters: 300, epoch: 1 | loss: 0.2646486
	speed: 0.0110s/iter; left time: 122.0638s
	iters: 400, epoch: 1 | loss: 0.1720465
	speed: 0.0110s/iter; left time: 120.6297s
	iters: 500, epoch: 1 | loss: 0.1448887
	speed: 0.0110s/iter; left time: 119.8961s
Epoch: 1 cost time: 7.470785617828369
Epoch: 1, Steps: 570 | Train Loss: 0.1720080 Vali Loss: 0.0403345 Test Loss: 0.1291035
Validation loss decreased (inf --> 0.040335).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1453598
	speed: 0.0361s/iter; left time: 387.1962s
	iters: 200, epoch: 2 | loss: 0.1594643
	speed: 0.0097s/iter; left time: 103.5934s
	iters: 300, epoch: 2 | loss: 0.1013634
	speed: 0.0097s/iter; left time: 102.4933s
	iters: 400, epoch: 2 | loss: 0.1286521
	speed: 0.0098s/iter; left time: 101.7597s
	iters: 500, epoch: 2 | loss: 0.1487427
	speed: 0.0098s/iter; left time: 100.9953s
Epoch: 2 cost time: 5.843745231628418
Epoch: 2, Steps: 570 | Train Loss: 0.1495713 Vali Loss: 0.0390293 Test Loss: 0.1178959
Validation loss decreased (0.040335 --> 0.039029).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0682671
	speed: 0.0343s/iter; left time: 349.0029s
	iters: 200, epoch: 3 | loss: 0.1072318
	speed: 0.0098s/iter; left time: 98.4002s
	iters: 300, epoch: 3 | loss: 0.2377545
	speed: 0.0098s/iter; left time: 97.5810s
	iters: 400, epoch: 3 | loss: 0.0908594
	speed: 0.0098s/iter; left time: 96.4823s
	iters: 500, epoch: 3 | loss: 0.1022637
	speed: 0.0098s/iter; left time: 95.2820s
Epoch: 3 cost time: 5.831713914871216
Epoch: 3, Steps: 570 | Train Loss: 0.1173280 Vali Loss: 0.0366322 Test Loss: 0.1228527
Validation loss decreased (0.039029 --> 0.036632).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0568030
	speed: 0.0344s/iter; left time: 330.3768s
	iters: 200, epoch: 4 | loss: 0.0824297
	speed: 0.0097s/iter; left time: 92.1602s
	iters: 300, epoch: 4 | loss: 0.0730975
	speed: 0.0097s/iter; left time: 91.2440s
	iters: 400, epoch: 4 | loss: 0.0647070
	speed: 0.0097s/iter; left time: 90.2348s
	iters: 500, epoch: 4 | loss: 0.1246519
	speed: 0.0097s/iter; left time: 89.2406s
Epoch: 4 cost time: 5.806314706802368
Epoch: 4, Steps: 570 | Train Loss: 0.0948988 Vali Loss: 0.0338575 Test Loss: 0.1180945
Validation loss decreased (0.036632 --> 0.033857).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0781938
	speed: 0.0352s/iter; left time: 317.0999s
	iters: 200, epoch: 5 | loss: 0.1319440
	speed: 0.0097s/iter; left time: 86.4036s
	iters: 300, epoch: 5 | loss: 0.0976825
	speed: 0.0097s/iter; left time: 85.4373s
	iters: 400, epoch: 5 | loss: 0.1006055
	speed: 0.0097s/iter; left time: 84.3950s
	iters: 500, epoch: 5 | loss: 0.0793026
	speed: 0.0097s/iter; left time: 83.4524s
Epoch: 5 cost time: 5.775852918624878
Epoch: 5, Steps: 570 | Train Loss: 0.0803605 Vali Loss: 0.0351952 Test Loss: 0.1226837
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0424945
	speed: 0.0358s/iter; left time: 302.3102s
	iters: 200, epoch: 6 | loss: 0.1019709
	speed: 0.0110s/iter; left time: 91.7218s
	iters: 300, epoch: 6 | loss: 0.0809842
	speed: 0.0110s/iter; left time: 90.5932s
	iters: 400, epoch: 6 | loss: 0.0547756
	speed: 0.0110s/iter; left time: 89.4455s
	iters: 500, epoch: 6 | loss: 0.0598729
	speed: 0.0110s/iter; left time: 88.3199s
Epoch: 6 cost time: 6.485745906829834
Epoch: 6, Steps: 570 | Train Loss: 0.0692373 Vali Loss: 0.0350499 Test Loss: 0.1206383
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0527762
	speed: 0.0345s/iter; left time: 272.2285s
	iters: 200, epoch: 7 | loss: 0.0589522
	speed: 0.0098s/iter; left time: 76.5229s
	iters: 300, epoch: 7 | loss: 0.0877783
	speed: 0.0098s/iter; left time: 75.6146s
	iters: 400, epoch: 7 | loss: 0.1168775
	speed: 0.0098s/iter; left time: 74.4082s
	iters: 500, epoch: 7 | loss: 0.0699338
	speed: 0.0098s/iter; left time: 73.3929s
Epoch: 7 cost time: 5.885418653488159
Epoch: 7, Steps: 570 | Train Loss: 0.0624762 Vali Loss: 0.0346230 Test Loss: 0.1217008
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11820906400680542, mae:0.2072521150112152
>>> MS_Pen LR=1e-3 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1700127
	speed: 0.0213s/iter; left time: 240.5889s
	iters: 200, epoch: 1 | loss: 0.1512129
	speed: 0.0097s/iter; left time: 108.7675s
	iters: 300, epoch: 1 | loss: 0.1594586
	speed: 0.0097s/iter; left time: 108.1172s
	iters: 400, epoch: 1 | loss: 0.1281981
	speed: 0.0097s/iter; left time: 106.9271s
	iters: 500, epoch: 1 | loss: 0.2029407
	speed: 0.0097s/iter; left time: 106.1639s
Epoch: 1 cost time: 6.744185447692871
Epoch: 1, Steps: 570 | Train Loss: 0.2135328 Vali Loss: 0.0514278 Test Loss: 0.1598524
Validation loss decreased (inf --> 0.051428).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3021875
	speed: 0.0351s/iter; left time: 376.9434s
	iters: 200, epoch: 2 | loss: 0.3076267
	speed: 0.0098s/iter; left time: 104.4681s
	iters: 300, epoch: 2 | loss: 0.2201146
	speed: 0.0098s/iter; left time: 103.0724s
	iters: 400, epoch: 2 | loss: 0.2349300
	speed: 0.0098s/iter; left time: 102.3179s
	iters: 500, epoch: 2 | loss: 0.2101674
	speed: 0.0106s/iter; left time: 109.7723s
Epoch: 2 cost time: 6.054028272628784
Epoch: 2, Steps: 570 | Train Loss: 0.2076726 Vali Loss: 0.0469739 Test Loss: 0.1502938
Validation loss decreased (0.051428 --> 0.046974).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1149412
	speed: 0.0368s/iter; left time: 373.5671s
	iters: 200, epoch: 3 | loss: 0.1166484
	speed: 0.0097s/iter; left time: 97.8333s
	iters: 300, epoch: 3 | loss: 0.2477467
	speed: 0.0097s/iter; left time: 96.8538s
	iters: 400, epoch: 3 | loss: 0.1489918
	speed: 0.0098s/iter; left time: 96.1519s
	iters: 500, epoch: 3 | loss: 0.0986105
	speed: 0.0098s/iter; left time: 95.4623s
Epoch: 3 cost time: 5.84079384803772
Epoch: 3, Steps: 570 | Train Loss: 0.1623888 Vali Loss: 0.0437273 Test Loss: 0.1451707
Validation loss decreased (0.046974 --> 0.043727).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0892760
	speed: 0.0351s/iter; left time: 336.4117s
	iters: 200, epoch: 4 | loss: 0.1055971
	speed: 0.0098s/iter; left time: 93.0392s
	iters: 300, epoch: 4 | loss: 0.1192294
	speed: 0.0098s/iter; left time: 92.0953s
	iters: 400, epoch: 4 | loss: 0.1431255
	speed: 0.0098s/iter; left time: 91.2697s
	iters: 500, epoch: 4 | loss: 0.1096387
	speed: 0.0098s/iter; left time: 90.1476s
Epoch: 4 cost time: 5.865549802780151
Epoch: 4, Steps: 570 | Train Loss: 0.1283996 Vali Loss: 0.0447656 Test Loss: 0.1464110
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0979286
	speed: 0.0338s/iter; left time: 304.9192s
	iters: 200, epoch: 5 | loss: 0.0805179
	speed: 0.0098s/iter; left time: 87.0440s
	iters: 300, epoch: 5 | loss: 0.1219209
	speed: 0.0098s/iter; left time: 86.3502s
	iters: 400, epoch: 5 | loss: 0.0692666
	speed: 0.0098s/iter; left time: 85.3927s
	iters: 500, epoch: 5 | loss: 0.1151776
	speed: 0.0098s/iter; left time: 84.3230s
Epoch: 5 cost time: 5.837274789810181
Epoch: 5, Steps: 570 | Train Loss: 0.1047941 Vali Loss: 0.0431021 Test Loss: 0.1403595
Validation loss decreased (0.043727 --> 0.043102).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0733144
	speed: 0.0349s/iter; left time: 294.6706s
	iters: 200, epoch: 6 | loss: 0.1084118
	speed: 0.0097s/iter; left time: 81.0671s
	iters: 300, epoch: 6 | loss: 0.1121733
	speed: 0.0097s/iter; left time: 79.8560s
	iters: 400, epoch: 6 | loss: 0.0753721
	speed: 0.0097s/iter; left time: 79.2295s
	iters: 500, epoch: 6 | loss: 0.0964731
	speed: 0.0098s/iter; left time: 79.0235s
Epoch: 6 cost time: 5.832361459732056
Epoch: 6, Steps: 570 | Train Loss: 0.0887864 Vali Loss: 0.0420648 Test Loss: 0.1403697
Validation loss decreased (0.043102 --> 0.042065).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0500963
	speed: 0.0351s/iter; left time: 276.7641s
	iters: 200, epoch: 7 | loss: 0.0673986
	speed: 0.0097s/iter; left time: 75.8440s
	iters: 300, epoch: 7 | loss: 0.0642499
	speed: 0.0098s/iter; left time: 75.0806s
	iters: 400, epoch: 7 | loss: 0.0445359
	speed: 0.0098s/iter; left time: 74.3232s
	iters: 500, epoch: 7 | loss: 0.0809492
	speed: 0.0098s/iter; left time: 73.0348s
Epoch: 7 cost time: 5.857688665390015
Epoch: 7, Steps: 570 | Train Loss: 0.0798660 Vali Loss: 0.0416158 Test Loss: 0.1381611
Validation loss decreased (0.042065 --> 0.041616).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0733135
	speed: 0.0345s/iter; left time: 252.2220s
	iters: 200, epoch: 8 | loss: 0.0741016
	speed: 0.0097s/iter; left time: 69.7209s
	iters: 300, epoch: 8 | loss: 0.0499898
	speed: 0.0097s/iter; left time: 69.0908s
	iters: 400, epoch: 8 | loss: 0.0861142
	speed: 0.0097s/iter; left time: 68.1328s
	iters: 500, epoch: 8 | loss: 0.0707234
	speed: 0.0097s/iter; left time: 66.9358s
Epoch: 8 cost time: 5.809747219085693
Epoch: 8, Steps: 570 | Train Loss: 0.0750049 Vali Loss: 0.0418630 Test Loss: 0.1403479
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0593644
	speed: 0.0344s/iter; left time: 231.7481s
	iters: 200, epoch: 9 | loss: 0.0935081
	speed: 0.0097s/iter; left time: 64.2874s
	iters: 300, epoch: 9 | loss: 0.0744623
	speed: 0.0097s/iter; left time: 63.3450s
	iters: 400, epoch: 9 | loss: 0.0587880
	speed: 0.0097s/iter; left time: 62.4363s
	iters: 500, epoch: 9 | loss: 0.0747241
	speed: 0.0097s/iter; left time: 61.1943s
Epoch: 9 cost time: 5.758820533752441
Epoch: 9, Steps: 570 | Train Loss: 0.0724440 Vali Loss: 0.0423791 Test Loss: 0.1411886
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0671680
	speed: 0.0350s/iter; left time: 215.8517s
	iters: 200, epoch: 10 | loss: 0.0645968
	speed: 0.0097s/iter; left time: 58.9152s
	iters: 300, epoch: 10 | loss: 0.0686836
	speed: 0.0098s/iter; left time: 58.3581s
	iters: 400, epoch: 10 | loss: 0.0717669
	speed: 0.0098s/iter; left time: 57.2974s
	iters: 500, epoch: 10 | loss: 0.0813351
	speed: 0.0097s/iter; left time: 56.2668s
Epoch: 10 cost time: 5.810706615447998
Epoch: 10, Steps: 570 | Train Loss: 0.0711860 Vali Loss: 0.0424655 Test Loss: 0.1415773
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13828763365745544, mae:0.2425905466079712
>>> MS_Pen LR=1e-3 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3261532
	speed: 0.0245s/iter; left time: 276.3465s
	iters: 200, epoch: 1 | loss: 0.2520280
	speed: 0.0124s/iter; left time: 139.2238s
	iters: 300, epoch: 1 | loss: 0.1979766
	speed: 0.0124s/iter; left time: 137.6329s
	iters: 400, epoch: 1 | loss: 0.2258353
	speed: 0.0124s/iter; left time: 136.3405s
	iters: 500, epoch: 1 | loss: 0.2555299
	speed: 0.0124s/iter; left time: 135.4604s
Epoch: 1 cost time: 8.325717449188232
Epoch: 1, Steps: 570 | Train Loss: 0.2950186 Vali Loss: 0.0646661 Test Loss: 0.1852291
Validation loss decreased (inf --> 0.064666).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2514182
	speed: 0.0392s/iter; left time: 420.9423s
	iters: 200, epoch: 2 | loss: 0.2357028
	speed: 0.0114s/iter; left time: 120.9876s
	iters: 300, epoch: 2 | loss: 0.3002355
	speed: 0.0114s/iter; left time: 119.9794s
	iters: 400, epoch: 2 | loss: 0.1448573
	speed: 0.0114s/iter; left time: 119.0569s
	iters: 500, epoch: 2 | loss: 0.2164454
	speed: 0.0114s/iter; left time: 118.0474s
Epoch: 2 cost time: 6.822977781295776
Epoch: 2, Steps: 570 | Train Loss: 0.2745343 Vali Loss: 0.0612423 Test Loss: 0.1935764
Validation loss decreased (0.064666 --> 0.061242).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2867512
	speed: 0.0393s/iter; left time: 399.7440s
	iters: 200, epoch: 3 | loss: 0.2797130
	speed: 0.0114s/iter; left time: 114.3984s
	iters: 300, epoch: 3 | loss: 0.1244949
	speed: 0.0114s/iter; left time: 113.2923s
	iters: 400, epoch: 3 | loss: 0.2082528
	speed: 0.0113s/iter; left time: 111.9140s
	iters: 500, epoch: 3 | loss: 0.2447630
	speed: 0.0113s/iter; left time: 110.7410s
Epoch: 3 cost time: 6.79191517829895
Epoch: 3, Steps: 570 | Train Loss: 0.2435256 Vali Loss: 0.0636736 Test Loss: 0.1828414
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1675533
	speed: 0.0379s/iter; left time: 363.6862s
	iters: 200, epoch: 4 | loss: 0.2476037
	speed: 0.0114s/iter; left time: 108.3086s
	iters: 300, epoch: 4 | loss: 0.1755639
	speed: 0.0114s/iter; left time: 107.4852s
	iters: 400, epoch: 4 | loss: 0.1316567
	speed: 0.0114s/iter; left time: 105.9940s
	iters: 500, epoch: 4 | loss: 0.2190938
	speed: 0.0114s/iter; left time: 104.8627s
Epoch: 4 cost time: 6.801229000091553
Epoch: 4, Steps: 570 | Train Loss: 0.2321038 Vali Loss: 0.0554255 Test Loss: 0.1704437
Validation loss decreased (0.061242 --> 0.055426).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1517879
	speed: 0.0395s/iter; left time: 356.2666s
	iters: 200, epoch: 5 | loss: 0.1944198
	speed: 0.0114s/iter; left time: 101.6894s
	iters: 300, epoch: 5 | loss: 0.2559067
	speed: 0.0114s/iter; left time: 100.6512s
	iters: 400, epoch: 5 | loss: 0.1793101
	speed: 0.0114s/iter; left time: 99.3214s
	iters: 500, epoch: 5 | loss: 0.1839177
	speed: 0.0114s/iter; left time: 98.2060s
Epoch: 5 cost time: 6.812355279922485
Epoch: 5, Steps: 570 | Train Loss: 0.2240549 Vali Loss: 0.0574087 Test Loss: 0.1707672
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2127099
	speed: 0.0374s/iter; left time: 316.4720s
	iters: 200, epoch: 6 | loss: 0.1665061
	speed: 0.0114s/iter; left time: 95.2912s
	iters: 300, epoch: 6 | loss: 0.2353106
	speed: 0.0114s/iter; left time: 94.1311s
	iters: 400, epoch: 6 | loss: 0.2278039
	speed: 0.0114s/iter; left time: 93.0234s
	iters: 500, epoch: 6 | loss: 0.1848499
	speed: 0.0114s/iter; left time: 91.7987s
Epoch: 6 cost time: 6.778924226760864
Epoch: 6, Steps: 570 | Train Loss: 0.2188393 Vali Loss: 0.0562720 Test Loss: 0.1683426
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3040668
	speed: 0.0375s/iter; left time: 295.2850s
	iters: 200, epoch: 7 | loss: 0.1900933
	speed: 0.0114s/iter; left time: 88.6741s
	iters: 300, epoch: 7 | loss: 0.1954149
	speed: 0.0114s/iter; left time: 87.5099s
	iters: 400, epoch: 7 | loss: 0.1623598
	speed: 0.0114s/iter; left time: 86.4352s
	iters: 500, epoch: 7 | loss: 0.2624742
	speed: 0.0114s/iter; left time: 85.3174s
Epoch: 7 cost time: 6.761906385421753
Epoch: 7, Steps: 570 | Train Loss: 0.2174653 Vali Loss: 0.0561439 Test Loss: 0.1692052
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17069482803344727, mae:0.26560652256011963
>>> MS_Pen LR=1e-3 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1535867
	speed: 0.0239s/iter; left time: 270.0857s
	iters: 200, epoch: 1 | loss: 0.2387971
	speed: 0.0121s/iter; left time: 135.1093s
	iters: 300, epoch: 1 | loss: 0.1725354
	speed: 0.0121s/iter; left time: 134.1125s
	iters: 400, epoch: 1 | loss: 0.3625556
	speed: 0.0121s/iter; left time: 132.6453s
	iters: 500, epoch: 1 | loss: 0.2453939
	speed: 0.0121s/iter; left time: 131.4706s
Epoch: 1 cost time: 8.111890316009521
Epoch: 1, Steps: 570 | Train Loss: 0.2416201 Vali Loss: 0.0679914 Test Loss: 0.1934308
Validation loss decreased (inf --> 0.067991).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1986994
	speed: 0.0395s/iter; left time: 423.3539s
	iters: 200, epoch: 2 | loss: 0.1689395
	speed: 0.0110s/iter; left time: 117.1365s
	iters: 300, epoch: 2 | loss: 0.1920654
	speed: 0.0110s/iter; left time: 115.8837s
	iters: 400, epoch: 2 | loss: 0.2594960
	speed: 0.0110s/iter; left time: 115.1143s
	iters: 500, epoch: 2 | loss: 0.3048922
	speed: 0.0110s/iter; left time: 113.8791s
Epoch: 2 cost time: 6.577740430831909
Epoch: 2, Steps: 570 | Train Loss: 0.2212117 Vali Loss: 0.0554623 Test Loss: 0.1574629
Validation loss decreased (0.067991 --> 0.055462).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2144662
	speed: 0.0373s/iter; left time: 378.9439s
	iters: 200, epoch: 3 | loss: 0.1316594
	speed: 0.0111s/iter; left time: 111.2321s
	iters: 300, epoch: 3 | loss: 0.2425874
	speed: 0.0111s/iter; left time: 110.3039s
	iters: 400, epoch: 3 | loss: 0.1758515
	speed: 0.0111s/iter; left time: 109.1393s
	iters: 500, epoch: 3 | loss: 0.2145543
	speed: 0.0111s/iter; left time: 107.8835s
Epoch: 3 cost time: 6.57299280166626
Epoch: 3, Steps: 570 | Train Loss: 0.1914163 Vali Loss: 0.0552371 Test Loss: 0.1593590
Validation loss decreased (0.055462 --> 0.055237).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1710709
	speed: 0.0382s/iter; left time: 365.9950s
	iters: 200, epoch: 4 | loss: 0.1724648
	speed: 0.0120s/iter; left time: 114.1319s
	iters: 300, epoch: 4 | loss: 0.0783748
	speed: 0.0120s/iter; left time: 112.3235s
	iters: 400, epoch: 4 | loss: 0.1447207
	speed: 0.0120s/iter; left time: 111.2224s
	iters: 500, epoch: 4 | loss: 0.1438596
	speed: 0.0120s/iter; left time: 110.0382s
Epoch: 4 cost time: 7.099798679351807
Epoch: 4, Steps: 570 | Train Loss: 0.1734779 Vali Loss: 0.0510139 Test Loss: 0.1501884
Validation loss decreased (0.055237 --> 0.051014).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1324835
	speed: 0.0383s/iter; left time: 345.4583s
	iters: 200, epoch: 5 | loss: 0.1597412
	speed: 0.0110s/iter; left time: 98.4759s
	iters: 300, epoch: 5 | loss: 0.1784908
	speed: 0.0110s/iter; left time: 97.2760s
	iters: 400, epoch: 5 | loss: 0.1865313
	speed: 0.0110s/iter; left time: 96.0501s
	iters: 500, epoch: 5 | loss: 0.1265789
	speed: 0.0110s/iter; left time: 94.9885s
Epoch: 5 cost time: 6.574337959289551
Epoch: 5, Steps: 570 | Train Loss: 0.1600997 Vali Loss: 0.0460756 Test Loss: 0.1458598
Validation loss decreased (0.051014 --> 0.046076).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1654937
	speed: 0.0378s/iter; left time: 319.1960s
	iters: 200, epoch: 6 | loss: 0.1715231
	speed: 0.0110s/iter; left time: 91.8817s
	iters: 300, epoch: 6 | loss: 0.1044515
	speed: 0.0110s/iter; left time: 90.9007s
	iters: 400, epoch: 6 | loss: 0.0963980
	speed: 0.0110s/iter; left time: 89.8166s
	iters: 500, epoch: 6 | loss: 0.1031130
	speed: 0.0110s/iter; left time: 88.8362s
Epoch: 6 cost time: 6.571406841278076
Epoch: 6, Steps: 570 | Train Loss: 0.1511037 Vali Loss: 0.0455642 Test Loss: 0.1411269
Validation loss decreased (0.046076 --> 0.045564).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1055984
	speed: 0.0384s/iter; left time: 302.8763s
	iters: 200, epoch: 7 | loss: 0.2174329
	speed: 0.0111s/iter; left time: 86.1539s
	iters: 300, epoch: 7 | loss: 0.1222867
	speed: 0.0111s/iter; left time: 84.8985s
	iters: 400, epoch: 7 | loss: 0.1494561
	speed: 0.0111s/iter; left time: 83.8782s
	iters: 500, epoch: 7 | loss: 0.0917813
	speed: 0.0111s/iter; left time: 82.7701s
Epoch: 7 cost time: 6.606194972991943
Epoch: 7, Steps: 570 | Train Loss: 0.1461887 Vali Loss: 0.0458324 Test Loss: 0.1405160
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1240712
	speed: 0.0372s/iter; left time: 272.0442s
	iters: 200, epoch: 8 | loss: 0.1325634
	speed: 0.0111s/iter; left time: 79.9350s
	iters: 300, epoch: 8 | loss: 0.1521552
	speed: 0.0111s/iter; left time: 78.8220s
	iters: 400, epoch: 8 | loss: 0.1531927
	speed: 0.0111s/iter; left time: 77.6977s
	iters: 500, epoch: 8 | loss: 0.1216493
	speed: 0.0111s/iter; left time: 76.4544s
Epoch: 8 cost time: 6.597062587738037
Epoch: 8, Steps: 570 | Train Loss: 0.1435100 Vali Loss: 0.0450532 Test Loss: 0.1398073
Validation loss decreased (0.045564 --> 0.045053).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1136143
	speed: 0.0373s/iter; left time: 251.3546s
	iters: 200, epoch: 9 | loss: 0.0906612
	speed: 0.0110s/iter; left time: 73.0824s
	iters: 300, epoch: 9 | loss: 0.1695038
	speed: 0.0110s/iter; left time: 72.0408s
	iters: 400, epoch: 9 | loss: 0.1818432
	speed: 0.0110s/iter; left time: 71.0085s
	iters: 500, epoch: 9 | loss: 0.1903278
	speed: 0.0110s/iter; left time: 69.8051s
Epoch: 9 cost time: 6.581679105758667
Epoch: 9, Steps: 570 | Train Loss: 0.1416417 Vali Loss: 0.0450743 Test Loss: 0.1413958
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1058365
	speed: 0.0370s/iter; left time: 228.1261s
	iters: 200, epoch: 10 | loss: 0.0916786
	speed: 0.0110s/iter; left time: 66.9626s
	iters: 300, epoch: 10 | loss: 0.1180841
	speed: 0.0110s/iter; left time: 65.8783s
	iters: 400, epoch: 10 | loss: 0.1729666
	speed: 0.0110s/iter; left time: 64.8078s
	iters: 500, epoch: 10 | loss: 0.2695843
	speed: 0.0110s/iter; left time: 63.5295s
Epoch: 10 cost time: 6.602633714675903
Epoch: 10, Steps: 570 | Train Loss: 0.1406862 Vali Loss: 0.0450385 Test Loss: 0.1414892
Validation loss decreased (0.045053 --> 0.045038).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1089610
	speed: 0.0383s/iter; left time: 214.4088s
	iters: 200, epoch: 11 | loss: 0.1198285
	speed: 0.0111s/iter; left time: 61.2533s
	iters: 300, epoch: 11 | loss: 0.1301968
	speed: 0.0111s/iter; left time: 59.9658s
	iters: 400, epoch: 11 | loss: 0.1332547
	speed: 0.0111s/iter; left time: 58.8438s
	iters: 500, epoch: 11 | loss: 0.1674422
	speed: 0.0110s/iter; left time: 57.4370s
Epoch: 11 cost time: 6.617268085479736
Epoch: 11, Steps: 570 | Train Loss: 0.1401986 Vali Loss: 0.0452158 Test Loss: 0.1415725
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1070485
	speed: 0.0368s/iter; left time: 185.0090s
	iters: 200, epoch: 12 | loss: 0.1015387
	speed: 0.0111s/iter; left time: 54.7937s
	iters: 300, epoch: 12 | loss: 0.1044682
	speed: 0.0111s/iter; left time: 53.4897s
	iters: 400, epoch: 12 | loss: 0.1798037
	speed: 0.0111s/iter; left time: 52.5054s
	iters: 500, epoch: 12 | loss: 0.1105967
	speed: 0.0111s/iter; left time: 51.3356s
Epoch: 12 cost time: 6.596075057983398
Epoch: 12, Steps: 570 | Train Loss: 0.1397034 Vali Loss: 0.0453700 Test Loss: 0.1416765
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2219042
	speed: 0.0385s/iter; left time: 171.9556s
	iters: 200, epoch: 13 | loss: 0.1329235
	speed: 0.0110s/iter; left time: 48.0105s
	iters: 300, epoch: 13 | loss: 0.1511546
	speed: 0.0110s/iter; left time: 46.9128s
	iters: 400, epoch: 13 | loss: 0.1901735
	speed: 0.0110s/iter; left time: 45.7981s
	iters: 500, epoch: 13 | loss: 0.1936226
	speed: 0.0110s/iter; left time: 44.7056s
Epoch: 13 cost time: 6.553307294845581
Epoch: 13, Steps: 570 | Train Loss: 0.1395651 Vali Loss: 0.0452587 Test Loss: 0.1416855
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.141733318567276, mae:0.2386360913515091
>>> MS_Pen LR=1e-3 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2443528
	speed: 0.0219s/iter; left time: 247.4299s
	iters: 200, epoch: 1 | loss: 0.3578005
	speed: 0.0103s/iter; left time: 114.8455s
	iters: 300, epoch: 1 | loss: 0.3049083
	speed: 0.0103s/iter; left time: 114.0350s
	iters: 400, epoch: 1 | loss: 0.2485562
	speed: 0.0102s/iter; left time: 112.6856s
	iters: 500, epoch: 1 | loss: 0.2602179
	speed: 0.0103s/iter; left time: 111.8916s
Epoch: 1 cost time: 7.057763338088989
Epoch: 1, Steps: 570 | Train Loss: 0.2586805 Vali Loss: 0.0589682 Test Loss: 0.1697829
Validation loss decreased (inf --> 0.058968).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2163319
	speed: 0.0367s/iter; left time: 393.8716s
	iters: 200, epoch: 2 | loss: 0.2580814
	speed: 0.0103s/iter; left time: 108.9910s
	iters: 300, epoch: 2 | loss: 0.1680081
	speed: 0.0102s/iter; left time: 107.6821s
	iters: 400, epoch: 2 | loss: 0.1710100
	speed: 0.0102s/iter; left time: 106.8781s
	iters: 500, epoch: 2 | loss: 0.1837434
	speed: 0.0102s/iter; left time: 105.8130s
Epoch: 2 cost time: 6.132780075073242
Epoch: 2, Steps: 570 | Train Loss: 0.2308463 Vali Loss: 0.0502236 Test Loss: 0.1592498
Validation loss decreased (0.058968 --> 0.050224).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1681412
	speed: 0.0368s/iter; left time: 373.8802s
	iters: 200, epoch: 3 | loss: 0.1754512
	speed: 0.0103s/iter; left time: 103.4987s
	iters: 300, epoch: 3 | loss: 0.1963368
	speed: 0.0103s/iter; left time: 102.3231s
	iters: 400, epoch: 3 | loss: 0.2069065
	speed: 0.0103s/iter; left time: 101.0938s
	iters: 500, epoch: 3 | loss: 0.1569017
	speed: 0.0102s/iter; left time: 99.7263s
Epoch: 3 cost time: 6.128087282180786
Epoch: 3, Steps: 570 | Train Loss: 0.2061692 Vali Loss: 0.0531123 Test Loss: 0.1498659
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1961437
	speed: 0.0355s/iter; left time: 340.2957s
	iters: 200, epoch: 4 | loss: 0.0999662
	speed: 0.0103s/iter; left time: 97.5910s
	iters: 300, epoch: 4 | loss: 0.1881894
	speed: 0.0103s/iter; left time: 96.4769s
	iters: 400, epoch: 4 | loss: 0.3000124
	speed: 0.0102s/iter; left time: 95.1626s
	iters: 500, epoch: 4 | loss: 0.1893278
	speed: 0.0103s/iter; left time: 94.3716s
Epoch: 4 cost time: 6.130547523498535
Epoch: 4, Steps: 570 | Train Loss: 0.1870424 Vali Loss: 0.0522162 Test Loss: 0.1545158
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1935280
	speed: 0.0366s/iter; left time: 330.0100s
	iters: 200, epoch: 5 | loss: 0.1828425
	speed: 0.0103s/iter; left time: 91.9138s
	iters: 300, epoch: 5 | loss: 0.1505107
	speed: 0.0103s/iter; left time: 91.1725s
	iters: 400, epoch: 5 | loss: 0.1266857
	speed: 0.0104s/iter; left time: 90.3193s
	iters: 500, epoch: 5 | loss: 0.2074870
	speed: 0.0103s/iter; left time: 88.6680s
Epoch: 5 cost time: 6.182635545730591
Epoch: 5, Steps: 570 | Train Loss: 0.1721567 Vali Loss: 0.0477816 Test Loss: 0.1441964
Validation loss decreased (0.050224 --> 0.047782).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1753214
	speed: 0.0360s/iter; left time: 304.4673s
	iters: 200, epoch: 6 | loss: 0.1444257
	speed: 0.0103s/iter; left time: 86.3593s
	iters: 300, epoch: 6 | loss: 0.2310216
	speed: 0.0104s/iter; left time: 85.6780s
	iters: 400, epoch: 6 | loss: 0.1317607
	speed: 0.0103s/iter; left time: 84.3397s
	iters: 500, epoch: 6 | loss: 0.1428669
	speed: 0.0103s/iter; left time: 83.1922s
Epoch: 6 cost time: 6.204612731933594
Epoch: 6, Steps: 570 | Train Loss: 0.1630436 Vali Loss: 0.0482317 Test Loss: 0.1475827
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1120970
	speed: 0.0350s/iter; left time: 275.8821s
	iters: 200, epoch: 7 | loss: 0.1533585
	speed: 0.0103s/iter; left time: 80.0104s
	iters: 300, epoch: 7 | loss: 0.0935650
	speed: 0.0103s/iter; left time: 78.8981s
	iters: 400, epoch: 7 | loss: 0.1506457
	speed: 0.0103s/iter; left time: 77.8382s
	iters: 500, epoch: 7 | loss: 0.1663114
	speed: 0.0103s/iter; left time: 76.8870s
Epoch: 7 cost time: 6.119019269943237
Epoch: 7, Steps: 570 | Train Loss: 0.1566155 Vali Loss: 0.0472276 Test Loss: 0.1478602
Validation loss decreased (0.047782 --> 0.047228).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0940043
	speed: 0.0371s/iter; left time: 271.1077s
	iters: 200, epoch: 8 | loss: 0.1800084
	speed: 0.0103s/iter; left time: 74.2865s
	iters: 300, epoch: 8 | loss: 0.1674058
	speed: 0.0103s/iter; left time: 73.4131s
	iters: 400, epoch: 8 | loss: 0.1366846
	speed: 0.0103s/iter; left time: 72.3969s
	iters: 500, epoch: 8 | loss: 0.1172167
	speed: 0.0103s/iter; left time: 71.3333s
Epoch: 8 cost time: 6.160590887069702
Epoch: 8, Steps: 570 | Train Loss: 0.1525278 Vali Loss: 0.0471122 Test Loss: 0.1481489
Validation loss decreased (0.047228 --> 0.047112).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1131840
	speed: 0.0361s/iter; left time: 243.4313s
	iters: 200, epoch: 9 | loss: 0.1122810
	speed: 0.0103s/iter; left time: 68.2999s
	iters: 300, epoch: 9 | loss: 0.1955280
	speed: 0.0103s/iter; left time: 67.3240s
	iters: 400, epoch: 9 | loss: 0.2275185
	speed: 0.0103s/iter; left time: 66.3665s
	iters: 500, epoch: 9 | loss: 0.1062673
	speed: 0.0103s/iter; left time: 65.3399s
Epoch: 9 cost time: 6.14210057258606
Epoch: 9, Steps: 570 | Train Loss: 0.1498103 Vali Loss: 0.0474544 Test Loss: 0.1491840
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1987630
	speed: 0.0353s/iter; left time: 217.7273s
	iters: 200, epoch: 10 | loss: 0.0741406
	speed: 0.0103s/iter; left time: 62.4890s
	iters: 300, epoch: 10 | loss: 0.2517295
	speed: 0.0103s/iter; left time: 61.4084s
	iters: 400, epoch: 10 | loss: 0.0983079
	speed: 0.0103s/iter; left time: 60.3930s
	iters: 500, epoch: 10 | loss: 0.2026307
	speed: 0.0103s/iter; left time: 59.3746s
Epoch: 10 cost time: 6.156519651412964
Epoch: 10, Steps: 570 | Train Loss: 0.1484477 Vali Loss: 0.0475081 Test Loss: 0.1490756
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0951658
	speed: 0.0368s/iter; left time: 206.1934s
	iters: 200, epoch: 11 | loss: 0.1740904
	speed: 0.0103s/iter; left time: 56.4780s
	iters: 300, epoch: 11 | loss: 0.0895702
	speed: 0.0103s/iter; left time: 55.4966s
	iters: 400, epoch: 11 | loss: 0.1244813
	speed: 0.0103s/iter; left time: 54.4110s
	iters: 500, epoch: 11 | loss: 0.1019066
	speed: 0.0103s/iter; left time: 53.3531s
Epoch: 11 cost time: 6.108588933944702
Epoch: 11, Steps: 570 | Train Loss: 0.1477466 Vali Loss: 0.0476023 Test Loss: 0.1492899
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14832991361618042, mae:0.24233581125736237
>>> MS_Pen LR=1e-3 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1658867
	speed: 0.0273s/iter; left time: 309.0439s
	iters: 200, epoch: 1 | loss: 0.2480516
	speed: 0.0150s/iter; left time: 167.9481s
	iters: 300, epoch: 1 | loss: 0.3146825
	speed: 0.0136s/iter; left time: 151.2744s
	iters: 400, epoch: 1 | loss: 0.2364380
	speed: 0.0137s/iter; left time: 150.5394s
	iters: 500, epoch: 1 | loss: 0.2071313
	speed: 0.0137s/iter; left time: 148.9041s
Epoch: 1 cost time: 9.33798599243164
Epoch: 1, Steps: 570 | Train Loss: 0.2408229 Vali Loss: 0.0646330 Test Loss: 0.1890036
Validation loss decreased (inf --> 0.064633).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3034933
	speed: 0.0450s/iter; left time: 482.4513s
	iters: 200, epoch: 2 | loss: 0.2256007
	speed: 0.0146s/iter; left time: 155.0329s
	iters: 300, epoch: 2 | loss: 0.1669995
	speed: 0.0158s/iter; left time: 166.6100s
	iters: 400, epoch: 2 | loss: 0.1657918
	speed: 0.0158s/iter; left time: 165.0790s
	iters: 500, epoch: 2 | loss: 0.3039019
	speed: 0.0158s/iter; left time: 162.9970s
Epoch: 2 cost time: 8.963632345199585
Epoch: 2, Steps: 570 | Train Loss: 0.2249621 Vali Loss: 0.0570107 Test Loss: 0.1631618
Validation loss decreased (0.064633 --> 0.057011).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3254840
	speed: 0.0481s/iter; left time: 488.4180s
	iters: 200, epoch: 3 | loss: 0.1732772
	speed: 0.0158s/iter; left time: 158.8345s
	iters: 300, epoch: 3 | loss: 0.0935112
	speed: 0.0158s/iter; left time: 157.1142s
	iters: 400, epoch: 3 | loss: 0.1422987
	speed: 0.0158s/iter; left time: 155.4109s
	iters: 500, epoch: 3 | loss: 0.1585723
	speed: 0.0157s/iter; left time: 153.6623s
Epoch: 3 cost time: 9.277133226394653
Epoch: 3, Steps: 570 | Train Loss: 0.1911990 Vali Loss: 0.0519468 Test Loss: 0.1514897
Validation loss decreased (0.057011 --> 0.051947).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1619781
	speed: 0.0465s/iter; left time: 445.9408s
	iters: 200, epoch: 4 | loss: 0.1459507
	speed: 0.0137s/iter; left time: 130.0835s
	iters: 300, epoch: 4 | loss: 0.2020745
	speed: 0.0137s/iter; left time: 128.4072s
	iters: 400, epoch: 4 | loss: 0.1595652
	speed: 0.0157s/iter; left time: 145.5496s
	iters: 500, epoch: 4 | loss: 0.1885917
	speed: 0.0157s/iter; left time: 143.9874s
Epoch: 4 cost time: 8.63862657546997
Epoch: 4, Steps: 570 | Train Loss: 0.1704847 Vali Loss: 0.0497043 Test Loss: 0.1518928
Validation loss decreased (0.051947 --> 0.049704).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1646920
	speed: 0.0457s/iter; left time: 411.9611s
	iters: 200, epoch: 5 | loss: 0.1770309
	speed: 0.0137s/iter; left time: 121.7933s
	iters: 300, epoch: 5 | loss: 0.1382125
	speed: 0.0137s/iter; left time: 120.4804s
	iters: 400, epoch: 5 | loss: 0.2092270
	speed: 0.0137s/iter; left time: 119.0620s
	iters: 500, epoch: 5 | loss: 0.1382455
	speed: 0.0136s/iter; left time: 117.6161s
Epoch: 5 cost time: 8.04288649559021
Epoch: 5, Steps: 570 | Train Loss: 0.1590700 Vali Loss: 0.0466470 Test Loss: 0.1493962
Validation loss decreased (0.049704 --> 0.046647).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1091114
	speed: 0.0460s/iter; left time: 388.5814s
	iters: 200, epoch: 6 | loss: 0.1588533
	speed: 0.0154s/iter; left time: 128.4128s
	iters: 300, epoch: 6 | loss: 0.1243788
	speed: 0.0154s/iter; left time: 126.9590s
	iters: 400, epoch: 6 | loss: 0.1171764
	speed: 0.0154s/iter; left time: 125.2054s
	iters: 500, epoch: 6 | loss: 0.1666334
	speed: 0.0154s/iter; left time: 123.7757s
Epoch: 6 cost time: 9.022931575775146
Epoch: 6, Steps: 570 | Train Loss: 0.1502159 Vali Loss: 0.0473227 Test Loss: 0.1535940
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1098357
	speed: 0.0475s/iter; left time: 374.4022s
	iters: 200, epoch: 7 | loss: 0.1137321
	speed: 0.0154s/iter; left time: 119.6901s
	iters: 300, epoch: 7 | loss: 0.1798865
	speed: 0.0154s/iter; left time: 118.2001s
	iters: 400, epoch: 7 | loss: 0.1524079
	speed: 0.0154s/iter; left time: 116.4066s
	iters: 500, epoch: 7 | loss: 0.2288755
	speed: 0.0154s/iter; left time: 115.1814s
Epoch: 7 cost time: 9.029096126556396
Epoch: 7, Steps: 570 | Train Loss: 0.1451842 Vali Loss: 0.0471564 Test Loss: 0.1557757
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1835018
	speed: 0.0451s/iter; left time: 329.5916s
	iters: 200, epoch: 8 | loss: 0.1543491
	speed: 0.0137s/iter; left time: 99.1289s
	iters: 300, epoch: 8 | loss: 0.2745227
	speed: 0.0138s/iter; left time: 97.9127s
	iters: 400, epoch: 8 | loss: 0.1036771
	speed: 0.0137s/iter; left time: 96.2961s
	iters: 500, epoch: 8 | loss: 0.1259146
	speed: 0.0138s/iter; left time: 95.0313s
Epoch: 8 cost time: 8.129817247390747
Epoch: 8, Steps: 570 | Train Loss: 0.1422931 Vali Loss: 0.0472489 Test Loss: 0.1552374
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14960341155529022, mae:0.24595314264297485
>>> MS_Pen LR=1e-3 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3095029
	speed: 0.0257s/iter; left time: 290.1733s
	iters: 200, epoch: 1 | loss: 0.1511111
	speed: 0.0134s/iter; left time: 150.6294s
	iters: 300, epoch: 1 | loss: 0.1151318
	speed: 0.0134s/iter; left time: 148.9199s
	iters: 400, epoch: 1 | loss: 0.2133438
	speed: 0.0134s/iter; left time: 147.8432s
	iters: 500, epoch: 1 | loss: 0.2367844
	speed: 0.0134s/iter; left time: 146.6180s
Epoch: 1 cost time: 8.938132524490356
Epoch: 1, Steps: 570 | Train Loss: 0.1861310 Vali Loss: 0.0458755 Test Loss: 0.1457141
Validation loss decreased (inf --> 0.045876).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1615647
	speed: 0.0446s/iter; left time: 478.3564s
	iters: 200, epoch: 2 | loss: 0.2962275
	speed: 0.0134s/iter; left time: 142.9099s
	iters: 300, epoch: 2 | loss: 0.2025602
	speed: 0.0135s/iter; left time: 141.8412s
	iters: 400, epoch: 2 | loss: 0.1099815
	speed: 0.0135s/iter; left time: 140.5809s
	iters: 500, epoch: 2 | loss: 0.1533603
	speed: 0.0134s/iter; left time: 138.9168s
Epoch: 2 cost time: 7.959876537322998
Epoch: 2, Steps: 570 | Train Loss: 0.1858733 Vali Loss: 0.0565400 Test Loss: 0.1559449
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2219073
	speed: 0.0436s/iter; left time: 442.6471s
	iters: 200, epoch: 3 | loss: 0.0872282
	speed: 0.0135s/iter; left time: 135.7864s
	iters: 300, epoch: 3 | loss: 0.1995245
	speed: 0.0135s/iter; left time: 134.5511s
	iters: 400, epoch: 3 | loss: 0.1000503
	speed: 0.0134s/iter; left time: 132.3983s
	iters: 500, epoch: 3 | loss: 0.1165842
	speed: 0.0134s/iter; left time: 131.0690s
Epoch: 3 cost time: 7.953523635864258
Epoch: 3, Steps: 570 | Train Loss: 0.1724140 Vali Loss: 0.0436262 Test Loss: 0.1313842
Validation loss decreased (0.045876 --> 0.043626).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0995578
	speed: 0.0454s/iter; left time: 435.5159s
	iters: 200, epoch: 4 | loss: 0.1405157
	speed: 0.0134s/iter; left time: 127.4484s
	iters: 300, epoch: 4 | loss: 0.1394246
	speed: 0.0135s/iter; left time: 126.3959s
	iters: 400, epoch: 4 | loss: 0.1033533
	speed: 0.0134s/iter; left time: 124.8093s
	iters: 500, epoch: 4 | loss: 0.0942017
	speed: 0.0134s/iter; left time: 123.5974s
Epoch: 4 cost time: 7.92521858215332
Epoch: 4, Steps: 570 | Train Loss: 0.1363509 Vali Loss: 0.0426840 Test Loss: 0.1279980
Validation loss decreased (0.043626 --> 0.042684).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1102681
	speed: 0.0451s/iter; left time: 407.1560s
	iters: 200, epoch: 5 | loss: 0.1585929
	speed: 0.0150s/iter; left time: 134.2432s
	iters: 300, epoch: 5 | loss: 0.0853318
	speed: 0.0133s/iter; left time: 117.3911s
	iters: 400, epoch: 5 | loss: 0.1096090
	speed: 0.0133s/iter; left time: 115.9775s
	iters: 500, epoch: 5 | loss: 0.1403505
	speed: 0.0134s/iter; left time: 115.3230s
Epoch: 5 cost time: 8.218181371688843
Epoch: 5, Steps: 570 | Train Loss: 0.1231976 Vali Loss: 0.0391788 Test Loss: 0.1213969
Validation loss decreased (0.042684 --> 0.039179).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1196287
	speed: 0.0446s/iter; left time: 376.9923s
	iters: 200, epoch: 6 | loss: 0.1622232
	speed: 0.0134s/iter; left time: 112.3034s
	iters: 300, epoch: 6 | loss: 0.1529514
	speed: 0.0135s/iter; left time: 111.4561s
	iters: 400, epoch: 6 | loss: 0.1064758
	speed: 0.0134s/iter; left time: 109.5305s
	iters: 500, epoch: 6 | loss: 0.1634354
	speed: 0.0135s/iter; left time: 108.3326s
Epoch: 6 cost time: 7.948661804199219
Epoch: 6, Steps: 570 | Train Loss: 0.1145642 Vali Loss: 0.0399690 Test Loss: 0.1253550
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0853698
	speed: 0.0426s/iter; left time: 335.6690s
	iters: 200, epoch: 7 | loss: 0.1221967
	speed: 0.0134s/iter; left time: 104.1808s
	iters: 300, epoch: 7 | loss: 0.1050045
	speed: 0.0134s/iter; left time: 102.8631s
	iters: 400, epoch: 7 | loss: 0.0943974
	speed: 0.0134s/iter; left time: 101.3843s
	iters: 500, epoch: 7 | loss: 0.1704107
	speed: 0.0134s/iter; left time: 100.0033s
Epoch: 7 cost time: 7.887708425521851
Epoch: 7, Steps: 570 | Train Loss: 0.1097918 Vali Loss: 0.0389271 Test Loss: 0.1229823
Validation loss decreased (0.039179 --> 0.038927).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1005069
	speed: 0.0436s/iter; left time: 319.0958s
	iters: 200, epoch: 8 | loss: 0.0575969
	speed: 0.0135s/iter; left time: 97.1465s
	iters: 300, epoch: 8 | loss: 0.1590822
	speed: 0.0135s/iter; left time: 96.0773s
	iters: 400, epoch: 8 | loss: 0.1025032
	speed: 0.0134s/iter; left time: 94.2805s
	iters: 500, epoch: 8 | loss: 0.1123086
	speed: 0.0134s/iter; left time: 92.7028s
Epoch: 8 cost time: 7.948917627334595
Epoch: 8, Steps: 570 | Train Loss: 0.1072372 Vali Loss: 0.0391744 Test Loss: 0.1237165
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0790208
	speed: 0.0455s/iter; left time: 306.8557s
	iters: 200, epoch: 9 | loss: 0.0891747
	speed: 0.0155s/iter; left time: 102.9269s
	iters: 300, epoch: 9 | loss: 0.1366601
	speed: 0.0155s/iter; left time: 101.3800s
	iters: 400, epoch: 9 | loss: 0.1255006
	speed: 0.0155s/iter; left time: 99.6779s
	iters: 500, epoch: 9 | loss: 0.1062626
	speed: 0.0154s/iter; left time: 97.7605s
Epoch: 9 cost time: 9.08120322227478
Epoch: 9, Steps: 570 | Train Loss: 0.1056191 Vali Loss: 0.0388829 Test Loss: 0.1245549
Validation loss decreased (0.038927 --> 0.038883).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1074423
	speed: 0.0472s/iter; left time: 291.5635s
	iters: 200, epoch: 10 | loss: 0.0868585
	speed: 0.0155s/iter; left time: 94.1070s
	iters: 300, epoch: 10 | loss: 0.1081936
	speed: 0.0155s/iter; left time: 92.5420s
	iters: 400, epoch: 10 | loss: 0.1223703
	speed: 0.0155s/iter; left time: 90.8889s
	iters: 500, epoch: 10 | loss: 0.0963618
	speed: 0.0154s/iter; left time: 88.9068s
Epoch: 10 cost time: 9.118820190429688
Epoch: 10, Steps: 570 | Train Loss: 0.1046921 Vali Loss: 0.0390513 Test Loss: 0.1250096
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1252693
	speed: 0.0460s/iter; left time: 257.5270s
	iters: 200, epoch: 11 | loss: 0.1580600
	speed: 0.0154s/iter; left time: 84.9389s
	iters: 300, epoch: 11 | loss: 0.1313110
	speed: 0.0154s/iter; left time: 83.2675s
	iters: 400, epoch: 11 | loss: 0.0705052
	speed: 0.0154s/iter; left time: 81.7159s
	iters: 500, epoch: 11 | loss: 0.1683805
	speed: 0.0154s/iter; left time: 80.1873s
Epoch: 11 cost time: 9.043493747711182
Epoch: 11, Steps: 570 | Train Loss: 0.1041579 Vali Loss: 0.0391736 Test Loss: 0.1249886
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1464695
	speed: 0.0474s/iter; left time: 238.2711s
	iters: 200, epoch: 12 | loss: 0.1083534
	speed: 0.0155s/iter; left time: 76.3623s
	iters: 300, epoch: 12 | loss: 0.0687128
	speed: 0.0155s/iter; left time: 74.8116s
	iters: 400, epoch: 12 | loss: 0.1134111
	speed: 0.0150s/iter; left time: 71.0265s
	iters: 500, epoch: 12 | loss: 0.1142916
	speed: 0.0135s/iter; left time: 62.4399s
Epoch: 12 cost time: 8.70148777961731
Epoch: 12, Steps: 570 | Train Loss: 0.1037700 Vali Loss: 0.0392031 Test Loss: 0.1248831
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12472250312566757, mae:0.2196894884109497
>>> MS_Pen LR=1e-3 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1191844
	speed: 0.0251s/iter; left time: 283.7482s
	iters: 200, epoch: 1 | loss: 0.3557626
	speed: 0.0135s/iter; left time: 151.2358s
	iters: 300, epoch: 1 | loss: 0.2818670
	speed: 0.0135s/iter; left time: 149.5841s
	iters: 400, epoch: 1 | loss: 0.2066875
	speed: 0.0135s/iter; left time: 148.4413s
	iters: 500, epoch: 1 | loss: 0.2712557
	speed: 0.0135s/iter; left time: 147.2595s
Epoch: 1 cost time: 8.90773320198059
Epoch: 1, Steps: 570 | Train Loss: 0.2374572 Vali Loss: 0.0508655 Test Loss: 0.1509393
Validation loss decreased (inf --> 0.050865).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1732400
	speed: 0.0447s/iter; left time: 480.0137s
	iters: 200, epoch: 2 | loss: 0.1680178
	speed: 0.0136s/iter; left time: 144.4474s
	iters: 300, epoch: 2 | loss: 0.1382378
	speed: 0.0136s/iter; left time: 143.1448s
	iters: 400, epoch: 2 | loss: 0.1887506
	speed: 0.0136s/iter; left time: 141.6362s
	iters: 500, epoch: 2 | loss: 0.3356881
	speed: 0.0135s/iter; left time: 139.9080s
Epoch: 2 cost time: 8.049571990966797
Epoch: 2, Steps: 570 | Train Loss: 0.2443318 Vali Loss: 0.0667843 Test Loss: 0.1886942
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2845499
	speed: 0.0440s/iter; left time: 447.1905s
	iters: 200, epoch: 3 | loss: 0.2825237
	speed: 0.0135s/iter; left time: 135.6460s
	iters: 300, epoch: 3 | loss: 0.1871234
	speed: 0.0135s/iter; left time: 134.5458s
	iters: 400, epoch: 3 | loss: 0.2099354
	speed: 0.0134s/iter; left time: 132.5529s
	iters: 500, epoch: 3 | loss: 0.2178774
	speed: 0.0135s/iter; left time: 131.3670s
Epoch: 3 cost time: 7.942523002624512
Epoch: 3, Steps: 570 | Train Loss: 0.2390431 Vali Loss: 0.0577609 Test Loss: 0.1619972
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2313320
	speed: 0.0454s/iter; left time: 435.3149s
	iters: 200, epoch: 4 | loss: 0.2824305
	speed: 0.0136s/iter; left time: 129.2812s
	iters: 300, epoch: 4 | loss: 0.2090813
	speed: 0.0140s/iter; left time: 131.4615s
	iters: 400, epoch: 4 | loss: 0.2059440
	speed: 0.0152s/iter; left time: 141.0214s
	iters: 500, epoch: 4 | loss: 0.1338997
	speed: 0.0152s/iter; left time: 139.8257s
Epoch: 4 cost time: 8.58899712562561
Epoch: 4, Steps: 570 | Train Loss: 0.2198788 Vali Loss: 0.0572226 Test Loss: 0.1658647
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15113228559494019, mae:0.2526218593120575
>>> MS_Pen LR=1e-3 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2477359
	speed: 0.0282s/iter; left time: 319.0298s
	iters: 200, epoch: 1 | loss: 0.2667515
	speed: 0.0164s/iter; left time: 183.2329s
	iters: 300, epoch: 1 | loss: 0.3100102
	speed: 0.0163s/iter; left time: 181.2368s
	iters: 400, epoch: 1 | loss: 0.2020439
	speed: 0.0164s/iter; left time: 180.0384s
	iters: 500, epoch: 1 | loss: 0.1965743
	speed: 0.0163s/iter; left time: 178.1826s
Epoch: 1 cost time: 10.560357332229614
Epoch: 1, Steps: 570 | Train Loss: 0.2977769 Vali Loss: 0.0605959 Test Loss: 0.1784985
Validation loss decreased (inf --> 0.060596).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3199761
	speed: 0.0498s/iter; left time: 534.8886s
	iters: 200, epoch: 2 | loss: 0.2933764
	speed: 0.0162s/iter; left time: 172.5001s
	iters: 300, epoch: 2 | loss: 0.2461826
	speed: 0.0163s/iter; left time: 171.1481s
	iters: 400, epoch: 2 | loss: 0.1865421
	speed: 0.0162s/iter; left time: 169.2012s
	iters: 500, epoch: 2 | loss: 0.1998470
	speed: 0.0162s/iter; left time: 167.5460s
Epoch: 2 cost time: 9.561336755752563
Epoch: 2, Steps: 570 | Train Loss: 0.2443581 Vali Loss: 0.0566670 Test Loss: 0.1673443
Validation loss decreased (0.060596 --> 0.056667).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1712860
	speed: 0.0496s/iter; left time: 503.8003s
	iters: 200, epoch: 3 | loss: 0.2103451
	speed: 0.0163s/iter; left time: 164.2898s
	iters: 300, epoch: 3 | loss: 0.4008002
	speed: 0.0163s/iter; left time: 162.8547s
	iters: 400, epoch: 3 | loss: 0.1707188
	speed: 0.0163s/iter; left time: 160.5025s
	iters: 500, epoch: 3 | loss: 0.1664254
	speed: 0.0162s/iter; left time: 158.4912s
Epoch: 3 cost time: 9.588996171951294
Epoch: 3, Steps: 570 | Train Loss: 0.2219512 Vali Loss: 0.0556036 Test Loss: 0.1672316
Validation loss decreased (0.056667 --> 0.055604).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2207455
	speed: 0.0501s/iter; left time: 480.9439s
	iters: 200, epoch: 4 | loss: 0.1581748
	speed: 0.0164s/iter; left time: 155.2592s
	iters: 300, epoch: 4 | loss: 0.2124525
	speed: 0.0163s/iter; left time: 153.5327s
	iters: 400, epoch: 4 | loss: 0.2408208
	speed: 0.0164s/iter; left time: 151.9080s
	iters: 500, epoch: 4 | loss: 0.2091046
	speed: 0.0164s/iter; left time: 150.3339s
Epoch: 4 cost time: 9.626768589019775
Epoch: 4, Steps: 570 | Train Loss: 0.2056069 Vali Loss: 0.0549288 Test Loss: 0.1595826
Validation loss decreased (0.055604 --> 0.054929).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1119223
	speed: 0.0502s/iter; left time: 452.9298s
	iters: 200, epoch: 5 | loss: 0.2474061
	speed: 0.0162s/iter; left time: 144.3792s
	iters: 300, epoch: 5 | loss: 0.1595972
	speed: 0.0162s/iter; left time: 142.7716s
	iters: 400, epoch: 5 | loss: 0.1962070
	speed: 0.0162s/iter; left time: 141.2586s
	iters: 500, epoch: 5 | loss: 0.1181757
	speed: 0.0162s/iter; left time: 139.6007s
Epoch: 5 cost time: 9.523343563079834
Epoch: 5, Steps: 570 | Train Loss: 0.1918694 Vali Loss: 0.0520827 Test Loss: 0.1561523
Validation loss decreased (0.054929 --> 0.052083).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2458714
	speed: 0.0496s/iter; left time: 419.2086s
	iters: 200, epoch: 6 | loss: 0.1949445
	speed: 0.0164s/iter; left time: 136.7128s
	iters: 300, epoch: 6 | loss: 0.1986408
	speed: 0.0163s/iter; left time: 134.4161s
	iters: 400, epoch: 6 | loss: 0.1711691
	speed: 0.0163s/iter; left time: 132.6499s
	iters: 500, epoch: 6 | loss: 0.1469568
	speed: 0.0163s/iter; left time: 131.0576s
Epoch: 6 cost time: 9.609584331512451
Epoch: 6, Steps: 570 | Train Loss: 0.1827700 Vali Loss: 0.0516950 Test Loss: 0.1541000
Validation loss decreased (0.052083 --> 0.051695).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1399203
	speed: 0.0499s/iter; left time: 393.6313s
	iters: 200, epoch: 7 | loss: 0.1742556
	speed: 0.0164s/iter; left time: 127.4902s
	iters: 300, epoch: 7 | loss: 0.2358050
	speed: 0.0164s/iter; left time: 125.6959s
	iters: 400, epoch: 7 | loss: 0.1169023
	speed: 0.0164s/iter; left time: 123.9958s
	iters: 500, epoch: 7 | loss: 0.1349545
	speed: 0.0163s/iter; left time: 122.2839s
Epoch: 7 cost time: 9.626683473587036
Epoch: 7, Steps: 570 | Train Loss: 0.1767164 Vali Loss: 0.0508177 Test Loss: 0.1546150
Validation loss decreased (0.051695 --> 0.050818).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1813668
	speed: 0.0498s/iter; left time: 363.9403s
	iters: 200, epoch: 8 | loss: 0.0937806
	speed: 0.0162s/iter; left time: 116.8733s
	iters: 300, epoch: 8 | loss: 0.2412933
	speed: 0.0162s/iter; left time: 115.1767s
	iters: 400, epoch: 8 | loss: 0.0744712
	speed: 0.0163s/iter; left time: 114.0482s
	iters: 500, epoch: 8 | loss: 0.1182611
	speed: 0.0162s/iter; left time: 112.2864s
Epoch: 8 cost time: 9.549283027648926
Epoch: 8, Steps: 570 | Train Loss: 0.1734604 Vali Loss: 0.0512147 Test Loss: 0.1527786
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1379862
	speed: 0.0488s/iter; left time: 329.1570s
	iters: 200, epoch: 9 | loss: 0.1061947
	speed: 0.0162s/iter; left time: 107.8691s
	iters: 300, epoch: 9 | loss: 0.2308059
	speed: 0.0162s/iter; left time: 106.1933s
	iters: 400, epoch: 9 | loss: 0.2565937
	speed: 0.0162s/iter; left time: 104.4694s
	iters: 500, epoch: 9 | loss: 0.2260476
	speed: 0.0162s/iter; left time: 102.8773s
Epoch: 9 cost time: 9.532809972763062
Epoch: 9, Steps: 570 | Train Loss: 0.1710706 Vali Loss: 0.0513368 Test Loss: 0.1541629
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2487854
	speed: 0.0490s/iter; left time: 302.6275s
	iters: 200, epoch: 10 | loss: 0.1119462
	speed: 0.0163s/iter; left time: 98.9309s
	iters: 300, epoch: 10 | loss: 0.2310973
	speed: 0.0162s/iter; left time: 96.9338s
	iters: 400, epoch: 10 | loss: 0.1924249
	speed: 0.0163s/iter; left time: 95.4414s
	iters: 500, epoch: 10 | loss: 0.1760089
	speed: 0.0163s/iter; left time: 94.2722s
Epoch: 10 cost time: 9.593299388885498
Epoch: 10, Steps: 570 | Train Loss: 0.1698534 Vali Loss: 0.0513064 Test Loss: 0.1535706
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1548595428466797, mae:0.25309622287750244
>>> MS_Pen LR=1e-3 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2214940
	speed: 0.0276s/iter; left time: 312.4691s
	iters: 200, epoch: 1 | loss: 0.1408844
	speed: 0.0158s/iter; left time: 176.5117s
	iters: 300, epoch: 1 | loss: 0.3629175
	speed: 0.0158s/iter; left time: 174.8452s
	iters: 400, epoch: 1 | loss: 0.2472689
	speed: 0.0158s/iter; left time: 173.7293s
	iters: 500, epoch: 1 | loss: 0.1526705
	speed: 0.0158s/iter; left time: 171.8148s
Epoch: 1 cost time: 10.227437734603882
Epoch: 1, Steps: 570 | Train Loss: 0.2836423 Vali Loss: 0.0568554 Test Loss: 0.1650993
Validation loss decreased (inf --> 0.056855).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2308982
	speed: 0.0490s/iter; left time: 526.2794s
	iters: 200, epoch: 2 | loss: 0.2017940
	speed: 0.0158s/iter; left time: 167.6229s
	iters: 300, epoch: 2 | loss: 0.3303472
	speed: 0.0158s/iter; left time: 166.0641s
	iters: 400, epoch: 2 | loss: 0.2706167
	speed: 0.0158s/iter; left time: 164.4262s
	iters: 500, epoch: 2 | loss: 0.2770408
	speed: 0.0158s/iter; left time: 163.0472s
Epoch: 2 cost time: 9.313035726547241
Epoch: 2, Steps: 570 | Train Loss: 0.2510214 Vali Loss: 0.0587489 Test Loss: 0.1632296
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2044878
	speed: 0.0479s/iter; left time: 486.7761s
	iters: 200, epoch: 3 | loss: 0.2003841
	speed: 0.0159s/iter; left time: 159.5595s
	iters: 300, epoch: 3 | loss: 0.1661766
	speed: 0.0158s/iter; left time: 157.7824s
	iters: 400, epoch: 3 | loss: 0.2172903
	speed: 0.0159s/iter; left time: 156.3585s
	iters: 500, epoch: 3 | loss: 0.2203510
	speed: 0.0158s/iter; left time: 154.5732s
Epoch: 3 cost time: 9.32435154914856
Epoch: 3, Steps: 570 | Train Loss: 0.2184401 Vali Loss: 0.0554921 Test Loss: 0.1586099
Validation loss decreased (0.056855 --> 0.055492).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1604000
	speed: 0.0485s/iter; left time: 464.8800s
	iters: 200, epoch: 4 | loss: 0.3697075
	speed: 0.0158s/iter; left time: 150.0255s
	iters: 300, epoch: 4 | loss: 0.1668597
	speed: 0.0158s/iter; left time: 148.3034s
	iters: 400, epoch: 4 | loss: 0.1532305
	speed: 0.0158s/iter; left time: 146.8650s
	iters: 500, epoch: 4 | loss: 0.3278894
	speed: 0.0158s/iter; left time: 145.3460s
Epoch: 4 cost time: 9.275384426116943
Epoch: 4, Steps: 570 | Train Loss: 0.2001305 Vali Loss: 0.0561239 Test Loss: 0.1634805
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1443114
	speed: 0.0476s/iter; left time: 429.0360s
	iters: 200, epoch: 5 | loss: 0.3411675
	speed: 0.0158s/iter; left time: 140.8578s
	iters: 300, epoch: 5 | loss: 0.1927782
	speed: 0.0158s/iter; left time: 139.0039s
	iters: 400, epoch: 5 | loss: 0.1514819
	speed: 0.0158s/iter; left time: 137.5045s
	iters: 500, epoch: 5 | loss: 0.2250858
	speed: 0.0158s/iter; left time: 136.0622s
Epoch: 5 cost time: 9.28562068939209
Epoch: 5, Steps: 570 | Train Loss: 0.1866314 Vali Loss: 0.0557840 Test Loss: 0.1579999
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1618260
	speed: 0.0475s/iter; left time: 401.8165s
	iters: 200, epoch: 6 | loss: 0.2512094
	speed: 0.0158s/iter; left time: 131.7672s
	iters: 300, epoch: 6 | loss: 0.2108341
	speed: 0.0158s/iter; left time: 130.3919s
	iters: 400, epoch: 6 | loss: 0.1600610
	speed: 0.0158s/iter; left time: 128.6210s
	iters: 500, epoch: 6 | loss: 0.1679038
	speed: 0.0158s/iter; left time: 127.0682s
Epoch: 6 cost time: 9.278112411499023
Epoch: 6, Steps: 570 | Train Loss: 0.1662470 Vali Loss: 0.0509387 Test Loss: 0.1489864
Validation loss decreased (0.055492 --> 0.050939).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1633456
	speed: 0.0513s/iter; left time: 404.4892s
	iters: 200, epoch: 7 | loss: 0.1247004
	speed: 0.0158s/iter; left time: 122.5780s
	iters: 300, epoch: 7 | loss: 0.1608980
	speed: 0.0157s/iter; left time: 120.9007s
	iters: 400, epoch: 7 | loss: 0.1723228
	speed: 0.0157s/iter; left time: 119.2985s
	iters: 500, epoch: 7 | loss: 0.2095704
	speed: 0.0157s/iter; left time: 117.7376s
Epoch: 7 cost time: 9.255390167236328
Epoch: 7, Steps: 570 | Train Loss: 0.1520613 Vali Loss: 0.0510815 Test Loss: 0.1478942
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0750195
	speed: 0.0482s/iter; left time: 352.3090s
	iters: 200, epoch: 8 | loss: 0.1874878
	speed: 0.0158s/iter; left time: 113.8960s
	iters: 300, epoch: 8 | loss: 0.1498445
	speed: 0.0158s/iter; left time: 112.1663s
	iters: 400, epoch: 8 | loss: 0.1987157
	speed: 0.0158s/iter; left time: 110.5916s
	iters: 500, epoch: 8 | loss: 0.1718604
	speed: 0.0158s/iter; left time: 109.0359s
Epoch: 8 cost time: 9.274794101715088
Epoch: 8, Steps: 570 | Train Loss: 0.1447833 Vali Loss: 0.0500474 Test Loss: 0.1463327
Validation loss decreased (0.050939 --> 0.050047).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0980536
	speed: 0.0497s/iter; left time: 335.2964s
	iters: 200, epoch: 9 | loss: 0.1085601
	speed: 0.0159s/iter; left time: 105.3687s
	iters: 300, epoch: 9 | loss: 0.0692479
	speed: 0.0159s/iter; left time: 103.7673s
	iters: 400, epoch: 9 | loss: 0.0788648
	speed: 0.0158s/iter; left time: 102.0529s
	iters: 500, epoch: 9 | loss: 0.0777115
	speed: 0.0159s/iter; left time: 100.7554s
Epoch: 9 cost time: 9.331968784332275
Epoch: 9, Steps: 570 | Train Loss: 0.1404098 Vali Loss: 0.0486988 Test Loss: 0.1432973
Validation loss decreased (0.050047 --> 0.048699).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1660873
	speed: 0.0492s/iter; left time: 303.5603s
	iters: 200, epoch: 10 | loss: 0.1374163
	speed: 0.0157s/iter; left time: 95.5806s
	iters: 300, epoch: 10 | loss: 0.0898324
	speed: 0.0158s/iter; left time: 94.0968s
	iters: 400, epoch: 10 | loss: 0.1360502
	speed: 0.0157s/iter; left time: 92.3849s
	iters: 500, epoch: 10 | loss: 0.1168721
	speed: 0.0157s/iter; left time: 90.7938s
Epoch: 10 cost time: 9.267507076263428
Epoch: 10, Steps: 570 | Train Loss: 0.1390289 Vali Loss: 0.0487065 Test Loss: 0.1435609
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0898554
	speed: 0.0509s/iter; left time: 285.2814s
	iters: 200, epoch: 11 | loss: 0.1081752
	speed: 0.0172s/iter; left time: 94.6690s
	iters: 300, epoch: 11 | loss: 0.1202586
	speed: 0.0172s/iter; left time: 92.9818s
	iters: 400, epoch: 11 | loss: 0.1520983
	speed: 0.0172s/iter; left time: 91.2859s
	iters: 500, epoch: 11 | loss: 0.1131320
	speed: 0.0172s/iter; left time: 89.4536s
Epoch: 11 cost time: 10.073539972305298
Epoch: 11, Steps: 570 | Train Loss: 0.1377944 Vali Loss: 0.0483181 Test Loss: 0.1429313
Validation loss decreased (0.048699 --> 0.048318).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.0846506
	speed: 0.0512s/iter; left time: 257.3446s
	iters: 200, epoch: 12 | loss: 0.1405061
	speed: 0.0158s/iter; left time: 77.7766s
	iters: 300, epoch: 12 | loss: 0.0901031
	speed: 0.0158s/iter; left time: 76.1948s
	iters: 400, epoch: 12 | loss: 0.1505682
	speed: 0.0158s/iter; left time: 74.6180s
	iters: 500, epoch: 12 | loss: 0.1931266
	speed: 0.0157s/iter; left time: 72.7961s
Epoch: 12 cost time: 9.272964239120483
Epoch: 12, Steps: 570 | Train Loss: 0.1372033 Vali Loss: 0.0483315 Test Loss: 0.1430551
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1977529
	speed: 0.0475s/iter; left time: 211.8812s
	iters: 200, epoch: 13 | loss: 0.2094695
	speed: 0.0158s/iter; left time: 68.7934s
	iters: 300, epoch: 13 | loss: 0.1901880
	speed: 0.0158s/iter; left time: 67.1928s
	iters: 400, epoch: 13 | loss: 0.0963963
	speed: 0.0157s/iter; left time: 65.5181s
	iters: 500, epoch: 13 | loss: 0.1426376
	speed: 0.0158s/iter; left time: 64.0319s
Epoch: 13 cost time: 9.258672714233398
Epoch: 13, Steps: 570 | Train Loss: 0.1369250 Vali Loss: 0.0484381 Test Loss: 0.1430639
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1232191
	speed: 0.0486s/iter; left time: 189.1182s
	iters: 200, epoch: 14 | loss: 0.1315100
	speed: 0.0158s/iter; left time: 59.9005s
	iters: 300, epoch: 14 | loss: 0.1509756
	speed: 0.0158s/iter; left time: 58.1792s
	iters: 400, epoch: 14 | loss: 0.1421288
	speed: 0.0158s/iter; left time: 56.5711s
	iters: 500, epoch: 14 | loss: 0.1077337
	speed: 0.0157s/iter; left time: 54.9774s
Epoch: 14 cost time: 9.244015216827393
Epoch: 14, Steps: 570 | Train Loss: 0.1367975 Vali Loss: 0.0482784 Test Loss: 0.1430836
Validation loss decreased (0.048318 --> 0.048278).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1316568
	speed: 0.0495s/iter; left time: 164.4397s
	iters: 200, epoch: 15 | loss: 0.1863727
	speed: 0.0157s/iter; left time: 50.7256s
	iters: 300, epoch: 15 | loss: 0.0980348
	speed: 0.0157s/iter; left time: 49.1306s
	iters: 400, epoch: 15 | loss: 0.1037595
	speed: 0.0157s/iter; left time: 47.5604s
	iters: 500, epoch: 15 | loss: 0.2110654
	speed: 0.0157s/iter; left time: 45.9831s
Epoch: 15 cost time: 9.306355953216553
Epoch: 15, Steps: 570 | Train Loss: 0.1366967 Vali Loss: 0.0482203 Test Loss: 0.1430873
Validation loss decreased (0.048278 --> 0.048220).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.1639744
	speed: 0.0502s/iter; left time: 138.0636s
	iters: 200, epoch: 16 | loss: 0.1594280
	speed: 0.0158s/iter; left time: 41.7771s
	iters: 300, epoch: 16 | loss: 0.1529653
	speed: 0.0158s/iter; left time: 40.1909s
	iters: 400, epoch: 16 | loss: 0.1611038
	speed: 0.0158s/iter; left time: 38.6112s
	iters: 500, epoch: 16 | loss: 0.2011173
	speed: 0.0158s/iter; left time: 37.0325s
Epoch: 16 cost time: 9.288283348083496
Epoch: 16, Steps: 570 | Train Loss: 0.1366207 Vali Loss: 0.0482716 Test Loss: 0.1430906
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1700173
	speed: 0.0489s/iter; left time: 106.5986s
	iters: 200, epoch: 17 | loss: 0.1171240
	speed: 0.0158s/iter; left time: 32.8200s
	iters: 300, epoch: 17 | loss: 0.1370228
	speed: 0.0158s/iter; left time: 31.2249s
	iters: 400, epoch: 17 | loss: 0.1072877
	speed: 0.0158s/iter; left time: 29.8013s
	iters: 500, epoch: 17 | loss: 0.1197212
	speed: 0.0158s/iter; left time: 28.2261s
Epoch: 17 cost time: 9.262685537338257
Epoch: 17, Steps: 570 | Train Loss: 0.1365998 Vali Loss: 0.0482664 Test Loss: 0.1430974
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 18 | loss: 0.1060608
	speed: 0.0470s/iter; left time: 75.7678s
	iters: 200, epoch: 18 | loss: 0.1137656
	speed: 0.0158s/iter; left time: 23.8517s
	iters: 300, epoch: 18 | loss: 0.0880466
	speed: 0.0158s/iter; left time: 22.2257s
	iters: 400, epoch: 18 | loss: 0.1359554
	speed: 0.0157s/iter; left time: 20.6399s
	iters: 500, epoch: 18 | loss: 0.0877416
	speed: 0.0157s/iter; left time: 19.0557s
Epoch: 18 cost time: 9.259313344955444
Epoch: 18, Steps: 570 | Train Loss: 0.1366542 Vali Loss: 0.0482665 Test Loss: 0.1431000
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14329484105110168, mae:0.2422506958246231
>>> MS_Pen LR=1e-3 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3942888
	speed: 0.0279s/iter; left time: 315.1173s
	iters: 200, epoch: 1 | loss: 0.2671295
	speed: 0.0161s/iter; left time: 179.8138s
	iters: 300, epoch: 1 | loss: 0.1805864
	speed: 0.0160s/iter; left time: 177.8636s
	iters: 400, epoch: 1 | loss: 0.3051353
	speed: 0.0161s/iter; left time: 176.6388s
	iters: 500, epoch: 1 | loss: 0.4294639
	speed: 0.0161s/iter; left time: 175.2867s
Epoch: 1 cost time: 10.37992000579834
Epoch: 1, Steps: 570 | Train Loss: 0.2928813 Vali Loss: 0.0611380 Test Loss: 0.1848687
Validation loss decreased (inf --> 0.061138).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3029412
	speed: 0.0470s/iter; left time: 504.0266s
	iters: 200, epoch: 2 | loss: 0.1926967
	speed: 0.0146s/iter; left time: 154.8245s
	iters: 300, epoch: 2 | loss: 0.3330376
	speed: 0.0146s/iter; left time: 153.7719s
	iters: 400, epoch: 2 | loss: 0.2299203
	speed: 0.0146s/iter; left time: 151.9207s
	iters: 500, epoch: 2 | loss: 0.3412156
	speed: 0.0145s/iter; left time: 150.2847s
Epoch: 2 cost time: 8.584226846694946
Epoch: 2, Steps: 570 | Train Loss: 0.2461594 Vali Loss: 0.0546920 Test Loss: 0.1677886
Validation loss decreased (0.061138 --> 0.054692).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1868055
	speed: 0.0459s/iter; left time: 466.5925s
	iters: 200, epoch: 3 | loss: 0.1399674
	speed: 0.0146s/iter; left time: 146.5638s
	iters: 300, epoch: 3 | loss: 0.2686568
	speed: 0.0146s/iter; left time: 145.0055s
	iters: 400, epoch: 3 | loss: 0.2352526
	speed: 0.0145s/iter; left time: 143.1858s
	iters: 500, epoch: 3 | loss: 0.2205114
	speed: 0.0145s/iter; left time: 141.5787s
Epoch: 3 cost time: 8.558057308197021
Epoch: 3, Steps: 570 | Train Loss: 0.2194285 Vali Loss: 0.0528443 Test Loss: 0.1542518
Validation loss decreased (0.054692 --> 0.052844).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1516195
	speed: 0.0469s/iter; left time: 449.7408s
	iters: 200, epoch: 4 | loss: 0.2515127
	speed: 0.0146s/iter; left time: 138.4466s
	iters: 300, epoch: 4 | loss: 0.3024354
	speed: 0.0146s/iter; left time: 137.2223s
	iters: 400, epoch: 4 | loss: 0.1724420
	speed: 0.0146s/iter; left time: 135.6751s
	iters: 500, epoch: 4 | loss: 0.3107774
	speed: 0.0146s/iter; left time: 134.1238s
Epoch: 4 cost time: 8.602948188781738
Epoch: 4, Steps: 570 | Train Loss: 0.2024795 Vali Loss: 0.0508361 Test Loss: 0.1555642
Validation loss decreased (0.052844 --> 0.050836).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1706734
	speed: 0.0466s/iter; left time: 419.9782s
	iters: 200, epoch: 5 | loss: 0.1157060
	speed: 0.0146s/iter; left time: 129.9175s
	iters: 300, epoch: 5 | loss: 0.1478989
	speed: 0.0146s/iter; left time: 129.2152s
	iters: 400, epoch: 5 | loss: 0.1531830
	speed: 0.0159s/iter; left time: 138.3795s
	iters: 500, epoch: 5 | loss: 0.1448667
	speed: 0.0154s/iter; left time: 132.9177s
Epoch: 5 cost time: 8.933084726333618
Epoch: 5, Steps: 570 | Train Loss: 0.1927716 Vali Loss: 0.0495823 Test Loss: 0.1450873
Validation loss decreased (0.050836 --> 0.049582).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1803181
	speed: 0.0490s/iter; left time: 414.2125s
	iters: 200, epoch: 6 | loss: 0.1483917
	speed: 0.0167s/iter; left time: 139.2816s
	iters: 300, epoch: 6 | loss: 0.1078806
	speed: 0.0167s/iter; left time: 137.5264s
	iters: 400, epoch: 6 | loss: 0.0987182
	speed: 0.0167s/iter; left time: 135.9590s
	iters: 500, epoch: 6 | loss: 0.1737516
	speed: 0.0167s/iter; left time: 134.2410s
Epoch: 6 cost time: 9.774396896362305
Epoch: 6, Steps: 570 | Train Loss: 0.1832312 Vali Loss: 0.0482818 Test Loss: 0.1453328
Validation loss decreased (0.049582 --> 0.048282).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2071727
	speed: 0.0524s/iter; left time: 412.9270s
	iters: 200, epoch: 7 | loss: 0.1882157
	speed: 0.0167s/iter; left time: 130.1418s
	iters: 300, epoch: 7 | loss: 0.1491104
	speed: 0.0167s/iter; left time: 128.4568s
	iters: 400, epoch: 7 | loss: 0.1580932
	speed: 0.0167s/iter; left time: 126.8544s
	iters: 500, epoch: 7 | loss: 0.2288627
	speed: 0.0167s/iter; left time: 125.1559s
Epoch: 7 cost time: 9.818743228912354
Epoch: 7, Steps: 570 | Train Loss: 0.1780754 Vali Loss: 0.0474639 Test Loss: 0.1427371
Validation loss decreased (0.048282 --> 0.047464).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1561424
	speed: 0.0499s/iter; left time: 364.5545s
	iters: 200, epoch: 8 | loss: 0.2498607
	speed: 0.0145s/iter; left time: 104.6929s
	iters: 300, epoch: 8 | loss: 0.1426222
	speed: 0.0145s/iter; left time: 103.2709s
	iters: 400, epoch: 8 | loss: 0.1898964
	speed: 0.0145s/iter; left time: 101.8558s
	iters: 500, epoch: 8 | loss: 0.1596253
	speed: 0.0146s/iter; left time: 100.5769s
Epoch: 8 cost time: 8.771093606948853
Epoch: 8, Steps: 570 | Train Loss: 0.1754821 Vali Loss: 0.0479707 Test Loss: 0.1449824
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1804230
	speed: 0.0451s/iter; left time: 303.6866s
	iters: 200, epoch: 9 | loss: 0.1751491
	speed: 0.0145s/iter; left time: 96.3318s
	iters: 300, epoch: 9 | loss: 0.1744241
	speed: 0.0145s/iter; left time: 94.8821s
	iters: 400, epoch: 9 | loss: 0.1051261
	speed: 0.0145s/iter; left time: 93.2917s
	iters: 500, epoch: 9 | loss: 0.1422366
	speed: 0.0146s/iter; left time: 92.7181s
Epoch: 9 cost time: 8.56615686416626
Epoch: 9, Steps: 570 | Train Loss: 0.1741010 Vali Loss: 0.0482375 Test Loss: 0.1451036
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2013569
	speed: 0.0467s/iter; left time: 288.1752s
	iters: 200, epoch: 10 | loss: 0.2049690
	speed: 0.0146s/iter; left time: 88.5176s
	iters: 300, epoch: 10 | loss: 0.1360261
	speed: 0.0146s/iter; left time: 87.1191s
	iters: 400, epoch: 10 | loss: 0.1976012
	speed: 0.0167s/iter; left time: 97.8507s
	iters: 500, epoch: 10 | loss: 0.2637321
	speed: 0.0167s/iter; left time: 96.1407s
Epoch: 10 cost time: 9.14870309829712
Epoch: 10, Steps: 570 | Train Loss: 0.1730316 Vali Loss: 0.0482637 Test Loss: 0.1452774
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14297498762607574, mae:0.24165786802768707
>>> MS_Pen LR=1e-3 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1420940
	speed: 0.0315s/iter; left time: 355.8363s
	iters: 200, epoch: 1 | loss: 0.2577541
	speed: 0.0197s/iter; left time: 220.1316s
	iters: 300, epoch: 1 | loss: 0.4149987
	speed: 0.0194s/iter; left time: 214.9527s
	iters: 400, epoch: 1 | loss: 0.2494985
	speed: 0.0177s/iter; left time: 194.3906s
	iters: 500, epoch: 1 | loss: 0.1596740
	speed: 0.0177s/iter; left time: 192.6184s
Epoch: 1 cost time: 11.877482414245605
Epoch: 1, Steps: 570 | Train Loss: 0.2611593 Vali Loss: 0.0625295 Test Loss: 0.1870161
Validation loss decreased (inf --> 0.062530).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2851799
	speed: 0.0570s/iter; left time: 612.0058s
	iters: 200, epoch: 2 | loss: 0.1957552
	speed: 0.0175s/iter; left time: 186.3132s
	iters: 300, epoch: 2 | loss: 0.1180364
	speed: 0.0175s/iter; left time: 184.4540s
	iters: 400, epoch: 2 | loss: 0.1536604
	speed: 0.0175s/iter; left time: 182.5990s
	iters: 500, epoch: 2 | loss: 0.1131565
	speed: 0.0175s/iter; left time: 180.8929s
Epoch: 2 cost time: 10.30465817451477
Epoch: 2, Steps: 570 | Train Loss: 0.2008691 Vali Loss: 0.0475021 Test Loss: 0.1444101
Validation loss decreased (0.062530 --> 0.047502).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1196848
	speed: 0.0546s/iter; left time: 554.3611s
	iters: 200, epoch: 3 | loss: 0.1901355
	speed: 0.0176s/iter; left time: 176.6097s
	iters: 300, epoch: 3 | loss: 0.1668904
	speed: 0.0176s/iter; left time: 175.1769s
	iters: 400, epoch: 3 | loss: 0.1014308
	speed: 0.0176s/iter; left time: 173.1973s
	iters: 500, epoch: 3 | loss: 0.1136454
	speed: 0.0176s/iter; left time: 171.3486s
Epoch: 3 cost time: 10.326209545135498
Epoch: 3, Steps: 570 | Train Loss: 0.1690780 Vali Loss: 0.0484118 Test Loss: 0.1423367
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1904339
	speed: 0.0546s/iter; left time: 523.3131s
	iters: 200, epoch: 4 | loss: 0.1706080
	speed: 0.0177s/iter; left time: 168.1357s
	iters: 300, epoch: 4 | loss: 0.1949360
	speed: 0.0177s/iter; left time: 166.4246s
	iters: 400, epoch: 4 | loss: 0.1151955
	speed: 0.0176s/iter; left time: 163.4086s
	iters: 500, epoch: 4 | loss: 0.1369155
	speed: 0.0176s/iter; left time: 161.4717s
Epoch: 4 cost time: 10.360308647155762
Epoch: 4, Steps: 570 | Train Loss: 0.1508992 Vali Loss: 0.0443195 Test Loss: 0.1360094
Validation loss decreased (0.047502 --> 0.044320).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1449357
	speed: 0.0544s/iter; left time: 490.8376s
	iters: 200, epoch: 5 | loss: 0.1074786
	speed: 0.0177s/iter; left time: 157.4663s
	iters: 300, epoch: 5 | loss: 0.1417876
	speed: 0.0176s/iter; left time: 155.6490s
	iters: 400, epoch: 5 | loss: 0.1290242
	speed: 0.0177s/iter; left time: 153.9520s
	iters: 500, epoch: 5 | loss: 0.1432491
	speed: 0.0176s/iter; left time: 152.1119s
Epoch: 5 cost time: 10.362580299377441
Epoch: 5, Steps: 570 | Train Loss: 0.1380295 Vali Loss: 0.0438518 Test Loss: 0.1352330
Validation loss decreased (0.044320 --> 0.043852).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0976194
	speed: 0.0578s/iter; left time: 488.5403s
	iters: 200, epoch: 6 | loss: 0.1282525
	speed: 0.0196s/iter; left time: 163.5504s
	iters: 300, epoch: 6 | loss: 0.1177963
	speed: 0.0196s/iter; left time: 161.4415s
	iters: 400, epoch: 6 | loss: 0.1526096
	speed: 0.0196s/iter; left time: 159.5575s
	iters: 500, epoch: 6 | loss: 0.1113358
	speed: 0.0196s/iter; left time: 157.6029s
Epoch: 6 cost time: 11.445297718048096
Epoch: 6, Steps: 570 | Train Loss: 0.1290398 Vali Loss: 0.0451742 Test Loss: 0.1436341
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1060010
	speed: 0.0558s/iter; left time: 439.5494s
	iters: 200, epoch: 7 | loss: 0.1501136
	speed: 0.0176s/iter; left time: 136.8366s
	iters: 300, epoch: 7 | loss: 0.1245107
	speed: 0.0176s/iter; left time: 135.0104s
	iters: 400, epoch: 7 | loss: 0.1239189
	speed: 0.0176s/iter; left time: 133.2672s
	iters: 500, epoch: 7 | loss: 0.1371768
	speed: 0.0176s/iter; left time: 131.5207s
Epoch: 7 cost time: 10.306340456008911
Epoch: 7, Steps: 570 | Train Loss: 0.1235699 Vali Loss: 0.0440384 Test Loss: 0.1399331
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1244673
	speed: 0.0548s/iter; left time: 400.9201s
	iters: 200, epoch: 8 | loss: 0.0826228
	speed: 0.0175s/iter; left time: 126.0714s
	iters: 300, epoch: 8 | loss: 0.1352234
	speed: 0.0175s/iter; left time: 124.4036s
	iters: 400, epoch: 8 | loss: 0.1579100
	speed: 0.0175s/iter; left time: 122.5285s
	iters: 500, epoch: 8 | loss: 0.0955223
	speed: 0.0174s/iter; left time: 120.5365s
Epoch: 8 cost time: 10.250279188156128
Epoch: 8, Steps: 570 | Train Loss: 0.1202579 Vali Loss: 0.0442538 Test Loss: 0.1415379
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1354133039712906, mae:0.23098686337471008
>>> MS_Pen LR=1e-3 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.4012366
	speed: 0.0293s/iter; left time: 331.3598s
	iters: 200, epoch: 1 | loss: 0.2056595
	speed: 0.0174s/iter; left time: 194.4426s
	iters: 300, epoch: 1 | loss: 0.1651605
	speed: 0.0174s/iter; left time: 192.7063s
	iters: 400, epoch: 1 | loss: 0.2505523
	speed: 0.0174s/iter; left time: 191.4235s
	iters: 500, epoch: 1 | loss: 0.2654470
	speed: 0.0174s/iter; left time: 189.6648s
Epoch: 1 cost time: 11.154785394668579
Epoch: 1, Steps: 570 | Train Loss: 0.2328296 Vali Loss: 0.0580657 Test Loss: 0.1817345
Validation loss decreased (inf --> 0.058066).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2797346
	speed: 0.0574s/iter; left time: 615.8560s
	iters: 200, epoch: 2 | loss: 0.3381135
	speed: 0.0174s/iter; left time: 185.3090s
	iters: 300, epoch: 2 | loss: 0.4131970
	speed: 0.0174s/iter; left time: 183.6020s
	iters: 400, epoch: 2 | loss: 0.2254952
	speed: 0.0174s/iter; left time: 181.1051s
	iters: 500, epoch: 2 | loss: 0.1578142
	speed: 0.0173s/iter; left time: 179.0641s
Epoch: 2 cost time: 10.229573249816895
Epoch: 2, Steps: 570 | Train Loss: 0.2494150 Vali Loss: 0.0604770 Test Loss: 0.1708640
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1581524
	speed: 0.0562s/iter; left time: 571.4710s
	iters: 200, epoch: 3 | loss: 0.1966600
	speed: 0.0174s/iter; left time: 175.1151s
	iters: 300, epoch: 3 | loss: 0.2181230
	speed: 0.0173s/iter; left time: 172.7043s
	iters: 400, epoch: 3 | loss: 0.1595051
	speed: 0.0174s/iter; left time: 171.3289s
	iters: 500, epoch: 3 | loss: 0.1622049
	speed: 0.0174s/iter; left time: 169.5246s
Epoch: 3 cost time: 10.206663131713867
Epoch: 3, Steps: 570 | Train Loss: 0.2250589 Vali Loss: 0.0563632 Test Loss: 0.1685880
Validation loss decreased (0.058066 --> 0.056363).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2193945
	speed: 0.0550s/iter; left time: 527.7841s
	iters: 200, epoch: 4 | loss: 0.1463875
	speed: 0.0191s/iter; left time: 181.4694s
	iters: 300, epoch: 4 | loss: 0.3321868
	speed: 0.0175s/iter; left time: 163.8885s
	iters: 400, epoch: 4 | loss: 0.1739766
	speed: 0.0174s/iter; left time: 162.0716s
	iters: 500, epoch: 4 | loss: 0.1451930
	speed: 0.0174s/iter; left time: 160.1949s
Epoch: 4 cost time: 10.49593186378479
Epoch: 4, Steps: 570 | Train Loss: 0.2105025 Vali Loss: 0.0559186 Test Loss: 0.1607026
Validation loss decreased (0.056363 --> 0.055919).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1721803
	speed: 0.0562s/iter; left time: 506.5958s
	iters: 200, epoch: 5 | loss: 0.1990937
	speed: 0.0174s/iter; left time: 155.1022s
	iters: 300, epoch: 5 | loss: 0.1523555
	speed: 0.0173s/iter; left time: 153.0139s
	iters: 400, epoch: 5 | loss: 0.1686691
	speed: 0.0173s/iter; left time: 151.0111s
	iters: 500, epoch: 5 | loss: 0.1931356
	speed: 0.0173s/iter; left time: 149.2824s
Epoch: 5 cost time: 10.219026327133179
Epoch: 5, Steps: 570 | Train Loss: 0.2001705 Vali Loss: 0.0553935 Test Loss: 0.1577737
Validation loss decreased (0.055919 --> 0.055393).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2996748
	speed: 0.0549s/iter; left time: 463.9375s
	iters: 200, epoch: 6 | loss: 0.1744705
	speed: 0.0174s/iter; left time: 144.9991s
	iters: 300, epoch: 6 | loss: 0.1485855
	speed: 0.0173s/iter; left time: 142.9982s
	iters: 400, epoch: 6 | loss: 0.1690910
	speed: 0.0173s/iter; left time: 140.7921s
	iters: 500, epoch: 6 | loss: 0.1681129
	speed: 0.0174s/iter; left time: 140.4147s
Epoch: 6 cost time: 10.215899467468262
Epoch: 6, Steps: 570 | Train Loss: 0.1928969 Vali Loss: 0.0547578 Test Loss: 0.1565004
Validation loss decreased (0.055393 --> 0.054758).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1680882
	speed: 0.0558s/iter; left time: 439.4496s
	iters: 200, epoch: 7 | loss: 0.1866066
	speed: 0.0175s/iter; left time: 136.1817s
	iters: 300, epoch: 7 | loss: 0.1336622
	speed: 0.0175s/iter; left time: 134.7854s
	iters: 400, epoch: 7 | loss: 0.2160063
	speed: 0.0175s/iter; left time: 132.5317s
	iters: 500, epoch: 7 | loss: 0.2041096
	speed: 0.0175s/iter; left time: 131.0854s
Epoch: 7 cost time: 10.318054437637329
Epoch: 7, Steps: 570 | Train Loss: 0.1886214 Vali Loss: 0.0552595 Test Loss: 0.1577788
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1454370
	speed: 0.0583s/iter; left time: 425.9541s
	iters: 200, epoch: 8 | loss: 0.1480299
	speed: 0.0190s/iter; left time: 137.2503s
	iters: 300, epoch: 8 | loss: 0.2344817
	speed: 0.0174s/iter; left time: 124.0315s
	iters: 400, epoch: 8 | loss: 0.2088774
	speed: 0.0174s/iter; left time: 122.2594s
	iters: 500, epoch: 8 | loss: 0.2026727
	speed: 0.0174s/iter; left time: 120.4676s
Epoch: 8 cost time: 10.641125440597534
Epoch: 8, Steps: 570 | Train Loss: 0.1860456 Vali Loss: 0.0551524 Test Loss: 0.1582132
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1338591
	speed: 0.0545s/iter; left time: 367.5437s
	iters: 200, epoch: 9 | loss: 0.1560225
	speed: 0.0174s/iter; left time: 115.7360s
	iters: 300, epoch: 9 | loss: 0.1565053
	speed: 0.0174s/iter; left time: 113.8723s
	iters: 400, epoch: 9 | loss: 0.1771824
	speed: 0.0174s/iter; left time: 111.9632s
	iters: 500, epoch: 9 | loss: 0.1241863
	speed: 0.0173s/iter; left time: 109.9491s
Epoch: 9 cost time: 10.23803162574768
Epoch: 9, Steps: 570 | Train Loss: 0.1846243 Vali Loss: 0.0552148 Test Loss: 0.1573553
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15671910345554352, mae:0.2557891011238098
>>> MS_Pen LR=1e-3 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2498478
	speed: 0.0310s/iter; left time: 350.5970s
	iters: 200, epoch: 1 | loss: 0.1637570
	speed: 0.0192s/iter; left time: 215.0728s
	iters: 300, epoch: 1 | loss: 0.2891388
	speed: 0.0192s/iter; left time: 213.1572s
	iters: 400, epoch: 1 | loss: 0.2380916
	speed: 0.0193s/iter; left time: 212.1111s
	iters: 500, epoch: 1 | loss: 0.3261759
	speed: 0.0192s/iter; left time: 209.5209s
Epoch: 1 cost time: 12.149645566940308
Epoch: 1, Steps: 570 | Train Loss: 0.2471027 Vali Loss: 0.0580934 Test Loss: 0.1665098
Validation loss decreased (inf --> 0.058093).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3557869
	speed: 0.0561s/iter; left time: 602.1906s
	iters: 200, epoch: 2 | loss: 0.2950077
	speed: 0.0173s/iter; left time: 183.7715s
	iters: 300, epoch: 2 | loss: 0.3624564
	speed: 0.0172s/iter; left time: 181.6392s
	iters: 400, epoch: 2 | loss: 0.2290204
	speed: 0.0172s/iter; left time: 179.8199s
	iters: 500, epoch: 2 | loss: 0.2144728
	speed: 0.0172s/iter; left time: 178.1602s
Epoch: 2 cost time: 10.131885290145874
Epoch: 2, Steps: 570 | Train Loss: 0.2352410 Vali Loss: 0.0546981 Test Loss: 0.1538625
Validation loss decreased (0.058093 --> 0.054698).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1082023
	speed: 0.0546s/iter; left time: 555.1389s
	iters: 200, epoch: 3 | loss: 0.1966630
	speed: 0.0173s/iter; left time: 174.4167s
	iters: 300, epoch: 3 | loss: 0.2291169
	speed: 0.0173s/iter; left time: 172.4932s
	iters: 400, epoch: 3 | loss: 0.2323553
	speed: 0.0173s/iter; left time: 170.5476s
	iters: 500, epoch: 3 | loss: 0.2441278
	speed: 0.0173s/iter; left time: 168.8535s
Epoch: 3 cost time: 10.181424617767334
Epoch: 3, Steps: 570 | Train Loss: 0.2010330 Vali Loss: 0.0528549 Test Loss: 0.1598477
Validation loss decreased (0.054698 --> 0.052855).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1502921
	speed: 0.0541s/iter; left time: 519.0725s
	iters: 200, epoch: 4 | loss: 0.1704096
	speed: 0.0172s/iter; left time: 163.5195s
	iters: 300, epoch: 4 | loss: 0.1226868
	speed: 0.0172s/iter; left time: 161.4846s
	iters: 400, epoch: 4 | loss: 0.1857459
	speed: 0.0172s/iter; left time: 159.9485s
	iters: 500, epoch: 4 | loss: 0.1240489
	speed: 0.0172s/iter; left time: 158.2027s
Epoch: 4 cost time: 10.1315758228302
Epoch: 4, Steps: 570 | Train Loss: 0.1822212 Vali Loss: 0.0493927 Test Loss: 0.1518583
Validation loss decreased (0.052855 --> 0.049393).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1629769
	speed: 0.0562s/iter; left time: 507.1940s
	iters: 200, epoch: 5 | loss: 0.1153805
	speed: 0.0173s/iter; left time: 154.0559s
	iters: 300, epoch: 5 | loss: 0.1275136
	speed: 0.0172s/iter; left time: 152.1117s
	iters: 400, epoch: 5 | loss: 0.1494311
	speed: 0.0172s/iter; left time: 149.9628s
	iters: 500, epoch: 5 | loss: 0.1121871
	speed: 0.0172s/iter; left time: 148.3384s
Epoch: 5 cost time: 10.124966144561768
Epoch: 5, Steps: 570 | Train Loss: 0.1641398 Vali Loss: 0.0482421 Test Loss: 0.1532857
Validation loss decreased (0.049393 --> 0.048242).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1932170
	speed: 0.0545s/iter; left time: 460.1914s
	iters: 200, epoch: 6 | loss: 0.1256723
	speed: 0.0173s/iter; left time: 144.0795s
	iters: 300, epoch: 6 | loss: 0.2789684
	speed: 0.0172s/iter; left time: 141.7354s
	iters: 400, epoch: 6 | loss: 0.1143450
	speed: 0.0171s/iter; left time: 139.7710s
	iters: 500, epoch: 6 | loss: 0.1447797
	speed: 0.0171s/iter; left time: 138.0273s
Epoch: 6 cost time: 10.094863891601562
Epoch: 6, Steps: 570 | Train Loss: 0.1526357 Vali Loss: 0.0487253 Test Loss: 0.1559197
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1284846
	speed: 0.0528s/iter; left time: 416.1762s
	iters: 200, epoch: 7 | loss: 0.0848803
	speed: 0.0171s/iter; left time: 133.0738s
	iters: 300, epoch: 7 | loss: 0.1500979
	speed: 0.0171s/iter; left time: 131.3385s
	iters: 400, epoch: 7 | loss: 0.1410034
	speed: 0.0171s/iter; left time: 129.3738s
	iters: 500, epoch: 7 | loss: 0.1171819
	speed: 0.0171s/iter; left time: 127.9112s
Epoch: 7 cost time: 10.004610061645508
Epoch: 7, Steps: 570 | Train Loss: 0.1454465 Vali Loss: 0.0481474 Test Loss: 0.1533231
Validation loss decreased (0.048242 --> 0.048147).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1011078
	speed: 0.0547s/iter; left time: 399.6620s
	iters: 200, epoch: 8 | loss: 0.0680484
	speed: 0.0172s/iter; left time: 124.0516s
	iters: 300, epoch: 8 | loss: 0.1225398
	speed: 0.0172s/iter; left time: 122.0301s
	iters: 400, epoch: 8 | loss: 0.1554933
	speed: 0.0171s/iter; left time: 120.1990s
	iters: 500, epoch: 8 | loss: 0.0881597
	speed: 0.0172s/iter; left time: 118.5813s
Epoch: 8 cost time: 10.078516006469727
Epoch: 8, Steps: 570 | Train Loss: 0.1416314 Vali Loss: 0.0489335 Test Loss: 0.1573184
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1936120
	speed: 0.0533s/iter; left time: 359.0915s
	iters: 200, epoch: 9 | loss: 0.2385273
	speed: 0.0173s/iter; left time: 114.8865s
	iters: 300, epoch: 9 | loss: 0.1454410
	speed: 0.0172s/iter; left time: 112.6020s
	iters: 400, epoch: 9 | loss: 0.2446989
	speed: 0.0172s/iter; left time: 110.6388s
	iters: 500, epoch: 9 | loss: 0.1272679
	speed: 0.0172s/iter; left time: 108.9471s
Epoch: 9 cost time: 10.179310321807861
Epoch: 9, Steps: 570 | Train Loss: 0.1393948 Vali Loss: 0.0484493 Test Loss: 0.1566498
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1430313
	speed: 0.0565s/iter; left time: 348.7819s
	iters: 200, epoch: 10 | loss: 0.1283201
	speed: 0.0199s/iter; left time: 120.7401s
	iters: 300, epoch: 10 | loss: 0.1555084
	speed: 0.0199s/iter; left time: 118.6214s
	iters: 400, epoch: 10 | loss: 0.1811756
	speed: 0.0194s/iter; left time: 113.6636s
	iters: 500, epoch: 10 | loss: 0.1344785
	speed: 0.0172s/iter; left time: 99.3436s
Epoch: 10 cost time: 11.110920190811157
Epoch: 10, Steps: 570 | Train Loss: 0.1381414 Vali Loss: 0.0484319 Test Loss: 0.1571210
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15354783833026886, mae:0.25223395228385925
>>> MS_Pen LR=1e-3 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2154056
	speed: 0.0333s/iter; left time: 375.8983s
	iters: 200, epoch: 1 | loss: 0.3033966
	speed: 0.0213s/iter; left time: 238.1730s
	iters: 300, epoch: 1 | loss: 0.2604544
	speed: 0.0213s/iter; left time: 235.9746s
	iters: 400, epoch: 1 | loss: 0.4135274
	speed: 0.0212s/iter; left time: 233.6918s
	iters: 500, epoch: 1 | loss: 0.3152454
	speed: 0.0213s/iter; left time: 232.1705s
Epoch: 1 cost time: 13.37324857711792
Epoch: 1, Steps: 570 | Train Loss: 0.3065426 Vali Loss: 0.0596851 Test Loss: 0.1738337
Validation loss decreased (inf --> 0.059685).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2852287
	speed: 0.0609s/iter; left time: 653.9624s
	iters: 200, epoch: 2 | loss: 0.2755420
	speed: 0.0214s/iter; left time: 227.7622s
	iters: 300, epoch: 2 | loss: 0.1920915
	speed: 0.0214s/iter; left time: 225.7661s
	iters: 400, epoch: 2 | loss: 0.3158519
	speed: 0.0214s/iter; left time: 223.5303s
	iters: 500, epoch: 2 | loss: 0.2412632
	speed: 0.0214s/iter; left time: 221.2995s
Epoch: 2 cost time: 12.513462781906128
Epoch: 2, Steps: 570 | Train Loss: 0.2485232 Vali Loss: 0.0561179 Test Loss: 0.1717473
Validation loss decreased (0.059685 --> 0.056118).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3606746
	speed: 0.0638s/iter; left time: 648.5782s
	iters: 200, epoch: 3 | loss: 0.1826836
	speed: 0.0232s/iter; left time: 233.8652s
	iters: 300, epoch: 3 | loss: 0.2249395
	speed: 0.0232s/iter; left time: 231.3898s
	iters: 400, epoch: 3 | loss: 0.2362014
	speed: 0.0232s/iter; left time: 228.9091s
	iters: 500, epoch: 3 | loss: 0.1449914
	speed: 0.0226s/iter; left time: 220.5755s
Epoch: 3 cost time: 13.462313652038574
Epoch: 3, Steps: 570 | Train Loss: 0.2259435 Vali Loss: 0.0540255 Test Loss: 0.1566758
Validation loss decreased (0.056118 --> 0.054025).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1732346
	speed: 0.0638s/iter; left time: 612.1490s
	iters: 200, epoch: 4 | loss: 0.2290437
	speed: 0.0213s/iter; left time: 202.0793s
	iters: 300, epoch: 4 | loss: 0.2571748
	speed: 0.0213s/iter; left time: 199.7910s
	iters: 400, epoch: 4 | loss: 0.1721740
	speed: 0.0213s/iter; left time: 197.8453s
	iters: 500, epoch: 4 | loss: 0.2625445
	speed: 0.0213s/iter; left time: 195.9191s
Epoch: 4 cost time: 12.437720537185669
Epoch: 4, Steps: 570 | Train Loss: 0.2059655 Vali Loss: 0.0538194 Test Loss: 0.1590706
Validation loss decreased (0.054025 --> 0.053819).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2475958
	speed: 0.0616s/iter; left time: 556.0453s
	iters: 200, epoch: 5 | loss: 0.2012775
	speed: 0.0213s/iter; left time: 190.2469s
	iters: 300, epoch: 5 | loss: 0.1883765
	speed: 0.0213s/iter; left time: 188.1193s
	iters: 400, epoch: 5 | loss: 0.1916563
	speed: 0.0213s/iter; left time: 185.9505s
	iters: 500, epoch: 5 | loss: 0.2555608
	speed: 0.0213s/iter; left time: 183.9122s
Epoch: 5 cost time: 12.460401058197021
Epoch: 5, Steps: 570 | Train Loss: 0.1902088 Vali Loss: 0.0520273 Test Loss: 0.1501857
Validation loss decreased (0.053819 --> 0.052027).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1720285
	speed: 0.0610s/iter; left time: 515.7900s
	iters: 200, epoch: 6 | loss: 0.2519647
	speed: 0.0214s/iter; left time: 178.5730s
	iters: 300, epoch: 6 | loss: 0.1732395
	speed: 0.0213s/iter; left time: 176.1360s
	iters: 400, epoch: 6 | loss: 0.1056768
	speed: 0.0213s/iter; left time: 173.7024s
	iters: 500, epoch: 6 | loss: 0.2480313
	speed: 0.0213s/iter; left time: 171.7283s
Epoch: 6 cost time: 12.434985160827637
Epoch: 6, Steps: 570 | Train Loss: 0.1806240 Vali Loss: 0.0520667 Test Loss: 0.1506981
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2316780
	speed: 0.0606s/iter; left time: 477.4730s
	iters: 200, epoch: 7 | loss: 0.1615822
	speed: 0.0213s/iter; left time: 165.6522s
	iters: 300, epoch: 7 | loss: 0.1267201
	speed: 0.0213s/iter; left time: 163.8504s
	iters: 400, epoch: 7 | loss: 0.1599964
	speed: 0.0213s/iter; left time: 161.3847s
	iters: 500, epoch: 7 | loss: 0.1621538
	speed: 0.0213s/iter; left time: 159.2659s
Epoch: 7 cost time: 12.478752374649048
Epoch: 7, Steps: 570 | Train Loss: 0.1746620 Vali Loss: 0.0508788 Test Loss: 0.1490361
Validation loss decreased (0.052027 --> 0.050879).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1194919
	speed: 0.0629s/iter; left time: 459.7043s
	iters: 200, epoch: 8 | loss: 0.2796100
	speed: 0.0216s/iter; left time: 155.5558s
	iters: 300, epoch: 8 | loss: 0.1227089
	speed: 0.0213s/iter; left time: 151.4837s
	iters: 400, epoch: 8 | loss: 0.1790843
	speed: 0.0213s/iter; left time: 149.3767s
	iters: 500, epoch: 8 | loss: 0.1589623
	speed: 0.0213s/iter; left time: 147.2645s
Epoch: 8 cost time: 12.648473501205444
Epoch: 8, Steps: 570 | Train Loss: 0.1710224 Vali Loss: 0.0505019 Test Loss: 0.1492615
Validation loss decreased (0.050879 --> 0.050502).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1677516
	speed: 0.0628s/iter; left time: 423.2611s
	iters: 200, epoch: 9 | loss: 0.1860765
	speed: 0.0213s/iter; left time: 141.6383s
	iters: 300, epoch: 9 | loss: 0.2290961
	speed: 0.0213s/iter; left time: 139.5781s
	iters: 400, epoch: 9 | loss: 0.1515317
	speed: 0.0213s/iter; left time: 137.2924s
	iters: 500, epoch: 9 | loss: 0.1377612
	speed: 0.0213s/iter; left time: 135.2496s
Epoch: 9 cost time: 12.433488130569458
Epoch: 9, Steps: 570 | Train Loss: 0.1694412 Vali Loss: 0.0507134 Test Loss: 0.1495891
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1669754
	speed: 0.0596s/iter; left time: 367.5680s
	iters: 200, epoch: 10 | loss: 0.1517929
	speed: 0.0213s/iter; left time: 129.3841s
	iters: 300, epoch: 10 | loss: 0.1343443
	speed: 0.0213s/iter; left time: 127.1905s
	iters: 400, epoch: 10 | loss: 0.3033867
	speed: 0.0213s/iter; left time: 125.0974s
	iters: 500, epoch: 10 | loss: 0.1626382
	speed: 0.0213s/iter; left time: 122.9323s
Epoch: 10 cost time: 12.406131029129028
Epoch: 10, Steps: 570 | Train Loss: 0.1683986 Vali Loss: 0.0508544 Test Loss: 0.1496655
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1863212
	speed: 0.0606s/iter; left time: 339.5880s
	iters: 200, epoch: 11 | loss: 0.1476232
	speed: 0.0213s/iter; left time: 117.3730s
	iters: 300, epoch: 11 | loss: 0.0879891
	speed: 0.0214s/iter; left time: 115.3188s
	iters: 400, epoch: 11 | loss: 0.1659213
	speed: 0.0214s/iter; left time: 113.2277s
	iters: 500, epoch: 11 | loss: 0.1273058
	speed: 0.0214s/iter; left time: 111.0861s
Epoch: 11 cost time: 12.43802285194397
Epoch: 11, Steps: 570 | Train Loss: 0.1677142 Vali Loss: 0.0508682 Test Loss: 0.1500585
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14947140216827393, mae:0.2436520755290985
>>> MS_Pen LR=1e-3 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3084499
	speed: 0.0344s/iter; left time: 388.3442s
	iters: 200, epoch: 1 | loss: 0.1353231
	speed: 0.0223s/iter; left time: 250.1731s
	iters: 300, epoch: 1 | loss: 0.2363759
	speed: 0.0224s/iter; left time: 248.3995s
	iters: 400, epoch: 1 | loss: 0.2772127
	speed: 0.0224s/iter; left time: 245.8759s
	iters: 500, epoch: 1 | loss: 0.2358459
	speed: 0.0223s/iter; left time: 243.6359s
Epoch: 1 cost time: 13.93340539932251
Epoch: 1, Steps: 570 | Train Loss: 0.3069958 Vali Loss: 0.0603072 Test Loss: 0.1735165
Validation loss decreased (inf --> 0.060307).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2368756
	speed: 0.0606s/iter; left time: 650.1446s
	iters: 200, epoch: 2 | loss: 0.1771477
	speed: 0.0206s/iter; left time: 219.1457s
	iters: 300, epoch: 2 | loss: 0.5024735
	speed: 0.0206s/iter; left time: 217.1615s
	iters: 400, epoch: 2 | loss: 0.2357582
	speed: 0.0206s/iter; left time: 214.9123s
	iters: 500, epoch: 2 | loss: 0.1817956
	speed: 0.0206s/iter; left time: 212.8966s
Epoch: 2 cost time: 12.06575322151184
Epoch: 2, Steps: 570 | Train Loss: 0.2525960 Vali Loss: 0.0578917 Test Loss: 0.1736360
Validation loss decreased (0.060307 --> 0.057892).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2363552
	speed: 0.0619s/iter; left time: 629.1886s
	iters: 200, epoch: 3 | loss: 0.2218982
	speed: 0.0206s/iter; left time: 207.3625s
	iters: 300, epoch: 3 | loss: 0.1436571
	speed: 0.0206s/iter; left time: 205.4093s
	iters: 400, epoch: 3 | loss: 0.1598773
	speed: 0.0207s/iter; left time: 203.6762s
	iters: 500, epoch: 3 | loss: 0.2024786
	speed: 0.0206s/iter; left time: 201.4653s
Epoch: 3 cost time: 12.088805198669434
Epoch: 3, Steps: 570 | Train Loss: 0.2275868 Vali Loss: 0.0580108 Test Loss: 0.1702792
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1257251
	speed: 0.0591s/iter; left time: 566.6410s
	iters: 200, epoch: 4 | loss: 0.2056577
	speed: 0.0206s/iter; left time: 195.0662s
	iters: 300, epoch: 4 | loss: 0.2245360
	speed: 0.0205s/iter; left time: 192.9650s
	iters: 400, epoch: 4 | loss: 0.3574862
	speed: 0.0206s/iter; left time: 191.3401s
	iters: 500, epoch: 4 | loss: 0.1559734
	speed: 0.0206s/iter; left time: 189.3548s
Epoch: 4 cost time: 12.026291370391846
Epoch: 4, Steps: 570 | Train Loss: 0.2141289 Vali Loss: 0.0525933 Test Loss: 0.1570989
Validation loss decreased (0.057892 --> 0.052593).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2645865
	speed: 0.0604s/iter; left time: 544.8922s
	iters: 200, epoch: 5 | loss: 0.1520475
	speed: 0.0206s/iter; left time: 183.6781s
	iters: 300, epoch: 5 | loss: 0.2722298
	speed: 0.0206s/iter; left time: 181.8745s
	iters: 400, epoch: 5 | loss: 0.1904187
	speed: 0.0206s/iter; left time: 179.7611s
	iters: 500, epoch: 5 | loss: 0.1742841
	speed: 0.0206s/iter; left time: 177.6230s
Epoch: 5 cost time: 12.034613132476807
Epoch: 5, Steps: 570 | Train Loss: 0.2028010 Vali Loss: 0.0547308 Test Loss: 0.1611819
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1886413
	speed: 0.0634s/iter; left time: 535.9146s
	iters: 200, epoch: 6 | loss: 0.1966048
	speed: 0.0224s/iter; left time: 187.4126s
	iters: 300, epoch: 6 | loss: 0.2258761
	speed: 0.0224s/iter; left time: 185.1704s
	iters: 400, epoch: 6 | loss: 0.1455501
	speed: 0.0224s/iter; left time: 182.7746s
	iters: 500, epoch: 6 | loss: 0.1332271
	speed: 0.0224s/iter; left time: 180.5211s
Epoch: 6 cost time: 13.00873875617981
Epoch: 6, Steps: 570 | Train Loss: 0.1970484 Vali Loss: 0.0529926 Test Loss: 0.1599962
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1412240
	speed: 0.0619s/iter; left time: 487.9907s
	iters: 200, epoch: 7 | loss: 0.2534088
	speed: 0.0223s/iter; left time: 173.9021s
	iters: 300, epoch: 7 | loss: 0.1858704
	speed: 0.0224s/iter; left time: 171.9238s
	iters: 400, epoch: 7 | loss: 0.1206646
	speed: 0.0214s/iter; left time: 162.5062s
	iters: 500, epoch: 7 | loss: 0.1900481
	speed: 0.0205s/iter; left time: 153.0586s
Epoch: 7 cost time: 12.631507158279419
Epoch: 7, Steps: 570 | Train Loss: 0.1931835 Vali Loss: 0.0528596 Test Loss: 0.1578578
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1573239117860794, mae:0.2550812363624573
>>> MS_Pen LR=1e-3 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3087969
	speed: 0.0320s/iter; left time: 361.7486s
	iters: 200, epoch: 1 | loss: 0.2023722
	speed: 0.0189s/iter; left time: 212.0558s
	iters: 300, epoch: 1 | loss: 0.3101984
	speed: 0.0189s/iter; left time: 209.8748s
	iters: 400, epoch: 1 | loss: 0.3007245
	speed: 0.0189s/iter; left time: 207.8590s
	iters: 500, epoch: 1 | loss: 0.2426887
	speed: 0.0189s/iter; left time: 205.8880s
Epoch: 1 cost time: 12.144327163696289
Epoch: 1, Steps: 570 | Train Loss: 0.2852536 Vali Loss: 0.0603504 Test Loss: 0.1755603
Validation loss decreased (inf --> 0.060350).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1576862
	speed: 0.0605s/iter; left time: 649.0817s
	iters: 200, epoch: 2 | loss: 0.4950549
	speed: 0.0196s/iter; left time: 208.8796s
	iters: 300, epoch: 2 | loss: 0.1697701
	speed: 0.0189s/iter; left time: 198.9814s
	iters: 400, epoch: 2 | loss: 0.1586955
	speed: 0.0189s/iter; left time: 197.0235s
	iters: 500, epoch: 2 | loss: 0.1555874
	speed: 0.0200s/iter; left time: 206.5609s
Epoch: 2 cost time: 11.553744554519653
Epoch: 2, Steps: 570 | Train Loss: 0.2506238 Vali Loss: 0.0575833 Test Loss: 0.1728038
Validation loss decreased (0.060350 --> 0.057583).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1734755
	speed: 0.0618s/iter; left time: 628.1715s
	iters: 200, epoch: 3 | loss: 0.1887215
	speed: 0.0218s/iter; left time: 218.9814s
	iters: 300, epoch: 3 | loss: 0.1704048
	speed: 0.0218s/iter; left time: 216.7370s
	iters: 400, epoch: 3 | loss: 0.2559999
	speed: 0.0204s/iter; left time: 201.1801s
	iters: 500, epoch: 3 | loss: 0.1997102
	speed: 0.0208s/iter; left time: 203.2310s
Epoch: 3 cost time: 12.393635988235474
Epoch: 3, Steps: 570 | Train Loss: 0.2321653 Vali Loss: 0.0551971 Test Loss: 0.1644590
Validation loss decreased (0.057583 --> 0.055197).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1337226
	speed: 0.0582s/iter; left time: 558.1518s
	iters: 200, epoch: 4 | loss: 0.3646896
	speed: 0.0207s/iter; left time: 196.1161s
	iters: 300, epoch: 4 | loss: 0.1183275
	speed: 0.0218s/iter; left time: 204.3189s
	iters: 400, epoch: 4 | loss: 0.2147086
	speed: 0.0218s/iter; left time: 202.1869s
	iters: 500, epoch: 4 | loss: 0.1471406
	speed: 0.0218s/iter; left time: 199.9423s
Epoch: 4 cost time: 12.308001279830933
Epoch: 4, Steps: 570 | Train Loss: 0.2127695 Vali Loss: 0.0560012 Test Loss: 0.1567404
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2098137
	speed: 0.0604s/iter; left time: 545.2164s
	iters: 200, epoch: 5 | loss: 0.2508682
	speed: 0.0217s/iter; left time: 193.2952s
	iters: 300, epoch: 5 | loss: 0.1819888
	speed: 0.0195s/iter; left time: 172.2252s
	iters: 400, epoch: 5 | loss: 0.1926902
	speed: 0.0188s/iter; left time: 164.3214s
	iters: 500, epoch: 5 | loss: 0.1531675
	speed: 0.0189s/iter; left time: 162.6920s
Epoch: 5 cost time: 11.628439664840698
Epoch: 5, Steps: 570 | Train Loss: 0.2027244 Vali Loss: 0.0524904 Test Loss: 0.1513902
Validation loss decreased (0.055197 --> 0.052490).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1431839
	speed: 0.0582s/iter; left time: 492.0510s
	iters: 200, epoch: 6 | loss: 0.2311312
	speed: 0.0190s/iter; left time: 158.8027s
	iters: 300, epoch: 6 | loss: 0.1536578
	speed: 0.0190s/iter; left time: 156.8186s
	iters: 400, epoch: 6 | loss: 0.1346363
	speed: 0.0190s/iter; left time: 154.9742s
	iters: 500, epoch: 6 | loss: 0.2599211
	speed: 0.0190s/iter; left time: 152.9394s
Epoch: 6 cost time: 11.158247947692871
Epoch: 6, Steps: 570 | Train Loss: 0.1937918 Vali Loss: 0.0524468 Test Loss: 0.1501493
Validation loss decreased (0.052490 --> 0.052447).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2242231
	speed: 0.0567s/iter; left time: 446.7100s
	iters: 200, epoch: 7 | loss: 0.2632203
	speed: 0.0189s/iter; left time: 146.8721s
	iters: 300, epoch: 7 | loss: 0.2297078
	speed: 0.0189s/iter; left time: 145.1473s
	iters: 400, epoch: 7 | loss: 0.2037995
	speed: 0.0189s/iter; left time: 143.4120s
	iters: 500, epoch: 7 | loss: 0.1408660
	speed: 0.0189s/iter; left time: 141.4790s
Epoch: 7 cost time: 11.038635730743408
Epoch: 7, Steps: 570 | Train Loss: 0.1881872 Vali Loss: 0.0533011 Test Loss: 0.1496732
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1955065
	speed: 0.0560s/iter; left time: 409.4903s
	iters: 200, epoch: 8 | loss: 0.2417010
	speed: 0.0189s/iter; left time: 136.4888s
	iters: 300, epoch: 8 | loss: 0.2273314
	speed: 0.0189s/iter; left time: 134.6413s
	iters: 400, epoch: 8 | loss: 0.1722609
	speed: 0.0189s/iter; left time: 132.5503s
	iters: 500, epoch: 8 | loss: 0.2175039
	speed: 0.0198s/iter; left time: 137.0271s
Epoch: 8 cost time: 11.26373028755188
Epoch: 8, Steps: 570 | Train Loss: 0.1850463 Vali Loss: 0.0526070 Test Loss: 0.1480381
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1406005
	speed: 0.0568s/iter; left time: 382.9944s
	iters: 200, epoch: 9 | loss: 0.1561899
	speed: 0.0188s/iter; left time: 125.1729s
	iters: 300, epoch: 9 | loss: 0.2469154
	speed: 0.0188s/iter; left time: 123.2676s
	iters: 400, epoch: 9 | loss: 0.1618287
	speed: 0.0189s/iter; left time: 121.5693s
	iters: 500, epoch: 9 | loss: 0.1233194
	speed: 0.0189s/iter; left time: 119.7268s
Epoch: 9 cost time: 11.02365493774414
Epoch: 9, Steps: 570 | Train Loss: 0.1827691 Vali Loss: 0.0530058 Test Loss: 0.1488859
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15037868916988373, mae:0.2509215176105499
>>> MS_Pen LR=1e-3 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2124866
	speed: 0.0236s/iter; left time: 266.3616s
	iters: 200, epoch: 1 | loss: 0.2081580
	speed: 0.0119s/iter; left time: 132.9738s
	iters: 300, epoch: 1 | loss: 0.2090941
	speed: 0.0117s/iter; left time: 129.9142s
	iters: 400, epoch: 1 | loss: 0.2336477
	speed: 0.0106s/iter; left time: 116.5477s
	iters: 500, epoch: 1 | loss: 0.1969697
	speed: 0.0106s/iter; left time: 115.8502s
Epoch: 1 cost time: 7.625898122787476
Epoch: 1, Steps: 570 | Train Loss: 0.2443739 Vali Loss: 0.0473542 Test Loss: 0.1506341
Validation loss decreased (inf --> 0.047354).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3527943
	speed: 0.0359s/iter; left time: 385.0505s
	iters: 200, epoch: 2 | loss: 0.3816153
	speed: 0.0106s/iter; left time: 112.3781s
	iters: 300, epoch: 2 | loss: 0.2653393
	speed: 0.0106s/iter; left time: 111.2425s
	iters: 400, epoch: 2 | loss: 0.1867400
	speed: 0.0105s/iter; left time: 109.9959s
	iters: 500, epoch: 2 | loss: 0.2561979
	speed: 0.0105s/iter; left time: 108.6808s
Epoch: 2 cost time: 6.286775588989258
Epoch: 2, Steps: 570 | Train Loss: 0.2427113 Vali Loss: 0.0492863 Test Loss: 0.1456314
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1969703
	speed: 0.0385s/iter; left time: 391.3085s
	iters: 200, epoch: 3 | loss: 0.2466320
	speed: 0.0119s/iter; left time: 119.6767s
	iters: 300, epoch: 3 | loss: 0.1811669
	speed: 0.0119s/iter; left time: 118.3052s
	iters: 400, epoch: 3 | loss: 0.1673429
	speed: 0.0118s/iter; left time: 116.8292s
	iters: 500, epoch: 3 | loss: 0.2313423
	speed: 0.0119s/iter; left time: 115.9611s
Epoch: 3 cost time: 7.076234579086304
Epoch: 3, Steps: 570 | Train Loss: 0.2023829 Vali Loss: 0.0441126 Test Loss: 0.1341744
Validation loss decreased (0.047354 --> 0.044113).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2185833
	speed: 0.0374s/iter; left time: 358.3047s
	iters: 200, epoch: 4 | loss: 0.1136125
	speed: 0.0105s/iter; left time: 99.7920s
	iters: 300, epoch: 4 | loss: 0.1933589
	speed: 0.0106s/iter; left time: 99.0859s
	iters: 400, epoch: 4 | loss: 0.2158227
	speed: 0.0105s/iter; left time: 97.5867s
	iters: 500, epoch: 4 | loss: 0.1614646
	speed: 0.0105s/iter; left time: 96.5932s
Epoch: 4 cost time: 6.286233186721802
Epoch: 4, Steps: 570 | Train Loss: 0.1829580 Vali Loss: 0.0422993 Test Loss: 0.1313419
Validation loss decreased (0.044113 --> 0.042299).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1680698
	speed: 0.0388s/iter; left time: 349.8051s
	iters: 200, epoch: 5 | loss: 0.1431366
	speed: 0.0119s/iter; left time: 106.0045s
	iters: 300, epoch: 5 | loss: 0.0988805
	speed: 0.0116s/iter; left time: 102.0690s
	iters: 400, epoch: 5 | loss: 0.2037376
	speed: 0.0105s/iter; left time: 91.6236s
	iters: 500, epoch: 5 | loss: 0.1634221
	speed: 0.0105s/iter; left time: 90.4190s
Epoch: 5 cost time: 6.647098064422607
Epoch: 5, Steps: 570 | Train Loss: 0.1735005 Vali Loss: 0.0413287 Test Loss: 0.1321486
Validation loss decreased (0.042299 --> 0.041329).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1689074
	speed: 0.0366s/iter; left time: 309.3099s
	iters: 200, epoch: 6 | loss: 0.1076569
	speed: 0.0106s/iter; left time: 88.1081s
	iters: 300, epoch: 6 | loss: 0.2245640
	speed: 0.0106s/iter; left time: 87.0693s
	iters: 400, epoch: 6 | loss: 0.1663792
	speed: 0.0106s/iter; left time: 86.1447s
	iters: 500, epoch: 6 | loss: 0.1656932
	speed: 0.0106s/iter; left time: 85.0033s
Epoch: 6 cost time: 6.327985763549805
Epoch: 6, Steps: 570 | Train Loss: 0.1661600 Vali Loss: 0.0407061 Test Loss: 0.1324717
Validation loss decreased (0.041329 --> 0.040706).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2063399
	speed: 0.0365s/iter; left time: 287.2762s
	iters: 200, epoch: 7 | loss: 0.2191859
	speed: 0.0105s/iter; left time: 81.8000s
	iters: 300, epoch: 7 | loss: 0.1272011
	speed: 0.0105s/iter; left time: 80.4038s
	iters: 400, epoch: 7 | loss: 0.1069944
	speed: 0.0105s/iter; left time: 79.5281s
	iters: 500, epoch: 7 | loss: 0.1225211
	speed: 0.0105s/iter; left time: 78.4704s
Epoch: 7 cost time: 6.285236597061157
Epoch: 7, Steps: 570 | Train Loss: 0.1640662 Vali Loss: 0.0406758 Test Loss: 0.1298965
Validation loss decreased (0.040706 --> 0.040676).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1714862
	speed: 0.0362s/iter; left time: 264.8284s
	iters: 200, epoch: 8 | loss: 0.1438331
	speed: 0.0106s/iter; left time: 76.4029s
	iters: 300, epoch: 8 | loss: 0.1613038
	speed: 0.0105s/iter; left time: 74.8038s
	iters: 400, epoch: 8 | loss: 0.2566692
	speed: 0.0106s/iter; left time: 73.9691s
	iters: 500, epoch: 8 | loss: 0.1199903
	speed: 0.0106s/iter; left time: 72.9334s
Epoch: 8 cost time: 6.303753614425659
Epoch: 8, Steps: 570 | Train Loss: 0.1606365 Vali Loss: 0.0403303 Test Loss: 0.1297301
Validation loss decreased (0.040676 --> 0.040330).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2084617
	speed: 0.0383s/iter; left time: 258.2587s
	iters: 200, epoch: 9 | loss: 0.1454024
	speed: 0.0105s/iter; left time: 69.5315s
	iters: 300, epoch: 9 | loss: 0.0768909
	speed: 0.0105s/iter; left time: 68.7592s
	iters: 400, epoch: 9 | loss: 0.1455752
	speed: 0.0105s/iter; left time: 67.6176s
	iters: 500, epoch: 9 | loss: 0.1347975
	speed: 0.0106s/iter; left time: 67.1416s
Epoch: 9 cost time: 6.279200553894043
Epoch: 9, Steps: 570 | Train Loss: 0.1598784 Vali Loss: 0.0406115 Test Loss: 0.1297631
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1699475
	speed: 0.0364s/iter; left time: 224.7279s
	iters: 200, epoch: 10 | loss: 0.1620558
	speed: 0.0105s/iter; left time: 63.8945s
	iters: 300, epoch: 10 | loss: 0.1389125
	speed: 0.0106s/iter; left time: 63.0373s
	iters: 400, epoch: 10 | loss: 0.1343831
	speed: 0.0105s/iter; left time: 61.9038s
	iters: 500, epoch: 10 | loss: 0.1976606
	speed: 0.0106s/iter; left time: 61.0476s
Epoch: 10 cost time: 6.292518854141235
Epoch: 10, Steps: 570 | Train Loss: 0.1586684 Vali Loss: 0.0402411 Test Loss: 0.1297162
Validation loss decreased (0.040330 --> 0.040241).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1751050
	speed: 0.0363s/iter; left time: 203.1595s
	iters: 200, epoch: 11 | loss: 0.1354931
	speed: 0.0105s/iter; left time: 57.8492s
	iters: 300, epoch: 11 | loss: 0.1108917
	speed: 0.0105s/iter; left time: 56.8805s
	iters: 400, epoch: 11 | loss: 0.1852910
	speed: 0.0106s/iter; left time: 56.0494s
	iters: 500, epoch: 11 | loss: 0.1377432
	speed: 0.0105s/iter; left time: 54.8620s
Epoch: 11 cost time: 6.306199789047241
Epoch: 11, Steps: 570 | Train Loss: 0.1596464 Vali Loss: 0.0401144 Test Loss: 0.1295632
Validation loss decreased (0.040241 --> 0.040114).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1914298
	speed: 0.0362s/iter; left time: 182.1971s
	iters: 200, epoch: 12 | loss: 0.1483482
	speed: 0.0105s/iter; left time: 51.9827s
	iters: 300, epoch: 12 | loss: 0.1193140
	speed: 0.0105s/iter; left time: 50.8942s
	iters: 400, epoch: 12 | loss: 0.1424914
	speed: 0.0105s/iter; left time: 49.8148s
	iters: 500, epoch: 12 | loss: 0.2098823
	speed: 0.0105s/iter; left time: 48.7964s
Epoch: 12 cost time: 6.3142383098602295
Epoch: 12, Steps: 570 | Train Loss: 0.1590734 Vali Loss: 0.0402980 Test Loss: 0.1295617
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.0659715
	speed: 0.0361s/iter; left time: 161.2194s
	iters: 200, epoch: 13 | loss: 0.1786089
	speed: 0.0105s/iter; left time: 45.8317s
	iters: 300, epoch: 13 | loss: 0.1165826
	speed: 0.0105s/iter; left time: 44.9035s
	iters: 400, epoch: 13 | loss: 0.1500314
	speed: 0.0105s/iter; left time: 43.8354s
	iters: 500, epoch: 13 | loss: 0.1713581
	speed: 0.0105s/iter; left time: 42.7055s
Epoch: 13 cost time: 6.297241449356079
Epoch: 13, Steps: 570 | Train Loss: 0.1583987 Vali Loss: 0.0402601 Test Loss: 0.1296035
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1148220
	speed: 0.0372s/iter; left time: 144.6174s
	iters: 200, epoch: 14 | loss: 0.1483257
	speed: 0.0105s/iter; left time: 39.8249s
	iters: 300, epoch: 14 | loss: 0.1714469
	speed: 0.0105s/iter; left time: 38.7705s
	iters: 400, epoch: 14 | loss: 0.2306710
	speed: 0.0105s/iter; left time: 37.7075s
	iters: 500, epoch: 14 | loss: 0.1327972
	speed: 0.0105s/iter; left time: 36.6421s
Epoch: 14 cost time: 6.27630352973938
Epoch: 14, Steps: 570 | Train Loss: 0.1585831 Vali Loss: 0.0401989 Test Loss: 0.1296244
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12971505522727966, mae:0.22327618300914764
>>> MS_Pen LR=1e-3 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1922944
	speed: 0.0221s/iter; left time: 249.9722s
	iters: 200, epoch: 1 | loss: 0.1946751
	speed: 0.0103s/iter; left time: 115.2441s
	iters: 300, epoch: 1 | loss: 0.2895446
	speed: 0.0103s/iter; left time: 113.8994s
	iters: 400, epoch: 1 | loss: 0.2138427
	speed: 0.0102s/iter; left time: 112.3963s
	iters: 500, epoch: 1 | loss: 0.1732728
	speed: 0.0102s/iter; left time: 111.6206s
Epoch: 1 cost time: 7.083897590637207
Epoch: 1, Steps: 570 | Train Loss: 0.2037329 Vali Loss: 0.0397037 Test Loss: 0.1288965
Validation loss decreased (inf --> 0.039704).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1610800
	speed: 0.0362s/iter; left time: 388.1635s
	iters: 200, epoch: 2 | loss: 0.2057153
	speed: 0.0103s/iter; left time: 109.1621s
	iters: 300, epoch: 2 | loss: 0.1378324
	speed: 0.0103s/iter; left time: 108.4116s
	iters: 400, epoch: 2 | loss: 0.1499633
	speed: 0.0103s/iter; left time: 107.5269s
	iters: 500, epoch: 2 | loss: 0.1774105
	speed: 0.0103s/iter; left time: 106.5456s
Epoch: 2 cost time: 6.181086301803589
Epoch: 2, Steps: 570 | Train Loss: 0.1830745 Vali Loss: 0.0392760 Test Loss: 0.1227310
Validation loss decreased (0.039704 --> 0.039276).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0805140
	speed: 0.0367s/iter; left time: 372.9475s
	iters: 200, epoch: 3 | loss: 0.1431882
	speed: 0.0103s/iter; left time: 103.4788s
	iters: 300, epoch: 3 | loss: 0.3347811
	speed: 0.0103s/iter; left time: 102.6145s
	iters: 400, epoch: 3 | loss: 0.1345760
	speed: 0.0103s/iter; left time: 101.0755s
	iters: 500, epoch: 3 | loss: 0.1258087
	speed: 0.0102s/iter; left time: 99.9837s
Epoch: 3 cost time: 6.163681745529175
Epoch: 3, Steps: 570 | Train Loss: 0.1555655 Vali Loss: 0.0353577 Test Loss: 0.1176465
Validation loss decreased (0.039276 --> 0.035358).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1098096
	speed: 0.0362s/iter; left time: 347.1983s
	iters: 200, epoch: 4 | loss: 0.0986223
	speed: 0.0102s/iter; left time: 97.0105s
	iters: 300, epoch: 4 | loss: 0.0920331
	speed: 0.0102s/iter; left time: 96.2528s
	iters: 400, epoch: 4 | loss: 0.1081699
	speed: 0.0103s/iter; left time: 95.2892s
	iters: 500, epoch: 4 | loss: 0.1651505
	speed: 0.0103s/iter; left time: 94.2589s
Epoch: 4 cost time: 6.13425087928772
Epoch: 4, Steps: 570 | Train Loss: 0.1362491 Vali Loss: 0.0343242 Test Loss: 0.1139490
Validation loss decreased (0.035358 --> 0.034324).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1057010
	speed: 0.0373s/iter; left time: 336.7378s
	iters: 200, epoch: 5 | loss: 0.1736578
	speed: 0.0103s/iter; left time: 91.8743s
	iters: 300, epoch: 5 | loss: 0.1264529
	speed: 0.0103s/iter; left time: 90.5438s
	iters: 400, epoch: 5 | loss: 0.1261605
	speed: 0.0102s/iter; left time: 89.3592s
	iters: 500, epoch: 5 | loss: 0.1336709
	speed: 0.0102s/iter; left time: 88.3176s
Epoch: 5 cost time: 6.1552863121032715
Epoch: 5, Steps: 570 | Train Loss: 0.1254642 Vali Loss: 0.0346379 Test Loss: 0.1166072
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0902153
	speed: 0.0368s/iter; left time: 311.4044s
	iters: 200, epoch: 6 | loss: 0.1782833
	speed: 0.0102s/iter; left time: 85.3715s
	iters: 300, epoch: 6 | loss: 0.1273989
	speed: 0.0102s/iter; left time: 84.1648s
	iters: 400, epoch: 6 | loss: 0.0876294
	speed: 0.0102s/iter; left time: 83.1038s
	iters: 500, epoch: 6 | loss: 0.0817961
	speed: 0.0102s/iter; left time: 82.1189s
Epoch: 6 cost time: 6.109761714935303
Epoch: 6, Steps: 570 | Train Loss: 0.1183125 Vali Loss: 0.0343412 Test Loss: 0.1141889
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1027294
	speed: 0.0358s/iter; left time: 282.4207s
	iters: 200, epoch: 7 | loss: 0.1358264
	speed: 0.0103s/iter; left time: 80.1561s
	iters: 300, epoch: 7 | loss: 0.2221995
	speed: 0.0103s/iter; left time: 79.2522s
	iters: 400, epoch: 7 | loss: 0.1854914
	speed: 0.0103s/iter; left time: 78.3192s
	iters: 500, epoch: 7 | loss: 0.1229748
	speed: 0.0103s/iter; left time: 77.0067s
Epoch: 7 cost time: 6.157487869262695
Epoch: 7, Steps: 570 | Train Loss: 0.1161100 Vali Loss: 0.0342365 Test Loss: 0.1138797
Validation loss decreased (0.034324 --> 0.034236).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1051874
	speed: 0.0363s/iter; left time: 265.2242s
	iters: 200, epoch: 8 | loss: 0.0840929
	speed: 0.0103s/iter; left time: 73.9995s
	iters: 300, epoch: 8 | loss: 0.1026191
	speed: 0.0103s/iter; left time: 72.9571s
	iters: 400, epoch: 8 | loss: 0.1061363
	speed: 0.0102s/iter; left time: 71.6592s
	iters: 500, epoch: 8 | loss: 0.0749193
	speed: 0.0102s/iter; left time: 70.7005s
Epoch: 8 cost time: 6.156512498855591
Epoch: 8, Steps: 570 | Train Loss: 0.1136495 Vali Loss: 0.0341638 Test Loss: 0.1151718
Validation loss decreased (0.034236 --> 0.034164).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1065861
	speed: 0.0364s/iter; left time: 245.5859s
	iters: 200, epoch: 9 | loss: 0.1184810
	speed: 0.0102s/iter; left time: 67.7982s
	iters: 300, epoch: 9 | loss: 0.1071303
	speed: 0.0102s/iter; left time: 67.0244s
	iters: 400, epoch: 9 | loss: 0.1315207
	speed: 0.0103s/iter; left time: 66.0590s
	iters: 500, epoch: 9 | loss: 0.0966823
	speed: 0.0102s/iter; left time: 64.7021s
Epoch: 9 cost time: 6.200044631958008
Epoch: 9, Steps: 570 | Train Loss: 0.1119282 Vali Loss: 0.0342922 Test Loss: 0.1154510
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0865196
	speed: 0.0361s/iter; left time: 222.8246s
	iters: 200, epoch: 10 | loss: 0.1136670
	speed: 0.0102s/iter; left time: 61.6975s
	iters: 300, epoch: 10 | loss: 0.1075284
	speed: 0.0102s/iter; left time: 60.6288s
	iters: 400, epoch: 10 | loss: 0.0865543
	speed: 0.0101s/iter; left time: 59.5808s
	iters: 500, epoch: 10 | loss: 0.0850538
	speed: 0.0101s/iter; left time: 58.5652s
Epoch: 10 cost time: 6.109545946121216
Epoch: 10, Steps: 570 | Train Loss: 0.1125446 Vali Loss: 0.0342799 Test Loss: 0.1157073
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0992889
	speed: 0.0357s/iter; left time: 200.2207s
	iters: 200, epoch: 11 | loss: 0.0991012
	speed: 0.0102s/iter; left time: 56.1483s
	iters: 300, epoch: 11 | loss: 0.1427831
	speed: 0.0102s/iter; left time: 55.1153s
	iters: 400, epoch: 11 | loss: 0.1266070
	speed: 0.0102s/iter; left time: 54.1919s
	iters: 500, epoch: 11 | loss: 0.1079441
	speed: 0.0102s/iter; left time: 53.0257s
Epoch: 11 cost time: 6.1331586837768555
Epoch: 11, Steps: 570 | Train Loss: 0.1105350 Vali Loss: 0.0341526 Test Loss: 0.1155738
Validation loss decreased (0.034164 --> 0.034153).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.0953067
	speed: 0.0378s/iter; left time: 190.1694s
	iters: 200, epoch: 12 | loss: 0.0978816
	speed: 0.0103s/iter; left time: 50.5966s
	iters: 300, epoch: 12 | loss: 0.1041394
	speed: 0.0103s/iter; left time: 49.5654s
	iters: 400, epoch: 12 | loss: 0.1600902
	speed: 0.0102s/iter; left time: 48.3767s
	iters: 500, epoch: 12 | loss: 0.1142657
	speed: 0.0102s/iter; left time: 47.3734s
Epoch: 12 cost time: 6.140884876251221
Epoch: 12, Steps: 570 | Train Loss: 0.1109478 Vali Loss: 0.0342234 Test Loss: 0.1155648
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1215616
	speed: 0.0354s/iter; left time: 157.9180s
	iters: 200, epoch: 13 | loss: 0.1531714
	speed: 0.0103s/iter; left time: 44.9304s
	iters: 300, epoch: 13 | loss: 0.0849335
	speed: 0.0103s/iter; left time: 43.8250s
	iters: 400, epoch: 13 | loss: 0.1213802
	speed: 0.0103s/iter; left time: 42.9129s
	iters: 500, epoch: 13 | loss: 0.1199898
	speed: 0.0103s/iter; left time: 41.8692s
Epoch: 13 cost time: 6.149622201919556
Epoch: 13, Steps: 570 | Train Loss: 0.1114412 Vali Loss: 0.0341175 Test Loss: 0.1155554
Validation loss decreased (0.034153 --> 0.034117).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.0989873
	speed: 0.0381s/iter; left time: 148.2950s
	iters: 200, epoch: 14 | loss: 0.0841193
	speed: 0.0115s/iter; left time: 43.7719s
	iters: 300, epoch: 14 | loss: 0.0873873
	speed: 0.0116s/iter; left time: 42.6668s
	iters: 400, epoch: 14 | loss: 0.1252313
	speed: 0.0115s/iter; left time: 41.4120s
	iters: 500, epoch: 14 | loss: 0.1056054
	speed: 0.0115s/iter; left time: 40.2005s
Epoch: 14 cost time: 6.882970094680786
Epoch: 14, Steps: 570 | Train Loss: 0.1112782 Vali Loss: 0.0342134 Test Loss: 0.1155501
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.0778927
	speed: 0.0365s/iter; left time: 121.3766s
	iters: 200, epoch: 15 | loss: 0.1261667
	speed: 0.0103s/iter; left time: 33.0431s
	iters: 300, epoch: 15 | loss: 0.1310873
	speed: 0.0103s/iter; left time: 32.0173s
	iters: 400, epoch: 15 | loss: 0.1144261
	speed: 0.0103s/iter; left time: 31.0723s
	iters: 500, epoch: 15 | loss: 0.0931881
	speed: 0.0103s/iter; left time: 29.9414s
Epoch: 15 cost time: 6.125542163848877
Epoch: 15, Steps: 570 | Train Loss: 0.1104727 Vali Loss: 0.0341238 Test Loss: 0.1155609
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.1661809
	speed: 0.0356s/iter; left time: 98.0136s
	iters: 200, epoch: 16 | loss: 0.1003752
	speed: 0.0103s/iter; left time: 27.2595s
	iters: 300, epoch: 16 | loss: 0.1333190
	speed: 0.0102s/iter; left time: 26.0459s
	iters: 400, epoch: 16 | loss: 0.1224285
	speed: 0.0102s/iter; left time: 24.9804s
	iters: 500, epoch: 16 | loss: 0.1745756
	speed: 0.0102s/iter; left time: 23.9913s
Epoch: 16 cost time: 6.118609666824341
Epoch: 16, Steps: 570 | Train Loss: 0.1111349 Vali Loss: 0.0341340 Test Loss: 0.1155604
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1156511977314949, mae:0.20733590424060822
>>> MS_Pen LR=1e-3 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2110972
	speed: 0.0222s/iter; left time: 251.3953s
	iters: 200, epoch: 1 | loss: 0.1375355
	speed: 0.0104s/iter; left time: 116.3565s
	iters: 300, epoch: 1 | loss: 0.1843666
	speed: 0.0104s/iter; left time: 115.6462s
	iters: 400, epoch: 1 | loss: 0.1566288
	speed: 0.0104s/iter; left time: 114.2392s
	iters: 500, epoch: 1 | loss: 0.2090071
	speed: 0.0104s/iter; left time: 113.4174s
Epoch: 1 cost time: 7.160529613494873
Epoch: 1, Steps: 570 | Train Loss: 0.2389042 Vali Loss: 0.0509848 Test Loss: 0.1546179
Validation loss decreased (inf --> 0.050985).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2344657
	speed: 0.0368s/iter; left time: 394.6463s
	iters: 200, epoch: 2 | loss: 0.3615655
	speed: 0.0103s/iter; left time: 109.9183s
	iters: 300, epoch: 2 | loss: 0.2034329
	speed: 0.0103s/iter; left time: 108.9691s
	iters: 400, epoch: 2 | loss: 0.2959264
	speed: 0.0104s/iter; left time: 108.1089s
	iters: 500, epoch: 2 | loss: 0.3161413
	speed: 0.0104s/iter; left time: 107.0366s
Epoch: 2 cost time: 6.210773229598999
Epoch: 2, Steps: 570 | Train Loss: 0.2331953 Vali Loss: 0.0463225 Test Loss: 0.1464978
Validation loss decreased (0.050985 --> 0.046322).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1449720
	speed: 0.0377s/iter; left time: 383.5561s
	iters: 200, epoch: 3 | loss: 0.1837749
	speed: 0.0116s/iter; left time: 116.8558s
	iters: 300, epoch: 3 | loss: 0.2854561
	speed: 0.0117s/iter; left time: 116.1678s
	iters: 400, epoch: 3 | loss: 0.1757745
	speed: 0.0109s/iter; left time: 107.6624s
	iters: 500, epoch: 3 | loss: 0.1408072
	speed: 0.0103s/iter; left time: 100.7322s
Epoch: 3 cost time: 6.639986276626587
Epoch: 3, Steps: 570 | Train Loss: 0.2046565 Vali Loss: 0.0427136 Test Loss: 0.1387903
Validation loss decreased (0.046322 --> 0.042714).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1134455
	speed: 0.0359s/iter; left time: 344.5985s
	iters: 200, epoch: 4 | loss: 0.1392319
	speed: 0.0102s/iter; left time: 97.2139s
	iters: 300, epoch: 4 | loss: 0.1285612
	speed: 0.0102s/iter; left time: 95.9281s
	iters: 400, epoch: 4 | loss: 0.2117725
	speed: 0.0102s/iter; left time: 94.9866s
	iters: 500, epoch: 4 | loss: 0.1463621
	speed: 0.0102s/iter; left time: 93.9423s
Epoch: 4 cost time: 6.120197772979736
Epoch: 4, Steps: 570 | Train Loss: 0.1778111 Vali Loss: 0.0422923 Test Loss: 0.1373916
Validation loss decreased (0.042714 --> 0.042292).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1815717
	speed: 0.0361s/iter; left time: 325.9903s
	iters: 200, epoch: 5 | loss: 0.0880035
	speed: 0.0103s/iter; left time: 92.3033s
	iters: 300, epoch: 5 | loss: 0.2096464
	speed: 0.0103s/iter; left time: 91.2311s
	iters: 400, epoch: 5 | loss: 0.1300189
	speed: 0.0103s/iter; left time: 90.1950s
	iters: 500, epoch: 5 | loss: 0.2042760
	speed: 0.0103s/iter; left time: 89.1317s
Epoch: 5 cost time: 6.210375785827637
Epoch: 5, Steps: 570 | Train Loss: 0.1656417 Vali Loss: 0.0409576 Test Loss: 0.1375058
Validation loss decreased (0.042292 --> 0.040958).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1097134
	speed: 0.0382s/iter; left time: 323.1845s
	iters: 200, epoch: 6 | loss: 0.1723037
	speed: 0.0102s/iter; left time: 85.1813s
	iters: 300, epoch: 6 | loss: 0.1191186
	speed: 0.0102s/iter; left time: 84.2123s
	iters: 400, epoch: 6 | loss: 0.1282435
	speed: 0.0102s/iter; left time: 83.2304s
	iters: 500, epoch: 6 | loss: 0.1562344
	speed: 0.0102s/iter; left time: 82.3795s
Epoch: 6 cost time: 6.219232082366943
Epoch: 6, Steps: 570 | Train Loss: 0.1558673 Vali Loss: 0.0397200 Test Loss: 0.1364562
Validation loss decreased (0.040958 --> 0.039720).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1286918
	speed: 0.0369s/iter; left time: 290.9453s
	iters: 200, epoch: 7 | loss: 0.1360803
	speed: 0.0103s/iter; left time: 80.1030s
	iters: 300, epoch: 7 | loss: 0.1248378
	speed: 0.0103s/iter; left time: 79.0518s
	iters: 400, epoch: 7 | loss: 0.0782786
	speed: 0.0103s/iter; left time: 78.0807s
	iters: 500, epoch: 7 | loss: 0.1539550
	speed: 0.0103s/iter; left time: 77.0105s
Epoch: 7 cost time: 6.169837474822998
Epoch: 7, Steps: 570 | Train Loss: 0.1505050 Vali Loss: 0.0403062 Test Loss: 0.1362296
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1079786
	speed: 0.0368s/iter; left time: 269.0646s
	iters: 200, epoch: 8 | loss: 0.1292587
	speed: 0.0102s/iter; left time: 73.7053s
	iters: 300, epoch: 8 | loss: 0.1350319
	speed: 0.0102s/iter; left time: 72.7706s
	iters: 400, epoch: 8 | loss: 0.1803887
	speed: 0.0102s/iter; left time: 71.8047s
	iters: 500, epoch: 8 | loss: 0.1620241
	speed: 0.0102s/iter; left time: 70.7478s
Epoch: 8 cost time: 6.102356433868408
Epoch: 8, Steps: 570 | Train Loss: 0.1474145 Vali Loss: 0.0398436 Test Loss: 0.1363726
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1368096
	speed: 0.0353s/iter; left time: 238.2057s
	iters: 200, epoch: 9 | loss: 0.1821916
	speed: 0.0103s/iter; left time: 68.4627s
	iters: 300, epoch: 9 | loss: 0.1272152
	speed: 0.0104s/iter; left time: 67.7324s
	iters: 400, epoch: 9 | loss: 0.1312700
	speed: 0.0103s/iter; left time: 66.5884s
	iters: 500, epoch: 9 | loss: 0.1610617
	speed: 0.0103s/iter; left time: 65.2523s
Epoch: 9 cost time: 6.145081996917725
Epoch: 9, Steps: 570 | Train Loss: 0.1457193 Vali Loss: 0.0403653 Test Loss: 0.1363470
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13659560680389404, mae:0.23201531171798706
>>> MS_Pen LR=1e-3 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3058389
	speed: 0.0241s/iter; left time: 272.3777s
	iters: 200, epoch: 1 | loss: 0.2664665
	speed: 0.0122s/iter; left time: 136.8722s
	iters: 300, epoch: 1 | loss: 0.1937886
	speed: 0.0130s/iter; left time: 143.8487s
	iters: 400, epoch: 1 | loss: 0.1343950
	speed: 0.0130s/iter; left time: 142.5631s
	iters: 500, epoch: 1 | loss: 0.2776495
	speed: 0.0129s/iter; left time: 140.7779s
Epoch: 1 cost time: 8.478153467178345
Epoch: 1, Steps: 570 | Train Loss: 0.3088316 Vali Loss: 0.0637035 Test Loss: 0.1817283
Validation loss decreased (inf --> 0.063704).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2677446
	speed: 0.0429s/iter; left time: 459.9705s
	iters: 200, epoch: 2 | loss: 0.2310271
	speed: 0.0119s/iter; left time: 126.1117s
	iters: 300, epoch: 2 | loss: 0.2217159
	speed: 0.0119s/iter; left time: 125.1216s
	iters: 400, epoch: 2 | loss: 0.1326933
	speed: 0.0118s/iter; left time: 123.5443s
	iters: 500, epoch: 2 | loss: 0.2720838
	speed: 0.0119s/iter; left time: 122.4626s
Epoch: 2 cost time: 7.100865602493286
Epoch: 2, Steps: 570 | Train Loss: 0.2813938 Vali Loss: 0.0591920 Test Loss: 0.1817312
Validation loss decreased (0.063704 --> 0.059192).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3443232
	speed: 0.0414s/iter; left time: 420.6572s
	iters: 200, epoch: 3 | loss: 0.3071600
	speed: 0.0118s/iter; left time: 118.8502s
	iters: 300, epoch: 3 | loss: 0.1573724
	speed: 0.0118s/iter; left time: 117.9979s
	iters: 400, epoch: 3 | loss: 0.1900348
	speed: 0.0118s/iter; left time: 116.7124s
	iters: 500, epoch: 3 | loss: 0.2233288
	speed: 0.0119s/iter; left time: 115.9289s
Epoch: 3 cost time: 7.060922622680664
Epoch: 3, Steps: 570 | Train Loss: 0.2568078 Vali Loss: 0.0604194 Test Loss: 0.1696175
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1868120
	speed: 0.0388s/iter; left time: 372.2574s
	iters: 200, epoch: 4 | loss: 0.2755578
	speed: 0.0118s/iter; left time: 112.3290s
	iters: 300, epoch: 4 | loss: 0.1685219
	speed: 0.0118s/iter; left time: 110.8677s
	iters: 400, epoch: 4 | loss: 0.1689778
	speed: 0.0118s/iter; left time: 109.8566s
	iters: 500, epoch: 4 | loss: 0.2275651
	speed: 0.0118s/iter; left time: 108.5164s
Epoch: 4 cost time: 7.004931926727295
Epoch: 4, Steps: 570 | Train Loss: 0.2454483 Vali Loss: 0.0540319 Test Loss: 0.1591604
Validation loss decreased (0.059192 --> 0.054032).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1850761
	speed: 0.0390s/iter; left time: 351.7653s
	iters: 200, epoch: 5 | loss: 0.1889029
	speed: 0.0119s/iter; left time: 105.7984s
	iters: 300, epoch: 5 | loss: 0.2725276
	speed: 0.0119s/iter; left time: 104.6336s
	iters: 400, epoch: 5 | loss: 0.2154996
	speed: 0.0119s/iter; left time: 103.3688s
	iters: 500, epoch: 5 | loss: 0.2657468
	speed: 0.0118s/iter; left time: 101.9751s
Epoch: 5 cost time: 7.0598883628845215
Epoch: 5, Steps: 570 | Train Loss: 0.2392605 Vali Loss: 0.0551340 Test Loss: 0.1615252
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2374498
	speed: 0.0387s/iter; left time: 326.8787s
	iters: 200, epoch: 6 | loss: 0.1419885
	speed: 0.0118s/iter; left time: 98.8113s
	iters: 300, epoch: 6 | loss: 0.2413763
	speed: 0.0118s/iter; left time: 97.7010s
	iters: 400, epoch: 6 | loss: 0.2870142
	speed: 0.0118s/iter; left time: 96.4810s
	iters: 500, epoch: 6 | loss: 0.1741587
	speed: 0.0118s/iter; left time: 95.3819s
Epoch: 6 cost time: 7.037943601608276
Epoch: 6, Steps: 570 | Train Loss: 0.2341175 Vali Loss: 0.0529724 Test Loss: 0.1563462
Validation loss decreased (0.054032 --> 0.052972).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3105032
	speed: 0.0389s/iter; left time: 306.8510s
	iters: 200, epoch: 7 | loss: 0.2011037
	speed: 0.0118s/iter; left time: 91.7595s
	iters: 300, epoch: 7 | loss: 0.2152520
	speed: 0.0118s/iter; left time: 90.6328s
	iters: 400, epoch: 7 | loss: 0.1624408
	speed: 0.0118s/iter; left time: 89.4277s
	iters: 500, epoch: 7 | loss: 0.2676790
	speed: 0.0118s/iter; left time: 88.3297s
Epoch: 7 cost time: 7.04282021522522
Epoch: 7, Steps: 570 | Train Loss: 0.2326833 Vali Loss: 0.0528570 Test Loss: 0.1572135
Validation loss decreased (0.052972 --> 0.052857).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1451260
	speed: 0.0402s/iter; left time: 293.6667s
	iters: 200, epoch: 8 | loss: 0.3053848
	speed: 0.0118s/iter; left time: 84.9784s
	iters: 300, epoch: 8 | loss: 0.1771766
	speed: 0.0118s/iter; left time: 83.6791s
	iters: 400, epoch: 8 | loss: 0.1646213
	speed: 0.0118s/iter; left time: 82.6298s
	iters: 500, epoch: 8 | loss: 0.1803764
	speed: 0.0118s/iter; left time: 81.3363s
Epoch: 8 cost time: 7.016737937927246
Epoch: 8, Steps: 570 | Train Loss: 0.2317263 Vali Loss: 0.0529054 Test Loss: 0.1559442
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1688925
	speed: 0.0387s/iter; left time: 261.0477s
	iters: 200, epoch: 9 | loss: 0.1799933
	speed: 0.0119s/iter; left time: 78.8982s
	iters: 300, epoch: 9 | loss: 0.2187222
	speed: 0.0119s/iter; left time: 77.5473s
	iters: 400, epoch: 9 | loss: 0.1532282
	speed: 0.0119s/iter; left time: 76.5568s
	iters: 500, epoch: 9 | loss: 0.2256137
	speed: 0.0119s/iter; left time: 75.2738s
Epoch: 9 cost time: 7.050581216812134
Epoch: 9, Steps: 570 | Train Loss: 0.2316749 Vali Loss: 0.0526446 Test Loss: 0.1556534
Validation loss decreased (0.052857 --> 0.052645).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1936939
	speed: 0.0398s/iter; left time: 245.7015s
	iters: 200, epoch: 10 | loss: 0.2210517
	speed: 0.0119s/iter; left time: 72.3735s
	iters: 300, epoch: 10 | loss: 0.1649834
	speed: 0.0119s/iter; left time: 71.0653s
	iters: 400, epoch: 10 | loss: 0.2642685
	speed: 0.0119s/iter; left time: 69.6182s
	iters: 500, epoch: 10 | loss: 0.3003309
	speed: 0.0118s/iter; left time: 68.2279s
Epoch: 10 cost time: 7.075215101242065
Epoch: 10, Steps: 570 | Train Loss: 0.2301639 Vali Loss: 0.0527574 Test Loss: 0.1555076
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1658002
	speed: 0.0381s/iter; left time: 213.1604s
	iters: 200, epoch: 11 | loss: 0.4148706
	speed: 0.0119s/iter; left time: 65.3031s
	iters: 300, epoch: 11 | loss: 0.2692519
	speed: 0.0118s/iter; left time: 64.0003s
	iters: 400, epoch: 11 | loss: 0.2313099
	speed: 0.0119s/iter; left time: 62.8974s
	iters: 500, epoch: 11 | loss: 0.3785539
	speed: 0.0118s/iter; left time: 61.4082s
Epoch: 11 cost time: 7.031074285507202
Epoch: 11, Steps: 570 | Train Loss: 0.2309016 Vali Loss: 0.0527499 Test Loss: 0.1554818
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2002010
	speed: 0.0384s/iter; left time: 193.1314s
	iters: 200, epoch: 12 | loss: 0.1493347
	speed: 0.0118s/iter; left time: 58.2682s
	iters: 300, epoch: 12 | loss: 0.1686918
	speed: 0.0118s/iter; left time: 57.0432s
	iters: 400, epoch: 12 | loss: 0.1783218
	speed: 0.0118s/iter; left time: 55.9335s
	iters: 500, epoch: 12 | loss: 0.2065969
	speed: 0.0118s/iter; left time: 54.7272s
Epoch: 12 cost time: 7.0417375564575195
Epoch: 12, Steps: 570 | Train Loss: 0.2303478 Vali Loss: 0.0528013 Test Loss: 0.1554430
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15591469407081604, mae:0.2550596296787262
>>> MS_Pen LR=1e-3 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1509071
	speed: 0.0247s/iter; left time: 279.4753s
	iters: 200, epoch: 1 | loss: 0.3212380
	speed: 0.0125s/iter; left time: 140.0436s
	iters: 300, epoch: 1 | loss: 0.1788975
	speed: 0.0125s/iter; left time: 138.4578s
	iters: 400, epoch: 1 | loss: 0.3015900
	speed: 0.0122s/iter; left time: 134.1905s
	iters: 500, epoch: 1 | loss: 0.1719534
	speed: 0.0114s/iter; left time: 124.3712s
Epoch: 1 cost time: 8.17455267906189
Epoch: 1, Steps: 570 | Train Loss: 0.2450132 Vali Loss: 0.0662380 Test Loss: 0.1941232
Validation loss decreased (inf --> 0.066238).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2584324
	speed: 0.0395s/iter; left time: 424.2307s
	iters: 200, epoch: 2 | loss: 0.1814772
	speed: 0.0114s/iter; left time: 121.4921s
	iters: 300, epoch: 2 | loss: 0.2323037
	speed: 0.0114s/iter; left time: 119.9304s
	iters: 400, epoch: 2 | loss: 0.3353382
	speed: 0.0114s/iter; left time: 118.6157s
	iters: 500, epoch: 2 | loss: 0.3974211
	speed: 0.0114s/iter; left time: 117.6253s
Epoch: 2 cost time: 6.844512224197388
Epoch: 2, Steps: 570 | Train Loss: 0.3134646 Vali Loss: 0.0578398 Test Loss: 0.1766284
Validation loss decreased (0.066238 --> 0.057840).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3264505
	speed: 0.0412s/iter; left time: 418.9223s
	iters: 200, epoch: 3 | loss: 0.1324500
	speed: 0.0115s/iter; left time: 115.6567s
	iters: 300, epoch: 3 | loss: 0.2926774
	speed: 0.0115s/iter; left time: 114.2636s
	iters: 400, epoch: 3 | loss: 0.2295270
	speed: 0.0115s/iter; left time: 112.9375s
	iters: 500, epoch: 3 | loss: 0.3189160
	speed: 0.0115s/iter; left time: 111.8435s
Epoch: 3 cost time: 6.8627541065216064
Epoch: 3, Steps: 570 | Train Loss: 0.2650596 Vali Loss: 0.0579850 Test Loss: 0.1755472
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2140042
	speed: 0.0390s/iter; left time: 373.6729s
	iters: 200, epoch: 4 | loss: 0.1896974
	speed: 0.0114s/iter; left time: 108.3839s
	iters: 300, epoch: 4 | loss: 0.1402501
	speed: 0.0114s/iter; left time: 107.2721s
	iters: 400, epoch: 4 | loss: 0.1901198
	speed: 0.0114s/iter; left time: 106.1172s
	iters: 500, epoch: 4 | loss: 0.2566216
	speed: 0.0114s/iter; left time: 105.0324s
Epoch: 4 cost time: 6.805407524108887
Epoch: 4, Steps: 570 | Train Loss: 0.2506612 Vali Loss: 0.0569323 Test Loss: 0.1682628
Validation loss decreased (0.057840 --> 0.056932).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2612424
	speed: 0.0395s/iter; left time: 356.1297s
	iters: 200, epoch: 5 | loss: 0.2046992
	speed: 0.0114s/iter; left time: 101.6584s
	iters: 300, epoch: 5 | loss: 0.3347915
	speed: 0.0114s/iter; left time: 100.4744s
	iters: 400, epoch: 5 | loss: 0.1965661
	speed: 0.0114s/iter; left time: 99.3390s
	iters: 500, epoch: 5 | loss: 0.1952841
	speed: 0.0114s/iter; left time: 98.1934s
Epoch: 5 cost time: 6.821918487548828
Epoch: 5, Steps: 570 | Train Loss: 0.2419564 Vali Loss: 0.0546598 Test Loss: 0.1648123
Validation loss decreased (0.056932 --> 0.054660).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2972511
	speed: 0.0396s/iter; left time: 335.0474s
	iters: 200, epoch: 6 | loss: 0.2470823
	speed: 0.0125s/iter; left time: 104.3170s
	iters: 300, epoch: 6 | loss: 0.1233257
	speed: 0.0125s/iter; left time: 103.0965s
	iters: 400, epoch: 6 | loss: 0.1863891
	speed: 0.0125s/iter; left time: 101.8585s
	iters: 500, epoch: 6 | loss: 0.1870228
	speed: 0.0125s/iter; left time: 100.6188s
Epoch: 6 cost time: 7.439405202865601
Epoch: 6, Steps: 570 | Train Loss: 0.2378196 Vali Loss: 0.0537767 Test Loss: 0.1619261
Validation loss decreased (0.054660 --> 0.053777).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1401359
	speed: 0.0416s/iter; left time: 327.9966s
	iters: 200, epoch: 7 | loss: 0.3585486
	speed: 0.0114s/iter; left time: 88.8251s
	iters: 300, epoch: 7 | loss: 0.2107861
	speed: 0.0114s/iter; left time: 87.7201s
	iters: 400, epoch: 7 | loss: 0.2073438
	speed: 0.0115s/iter; left time: 87.3020s
	iters: 500, epoch: 7 | loss: 0.1669815
	speed: 0.0125s/iter; left time: 93.7061s
Epoch: 7 cost time: 7.045830726623535
Epoch: 7, Steps: 570 | Train Loss: 0.2327031 Vali Loss: 0.0546446 Test Loss: 0.1622165
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1495917
	speed: 0.0392s/iter; left time: 286.2564s
	iters: 200, epoch: 8 | loss: 0.2284452
	speed: 0.0114s/iter; left time: 82.4598s
	iters: 300, epoch: 8 | loss: 0.2288702
	speed: 0.0114s/iter; left time: 81.3391s
	iters: 400, epoch: 8 | loss: 0.2105174
	speed: 0.0114s/iter; left time: 80.2018s
	iters: 500, epoch: 8 | loss: 0.1656700
	speed: 0.0115s/iter; left time: 79.1527s
Epoch: 8 cost time: 6.832677602767944
Epoch: 8, Steps: 570 | Train Loss: 0.2311828 Vali Loss: 0.0544159 Test Loss: 0.1614311
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2959658
	speed: 0.0413s/iter; left time: 278.5523s
	iters: 200, epoch: 9 | loss: 0.1489349
	speed: 0.0124s/iter; left time: 82.5566s
	iters: 300, epoch: 9 | loss: 0.2802715
	speed: 0.0121s/iter; left time: 79.1845s
	iters: 400, epoch: 9 | loss: 0.2312120
	speed: 0.0114s/iter; left time: 73.5023s
	iters: 500, epoch: 9 | loss: 0.3215106
	speed: 0.0114s/iter; left time: 72.3963s
Epoch: 9 cost time: 7.007298946380615
Epoch: 9, Steps: 570 | Train Loss: 0.2304932 Vali Loss: 0.0536649 Test Loss: 0.1605409
Validation loss decreased (0.053777 --> 0.053665).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1618070
	speed: 0.0399s/iter; left time: 246.4427s
	iters: 200, epoch: 10 | loss: 0.2013138
	speed: 0.0115s/iter; left time: 69.5580s
	iters: 300, epoch: 10 | loss: 0.1589930
	speed: 0.0114s/iter; left time: 68.3558s
	iters: 400, epoch: 10 | loss: 0.2224224
	speed: 0.0114s/iter; left time: 67.2179s
	iters: 500, epoch: 10 | loss: 0.3087425
	speed: 0.0114s/iter; left time: 66.0631s
Epoch: 10 cost time: 6.843631982803345
Epoch: 10, Steps: 570 | Train Loss: 0.2298284 Vali Loss: 0.0540152 Test Loss: 0.1607814
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1280895
	speed: 0.0384s/iter; left time: 214.8187s
	iters: 200, epoch: 11 | loss: 0.2343068
	speed: 0.0114s/iter; left time: 62.7229s
	iters: 300, epoch: 11 | loss: 0.2566437
	speed: 0.0114s/iter; left time: 61.5697s
	iters: 400, epoch: 11 | loss: 0.2255944
	speed: 0.0114s/iter; left time: 60.4373s
	iters: 500, epoch: 11 | loss: 0.2900305
	speed: 0.0114s/iter; left time: 59.3829s
Epoch: 11 cost time: 6.837893009185791
Epoch: 11, Steps: 570 | Train Loss: 0.2303184 Vali Loss: 0.0538506 Test Loss: 0.1605150
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1795762
	speed: 0.0391s/iter; left time: 196.5115s
	iters: 200, epoch: 12 | loss: 0.1843097
	speed: 0.0114s/iter; left time: 56.2218s
	iters: 300, epoch: 12 | loss: 0.1601946
	speed: 0.0114s/iter; left time: 55.0858s
	iters: 400, epoch: 12 | loss: 0.2721617
	speed: 0.0114s/iter; left time: 53.9549s
	iters: 500, epoch: 12 | loss: 0.2119157
	speed: 0.0114s/iter; left time: 52.8472s
Epoch: 12 cost time: 6.825995206832886
Epoch: 12, Steps: 570 | Train Loss: 0.2295665 Vali Loss: 0.0539212 Test Loss: 0.1605024
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16079546511173248, mae:0.25814613699913025
>>> MS_Pen LR=1e-3 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2822567
	speed: 0.0223s/iter; left time: 252.0298s
	iters: 200, epoch: 1 | loss: 0.4816814
	speed: 0.0107s/iter; left time: 120.3059s
	iters: 300, epoch: 1 | loss: 0.3951634
	speed: 0.0107s/iter; left time: 118.9810s
	iters: 400, epoch: 1 | loss: 0.4299395
	speed: 0.0107s/iter; left time: 117.8928s
	iters: 500, epoch: 1 | loss: 0.2983114
	speed: 0.0107s/iter; left time: 116.9737s
Epoch: 1 cost time: 7.3231165409088135
Epoch: 1, Steps: 570 | Train Loss: 0.3078520 Vali Loss: 0.0602082 Test Loss: 0.1726341
Validation loss decreased (inf --> 0.060208).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2980622
	speed: 0.0383s/iter; left time: 411.3239s
	iters: 200, epoch: 2 | loss: 0.3044290
	speed: 0.0108s/iter; left time: 115.0483s
	iters: 300, epoch: 2 | loss: 0.1974563
	speed: 0.0108s/iter; left time: 113.8539s
	iters: 400, epoch: 2 | loss: 0.1948259
	speed: 0.0108s/iter; left time: 113.1238s
	iters: 500, epoch: 2 | loss: 0.2634924
	speed: 0.0108s/iter; left time: 111.7914s
Epoch: 2 cost time: 6.492152690887451
Epoch: 2, Steps: 570 | Train Loss: 0.2639416 Vali Loss: 0.0560939 Test Loss: 0.1677561
Validation loss decreased (0.060208 --> 0.056094).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1675811
	speed: 0.0377s/iter; left time: 382.6268s
	iters: 200, epoch: 3 | loss: 0.2119505
	speed: 0.0108s/iter; left time: 108.4330s
	iters: 300, epoch: 3 | loss: 0.2337271
	speed: 0.0108s/iter; left time: 107.2218s
	iters: 400, epoch: 3 | loss: 0.2781934
	speed: 0.0107s/iter; left time: 105.7839s
	iters: 500, epoch: 3 | loss: 0.2063545
	speed: 0.0108s/iter; left time: 105.1131s
Epoch: 3 cost time: 6.421807289123535
Epoch: 3, Steps: 570 | Train Loss: 0.2457383 Vali Loss: 0.0552824 Test Loss: 0.1617023
Validation loss decreased (0.056094 --> 0.055282).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2442012
	speed: 0.0385s/iter; left time: 368.9377s
	iters: 200, epoch: 4 | loss: 0.1150300
	speed: 0.0108s/iter; left time: 102.7665s
	iters: 300, epoch: 4 | loss: 0.2372011
	speed: 0.0109s/iter; left time: 101.9038s
	iters: 400, epoch: 4 | loss: 0.3645364
	speed: 0.0109s/iter; left time: 100.9113s
	iters: 500, epoch: 4 | loss: 0.2735789
	speed: 0.0108s/iter; left time: 99.6840s
Epoch: 4 cost time: 6.475318670272827
Epoch: 4, Steps: 570 | Train Loss: 0.2377449 Vali Loss: 0.0556254 Test Loss: 0.1622950
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2401594
	speed: 0.0375s/iter; left time: 338.6332s
	iters: 200, epoch: 5 | loss: 0.2505141
	speed: 0.0108s/iter; left time: 96.6189s
	iters: 300, epoch: 5 | loss: 0.1827528
	speed: 0.0108s/iter; left time: 95.6474s
	iters: 400, epoch: 5 | loss: 0.1429647
	speed: 0.0108s/iter; left time: 94.6188s
	iters: 500, epoch: 5 | loss: 0.3052420
	speed: 0.0108s/iter; left time: 93.3976s
Epoch: 5 cost time: 6.460405349731445
Epoch: 5, Steps: 570 | Train Loss: 0.2302401 Vali Loss: 0.0528496 Test Loss: 0.1541577
Validation loss decreased (0.055282 --> 0.052850).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1634910
	speed: 0.0383s/iter; left time: 323.2964s
	iters: 200, epoch: 6 | loss: 0.1938904
	speed: 0.0108s/iter; left time: 90.3679s
	iters: 300, epoch: 6 | loss: 0.2250472
	speed: 0.0108s/iter; left time: 89.1355s
	iters: 400, epoch: 6 | loss: 0.2017581
	speed: 0.0108s/iter; left time: 88.1912s
	iters: 500, epoch: 6 | loss: 0.1881468
	speed: 0.0108s/iter; left time: 87.0200s
Epoch: 6 cost time: 6.475929260253906
Epoch: 6, Steps: 570 | Train Loss: 0.2252231 Vali Loss: 0.0534450 Test Loss: 0.1534057
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1708156
	speed: 0.0360s/iter; left time: 283.4475s
	iters: 200, epoch: 7 | loss: 0.1438303
	speed: 0.0109s/iter; left time: 84.9262s
	iters: 300, epoch: 7 | loss: 0.1481089
	speed: 0.0109s/iter; left time: 83.3515s
	iters: 400, epoch: 7 | loss: 0.2082520
	speed: 0.0109s/iter; left time: 82.3375s
	iters: 500, epoch: 7 | loss: 0.1801710
	speed: 0.0109s/iter; left time: 81.3168s
Epoch: 7 cost time: 6.478635549545288
Epoch: 7, Steps: 570 | Train Loss: 0.2211103 Vali Loss: 0.0527321 Test Loss: 0.1534466
Validation loss decreased (0.052850 --> 0.052732).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1511785
	speed: 0.0381s/iter; left time: 278.7062s
	iters: 200, epoch: 8 | loss: 0.2388767
	speed: 0.0108s/iter; left time: 77.9198s
	iters: 300, epoch: 8 | loss: 0.2504897
	speed: 0.0108s/iter; left time: 76.7850s
	iters: 400, epoch: 8 | loss: 0.1956594
	speed: 0.0108s/iter; left time: 75.8601s
	iters: 500, epoch: 8 | loss: 0.1278644
	speed: 0.0108s/iter; left time: 74.6412s
Epoch: 8 cost time: 6.469686269760132
Epoch: 8, Steps: 570 | Train Loss: 0.2187824 Vali Loss: 0.0523988 Test Loss: 0.1517610
Validation loss decreased (0.052732 --> 0.052399).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1298836
	speed: 0.0368s/iter; left time: 247.9404s
	iters: 200, epoch: 9 | loss: 0.1487129
	speed: 0.0108s/iter; left time: 71.9800s
	iters: 300, epoch: 9 | loss: 0.2670879
	speed: 0.0108s/iter; left time: 70.6761s
	iters: 400, epoch: 9 | loss: 0.2836670
	speed: 0.0108s/iter; left time: 69.6652s
	iters: 500, epoch: 9 | loss: 0.1261092
	speed: 0.0108s/iter; left time: 68.5952s
Epoch: 9 cost time: 6.47120475769043
Epoch: 9, Steps: 570 | Train Loss: 0.2177757 Vali Loss: 0.0525436 Test Loss: 0.1515953
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2492788
	speed: 0.0367s/iter; left time: 226.2704s
	iters: 200, epoch: 10 | loss: 0.1100784
	speed: 0.0108s/iter; left time: 65.5205s
	iters: 300, epoch: 10 | loss: 0.2642111
	speed: 0.0108s/iter; left time: 64.4344s
	iters: 400, epoch: 10 | loss: 0.1505756
	speed: 0.0108s/iter; left time: 63.4418s
	iters: 500, epoch: 10 | loss: 0.2429055
	speed: 0.0108s/iter; left time: 62.2680s
Epoch: 10 cost time: 6.408429145812988
Epoch: 10, Steps: 570 | Train Loss: 0.2174477 Vali Loss: 0.0528041 Test Loss: 0.1515952
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1647820
	speed: 0.0357s/iter; left time: 199.9154s
	iters: 200, epoch: 11 | loss: 0.2234276
	speed: 0.0108s/iter; left time: 59.4010s
	iters: 300, epoch: 11 | loss: 0.2081616
	speed: 0.0108s/iter; left time: 58.3371s
	iters: 400, epoch: 11 | loss: 0.1634420
	speed: 0.0108s/iter; left time: 57.2489s
	iters: 500, epoch: 11 | loss: 0.1616266
	speed: 0.0108s/iter; left time: 56.1216s
Epoch: 11 cost time: 6.436634302139282
Epoch: 11, Steps: 570 | Train Loss: 0.2173352 Vali Loss: 0.0526544 Test Loss: 0.1517539
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1519872099161148, mae:0.2501361072063446
>>> MS_Pen LR=1e-3 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1843760
	speed: 0.0282s/iter; left time: 318.1877s
	iters: 200, epoch: 1 | loss: 0.1822767
	speed: 0.0163s/iter; left time: 182.4013s
	iters: 300, epoch: 1 | loss: 0.3680701
	speed: 0.0163s/iter; left time: 180.4354s
	iters: 400, epoch: 1 | loss: 0.2591729
	speed: 0.0162s/iter; left time: 178.0781s
	iters: 500, epoch: 1 | loss: 0.1609499
	speed: 0.0146s/iter; left time: 158.7645s
Epoch: 1 cost time: 10.214034795761108
Epoch: 1, Steps: 570 | Train Loss: 0.2511844 Vali Loss: 0.0589159 Test Loss: 0.1685453
Validation loss decreased (inf --> 0.058916).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2733735
	speed: 0.0480s/iter; left time: 515.2533s
	iters: 200, epoch: 2 | loss: 0.2321686
	speed: 0.0145s/iter; left time: 153.9566s
	iters: 300, epoch: 2 | loss: 0.2336049
	speed: 0.0145s/iter; left time: 152.4377s
	iters: 400, epoch: 2 | loss: 0.1893339
	speed: 0.0145s/iter; left time: 150.9421s
	iters: 500, epoch: 2 | loss: 0.3495924
	speed: 0.0144s/iter; left time: 148.9841s
Epoch: 2 cost time: 8.575408458709717
Epoch: 2, Steps: 570 | Train Loss: 0.2617514 Vali Loss: 0.0591907 Test Loss: 0.1677899
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3792908
	speed: 0.0454s/iter; left time: 460.9359s
	iters: 200, epoch: 3 | loss: 0.2742902
	speed: 0.0146s/iter; left time: 146.9678s
	iters: 300, epoch: 3 | loss: 0.1260097
	speed: 0.0146s/iter; left time: 145.4668s
	iters: 400, epoch: 3 | loss: 0.1993733
	speed: 0.0146s/iter; left time: 144.2146s
	iters: 500, epoch: 3 | loss: 0.2234380
	speed: 0.0146s/iter; left time: 142.6009s
Epoch: 3 cost time: 8.609439134597778
Epoch: 3, Steps: 570 | Train Loss: 0.2409582 Vali Loss: 0.0586107 Test Loss: 0.1595254
Validation loss decreased (0.058916 --> 0.058611).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1893520
	speed: 0.0462s/iter; left time: 442.9785s
	iters: 200, epoch: 4 | loss: 0.1972208
	speed: 0.0144s/iter; left time: 136.7021s
	iters: 300, epoch: 4 | loss: 0.2335220
	speed: 0.0144s/iter; left time: 135.2647s
	iters: 400, epoch: 4 | loss: 0.2347302
	speed: 0.0144s/iter; left time: 133.8715s
	iters: 500, epoch: 4 | loss: 0.2468700
	speed: 0.0144s/iter; left time: 132.4692s
Epoch: 4 cost time: 8.514348983764648
Epoch: 4, Steps: 570 | Train Loss: 0.2258104 Vali Loss: 0.0540716 Test Loss: 0.1568075
Validation loss decreased (0.058611 --> 0.054072).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2009428
	speed: 0.0473s/iter; left time: 426.7413s
	iters: 200, epoch: 5 | loss: 0.1783671
	speed: 0.0146s/iter; left time: 129.8555s
	iters: 300, epoch: 5 | loss: 0.1392120
	speed: 0.0145s/iter; left time: 128.3068s
	iters: 400, epoch: 5 | loss: 0.2260881
	speed: 0.0145s/iter; left time: 126.8586s
	iters: 500, epoch: 5 | loss: 0.1927846
	speed: 0.0145s/iter; left time: 125.4194s
Epoch: 5 cost time: 8.608092308044434
Epoch: 5, Steps: 570 | Train Loss: 0.2123332 Vali Loss: 0.0542340 Test Loss: 0.1531625
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1433442
	speed: 0.0459s/iter; left time: 388.1870s
	iters: 200, epoch: 6 | loss: 0.1920369
	speed: 0.0143s/iter; left time: 119.5320s
	iters: 300, epoch: 6 | loss: 0.1630902
	speed: 0.0143s/iter; left time: 118.1145s
	iters: 400, epoch: 6 | loss: 0.1414170
	speed: 0.0143s/iter; left time: 116.6592s
	iters: 500, epoch: 6 | loss: 0.2374915
	speed: 0.0143s/iter; left time: 115.3286s
Epoch: 6 cost time: 8.426842451095581
Epoch: 6, Steps: 570 | Train Loss: 0.2048397 Vali Loss: 0.0532543 Test Loss: 0.1520357
Validation loss decreased (0.054072 --> 0.053254).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1616761
	speed: 0.0459s/iter; left time: 361.3898s
	iters: 200, epoch: 7 | loss: 0.1468818
	speed: 0.0143s/iter; left time: 111.6399s
	iters: 300, epoch: 7 | loss: 0.2503196
	speed: 0.0144s/iter; left time: 110.2228s
	iters: 400, epoch: 7 | loss: 0.2018163
	speed: 0.0143s/iter; left time: 108.7666s
	iters: 500, epoch: 7 | loss: 0.2737740
	speed: 0.0143s/iter; left time: 107.2980s
Epoch: 7 cost time: 8.486557722091675
Epoch: 7, Steps: 570 | Train Loss: 0.2010495 Vali Loss: 0.0536814 Test Loss: 0.1516130
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2994906
	speed: 0.0471s/iter; left time: 344.5854s
	iters: 200, epoch: 8 | loss: 0.2195136
	speed: 0.0144s/iter; left time: 103.4852s
	iters: 300, epoch: 8 | loss: 0.2822881
	speed: 0.0144s/iter; left time: 102.0843s
	iters: 400, epoch: 8 | loss: 0.1445384
	speed: 0.0144s/iter; left time: 100.6718s
	iters: 500, epoch: 8 | loss: 0.2040666
	speed: 0.0144s/iter; left time: 99.1848s
Epoch: 8 cost time: 8.450117349624634
Epoch: 8, Steps: 570 | Train Loss: 0.1995782 Vali Loss: 0.0539325 Test Loss: 0.1513493
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3033283
	speed: 0.0478s/iter; left time: 322.2775s
	iters: 200, epoch: 9 | loss: 0.1987993
	speed: 0.0144s/iter; left time: 95.5044s
	iters: 300, epoch: 9 | loss: 0.3270931
	speed: 0.0144s/iter; left time: 94.0332s
	iters: 400, epoch: 9 | loss: 0.2105863
	speed: 0.0144s/iter; left time: 92.7135s
	iters: 500, epoch: 9 | loss: 0.1528385
	speed: 0.0144s/iter; left time: 91.1535s
Epoch: 9 cost time: 8.49717926979065
Epoch: 9, Steps: 570 | Train Loss: 0.1970950 Vali Loss: 0.0540113 Test Loss: 0.1509235
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15224704146385193, mae:0.251373291015625
>>> MS_Pen LR=1e-3 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3636178
	speed: 0.0262s/iter; left time: 295.6674s
	iters: 200, epoch: 1 | loss: 0.2081058
	speed: 0.0143s/iter; left time: 160.3109s
	iters: 300, epoch: 1 | loss: 0.1317699
	speed: 0.0143s/iter; left time: 158.5048s
	iters: 400, epoch: 1 | loss: 0.3089321
	speed: 0.0142s/iter; left time: 156.3829s
	iters: 500, epoch: 1 | loss: 0.2146003
	speed: 0.0142s/iter; left time: 155.2648s
Epoch: 1 cost time: 9.371448993682861
Epoch: 1, Steps: 570 | Train Loss: 0.2227917 Vali Loss: 0.0468780 Test Loss: 0.1482131
Validation loss decreased (inf --> 0.046878).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1368866
	speed: 0.0476s/iter; left time: 511.2141s
	iters: 200, epoch: 2 | loss: 0.3101235
	speed: 0.0146s/iter; left time: 155.3695s
	iters: 300, epoch: 2 | loss: 0.1976185
	speed: 0.0142s/iter; left time: 149.6025s
	iters: 400, epoch: 2 | loss: 0.1509847
	speed: 0.0142s/iter; left time: 148.0149s
	iters: 500, epoch: 2 | loss: 0.2299683
	speed: 0.0142s/iter; left time: 146.3034s
Epoch: 2 cost time: 8.618559837341309
Epoch: 2, Steps: 570 | Train Loss: 0.2248750 Vali Loss: 0.0598884 Test Loss: 0.1763400
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2481295
	speed: 0.0455s/iter; left time: 462.7622s
	iters: 200, epoch: 3 | loss: 0.1342225
	speed: 0.0143s/iter; left time: 143.4167s
	iters: 300, epoch: 3 | loss: 0.3169939
	speed: 0.0143s/iter; left time: 142.0959s
	iters: 400, epoch: 3 | loss: 0.1537205
	speed: 0.0143s/iter; left time: 140.7595s
	iters: 500, epoch: 3 | loss: 0.1871113
	speed: 0.0143s/iter; left time: 139.4571s
Epoch: 3 cost time: 8.379609107971191
Epoch: 3, Steps: 570 | Train Loss: 0.2577845 Vali Loss: 0.0542090 Test Loss: 0.1637957
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1911266
	speed: 0.0443s/iter; left time: 424.8054s
	iters: 200, epoch: 4 | loss: 0.2032727
	speed: 0.0142s/iter; left time: 135.0595s
	iters: 300, epoch: 4 | loss: 0.2301635
	speed: 0.0142s/iter; left time: 133.8024s
	iters: 400, epoch: 4 | loss: 0.1981621
	speed: 0.0143s/iter; left time: 132.5207s
	iters: 500, epoch: 4 | loss: 0.1271921
	speed: 0.0143s/iter; left time: 131.0455s
Epoch: 4 cost time: 8.397259950637817
Epoch: 4, Steps: 570 | Train Loss: 0.2392480 Vali Loss: 0.0546601 Test Loss: 0.1575944
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14841753244400024, mae:0.23845058679580688
>>> MS_Pen LR=1e-3 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1394671
	speed: 0.0261s/iter; left time: 294.5638s
	iters: 200, epoch: 1 | loss: 0.3516190
	speed: 0.0143s/iter; left time: 159.9656s
	iters: 300, epoch: 1 | loss: 0.3245022
	speed: 0.0142s/iter; left time: 158.1837s
	iters: 400, epoch: 1 | loss: 0.2682468
	speed: 0.0143s/iter; left time: 156.8673s
	iters: 500, epoch: 1 | loss: 0.3139414
	speed: 0.0143s/iter; left time: 155.4145s
Epoch: 1 cost time: 9.359297513961792
Epoch: 1, Steps: 570 | Train Loss: 0.2581863 Vali Loss: 0.0530587 Test Loss: 0.1631166
Validation loss decreased (inf --> 0.053059).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2206802
	speed: 0.0465s/iter; left time: 498.5190s
	iters: 200, epoch: 2 | loss: 0.1619069
	speed: 0.0144s/iter; left time: 152.8354s
	iters: 300, epoch: 2 | loss: 0.1431248
	speed: 0.0144s/iter; left time: 151.8847s
	iters: 400, epoch: 2 | loss: 0.1601668
	speed: 0.0144s/iter; left time: 150.0769s
	iters: 500, epoch: 2 | loss: 0.3075661
	speed: 0.0144s/iter; left time: 148.3316s
Epoch: 2 cost time: 8.504920244216919
Epoch: 2, Steps: 570 | Train Loss: 0.2437752 Vali Loss: 0.0584469 Test Loss: 0.1708448
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2422423
	speed: 0.0476s/iter; left time: 484.1693s
	iters: 200, epoch: 3 | loss: 0.2782323
	speed: 0.0143s/iter; left time: 143.9212s
	iters: 300, epoch: 3 | loss: 0.2018352
	speed: 0.0142s/iter; left time: 141.8994s
	iters: 400, epoch: 3 | loss: 0.1859270
	speed: 0.0143s/iter; left time: 140.6611s
	iters: 500, epoch: 3 | loss: 0.2564128
	speed: 0.0143s/iter; left time: 139.6653s
Epoch: 3 cost time: 8.437844038009644
Epoch: 3, Steps: 570 | Train Loss: 0.2322582 Vali Loss: 0.0496809 Test Loss: 0.1449708
Validation loss decreased (0.053059 --> 0.049681).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2497228
	speed: 0.0462s/iter; left time: 443.5523s
	iters: 200, epoch: 4 | loss: 0.2251240
	speed: 0.0142s/iter; left time: 135.1558s
	iters: 300, epoch: 4 | loss: 0.2463627
	speed: 0.0142s/iter; left time: 133.5626s
	iters: 400, epoch: 4 | loss: 0.1906769
	speed: 0.0142s/iter; left time: 131.6242s
	iters: 500, epoch: 4 | loss: 0.1613968
	speed: 0.0141s/iter; left time: 129.5433s
Epoch: 4 cost time: 8.370611906051636
Epoch: 4, Steps: 570 | Train Loss: 0.2101782 Vali Loss: 0.0481491 Test Loss: 0.1484029
Validation loss decreased (0.049681 --> 0.048149).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1855838
	speed: 0.0471s/iter; left time: 424.5313s
	iters: 200, epoch: 5 | loss: 0.2028966
	speed: 0.0160s/iter; left time: 142.7852s
	iters: 300, epoch: 5 | loss: 0.2152241
	speed: 0.0160s/iter; left time: 141.2974s
	iters: 400, epoch: 5 | loss: 0.2828135
	speed: 0.0160s/iter; left time: 139.2985s
	iters: 500, epoch: 5 | loss: 0.1283661
	speed: 0.0149s/iter; left time: 128.2157s
Epoch: 5 cost time: 9.172804355621338
Epoch: 5, Steps: 570 | Train Loss: 0.1946564 Vali Loss: 0.0450419 Test Loss: 0.1402544
Validation loss decreased (0.048149 --> 0.045042).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2155667
	speed: 0.0484s/iter; left time: 409.2765s
	iters: 200, epoch: 6 | loss: 0.1722564
	speed: 0.0161s/iter; left time: 134.3580s
	iters: 300, epoch: 6 | loss: 0.1046327
	speed: 0.0161s/iter; left time: 133.0371s
	iters: 400, epoch: 6 | loss: 0.1979500
	speed: 0.0161s/iter; left time: 131.2342s
	iters: 500, epoch: 6 | loss: 0.1756997
	speed: 0.0161s/iter; left time: 129.5743s
Epoch: 6 cost time: 9.469298362731934
Epoch: 6, Steps: 570 | Train Loss: 0.1851010 Vali Loss: 0.0431777 Test Loss: 0.1363923
Validation loss decreased (0.045042 --> 0.043178).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2317948
	speed: 0.0464s/iter; left time: 366.0710s
	iters: 200, epoch: 7 | loss: 0.1168500
	speed: 0.0142s/iter; left time: 110.6192s
	iters: 300, epoch: 7 | loss: 0.1326806
	speed: 0.0142s/iter; left time: 109.2147s
	iters: 400, epoch: 7 | loss: 0.2240092
	speed: 0.0142s/iter; left time: 107.9462s
	iters: 500, epoch: 7 | loss: 0.1497772
	speed: 0.0142s/iter; left time: 106.2235s
Epoch: 7 cost time: 8.397447347640991
Epoch: 7, Steps: 570 | Train Loss: 0.1798210 Vali Loss: 0.0428666 Test Loss: 0.1357974
Validation loss decreased (0.043178 --> 0.042867).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1509958
	speed: 0.0471s/iter; left time: 344.3556s
	iters: 200, epoch: 8 | loss: 0.1584049
	speed: 0.0143s/iter; left time: 103.4325s
	iters: 300, epoch: 8 | loss: 0.1472069
	speed: 0.0143s/iter; left time: 101.8914s
	iters: 400, epoch: 8 | loss: 0.1707233
	speed: 0.0143s/iter; left time: 100.1175s
	iters: 500, epoch: 8 | loss: 0.1341079
	speed: 0.0142s/iter; left time: 98.3759s
Epoch: 8 cost time: 8.469220399856567
Epoch: 8, Steps: 570 | Train Loss: 0.1778650 Vali Loss: 0.0433490 Test Loss: 0.1366270
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2271876
	speed: 0.0457s/iter; left time: 308.2509s
	iters: 200, epoch: 9 | loss: 0.1580866
	speed: 0.0142s/iter; left time: 94.6008s
	iters: 300, epoch: 9 | loss: 0.1193574
	speed: 0.0142s/iter; left time: 93.0359s
	iters: 400, epoch: 9 | loss: 0.1367483
	speed: 0.0142s/iter; left time: 91.7087s
	iters: 500, epoch: 9 | loss: 0.1606115
	speed: 0.0142s/iter; left time: 90.1871s
Epoch: 9 cost time: 8.41749119758606
Epoch: 9, Steps: 570 | Train Loss: 0.1753826 Vali Loss: 0.0427448 Test Loss: 0.1358346
Validation loss decreased (0.042867 --> 0.042745).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1848939
	speed: 0.0462s/iter; left time: 285.0987s
	iters: 200, epoch: 10 | loss: 0.1824499
	speed: 0.0142s/iter; left time: 86.0492s
	iters: 300, epoch: 10 | loss: 0.1686908
	speed: 0.0142s/iter; left time: 84.6199s
	iters: 400, epoch: 10 | loss: 0.2237145
	speed: 0.0142s/iter; left time: 83.2458s
	iters: 500, epoch: 10 | loss: 0.1855693
	speed: 0.0142s/iter; left time: 81.8155s
Epoch: 10 cost time: 8.385062217712402
Epoch: 10, Steps: 570 | Train Loss: 0.1745784 Vali Loss: 0.0430438 Test Loss: 0.1360570
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1966806
	speed: 0.0472s/iter; left time: 264.3508s
	iters: 200, epoch: 11 | loss: 0.1774195
	speed: 0.0143s/iter; left time: 78.4554s
	iters: 300, epoch: 11 | loss: 0.1399007
	speed: 0.0142s/iter; left time: 76.9019s
	iters: 400, epoch: 11 | loss: 0.2136167
	speed: 0.0142s/iter; left time: 75.4519s
	iters: 500, epoch: 11 | loss: 0.1611851
	speed: 0.0142s/iter; left time: 73.9640s
Epoch: 11 cost time: 8.387152671813965
Epoch: 11, Steps: 570 | Train Loss: 0.1738270 Vali Loss: 0.0430282 Test Loss: 0.1362670
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1389070
	speed: 0.0472s/iter; left time: 237.4512s
	iters: 200, epoch: 12 | loss: 0.1328546
	speed: 0.0143s/iter; left time: 70.7274s
	iters: 300, epoch: 12 | loss: 0.1759901
	speed: 0.0143s/iter; left time: 69.1874s
	iters: 400, epoch: 12 | loss: 0.1451595
	speed: 0.0143s/iter; left time: 67.7340s
	iters: 500, epoch: 12 | loss: 0.2057342
	speed: 0.0143s/iter; left time: 66.3499s
Epoch: 12 cost time: 8.458002090454102
Epoch: 12, Steps: 570 | Train Loss: 0.1744286 Vali Loss: 0.0428929 Test Loss: 0.1361078
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.136022686958313, mae:0.23678529262542725
>>> MS_Pen LR=1e-3 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3018901
	speed: 0.0306s/iter; left time: 346.0880s
	iters: 200, epoch: 1 | loss: 0.3349977
	speed: 0.0183s/iter; left time: 205.4091s
	iters: 300, epoch: 1 | loss: 0.3091048
	speed: 0.0183s/iter; left time: 203.6220s
	iters: 400, epoch: 1 | loss: 0.3415086
	speed: 0.0183s/iter; left time: 201.5978s
	iters: 500, epoch: 1 | loss: 0.2008106
	speed: 0.0175s/iter; left time: 190.7679s
Epoch: 1 cost time: 11.541097640991211
Epoch: 1, Steps: 570 | Train Loss: 0.3274921 Vali Loss: 0.0627135 Test Loss: 0.1935303
Validation loss decreased (inf --> 0.062714).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3344552
	speed: 0.0525s/iter; left time: 563.6642s
	iters: 200, epoch: 2 | loss: 0.3718872
	speed: 0.0184s/iter; left time: 195.4249s
	iters: 300, epoch: 2 | loss: 0.2729011
	speed: 0.0184s/iter; left time: 193.5664s
	iters: 400, epoch: 2 | loss: 0.2201035
	speed: 0.0184s/iter; left time: 191.4450s
	iters: 500, epoch: 2 | loss: 0.2424858
	speed: 0.0184s/iter; left time: 189.6360s
Epoch: 2 cost time: 10.79852032661438
Epoch: 2, Steps: 570 | Train Loss: 0.2732236 Vali Loss: 0.0579046 Test Loss: 0.1691373
Validation loss decreased (0.062714 --> 0.057905).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2370001
	speed: 0.0518s/iter; left time: 526.1200s
	iters: 200, epoch: 3 | loss: 0.2304877
	speed: 0.0168s/iter; left time: 169.1870s
	iters: 300, epoch: 3 | loss: 0.4226177
	speed: 0.0168s/iter; left time: 167.5030s
	iters: 400, epoch: 3 | loss: 0.1938778
	speed: 0.0169s/iter; left time: 166.6526s
	iters: 500, epoch: 3 | loss: 0.2061315
	speed: 0.0169s/iter; left time: 165.3585s
Epoch: 3 cost time: 9.9170081615448
Epoch: 3, Steps: 570 | Train Loss: 0.2530409 Vali Loss: 0.0588444 Test Loss: 0.1696432
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2571878
	speed: 0.0508s/iter; left time: 486.7910s
	iters: 200, epoch: 4 | loss: 0.2057034
	speed: 0.0169s/iter; left time: 160.0675s
	iters: 300, epoch: 4 | loss: 0.2511749
	speed: 0.0169s/iter; left time: 158.3913s
	iters: 400, epoch: 4 | loss: 0.2938120
	speed: 0.0169s/iter; left time: 156.7168s
	iters: 500, epoch: 4 | loss: 0.2625273
	speed: 0.0169s/iter; left time: 155.0477s
Epoch: 4 cost time: 9.935539245605469
Epoch: 4, Steps: 570 | Train Loss: 0.2388769 Vali Loss: 0.0560308 Test Loss: 0.1627169
Validation loss decreased (0.057905 --> 0.056031).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1273647
	speed: 0.0510s/iter; left time: 459.9471s
	iters: 200, epoch: 5 | loss: 0.2598443
	speed: 0.0168s/iter; left time: 150.2081s
	iters: 300, epoch: 5 | loss: 0.2272685
	speed: 0.0169s/iter; left time: 148.8267s
	iters: 400, epoch: 5 | loss: 0.2615191
	speed: 0.0168s/iter; left time: 146.8710s
	iters: 500, epoch: 5 | loss: 0.1898490
	speed: 0.0168s/iter; left time: 145.1594s
Epoch: 5 cost time: 9.933323383331299
Epoch: 5, Steps: 570 | Train Loss: 0.2283545 Vali Loss: 0.0521093 Test Loss: 0.1528376
Validation loss decreased (0.056031 --> 0.052109).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3240907
	speed: 0.0530s/iter; left time: 447.5318s
	iters: 200, epoch: 6 | loss: 0.2017095
	speed: 0.0169s/iter; left time: 140.7916s
	iters: 300, epoch: 6 | loss: 0.2949613
	speed: 0.0168s/iter; left time: 138.9287s
	iters: 400, epoch: 6 | loss: 0.3176266
	speed: 0.0168s/iter; left time: 137.1395s
	iters: 500, epoch: 6 | loss: 0.1655273
	speed: 0.0168s/iter; left time: 135.5045s
Epoch: 6 cost time: 9.92443585395813
Epoch: 6, Steps: 570 | Train Loss: 0.2231208 Vali Loss: 0.0522348 Test Loss: 0.1539993
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1753174
	speed: 0.0512s/iter; left time: 403.3381s
	iters: 200, epoch: 7 | loss: 0.2271264
	speed: 0.0168s/iter; left time: 131.0171s
	iters: 300, epoch: 7 | loss: 0.2940830
	speed: 0.0169s/iter; left time: 129.5680s
	iters: 400, epoch: 7 | loss: 0.1358085
	speed: 0.0169s/iter; left time: 127.8233s
	iters: 500, epoch: 7 | loss: 0.1636896
	speed: 0.0168s/iter; left time: 125.7760s
Epoch: 7 cost time: 9.905540227890015
Epoch: 7, Steps: 570 | Train Loss: 0.2197555 Vali Loss: 0.0517737 Test Loss: 0.1527362
Validation loss decreased (0.052109 --> 0.051774).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2416624
	speed: 0.0512s/iter; left time: 374.1853s
	iters: 200, epoch: 8 | loss: 0.1726333
	speed: 0.0169s/iter; left time: 122.0699s
	iters: 300, epoch: 8 | loss: 0.2527027
	speed: 0.0169s/iter; left time: 120.3374s
	iters: 400, epoch: 8 | loss: 0.1040150
	speed: 0.0169s/iter; left time: 118.5942s
	iters: 500, epoch: 8 | loss: 0.1540010
	speed: 0.0169s/iter; left time: 116.9163s
Epoch: 8 cost time: 9.929746627807617
Epoch: 8, Steps: 570 | Train Loss: 0.2180057 Vali Loss: 0.0516721 Test Loss: 0.1538509
Validation loss decreased (0.051774 --> 0.051672).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1708689
	speed: 0.0505s/iter; left time: 340.6468s
	iters: 200, epoch: 9 | loss: 0.1775216
	speed: 0.0169s/iter; left time: 112.4464s
	iters: 300, epoch: 9 | loss: 0.2508749
	speed: 0.0169s/iter; left time: 110.6445s
	iters: 400, epoch: 9 | loss: 0.2500526
	speed: 0.0169s/iter; left time: 108.8826s
	iters: 500, epoch: 9 | loss: 0.2603719
	speed: 0.0169s/iter; left time: 107.1578s
Epoch: 9 cost time: 9.951984882354736
Epoch: 9, Steps: 570 | Train Loss: 0.2165081 Vali Loss: 0.0516247 Test Loss: 0.1542085
Validation loss decreased (0.051672 --> 0.051625).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2945718
	speed: 0.0525s/iter; left time: 323.9965s
	iters: 200, epoch: 10 | loss: 0.1094637
	speed: 0.0169s/iter; left time: 102.6369s
	iters: 300, epoch: 10 | loss: 0.3332633
	speed: 0.0169s/iter; left time: 100.9641s
	iters: 400, epoch: 10 | loss: 0.2457056
	speed: 0.0169s/iter; left time: 99.2727s
	iters: 500, epoch: 10 | loss: 0.2014054
	speed: 0.0169s/iter; left time: 97.5664s
Epoch: 10 cost time: 9.964969158172607
Epoch: 10, Steps: 570 | Train Loss: 0.2160146 Vali Loss: 0.0514729 Test Loss: 0.1535854
Validation loss decreased (0.051625 --> 0.051473).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1768478
	speed: 0.0518s/iter; left time: 290.3761s
	iters: 200, epoch: 11 | loss: 0.2917337
	speed: 0.0168s/iter; left time: 92.6439s
	iters: 300, epoch: 11 | loss: 0.1130786
	speed: 0.0168s/iter; left time: 90.9522s
	iters: 400, epoch: 11 | loss: 0.2039293
	speed: 0.0169s/iter; left time: 89.4911s
	iters: 500, epoch: 11 | loss: 0.2977304
	speed: 0.0169s/iter; left time: 87.8506s
Epoch: 11 cost time: 9.935081243515015
Epoch: 11, Steps: 570 | Train Loss: 0.2157329 Vali Loss: 0.0515855 Test Loss: 0.1534776
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2409370
	speed: 0.0500s/iter; left time: 251.6881s
	iters: 200, epoch: 12 | loss: 0.2046191
	speed: 0.0169s/iter; left time: 83.3149s
	iters: 300, epoch: 12 | loss: 0.1590228
	speed: 0.0169s/iter; left time: 81.6506s
	iters: 400, epoch: 12 | loss: 0.2274008
	speed: 0.0169s/iter; left time: 79.9221s
	iters: 500, epoch: 12 | loss: 0.2850357
	speed: 0.0169s/iter; left time: 78.2284s
Epoch: 12 cost time: 9.899158000946045
Epoch: 12, Steps: 570 | Train Loss: 0.2147545 Vali Loss: 0.0513672 Test Loss: 0.1534916
Validation loss decreased (0.051473 --> 0.051367).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2558627
	speed: 0.0537s/iter; left time: 239.4145s
	iters: 200, epoch: 13 | loss: 0.3152080
	speed: 0.0169s/iter; left time: 73.7438s
	iters: 300, epoch: 13 | loss: 0.1992790
	speed: 0.0169s/iter; left time: 71.9123s
	iters: 400, epoch: 13 | loss: 0.1745308
	speed: 0.0169s/iter; left time: 70.2304s
	iters: 500, epoch: 13 | loss: 0.1334305
	speed: 0.0169s/iter; left time: 68.5683s
Epoch: 13 cost time: 9.934594869613647
Epoch: 13, Steps: 570 | Train Loss: 0.2152778 Vali Loss: 0.0514979 Test Loss: 0.1534643
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1998647
	speed: 0.0501s/iter; left time: 195.0943s
	iters: 200, epoch: 14 | loss: 0.1965610
	speed: 0.0169s/iter; left time: 64.1740s
	iters: 300, epoch: 14 | loss: 0.4828618
	speed: 0.0169s/iter; left time: 62.4714s
	iters: 400, epoch: 14 | loss: 0.1411586
	speed: 0.0169s/iter; left time: 60.6188s
	iters: 500, epoch: 14 | loss: 0.1506366
	speed: 0.0169s/iter; left time: 58.8950s
Epoch: 14 cost time: 9.929820537567139
Epoch: 14, Steps: 570 | Train Loss: 0.2151613 Vali Loss: 0.0515730 Test Loss: 0.1534504
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2264612
	speed: 0.0531s/iter; left time: 176.4281s
	iters: 200, epoch: 15 | loss: 0.2077855
	speed: 0.0170s/iter; left time: 54.6433s
	iters: 300, epoch: 15 | loss: 0.2230493
	speed: 0.0169s/iter; left time: 52.8628s
	iters: 400, epoch: 15 | loss: 0.2580161
	speed: 0.0170s/iter; left time: 51.2563s
	iters: 500, epoch: 15 | loss: 0.2116715
	speed: 0.0170s/iter; left time: 49.5693s
Epoch: 15 cost time: 9.961683511734009
Epoch: 15, Steps: 570 | Train Loss: 0.2146142 Vali Loss: 0.0515467 Test Loss: 0.1534416
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15371473133563995, mae:0.24967138469219208
>>> MS_Pen LR=1e-3 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2921556
	speed: 0.0280s/iter; left time: 316.5400s
	iters: 200, epoch: 1 | loss: 0.1760252
	speed: 0.0163s/iter; left time: 182.8753s
	iters: 300, epoch: 1 | loss: 0.4213624
	speed: 0.0163s/iter; left time: 181.1458s
	iters: 400, epoch: 1 | loss: 0.3198061
	speed: 0.0163s/iter; left time: 179.6905s
	iters: 500, epoch: 1 | loss: 0.1544090
	speed: 0.0163s/iter; left time: 177.9540s
Epoch: 1 cost time: 10.53492259979248
Epoch: 1, Steps: 570 | Train Loss: 0.3227123 Vali Loss: 0.0600006 Test Loss: 0.1763321
Validation loss decreased (inf --> 0.060001).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2571904
	speed: 0.0521s/iter; left time: 559.0355s
	iters: 200, epoch: 2 | loss: 0.1995481
	speed: 0.0164s/iter; left time: 174.6925s
	iters: 300, epoch: 2 | loss: 0.3448341
	speed: 0.0164s/iter; left time: 172.9182s
	iters: 400, epoch: 2 | loss: 0.3028793
	speed: 0.0164s/iter; left time: 171.0893s
	iters: 500, epoch: 2 | loss: 0.2266126
	speed: 0.0164s/iter; left time: 169.8484s
Epoch: 2 cost time: 9.661035776138306
Epoch: 2, Steps: 570 | Train Loss: 0.2758758 Vali Loss: 0.0608297 Test Loss: 0.1712213
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2388651
	speed: 0.0493s/iter; left time: 501.1858s
	iters: 200, epoch: 3 | loss: 0.2581382
	speed: 0.0175s/iter; left time: 175.5961s
	iters: 300, epoch: 3 | loss: 0.1635271
	speed: 0.0178s/iter; left time: 177.5662s
	iters: 400, epoch: 3 | loss: 0.2677785
	speed: 0.0179s/iter; left time: 176.0261s
	iters: 500, epoch: 3 | loss: 0.1697057
	speed: 0.0178s/iter; left time: 174.0660s
Epoch: 3 cost time: 10.29698657989502
Epoch: 3, Steps: 570 | Train Loss: 0.2496348 Vali Loss: 0.0587974 Test Loss: 0.1693519
Validation loss decreased (0.060001 --> 0.058797).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1899102
	speed: 0.0507s/iter; left time: 486.3198s
	iters: 200, epoch: 4 | loss: 0.4333566
	speed: 0.0163s/iter; left time: 155.0951s
	iters: 300, epoch: 4 | loss: 0.2637576
	speed: 0.0164s/iter; left time: 153.5634s
	iters: 400, epoch: 4 | loss: 0.1771550
	speed: 0.0163s/iter; left time: 151.8921s
	iters: 500, epoch: 4 | loss: 0.3372101
	speed: 0.0164s/iter; left time: 150.2976s
Epoch: 4 cost time: 9.623016357421875
Epoch: 4, Steps: 570 | Train Loss: 0.2392605 Vali Loss: 0.0575851 Test Loss: 0.1649909
Validation loss decreased (0.058797 --> 0.057585).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2291822
	speed: 0.0498s/iter; left time: 449.5812s
	iters: 200, epoch: 5 | loss: 0.3507197
	speed: 0.0163s/iter; left time: 145.6560s
	iters: 300, epoch: 5 | loss: 0.2514752
	speed: 0.0163s/iter; left time: 143.9678s
	iters: 400, epoch: 5 | loss: 0.1517840
	speed: 0.0163s/iter; left time: 142.0297s
	iters: 500, epoch: 5 | loss: 0.3210300
	speed: 0.0163s/iter; left time: 140.4011s
Epoch: 5 cost time: 9.604145288467407
Epoch: 5, Steps: 570 | Train Loss: 0.2328963 Vali Loss: 0.0555982 Test Loss: 0.1579258
Validation loss decreased (0.057585 --> 0.055598).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2407105
	speed: 0.0506s/iter; left time: 427.7062s
	iters: 200, epoch: 6 | loss: 0.3455437
	speed: 0.0164s/iter; left time: 136.8485s
	iters: 300, epoch: 6 | loss: 0.3734482
	speed: 0.0164s/iter; left time: 135.1020s
	iters: 400, epoch: 6 | loss: 0.2350686
	speed: 0.0164s/iter; left time: 133.5563s
	iters: 500, epoch: 6 | loss: 0.2192478
	speed: 0.0164s/iter; left time: 131.7215s
Epoch: 6 cost time: 9.624942302703857
Epoch: 6, Steps: 570 | Train Loss: 0.2274202 Vali Loss: 0.0533519 Test Loss: 0.1556490
Validation loss decreased (0.055598 --> 0.053352).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2482363
	speed: 0.0497s/iter; left time: 391.5113s
	iters: 200, epoch: 7 | loss: 0.1676116
	speed: 0.0164s/iter; left time: 127.7845s
	iters: 300, epoch: 7 | loss: 0.1691159
	speed: 0.0164s/iter; left time: 126.1735s
	iters: 400, epoch: 7 | loss: 0.2403049
	speed: 0.0164s/iter; left time: 124.5564s
	iters: 500, epoch: 7 | loss: 0.3173589
	speed: 0.0164s/iter; left time: 122.7904s
Epoch: 7 cost time: 9.643287897109985
Epoch: 7, Steps: 570 | Train Loss: 0.2266322 Vali Loss: 0.0543143 Test Loss: 0.1582074
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2081234
	speed: 0.0518s/iter; left time: 378.9702s
	iters: 200, epoch: 8 | loss: 0.2769406
	speed: 0.0178s/iter; left time: 128.6402s
	iters: 300, epoch: 8 | loss: 0.2942861
	speed: 0.0179s/iter; left time: 127.4151s
	iters: 400, epoch: 8 | loss: 0.2459511
	speed: 0.0180s/iter; left time: 125.9168s
	iters: 500, epoch: 8 | loss: 0.2051626
	speed: 0.0180s/iter; left time: 124.1632s
Epoch: 8 cost time: 10.549005031585693
Epoch: 8, Steps: 570 | Train Loss: 0.2236049 Vali Loss: 0.0534606 Test Loss: 0.1551327
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1227740
	speed: 0.0513s/iter; left time: 345.7125s
	iters: 200, epoch: 9 | loss: 0.2153285
	speed: 0.0179s/iter; left time: 118.7613s
	iters: 300, epoch: 9 | loss: 0.1113076
	speed: 0.0179s/iter; left time: 117.0392s
	iters: 400, epoch: 9 | loss: 0.1840621
	speed: 0.0179s/iter; left time: 115.0632s
	iters: 500, epoch: 9 | loss: 0.1186437
	speed: 0.0179s/iter; left time: 113.3586s
Epoch: 9 cost time: 10.484956741333008
Epoch: 9, Steps: 570 | Train Loss: 0.2232058 Vali Loss: 0.0531829 Test Loss: 0.1540438
Validation loss decreased (0.053352 --> 0.053183).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2862321
	speed: 0.0542s/iter; left time: 334.3606s
	iters: 200, epoch: 10 | loss: 0.1943080
	speed: 0.0179s/iter; left time: 108.5467s
	iters: 300, epoch: 10 | loss: 0.1438844
	speed: 0.0179s/iter; left time: 106.6179s
	iters: 400, epoch: 10 | loss: 0.2257206
	speed: 0.0179s/iter; left time: 105.0018s
	iters: 500, epoch: 10 | loss: 0.1526783
	speed: 0.0178s/iter; left time: 102.9530s
Epoch: 10 cost time: 10.459721088409424
Epoch: 10, Steps: 570 | Train Loss: 0.2237485 Vali Loss: 0.0531861 Test Loss: 0.1540904
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1467920
	speed: 0.0510s/iter; left time: 285.5864s
	iters: 200, epoch: 11 | loss: 0.1328296
	speed: 0.0180s/iter; left time: 98.7789s
	iters: 300, epoch: 11 | loss: 0.1514166
	speed: 0.0180s/iter; left time: 97.1954s
	iters: 400, epoch: 11 | loss: 0.2035938
	speed: 0.0180s/iter; left time: 95.2791s
	iters: 500, epoch: 11 | loss: 0.1669180
	speed: 0.0180s/iter; left time: 93.5005s
Epoch: 11 cost time: 10.515505313873291
Epoch: 11, Steps: 570 | Train Loss: 0.2227750 Vali Loss: 0.0532895 Test Loss: 0.1538583
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1183589
	speed: 0.0546s/iter; left time: 274.7244s
	iters: 200, epoch: 12 | loss: 0.2212636
	speed: 0.0172s/iter; left time: 84.7437s
	iters: 300, epoch: 12 | loss: 0.1394235
	speed: 0.0164s/iter; left time: 79.2290s
	iters: 400, epoch: 12 | loss: 0.2351298
	speed: 0.0164s/iter; left time: 77.5392s
	iters: 500, epoch: 12 | loss: 0.3038564
	speed: 0.0164s/iter; left time: 76.0192s
Epoch: 12 cost time: 9.844521284103394
Epoch: 12, Steps: 570 | Train Loss: 0.2227417 Vali Loss: 0.0532593 Test Loss: 0.1537978
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1542830616235733, mae:0.2523057460784912
>>> MS_Pen LR=1e-3 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2980664
	speed: 0.0278s/iter; left time: 313.9158s
	iters: 200, epoch: 1 | loss: 0.3510397
	speed: 0.0156s/iter; left time: 174.9909s
	iters: 300, epoch: 1 | loss: 0.2123677
	speed: 0.0157s/iter; left time: 173.8958s
	iters: 400, epoch: 1 | loss: 0.3633636
	speed: 0.0156s/iter; left time: 172.0267s
	iters: 500, epoch: 1 | loss: 0.5131801
	speed: 0.0157s/iter; left time: 170.9223s
Epoch: 1 cost time: 10.19256854057312
Epoch: 1, Steps: 570 | Train Loss: 0.2912608 Vali Loss: 0.0615144 Test Loss: 0.1728844
Validation loss decreased (inf --> 0.061514).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3275006
	speed: 0.0495s/iter; left time: 531.1487s
	iters: 200, epoch: 2 | loss: 0.1593756
	speed: 0.0156s/iter; left time: 166.1408s
	iters: 300, epoch: 2 | loss: 0.3578725
	speed: 0.0156s/iter; left time: 164.7079s
	iters: 400, epoch: 2 | loss: 0.2710070
	speed: 0.0156s/iter; left time: 162.6557s
	iters: 500, epoch: 2 | loss: 0.3958574
	speed: 0.0156s/iter; left time: 161.1093s
Epoch: 2 cost time: 9.24121618270874
Epoch: 2, Steps: 570 | Train Loss: 0.2862565 Vali Loss: 0.0579125 Test Loss: 0.1795544
Validation loss decreased (0.061514 --> 0.057912).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2399898
	speed: 0.0501s/iter; left time: 509.2393s
	iters: 200, epoch: 3 | loss: 0.1461249
	speed: 0.0156s/iter; left time: 157.3229s
	iters: 300, epoch: 3 | loss: 0.3108455
	speed: 0.0157s/iter; left time: 155.8993s
	iters: 400, epoch: 3 | loss: 0.2739392
	speed: 0.0156s/iter; left time: 154.3055s
	iters: 500, epoch: 3 | loss: 0.2479370
	speed: 0.0156s/iter; left time: 152.4609s
Epoch: 3 cost time: 9.243221759796143
Epoch: 3, Steps: 570 | Train Loss: 0.2581748 Vali Loss: 0.0583892 Test Loss: 0.1740841
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1893972
	speed: 0.0500s/iter; left time: 480.0009s
	iters: 200, epoch: 4 | loss: 0.2543286
	speed: 0.0157s/iter; left time: 148.8710s
	iters: 300, epoch: 4 | loss: 0.3285175
	speed: 0.0157s/iter; left time: 147.3011s
	iters: 400, epoch: 4 | loss: 0.2311570
	speed: 0.0157s/iter; left time: 145.4377s
	iters: 500, epoch: 4 | loss: 0.3185741
	speed: 0.0156s/iter; left time: 143.8315s
Epoch: 4 cost time: 9.265348672866821
Epoch: 4, Steps: 570 | Train Loss: 0.2435879 Vali Loss: 0.0567875 Test Loss: 0.1680340
Validation loss decreased (0.057912 --> 0.056788).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2053465
	speed: 0.0520s/iter; left time: 469.1682s
	iters: 200, epoch: 5 | loss: 0.1766798
	speed: 0.0173s/iter; left time: 153.9906s
	iters: 300, epoch: 5 | loss: 0.2404772
	speed: 0.0173s/iter; left time: 152.2536s
	iters: 400, epoch: 5 | loss: 0.1979766
	speed: 0.0172s/iter; left time: 150.0541s
	iters: 500, epoch: 5 | loss: 0.1375353
	speed: 0.0172s/iter; left time: 148.5548s
Epoch: 5 cost time: 10.170743227005005
Epoch: 5, Steps: 570 | Train Loss: 0.2353507 Vali Loss: 0.0553789 Test Loss: 0.1606733
Validation loss decreased (0.056788 --> 0.055379).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2534267
	speed: 0.0524s/iter; left time: 442.7820s
	iters: 200, epoch: 6 | loss: 0.1721647
	speed: 0.0167s/iter; left time: 139.6883s
	iters: 300, epoch: 6 | loss: 0.1362030
	speed: 0.0167s/iter; left time: 137.5435s
	iters: 400, epoch: 6 | loss: 0.1378944
	speed: 0.0167s/iter; left time: 135.8940s
	iters: 500, epoch: 6 | loss: 0.2192990
	speed: 0.0169s/iter; left time: 135.8985s
Epoch: 6 cost time: 9.942528247833252
Epoch: 6, Steps: 570 | Train Loss: 0.2284118 Vali Loss: 0.0550714 Test Loss: 0.1583570
Validation loss decreased (0.055379 --> 0.055071).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2846545
	speed: 0.0509s/iter; left time: 400.7572s
	iters: 200, epoch: 7 | loss: 0.2214909
	speed: 0.0157s/iter; left time: 122.1983s
	iters: 300, epoch: 7 | loss: 0.1893008
	speed: 0.0157s/iter; left time: 120.3243s
	iters: 400, epoch: 7 | loss: 0.2430053
	speed: 0.0157s/iter; left time: 118.9536s
	iters: 500, epoch: 7 | loss: 0.2406907
	speed: 0.0157s/iter; left time: 117.3221s
Epoch: 7 cost time: 9.24562931060791
Epoch: 7, Steps: 570 | Train Loss: 0.2240531 Vali Loss: 0.0539187 Test Loss: 0.1539739
Validation loss decreased (0.055071 --> 0.053919).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1621722
	speed: 0.0496s/iter; left time: 362.7404s
	iters: 200, epoch: 8 | loss: 0.3038989
	speed: 0.0156s/iter; left time: 112.3257s
	iters: 300, epoch: 8 | loss: 0.1335617
	speed: 0.0156s/iter; left time: 110.7365s
	iters: 400, epoch: 8 | loss: 0.2152738
	speed: 0.0156s/iter; left time: 109.1467s
	iters: 500, epoch: 8 | loss: 0.1535229
	speed: 0.0155s/iter; left time: 107.3578s
Epoch: 8 cost time: 9.191420555114746
Epoch: 8, Steps: 570 | Train Loss: 0.2221113 Vali Loss: 0.0543124 Test Loss: 0.1550025
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2035872
	speed: 0.0491s/iter; left time: 330.7268s
	iters: 200, epoch: 9 | loss: 0.1910059
	speed: 0.0157s/iter; left time: 103.9687s
	iters: 300, epoch: 9 | loss: 0.2166319
	speed: 0.0156s/iter; left time: 102.2643s
	iters: 400, epoch: 9 | loss: 0.1432964
	speed: 0.0157s/iter; left time: 100.8226s
	iters: 500, epoch: 9 | loss: 0.2289405
	speed: 0.0157s/iter; left time: 99.3052s
Epoch: 9 cost time: 9.26292896270752
Epoch: 9, Steps: 570 | Train Loss: 0.2202278 Vali Loss: 0.0541496 Test Loss: 0.1542068
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2359684
	speed: 0.0509s/iter; left time: 313.9315s
	iters: 200, epoch: 10 | loss: 0.2455178
	speed: 0.0172s/iter; left time: 104.4831s
	iters: 300, epoch: 10 | loss: 0.1366039
	speed: 0.0173s/iter; left time: 103.1289s
	iters: 400, epoch: 10 | loss: 0.2370714
	speed: 0.0172s/iter; left time: 101.1326s
	iters: 500, epoch: 10 | loss: 0.2987494
	speed: 0.0172s/iter; left time: 99.5042s
Epoch: 10 cost time: 10.127180814743042
Epoch: 10, Steps: 570 | Train Loss: 0.2219270 Vali Loss: 0.0541005 Test Loss: 0.1538111
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15420560538768768, mae:0.25051793456077576
>>> MS_Pen LR=1e-3 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1999218
	speed: 0.0306s/iter; left time: 345.4811s
	iters: 200, epoch: 1 | loss: 0.2491160
	speed: 0.0187s/iter; left time: 209.2342s
	iters: 300, epoch: 1 | loss: 0.3645742
	speed: 0.0187s/iter; left time: 207.3767s
	iters: 400, epoch: 1 | loss: 0.2960358
	speed: 0.0187s/iter; left time: 206.0387s
	iters: 500, epoch: 1 | loss: 0.1941821
	speed: 0.0187s/iter; left time: 203.9278s
Epoch: 1 cost time: 11.896116971969604
Epoch: 1, Steps: 570 | Train Loss: 0.2550228 Vali Loss: 0.0734902 Test Loss: 0.1976991
Validation loss decreased (inf --> 0.073490).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5131319
	speed: 0.0566s/iter; left time: 607.1212s
	iters: 200, epoch: 2 | loss: 0.2232842
	speed: 0.0187s/iter; left time: 198.9673s
	iters: 300, epoch: 2 | loss: 0.2001598
	speed: 0.0187s/iter; left time: 197.2443s
	iters: 400, epoch: 2 | loss: 0.2836753
	speed: 0.0187s/iter; left time: 195.2111s
	iters: 500, epoch: 2 | loss: 0.2330045
	speed: 0.0187s/iter; left time: 193.1827s
Epoch: 2 cost time: 10.964983701705933
Epoch: 2, Steps: 570 | Train Loss: 0.2761616 Vali Loss: 0.0577331 Test Loss: 0.1726271
Validation loss decreased (0.073490 --> 0.057733).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2062287
	speed: 0.0565s/iter; left time: 573.7117s
	iters: 200, epoch: 3 | loss: 0.1880657
	speed: 0.0186s/iter; left time: 187.0081s
	iters: 300, epoch: 3 | loss: 0.2252209
	speed: 0.0186s/iter; left time: 185.2825s
	iters: 400, epoch: 3 | loss: 0.1789719
	speed: 0.0186s/iter; left time: 183.2961s
	iters: 500, epoch: 3 | loss: 0.2950230
	speed: 0.0186s/iter; left time: 181.5835s
Epoch: 3 cost time: 10.895012140274048
Epoch: 3, Steps: 570 | Train Loss: 0.2519194 Vali Loss: 0.0536444 Test Loss: 0.1604553
Validation loss decreased (0.057733 --> 0.053644).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2658243
	speed: 0.0559s/iter; left time: 536.2478s
	iters: 200, epoch: 4 | loss: 0.2885033
	speed: 0.0186s/iter; left time: 176.3307s
	iters: 300, epoch: 4 | loss: 0.2624967
	speed: 0.0185s/iter; left time: 174.1381s
	iters: 400, epoch: 4 | loss: 0.1334765
	speed: 0.0186s/iter; left time: 172.3749s
	iters: 500, epoch: 4 | loss: 0.2340596
	speed: 0.0185s/iter; left time: 170.4473s
Epoch: 4 cost time: 10.875957250595093
Epoch: 4, Steps: 570 | Train Loss: 0.2365642 Vali Loss: 0.0549625 Test Loss: 0.1563374
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2580525
	speed: 0.0563s/iter; left time: 507.7346s
	iters: 200, epoch: 5 | loss: 0.1804364
	speed: 0.0185s/iter; left time: 165.1103s
	iters: 300, epoch: 5 | loss: 0.1976572
	speed: 0.0185s/iter; left time: 163.2180s
	iters: 400, epoch: 5 | loss: 0.2543549
	speed: 0.0185s/iter; left time: 161.3334s
	iters: 500, epoch: 5 | loss: 0.1898593
	speed: 0.0185s/iter; left time: 159.5451s
Epoch: 5 cost time: 10.817236423492432
Epoch: 5, Steps: 570 | Train Loss: 0.2268639 Vali Loss: 0.0531528 Test Loss: 0.1506206
Validation loss decreased (0.053644 --> 0.053153).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1398694
	speed: 0.0574s/iter; left time: 485.2761s
	iters: 200, epoch: 6 | loss: 0.2386843
	speed: 0.0188s/iter; left time: 156.6151s
	iters: 300, epoch: 6 | loss: 0.1643228
	speed: 0.0187s/iter; left time: 154.6319s
	iters: 400, epoch: 6 | loss: 0.2247228
	speed: 0.0188s/iter; left time: 152.8593s
	iters: 500, epoch: 6 | loss: 0.2492116
	speed: 0.0188s/iter; left time: 151.0260s
Epoch: 6 cost time: 11.149933815002441
Epoch: 6, Steps: 570 | Train Loss: 0.2204209 Vali Loss: 0.0521986 Test Loss: 0.1500294
Validation loss decreased (0.053153 --> 0.052199).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1571538
	speed: 0.0591s/iter; left time: 465.6738s
	iters: 200, epoch: 7 | loss: 0.2818370
	speed: 0.0187s/iter; left time: 145.7904s
	iters: 300, epoch: 7 | loss: 0.1564733
	speed: 0.0187s/iter; left time: 143.7175s
	iters: 400, epoch: 7 | loss: 0.2595518
	speed: 0.0188s/iter; left time: 142.2333s
	iters: 500, epoch: 7 | loss: 0.3444387
	speed: 0.0187s/iter; left time: 139.9846s
Epoch: 7 cost time: 10.966346979141235
Epoch: 7, Steps: 570 | Train Loss: 0.2172753 Vali Loss: 0.0530622 Test Loss: 0.1492774
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2220782
	speed: 0.0573s/iter; left time: 419.0184s
	iters: 200, epoch: 8 | loss: 0.1558035
	speed: 0.0209s/iter; left time: 150.4684s
	iters: 300, epoch: 8 | loss: 0.2141432
	speed: 0.0191s/iter; left time: 136.1210s
	iters: 400, epoch: 8 | loss: 0.2705411
	speed: 0.0187s/iter; left time: 131.1083s
	iters: 500, epoch: 8 | loss: 0.1601838
	speed: 0.0186s/iter; left time: 128.6684s
Epoch: 8 cost time: 11.391992807388306
Epoch: 8, Steps: 570 | Train Loss: 0.2158829 Vali Loss: 0.0522193 Test Loss: 0.1489724
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1286265
	speed: 0.0550s/iter; left time: 370.8762s
	iters: 200, epoch: 9 | loss: 0.2930393
	speed: 0.0188s/iter; left time: 124.7817s
	iters: 300, epoch: 9 | loss: 0.0996389
	speed: 0.0188s/iter; left time: 122.7390s
	iters: 400, epoch: 9 | loss: 0.2678416
	speed: 0.0187s/iter; left time: 120.3491s
	iters: 500, epoch: 9 | loss: 0.0947702
	speed: 0.0187s/iter; left time: 118.5530s
Epoch: 9 cost time: 10.918361902236938
Epoch: 9, Steps: 570 | Train Loss: 0.2154806 Vali Loss: 0.0527790 Test Loss: 0.1498014
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.150251105427742, mae:0.248678520321846
>>> MS_Pen LR=1e-3 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.4270716
	speed: 0.0323s/iter; left time: 364.7540s
	iters: 200, epoch: 1 | loss: 0.2580711
	speed: 0.0204s/iter; left time: 228.2579s
	iters: 300, epoch: 1 | loss: 0.2591376
	speed: 0.0183s/iter; left time: 203.2290s
	iters: 400, epoch: 1 | loss: 0.1929723
	speed: 0.0183s/iter; left time: 201.0592s
	iters: 500, epoch: 1 | loss: 0.2998595
	speed: 0.0182s/iter; left time: 198.5431s
Epoch: 1 cost time: 12.07677412033081
Epoch: 1, Steps: 570 | Train Loss: 0.2421146 Vali Loss: 0.0581426 Test Loss: 0.1726043
Validation loss decreased (inf --> 0.058143).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2076776
	speed: 0.0551s/iter; left time: 591.3208s
	iters: 200, epoch: 2 | loss: 0.3377786
	speed: 0.0182s/iter; left time: 193.5790s
	iters: 300, epoch: 2 | loss: 0.4137818
	speed: 0.0182s/iter; left time: 191.8898s
	iters: 400, epoch: 2 | loss: 0.2106422
	speed: 0.0182s/iter; left time: 189.5762s
	iters: 500, epoch: 2 | loss: 0.1930470
	speed: 0.0182s/iter; left time: 187.6436s
Epoch: 2 cost time: 10.67370080947876
Epoch: 2, Steps: 570 | Train Loss: 0.2678901 Vali Loss: 0.0597704 Test Loss: 0.1738723
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1685157
	speed: 0.0583s/iter; left time: 592.8163s
	iters: 200, epoch: 3 | loss: 0.2548809
	speed: 0.0197s/iter; left time: 198.6564s
	iters: 300, epoch: 3 | loss: 0.2118769
	speed: 0.0182s/iter; left time: 181.0281s
	iters: 400, epoch: 3 | loss: 0.1802010
	speed: 0.0183s/iter; left time: 180.1913s
	iters: 500, epoch: 3 | loss: 0.1707870
	speed: 0.0183s/iter; left time: 178.5681s
Epoch: 3 cost time: 11.028301000595093
Epoch: 3, Steps: 570 | Train Loss: 0.2465783 Vali Loss: 0.0555889 Test Loss: 0.1653189
Validation loss decreased (0.058143 --> 0.055589).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2711021
	speed: 0.0577s/iter; left time: 553.3676s
	iters: 200, epoch: 4 | loss: 0.1302969
	speed: 0.0183s/iter; left time: 173.4952s
	iters: 300, epoch: 4 | loss: 0.3315422
	speed: 0.0183s/iter; left time: 171.4057s
	iters: 400, epoch: 4 | loss: 0.1899467
	speed: 0.0183s/iter; left time: 169.7394s
	iters: 500, epoch: 4 | loss: 0.1523945
	speed: 0.0183s/iter; left time: 167.8009s
Epoch: 4 cost time: 10.673715829849243
Epoch: 4, Steps: 570 | Train Loss: 0.2293968 Vali Loss: 0.0553815 Test Loss: 0.1540828
Validation loss decreased (0.055589 --> 0.055382).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2169851
	speed: 0.0566s/iter; left time: 510.5876s
	iters: 200, epoch: 5 | loss: 0.2137706
	speed: 0.0181s/iter; left time: 161.3180s
	iters: 300, epoch: 5 | loss: 0.1828629
	speed: 0.0181s/iter; left time: 159.3598s
	iters: 400, epoch: 5 | loss: 0.1953379
	speed: 0.0181s/iter; left time: 157.5227s
	iters: 500, epoch: 5 | loss: 0.2245048
	speed: 0.0181s/iter; left time: 155.9203s
Epoch: 5 cost time: 10.601192474365234
Epoch: 5, Steps: 570 | Train Loss: 0.2202614 Vali Loss: 0.0530915 Test Loss: 0.1507687
Validation loss decreased (0.055382 --> 0.053091).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2985982
	speed: 0.0553s/iter; left time: 467.2368s
	iters: 200, epoch: 6 | loss: 0.1767443
	speed: 0.0183s/iter; left time: 152.4943s
	iters: 300, epoch: 6 | loss: 0.1998443
	speed: 0.0182s/iter; left time: 149.7905s
	iters: 400, epoch: 6 | loss: 0.1835615
	speed: 0.0180s/iter; left time: 146.9840s
	iters: 500, epoch: 6 | loss: 0.1437964
	speed: 0.0180s/iter; left time: 145.1342s
Epoch: 6 cost time: 10.622596263885498
Epoch: 6, Steps: 570 | Train Loss: 0.2150062 Vali Loss: 0.0525845 Test Loss: 0.1482651
Validation loss decreased (0.053091 --> 0.052585).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1627439
	speed: 0.0580s/iter; left time: 457.0327s
	iters: 200, epoch: 7 | loss: 0.2417117
	speed: 0.0204s/iter; left time: 159.0957s
	iters: 300, epoch: 7 | loss: 0.1503348
	speed: 0.0204s/iter; left time: 156.8628s
	iters: 400, epoch: 7 | loss: 0.2430944
	speed: 0.0204s/iter; left time: 154.7097s
	iters: 500, epoch: 7 | loss: 0.1976367
	speed: 0.0204s/iter; left time: 152.6344s
Epoch: 7 cost time: 11.927543878555298
Epoch: 7, Steps: 570 | Train Loss: 0.2100322 Vali Loss: 0.0527237 Test Loss: 0.1494455
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1562943
	speed: 0.0560s/iter; left time: 409.3556s
	iters: 200, epoch: 8 | loss: 0.1593350
	speed: 0.0183s/iter; left time: 132.0012s
	iters: 300, epoch: 8 | loss: 0.2148328
	speed: 0.0182s/iter; left time: 129.5867s
	iters: 400, epoch: 8 | loss: 0.2384945
	speed: 0.0182s/iter; left time: 127.6578s
	iters: 500, epoch: 8 | loss: 0.2182001
	speed: 0.0182s/iter; left time: 125.6793s
Epoch: 8 cost time: 10.658231496810913
Epoch: 8, Steps: 570 | Train Loss: 0.2082485 Vali Loss: 0.0526468 Test Loss: 0.1492854
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1081508
	speed: 0.0567s/iter; left time: 382.2570s
	iters: 200, epoch: 9 | loss: 0.1506211
	speed: 0.0183s/iter; left time: 121.6148s
	iters: 300, epoch: 9 | loss: 0.2043046
	speed: 0.0183s/iter; left time: 119.5813s
	iters: 400, epoch: 9 | loss: 0.1844241
	speed: 0.0204s/iter; left time: 131.5362s
	iters: 500, epoch: 9 | loss: 0.1600566
	speed: 0.0201s/iter; left time: 127.5573s
Epoch: 9 cost time: 11.210950136184692
Epoch: 9, Steps: 570 | Train Loss: 0.2075549 Vali Loss: 0.0526962 Test Loss: 0.1484779
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14848209917545319, mae:0.2443913370370865
>>> MS_Pen LR=1e-3 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2589697
	speed: 0.0299s/iter; left time: 337.4036s
	iters: 200, epoch: 1 | loss: 0.1810374
	speed: 0.0184s/iter; left time: 206.2124s
	iters: 300, epoch: 1 | loss: 0.3493967
	speed: 0.0184s/iter; left time: 204.5542s
	iters: 400, epoch: 1 | loss: 0.3799431
	speed: 0.0184s/iter; left time: 202.2237s
	iters: 500, epoch: 1 | loss: 0.4410340
	speed: 0.0184s/iter; left time: 200.9806s
Epoch: 1 cost time: 11.692534923553467
Epoch: 1, Steps: 570 | Train Loss: 0.2731163 Vali Loss: 0.0584606 Test Loss: 0.1735353
Validation loss decreased (inf --> 0.058461).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3232612
	speed: 0.0583s/iter; left time: 625.5159s
	iters: 200, epoch: 2 | loss: 0.2886797
	speed: 0.0183s/iter; left time: 194.8789s
	iters: 300, epoch: 2 | loss: 0.4150047
	speed: 0.0183s/iter; left time: 192.7624s
	iters: 400, epoch: 2 | loss: 0.2376847
	speed: 0.0183s/iter; left time: 190.8668s
	iters: 500, epoch: 2 | loss: 0.2204978
	speed: 0.0183s/iter; left time: 188.8875s
Epoch: 2 cost time: 10.72918963432312
Epoch: 2, Steps: 570 | Train Loss: 0.2593711 Vali Loss: 0.0559451 Test Loss: 0.1567160
Validation loss decreased (0.058461 --> 0.055945).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1311535
	speed: 0.0552s/iter; left time: 561.3536s
	iters: 200, epoch: 3 | loss: 0.2415999
	speed: 0.0182s/iter; left time: 183.2930s
	iters: 300, epoch: 3 | loss: 0.2003295
	speed: 0.0183s/iter; left time: 182.2380s
	iters: 400, epoch: 3 | loss: 0.2834609
	speed: 0.0183s/iter; left time: 180.1425s
	iters: 500, epoch: 3 | loss: 0.2709565
	speed: 0.0183s/iter; left time: 178.6781s
Epoch: 3 cost time: 10.686919927597046
Epoch: 3, Steps: 570 | Train Loss: 0.2333384 Vali Loss: 0.0517187 Test Loss: 0.1541077
Validation loss decreased (0.055945 --> 0.051719).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1753390
	speed: 0.0550s/iter; left time: 527.3844s
	iters: 200, epoch: 4 | loss: 0.2129304
	speed: 0.0182s/iter; left time: 172.9898s
	iters: 300, epoch: 4 | loss: 0.1757641
	speed: 0.0183s/iter; left time: 171.4940s
	iters: 400, epoch: 4 | loss: 0.2390345
	speed: 0.0182s/iter; left time: 169.4319s
	iters: 500, epoch: 4 | loss: 0.1475455
	speed: 0.0183s/iter; left time: 167.7874s
Epoch: 4 cost time: 10.666278839111328
Epoch: 4, Steps: 570 | Train Loss: 0.2159650 Vali Loss: 0.0502750 Test Loss: 0.1434910
Validation loss decreased (0.051719 --> 0.050275).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1517927
	speed: 0.0558s/iter; left time: 503.4517s
	iters: 200, epoch: 5 | loss: 0.1793084
	speed: 0.0184s/iter; left time: 163.7967s
	iters: 300, epoch: 5 | loss: 0.1566865
	speed: 0.0183s/iter; left time: 161.6109s
	iters: 400, epoch: 5 | loss: 0.1816232
	speed: 0.0183s/iter; left time: 159.9270s
	iters: 500, epoch: 5 | loss: 0.1339248
	speed: 0.0183s/iter; left time: 157.7612s
Epoch: 5 cost time: 10.742798805236816
Epoch: 5, Steps: 570 | Train Loss: 0.2024780 Vali Loss: 0.0496474 Test Loss: 0.1415492
Validation loss decreased (0.050275 --> 0.049647).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2693816
	speed: 0.0596s/iter; left time: 503.3766s
	iters: 200, epoch: 6 | loss: 0.1579260
	speed: 0.0205s/iter; left time: 171.2491s
	iters: 300, epoch: 6 | loss: 0.3361299
	speed: 0.0204s/iter; left time: 168.3262s
	iters: 400, epoch: 6 | loss: 0.1110185
	speed: 0.0205s/iter; left time: 166.7905s
	iters: 500, epoch: 6 | loss: 0.1741121
	speed: 0.0205s/iter; left time: 164.9481s
Epoch: 6 cost time: 12.000821113586426
Epoch: 6, Steps: 570 | Train Loss: 0.1954663 Vali Loss: 0.0490374 Test Loss: 0.1379651
Validation loss decreased (0.049647 --> 0.049037).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1516480
	speed: 0.0566s/iter; left time: 445.9828s
	iters: 200, epoch: 7 | loss: 0.1617555
	speed: 0.0183s/iter; left time: 142.7640s
	iters: 300, epoch: 7 | loss: 0.1918754
	speed: 0.0183s/iter; left time: 140.9328s
	iters: 400, epoch: 7 | loss: 0.1771417
	speed: 0.0183s/iter; left time: 138.8287s
	iters: 500, epoch: 7 | loss: 0.1390273
	speed: 0.0183s/iter; left time: 136.8905s
Epoch: 7 cost time: 10.747800827026367
Epoch: 7, Steps: 570 | Train Loss: 0.1928610 Vali Loss: 0.0495798 Test Loss: 0.1384462
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1368603
	speed: 0.0570s/iter; left time: 416.5151s
	iters: 200, epoch: 8 | loss: 0.1084811
	speed: 0.0183s/iter; left time: 132.0937s
	iters: 300, epoch: 8 | loss: 0.1802435
	speed: 0.0183s/iter; left time: 130.3682s
	iters: 400, epoch: 8 | loss: 0.2375583
	speed: 0.0183s/iter; left time: 128.4532s
	iters: 500, epoch: 8 | loss: 0.1206949
	speed: 0.0183s/iter; left time: 126.2974s
Epoch: 8 cost time: 10.678046941757202
Epoch: 8, Steps: 570 | Train Loss: 0.1906107 Vali Loss: 0.0491021 Test Loss: 0.1385363
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2750022
	speed: 0.0545s/iter; left time: 367.2444s
	iters: 200, epoch: 9 | loss: 0.2511697
	speed: 0.0182s/iter; left time: 120.6530s
	iters: 300, epoch: 9 | loss: 0.2294180
	speed: 0.0182s/iter; left time: 118.9019s
	iters: 400, epoch: 9 | loss: 0.3661038
	speed: 0.0182s/iter; left time: 116.9203s
	iters: 500, epoch: 9 | loss: 0.1567267
	speed: 0.0181s/iter; left time: 114.9854s
Epoch: 9 cost time: 10.59837555885315
Epoch: 9, Steps: 570 | Train Loss: 0.1884925 Vali Loss: 0.0492663 Test Loss: 0.1381573
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13817141950130463, mae:0.23649495840072632
>>> MS_Pen LR=1e-3 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2565341
	speed: 0.0337s/iter; left time: 380.8506s
	iters: 200, epoch: 1 | loss: 0.3132920
	speed: 0.0219s/iter; left time: 245.7922s
	iters: 300, epoch: 1 | loss: 0.2396938
	speed: 0.0220s/iter; left time: 243.9756s
	iters: 400, epoch: 1 | loss: 0.4252193
	speed: 0.0219s/iter; left time: 241.4269s
	iters: 500, epoch: 1 | loss: 0.3248438
	speed: 0.0220s/iter; left time: 240.2217s
Epoch: 1 cost time: 13.761664867401123
Epoch: 1, Steps: 570 | Train Loss: 0.3239395 Vali Loss: 0.0575431 Test Loss: 0.1767280
Validation loss decreased (inf --> 0.057543).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3117552
	speed: 0.0655s/iter; left time: 703.3413s
	iters: 200, epoch: 2 | loss: 0.2674470
	speed: 0.0220s/iter; left time: 234.0721s
	iters: 300, epoch: 2 | loss: 0.2442129
	speed: 0.0220s/iter; left time: 232.0393s
	iters: 400, epoch: 2 | loss: 0.2924782
	speed: 0.0220s/iter; left time: 229.9547s
	iters: 500, epoch: 2 | loss: 0.2460423
	speed: 0.0220s/iter; left time: 227.5024s
Epoch: 2 cost time: 12.883302927017212
Epoch: 2, Steps: 570 | Train Loss: 0.2764211 Vali Loss: 0.0588776 Test Loss: 0.1757195
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4994050
	speed: 0.0620s/iter; left time: 630.0754s
	iters: 200, epoch: 3 | loss: 0.1838737
	speed: 0.0222s/iter; left time: 223.1050s
	iters: 300, epoch: 3 | loss: 0.2790639
	speed: 0.0222s/iter; left time: 220.8261s
	iters: 400, epoch: 3 | loss: 0.2799931
	speed: 0.0222s/iter; left time: 218.7390s
	iters: 500, epoch: 3 | loss: 0.1674743
	speed: 0.0222s/iter; left time: 216.5161s
Epoch: 3 cost time: 12.908128499984741
Epoch: 3, Steps: 570 | Train Loss: 0.2541381 Vali Loss: 0.0536248 Test Loss: 0.1610261
Validation loss decreased (0.057543 --> 0.053625).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1796732
	speed: 0.0630s/iter; left time: 604.1326s
	iters: 200, epoch: 4 | loss: 0.2409195
	speed: 0.0220s/iter; left time: 208.6984s
	iters: 300, epoch: 4 | loss: 0.3047594
	speed: 0.0220s/iter; left time: 206.5067s
	iters: 400, epoch: 4 | loss: 0.2300758
	speed: 0.0220s/iter; left time: 204.2651s
	iters: 500, epoch: 4 | loss: 0.2921095
	speed: 0.0220s/iter; left time: 201.9867s
Epoch: 4 cost time: 12.856575965881348
Epoch: 4, Steps: 570 | Train Loss: 0.2417666 Vali Loss: 0.0545890 Test Loss: 0.1631500
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2644576
	speed: 0.0610s/iter; left time: 549.9060s
	iters: 200, epoch: 5 | loss: 0.2786416
	speed: 0.0221s/iter; left time: 196.7771s
	iters: 300, epoch: 5 | loss: 0.1826820
	speed: 0.0221s/iter; left time: 194.5844s
	iters: 400, epoch: 5 | loss: 0.1958529
	speed: 0.0221s/iter; left time: 192.4110s
	iters: 500, epoch: 5 | loss: 0.2538501
	speed: 0.0221s/iter; left time: 190.1599s
Epoch: 5 cost time: 12.850232362747192
Epoch: 5, Steps: 570 | Train Loss: 0.2328122 Vali Loss: 0.0504909 Test Loss: 0.1512922
Validation loss decreased (0.053625 --> 0.050491).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2173743
	speed: 0.0656s/iter; left time: 554.0497s
	iters: 200, epoch: 6 | loss: 0.3193439
	speed: 0.0221s/iter; left time: 184.2571s
	iters: 300, epoch: 6 | loss: 0.1974543
	speed: 0.0220s/iter; left time: 181.6057s
	iters: 400, epoch: 6 | loss: 0.1602071
	speed: 0.0220s/iter; left time: 179.4979s
	iters: 500, epoch: 6 | loss: 0.3582432
	speed: 0.0221s/iter; left time: 177.6027s
Epoch: 6 cost time: 12.867464303970337
Epoch: 6, Steps: 570 | Train Loss: 0.2269954 Vali Loss: 0.0511528 Test Loss: 0.1518470
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2924430
	speed: 0.0639s/iter; left time: 503.2985s
	iters: 200, epoch: 7 | loss: 0.2139056
	speed: 0.0221s/iter; left time: 171.9216s
	iters: 300, epoch: 7 | loss: 0.1561231
	speed: 0.0221s/iter; left time: 169.4964s
	iters: 400, epoch: 7 | loss: 0.1696473
	speed: 0.0220s/iter; left time: 167.0875s
	iters: 500, epoch: 7 | loss: 0.2370343
	speed: 0.0221s/iter; left time: 165.2048s
Epoch: 7 cost time: 12.859755992889404
Epoch: 7, Steps: 570 | Train Loss: 0.2225414 Vali Loss: 0.0507426 Test Loss: 0.1487349
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1378464
	speed: 0.0611s/iter; left time: 446.8835s
	iters: 200, epoch: 8 | loss: 0.4550732
	speed: 0.0220s/iter; left time: 158.4199s
	iters: 300, epoch: 8 | loss: 0.1311446
	speed: 0.0221s/iter; left time: 156.7977s
	iters: 400, epoch: 8 | loss: 0.2130164
	speed: 0.0221s/iter; left time: 154.6149s
	iters: 500, epoch: 8 | loss: 0.1937808
	speed: 0.0220s/iter; left time: 152.2263s
Epoch: 8 cost time: 12.830576419830322
Epoch: 8, Steps: 570 | Train Loss: 0.2207914 Vali Loss: 0.0502570 Test Loss: 0.1489352
Validation loss decreased (0.050491 --> 0.050257).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2102027
	speed: 0.0628s/iter; left time: 423.0672s
	iters: 200, epoch: 9 | loss: 0.2005131
	speed: 0.0221s/iter; left time: 147.0060s
	iters: 300, epoch: 9 | loss: 0.4518197
	speed: 0.0221s/iter; left time: 144.8188s
	iters: 400, epoch: 9 | loss: 0.1668310
	speed: 0.0222s/iter; left time: 142.7391s
	iters: 500, epoch: 9 | loss: 0.1777067
	speed: 0.0221s/iter; left time: 140.4241s
Epoch: 9 cost time: 12.930381298065186
Epoch: 9, Steps: 570 | Train Loss: 0.2201751 Vali Loss: 0.0504693 Test Loss: 0.1486825
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2193392
	speed: 0.0620s/iter; left time: 382.5188s
	iters: 200, epoch: 10 | loss: 0.2379362
	speed: 0.0221s/iter; left time: 133.9388s
	iters: 300, epoch: 10 | loss: 0.2421838
	speed: 0.0220s/iter; left time: 131.5603s
	iters: 400, epoch: 10 | loss: 0.3152669
	speed: 0.0220s/iter; left time: 129.3550s
	iters: 500, epoch: 10 | loss: 0.2080968
	speed: 0.0220s/iter; left time: 127.1738s
Epoch: 10 cost time: 12.898318529129028
Epoch: 10, Steps: 570 | Train Loss: 0.2205566 Vali Loss: 0.0505714 Test Loss: 0.1484683
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2241243
	speed: 0.0643s/iter; left time: 360.1233s
	iters: 200, epoch: 11 | loss: 0.1712108
	speed: 0.0221s/iter; left time: 121.4139s
	iters: 300, epoch: 11 | loss: 0.1030466
	speed: 0.0221s/iter; left time: 119.3427s
	iters: 400, epoch: 11 | loss: 0.2405284
	speed: 0.0221s/iter; left time: 117.2576s
	iters: 500, epoch: 11 | loss: 0.1749539
	speed: 0.0221s/iter; left time: 115.0554s
Epoch: 11 cost time: 12.877045392990112
Epoch: 11, Steps: 570 | Train Loss: 0.2200348 Vali Loss: 0.0504946 Test Loss: 0.1483420
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.149175763130188, mae:0.24229665100574493
>>> MS_Pen LR=1e-3 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2879180
	speed: 0.0353s/iter; left time: 398.3937s
	iters: 200, epoch: 1 | loss: 0.1632014
	speed: 0.0231s/iter; left time: 258.8774s
	iters: 300, epoch: 1 | loss: 0.2511329
	speed: 0.0232s/iter; left time: 257.2552s
	iters: 400, epoch: 1 | loss: 0.2741563
	speed: 0.0231s/iter; left time: 254.5433s
	iters: 500, epoch: 1 | loss: 0.2698947
	speed: 0.0231s/iter; left time: 252.3010s
Epoch: 1 cost time: 14.454468011856079
Epoch: 1, Steps: 570 | Train Loss: 0.3130490 Vali Loss: 0.0609726 Test Loss: 0.1785563
Validation loss decreased (inf --> 0.060973).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2443384
	speed: 0.0652s/iter; left time: 699.4644s
	iters: 200, epoch: 2 | loss: 0.1772395
	speed: 0.0232s/iter; left time: 246.8488s
	iters: 300, epoch: 2 | loss: 0.4015157
	speed: 0.0232s/iter; left time: 244.3952s
	iters: 400, epoch: 2 | loss: 0.2632437
	speed: 0.0230s/iter; left time: 240.0954s
	iters: 500, epoch: 2 | loss: 0.1933166
	speed: 0.0212s/iter; left time: 219.1181s
Epoch: 2 cost time: 13.18967318534851
Epoch: 2, Steps: 570 | Train Loss: 0.2675655 Vali Loss: 0.0581248 Test Loss: 0.1708272
Validation loss decreased (0.060973 --> 0.058125).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2064199
	speed: 0.0638s/iter; left time: 647.9759s
	iters: 200, epoch: 3 | loss: 0.2071824
	speed: 0.0213s/iter; left time: 214.5818s
	iters: 300, epoch: 3 | loss: 0.1496096
	speed: 0.0214s/iter; left time: 212.8514s
	iters: 400, epoch: 3 | loss: 0.1643683
	speed: 0.0214s/iter; left time: 210.7558s
	iters: 500, epoch: 3 | loss: 0.2253630
	speed: 0.0214s/iter; left time: 208.4128s
Epoch: 3 cost time: 12.490590810775757
Epoch: 3, Steps: 570 | Train Loss: 0.2472610 Vali Loss: 0.0567611 Test Loss: 0.1638537
Validation loss decreased (0.058125 --> 0.056761).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1531286
	speed: 0.0627s/iter; left time: 601.5877s
	iters: 200, epoch: 4 | loss: 0.2276201
	speed: 0.0233s/iter; left time: 220.7096s
	iters: 300, epoch: 4 | loss: 0.2295771
	speed: 0.0229s/iter; left time: 215.2638s
	iters: 400, epoch: 4 | loss: 0.3237520
	speed: 0.0213s/iter; left time: 197.6394s
	iters: 500, epoch: 4 | loss: 0.1898578
	speed: 0.0213s/iter; left time: 195.7301s
Epoch: 4 cost time: 12.92219352722168
Epoch: 4, Steps: 570 | Train Loss: 0.2334605 Vali Loss: 0.0524051 Test Loss: 0.1529254
Validation loss decreased (0.056761 --> 0.052405).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2945387
	speed: 0.0641s/iter; left time: 578.5247s
	iters: 200, epoch: 5 | loss: 0.1632637
	speed: 0.0213s/iter; left time: 190.1418s
	iters: 300, epoch: 5 | loss: 0.3073603
	speed: 0.0213s/iter; left time: 187.9645s
	iters: 400, epoch: 5 | loss: 0.2000224
	speed: 0.0213s/iter; left time: 185.9654s
	iters: 500, epoch: 5 | loss: 0.1767015
	speed: 0.0213s/iter; left time: 183.5080s
Epoch: 5 cost time: 12.45369839668274
Epoch: 5, Steps: 570 | Train Loss: 0.2246958 Vali Loss: 0.0527089 Test Loss: 0.1511439
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1841463
	speed: 0.0614s/iter; left time: 518.4816s
	iters: 200, epoch: 6 | loss: 0.2438609
	speed: 0.0213s/iter; left time: 177.6845s
	iters: 300, epoch: 6 | loss: 0.2459861
	speed: 0.0213s/iter; left time: 175.5342s
	iters: 400, epoch: 6 | loss: 0.1411087
	speed: 0.0213s/iter; left time: 173.3563s
	iters: 500, epoch: 6 | loss: 0.1472613
	speed: 0.0213s/iter; left time: 171.1283s
Epoch: 6 cost time: 12.40976333618164
Epoch: 6, Steps: 570 | Train Loss: 0.2183540 Vali Loss: 0.0513764 Test Loss: 0.1504981
Validation loss decreased (0.052405 --> 0.051376).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1786622
	speed: 0.0633s/iter; left time: 499.1309s
	iters: 200, epoch: 7 | loss: 0.2804419
	speed: 0.0232s/iter; left time: 180.5423s
	iters: 300, epoch: 7 | loss: 0.1999829
	speed: 0.0231s/iter; left time: 177.0616s
	iters: 400, epoch: 7 | loss: 0.1454301
	speed: 0.0213s/iter; left time: 161.1534s
	iters: 500, epoch: 7 | loss: 0.2220988
	speed: 0.0213s/iter; left time: 159.0953s
Epoch: 7 cost time: 12.98671817779541
Epoch: 7, Steps: 570 | Train Loss: 0.2143936 Vali Loss: 0.0513327 Test Loss: 0.1497683
Validation loss decreased (0.051376 --> 0.051333).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2127638
	speed: 0.0616s/iter; left time: 450.3144s
	iters: 200, epoch: 8 | loss: 0.2130205
	speed: 0.0214s/iter; left time: 154.5307s
	iters: 300, epoch: 8 | loss: 0.1859967
	speed: 0.0214s/iter; left time: 152.3327s
	iters: 400, epoch: 8 | loss: 0.2646169
	speed: 0.0214s/iter; left time: 150.0628s
	iters: 500, epoch: 8 | loss: 0.2790228
	speed: 0.0214s/iter; left time: 148.0697s
Epoch: 8 cost time: 12.494812965393066
Epoch: 8, Steps: 570 | Train Loss: 0.2121992 Vali Loss: 0.0505089 Test Loss: 0.1496285
Validation loss decreased (0.051333 --> 0.050509).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1362436
	speed: 0.0630s/iter; left time: 424.5763s
	iters: 200, epoch: 9 | loss: 0.3195670
	speed: 0.0214s/iter; left time: 141.9220s
	iters: 300, epoch: 9 | loss: 0.2327820
	speed: 0.0213s/iter; left time: 139.4724s
	iters: 400, epoch: 9 | loss: 0.1823437
	speed: 0.0213s/iter; left time: 137.2272s
	iters: 500, epoch: 9 | loss: 0.1120644
	speed: 0.0213s/iter; left time: 135.1518s
Epoch: 9 cost time: 12.487517595291138
Epoch: 9, Steps: 570 | Train Loss: 0.2124336 Vali Loss: 0.0500489 Test Loss: 0.1483408
Validation loss decreased (0.050509 --> 0.050049).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1388090
	speed: 0.0623s/iter; left time: 384.4662s
	iters: 200, epoch: 10 | loss: 0.2455291
	speed: 0.0214s/iter; left time: 129.8290s
	iters: 300, epoch: 10 | loss: 0.1789048
	speed: 0.0214s/iter; left time: 127.5784s
	iters: 400, epoch: 10 | loss: 0.2180991
	speed: 0.0214s/iter; left time: 125.4028s
	iters: 500, epoch: 10 | loss: 0.2769597
	speed: 0.0213s/iter; left time: 123.1719s
Epoch: 10 cost time: 12.477556943893433
Epoch: 10, Steps: 570 | Train Loss: 0.2099131 Vali Loss: 0.0499677 Test Loss: 0.1482455
Validation loss decreased (0.050049 --> 0.049968).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.3319151
	speed: 0.0639s/iter; left time: 358.1157s
	iters: 200, epoch: 11 | loss: 0.1603609
	speed: 0.0213s/iter; left time: 117.3945s
	iters: 300, epoch: 11 | loss: 0.2007231
	speed: 0.0214s/iter; left time: 115.4377s
	iters: 400, epoch: 11 | loss: 0.2064684
	speed: 0.0214s/iter; left time: 113.1820s
	iters: 500, epoch: 11 | loss: 0.2551329
	speed: 0.0214s/iter; left time: 111.0951s
Epoch: 11 cost time: 12.45363450050354
Epoch: 11, Steps: 570 | Train Loss: 0.2100807 Vali Loss: 0.0499856 Test Loss: 0.1483901
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2257832
	speed: 0.0647s/iter; left time: 325.6529s
	iters: 200, epoch: 12 | loss: 0.2410815
	speed: 0.0233s/iter; left time: 114.7171s
	iters: 300, epoch: 12 | loss: 0.2052367
	speed: 0.0233s/iter; left time: 112.5106s
	iters: 400, epoch: 12 | loss: 0.4146351
	speed: 0.0233s/iter; left time: 110.0401s
	iters: 500, epoch: 12 | loss: 0.1692587
	speed: 0.0233s/iter; left time: 107.6853s
Epoch: 12 cost time: 13.53585147857666
Epoch: 12, Steps: 570 | Train Loss: 0.2093087 Vali Loss: 0.0501432 Test Loss: 0.1484841
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1615235
	speed: 0.0625s/iter; left time: 278.7558s
	iters: 200, epoch: 13 | loss: 0.2599730
	speed: 0.0214s/iter; left time: 93.2346s
	iters: 300, epoch: 13 | loss: 0.3217983
	speed: 0.0213s/iter; left time: 90.8990s
	iters: 400, epoch: 13 | loss: 0.1728404
	speed: 0.0213s/iter; left time: 88.7825s
	iters: 500, epoch: 13 | loss: 0.2208634
	speed: 0.0213s/iter; left time: 86.6199s
Epoch: 13 cost time: 12.475354671478271
Epoch: 13, Steps: 570 | Train Loss: 0.2098752 Vali Loss: 0.0503514 Test Loss: 0.1484105
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14845094084739685, mae:0.24489732086658478
>>> MS_Pen LR=1e-3 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3189148
	speed: 0.0316s/iter; left time: 357.0215s
	iters: 200, epoch: 1 | loss: 0.2103636
	speed: 0.0200s/iter; left time: 224.0058s
	iters: 300, epoch: 1 | loss: 0.3174877
	speed: 0.0201s/iter; left time: 222.5966s
	iters: 400, epoch: 1 | loss: 0.3830815
	speed: 0.0201s/iter; left time: 220.7758s
	iters: 500, epoch: 1 | loss: 0.2939625
	speed: 0.0200s/iter; left time: 218.5488s
Epoch: 1 cost time: 12.629019498825073
Epoch: 1, Steps: 570 | Train Loss: 0.3183998 Vali Loss: 0.0608794 Test Loss: 0.1771295
Validation loss decreased (inf --> 0.060879).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1549071
	speed: 0.0601s/iter; left time: 644.7826s
	iters: 200, epoch: 2 | loss: 0.4491497
	speed: 0.0203s/iter; left time: 215.4389s
	iters: 300, epoch: 2 | loss: 0.2179407
	speed: 0.0209s/iter; left time: 220.4375s
	iters: 400, epoch: 2 | loss: 0.1606091
	speed: 0.0223s/iter; left time: 232.4762s
	iters: 500, epoch: 2 | loss: 0.1818204
	speed: 0.0223s/iter; left time: 230.1062s
Epoch: 2 cost time: 12.46394944190979
Epoch: 2, Steps: 570 | Train Loss: 0.2710677 Vali Loss: 0.0571539 Test Loss: 0.1697992
Validation loss decreased (0.060879 --> 0.057154).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1889929
	speed: 0.0637s/iter; left time: 646.7756s
	iters: 200, epoch: 3 | loss: 0.2051748
	speed: 0.0201s/iter; left time: 201.8826s
	iters: 300, epoch: 3 | loss: 0.2255878
	speed: 0.0201s/iter; left time: 199.9875s
	iters: 400, epoch: 3 | loss: 0.2459062
	speed: 0.0201s/iter; left time: 197.8398s
	iters: 500, epoch: 3 | loss: 0.2326927
	speed: 0.0200s/iter; left time: 195.6502s
Epoch: 3 cost time: 11.845717668533325
Epoch: 3, Steps: 570 | Train Loss: 0.2493836 Vali Loss: 0.0560619 Test Loss: 0.1660061
Validation loss decreased (0.057154 --> 0.056062).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1597677
	speed: 0.0603s/iter; left time: 578.1937s
	iters: 200, epoch: 4 | loss: 0.4984940
	speed: 0.0201s/iter; left time: 191.1028s
	iters: 300, epoch: 4 | loss: 0.1477542
	speed: 0.0201s/iter; left time: 188.8089s
	iters: 400, epoch: 4 | loss: 0.2513062
	speed: 0.0201s/iter; left time: 186.9023s
	iters: 500, epoch: 4 | loss: 0.1983862
	speed: 0.0201s/iter; left time: 185.0518s
Epoch: 4 cost time: 11.75319242477417
Epoch: 4, Steps: 570 | Train Loss: 0.2376432 Vali Loss: 0.0556861 Test Loss: 0.1642032
Validation loss decreased (0.056062 --> 0.055686).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2035414
	speed: 0.0601s/iter; left time: 542.1973s
	iters: 200, epoch: 5 | loss: 0.3388488
	speed: 0.0202s/iter; left time: 179.8208s
	iters: 300, epoch: 5 | loss: 0.2493238
	speed: 0.0202s/iter; left time: 177.9032s
	iters: 400, epoch: 5 | loss: 0.2003111
	speed: 0.0202s/iter; left time: 175.8548s
	iters: 500, epoch: 5 | loss: 0.1778272
	speed: 0.0201s/iter; left time: 173.6380s
Epoch: 5 cost time: 11.78526496887207
Epoch: 5, Steps: 570 | Train Loss: 0.2284519 Vali Loss: 0.0508585 Test Loss: 0.1544451
Validation loss decreased (0.055686 --> 0.050859).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1944875
	speed: 0.0594s/iter; left time: 502.2594s
	iters: 200, epoch: 6 | loss: 0.3131018
	speed: 0.0201s/iter; left time: 167.9119s
	iters: 300, epoch: 6 | loss: 0.1692617
	speed: 0.0201s/iter; left time: 165.6729s
	iters: 400, epoch: 6 | loss: 0.1543893
	speed: 0.0201s/iter; left time: 163.5200s
	iters: 500, epoch: 6 | loss: 0.3484793
	speed: 0.0201s/iter; left time: 161.5532s
Epoch: 6 cost time: 11.747649431228638
Epoch: 6, Steps: 570 | Train Loss: 0.2235151 Vali Loss: 0.0503052 Test Loss: 0.1511480
Validation loss decreased (0.050859 --> 0.050305).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2424500
	speed: 0.0592s/iter; left time: 466.7339s
	iters: 200, epoch: 7 | loss: 0.2387349
	speed: 0.0201s/iter; left time: 156.2855s
	iters: 300, epoch: 7 | loss: 0.2721617
	speed: 0.0201s/iter; left time: 154.3501s
	iters: 400, epoch: 7 | loss: 0.2615589
	speed: 0.0201s/iter; left time: 152.2883s
	iters: 500, epoch: 7 | loss: 0.1479898
	speed: 0.0201s/iter; left time: 150.1421s
Epoch: 7 cost time: 11.760498523712158
Epoch: 7, Steps: 570 | Train Loss: 0.2191397 Vali Loss: 0.0505456 Test Loss: 0.1507344
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2345475
	speed: 0.0593s/iter; left time: 433.5454s
	iters: 200, epoch: 8 | loss: 0.2793675
	speed: 0.0199s/iter; left time: 143.6429s
	iters: 300, epoch: 8 | loss: 0.2438259
	speed: 0.0199s/iter; left time: 141.5228s
	iters: 400, epoch: 8 | loss: 0.1577222
	speed: 0.0199s/iter; left time: 139.4366s
	iters: 500, epoch: 8 | loss: 0.2415860
	speed: 0.0199s/iter; left time: 137.4565s
Epoch: 8 cost time: 11.59008240699768
Epoch: 8, Steps: 570 | Train Loss: 0.2164641 Vali Loss: 0.0502084 Test Loss: 0.1503948
Validation loss decreased (0.050305 --> 0.050208).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2238908
	speed: 0.0612s/iter; left time: 412.2427s
	iters: 200, epoch: 9 | loss: 0.1914735
	speed: 0.0200s/iter; left time: 133.0110s
	iters: 300, epoch: 9 | loss: 0.2784654
	speed: 0.0200s/iter; left time: 130.8153s
	iters: 400, epoch: 9 | loss: 0.1624730
	speed: 0.0200s/iter; left time: 128.8607s
	iters: 500, epoch: 9 | loss: 0.1162415
	speed: 0.0200s/iter; left time: 126.9507s
Epoch: 9 cost time: 11.725374221801758
Epoch: 9, Steps: 570 | Train Loss: 0.2159761 Vali Loss: 0.0502525 Test Loss: 0.1504312
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2298633
	speed: 0.0579s/iter; left time: 357.4446s
	iters: 200, epoch: 10 | loss: 0.1300884
	speed: 0.0200s/iter; left time: 121.6709s
	iters: 300, epoch: 10 | loss: 0.2430346
	speed: 0.0200s/iter; left time: 119.6671s
	iters: 400, epoch: 10 | loss: 0.2998106
	speed: 0.0200s/iter; left time: 117.6556s
	iters: 500, epoch: 10 | loss: 0.2811089
	speed: 0.0200s/iter; left time: 115.7050s
Epoch: 10 cost time: 11.70952844619751
Epoch: 10, Steps: 570 | Train Loss: 0.2148448 Vali Loss: 0.0500308 Test Loss: 0.1493556
Validation loss decreased (0.050208 --> 0.050031).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1597968
	speed: 0.0586s/iter; left time: 328.3734s
	iters: 200, epoch: 11 | loss: 0.1659497
	speed: 0.0200s/iter; left time: 110.0926s
	iters: 300, epoch: 11 | loss: 0.1524655
	speed: 0.0200s/iter; left time: 108.1084s
	iters: 400, epoch: 11 | loss: 0.2344353
	speed: 0.0200s/iter; left time: 106.2305s
	iters: 500, epoch: 11 | loss: 0.1671306
	speed: 0.0200s/iter; left time: 104.1066s
Epoch: 11 cost time: 11.728777408599854
Epoch: 11, Steps: 570 | Train Loss: 0.2149219 Vali Loss: 0.0500546 Test Loss: 0.1495130
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1958102
	speed: 0.0610s/iter; left time: 306.7554s
	iters: 200, epoch: 12 | loss: 0.2010200
	speed: 0.0201s/iter; left time: 99.0767s
	iters: 300, epoch: 12 | loss: 0.3940863
	speed: 0.0201s/iter; left time: 97.0084s
	iters: 400, epoch: 12 | loss: 0.2292265
	speed: 0.0201s/iter; left time: 94.8929s
	iters: 500, epoch: 12 | loss: 0.3536323
	speed: 0.0201s/iter; left time: 93.1873s
Epoch: 12 cost time: 11.785325527191162
Epoch: 12, Steps: 570 | Train Loss: 0.2143419 Vali Loss: 0.0500232 Test Loss: 0.1495131
Validation loss decreased (0.050031 --> 0.050023).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2225682
	speed: 0.0618s/iter; left time: 275.8321s
	iters: 200, epoch: 13 | loss: 0.1502023
	speed: 0.0201s/iter; left time: 87.7413s
	iters: 300, epoch: 13 | loss: 0.2039757
	speed: 0.0201s/iter; left time: 85.6536s
	iters: 400, epoch: 13 | loss: 0.1259789
	speed: 0.0203s/iter; left time: 84.3036s
	iters: 500, epoch: 13 | loss: 0.1979526
	speed: 0.0230s/iter; left time: 93.5323s
Epoch: 13 cost time: 12.266606330871582
Epoch: 13, Steps: 570 | Train Loss: 0.2154841 Vali Loss: 0.0502308 Test Loss: 0.1495116
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2863019
	speed: 0.0621s/iter; left time: 241.5279s
	iters: 200, epoch: 14 | loss: 0.2155620
	speed: 0.0222s/iter; left time: 84.0669s
	iters: 300, epoch: 14 | loss: 0.2947657
	speed: 0.0225s/iter; left time: 82.9772s
	iters: 400, epoch: 14 | loss: 0.1449294
	speed: 0.0215s/iter; left time: 77.3439s
	iters: 500, epoch: 14 | loss: 0.1873342
	speed: 0.0201s/iter; left time: 70.0679s
Epoch: 14 cost time: 12.562198877334595
Epoch: 14, Steps: 570 | Train Loss: 0.2149081 Vali Loss: 0.0500003 Test Loss: 0.1494732
Validation loss decreased (0.050023 --> 0.050000).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1389874
	speed: 0.0604s/iter; left time: 200.7014s
	iters: 200, epoch: 15 | loss: 0.1967863
	speed: 0.0200s/iter; left time: 64.5743s
	iters: 300, epoch: 15 | loss: 0.2328144
	speed: 0.0200s/iter; left time: 62.4167s
	iters: 400, epoch: 15 | loss: 0.1966397
	speed: 0.0200s/iter; left time: 60.4109s
	iters: 500, epoch: 15 | loss: 0.1649776
	speed: 0.0200s/iter; left time: 58.3434s
Epoch: 15 cost time: 11.752034187316895
Epoch: 15, Steps: 570 | Train Loss: 0.2149164 Vali Loss: 0.0500740 Test Loss: 0.1494658
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.2145531
	speed: 0.0612s/iter; left time: 168.2338s
	iters: 200, epoch: 16 | loss: 0.1278512
	speed: 0.0201s/iter; left time: 53.2834s
	iters: 300, epoch: 16 | loss: 0.2588633
	speed: 0.0201s/iter; left time: 51.2407s
	iters: 400, epoch: 16 | loss: 0.1422816
	speed: 0.0201s/iter; left time: 49.2246s
	iters: 500, epoch: 16 | loss: 0.2397075
	speed: 0.0201s/iter; left time: 47.2055s
Epoch: 16 cost time: 11.821930646896362
Epoch: 16, Steps: 570 | Train Loss: 0.2144899 Vali Loss: 0.0500750 Test Loss: 0.1494666
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1898191
	speed: 0.0615s/iter; left time: 134.0283s
	iters: 200, epoch: 17 | loss: 0.1838387
	speed: 0.0201s/iter; left time: 41.7579s
	iters: 300, epoch: 17 | loss: 0.1977193
	speed: 0.0200s/iter; left time: 39.6736s
	iters: 400, epoch: 17 | loss: 0.1685367
	speed: 0.0200s/iter; left time: 37.6815s
	iters: 500, epoch: 17 | loss: 0.2197523
	speed: 0.0200s/iter; left time: 35.6985s
Epoch: 17 cost time: 11.676727771759033
Epoch: 17, Steps: 570 | Train Loss: 0.2149831 Vali Loss: 0.0499559 Test Loss: 0.1494615
Validation loss decreased (0.050000 --> 0.049956).  Saving model ...
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 18 | loss: 0.2282875
	speed: 0.0586s/iter; left time: 94.4018s
	iters: 200, epoch: 18 | loss: 0.2393482
	speed: 0.0200s/iter; left time: 30.2919s
	iters: 300, epoch: 18 | loss: 0.2775904
	speed: 0.0200s/iter; left time: 28.2264s
	iters: 400, epoch: 18 | loss: 0.1524552
	speed: 0.0200s/iter; left time: 26.2187s
	iters: 500, epoch: 18 | loss: 0.2459349
	speed: 0.0200s/iter; left time: 24.2126s
Epoch: 18 cost time: 11.722681999206543
Epoch: 18, Steps: 570 | Train Loss: 0.2160602 Vali Loss: 0.0500832 Test Loss: 0.1494612
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 19 | loss: 0.3214992
	speed: 0.0600s/iter; left time: 62.4196s
	iters: 200, epoch: 19 | loss: 0.2399023
	speed: 0.0221s/iter; left time: 20.8336s
	iters: 300, epoch: 19 | loss: 0.1557458
	speed: 0.0221s/iter; left time: 18.5791s
	iters: 400, epoch: 19 | loss: 0.3209362
	speed: 0.0221s/iter; left time: 16.3726s
	iters: 500, epoch: 19 | loss: 0.1392685
	speed: 0.0221s/iter; left time: 14.1556s
Epoch: 19 cost time: 12.878152847290039
Epoch: 19, Steps: 570 | Train Loss: 0.2142600 Vali Loss: 0.0502308 Test Loss: 0.1494605
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.814697265625e-09
	iters: 100, epoch: 20 | loss: 0.2820548
	speed: 0.0592s/iter; left time: 27.8879s
	iters: 200, epoch: 20 | loss: 0.2059327
	speed: 0.0200s/iter; left time: 7.4193s
	iters: 300, epoch: 20 | loss: 0.3752716
	speed: 0.0200s/iter; left time: 5.4210s
	iters: 400, epoch: 20 | loss: 0.2709123
	speed: 0.0200s/iter; left time: 3.4189s
	iters: 500, epoch: 20 | loss: 0.1591653
	speed: 0.0200s/iter; left time: 1.4200s
Epoch: 20 cost time: 11.642706871032715
Epoch: 20, Steps: 570 | Train Loss: 0.2137209 Vali Loss: 0.0501167 Test Loss: 0.1494606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14969836175441742, mae:0.2452845722436905
>>> MS_Pen LR=1e-3 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2459056
	speed: 0.0234s/iter; left time: 264.6970s
	iters: 200, epoch: 1 | loss: 0.2053174
	speed: 0.0118s/iter; left time: 132.6476s
	iters: 300, epoch: 1 | loss: 0.1746463
	speed: 0.0113s/iter; left time: 125.8702s
	iters: 400, epoch: 1 | loss: 0.2600772
	speed: 0.0105s/iter; left time: 115.6613s
	iters: 500, epoch: 1 | loss: 0.2040609
	speed: 0.0106s/iter; left time: 115.2740s
Epoch: 1 cost time: 7.552582263946533
Epoch: 1, Steps: 570 | Train Loss: 0.2575410 Vali Loss: 0.0468092 Test Loss: 0.1506761
Validation loss decreased (inf --> 0.046809).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4113708
	speed: 0.0381s/iter; left time: 409.1016s
	iters: 200, epoch: 2 | loss: 0.3051817
	speed: 0.0105s/iter; left time: 112.1063s
	iters: 300, epoch: 2 | loss: 0.2930099
	speed: 0.0106s/iter; left time: 111.2312s
	iters: 400, epoch: 2 | loss: 0.1676931
	speed: 0.0106s/iter; left time: 110.2109s
	iters: 500, epoch: 2 | loss: 0.2014936
	speed: 0.0105s/iter; left time: 108.6465s
Epoch: 2 cost time: 6.347749710083008
Epoch: 2, Steps: 570 | Train Loss: 0.2307796 Vali Loss: 0.0478973 Test Loss: 0.1484201
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1596803
	speed: 0.0377s/iter; left time: 383.5138s
	iters: 200, epoch: 3 | loss: 0.2503156
	speed: 0.0119s/iter; left time: 119.5321s
	iters: 300, epoch: 3 | loss: 0.1857684
	speed: 0.0119s/iter; left time: 118.1797s
	iters: 400, epoch: 3 | loss: 0.2229245
	speed: 0.0106s/iter; left time: 104.2484s
	iters: 500, epoch: 3 | loss: 0.2480483
	speed: 0.0105s/iter; left time: 102.8464s
Epoch: 3 cost time: 6.666830539703369
Epoch: 3, Steps: 570 | Train Loss: 0.2079146 Vali Loss: 0.0407361 Test Loss: 0.1299079
Validation loss decreased (0.046809 --> 0.040736).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1995311
	speed: 0.0370s/iter; left time: 354.7677s
	iters: 200, epoch: 4 | loss: 0.1172522
	speed: 0.0106s/iter; left time: 100.4570s
	iters: 300, epoch: 4 | loss: 0.1985103
	speed: 0.0106s/iter; left time: 99.3981s
	iters: 400, epoch: 4 | loss: 0.2083584
	speed: 0.0106s/iter; left time: 98.3068s
	iters: 500, epoch: 4 | loss: 0.1715413
	speed: 0.0106s/iter; left time: 97.2048s
Epoch: 4 cost time: 6.3607237339019775
Epoch: 4, Steps: 570 | Train Loss: 0.1899426 Vali Loss: 0.0394711 Test Loss: 0.1248350
Validation loss decreased (0.040736 --> 0.039471).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1505792
	speed: 0.0374s/iter; left time: 337.3396s
	iters: 200, epoch: 5 | loss: 0.1572786
	speed: 0.0118s/iter; left time: 105.0787s
	iters: 300, epoch: 5 | loss: 0.1092936
	speed: 0.0118s/iter; left time: 103.9609s
	iters: 400, epoch: 5 | loss: 0.1929007
	speed: 0.0118s/iter; left time: 102.6759s
	iters: 500, epoch: 5 | loss: 0.1876542
	speed: 0.0118s/iter; left time: 101.3912s
Epoch: 5 cost time: 7.019644498825073
Epoch: 5, Steps: 570 | Train Loss: 0.1810721 Vali Loss: 0.0371352 Test Loss: 0.1255786
Validation loss decreased (0.039471 --> 0.037135).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1579900
	speed: 0.0372s/iter; left time: 314.6264s
	iters: 200, epoch: 6 | loss: 0.1308322
	speed: 0.0104s/iter; left time: 87.1306s
	iters: 300, epoch: 6 | loss: 0.1666650
	speed: 0.0104s/iter; left time: 85.9957s
	iters: 400, epoch: 6 | loss: 0.1973354
	speed: 0.0104s/iter; left time: 85.1424s
	iters: 500, epoch: 6 | loss: 0.1933066
	speed: 0.0105s/iter; left time: 84.1578s
Epoch: 6 cost time: 6.225353717803955
Epoch: 6, Steps: 570 | Train Loss: 0.1758177 Vali Loss: 0.0371745 Test Loss: 0.1260326
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2168415
	speed: 0.0353s/iter; left time: 278.3257s
	iters: 200, epoch: 7 | loss: 0.2185694
	speed: 0.0105s/iter; left time: 81.5217s
	iters: 300, epoch: 7 | loss: 0.1547402
	speed: 0.0105s/iter; left time: 80.6154s
	iters: 400, epoch: 7 | loss: 0.1402031
	speed: 0.0105s/iter; left time: 79.4526s
	iters: 500, epoch: 7 | loss: 0.1470648
	speed: 0.0105s/iter; left time: 78.4122s
Epoch: 7 cost time: 6.262544393539429
Epoch: 7, Steps: 570 | Train Loss: 0.1734728 Vali Loss: 0.0371055 Test Loss: 0.1242672
Validation loss decreased (0.037135 --> 0.037106).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1948281
	speed: 0.0367s/iter; left time: 267.9626s
	iters: 200, epoch: 8 | loss: 0.1756843
	speed: 0.0106s/iter; left time: 76.1586s
	iters: 300, epoch: 8 | loss: 0.2054918
	speed: 0.0105s/iter; left time: 74.9573s
	iters: 400, epoch: 8 | loss: 0.2192298
	speed: 0.0105s/iter; left time: 73.6132s
	iters: 500, epoch: 8 | loss: 0.1310047
	speed: 0.0105s/iter; left time: 72.7847s
Epoch: 8 cost time: 6.317971467971802
Epoch: 8, Steps: 570 | Train Loss: 0.1708637 Vali Loss: 0.0369728 Test Loss: 0.1232885
Validation loss decreased (0.037106 --> 0.036973).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2167366
	speed: 0.0382s/iter; left time: 257.7284s
	iters: 200, epoch: 9 | loss: 0.1626986
	speed: 0.0105s/iter; left time: 69.8604s
	iters: 300, epoch: 9 | loss: 0.0887831
	speed: 0.0106s/iter; left time: 69.0155s
	iters: 400, epoch: 9 | loss: 0.1625871
	speed: 0.0105s/iter; left time: 67.7881s
	iters: 500, epoch: 9 | loss: 0.1464417
	speed: 0.0105s/iter; left time: 66.4189s
Epoch: 9 cost time: 6.317563772201538
Epoch: 9, Steps: 570 | Train Loss: 0.1693437 Vali Loss: 0.0373023 Test Loss: 0.1234243
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1661254
	speed: 0.0378s/iter; left time: 232.9813s
	iters: 200, epoch: 10 | loss: 0.1505809
	speed: 0.0105s/iter; left time: 63.6123s
	iters: 300, epoch: 10 | loss: 0.1414452
	speed: 0.0105s/iter; left time: 62.5271s
	iters: 400, epoch: 10 | loss: 0.1539758
	speed: 0.0105s/iter; left time: 61.5100s
	iters: 500, epoch: 10 | loss: 0.2261977
	speed: 0.0105s/iter; left time: 60.4133s
Epoch: 10 cost time: 6.297403573989868
Epoch: 10, Steps: 570 | Train Loss: 0.1691252 Vali Loss: 0.0371325 Test Loss: 0.1237375
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1897544
	speed: 0.0361s/iter; left time: 202.4731s
	iters: 200, epoch: 11 | loss: 0.1497593
	speed: 0.0106s/iter; left time: 58.0823s
	iters: 300, epoch: 11 | loss: 0.1306981
	speed: 0.0106s/iter; left time: 57.0536s
	iters: 400, epoch: 11 | loss: 0.2127613
	speed: 0.0106s/iter; left time: 55.9873s
	iters: 500, epoch: 11 | loss: 0.1408472
	speed: 0.0106s/iter; left time: 54.9774s
Epoch: 11 cost time: 6.309917211532593
Epoch: 11, Steps: 570 | Train Loss: 0.1694983 Vali Loss: 0.0369963 Test Loss: 0.1238947
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12344389408826828, mae:0.21689456701278687
>>> MS_Pen LR=1e-3 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2476437
	speed: 0.0226s/iter; left time: 255.5760s
	iters: 200, epoch: 1 | loss: 0.2371789
	speed: 0.0104s/iter; left time: 116.7994s
	iters: 300, epoch: 1 | loss: 0.3181948
	speed: 0.0105s/iter; left time: 116.0313s
	iters: 400, epoch: 1 | loss: 0.2483199
	speed: 0.0104s/iter; left time: 114.6864s
	iters: 500, epoch: 1 | loss: 0.2214327
	speed: 0.0105s/iter; left time: 113.9492s
Epoch: 1 cost time: 7.216726541519165
Epoch: 1, Steps: 570 | Train Loss: 0.2349179 Vali Loss: 0.0405447 Test Loss: 0.1281663
Validation loss decreased (inf --> 0.040545).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2070494
	speed: 0.0375s/iter; left time: 402.8354s
	iters: 200, epoch: 2 | loss: 0.2037369
	speed: 0.0103s/iter; left time: 109.5911s
	iters: 300, epoch: 2 | loss: 0.1691287
	speed: 0.0104s/iter; left time: 109.0123s
	iters: 400, epoch: 2 | loss: 0.1751302
	speed: 0.0103s/iter; left time: 107.7249s
	iters: 500, epoch: 2 | loss: 0.1971921
	speed: 0.0103s/iter; left time: 106.2463s
Epoch: 2 cost time: 6.216273784637451
Epoch: 2, Steps: 570 | Train Loss: 0.2109430 Vali Loss: 0.0414020 Test Loss: 0.1275221
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1147127
	speed: 0.0392s/iter; left time: 398.4877s
	iters: 200, epoch: 3 | loss: 0.1728597
	speed: 0.0104s/iter; left time: 104.1720s
	iters: 300, epoch: 3 | loss: 0.3457229
	speed: 0.0103s/iter; left time: 102.6705s
	iters: 400, epoch: 3 | loss: 0.2067368
	speed: 0.0103s/iter; left time: 101.4921s
	iters: 500, epoch: 3 | loss: 0.1668555
	speed: 0.0103s/iter; left time: 100.7852s
Epoch: 3 cost time: 6.232083082199097
Epoch: 3, Steps: 570 | Train Loss: 0.1951589 Vali Loss: 0.0368425 Test Loss: 0.1221794
Validation loss decreased (0.040545 --> 0.036842).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1749235
	speed: 0.0371s/iter; left time: 356.0370s
	iters: 200, epoch: 4 | loss: 0.1415788
	speed: 0.0103s/iter; left time: 97.9567s
	iters: 300, epoch: 4 | loss: 0.0958348
	speed: 0.0103s/iter; left time: 96.6290s
	iters: 400, epoch: 4 | loss: 0.1286031
	speed: 0.0103s/iter; left time: 95.6678s
	iters: 500, epoch: 4 | loss: 0.2181889
	speed: 0.0103s/iter; left time: 94.8838s
Epoch: 4 cost time: 6.221435308456421
Epoch: 4, Steps: 570 | Train Loss: 0.1791087 Vali Loss: 0.0351385 Test Loss: 0.1157697
Validation loss decreased (0.036842 --> 0.035138).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1454516
	speed: 0.0386s/iter; left time: 348.3086s
	iters: 200, epoch: 5 | loss: 0.2242024
	speed: 0.0104s/iter; left time: 92.3966s
	iters: 300, epoch: 5 | loss: 0.1587919
	speed: 0.0103s/iter; left time: 91.2897s
	iters: 400, epoch: 5 | loss: 0.1711693
	speed: 0.0103s/iter; left time: 90.0394s
	iters: 500, epoch: 5 | loss: 0.1700581
	speed: 0.0103s/iter; left time: 88.8964s
Epoch: 5 cost time: 6.2224249839782715
Epoch: 5, Steps: 570 | Train Loss: 0.1704351 Vali Loss: 0.0355065 Test Loss: 0.1134178
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1244844
	speed: 0.0370s/iter; left time: 312.4503s
	iters: 200, epoch: 6 | loss: 0.2073452
	speed: 0.0114s/iter; left time: 95.2971s
	iters: 300, epoch: 6 | loss: 0.1692457
	speed: 0.0116s/iter; left time: 95.7818s
	iters: 400, epoch: 6 | loss: 0.1297386
	speed: 0.0116s/iter; left time: 94.9588s
	iters: 500, epoch: 6 | loss: 0.1052673
	speed: 0.0116s/iter; left time: 93.7555s
Epoch: 6 cost time: 6.779000520706177
Epoch: 6, Steps: 570 | Train Loss: 0.1645976 Vali Loss: 0.0344207 Test Loss: 0.1120361
Validation loss decreased (0.035138 --> 0.034421).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1582694
	speed: 0.0379s/iter; left time: 299.0731s
	iters: 200, epoch: 7 | loss: 0.1884681
	speed: 0.0104s/iter; left time: 80.6614s
	iters: 300, epoch: 7 | loss: 0.3173409
	speed: 0.0104s/iter; left time: 79.8960s
	iters: 400, epoch: 7 | loss: 0.2232701
	speed: 0.0104s/iter; left time: 78.6825s
	iters: 500, epoch: 7 | loss: 0.1907133
	speed: 0.0103s/iter; left time: 77.3369s
Epoch: 7 cost time: 6.228418350219727
Epoch: 7, Steps: 570 | Train Loss: 0.1628588 Vali Loss: 0.0339260 Test Loss: 0.1120809
Validation loss decreased (0.034421 --> 0.033926).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1358303
	speed: 0.0392s/iter; left time: 286.8673s
	iters: 200, epoch: 8 | loss: 0.1164041
	speed: 0.0117s/iter; left time: 84.4986s
	iters: 300, epoch: 8 | loss: 0.1499057
	speed: 0.0116s/iter; left time: 82.5047s
	iters: 400, epoch: 8 | loss: 0.1426590
	speed: 0.0114s/iter; left time: 79.8409s
	iters: 500, epoch: 8 | loss: 0.0971270
	speed: 0.0117s/iter; left time: 80.6563s
Epoch: 8 cost time: 6.946027517318726
Epoch: 8, Steps: 570 | Train Loss: 0.1626328 Vali Loss: 0.0340252 Test Loss: 0.1119210
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1539273
	speed: 0.0373s/iter; left time: 251.6088s
	iters: 200, epoch: 9 | loss: 0.1539155
	speed: 0.0104s/iter; left time: 69.1787s
	iters: 300, epoch: 9 | loss: 0.1409806
	speed: 0.0104s/iter; left time: 68.3035s
	iters: 400, epoch: 9 | loss: 0.1980272
	speed: 0.0105s/iter; left time: 67.3861s
	iters: 500, epoch: 9 | loss: 0.1330296
	speed: 0.0105s/iter; left time: 66.3006s
Epoch: 9 cost time: 6.237641334533691
Epoch: 9, Steps: 570 | Train Loss: 0.1610731 Vali Loss: 0.0341044 Test Loss: 0.1118173
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1709599
	speed: 0.0362s/iter; left time: 223.2051s
	iters: 200, epoch: 10 | loss: 0.1282208
	speed: 0.0103s/iter; left time: 62.6762s
	iters: 300, epoch: 10 | loss: 0.1477209
	speed: 0.0103s/iter; left time: 61.4945s
	iters: 400, epoch: 10 | loss: 0.1071189
	speed: 0.0103s/iter; left time: 60.4878s
	iters: 500, epoch: 10 | loss: 0.1184581
	speed: 0.0103s/iter; left time: 59.4832s
Epoch: 10 cost time: 6.152594327926636
Epoch: 10, Steps: 570 | Train Loss: 0.1618541 Vali Loss: 0.0341257 Test Loss: 0.1118800
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11222454160451889, mae:0.2021186351776123
>>> MS_Pen LR=1e-3 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2439659
	speed: 0.0237s/iter; left time: 267.9810s
	iters: 200, epoch: 1 | loss: 0.1549723
	speed: 0.0118s/iter; left time: 132.4253s
	iters: 300, epoch: 1 | loss: 0.1714798
	speed: 0.0118s/iter; left time: 131.1434s
	iters: 400, epoch: 1 | loss: 0.2461089
	speed: 0.0118s/iter; left time: 129.8554s
	iters: 500, epoch: 1 | loss: 0.2484648
	speed: 0.0118s/iter; left time: 128.9604s
Epoch: 1 cost time: 7.977792501449585
Epoch: 1, Steps: 570 | Train Loss: 0.2645699 Vali Loss: 0.0495486 Test Loss: 0.1462292
Validation loss decreased (inf --> 0.049549).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2610985
	speed: 0.0410s/iter; left time: 440.1270s
	iters: 200, epoch: 2 | loss: 0.3294885
	speed: 0.0118s/iter; left time: 125.0843s
	iters: 300, epoch: 2 | loss: 0.2337901
	speed: 0.0118s/iter; left time: 124.2176s
	iters: 400, epoch: 2 | loss: 0.3738957
	speed: 0.0118s/iter; left time: 123.1161s
	iters: 500, epoch: 2 | loss: 0.2649249
	speed: 0.0118s/iter; left time: 121.6659s
Epoch: 2 cost time: 7.065972566604614
Epoch: 2, Steps: 570 | Train Loss: 0.2510123 Vali Loss: 0.0478081 Test Loss: 0.1474155
Validation loss decreased (0.049549 --> 0.047808).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1667514
	speed: 0.0407s/iter; left time: 413.4026s
	iters: 200, epoch: 3 | loss: 0.2326007
	speed: 0.0118s/iter; left time: 119.0270s
	iters: 300, epoch: 3 | loss: 0.3025205
	speed: 0.0118s/iter; left time: 117.5404s
	iters: 400, epoch: 3 | loss: 0.2212566
	speed: 0.0118s/iter; left time: 116.2505s
	iters: 500, epoch: 3 | loss: 0.1760064
	speed: 0.0118s/iter; left time: 115.2789s
Epoch: 3 cost time: 7.083717584609985
Epoch: 3, Steps: 570 | Train Loss: 0.2251062 Vali Loss: 0.0439139 Test Loss: 0.1367297
Validation loss decreased (0.047808 --> 0.043914).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1432704
	speed: 0.0397s/iter; left time: 380.8886s
	iters: 200, epoch: 4 | loss: 0.1284997
	speed: 0.0118s/iter; left time: 112.2353s
	iters: 300, epoch: 4 | loss: 0.1675973
	speed: 0.0118s/iter; left time: 111.2573s
	iters: 400, epoch: 4 | loss: 0.2420107
	speed: 0.0118s/iter; left time: 110.0472s
	iters: 500, epoch: 4 | loss: 0.1729377
	speed: 0.0109s/iter; left time: 100.2876s
Epoch: 4 cost time: 6.8684515953063965
Epoch: 4, Steps: 570 | Train Loss: 0.2094277 Vali Loss: 0.0437900 Test Loss: 0.1408217
Validation loss decreased (0.043914 --> 0.043790).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1755169
	speed: 0.0379s/iter; left time: 341.8715s
	iters: 200, epoch: 5 | loss: 0.1211507
	speed: 0.0103s/iter; left time: 92.1273s
	iters: 300, epoch: 5 | loss: 0.2766564
	speed: 0.0103s/iter; left time: 90.9626s
	iters: 400, epoch: 5 | loss: 0.1715333
	speed: 0.0103s/iter; left time: 89.7076s
	iters: 500, epoch: 5 | loss: 0.2672638
	speed: 0.0103s/iter; left time: 88.7650s
Epoch: 5 cost time: 6.202961444854736
Epoch: 5, Steps: 570 | Train Loss: 0.2005825 Vali Loss: 0.0413586 Test Loss: 0.1382270
Validation loss decreased (0.043790 --> 0.041359).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1389459
	speed: 0.0369s/iter; left time: 312.2120s
	iters: 200, epoch: 6 | loss: 0.1891766
	speed: 0.0104s/iter; left time: 86.5387s
	iters: 300, epoch: 6 | loss: 0.1670524
	speed: 0.0104s/iter; left time: 85.6657s
	iters: 400, epoch: 6 | loss: 0.1546171
	speed: 0.0104s/iter; left time: 84.5132s
	iters: 500, epoch: 6 | loss: 0.1879481
	speed: 0.0103s/iter; left time: 82.8095s
Epoch: 6 cost time: 6.240540504455566
Epoch: 6, Steps: 570 | Train Loss: 0.1923343 Vali Loss: 0.0399473 Test Loss: 0.1364636
Validation loss decreased (0.041359 --> 0.039947).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1333522
	speed: 0.0408s/iter; left time: 321.3452s
	iters: 200, epoch: 7 | loss: 0.1459925
	speed: 0.0104s/iter; left time: 80.9475s
	iters: 300, epoch: 7 | loss: 0.1591315
	speed: 0.0104s/iter; left time: 79.6134s
	iters: 400, epoch: 7 | loss: 0.1218084
	speed: 0.0106s/iter; left time: 80.3714s
	iters: 500, epoch: 7 | loss: 0.2205799
	speed: 0.0119s/iter; left time: 88.7007s
Epoch: 7 cost time: 6.623394727706909
Epoch: 7, Steps: 570 | Train Loss: 0.1902240 Vali Loss: 0.0401278 Test Loss: 0.1362865
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1542552
	speed: 0.0397s/iter; left time: 290.2566s
	iters: 200, epoch: 8 | loss: 0.1557491
	speed: 0.0106s/iter; left time: 76.5559s
	iters: 300, epoch: 8 | loss: 0.2015302
	speed: 0.0116s/iter; left time: 82.1529s
	iters: 400, epoch: 8 | loss: 0.2496035
	speed: 0.0116s/iter; left time: 81.1489s
	iters: 500, epoch: 8 | loss: 0.1776606
	speed: 0.0107s/iter; left time: 73.8375s
Epoch: 8 cost time: 6.497991561889648
Epoch: 8, Steps: 570 | Train Loss: 0.1867167 Vali Loss: 0.0399168 Test Loss: 0.1367334
Validation loss decreased (0.039947 --> 0.039917).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1747720
	speed: 0.0369s/iter; left time: 248.6340s
	iters: 200, epoch: 9 | loss: 0.2126442
	speed: 0.0103s/iter; left time: 68.0737s
	iters: 300, epoch: 9 | loss: 0.1602333
	speed: 0.0102s/iter; left time: 67.0327s
	iters: 400, epoch: 9 | loss: 0.1424625
	speed: 0.0109s/iter; left time: 70.0294s
	iters: 500, epoch: 9 | loss: 0.2186947
	speed: 0.0118s/iter; left time: 74.6323s
Epoch: 9 cost time: 6.487844228744507
Epoch: 9, Steps: 570 | Train Loss: 0.1861194 Vali Loss: 0.0402283 Test Loss: 0.1366536
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1741327
	speed: 0.0392s/iter; left time: 241.6434s
	iters: 200, epoch: 10 | loss: 0.2627142
	speed: 0.0117s/iter; left time: 71.0956s
	iters: 300, epoch: 10 | loss: 0.2688121
	speed: 0.0117s/iter; left time: 69.8912s
	iters: 400, epoch: 10 | loss: 0.1908757
	speed: 0.0117s/iter; left time: 68.7079s
	iters: 500, epoch: 10 | loss: 0.2230720
	speed: 0.0117s/iter; left time: 67.4515s
Epoch: 10 cost time: 6.9672863483428955
Epoch: 10, Steps: 570 | Train Loss: 0.1867551 Vali Loss: 0.0400570 Test Loss: 0.1362414
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1938286
	speed: 0.0392s/iter; left time: 219.3349s
	iters: 200, epoch: 11 | loss: 0.1627188
	speed: 0.0118s/iter; left time: 65.0218s
	iters: 300, epoch: 11 | loss: 0.2170820
	speed: 0.0118s/iter; left time: 63.8301s
	iters: 400, epoch: 11 | loss: 0.2244866
	speed: 0.0119s/iter; left time: 62.9558s
	iters: 500, epoch: 11 | loss: 0.2462322
	speed: 0.0118s/iter; left time: 61.4932s
Epoch: 11 cost time: 7.053137540817261
Epoch: 11, Steps: 570 | Train Loss: 0.1864245 Vali Loss: 0.0398796 Test Loss: 0.1360435
Validation loss decreased (0.039917 --> 0.039880).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1808738
	speed: 0.0413s/iter; left time: 207.9797s
	iters: 200, epoch: 12 | loss: 0.1594759
	speed: 0.0117s/iter; left time: 57.4948s
	iters: 300, epoch: 12 | loss: 0.1437175
	speed: 0.0104s/iter; left time: 50.1437s
	iters: 400, epoch: 12 | loss: 0.1823410
	speed: 0.0104s/iter; left time: 49.0478s
	iters: 500, epoch: 12 | loss: 0.1034540
	speed: 0.0104s/iter; left time: 48.0590s
Epoch: 12 cost time: 6.544623613357544
Epoch: 12, Steps: 570 | Train Loss: 0.1860450 Vali Loss: 0.0398726 Test Loss: 0.1361409
Validation loss decreased (0.039880 --> 0.039873).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2046220
	speed: 0.0375s/iter; left time: 167.3559s
	iters: 200, epoch: 13 | loss: 0.1521874
	speed: 0.0102s/iter; left time: 44.6379s
	iters: 300, epoch: 13 | loss: 0.1769326
	speed: 0.0102s/iter; left time: 43.6510s
	iters: 400, epoch: 13 | loss: 0.2124383
	speed: 0.0102s/iter; left time: 42.6088s
	iters: 500, epoch: 13 | loss: 0.1723673
	speed: 0.0103s/iter; left time: 41.6256s
Epoch: 13 cost time: 6.1624791622161865
Epoch: 13, Steps: 570 | Train Loss: 0.1875567 Vali Loss: 0.0399631 Test Loss: 0.1361620
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2162536
	speed: 0.0364s/iter; left time: 141.8229s
	iters: 200, epoch: 14 | loss: 0.2424447
	speed: 0.0103s/iter; left time: 38.9190s
	iters: 300, epoch: 14 | loss: 0.1476238
	speed: 0.0103s/iter; left time: 37.9850s
	iters: 400, epoch: 14 | loss: 0.1274017
	speed: 0.0103s/iter; left time: 36.9820s
	iters: 500, epoch: 14 | loss: 0.2173753
	speed: 0.0103s/iter; left time: 35.9487s
Epoch: 14 cost time: 6.180737257003784
Epoch: 14, Steps: 570 | Train Loss: 0.1865844 Vali Loss: 0.0398343 Test Loss: 0.1361711
Validation loss decreased (0.039873 --> 0.039834).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1360732
	speed: 0.0372s/iter; left time: 123.6770s
	iters: 200, epoch: 15 | loss: 0.2466209
	speed: 0.0103s/iter; left time: 33.3102s
	iters: 300, epoch: 15 | loss: 0.1103166
	speed: 0.0103s/iter; left time: 32.2640s
	iters: 400, epoch: 15 | loss: 0.0973444
	speed: 0.0104s/iter; left time: 31.2704s
	iters: 500, epoch: 15 | loss: 0.2756796
	speed: 0.0103s/iter; left time: 30.1563s
Epoch: 15 cost time: 6.228644609451294
Epoch: 15, Steps: 570 | Train Loss: 0.1855647 Vali Loss: 0.0398683 Test Loss: 0.1361655
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.2120662
	speed: 0.0375s/iter; left time: 103.2835s
	iters: 200, epoch: 16 | loss: 0.1393612
	speed: 0.0103s/iter; left time: 27.2930s
	iters: 300, epoch: 16 | loss: 0.1923253
	speed: 0.0102s/iter; left time: 26.1474s
	iters: 400, epoch: 16 | loss: 0.2070975
	speed: 0.0103s/iter; left time: 25.1685s
	iters: 500, epoch: 16 | loss: 0.2155225
	speed: 0.0103s/iter; left time: 24.1393s
Epoch: 16 cost time: 6.228386640548706
Epoch: 16, Steps: 570 | Train Loss: 0.1856985 Vali Loss: 0.0400992 Test Loss: 0.1361604
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1610325
	speed: 0.0380s/iter; left time: 82.9811s
	iters: 200, epoch: 17 | loss: 0.1361261
	speed: 0.0103s/iter; left time: 21.3635s
	iters: 300, epoch: 17 | loss: 0.1104676
	speed: 0.0103s/iter; left time: 20.3596s
	iters: 400, epoch: 17 | loss: 0.1915974
	speed: 0.0103s/iter; left time: 19.3769s
	iters: 500, epoch: 17 | loss: 0.1366606
	speed: 0.0103s/iter; left time: 18.3189s
Epoch: 17 cost time: 6.25071120262146
Epoch: 17, Steps: 570 | Train Loss: 0.1840708 Vali Loss: 0.0400736 Test Loss: 0.1361620
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1363270878791809, mae:0.23142485320568085
>>> MS_Pen LR=1e-3 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3108985
	speed: 0.0249s/iter; left time: 280.9164s
	iters: 200, epoch: 1 | loss: 0.3459192
	speed: 0.0129s/iter; left time: 144.5708s
	iters: 300, epoch: 1 | loss: 0.2123727
	speed: 0.0129s/iter; left time: 142.9253s
	iters: 400, epoch: 1 | loss: 0.1736775
	speed: 0.0129s/iter; left time: 141.7394s
	iters: 500, epoch: 1 | loss: 0.2736986
	speed: 0.0129s/iter; left time: 140.7323s
Epoch: 1 cost time: 8.60110068321228
Epoch: 1, Steps: 570 | Train Loss: 0.3002270 Vali Loss: 0.0519224 Test Loss: 0.1533709
Validation loss decreased (inf --> 0.051922).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2643891
	speed: 0.0411s/iter; left time: 440.5297s
	iters: 200, epoch: 2 | loss: 0.2336901
	speed: 0.0128s/iter; left time: 136.3320s
	iters: 300, epoch: 2 | loss: 0.3321570
	speed: 0.0128s/iter; left time: 134.8025s
	iters: 400, epoch: 2 | loss: 0.2203739
	speed: 0.0128s/iter; left time: 133.7092s
	iters: 500, epoch: 2 | loss: 0.2897434
	speed: 0.0128s/iter; left time: 132.3245s
Epoch: 2 cost time: 7.534605264663696
Epoch: 2, Steps: 570 | Train Loss: 0.3205155 Vali Loss: 0.0614729 Test Loss: 0.1749561
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3290762
	speed: 0.0414s/iter; left time: 421.0216s
	iters: 200, epoch: 3 | loss: 0.3495538
	speed: 0.0122s/iter; left time: 122.8360s
	iters: 300, epoch: 3 | loss: 0.1733610
	speed: 0.0119s/iter; left time: 118.8004s
	iters: 400, epoch: 3 | loss: 0.2143624
	speed: 0.0119s/iter; left time: 117.4738s
	iters: 500, epoch: 3 | loss: 0.2427330
	speed: 0.0119s/iter; left time: 116.1532s
Epoch: 3 cost time: 7.177685737609863
Epoch: 3, Steps: 570 | Train Loss: 0.2775466 Vali Loss: 0.0540000 Test Loss: 0.1559165
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1748521
	speed: 0.0394s/iter; left time: 377.7567s
	iters: 200, epoch: 4 | loss: 0.3018908
	speed: 0.0119s/iter; left time: 112.5007s
	iters: 300, epoch: 4 | loss: 0.1931645
	speed: 0.0119s/iter; left time: 111.4154s
	iters: 400, epoch: 4 | loss: 0.2066137
	speed: 0.0119s/iter; left time: 110.1369s
	iters: 500, epoch: 4 | loss: 0.2450958
	speed: 0.0118s/iter; left time: 108.8617s
Epoch: 4 cost time: 7.032356262207031
Epoch: 4, Steps: 570 | Train Loss: 0.2616481 Vali Loss: 0.0519467 Test Loss: 0.1535148
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1536162942647934, mae:0.24487291276454926
>>> MS_Pen LR=1e-3 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1705695
	speed: 0.0234s/iter; left time: 264.5926s
	iters: 200, epoch: 1 | loss: 0.3666598
	speed: 0.0114s/iter; left time: 128.0671s
	iters: 300, epoch: 1 | loss: 0.2076761
	speed: 0.0114s/iter; left time: 127.0146s
	iters: 400, epoch: 1 | loss: 0.2615184
	speed: 0.0114s/iter; left time: 125.6182s
	iters: 500, epoch: 1 | loss: 0.1936897
	speed: 0.0114s/iter; left time: 124.5673s
Epoch: 1 cost time: 7.759258031845093
Epoch: 1, Steps: 570 | Train Loss: 0.2676962 Vali Loss: 0.0601982 Test Loss: 0.1873419
Validation loss decreased (inf --> 0.060198).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2798041
	speed: 0.0396s/iter; left time: 424.4675s
	iters: 200, epoch: 2 | loss: 0.2019880
	speed: 0.0115s/iter; left time: 122.2399s
	iters: 300, epoch: 2 | loss: 0.2365189
	speed: 0.0125s/iter; left time: 131.8008s
	iters: 400, epoch: 2 | loss: 0.3627235
	speed: 0.0125s/iter; left time: 130.8397s
	iters: 500, epoch: 2 | loss: 0.5340703
	speed: 0.0125s/iter; left time: 129.6495s
Epoch: 2 cost time: 7.250175952911377
Epoch: 2, Steps: 570 | Train Loss: 0.3176589 Vali Loss: 0.0628528 Test Loss: 0.1879112
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3681116
	speed: 0.0394s/iter; left time: 400.1149s
	iters: 200, epoch: 3 | loss: 0.1560963
	speed: 0.0115s/iter; left time: 115.2962s
	iters: 300, epoch: 3 | loss: 0.2941972
	speed: 0.0115s/iter; left time: 114.3512s
	iters: 400, epoch: 3 | loss: 0.2526754
	speed: 0.0115s/iter; left time: 113.2152s
	iters: 500, epoch: 3 | loss: 0.3485654
	speed: 0.0115s/iter; left time: 111.9312s
Epoch: 3 cost time: 6.818010091781616
Epoch: 3, Steps: 570 | Train Loss: 0.2824960 Vali Loss: 0.0557231 Test Loss: 0.1684469
Validation loss decreased (0.060198 --> 0.055723).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2530393
	speed: 0.0384s/iter; left time: 368.3326s
	iters: 200, epoch: 4 | loss: 0.1597265
	speed: 0.0114s/iter; left time: 108.5577s
	iters: 300, epoch: 4 | loss: 0.1345567
	speed: 0.0114s/iter; left time: 107.1907s
	iters: 400, epoch: 4 | loss: 0.1971449
	speed: 0.0115s/iter; left time: 106.4796s
	iters: 500, epoch: 4 | loss: 0.2409697
	speed: 0.0115s/iter; left time: 105.2478s
Epoch: 4 cost time: 6.830554008483887
Epoch: 4, Steps: 570 | Train Loss: 0.2607098 Vali Loss: 0.0565890 Test Loss: 0.1655181
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2639130
	speed: 0.0378s/iter; left time: 341.0871s
	iters: 200, epoch: 5 | loss: 0.2229205
	speed: 0.0115s/iter; left time: 102.3420s
	iters: 300, epoch: 5 | loss: 0.3441359
	speed: 0.0115s/iter; left time: 101.1020s
	iters: 400, epoch: 5 | loss: 0.2438875
	speed: 0.0115s/iter; left time: 100.2133s
	iters: 500, epoch: 5 | loss: 0.2143305
	speed: 0.0115s/iter; left time: 98.8796s
Epoch: 5 cost time: 6.858383655548096
Epoch: 5, Steps: 570 | Train Loss: 0.2522585 Vali Loss: 0.0533597 Test Loss: 0.1587470
Validation loss decreased (0.055723 --> 0.053360).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3193189
	speed: 0.0391s/iter; left time: 330.6790s
	iters: 200, epoch: 6 | loss: 0.2999222
	speed: 0.0115s/iter; left time: 95.9672s
	iters: 300, epoch: 6 | loss: 0.1626950
	speed: 0.0115s/iter; left time: 94.6821s
	iters: 400, epoch: 6 | loss: 0.1717363
	speed: 0.0115s/iter; left time: 93.4058s
	iters: 500, epoch: 6 | loss: 0.1638107
	speed: 0.0115s/iter; left time: 92.3456s
Epoch: 6 cost time: 6.858415603637695
Epoch: 6, Steps: 570 | Train Loss: 0.2477514 Vali Loss: 0.0526441 Test Loss: 0.1565232
Validation loss decreased (0.053360 --> 0.052644).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1826701
	speed: 0.0387s/iter; left time: 305.0666s
	iters: 200, epoch: 7 | loss: 0.2884090
	speed: 0.0114s/iter; left time: 89.0135s
	iters: 300, epoch: 7 | loss: 0.2116523
	speed: 0.0115s/iter; left time: 88.0277s
	iters: 400, epoch: 7 | loss: 0.2129006
	speed: 0.0115s/iter; left time: 86.8906s
	iters: 500, epoch: 7 | loss: 0.2131337
	speed: 0.0114s/iter; left time: 85.5802s
Epoch: 7 cost time: 6.814671277999878
Epoch: 7, Steps: 570 | Train Loss: 0.2449411 Vali Loss: 0.0520947 Test Loss: 0.1555893
Validation loss decreased (0.052644 --> 0.052095).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1624478
	speed: 0.0387s/iter; left time: 282.8824s
	iters: 200, epoch: 8 | loss: 0.2543824
	speed: 0.0115s/iter; left time: 82.6381s
	iters: 300, epoch: 8 | loss: 0.2270102
	speed: 0.0114s/iter; left time: 81.2627s
	iters: 400, epoch: 8 | loss: 0.1925716
	speed: 0.0114s/iter; left time: 80.1008s
	iters: 500, epoch: 8 | loss: 0.1984042
	speed: 0.0114s/iter; left time: 78.9365s
Epoch: 8 cost time: 6.846925497055054
Epoch: 8, Steps: 570 | Train Loss: 0.2443318 Vali Loss: 0.0523681 Test Loss: 0.1554036
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3243343
	speed: 0.0382s/iter; left time: 257.7691s
	iters: 200, epoch: 9 | loss: 0.1539838
	speed: 0.0125s/iter; left time: 83.2146s
	iters: 300, epoch: 9 | loss: 0.2648263
	speed: 0.0119s/iter; left time: 78.0509s
	iters: 400, epoch: 9 | loss: 0.2936597
	speed: 0.0114s/iter; left time: 73.3839s
	iters: 500, epoch: 9 | loss: 0.3290230
	speed: 0.0114s/iter; left time: 72.2905s
Epoch: 9 cost time: 7.0598485469818115
Epoch: 9, Steps: 570 | Train Loss: 0.2423616 Vali Loss: 0.0517487 Test Loss: 0.1550124
Validation loss decreased (0.052095 --> 0.051749).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2034781
	speed: 0.0379s/iter; left time: 233.6957s
	iters: 200, epoch: 10 | loss: 0.1959935
	speed: 0.0114s/iter; left time: 69.2995s
	iters: 300, epoch: 10 | loss: 0.1723224
	speed: 0.0114s/iter; left time: 68.1855s
	iters: 400, epoch: 10 | loss: 0.2220239
	speed: 0.0114s/iter; left time: 67.0818s
	iters: 500, epoch: 10 | loss: 0.3290251
	speed: 0.0114s/iter; left time: 65.8367s
Epoch: 10 cost time: 6.813255548477173
Epoch: 10, Steps: 570 | Train Loss: 0.2446683 Vali Loss: 0.0520638 Test Loss: 0.1550826
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1436054
	speed: 0.0381s/iter; left time: 213.3559s
	iters: 200, epoch: 11 | loss: 0.2485403
	speed: 0.0115s/iter; left time: 63.1510s
	iters: 300, epoch: 11 | loss: 0.2529294
	speed: 0.0115s/iter; left time: 62.1612s
	iters: 400, epoch: 11 | loss: 0.2552961
	speed: 0.0115s/iter; left time: 60.9765s
	iters: 500, epoch: 11 | loss: 0.3322392
	speed: 0.0115s/iter; left time: 59.6667s
Epoch: 11 cost time: 6.86368727684021
Epoch: 11, Steps: 570 | Train Loss: 0.2436862 Vali Loss: 0.0519613 Test Loss: 0.1550563
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2085977
	speed: 0.0375s/iter; left time: 188.8840s
	iters: 200, epoch: 12 | loss: 0.1958880
	speed: 0.0115s/iter; left time: 56.4610s
	iters: 300, epoch: 12 | loss: 0.1756441
	speed: 0.0115s/iter; left time: 55.3505s
	iters: 400, epoch: 12 | loss: 0.3267347
	speed: 0.0114s/iter; left time: 54.1491s
	iters: 500, epoch: 12 | loss: 0.2021970
	speed: 0.0115s/iter; left time: 53.1965s
Epoch: 12 cost time: 6.811952114105225
Epoch: 12, Steps: 570 | Train Loss: 0.2451985 Vali Loss: 0.0521495 Test Loss: 0.1550149
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15524740517139435, mae:0.25473248958587646
>>> MS_Pen LR=1e-3 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2954969
	speed: 0.0242s/iter; left time: 273.4266s
	iters: 200, epoch: 1 | loss: 0.3859105
	speed: 0.0118s/iter; left time: 132.3790s
	iters: 300, epoch: 1 | loss: 0.5482857
	speed: 0.0108s/iter; left time: 119.8916s
	iters: 400, epoch: 1 | loss: 0.4214580
	speed: 0.0108s/iter; left time: 118.8942s
	iters: 500, epoch: 1 | loss: 0.3618134
	speed: 0.0118s/iter; left time: 128.1779s
Epoch: 1 cost time: 7.827408790588379
Epoch: 1, Steps: 570 | Train Loss: 0.3324003 Vali Loss: 0.0719104 Test Loss: 0.1949365
Validation loss decreased (inf --> 0.071910).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3198957
	speed: 0.0395s/iter; left time: 423.4845s
	iters: 200, epoch: 2 | loss: 0.3558821
	speed: 0.0125s/iter; left time: 132.6859s
	iters: 300, epoch: 2 | loss: 0.2035636
	speed: 0.0125s/iter; left time: 131.1915s
	iters: 400, epoch: 2 | loss: 0.2036389
	speed: 0.0125s/iter; left time: 130.1475s
	iters: 500, epoch: 2 | loss: 0.2165546
	speed: 0.0125s/iter; left time: 128.8603s
Epoch: 2 cost time: 7.420350074768066
Epoch: 2, Steps: 570 | Train Loss: 0.2984768 Vali Loss: 0.0579482 Test Loss: 0.1746220
Validation loss decreased (0.071910 --> 0.057948).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1781446
	speed: 0.0401s/iter; left time: 407.3106s
	iters: 200, epoch: 3 | loss: 0.2638286
	speed: 0.0108s/iter; left time: 108.6618s
	iters: 300, epoch: 3 | loss: 0.2785007
	speed: 0.0108s/iter; left time: 107.4938s
	iters: 400, epoch: 3 | loss: 0.2847319
	speed: 0.0108s/iter; left time: 106.2122s
	iters: 500, epoch: 3 | loss: 0.2608134
	speed: 0.0108s/iter; left time: 105.2600s
Epoch: 3 cost time: 6.557942152023315
Epoch: 3, Steps: 570 | Train Loss: 0.2767623 Vali Loss: 0.0566190 Test Loss: 0.1599094
Validation loss decreased (0.057948 --> 0.056619).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2515345
	speed: 0.0382s/iter; left time: 366.2008s
	iters: 200, epoch: 4 | loss: 0.1034869
	speed: 0.0109s/iter; left time: 103.4350s
	iters: 300, epoch: 4 | loss: 0.2314176
	speed: 0.0109s/iter; left time: 102.2530s
	iters: 400, epoch: 4 | loss: 0.4255664
	speed: 0.0109s/iter; left time: 101.4184s
	iters: 500, epoch: 4 | loss: 0.3124464
	speed: 0.0109s/iter; left time: 100.2060s
Epoch: 4 cost time: 6.5161755084991455
Epoch: 4, Steps: 570 | Train Loss: 0.2660459 Vali Loss: 0.0559953 Test Loss: 0.1606341
Validation loss decreased (0.056619 --> 0.055995).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2288418
	speed: 0.0373s/iter; left time: 336.8745s
	iters: 200, epoch: 5 | loss: 0.2493555
	speed: 0.0109s/iter; left time: 96.9740s
	iters: 300, epoch: 5 | loss: 0.2115756
	speed: 0.0120s/iter; left time: 106.2606s
	iters: 400, epoch: 5 | loss: 0.2098181
	speed: 0.0124s/iter; left time: 108.5521s
	iters: 500, epoch: 5 | loss: 0.3153959
	speed: 0.0124s/iter; left time: 107.1928s
Epoch: 5 cost time: 7.060575723648071
Epoch: 5, Steps: 570 | Train Loss: 0.2610736 Vali Loss: 0.0533021 Test Loss: 0.1545282
Validation loss decreased (0.055995 --> 0.053302).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2017622
	speed: 0.0398s/iter; left time: 336.6145s
	iters: 200, epoch: 6 | loss: 0.2228530
	speed: 0.0120s/iter; left time: 100.3797s
	iters: 300, epoch: 6 | loss: 0.2827265
	speed: 0.0120s/iter; left time: 99.0479s
	iters: 400, epoch: 6 | loss: 0.2044997
	speed: 0.0120s/iter; left time: 98.0745s
	iters: 500, epoch: 6 | loss: 0.3314768
	speed: 0.0120s/iter; left time: 96.6979s
Epoch: 6 cost time: 7.1828227043151855
Epoch: 6, Steps: 570 | Train Loss: 0.2563877 Vali Loss: 0.0542254 Test Loss: 0.1523738
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2252184
	speed: 0.0386s/iter; left time: 304.5600s
	iters: 200, epoch: 7 | loss: 0.2013411
	speed: 0.0108s/iter; left time: 83.8339s
	iters: 300, epoch: 7 | loss: 0.1663969
	speed: 0.0108s/iter; left time: 82.8882s
	iters: 400, epoch: 7 | loss: 0.2190889
	speed: 0.0108s/iter; left time: 81.6153s
	iters: 500, epoch: 7 | loss: 0.1944323
	speed: 0.0108s/iter; left time: 80.4982s
Epoch: 7 cost time: 6.4252142906188965
Epoch: 7, Steps: 570 | Train Loss: 0.2531854 Vali Loss: 0.0533289 Test Loss: 0.1518606
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1695509
	speed: 0.0371s/iter; left time: 271.1922s
	iters: 200, epoch: 8 | loss: 0.3082929
	speed: 0.0108s/iter; left time: 78.0729s
	iters: 300, epoch: 8 | loss: 0.3242790
	speed: 0.0109s/iter; left time: 77.2050s
	iters: 400, epoch: 8 | loss: 0.2297665
	speed: 0.0108s/iter; left time: 75.8991s
	iters: 500, epoch: 8 | loss: 0.1537072
	speed: 0.0108s/iter; left time: 74.7885s
Epoch: 8 cost time: 6.4679036140441895
Epoch: 8, Steps: 570 | Train Loss: 0.2530025 Vali Loss: 0.0531539 Test Loss: 0.1513540
Validation loss decreased (0.053302 --> 0.053154).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2222231
	speed: 0.0380s/iter; left time: 256.4672s
	iters: 200, epoch: 9 | loss: 0.1852013
	speed: 0.0108s/iter; left time: 72.0055s
	iters: 300, epoch: 9 | loss: 0.2790197
	speed: 0.0108s/iter; left time: 70.9103s
	iters: 400, epoch: 9 | loss: 0.3283579
	speed: 0.0109s/iter; left time: 69.9967s
	iters: 500, epoch: 9 | loss: 0.1437204
	speed: 0.0109s/iter; left time: 68.8154s
Epoch: 9 cost time: 6.49024224281311
Epoch: 9, Steps: 570 | Train Loss: 0.2513664 Vali Loss: 0.0535253 Test Loss: 0.1513746
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2830880
	speed: 0.0373s/iter; left time: 229.8923s
	iters: 200, epoch: 10 | loss: 0.1302060
	speed: 0.0109s/iter; left time: 66.2495s
	iters: 300, epoch: 10 | loss: 0.3390233
	speed: 0.0109s/iter; left time: 65.2756s
	iters: 400, epoch: 10 | loss: 0.1546450
	speed: 0.0110s/iter; left time: 64.3193s
	iters: 500, epoch: 10 | loss: 0.2498090
	speed: 0.0109s/iter; left time: 63.0539s
Epoch: 10 cost time: 6.510168552398682
Epoch: 10, Steps: 570 | Train Loss: 0.2518028 Vali Loss: 0.0533300 Test Loss: 0.1512511
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1899330
	speed: 0.0369s/iter; left time: 206.8051s
	iters: 200, epoch: 11 | loss: 0.2446003
	speed: 0.0109s/iter; left time: 59.7111s
	iters: 300, epoch: 11 | loss: 0.1824645
	speed: 0.0109s/iter; left time: 58.8210s
	iters: 400, epoch: 11 | loss: 0.1625489
	speed: 0.0109s/iter; left time: 57.6536s
	iters: 500, epoch: 11 | loss: 0.1800208
	speed: 0.0109s/iter; left time: 56.5961s
Epoch: 11 cost time: 6.5022361278533936
Epoch: 11, Steps: 570 | Train Loss: 0.2517493 Vali Loss: 0.0532470 Test Loss: 0.1512650
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1515783965587616, mae:0.24895302951335907
>>> MS_Pen LR=1e-3 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2272203
	speed: 0.0263s/iter; left time: 297.5116s
	iters: 200, epoch: 1 | loss: 0.1933531
	speed: 0.0146s/iter; left time: 163.5579s
	iters: 300, epoch: 1 | loss: 0.3700464
	speed: 0.0146s/iter; left time: 161.8367s
	iters: 400, epoch: 1 | loss: 0.3035750
	speed: 0.0146s/iter; left time: 160.4725s
	iters: 500, epoch: 1 | loss: 0.1833917
	speed: 0.0146s/iter; left time: 159.0690s
Epoch: 1 cost time: 9.53995132446289
Epoch: 1, Steps: 570 | Train Loss: 0.2741370 Vali Loss: 0.0623567 Test Loss: 0.1811329
Validation loss decreased (inf --> 0.062357).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3714340
	speed: 0.0468s/iter; left time: 502.4916s
	iters: 200, epoch: 2 | loss: 0.3029926
	speed: 0.0145s/iter; left time: 153.7593s
	iters: 300, epoch: 2 | loss: 0.2417487
	speed: 0.0145s/iter; left time: 152.3846s
	iters: 400, epoch: 2 | loss: 0.2025651
	speed: 0.0145s/iter; left time: 150.9991s
	iters: 500, epoch: 2 | loss: 0.3197419
	speed: 0.0145s/iter; left time: 149.8353s
Epoch: 2 cost time: 8.559468746185303
Epoch: 2, Steps: 570 | Train Loss: 0.3052657 Vali Loss: 0.0569718 Test Loss: 0.1734459
Validation loss decreased (0.062357 --> 0.056972).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4435502
	speed: 0.0458s/iter; left time: 465.2352s
	iters: 200, epoch: 3 | loss: 0.3228258
	speed: 0.0144s/iter; left time: 144.9147s
	iters: 300, epoch: 3 | loss: 0.1408543
	speed: 0.0145s/iter; left time: 144.4388s
	iters: 400, epoch: 3 | loss: 0.2534462
	speed: 0.0145s/iter; left time: 143.4292s
	iters: 500, epoch: 3 | loss: 0.2227151
	speed: 0.0145s/iter; left time: 141.3852s
Epoch: 3 cost time: 8.553852081298828
Epoch: 3, Steps: 570 | Train Loss: 0.2775301 Vali Loss: 0.0570345 Test Loss: 0.1680477
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2464219
	speed: 0.0451s/iter; left time: 432.1533s
	iters: 200, epoch: 4 | loss: 0.2184783
	speed: 0.0146s/iter; left time: 138.5232s
	iters: 300, epoch: 4 | loss: 0.2400331
	speed: 0.0146s/iter; left time: 137.0794s
	iters: 400, epoch: 4 | loss: 0.2754682
	speed: 0.0146s/iter; left time: 135.2054s
	iters: 500, epoch: 4 | loss: 0.2277149
	speed: 0.0145s/iter; left time: 133.1638s
Epoch: 4 cost time: 8.534348726272583
Epoch: 4, Steps: 570 | Train Loss: 0.2659473 Vali Loss: 0.0532775 Test Loss: 0.1559451
Validation loss decreased (0.056972 --> 0.053277).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2228382
	speed: 0.0461s/iter; left time: 415.9906s
	iters: 200, epoch: 5 | loss: 0.2066480
	speed: 0.0145s/iter; left time: 129.3652s
	iters: 300, epoch: 5 | loss: 0.2173893
	speed: 0.0145s/iter; left time: 128.0468s
	iters: 400, epoch: 5 | loss: 0.3371693
	speed: 0.0145s/iter; left time: 126.3114s
	iters: 500, epoch: 5 | loss: 0.2777773
	speed: 0.0145s/iter; left time: 124.8789s
Epoch: 5 cost time: 8.529585361480713
Epoch: 5, Steps: 570 | Train Loss: 0.2594494 Vali Loss: 0.0527060 Test Loss: 0.1536863
Validation loss decreased (0.053277 --> 0.052706).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1929220
	speed: 0.0491s/iter; left time: 415.0830s
	iters: 200, epoch: 6 | loss: 0.2268897
	speed: 0.0152s/iter; left time: 127.0530s
	iters: 300, epoch: 6 | loss: 0.1632645
	speed: 0.0145s/iter; left time: 119.7096s
	iters: 400, epoch: 6 | loss: 0.1641586
	speed: 0.0145s/iter; left time: 118.2047s
	iters: 500, epoch: 6 | loss: 0.2668280
	speed: 0.0145s/iter; left time: 116.7793s
Epoch: 6 cost time: 8.79984974861145
Epoch: 6, Steps: 570 | Train Loss: 0.2540632 Vali Loss: 0.0526574 Test Loss: 0.1521882
Validation loss decreased (0.052706 --> 0.052657).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2011261
	speed: 0.0497s/iter; left time: 391.3417s
	iters: 200, epoch: 7 | loss: 0.1548195
	speed: 0.0145s/iter; left time: 112.4957s
	iters: 300, epoch: 7 | loss: 0.2380850
	speed: 0.0145s/iter; left time: 111.3319s
	iters: 400, epoch: 7 | loss: 0.2743579
	speed: 0.0145s/iter; left time: 109.8304s
	iters: 500, epoch: 7 | loss: 0.3396780
	speed: 0.0145s/iter; left time: 108.2757s
Epoch: 7 cost time: 8.527945041656494
Epoch: 7, Steps: 570 | Train Loss: 0.2522021 Vali Loss: 0.0528502 Test Loss: 0.1508166
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3641231
	speed: 0.0448s/iter; left time: 327.4511s
	iters: 200, epoch: 8 | loss: 0.2902711
	speed: 0.0145s/iter; left time: 104.5624s
	iters: 300, epoch: 8 | loss: 0.3985306
	speed: 0.0145s/iter; left time: 103.0572s
	iters: 400, epoch: 8 | loss: 0.1770813
	speed: 0.0144s/iter; left time: 101.1952s
	iters: 500, epoch: 8 | loss: 0.3242327
	speed: 0.0145s/iter; left time: 100.0197s
Epoch: 8 cost time: 8.509148359298706
Epoch: 8, Steps: 570 | Train Loss: 0.2529673 Vali Loss: 0.0529297 Test Loss: 0.1506264
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2880127
	speed: 0.0454s/iter; left time: 305.7624s
	iters: 200, epoch: 9 | loss: 0.3123119
	speed: 0.0144s/iter; left time: 95.9313s
	iters: 300, epoch: 9 | loss: 0.5284764
	speed: 0.0144s/iter; left time: 94.4959s
	iters: 400, epoch: 9 | loss: 0.2752268
	speed: 0.0144s/iter; left time: 93.0562s
	iters: 500, epoch: 9 | loss: 0.1681106
	speed: 0.0144s/iter; left time: 91.5730s
Epoch: 9 cost time: 8.481863498687744
Epoch: 9, Steps: 570 | Train Loss: 0.2489363 Vali Loss: 0.0530628 Test Loss: 0.1505362
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15242402255535126, mae:0.24937394261360168
>>> MS_Pen LR=1e-3 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3485701
	speed: 0.0257s/iter; left time: 289.9305s
	iters: 200, epoch: 1 | loss: 0.3113614
	speed: 0.0142s/iter; left time: 159.2320s
	iters: 300, epoch: 1 | loss: 0.1591527
	speed: 0.0142s/iter; left time: 157.6843s
	iters: 400, epoch: 1 | loss: 0.3692232
	speed: 0.0142s/iter; left time: 156.3401s
	iters: 500, epoch: 1 | loss: 0.2102203
	speed: 0.0142s/iter; left time: 154.8988s
Epoch: 1 cost time: 9.294409036636353
Epoch: 1, Steps: 570 | Train Loss: 0.2462291 Vali Loss: 0.0504803 Test Loss: 0.1532918
Validation loss decreased (inf --> 0.050480).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1940119
	speed: 0.0449s/iter; left time: 481.4857s
	iters: 200, epoch: 2 | loss: 0.3094847
	speed: 0.0142s/iter; left time: 150.9280s
	iters: 300, epoch: 2 | loss: 0.2721627
	speed: 0.0142s/iter; left time: 149.5485s
	iters: 400, epoch: 2 | loss: 0.1587809
	speed: 0.0142s/iter; left time: 148.2153s
	iters: 500, epoch: 2 | loss: 0.2387960
	speed: 0.0142s/iter; left time: 147.0460s
Epoch: 2 cost time: 8.39254117012024
Epoch: 2, Steps: 570 | Train Loss: 0.2554104 Vali Loss: 0.0489266 Test Loss: 0.1517773
Validation loss decreased (0.050480 --> 0.048927).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2249487
	speed: 0.0455s/iter; left time: 461.8693s
	iters: 200, epoch: 3 | loss: 0.1252227
	speed: 0.0142s/iter; left time: 142.4987s
	iters: 300, epoch: 3 | loss: 0.3260162
	speed: 0.0142s/iter; left time: 141.4325s
	iters: 400, epoch: 3 | loss: 0.1415161
	speed: 0.0142s/iter; left time: 140.1223s
	iters: 500, epoch: 3 | loss: 0.2009176
	speed: 0.0148s/iter; left time: 144.3806s
Epoch: 3 cost time: 8.522367238998413
Epoch: 3, Steps: 570 | Train Loss: 0.2270288 Vali Loss: 0.0453539 Test Loss: 0.1397322
Validation loss decreased (0.048927 --> 0.045354).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2115685
	speed: 0.0470s/iter; left time: 450.9525s
	iters: 200, epoch: 4 | loss: 0.1896150
	speed: 0.0142s/iter; left time: 134.8558s
	iters: 300, epoch: 4 | loss: 0.2411179
	speed: 0.0142s/iter; left time: 133.3744s
	iters: 400, epoch: 4 | loss: 0.1447599
	speed: 0.0142s/iter; left time: 132.0280s
	iters: 500, epoch: 4 | loss: 0.1285859
	speed: 0.0142s/iter; left time: 130.5867s
Epoch: 4 cost time: 8.41916823387146
Epoch: 4, Steps: 570 | Train Loss: 0.2070382 Vali Loss: 0.0439644 Test Loss: 0.1356342
Validation loss decreased (0.045354 --> 0.043964).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1192427
	speed: 0.0466s/iter; left time: 420.4595s
	iters: 200, epoch: 5 | loss: 0.2609248
	speed: 0.0143s/iter; left time: 127.4498s
	iters: 300, epoch: 5 | loss: 0.2234254
	speed: 0.0143s/iter; left time: 126.2407s
	iters: 400, epoch: 5 | loss: 0.1407506
	speed: 0.0142s/iter; left time: 124.2286s
	iters: 500, epoch: 5 | loss: 0.2021188
	speed: 0.0142s/iter; left time: 122.7030s
Epoch: 5 cost time: 8.38792872428894
Epoch: 5, Steps: 570 | Train Loss: 0.1979862 Vali Loss: 0.0420947 Test Loss: 0.1332260
Validation loss decreased (0.043964 --> 0.042095).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2168062
	speed: 0.0481s/iter; left time: 406.4710s
	iters: 200, epoch: 6 | loss: 0.3435604
	speed: 0.0143s/iter; left time: 119.3983s
	iters: 300, epoch: 6 | loss: 0.2989988
	speed: 0.0143s/iter; left time: 118.1175s
	iters: 400, epoch: 6 | loss: 0.1838902
	speed: 0.0143s/iter; left time: 116.7569s
	iters: 500, epoch: 6 | loss: 0.1875025
	speed: 0.0143s/iter; left time: 115.0917s
Epoch: 6 cost time: 8.427875757217407
Epoch: 6, Steps: 570 | Train Loss: 0.1922495 Vali Loss: 0.0415113 Test Loss: 0.1323656
Validation loss decreased (0.042095 --> 0.041511).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1275003
	speed: 0.0451s/iter; left time: 355.3332s
	iters: 200, epoch: 7 | loss: 0.1855213
	speed: 0.0141s/iter; left time: 110.0042s
	iters: 300, epoch: 7 | loss: 0.2600245
	speed: 0.0141s/iter; left time: 108.6433s
	iters: 400, epoch: 7 | loss: 0.1525622
	speed: 0.0141s/iter; left time: 107.0445s
	iters: 500, epoch: 7 | loss: 0.2443185
	speed: 0.0141s/iter; left time: 105.6222s
Epoch: 7 cost time: 8.355385780334473
Epoch: 7, Steps: 570 | Train Loss: 0.1900108 Vali Loss: 0.0413575 Test Loss: 0.1313452
Validation loss decreased (0.041511 --> 0.041357).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1718650
	speed: 0.0449s/iter; left time: 328.6263s
	iters: 200, epoch: 8 | loss: 0.1527798
	speed: 0.0142s/iter; left time: 102.4453s
	iters: 300, epoch: 8 | loss: 0.2736727
	speed: 0.0142s/iter; left time: 100.9575s
	iters: 400, epoch: 8 | loss: 0.2340536
	speed: 0.0142s/iter; left time: 99.4823s
	iters: 500, epoch: 8 | loss: 0.2001227
	speed: 0.0142s/iter; left time: 98.0640s
Epoch: 8 cost time: 8.383919477462769
Epoch: 8, Steps: 570 | Train Loss: 0.1881763 Vali Loss: 0.0410702 Test Loss: 0.1310940
Validation loss decreased (0.041357 --> 0.041070).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1437787
	speed: 0.0455s/iter; left time: 306.8089s
	iters: 200, epoch: 9 | loss: 0.1315756
	speed: 0.0143s/iter; left time: 94.7571s
	iters: 300, epoch: 9 | loss: 0.2443540
	speed: 0.0143s/iter; left time: 93.4940s
	iters: 400, epoch: 9 | loss: 0.2056708
	speed: 0.0143s/iter; left time: 91.9444s
	iters: 500, epoch: 9 | loss: 0.2210577
	speed: 0.0143s/iter; left time: 90.5370s
Epoch: 9 cost time: 8.427886962890625
Epoch: 9, Steps: 570 | Train Loss: 0.1870815 Vali Loss: 0.0410582 Test Loss: 0.1315101
Validation loss decreased (0.041070 --> 0.041058).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2246411
	speed: 0.0463s/iter; left time: 285.9400s
	iters: 200, epoch: 10 | loss: 0.1425713
	speed: 0.0143s/iter; left time: 86.5909s
	iters: 300, epoch: 10 | loss: 0.1920382
	speed: 0.0143s/iter; left time: 85.1214s
	iters: 400, epoch: 10 | loss: 0.2102857
	speed: 0.0142s/iter; left time: 83.4614s
	iters: 500, epoch: 10 | loss: 0.2087905
	speed: 0.0142s/iter; left time: 82.1140s
Epoch: 10 cost time: 8.4058256149292
Epoch: 10, Steps: 570 | Train Loss: 0.1876031 Vali Loss: 0.0409734 Test Loss: 0.1313485
Validation loss decreased (0.041058 --> 0.040973).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2479324
	speed: 0.0449s/iter; left time: 251.2461s
	iters: 200, epoch: 11 | loss: 0.2062574
	speed: 0.0141s/iter; left time: 77.6918s
	iters: 300, epoch: 11 | loss: 0.2221435
	speed: 0.0141s/iter; left time: 76.3428s
	iters: 400, epoch: 11 | loss: 0.1013395
	speed: 0.0141s/iter; left time: 74.8762s
	iters: 500, epoch: 11 | loss: 0.3271964
	speed: 0.0142s/iter; left time: 73.5946s
Epoch: 11 cost time: 8.31805944442749
Epoch: 11, Steps: 570 | Train Loss: 0.1863334 Vali Loss: 0.0411231 Test Loss: 0.1313294
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2570079
	speed: 0.0456s/iter; left time: 229.2595s
	iters: 200, epoch: 12 | loss: 0.2068394
	speed: 0.0142s/iter; left time: 69.8510s
	iters: 300, epoch: 12 | loss: 0.1710191
	speed: 0.0142s/iter; left time: 68.4518s
	iters: 400, epoch: 12 | loss: 0.1957142
	speed: 0.0142s/iter; left time: 67.3910s
	iters: 500, epoch: 12 | loss: 0.2258205
	speed: 0.0143s/iter; left time: 65.9998s
Epoch: 12 cost time: 8.40873122215271
Epoch: 12, Steps: 570 | Train Loss: 0.1872584 Vali Loss: 0.0411231 Test Loss: 0.1313380
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1533021
	speed: 0.0447s/iter; left time: 199.2482s
	iters: 200, epoch: 13 | loss: 0.1254266
	speed: 0.0143s/iter; left time: 62.4725s
	iters: 300, epoch: 13 | loss: 0.1436566
	speed: 0.0143s/iter; left time: 60.8577s
	iters: 400, epoch: 13 | loss: 0.0989945
	speed: 0.0143s/iter; left time: 59.4401s
	iters: 500, epoch: 13 | loss: 0.2045512
	speed: 0.0143s/iter; left time: 57.9947s
Epoch: 13 cost time: 8.423919439315796
Epoch: 13, Steps: 570 | Train Loss: 0.1870305 Vali Loss: 0.0410590 Test Loss: 0.1313520
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1315474957227707, mae:0.22323128581047058
>>> MS_Pen LR=1e-3 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1441758
	speed: 0.0259s/iter; left time: 293.0800s
	iters: 200, epoch: 1 | loss: 0.3497763
	speed: 0.0150s/iter; left time: 168.4193s
	iters: 300, epoch: 1 | loss: 0.3439338
	speed: 0.0160s/iter; left time: 177.9075s
	iters: 400, epoch: 1 | loss: 0.2955757
	speed: 0.0160s/iter; left time: 176.3190s
	iters: 500, epoch: 1 | loss: 0.2809101
	speed: 0.0161s/iter; left time: 175.0148s
Epoch: 1 cost time: 10.085058212280273
Epoch: 1, Steps: 570 | Train Loss: 0.2818201 Vali Loss: 0.0532391 Test Loss: 0.1546181
Validation loss decreased (inf --> 0.053239).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2284568
	speed: 0.0483s/iter; left time: 518.8328s
	iters: 200, epoch: 2 | loss: 0.2232818
	speed: 0.0144s/iter; left time: 153.1084s
	iters: 300, epoch: 2 | loss: 0.1958117
	speed: 0.0144s/iter; left time: 151.3825s
	iters: 400, epoch: 2 | loss: 0.2299394
	speed: 0.0144s/iter; left time: 150.1148s
	iters: 500, epoch: 2 | loss: 0.2891994
	speed: 0.0144s/iter; left time: 148.9257s
Epoch: 2 cost time: 8.517290115356445
Epoch: 2, Steps: 570 | Train Loss: 0.2791381 Vali Loss: 0.0546333 Test Loss: 0.1602266
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2899931
	speed: 0.0469s/iter; left time: 476.5380s
	iters: 200, epoch: 3 | loss: 0.3095874
	speed: 0.0144s/iter; left time: 144.5332s
	iters: 300, epoch: 3 | loss: 0.2237518
	speed: 0.0143s/iter; left time: 142.8268s
	iters: 400, epoch: 3 | loss: 0.2953077
	speed: 0.0143s/iter; left time: 141.1872s
	iters: 500, epoch: 3 | loss: 0.2957452
	speed: 0.0143s/iter; left time: 139.9078s
Epoch: 3 cost time: 8.439500570297241
Epoch: 3, Steps: 570 | Train Loss: 0.2563540 Vali Loss: 0.0550624 Test Loss: 0.1564429
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3675753
	speed: 0.0468s/iter; left time: 448.7480s
	iters: 200, epoch: 4 | loss: 0.2352058
	speed: 0.0141s/iter; left time: 134.2324s
	iters: 300, epoch: 4 | loss: 0.2369417
	speed: 0.0141s/iter; left time: 132.2047s
	iters: 400, epoch: 4 | loss: 0.1928086
	speed: 0.0141s/iter; left time: 131.2818s
	iters: 500, epoch: 4 | loss: 0.1966515
	speed: 0.0141s/iter; left time: 129.7712s
Epoch: 4 cost time: 8.483006238937378
Epoch: 4, Steps: 570 | Train Loss: 0.2484997 Vali Loss: 0.0497284 Test Loss: 0.1526346
Validation loss decreased (0.053239 --> 0.049728).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1990980
	speed: 0.0481s/iter; left time: 434.0432s
	iters: 200, epoch: 5 | loss: 0.2729777
	speed: 0.0144s/iter; left time: 128.3679s
	iters: 300, epoch: 5 | loss: 0.2280573
	speed: 0.0144s/iter; left time: 126.7452s
	iters: 400, epoch: 5 | loss: 0.3376132
	speed: 0.0143s/iter; left time: 124.9608s
	iters: 500, epoch: 5 | loss: 0.1753474
	speed: 0.0143s/iter; left time: 123.4278s
Epoch: 5 cost time: 8.476775407791138
Epoch: 5, Steps: 570 | Train Loss: 0.2363956 Vali Loss: 0.0505474 Test Loss: 0.1489872
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3241039
	speed: 0.0483s/iter; left time: 408.3500s
	iters: 200, epoch: 6 | loss: 0.2378615
	speed: 0.0143s/iter; left time: 119.6850s
	iters: 300, epoch: 6 | loss: 0.1461298
	speed: 0.0144s/iter; left time: 118.4938s
	iters: 400, epoch: 6 | loss: 0.2479360
	speed: 0.0143s/iter; left time: 116.9360s
	iters: 500, epoch: 6 | loss: 0.2190994
	speed: 0.0143s/iter; left time: 115.3359s
Epoch: 6 cost time: 8.434819459915161
Epoch: 6, Steps: 570 | Train Loss: 0.2317504 Vali Loss: 0.0495301 Test Loss: 0.1478921
Validation loss decreased (0.049728 --> 0.049530).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2636854
	speed: 0.0460s/iter; left time: 362.7399s
	iters: 200, epoch: 7 | loss: 0.1318319
	speed: 0.0141s/iter; left time: 109.9715s
	iters: 300, epoch: 7 | loss: 0.1424991
	speed: 0.0141s/iter; left time: 108.6301s
	iters: 400, epoch: 7 | loss: 0.2908129
	speed: 0.0141s/iter; left time: 106.8844s
	iters: 500, epoch: 7 | loss: 0.2411437
	speed: 0.0141s/iter; left time: 105.4426s
Epoch: 7 cost time: 8.328307867050171
Epoch: 7, Steps: 570 | Train Loss: 0.2300232 Vali Loss: 0.0492419 Test Loss: 0.1453485
Validation loss decreased (0.049530 --> 0.049242).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1857641
	speed: 0.0470s/iter; left time: 343.9395s
	iters: 200, epoch: 8 | loss: 0.1902750
	speed: 0.0160s/iter; left time: 115.2043s
	iters: 300, epoch: 8 | loss: 0.2216117
	speed: 0.0160s/iter; left time: 113.6445s
	iters: 400, epoch: 8 | loss: 0.2184967
	speed: 0.0160s/iter; left time: 111.9791s
	iters: 500, epoch: 8 | loss: 0.1561821
	speed: 0.0160s/iter; left time: 110.3755s
Epoch: 8 cost time: 9.385283946990967
Epoch: 8, Steps: 570 | Train Loss: 0.2286467 Vali Loss: 0.0495880 Test Loss: 0.1462357
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3051796
	speed: 0.0474s/iter; left time: 319.2458s
	iters: 200, epoch: 9 | loss: 0.2256956
	speed: 0.0143s/iter; left time: 94.8286s
	iters: 300, epoch: 9 | loss: 0.1749694
	speed: 0.0143s/iter; left time: 93.3872s
	iters: 400, epoch: 9 | loss: 0.1986991
	speed: 0.0143s/iter; left time: 91.9114s
	iters: 500, epoch: 9 | loss: 0.2190670
	speed: 0.0142s/iter; left time: 90.2500s
Epoch: 9 cost time: 8.43322491645813
Epoch: 9, Steps: 570 | Train Loss: 0.2271850 Vali Loss: 0.0491677 Test Loss: 0.1456196
Validation loss decreased (0.049242 --> 0.049168).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2916849
	speed: 0.0459s/iter; left time: 283.5463s
	iters: 200, epoch: 10 | loss: 0.2593021
	speed: 0.0142s/iter; left time: 86.2515s
	iters: 300, epoch: 10 | loss: 0.2060677
	speed: 0.0142s/iter; left time: 84.6527s
	iters: 400, epoch: 10 | loss: 0.2859290
	speed: 0.0142s/iter; left time: 83.2472s
	iters: 500, epoch: 10 | loss: 0.2250637
	speed: 0.0142s/iter; left time: 81.8627s
Epoch: 10 cost time: 8.387049913406372
Epoch: 10, Steps: 570 | Train Loss: 0.2256848 Vali Loss: 0.0494457 Test Loss: 0.1457386
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2723219
	speed: 0.0450s/iter; left time: 251.8841s
	iters: 200, epoch: 11 | loss: 0.1974434
	speed: 0.0142s/iter; left time: 78.2521s
	iters: 300, epoch: 11 | loss: 0.1769828
	speed: 0.0142s/iter; left time: 76.8923s
	iters: 400, epoch: 11 | loss: 0.3000897
	speed: 0.0142s/iter; left time: 75.1826s
	iters: 500, epoch: 11 | loss: 0.1715814
	speed: 0.0142s/iter; left time: 74.0473s
Epoch: 11 cost time: 8.374593496322632
Epoch: 11, Steps: 570 | Train Loss: 0.2262369 Vali Loss: 0.0493543 Test Loss: 0.1457456
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1606096
	speed: 0.0454s/iter; left time: 228.2778s
	iters: 200, epoch: 12 | loss: 0.1608504
	speed: 0.0143s/iter; left time: 70.3444s
	iters: 300, epoch: 12 | loss: 0.2166485
	speed: 0.0143s/iter; left time: 68.9129s
	iters: 400, epoch: 12 | loss: 0.2996814
	speed: 0.0143s/iter; left time: 67.5220s
	iters: 500, epoch: 12 | loss: 0.3161151
	speed: 0.0142s/iter; left time: 65.8909s
Epoch: 12 cost time: 8.372793912887573
Epoch: 12, Steps: 570 | Train Loss: 0.2263840 Vali Loss: 0.0491373 Test Loss: 0.1457625
Validation loss decreased (0.049168 --> 0.049137).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1785799
	speed: 0.0459s/iter; left time: 204.5442s
	iters: 200, epoch: 13 | loss: 0.2170846
	speed: 0.0143s/iter; left time: 62.1525s
	iters: 300, epoch: 13 | loss: 0.2515455
	speed: 0.0143s/iter; left time: 60.7506s
	iters: 400, epoch: 13 | loss: 0.2159869
	speed: 0.0142s/iter; left time: 59.2053s
	iters: 500, epoch: 13 | loss: 0.2271322
	speed: 0.0142s/iter; left time: 57.8390s
Epoch: 13 cost time: 8.443626642227173
Epoch: 13, Steps: 570 | Train Loss: 0.2272685 Vali Loss: 0.0494166 Test Loss: 0.1457653
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1911967
	speed: 0.0475s/iter; left time: 184.9685s
	iters: 200, epoch: 14 | loss: 0.2238209
	speed: 0.0142s/iter; left time: 53.8395s
	iters: 300, epoch: 14 | loss: 0.1644226
	speed: 0.0142s/iter; left time: 52.4644s
	iters: 400, epoch: 14 | loss: 0.2870014
	speed: 0.0141s/iter; left time: 50.8035s
	iters: 500, epoch: 14 | loss: 0.1816515
	speed: 0.0142s/iter; left time: 49.6188s
Epoch: 14 cost time: 8.372479438781738
Epoch: 14, Steps: 570 | Train Loss: 0.2263090 Vali Loss: 0.0495959 Test Loss: 0.1457638
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2287134
	speed: 0.0457s/iter; left time: 151.7472s
	iters: 200, epoch: 15 | loss: 0.1733811
	speed: 0.0142s/iter; left time: 45.7636s
	iters: 300, epoch: 15 | loss: 0.2645481
	speed: 0.0142s/iter; left time: 44.3921s
	iters: 400, epoch: 15 | loss: 0.2160256
	speed: 0.0141s/iter; left time: 42.7392s
	iters: 500, epoch: 15 | loss: 0.2170612
	speed: 0.0142s/iter; left time: 41.3786s
Epoch: 15 cost time: 8.392169713973999
Epoch: 15, Steps: 570 | Train Loss: 0.2254843 Vali Loss: 0.0492601 Test Loss: 0.1457666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14595626294612885, mae:0.24136628210544586
>>> MS_Pen LR=1e-3 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3816348
	speed: 0.0305s/iter; left time: 344.5553s
	iters: 200, epoch: 1 | loss: 0.2753207
	speed: 0.0184s/iter; left time: 205.7221s
	iters: 300, epoch: 1 | loss: 0.3995244
	speed: 0.0184s/iter; left time: 203.9476s
	iters: 400, epoch: 1 | loss: 0.2930883
	speed: 0.0184s/iter; left time: 202.2384s
	iters: 500, epoch: 1 | loss: 0.2347081
	speed: 0.0184s/iter; left time: 200.7963s
Epoch: 1 cost time: 11.74078917503357
Epoch: 1, Steps: 570 | Train Loss: 0.3384241 Vali Loss: 0.0617408 Test Loss: 0.1895222
Validation loss decreased (inf --> 0.061741).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3994111
	speed: 0.0518s/iter; left time: 555.8171s
	iters: 200, epoch: 2 | loss: 0.3244122
	speed: 0.0169s/iter; left time: 180.1538s
	iters: 300, epoch: 2 | loss: 0.2944384
	speed: 0.0170s/iter; left time: 178.5861s
	iters: 400, epoch: 2 | loss: 0.2023038
	speed: 0.0169s/iter; left time: 176.4130s
	iters: 500, epoch: 2 | loss: 0.2557953
	speed: 0.0169s/iter; left time: 174.9800s
Epoch: 2 cost time: 9.978815078735352
Epoch: 2, Steps: 570 | Train Loss: 0.2946536 Vali Loss: 0.0595400 Test Loss: 0.1717528
Validation loss decreased (0.061741 --> 0.059540).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2270367
	speed: 0.0513s/iter; left time: 521.2371s
	iters: 200, epoch: 3 | loss: 0.2779000
	speed: 0.0168s/iter; left time: 169.3235s
	iters: 300, epoch: 3 | loss: 0.4462025
	speed: 0.0168s/iter; left time: 167.5504s
	iters: 400, epoch: 3 | loss: 0.2034870
	speed: 0.0169s/iter; left time: 166.3107s
	iters: 500, epoch: 3 | loss: 0.2242411
	speed: 0.0168s/iter; left time: 164.4017s
Epoch: 3 cost time: 9.908565759658813
Epoch: 3, Steps: 570 | Train Loss: 0.2749123 Vali Loss: 0.0542375 Test Loss: 0.1626598
Validation loss decreased (0.059540 --> 0.054238).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2796087
	speed: 0.0523s/iter; left time: 501.8282s
	iters: 200, epoch: 4 | loss: 0.2529212
	speed: 0.0169s/iter; left time: 160.6965s
	iters: 300, epoch: 4 | loss: 0.3386411
	speed: 0.0169s/iter; left time: 158.9592s
	iters: 400, epoch: 4 | loss: 0.3144568
	speed: 0.0169s/iter; left time: 157.2273s
	iters: 500, epoch: 4 | loss: 0.2369062
	speed: 0.0169s/iter; left time: 155.6647s
Epoch: 4 cost time: 9.9595205783844
Epoch: 4, Steps: 570 | Train Loss: 0.2604079 Vali Loss: 0.0537463 Test Loss: 0.1561628
Validation loss decreased (0.054238 --> 0.053746).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1198907
	speed: 0.0513s/iter; left time: 462.9003s
	iters: 200, epoch: 5 | loss: 0.3251097
	speed: 0.0170s/iter; left time: 151.2724s
	iters: 300, epoch: 5 | loss: 0.2472024
	speed: 0.0169s/iter; left time: 149.4315s
	iters: 400, epoch: 5 | loss: 0.2441879
	speed: 0.0169s/iter; left time: 147.7910s
	iters: 500, epoch: 5 | loss: 0.1760829
	speed: 0.0169s/iter; left time: 145.9888s
Epoch: 5 cost time: 9.948428869247437
Epoch: 5, Steps: 570 | Train Loss: 0.2524548 Vali Loss: 0.0521909 Test Loss: 0.1520784
Validation loss decreased (0.053746 --> 0.052191).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3005377
	speed: 0.0523s/iter; left time: 441.8585s
	iters: 200, epoch: 6 | loss: 0.2282297
	speed: 0.0181s/iter; left time: 151.4164s
	iters: 300, epoch: 6 | loss: 0.3039387
	speed: 0.0169s/iter; left time: 139.0998s
	iters: 400, epoch: 6 | loss: 0.3681769
	speed: 0.0168s/iter; left time: 137.2928s
	iters: 500, epoch: 6 | loss: 0.2288534
	speed: 0.0169s/iter; left time: 135.7751s
Epoch: 6 cost time: 10.224396705627441
Epoch: 6, Steps: 570 | Train Loss: 0.2495858 Vali Loss: 0.0522044 Test Loss: 0.1505608
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1937335
	speed: 0.0510s/iter; left time: 402.2815s
	iters: 200, epoch: 7 | loss: 0.2353497
	speed: 0.0169s/iter; left time: 131.6505s
	iters: 300, epoch: 7 | loss: 0.3341786
	speed: 0.0169s/iter; left time: 129.9885s
	iters: 400, epoch: 7 | loss: 0.1661522
	speed: 0.0169s/iter; left time: 128.0605s
	iters: 500, epoch: 7 | loss: 0.2010225
	speed: 0.0169s/iter; left time: 126.4773s
Epoch: 7 cost time: 9.908905506134033
Epoch: 7, Steps: 570 | Train Loss: 0.2459931 Vali Loss: 0.0514315 Test Loss: 0.1487995
Validation loss decreased (0.052191 --> 0.051432).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2651334
	speed: 0.0509s/iter; left time: 371.8536s
	iters: 200, epoch: 8 | loss: 0.1773468
	speed: 0.0170s/iter; left time: 122.7291s
	iters: 300, epoch: 8 | loss: 0.2554709
	speed: 0.0170s/iter; left time: 120.7029s
	iters: 400, epoch: 8 | loss: 0.1146534
	speed: 0.0170s/iter; left time: 119.1167s
	iters: 500, epoch: 8 | loss: 0.2051097
	speed: 0.0170s/iter; left time: 117.3123s
Epoch: 8 cost time: 10.089192628860474
Epoch: 8, Steps: 570 | Train Loss: 0.2458947 Vali Loss: 0.0511350 Test Loss: 0.1483416
Validation loss decreased (0.051432 --> 0.051135).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2008958
	speed: 0.0522s/iter; left time: 351.7595s
	iters: 200, epoch: 9 | loss: 0.1487129
	speed: 0.0169s/iter; left time: 112.1732s
	iters: 300, epoch: 9 | loss: 0.2826459
	speed: 0.0169s/iter; left time: 110.4381s
	iters: 400, epoch: 9 | loss: 0.2932739
	speed: 0.0169s/iter; left time: 108.7530s
	iters: 500, epoch: 9 | loss: 0.3040145
	speed: 0.0169s/iter; left time: 107.0824s
Epoch: 9 cost time: 9.927592754364014
Epoch: 9, Steps: 570 | Train Loss: 0.2432671 Vali Loss: 0.0512706 Test Loss: 0.1480612
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3618590
	speed: 0.0501s/iter; left time: 309.1369s
	iters: 200, epoch: 10 | loss: 0.1358148
	speed: 0.0169s/iter; left time: 102.5549s
	iters: 300, epoch: 10 | loss: 0.3507194
	speed: 0.0169s/iter; left time: 100.8438s
	iters: 400, epoch: 10 | loss: 0.2794236
	speed: 0.0168s/iter; left time: 98.7637s
	iters: 500, epoch: 10 | loss: 0.2178606
	speed: 0.0168s/iter; left time: 97.1002s
Epoch: 10 cost time: 9.937951803207397
Epoch: 10, Steps: 570 | Train Loss: 0.2455392 Vali Loss: 0.0511539 Test Loss: 0.1478531
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1949241
	speed: 0.0515s/iter; left time: 288.4858s
	iters: 200, epoch: 11 | loss: 0.2633449
	speed: 0.0169s/iter; left time: 92.8056s
	iters: 300, epoch: 11 | loss: 0.1448274
	speed: 0.0169s/iter; left time: 91.1800s
	iters: 400, epoch: 11 | loss: 0.2548759
	speed: 0.0169s/iter; left time: 89.4371s
	iters: 500, epoch: 11 | loss: 0.3064568
	speed: 0.0169s/iter; left time: 87.8693s
Epoch: 11 cost time: 9.904796123504639
Epoch: 11, Steps: 570 | Train Loss: 0.2432240 Vali Loss: 0.0512001 Test Loss: 0.1478920
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1485711932182312, mae:0.24451367557048798
>>> MS_Pen LR=1e-3 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3313836
	speed: 0.0299s/iter; left time: 337.9676s
	iters: 200, epoch: 1 | loss: 0.1949708
	speed: 0.0178s/iter; left time: 199.0506s
	iters: 300, epoch: 1 | loss: 0.3090669
	speed: 0.0178s/iter; left time: 197.3325s
	iters: 400, epoch: 1 | loss: 0.2631664
	speed: 0.0170s/iter; left time: 186.9781s
	iters: 500, epoch: 1 | loss: 0.1556598
	speed: 0.0163s/iter; left time: 177.7640s
Epoch: 1 cost time: 11.068195819854736
Epoch: 1, Steps: 570 | Train Loss: 0.3151633 Vali Loss: 0.0591624 Test Loss: 0.1717628
Validation loss decreased (inf --> 0.059162).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2257653
	speed: 0.0526s/iter; left time: 564.1607s
	iters: 200, epoch: 2 | loss: 0.1783765
	speed: 0.0163s/iter; left time: 173.0794s
	iters: 300, epoch: 2 | loss: 0.2835246
	speed: 0.0163s/iter; left time: 171.3852s
	iters: 400, epoch: 2 | loss: 0.3733197
	speed: 0.0163s/iter; left time: 169.5951s
	iters: 500, epoch: 2 | loss: 0.2859812
	speed: 0.0162s/iter; left time: 167.7723s
Epoch: 2 cost time: 9.583381652832031
Epoch: 2, Steps: 570 | Train Loss: 0.2791129 Vali Loss: 0.0564053 Test Loss: 0.1699882
Validation loss decreased (0.059162 --> 0.056405).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2687662
	speed: 0.0498s/iter; left time: 505.8270s
	iters: 200, epoch: 3 | loss: 0.3093022
	speed: 0.0163s/iter; left time: 164.0158s
	iters: 300, epoch: 3 | loss: 0.2018701
	speed: 0.0163s/iter; left time: 162.1857s
	iters: 400, epoch: 3 | loss: 0.2794257
	speed: 0.0163s/iter; left time: 160.5344s
	iters: 500, epoch: 3 | loss: 0.1649625
	speed: 0.0163s/iter; left time: 159.1250s
Epoch: 3 cost time: 9.567324161529541
Epoch: 3, Steps: 570 | Train Loss: 0.2611993 Vali Loss: 0.0529572 Test Loss: 0.1597655
Validation loss decreased (0.056405 --> 0.052957).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2008155
	speed: 0.0495s/iter; left time: 474.8420s
	iters: 200, epoch: 4 | loss: 0.4711156
	speed: 0.0162s/iter; left time: 154.1402s
	iters: 300, epoch: 4 | loss: 0.2509032
	speed: 0.0163s/iter; left time: 152.6458s
	iters: 400, epoch: 4 | loss: 0.1769927
	speed: 0.0162s/iter; left time: 150.7521s
	iters: 500, epoch: 4 | loss: 0.3463054
	speed: 0.0162s/iter; left time: 149.2832s
Epoch: 4 cost time: 9.572242498397827
Epoch: 4, Steps: 570 | Train Loss: 0.2547559 Vali Loss: 0.0510064 Test Loss: 0.1578753
Validation loss decreased (0.052957 --> 0.051006).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2479218
	speed: 0.0490s/iter; left time: 441.7859s
	iters: 200, epoch: 5 | loss: 0.3355803
	speed: 0.0163s/iter; left time: 145.4867s
	iters: 300, epoch: 5 | loss: 0.2493934
	speed: 0.0163s/iter; left time: 144.0293s
	iters: 400, epoch: 5 | loss: 0.1896707
	speed: 0.0163s/iter; left time: 142.2759s
	iters: 500, epoch: 5 | loss: 0.3432315
	speed: 0.0163s/iter; left time: 140.7191s
Epoch: 5 cost time: 9.603397607803345
Epoch: 5, Steps: 570 | Train Loss: 0.2470386 Vali Loss: 0.0511761 Test Loss: 0.1549825
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2252344
	speed: 0.0515s/iter; left time: 435.4758s
	iters: 200, epoch: 6 | loss: 0.3544571
	speed: 0.0163s/iter; left time: 136.0303s
	iters: 300, epoch: 6 | loss: 0.4652299
	speed: 0.0163s/iter; left time: 134.3942s
	iters: 400, epoch: 6 | loss: 0.2342515
	speed: 0.0163s/iter; left time: 132.7958s
	iters: 500, epoch: 6 | loss: 0.2314786
	speed: 0.0163s/iter; left time: 131.1378s
Epoch: 6 cost time: 9.579083442687988
Epoch: 6, Steps: 570 | Train Loss: 0.2435749 Vali Loss: 0.0501518 Test Loss: 0.1532144
Validation loss decreased (0.051006 --> 0.050152).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2932135
	speed: 0.0494s/iter; left time: 389.2294s
	iters: 200, epoch: 7 | loss: 0.1642066
	speed: 0.0162s/iter; left time: 126.3388s
	iters: 300, epoch: 7 | loss: 0.2119786
	speed: 0.0162s/iter; left time: 124.6896s
	iters: 400, epoch: 7 | loss: 0.2971531
	speed: 0.0163s/iter; left time: 123.5814s
	iters: 500, epoch: 7 | loss: 0.3496589
	speed: 0.0164s/iter; left time: 122.6606s
Epoch: 7 cost time: 9.56802749633789
Epoch: 7, Steps: 570 | Train Loss: 0.2419818 Vali Loss: 0.0502027 Test Loss: 0.1523810
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1552434
	speed: 0.0488s/iter; left time: 356.9211s
	iters: 200, epoch: 8 | loss: 0.3207072
	speed: 0.0163s/iter; left time: 117.6316s
	iters: 300, epoch: 8 | loss: 0.3398219
	speed: 0.0163s/iter; left time: 115.9758s
	iters: 400, epoch: 8 | loss: 0.2756896
	speed: 0.0163s/iter; left time: 114.3622s
	iters: 500, epoch: 8 | loss: 0.2304991
	speed: 0.0163s/iter; left time: 112.7039s
Epoch: 8 cost time: 9.588282585144043
Epoch: 8, Steps: 570 | Train Loss: 0.2392136 Vali Loss: 0.0495650 Test Loss: 0.1513787
Validation loss decreased (0.050152 --> 0.049565).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1436391
	speed: 0.0516s/iter; left time: 347.7912s
	iters: 200, epoch: 9 | loss: 0.2559650
	speed: 0.0163s/iter; left time: 108.5260s
	iters: 300, epoch: 9 | loss: 0.1274852
	speed: 0.0163s/iter; left time: 106.9193s
	iters: 400, epoch: 9 | loss: 0.2023289
	speed: 0.0164s/iter; left time: 105.6444s
	iters: 500, epoch: 9 | loss: 0.1065270
	speed: 0.0164s/iter; left time: 104.1863s
Epoch: 9 cost time: 9.62901258468628
Epoch: 9, Steps: 570 | Train Loss: 0.2382935 Vali Loss: 0.0496397 Test Loss: 0.1513249
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2950469
	speed: 0.0516s/iter; left time: 318.4030s
	iters: 200, epoch: 10 | loss: 0.2090764
	speed: 0.0179s/iter; left time: 108.6649s
	iters: 300, epoch: 10 | loss: 0.1610271
	speed: 0.0178s/iter; left time: 106.2704s
	iters: 400, epoch: 10 | loss: 0.2293173
	speed: 0.0178s/iter; left time: 104.6722s
	iters: 500, epoch: 10 | loss: 0.1719425
	speed: 0.0178s/iter; left time: 102.7534s
Epoch: 10 cost time: 10.541934251785278
Epoch: 10, Steps: 570 | Train Loss: 0.2378965 Vali Loss: 0.0496723 Test Loss: 0.1513163
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1645397
	speed: 0.0532s/iter; left time: 298.0992s
	iters: 200, epoch: 11 | loss: 0.1480546
	speed: 0.0163s/iter; left time: 89.8525s
	iters: 300, epoch: 11 | loss: 0.1576663
	speed: 0.0163s/iter; left time: 87.9499s
	iters: 400, epoch: 11 | loss: 0.2298544
	speed: 0.0162s/iter; left time: 86.0211s
	iters: 500, epoch: 11 | loss: 0.1962218
	speed: 0.0162s/iter; left time: 84.3551s
Epoch: 11 cost time: 9.702778100967407
Epoch: 11, Steps: 570 | Train Loss: 0.2372020 Vali Loss: 0.0497222 Test Loss: 0.1513233
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15160903334617615, mae:0.24814026057720184
>>> MS_Pen LR=1e-3 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3249311
	speed: 0.0270s/iter; left time: 305.0196s
	iters: 200, epoch: 1 | loss: 0.3090947
	speed: 0.0153s/iter; left time: 171.8562s
	iters: 300, epoch: 1 | loss: 0.2695161
	speed: 0.0153s/iter; left time: 169.9631s
	iters: 400, epoch: 1 | loss: 0.3534608
	speed: 0.0153s/iter; left time: 168.6928s
	iters: 500, epoch: 1 | loss: 0.5284889
	speed: 0.0153s/iter; left time: 167.1010s
Epoch: 1 cost time: 9.954746007919312
Epoch: 1, Steps: 570 | Train Loss: 0.3169651 Vali Loss: 0.0613149 Test Loss: 0.1779069
Validation loss decreased (inf --> 0.061315).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3692390
	speed: 0.0509s/iter; left time: 546.1212s
	iters: 200, epoch: 2 | loss: 0.1793748
	speed: 0.0165s/iter; left time: 175.3894s
	iters: 300, epoch: 2 | loss: 0.3474545
	speed: 0.0170s/iter; left time: 178.9532s
	iters: 400, epoch: 2 | loss: 0.2666721
	speed: 0.0170s/iter; left time: 177.4598s
	iters: 500, epoch: 2 | loss: 0.3737580
	speed: 0.0170s/iter; left time: 175.3988s
Epoch: 2 cost time: 9.952319622039795
Epoch: 2, Steps: 570 | Train Loss: 0.3027050 Vali Loss: 0.0600859 Test Loss: 0.1783657
Validation loss decreased (0.061315 --> 0.060086).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2591949
	speed: 0.0493s/iter; left time: 500.4662s
	iters: 200, epoch: 3 | loss: 0.1608320
	speed: 0.0154s/iter; left time: 154.4807s
	iters: 300, epoch: 3 | loss: 0.3315752
	speed: 0.0154s/iter; left time: 153.0809s
	iters: 400, epoch: 3 | loss: 0.2744716
	speed: 0.0153s/iter; left time: 151.3161s
	iters: 500, epoch: 3 | loss: 0.2771050
	speed: 0.0154s/iter; left time: 150.1167s
Epoch: 3 cost time: 9.046979188919067
Epoch: 3, Steps: 570 | Train Loss: 0.2715883 Vali Loss: 0.0551577 Test Loss: 0.1600329
Validation loss decreased (0.060086 --> 0.055158).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1892183
	speed: 0.0499s/iter; left time: 478.7012s
	iters: 200, epoch: 4 | loss: 0.3466508
	speed: 0.0154s/iter; left time: 146.5718s
	iters: 300, epoch: 4 | loss: 0.3069155
	speed: 0.0154s/iter; left time: 144.6891s
	iters: 400, epoch: 4 | loss: 0.1944237
	speed: 0.0154s/iter; left time: 143.1968s
	iters: 500, epoch: 4 | loss: 0.3081178
	speed: 0.0154s/iter; left time: 141.4659s
Epoch: 4 cost time: 9.089305400848389
Epoch: 4, Steps: 570 | Train Loss: 0.2638826 Vali Loss: 0.0542291 Test Loss: 0.1568702
Validation loss decreased (0.055158 --> 0.054229).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2524643
	speed: 0.0485s/iter; left time: 437.8026s
	iters: 200, epoch: 5 | loss: 0.1990185
	speed: 0.0155s/iter; left time: 137.8730s
	iters: 300, epoch: 5 | loss: 0.2352924
	speed: 0.0155s/iter; left time: 136.4226s
	iters: 400, epoch: 5 | loss: 0.1824518
	speed: 0.0154s/iter; left time: 134.4263s
	iters: 500, epoch: 5 | loss: 0.1734565
	speed: 0.0154s/iter; left time: 132.4402s
Epoch: 5 cost time: 9.124162435531616
Epoch: 5, Steps: 570 | Train Loss: 0.2569113 Vali Loss: 0.0539367 Test Loss: 0.1526746
Validation loss decreased (0.054229 --> 0.053937).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3079302
	speed: 0.0487s/iter; left time: 411.4624s
	iters: 200, epoch: 6 | loss: 0.1778134
	speed: 0.0154s/iter; left time: 128.9259s
	iters: 300, epoch: 6 | loss: 0.1780012
	speed: 0.0154s/iter; left time: 127.0682s
	iters: 400, epoch: 6 | loss: 0.1520462
	speed: 0.0154s/iter; left time: 125.4509s
	iters: 500, epoch: 6 | loss: 0.2189526
	speed: 0.0154s/iter; left time: 123.9859s
Epoch: 6 cost time: 9.10529112815857
Epoch: 6, Steps: 570 | Train Loss: 0.2518730 Vali Loss: 0.0526771 Test Loss: 0.1517928
Validation loss decreased (0.053937 --> 0.052677).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2944561
	speed: 0.0489s/iter; left time: 385.4647s
	iters: 200, epoch: 7 | loss: 0.2309810
	speed: 0.0155s/iter; left time: 120.4523s
	iters: 300, epoch: 7 | loss: 0.1754440
	speed: 0.0155s/iter; left time: 118.8156s
	iters: 400, epoch: 7 | loss: 0.2906879
	speed: 0.0155s/iter; left time: 117.5597s
	iters: 500, epoch: 7 | loss: 0.2675605
	speed: 0.0155s/iter; left time: 115.8504s
Epoch: 7 cost time: 9.139741897583008
Epoch: 7, Steps: 570 | Train Loss: 0.2479802 Vali Loss: 0.0532570 Test Loss: 0.1505218
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2142801
	speed: 0.0484s/iter; left time: 354.0255s
	iters: 200, epoch: 8 | loss: 0.3342414
	speed: 0.0153s/iter; left time: 110.3084s
	iters: 300, epoch: 8 | loss: 0.1580867
	speed: 0.0153s/iter; left time: 108.6971s
	iters: 400, epoch: 8 | loss: 0.2410665
	speed: 0.0153s/iter; left time: 107.1807s
	iters: 500, epoch: 8 | loss: 0.1730840
	speed: 0.0153s/iter; left time: 105.6924s
Epoch: 8 cost time: 9.101269721984863
Epoch: 8, Steps: 570 | Train Loss: 0.2493073 Vali Loss: 0.0530805 Test Loss: 0.1502587
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2289393
	speed: 0.0460s/iter; left time: 309.9668s
	iters: 200, epoch: 9 | loss: 0.2496487
	speed: 0.0153s/iter; left time: 101.4323s
	iters: 300, epoch: 9 | loss: 0.2270432
	speed: 0.0153s/iter; left time: 99.9355s
	iters: 400, epoch: 9 | loss: 0.1999897
	speed: 0.0153s/iter; left time: 98.3612s
	iters: 500, epoch: 9 | loss: 0.2394364
	speed: 0.0153s/iter; left time: 96.9823s
Epoch: 9 cost time: 8.967658758163452
Epoch: 9, Steps: 570 | Train Loss: 0.2473467 Vali Loss: 0.0531609 Test Loss: 0.1502564
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15202629566192627, mae:0.24972769618034363
>>> MS_Pen LR=1e-3 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2001821
	speed: 0.0326s/iter; left time: 368.0731s
	iters: 200, epoch: 1 | loss: 0.2417762
	speed: 0.0208s/iter; left time: 232.6207s
	iters: 300, epoch: 1 | loss: 0.4822366
	speed: 0.0208s/iter; left time: 230.4657s
	iters: 400, epoch: 1 | loss: 0.2262647
	speed: 0.0208s/iter; left time: 228.9699s
	iters: 500, epoch: 1 | loss: 0.2150166
	speed: 0.0208s/iter; left time: 226.7000s
Epoch: 1 cost time: 13.077879667282104
Epoch: 1, Steps: 570 | Train Loss: 0.2785666 Vali Loss: 0.0552368 Test Loss: 0.1689567
Validation loss decreased (inf --> 0.055237).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5678798
	speed: 0.0588s/iter; left time: 631.4484s
	iters: 200, epoch: 2 | loss: 0.2646620
	speed: 0.0185s/iter; left time: 196.9777s
	iters: 300, epoch: 2 | loss: 0.1818222
	speed: 0.0185s/iter; left time: 195.2328s
	iters: 400, epoch: 2 | loss: 0.2754609
	speed: 0.0185s/iter; left time: 192.6901s
	iters: 500, epoch: 2 | loss: 0.2573315
	speed: 0.0184s/iter; left time: 190.2251s
Epoch: 2 cost time: 10.851361751556396
Epoch: 2, Steps: 570 | Train Loss: 0.2964017 Vali Loss: 0.0599058 Test Loss: 0.1796731
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1875128
	speed: 0.0578s/iter; left time: 587.3014s
	iters: 200, epoch: 3 | loss: 0.2190283
	speed: 0.0185s/iter; left time: 186.0576s
	iters: 300, epoch: 3 | loss: 0.2290990
	speed: 0.0185s/iter; left time: 184.2836s
	iters: 400, epoch: 3 | loss: 0.1917821
	speed: 0.0185s/iter; left time: 182.5147s
	iters: 500, epoch: 3 | loss: 0.3180860
	speed: 0.0185s/iter; left time: 180.3655s
Epoch: 3 cost time: 10.822835922241211
Epoch: 3, Steps: 570 | Train Loss: 0.2692496 Vali Loss: 0.0566989 Test Loss: 0.1623690
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3109084
	speed: 0.0575s/iter; left time: 551.7089s
	iters: 200, epoch: 4 | loss: 0.3140034
	speed: 0.0185s/iter; left time: 175.1844s
	iters: 300, epoch: 4 | loss: 0.3064941
	speed: 0.0184s/iter; left time: 173.1955s
	iters: 400, epoch: 4 | loss: 0.1343491
	speed: 0.0184s/iter; left time: 171.3822s
	iters: 500, epoch: 4 | loss: 0.2434141
	speed: 0.0184s/iter; left time: 169.3909s
Epoch: 4 cost time: 10.887572526931763
Epoch: 4, Steps: 570 | Train Loss: 0.2534127 Vali Loss: 0.0565278 Test Loss: 0.1596692
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16920636594295502, mae:0.26431775093078613
>>> MS_Pen LR=1e-3 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.4687042
	speed: 0.0324s/iter; left time: 366.1078s
	iters: 200, epoch: 1 | loss: 0.2641037
	speed: 0.0206s/iter; left time: 230.1854s
	iters: 300, epoch: 1 | loss: 0.1812647
	speed: 0.0205s/iter; left time: 227.9998s
	iters: 400, epoch: 1 | loss: 0.2118859
	speed: 0.0195s/iter; left time: 214.6961s
	iters: 500, epoch: 1 | loss: 0.4369192
	speed: 0.0184s/iter; left time: 200.0838s
Epoch: 1 cost time: 12.59153437614441
Epoch: 1, Steps: 570 | Train Loss: 0.2723315 Vali Loss: 0.0595802 Test Loss: 0.1731033
Validation loss decreased (inf --> 0.059580).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2062251
	speed: 0.0574s/iter; left time: 615.8826s
	iters: 200, epoch: 2 | loss: 0.3534942
	speed: 0.0184s/iter; left time: 195.9693s
	iters: 300, epoch: 2 | loss: 0.4313175
	speed: 0.0184s/iter; left time: 193.3425s
	iters: 400, epoch: 2 | loss: 0.2150224
	speed: 0.0183s/iter; left time: 190.4743s
	iters: 500, epoch: 2 | loss: 0.1672023
	speed: 0.0183s/iter; left time: 189.1362s
Epoch: 2 cost time: 10.77236008644104
Epoch: 2, Steps: 570 | Train Loss: 0.2830124 Vali Loss: 0.0565694 Test Loss: 0.1672366
Validation loss decreased (0.059580 --> 0.056569).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1731154
	speed: 0.0558s/iter; left time: 566.6003s
	iters: 200, epoch: 3 | loss: 0.2266990
	speed: 0.0186s/iter; left time: 187.2286s
	iters: 300, epoch: 3 | loss: 0.2342203
	speed: 0.0186s/iter; left time: 184.9252s
	iters: 400, epoch: 3 | loss: 0.1998924
	speed: 0.0186s/iter; left time: 182.9558s
	iters: 500, epoch: 3 | loss: 0.1589972
	speed: 0.0186s/iter; left time: 181.5293s
Epoch: 3 cost time: 10.898566484451294
Epoch: 3, Steps: 570 | Train Loss: 0.2508312 Vali Loss: 0.0538470 Test Loss: 0.1650232
Validation loss decreased (0.056569 --> 0.053847).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2966254
	speed: 0.0567s/iter; left time: 544.1348s
	iters: 200, epoch: 4 | loss: 0.1806449
	speed: 0.0184s/iter; left time: 174.4978s
	iters: 300, epoch: 4 | loss: 0.3537821
	speed: 0.0184s/iter; left time: 172.8253s
	iters: 400, epoch: 4 | loss: 0.1768056
	speed: 0.0184s/iter; left time: 170.5242s
	iters: 500, epoch: 4 | loss: 0.1771758
	speed: 0.0184s/iter; left time: 168.8956s
Epoch: 4 cost time: 10.79756474494934
Epoch: 4, Steps: 570 | Train Loss: 0.2435769 Vali Loss: 0.0511004 Test Loss: 0.1546542
Validation loss decreased (0.053847 --> 0.051100).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1931188
	speed: 0.0566s/iter; left time: 510.9257s
	iters: 200, epoch: 5 | loss: 0.2311109
	speed: 0.0184s/iter; left time: 164.2102s
	iters: 300, epoch: 5 | loss: 0.1710693
	speed: 0.0184s/iter; left time: 162.0239s
	iters: 400, epoch: 5 | loss: 0.2020206
	speed: 0.0184s/iter; left time: 160.1484s
	iters: 500, epoch: 5 | loss: 0.2656281
	speed: 0.0184s/iter; left time: 158.5851s
Epoch: 5 cost time: 10.78903841972351
Epoch: 5, Steps: 570 | Train Loss: 0.2364790 Vali Loss: 0.0505132 Test Loss: 0.1533560
Validation loss decreased (0.051100 --> 0.050513).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3187085
	speed: 0.0582s/iter; left time: 491.6181s
	iters: 200, epoch: 6 | loss: 0.2114805
	speed: 0.0197s/iter; left time: 164.3520s
	iters: 300, epoch: 6 | loss: 0.1903083
	speed: 0.0183s/iter; left time: 151.2715s
	iters: 400, epoch: 6 | loss: 0.1835104
	speed: 0.0183s/iter; left time: 149.2730s
	iters: 500, epoch: 6 | loss: 0.1358994
	speed: 0.0183s/iter; left time: 147.5259s
Epoch: 6 cost time: 11.144816637039185
Epoch: 6, Steps: 570 | Train Loss: 0.2341669 Vali Loss: 0.0498738 Test Loss: 0.1518528
Validation loss decreased (0.050513 --> 0.049874).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2144529
	speed: 0.0571s/iter; left time: 449.9373s
	iters: 200, epoch: 7 | loss: 0.2557807
	speed: 0.0184s/iter; left time: 142.8623s
	iters: 300, epoch: 7 | loss: 0.1613901
	speed: 0.0184s/iter; left time: 140.9735s
	iters: 400, epoch: 7 | loss: 0.2431063
	speed: 0.0184s/iter; left time: 139.1443s
	iters: 500, epoch: 7 | loss: 0.2212004
	speed: 0.0183s/iter; left time: 137.1409s
Epoch: 7 cost time: 10.768519163131714
Epoch: 7, Steps: 570 | Train Loss: 0.2301170 Vali Loss: 0.0496727 Test Loss: 0.1515751
Validation loss decreased (0.049874 --> 0.049673).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1637494
	speed: 0.0596s/iter; left time: 435.3775s
	iters: 200, epoch: 8 | loss: 0.1778509
	speed: 0.0182s/iter; left time: 131.3249s
	iters: 300, epoch: 8 | loss: 0.3046918
	speed: 0.0182s/iter; left time: 129.1436s
	iters: 400, epoch: 8 | loss: 0.2451166
	speed: 0.0182s/iter; left time: 127.3454s
	iters: 500, epoch: 8 | loss: 0.2567649
	speed: 0.0182s/iter; left time: 125.4579s
Epoch: 8 cost time: 10.662056684494019
Epoch: 8, Steps: 570 | Train Loss: 0.2292969 Vali Loss: 0.0497182 Test Loss: 0.1519510
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1378686
	speed: 0.0547s/iter; left time: 368.7967s
	iters: 200, epoch: 9 | loss: 0.2209715
	speed: 0.0184s/iter; left time: 122.4620s
	iters: 300, epoch: 9 | loss: 0.2341809
	speed: 0.0184s/iter; left time: 120.6808s
	iters: 400, epoch: 9 | loss: 0.2128103
	speed: 0.0184s/iter; left time: 118.7788s
	iters: 500, epoch: 9 | loss: 0.1823326
	speed: 0.0184s/iter; left time: 116.9262s
Epoch: 9 cost time: 10.777697801589966
Epoch: 9, Steps: 570 | Train Loss: 0.2290739 Vali Loss: 0.0499163 Test Loss: 0.1516961
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1578461
	speed: 0.0551s/iter; left time: 339.7362s
	iters: 200, epoch: 10 | loss: 0.2146426
	speed: 0.0183s/iter; left time: 110.9027s
	iters: 300, epoch: 10 | loss: 0.3545410
	speed: 0.0183s/iter; left time: 109.0612s
	iters: 400, epoch: 10 | loss: 0.2310585
	speed: 0.0183s/iter; left time: 107.2647s
	iters: 500, epoch: 10 | loss: 0.2372594
	speed: 0.0183s/iter; left time: 105.3521s
Epoch: 10 cost time: 10.679439544677734
Epoch: 10, Steps: 570 | Train Loss: 0.2293376 Vali Loss: 0.0496634 Test Loss: 0.1517312
Validation loss decreased (0.049673 --> 0.049663).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2945793
	speed: 0.0557s/iter; left time: 311.7815s
	iters: 200, epoch: 11 | loss: 0.2734328
	speed: 0.0184s/iter; left time: 101.1097s
	iters: 300, epoch: 11 | loss: 0.1513260
	speed: 0.0184s/iter; left time: 99.2218s
	iters: 400, epoch: 11 | loss: 0.2486075
	speed: 0.0183s/iter; left time: 97.2274s
	iters: 500, epoch: 11 | loss: 0.2087723
	speed: 0.0183s/iter; left time: 95.3488s
Epoch: 11 cost time: 10.762381792068481
Epoch: 11, Steps: 570 | Train Loss: 0.2279504 Vali Loss: 0.0497748 Test Loss: 0.1517861
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3449732
	speed: 0.0556s/iter; left time: 279.4967s
	iters: 200, epoch: 12 | loss: 0.2297663
	speed: 0.0184s/iter; left time: 90.5007s
	iters: 300, epoch: 12 | loss: 0.1904300
	speed: 0.0184s/iter; left time: 88.6998s
	iters: 400, epoch: 12 | loss: 0.1764166
	speed: 0.0184s/iter; left time: 87.0075s
	iters: 500, epoch: 12 | loss: 0.2029949
	speed: 0.0184s/iter; left time: 85.2337s
Epoch: 12 cost time: 10.775201797485352
Epoch: 12, Steps: 570 | Train Loss: 0.2289556 Vali Loss: 0.0498606 Test Loss: 0.1517719
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2067565
	speed: 0.0551s/iter; left time: 245.7497s
	iters: 200, epoch: 13 | loss: 0.3033906
	speed: 0.0183s/iter; left time: 79.9541s
	iters: 300, epoch: 13 | loss: 0.2139339
	speed: 0.0183s/iter; left time: 78.0616s
	iters: 400, epoch: 13 | loss: 0.3114850
	speed: 0.0183s/iter; left time: 76.3120s
	iters: 500, epoch: 13 | loss: 0.3391984
	speed: 0.0183s/iter; left time: 74.4263s
Epoch: 13 cost time: 10.752841234207153
Epoch: 13, Steps: 570 | Train Loss: 0.2295944 Vali Loss: 0.0497987 Test Loss: 0.1517624
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1519670933485031, mae:0.2496030479669571
>>> MS_Pen LR=1e-3 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2701032
	speed: 0.0325s/iter; left time: 367.5260s
	iters: 200, epoch: 1 | loss: 0.1903238
	speed: 0.0205s/iter; left time: 229.0786s
	iters: 300, epoch: 1 | loss: 0.3127182
	speed: 0.0205s/iter; left time: 227.4085s
	iters: 400, epoch: 1 | loss: 0.3384723
	speed: 0.0205s/iter; left time: 225.7593s
	iters: 500, epoch: 1 | loss: 0.3862449
	speed: 0.0204s/iter; left time: 222.6091s
Epoch: 1 cost time: 12.925012111663818
Epoch: 1, Steps: 570 | Train Loss: 0.2822764 Vali Loss: 0.0563766 Test Loss: 0.1661949
Validation loss decreased (inf --> 0.056377).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4013171
	speed: 0.0580s/iter; left time: 622.1460s
	iters: 200, epoch: 2 | loss: 0.3957237
	speed: 0.0182s/iter; left time: 193.9847s
	iters: 300, epoch: 2 | loss: 0.4586100
	speed: 0.0182s/iter; left time: 191.9431s
	iters: 400, epoch: 2 | loss: 0.2175338
	speed: 0.0182s/iter; left time: 190.1012s
	iters: 500, epoch: 2 | loss: 0.2660935
	speed: 0.0182s/iter; left time: 188.1874s
Epoch: 2 cost time: 10.713175773620605
Epoch: 2, Steps: 570 | Train Loss: 0.2828532 Vali Loss: 0.0561119 Test Loss: 0.1621483
Validation loss decreased (0.056377 --> 0.056112).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1606582
	speed: 0.0575s/iter; left time: 584.7139s
	iters: 200, epoch: 3 | loss: 0.2526506
	speed: 0.0183s/iter; left time: 183.7610s
	iters: 300, epoch: 3 | loss: 0.2360178
	speed: 0.0183s/iter; left time: 181.9811s
	iters: 400, epoch: 3 | loss: 0.4276330
	speed: 0.0183s/iter; left time: 180.1742s
	iters: 500, epoch: 3 | loss: 0.2923255
	speed: 0.0183s/iter; left time: 178.2976s
Epoch: 3 cost time: 10.964160680770874
Epoch: 3, Steps: 570 | Train Loss: 0.2584792 Vali Loss: 0.0540807 Test Loss: 0.1605853
Validation loss decreased (0.056112 --> 0.054081).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2011919
	speed: 0.0580s/iter; left time: 556.3596s
	iters: 200, epoch: 4 | loss: 0.2344457
	speed: 0.0183s/iter; left time: 173.4630s
	iters: 300, epoch: 4 | loss: 0.1981566
	speed: 0.0183s/iter; left time: 171.6807s
	iters: 400, epoch: 4 | loss: 0.2348550
	speed: 0.0183s/iter; left time: 169.7472s
	iters: 500, epoch: 4 | loss: 0.1789940
	speed: 0.0183s/iter; left time: 167.9557s
Epoch: 4 cost time: 10.720901727676392
Epoch: 4, Steps: 570 | Train Loss: 0.2442707 Vali Loss: 0.0526743 Test Loss: 0.1542613
Validation loss decreased (0.054081 --> 0.052674).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2010366
	speed: 0.0558s/iter; left time: 503.1011s
	iters: 200, epoch: 5 | loss: 0.2365041
	speed: 0.0182s/iter; left time: 162.5804s
	iters: 300, epoch: 5 | loss: 0.1911963
	speed: 0.0182s/iter; left time: 160.9423s
	iters: 400, epoch: 5 | loss: 0.2247200
	speed: 0.0182s/iter; left time: 158.8794s
	iters: 500, epoch: 5 | loss: 0.1414267
	speed: 0.0182s/iter; left time: 157.1655s
Epoch: 5 cost time: 10.70738959312439
Epoch: 5, Steps: 570 | Train Loss: 0.2373767 Vali Loss: 0.0518860 Test Loss: 0.1484596
Validation loss decreased (0.052674 --> 0.051886).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3027348
	speed: 0.0562s/iter; left time: 474.7322s
	iters: 200, epoch: 6 | loss: 0.1498618
	speed: 0.0183s/iter; left time: 152.5231s
	iters: 300, epoch: 6 | loss: 0.3644967
	speed: 0.0182s/iter; left time: 150.5493s
	iters: 400, epoch: 6 | loss: 0.1628048
	speed: 0.0183s/iter; left time: 148.7679s
	iters: 500, epoch: 6 | loss: 0.2414984
	speed: 0.0182s/iter; left time: 146.4915s
Epoch: 6 cost time: 10.76723599433899
Epoch: 6, Steps: 570 | Train Loss: 0.2319329 Vali Loss: 0.0505537 Test Loss: 0.1481725
Validation loss decreased (0.051886 --> 0.050554).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1846329
	speed: 0.0557s/iter; left time: 439.0758s
	iters: 200, epoch: 7 | loss: 0.1783097
	speed: 0.0187s/iter; left time: 145.3755s
	iters: 300, epoch: 7 | loss: 0.2219580
	speed: 0.0211s/iter; left time: 161.9871s
	iters: 400, epoch: 7 | loss: 0.2006360
	speed: 0.0211s/iter; left time: 160.2260s
	iters: 500, epoch: 7 | loss: 0.1905786
	speed: 0.0211s/iter; left time: 157.5155s
Epoch: 7 cost time: 11.816541194915771
Epoch: 7, Steps: 570 | Train Loss: 0.2293661 Vali Loss: 0.0509082 Test Loss: 0.1484540
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1470166
	speed: 0.0605s/iter; left time: 442.1506s
	iters: 200, epoch: 8 | loss: 0.1414590
	speed: 0.0211s/iter; left time: 152.4980s
	iters: 300, epoch: 8 | loss: 0.1941523
	speed: 0.0211s/iter; left time: 149.8139s
	iters: 400, epoch: 8 | loss: 0.2642015
	speed: 0.0211s/iter; left time: 147.8598s
	iters: 500, epoch: 8 | loss: 0.1815724
	speed: 0.0211s/iter; left time: 145.5020s
Epoch: 8 cost time: 12.312686681747437
Epoch: 8, Steps: 570 | Train Loss: 0.2277058 Vali Loss: 0.0506683 Test Loss: 0.1479239
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2754253
	speed: 0.0586s/iter; left time: 395.3493s
	iters: 200, epoch: 9 | loss: 0.2511203
	speed: 0.0183s/iter; left time: 121.6543s
	iters: 300, epoch: 9 | loss: 0.2443328
	speed: 0.0183s/iter; left time: 119.6982s
	iters: 400, epoch: 9 | loss: 0.3827503
	speed: 0.0183s/iter; left time: 117.6818s
	iters: 500, epoch: 9 | loss: 0.1933233
	speed: 0.0183s/iter; left time: 115.9792s
Epoch: 9 cost time: 10.852561712265015
Epoch: 9, Steps: 570 | Train Loss: 0.2261463 Vali Loss: 0.0508255 Test Loss: 0.1480831
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14837609231472015, mae:0.24315091967582703
>>> MS_Pen LR=1e-3 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2750815
	speed: 0.0360s/iter; left time: 406.4301s
	iters: 200, epoch: 1 | loss: 0.3246882
	speed: 0.0222s/iter; left time: 248.8624s
	iters: 300, epoch: 1 | loss: 0.2704593
	speed: 0.0237s/iter; left time: 263.3194s
	iters: 400, epoch: 1 | loss: 0.4087913
	speed: 0.0238s/iter; left time: 261.7765s
	iters: 500, epoch: 1 | loss: 0.3158729
	speed: 0.0239s/iter; left time: 260.4342s
Epoch: 1 cost time: 14.689700603485107
Epoch: 1, Steps: 570 | Train Loss: 0.3501695 Vali Loss: 0.0640878 Test Loss: 0.1792476
Validation loss decreased (inf --> 0.064088).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3506996
	speed: 0.0645s/iter; left time: 691.9323s
	iters: 200, epoch: 2 | loss: 0.2391705
	speed: 0.0220s/iter; left time: 233.3792s
	iters: 300, epoch: 2 | loss: 0.2357465
	speed: 0.0219s/iter; left time: 230.9812s
	iters: 400, epoch: 2 | loss: 0.2845646
	speed: 0.0220s/iter; left time: 229.0332s
	iters: 500, epoch: 2 | loss: 0.2942829
	speed: 0.0219s/iter; left time: 226.7441s
Epoch: 2 cost time: 12.839287281036377
Epoch: 2, Steps: 570 | Train Loss: 0.2940563 Vali Loss: 0.0596983 Test Loss: 0.1806519
Validation loss decreased (0.064088 --> 0.059698).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5565472
	speed: 0.0662s/iter; left time: 672.6293s
	iters: 200, epoch: 3 | loss: 0.1981962
	speed: 0.0220s/iter; left time: 221.4665s
	iters: 300, epoch: 3 | loss: 0.3459869
	speed: 0.0220s/iter; left time: 219.4213s
	iters: 400, epoch: 3 | loss: 0.2669314
	speed: 0.0220s/iter; left time: 217.1141s
	iters: 500, epoch: 3 | loss: 0.1939363
	speed: 0.0220s/iter; left time: 215.1277s
Epoch: 3 cost time: 12.874677896499634
Epoch: 3, Steps: 570 | Train Loss: 0.2752146 Vali Loss: 0.0553213 Test Loss: 0.1631024
Validation loss decreased (0.059698 --> 0.055321).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2337604
	speed: 0.0643s/iter; left time: 616.4600s
	iters: 200, epoch: 4 | loss: 0.2094529
	speed: 0.0221s/iter; left time: 209.5706s
	iters: 300, epoch: 4 | loss: 0.2817573
	speed: 0.0221s/iter; left time: 207.2896s
	iters: 400, epoch: 4 | loss: 0.2358335
	speed: 0.0221s/iter; left time: 205.3755s
	iters: 500, epoch: 4 | loss: 0.2758797
	speed: 0.0221s/iter; left time: 203.3641s
Epoch: 4 cost time: 12.881462812423706
Epoch: 4, Steps: 570 | Train Loss: 0.2625564 Vali Loss: 0.0530126 Test Loss: 0.1590546
Validation loss decreased (0.055321 --> 0.053013).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2596333
	speed: 0.0625s/iter; left time: 564.0262s
	iters: 200, epoch: 5 | loss: 0.2596903
	speed: 0.0222s/iter; left time: 197.6063s
	iters: 300, epoch: 5 | loss: 0.2005000
	speed: 0.0222s/iter; left time: 195.4849s
	iters: 400, epoch: 5 | loss: 0.2477988
	speed: 0.0222s/iter; left time: 193.3197s
	iters: 500, epoch: 5 | loss: 0.2814422
	speed: 0.0222s/iter; left time: 190.9593s
Epoch: 5 cost time: 12.910043716430664
Epoch: 5, Steps: 570 | Train Loss: 0.2539889 Vali Loss: 0.0525268 Test Loss: 0.1543871
Validation loss decreased (0.053013 --> 0.052527).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2327062
	speed: 0.0635s/iter; left time: 536.3373s
	iters: 200, epoch: 6 | loss: 0.3386104
	speed: 0.0220s/iter; left time: 184.0915s
	iters: 300, epoch: 6 | loss: 0.2103603
	speed: 0.0220s/iter; left time: 181.8569s
	iters: 400, epoch: 6 | loss: 0.1875432
	speed: 0.0221s/iter; left time: 179.7731s
	iters: 500, epoch: 6 | loss: 0.3493881
	speed: 0.0221s/iter; left time: 177.5395s
Epoch: 6 cost time: 12.88375735282898
Epoch: 6, Steps: 570 | Train Loss: 0.2483144 Vali Loss: 0.0518715 Test Loss: 0.1524905
Validation loss decreased (0.052527 --> 0.051871).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3180377
	speed: 0.0634s/iter; left time: 499.5699s
	iters: 200, epoch: 7 | loss: 0.2666661
	speed: 0.0221s/iter; left time: 172.0580s
	iters: 300, epoch: 7 | loss: 0.1726352
	speed: 0.0221s/iter; left time: 169.7314s
	iters: 400, epoch: 7 | loss: 0.2146953
	speed: 0.0221s/iter; left time: 167.4378s
	iters: 500, epoch: 7 | loss: 0.2683094
	speed: 0.0221s/iter; left time: 165.2880s
Epoch: 7 cost time: 12.88137698173523
Epoch: 7, Steps: 570 | Train Loss: 0.2450295 Vali Loss: 0.0514832 Test Loss: 0.1517571
Validation loss decreased (0.051871 --> 0.051483).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1694895
	speed: 0.0645s/iter; left time: 471.2641s
	iters: 200, epoch: 8 | loss: 0.5112751
	speed: 0.0228s/iter; left time: 164.3864s
	iters: 300, epoch: 8 | loss: 0.1350577
	speed: 0.0228s/iter; left time: 162.2391s
	iters: 400, epoch: 8 | loss: 0.2498518
	speed: 0.0228s/iter; left time: 160.0742s
	iters: 500, epoch: 8 | loss: 0.2181379
	speed: 0.0228s/iter; left time: 157.6546s
Epoch: 8 cost time: 13.39684271812439
Epoch: 8, Steps: 570 | Train Loss: 0.2453723 Vali Loss: 0.0513246 Test Loss: 0.1510552
Validation loss decreased (0.051483 --> 0.051325).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2269857
	speed: 0.0673s/iter; left time: 453.3617s
	iters: 200, epoch: 9 | loss: 0.2448730
	speed: 0.0228s/iter; left time: 151.6199s
	iters: 300, epoch: 9 | loss: 0.3973202
	speed: 0.0228s/iter; left time: 149.2134s
	iters: 400, epoch: 9 | loss: 0.2251778
	speed: 0.0228s/iter; left time: 147.0908s
	iters: 500, epoch: 9 | loss: 0.1957670
	speed: 0.0228s/iter; left time: 144.5539s
Epoch: 9 cost time: 13.406012296676636
Epoch: 9, Steps: 570 | Train Loss: 0.2446055 Vali Loss: 0.0512709 Test Loss: 0.1507572
Validation loss decreased (0.051325 --> 0.051271).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2604954
	speed: 0.0673s/iter; left time: 415.0572s
	iters: 200, epoch: 10 | loss: 0.2850889
	speed: 0.0228s/iter; left time: 138.3784s
	iters: 300, epoch: 10 | loss: 0.2512812
	speed: 0.0228s/iter; left time: 136.1131s
	iters: 400, epoch: 10 | loss: 0.3503199
	speed: 0.0228s/iter; left time: 133.7875s
	iters: 500, epoch: 10 | loss: 0.2445469
	speed: 0.0228s/iter; left time: 131.6092s
Epoch: 10 cost time: 13.389094591140747
Epoch: 10, Steps: 570 | Train Loss: 0.2441921 Vali Loss: 0.0512759 Test Loss: 0.1507604
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1957394
	speed: 0.0662s/iter; left time: 370.6964s
	iters: 200, epoch: 11 | loss: 0.1942608
	speed: 0.0221s/iter; left time: 121.6348s
	iters: 300, epoch: 11 | loss: 0.1168612
	speed: 0.0221s/iter; left time: 119.3071s
	iters: 400, epoch: 11 | loss: 0.2084340
	speed: 0.0221s/iter; left time: 117.2128s
	iters: 500, epoch: 11 | loss: 0.1760301
	speed: 0.0221s/iter; left time: 114.7923s
Epoch: 11 cost time: 12.906799793243408
Epoch: 11, Steps: 570 | Train Loss: 0.2442585 Vali Loss: 0.0512037 Test Loss: 0.1507266
Validation loss decreased (0.051271 --> 0.051204).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2693572
	speed: 0.0639s/iter; left time: 321.3600s
	iters: 200, epoch: 12 | loss: 0.2250412
	speed: 0.0222s/iter; left time: 109.5270s
	iters: 300, epoch: 12 | loss: 0.3482187
	speed: 0.0222s/iter; left time: 107.2590s
	iters: 400, epoch: 12 | loss: 0.1200140
	speed: 0.0222s/iter; left time: 104.9727s
	iters: 500, epoch: 12 | loss: 0.2426719
	speed: 0.0222s/iter; left time: 102.7622s
Epoch: 12 cost time: 12.97020936012268
Epoch: 12, Steps: 570 | Train Loss: 0.2423731 Vali Loss: 0.0512163 Test Loss: 0.1507936
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3398483
	speed: 0.0629s/iter; left time: 280.3840s
	iters: 200, epoch: 13 | loss: 0.1844975
	speed: 0.0221s/iter; left time: 96.2712s
	iters: 300, epoch: 13 | loss: 0.1676707
	speed: 0.0220s/iter; left time: 93.9467s
	iters: 400, epoch: 13 | loss: 0.3044376
	speed: 0.0221s/iter; left time: 91.9323s
	iters: 500, epoch: 13 | loss: 0.4036616
	speed: 0.0221s/iter; left time: 89.6104s
Epoch: 13 cost time: 12.902535200119019
Epoch: 13, Steps: 570 | Train Loss: 0.2428379 Vali Loss: 0.0511861 Test Loss: 0.1507607
Validation loss decreased (0.051204 --> 0.051186).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2699794
	speed: 0.0655s/iter; left time: 254.7852s
	iters: 200, epoch: 14 | loss: 0.3027028
	speed: 0.0220s/iter; left time: 83.4027s
	iters: 300, epoch: 14 | loss: 0.2195593
	speed: 0.0236s/iter; left time: 87.1885s
	iters: 400, epoch: 14 | loss: 0.2045779
	speed: 0.0239s/iter; left time: 85.9402s
	iters: 500, epoch: 14 | loss: 0.1878626
	speed: 0.0239s/iter; left time: 83.5087s
Epoch: 14 cost time: 13.53304409980774
Epoch: 14, Steps: 570 | Train Loss: 0.2442901 Vali Loss: 0.0513655 Test Loss: 0.1507474
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1778729
	speed: 0.0678s/iter; left time: 225.2029s
	iters: 200, epoch: 15 | loss: 0.2618769
	speed: 0.0239s/iter; left time: 77.0935s
	iters: 300, epoch: 15 | loss: 0.1391211
	speed: 0.0240s/iter; left time: 74.7660s
	iters: 400, epoch: 15 | loss: 0.2216332
	speed: 0.0226s/iter; left time: 68.1549s
	iters: 500, epoch: 15 | loss: 0.1931477
	speed: 0.0220s/iter; left time: 64.3467s
Epoch: 15 cost time: 13.424921989440918
Epoch: 15, Steps: 570 | Train Loss: 0.2439568 Vali Loss: 0.0513036 Test Loss: 0.1507314
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.3681219
	speed: 0.0617s/iter; left time: 169.7946s
	iters: 200, epoch: 16 | loss: 0.1981493
	speed: 0.0221s/iter; left time: 58.4722s
	iters: 300, epoch: 16 | loss: 0.2757837
	speed: 0.0220s/iter; left time: 56.2483s
	iters: 400, epoch: 16 | loss: 0.1725632
	speed: 0.0220s/iter; left time: 53.9678s
	iters: 500, epoch: 16 | loss: 0.1664240
	speed: 0.0220s/iter; left time: 51.8001s
Epoch: 16 cost time: 12.85262656211853
Epoch: 16, Steps: 570 | Train Loss: 0.2429575 Vali Loss: 0.0510715 Test Loss: 0.1507231
Validation loss decreased (0.051186 --> 0.051072).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1473253
	speed: 0.0646s/iter; left time: 140.9463s
	iters: 200, epoch: 17 | loss: 0.2017906
	speed: 0.0220s/iter; left time: 45.8393s
	iters: 300, epoch: 17 | loss: 0.1837082
	speed: 0.0220s/iter; left time: 43.6401s
	iters: 400, epoch: 17 | loss: 0.2509632
	speed: 0.0220s/iter; left time: 41.4246s
	iters: 500, epoch: 17 | loss: 0.2785687
	speed: 0.0220s/iter; left time: 39.2203s
Epoch: 17 cost time: 12.867923974990845
Epoch: 17, Steps: 570 | Train Loss: 0.2432089 Vali Loss: 0.0512008 Test Loss: 0.1507179
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 18 | loss: 0.1695665
	speed: 0.0646s/iter; left time: 104.0718s
	iters: 200, epoch: 18 | loss: 0.3731337
	speed: 0.0220s/iter; left time: 33.1876s
	iters: 300, epoch: 18 | loss: 0.2575006
	speed: 0.0219s/iter; left time: 30.9597s
	iters: 400, epoch: 18 | loss: 0.2911354
	speed: 0.0219s/iter; left time: 28.7678s
	iters: 500, epoch: 18 | loss: 0.5415210
	speed: 0.0219s/iter; left time: 26.5635s
Epoch: 18 cost time: 12.813192367553711
Epoch: 18, Steps: 570 | Train Loss: 0.2433491 Vali Loss: 0.0511329 Test Loss: 0.1507179
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 19 | loss: 0.1507591
	speed: 0.0654s/iter; left time: 68.0977s
	iters: 200, epoch: 19 | loss: 0.1737504
	speed: 0.0228s/iter; left time: 21.4833s
	iters: 300, epoch: 19 | loss: 0.1876396
	speed: 0.0228s/iter; left time: 19.1924s
	iters: 400, epoch: 19 | loss: 0.2638969
	speed: 0.0228s/iter; left time: 16.9139s
	iters: 500, epoch: 19 | loss: 0.4641080
	speed: 0.0228s/iter; left time: 14.6298s
Epoch: 19 cost time: 13.416096925735474
Epoch: 19, Steps: 570 | Train Loss: 0.2434421 Vali Loss: 0.0510736 Test Loss: 0.1507176
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1509568989276886, mae:0.2461848258972168
>>> MS_Pen LR=1e-3 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3161476
	speed: 0.0353s/iter; left time: 398.5193s
	iters: 200, epoch: 1 | loss: 0.1664882
	speed: 0.0232s/iter; left time: 259.3417s
	iters: 300, epoch: 1 | loss: 0.2394081
	speed: 0.0232s/iter; left time: 257.3929s
	iters: 400, epoch: 1 | loss: 0.3441008
	speed: 0.0232s/iter; left time: 255.2752s
	iters: 500, epoch: 1 | loss: 0.2611051
	speed: 0.0231s/iter; left time: 252.2730s
Epoch: 1 cost time: 14.476104259490967
Epoch: 1, Steps: 570 | Train Loss: 0.3431243 Vali Loss: 0.0626990 Test Loss: 0.1764411
Validation loss decreased (inf --> 0.062699).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3030506
	speed: 0.0631s/iter; left time: 677.4697s
	iters: 200, epoch: 2 | loss: 0.1775196
	speed: 0.0231s/iter; left time: 245.6484s
	iters: 300, epoch: 2 | loss: 0.3893668
	speed: 0.0234s/iter; left time: 246.6566s
	iters: 400, epoch: 2 | loss: 0.2905587
	speed: 0.0234s/iter; left time: 244.1227s
	iters: 500, epoch: 2 | loss: 0.2257946
	speed: 0.0234s/iter; left time: 241.7473s
Epoch: 2 cost time: 13.428266286849976
Epoch: 2, Steps: 570 | Train Loss: 0.2916583 Vali Loss: 0.0607554 Test Loss: 0.1789096
Validation loss decreased (0.062699 --> 0.060755).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3182587
	speed: 0.0648s/iter; left time: 658.0644s
	iters: 200, epoch: 3 | loss: 0.2862039
	speed: 0.0234s/iter; left time: 235.6964s
	iters: 300, epoch: 3 | loss: 0.1795823
	speed: 0.0234s/iter; left time: 233.4987s
	iters: 400, epoch: 3 | loss: 0.1741747
	speed: 0.0216s/iter; left time: 212.5953s
	iters: 500, epoch: 3 | loss: 0.2769111
	speed: 0.0213s/iter; left time: 208.1714s
Epoch: 3 cost time: 13.12405776977539
Epoch: 3, Steps: 570 | Train Loss: 0.2940707 Vali Loss: 0.0605991 Test Loss: 0.1736742
Validation loss decreased (0.060755 --> 0.060599).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1772935
	speed: 0.0639s/iter; left time: 613.3285s
	iters: 200, epoch: 4 | loss: 0.2779975
	speed: 0.0235s/iter; left time: 223.4661s
	iters: 300, epoch: 4 | loss: 0.2725044
	speed: 0.0236s/iter; left time: 221.1719s
	iters: 400, epoch: 4 | loss: 0.4775804
	speed: 0.0235s/iter; left time: 218.5567s
	iters: 500, epoch: 4 | loss: 0.2006392
	speed: 0.0234s/iter; left time: 215.3637s
Epoch: 4 cost time: 13.698753118515015
Epoch: 4, Steps: 570 | Train Loss: 0.2755009 Vali Loss: 0.0568068 Test Loss: 0.1658119
Validation loss decreased (0.060599 --> 0.056807).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3996459
	speed: 0.0661s/iter; left time: 596.0931s
	iters: 200, epoch: 5 | loss: 0.1945655
	speed: 0.0233s/iter; left time: 208.2558s
	iters: 300, epoch: 5 | loss: 0.3594762
	speed: 0.0234s/iter; left time: 206.0566s
	iters: 400, epoch: 5 | loss: 0.2734274
	speed: 0.0233s/iter; left time: 203.6156s
	iters: 500, epoch: 5 | loss: 0.2160389
	speed: 0.0234s/iter; left time: 201.3373s
Epoch: 5 cost time: 13.614511013031006
Epoch: 5, Steps: 570 | Train Loss: 0.2715319 Vali Loss: 0.0552411 Test Loss: 0.1620303
Validation loss decreased (0.056807 --> 0.055241).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2149313
	speed: 0.0656s/iter; left time: 554.2509s
	iters: 200, epoch: 6 | loss: 0.2937316
	speed: 0.0233s/iter; left time: 194.5883s
	iters: 300, epoch: 6 | loss: 0.2783031
	speed: 0.0233s/iter; left time: 192.1106s
	iters: 400, epoch: 6 | loss: 0.1931113
	speed: 0.0233s/iter; left time: 189.7226s
	iters: 500, epoch: 6 | loss: 0.1636817
	speed: 0.0233s/iter; left time: 187.4580s
Epoch: 6 cost time: 13.480162143707275
Epoch: 6, Steps: 570 | Train Loss: 0.2674805 Vali Loss: 0.0549978 Test Loss: 0.1617953
Validation loss decreased (0.055241 --> 0.054998).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2122845
	speed: 0.0628s/iter; left time: 495.2617s
	iters: 200, epoch: 7 | loss: 0.3822582
	speed: 0.0213s/iter; left time: 165.6783s
	iters: 300, epoch: 7 | loss: 0.2588146
	speed: 0.0214s/iter; left time: 164.2895s
	iters: 400, epoch: 7 | loss: 0.1555778
	speed: 0.0214s/iter; left time: 162.0968s
	iters: 500, epoch: 7 | loss: 0.2512133
	speed: 0.0213s/iter; left time: 159.1808s
Epoch: 7 cost time: 12.461121082305908
Epoch: 7, Steps: 570 | Train Loss: 0.2646220 Vali Loss: 0.0547525 Test Loss: 0.1604746
Validation loss decreased (0.054998 --> 0.054752).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2805597
	speed: 0.0632s/iter; left time: 462.2516s
	iters: 200, epoch: 8 | loss: 0.2447244
	speed: 0.0233s/iter; left time: 167.8116s
	iters: 300, epoch: 8 | loss: 0.2177183
	speed: 0.0233s/iter; left time: 165.5593s
	iters: 400, epoch: 8 | loss: 0.2888023
	speed: 0.0233s/iter; left time: 163.2088s
	iters: 500, epoch: 8 | loss: 0.3933767
	speed: 0.0233s/iter; left time: 160.7250s
Epoch: 8 cost time: 13.579666137695312
Epoch: 8, Steps: 570 | Train Loss: 0.2636584 Vali Loss: 0.0537159 Test Loss: 0.1601849
Validation loss decreased (0.054752 --> 0.053716).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1953794
	speed: 0.0646s/iter; left time: 435.2582s
	iters: 200, epoch: 9 | loss: 0.3769563
	speed: 0.0233s/iter; left time: 154.7991s
	iters: 300, epoch: 9 | loss: 0.3153676
	speed: 0.0233s/iter; left time: 152.4179s
	iters: 400, epoch: 9 | loss: 0.2661078
	speed: 0.0233s/iter; left time: 150.0546s
	iters: 500, epoch: 9 | loss: 0.1517549
	speed: 0.0233s/iter; left time: 147.7736s
Epoch: 9 cost time: 13.572636842727661
Epoch: 9, Steps: 570 | Train Loss: 0.2623373 Vali Loss: 0.0535643 Test Loss: 0.1600310
Validation loss decreased (0.053716 --> 0.053564).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1497404
	speed: 0.0653s/iter; left time: 402.7317s
	iters: 200, epoch: 10 | loss: 0.2863916
	speed: 0.0232s/iter; left time: 140.9455s
	iters: 300, epoch: 10 | loss: 0.2089572
	speed: 0.0232s/iter; left time: 138.5872s
	iters: 400, epoch: 10 | loss: 0.2620510
	speed: 0.0232s/iter; left time: 136.3450s
	iters: 500, epoch: 10 | loss: 0.4597659
	speed: 0.0232s/iter; left time: 133.9866s
Epoch: 10 cost time: 13.480076789855957
Epoch: 10, Steps: 570 | Train Loss: 0.2614273 Vali Loss: 0.0535410 Test Loss: 0.1599082
Validation loss decreased (0.053564 --> 0.053541).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.3531061
	speed: 0.0624s/iter; left time: 349.5249s
	iters: 200, epoch: 11 | loss: 0.2369592
	speed: 0.0212s/iter; left time: 116.6748s
	iters: 300, epoch: 11 | loss: 0.2537033
	speed: 0.0212s/iter; left time: 114.5839s
	iters: 400, epoch: 11 | loss: 0.2205848
	speed: 0.0212s/iter; left time: 112.4746s
	iters: 500, epoch: 11 | loss: 0.3265507
	speed: 0.0212s/iter; left time: 110.3525s
Epoch: 11 cost time: 12.390864372253418
Epoch: 11, Steps: 570 | Train Loss: 0.2630612 Vali Loss: 0.0534851 Test Loss: 0.1597832
Validation loss decreased (0.053541 --> 0.053485).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2853971
	speed: 0.0634s/iter; left time: 318.7860s
	iters: 200, epoch: 12 | loss: 0.2885956
	speed: 0.0213s/iter; left time: 105.1762s
	iters: 300, epoch: 12 | loss: 0.2627921
	speed: 0.0213s/iter; left time: 103.0177s
	iters: 400, epoch: 12 | loss: 0.4905828
	speed: 0.0213s/iter; left time: 100.9097s
	iters: 500, epoch: 12 | loss: 0.1787799
	speed: 0.0213s/iter; left time: 98.7474s
Epoch: 12 cost time: 12.468019485473633
Epoch: 12, Steps: 570 | Train Loss: 0.2615353 Vali Loss: 0.0535323 Test Loss: 0.1597302
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2102558
	speed: 0.0623s/iter; left time: 278.0786s
	iters: 200, epoch: 13 | loss: 0.3282454
	speed: 0.0212s/iter; left time: 92.3784s
	iters: 300, epoch: 13 | loss: 0.3855360
	speed: 0.0213s/iter; left time: 90.7889s
	iters: 400, epoch: 13 | loss: 0.1963362
	speed: 0.0214s/iter; left time: 89.1563s
	iters: 500, epoch: 13 | loss: 0.2938107
	speed: 0.0214s/iter; left time: 86.8736s
Epoch: 13 cost time: 12.45067024230957
Epoch: 13, Steps: 570 | Train Loss: 0.2610783 Vali Loss: 0.0537455 Test Loss: 0.1597098
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2878399
	speed: 0.0653s/iter; left time: 254.1590s
	iters: 200, epoch: 14 | loss: 0.3568465
	speed: 0.0213s/iter; left time: 80.6824s
	iters: 300, epoch: 14 | loss: 0.2511877
	speed: 0.0213s/iter; left time: 78.4900s
	iters: 400, epoch: 14 | loss: 0.1885774
	speed: 0.0212s/iter; left time: 76.3041s
	iters: 500, epoch: 14 | loss: 0.3288700
	speed: 0.0213s/iter; left time: 74.1893s
Epoch: 14 cost time: 12.438027620315552
Epoch: 14, Steps: 570 | Train Loss: 0.2623683 Vali Loss: 0.0534915 Test Loss: 0.1597202
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16003403067588806, mae:0.2549203038215637
>>> MS_Pen LR=1e-3 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3750713
	speed: 0.0320s/iter; left time: 361.8867s
	iters: 200, epoch: 1 | loss: 0.2384924
	speed: 0.0201s/iter; left time: 224.9494s
	iters: 300, epoch: 1 | loss: 0.3962362
	speed: 0.0201s/iter; left time: 223.5421s
	iters: 400, epoch: 1 | loss: 0.3838855
	speed: 0.0201s/iter; left time: 221.5351s
	iters: 500, epoch: 1 | loss: 0.2977023
	speed: 0.0201s/iter; left time: 218.8680s
Epoch: 1 cost time: 12.706952095031738
Epoch: 1, Steps: 570 | Train Loss: 0.3253613 Vali Loss: 0.0600034 Test Loss: 0.1750680
Validation loss decreased (inf --> 0.060003).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1929320
	speed: 0.0596s/iter; left time: 640.0854s
	iters: 200, epoch: 2 | loss: 0.4421982
	speed: 0.0201s/iter; left time: 213.5956s
	iters: 300, epoch: 2 | loss: 0.2038589
	speed: 0.0201s/iter; left time: 211.4239s
	iters: 400, epoch: 2 | loss: 0.2037856
	speed: 0.0201s/iter; left time: 209.1441s
	iters: 500, epoch: 2 | loss: 0.1888004
	speed: 0.0200s/iter; left time: 207.1106s
Epoch: 2 cost time: 11.752740383148193
Epoch: 2, Steps: 570 | Train Loss: 0.2930621 Vali Loss: 0.0606160 Test Loss: 0.1769885
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1883779
	speed: 0.0609s/iter; left time: 618.3782s
	iters: 200, epoch: 3 | loss: 0.2167855
	speed: 0.0200s/iter; left time: 201.6488s
	iters: 300, epoch: 3 | loss: 0.2373651
	speed: 0.0200s/iter; left time: 199.5134s
	iters: 400, epoch: 3 | loss: 0.2729523
	speed: 0.0200s/iter; left time: 197.4578s
	iters: 500, epoch: 3 | loss: 0.2416925
	speed: 0.0200s/iter; left time: 195.3207s
Epoch: 3 cost time: 11.680440664291382
Epoch: 3, Steps: 570 | Train Loss: 0.2737659 Vali Loss: 0.0587743 Test Loss: 0.1689647
Validation loss decreased (0.060003 --> 0.058774).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1936586
	speed: 0.0613s/iter; left time: 588.1671s
	iters: 200, epoch: 4 | loss: 0.4690208
	speed: 0.0216s/iter; left time: 204.8829s
	iters: 300, epoch: 4 | loss: 0.1593448
	speed: 0.0206s/iter; left time: 193.0681s
	iters: 400, epoch: 4 | loss: 0.2790157
	speed: 0.0202s/iter; left time: 187.5180s
	iters: 500, epoch: 4 | loss: 0.2002249
	speed: 0.0202s/iter; left time: 185.5398s
Epoch: 4 cost time: 12.192917823791504
Epoch: 4, Steps: 570 | Train Loss: 0.2635137 Vali Loss: 0.0581995 Test Loss: 0.1645378
Validation loss decreased (0.058774 --> 0.058199).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2272132
	speed: 0.0595s/iter; left time: 536.6104s
	iters: 200, epoch: 5 | loss: 0.3608044
	speed: 0.0200s/iter; left time: 178.4827s
	iters: 300, epoch: 5 | loss: 0.2277764
	speed: 0.0200s/iter; left time: 176.2827s
	iters: 400, epoch: 5 | loss: 0.2039683
	speed: 0.0200s/iter; left time: 174.3736s
	iters: 500, epoch: 5 | loss: 0.2077701
	speed: 0.0200s/iter; left time: 172.2810s
Epoch: 5 cost time: 11.70464825630188
Epoch: 5, Steps: 570 | Train Loss: 0.2560573 Vali Loss: 0.0551996 Test Loss: 0.1609608
Validation loss decreased (0.058199 --> 0.055200).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2360426
	speed: 0.0603s/iter; left time: 509.3242s
	iters: 200, epoch: 6 | loss: 0.2853209
	speed: 0.0200s/iter; left time: 166.7815s
	iters: 300, epoch: 6 | loss: 0.2220450
	speed: 0.0200s/iter; left time: 164.9200s
	iters: 400, epoch: 6 | loss: 0.1477225
	speed: 0.0200s/iter; left time: 162.6922s
	iters: 500, epoch: 6 | loss: 0.4107995
	speed: 0.0200s/iter; left time: 160.8350s
Epoch: 6 cost time: 11.693007946014404
Epoch: 6, Steps: 570 | Train Loss: 0.2535157 Vali Loss: 0.0549975 Test Loss: 0.1580261
Validation loss decreased (0.055200 --> 0.054997).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3114533
	speed: 0.0591s/iter; left time: 466.0816s
	iters: 200, epoch: 7 | loss: 0.2534463
	speed: 0.0200s/iter; left time: 155.5244s
	iters: 300, epoch: 7 | loss: 0.3523537
	speed: 0.0200s/iter; left time: 153.6090s
	iters: 400, epoch: 7 | loss: 0.3355589
	speed: 0.0200s/iter; left time: 151.4505s
	iters: 500, epoch: 7 | loss: 0.1799890
	speed: 0.0200s/iter; left time: 149.5474s
Epoch: 7 cost time: 11.709465503692627
Epoch: 7, Steps: 570 | Train Loss: 0.2523162 Vali Loss: 0.0547585 Test Loss: 0.1581271
Validation loss decreased (0.054997 --> 0.054758).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2612191
	speed: 0.0595s/iter; left time: 434.9056s
	iters: 200, epoch: 8 | loss: 0.3386334
	speed: 0.0200s/iter; left time: 144.3975s
	iters: 300, epoch: 8 | loss: 0.2633469
	speed: 0.0200s/iter; left time: 142.0843s
	iters: 400, epoch: 8 | loss: 0.1686364
	speed: 0.0200s/iter; left time: 140.2720s
	iters: 500, epoch: 8 | loss: 0.2778310
	speed: 0.0200s/iter; left time: 138.0344s
Epoch: 8 cost time: 11.702616453170776
Epoch: 8, Steps: 570 | Train Loss: 0.2498978 Vali Loss: 0.0546581 Test Loss: 0.1582896
Validation loss decreased (0.054758 --> 0.054658).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2200691
	speed: 0.0612s/iter; left time: 412.3361s
	iters: 200, epoch: 9 | loss: 0.1982438
	speed: 0.0201s/iter; left time: 133.3382s
	iters: 300, epoch: 9 | loss: 0.3227975
	speed: 0.0200s/iter; left time: 131.0131s
	iters: 400, epoch: 9 | loss: 0.1825926
	speed: 0.0201s/iter; left time: 129.2715s
	iters: 500, epoch: 9 | loss: 0.1337509
	speed: 0.0201s/iter; left time: 127.2780s
Epoch: 9 cost time: 11.746823072433472
Epoch: 9, Steps: 570 | Train Loss: 0.2481816 Vali Loss: 0.0542581 Test Loss: 0.1577739
Validation loss decreased (0.054658 --> 0.054258).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2540298
	speed: 0.0642s/iter; left time: 396.0945s
	iters: 200, epoch: 10 | loss: 0.1545343
	speed: 0.0219s/iter; left time: 132.8627s
	iters: 300, epoch: 10 | loss: 0.3586917
	speed: 0.0201s/iter; left time: 120.0859s
	iters: 400, epoch: 10 | loss: 0.3334013
	speed: 0.0201s/iter; left time: 117.9883s
	iters: 500, epoch: 10 | loss: 0.2832596
	speed: 0.0201s/iter; left time: 116.0250s
Epoch: 10 cost time: 12.23630666732788
Epoch: 10, Steps: 570 | Train Loss: 0.2475352 Vali Loss: 0.0543245 Test Loss: 0.1575581
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2243875
	speed: 0.0592s/iter; left time: 331.4847s
	iters: 200, epoch: 11 | loss: 0.1915517
	speed: 0.0200s/iter; left time: 109.9235s
	iters: 300, epoch: 11 | loss: 0.1809626
	speed: 0.0200s/iter; left time: 107.9249s
	iters: 400, epoch: 11 | loss: 0.2830651
	speed: 0.0200s/iter; left time: 106.2524s
	iters: 500, epoch: 11 | loss: 0.2446860
	speed: 0.0201s/iter; left time: 104.5652s
Epoch: 11 cost time: 11.724725484848022
Epoch: 11, Steps: 570 | Train Loss: 0.2494600 Vali Loss: 0.0542594 Test Loss: 0.1575069
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2128759
	speed: 0.0623s/iter; left time: 313.4030s
	iters: 200, epoch: 12 | loss: 0.2073058
	speed: 0.0201s/iter; left time: 98.9327s
	iters: 300, epoch: 12 | loss: 0.3986588
	speed: 0.0201s/iter; left time: 96.8802s
	iters: 400, epoch: 12 | loss: 0.2917931
	speed: 0.0201s/iter; left time: 94.8677s
	iters: 500, epoch: 12 | loss: 0.3904171
	speed: 0.0200s/iter; left time: 92.8178s
Epoch: 12 cost time: 11.710743188858032
Epoch: 12, Steps: 570 | Train Loss: 0.2470809 Vali Loss: 0.0541609 Test Loss: 0.1575785
Validation loss decreased (0.054258 --> 0.054161).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2367580
	speed: 0.0607s/iter; left time: 270.9749s
	iters: 200, epoch: 13 | loss: 0.1958071
	speed: 0.0202s/iter; left time: 87.9422s
	iters: 300, epoch: 13 | loss: 0.2263430
	speed: 0.0202s/iter; left time: 86.0211s
	iters: 400, epoch: 13 | loss: 0.1741709
	speed: 0.0202s/iter; left time: 84.0325s
	iters: 500, epoch: 13 | loss: 0.2542644
	speed: 0.0202s/iter; left time: 81.8852s
Epoch: 13 cost time: 11.826369524002075
Epoch: 13, Steps: 570 | Train Loss: 0.2463888 Vali Loss: 0.0543651 Test Loss: 0.1576215
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.3378410
	speed: 0.0592s/iter; left time: 230.2645s
	iters: 200, epoch: 14 | loss: 0.2707462
	speed: 0.0200s/iter; left time: 75.6791s
	iters: 300, epoch: 14 | loss: 0.2441809
	speed: 0.0200s/iter; left time: 73.9717s
	iters: 400, epoch: 14 | loss: 0.1679864
	speed: 0.0201s/iter; left time: 72.2263s
	iters: 500, epoch: 14 | loss: 0.2040246
	speed: 0.0201s/iter; left time: 70.2131s
Epoch: 14 cost time: 11.708327054977417
Epoch: 14, Steps: 570 | Train Loss: 0.2480999 Vali Loss: 0.0542178 Test Loss: 0.1576006
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1153651
	speed: 0.0616s/iter; left time: 204.6781s
	iters: 200, epoch: 15 | loss: 0.2474753
	speed: 0.0201s/iter; left time: 64.7336s
	iters: 300, epoch: 15 | loss: 0.2665219
	speed: 0.0201s/iter; left time: 62.7207s
	iters: 400, epoch: 15 | loss: 0.2181464
	speed: 0.0201s/iter; left time: 60.6115s
	iters: 500, epoch: 15 | loss: 0.2044065
	speed: 0.0201s/iter; left time: 58.6519s
Epoch: 15 cost time: 11.764378070831299
Epoch: 15, Steps: 570 | Train Loss: 0.2474956 Vali Loss: 0.0543596 Test Loss: 0.1575866
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15779076516628265, mae:0.25428980588912964
>>> MS_Pen LR=5e-4 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2045864
	speed: 0.0215s/iter; left time: 242.4308s
	iters: 200, epoch: 1 | loss: 0.1733620
	speed: 0.0099s/iter; left time: 111.2111s
	iters: 300, epoch: 1 | loss: 0.1845773
	speed: 0.0099s/iter; left time: 110.3044s
	iters: 400, epoch: 1 | loss: 0.2216783
	speed: 0.0099s/iter; left time: 109.2290s
	iters: 500, epoch: 1 | loss: 0.1751772
	speed: 0.0099s/iter; left time: 108.3801s
Epoch: 1 cost time: 6.8602612018585205
Epoch: 1, Steps: 570 | Train Loss: 0.1821493 Vali Loss: 0.0413525 Test Loss: 0.1348096
Validation loss decreased (inf --> 0.041352).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2144081
	speed: 0.0371s/iter; left time: 398.6370s
	iters: 200, epoch: 2 | loss: 0.1845828
	speed: 0.0100s/iter; left time: 106.4349s
	iters: 300, epoch: 2 | loss: 0.1327614
	speed: 0.0100s/iter; left time: 105.1295s
	iters: 400, epoch: 2 | loss: 0.1287039
	speed: 0.0100s/iter; left time: 104.4065s
	iters: 500, epoch: 2 | loss: 0.1282229
	speed: 0.0100s/iter; left time: 103.5012s
Epoch: 2 cost time: 6.026155471801758
Epoch: 2, Steps: 570 | Train Loss: 0.1363370 Vali Loss: 0.0428581 Test Loss: 0.1446546
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0952069
	speed: 0.0363s/iter; left time: 368.4536s
	iters: 200, epoch: 3 | loss: 0.0870392
	speed: 0.0099s/iter; left time: 100.1041s
	iters: 300, epoch: 3 | loss: 0.1000157
	speed: 0.0099s/iter; left time: 99.0757s
	iters: 400, epoch: 3 | loss: 0.1262193
	speed: 0.0100s/iter; left time: 98.1495s
	iters: 500, epoch: 3 | loss: 0.1357596
	speed: 0.0100s/iter; left time: 97.4746s
Epoch: 3 cost time: 5.978883266448975
Epoch: 3, Steps: 570 | Train Loss: 0.0925927 Vali Loss: 0.0359032 Test Loss: 0.1393120
Validation loss decreased (0.041352 --> 0.035903).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0781045
	speed: 0.0362s/iter; left time: 347.5910s
	iters: 200, epoch: 4 | loss: 0.0516135
	speed: 0.0100s/iter; left time: 94.9344s
	iters: 300, epoch: 4 | loss: 0.0606628
	speed: 0.0100s/iter; left time: 93.6454s
	iters: 400, epoch: 4 | loss: 0.0607548
	speed: 0.0100s/iter; left time: 92.7493s
	iters: 500, epoch: 4 | loss: 0.0538257
	speed: 0.0100s/iter; left time: 91.8026s
Epoch: 4 cost time: 6.020134925842285
Epoch: 4, Steps: 570 | Train Loss: 0.0625449 Vali Loss: 0.0349575 Test Loss: 0.1432575
Validation loss decreased (0.035903 --> 0.034958).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0577946
	speed: 0.0355s/iter; left time: 320.6362s
	iters: 200, epoch: 5 | loss: 0.0472868
	speed: 0.0099s/iter; left time: 88.5414s
	iters: 300, epoch: 5 | loss: 0.0331563
	speed: 0.0099s/iter; left time: 87.6651s
	iters: 400, epoch: 5 | loss: 0.0448815
	speed: 0.0100s/iter; left time: 86.7823s
	iters: 500, epoch: 5 | loss: 0.0354932
	speed: 0.0100s/iter; left time: 85.8548s
Epoch: 5 cost time: 5.946153163909912
Epoch: 5, Steps: 570 | Train Loss: 0.0484084 Vali Loss: 0.0367225 Test Loss: 0.1430236
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0351372
	speed: 0.0354s/iter; left time: 298.7787s
	iters: 200, epoch: 6 | loss: 0.0406563
	speed: 0.0100s/iter; left time: 83.7205s
	iters: 300, epoch: 6 | loss: 0.0399993
	speed: 0.0100s/iter; left time: 82.4883s
	iters: 400, epoch: 6 | loss: 0.0410174
	speed: 0.0100s/iter; left time: 81.6124s
	iters: 500, epoch: 6 | loss: 0.0541643
	speed: 0.0100s/iter; left time: 80.6180s
Epoch: 6 cost time: 5.988423824310303
Epoch: 6, Steps: 570 | Train Loss: 0.0415848 Vali Loss: 0.0371886 Test Loss: 0.1487364
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0409232
	speed: 0.0369s/iter; left time: 290.7145s
	iters: 200, epoch: 7 | loss: 0.0348230
	speed: 0.0105s/iter; left time: 81.5195s
	iters: 300, epoch: 7 | loss: 0.0323584
	speed: 0.0100s/iter; left time: 76.9570s
	iters: 400, epoch: 7 | loss: 0.0282780
	speed: 0.0099s/iter; left time: 75.3216s
	iters: 500, epoch: 7 | loss: 0.0294352
	speed: 0.0099s/iter; left time: 74.1313s
Epoch: 7 cost time: 6.124318838119507
Epoch: 7, Steps: 570 | Train Loss: 0.0382855 Vali Loss: 0.0377978 Test Loss: 0.1479969
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14332592487335205, mae:0.2375890612602234
>>> MS_Pen LR=5e-4 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1894308
	speed: 0.0216s/iter; left time: 244.6421s
	iters: 200, epoch: 1 | loss: 0.1330029
	speed: 0.0098s/iter; left time: 110.1079s
	iters: 300, epoch: 1 | loss: 0.2196530
	speed: 0.0098s/iter; left time: 109.2120s
	iters: 400, epoch: 1 | loss: 0.1302457
	speed: 0.0098s/iter; left time: 107.3398s
	iters: 500, epoch: 1 | loss: 0.1308354
	speed: 0.0098s/iter; left time: 106.4230s
Epoch: 1 cost time: 6.812453746795654
Epoch: 1, Steps: 570 | Train Loss: 0.1541994 Vali Loss: 0.0412486 Test Loss: 0.1267791
Validation loss decreased (inf --> 0.041249).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1281098
	speed: 0.0345s/iter; left time: 370.2789s
	iters: 200, epoch: 2 | loss: 0.1275928
	speed: 0.0097s/iter; left time: 103.3064s
	iters: 300, epoch: 2 | loss: 0.0834541
	speed: 0.0097s/iter; left time: 101.9373s
	iters: 400, epoch: 2 | loss: 0.0823608
	speed: 0.0097s/iter; left time: 100.9951s
	iters: 500, epoch: 2 | loss: 0.1316990
	speed: 0.0097s/iter; left time: 99.9694s
Epoch: 2 cost time: 5.811763525009155
Epoch: 2, Steps: 570 | Train Loss: 0.1233870 Vali Loss: 0.0366897 Test Loss: 0.1233841
Validation loss decreased (0.041249 --> 0.036690).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0563195
	speed: 0.0345s/iter; left time: 350.4104s
	iters: 200, epoch: 3 | loss: 0.0907829
	speed: 0.0098s/iter; left time: 98.0950s
	iters: 300, epoch: 3 | loss: 0.1418052
	speed: 0.0098s/iter; left time: 97.1725s
	iters: 400, epoch: 3 | loss: 0.0587475
	speed: 0.0098s/iter; left time: 96.5841s
	iters: 500, epoch: 3 | loss: 0.0693893
	speed: 0.0098s/iter; left time: 95.2658s
Epoch: 3 cost time: 5.86772084236145
Epoch: 3, Steps: 570 | Train Loss: 0.0876941 Vali Loss: 0.0350165 Test Loss: 0.1257647
Validation loss decreased (0.036690 --> 0.035017).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0485780
	speed: 0.0347s/iter; left time: 332.4627s
	iters: 200, epoch: 4 | loss: 0.0523655
	speed: 0.0097s/iter; left time: 92.0508s
	iters: 300, epoch: 4 | loss: 0.0428194
	speed: 0.0097s/iter; left time: 90.8949s
	iters: 400, epoch: 4 | loss: 0.0515971
	speed: 0.0097s/iter; left time: 89.9886s
	iters: 500, epoch: 4 | loss: 0.0801588
	speed: 0.0097s/iter; left time: 89.1669s
Epoch: 4 cost time: 5.791520118713379
Epoch: 4, Steps: 570 | Train Loss: 0.0639764 Vali Loss: 0.0358091 Test Loss: 0.1240897
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0482407
	speed: 0.0347s/iter; left time: 312.7216s
	iters: 200, epoch: 5 | loss: 0.0729651
	speed: 0.0109s/iter; left time: 97.4845s
	iters: 300, epoch: 5 | loss: 0.0555053
	speed: 0.0110s/iter; left time: 96.9217s
	iters: 400, epoch: 5 | loss: 0.0634048
	speed: 0.0110s/iter; left time: 95.7284s
	iters: 500, epoch: 5 | loss: 0.0581363
	speed: 0.0110s/iter; left time: 94.4803s
Epoch: 5 cost time: 6.507568359375
Epoch: 5, Steps: 570 | Train Loss: 0.0499830 Vali Loss: 0.0383923 Test Loss: 0.1285279
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0308606
	speed: 0.0345s/iter; left time: 291.9615s
	iters: 200, epoch: 6 | loss: 0.0748379
	speed: 0.0097s/iter; left time: 80.7840s
	iters: 300, epoch: 6 | loss: 0.0436732
	speed: 0.0097s/iter; left time: 79.8416s
	iters: 400, epoch: 6 | loss: 0.0375415
	speed: 0.0097s/iter; left time: 78.8149s
	iters: 500, epoch: 6 | loss: 0.0333465
	speed: 0.0097s/iter; left time: 77.8436s
Epoch: 6 cost time: 5.779268741607666
Epoch: 6, Steps: 570 | Train Loss: 0.0432871 Vali Loss: 0.0388103 Test Loss: 0.1302710
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1259264498949051, mae:0.21734750270843506
>>> MS_Pen LR=5e-4 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1788316
	speed: 0.0213s/iter; left time: 240.5591s
	iters: 200, epoch: 1 | loss: 0.1158331
	speed: 0.0097s/iter; left time: 108.4513s
	iters: 300, epoch: 1 | loss: 0.1227661
	speed: 0.0097s/iter; left time: 107.8747s
	iters: 400, epoch: 1 | loss: 0.1196469
	speed: 0.0097s/iter; left time: 106.6722s
	iters: 500, epoch: 1 | loss: 0.1578856
	speed: 0.0097s/iter; left time: 105.6887s
Epoch: 1 cost time: 6.729521989822388
Epoch: 1, Steps: 570 | Train Loss: 0.1846814 Vali Loss: 0.0437129 Test Loss: 0.1455738
Validation loss decreased (inf --> 0.043713).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1516466
	speed: 0.0355s/iter; left time: 381.2888s
	iters: 200, epoch: 2 | loss: 0.2437462
	speed: 0.0097s/iter; left time: 103.5389s
	iters: 300, epoch: 2 | loss: 0.1125790
	speed: 0.0098s/iter; left time: 103.0474s
	iters: 400, epoch: 2 | loss: 0.1774130
	speed: 0.0109s/iter; left time: 113.8251s
	iters: 500, epoch: 2 | loss: 0.1317417
	speed: 0.0102s/iter; left time: 105.2596s
Epoch: 2 cost time: 6.02535080909729
Epoch: 2, Steps: 570 | Train Loss: 0.1289980 Vali Loss: 0.0430496 Test Loss: 0.1422208
Validation loss decreased (0.043713 --> 0.043050).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0618814
	speed: 0.0352s/iter; left time: 357.9151s
	iters: 200, epoch: 3 | loss: 0.0606751
	speed: 0.0097s/iter; left time: 97.8025s
	iters: 300, epoch: 3 | loss: 0.0833563
	speed: 0.0097s/iter; left time: 96.9290s
	iters: 400, epoch: 3 | loss: 0.0708743
	speed: 0.0097s/iter; left time: 95.6428s
	iters: 500, epoch: 3 | loss: 0.0569978
	speed: 0.0097s/iter; left time: 94.6316s
Epoch: 3 cost time: 5.851056098937988
Epoch: 3, Steps: 570 | Train Loss: 0.0756051 Vali Loss: 0.0408516 Test Loss: 0.1487618
Validation loss decreased (0.043050 --> 0.040852).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0427574
	speed: 0.0362s/iter; left time: 347.3573s
	iters: 200, epoch: 4 | loss: 0.0320558
	speed: 0.0109s/iter; left time: 103.5729s
	iters: 300, epoch: 4 | loss: 0.0364721
	speed: 0.0109s/iter; left time: 102.3076s
	iters: 400, epoch: 4 | loss: 0.0605254
	speed: 0.0109s/iter; left time: 101.5868s
	iters: 500, epoch: 4 | loss: 0.0324417
	speed: 0.0109s/iter; left time: 100.6225s
Epoch: 4 cost time: 6.488371133804321
Epoch: 4, Steps: 570 | Train Loss: 0.0469996 Vali Loss: 0.0432537 Test Loss: 0.1555758
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0344975
	speed: 0.0346s/iter; left time: 312.3387s
	iters: 200, epoch: 5 | loss: 0.0295287
	speed: 0.0097s/iter; left time: 86.9466s
	iters: 300, epoch: 5 | loss: 0.0288482
	speed: 0.0097s/iter; left time: 85.9730s
	iters: 400, epoch: 5 | loss: 0.0274112
	speed: 0.0097s/iter; left time: 85.0115s
	iters: 500, epoch: 5 | loss: 0.0375796
	speed: 0.0097s/iter; left time: 83.8033s
Epoch: 5 cost time: 5.794804334640503
Epoch: 5, Steps: 570 | Train Loss: 0.0353634 Vali Loss: 0.0431669 Test Loss: 0.1515637
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0269072
	speed: 0.0363s/iter; left time: 306.6340s
	iters: 200, epoch: 6 | loss: 0.0402103
	speed: 0.0110s/iter; left time: 91.5123s
	iters: 300, epoch: 6 | loss: 0.0309541
	speed: 0.0102s/iter; left time: 84.3721s
	iters: 400, epoch: 6 | loss: 0.0232301
	speed: 0.0098s/iter; left time: 79.9521s
	iters: 500, epoch: 6 | loss: 0.0320284
	speed: 0.0098s/iter; left time: 78.9875s
Epoch: 6 cost time: 6.133069276809692
Epoch: 6, Steps: 570 | Train Loss: 0.0302128 Vali Loss: 0.0432570 Test Loss: 0.1535778
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14884638786315918, mae:0.2425193339586258
>>> MS_Pen LR=5e-4 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2924939
	speed: 0.0252s/iter; left time: 284.5456s
	iters: 200, epoch: 1 | loss: 0.1928521
	speed: 0.0124s/iter; left time: 139.1000s
	iters: 300, epoch: 1 | loss: 0.1504872
	speed: 0.0120s/iter; left time: 133.4810s
	iters: 400, epoch: 1 | loss: 0.0700475
	speed: 0.0114s/iter; left time: 125.7196s
	iters: 500, epoch: 1 | loss: 0.1537740
	speed: 0.0124s/iter; left time: 135.0276s
Epoch: 1 cost time: 8.254524946212769
Epoch: 1, Steps: 570 | Train Loss: 0.1965059 Vali Loss: 0.0404568 Test Loss: 0.1293754
Validation loss decreased (inf --> 0.040457).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1456333
	speed: 0.0404s/iter; left time: 433.4160s
	iters: 200, epoch: 2 | loss: 0.1334302
	speed: 0.0114s/iter; left time: 121.0535s
	iters: 300, epoch: 2 | loss: 0.0984692
	speed: 0.0114s/iter; left time: 119.9120s
	iters: 400, epoch: 2 | loss: 0.0904908
	speed: 0.0114s/iter; left time: 118.8203s
	iters: 500, epoch: 2 | loss: 0.1791390
	speed: 0.0114s/iter; left time: 117.6539s
Epoch: 2 cost time: 6.81063175201416
Epoch: 2, Steps: 570 | Train Loss: 0.1686298 Vali Loss: 0.0420141 Test Loss: 0.1326272
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1985071
	speed: 0.0378s/iter; left time: 384.1937s
	iters: 200, epoch: 3 | loss: 0.1590382
	speed: 0.0114s/iter; left time: 114.8653s
	iters: 300, epoch: 3 | loss: 0.0849006
	speed: 0.0114s/iter; left time: 113.5585s
	iters: 400, epoch: 3 | loss: 0.1209482
	speed: 0.0114s/iter; left time: 112.4056s
	iters: 500, epoch: 3 | loss: 0.0976644
	speed: 0.0114s/iter; left time: 111.4981s
Epoch: 3 cost time: 6.7990882396698
Epoch: 3, Steps: 570 | Train Loss: 0.1460637 Vali Loss: 0.0442504 Test Loss: 0.1377442
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0753799
	speed: 0.0384s/iter; left time: 368.5378s
	iters: 200, epoch: 4 | loss: 0.1548820
	speed: 0.0114s/iter; left time: 107.9122s
	iters: 300, epoch: 4 | loss: 0.0729915
	speed: 0.0114s/iter; left time: 107.0969s
	iters: 400, epoch: 4 | loss: 0.0912375
	speed: 0.0114s/iter; left time: 106.3535s
	iters: 500, epoch: 4 | loss: 0.1034312
	speed: 0.0114s/iter; left time: 105.0565s
Epoch: 4 cost time: 6.777982711791992
Epoch: 4, Steps: 570 | Train Loss: 0.1184274 Vali Loss: 0.0416804 Test Loss: 0.1313710
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12956693768501282, mae:0.2266797423362732
>>> MS_Pen LR=5e-4 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.0988105
	speed: 0.0241s/iter; left time: 272.8495s
	iters: 200, epoch: 1 | loss: 0.2299928
	speed: 0.0121s/iter; left time: 135.2166s
	iters: 300, epoch: 1 | loss: 0.1473292
	speed: 0.0120s/iter; left time: 133.6652s
	iters: 400, epoch: 1 | loss: 0.2019569
	speed: 0.0120s/iter; left time: 132.5233s
	iters: 500, epoch: 1 | loss: 0.1238144
	speed: 0.0121s/iter; left time: 131.7801s
Epoch: 1 cost time: 8.133400678634644
Epoch: 1, Steps: 570 | Train Loss: 0.1669668 Vali Loss: 0.0434678 Test Loss: 0.1273761
Validation loss decreased (inf --> 0.043468).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1273392
	speed: 0.0399s/iter; left time: 428.4702s
	iters: 200, epoch: 2 | loss: 0.0809040
	speed: 0.0121s/iter; left time: 128.3825s
	iters: 300, epoch: 2 | loss: 0.1350428
	speed: 0.0121s/iter; left time: 127.3370s
	iters: 400, epoch: 2 | loss: 0.1599243
	speed: 0.0121s/iter; left time: 125.9648s
	iters: 500, epoch: 2 | loss: 0.2239113
	speed: 0.0121s/iter; left time: 125.0470s
Epoch: 2 cost time: 7.213498830795288
Epoch: 2, Steps: 570 | Train Loss: 0.1429938 Vali Loss: 0.0410966 Test Loss: 0.1330668
Validation loss decreased (0.043468 --> 0.041097).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1490123
	speed: 0.0409s/iter; left time: 415.5291s
	iters: 200, epoch: 3 | loss: 0.0789336
	speed: 0.0111s/iter; left time: 111.8438s
	iters: 300, epoch: 3 | loss: 0.1141904
	speed: 0.0111s/iter; left time: 110.1597s
	iters: 400, epoch: 3 | loss: 0.1238904
	speed: 0.0110s/iter; left time: 108.9573s
	iters: 500, epoch: 3 | loss: 0.1248248
	speed: 0.0111s/iter; left time: 108.0515s
Epoch: 3 cost time: 6.63837456703186
Epoch: 3, Steps: 570 | Train Loss: 0.1098653 Vali Loss: 0.0350523 Test Loss: 0.1211184
Validation loss decreased (0.041097 --> 0.035052).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0940389
	speed: 0.0395s/iter; left time: 378.7844s
	iters: 200, epoch: 4 | loss: 0.0636871
	speed: 0.0111s/iter; left time: 105.0212s
	iters: 300, epoch: 4 | loss: 0.0462316
	speed: 0.0111s/iter; left time: 103.9482s
	iters: 400, epoch: 4 | loss: 0.0831548
	speed: 0.0111s/iter; left time: 102.8385s
	iters: 500, epoch: 4 | loss: 0.0733554
	speed: 0.0111s/iter; left time: 101.6883s
Epoch: 4 cost time: 6.62926459312439
Epoch: 4, Steps: 570 | Train Loss: 0.0877338 Vali Loss: 0.0353559 Test Loss: 0.1255208
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0661100
	speed: 0.0378s/iter; left time: 341.0703s
	iters: 200, epoch: 5 | loss: 0.0648675
	speed: 0.0110s/iter; left time: 98.0764s
	iters: 300, epoch: 5 | loss: 0.0798953
	speed: 0.0110s/iter; left time: 96.9640s
	iters: 400, epoch: 5 | loss: 0.0777359
	speed: 0.0110s/iter; left time: 95.8433s
	iters: 500, epoch: 5 | loss: 0.0630632
	speed: 0.0110s/iter; left time: 94.7172s
Epoch: 5 cost time: 6.55872106552124
Epoch: 5, Steps: 570 | Train Loss: 0.0707912 Vali Loss: 0.0335569 Test Loss: 0.1300794
Validation loss decreased (0.035052 --> 0.033557).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0917503
	speed: 0.0393s/iter; left time: 332.1561s
	iters: 200, epoch: 6 | loss: 0.0531432
	speed: 0.0111s/iter; left time: 92.2842s
	iters: 300, epoch: 6 | loss: 0.0540759
	speed: 0.0110s/iter; left time: 91.1203s
	iters: 400, epoch: 6 | loss: 0.0419210
	speed: 0.0110s/iter; left time: 90.0328s
	iters: 500, epoch: 6 | loss: 0.0489932
	speed: 0.0110s/iter; left time: 88.9097s
Epoch: 6 cost time: 6.644634962081909
Epoch: 6, Steps: 570 | Train Loss: 0.0596555 Vali Loss: 0.0342453 Test Loss: 0.1369105
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0469150
	speed: 0.0393s/iter; left time: 309.9535s
	iters: 200, epoch: 7 | loss: 0.0627756
	speed: 0.0110s/iter; left time: 85.6078s
	iters: 300, epoch: 7 | loss: 0.0445048
	speed: 0.0110s/iter; left time: 84.4709s
	iters: 400, epoch: 7 | loss: 0.0509527
	speed: 0.0110s/iter; left time: 83.4528s
	iters: 500, epoch: 7 | loss: 0.0366362
	speed: 0.0110s/iter; left time: 82.3686s
Epoch: 7 cost time: 6.574743747711182
Epoch: 7, Steps: 570 | Train Loss: 0.0531000 Vali Loss: 0.0344265 Test Loss: 0.1379838
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0499541
	speed: 0.0372s/iter; left time: 271.8660s
	iters: 200, epoch: 8 | loss: 0.0632219
	speed: 0.0111s/iter; left time: 79.7427s
	iters: 300, epoch: 8 | loss: 0.0348987
	speed: 0.0110s/iter; left time: 78.4013s
	iters: 400, epoch: 8 | loss: 0.0534596
	speed: 0.0110s/iter; left time: 77.3227s
	iters: 500, epoch: 8 | loss: 0.0433620
	speed: 0.0111s/iter; left time: 76.3954s
Epoch: 8 cost time: 6.572651147842407
Epoch: 8, Steps: 570 | Train Loss: 0.0495741 Vali Loss: 0.0346185 Test Loss: 0.1381538
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13020673394203186, mae:0.22063812613487244
>>> MS_Pen LR=5e-4 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2180052
	speed: 0.0233s/iter; left time: 263.1723s
	iters: 200, epoch: 1 | loss: 0.2887788
	speed: 0.0118s/iter; left time: 132.0165s
	iters: 300, epoch: 1 | loss: 0.2479474
	speed: 0.0118s/iter; left time: 130.5025s
	iters: 400, epoch: 1 | loss: 0.1906537
	speed: 0.0117s/iter; left time: 129.1303s
	iters: 500, epoch: 1 | loss: 0.1694543
	speed: 0.0118s/iter; left time: 128.3443s
Epoch: 1 cost time: 7.855860710144043
Epoch: 1, Steps: 570 | Train Loss: 0.1962822 Vali Loss: 0.0463981 Test Loss: 0.1506609
Validation loss decreased (inf --> 0.046398).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1667731
	speed: 0.0368s/iter; left time: 395.3006s
	iters: 200, epoch: 2 | loss: 0.2281767
	speed: 0.0116s/iter; left time: 123.5134s
	iters: 300, epoch: 2 | loss: 0.1253162
	speed: 0.0117s/iter; left time: 123.6071s
	iters: 400, epoch: 2 | loss: 0.1322799
	speed: 0.0118s/iter; left time: 122.6497s
	iters: 500, epoch: 2 | loss: 0.1799139
	speed: 0.0117s/iter; left time: 121.2620s
Epoch: 2 cost time: 6.876274824142456
Epoch: 2, Steps: 570 | Train Loss: 0.1747005 Vali Loss: 0.0487041 Test Loss: 0.1493196
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1390735
	speed: 0.0386s/iter; left time: 392.5602s
	iters: 200, epoch: 3 | loss: 0.1186322
	speed: 0.0118s/iter; left time: 118.6541s
	iters: 300, epoch: 3 | loss: 0.1809721
	speed: 0.0118s/iter; left time: 117.4354s
	iters: 400, epoch: 3 | loss: 0.0892423
	speed: 0.0118s/iter; left time: 116.0308s
	iters: 500, epoch: 3 | loss: 0.1772537
	speed: 0.0118s/iter; left time: 114.9509s
Epoch: 3 cost time: 7.025604248046875
Epoch: 3, Steps: 570 | Train Loss: 0.1422745 Vali Loss: 0.0438747 Test Loss: 0.1436054
Validation loss decreased (0.046398 --> 0.043875).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1052093
	speed: 0.0408s/iter; left time: 391.1987s
	iters: 200, epoch: 4 | loss: 0.0984978
	speed: 0.0103s/iter; left time: 97.3011s
	iters: 300, epoch: 4 | loss: 0.0969902
	speed: 0.0103s/iter; left time: 96.4378s
	iters: 400, epoch: 4 | loss: 0.2178531
	speed: 0.0103s/iter; left time: 95.6045s
	iters: 500, epoch: 4 | loss: 0.0968025
	speed: 0.0103s/iter; left time: 94.4927s
Epoch: 4 cost time: 6.245820045471191
Epoch: 4, Steps: 570 | Train Loss: 0.1066322 Vali Loss: 0.0416963 Test Loss: 0.1453095
Validation loss decreased (0.043875 --> 0.041696).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0862623
	speed: 0.0366s/iter; left time: 330.5699s
	iters: 200, epoch: 5 | loss: 0.1055892
	speed: 0.0103s/iter; left time: 91.9980s
	iters: 300, epoch: 5 | loss: 0.0991225
	speed: 0.0103s/iter; left time: 91.0450s
	iters: 400, epoch: 5 | loss: 0.0442018
	speed: 0.0104s/iter; left time: 90.2960s
	iters: 500, epoch: 5 | loss: 0.1016406
	speed: 0.0103s/iter; left time: 89.0795s
Epoch: 5 cost time: 6.17037296295166
Epoch: 5, Steps: 570 | Train Loss: 0.0827485 Vali Loss: 0.0393396 Test Loss: 0.1400730
Validation loss decreased (0.041696 --> 0.039340).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0824829
	speed: 0.0357s/iter; left time: 301.5256s
	iters: 200, epoch: 6 | loss: 0.0708365
	speed: 0.0102s/iter; left time: 85.5963s
	iters: 300, epoch: 6 | loss: 0.0642158
	speed: 0.0103s/iter; left time: 84.5953s
	iters: 400, epoch: 6 | loss: 0.0609981
	speed: 0.0102s/iter; left time: 83.5329s
	iters: 500, epoch: 6 | loss: 0.0641460
	speed: 0.0102s/iter; left time: 82.4689s
Epoch: 6 cost time: 6.144681692123413
Epoch: 6, Steps: 570 | Train Loss: 0.0693344 Vali Loss: 0.0402456 Test Loss: 0.1442885
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0474491
	speed: 0.0368s/iter; left time: 290.1114s
	iters: 200, epoch: 7 | loss: 0.0591522
	speed: 0.0114s/iter; left time: 88.5857s
	iters: 300, epoch: 7 | loss: 0.0474236
	speed: 0.0114s/iter; left time: 87.4241s
	iters: 400, epoch: 7 | loss: 0.0914606
	speed: 0.0114s/iter; left time: 86.3124s
	iters: 500, epoch: 7 | loss: 0.0444082
	speed: 0.0114s/iter; left time: 85.0388s
Epoch: 7 cost time: 6.790791988372803
Epoch: 7, Steps: 570 | Train Loss: 0.0618761 Vali Loss: 0.0411636 Test Loss: 0.1459919
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0533223
	speed: 0.0377s/iter; left time: 275.5552s
	iters: 200, epoch: 8 | loss: 0.0796355
	speed: 0.0114s/iter; left time: 81.9352s
	iters: 300, epoch: 8 | loss: 0.0630370
	speed: 0.0113s/iter; left time: 80.1600s
	iters: 400, epoch: 8 | loss: 0.0719336
	speed: 0.0112s/iter; left time: 78.2154s
	iters: 500, epoch: 8 | loss: 0.0561244
	speed: 0.0102s/iter; left time: 70.8252s
Epoch: 8 cost time: 6.540243625640869
Epoch: 8, Steps: 570 | Train Loss: 0.0578916 Vali Loss: 0.0411308 Test Loss: 0.1462468
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1402348130941391, mae:0.24120444059371948
>>> MS_Pen LR=5e-4 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1578362
	speed: 0.0256s/iter; left time: 288.9528s
	iters: 200, epoch: 1 | loss: 0.1289520
	speed: 0.0137s/iter; left time: 153.5774s
	iters: 300, epoch: 1 | loss: 0.2656170
	speed: 0.0137s/iter; left time: 151.9670s
	iters: 400, epoch: 1 | loss: 0.1233052
	speed: 0.0138s/iter; left time: 151.6366s
	iters: 500, epoch: 1 | loss: 0.1309156
	speed: 0.0138s/iter; left time: 150.1314s
Epoch: 1 cost time: 9.0702645778656
Epoch: 1, Steps: 570 | Train Loss: 0.1837774 Vali Loss: 0.0434109 Test Loss: 0.1350034
Validation loss decreased (inf --> 0.043411).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1369315
	speed: 0.0463s/iter; left time: 497.1782s
	iters: 200, epoch: 2 | loss: 0.1394715
	speed: 0.0154s/iter; left time: 164.0619s
	iters: 300, epoch: 2 | loss: 0.1070445
	speed: 0.0144s/iter; left time: 151.3922s
	iters: 400, epoch: 2 | loss: 0.1061904
	speed: 0.0138s/iter; left time: 143.6474s
	iters: 500, epoch: 2 | loss: 0.1784884
	speed: 0.0137s/iter; left time: 142.0093s
Epoch: 2 cost time: 8.526045322418213
Epoch: 2, Steps: 570 | Train Loss: 0.1300051 Vali Loss: 0.0442297 Test Loss: 0.1449541
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1538069
	speed: 0.0439s/iter; left time: 445.9659s
	iters: 200, epoch: 3 | loss: 0.0803680
	speed: 0.0137s/iter; left time: 137.3938s
	iters: 300, epoch: 3 | loss: 0.0611468
	speed: 0.0136s/iter; left time: 135.9512s
	iters: 400, epoch: 3 | loss: 0.0539834
	speed: 0.0136s/iter; left time: 134.5090s
	iters: 500, epoch: 3 | loss: 0.0681444
	speed: 0.0136s/iter; left time: 133.2070s
Epoch: 3 cost time: 8.042621612548828
Epoch: 3, Steps: 570 | Train Loss: 0.0830555 Vali Loss: 0.0430136 Test Loss: 0.1616562
Validation loss decreased (0.043411 --> 0.043014).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0451279
	speed: 0.0458s/iter; left time: 439.1519s
	iters: 200, epoch: 4 | loss: 0.0444027
	speed: 0.0137s/iter; left time: 129.8392s
	iters: 300, epoch: 4 | loss: 0.0725657
	speed: 0.0137s/iter; left time: 128.6851s
	iters: 400, epoch: 4 | loss: 0.0645153
	speed: 0.0137s/iter; left time: 127.4211s
	iters: 500, epoch: 4 | loss: 0.0383609
	speed: 0.0136s/iter; left time: 125.3054s
Epoch: 4 cost time: 8.057918310165405
Epoch: 4, Steps: 570 | Train Loss: 0.0549395 Vali Loss: 0.0388707 Test Loss: 0.1387546
Validation loss decreased (0.043014 --> 0.038871).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0540210
	speed: 0.0472s/iter; left time: 425.5608s
	iters: 200, epoch: 5 | loss: 0.0368198
	speed: 0.0140s/iter; left time: 124.5260s
	iters: 300, epoch: 5 | loss: 0.0457855
	speed: 0.0138s/iter; left time: 122.1680s
	iters: 400, epoch: 5 | loss: 0.0368374
	speed: 0.0138s/iter; left time: 120.0979s
	iters: 500, epoch: 5 | loss: 0.0370026
	speed: 0.0138s/iter; left time: 118.5592s
Epoch: 5 cost time: 8.326078176498413
Epoch: 5, Steps: 570 | Train Loss: 0.0404896 Vali Loss: 0.0409471 Test Loss: 0.1412022
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0381618
	speed: 0.0438s/iter; left time: 370.0934s
	iters: 200, epoch: 6 | loss: 0.0550946
	speed: 0.0138s/iter; left time: 114.9070s
	iters: 300, epoch: 6 | loss: 0.0295509
	speed: 0.0137s/iter; left time: 113.3404s
	iters: 400, epoch: 6 | loss: 0.0334605
	speed: 0.0137s/iter; left time: 111.7418s
	iters: 500, epoch: 6 | loss: 0.0281086
	speed: 0.0137s/iter; left time: 110.1928s
Epoch: 6 cost time: 8.095348119735718
Epoch: 6, Steps: 570 | Train Loss: 0.0335780 Vali Loss: 0.0410329 Test Loss: 0.1425936
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0288295
	speed: 0.0457s/iter; left time: 359.8273s
	iters: 200, epoch: 7 | loss: 0.0309771
	speed: 0.0137s/iter; left time: 106.8002s
	iters: 300, epoch: 7 | loss: 0.0274241
	speed: 0.0137s/iter; left time: 105.4909s
	iters: 400, epoch: 7 | loss: 0.0287206
	speed: 0.0137s/iter; left time: 104.1415s
	iters: 500, epoch: 7 | loss: 0.0301278
	speed: 0.0137s/iter; left time: 102.3968s
Epoch: 7 cost time: 8.184329509735107
Epoch: 7, Steps: 570 | Train Loss: 0.0301353 Vali Loss: 0.0413954 Test Loss: 0.1414367
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1388753056526184, mae:0.23707732558250427
>>> MS_Pen LR=5e-4 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2321097
	speed: 0.0252s/iter; left time: 284.6949s
	iters: 200, epoch: 1 | loss: 0.1157365
	speed: 0.0135s/iter; left time: 151.5397s
	iters: 300, epoch: 1 | loss: 0.1037099
	speed: 0.0135s/iter; left time: 149.9052s
	iters: 400, epoch: 1 | loss: 0.1687892
	speed: 0.0135s/iter; left time: 148.7555s
	iters: 500, epoch: 1 | loss: 0.1414548
	speed: 0.0135s/iter; left time: 147.1882s
Epoch: 1 cost time: 8.922576427459717
Epoch: 1, Steps: 570 | Train Loss: 0.1566462 Vali Loss: 0.0408434 Test Loss: 0.1273687
Validation loss decreased (inf --> 0.040843).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0836369
	speed: 0.0458s/iter; left time: 491.4063s
	iters: 200, epoch: 2 | loss: 0.1748103
	speed: 0.0150s/iter; left time: 159.8823s
	iters: 300, epoch: 2 | loss: 0.1266452
	speed: 0.0151s/iter; left time: 158.6735s
	iters: 400, epoch: 2 | loss: 0.1082136
	speed: 0.0151s/iter; left time: 157.2247s
	iters: 500, epoch: 2 | loss: 0.1084082
	speed: 0.0148s/iter; left time: 152.8305s
Epoch: 2 cost time: 8.758671045303345
Epoch: 2, Steps: 570 | Train Loss: 0.1209939 Vali Loss: 0.0398005 Test Loss: 0.1273924
Validation loss decreased (0.040843 --> 0.039800).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0902429
	speed: 0.0442s/iter; left time: 449.4989s
	iters: 200, epoch: 3 | loss: 0.0493391
	speed: 0.0134s/iter; left time: 134.5156s
	iters: 300, epoch: 3 | loss: 0.0904723
	speed: 0.0134s/iter; left time: 133.2632s
	iters: 400, epoch: 3 | loss: 0.0663910
	speed: 0.0134s/iter; left time: 131.9799s
	iters: 500, epoch: 3 | loss: 0.0516019
	speed: 0.0134s/iter; left time: 130.4504s
Epoch: 3 cost time: 7.930225849151611
Epoch: 3, Steps: 570 | Train Loss: 0.0810672 Vali Loss: 0.0355138 Test Loss: 0.1307001
Validation loss decreased (0.039800 --> 0.035514).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0344577
	speed: 0.0439s/iter; left time: 420.7546s
	iters: 200, epoch: 4 | loss: 0.0624754
	speed: 0.0134s/iter; left time: 127.2729s
	iters: 300, epoch: 4 | loss: 0.0724624
	speed: 0.0134s/iter; left time: 125.8834s
	iters: 400, epoch: 4 | loss: 0.0454833
	speed: 0.0134s/iter; left time: 124.5342s
	iters: 500, epoch: 4 | loss: 0.0409478
	speed: 0.0134s/iter; left time: 123.1250s
Epoch: 4 cost time: 7.930099725723267
Epoch: 4, Steps: 570 | Train Loss: 0.0550598 Vali Loss: 0.0351253 Test Loss: 0.1327536
Validation loss decreased (0.035514 --> 0.035125).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0357585
	speed: 0.0462s/iter; left time: 416.5424s
	iters: 200, epoch: 5 | loss: 0.0410368
	speed: 0.0135s/iter; left time: 120.0001s
	iters: 300, epoch: 5 | loss: 0.0362511
	speed: 0.0135s/iter; left time: 118.7685s
	iters: 400, epoch: 5 | loss: 0.0282203
	speed: 0.0135s/iter; left time: 117.3962s
	iters: 500, epoch: 5 | loss: 0.0479506
	speed: 0.0135s/iter; left time: 116.0336s
Epoch: 5 cost time: 7.973097085952759
Epoch: 5, Steps: 570 | Train Loss: 0.0403530 Vali Loss: 0.0350215 Test Loss: 0.1340194
Validation loss decreased (0.035125 --> 0.035021).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0331738
	speed: 0.0455s/iter; left time: 384.3674s
	iters: 200, epoch: 6 | loss: 0.0423843
	speed: 0.0134s/iter; left time: 111.9857s
	iters: 300, epoch: 6 | loss: 0.0367952
	speed: 0.0134s/iter; left time: 110.6848s
	iters: 400, epoch: 6 | loss: 0.0472632
	speed: 0.0134s/iter; left time: 109.2684s
	iters: 500, epoch: 6 | loss: 0.0319536
	speed: 0.0134s/iter; left time: 107.9264s
Epoch: 6 cost time: 7.919373512268066
Epoch: 6, Steps: 570 | Train Loss: 0.0333034 Vali Loss: 0.0353128 Test Loss: 0.1383440
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0249179
	speed: 0.0436s/iter; left time: 343.4416s
	iters: 200, epoch: 7 | loss: 0.0275852
	speed: 0.0134s/iter; left time: 104.1525s
	iters: 300, epoch: 7 | loss: 0.0268007
	speed: 0.0134s/iter; left time: 102.8912s
	iters: 400, epoch: 7 | loss: 0.0470495
	speed: 0.0134s/iter; left time: 101.4932s
	iters: 500, epoch: 7 | loss: 0.0343288
	speed: 0.0134s/iter; left time: 100.0985s
Epoch: 7 cost time: 7.916487216949463
Epoch: 7, Steps: 570 | Train Loss: 0.0299546 Vali Loss: 0.0359537 Test Loss: 0.1404588
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0275000
	speed: 0.0447s/iter; left time: 326.9586s
	iters: 200, epoch: 8 | loss: 0.0229065
	speed: 0.0151s/iter; left time: 108.6754s
	iters: 300, epoch: 8 | loss: 0.0295994
	speed: 0.0143s/iter; left time: 101.8446s
	iters: 400, epoch: 8 | loss: 0.0282511
	speed: 0.0134s/iter; left time: 94.1276s
	iters: 500, epoch: 8 | loss: 0.0229039
	speed: 0.0134s/iter; left time: 92.7525s
Epoch: 8 cost time: 8.339668035507202
Epoch: 8, Steps: 570 | Train Loss: 0.0282429 Vali Loss: 0.0363711 Test Loss: 0.1414014
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13409674167633057, mae:0.2243374139070511
>>> MS_Pen LR=5e-4 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1080340
	speed: 0.0251s/iter; left time: 284.1773s
	iters: 200, epoch: 1 | loss: 0.2859254
	speed: 0.0142s/iter; left time: 158.9209s
	iters: 300, epoch: 1 | loss: 0.2589468
	speed: 0.0135s/iter; left time: 149.6705s
	iters: 400, epoch: 1 | loss: 0.1871030
	speed: 0.0135s/iter; left time: 148.3737s
	iters: 500, epoch: 1 | loss: 0.2180350
	speed: 0.0135s/iter; left time: 147.1173s
Epoch: 1 cost time: 8.97885251045227
Epoch: 1, Steps: 570 | Train Loss: 0.1921938 Vali Loss: 0.0460822 Test Loss: 0.1373031
Validation loss decreased (inf --> 0.046082).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1186255
	speed: 0.0466s/iter; left time: 499.8762s
	iters: 200, epoch: 2 | loss: 0.1221818
	speed: 0.0144s/iter; left time: 153.2951s
	iters: 300, epoch: 2 | loss: 0.0899891
	speed: 0.0136s/iter; left time: 142.9086s
	iters: 400, epoch: 2 | loss: 0.0922930
	speed: 0.0135s/iter; left time: 141.0610s
	iters: 500, epoch: 2 | loss: 0.1567103
	speed: 0.0135s/iter; left time: 139.4576s
Epoch: 2 cost time: 8.25602412223816
Epoch: 2, Steps: 570 | Train Loss: 0.1333438 Vali Loss: 0.0426168 Test Loss: 0.1401526
Validation loss decreased (0.046082 --> 0.042617).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0913011
	speed: 0.0460s/iter; left time: 466.9129s
	iters: 200, epoch: 3 | loss: 0.1199827
	speed: 0.0136s/iter; left time: 136.8465s
	iters: 300, epoch: 3 | loss: 0.0697879
	speed: 0.0136s/iter; left time: 135.2403s
	iters: 400, epoch: 3 | loss: 0.0697273
	speed: 0.0135s/iter; left time: 133.4502s
	iters: 500, epoch: 3 | loss: 0.0684704
	speed: 0.0135s/iter; left time: 132.0682s
Epoch: 3 cost time: 8.010271787643433
Epoch: 3, Steps: 570 | Train Loss: 0.0790802 Vali Loss: 0.0427800 Test Loss: 0.1419995
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0419889
	speed: 0.0433s/iter; left time: 415.2994s
	iters: 200, epoch: 4 | loss: 0.0375734
	speed: 0.0134s/iter; left time: 127.4089s
	iters: 300, epoch: 4 | loss: 0.0455835
	speed: 0.0134s/iter; left time: 126.2965s
	iters: 400, epoch: 4 | loss: 0.0484453
	speed: 0.0134s/iter; left time: 124.8119s
	iters: 500, epoch: 4 | loss: 0.0347002
	speed: 0.0134s/iter; left time: 123.1929s
Epoch: 4 cost time: 7.92918586730957
Epoch: 4, Steps: 570 | Train Loss: 0.0462335 Vali Loss: 0.0416918 Test Loss: 0.1441520
Validation loss decreased (0.042617 --> 0.041692).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0465301
	speed: 0.0461s/iter; left time: 415.5502s
	iters: 200, epoch: 5 | loss: 0.0510239
	speed: 0.0149s/iter; left time: 132.5682s
	iters: 300, epoch: 5 | loss: 0.0320916
	speed: 0.0134s/iter; left time: 118.3170s
	iters: 400, epoch: 5 | loss: 0.0499266
	speed: 0.0150s/iter; left time: 130.4318s
	iters: 500, epoch: 5 | loss: 0.0266723
	speed: 0.0151s/iter; left time: 129.9394s
Epoch: 5 cost time: 8.690927267074585
Epoch: 5, Steps: 570 | Train Loss: 0.0327692 Vali Loss: 0.0421148 Test Loss: 0.1472104
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0235237
	speed: 0.0443s/iter; left time: 374.3487s
	iters: 200, epoch: 6 | loss: 0.0261442
	speed: 0.0135s/iter; left time: 112.7587s
	iters: 300, epoch: 6 | loss: 0.0196315
	speed: 0.0135s/iter; left time: 111.3859s
	iters: 400, epoch: 6 | loss: 0.0426821
	speed: 0.0135s/iter; left time: 110.1208s
	iters: 500, epoch: 6 | loss: 0.0257109
	speed: 0.0135s/iter; left time: 108.6803s
Epoch: 6 cost time: 7.966610670089722
Epoch: 6, Steps: 570 | Train Loss: 0.0270066 Vali Loss: 0.0420603 Test Loss: 0.1499446
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0264186
	speed: 0.0440s/iter; left time: 347.1156s
	iters: 200, epoch: 7 | loss: 0.0214623
	speed: 0.0134s/iter; left time: 104.3373s
	iters: 300, epoch: 7 | loss: 0.0157460
	speed: 0.0134s/iter; left time: 103.0398s
	iters: 400, epoch: 7 | loss: 0.0284765
	speed: 0.0134s/iter; left time: 101.6857s
	iters: 500, epoch: 7 | loss: 0.0211088
	speed: 0.0135s/iter; left time: 101.0463s
Epoch: 7 cost time: 7.912746429443359
Epoch: 7, Steps: 570 | Train Loss: 0.0242912 Vali Loss: 0.0433619 Test Loss: 0.1509877
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14426828920841217, mae:0.24323821067810059
>>> MS_Pen LR=5e-4 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1964941
	speed: 0.0288s/iter; left time: 325.0418s
	iters: 200, epoch: 1 | loss: 0.1605188
	speed: 0.0163s/iter; left time: 182.7063s
	iters: 300, epoch: 1 | loss: 0.2042286
	speed: 0.0163s/iter; left time: 180.9250s
	iters: 400, epoch: 1 | loss: 0.1916119
	speed: 0.0163s/iter; left time: 179.1294s
	iters: 500, epoch: 1 | loss: 0.1164993
	speed: 0.0163s/iter; left time: 177.9861s
Epoch: 1 cost time: 10.59121584892273
Epoch: 1, Steps: 570 | Train Loss: 0.2058174 Vali Loss: 0.0495508 Test Loss: 0.1595942
Validation loss decreased (inf --> 0.049551).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2021853
	speed: 0.0497s/iter; left time: 533.4360s
	iters: 200, epoch: 2 | loss: 0.1950355
	speed: 0.0163s/iter; left time: 173.0916s
	iters: 300, epoch: 2 | loss: 0.2041556
	speed: 0.0163s/iter; left time: 171.5409s
	iters: 400, epoch: 2 | loss: 0.1723527
	speed: 0.0163s/iter; left time: 169.7726s
	iters: 500, epoch: 2 | loss: 0.1946950
	speed: 0.0163s/iter; left time: 168.4445s
Epoch: 2 cost time: 9.608856916427612
Epoch: 2, Steps: 570 | Train Loss: 0.1919631 Vali Loss: 0.0517373 Test Loss: 0.1582644
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1943865
	speed: 0.0490s/iter; left time: 497.5711s
	iters: 200, epoch: 3 | loss: 0.1713437
	speed: 0.0163s/iter; left time: 163.8422s
	iters: 300, epoch: 3 | loss: 0.3141883
	speed: 0.0163s/iter; left time: 162.2366s
	iters: 400, epoch: 3 | loss: 0.1318318
	speed: 0.0163s/iter; left time: 160.6938s
	iters: 500, epoch: 3 | loss: 0.1171362
	speed: 0.0163s/iter; left time: 158.6975s
Epoch: 3 cost time: 9.55716323852539
Epoch: 3, Steps: 570 | Train Loss: 0.1736190 Vali Loss: 0.0468029 Test Loss: 0.1479750
Validation loss decreased (0.049551 --> 0.046803).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1214465
	speed: 0.0504s/iter; left time: 483.7755s
	iters: 200, epoch: 4 | loss: 0.1093698
	speed: 0.0163s/iter; left time: 154.4699s
	iters: 300, epoch: 4 | loss: 0.1125674
	speed: 0.0163s/iter; left time: 152.7092s
	iters: 400, epoch: 4 | loss: 0.1226619
	speed: 0.0163s/iter; left time: 151.2351s
	iters: 500, epoch: 4 | loss: 0.1652830
	speed: 0.0163s/iter; left time: 149.7136s
Epoch: 4 cost time: 9.571431159973145
Epoch: 4, Steps: 570 | Train Loss: 0.1411742 Vali Loss: 0.0465570 Test Loss: 0.1457626
Validation loss decreased (0.046803 --> 0.046557).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0859538
	speed: 0.0493s/iter; left time: 444.6791s
	iters: 200, epoch: 5 | loss: 0.1401871
	speed: 0.0162s/iter; left time: 144.6532s
	iters: 300, epoch: 5 | loss: 0.0972988
	speed: 0.0162s/iter; left time: 143.1939s
	iters: 400, epoch: 5 | loss: 0.1523543
	speed: 0.0162s/iter; left time: 141.4372s
	iters: 500, epoch: 5 | loss: 0.0832699
	speed: 0.0162s/iter; left time: 140.0804s
Epoch: 5 cost time: 9.55648398399353
Epoch: 5, Steps: 570 | Train Loss: 0.1206995 Vali Loss: 0.0424277 Test Loss: 0.1396010
Validation loss decreased (0.046557 --> 0.042428).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1247516
	speed: 0.0498s/iter; left time: 421.2064s
	iters: 200, epoch: 6 | loss: 0.0835743
	speed: 0.0162s/iter; left time: 135.4479s
	iters: 300, epoch: 6 | loss: 0.1118206
	speed: 0.0162s/iter; left time: 133.8065s
	iters: 400, epoch: 6 | loss: 0.1269368
	speed: 0.0162s/iter; left time: 132.3129s
	iters: 500, epoch: 6 | loss: 0.0977479
	speed: 0.0163s/iter; left time: 131.4111s
Epoch: 6 cost time: 9.582356929779053
Epoch: 6, Steps: 570 | Train Loss: 0.1085740 Vali Loss: 0.0416332 Test Loss: 0.1399844
Validation loss decreased (0.042428 --> 0.041633).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1093714
	speed: 0.0500s/iter; left time: 394.0696s
	iters: 200, epoch: 7 | loss: 0.1402529
	speed: 0.0163s/iter; left time: 126.7396s
	iters: 300, epoch: 7 | loss: 0.1121155
	speed: 0.0163s/iter; left time: 125.1431s
	iters: 400, epoch: 7 | loss: 0.0923678
	speed: 0.0163s/iter; left time: 123.6054s
	iters: 500, epoch: 7 | loss: 0.0646178
	speed: 0.0163s/iter; left time: 121.7977s
Epoch: 7 cost time: 9.593020915985107
Epoch: 7, Steps: 570 | Train Loss: 0.1014402 Vali Loss: 0.0412199 Test Loss: 0.1412705
Validation loss decreased (0.041633 --> 0.041220).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0864961
	speed: 0.0504s/iter; left time: 368.6982s
	iters: 200, epoch: 8 | loss: 0.0825486
	speed: 0.0164s/iter; left time: 118.3508s
	iters: 300, epoch: 8 | loss: 0.1386834
	speed: 0.0164s/iter; left time: 116.3880s
	iters: 400, epoch: 8 | loss: 0.0622264
	speed: 0.0164s/iter; left time: 114.6629s
	iters: 500, epoch: 8 | loss: 0.1029423
	speed: 0.0164s/iter; left time: 113.0933s
Epoch: 8 cost time: 9.642975091934204
Epoch: 8, Steps: 570 | Train Loss: 0.0976369 Vali Loss: 0.0410506 Test Loss: 0.1411332
Validation loss decreased (0.041220 --> 0.041051).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0967142
	speed: 0.0519s/iter; left time: 349.6738s
	iters: 200, epoch: 9 | loss: 0.0930075
	speed: 0.0163s/iter; left time: 108.0967s
	iters: 300, epoch: 9 | loss: 0.1030054
	speed: 0.0163s/iter; left time: 106.4327s
	iters: 400, epoch: 9 | loss: 0.1332914
	speed: 0.0163s/iter; left time: 104.6904s
	iters: 500, epoch: 9 | loss: 0.1279310
	speed: 0.0163s/iter; left time: 103.1302s
Epoch: 9 cost time: 9.559890747070312
Epoch: 9, Steps: 570 | Train Loss: 0.0952809 Vali Loss: 0.0409226 Test Loss: 0.1423697
Validation loss decreased (0.041051 --> 0.040923).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0996228
	speed: 0.0497s/iter; left time: 307.0064s
	iters: 200, epoch: 10 | loss: 0.0703641
	speed: 0.0163s/iter; left time: 98.6962s
	iters: 300, epoch: 10 | loss: 0.0728533
	speed: 0.0162s/iter; left time: 96.8649s
	iters: 400, epoch: 10 | loss: 0.1089483
	speed: 0.0162s/iter; left time: 95.1905s
	iters: 500, epoch: 10 | loss: 0.0928170
	speed: 0.0162s/iter; left time: 93.7296s
Epoch: 10 cost time: 9.56289792060852
Epoch: 10, Steps: 570 | Train Loss: 0.0940941 Vali Loss: 0.0410012 Test Loss: 0.1424332
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0677674
	speed: 0.0489s/iter; left time: 273.7302s
	iters: 200, epoch: 11 | loss: 0.1027185
	speed: 0.0163s/iter; left time: 89.4738s
	iters: 300, epoch: 11 | loss: 0.0687106
	speed: 0.0163s/iter; left time: 87.8279s
	iters: 400, epoch: 11 | loss: 0.1289993
	speed: 0.0163s/iter; left time: 86.2301s
	iters: 500, epoch: 11 | loss: 0.1447545
	speed: 0.0163s/iter; left time: 84.5473s
Epoch: 11 cost time: 9.565649032592773
Epoch: 11, Steps: 570 | Train Loss: 0.0934823 Vali Loss: 0.0409046 Test Loss: 0.1423106
Validation loss decreased (0.040923 --> 0.040905).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1031807
	speed: 0.0499s/iter; left time: 250.9663s
	iters: 200, epoch: 12 | loss: 0.0909289
	speed: 0.0163s/iter; left time: 80.5883s
	iters: 300, epoch: 12 | loss: 0.0786132
	speed: 0.0163s/iter; left time: 78.9142s
	iters: 400, epoch: 12 | loss: 0.1137376
	speed: 0.0163s/iter; left time: 77.2045s
	iters: 500, epoch: 12 | loss: 0.0986403
	speed: 0.0164s/iter; left time: 75.7559s
Epoch: 12 cost time: 9.608912467956543
Epoch: 12, Steps: 570 | Train Loss: 0.0930950 Vali Loss: 0.0408884 Test Loss: 0.1424652
Validation loss decreased (0.040905 --> 0.040888).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1033700
	speed: 0.0524s/iter; left time: 233.7056s
	iters: 200, epoch: 13 | loss: 0.1391255
	speed: 0.0163s/iter; left time: 71.2269s
	iters: 300, epoch: 13 | loss: 0.0895902
	speed: 0.0163s/iter; left time: 69.6322s
	iters: 400, epoch: 13 | loss: 0.0850097
	speed: 0.0163s/iter; left time: 67.9259s
	iters: 500, epoch: 13 | loss: 0.0706151
	speed: 0.0164s/iter; left time: 66.4003s
Epoch: 13 cost time: 9.625509262084961
Epoch: 13, Steps: 570 | Train Loss: 0.0929845 Vali Loss: 0.0409349 Test Loss: 0.1426480
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.0892936
	speed: 0.0495s/iter; left time: 192.7679s
	iters: 200, epoch: 14 | loss: 0.0947507
	speed: 0.0163s/iter; left time: 61.8621s
	iters: 300, epoch: 14 | loss: 0.1226220
	speed: 0.0163s/iter; left time: 60.3047s
	iters: 400, epoch: 14 | loss: 0.0803918
	speed: 0.0163s/iter; left time: 58.5195s
	iters: 500, epoch: 14 | loss: 0.0873356
	speed: 0.0163s/iter; left time: 56.8372s
Epoch: 14 cost time: 9.554410219192505
Epoch: 14, Steps: 570 | Train Loss: 0.0928869 Vali Loss: 0.0410983 Test Loss: 0.1426810
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.0840338
	speed: 0.0488s/iter; left time: 162.1793s
	iters: 200, epoch: 15 | loss: 0.0937262
	speed: 0.0163s/iter; left time: 52.4488s
	iters: 300, epoch: 15 | loss: 0.1169392
	speed: 0.0163s/iter; left time: 50.8051s
	iters: 400, epoch: 15 | loss: 0.0956741
	speed: 0.0163s/iter; left time: 49.1256s
	iters: 500, epoch: 15 | loss: 0.0956151
	speed: 0.0163s/iter; left time: 47.4895s
Epoch: 15 cost time: 9.561268091201782
Epoch: 15, Steps: 570 | Train Loss: 0.0928297 Vali Loss: 0.0409664 Test Loss: 0.1426875
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1426417976617813, mae:0.24011923372745514
>>> MS_Pen LR=5e-4 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2091267
	speed: 0.0277s/iter; left time: 313.1287s
	iters: 200, epoch: 1 | loss: 0.0895570
	speed: 0.0159s/iter; left time: 177.8578s
	iters: 300, epoch: 1 | loss: 0.1919908
	speed: 0.0159s/iter; left time: 176.0213s
	iters: 400, epoch: 1 | loss: 0.1074518
	speed: 0.0159s/iter; left time: 174.6021s
	iters: 500, epoch: 1 | loss: 0.0945984
	speed: 0.0159s/iter; left time: 173.5714s
Epoch: 1 cost time: 10.287144422531128
Epoch: 1, Steps: 570 | Train Loss: 0.1837413 Vali Loss: 0.0497935 Test Loss: 0.1511875
Validation loss decreased (inf --> 0.049793).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1532350
	speed: 0.0520s/iter; left time: 557.8577s
	iters: 200, epoch: 2 | loss: 0.1595316
	speed: 0.0158s/iter; left time: 168.2226s
	iters: 300, epoch: 2 | loss: 0.2039528
	speed: 0.0169s/iter; left time: 178.0182s
	iters: 400, epoch: 2 | loss: 0.3546842
	speed: 0.0172s/iter; left time: 179.7780s
	iters: 500, epoch: 2 | loss: 0.2870416
	speed: 0.0162s/iter; left time: 167.2228s
Epoch: 2 cost time: 9.673748970031738
Epoch: 2, Steps: 570 | Train Loss: 0.2096404 Vali Loss: 0.0620743 Test Loss: 0.1859356
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2341646
	speed: 0.0486s/iter; left time: 493.9946s
	iters: 200, epoch: 3 | loss: 0.2446437
	speed: 0.0158s/iter; left time: 159.0070s
	iters: 300, epoch: 3 | loss: 0.1751114
	speed: 0.0158s/iter; left time: 157.4019s
	iters: 400, epoch: 3 | loss: 0.2079699
	speed: 0.0158s/iter; left time: 155.7604s
	iters: 500, epoch: 3 | loss: 0.1227611
	speed: 0.0158s/iter; left time: 154.2970s
Epoch: 3 cost time: 9.295809984207153
Epoch: 3, Steps: 570 | Train Loss: 0.1992026 Vali Loss: 0.0519196 Test Loss: 0.1659275
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1468963
	speed: 0.0490s/iter; left time: 470.0068s
	iters: 200, epoch: 4 | loss: 0.2180204
	speed: 0.0158s/iter; left time: 149.8518s
	iters: 300, epoch: 4 | loss: 0.1063861
	speed: 0.0158s/iter; left time: 148.7090s
	iters: 400, epoch: 4 | loss: 0.0912014
	speed: 0.0158s/iter; left time: 146.7362s
	iters: 500, epoch: 4 | loss: 0.1777659
	speed: 0.0158s/iter; left time: 145.1317s
Epoch: 4 cost time: 9.409376859664917
Epoch: 4, Steps: 570 | Train Loss: 0.1497295 Vali Loss: 0.0464907 Test Loss: 0.1439078
Validation loss decreased (0.049793 --> 0.046491).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1322723
	speed: 0.0495s/iter; left time: 446.8496s
	iters: 200, epoch: 5 | loss: 0.1907931
	speed: 0.0158s/iter; left time: 141.0475s
	iters: 300, epoch: 5 | loss: 0.1333173
	speed: 0.0158s/iter; left time: 139.4370s
	iters: 400, epoch: 5 | loss: 0.1083180
	speed: 0.0158s/iter; left time: 137.8918s
	iters: 500, epoch: 5 | loss: 0.1380687
	speed: 0.0158s/iter; left time: 136.2738s
Epoch: 5 cost time: 9.36605954170227
Epoch: 5, Steps: 570 | Train Loss: 0.1328602 Vali Loss: 0.0426537 Test Loss: 0.1363908
Validation loss decreased (0.046491 --> 0.042654).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1640620
	speed: 0.0513s/iter; left time: 433.6723s
	iters: 200, epoch: 6 | loss: 0.1240330
	speed: 0.0158s/iter; left time: 132.0291s
	iters: 300, epoch: 6 | loss: 0.1734248
	speed: 0.0158s/iter; left time: 130.5122s
	iters: 400, epoch: 6 | loss: 0.1307983
	speed: 0.0159s/iter; left time: 129.3575s
	iters: 500, epoch: 6 | loss: 0.1197621
	speed: 0.0159s/iter; left time: 127.7743s
Epoch: 6 cost time: 9.357929229736328
Epoch: 6, Steps: 570 | Train Loss: 0.1232547 Vali Loss: 0.0413468 Test Loss: 0.1351649
Validation loss decreased (0.042654 --> 0.041347).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1551580
	speed: 0.0497s/iter; left time: 391.7730s
	iters: 200, epoch: 7 | loss: 0.0842369
	speed: 0.0173s/iter; left time: 134.6826s
	iters: 300, epoch: 7 | loss: 0.1078781
	speed: 0.0173s/iter; left time: 132.5479s
	iters: 400, epoch: 7 | loss: 0.1163753
	speed: 0.0172s/iter; left time: 130.6662s
	iters: 500, epoch: 7 | loss: 0.1280681
	speed: 0.0172s/iter; left time: 128.8762s
Epoch: 7 cost time: 10.115323781967163
Epoch: 7, Steps: 570 | Train Loss: 0.1175454 Vali Loss: 0.0409733 Test Loss: 0.1361305
Validation loss decreased (0.041347 --> 0.040973).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0673299
	speed: 0.0527s/iter; left time: 384.9366s
	iters: 200, epoch: 8 | loss: 0.1896786
	speed: 0.0158s/iter; left time: 114.0433s
	iters: 300, epoch: 8 | loss: 0.1169873
	speed: 0.0158s/iter; left time: 112.6274s
	iters: 400, epoch: 8 | loss: 0.1546192
	speed: 0.0158s/iter; left time: 110.9186s
	iters: 500, epoch: 8 | loss: 0.1213248
	speed: 0.0158s/iter; left time: 109.2836s
Epoch: 8 cost time: 9.305094718933105
Epoch: 8, Steps: 570 | Train Loss: 0.1145312 Vali Loss: 0.0405667 Test Loss: 0.1351884
Validation loss decreased (0.040973 --> 0.040567).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0758739
	speed: 0.0484s/iter; left time: 326.2120s
	iters: 200, epoch: 9 | loss: 0.0844064
	speed: 0.0159s/iter; left time: 105.3899s
	iters: 300, epoch: 9 | loss: 0.0795203
	speed: 0.0159s/iter; left time: 103.8018s
	iters: 400, epoch: 9 | loss: 0.0697846
	speed: 0.0159s/iter; left time: 102.2024s
	iters: 500, epoch: 9 | loss: 0.0751502
	speed: 0.0159s/iter; left time: 100.6293s
Epoch: 9 cost time: 9.341699838638306
Epoch: 9, Steps: 570 | Train Loss: 0.1125866 Vali Loss: 0.0408013 Test Loss: 0.1373776
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1319004
	speed: 0.0487s/iter; left time: 300.6597s
	iters: 200, epoch: 10 | loss: 0.1307049
	speed: 0.0159s/iter; left time: 96.2841s
	iters: 300, epoch: 10 | loss: 0.0624284
	speed: 0.0159s/iter; left time: 94.6745s
	iters: 400, epoch: 10 | loss: 0.1027110
	speed: 0.0159s/iter; left time: 93.1177s
	iters: 500, epoch: 10 | loss: 0.1262836
	speed: 0.0159s/iter; left time: 91.5182s
Epoch: 10 cost time: 9.364205121994019
Epoch: 10, Steps: 570 | Train Loss: 0.1116882 Vali Loss: 0.0404550 Test Loss: 0.1357732
Validation loss decreased (0.040567 --> 0.040455).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0780299
	speed: 0.0494s/iter; left time: 276.8502s
	iters: 200, epoch: 11 | loss: 0.0906231
	speed: 0.0158s/iter; left time: 86.9090s
	iters: 300, epoch: 11 | loss: 0.0873221
	speed: 0.0158s/iter; left time: 85.3873s
	iters: 400, epoch: 11 | loss: 0.1305353
	speed: 0.0158s/iter; left time: 83.8091s
	iters: 500, epoch: 11 | loss: 0.1057168
	speed: 0.0158s/iter; left time: 82.2372s
Epoch: 11 cost time: 9.320724964141846
Epoch: 11, Steps: 570 | Train Loss: 0.1110504 Vali Loss: 0.0404501 Test Loss: 0.1355097
Validation loss decreased (0.040455 --> 0.040450).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1000475
	speed: 0.0497s/iter; left time: 250.2713s
	iters: 200, epoch: 12 | loss: 0.1099152
	speed: 0.0165s/iter; left time: 81.5160s
	iters: 300, epoch: 12 | loss: 0.0667748
	speed: 0.0158s/iter; left time: 76.4000s
	iters: 400, epoch: 12 | loss: 0.1194867
	speed: 0.0158s/iter; left time: 74.8573s
	iters: 500, epoch: 12 | loss: 0.1502271
	speed: 0.0158s/iter; left time: 73.2575s
Epoch: 12 cost time: 9.512454986572266
Epoch: 12, Steps: 570 | Train Loss: 0.1107924 Vali Loss: 0.0405066 Test Loss: 0.1357796
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1368764
	speed: 0.0477s/iter; left time: 212.8541s
	iters: 200, epoch: 13 | loss: 0.2218953
	speed: 0.0159s/iter; left time: 69.1243s
	iters: 300, epoch: 13 | loss: 0.1652798
	speed: 0.0158s/iter; left time: 67.4267s
	iters: 400, epoch: 13 | loss: 0.0762827
	speed: 0.0158s/iter; left time: 65.8365s
	iters: 500, epoch: 13 | loss: 0.1234728
	speed: 0.0158s/iter; left time: 64.2655s
Epoch: 13 cost time: 9.297348737716675
Epoch: 13, Steps: 570 | Train Loss: 0.1106390 Vali Loss: 0.0404439 Test Loss: 0.1355655
Validation loss decreased (0.040450 --> 0.040444).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.0993882
	speed: 0.0494s/iter; left time: 192.2641s
	iters: 200, epoch: 14 | loss: 0.1020162
	speed: 0.0158s/iter; left time: 59.8371s
	iters: 300, epoch: 14 | loss: 0.1887988
	speed: 0.0158s/iter; left time: 58.4025s
	iters: 400, epoch: 14 | loss: 0.1245337
	speed: 0.0158s/iter; left time: 56.7402s
	iters: 500, epoch: 14 | loss: 0.0835331
	speed: 0.0158s/iter; left time: 55.1220s
Epoch: 14 cost time: 9.296477556228638
Epoch: 14, Steps: 570 | Train Loss: 0.1106103 Vali Loss: 0.0404395 Test Loss: 0.1355990
Validation loss decreased (0.040444 --> 0.040439).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.0882944
	speed: 0.0497s/iter; left time: 165.1213s
	iters: 200, epoch: 15 | loss: 0.1214584
	speed: 0.0172s/iter; left time: 55.5613s
	iters: 300, epoch: 15 | loss: 0.0868567
	speed: 0.0173s/iter; left time: 53.9271s
	iters: 400, epoch: 15 | loss: 0.0917521
	speed: 0.0172s/iter; left time: 52.1045s
	iters: 500, epoch: 15 | loss: 0.1732763
	speed: 0.0172s/iter; left time: 50.3841s
Epoch: 15 cost time: 10.07995057106018
Epoch: 15, Steps: 570 | Train Loss: 0.1104769 Vali Loss: 0.0403034 Test Loss: 0.1355987
Validation loss decreased (0.040439 --> 0.040303).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1211360
	speed: 0.0521s/iter; left time: 143.2402s
	iters: 200, epoch: 16 | loss: 0.1303284
	speed: 0.0159s/iter; left time: 42.1478s
	iters: 300, epoch: 16 | loss: 0.1572953
	speed: 0.0159s/iter; left time: 40.5442s
	iters: 400, epoch: 16 | loss: 0.1538701
	speed: 0.0159s/iter; left time: 38.9061s
	iters: 500, epoch: 16 | loss: 0.1464387
	speed: 0.0159s/iter; left time: 37.3251s
Epoch: 16 cost time: 9.357348442077637
Epoch: 16, Steps: 570 | Train Loss: 0.1104409 Vali Loss: 0.0404268 Test Loss: 0.1356013
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1148495
	speed: 0.0475s/iter; left time: 103.6649s
	iters: 200, epoch: 17 | loss: 0.1110382
	speed: 0.0158s/iter; left time: 32.9664s
	iters: 300, epoch: 17 | loss: 0.0821738
	speed: 0.0158s/iter; left time: 31.3766s
	iters: 400, epoch: 17 | loss: 0.1056507
	speed: 0.0158s/iter; left time: 29.8057s
	iters: 500, epoch: 17 | loss: 0.1384287
	speed: 0.0158s/iter; left time: 28.2219s
Epoch: 17 cost time: 9.321625709533691
Epoch: 17, Steps: 570 | Train Loss: 0.1104241 Vali Loss: 0.0403223 Test Loss: 0.1356038
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.0878980
	speed: 0.0517s/iter; left time: 83.3170s
	iters: 200, epoch: 18 | loss: 0.1103841
	speed: 0.0170s/iter; left time: 25.6560s
	iters: 300, epoch: 18 | loss: 0.0687813
	speed: 0.0160s/iter; left time: 22.5294s
	iters: 400, epoch: 18 | loss: 0.1152944
	speed: 0.0158s/iter; left time: 20.6931s
	iters: 500, epoch: 18 | loss: 0.0684247
	speed: 0.0158s/iter; left time: 19.1185s
Epoch: 18 cost time: 9.60588788986206
Epoch: 18, Steps: 570 | Train Loss: 0.1104895 Vali Loss: 0.0403452 Test Loss: 0.1356070
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1358376294374466, mae:0.23209401965141296
>>> MS_Pen LR=5e-4 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1994719
	speed: 0.0284s/iter; left time: 321.4288s
	iters: 200, epoch: 1 | loss: 0.1455167
	speed: 0.0157s/iter; left time: 175.9997s
	iters: 300, epoch: 1 | loss: 0.1631928
	speed: 0.0147s/iter; left time: 163.2982s
	iters: 400, epoch: 1 | loss: 0.1946607
	speed: 0.0147s/iter; left time: 161.7816s
	iters: 500, epoch: 1 | loss: 0.2655125
	speed: 0.0147s/iter; left time: 160.6501s
Epoch: 1 cost time: 9.909887790679932
Epoch: 1, Steps: 570 | Train Loss: 0.2044727 Vali Loss: 0.0551108 Test Loss: 0.1686999
Validation loss decreased (inf --> 0.055111).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2634267
	speed: 0.0488s/iter; left time: 523.3344s
	iters: 200, epoch: 2 | loss: 0.1347365
	speed: 0.0149s/iter; left time: 158.0406s
	iters: 300, epoch: 2 | loss: 0.2623769
	speed: 0.0148s/iter; left time: 156.1142s
	iters: 400, epoch: 2 | loss: 0.2263102
	speed: 0.0148s/iter; left time: 154.2319s
	iters: 500, epoch: 2 | loss: 0.3483463
	speed: 0.0159s/iter; left time: 164.1900s
Epoch: 2 cost time: 9.069904804229736
Epoch: 2, Steps: 570 | Train Loss: 0.2241573 Vali Loss: 0.0563352 Test Loss: 0.1742678
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1763115
	speed: 0.0537s/iter; left time: 546.0827s
	iters: 200, epoch: 3 | loss: 0.1180850
	speed: 0.0169s/iter; left time: 169.8184s
	iters: 300, epoch: 3 | loss: 0.2073625
	speed: 0.0169s/iter; left time: 168.8318s
	iters: 400, epoch: 3 | loss: 0.2160044
	speed: 0.0165s/iter; left time: 162.6626s
	iters: 500, epoch: 3 | loss: 0.1894022
	speed: 0.0148s/iter; left time: 144.4994s
Epoch: 3 cost time: 9.594436645507812
Epoch: 3, Steps: 570 | Train Loss: 0.2014830 Vali Loss: 0.0551509 Test Loss: 0.1541071
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1374929
	speed: 0.0499s/iter; left time: 478.5458s
	iters: 200, epoch: 4 | loss: 0.2138111
	speed: 0.0149s/iter; left time: 141.1291s
	iters: 300, epoch: 4 | loss: 0.2061602
	speed: 0.0153s/iter; left time: 143.4399s
	iters: 400, epoch: 4 | loss: 0.1377662
	speed: 0.0148s/iter; left time: 137.9024s
	iters: 500, epoch: 4 | loss: 0.1574530
	speed: 0.0148s/iter; left time: 136.3374s
Epoch: 4 cost time: 8.840588808059692
Epoch: 4, Steps: 570 | Train Loss: 0.1653574 Vali Loss: 0.0514347 Test Loss: 0.1635725
Validation loss decreased (0.055111 --> 0.051435).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1060141
	speed: 0.0524s/iter; left time: 472.7775s
	iters: 200, epoch: 5 | loss: 0.0872736
	speed: 0.0163s/iter; left time: 145.8430s
	iters: 300, epoch: 5 | loss: 0.1029634
	speed: 0.0164s/iter; left time: 144.7560s
	iters: 400, epoch: 5 | loss: 0.1430008
	speed: 0.0163s/iter; left time: 142.1088s
	iters: 500, epoch: 5 | loss: 0.0945398
	speed: 0.0165s/iter; left time: 142.2172s
Epoch: 5 cost time: 9.720808267593384
Epoch: 5, Steps: 570 | Train Loss: 0.1397851 Vali Loss: 0.0513622 Test Loss: 0.1588049
Validation loss decreased (0.051435 --> 0.051362).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1324671
	speed: 0.0504s/iter; left time: 426.1240s
	iters: 200, epoch: 6 | loss: 0.0970584
	speed: 0.0148s/iter; left time: 123.6863s
	iters: 300, epoch: 6 | loss: 0.1108202
	speed: 0.0148s/iter; left time: 122.0889s
	iters: 400, epoch: 6 | loss: 0.0884397
	speed: 0.0148s/iter; left time: 120.5577s
	iters: 500, epoch: 6 | loss: 0.0965577
	speed: 0.0155s/iter; left time: 124.9344s
Epoch: 6 cost time: 8.96104097366333
Epoch: 6, Steps: 570 | Train Loss: 0.1222649 Vali Loss: 0.0470786 Test Loss: 0.1487198
Validation loss decreased (0.051362 --> 0.047079).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1176486
	speed: 0.0521s/iter; left time: 410.8847s
	iters: 200, epoch: 7 | loss: 0.1137781
	speed: 0.0167s/iter; left time: 129.6752s
	iters: 300, epoch: 7 | loss: 0.1125121
	speed: 0.0169s/iter; left time: 129.4292s
	iters: 400, epoch: 7 | loss: 0.0929527
	speed: 0.0148s/iter; left time: 111.8426s
	iters: 500, epoch: 7 | loss: 0.1492064
	speed: 0.0147s/iter; left time: 110.3052s
Epoch: 7 cost time: 9.22257685661316
Epoch: 7, Steps: 570 | Train Loss: 0.1126500 Vali Loss: 0.0460596 Test Loss: 0.1512717
Validation loss decreased (0.047079 --> 0.046060).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0789228
	speed: 0.0517s/iter; left time: 378.2744s
	iters: 200, epoch: 8 | loss: 0.1430565
	speed: 0.0148s/iter; left time: 106.8898s
	iters: 300, epoch: 8 | loss: 0.0844805
	speed: 0.0148s/iter; left time: 105.5717s
	iters: 400, epoch: 8 | loss: 0.1370506
	speed: 0.0148s/iter; left time: 103.9741s
	iters: 500, epoch: 8 | loss: 0.1150513
	speed: 0.0148s/iter; left time: 102.4245s
Epoch: 8 cost time: 8.783375263214111
Epoch: 8, Steps: 570 | Train Loss: 0.1072418 Vali Loss: 0.0462423 Test Loss: 0.1540082
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0874257
	speed: 0.0503s/iter; left time: 338.9038s
	iters: 200, epoch: 9 | loss: 0.1024515
	speed: 0.0147s/iter; left time: 97.9383s
	iters: 300, epoch: 9 | loss: 0.0916379
	speed: 0.0147s/iter; left time: 96.4525s
	iters: 400, epoch: 9 | loss: 0.0996391
	speed: 0.0147s/iter; left time: 94.6856s
	iters: 500, epoch: 9 | loss: 0.1039565
	speed: 0.0147s/iter; left time: 93.2603s
Epoch: 9 cost time: 8.780081510543823
Epoch: 9, Steps: 570 | Train Loss: 0.1038717 Vali Loss: 0.0461118 Test Loss: 0.1527137
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1349721
	speed: 0.0484s/iter; left time: 298.7245s
	iters: 200, epoch: 10 | loss: 0.1114902
	speed: 0.0148s/iter; left time: 89.5861s
	iters: 300, epoch: 10 | loss: 0.0928862
	speed: 0.0148s/iter; left time: 88.1785s
	iters: 400, epoch: 10 | loss: 0.1257324
	speed: 0.0148s/iter; left time: 86.6689s
	iters: 500, epoch: 10 | loss: 0.1631015
	speed: 0.0148s/iter; left time: 85.2368s
Epoch: 10 cost time: 8.764333486557007
Epoch: 10, Steps: 570 | Train Loss: 0.1020564 Vali Loss: 0.0459032 Test Loss: 0.1539292
Validation loss decreased (0.046060 --> 0.045903).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1306687
	speed: 0.0521s/iter; left time: 291.6614s
	iters: 200, epoch: 11 | loss: 0.1042234
	speed: 0.0150s/iter; left time: 82.4865s
	iters: 300, epoch: 11 | loss: 0.0879156
	speed: 0.0148s/iter; left time: 79.6936s
	iters: 400, epoch: 11 | loss: 0.1103871
	speed: 0.0148s/iter; left time: 78.2871s
	iters: 500, epoch: 11 | loss: 0.1164501
	speed: 0.0148s/iter; left time: 77.0167s
Epoch: 11 cost time: 8.941891193389893
Epoch: 11, Steps: 570 | Train Loss: 0.1012589 Vali Loss: 0.0460944 Test Loss: 0.1539772
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0904257
	speed: 0.0484s/iter; left time: 243.2756s
	iters: 200, epoch: 12 | loss: 0.1423954
	speed: 0.0148s/iter; left time: 72.9228s
	iters: 300, epoch: 12 | loss: 0.0875744
	speed: 0.0149s/iter; left time: 71.8060s
	iters: 400, epoch: 12 | loss: 0.1066201
	speed: 0.0148s/iter; left time: 70.0323s
	iters: 500, epoch: 12 | loss: 0.0954624
	speed: 0.0148s/iter; left time: 68.3503s
Epoch: 12 cost time: 8.786759614944458
Epoch: 12, Steps: 570 | Train Loss: 0.1007041 Vali Loss: 0.0462054 Test Loss: 0.1538045
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1082996
	speed: 0.0493s/iter; left time: 220.0206s
	iters: 200, epoch: 13 | loss: 0.0953003
	speed: 0.0161s/iter; left time: 70.4004s
	iters: 300, epoch: 13 | loss: 0.0894510
	speed: 0.0159s/iter; left time: 67.6691s
	iters: 400, epoch: 13 | loss: 0.1428261
	speed: 0.0148s/iter; left time: 61.7423s
	iters: 500, epoch: 13 | loss: 0.1253662
	speed: 0.0149s/iter; left time: 60.3419s
Epoch: 13 cost time: 9.165602207183838
Epoch: 13, Steps: 570 | Train Loss: 0.1004703 Vali Loss: 0.0460224 Test Loss: 0.1537329
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1541181206703186, mae:0.2545745372772217
>>> MS_Pen LR=5e-4 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1360229
	speed: 0.0314s/iter; left time: 355.3084s
	iters: 200, epoch: 1 | loss: 0.1579062
	speed: 0.0199s/iter; left time: 223.3776s
	iters: 300, epoch: 1 | loss: 0.2166835
	speed: 0.0199s/iter; left time: 221.0228s
	iters: 400, epoch: 1 | loss: 0.1318803
	speed: 0.0199s/iter; left time: 219.2679s
	iters: 500, epoch: 1 | loss: 0.1282020
	speed: 0.0199s/iter; left time: 217.2537s
Epoch: 1 cost time: 12.557801723480225
Epoch: 1, Steps: 570 | Train Loss: 0.1870145 Vali Loss: 0.0440038 Test Loss: 0.1417097
Validation loss decreased (inf --> 0.044004).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2170566
	speed: 0.0585s/iter; left time: 627.4941s
	iters: 200, epoch: 2 | loss: 0.1166764
	speed: 0.0201s/iter; left time: 213.6404s
	iters: 300, epoch: 2 | loss: 0.0842871
	speed: 0.0200s/iter; left time: 211.0935s
	iters: 400, epoch: 2 | loss: 0.1108013
	speed: 0.0201s/iter; left time: 209.5379s
	iters: 500, epoch: 2 | loss: 0.1084533
	speed: 0.0200s/iter; left time: 207.0408s
Epoch: 2 cost time: 11.723355531692505
Epoch: 2, Steps: 570 | Train Loss: 0.1377793 Vali Loss: 0.0412173 Test Loss: 0.1472900
Validation loss decreased (0.044004 --> 0.041217).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1002067
	speed: 0.0576s/iter; left time: 585.4890s
	iters: 200, epoch: 3 | loss: 0.0682296
	speed: 0.0201s/iter; left time: 201.7595s
	iters: 300, epoch: 3 | loss: 0.0784678
	speed: 0.0201s/iter; left time: 199.8426s
	iters: 400, epoch: 3 | loss: 0.0655557
	speed: 0.0200s/iter; left time: 197.6154s
	iters: 500, epoch: 3 | loss: 0.0570055
	speed: 0.0201s/iter; left time: 195.8032s
Epoch: 3 cost time: 11.692432641983032
Epoch: 3, Steps: 570 | Train Loss: 0.0923281 Vali Loss: 0.0404976 Test Loss: 0.1457195
Validation loss decreased (0.041217 --> 0.040498).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0588812
	speed: 0.0595s/iter; left time: 570.9386s
	iters: 200, epoch: 4 | loss: 0.0741649
	speed: 0.0200s/iter; left time: 190.1004s
	iters: 300, epoch: 4 | loss: 0.0586592
	speed: 0.0201s/iter; left time: 188.3030s
	iters: 400, epoch: 4 | loss: 0.0447989
	speed: 0.0200s/iter; left time: 185.9237s
	iters: 500, epoch: 4 | loss: 0.0635057
	speed: 0.0200s/iter; left time: 184.0436s
Epoch: 4 cost time: 11.690749406814575
Epoch: 4, Steps: 570 | Train Loss: 0.0604128 Vali Loss: 0.0401949 Test Loss: 0.1403453
Validation loss decreased (0.040498 --> 0.040195).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0608543
	speed: 0.0575s/iter; left time: 518.9347s
	iters: 200, epoch: 5 | loss: 0.0372635
	speed: 0.0194s/iter; left time: 173.5130s
	iters: 300, epoch: 5 | loss: 0.0400565
	speed: 0.0194s/iter; left time: 171.5357s
	iters: 400, epoch: 5 | loss: 0.0432775
	speed: 0.0183s/iter; left time: 159.5400s
	iters: 500, epoch: 5 | loss: 0.0526817
	speed: 0.0172s/iter; left time: 148.3879s
Epoch: 5 cost time: 10.916380643844604
Epoch: 5, Steps: 570 | Train Loss: 0.0437025 Vali Loss: 0.0386792 Test Loss: 0.1450286
Validation loss decreased (0.040195 --> 0.038679).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0340712
	speed: 0.0560s/iter; left time: 473.4838s
	iters: 200, epoch: 6 | loss: 0.0352673
	speed: 0.0192s/iter; left time: 160.3190s
	iters: 300, epoch: 6 | loss: 0.0347532
	speed: 0.0200s/iter; left time: 165.2703s
	iters: 400, epoch: 6 | loss: 0.0484823
	speed: 0.0200s/iter; left time: 163.0263s
	iters: 500, epoch: 6 | loss: 0.0317319
	speed: 0.0200s/iter; left time: 161.0127s
Epoch: 6 cost time: 11.367735862731934
Epoch: 6, Steps: 570 | Train Loss: 0.0356378 Vali Loss: 0.0401136 Test Loss: 0.1441090
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0274794
	speed: 0.0573s/iter; left time: 451.4232s
	iters: 200, epoch: 7 | loss: 0.0308830
	speed: 0.0200s/iter; left time: 155.9621s
	iters: 300, epoch: 7 | loss: 0.0259677
	speed: 0.0201s/iter; left time: 154.0801s
	iters: 400, epoch: 7 | loss: 0.0388247
	speed: 0.0201s/iter; left time: 152.1604s
	iters: 500, epoch: 7 | loss: 0.0322811
	speed: 0.0200s/iter; left time: 149.9008s
Epoch: 7 cost time: 11.703126668930054
Epoch: 7, Steps: 570 | Train Loss: 0.0315944 Vali Loss: 0.0408308 Test Loss: 0.1452154
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0343611
	speed: 0.0577s/iter; left time: 421.5715s
	iters: 200, epoch: 8 | loss: 0.0291303
	speed: 0.0201s/iter; left time: 144.9758s
	iters: 300, epoch: 8 | loss: 0.0275170
	speed: 0.0201s/iter; left time: 142.9969s
	iters: 400, epoch: 8 | loss: 0.0313446
	speed: 0.0201s/iter; left time: 140.9874s
	iters: 500, epoch: 8 | loss: 0.0282435
	speed: 0.0201s/iter; left time: 138.9749s
Epoch: 8 cost time: 11.582986831665039
Epoch: 8, Steps: 570 | Train Loss: 0.0295457 Vali Loss: 0.0415143 Test Loss: 0.1481340
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1451469361782074, mae:0.23747871816158295
>>> MS_Pen LR=5e-4 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3132325
	speed: 0.0284s/iter; left time: 321.0798s
	iters: 200, epoch: 1 | loss: 0.1752287
	speed: 0.0171s/iter; left time: 191.0198s
	iters: 300, epoch: 1 | loss: 0.1406166
	speed: 0.0170s/iter; left time: 189.2679s
	iters: 400, epoch: 1 | loss: 0.1334853
	speed: 0.0171s/iter; left time: 188.1503s
	iters: 500, epoch: 1 | loss: 0.2255649
	speed: 0.0171s/iter; left time: 186.0039s
Epoch: 1 cost time: 10.913917064666748
Epoch: 1, Steps: 570 | Train Loss: 0.1612660 Vali Loss: 0.0418148 Test Loss: 0.1372133
Validation loss decreased (inf --> 0.041815).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0956646
	speed: 0.0530s/iter; left time: 569.1156s
	iters: 200, epoch: 2 | loss: 0.1535348
	speed: 0.0170s/iter; left time: 180.7160s
	iters: 300, epoch: 2 | loss: 0.1812721
	speed: 0.0170s/iter; left time: 179.0446s
	iters: 400, epoch: 2 | loss: 0.1808475
	speed: 0.0170s/iter; left time: 177.1738s
	iters: 500, epoch: 2 | loss: 0.1148626
	speed: 0.0170s/iter; left time: 175.5912s
Epoch: 2 cost time: 9.98370361328125
Epoch: 2, Steps: 570 | Train Loss: 0.1331840 Vali Loss: 0.0390569 Test Loss: 0.1279600
Validation loss decreased (0.041815 --> 0.039057).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0899614
	speed: 0.0558s/iter; left time: 567.0495s
	iters: 200, epoch: 3 | loss: 0.1031727
	speed: 0.0171s/iter; left time: 171.8775s
	iters: 300, epoch: 3 | loss: 0.1035545
	speed: 0.0171s/iter; left time: 169.9915s
	iters: 400, epoch: 3 | loss: 0.0641690
	speed: 0.0170s/iter; left time: 167.8284s
	iters: 500, epoch: 3 | loss: 0.0752347
	speed: 0.0171s/iter; left time: 166.6381s
Epoch: 3 cost time: 10.016084432601929
Epoch: 3, Steps: 570 | Train Loss: 0.0969367 Vali Loss: 0.0359555 Test Loss: 0.1230317
Validation loss decreased (0.039057 --> 0.035955).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0852547
	speed: 0.0531s/iter; left time: 508.9961s
	iters: 200, epoch: 4 | loss: 0.0464864
	speed: 0.0172s/iter; left time: 163.6151s
	iters: 300, epoch: 4 | loss: 0.0845368
	speed: 0.0172s/iter; left time: 161.1403s
	iters: 400, epoch: 4 | loss: 0.0767692
	speed: 0.0179s/iter; left time: 166.7689s
	iters: 500, epoch: 4 | loss: 0.0509959
	speed: 0.0192s/iter; left time: 176.4737s
Epoch: 4 cost time: 10.400290966033936
Epoch: 4, Steps: 570 | Train Loss: 0.0678405 Vali Loss: 0.0343962 Test Loss: 0.1304507
Validation loss decreased (0.035955 --> 0.034396).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0503961
	speed: 0.0536s/iter; left time: 483.5456s
	iters: 200, epoch: 5 | loss: 0.0542500
	speed: 0.0171s/iter; left time: 152.7890s
	iters: 300, epoch: 5 | loss: 0.0508586
	speed: 0.0171s/iter; left time: 150.8391s
	iters: 400, epoch: 5 | loss: 0.0406440
	speed: 0.0171s/iter; left time: 149.0042s
	iters: 500, epoch: 5 | loss: 0.0566705
	speed: 0.0171s/iter; left time: 147.1079s
Epoch: 5 cost time: 10.035226583480835
Epoch: 5, Steps: 570 | Train Loss: 0.0491521 Vali Loss: 0.0345311 Test Loss: 0.1318283
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0437495
	speed: 0.0530s/iter; left time: 448.2128s
	iters: 200, epoch: 6 | loss: 0.0290966
	speed: 0.0172s/iter; left time: 144.0181s
	iters: 300, epoch: 6 | loss: 0.0363133
	speed: 0.0172s/iter; left time: 142.2700s
	iters: 400, epoch: 6 | loss: 0.0372357
	speed: 0.0172s/iter; left time: 140.3877s
	iters: 500, epoch: 6 | loss: 0.0275452
	speed: 0.0172s/iter; left time: 138.7656s
Epoch: 6 cost time: 10.086400985717773
Epoch: 6, Steps: 570 | Train Loss: 0.0400763 Vali Loss: 0.0341172 Test Loss: 0.1337576
Validation loss decreased (0.034396 --> 0.034117).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0356629
	speed: 0.0538s/iter; left time: 424.3748s
	iters: 200, epoch: 7 | loss: 0.0485827
	speed: 0.0171s/iter; left time: 132.9607s
	iters: 300, epoch: 7 | loss: 0.0300166
	speed: 0.0171s/iter; left time: 131.3330s
	iters: 400, epoch: 7 | loss: 0.0312157
	speed: 0.0172s/iter; left time: 130.1165s
	iters: 500, epoch: 7 | loss: 0.0314133
	speed: 0.0172s/iter; left time: 128.6638s
Epoch: 7 cost time: 10.077351808547974
Epoch: 7, Steps: 570 | Train Loss: 0.0356246 Vali Loss: 0.0347200 Test Loss: 0.1365176
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0252782
	speed: 0.0526s/iter; left time: 384.7295s
	iters: 200, epoch: 8 | loss: 0.0296345
	speed: 0.0172s/iter; left time: 123.8708s
	iters: 300, epoch: 8 | loss: 0.0390884
	speed: 0.0172s/iter; left time: 122.0760s
	iters: 400, epoch: 8 | loss: 0.0339443
	speed: 0.0172s/iter; left time: 120.4903s
	iters: 500, epoch: 8 | loss: 0.0357747
	speed: 0.0172s/iter; left time: 118.6142s
Epoch: 8 cost time: 10.029804229736328
Epoch: 8, Steps: 570 | Train Loss: 0.0334273 Vali Loss: 0.0349171 Test Loss: 0.1364296
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0318514
	speed: 0.0573s/iter; left time: 386.0198s
	iters: 200, epoch: 9 | loss: 0.0309557
	speed: 0.0194s/iter; left time: 128.6586s
	iters: 300, epoch: 9 | loss: 0.0187892
	speed: 0.0193s/iter; left time: 126.4225s
	iters: 400, epoch: 9 | loss: 0.0357251
	speed: 0.0193s/iter; left time: 124.1905s
	iters: 500, epoch: 9 | loss: 0.0192944
	speed: 0.0192s/iter; left time: 121.9615s
Epoch: 9 cost time: 11.255975246429443
Epoch: 9, Steps: 570 | Train Loss: 0.0322636 Vali Loss: 0.0352738 Test Loss: 0.1372101
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1338290274143219, mae:0.2222568243741989
>>> MS_Pen LR=5e-4 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2779584
	speed: 0.0288s/iter; left time: 324.9213s
	iters: 200, epoch: 1 | loss: 0.1698136
	speed: 0.0173s/iter; left time: 193.5428s
	iters: 300, epoch: 1 | loss: 0.2338955
	speed: 0.0173s/iter; left time: 191.5292s
	iters: 400, epoch: 1 | loss: 0.2008446
	speed: 0.0173s/iter; left time: 190.1074s
	iters: 500, epoch: 1 | loss: 0.2290255
	speed: 0.0173s/iter; left time: 188.3425s
Epoch: 1 cost time: 11.04488468170166
Epoch: 1, Steps: 570 | Train Loss: 0.1953619 Vali Loss: 0.0435250 Test Loss: 0.1485369
Validation loss decreased (inf --> 0.043525).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2112743
	speed: 0.0555s/iter; left time: 595.9030s
	iters: 200, epoch: 2 | loss: 0.1488754
	speed: 0.0173s/iter; left time: 183.9484s
	iters: 300, epoch: 2 | loss: 0.2582540
	speed: 0.0173s/iter; left time: 182.5441s
	iters: 400, epoch: 2 | loss: 0.0927804
	speed: 0.0173s/iter; left time: 180.2633s
	iters: 500, epoch: 2 | loss: 0.0989588
	speed: 0.0173s/iter; left time: 178.5661s
Epoch: 2 cost time: 10.121392011642456
Epoch: 2, Steps: 570 | Train Loss: 0.1417791 Vali Loss: 0.0441026 Test Loss: 0.1493888
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0833534
	speed: 0.0548s/iter; left time: 556.3915s
	iters: 200, epoch: 3 | loss: 0.0938728
	speed: 0.0188s/iter; left time: 188.9589s
	iters: 300, epoch: 3 | loss: 0.0805305
	speed: 0.0172s/iter; left time: 171.0442s
	iters: 400, epoch: 3 | loss: 0.0600205
	speed: 0.0172s/iter; left time: 169.3166s
	iters: 500, epoch: 3 | loss: 0.0565213
	speed: 0.0172s/iter; left time: 167.6986s
Epoch: 3 cost time: 10.417908191680908
Epoch: 3, Steps: 570 | Train Loss: 0.0812162 Vali Loss: 0.0405852 Test Loss: 0.1463725
Validation loss decreased (0.043525 --> 0.040585).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0419820
	speed: 0.0540s/iter; left time: 517.5190s
	iters: 200, epoch: 4 | loss: 0.0658338
	speed: 0.0172s/iter; left time: 163.1455s
	iters: 300, epoch: 4 | loss: 0.0429124
	speed: 0.0172s/iter; left time: 161.1029s
	iters: 400, epoch: 4 | loss: 0.0476550
	speed: 0.0171s/iter; left time: 159.2059s
	iters: 500, epoch: 4 | loss: 0.0371666
	speed: 0.0171s/iter; left time: 157.5722s
Epoch: 4 cost time: 10.080209493637085
Epoch: 4, Steps: 570 | Train Loss: 0.0460038 Vali Loss: 0.0400740 Test Loss: 0.1489035
Validation loss decreased (0.040585 --> 0.040074).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0288468
	speed: 0.0538s/iter; left time: 485.6252s
	iters: 200, epoch: 5 | loss: 0.0274259
	speed: 0.0172s/iter; left time: 153.2444s
	iters: 300, epoch: 5 | loss: 0.0307528
	speed: 0.0171s/iter; left time: 151.2207s
	iters: 400, epoch: 5 | loss: 0.0319802
	speed: 0.0171s/iter; left time: 149.2944s
	iters: 500, epoch: 5 | loss: 0.0218929
	speed: 0.0171s/iter; left time: 147.5204s
Epoch: 5 cost time: 10.080859184265137
Epoch: 5, Steps: 570 | Train Loss: 0.0316928 Vali Loss: 0.0412722 Test Loss: 0.1505026
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0268963
	speed: 0.0576s/iter; left time: 486.9021s
	iters: 200, epoch: 6 | loss: 0.0236931
	speed: 0.0173s/iter; left time: 144.4168s
	iters: 300, epoch: 6 | loss: 0.0262375
	speed: 0.0173s/iter; left time: 142.5689s
	iters: 400, epoch: 6 | loss: 0.0245301
	speed: 0.0173s/iter; left time: 140.9791s
	iters: 500, epoch: 6 | loss: 0.0292813
	speed: 0.0173s/iter; left time: 139.2343s
Epoch: 6 cost time: 10.126562118530273
Epoch: 6, Steps: 570 | Train Loss: 0.0255353 Vali Loss: 0.0404648 Test Loss: 0.1505329
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0217386
	speed: 0.0545s/iter; left time: 429.7257s
	iters: 200, epoch: 7 | loss: 0.0174095
	speed: 0.0172s/iter; left time: 133.6005s
	iters: 300, epoch: 7 | loss: 0.0217999
	speed: 0.0172s/iter; left time: 131.8144s
	iters: 400, epoch: 7 | loss: 0.0344283
	speed: 0.0172s/iter; left time: 130.1796s
	iters: 500, epoch: 7 | loss: 0.0185564
	speed: 0.0173s/iter; left time: 129.1815s
Epoch: 7 cost time: 10.256259441375732
Epoch: 7, Steps: 570 | Train Loss: 0.0226948 Vali Loss: 0.0406990 Test Loss: 0.1528346
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14899347722530365, mae:0.2471892386674881
>>> MS_Pen LR=5e-4 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1806112
	speed: 0.0350s/iter; left time: 395.2867s
	iters: 200, epoch: 1 | loss: 0.1634983
	speed: 0.0230s/iter; left time: 258.1584s
	iters: 300, epoch: 1 | loss: 0.1401813
	speed: 0.0231s/iter; left time: 256.1884s
	iters: 400, epoch: 1 | loss: 0.4582297
	speed: 0.0231s/iter; left time: 254.2762s
	iters: 500, epoch: 1 | loss: 0.2337963
	speed: 0.0222s/iter; left time: 242.3829s
Epoch: 1 cost time: 14.197317123413086
Epoch: 1, Steps: 570 | Train Loss: 0.2577422 Vali Loss: 0.0617416 Test Loss: 0.1854118
Validation loss decreased (inf --> 0.061742).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3330774
	speed: 0.0621s/iter; left time: 666.4662s
	iters: 200, epoch: 2 | loss: 0.2674420
	speed: 0.0213s/iter; left time: 226.5916s
	iters: 300, epoch: 2 | loss: 0.2000841
	speed: 0.0213s/iter; left time: 224.2084s
	iters: 400, epoch: 2 | loss: 0.2481912
	speed: 0.0213s/iter; left time: 222.0462s
	iters: 500, epoch: 2 | loss: 0.2225932
	speed: 0.0213s/iter; left time: 220.1340s
Epoch: 2 cost time: 12.478601932525635
Epoch: 2, Steps: 570 | Train Loss: 0.2474862 Vali Loss: 0.0578412 Test Loss: 0.1698973
Validation loss decreased (0.061742 --> 0.057841).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3433335
	speed: 0.0618s/iter; left time: 627.7630s
	iters: 200, epoch: 3 | loss: 0.1615853
	speed: 0.0213s/iter; left time: 214.4689s
	iters: 300, epoch: 3 | loss: 0.2630264
	speed: 0.0212s/iter; left time: 211.5303s
	iters: 400, epoch: 3 | loss: 0.2982751
	speed: 0.0213s/iter; left time: 209.6779s
	iters: 500, epoch: 3 | loss: 0.1600157
	speed: 0.0213s/iter; left time: 207.6642s
Epoch: 3 cost time: 12.421619415283203
Epoch: 3, Steps: 570 | Train Loss: 0.2240691 Vali Loss: 0.0545890 Test Loss: 0.1621116
Validation loss decreased (0.057841 --> 0.054589).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1581411
	speed: 0.0652s/iter; left time: 625.1838s
	iters: 200, epoch: 4 | loss: 0.2087987
	speed: 0.0212s/iter; left time: 201.1622s
	iters: 300, epoch: 4 | loss: 0.2846755
	speed: 0.0212s/iter; left time: 198.9694s
	iters: 400, epoch: 4 | loss: 0.1646631
	speed: 0.0212s/iter; left time: 196.7916s
	iters: 500, epoch: 4 | loss: 0.2796925
	speed: 0.0212s/iter; left time: 194.6757s
Epoch: 4 cost time: 12.41090178489685
Epoch: 4, Steps: 570 | Train Loss: 0.2094376 Vali Loss: 0.0557586 Test Loss: 0.1584478
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2188329
	speed: 0.0620s/iter; left time: 559.2495s
	iters: 200, epoch: 5 | loss: 0.2613864
	speed: 0.0212s/iter; left time: 188.9959s
	iters: 300, epoch: 5 | loss: 0.1605555
	speed: 0.0212s/iter; left time: 186.8448s
	iters: 400, epoch: 5 | loss: 0.1587113
	speed: 0.0212s/iter; left time: 184.7592s
	iters: 500, epoch: 5 | loss: 0.2222226
	speed: 0.0212s/iter; left time: 182.5766s
Epoch: 5 cost time: 12.362121105194092
Epoch: 5, Steps: 570 | Train Loss: 0.1898969 Vali Loss: 0.0554023 Test Loss: 0.1549055
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1717020
	speed: 0.0603s/iter; left time: 509.6223s
	iters: 200, epoch: 6 | loss: 0.2296056
	speed: 0.0213s/iter; left time: 177.5044s
	iters: 300, epoch: 6 | loss: 0.1460828
	speed: 0.0213s/iter; left time: 175.7010s
	iters: 400, epoch: 6 | loss: 0.1285347
	speed: 0.0213s/iter; left time: 173.3670s
	iters: 500, epoch: 6 | loss: 0.2485529
	speed: 0.0213s/iter; left time: 171.0902s
Epoch: 6 cost time: 12.386208534240723
Epoch: 6, Steps: 570 | Train Loss: 0.1847247 Vali Loss: 0.0559165 Test Loss: 0.1565125
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1623774915933609, mae:0.26093247532844543
>>> MS_Pen LR=5e-4 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1682725
	speed: 0.0323s/iter; left time: 365.5250s
	iters: 200, epoch: 1 | loss: 0.0796426
	speed: 0.0206s/iter; left time: 230.4682s
	iters: 300, epoch: 1 | loss: 0.1519262
	speed: 0.0206s/iter; left time: 228.3775s
	iters: 400, epoch: 1 | loss: 0.1484312
	speed: 0.0206s/iter; left time: 226.4886s
	iters: 500, epoch: 1 | loss: 0.1957748
	speed: 0.0206s/iter; left time: 224.5199s
Epoch: 1 cost time: 12.965664625167847
Epoch: 1, Steps: 570 | Train Loss: 0.1851253 Vali Loss: 0.0441882 Test Loss: 0.1450370
Validation loss decreased (inf --> 0.044188).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2320149
	speed: 0.0604s/iter; left time: 647.7422s
	iters: 200, epoch: 2 | loss: 0.1659864
	speed: 0.0207s/iter; left time: 219.5945s
	iters: 300, epoch: 2 | loss: 0.4164134
	speed: 0.0207s/iter; left time: 217.8446s
	iters: 400, epoch: 2 | loss: 0.3081843
	speed: 0.0207s/iter; left time: 215.4681s
	iters: 500, epoch: 2 | loss: 0.1766469
	speed: 0.0206s/iter; left time: 213.2359s
Epoch: 2 cost time: 12.067427396774292
Epoch: 2, Steps: 570 | Train Loss: 0.2377094 Vali Loss: 0.0603380 Test Loss: 0.1777626
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2088699
	speed: 0.0598s/iter; left time: 607.1947s
	iters: 200, epoch: 3 | loss: 0.1873502
	speed: 0.0205s/iter; left time: 206.6122s
	iters: 300, epoch: 3 | loss: 0.1461753
	speed: 0.0205s/iter; left time: 204.5656s
	iters: 400, epoch: 3 | loss: 0.1629782
	speed: 0.0205s/iter; left time: 202.6363s
	iters: 500, epoch: 3 | loss: 0.1533601
	speed: 0.0206s/iter; left time: 200.8168s
Epoch: 3 cost time: 12.005592107772827
Epoch: 3, Steps: 570 | Train Loss: 0.2155173 Vali Loss: 0.0552482 Test Loss: 0.1624160
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1252925
	speed: 0.0600s/iter; left time: 575.3918s
	iters: 200, epoch: 4 | loss: 0.1931751
	speed: 0.0206s/iter; left time: 195.2858s
	iters: 300, epoch: 4 | loss: 0.1847452
	speed: 0.0206s/iter; left time: 193.0308s
	iters: 400, epoch: 4 | loss: 0.2110954
	speed: 0.0206s/iter; left time: 191.0983s
	iters: 500, epoch: 4 | loss: 0.1423087
	speed: 0.0206s/iter; left time: 189.0245s
Epoch: 4 cost time: 11.979273796081543
Epoch: 4, Steps: 570 | Train Loss: 0.1878835 Vali Loss: 0.0507321 Test Loss: 0.1503899
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1452789604663849, mae:0.2482956200838089
>>> MS_Pen LR=5e-4 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2864320
	speed: 0.0333s/iter; left time: 375.9731s
	iters: 200, epoch: 1 | loss: 0.1647492
	speed: 0.0209s/iter; left time: 233.8627s
	iters: 300, epoch: 1 | loss: 0.2324013
	speed: 0.0209s/iter; left time: 232.0519s
	iters: 400, epoch: 1 | loss: 0.2189510
	speed: 0.0209s/iter; left time: 230.0658s
	iters: 500, epoch: 1 | loss: 0.3000635
	speed: 0.0194s/iter; left time: 211.7439s
Epoch: 1 cost time: 12.926291942596436
Epoch: 1, Steps: 570 | Train Loss: 0.2236536 Vali Loss: 0.0499021 Test Loss: 0.1555753
Validation loss decreased (inf --> 0.049902).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1342677
	speed: 0.0576s/iter; left time: 617.7016s
	iters: 200, epoch: 2 | loss: 0.3297622
	speed: 0.0190s/iter; left time: 201.4690s
	iters: 300, epoch: 2 | loss: 0.1992538
	speed: 0.0189s/iter; left time: 199.5127s
	iters: 400, epoch: 2 | loss: 0.1305161
	speed: 0.0189s/iter; left time: 197.5963s
	iters: 500, epoch: 2 | loss: 0.1761182
	speed: 0.0189s/iter; left time: 195.7676s
Epoch: 2 cost time: 11.11205267906189
Epoch: 2, Steps: 570 | Train Loss: 0.2213877 Vali Loss: 0.0531147 Test Loss: 0.1637371
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1321498
	speed: 0.0598s/iter; left time: 607.2958s
	iters: 200, epoch: 3 | loss: 0.1276280
	speed: 0.0209s/iter; left time: 210.5051s
	iters: 300, epoch: 3 | loss: 0.1547408
	speed: 0.0209s/iter; left time: 208.6781s
	iters: 400, epoch: 3 | loss: 0.2042907
	speed: 0.0209s/iter; left time: 206.4741s
	iters: 500, epoch: 3 | loss: 0.1660408
	speed: 0.0206s/iter; left time: 201.3153s
Epoch: 3 cost time: 12.087523937225342
Epoch: 3, Steps: 570 | Train Loss: 0.1970072 Vali Loss: 0.0532967 Test Loss: 0.1544203
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1282558
	speed: 0.0576s/iter; left time: 552.4134s
	iters: 200, epoch: 4 | loss: 0.3156899
	speed: 0.0190s/iter; left time: 179.9555s
	iters: 300, epoch: 4 | loss: 0.0891693
	speed: 0.0189s/iter; left time: 177.9275s
	iters: 400, epoch: 4 | loss: 0.1448933
	speed: 0.0190s/iter; left time: 176.2301s
	iters: 500, epoch: 4 | loss: 0.1008319
	speed: 0.0190s/iter; left time: 174.2464s
Epoch: 4 cost time: 11.086035013198853
Epoch: 4, Steps: 570 | Train Loss: 0.1687454 Vali Loss: 0.0503755 Test Loss: 0.1572128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15583132207393646, mae:0.2567580044269562
>>> MS_Pen LR=5e-4 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2298582
	speed: 0.0238s/iter; left time: 268.7010s
	iters: 200, epoch: 1 | loss: 0.1804461
	speed: 0.0119s/iter; left time: 133.3126s
	iters: 300, epoch: 1 | loss: 0.1931321
	speed: 0.0116s/iter; left time: 128.9712s
	iters: 400, epoch: 1 | loss: 0.2233231
	speed: 0.0106s/iter; left time: 116.0825s
	iters: 500, epoch: 1 | loss: 0.1856398
	speed: 0.0106s/iter; left time: 115.6299s
Epoch: 1 cost time: 7.631033182144165
Epoch: 1, Steps: 570 | Train Loss: 0.2129098 Vali Loss: 0.0433439 Test Loss: 0.1387904
Validation loss decreased (inf --> 0.043344).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2855514
	speed: 0.0390s/iter; left time: 418.2309s
	iters: 200, epoch: 2 | loss: 0.2209561
	speed: 0.0106s/iter; left time: 112.8912s
	iters: 300, epoch: 2 | loss: 0.2612448
	speed: 0.0105s/iter; left time: 111.0987s
	iters: 400, epoch: 2 | loss: 0.1345950
	speed: 0.0106s/iter; left time: 110.3793s
	iters: 500, epoch: 2 | loss: 0.1325779
	speed: 0.0106s/iter; left time: 109.2941s
Epoch: 2 cost time: 6.487763166427612
Epoch: 2, Steps: 570 | Train Loss: 0.1734613 Vali Loss: 0.0411551 Test Loss: 0.1292876
Validation loss decreased (0.043344 --> 0.041155).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1165779
	speed: 0.0399s/iter; left time: 405.4699s
	iters: 200, epoch: 3 | loss: 0.1507982
	speed: 0.0121s/iter; left time: 121.9566s
	iters: 300, epoch: 3 | loss: 0.1384474
	speed: 0.0121s/iter; left time: 120.5042s
	iters: 400, epoch: 3 | loss: 0.1694373
	speed: 0.0121s/iter; left time: 119.2169s
	iters: 500, epoch: 3 | loss: 0.1911456
	speed: 0.0121s/iter; left time: 118.0458s
Epoch: 3 cost time: 7.20161509513855
Epoch: 3, Steps: 570 | Train Loss: 0.1401094 Vali Loss: 0.0375599 Test Loss: 0.1338388
Validation loss decreased (0.041155 --> 0.037560).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1152991
	speed: 0.0393s/iter; left time: 376.9907s
	iters: 200, epoch: 4 | loss: 0.0763824
	speed: 0.0110s/iter; left time: 103.9906s
	iters: 300, epoch: 4 | loss: 0.1381815
	speed: 0.0121s/iter; left time: 113.6191s
	iters: 400, epoch: 4 | loss: 0.1320618
	speed: 0.0121s/iter; left time: 112.3537s
	iters: 500, epoch: 4 | loss: 0.1242370
	speed: 0.0121s/iter; left time: 111.1510s
Epoch: 4 cost time: 6.960397958755493
Epoch: 4, Steps: 570 | Train Loss: 0.1184324 Vali Loss: 0.0374648 Test Loss: 0.1353535
Validation loss decreased (0.037560 --> 0.037465).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1081271
	speed: 0.0402s/iter; left time: 362.8875s
	iters: 200, epoch: 5 | loss: 0.1169578
	speed: 0.0121s/iter; left time: 107.8598s
	iters: 300, epoch: 5 | loss: 0.0653785
	speed: 0.0121s/iter; left time: 106.6695s
	iters: 400, epoch: 5 | loss: 0.1057846
	speed: 0.0121s/iter; left time: 105.7149s
	iters: 500, epoch: 5 | loss: 0.1212949
	speed: 0.0121s/iter; left time: 104.5283s
Epoch: 5 cost time: 7.242760896682739
Epoch: 5, Steps: 570 | Train Loss: 0.1085309 Vali Loss: 0.0362083 Test Loss: 0.1343497
Validation loss decreased (0.037465 --> 0.036208).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0962585
	speed: 0.0406s/iter; left time: 343.2703s
	iters: 200, epoch: 6 | loss: 0.0751027
	speed: 0.0121s/iter; left time: 100.8504s
	iters: 300, epoch: 6 | loss: 0.1194304
	speed: 0.0121s/iter; left time: 99.6799s
	iters: 400, epoch: 6 | loss: 0.1090615
	speed: 0.0121s/iter; left time: 98.4685s
	iters: 500, epoch: 6 | loss: 0.1133996
	speed: 0.0121s/iter; left time: 97.2318s
Epoch: 6 cost time: 7.2077977657318115
Epoch: 6, Steps: 570 | Train Loss: 0.1022474 Vali Loss: 0.0358605 Test Loss: 0.1402813
Validation loss decreased (0.036208 --> 0.035861).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1242152
	speed: 0.0411s/iter; left time: 323.8630s
	iters: 200, epoch: 7 | loss: 0.1372739
	speed: 0.0129s/iter; left time: 100.3586s
	iters: 300, epoch: 7 | loss: 0.0943198
	speed: 0.0129s/iter; left time: 99.3101s
	iters: 400, epoch: 7 | loss: 0.0672748
	speed: 0.0120s/iter; left time: 91.1326s
	iters: 500, epoch: 7 | loss: 0.0997393
	speed: 0.0122s/iter; left time: 91.1604s
Epoch: 7 cost time: 7.52005410194397
Epoch: 7, Steps: 570 | Train Loss: 0.1008664 Vali Loss: 0.0360723 Test Loss: 0.1405143
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0979956
	speed: 0.0400s/iter; left time: 292.7169s
	iters: 200, epoch: 8 | loss: 0.0947930
	speed: 0.0119s/iter; left time: 85.9582s
	iters: 300, epoch: 8 | loss: 0.1119922
	speed: 0.0119s/iter; left time: 84.9474s
	iters: 400, epoch: 8 | loss: 0.1709442
	speed: 0.0122s/iter; left time: 85.3316s
	iters: 500, epoch: 8 | loss: 0.0698002
	speed: 0.0121s/iter; left time: 83.9552s
Epoch: 8 cost time: 7.215375900268555
Epoch: 8, Steps: 570 | Train Loss: 0.0979105 Vali Loss: 0.0361909 Test Loss: 0.1394270
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1507136
	speed: 0.0403s/iter; left time: 271.4986s
	iters: 200, epoch: 9 | loss: 0.0898597
	speed: 0.0122s/iter; left time: 80.7305s
	iters: 300, epoch: 9 | loss: 0.0630603
	speed: 0.0122s/iter; left time: 79.4874s
	iters: 400, epoch: 9 | loss: 0.0838076
	speed: 0.0122s/iter; left time: 78.7712s
	iters: 500, epoch: 9 | loss: 0.0967609
	speed: 0.0122s/iter; left time: 77.6720s
Epoch: 9 cost time: 7.284346580505371
Epoch: 9, Steps: 570 | Train Loss: 0.0973147 Vali Loss: 0.0362085 Test Loss: 0.1385178
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14039956033229828, mae:0.23139265179634094
>>> MS_Pen LR=5e-4 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2210019
	speed: 0.0236s/iter; left time: 267.2534s
	iters: 200, epoch: 1 | loss: 0.1731476
	speed: 0.0116s/iter; left time: 129.9697s
	iters: 300, epoch: 1 | loss: 0.2518428
	speed: 0.0116s/iter; left time: 129.0685s
	iters: 400, epoch: 1 | loss: 0.1868301
	speed: 0.0116s/iter; left time: 127.6614s
	iters: 500, epoch: 1 | loss: 0.1898514
	speed: 0.0116s/iter; left time: 126.6706s
Epoch: 1 cost time: 7.870097875595093
Epoch: 1, Steps: 570 | Train Loss: 0.1875862 Vali Loss: 0.0384167 Test Loss: 0.1228519
Validation loss decreased (inf --> 0.038417).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1238552
	speed: 0.0382s/iter; left time: 409.5737s
	iters: 200, epoch: 2 | loss: 0.1770502
	speed: 0.0103s/iter; left time: 109.7381s
	iters: 300, epoch: 2 | loss: 0.1150974
	speed: 0.0103s/iter; left time: 108.8427s
	iters: 400, epoch: 2 | loss: 0.1425906
	speed: 0.0103s/iter; left time: 107.6079s
	iters: 500, epoch: 2 | loss: 0.1575787
	speed: 0.0103s/iter; left time: 106.5285s
Epoch: 2 cost time: 6.1805503368377686
Epoch: 2, Steps: 570 | Train Loss: 0.1582912 Vali Loss: 0.0359729 Test Loss: 0.1197212
Validation loss decreased (0.038417 --> 0.035973).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0622731
	speed: 0.0357s/iter; left time: 363.0720s
	iters: 200, epoch: 3 | loss: 0.1134994
	speed: 0.0103s/iter; left time: 103.5862s
	iters: 300, epoch: 3 | loss: 0.2644945
	speed: 0.0108s/iter; left time: 107.2411s
	iters: 400, epoch: 3 | loss: 0.1437093
	speed: 0.0117s/iter; left time: 115.1869s
	iters: 500, epoch: 3 | loss: 0.0840519
	speed: 0.0112s/iter; left time: 109.4599s
Epoch: 3 cost time: 6.442623615264893
Epoch: 3, Steps: 570 | Train Loss: 0.1313261 Vali Loss: 0.0317063 Test Loss: 0.1188087
Validation loss decreased (0.035973 --> 0.031706).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1042145
	speed: 0.0380s/iter; left time: 364.3801s
	iters: 200, epoch: 4 | loss: 0.0807694
	speed: 0.0118s/iter; left time: 112.2066s
	iters: 300, epoch: 4 | loss: 0.0771142
	speed: 0.0119s/iter; left time: 111.3550s
	iters: 400, epoch: 4 | loss: 0.0883855
	speed: 0.0119s/iter; left time: 110.4756s
	iters: 500, epoch: 4 | loss: 0.1359943
	speed: 0.0119s/iter; left time: 109.0865s
Epoch: 4 cost time: 6.942572832107544
Epoch: 4, Steps: 570 | Train Loss: 0.1138816 Vali Loss: 0.0329531 Test Loss: 0.1193976
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0861323
	speed: 0.0375s/iter; left time: 338.5891s
	iters: 200, epoch: 5 | loss: 0.1223774
	speed: 0.0116s/iter; left time: 103.8427s
	iters: 300, epoch: 5 | loss: 0.0931753
	speed: 0.0117s/iter; left time: 102.8728s
	iters: 400, epoch: 5 | loss: 0.1120945
	speed: 0.0116s/iter; left time: 101.2587s
	iters: 500, epoch: 5 | loss: 0.0930904
	speed: 0.0116s/iter; left time: 100.3382s
Epoch: 5 cost time: 6.832178831100464
Epoch: 5, Steps: 570 | Train Loss: 0.1050411 Vali Loss: 0.0322947 Test Loss: 0.1202484
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0821023
	speed: 0.0372s/iter; left time: 314.5841s
	iters: 200, epoch: 6 | loss: 0.1481856
	speed: 0.0102s/iter; left time: 85.3373s
	iters: 300, epoch: 6 | loss: 0.1316731
	speed: 0.0102s/iter; left time: 84.5181s
	iters: 400, epoch: 6 | loss: 0.0843456
	speed: 0.0103s/iter; left time: 83.6379s
	iters: 500, epoch: 6 | loss: 0.0752883
	speed: 0.0102s/iter; left time: 82.1612s
Epoch: 6 cost time: 6.139161109924316
Epoch: 6, Steps: 570 | Train Loss: 0.1004257 Vali Loss: 0.0316971 Test Loss: 0.1210150
Validation loss decreased (0.031706 --> 0.031697).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0927885
	speed: 0.0395s/iter; left time: 311.5858s
	iters: 200, epoch: 7 | loss: 0.0999407
	speed: 0.0116s/iter; left time: 90.0393s
	iters: 300, epoch: 7 | loss: 0.1658804
	speed: 0.0116s/iter; left time: 89.3168s
	iters: 400, epoch: 7 | loss: 0.1473324
	speed: 0.0116s/iter; left time: 87.7107s
	iters: 500, epoch: 7 | loss: 0.1112768
	speed: 0.0116s/iter; left time: 86.4796s
Epoch: 7 cost time: 6.920605182647705
Epoch: 7, Steps: 570 | Train Loss: 0.0988499 Vali Loss: 0.0317131 Test Loss: 0.1211554
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0855104
	speed: 0.0363s/iter; left time: 265.7389s
	iters: 200, epoch: 8 | loss: 0.0753835
	speed: 0.0102s/iter; left time: 73.5681s
	iters: 300, epoch: 8 | loss: 0.0806171
	speed: 0.0102s/iter; left time: 72.5433s
	iters: 400, epoch: 8 | loss: 0.0999818
	speed: 0.0102s/iter; left time: 71.6149s
	iters: 500, epoch: 8 | loss: 0.0566629
	speed: 0.0102s/iter; left time: 70.6202s
Epoch: 8 cost time: 6.084341049194336
Epoch: 8, Steps: 570 | Train Loss: 0.0972395 Vali Loss: 0.0318577 Test Loss: 0.1217074
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0870742
	speed: 0.0363s/iter; left time: 244.3960s
	iters: 200, epoch: 9 | loss: 0.1154571
	speed: 0.0102s/iter; left time: 67.7537s
	iters: 300, epoch: 9 | loss: 0.0765767
	speed: 0.0102s/iter; left time: 66.8609s
	iters: 400, epoch: 9 | loss: 0.1062533
	speed: 0.0117s/iter; left time: 75.0644s
	iters: 500, epoch: 9 | loss: 0.0881459
	speed: 0.0105s/iter; left time: 66.6913s
Epoch: 9 cost time: 6.268423557281494
Epoch: 9, Steps: 570 | Train Loss: 0.0963129 Vali Loss: 0.0319356 Test Loss: 0.1220400
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12114062160253525, mae:0.21276524662971497
>>> MS_Pen LR=5e-4 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1936132
	speed: 0.0221s/iter; left time: 249.7844s
	iters: 200, epoch: 1 | loss: 0.1321133
	speed: 0.0103s/iter; left time: 114.8608s
	iters: 300, epoch: 1 | loss: 0.1458938
	speed: 0.0103s/iter; left time: 114.1142s
	iters: 400, epoch: 1 | loss: 0.1326369
	speed: 0.0102s/iter; left time: 112.7145s
	iters: 500, epoch: 1 | loss: 0.1906051
	speed: 0.0103s/iter; left time: 111.9697s
Epoch: 1 cost time: 7.083675146102905
Epoch: 1, Steps: 570 | Train Loss: 0.2187603 Vali Loss: 0.0435828 Test Loss: 0.1418385
Validation loss decreased (inf --> 0.043583).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1742232
	speed: 0.0380s/iter; left time: 407.8809s
	iters: 200, epoch: 2 | loss: 0.2552374
	speed: 0.0116s/iter; left time: 122.9462s
	iters: 300, epoch: 2 | loss: 0.1611863
	speed: 0.0118s/iter; left time: 124.0232s
	iters: 400, epoch: 2 | loss: 0.2512452
	speed: 0.0117s/iter; left time: 122.5373s
	iters: 500, epoch: 2 | loss: 0.2061151
	speed: 0.0118s/iter; left time: 121.5886s
Epoch: 2 cost time: 6.959132432937622
Epoch: 2, Steps: 570 | Train Loss: 0.1761155 Vali Loss: 0.0390582 Test Loss: 0.1342114
Validation loss decreased (0.043583 --> 0.039058).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0938206
	speed: 0.0405s/iter; left time: 411.4233s
	iters: 200, epoch: 3 | loss: 0.1350542
	speed: 0.0105s/iter; left time: 105.3307s
	iters: 300, epoch: 3 | loss: 0.1736645
	speed: 0.0103s/iter; left time: 102.8459s
	iters: 400, epoch: 3 | loss: 0.1489887
	speed: 0.0103s/iter; left time: 101.6781s
	iters: 500, epoch: 3 | loss: 0.0878867
	speed: 0.0103s/iter; left time: 100.4509s
Epoch: 3 cost time: 6.350620269775391
Epoch: 3, Steps: 570 | Train Loss: 0.1360812 Vali Loss: 0.0380986 Test Loss: 0.1357588
Validation loss decreased (0.039058 --> 0.038099).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0879547
	speed: 0.0361s/iter; left time: 346.6602s
	iters: 200, epoch: 4 | loss: 0.0663335
	speed: 0.0103s/iter; left time: 97.6888s
	iters: 300, epoch: 4 | loss: 0.0794593
	speed: 0.0103s/iter; left time: 96.7788s
	iters: 400, epoch: 4 | loss: 0.1285057
	speed: 0.0103s/iter; left time: 95.9218s
	iters: 500, epoch: 4 | loss: 0.0902330
	speed: 0.0103s/iter; left time: 94.6802s
Epoch: 4 cost time: 6.138187646865845
Epoch: 4, Steps: 570 | Train Loss: 0.1129111 Vali Loss: 0.0383406 Test Loss: 0.1400019
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0928471
	speed: 0.0344s/iter; left time: 310.3623s
	iters: 200, epoch: 5 | loss: 0.0679989
	speed: 0.0112s/iter; left time: 99.9891s
	iters: 300, epoch: 5 | loss: 0.1055788
	speed: 0.0118s/iter; left time: 103.8489s
	iters: 400, epoch: 5 | loss: 0.1033747
	speed: 0.0118s/iter; left time: 102.6877s
	iters: 500, epoch: 5 | loss: 0.1370478
	speed: 0.0118s/iter; left time: 101.4726s
Epoch: 5 cost time: 6.762766122817993
Epoch: 5, Steps: 570 | Train Loss: 0.1038955 Vali Loss: 0.0370738 Test Loss: 0.1343306
Validation loss decreased (0.038099 --> 0.037074).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0784178
	speed: 0.0389s/iter; left time: 328.3829s
	iters: 200, epoch: 6 | loss: 0.1033465
	speed: 0.0101s/iter; left time: 84.6660s
	iters: 300, epoch: 6 | loss: 0.0774183
	speed: 0.0101s/iter; left time: 83.7133s
	iters: 400, epoch: 6 | loss: 0.0826139
	speed: 0.0102s/iter; left time: 82.8605s
	iters: 500, epoch: 6 | loss: 0.0996786
	speed: 0.0101s/iter; left time: 81.5292s
Epoch: 6 cost time: 6.20990514755249
Epoch: 6, Steps: 570 | Train Loss: 0.0982531 Vali Loss: 0.0375761 Test Loss: 0.1363649
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1059824
	speed: 0.0362s/iter; left time: 285.2001s
	iters: 200, epoch: 7 | loss: 0.0854460
	speed: 0.0102s/iter; left time: 79.5293s
	iters: 300, epoch: 7 | loss: 0.0922823
	speed: 0.0102s/iter; left time: 78.3474s
	iters: 400, epoch: 7 | loss: 0.0640625
	speed: 0.0102s/iter; left time: 77.5759s
	iters: 500, epoch: 7 | loss: 0.0938037
	speed: 0.0102s/iter; left time: 76.6697s
Epoch: 7 cost time: 6.089670181274414
Epoch: 7, Steps: 570 | Train Loss: 0.0947285 Vali Loss: 0.0375498 Test Loss: 0.1371997
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0771019
	speed: 0.0356s/iter; left time: 260.4792s
	iters: 200, epoch: 8 | loss: 0.0956005
	speed: 0.0102s/iter; left time: 73.6932s
	iters: 300, epoch: 8 | loss: 0.0873900
	speed: 0.0102s/iter; left time: 72.5090s
	iters: 400, epoch: 8 | loss: 0.0977112
	speed: 0.0102s/iter; left time: 71.5050s
	iters: 500, epoch: 8 | loss: 0.0781114
	speed: 0.0102s/iter; left time: 70.4702s
Epoch: 8 cost time: 6.097975015640259
Epoch: 8, Steps: 570 | Train Loss: 0.0927485 Vali Loss: 0.0374195 Test Loss: 0.1360551
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13442754745483398, mae:0.23146632313728333
>>> MS_Pen LR=5e-4 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3028562
	speed: 0.0242s/iter; left time: 273.0785s
	iters: 200, epoch: 1 | loss: 0.2216669
	speed: 0.0118s/iter; left time: 132.5111s
	iters: 300, epoch: 1 | loss: 0.1609930
	speed: 0.0118s/iter; left time: 131.0418s
	iters: 400, epoch: 1 | loss: 0.1028661
	speed: 0.0118s/iter; left time: 130.0418s
	iters: 500, epoch: 1 | loss: 0.1996830
	speed: 0.0118s/iter; left time: 128.9980s
Epoch: 1 cost time: 8.017410278320312
Epoch: 1, Steps: 570 | Train Loss: 0.2272450 Vali Loss: 0.0445026 Test Loss: 0.1386323
Validation loss decreased (inf --> 0.044503).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1807986
	speed: 0.0403s/iter; left time: 432.0324s
	iters: 200, epoch: 2 | loss: 0.1491205
	speed: 0.0118s/iter; left time: 125.9593s
	iters: 300, epoch: 2 | loss: 0.1497478
	speed: 0.0119s/iter; left time: 125.0992s
	iters: 400, epoch: 2 | loss: 0.0961273
	speed: 0.0119s/iter; left time: 123.6937s
	iters: 500, epoch: 2 | loss: 0.1828189
	speed: 0.0119s/iter; left time: 122.4330s
Epoch: 2 cost time: 7.092391729354858
Epoch: 2, Steps: 570 | Train Loss: 0.1971384 Vali Loss: 0.0411102 Test Loss: 0.1329025
Validation loss decreased (0.044503 --> 0.041110).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1982703
	speed: 0.0390s/iter; left time: 396.4433s
	iters: 200, epoch: 3 | loss: 0.2015309
	speed: 0.0118s/iter; left time: 118.3831s
	iters: 300, epoch: 3 | loss: 0.1023955
	speed: 0.0118s/iter; left time: 117.1898s
	iters: 400, epoch: 3 | loss: 0.1399367
	speed: 0.0117s/iter; left time: 115.7881s
	iters: 500, epoch: 3 | loss: 0.1193439
	speed: 0.0117s/iter; left time: 114.6384s
Epoch: 3 cost time: 7.015300512313843
Epoch: 3, Steps: 570 | Train Loss: 0.1693655 Vali Loss: 0.0400401 Test Loss: 0.1306414
Validation loss decreased (0.041110 --> 0.040040).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1131860
	speed: 0.0388s/iter; left time: 371.9141s
	iters: 200, epoch: 4 | loss: 0.1874276
	speed: 0.0117s/iter; left time: 111.2586s
	iters: 300, epoch: 4 | loss: 0.0957603
	speed: 0.0117s/iter; left time: 110.0877s
	iters: 400, epoch: 4 | loss: 0.1001869
	speed: 0.0117s/iter; left time: 108.8996s
	iters: 500, epoch: 4 | loss: 0.1324733
	speed: 0.0117s/iter; left time: 107.7108s
Epoch: 4 cost time: 6.994934558868408
Epoch: 4, Steps: 570 | Train Loss: 0.1444747 Vali Loss: 0.0375293 Test Loss: 0.1276189
Validation loss decreased (0.040040 --> 0.037529).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1074059
	speed: 0.0400s/iter; left time: 361.2764s
	iters: 200, epoch: 5 | loss: 0.1281263
	speed: 0.0127s/iter; left time: 113.7247s
	iters: 300, epoch: 5 | loss: 0.1608924
	speed: 0.0119s/iter; left time: 105.2472s
	iters: 400, epoch: 5 | loss: 0.1334859
	speed: 0.0118s/iter; left time: 102.5594s
	iters: 500, epoch: 5 | loss: 0.1293393
	speed: 0.0118s/iter; left time: 101.3712s
Epoch: 5 cost time: 7.213080167770386
Epoch: 5, Steps: 570 | Train Loss: 0.1301423 Vali Loss: 0.0355935 Test Loss: 0.1226767
Validation loss decreased (0.037529 --> 0.035594).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1206797
	speed: 0.0412s/iter; left time: 348.4652s
	iters: 200, epoch: 6 | loss: 0.0740556
	speed: 0.0118s/iter; left time: 98.3914s
	iters: 300, epoch: 6 | loss: 0.1399121
	speed: 0.0117s/iter; left time: 96.9472s
	iters: 400, epoch: 6 | loss: 0.1300173
	speed: 0.0118s/iter; left time: 95.8396s
	iters: 500, epoch: 6 | loss: 0.1059462
	speed: 0.0117s/iter; left time: 94.5627s
Epoch: 6 cost time: 7.019933700561523
Epoch: 6, Steps: 570 | Train Loss: 0.1220833 Vali Loss: 0.0353545 Test Loss: 0.1239590
Validation loss decreased (0.035594 --> 0.035354).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1030405
	speed: 0.0392s/iter; left time: 308.8783s
	iters: 200, epoch: 7 | loss: 0.1200451
	speed: 0.0118s/iter; left time: 91.9576s
	iters: 300, epoch: 7 | loss: 0.1070335
	speed: 0.0118s/iter; left time: 90.9851s
	iters: 400, epoch: 7 | loss: 0.0678785
	speed: 0.0118s/iter; left time: 89.6841s
	iters: 500, epoch: 7 | loss: 0.1040352
	speed: 0.0118s/iter; left time: 88.4291s
Epoch: 7 cost time: 7.057756423950195
Epoch: 7, Steps: 570 | Train Loss: 0.1170054 Vali Loss: 0.0356135 Test Loss: 0.1235566
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0809132
	speed: 0.0395s/iter; left time: 288.8625s
	iters: 200, epoch: 8 | loss: 0.1265160
	speed: 0.0118s/iter; left time: 84.9689s
	iters: 300, epoch: 8 | loss: 0.1175814
	speed: 0.0118s/iter; left time: 83.7404s
	iters: 400, epoch: 8 | loss: 0.0984192
	speed: 0.0118s/iter; left time: 82.4066s
	iters: 500, epoch: 8 | loss: 0.0901846
	speed: 0.0118s/iter; left time: 81.4897s
Epoch: 8 cost time: 7.002818822860718
Epoch: 8, Steps: 570 | Train Loss: 0.1161139 Vali Loss: 0.0351845 Test Loss: 0.1225990
Validation loss decreased (0.035354 --> 0.035185).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0819460
	speed: 0.0401s/iter; left time: 270.6391s
	iters: 200, epoch: 9 | loss: 0.1022034
	speed: 0.0128s/iter; left time: 85.3249s
	iters: 300, epoch: 9 | loss: 0.1086730
	speed: 0.0128s/iter; left time: 84.0008s
	iters: 400, epoch: 9 | loss: 0.0824839
	speed: 0.0128s/iter; left time: 82.7597s
	iters: 500, epoch: 9 | loss: 0.1306670
	speed: 0.0129s/iter; left time: 81.7575s
Epoch: 9 cost time: 7.617988586425781
Epoch: 9, Steps: 570 | Train Loss: 0.1142666 Vali Loss: 0.0351982 Test Loss: 0.1233137
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1123947
	speed: 0.0386s/iter; left time: 238.2238s
	iters: 200, epoch: 10 | loss: 0.1207440
	speed: 0.0118s/iter; left time: 71.5639s
	iters: 300, epoch: 10 | loss: 0.1109962
	speed: 0.0118s/iter; left time: 70.2237s
	iters: 400, epoch: 10 | loss: 0.0692169
	speed: 0.0118s/iter; left time: 69.0130s
	iters: 500, epoch: 10 | loss: 0.1685511
	speed: 0.0118s/iter; left time: 67.8969s
Epoch: 10 cost time: 6.975877285003662
Epoch: 10, Steps: 570 | Train Loss: 0.1144519 Vali Loss: 0.0353243 Test Loss: 0.1230501
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0952772
	speed: 0.0393s/iter; left time: 220.1718s
	iters: 200, epoch: 11 | loss: 0.1585209
	speed: 0.0117s/iter; left time: 64.5203s
	iters: 300, epoch: 11 | loss: 0.1005148
	speed: 0.0117s/iter; left time: 63.3365s
	iters: 400, epoch: 11 | loss: 0.1095706
	speed: 0.0117s/iter; left time: 62.1637s
	iters: 500, epoch: 11 | loss: 0.1574282
	speed: 0.0117s/iter; left time: 60.9819s
Epoch: 11 cost time: 7.000956296920776
Epoch: 11, Steps: 570 | Train Loss: 0.1135047 Vali Loss: 0.0353028 Test Loss: 0.1231719
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1227310374379158, mae:0.2186552733182907
>>> MS_Pen LR=5e-4 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1202751
	speed: 0.0234s/iter; left time: 264.1777s
	iters: 200, epoch: 1 | loss: 0.2959835
	speed: 0.0126s/iter; left time: 141.4702s
	iters: 300, epoch: 1 | loss: 0.1565410
	speed: 0.0114s/iter; left time: 126.8568s
	iters: 400, epoch: 1 | loss: 0.2037110
	speed: 0.0114s/iter; left time: 125.8215s
	iters: 500, epoch: 1 | loss: 0.1494418
	speed: 0.0114s/iter; left time: 124.5380s
Epoch: 1 cost time: 7.878630638122559
Epoch: 1, Steps: 570 | Train Loss: 0.2008397 Vali Loss: 0.0445467 Test Loss: 0.1336361
Validation loss decreased (inf --> 0.044547).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1632410
	speed: 0.0397s/iter; left time: 426.2091s
	iters: 200, epoch: 2 | loss: 0.1071862
	speed: 0.0115s/iter; left time: 121.7776s
	iters: 300, epoch: 2 | loss: 0.1555620
	speed: 0.0115s/iter; left time: 120.7897s
	iters: 400, epoch: 2 | loss: 0.2279187
	speed: 0.0115s/iter; left time: 119.8793s
	iters: 500, epoch: 2 | loss: 0.2860282
	speed: 0.0115s/iter; left time: 118.4992s
Epoch: 2 cost time: 6.956625699996948
Epoch: 2, Steps: 570 | Train Loss: 0.1739395 Vali Loss: 0.0400461 Test Loss: 0.1270943
Validation loss decreased (0.044547 --> 0.040046).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1412773
	speed: 0.0392s/iter; left time: 398.2255s
	iters: 200, epoch: 3 | loss: 0.0909934
	speed: 0.0114s/iter; left time: 114.5964s
	iters: 300, epoch: 3 | loss: 0.1704258
	speed: 0.0114s/iter; left time: 113.4957s
	iters: 400, epoch: 3 | loss: 0.1502642
	speed: 0.0114s/iter; left time: 112.1915s
	iters: 500, epoch: 3 | loss: 0.1892189
	speed: 0.0114s/iter; left time: 111.0384s
Epoch: 3 cost time: 6.7688422203063965
Epoch: 3, Steps: 570 | Train Loss: 0.1508915 Vali Loss: 0.0353793 Test Loss: 0.1190604
Validation loss decreased (0.040046 --> 0.035379).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1235681
	speed: 0.0379s/iter; left time: 363.6552s
	iters: 200, epoch: 4 | loss: 0.0856838
	speed: 0.0115s/iter; left time: 108.7794s
	iters: 300, epoch: 4 | loss: 0.0766485
	speed: 0.0115s/iter; left time: 107.6132s
	iters: 400, epoch: 4 | loss: 0.1224585
	speed: 0.0115s/iter; left time: 106.4320s
	iters: 500, epoch: 4 | loss: 0.1201737
	speed: 0.0115s/iter; left time: 105.2984s
Epoch: 4 cost time: 6.854840040206909
Epoch: 4, Steps: 570 | Train Loss: 0.1299188 Vali Loss: 0.0332308 Test Loss: 0.1176815
Validation loss decreased (0.035379 --> 0.033231).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0971517
	speed: 0.0385s/iter; left time: 347.3112s
	iters: 200, epoch: 5 | loss: 0.0984773
	speed: 0.0115s/iter; left time: 102.2277s
	iters: 300, epoch: 5 | loss: 0.1735609
	speed: 0.0115s/iter; left time: 101.0548s
	iters: 400, epoch: 5 | loss: 0.1083516
	speed: 0.0115s/iter; left time: 99.9138s
	iters: 500, epoch: 5 | loss: 0.0898281
	speed: 0.0115s/iter; left time: 98.8383s
Epoch: 5 cost time: 6.854555368423462
Epoch: 5, Steps: 570 | Train Loss: 0.1178392 Vali Loss: 0.0320052 Test Loss: 0.1201276
Validation loss decreased (0.033231 --> 0.032005).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1441631
	speed: 0.0399s/iter; left time: 337.2014s
	iters: 200, epoch: 6 | loss: 0.1186986
	speed: 0.0115s/iter; left time: 96.3836s
	iters: 300, epoch: 6 | loss: 0.0970161
	speed: 0.0115s/iter; left time: 94.8345s
	iters: 400, epoch: 6 | loss: 0.0813735
	speed: 0.0115s/iter; left time: 93.3891s
	iters: 500, epoch: 6 | loss: 0.0835359
	speed: 0.0117s/iter; left time: 94.3037s
Epoch: 6 cost time: 7.050251483917236
Epoch: 6, Steps: 570 | Train Loss: 0.1109476 Vali Loss: 0.0309741 Test Loss: 0.1206257
Validation loss decreased (0.032005 --> 0.030974).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0812402
	speed: 0.0404s/iter; left time: 318.1042s
	iters: 200, epoch: 7 | loss: 0.1531464
	speed: 0.0114s/iter; left time: 88.6403s
	iters: 300, epoch: 7 | loss: 0.0753045
	speed: 0.0114s/iter; left time: 87.8352s
	iters: 400, epoch: 7 | loss: 0.0808168
	speed: 0.0114s/iter; left time: 86.5565s
	iters: 500, epoch: 7 | loss: 0.0947435
	speed: 0.0114s/iter; left time: 85.2628s
Epoch: 7 cost time: 6.819275856018066
Epoch: 7, Steps: 570 | Train Loss: 0.1065658 Vali Loss: 0.0311453 Test Loss: 0.1220143
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0908711
	speed: 0.0383s/iter; left time: 279.8007s
	iters: 200, epoch: 8 | loss: 0.1192433
	speed: 0.0115s/iter; left time: 82.7336s
	iters: 300, epoch: 8 | loss: 0.0805107
	speed: 0.0115s/iter; left time: 81.5732s
	iters: 400, epoch: 8 | loss: 0.0921295
	speed: 0.0115s/iter; left time: 80.3896s
	iters: 500, epoch: 8 | loss: 0.0912026
	speed: 0.0114s/iter; left time: 79.0884s
Epoch: 8 cost time: 6.835477352142334
Epoch: 8, Steps: 570 | Train Loss: 0.1051285 Vali Loss: 0.0312470 Test Loss: 0.1196921
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1611527
	speed: 0.0390s/iter; left time: 262.7164s
	iters: 200, epoch: 9 | loss: 0.0804175
	speed: 0.0125s/iter; left time: 83.1996s
	iters: 300, epoch: 9 | loss: 0.1154313
	speed: 0.0126s/iter; left time: 82.3770s
	iters: 400, epoch: 9 | loss: 0.1085627
	speed: 0.0125s/iter; left time: 80.7191s
	iters: 500, epoch: 9 | loss: 0.1791905
	speed: 0.0125s/iter; left time: 79.3929s
Epoch: 9 cost time: 7.37513279914856
Epoch: 9, Steps: 570 | Train Loss: 0.1041962 Vali Loss: 0.0310808 Test Loss: 0.1202725
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12075719982385635, mae:0.21192647516727448
>>> MS_Pen LR=5e-4 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2705370
	speed: 0.0241s/iter; left time: 272.7550s
	iters: 200, epoch: 1 | loss: 0.3427274
	speed: 0.0120s/iter; left time: 134.8364s
	iters: 300, epoch: 1 | loss: 0.2588386
	speed: 0.0120s/iter; left time: 133.2442s
	iters: 400, epoch: 1 | loss: 0.2305568
	speed: 0.0120s/iter; left time: 132.1370s
	iters: 500, epoch: 1 | loss: 0.2116744
	speed: 0.0110s/iter; left time: 120.1703s
Epoch: 1 cost time: 7.935122489929199
Epoch: 1, Steps: 570 | Train Loss: 0.2302455 Vali Loss: 0.0482420 Test Loss: 0.1573137
Validation loss decreased (inf --> 0.048242).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2296468
	speed: 0.0376s/iter; left time: 403.7434s
	iters: 200, epoch: 2 | loss: 0.2797962
	speed: 0.0109s/iter; left time: 115.4662s
	iters: 300, epoch: 2 | loss: 0.1302751
	speed: 0.0122s/iter; left time: 128.1762s
	iters: 400, epoch: 2 | loss: 0.1565011
	speed: 0.0109s/iter; left time: 113.2146s
	iters: 500, epoch: 2 | loss: 0.1555112
	speed: 0.0109s/iter; left time: 112.2450s
Epoch: 2 cost time: 6.655567646026611
Epoch: 2, Steps: 570 | Train Loss: 0.2071917 Vali Loss: 0.0442381 Test Loss: 0.1380385
Validation loss decreased (0.048242 --> 0.044238).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1378340
	speed: 0.0384s/iter; left time: 389.9767s
	iters: 200, epoch: 3 | loss: 0.1178541
	speed: 0.0109s/iter; left time: 109.3977s
	iters: 300, epoch: 3 | loss: 0.2113827
	speed: 0.0109s/iter; left time: 108.4121s
	iters: 400, epoch: 3 | loss: 0.1262664
	speed: 0.0109s/iter; left time: 107.1662s
	iters: 500, epoch: 3 | loss: 0.1787789
	speed: 0.0118s/iter; left time: 115.1058s
Epoch: 3 cost time: 6.681350231170654
Epoch: 3, Steps: 570 | Train Loss: 0.1690255 Vali Loss: 0.0400328 Test Loss: 0.1352951
Validation loss decreased (0.044238 --> 0.040033).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1433545
	speed: 0.0405s/iter; left time: 388.6605s
	iters: 200, epoch: 4 | loss: 0.0975690
	speed: 0.0125s/iter; left time: 118.4108s
	iters: 300, epoch: 4 | loss: 0.1266421
	speed: 0.0125s/iter; left time: 117.1305s
	iters: 400, epoch: 4 | loss: 0.2613226
	speed: 0.0124s/iter; left time: 115.2473s
	iters: 500, epoch: 4 | loss: 0.1421494
	speed: 0.0124s/iter; left time: 113.9107s
Epoch: 4 cost time: 7.404796361923218
Epoch: 4, Steps: 570 | Train Loss: 0.1440403 Vali Loss: 0.0389429 Test Loss: 0.1357294
Validation loss decreased (0.040033 --> 0.038943).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1147749
	speed: 0.0417s/iter; left time: 376.2064s
	iters: 200, epoch: 5 | loss: 0.1279340
	speed: 0.0124s/iter; left time: 110.4653s
	iters: 300, epoch: 5 | loss: 0.1360924
	speed: 0.0124s/iter; left time: 109.0612s
	iters: 400, epoch: 5 | loss: 0.0932732
	speed: 0.0124s/iter; left time: 108.1227s
	iters: 500, epoch: 5 | loss: 0.1762866
	speed: 0.0124s/iter; left time: 107.1264s
Epoch: 5 cost time: 7.345396280288696
Epoch: 5, Steps: 570 | Train Loss: 0.1272187 Vali Loss: 0.0359191 Test Loss: 0.1290458
Validation loss decreased (0.038943 --> 0.035919).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1103596
	speed: 0.0392s/iter; left time: 330.9757s
	iters: 200, epoch: 6 | loss: 0.1059989
	speed: 0.0113s/iter; left time: 93.9578s
	iters: 300, epoch: 6 | loss: 0.1116873
	speed: 0.0115s/iter; left time: 95.2099s
	iters: 400, epoch: 6 | loss: 0.1059870
	speed: 0.0120s/iter; left time: 97.5663s
	iters: 500, epoch: 6 | loss: 0.1060848
	speed: 0.0120s/iter; left time: 96.4287s
Epoch: 6 cost time: 7.013311147689819
Epoch: 6, Steps: 570 | Train Loss: 0.1180061 Vali Loss: 0.0359020 Test Loss: 0.1317822
Validation loss decreased (0.035919 --> 0.035902).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0822089
	speed: 0.0380s/iter; left time: 299.1883s
	iters: 200, epoch: 7 | loss: 0.1013720
	speed: 0.0109s/iter; left time: 84.4896s
	iters: 300, epoch: 7 | loss: 0.0827663
	speed: 0.0109s/iter; left time: 83.4052s
	iters: 400, epoch: 7 | loss: 0.1201123
	speed: 0.0109s/iter; left time: 82.2833s
	iters: 500, epoch: 7 | loss: 0.0797979
	speed: 0.0109s/iter; left time: 81.2212s
Epoch: 7 cost time: 6.4948296546936035
Epoch: 7, Steps: 570 | Train Loss: 0.1121354 Vali Loss: 0.0358033 Test Loss: 0.1332538
Validation loss decreased (0.035902 --> 0.035803).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0816510
	speed: 0.0376s/iter; left time: 274.5890s
	iters: 200, epoch: 8 | loss: 0.1575800
	speed: 0.0108s/iter; left time: 77.7470s
	iters: 300, epoch: 8 | loss: 0.1361223
	speed: 0.0108s/iter; left time: 76.6690s
	iters: 400, epoch: 8 | loss: 0.1150318
	speed: 0.0108s/iter; left time: 75.6020s
	iters: 500, epoch: 8 | loss: 0.0744062
	speed: 0.0108s/iter; left time: 74.5091s
Epoch: 8 cost time: 6.4472815990448
Epoch: 8, Steps: 570 | Train Loss: 0.1098511 Vali Loss: 0.0356490 Test Loss: 0.1321910
Validation loss decreased (0.035803 --> 0.035649).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1148363
	speed: 0.0375s/iter; left time: 252.6980s
	iters: 200, epoch: 9 | loss: 0.0872789
	speed: 0.0109s/iter; left time: 72.1756s
	iters: 300, epoch: 9 | loss: 0.1348362
	speed: 0.0109s/iter; left time: 71.0791s
	iters: 400, epoch: 9 | loss: 0.1241431
	speed: 0.0109s/iter; left time: 69.9811s
	iters: 500, epoch: 9 | loss: 0.0649228
	speed: 0.0109s/iter; left time: 69.1979s
Epoch: 9 cost time: 6.513181209564209
Epoch: 9, Steps: 570 | Train Loss: 0.1079173 Vali Loss: 0.0357764 Test Loss: 0.1331657
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1205262
	speed: 0.0368s/iter; left time: 226.9356s
	iters: 200, epoch: 10 | loss: 0.0690902
	speed: 0.0108s/iter; left time: 65.7259s
	iters: 300, epoch: 10 | loss: 0.1168063
	speed: 0.0108s/iter; left time: 64.6945s
	iters: 400, epoch: 10 | loss: 0.0826818
	speed: 0.0108s/iter; left time: 63.3798s
	iters: 500, epoch: 10 | loss: 0.1131612
	speed: 0.0108s/iter; left time: 62.2832s
Epoch: 10 cost time: 6.45894980430603
Epoch: 10, Steps: 570 | Train Loss: 0.1079922 Vali Loss: 0.0357044 Test Loss: 0.1328406
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0843337
	speed: 0.0378s/iter; left time: 211.5543s
	iters: 200, epoch: 11 | loss: 0.0985981
	speed: 0.0120s/iter; left time: 66.2108s
	iters: 300, epoch: 11 | loss: 0.1206183
	speed: 0.0120s/iter; left time: 64.8138s
	iters: 400, epoch: 11 | loss: 0.0832866
	speed: 0.0120s/iter; left time: 63.8146s
	iters: 500, epoch: 11 | loss: 0.0851068
	speed: 0.0121s/iter; left time: 62.8327s
Epoch: 11 cost time: 7.1134161949157715
Epoch: 11, Steps: 570 | Train Loss: 0.1077295 Vali Loss: 0.0356783 Test Loss: 0.1328865
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13231457769870758, mae:0.23235800862312317
>>> MS_Pen LR=5e-4 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1790876
	speed: 0.0280s/iter; left time: 316.6176s
	iters: 200, epoch: 1 | loss: 0.1573808
	speed: 0.0163s/iter; left time: 182.2426s
	iters: 300, epoch: 1 | loss: 0.3146160
	speed: 0.0152s/iter; left time: 168.9846s
	iters: 400, epoch: 1 | loss: 0.1746790
	speed: 0.0145s/iter; left time: 159.4588s
	iters: 500, epoch: 1 | loss: 0.1537990
	speed: 0.0146s/iter; left time: 158.6536s
Epoch: 1 cost time: 9.924726009368896
Epoch: 1, Steps: 570 | Train Loss: 0.2115783 Vali Loss: 0.0449815 Test Loss: 0.1384557
Validation loss decreased (inf --> 0.044982).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1849068
	speed: 0.0464s/iter; left time: 497.6123s
	iters: 200, epoch: 2 | loss: 0.1973993
	speed: 0.0145s/iter; left time: 154.6569s
	iters: 300, epoch: 2 | loss: 0.1297039
	speed: 0.0146s/iter; left time: 153.3375s
	iters: 400, epoch: 2 | loss: 0.0895719
	speed: 0.0145s/iter; left time: 151.6370s
	iters: 500, epoch: 2 | loss: 0.1872752
	speed: 0.0145s/iter; left time: 150.2287s
Epoch: 2 cost time: 8.595214366912842
Epoch: 2, Steps: 570 | Train Loss: 0.1705150 Vali Loss: 0.0438261 Test Loss: 0.1445255
Validation loss decreased (0.044982 --> 0.043826).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1999095
	speed: 0.0466s/iter; left time: 473.1942s
	iters: 200, epoch: 3 | loss: 0.1406881
	speed: 0.0145s/iter; left time: 145.4863s
	iters: 300, epoch: 3 | loss: 0.0995227
	speed: 0.0144s/iter; left time: 143.2837s
	iters: 400, epoch: 3 | loss: 0.0839944
	speed: 0.0144s/iter; left time: 142.1673s
	iters: 500, epoch: 3 | loss: 0.0879420
	speed: 0.0144s/iter; left time: 140.5615s
Epoch: 3 cost time: 8.567726612091064
Epoch: 3, Steps: 570 | Train Loss: 0.1363845 Vali Loss: 0.0369009 Test Loss: 0.1379378
Validation loss decreased (0.043826 --> 0.036901).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1013065
	speed: 0.0462s/iter; left time: 442.6949s
	iters: 200, epoch: 4 | loss: 0.0940519
	speed: 0.0144s/iter; left time: 136.5355s
	iters: 300, epoch: 4 | loss: 0.1225123
	speed: 0.0144s/iter; left time: 135.3877s
	iters: 400, epoch: 4 | loss: 0.1340629
	speed: 0.0144s/iter; left time: 133.8109s
	iters: 500, epoch: 4 | loss: 0.1052118
	speed: 0.0144s/iter; left time: 132.5135s
Epoch: 4 cost time: 8.50010371208191
Epoch: 4, Steps: 570 | Train Loss: 0.1136092 Vali Loss: 0.0376151 Test Loss: 0.1382716
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0925715
	speed: 0.0455s/iter; left time: 410.7623s
	iters: 200, epoch: 5 | loss: 0.0867511
	speed: 0.0144s/iter; left time: 128.5834s
	iters: 300, epoch: 5 | loss: 0.0816131
	speed: 0.0144s/iter; left time: 126.8613s
	iters: 400, epoch: 5 | loss: 0.0923569
	speed: 0.0144s/iter; left time: 125.4246s
	iters: 500, epoch: 5 | loss: 0.0894524
	speed: 0.0144s/iter; left time: 123.9451s
Epoch: 5 cost time: 8.469649314880371
Epoch: 5, Steps: 570 | Train Loss: 0.1017393 Vali Loss: 0.0381218 Test Loss: 0.1426080
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0692578
	speed: 0.0480s/iter; left time: 405.4505s
	iters: 200, epoch: 6 | loss: 0.1267217
	speed: 0.0145s/iter; left time: 121.2817s
	iters: 300, epoch: 6 | loss: 0.0750885
	speed: 0.0145s/iter; left time: 119.2312s
	iters: 400, epoch: 6 | loss: 0.0932668
	speed: 0.0145s/iter; left time: 118.5083s
	iters: 500, epoch: 6 | loss: 0.0862408
	speed: 0.0146s/iter; left time: 117.3553s
Epoch: 6 cost time: 8.545198202133179
Epoch: 6, Steps: 570 | Train Loss: 0.0953233 Vali Loss: 0.0378472 Test Loss: 0.1465924
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13805225491523743, mae:0.2336909919977188
>>> MS_Pen LR=5e-4 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2700909
	speed: 0.0261s/iter; left time: 295.0989s
	iters: 200, epoch: 1 | loss: 0.1792139
	speed: 0.0142s/iter; left time: 158.9370s
	iters: 300, epoch: 1 | loss: 0.1238542
	speed: 0.0142s/iter; left time: 157.3022s
	iters: 400, epoch: 1 | loss: 0.2294765
	speed: 0.0142s/iter; left time: 156.3230s
	iters: 500, epoch: 1 | loss: 0.1809429
	speed: 0.0142s/iter; left time: 154.3746s
Epoch: 1 cost time: 9.325599908828735
Epoch: 1, Steps: 570 | Train Loss: 0.1894358 Vali Loss: 0.0425531 Test Loss: 0.1325172
Validation loss decreased (inf --> 0.042553).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1259562
	speed: 0.0453s/iter; left time: 486.4770s
	iters: 200, epoch: 2 | loss: 0.2918951
	speed: 0.0142s/iter; left time: 150.7887s
	iters: 300, epoch: 2 | loss: 0.1821671
	speed: 0.0141s/iter; left time: 148.6656s
	iters: 400, epoch: 2 | loss: 0.1498497
	speed: 0.0142s/iter; left time: 147.6084s
	iters: 500, epoch: 2 | loss: 0.1514948
	speed: 0.0141s/iter; left time: 145.7800s
Epoch: 2 cost time: 8.377035140991211
Epoch: 2, Steps: 570 | Train Loss: 0.1570400 Vali Loss: 0.0378672 Test Loss: 0.1255819
Validation loss decreased (0.042553 --> 0.037867).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1520082
	speed: 0.0455s/iter; left time: 462.2650s
	iters: 200, epoch: 3 | loss: 0.0701768
	speed: 0.0142s/iter; left time: 143.0304s
	iters: 300, epoch: 3 | loss: 0.1781478
	speed: 0.0142s/iter; left time: 141.5199s
	iters: 400, epoch: 3 | loss: 0.1072886
	speed: 0.0142s/iter; left time: 140.1160s
	iters: 500, epoch: 3 | loss: 0.1039454
	speed: 0.0142s/iter; left time: 138.6053s
Epoch: 3 cost time: 8.397168159484863
Epoch: 3, Steps: 570 | Train Loss: 0.1294545 Vali Loss: 0.0351383 Test Loss: 0.1228892
Validation loss decreased (0.037867 --> 0.035138).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1328576
	speed: 0.0455s/iter; left time: 436.8007s
	iters: 200, epoch: 4 | loss: 0.1138541
	speed: 0.0141s/iter; left time: 134.1626s
	iters: 300, epoch: 4 | loss: 0.1130157
	speed: 0.0141s/iter; left time: 132.7188s
	iters: 400, epoch: 4 | loss: 0.0773101
	speed: 0.0141s/iter; left time: 131.1457s
	iters: 500, epoch: 4 | loss: 0.0857409
	speed: 0.0141s/iter; left time: 129.6614s
Epoch: 4 cost time: 8.367103815078735
Epoch: 4, Steps: 570 | Train Loss: 0.1117909 Vali Loss: 0.0338144 Test Loss: 0.1219159
Validation loss decreased (0.035138 --> 0.033814).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0635250
	speed: 0.0458s/iter; left time: 413.5856s
	iters: 200, epoch: 5 | loss: 0.0954800
	speed: 0.0142s/iter; left time: 126.8849s
	iters: 300, epoch: 5 | loss: 0.1351765
	speed: 0.0142s/iter; left time: 125.5477s
	iters: 400, epoch: 5 | loss: 0.0812712
	speed: 0.0142s/iter; left time: 123.7371s
	iters: 500, epoch: 5 | loss: 0.1414644
	speed: 0.0142s/iter; left time: 122.2643s
Epoch: 5 cost time: 8.390283107757568
Epoch: 5, Steps: 570 | Train Loss: 0.1011215 Vali Loss: 0.0340379 Test Loss: 0.1190188
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0849864
	speed: 0.0448s/iter; left time: 378.1857s
	iters: 200, epoch: 6 | loss: 0.1885727
	speed: 0.0142s/iter; left time: 118.6830s
	iters: 300, epoch: 6 | loss: 0.1309398
	speed: 0.0142s/iter; left time: 117.2459s
	iters: 400, epoch: 6 | loss: 0.1123931
	speed: 0.0142s/iter; left time: 115.8046s
	iters: 500, epoch: 6 | loss: 0.1085935
	speed: 0.0142s/iter; left time: 114.3205s
Epoch: 6 cost time: 8.372184991836548
Epoch: 6, Steps: 570 | Train Loss: 0.0960663 Vali Loss: 0.0343167 Test Loss: 0.1192324
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0779469
	speed: 0.0454s/iter; left time: 358.1882s
	iters: 200, epoch: 7 | loss: 0.1085906
	speed: 0.0141s/iter; left time: 109.6746s
	iters: 300, epoch: 7 | loss: 0.1448349
	speed: 0.0141s/iter; left time: 108.2957s
	iters: 400, epoch: 7 | loss: 0.1016075
	speed: 0.0141s/iter; left time: 106.8727s
	iters: 500, epoch: 7 | loss: 0.1249725
	speed: 0.0141s/iter; left time: 105.4604s
Epoch: 7 cost time: 8.315705299377441
Epoch: 7, Steps: 570 | Train Loss: 0.0930802 Vali Loss: 0.0337659 Test Loss: 0.1195417
Validation loss decreased (0.033814 --> 0.033766).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0693564
	speed: 0.0466s/iter; left time: 340.9616s
	iters: 200, epoch: 8 | loss: 0.0921130
	speed: 0.0141s/iter; left time: 101.5771s
	iters: 300, epoch: 8 | loss: 0.1297995
	speed: 0.0141s/iter; left time: 100.1396s
	iters: 400, epoch: 8 | loss: 0.0841560
	speed: 0.0141s/iter; left time: 98.7250s
	iters: 500, epoch: 8 | loss: 0.0785875
	speed: 0.0141s/iter; left time: 97.2739s
Epoch: 8 cost time: 8.320661306381226
Epoch: 8, Steps: 570 | Train Loss: 0.0912789 Vali Loss: 0.0337764 Test Loss: 0.1187815
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0664099
	speed: 0.0443s/iter; left time: 298.8838s
	iters: 200, epoch: 9 | loss: 0.0698422
	speed: 0.0141s/iter; left time: 93.6248s
	iters: 300, epoch: 9 | loss: 0.1077518
	speed: 0.0141s/iter; left time: 92.2427s
	iters: 400, epoch: 9 | loss: 0.0738081
	speed: 0.0141s/iter; left time: 90.7544s
	iters: 500, epoch: 9 | loss: 0.0965785
	speed: 0.0141s/iter; left time: 89.2752s
Epoch: 9 cost time: 8.310823678970337
Epoch: 9, Steps: 570 | Train Loss: 0.0905945 Vali Loss: 0.0334271 Test Loss: 0.1186896
Validation loss decreased (0.033766 --> 0.033427).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0897220
	speed: 0.0474s/iter; left time: 292.5438s
	iters: 200, epoch: 10 | loss: 0.0760594
	speed: 0.0142s/iter; left time: 86.2585s
	iters: 300, epoch: 10 | loss: 0.0688992
	speed: 0.0142s/iter; left time: 84.9328s
	iters: 400, epoch: 10 | loss: 0.0886419
	speed: 0.0142s/iter; left time: 83.2385s
	iters: 500, epoch: 10 | loss: 0.1032285
	speed: 0.0142s/iter; left time: 82.0852s
Epoch: 10 cost time: 8.403922319412231
Epoch: 10, Steps: 570 | Train Loss: 0.0903915 Vali Loss: 0.0335778 Test Loss: 0.1191557
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1231155
	speed: 0.0445s/iter; left time: 249.2350s
	iters: 200, epoch: 11 | loss: 0.1062441
	speed: 0.0142s/iter; left time: 77.9710s
	iters: 300, epoch: 11 | loss: 0.1210203
	speed: 0.0142s/iter; left time: 76.6527s
	iters: 400, epoch: 11 | loss: 0.0659267
	speed: 0.0141s/iter; left time: 74.9757s
	iters: 500, epoch: 11 | loss: 0.1484920
	speed: 0.0141s/iter; left time: 73.4964s
Epoch: 11 cost time: 8.336936235427856
Epoch: 11, Steps: 570 | Train Loss: 0.0897532 Vali Loss: 0.0335379 Test Loss: 0.1189523
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1068639
	speed: 0.0459s/iter; left time: 230.7298s
	iters: 200, epoch: 12 | loss: 0.1030701
	speed: 0.0142s/iter; left time: 70.1420s
	iters: 300, epoch: 12 | loss: 0.0816751
	speed: 0.0142s/iter; left time: 68.6424s
	iters: 400, epoch: 12 | loss: 0.1187332
	speed: 0.0142s/iter; left time: 67.1354s
	iters: 500, epoch: 12 | loss: 0.0863391
	speed: 0.0142s/iter; left time: 65.6552s
Epoch: 12 cost time: 8.392552137374878
Epoch: 12, Steps: 570 | Train Loss: 0.0907794 Vali Loss: 0.0335927 Test Loss: 0.1189671
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11880545318126678, mae:0.2078932821750641
>>> MS_Pen LR=5e-4 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1262358
	speed: 0.0257s/iter; left time: 290.3294s
	iters: 200, epoch: 1 | loss: 0.3052596
	speed: 0.0141s/iter; left time: 157.9866s
	iters: 300, epoch: 1 | loss: 0.2837691
	speed: 0.0141s/iter; left time: 156.2821s
	iters: 400, epoch: 1 | loss: 0.2278500
	speed: 0.0141s/iter; left time: 154.9632s
	iters: 500, epoch: 1 | loss: 0.2820081
	speed: 0.0141s/iter; left time: 153.5009s
Epoch: 1 cost time: 9.240724325180054
Epoch: 1, Steps: 570 | Train Loss: 0.2208503 Vali Loss: 0.0455834 Test Loss: 0.1388395
Validation loss decreased (inf --> 0.045583).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1781646
	speed: 0.0483s/iter; left time: 518.5257s
	iters: 200, epoch: 2 | loss: 0.1484874
	speed: 0.0142s/iter; left time: 150.5661s
	iters: 300, epoch: 2 | loss: 0.1049022
	speed: 0.0142s/iter; left time: 149.3612s
	iters: 400, epoch: 2 | loss: 0.1333395
	speed: 0.0142s/iter; left time: 147.9595s
	iters: 500, epoch: 2 | loss: 0.1803235
	speed: 0.0141s/iter; left time: 146.0826s
Epoch: 2 cost time: 8.373589038848877
Epoch: 2, Steps: 570 | Train Loss: 0.1773550 Vali Loss: 0.0429762 Test Loss: 0.1350695
Validation loss decreased (0.045583 --> 0.042976).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1405179
	speed: 0.0470s/iter; left time: 478.0646s
	iters: 200, epoch: 3 | loss: 0.1867667
	speed: 0.0143s/iter; left time: 143.3763s
	iters: 300, epoch: 3 | loss: 0.1315536
	speed: 0.0143s/iter; left time: 142.2420s
	iters: 400, epoch: 3 | loss: 0.1061085
	speed: 0.0142s/iter; left time: 140.4609s
	iters: 500, epoch: 3 | loss: 0.1400914
	speed: 0.0143s/iter; left time: 139.3459s
Epoch: 3 cost time: 8.435360431671143
Epoch: 3, Steps: 570 | Train Loss: 0.1342362 Vali Loss: 0.0394762 Test Loss: 0.1359091
Validation loss decreased (0.042976 --> 0.039476).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1330414
	speed: 0.0456s/iter; left time: 437.4335s
	iters: 200, epoch: 4 | loss: 0.0904911
	speed: 0.0143s/iter; left time: 135.9190s
	iters: 300, epoch: 4 | loss: 0.1143715
	speed: 0.0143s/iter; left time: 134.6624s
	iters: 400, epoch: 4 | loss: 0.0837031
	speed: 0.0143s/iter; left time: 132.9681s
	iters: 500, epoch: 4 | loss: 0.0945808
	speed: 0.0143s/iter; left time: 131.8507s
Epoch: 4 cost time: 8.444544553756714
Epoch: 4, Steps: 570 | Train Loss: 0.1107563 Vali Loss: 0.0377815 Test Loss: 0.1393421
Validation loss decreased (0.039476 --> 0.037781).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1084680
	speed: 0.0487s/iter; left time: 438.8978s
	iters: 200, epoch: 5 | loss: 0.1185181
	speed: 0.0141s/iter; left time: 126.0250s
	iters: 300, epoch: 5 | loss: 0.0968105
	speed: 0.0141s/iter; left time: 124.6659s
	iters: 400, epoch: 5 | loss: 0.1315966
	speed: 0.0141s/iter; left time: 122.8598s
	iters: 500, epoch: 5 | loss: 0.0709336
	speed: 0.0141s/iter; left time: 121.4198s
Epoch: 5 cost time: 8.339617729187012
Epoch: 5, Steps: 570 | Train Loss: 0.0989029 Vali Loss: 0.0379239 Test Loss: 0.1398018
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0868681
	speed: 0.0457s/iter; left time: 386.3342s
	iters: 200, epoch: 6 | loss: 0.0775118
	speed: 0.0158s/iter; left time: 132.2417s
	iters: 300, epoch: 6 | loss: 0.0708717
	speed: 0.0159s/iter; left time: 130.9379s
	iters: 400, epoch: 6 | loss: 0.1199894
	speed: 0.0159s/iter; left time: 129.2344s
	iters: 500, epoch: 6 | loss: 0.0959911
	speed: 0.0159s/iter; left time: 127.6712s
Epoch: 6 cost time: 9.227256536483765
Epoch: 6, Steps: 570 | Train Loss: 0.0932129 Vali Loss: 0.0381437 Test Loss: 0.1404066
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1263813
	speed: 0.0475s/iter; left time: 373.9948s
	iters: 200, epoch: 7 | loss: 0.0752283
	speed: 0.0142s/iter; left time: 110.6331s
	iters: 300, epoch: 7 | loss: 0.0646869
	speed: 0.0142s/iter; left time: 109.1108s
	iters: 400, epoch: 7 | loss: 0.1098015
	speed: 0.0142s/iter; left time: 107.7438s
	iters: 500, epoch: 7 | loss: 0.0868554
	speed: 0.0142s/iter; left time: 106.2961s
Epoch: 7 cost time: 8.366881608963013
Epoch: 7, Steps: 570 | Train Loss: 0.0912169 Vali Loss: 0.0381496 Test Loss: 0.1392259
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13947834074497223, mae:0.23649267852306366
>>> MS_Pen LR=5e-4 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2562885
	speed: 0.0296s/iter; left time: 334.3735s
	iters: 200, epoch: 1 | loss: 0.1999886
	speed: 0.0170s/iter; left time: 190.1066s
	iters: 300, epoch: 1 | loss: 0.2178953
	speed: 0.0170s/iter; left time: 188.2573s
	iters: 400, epoch: 1 | loss: 0.2215199
	speed: 0.0169s/iter; left time: 186.4431s
	iters: 500, epoch: 1 | loss: 0.1462029
	speed: 0.0169s/iter; left time: 184.2867s
Epoch: 1 cost time: 10.978292465209961
Epoch: 1, Steps: 570 | Train Loss: 0.2306546 Vali Loss: 0.0499918 Test Loss: 0.1537168
Validation loss decreased (inf --> 0.049992).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2487415
	speed: 0.0510s/iter; left time: 547.4974s
	iters: 200, epoch: 2 | loss: 0.2860377
	speed: 0.0169s/iter; left time: 179.9959s
	iters: 300, epoch: 2 | loss: 0.2509544
	speed: 0.0169s/iter; left time: 178.3917s
	iters: 400, epoch: 2 | loss: 0.1937617
	speed: 0.0169s/iter; left time: 176.5087s
	iters: 500, epoch: 2 | loss: 0.1791643
	speed: 0.0169s/iter; left time: 174.6965s
Epoch: 2 cost time: 9.962087154388428
Epoch: 2, Steps: 570 | Train Loss: 0.2359557 Vali Loss: 0.0492589 Test Loss: 0.1544130
Validation loss decreased (0.049992 --> 0.049259).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1909641
	speed: 0.0539s/iter; left time: 547.8031s
	iters: 200, epoch: 3 | loss: 0.1594013
	speed: 0.0168s/iter; left time: 169.4942s
	iters: 300, epoch: 3 | loss: 0.3745329
	speed: 0.0168s/iter; left time: 167.6805s
	iters: 400, epoch: 3 | loss: 0.1596382
	speed: 0.0168s/iter; left time: 165.8780s
	iters: 500, epoch: 3 | loss: 0.1671783
	speed: 0.0169s/iter; left time: 164.5946s
Epoch: 3 cost time: 9.909314632415771
Epoch: 3, Steps: 570 | Train Loss: 0.2094819 Vali Loss: 0.0489972 Test Loss: 0.1506076
Validation loss decreased (0.049259 --> 0.048997).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1590091
	speed: 0.0522s/iter; left time: 500.9319s
	iters: 200, epoch: 4 | loss: 0.1913332
	speed: 0.0169s/iter; left time: 160.4856s
	iters: 300, epoch: 4 | loss: 0.1503056
	speed: 0.0169s/iter; left time: 158.6823s
	iters: 400, epoch: 4 | loss: 0.2072351
	speed: 0.0169s/iter; left time: 156.9247s
	iters: 500, epoch: 4 | loss: 0.1919286
	speed: 0.0169s/iter; left time: 155.2608s
Epoch: 4 cost time: 9.939064264297485
Epoch: 4, Steps: 570 | Train Loss: 0.1853137 Vali Loss: 0.0476918 Test Loss: 0.1443161
Validation loss decreased (0.048997 --> 0.047692).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1001527
	speed: 0.0516s/iter; left time: 465.8073s
	iters: 200, epoch: 5 | loss: 0.2172483
	speed: 0.0169s/iter; left time: 150.4876s
	iters: 300, epoch: 5 | loss: 0.1668036
	speed: 0.0168s/iter; left time: 148.4598s
	iters: 400, epoch: 5 | loss: 0.2579871
	speed: 0.0169s/iter; left time: 147.1961s
	iters: 500, epoch: 5 | loss: 0.1033229
	speed: 0.0169s/iter; left time: 145.6275s
Epoch: 5 cost time: 9.944936513900757
Epoch: 5, Steps: 570 | Train Loss: 0.1734291 Vali Loss: 0.0451484 Test Loss: 0.1419821
Validation loss decreased (0.047692 --> 0.045148).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2174402
	speed: 0.0523s/iter; left time: 441.6511s
	iters: 200, epoch: 6 | loss: 0.1344675
	speed: 0.0169s/iter; left time: 141.1780s
	iters: 300, epoch: 6 | loss: 0.1813942
	speed: 0.0169s/iter; left time: 139.3613s
	iters: 400, epoch: 6 | loss: 0.1867656
	speed: 0.0168s/iter; left time: 137.3176s
	iters: 500, epoch: 6 | loss: 0.1348611
	speed: 0.0168s/iter; left time: 135.6554s
Epoch: 6 cost time: 9.920757293701172
Epoch: 6, Steps: 570 | Train Loss: 0.1641597 Vali Loss: 0.0438768 Test Loss: 0.1370953
Validation loss decreased (0.045148 --> 0.043877).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1514617
	speed: 0.0508s/iter; left time: 400.3311s
	iters: 200, epoch: 7 | loss: 0.2051070
	speed: 0.0168s/iter; left time: 131.0245s
	iters: 300, epoch: 7 | loss: 0.1697452
	speed: 0.0168s/iter; left time: 129.2903s
	iters: 400, epoch: 7 | loss: 0.1020646
	speed: 0.0168s/iter; left time: 127.6165s
	iters: 500, epoch: 7 | loss: 0.1149909
	speed: 0.0168s/iter; left time: 125.9949s
Epoch: 7 cost time: 9.905943870544434
Epoch: 7, Steps: 570 | Train Loss: 0.1597520 Vali Loss: 0.0433162 Test Loss: 0.1379599
Validation loss decreased (0.043877 --> 0.043316).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1672084
	speed: 0.0512s/iter; left time: 374.0100s
	iters: 200, epoch: 8 | loss: 0.1151245
	speed: 0.0169s/iter; left time: 121.5669s
	iters: 300, epoch: 8 | loss: 0.1556597
	speed: 0.0168s/iter; left time: 119.8191s
	iters: 400, epoch: 8 | loss: 0.0861644
	speed: 0.0169s/iter; left time: 118.1935s
	iters: 500, epoch: 8 | loss: 0.1124317
	speed: 0.0169s/iter; left time: 116.4728s
Epoch: 8 cost time: 9.943892478942871
Epoch: 8, Steps: 570 | Train Loss: 0.1567460 Vali Loss: 0.0428972 Test Loss: 0.1368085
Validation loss decreased (0.043316 --> 0.042897).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1375666
	speed: 0.0507s/iter; left time: 342.0157s
	iters: 200, epoch: 9 | loss: 0.1103541
	speed: 0.0168s/iter; left time: 111.5936s
	iters: 300, epoch: 9 | loss: 0.1789295
	speed: 0.0168s/iter; left time: 110.0536s
	iters: 400, epoch: 9 | loss: 0.1701317
	speed: 0.0168s/iter; left time: 108.5205s
	iters: 500, epoch: 9 | loss: 0.2013765
	speed: 0.0168s/iter; left time: 106.8308s
Epoch: 9 cost time: 9.898343563079834
Epoch: 9, Steps: 570 | Train Loss: 0.1552437 Vali Loss: 0.0426951 Test Loss: 0.1367020
Validation loss decreased (0.042897 --> 0.042695).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1670513
	speed: 0.0530s/iter; left time: 327.1142s
	iters: 200, epoch: 10 | loss: 0.0831012
	speed: 0.0169s/iter; left time: 102.5977s
	iters: 300, epoch: 10 | loss: 0.2363621
	speed: 0.0169s/iter; left time: 100.8889s
	iters: 400, epoch: 10 | loss: 0.1905236
	speed: 0.0169s/iter; left time: 99.4144s
	iters: 500, epoch: 10 | loss: 0.1434901
	speed: 0.0169s/iter; left time: 97.6350s
Epoch: 10 cost time: 9.94981837272644
Epoch: 10, Steps: 570 | Train Loss: 0.1543273 Vali Loss: 0.0429060 Test Loss: 0.1368421
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1192393
	speed: 0.0513s/iter; left time: 287.4510s
	iters: 200, epoch: 11 | loss: 0.1963890
	speed: 0.0182s/iter; left time: 100.1671s
	iters: 300, epoch: 11 | loss: 0.0915652
	speed: 0.0169s/iter; left time: 91.0112s
	iters: 400, epoch: 11 | loss: 0.1504435
	speed: 0.0169s/iter; left time: 89.3447s
	iters: 500, epoch: 11 | loss: 0.2332828
	speed: 0.0168s/iter; left time: 87.6337s
Epoch: 11 cost time: 10.142258405685425
Epoch: 11, Steps: 570 | Train Loss: 0.1547502 Vali Loss: 0.0427966 Test Loss: 0.1365099
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1983661
	speed: 0.0523s/iter; left time: 263.3505s
	iters: 200, epoch: 12 | loss: 0.1280299
	speed: 0.0169s/iter; left time: 83.2276s
	iters: 300, epoch: 12 | loss: 0.1277806
	speed: 0.0169s/iter; left time: 81.5354s
	iters: 400, epoch: 12 | loss: 0.1760537
	speed: 0.0169s/iter; left time: 79.8419s
	iters: 500, epoch: 12 | loss: 0.1929389
	speed: 0.0169s/iter; left time: 78.1407s
Epoch: 12 cost time: 9.967494249343872
Epoch: 12, Steps: 570 | Train Loss: 0.1545724 Vali Loss: 0.0425783 Test Loss: 0.1364063
Validation loss decreased (0.042695 --> 0.042578).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1829791
	speed: 0.0518s/iter; left time: 230.8884s
	iters: 200, epoch: 13 | loss: 0.2406721
	speed: 0.0170s/iter; left time: 73.9998s
	iters: 300, epoch: 13 | loss: 0.1596263
	speed: 0.0170s/iter; left time: 72.2314s
	iters: 400, epoch: 13 | loss: 0.1279479
	speed: 0.0170s/iter; left time: 70.6446s
	iters: 500, epoch: 13 | loss: 0.1061835
	speed: 0.0170s/iter; left time: 68.9128s
Epoch: 13 cost time: 9.975510120391846
Epoch: 13, Steps: 570 | Train Loss: 0.1548395 Vali Loss: 0.0425837 Test Loss: 0.1365085
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1473607
	speed: 0.0503s/iter; left time: 195.9098s
	iters: 200, epoch: 14 | loss: 0.1435989
	speed: 0.0169s/iter; left time: 64.2329s
	iters: 300, epoch: 14 | loss: 0.2030353
	speed: 0.0169s/iter; left time: 62.4380s
	iters: 400, epoch: 14 | loss: 0.1010013
	speed: 0.0169s/iter; left time: 60.7449s
	iters: 500, epoch: 14 | loss: 0.1094578
	speed: 0.0169s/iter; left time: 59.0760s
Epoch: 14 cost time: 9.945915460586548
Epoch: 14, Steps: 570 | Train Loss: 0.1542007 Vali Loss: 0.0427211 Test Loss: 0.1365219
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1652803
	speed: 0.0507s/iter; left time: 168.3265s
	iters: 200, epoch: 15 | loss: 0.1988715
	speed: 0.0169s/iter; left time: 54.3386s
	iters: 300, epoch: 15 | loss: 0.1490705
	speed: 0.0169s/iter; left time: 52.6546s
	iters: 400, epoch: 15 | loss: 0.1543137
	speed: 0.0169s/iter; left time: 50.9666s
	iters: 500, epoch: 15 | loss: 0.1526097
	speed: 0.0169s/iter; left time: 49.2915s
Epoch: 15 cost time: 9.924399614334106
Epoch: 15, Steps: 570 | Train Loss: 0.1539528 Vali Loss: 0.0426998 Test Loss: 0.1364961
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1365976184606552, mae:0.23430542647838593
>>> MS_Pen LR=5e-4 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1635055
	speed: 0.0297s/iter; left time: 335.4418s
	iters: 200, epoch: 1 | loss: 0.1377138
	speed: 0.0163s/iter; left time: 183.0259s
	iters: 300, epoch: 1 | loss: 0.2287486
	speed: 0.0163s/iter; left time: 181.0922s
	iters: 400, epoch: 1 | loss: 0.1835250
	speed: 0.0163s/iter; left time: 179.7226s
	iters: 500, epoch: 1 | loss: 0.1059270
	speed: 0.0163s/iter; left time: 177.4449s
Epoch: 1 cost time: 10.691593408584595
Epoch: 1, Steps: 570 | Train Loss: 0.2113323 Vali Loss: 0.0414901 Test Loss: 0.1342340
Validation loss decreased (inf --> 0.041490).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1726234
	speed: 0.0512s/iter; left time: 549.0473s
	iters: 200, epoch: 2 | loss: 0.1600526
	speed: 0.0164s/iter; left time: 174.1167s
	iters: 300, epoch: 2 | loss: 0.2723853
	speed: 0.0180s/iter; left time: 189.2742s
	iters: 400, epoch: 2 | loss: 0.3937339
	speed: 0.0180s/iter; left time: 188.0386s
	iters: 500, epoch: 2 | loss: 0.2703087
	speed: 0.0180s/iter; left time: 185.6207s
Epoch: 2 cost time: 10.254552364349365
Epoch: 2, Steps: 570 | Train Loss: 0.2154581 Vali Loss: 0.0644397 Test Loss: 0.1966757
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2193349
	speed: 0.0521s/iter; left time: 529.4855s
	iters: 200, epoch: 3 | loss: 0.2423710
	speed: 0.0179s/iter; left time: 180.5229s
	iters: 300, epoch: 3 | loss: 0.1603047
	speed: 0.0179s/iter; left time: 178.5121s
	iters: 400, epoch: 3 | loss: 0.2085722
	speed: 0.0179s/iter; left time: 176.7736s
	iters: 500, epoch: 3 | loss: 0.1149289
	speed: 0.0179s/iter; left time: 174.9404s
Epoch: 3 cost time: 10.506766557693481
Epoch: 3, Steps: 570 | Train Loss: 0.2003764 Vali Loss: 0.0432208 Test Loss: 0.1348211
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1420075
	speed: 0.0527s/iter; left time: 505.0824s
	iters: 200, epoch: 4 | loss: 0.2985248
	speed: 0.0175s/iter; left time: 166.0588s
	iters: 300, epoch: 4 | loss: 0.1284677
	speed: 0.0164s/iter; left time: 153.7386s
	iters: 400, epoch: 4 | loss: 0.1100594
	speed: 0.0163s/iter; left time: 151.6851s
	iters: 500, epoch: 4 | loss: 0.1752628
	speed: 0.0163s/iter; left time: 149.8551s
Epoch: 4 cost time: 9.869539976119995
Epoch: 4, Steps: 570 | Train Loss: 0.1726029 Vali Loss: 0.0408546 Test Loss: 0.1297677
Validation loss decreased (0.041490 --> 0.040855).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1682526
	speed: 0.0511s/iter; left time: 461.1173s
	iters: 200, epoch: 5 | loss: 0.2332133
	speed: 0.0163s/iter; left time: 145.8299s
	iters: 300, epoch: 5 | loss: 0.1538165
	speed: 0.0163s/iter; left time: 144.1065s
	iters: 400, epoch: 5 | loss: 0.1137983
	speed: 0.0163s/iter; left time: 142.5168s
	iters: 500, epoch: 5 | loss: 0.1889024
	speed: 0.0164s/iter; left time: 141.1655s
Epoch: 5 cost time: 9.672305345535278
Epoch: 5, Steps: 570 | Train Loss: 0.1579797 Vali Loss: 0.0367540 Test Loss: 0.1203643
Validation loss decreased (0.040855 --> 0.036754).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1510216
	speed: 0.0510s/iter; left time: 431.1356s
	iters: 200, epoch: 6 | loss: 0.2106880
	speed: 0.0163s/iter; left time: 136.1108s
	iters: 300, epoch: 6 | loss: 0.2450802
	speed: 0.0163s/iter; left time: 134.7206s
	iters: 400, epoch: 6 | loss: 0.1492630
	speed: 0.0163s/iter; left time: 133.0438s
	iters: 500, epoch: 6 | loss: 0.1436837
	speed: 0.0163s/iter; left time: 131.2945s
Epoch: 6 cost time: 9.628353834152222
Epoch: 6, Steps: 570 | Train Loss: 0.1503983 Vali Loss: 0.0366048 Test Loss: 0.1196453
Validation loss decreased (0.036754 --> 0.036605).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1849302
	speed: 0.0539s/iter; left time: 424.4946s
	iters: 200, epoch: 7 | loss: 0.0830442
	speed: 0.0181s/iter; left time: 140.8088s
	iters: 300, epoch: 7 | loss: 0.1224792
	speed: 0.0181s/iter; left time: 139.0882s
	iters: 400, epoch: 7 | loss: 0.1888541
	speed: 0.0181s/iter; left time: 137.1839s
	iters: 500, epoch: 7 | loss: 0.1725953
	speed: 0.0181s/iter; left time: 135.4297s
Epoch: 7 cost time: 10.626646757125854
Epoch: 7, Steps: 570 | Train Loss: 0.1461499 Vali Loss: 0.0361568 Test Loss: 0.1182407
Validation loss decreased (0.036605 --> 0.036157).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0975851
	speed: 0.0558s/iter; left time: 407.9182s
	iters: 200, epoch: 8 | loss: 0.1858658
	speed: 0.0179s/iter; left time: 128.7174s
	iters: 300, epoch: 8 | loss: 0.1592098
	speed: 0.0163s/iter; left time: 115.9064s
	iters: 400, epoch: 8 | loss: 0.1738347
	speed: 0.0163s/iter; left time: 114.1627s
	iters: 500, epoch: 8 | loss: 0.1326608
	speed: 0.0163s/iter; left time: 112.6260s
Epoch: 8 cost time: 9.92659330368042
Epoch: 8, Steps: 570 | Train Loss: 0.1439289 Vali Loss: 0.0357472 Test Loss: 0.1182276
Validation loss decreased (0.036157 --> 0.035747).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0801712
	speed: 0.0499s/iter; left time: 336.6222s
	iters: 200, epoch: 9 | loss: 0.1134875
	speed: 0.0163s/iter; left time: 108.3611s
	iters: 300, epoch: 9 | loss: 0.0855721
	speed: 0.0163s/iter; left time: 106.7882s
	iters: 400, epoch: 9 | loss: 0.0959512
	speed: 0.0163s/iter; left time: 105.0979s
	iters: 500, epoch: 9 | loss: 0.0782954
	speed: 0.0163s/iter; left time: 103.4853s
Epoch: 9 cost time: 9.627194881439209
Epoch: 9, Steps: 570 | Train Loss: 0.1434883 Vali Loss: 0.0356502 Test Loss: 0.1188664
Validation loss decreased (0.035747 --> 0.035650).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1504599
	speed: 0.0511s/iter; left time: 315.0976s
	iters: 200, epoch: 10 | loss: 0.1638319
	speed: 0.0163s/iter; left time: 99.1079s
	iters: 300, epoch: 10 | loss: 0.0880088
	speed: 0.0163s/iter; left time: 97.4602s
	iters: 400, epoch: 10 | loss: 0.1671048
	speed: 0.0165s/iter; left time: 96.9452s
	iters: 500, epoch: 10 | loss: 0.1319819
	speed: 0.0179s/iter; left time: 103.5243s
Epoch: 10 cost time: 9.941893339157104
Epoch: 10, Steps: 570 | Train Loss: 0.1417513 Vali Loss: 0.0357077 Test Loss: 0.1182553
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1063970
	speed: 0.0528s/iter; left time: 295.5297s
	iters: 200, epoch: 11 | loss: 0.1135974
	speed: 0.0180s/iter; left time: 99.0827s
	iters: 300, epoch: 11 | loss: 0.1170179
	speed: 0.0166s/iter; left time: 89.4162s
	iters: 400, epoch: 11 | loss: 0.1476856
	speed: 0.0164s/iter; left time: 86.7672s
	iters: 500, epoch: 11 | loss: 0.1181896
	speed: 0.0164s/iter; left time: 85.1236s
Epoch: 11 cost time: 9.966870784759521
Epoch: 11, Steps: 570 | Train Loss: 0.1409132 Vali Loss: 0.0357656 Test Loss: 0.1182915
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0962696
	speed: 0.0539s/iter; left time: 271.3130s
	iters: 200, epoch: 12 | loss: 0.1642889
	speed: 0.0179s/iter; left time: 88.0186s
	iters: 300, epoch: 12 | loss: 0.0886505
	speed: 0.0178s/iter; left time: 86.0823s
	iters: 400, epoch: 12 | loss: 0.1316462
	speed: 0.0178s/iter; left time: 84.3788s
	iters: 500, epoch: 12 | loss: 0.1873399
	speed: 0.0178s/iter; left time: 82.4611s
Epoch: 12 cost time: 10.49053430557251
Epoch: 12, Steps: 570 | Train Loss: 0.1413330 Vali Loss: 0.0357084 Test Loss: 0.1183375
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11904513835906982, mae:0.21326716244220734
>>> MS_Pen LR=5e-4 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2299943
	speed: 0.0292s/iter; left time: 329.9926s
	iters: 200, epoch: 1 | loss: 0.2224860
	speed: 0.0170s/iter; left time: 190.2509s
	iters: 300, epoch: 1 | loss: 0.1603474
	speed: 0.0170s/iter; left time: 188.3368s
	iters: 400, epoch: 1 | loss: 0.2565828
	speed: 0.0170s/iter; left time: 187.2273s
	iters: 500, epoch: 1 | loss: 0.3277534
	speed: 0.0170s/iter; left time: 185.2345s
Epoch: 1 cost time: 10.957746982574463
Epoch: 1, Steps: 570 | Train Loss: 0.2339126 Vali Loss: 0.0465752 Test Loss: 0.1628878
Validation loss decreased (inf --> 0.046575).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2317100
	speed: 0.0496s/iter; left time: 532.6478s
	iters: 200, epoch: 2 | loss: 0.1455019
	speed: 0.0154s/iter; left time: 164.2182s
	iters: 300, epoch: 2 | loss: 0.2874202
	speed: 0.0154s/iter; left time: 162.6260s
	iters: 400, epoch: 2 | loss: 0.2692606
	speed: 0.0155s/iter; left time: 161.2943s
	iters: 500, epoch: 2 | loss: 0.3379374
	speed: 0.0154s/iter; left time: 159.5899s
Epoch: 2 cost time: 9.113789558410645
Epoch: 2, Steps: 570 | Train Loss: 0.2387242 Vali Loss: 0.0539253 Test Loss: 0.1673031
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2131916
	speed: 0.0492s/iter; left time: 500.0123s
	iters: 200, epoch: 3 | loss: 0.1237076
	speed: 0.0177s/iter; left time: 177.8760s
	iters: 300, epoch: 3 | loss: 0.2660509
	speed: 0.0177s/iter; left time: 175.9944s
	iters: 400, epoch: 3 | loss: 0.2030985
	speed: 0.0177s/iter; left time: 174.2858s
	iters: 500, epoch: 3 | loss: 0.2317648
	speed: 0.0177s/iter; left time: 172.4938s
Epoch: 3 cost time: 10.162584781646729
Epoch: 3, Steps: 570 | Train Loss: 0.2216332 Vali Loss: 0.0504921 Test Loss: 0.1477336
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1985333
	speed: 0.0522s/iter; left time: 500.8080s
	iters: 200, epoch: 4 | loss: 0.2296147
	speed: 0.0177s/iter; left time: 168.4184s
	iters: 300, epoch: 4 | loss: 0.2158682
	speed: 0.0177s/iter; left time: 166.5078s
	iters: 400, epoch: 4 | loss: 0.1640738
	speed: 0.0177s/iter; left time: 164.6798s
	iters: 500, epoch: 4 | loss: 0.2022274
	speed: 0.0177s/iter; left time: 162.7737s
Epoch: 4 cost time: 10.389800548553467
Epoch: 4, Steps: 570 | Train Loss: 0.1951655 Vali Loss: 0.0501635 Test Loss: 0.1479105
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16309019923210144, mae:0.2616065442562103
>>> MS_Pen LR=5e-4 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1532570
	speed: 0.0308s/iter; left time: 348.0975s
	iters: 200, epoch: 1 | loss: 0.2265971
	speed: 0.0188s/iter; left time: 210.3920s
	iters: 300, epoch: 1 | loss: 0.3177215
	speed: 0.0188s/iter; left time: 208.3290s
	iters: 400, epoch: 1 | loss: 0.1728040
	speed: 0.0188s/iter; left time: 206.7128s
	iters: 500, epoch: 1 | loss: 0.1894635
	speed: 0.0188s/iter; left time: 205.1044s
Epoch: 1 cost time: 11.96604585647583
Epoch: 1, Steps: 570 | Train Loss: 0.2173269 Vali Loss: 0.0437477 Test Loss: 0.1325592
Validation loss decreased (inf --> 0.043748).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2894065
	speed: 0.0604s/iter; left time: 648.4611s
	iters: 200, epoch: 2 | loss: 0.1775541
	speed: 0.0210s/iter; left time: 223.0393s
	iters: 300, epoch: 2 | loss: 0.1109165
	speed: 0.0210s/iter; left time: 220.8167s
	iters: 400, epoch: 2 | loss: 0.1416571
	speed: 0.0209s/iter; left time: 218.3804s
	iters: 500, epoch: 2 | loss: 0.1338175
	speed: 0.0210s/iter; left time: 216.5591s
Epoch: 2 cost time: 12.256749868392944
Epoch: 2, Steps: 570 | Train Loss: 0.1761169 Vali Loss: 0.0409790 Test Loss: 0.1345205
Validation loss decreased (0.043748 --> 0.040979).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1080253
	speed: 0.0583s/iter; left time: 592.0056s
	iters: 200, epoch: 3 | loss: 0.1189484
	speed: 0.0187s/iter; left time: 188.1999s
	iters: 300, epoch: 3 | loss: 0.1430299
	speed: 0.0187s/iter; left time: 186.0384s
	iters: 400, epoch: 3 | loss: 0.1042053
	speed: 0.0187s/iter; left time: 183.9477s
	iters: 500, epoch: 3 | loss: 0.0882287
	speed: 0.0186s/iter; left time: 182.0393s
Epoch: 3 cost time: 10.974108219146729
Epoch: 3, Steps: 570 | Train Loss: 0.1368126 Vali Loss: 0.0349225 Test Loss: 0.1256399
Validation loss decreased (0.040979 --> 0.034922).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1281743
	speed: 0.0567s/iter; left time: 544.2175s
	iters: 200, epoch: 4 | loss: 0.1678431
	speed: 0.0187s/iter; left time: 177.2552s
	iters: 300, epoch: 4 | loss: 0.1245202
	speed: 0.0187s/iter; left time: 175.5177s
	iters: 400, epoch: 4 | loss: 0.0799242
	speed: 0.0186s/iter; left time: 173.2043s
	iters: 500, epoch: 4 | loss: 0.1142153
	speed: 0.0187s/iter; left time: 171.7266s
Epoch: 4 cost time: 10.940730571746826
Epoch: 4, Steps: 570 | Train Loss: 0.1126114 Vali Loss: 0.0374333 Test Loss: 0.1263768
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1133432
	speed: 0.0578s/iter; left time: 521.3230s
	iters: 200, epoch: 5 | loss: 0.1120454
	speed: 0.0186s/iter; left time: 166.3462s
	iters: 300, epoch: 5 | loss: 0.0955704
	speed: 0.0188s/iter; left time: 166.1710s
	iters: 400, epoch: 5 | loss: 0.0948473
	speed: 0.0187s/iter; left time: 162.8086s
	iters: 500, epoch: 5 | loss: 0.0890910
	speed: 0.0187s/iter; left time: 160.9232s
Epoch: 5 cost time: 11.005793571472168
Epoch: 5, Steps: 570 | Train Loss: 0.0996172 Vali Loss: 0.0351066 Test Loss: 0.1271248
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0636978
	speed: 0.0562s/iter; left time: 475.1953s
	iters: 200, epoch: 6 | loss: 0.1031560
	speed: 0.0185s/iter; left time: 154.3929s
	iters: 300, epoch: 6 | loss: 0.0830076
	speed: 0.0185s/iter; left time: 152.4550s
	iters: 400, epoch: 6 | loss: 0.1452225
	speed: 0.0185s/iter; left time: 150.5737s
	iters: 500, epoch: 6 | loss: 0.0768281
	speed: 0.0185s/iter; left time: 148.7600s
Epoch: 6 cost time: 10.799565315246582
Epoch: 6, Steps: 570 | Train Loss: 0.0942830 Vali Loss: 0.0356903 Test Loss: 0.1262043
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12578921020030975, mae:0.22166401147842407
>>> MS_Pen LR=5e-4 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3830855
	speed: 0.0296s/iter; left time: 334.7826s
	iters: 200, epoch: 1 | loss: 0.2228431
	speed: 0.0182s/iter; left time: 204.0992s
	iters: 300, epoch: 1 | loss: 0.1452855
	speed: 0.0182s/iter; left time: 202.0620s
	iters: 400, epoch: 1 | loss: 0.1574603
	speed: 0.0182s/iter; left time: 200.5821s
	iters: 500, epoch: 1 | loss: 0.2414622
	speed: 0.0182s/iter; left time: 198.8156s
Epoch: 1 cost time: 11.580088138580322
Epoch: 1, Steps: 570 | Train Loss: 0.1918325 Vali Loss: 0.0416686 Test Loss: 0.1333832
Validation loss decreased (inf --> 0.041669).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1402841
	speed: 0.0563s/iter; left time: 603.6194s
	iters: 200, epoch: 2 | loss: 0.2068255
	speed: 0.0182s/iter; left time: 193.7934s
	iters: 300, epoch: 2 | loss: 0.2124756
	speed: 0.0182s/iter; left time: 191.2091s
	iters: 400, epoch: 2 | loss: 0.1542139
	speed: 0.0182s/iter; left time: 189.7159s
	iters: 500, epoch: 2 | loss: 0.1366488
	speed: 0.0182s/iter; left time: 188.2809s
Epoch: 2 cost time: 10.659221410751343
Epoch: 2, Steps: 570 | Train Loss: 0.1635477 Vali Loss: 0.0400856 Test Loss: 0.1231066
Validation loss decreased (0.041669 --> 0.040086).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1043536
	speed: 0.0559s/iter; left time: 567.9723s
	iters: 200, epoch: 3 | loss: 0.1278084
	speed: 0.0182s/iter; left time: 182.6537s
	iters: 300, epoch: 3 | loss: 0.1410769
	speed: 0.0181s/iter; left time: 180.0119s
	iters: 400, epoch: 3 | loss: 0.1086669
	speed: 0.0181s/iter; left time: 178.1892s
	iters: 500, epoch: 3 | loss: 0.1024983
	speed: 0.0181s/iter; left time: 177.1222s
Epoch: 3 cost time: 10.603240013122559
Epoch: 3, Steps: 570 | Train Loss: 0.1330536 Vali Loss: 0.0368662 Test Loss: 0.1206170
Validation loss decreased (0.040086 --> 0.036866).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1330099
	speed: 0.0548s/iter; left time: 525.5223s
	iters: 200, epoch: 4 | loss: 0.0643254
	speed: 0.0181s/iter; left time: 171.8747s
	iters: 300, epoch: 4 | loss: 0.1486749
	speed: 0.0181s/iter; left time: 170.0288s
	iters: 400, epoch: 4 | loss: 0.1353314
	speed: 0.0181s/iter; left time: 168.0502s
	iters: 500, epoch: 4 | loss: 0.0816890
	speed: 0.0181s/iter; left time: 166.2075s
Epoch: 4 cost time: 10.586172819137573
Epoch: 4, Steps: 570 | Train Loss: 0.1125558 Vali Loss: 0.0345794 Test Loss: 0.1227276
Validation loss decreased (0.036866 --> 0.034579).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0880765
	speed: 0.0555s/iter; left time: 500.9803s
	iters: 200, epoch: 5 | loss: 0.1017824
	speed: 0.0182s/iter; left time: 162.2521s
	iters: 300, epoch: 5 | loss: 0.1055592
	speed: 0.0182s/iter; left time: 160.7146s
	iters: 400, epoch: 5 | loss: 0.0742135
	speed: 0.0182s/iter; left time: 158.7781s
	iters: 500, epoch: 5 | loss: 0.1023689
	speed: 0.0182s/iter; left time: 156.9123s
Epoch: 5 cost time: 10.721707820892334
Epoch: 5, Steps: 570 | Train Loss: 0.1005946 Vali Loss: 0.0345119 Test Loss: 0.1206408
Validation loss decreased (0.034579 --> 0.034512).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1125115
	speed: 0.0554s/iter; left time: 467.8238s
	iters: 200, epoch: 6 | loss: 0.0755194
	speed: 0.0184s/iter; left time: 153.3226s
	iters: 300, epoch: 6 | loss: 0.1145561
	speed: 0.0184s/iter; left time: 151.4125s
	iters: 400, epoch: 6 | loss: 0.0677967
	speed: 0.0183s/iter; left time: 149.2292s
	iters: 500, epoch: 6 | loss: 0.0647476
	speed: 0.0183s/iter; left time: 147.1954s
Epoch: 6 cost time: 10.7174711227417
Epoch: 6, Steps: 570 | Train Loss: 0.0947959 Vali Loss: 0.0341295 Test Loss: 0.1210362
Validation loss decreased (0.034512 --> 0.034129).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0847274
	speed: 0.0548s/iter; left time: 432.0867s
	iters: 200, epoch: 7 | loss: 0.1218980
	speed: 0.0181s/iter; left time: 140.7427s
	iters: 300, epoch: 7 | loss: 0.0753438
	speed: 0.0181s/iter; left time: 139.0144s
	iters: 400, epoch: 7 | loss: 0.1062237
	speed: 0.0181s/iter; left time: 137.1170s
	iters: 500, epoch: 7 | loss: 0.0829967
	speed: 0.0182s/iter; left time: 135.9335s
Epoch: 7 cost time: 10.607022285461426
Epoch: 7, Steps: 570 | Train Loss: 0.0914435 Vali Loss: 0.0337120 Test Loss: 0.1212828
Validation loss decreased (0.034129 --> 0.033712).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0724555
	speed: 0.0559s/iter; left time: 408.4223s
	iters: 200, epoch: 8 | loss: 0.0793349
	speed: 0.0182s/iter; left time: 131.5239s
	iters: 300, epoch: 8 | loss: 0.0881540
	speed: 0.0182s/iter; left time: 129.4782s
	iters: 400, epoch: 8 | loss: 0.0907332
	speed: 0.0192s/iter; left time: 134.4272s
	iters: 500, epoch: 8 | loss: 0.1045420
	speed: 0.0182s/iter; left time: 125.7000s
Epoch: 8 cost time: 10.766557693481445
Epoch: 8, Steps: 570 | Train Loss: 0.0888474 Vali Loss: 0.0337658 Test Loss: 0.1221761
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0605553
	speed: 0.0539s/iter; left time: 363.6121s
	iters: 200, epoch: 9 | loss: 0.0812691
	speed: 0.0180s/iter; left time: 119.6084s
	iters: 300, epoch: 9 | loss: 0.0905671
	speed: 0.0180s/iter; left time: 117.9554s
	iters: 400, epoch: 9 | loss: 0.0873388
	speed: 0.0180s/iter; left time: 116.1916s
	iters: 500, epoch: 9 | loss: 0.0795553
	speed: 0.0181s/iter; left time: 114.6469s
Epoch: 9 cost time: 10.56303858757019
Epoch: 9, Steps: 570 | Train Loss: 0.0888361 Vali Loss: 0.0337348 Test Loss: 0.1218218
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0774932
	speed: 0.0578s/iter; left time: 356.4542s
	iters: 200, epoch: 10 | loss: 0.0674662
	speed: 0.0185s/iter; left time: 112.4941s
	iters: 300, epoch: 10 | loss: 0.1176134
	speed: 0.0193s/iter; left time: 115.2838s
	iters: 400, epoch: 10 | loss: 0.0989943
	speed: 0.0181s/iter; left time: 106.2035s
	iters: 500, epoch: 10 | loss: 0.0706603
	speed: 0.0181s/iter; left time: 104.5055s
Epoch: 10 cost time: 10.782687664031982
Epoch: 10, Steps: 570 | Train Loss: 0.0887637 Vali Loss: 0.0337477 Test Loss: 0.1220895
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12139859050512314, mae:0.21001847088336945
>>> MS_Pen LR=5e-4 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2798200
	speed: 0.0324s/iter; left time: 366.5095s
	iters: 200, epoch: 1 | loss: 0.1778488
	speed: 0.0206s/iter; left time: 231.0297s
	iters: 300, epoch: 1 | loss: 0.2487421
	speed: 0.0207s/iter; left time: 229.4719s
	iters: 400, epoch: 1 | loss: 0.2325132
	speed: 0.0206s/iter; left time: 226.5206s
	iters: 500, epoch: 1 | loss: 0.2609662
	speed: 0.0206s/iter; left time: 224.1347s
Epoch: 1 cost time: 12.98750901222229
Epoch: 1, Steps: 570 | Train Loss: 0.2231418 Vali Loss: 0.0443482 Test Loss: 0.1419091
Validation loss decreased (inf --> 0.044348).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2579053
	speed: 0.0598s/iter; left time: 641.2068s
	iters: 200, epoch: 2 | loss: 0.2201451
	speed: 0.0183s/iter; left time: 194.2970s
	iters: 300, epoch: 2 | loss: 0.3597306
	speed: 0.0182s/iter; left time: 192.0532s
	iters: 400, epoch: 2 | loss: 0.1615839
	speed: 0.0182s/iter; left time: 189.7643s
	iters: 500, epoch: 2 | loss: 0.1050598
	speed: 0.0182s/iter; left time: 188.2927s
Epoch: 2 cost time: 10.84876036643982
Epoch: 2, Steps: 570 | Train Loss: 0.1808424 Vali Loss: 0.0492423 Test Loss: 0.1467876
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1199483
	speed: 0.0575s/iter; left time: 584.3620s
	iters: 200, epoch: 3 | loss: 0.1569464
	speed: 0.0182s/iter; left time: 183.1438s
	iters: 300, epoch: 3 | loss: 0.1452450
	speed: 0.0182s/iter; left time: 181.5829s
	iters: 400, epoch: 3 | loss: 0.1272140
	speed: 0.0182s/iter; left time: 179.2412s
	iters: 500, epoch: 3 | loss: 0.1292680
	speed: 0.0182s/iter; left time: 177.3828s
Epoch: 3 cost time: 10.631278991699219
Epoch: 3, Steps: 570 | Train Loss: 0.1353668 Vali Loss: 0.0408401 Test Loss: 0.1360781
Validation loss decreased (0.044348 --> 0.040840).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1077763
	speed: 0.0571s/iter; left time: 547.5010s
	iters: 200, epoch: 4 | loss: 0.1367476
	speed: 0.0183s/iter; left time: 173.7934s
	iters: 300, epoch: 4 | loss: 0.1046509
	speed: 0.0183s/iter; left time: 171.8496s
	iters: 400, epoch: 4 | loss: 0.1148479
	speed: 0.0183s/iter; left time: 169.9589s
	iters: 500, epoch: 4 | loss: 0.0837380
	speed: 0.0183s/iter; left time: 168.1207s
Epoch: 4 cost time: 10.70932388305664
Epoch: 4, Steps: 570 | Train Loss: 0.1092966 Vali Loss: 0.0387543 Test Loss: 0.1354099
Validation loss decreased (0.040840 --> 0.038754).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0754319
	speed: 0.0559s/iter; left time: 504.5582s
	iters: 200, epoch: 5 | loss: 0.1028209
	speed: 0.0183s/iter; left time: 163.3822s
	iters: 300, epoch: 5 | loss: 0.0749491
	speed: 0.0183s/iter; left time: 161.4746s
	iters: 400, epoch: 5 | loss: 0.1010608
	speed: 0.0184s/iter; left time: 160.6950s
	iters: 500, epoch: 5 | loss: 0.0518787
	speed: 0.0184s/iter; left time: 158.8827s
Epoch: 5 cost time: 10.771907806396484
Epoch: 5, Steps: 570 | Train Loss: 0.0957136 Vali Loss: 0.0393743 Test Loss: 0.1363172
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1258037
	speed: 0.0567s/iter; left time: 478.8670s
	iters: 200, epoch: 6 | loss: 0.0651198
	speed: 0.0183s/iter; left time: 153.1480s
	iters: 300, epoch: 6 | loss: 0.1208330
	speed: 0.0183s/iter; left time: 151.0188s
	iters: 400, epoch: 6 | loss: 0.0657723
	speed: 0.0183s/iter; left time: 148.9049s
	iters: 500, epoch: 6 | loss: 0.0893419
	speed: 0.0183s/iter; left time: 147.2618s
Epoch: 6 cost time: 10.762426376342773
Epoch: 6, Steps: 570 | Train Loss: 0.0896516 Vali Loss: 0.0384874 Test Loss: 0.1370584
Validation loss decreased (0.038754 --> 0.038487).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0836456
	speed: 0.0564s/iter; left time: 444.1853s
	iters: 200, epoch: 7 | loss: 0.0584256
	speed: 0.0185s/iter; left time: 143.8494s
	iters: 300, epoch: 7 | loss: 0.0908317
	speed: 0.0185s/iter; left time: 141.9757s
	iters: 400, epoch: 7 | loss: 0.1082451
	speed: 0.0185s/iter; left time: 140.1225s
	iters: 500, epoch: 7 | loss: 0.0696724
	speed: 0.0185s/iter; left time: 138.3373s
Epoch: 7 cost time: 10.842281818389893
Epoch: 7, Steps: 570 | Train Loss: 0.0883192 Vali Loss: 0.0392559 Test Loss: 0.1357287
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0736107
	speed: 0.0562s/iter; left time: 410.5446s
	iters: 200, epoch: 8 | loss: 0.0619227
	speed: 0.0183s/iter; left time: 131.8896s
	iters: 300, epoch: 8 | loss: 0.1009591
	speed: 0.0183s/iter; left time: 130.0117s
	iters: 400, epoch: 8 | loss: 0.0965234
	speed: 0.0183s/iter; left time: 128.3810s
	iters: 500, epoch: 8 | loss: 0.0714677
	speed: 0.0183s/iter; left time: 126.5479s
Epoch: 8 cost time: 10.727655410766602
Epoch: 8, Steps: 570 | Train Loss: 0.0854223 Vali Loss: 0.0388722 Test Loss: 0.1356676
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0916748
	speed: 0.0577s/iter; left time: 388.8197s
	iters: 200, epoch: 9 | loss: 0.1128493
	speed: 0.0186s/iter; left time: 123.2280s
	iters: 300, epoch: 9 | loss: 0.1002116
	speed: 0.0185s/iter; left time: 121.0964s
	iters: 400, epoch: 9 | loss: 0.1455362
	speed: 0.0185s/iter; left time: 119.3676s
	iters: 500, epoch: 9 | loss: 0.0607532
	speed: 0.0186s/iter; left time: 117.7255s
Epoch: 9 cost time: 10.85520076751709
Epoch: 9, Steps: 570 | Train Loss: 0.0853770 Vali Loss: 0.0391876 Test Loss: 0.1361573
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13714168965816498, mae:0.23191645741462708
>>> MS_Pen LR=5e-4 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2078088
	speed: 0.0362s/iter; left time: 408.5933s
	iters: 200, epoch: 1 | loss: 0.1918455
	speed: 0.0240s/iter; left time: 268.8087s
	iters: 300, epoch: 1 | loss: 0.2190505
	speed: 0.0240s/iter; left time: 266.2248s
	iters: 400, epoch: 1 | loss: 0.3139092
	speed: 0.0235s/iter; left time: 258.9663s
	iters: 500, epoch: 1 | loss: 0.2165795
	speed: 0.0222s/iter; left time: 241.5744s
Epoch: 1 cost time: 14.587928533554077
Epoch: 1, Steps: 570 | Train Loss: 0.2437908 Vali Loss: 0.0518072 Test Loss: 0.1549855
Validation loss decreased (inf --> 0.051807).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2636391
	speed: 0.0673s/iter; left time: 721.9168s
	iters: 200, epoch: 2 | loss: 0.1625863
	speed: 0.0237s/iter; left time: 252.0817s
	iters: 300, epoch: 2 | loss: 0.2240786
	speed: 0.0237s/iter; left time: 249.1472s
	iters: 400, epoch: 2 | loss: 0.3758626
	speed: 0.0237s/iter; left time: 247.0343s
	iters: 500, epoch: 2 | loss: 0.2638528
	speed: 0.0237s/iter; left time: 244.4335s
Epoch: 2 cost time: 13.760724306106567
Epoch: 2, Steps: 570 | Train Loss: 0.2455342 Vali Loss: 0.0580365 Test Loss: 0.1626997
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4201744
	speed: 0.0664s/iter; left time: 674.9619s
	iters: 200, epoch: 3 | loss: 0.1814641
	speed: 0.0235s/iter; left time: 236.9182s
	iters: 300, epoch: 3 | loss: 0.3068549
	speed: 0.0235s/iter; left time: 234.3173s
	iters: 400, epoch: 3 | loss: 0.2265036
	speed: 0.0235s/iter; left time: 231.9294s
	iters: 500, epoch: 3 | loss: 0.1502575
	speed: 0.0235s/iter; left time: 229.5647s
Epoch: 3 cost time: 13.70600700378418
Epoch: 3, Steps: 570 | Train Loss: 0.2519040 Vali Loss: 0.0559819 Test Loss: 0.1647657
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1880916
	speed: 0.0632s/iter; left time: 605.8143s
	iters: 200, epoch: 4 | loss: 0.2300973
	speed: 0.0220s/iter; left time: 208.3560s
	iters: 300, epoch: 4 | loss: 0.2730987
	speed: 0.0219s/iter; left time: 205.7986s
	iters: 400, epoch: 4 | loss: 0.2348977
	speed: 0.0220s/iter; left time: 203.9794s
	iters: 500, epoch: 4 | loss: 0.2905759
	speed: 0.0219s/iter; left time: 201.4532s
Epoch: 4 cost time: 12.82509183883667
Epoch: 4, Steps: 570 | Train Loss: 0.2367232 Vali Loss: 0.0543108 Test Loss: 0.1585393
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15516069531440735, mae:0.2542961537837982
>>> MS_Pen LR=5e-4 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1960606
	speed: 0.0350s/iter; left time: 395.8418s
	iters: 200, epoch: 1 | loss: 0.1143450
	speed: 0.0231s/iter; left time: 259.0847s
	iters: 300, epoch: 1 | loss: 0.1977831
	speed: 0.0232s/iter; left time: 257.4873s
	iters: 400, epoch: 1 | loss: 0.1905072
	speed: 0.0232s/iter; left time: 254.7816s
	iters: 500, epoch: 1 | loss: 0.2323282
	speed: 0.0231s/iter; left time: 252.1704s
Epoch: 1 cost time: 14.441394567489624
Epoch: 1, Steps: 570 | Train Loss: 0.2360396 Vali Loss: 0.0624642 Test Loss: 0.1860384
Validation loss decreased (inf --> 0.062464).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2285312
	speed: 0.0630s/iter; left time: 675.7551s
	iters: 200, epoch: 2 | loss: 0.1873291
	speed: 0.0213s/iter; left time: 226.3280s
	iters: 300, epoch: 2 | loss: 0.3799459
	speed: 0.0213s/iter; left time: 224.0720s
	iters: 400, epoch: 2 | loss: 0.2555818
	speed: 0.0213s/iter; left time: 221.7285s
	iters: 500, epoch: 2 | loss: 0.2040031
	speed: 0.0213s/iter; left time: 219.7138s
Epoch: 2 cost time: 12.445780754089355
Epoch: 2, Steps: 570 | Train Loss: 0.2661783 Vali Loss: 0.0587289 Test Loss: 0.1705228
Validation loss decreased (0.062464 --> 0.058729).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2091297
	speed: 0.0617s/iter; left time: 627.4206s
	iters: 200, epoch: 3 | loss: 0.2024689
	speed: 0.0213s/iter; left time: 214.5675s
	iters: 300, epoch: 3 | loss: 0.1545238
	speed: 0.0213s/iter; left time: 212.3056s
	iters: 400, epoch: 3 | loss: 0.1662264
	speed: 0.0213s/iter; left time: 210.2035s
	iters: 500, epoch: 3 | loss: 0.2352879
	speed: 0.0213s/iter; left time: 208.0719s
Epoch: 3 cost time: 12.475999355316162
Epoch: 3, Steps: 570 | Train Loss: 0.2312283 Vali Loss: 0.0610334 Test Loss: 0.1711728
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1288241
	speed: 0.0622s/iter; left time: 596.5441s
	iters: 200, epoch: 4 | loss: 0.1858027
	speed: 0.0214s/iter; left time: 203.3351s
	iters: 300, epoch: 4 | loss: 0.2011683
	speed: 0.0214s/iter; left time: 201.0850s
	iters: 400, epoch: 4 | loss: 0.2477377
	speed: 0.0214s/iter; left time: 199.1014s
	iters: 500, epoch: 4 | loss: 0.1630876
	speed: 0.0214s/iter; left time: 196.7506s
Epoch: 4 cost time: 12.552716493606567
Epoch: 4, Steps: 570 | Train Loss: 0.2100465 Vali Loss: 0.0541313 Test Loss: 0.1496312
Validation loss decreased (0.058729 --> 0.054131).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2706838
	speed: 0.0644s/iter; left time: 580.6739s
	iters: 200, epoch: 5 | loss: 0.1757583
	speed: 0.0213s/iter; left time: 190.0180s
	iters: 300, epoch: 5 | loss: 0.2211552
	speed: 0.0213s/iter; left time: 187.7406s
	iters: 400, epoch: 5 | loss: 0.1929898
	speed: 0.0213s/iter; left time: 185.6220s
	iters: 500, epoch: 5 | loss: 0.1517535
	speed: 0.0213s/iter; left time: 183.3504s
Epoch: 5 cost time: 12.416963338851929
Epoch: 5, Steps: 570 | Train Loss: 0.1968913 Vali Loss: 0.0544055 Test Loss: 0.1523525
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1821055
	speed: 0.0602s/iter; left time: 508.9267s
	iters: 200, epoch: 6 | loss: 0.2240908
	speed: 0.0213s/iter; left time: 177.7966s
	iters: 300, epoch: 6 | loss: 0.2220982
	speed: 0.0213s/iter; left time: 175.5094s
	iters: 400, epoch: 6 | loss: 0.1373273
	speed: 0.0213s/iter; left time: 173.2677s
	iters: 500, epoch: 6 | loss: 0.1442626
	speed: 0.0213s/iter; left time: 171.1080s
Epoch: 6 cost time: 12.409411907196045
Epoch: 6, Steps: 570 | Train Loss: 0.1883387 Vali Loss: 0.0528171 Test Loss: 0.1507412
Validation loss decreased (0.054131 --> 0.052817).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1263060
	speed: 0.0617s/iter; left time: 486.0214s
	iters: 200, epoch: 7 | loss: 0.2353142
	speed: 0.0213s/iter; left time: 165.9019s
	iters: 300, epoch: 7 | loss: 0.1703435
	speed: 0.0213s/iter; left time: 163.7923s
	iters: 400, epoch: 7 | loss: 0.1055188
	speed: 0.0213s/iter; left time: 161.7452s
	iters: 500, epoch: 7 | loss: 0.1741472
	speed: 0.0214s/iter; left time: 159.8439s
Epoch: 7 cost time: 12.472573518753052
Epoch: 7, Steps: 570 | Train Loss: 0.1840516 Vali Loss: 0.0526461 Test Loss: 0.1507950
Validation loss decreased (0.052817 --> 0.052646).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1547824
	speed: 0.0645s/iter; left time: 471.3392s
	iters: 200, epoch: 8 | loss: 0.1603685
	speed: 0.0232s/iter; left time: 167.4572s
	iters: 300, epoch: 8 | loss: 0.1828668
	speed: 0.0232s/iter; left time: 165.1914s
	iters: 400, epoch: 8 | loss: 0.1665240
	speed: 0.0231s/iter; left time: 161.8583s
	iters: 500, epoch: 8 | loss: 0.2305247
	speed: 0.0213s/iter; left time: 147.0369s
Epoch: 8 cost time: 13.224807977676392
Epoch: 8, Steps: 570 | Train Loss: 0.1810525 Vali Loss: 0.0517754 Test Loss: 0.1498416
Validation loss decreased (0.052646 --> 0.051775).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1322724
	speed: 0.0625s/iter; left time: 421.5420s
	iters: 200, epoch: 9 | loss: 0.2437309
	speed: 0.0213s/iter; left time: 141.4973s
	iters: 300, epoch: 9 | loss: 0.1743407
	speed: 0.0213s/iter; left time: 139.4624s
	iters: 400, epoch: 9 | loss: 0.1383392
	speed: 0.0213s/iter; left time: 137.3258s
	iters: 500, epoch: 9 | loss: 0.0987472
	speed: 0.0213s/iter; left time: 135.1648s
Epoch: 9 cost time: 12.470226049423218
Epoch: 9, Steps: 570 | Train Loss: 0.1779786 Vali Loss: 0.0506234 Test Loss: 0.1469322
Validation loss decreased (0.051775 --> 0.050623).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1046547
	speed: 0.0616s/iter; left time: 380.1841s
	iters: 200, epoch: 10 | loss: 0.2084260
	speed: 0.0214s/iter; left time: 129.7891s
	iters: 300, epoch: 10 | loss: 0.1552366
	speed: 0.0212s/iter; left time: 126.7040s
	iters: 400, epoch: 10 | loss: 0.2099379
	speed: 0.0212s/iter; left time: 124.6027s
	iters: 500, epoch: 10 | loss: 0.2477351
	speed: 0.0212s/iter; left time: 122.4382s
Epoch: 10 cost time: 12.445913791656494
Epoch: 10, Steps: 570 | Train Loss: 0.1727035 Vali Loss: 0.0499111 Test Loss: 0.1456624
Validation loss decreased (0.050623 --> 0.049911).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2319530
	speed: 0.0624s/iter; left time: 349.3193s
	iters: 200, epoch: 11 | loss: 0.1371441
	speed: 0.0233s/iter; left time: 128.0249s
	iters: 300, epoch: 11 | loss: 0.1383984
	speed: 0.0233s/iter; left time: 125.6801s
	iters: 400, epoch: 11 | loss: 0.1700851
	speed: 0.0233s/iter; left time: 123.4107s
	iters: 500, epoch: 11 | loss: 0.2116080
	speed: 0.0228s/iter; left time: 118.4513s
Epoch: 11 cost time: 13.254616022109985
Epoch: 11, Steps: 570 | Train Loss: 0.1707729 Vali Loss: 0.0497200 Test Loss: 0.1457715
Validation loss decreased (0.049911 --> 0.049720).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1757524
	speed: 0.0612s/iter; left time: 307.9955s
	iters: 200, epoch: 12 | loss: 0.2324313
	speed: 0.0213s/iter; left time: 104.8577s
	iters: 300, epoch: 12 | loss: 0.1618492
	speed: 0.0213s/iter; left time: 102.6912s
	iters: 400, epoch: 12 | loss: 0.3053412
	speed: 0.0213s/iter; left time: 100.5829s
	iters: 500, epoch: 12 | loss: 0.1459629
	speed: 0.0213s/iter; left time: 98.5050s
Epoch: 12 cost time: 12.436617851257324
Epoch: 12, Steps: 570 | Train Loss: 0.1691459 Vali Loss: 0.0496730 Test Loss: 0.1455054
Validation loss decreased (0.049720 --> 0.049673).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1268853
	speed: 0.0620s/iter; left time: 276.7525s
	iters: 200, epoch: 13 | loss: 0.1906301
	speed: 0.0213s/iter; left time: 92.9194s
	iters: 300, epoch: 13 | loss: 0.2036594
	speed: 0.0213s/iter; left time: 90.7994s
	iters: 400, epoch: 13 | loss: 0.1496732
	speed: 0.0213s/iter; left time: 88.6024s
	iters: 500, epoch: 13 | loss: 0.1656446
	speed: 0.0212s/iter; left time: 86.2161s
Epoch: 13 cost time: 12.41563868522644
Epoch: 13, Steps: 570 | Train Loss: 0.1693696 Vali Loss: 0.0497170 Test Loss: 0.1454245
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1950544
	speed: 0.0598s/iter; left time: 232.7712s
	iters: 200, epoch: 14 | loss: 0.1857572
	speed: 0.0213s/iter; left time: 80.5882s
	iters: 300, epoch: 14 | loss: 0.1533544
	speed: 0.0213s/iter; left time: 78.4736s
	iters: 400, epoch: 14 | loss: 0.1224787
	speed: 0.0213s/iter; left time: 76.3380s
	iters: 500, epoch: 14 | loss: 0.2722294
	speed: 0.0212s/iter; left time: 74.1812s
Epoch: 14 cost time: 12.417040348052979
Epoch: 14, Steps: 570 | Train Loss: 0.1690009 Vali Loss: 0.0495582 Test Loss: 0.1454170
Validation loss decreased (0.049673 --> 0.049558).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.2011028
	speed: 0.0628s/iter; left time: 208.4535s
	iters: 200, epoch: 15 | loss: 0.1447444
	speed: 0.0212s/iter; left time: 68.3502s
	iters: 300, epoch: 15 | loss: 0.1430202
	speed: 0.0212s/iter; left time: 66.2655s
	iters: 400, epoch: 15 | loss: 0.1504113
	speed: 0.0212s/iter; left time: 64.1331s
	iters: 500, epoch: 15 | loss: 0.1193048
	speed: 0.0213s/iter; left time: 62.3429s
Epoch: 15 cost time: 12.56313157081604
Epoch: 15, Steps: 570 | Train Loss: 0.1708521 Vali Loss: 0.0494653 Test Loss: 0.1454035
Validation loss decreased (0.049558 --> 0.049465).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1376981
	speed: 0.0627s/iter; left time: 172.3861s
	iters: 200, epoch: 16 | loss: 0.1055433
	speed: 0.0213s/iter; left time: 56.4827s
	iters: 300, epoch: 16 | loss: 0.2362642
	speed: 0.0213s/iter; left time: 54.3996s
	iters: 400, epoch: 16 | loss: 0.1351400
	speed: 0.0213s/iter; left time: 52.2055s
	iters: 500, epoch: 16 | loss: 0.1939912
	speed: 0.0213s/iter; left time: 50.0661s
Epoch: 16 cost time: 12.428397178649902
Epoch: 16, Steps: 570 | Train Loss: 0.1694571 Vali Loss: 0.0495717 Test Loss: 0.1453902
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.2368218
	speed: 0.0633s/iter; left time: 137.9490s
	iters: 200, epoch: 17 | loss: 0.1962468
	speed: 0.0213s/iter; left time: 44.3515s
	iters: 300, epoch: 17 | loss: 0.1520576
	speed: 0.0213s/iter; left time: 42.2160s
	iters: 400, epoch: 17 | loss: 0.1806225
	speed: 0.0213s/iter; left time: 40.0954s
	iters: 500, epoch: 17 | loss: 0.1345037
	speed: 0.0213s/iter; left time: 37.9526s
Epoch: 17 cost time: 12.437283992767334
Epoch: 17, Steps: 570 | Train Loss: 0.1706217 Vali Loss: 0.0497025 Test Loss: 0.1453852
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1744735
	speed: 0.0606s/iter; left time: 97.5866s
	iters: 200, epoch: 18 | loss: 0.1608479
	speed: 0.0214s/iter; left time: 32.2794s
	iters: 300, epoch: 18 | loss: 0.1912530
	speed: 0.0214s/iter; left time: 30.1440s
	iters: 400, epoch: 18 | loss: 0.2090923
	speed: 0.0214s/iter; left time: 28.0123s
	iters: 500, epoch: 18 | loss: 0.1497192
	speed: 0.0214s/iter; left time: 25.8738s
Epoch: 18 cost time: 12.43827223777771
Epoch: 18, Steps: 570 | Train Loss: 0.1686452 Vali Loss: 0.0495793 Test Loss: 0.1453830
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14558978378772736, mae:0.24136845767498016
>>> MS_Pen LR=5e-4 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2587065
	speed: 0.0319s/iter; left time: 360.5334s
	iters: 200, epoch: 1 | loss: 0.1701519
	speed: 0.0202s/iter; left time: 226.6393s
	iters: 300, epoch: 1 | loss: 0.2691703
	speed: 0.0202s/iter; left time: 224.7205s
	iters: 400, epoch: 1 | loss: 0.2571162
	speed: 0.0203s/iter; left time: 222.8502s
	iters: 500, epoch: 1 | loss: 0.3164177
	speed: 0.0218s/iter; left time: 237.1506s
Epoch: 1 cost time: 13.055069208145142
Epoch: 1, Steps: 570 | Train Loss: 0.2591719 Vali Loss: 0.0655578 Test Loss: 0.1924897
Validation loss decreased (inf --> 0.065558).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2509618
	speed: 0.0626s/iter; left time: 672.2638s
	iters: 200, epoch: 2 | loss: 0.4390530
	speed: 0.0202s/iter; left time: 215.1396s
	iters: 300, epoch: 2 | loss: 0.2692715
	speed: 0.0202s/iter; left time: 212.8212s
	iters: 400, epoch: 2 | loss: 0.1951402
	speed: 0.0202s/iter; left time: 210.6621s
	iters: 500, epoch: 2 | loss: 0.1927197
	speed: 0.0202s/iter; left time: 208.4980s
Epoch: 2 cost time: 11.779801368713379
Epoch: 2, Steps: 570 | Train Loss: 0.2741008 Vali Loss: 0.0565696 Test Loss: 0.1652095
Validation loss decreased (0.065558 --> 0.056570).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1762956
	speed: 0.0596s/iter; left time: 605.9234s
	iters: 200, epoch: 3 | loss: 0.1806643
	speed: 0.0201s/iter; left time: 202.5872s
	iters: 300, epoch: 3 | loss: 0.2117645
	speed: 0.0202s/iter; left time: 201.0933s
	iters: 400, epoch: 3 | loss: 0.2320340
	speed: 0.0202s/iter; left time: 198.8204s
	iters: 500, epoch: 3 | loss: 0.2223235
	speed: 0.0201s/iter; left time: 196.4202s
Epoch: 3 cost time: 11.786608457565308
Epoch: 3, Steps: 570 | Train Loss: 0.2424844 Vali Loss: 0.0545919 Test Loss: 0.1575548
Validation loss decreased (0.056570 --> 0.054592).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1359625
	speed: 0.0594s/iter; left time: 569.4225s
	iters: 200, epoch: 4 | loss: 0.3967896
	speed: 0.0201s/iter; left time: 191.1127s
	iters: 300, epoch: 4 | loss: 0.1457321
	speed: 0.0201s/iter; left time: 189.1972s
	iters: 400, epoch: 4 | loss: 0.2277738
	speed: 0.0201s/iter; left time: 187.1791s
	iters: 500, epoch: 4 | loss: 0.1614764
	speed: 0.0201s/iter; left time: 185.0658s
Epoch: 4 cost time: 11.772963523864746
Epoch: 4, Steps: 570 | Train Loss: 0.2310727 Vali Loss: 0.0527512 Test Loss: 0.1515726
Validation loss decreased (0.054592 --> 0.052751).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2144889
	speed: 0.0615s/iter; left time: 555.1463s
	iters: 200, epoch: 5 | loss: 0.3185079
	speed: 0.0203s/iter; left time: 180.7925s
	iters: 300, epoch: 5 | loss: 0.1943037
	speed: 0.0202s/iter; left time: 178.1949s
	iters: 400, epoch: 5 | loss: 0.1831174
	speed: 0.0202s/iter; left time: 176.2990s
	iters: 500, epoch: 5 | loss: 0.1761528
	speed: 0.0202s/iter; left time: 173.8245s
Epoch: 5 cost time: 11.826788902282715
Epoch: 5, Steps: 570 | Train Loss: 0.2212718 Vali Loss: 0.0493450 Test Loss: 0.1462961
Validation loss decreased (0.052751 --> 0.049345).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2146156
	speed: 0.0595s/iter; left time: 503.0563s
	iters: 200, epoch: 6 | loss: 0.2868646
	speed: 0.0202s/iter; left time: 168.2940s
	iters: 300, epoch: 6 | loss: 0.1728358
	speed: 0.0202s/iter; left time: 166.4178s
	iters: 400, epoch: 6 | loss: 0.1498028
	speed: 0.0202s/iter; left time: 164.3235s
	iters: 500, epoch: 6 | loss: 0.3098606
	speed: 0.0201s/iter; left time: 162.1460s
Epoch: 6 cost time: 11.819733619689941
Epoch: 6, Steps: 570 | Train Loss: 0.2156205 Vali Loss: 0.0491738 Test Loss: 0.1442291
Validation loss decreased (0.049345 --> 0.049174).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2353989
	speed: 0.0607s/iter; left time: 478.0843s
	iters: 200, epoch: 7 | loss: 0.2868282
	speed: 0.0202s/iter; left time: 156.8598s
	iters: 300, epoch: 7 | loss: 0.2540600
	speed: 0.0201s/iter; left time: 154.5955s
	iters: 400, epoch: 7 | loss: 0.2541274
	speed: 0.0202s/iter; left time: 152.7765s
	iters: 500, epoch: 7 | loss: 0.1512331
	speed: 0.0201s/iter; left time: 150.6013s
Epoch: 7 cost time: 11.782846450805664
Epoch: 7, Steps: 570 | Train Loss: 0.2148396 Vali Loss: 0.0492164 Test Loss: 0.1440482
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2506144
	speed: 0.0598s/iter; left time: 437.1166s
	iters: 200, epoch: 8 | loss: 0.3530543
	speed: 0.0203s/iter; left time: 146.2740s
	iters: 300, epoch: 8 | loss: 0.2386396
	speed: 0.0223s/iter; left time: 158.7091s
	iters: 400, epoch: 8 | loss: 0.1548925
	speed: 0.0224s/iter; left time: 156.9258s
	iters: 500, epoch: 8 | loss: 0.2504951
	speed: 0.0228s/iter; left time: 157.8862s
Epoch: 8 cost time: 12.876123428344727
Epoch: 8, Steps: 570 | Train Loss: 0.2112514 Vali Loss: 0.0491753 Test Loss: 0.1438920
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2017463
	speed: 0.0663s/iter; left time: 446.8232s
	iters: 200, epoch: 9 | loss: 0.1691719
	speed: 0.0232s/iter; left time: 153.7506s
	iters: 300, epoch: 9 | loss: 0.2888919
	speed: 0.0231s/iter; left time: 151.3681s
	iters: 400, epoch: 9 | loss: 0.1833407
	speed: 0.0231s/iter; left time: 148.9042s
	iters: 500, epoch: 9 | loss: 0.1124587
	speed: 0.0231s/iter; left time: 146.6006s
Epoch: 9 cost time: 13.512932777404785
Epoch: 9, Steps: 570 | Train Loss: 0.2112034 Vali Loss: 0.0491866 Test Loss: 0.1440183
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14445750415325165, mae:0.24213239550590515
>>> MS_Pen LR=5e-4 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2337772
	speed: 0.0221s/iter; left time: 249.2977s
	iters: 200, epoch: 1 | loss: 0.2141602
	speed: 0.0106s/iter; left time: 118.7177s
	iters: 300, epoch: 1 | loss: 0.2120595
	speed: 0.0106s/iter; left time: 117.8509s
	iters: 400, epoch: 1 | loss: 0.2371620
	speed: 0.0106s/iter; left time: 116.5430s
	iters: 500, epoch: 1 | loss: 0.2102680
	speed: 0.0106s/iter; left time: 115.5549s
Epoch: 1 cost time: 7.233018398284912
Epoch: 1, Steps: 570 | Train Loss: 0.2444011 Vali Loss: 0.0438950 Test Loss: 0.1383838
Validation loss decreased (inf --> 0.043895).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3636380
	speed: 0.0379s/iter; left time: 406.6998s
	iters: 200, epoch: 2 | loss: 0.2394428
	speed: 0.0106s/iter; left time: 112.1593s
	iters: 300, epoch: 2 | loss: 0.2398211
	speed: 0.0106s/iter; left time: 111.4493s
	iters: 400, epoch: 2 | loss: 0.1626414
	speed: 0.0106s/iter; left time: 110.4356s
	iters: 500, epoch: 2 | loss: 0.1776960
	speed: 0.0106s/iter; left time: 109.1500s
Epoch: 2 cost time: 6.3154456615448
Epoch: 2, Steps: 570 | Train Loss: 0.2052805 Vali Loss: 0.0450348 Test Loss: 0.1451215
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1459364
	speed: 0.0365s/iter; left time: 370.6341s
	iters: 200, epoch: 3 | loss: 0.2270676
	speed: 0.0105s/iter; left time: 106.1056s
	iters: 300, epoch: 3 | loss: 0.1634530
	speed: 0.0106s/iter; left time: 105.2938s
	iters: 400, epoch: 3 | loss: 0.1851940
	speed: 0.0106s/iter; left time: 104.3522s
	iters: 500, epoch: 3 | loss: 0.2188335
	speed: 0.0105s/iter; left time: 102.7376s
Epoch: 3 cost time: 6.282905101776123
Epoch: 3, Steps: 570 | Train Loss: 0.1810122 Vali Loss: 0.0385387 Test Loss: 0.1249979
Validation loss decreased (0.043895 --> 0.038539).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1757617
	speed: 0.0360s/iter; left time: 345.5012s
	iters: 200, epoch: 4 | loss: 0.0960347
	speed: 0.0106s/iter; left time: 100.3594s
	iters: 300, epoch: 4 | loss: 0.1759589
	speed: 0.0106s/iter; left time: 99.3637s
	iters: 400, epoch: 4 | loss: 0.1925610
	speed: 0.0106s/iter; left time: 98.9207s
	iters: 500, epoch: 4 | loss: 0.1669786
	speed: 0.0106s/iter; left time: 97.3367s
Epoch: 4 cost time: 6.32170844078064
Epoch: 4, Steps: 570 | Train Loss: 0.1653815 Vali Loss: 0.0371059 Test Loss: 0.1222323
Validation loss decreased (0.038539 --> 0.037106).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1569054
	speed: 0.0370s/iter; left time: 333.4408s
	iters: 200, epoch: 5 | loss: 0.1602874
	speed: 0.0106s/iter; left time: 94.6070s
	iters: 300, epoch: 5 | loss: 0.0878987
	speed: 0.0106s/iter; left time: 93.8977s
	iters: 400, epoch: 5 | loss: 0.1480418
	speed: 0.0107s/iter; left time: 93.4690s
	iters: 500, epoch: 5 | loss: 0.1752220
	speed: 0.0107s/iter; left time: 91.8731s
Epoch: 5 cost time: 6.330883026123047
Epoch: 5, Steps: 570 | Train Loss: 0.1576421 Vali Loss: 0.0368220 Test Loss: 0.1257318
Validation loss decreased (0.037106 --> 0.036822).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1472623
	speed: 0.0376s/iter; left time: 317.6444s
	iters: 200, epoch: 6 | loss: 0.1246589
	speed: 0.0108s/iter; left time: 90.2069s
	iters: 300, epoch: 6 | loss: 0.1569164
	speed: 0.0108s/iter; left time: 88.8775s
	iters: 400, epoch: 6 | loss: 0.1849780
	speed: 0.0108s/iter; left time: 87.6326s
	iters: 500, epoch: 6 | loss: 0.1538098
	speed: 0.0107s/iter; left time: 86.4772s
Epoch: 6 cost time: 6.442444562911987
Epoch: 6, Steps: 570 | Train Loss: 0.1527966 Vali Loss: 0.0354915 Test Loss: 0.1258728
Validation loss decreased (0.036822 --> 0.035492).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1655871
	speed: 0.0396s/iter; left time: 311.6992s
	iters: 200, epoch: 7 | loss: 0.2000734
	speed: 0.0119s/iter; left time: 92.6104s
	iters: 300, epoch: 7 | loss: 0.1362715
	speed: 0.0114s/iter; left time: 87.8054s
	iters: 400, epoch: 7 | loss: 0.1052459
	speed: 0.0105s/iter; left time: 79.9795s
	iters: 500, epoch: 7 | loss: 0.1364390
	speed: 0.0107s/iter; left time: 79.8672s
Epoch: 7 cost time: 6.751197576522827
Epoch: 7, Steps: 570 | Train Loss: 0.1511742 Vali Loss: 0.0355578 Test Loss: 0.1255730
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1507841
	speed: 0.0370s/iter; left time: 270.1716s
	iters: 200, epoch: 8 | loss: 0.1498711
	speed: 0.0107s/iter; left time: 77.1542s
	iters: 300, epoch: 8 | loss: 0.1803522
	speed: 0.0107s/iter; left time: 75.9623s
	iters: 400, epoch: 8 | loss: 0.2054901
	speed: 0.0107s/iter; left time: 74.9150s
	iters: 500, epoch: 8 | loss: 0.1127266
	speed: 0.0107s/iter; left time: 73.9288s
Epoch: 8 cost time: 6.366453647613525
Epoch: 8, Steps: 570 | Train Loss: 0.1496588 Vali Loss: 0.0353466 Test Loss: 0.1248244
Validation loss decreased (0.035492 --> 0.035347).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1902715
	speed: 0.0368s/iter; left time: 247.9140s
	iters: 200, epoch: 9 | loss: 0.1407188
	speed: 0.0107s/iter; left time: 71.1590s
	iters: 300, epoch: 9 | loss: 0.0794833
	speed: 0.0107s/iter; left time: 69.9823s
	iters: 400, epoch: 9 | loss: 0.1333896
	speed: 0.0107s/iter; left time: 68.9407s
	iters: 500, epoch: 9 | loss: 0.1281195
	speed: 0.0107s/iter; left time: 67.6110s
Epoch: 9 cost time: 6.384618759155273
Epoch: 9, Steps: 570 | Train Loss: 0.1487361 Vali Loss: 0.0356415 Test Loss: 0.1254302
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1311780
	speed: 0.0381s/iter; left time: 235.1864s
	iters: 200, epoch: 10 | loss: 0.1690136
	speed: 0.0106s/iter; left time: 64.1363s
	iters: 300, epoch: 10 | loss: 0.1109390
	speed: 0.0106s/iter; left time: 63.2054s
	iters: 400, epoch: 10 | loss: 0.1358591
	speed: 0.0106s/iter; left time: 62.0275s
	iters: 500, epoch: 10 | loss: 0.2053457
	speed: 0.0106s/iter; left time: 60.9721s
Epoch: 10 cost time: 6.33850359916687
Epoch: 10, Steps: 570 | Train Loss: 0.1485456 Vali Loss: 0.0355497 Test Loss: 0.1253608
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1768265
	speed: 0.0379s/iter; left time: 212.0483s
	iters: 200, epoch: 11 | loss: 0.1576028
	speed: 0.0106s/iter; left time: 58.1609s
	iters: 300, epoch: 11 | loss: 0.1272825
	speed: 0.0106s/iter; left time: 57.0143s
	iters: 400, epoch: 11 | loss: 0.1901489
	speed: 0.0105s/iter; left time: 55.8991s
	iters: 500, epoch: 11 | loss: 0.1271624
	speed: 0.0105s/iter; left time: 54.8583s
Epoch: 11 cost time: 6.459843397140503
Epoch: 11, Steps: 570 | Train Loss: 0.1489914 Vali Loss: 0.0354060 Test Loss: 0.1255834
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12494654208421707, mae:0.21745403110980988
>>> MS_Pen LR=5e-4 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2354873
	speed: 0.0220s/iter; left time: 248.7864s
	iters: 200, epoch: 1 | loss: 0.2257198
	speed: 0.0103s/iter; left time: 115.4188s
	iters: 300, epoch: 1 | loss: 0.3309304
	speed: 0.0103s/iter; left time: 114.4093s
	iters: 400, epoch: 1 | loss: 0.2256999
	speed: 0.0103s/iter; left time: 113.1333s
	iters: 500, epoch: 1 | loss: 0.2016405
	speed: 0.0103s/iter; left time: 112.2687s
Epoch: 1 cost time: 7.092444658279419
Epoch: 1, Steps: 570 | Train Loss: 0.2206205 Vali Loss: 0.0381409 Test Loss: 0.1229256
Validation loss decreased (inf --> 0.038141).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1671948
	speed: 0.0373s/iter; left time: 400.4505s
	iters: 200, epoch: 2 | loss: 0.2054474
	speed: 0.0103s/iter; left time: 109.8732s
	iters: 300, epoch: 2 | loss: 0.1732286
	speed: 0.0103s/iter; left time: 108.5033s
	iters: 400, epoch: 2 | loss: 0.1727217
	speed: 0.0103s/iter; left time: 107.6041s
	iters: 500, epoch: 2 | loss: 0.1768516
	speed: 0.0103s/iter; left time: 106.3770s
Epoch: 2 cost time: 6.191157817840576
Epoch: 2, Steps: 570 | Train Loss: 0.1900826 Vali Loss: 0.0374310 Test Loss: 0.1194472
Validation loss decreased (0.038141 --> 0.037431).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0926640
	speed: 0.0374s/iter; left time: 379.7555s
	iters: 200, epoch: 3 | loss: 0.1470486
	speed: 0.0103s/iter; left time: 103.3091s
	iters: 300, epoch: 3 | loss: 0.2925162
	speed: 0.0103s/iter; left time: 102.5957s
	iters: 400, epoch: 3 | loss: 0.1798667
	speed: 0.0103s/iter; left time: 101.4110s
	iters: 500, epoch: 3 | loss: 0.1209893
	speed: 0.0103s/iter; left time: 100.3117s
Epoch: 3 cost time: 6.1707093715667725
Epoch: 3, Steps: 570 | Train Loss: 0.1698808 Vali Loss: 0.0332966 Test Loss: 0.1137685
Validation loss decreased (0.037431 --> 0.033297).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1323597
	speed: 0.0357s/iter; left time: 342.6074s
	iters: 200, epoch: 4 | loss: 0.1405261
	speed: 0.0102s/iter; left time: 97.1386s
	iters: 300, epoch: 4 | loss: 0.1106589
	speed: 0.0102s/iter; left time: 96.1992s
	iters: 400, epoch: 4 | loss: 0.1286504
	speed: 0.0103s/iter; left time: 95.5633s
	iters: 500, epoch: 4 | loss: 0.1945246
	speed: 0.0103s/iter; left time: 94.5421s
Epoch: 4 cost time: 6.1461451053619385
Epoch: 4, Steps: 570 | Train Loss: 0.1566870 Vali Loss: 0.0337392 Test Loss: 0.1138690
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1156915
	speed: 0.0355s/iter; left time: 320.2461s
	iters: 200, epoch: 5 | loss: 0.1917595
	speed: 0.0103s/iter; left time: 91.8816s
	iters: 300, epoch: 5 | loss: 0.1337083
	speed: 0.0103s/iter; left time: 90.7347s
	iters: 400, epoch: 5 | loss: 0.1418213
	speed: 0.0103s/iter; left time: 89.8255s
	iters: 500, epoch: 5 | loss: 0.1331363
	speed: 0.0103s/iter; left time: 88.7194s
Epoch: 5 cost time: 6.118008136749268
Epoch: 5, Steps: 570 | Train Loss: 0.1501749 Vali Loss: 0.0332823 Test Loss: 0.1164556
Validation loss decreased (0.033297 --> 0.033282).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1095674
	speed: 0.0378s/iter; left time: 319.0873s
	iters: 200, epoch: 6 | loss: 0.2009984
	speed: 0.0116s/iter; left time: 96.5145s
	iters: 300, epoch: 6 | loss: 0.1614638
	speed: 0.0116s/iter; left time: 95.4633s
	iters: 400, epoch: 6 | loss: 0.1213851
	speed: 0.0115s/iter; left time: 94.0610s
	iters: 500, epoch: 6 | loss: 0.1024483
	speed: 0.0115s/iter; left time: 92.8039s
Epoch: 6 cost time: 6.8691651821136475
Epoch: 6, Steps: 570 | Train Loss: 0.1462533 Vali Loss: 0.0335239 Test Loss: 0.1158764
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1469603
	speed: 0.0360s/iter; left time: 283.8289s
	iters: 200, epoch: 7 | loss: 0.1693824
	speed: 0.0102s/iter; left time: 79.7208s
	iters: 300, epoch: 7 | loss: 0.2398802
	speed: 0.0102s/iter; left time: 78.5352s
	iters: 400, epoch: 7 | loss: 0.1932387
	speed: 0.0102s/iter; left time: 77.4938s
	iters: 500, epoch: 7 | loss: 0.1334548
	speed: 0.0102s/iter; left time: 76.4275s
Epoch: 7 cost time: 6.135737657546997
Epoch: 7, Steps: 570 | Train Loss: 0.1450162 Vali Loss: 0.0330925 Test Loss: 0.1152223
Validation loss decreased (0.033282 --> 0.033092).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1300980
	speed: 0.0353s/iter; left time: 258.1794s
	iters: 200, epoch: 8 | loss: 0.1131595
	speed: 0.0102s/iter; left time: 73.4852s
	iters: 300, epoch: 8 | loss: 0.1206596
	speed: 0.0102s/iter; left time: 72.2754s
	iters: 400, epoch: 8 | loss: 0.1260891
	speed: 0.0102s/iter; left time: 71.4987s
	iters: 500, epoch: 8 | loss: 0.0764525
	speed: 0.0102s/iter; left time: 70.4413s
Epoch: 8 cost time: 6.088110446929932
Epoch: 8, Steps: 570 | Train Loss: 0.1446851 Vali Loss: 0.0330252 Test Loss: 0.1158778
Validation loss decreased (0.033092 --> 0.033025).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1210036
	speed: 0.0377s/iter; left time: 254.4360s
	iters: 200, epoch: 9 | loss: 0.1426758
	speed: 0.0104s/iter; left time: 68.9865s
	iters: 300, epoch: 9 | loss: 0.1274056
	speed: 0.0104s/iter; left time: 67.9423s
	iters: 400, epoch: 9 | loss: 0.1546458
	speed: 0.0104s/iter; left time: 66.8796s
	iters: 500, epoch: 9 | loss: 0.1381187
	speed: 0.0104s/iter; left time: 65.6930s
Epoch: 9 cost time: 6.216355562210083
Epoch: 9, Steps: 570 | Train Loss: 0.1430687 Vali Loss: 0.0331302 Test Loss: 0.1153916
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1490276
	speed: 0.0374s/iter; left time: 230.7700s
	iters: 200, epoch: 10 | loss: 0.1085411
	speed: 0.0103s/iter; left time: 62.5795s
	iters: 300, epoch: 10 | loss: 0.1154791
	speed: 0.0103s/iter; left time: 61.5344s
	iters: 400, epoch: 10 | loss: 0.0865878
	speed: 0.0103s/iter; left time: 60.4157s
	iters: 500, epoch: 10 | loss: 0.1033681
	speed: 0.0103s/iter; left time: 59.4870s
Epoch: 10 cost time: 6.153795003890991
Epoch: 10, Steps: 570 | Train Loss: 0.1444400 Vali Loss: 0.0331294 Test Loss: 0.1154639
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1427893
	speed: 0.0379s/iter; left time: 212.4583s
	iters: 200, epoch: 11 | loss: 0.1368292
	speed: 0.0110s/iter; left time: 60.3442s
	iters: 300, epoch: 11 | loss: 0.1691055
	speed: 0.0103s/iter; left time: 55.7532s
	iters: 400, epoch: 11 | loss: 0.1551236
	speed: 0.0104s/iter; left time: 55.0632s
	iters: 500, epoch: 11 | loss: 0.1183433
	speed: 0.0107s/iter; left time: 55.7492s
Epoch: 11 cost time: 6.424924612045288
Epoch: 11, Steps: 570 | Train Loss: 0.1421207 Vali Loss: 0.0330393 Test Loss: 0.1154093
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11598408967256546, mae:0.20548422634601593
>>> MS_Pen LR=5e-4 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2242766
	speed: 0.0236s/iter; left time: 266.3672s
	iters: 200, epoch: 1 | loss: 0.1578388
	speed: 0.0115s/iter; left time: 129.3523s
	iters: 300, epoch: 1 | loss: 0.1658191
	speed: 0.0116s/iter; left time: 128.4942s
	iters: 400, epoch: 1 | loss: 0.2245109
	speed: 0.0115s/iter; left time: 126.8392s
	iters: 500, epoch: 1 | loss: 0.2278516
	speed: 0.0115s/iter; left time: 125.3004s
Epoch: 1 cost time: 7.82800555229187
Epoch: 1, Steps: 570 | Train Loss: 0.2487041 Vali Loss: 0.0456491 Test Loss: 0.1409592
Validation loss decreased (inf --> 0.045649).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2073869
	speed: 0.0401s/iter; left time: 429.8788s
	iters: 200, epoch: 2 | loss: 0.2783265
	speed: 0.0104s/iter; left time: 110.5469s
	iters: 300, epoch: 2 | loss: 0.1632271
	speed: 0.0104s/iter; left time: 109.4820s
	iters: 400, epoch: 2 | loss: 0.2551944
	speed: 0.0103s/iter; left time: 107.8843s
	iters: 500, epoch: 2 | loss: 0.2290028
	speed: 0.0104s/iter; left time: 107.1059s
Epoch: 2 cost time: 6.224104166030884
Epoch: 2, Steps: 570 | Train Loss: 0.2098029 Vali Loss: 0.0425316 Test Loss: 0.1327912
Validation loss decreased (0.045649 --> 0.042532).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1205451
	speed: 0.0378s/iter; left time: 383.8101s
	iters: 200, epoch: 3 | loss: 0.1829224
	speed: 0.0117s/iter; left time: 117.2866s
	iters: 300, epoch: 3 | loss: 0.2419520
	speed: 0.0116s/iter; left time: 115.8772s
	iters: 400, epoch: 3 | loss: 0.1879877
	speed: 0.0116s/iter; left time: 114.6611s
	iters: 500, epoch: 3 | loss: 0.1196027
	speed: 0.0116s/iter; left time: 113.2202s
Epoch: 3 cost time: 6.945156097412109
Epoch: 3, Steps: 570 | Train Loss: 0.1812194 Vali Loss: 0.0367341 Test Loss: 0.1292284
Validation loss decreased (0.042532 --> 0.036734).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0940912
	speed: 0.0381s/iter; left time: 365.1788s
	iters: 200, epoch: 4 | loss: 0.1229096
	speed: 0.0104s/iter; left time: 98.4172s
	iters: 300, epoch: 4 | loss: 0.1108187
	speed: 0.0104s/iter; left time: 97.4960s
	iters: 400, epoch: 4 | loss: 0.1665190
	speed: 0.0104s/iter; left time: 96.3062s
	iters: 500, epoch: 4 | loss: 0.1530784
	speed: 0.0104s/iter; left time: 95.4271s
Epoch: 4 cost time: 6.225606679916382
Epoch: 4, Steps: 570 | Train Loss: 0.1649805 Vali Loss: 0.0375185 Test Loss: 0.1338927
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1482353
	speed: 0.0366s/iter; left time: 330.3174s
	iters: 200, epoch: 5 | loss: 0.1012124
	speed: 0.0103s/iter; left time: 92.2640s
	iters: 300, epoch: 5 | loss: 0.1773050
	speed: 0.0103s/iter; left time: 91.2494s
	iters: 400, epoch: 5 | loss: 0.1552794
	speed: 0.0103s/iter; left time: 90.2384s
	iters: 500, epoch: 5 | loss: 0.2090470
	speed: 0.0103s/iter; left time: 88.6799s
Epoch: 5 cost time: 6.202208042144775
Epoch: 5, Steps: 570 | Train Loss: 0.1567858 Vali Loss: 0.0366082 Test Loss: 0.1330138
Validation loss decreased (0.036734 --> 0.036608).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1070867
	speed: 0.0377s/iter; left time: 318.4999s
	iters: 200, epoch: 6 | loss: 0.1356224
	speed: 0.0104s/iter; left time: 87.0856s
	iters: 300, epoch: 6 | loss: 0.1296971
	speed: 0.0104s/iter; left time: 85.8457s
	iters: 400, epoch: 6 | loss: 0.1284501
	speed: 0.0104s/iter; left time: 84.5913s
	iters: 500, epoch: 6 | loss: 0.1636503
	speed: 0.0104s/iter; left time: 83.4278s
Epoch: 6 cost time: 6.235696077346802
Epoch: 6, Steps: 570 | Train Loss: 0.1525835 Vali Loss: 0.0358234 Test Loss: 0.1318477
Validation loss decreased (0.036608 --> 0.035823).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1101330
	speed: 0.0369s/iter; left time: 290.7955s
	iters: 200, epoch: 7 | loss: 0.1059787
	speed: 0.0102s/iter; left time: 79.4658s
	iters: 300, epoch: 7 | loss: 0.1262559
	speed: 0.0103s/iter; left time: 78.8091s
	iters: 400, epoch: 7 | loss: 0.1008399
	speed: 0.0102s/iter; left time: 77.5856s
	iters: 500, epoch: 7 | loss: 0.1578117
	speed: 0.0102s/iter; left time: 76.6723s
Epoch: 7 cost time: 6.168623447418213
Epoch: 7, Steps: 570 | Train Loss: 0.1495977 Vali Loss: 0.0357734 Test Loss: 0.1313808
Validation loss decreased (0.035823 --> 0.035773).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1183925
	speed: 0.0371s/iter; left time: 271.4967s
	iters: 200, epoch: 8 | loss: 0.1397867
	speed: 0.0103s/iter; left time: 74.5227s
	iters: 300, epoch: 8 | loss: 0.1785212
	speed: 0.0103s/iter; left time: 73.5716s
	iters: 400, epoch: 8 | loss: 0.1687855
	speed: 0.0103s/iter; left time: 72.5396s
	iters: 500, epoch: 8 | loss: 0.1314717
	speed: 0.0103s/iter; left time: 71.5110s
Epoch: 8 cost time: 6.229686737060547
Epoch: 8, Steps: 570 | Train Loss: 0.1486639 Vali Loss: 0.0358959 Test Loss: 0.1313485
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1231559
	speed: 0.0382s/iter; left time: 257.6808s
	iters: 200, epoch: 9 | loss: 0.1789889
	speed: 0.0116s/iter; left time: 77.2894s
	iters: 300, epoch: 9 | loss: 0.1065091
	speed: 0.0116s/iter; left time: 76.0926s
	iters: 400, epoch: 9 | loss: 0.1146125
	speed: 0.0106s/iter; left time: 68.1788s
	iters: 500, epoch: 9 | loss: 0.1551807
	speed: 0.0104s/iter; left time: 65.8546s
Epoch: 9 cost time: 6.635666608810425
Epoch: 9, Steps: 570 | Train Loss: 0.1473617 Vali Loss: 0.0357149 Test Loss: 0.1320563
Validation loss decreased (0.035773 --> 0.035715).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1247124
	speed: 0.0374s/iter; left time: 230.9146s
	iters: 200, epoch: 10 | loss: 0.2052784
	speed: 0.0104s/iter; left time: 63.0217s
	iters: 300, epoch: 10 | loss: 0.1760048
	speed: 0.0104s/iter; left time: 61.8378s
	iters: 400, epoch: 10 | loss: 0.1799096
	speed: 0.0104s/iter; left time: 60.9807s
	iters: 500, epoch: 10 | loss: 0.1478708
	speed: 0.0104s/iter; left time: 59.9301s
Epoch: 10 cost time: 6.2571611404418945
Epoch: 10, Steps: 570 | Train Loss: 0.1487861 Vali Loss: 0.0357359 Test Loss: 0.1317919
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1556313
	speed: 0.0366s/iter; left time: 204.9929s
	iters: 200, epoch: 11 | loss: 0.1240818
	speed: 0.0103s/iter; left time: 56.7884s
	iters: 300, epoch: 11 | loss: 0.1726120
	speed: 0.0103s/iter; left time: 55.8167s
	iters: 400, epoch: 11 | loss: 0.1796897
	speed: 0.0104s/iter; left time: 54.9463s
	iters: 500, epoch: 11 | loss: 0.1882090
	speed: 0.0103s/iter; left time: 53.7656s
Epoch: 11 cost time: 6.231760740280151
Epoch: 11, Steps: 570 | Train Loss: 0.1488069 Vali Loss: 0.0356273 Test Loss: 0.1317018
Validation loss decreased (0.035715 --> 0.035627).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1380893
	speed: 0.0390s/iter; left time: 196.2283s
	iters: 200, epoch: 12 | loss: 0.1281421
	speed: 0.0116s/iter; left time: 57.2603s
	iters: 300, epoch: 12 | loss: 0.1047546
	speed: 0.0116s/iter; left time: 56.1656s
	iters: 400, epoch: 12 | loss: 0.1520403
	speed: 0.0116s/iter; left time: 54.8781s
	iters: 500, epoch: 12 | loss: 0.0941967
	speed: 0.0116s/iter; left time: 53.7003s
Epoch: 12 cost time: 6.953601121902466
Epoch: 12, Steps: 570 | Train Loss: 0.1481076 Vali Loss: 0.0355528 Test Loss: 0.1316943
Validation loss decreased (0.035627 --> 0.035553).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1471522
	speed: 0.0391s/iter; left time: 174.4195s
	iters: 200, epoch: 13 | loss: 0.1055979
	speed: 0.0104s/iter; left time: 45.1621s
	iters: 300, epoch: 13 | loss: 0.1533886
	speed: 0.0103s/iter; left time: 44.0927s
	iters: 400, epoch: 13 | loss: 0.1410610
	speed: 0.0103s/iter; left time: 43.0016s
	iters: 500, epoch: 13 | loss: 0.1484631
	speed: 0.0103s/iter; left time: 42.0029s
Epoch: 13 cost time: 6.2565202713012695
Epoch: 13, Steps: 570 | Train Loss: 0.1485971 Vali Loss: 0.0356692 Test Loss: 0.1316693
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1239892
	speed: 0.0371s/iter; left time: 144.2502s
	iters: 200, epoch: 14 | loss: 0.2063132
	speed: 0.0104s/iter; left time: 39.5405s
	iters: 300, epoch: 14 | loss: 0.1241409
	speed: 0.0104s/iter; left time: 38.4898s
	iters: 400, epoch: 14 | loss: 0.1100171
	speed: 0.0104s/iter; left time: 37.4551s
	iters: 500, epoch: 14 | loss: 0.1930922
	speed: 0.0104s/iter; left time: 36.2513s
Epoch: 14 cost time: 6.243021488189697
Epoch: 14, Steps: 570 | Train Loss: 0.1476236 Vali Loss: 0.0355257 Test Loss: 0.1316903
Validation loss decreased (0.035553 --> 0.035526).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1035002
	speed: 0.0367s/iter; left time: 121.7300s
	iters: 200, epoch: 15 | loss: 0.1980224
	speed: 0.0103s/iter; left time: 33.1084s
	iters: 300, epoch: 15 | loss: 0.0984730
	speed: 0.0103s/iter; left time: 32.0724s
	iters: 400, epoch: 15 | loss: 0.0731379
	speed: 0.0103s/iter; left time: 31.0495s
	iters: 500, epoch: 15 | loss: 0.1822353
	speed: 0.0103s/iter; left time: 30.0148s
Epoch: 15 cost time: 6.179388761520386
Epoch: 15, Steps: 570 | Train Loss: 0.1486844 Vali Loss: 0.0356337 Test Loss: 0.1316834
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1485071
	speed: 0.0372s/iter; left time: 102.3520s
	iters: 200, epoch: 16 | loss: 0.1287357
	speed: 0.0104s/iter; left time: 27.4740s
	iters: 300, epoch: 16 | loss: 0.1634172
	speed: 0.0104s/iter; left time: 26.4478s
	iters: 400, epoch: 16 | loss: 0.1616101
	speed: 0.0104s/iter; left time: 25.4178s
	iters: 500, epoch: 16 | loss: 0.1720946
	speed: 0.0104s/iter; left time: 24.3599s
Epoch: 16 cost time: 6.256830930709839
Epoch: 16, Steps: 570 | Train Loss: 0.1485396 Vali Loss: 0.0357390 Test Loss: 0.1316859
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1091974
	speed: 0.0389s/iter; left time: 84.8608s
	iters: 200, epoch: 17 | loss: 0.0915420
	speed: 0.0117s/iter; left time: 24.2714s
	iters: 300, epoch: 17 | loss: 0.0852216
	speed: 0.0117s/iter; left time: 23.1007s
	iters: 400, epoch: 17 | loss: 0.1678971
	speed: 0.0114s/iter; left time: 21.3916s
	iters: 500, epoch: 17 | loss: 0.1045564
	speed: 0.0103s/iter; left time: 18.3698s
Epoch: 17 cost time: 6.716983318328857
Epoch: 17, Steps: 570 | Train Loss: 0.1473871 Vali Loss: 0.0357834 Test Loss: 0.1316891
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13179177045822144, mae:0.22624237835407257
>>> MS_Pen LR=5e-4 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3254177
	speed: 0.0241s/iter; left time: 272.9052s
	iters: 200, epoch: 1 | loss: 0.2781049
	speed: 0.0127s/iter; left time: 142.4669s
	iters: 300, epoch: 1 | loss: 0.1965409
	speed: 0.0127s/iter; left time: 140.7825s
	iters: 400, epoch: 1 | loss: 0.1161880
	speed: 0.0127s/iter; left time: 139.6892s
	iters: 500, epoch: 1 | loss: 0.2041972
	speed: 0.0127s/iter; left time: 138.8673s
Epoch: 1 cost time: 8.440219640731812
Epoch: 1, Steps: 570 | Train Loss: 0.2582289 Vali Loss: 0.0460031 Test Loss: 0.1399752
Validation loss decreased (inf --> 0.046003).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2203663
	speed: 0.0438s/iter; left time: 469.7894s
	iters: 200, epoch: 2 | loss: 0.1626608
	speed: 0.0127s/iter; left time: 134.8505s
	iters: 300, epoch: 2 | loss: 0.1800906
	speed: 0.0127s/iter; left time: 133.7156s
	iters: 400, epoch: 2 | loss: 0.1277430
	speed: 0.0127s/iter; left time: 132.3444s
	iters: 500, epoch: 2 | loss: 0.2005955
	speed: 0.0127s/iter; left time: 131.1962s
Epoch: 2 cost time: 7.494109630584717
Epoch: 2, Steps: 570 | Train Loss: 0.2247860 Vali Loss: 0.0399162 Test Loss: 0.1294428
Validation loss decreased (0.046003 --> 0.039916).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2577814
	speed: 0.0421s/iter; left time: 428.1528s
	iters: 200, epoch: 3 | loss: 0.2475287
	speed: 0.0118s/iter; left time: 118.2390s
	iters: 300, epoch: 3 | loss: 0.1232816
	speed: 0.0117s/iter; left time: 116.9952s
	iters: 400, epoch: 3 | loss: 0.2075683
	speed: 0.0117s/iter; left time: 115.7184s
	iters: 500, epoch: 3 | loss: 0.1390008
	speed: 0.0117s/iter; left time: 114.6453s
Epoch: 3 cost time: 7.031258583068848
Epoch: 3, Steps: 570 | Train Loss: 0.1970052 Vali Loss: 0.0398570 Test Loss: 0.1319171
Validation loss decreased (0.039916 --> 0.039857).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1410931
	speed: 0.0394s/iter; left time: 377.4448s
	iters: 200, epoch: 4 | loss: 0.2647894
	speed: 0.0127s/iter; left time: 120.9200s
	iters: 300, epoch: 4 | loss: 0.1054844
	speed: 0.0128s/iter; left time: 119.9569s
	iters: 400, epoch: 4 | loss: 0.1292179
	speed: 0.0128s/iter; left time: 118.5093s
	iters: 500, epoch: 4 | loss: 0.1449382
	speed: 0.0128s/iter; left time: 117.3910s
Epoch: 4 cost time: 7.544338226318359
Epoch: 4, Steps: 570 | Train Loss: 0.1787969 Vali Loss: 0.0369433 Test Loss: 0.1250953
Validation loss decreased (0.039857 --> 0.036943).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1482397
	speed: 0.0423s/iter; left time: 381.7653s
	iters: 200, epoch: 5 | loss: 0.1355253
	speed: 0.0127s/iter; left time: 113.5726s
	iters: 300, epoch: 5 | loss: 0.2026354
	speed: 0.0127s/iter; left time: 112.2916s
	iters: 400, epoch: 5 | loss: 0.1580335
	speed: 0.0127s/iter; left time: 110.9955s
	iters: 500, epoch: 5 | loss: 0.1505542
	speed: 0.0127s/iter; left time: 109.8475s
Epoch: 5 cost time: 7.593823194503784
Epoch: 5, Steps: 570 | Train Loss: 0.1679826 Vali Loss: 0.0377686 Test Loss: 0.1271574
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1471252
	speed: 0.0403s/iter; left time: 340.2306s
	iters: 200, epoch: 6 | loss: 0.0997673
	speed: 0.0117s/iter; left time: 97.9648s
	iters: 300, epoch: 6 | loss: 0.1902243
	speed: 0.0118s/iter; left time: 97.0406s
	iters: 400, epoch: 6 | loss: 0.1822238
	speed: 0.0118s/iter; left time: 96.0247s
	iters: 500, epoch: 6 | loss: 0.1164195
	speed: 0.0117s/iter; left time: 94.4411s
Epoch: 6 cost time: 7.024780750274658
Epoch: 6, Steps: 570 | Train Loss: 0.1622371 Vali Loss: 0.0357933 Test Loss: 0.1257069
Validation loss decreased (0.036943 --> 0.035793).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1892530
	speed: 0.0407s/iter; left time: 320.7070s
	iters: 200, epoch: 7 | loss: 0.1695713
	speed: 0.0119s/iter; left time: 92.2613s
	iters: 300, epoch: 7 | loss: 0.1414748
	speed: 0.0117s/iter; left time: 90.1556s
	iters: 400, epoch: 7 | loss: 0.1243770
	speed: 0.0117s/iter; left time: 88.9433s
	iters: 500, epoch: 7 | loss: 0.1404520
	speed: 0.0117s/iter; left time: 87.7577s
Epoch: 7 cost time: 7.130521059036255
Epoch: 7, Steps: 570 | Train Loss: 0.1575322 Vali Loss: 0.0357781 Test Loss: 0.1255608
Validation loss decreased (0.035793 --> 0.035778).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0994304
	speed: 0.0413s/iter; left time: 301.6748s
	iters: 200, epoch: 8 | loss: 0.1510689
	speed: 0.0127s/iter; left time: 91.5902s
	iters: 300, epoch: 8 | loss: 0.1599903
	speed: 0.0127s/iter; left time: 90.5754s
	iters: 400, epoch: 8 | loss: 0.1481994
	speed: 0.0127s/iter; left time: 89.1388s
	iters: 500, epoch: 8 | loss: 0.1265747
	speed: 0.0127s/iter; left time: 87.7612s
Epoch: 8 cost time: 7.519871711730957
Epoch: 8, Steps: 570 | Train Loss: 0.1578830 Vali Loss: 0.0353268 Test Loss: 0.1248348
Validation loss decreased (0.035778 --> 0.035327).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1220234
	speed: 0.0409s/iter; left time: 275.3988s
	iters: 200, epoch: 9 | loss: 0.1523666
	speed: 0.0127s/iter; left time: 84.6013s
	iters: 300, epoch: 9 | loss: 0.1599658
	speed: 0.0127s/iter; left time: 82.8273s
	iters: 400, epoch: 9 | loss: 0.1030478
	speed: 0.0126s/iter; left time: 81.3842s
	iters: 500, epoch: 9 | loss: 0.1614626
	speed: 0.0126s/iter; left time: 80.1405s
Epoch: 9 cost time: 7.550086975097656
Epoch: 9, Steps: 570 | Train Loss: 0.1572007 Vali Loss: 0.0351600 Test Loss: 0.1247449
Validation loss decreased (0.035327 --> 0.035160).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1240428
	speed: 0.0413s/iter; left time: 254.8291s
	iters: 200, epoch: 10 | loss: 0.1920227
	speed: 0.0127s/iter; left time: 76.9294s
	iters: 300, epoch: 10 | loss: 0.1319865
	speed: 0.0127s/iter; left time: 75.6470s
	iters: 400, epoch: 10 | loss: 0.1539828
	speed: 0.0127s/iter; left time: 74.3606s
	iters: 500, epoch: 10 | loss: 0.1988384
	speed: 0.0127s/iter; left time: 73.0610s
Epoch: 10 cost time: 7.478862762451172
Epoch: 10, Steps: 570 | Train Loss: 0.1561945 Vali Loss: 0.0353372 Test Loss: 0.1244036
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1266925
	speed: 0.0399s/iter; left time: 223.5092s
	iters: 200, epoch: 11 | loss: 0.2318586
	speed: 0.0128s/iter; left time: 70.5757s
	iters: 300, epoch: 11 | loss: 0.1616977
	speed: 0.0128s/iter; left time: 69.2918s
	iters: 400, epoch: 11 | loss: 0.1759623
	speed: 0.0128s/iter; left time: 67.6446s
	iters: 500, epoch: 11 | loss: 0.1839972
	speed: 0.0126s/iter; left time: 65.4425s
Epoch: 11 cost time: 7.6124608516693115
Epoch: 11, Steps: 570 | Train Loss: 0.1545606 Vali Loss: 0.0353854 Test Loss: 0.1246148
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1266512
	speed: 0.0413s/iter; left time: 207.5749s
	iters: 200, epoch: 12 | loss: 0.1155796
	speed: 0.0127s/iter; left time: 62.3847s
	iters: 300, epoch: 12 | loss: 0.1143849
	speed: 0.0117s/iter; left time: 56.7590s
	iters: 400, epoch: 12 | loss: 0.1348121
	speed: 0.0117s/iter; left time: 55.5861s
	iters: 500, epoch: 12 | loss: 0.1434616
	speed: 0.0118s/iter; left time: 54.4201s
Epoch: 12 cost time: 7.188130140304565
Epoch: 12, Steps: 570 | Train Loss: 0.1554102 Vali Loss: 0.0354858 Test Loss: 0.1246521
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.124893918633461, mae:0.21663524210453033
>>> MS_Pen LR=5e-4 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1567930
	speed: 0.0247s/iter; left time: 279.2381s
	iters: 200, epoch: 1 | loss: 0.3305114
	speed: 0.0125s/iter; left time: 140.4178s
	iters: 300, epoch: 1 | loss: 0.1631124
	speed: 0.0125s/iter; left time: 138.8378s
	iters: 400, epoch: 1 | loss: 0.2435155
	speed: 0.0125s/iter; left time: 137.7832s
	iters: 500, epoch: 1 | loss: 0.1617722
	speed: 0.0125s/iter; left time: 136.6702s
Epoch: 1 cost time: 8.414165258407593
Epoch: 1, Steps: 570 | Train Loss: 0.2337023 Vali Loss: 0.0428492 Test Loss: 0.1287041
Validation loss decreased (inf --> 0.042849).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1720411
	speed: 0.0406s/iter; left time: 435.2013s
	iters: 200, epoch: 2 | loss: 0.1291345
	speed: 0.0115s/iter; left time: 122.2565s
	iters: 300, epoch: 2 | loss: 0.1885253
	speed: 0.0115s/iter; left time: 121.1954s
	iters: 400, epoch: 2 | loss: 0.2810433
	speed: 0.0115s/iter; left time: 120.1017s
	iters: 500, epoch: 2 | loss: 0.3345742
	speed: 0.0115s/iter; left time: 118.9974s
Epoch: 2 cost time: 6.890681266784668
Epoch: 2, Steps: 570 | Train Loss: 0.2105565 Vali Loss: 0.0398170 Test Loss: 0.1295037
Validation loss decreased (0.042849 --> 0.039817).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2053368
	speed: 0.0397s/iter; left time: 403.6721s
	iters: 200, epoch: 3 | loss: 0.1105831
	speed: 0.0115s/iter; left time: 115.7065s
	iters: 300, epoch: 3 | loss: 0.2089761
	speed: 0.0115s/iter; left time: 114.3034s
	iters: 400, epoch: 3 | loss: 0.1659934
	speed: 0.0114s/iter; left time: 112.7841s
	iters: 500, epoch: 3 | loss: 0.2425914
	speed: 0.0114s/iter; left time: 111.4650s
Epoch: 3 cost time: 6.876866817474365
Epoch: 3, Steps: 570 | Train Loss: 0.1904023 Vali Loss: 0.0352141 Test Loss: 0.1195326
Validation loss decreased (0.039817 --> 0.035214).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1669895
	speed: 0.0397s/iter; left time: 381.1124s
	iters: 200, epoch: 4 | loss: 0.1152371
	speed: 0.0115s/iter; left time: 109.1295s
	iters: 300, epoch: 4 | loss: 0.0933346
	speed: 0.0115s/iter; left time: 108.1021s
	iters: 400, epoch: 4 | loss: 0.1523793
	speed: 0.0115s/iter; left time: 106.5489s
	iters: 500, epoch: 4 | loss: 0.1591292
	speed: 0.0114s/iter; left time: 105.0094s
Epoch: 4 cost time: 6.853704214096069
Epoch: 4, Steps: 570 | Train Loss: 0.1729866 Vali Loss: 0.0356293 Test Loss: 0.1176840
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1634175
	speed: 0.0390s/iter; left time: 352.0044s
	iters: 200, epoch: 5 | loss: 0.1219243
	speed: 0.0115s/iter; left time: 102.8083s
	iters: 300, epoch: 5 | loss: 0.2581292
	speed: 0.0115s/iter; left time: 101.5535s
	iters: 400, epoch: 5 | loss: 0.1495541
	speed: 0.0115s/iter; left time: 100.3080s
	iters: 500, epoch: 5 | loss: 0.1254942
	speed: 0.0115s/iter; left time: 99.0632s
Epoch: 5 cost time: 6.91405463218689
Epoch: 5, Steps: 570 | Train Loss: 0.1641927 Vali Loss: 0.0339777 Test Loss: 0.1160158
Validation loss decreased (0.035214 --> 0.033978).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1928113
	speed: 0.0400s/iter; left time: 338.3651s
	iters: 200, epoch: 6 | loss: 0.1741862
	speed: 0.0115s/iter; left time: 95.7750s
	iters: 300, epoch: 6 | loss: 0.1187352
	speed: 0.0115s/iter; left time: 94.6445s
	iters: 400, epoch: 6 | loss: 0.1112918
	speed: 0.0115s/iter; left time: 93.4391s
	iters: 500, epoch: 6 | loss: 0.1150149
	speed: 0.0115s/iter; left time: 92.3821s
Epoch: 6 cost time: 6.827870845794678
Epoch: 6, Steps: 570 | Train Loss: 0.1584907 Vali Loss: 0.0331687 Test Loss: 0.1146340
Validation loss decreased (0.033978 --> 0.033169).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1133566
	speed: 0.0400s/iter; left time: 315.1158s
	iters: 200, epoch: 7 | loss: 0.2109797
	speed: 0.0114s/iter; left time: 88.8864s
	iters: 300, epoch: 7 | loss: 0.0993572
	speed: 0.0114s/iter; left time: 87.6119s
	iters: 400, epoch: 7 | loss: 0.1232319
	speed: 0.0114s/iter; left time: 86.5853s
	iters: 500, epoch: 7 | loss: 0.1478358
	speed: 0.0114s/iter; left time: 85.3521s
Epoch: 7 cost time: 6.835991859436035
Epoch: 7, Steps: 570 | Train Loss: 0.1557335 Vali Loss: 0.0330611 Test Loss: 0.1140587
Validation loss decreased (0.033169 --> 0.033061).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1205570
	speed: 0.0399s/iter; left time: 291.4708s
	iters: 200, epoch: 8 | loss: 0.1754347
	speed: 0.0115s/iter; left time: 82.6634s
	iters: 300, epoch: 8 | loss: 0.0987336
	speed: 0.0115s/iter; left time: 81.5706s
	iters: 400, epoch: 8 | loss: 0.1431111
	speed: 0.0114s/iter; left time: 80.2716s
	iters: 500, epoch: 8 | loss: 0.1085133
	speed: 0.0115s/iter; left time: 79.1984s
Epoch: 8 cost time: 6.8414928913116455
Epoch: 8, Steps: 570 | Train Loss: 0.1544081 Vali Loss: 0.0333342 Test Loss: 0.1138396
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2280223
	speed: 0.0371s/iter; left time: 250.3126s
	iters: 200, epoch: 9 | loss: 0.1023071
	speed: 0.0120s/iter; left time: 79.8657s
	iters: 300, epoch: 9 | loss: 0.1735917
	speed: 0.0127s/iter; left time: 82.8030s
	iters: 400, epoch: 9 | loss: 0.1737816
	speed: 0.0126s/iter; left time: 81.3658s
	iters: 500, epoch: 9 | loss: 0.2331082
	speed: 0.0127s/iter; left time: 80.2186s
Epoch: 9 cost time: 7.309145927429199
Epoch: 9, Steps: 570 | Train Loss: 0.1530857 Vali Loss: 0.0331201 Test Loss: 0.1139045
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1469052
	speed: 0.0403s/iter; left time: 248.9224s
	iters: 200, epoch: 10 | loss: 0.1212100
	speed: 0.0126s/iter; left time: 76.2697s
	iters: 300, epoch: 10 | loss: 0.1373105
	speed: 0.0125s/iter; left time: 74.3789s
	iters: 400, epoch: 10 | loss: 0.1584136
	speed: 0.0114s/iter; left time: 67.0383s
	iters: 500, epoch: 10 | loss: 0.1572147
	speed: 0.0114s/iter; left time: 65.9978s
Epoch: 10 cost time: 7.149698257446289
Epoch: 10, Steps: 570 | Train Loss: 0.1537432 Vali Loss: 0.0330662 Test Loss: 0.1140209
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11420503258705139, mae:0.20484612882137299
>>> MS_Pen LR=5e-4 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2790729
	speed: 0.0226s/iter; left time: 255.5256s
	iters: 200, epoch: 1 | loss: 0.3400983
	speed: 0.0108s/iter; left time: 121.4757s
	iters: 300, epoch: 1 | loss: 0.3322260
	speed: 0.0108s/iter; left time: 119.9783s
	iters: 400, epoch: 1 | loss: 0.2618206
	speed: 0.0108s/iter; left time: 118.8532s
	iters: 500, epoch: 1 | loss: 0.2847362
	speed: 0.0108s/iter; left time: 117.9508s
Epoch: 1 cost time: 7.393933057785034
Epoch: 1, Steps: 570 | Train Loss: 0.2716769 Vali Loss: 0.0499812 Test Loss: 0.1562769
Validation loss decreased (inf --> 0.049981).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2558817
	speed: 0.0386s/iter; left time: 414.1035s
	iters: 200, epoch: 2 | loss: 0.3206442
	speed: 0.0110s/iter; left time: 117.0400s
	iters: 300, epoch: 2 | loss: 0.1604976
	speed: 0.0110s/iter; left time: 115.8609s
	iters: 400, epoch: 2 | loss: 0.1685851
	speed: 0.0110s/iter; left time: 114.3282s
	iters: 500, epoch: 2 | loss: 0.2255012
	speed: 0.0110s/iter; left time: 113.2225s
Epoch: 2 cost time: 6.570694923400879
Epoch: 2, Steps: 570 | Train Loss: 0.2404269 Vali Loss: 0.0463378 Test Loss: 0.1514099
Validation loss decreased (0.049981 --> 0.046338).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1604055
	speed: 0.0394s/iter; left time: 400.0063s
	iters: 200, epoch: 3 | loss: 0.1558073
	speed: 0.0121s/iter; left time: 121.5038s
	iters: 300, epoch: 3 | loss: 0.2171490
	speed: 0.0121s/iter; left time: 120.5109s
	iters: 400, epoch: 3 | loss: 0.1887526
	speed: 0.0121s/iter; left time: 119.1357s
	iters: 500, epoch: 3 | loss: 0.1702587
	speed: 0.0121s/iter; left time: 117.8082s
Epoch: 3 cost time: 7.1372292041778564
Epoch: 3, Steps: 570 | Train Loss: 0.2092538 Vali Loss: 0.0423608 Test Loss: 0.1368277
Validation loss decreased (0.046338 --> 0.042361).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1892147
	speed: 0.0379s/iter; left time: 363.8790s
	iters: 200, epoch: 4 | loss: 0.1268705
	speed: 0.0109s/iter; left time: 103.4092s
	iters: 300, epoch: 4 | loss: 0.1492467
	speed: 0.0109s/iter; left time: 102.5675s
	iters: 400, epoch: 4 | loss: 0.3276152
	speed: 0.0109s/iter; left time: 101.2488s
	iters: 500, epoch: 4 | loss: 0.2012120
	speed: 0.0109s/iter; left time: 100.3098s
Epoch: 4 cost time: 6.579840898513794
Epoch: 4, Steps: 570 | Train Loss: 0.1879575 Vali Loss: 0.0395793 Test Loss: 0.1346499
Validation loss decreased (0.042361 --> 0.039579).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1568244
	speed: 0.0379s/iter; left time: 341.9025s
	iters: 200, epoch: 5 | loss: 0.1659507
	speed: 0.0109s/iter; left time: 97.3388s
	iters: 300, epoch: 5 | loss: 0.1669364
	speed: 0.0109s/iter; left time: 96.1591s
	iters: 400, epoch: 5 | loss: 0.1568761
	speed: 0.0109s/iter; left time: 95.2945s
	iters: 500, epoch: 5 | loss: 0.2456201
	speed: 0.0109s/iter; left time: 94.0661s
Epoch: 5 cost time: 6.502733945846558
Epoch: 5, Steps: 570 | Train Loss: 0.1767724 Vali Loss: 0.0381733 Test Loss: 0.1294960
Validation loss decreased (0.039579 --> 0.038173).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1559645
	speed: 0.0374s/iter; left time: 316.1303s
	iters: 200, epoch: 6 | loss: 0.1647708
	speed: 0.0109s/iter; left time: 91.3924s
	iters: 300, epoch: 6 | loss: 0.1819237
	speed: 0.0110s/iter; left time: 90.4737s
	iters: 400, epoch: 6 | loss: 0.1640819
	speed: 0.0109s/iter; left time: 89.0035s
	iters: 500, epoch: 6 | loss: 0.1665080
	speed: 0.0109s/iter; left time: 87.9157s
Epoch: 6 cost time: 6.513271331787109
Epoch: 6, Steps: 570 | Train Loss: 0.1684036 Vali Loss: 0.0377962 Test Loss: 0.1321992
Validation loss decreased (0.038173 --> 0.037796).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1372134
	speed: 0.0384s/iter; left time: 302.4673s
	iters: 200, epoch: 7 | loss: 0.1296499
	speed: 0.0109s/iter; left time: 84.6342s
	iters: 300, epoch: 7 | loss: 0.1019198
	speed: 0.0108s/iter; left time: 83.2466s
	iters: 400, epoch: 7 | loss: 0.1502118
	speed: 0.0108s/iter; left time: 81.9856s
	iters: 500, epoch: 7 | loss: 0.1172761
	speed: 0.0108s/iter; left time: 80.8963s
Epoch: 7 cost time: 6.490926742553711
Epoch: 7, Steps: 570 | Train Loss: 0.1650041 Vali Loss: 0.0374530 Test Loss: 0.1305297
Validation loss decreased (0.037796 --> 0.037453).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1133899
	speed: 0.0371s/iter; left time: 271.5743s
	iters: 200, epoch: 8 | loss: 0.2136709
	speed: 0.0109s/iter; left time: 78.2582s
	iters: 300, epoch: 8 | loss: 0.2191338
	speed: 0.0108s/iter; left time: 77.1022s
	iters: 400, epoch: 8 | loss: 0.1386452
	speed: 0.0109s/iter; left time: 76.1173s
	iters: 500, epoch: 8 | loss: 0.1247035
	speed: 0.0109s/iter; left time: 75.0011s
Epoch: 8 cost time: 6.508927822113037
Epoch: 8, Steps: 570 | Train Loss: 0.1630762 Vali Loss: 0.0372598 Test Loss: 0.1306198
Validation loss decreased (0.037453 --> 0.037260).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2070881
	speed: 0.0387s/iter; left time: 261.2124s
	iters: 200, epoch: 9 | loss: 0.1380206
	speed: 0.0109s/iter; left time: 72.1326s
	iters: 300, epoch: 9 | loss: 0.2335347
	speed: 0.0109s/iter; left time: 71.1433s
	iters: 400, epoch: 9 | loss: 0.2160635
	speed: 0.0109s/iter; left time: 70.0659s
	iters: 500, epoch: 9 | loss: 0.1167727
	speed: 0.0109s/iter; left time: 68.9413s
Epoch: 9 cost time: 6.502180099487305
Epoch: 9, Steps: 570 | Train Loss: 0.1626328 Vali Loss: 0.0371963 Test Loss: 0.1300201
Validation loss decreased (0.037260 --> 0.037196).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1717370
	speed: 0.0367s/iter; left time: 226.6001s
	iters: 200, epoch: 10 | loss: 0.0903480
	speed: 0.0108s/iter; left time: 65.7516s
	iters: 300, epoch: 10 | loss: 0.1979104
	speed: 0.0108s/iter; left time: 64.6455s
	iters: 400, epoch: 10 | loss: 0.1418974
	speed: 0.0108s/iter; left time: 63.5538s
	iters: 500, epoch: 10 | loss: 0.1564228
	speed: 0.0108s/iter; left time: 62.5076s
Epoch: 10 cost time: 6.460204839706421
Epoch: 10, Steps: 570 | Train Loss: 0.1614973 Vali Loss: 0.0373495 Test Loss: 0.1304106
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1286653
	speed: 0.0374s/iter; left time: 209.4667s
	iters: 200, epoch: 11 | loss: 0.1525767
	speed: 0.0108s/iter; left time: 59.4220s
	iters: 300, epoch: 11 | loss: 0.1530359
	speed: 0.0108s/iter; left time: 58.1943s
	iters: 400, epoch: 11 | loss: 0.1079395
	speed: 0.0108s/iter; left time: 57.2871s
	iters: 500, epoch: 11 | loss: 0.1342159
	speed: 0.0108s/iter; left time: 56.1985s
Epoch: 11 cost time: 6.427305221557617
Epoch: 11, Steps: 570 | Train Loss: 0.1609980 Vali Loss: 0.0372909 Test Loss: 0.1303818
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1751136
	speed: 0.0374s/iter; left time: 188.0175s
	iters: 200, epoch: 12 | loss: 0.2067647
	speed: 0.0108s/iter; left time: 53.4285s
	iters: 300, epoch: 12 | loss: 0.1833843
	speed: 0.0108s/iter; left time: 52.3923s
	iters: 400, epoch: 12 | loss: 0.1705329
	speed: 0.0109s/iter; left time: 51.3317s
	iters: 500, epoch: 12 | loss: 0.1693156
	speed: 0.0108s/iter; left time: 50.2305s
Epoch: 12 cost time: 6.466021299362183
Epoch: 12, Steps: 570 | Train Loss: 0.1614449 Vali Loss: 0.0373156 Test Loss: 0.1304111
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1301376074552536, mae:0.2279544174671173
>>> MS_Pen LR=5e-4 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2054587
	speed: 0.0262s/iter; left time: 295.6689s
	iters: 200, epoch: 1 | loss: 0.1713141
	speed: 0.0144s/iter; left time: 161.3785s
	iters: 300, epoch: 1 | loss: 0.3100350
	speed: 0.0144s/iter; left time: 159.7154s
	iters: 400, epoch: 1 | loss: 0.2015884
	speed: 0.0144s/iter; left time: 158.6255s
	iters: 500, epoch: 1 | loss: 0.1629674
	speed: 0.0144s/iter; left time: 157.1437s
Epoch: 1 cost time: 9.43902850151062
Epoch: 1, Steps: 570 | Train Loss: 0.2412349 Vali Loss: 0.0434974 Test Loss: 0.1338336
Validation loss decreased (inf --> 0.043497).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2410098
	speed: 0.0472s/iter; left time: 506.2002s
	iters: 200, epoch: 2 | loss: 0.1796810
	speed: 0.0145s/iter; left time: 154.0268s
	iters: 300, epoch: 2 | loss: 0.1612514
	speed: 0.0145s/iter; left time: 152.6683s
	iters: 400, epoch: 2 | loss: 0.1291539
	speed: 0.0145s/iter; left time: 150.8785s
	iters: 500, epoch: 2 | loss: 0.2188989
	speed: 0.0145s/iter; left time: 149.8404s
Epoch: 2 cost time: 8.553593635559082
Epoch: 2, Steps: 570 | Train Loss: 0.2047078 Vali Loss: 0.0392928 Test Loss: 0.1340238
Validation loss decreased (0.043497 --> 0.039293).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3099940
	speed: 0.0475s/iter; left time: 483.0711s
	iters: 200, epoch: 3 | loss: 0.1770425
	speed: 0.0144s/iter; left time: 144.8070s
	iters: 300, epoch: 3 | loss: 0.1049618
	speed: 0.0144s/iter; left time: 143.8419s
	iters: 400, epoch: 3 | loss: 0.1321135
	speed: 0.0144s/iter; left time: 142.1073s
	iters: 500, epoch: 3 | loss: 0.1129621
	speed: 0.0144s/iter; left time: 140.2886s
Epoch: 3 cost time: 8.489612102508545
Epoch: 3, Steps: 570 | Train Loss: 0.1757855 Vali Loss: 0.0362650 Test Loss: 0.1320688
Validation loss decreased (0.039293 --> 0.036265).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1354017
	speed: 0.0476s/iter; left time: 456.1837s
	iters: 200, epoch: 4 | loss: 0.1309670
	speed: 0.0146s/iter; left time: 138.4533s
	iters: 300, epoch: 4 | loss: 0.1805794
	speed: 0.0146s/iter; left time: 136.8007s
	iters: 400, epoch: 4 | loss: 0.1846922
	speed: 0.0145s/iter; left time: 134.8490s
	iters: 500, epoch: 4 | loss: 0.1334161
	speed: 0.0145s/iter; left time: 133.7229s
Epoch: 4 cost time: 8.59368634223938
Epoch: 4, Steps: 570 | Train Loss: 0.1563498 Vali Loss: 0.0367016 Test Loss: 0.1334485
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1289576
	speed: 0.0474s/iter; left time: 427.6380s
	iters: 200, epoch: 5 | loss: 0.1326087
	speed: 0.0153s/iter; left time: 136.0737s
	iters: 300, epoch: 5 | loss: 0.1348843
	speed: 0.0145s/iter; left time: 128.1880s
	iters: 400, epoch: 5 | loss: 0.1616173
	speed: 0.0160s/iter; left time: 139.7696s
	iters: 500, epoch: 5 | loss: 0.1722075
	speed: 0.0163s/iter; left time: 140.6194s
Epoch: 5 cost time: 9.173981428146362
Epoch: 5, Steps: 570 | Train Loss: 0.1474794 Vali Loss: 0.0367747 Test Loss: 0.1338779
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1142071
	speed: 0.0460s/iter; left time: 388.9687s
	iters: 200, epoch: 6 | loss: 0.1415030
	speed: 0.0144s/iter; left time: 120.6203s
	iters: 300, epoch: 6 | loss: 0.0945829
	speed: 0.0145s/iter; left time: 119.2386s
	iters: 400, epoch: 6 | loss: 0.1224431
	speed: 0.0144s/iter; left time: 117.6518s
	iters: 500, epoch: 6 | loss: 0.1499815
	speed: 0.0144s/iter; left time: 116.0565s
Epoch: 6 cost time: 8.505453824996948
Epoch: 6, Steps: 570 | Train Loss: 0.1417294 Vali Loss: 0.0365584 Test Loss: 0.1328406
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13221360743045807, mae:0.22430545091629028
>>> MS_Pen LR=5e-4 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3112310
	speed: 0.0277s/iter; left time: 312.5059s
	iters: 200, epoch: 1 | loss: 0.2779824
	speed: 0.0159s/iter; left time: 178.2897s
	iters: 300, epoch: 1 | loss: 0.1411805
	speed: 0.0159s/iter; left time: 176.8389s
	iters: 400, epoch: 1 | loss: 0.3223324
	speed: 0.0160s/iter; left time: 175.6439s
	iters: 500, epoch: 1 | loss: 0.1800265
	speed: 0.0160s/iter; left time: 174.2414s
Epoch: 1 cost time: 10.310043096542358
Epoch: 1, Steps: 570 | Train Loss: 0.2215261 Vali Loss: 0.0450065 Test Loss: 0.1367873
Validation loss decreased (inf --> 0.045006).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1408287
	speed: 0.0486s/iter; left time: 521.5565s
	iters: 200, epoch: 2 | loss: 0.2612531
	speed: 0.0143s/iter; left time: 152.4519s
	iters: 300, epoch: 2 | loss: 0.2083541
	speed: 0.0143s/iter; left time: 150.9423s
	iters: 400, epoch: 2 | loss: 0.1656047
	speed: 0.0143s/iter; left time: 149.6262s
	iters: 500, epoch: 2 | loss: 0.1876193
	speed: 0.0144s/iter; left time: 148.2526s
Epoch: 2 cost time: 8.466490030288696
Epoch: 2, Steps: 570 | Train Loss: 0.1913543 Vali Loss: 0.0387846 Test Loss: 0.1249044
Validation loss decreased (0.045006 --> 0.038785).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1667272
	speed: 0.0450s/iter; left time: 457.4107s
	iters: 200, epoch: 3 | loss: 0.0765688
	speed: 0.0141s/iter; left time: 141.6177s
	iters: 300, epoch: 3 | loss: 0.2160627
	speed: 0.0141s/iter; left time: 140.4827s
	iters: 400, epoch: 3 | loss: 0.1159166
	speed: 0.0142s/iter; left time: 139.8722s
	iters: 500, epoch: 3 | loss: 0.1562586
	speed: 0.0142s/iter; left time: 138.6824s
Epoch: 3 cost time: 8.34152340888977
Epoch: 3, Steps: 570 | Train Loss: 0.1656087 Vali Loss: 0.0381127 Test Loss: 0.1207009
Validation loss decreased (0.038785 --> 0.038113).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1601158
	speed: 0.0448s/iter; left time: 430.1400s
	iters: 200, epoch: 4 | loss: 0.1763500
	speed: 0.0143s/iter; left time: 135.5818s
	iters: 300, epoch: 4 | loss: 0.1817715
	speed: 0.0143s/iter; left time: 134.0752s
	iters: 400, epoch: 4 | loss: 0.0945800
	speed: 0.0143s/iter; left time: 132.9136s
	iters: 500, epoch: 4 | loss: 0.1084819
	speed: 0.0143s/iter; left time: 131.6402s
Epoch: 4 cost time: 8.436381578445435
Epoch: 4, Steps: 570 | Train Loss: 0.1546835 Vali Loss: 0.0350287 Test Loss: 0.1190882
Validation loss decreased (0.038113 --> 0.035029).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0864550
	speed: 0.0464s/iter; left time: 418.2305s
	iters: 200, epoch: 5 | loss: 0.1734241
	speed: 0.0143s/iter; left time: 127.3623s
	iters: 300, epoch: 5 | loss: 0.1977838
	speed: 0.0143s/iter; left time: 125.8854s
	iters: 400, epoch: 5 | loss: 0.0973368
	speed: 0.0143s/iter; left time: 124.4202s
	iters: 500, epoch: 5 | loss: 0.1694889
	speed: 0.0143s/iter; left time: 123.0521s
Epoch: 5 cost time: 8.419260025024414
Epoch: 5, Steps: 570 | Train Loss: 0.1463569 Vali Loss: 0.0342261 Test Loss: 0.1174238
Validation loss decreased (0.035029 --> 0.034226).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1538003
	speed: 0.0468s/iter; left time: 395.8248s
	iters: 200, epoch: 6 | loss: 0.2408272
	speed: 0.0142s/iter; left time: 118.8352s
	iters: 300, epoch: 6 | loss: 0.2196805
	speed: 0.0143s/iter; left time: 117.8010s
	iters: 400, epoch: 6 | loss: 0.1599859
	speed: 0.0142s/iter; left time: 115.9950s
	iters: 500, epoch: 6 | loss: 0.1688049
	speed: 0.0142s/iter; left time: 114.6017s
Epoch: 6 cost time: 8.432271242141724
Epoch: 6, Steps: 570 | Train Loss: 0.1434283 Vali Loss: 0.0336912 Test Loss: 0.1177072
Validation loss decreased (0.034226 --> 0.033691).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1132379
	speed: 0.0468s/iter; left time: 368.9332s
	iters: 200, epoch: 7 | loss: 0.1371254
	speed: 0.0142s/iter; left time: 110.5114s
	iters: 300, epoch: 7 | loss: 0.2336957
	speed: 0.0142s/iter; left time: 109.0505s
	iters: 400, epoch: 7 | loss: 0.1382759
	speed: 0.0142s/iter; left time: 107.6602s
	iters: 500, epoch: 7 | loss: 0.1689064
	speed: 0.0142s/iter; left time: 106.2315s
Epoch: 7 cost time: 8.4871187210083
Epoch: 7, Steps: 570 | Train Loss: 0.1406887 Vali Loss: 0.0338299 Test Loss: 0.1172446
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0952986
	speed: 0.0461s/iter; left time: 337.2690s
	iters: 200, epoch: 8 | loss: 0.1492710
	speed: 0.0142s/iter; left time: 102.6766s
	iters: 300, epoch: 8 | loss: 0.2126602
	speed: 0.0143s/iter; left time: 101.5014s
	iters: 400, epoch: 8 | loss: 0.1406239
	speed: 0.0143s/iter; left time: 100.0069s
	iters: 500, epoch: 8 | loss: 0.1580255
	speed: 0.0143s/iter; left time: 98.5254s
Epoch: 8 cost time: 8.430214881896973
Epoch: 8, Steps: 570 | Train Loss: 0.1395139 Vali Loss: 0.0335226 Test Loss: 0.1165608
Validation loss decreased (0.033691 --> 0.033523).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1172781
	speed: 0.0469s/iter; left time: 316.1551s
	iters: 200, epoch: 9 | loss: 0.1013584
	speed: 0.0143s/iter; left time: 94.7546s
	iters: 300, epoch: 9 | loss: 0.1741229
	speed: 0.0143s/iter; left time: 93.4371s
	iters: 400, epoch: 9 | loss: 0.1405626
	speed: 0.0142s/iter; left time: 91.5989s
	iters: 500, epoch: 9 | loss: 0.1434790
	speed: 0.0143s/iter; left time: 90.4536s
Epoch: 9 cost time: 8.449994564056396
Epoch: 9, Steps: 570 | Train Loss: 0.1383105 Vali Loss: 0.0334006 Test Loss: 0.1165702
Validation loss decreased (0.033523 --> 0.033401).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1430157
	speed: 0.0453s/iter; left time: 279.7463s
	iters: 200, epoch: 10 | loss: 0.1110714
	speed: 0.0143s/iter; left time: 86.6779s
	iters: 300, epoch: 10 | loss: 0.1298713
	speed: 0.0143s/iter; left time: 85.2041s
	iters: 400, epoch: 10 | loss: 0.1276461
	speed: 0.0142s/iter; left time: 83.5520s
	iters: 500, epoch: 10 | loss: 0.1677773
	speed: 0.0143s/iter; left time: 82.2630s
Epoch: 10 cost time: 8.423184156417847
Epoch: 10, Steps: 570 | Train Loss: 0.1381848 Vali Loss: 0.0333797 Test Loss: 0.1168130
Validation loss decreased (0.033401 --> 0.033380).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2084910
	speed: 0.0462s/iter; left time: 258.5248s
	iters: 200, epoch: 11 | loss: 0.1333878
	speed: 0.0143s/iter; left time: 78.5961s
	iters: 300, epoch: 11 | loss: 0.1652329
	speed: 0.0142s/iter; left time: 76.9047s
	iters: 400, epoch: 11 | loss: 0.0999873
	speed: 0.0143s/iter; left time: 75.7312s
	iters: 500, epoch: 11 | loss: 0.2098907
	speed: 0.0142s/iter; left time: 74.0946s
Epoch: 11 cost time: 8.428815603256226
Epoch: 11, Steps: 570 | Train Loss: 0.1372966 Vali Loss: 0.0333866 Test Loss: 0.1166108
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1857953
	speed: 0.0452s/iter; left time: 227.6281s
	iters: 200, epoch: 12 | loss: 0.1721203
	speed: 0.0143s/iter; left time: 70.4020s
	iters: 300, epoch: 12 | loss: 0.1104943
	speed: 0.0142s/iter; left time: 68.6935s
	iters: 400, epoch: 12 | loss: 0.1627085
	speed: 0.0142s/iter; left time: 67.4119s
	iters: 500, epoch: 12 | loss: 0.1704671
	speed: 0.0142s/iter; left time: 65.8889s
Epoch: 12 cost time: 8.400481462478638
Epoch: 12, Steps: 570 | Train Loss: 0.1393600 Vali Loss: 0.0335047 Test Loss: 0.1166232
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1267772
	speed: 0.0477s/iter; left time: 212.9564s
	iters: 200, epoch: 13 | loss: 0.0936469
	speed: 0.0142s/iter; left time: 62.1230s
	iters: 300, epoch: 13 | loss: 0.1231575
	speed: 0.0142s/iter; left time: 60.6674s
	iters: 400, epoch: 13 | loss: 0.0881526
	speed: 0.0142s/iter; left time: 59.0575s
	iters: 500, epoch: 13 | loss: 0.1377667
	speed: 0.0142s/iter; left time: 57.7657s
Epoch: 13 cost time: 8.395596981048584
Epoch: 13, Steps: 570 | Train Loss: 0.1385717 Vali Loss: 0.0334127 Test Loss: 0.1166206
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11691029369831085, mae:0.20494437217712402
>>> MS_Pen LR=5e-4 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1490074
	speed: 0.0277s/iter; left time: 312.5587s
	iters: 200, epoch: 1 | loss: 0.3383349
	speed: 0.0160s/iter; left time: 179.7041s
	iters: 300, epoch: 1 | loss: 0.3029401
	speed: 0.0160s/iter; left time: 177.5446s
	iters: 400, epoch: 1 | loss: 0.2450822
	speed: 0.0160s/iter; left time: 175.9642s
	iters: 500, epoch: 1 | loss: 0.2842770
	speed: 0.0161s/iter; left time: 175.2035s
Epoch: 1 cost time: 10.3483145236969
Epoch: 1, Steps: 570 | Train Loss: 0.2482602 Vali Loss: 0.0489800 Test Loss: 0.1486279
Validation loss decreased (inf --> 0.048980).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1972764
	speed: 0.0474s/iter; left time: 508.9085s
	iters: 200, epoch: 2 | loss: 0.1562154
	speed: 0.0143s/iter; left time: 152.3881s
	iters: 300, epoch: 2 | loss: 0.1371049
	speed: 0.0144s/iter; left time: 151.4342s
	iters: 400, epoch: 2 | loss: 0.1425201
	speed: 0.0144s/iter; left time: 149.9126s
	iters: 500, epoch: 2 | loss: 0.2674016
	speed: 0.0144s/iter; left time: 148.4764s
Epoch: 2 cost time: 8.504266500473022
Epoch: 2, Steps: 570 | Train Loss: 0.2120532 Vali Loss: 0.0435264 Test Loss: 0.1361995
Validation loss decreased (0.048980 --> 0.043526).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2157201
	speed: 0.0473s/iter; left time: 480.2255s
	iters: 200, epoch: 3 | loss: 0.2266513
	speed: 0.0144s/iter; left time: 144.4620s
	iters: 300, epoch: 3 | loss: 0.1438986
	speed: 0.0143s/iter; left time: 142.7423s
	iters: 400, epoch: 3 | loss: 0.1605911
	speed: 0.0144s/iter; left time: 141.6057s
	iters: 500, epoch: 3 | loss: 0.2193997
	speed: 0.0143s/iter; left time: 139.9160s
Epoch: 3 cost time: 8.49675464630127
Epoch: 3, Steps: 570 | Train Loss: 0.1775531 Vali Loss: 0.0394976 Test Loss: 0.1270039
Validation loss decreased (0.043526 --> 0.039498).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1796758
	speed: 0.0462s/iter; left time: 443.2085s
	iters: 200, epoch: 4 | loss: 0.1533782
	speed: 0.0144s/iter; left time: 136.8090s
	iters: 300, epoch: 4 | loss: 0.1586350
	speed: 0.0144s/iter; left time: 135.0280s
	iters: 400, epoch: 4 | loss: 0.1548672
	speed: 0.0143s/iter; left time: 133.3225s
	iters: 500, epoch: 4 | loss: 0.1106565
	speed: 0.0143s/iter; left time: 131.8774s
Epoch: 4 cost time: 8.492732524871826
Epoch: 4, Steps: 570 | Train Loss: 0.1598992 Vali Loss: 0.0374221 Test Loss: 0.1299095
Validation loss decreased (0.039498 --> 0.037422).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1485575
	speed: 0.0457s/iter; left time: 412.1360s
	iters: 200, epoch: 5 | loss: 0.1678060
	speed: 0.0143s/iter; left time: 127.2165s
	iters: 300, epoch: 5 | loss: 0.1335052
	speed: 0.0143s/iter; left time: 125.9055s
	iters: 400, epoch: 5 | loss: 0.2053581
	speed: 0.0143s/iter; left time: 124.2964s
	iters: 500, epoch: 5 | loss: 0.1065122
	speed: 0.0143s/iter; left time: 123.0686s
Epoch: 5 cost time: 8.41992473602295
Epoch: 5, Steps: 570 | Train Loss: 0.1495341 Vali Loss: 0.0381728 Test Loss: 0.1296885
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1571065
	speed: 0.0466s/iter; left time: 393.5199s
	iters: 200, epoch: 6 | loss: 0.1469583
	speed: 0.0142s/iter; left time: 118.7860s
	iters: 300, epoch: 6 | loss: 0.0884379
	speed: 0.0142s/iter; left time: 117.2295s
	iters: 400, epoch: 6 | loss: 0.1774802
	speed: 0.0142s/iter; left time: 115.4732s
	iters: 500, epoch: 6 | loss: 0.1431828
	speed: 0.0142s/iter; left time: 114.0775s
Epoch: 6 cost time: 8.37146258354187
Epoch: 6, Steps: 570 | Train Loss: 0.1457141 Vali Loss: 0.0378659 Test Loss: 0.1293644
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1833263
	speed: 0.0453s/iter; left time: 357.0199s
	iters: 200, epoch: 7 | loss: 0.1046223
	speed: 0.0143s/iter; left time: 111.1164s
	iters: 300, epoch: 7 | loss: 0.0964961
	speed: 0.0143s/iter; left time: 109.8468s
	iters: 400, epoch: 7 | loss: 0.1980914
	speed: 0.0143s/iter; left time: 108.3316s
	iters: 500, epoch: 7 | loss: 0.1411877
	speed: 0.0143s/iter; left time: 107.2240s
Epoch: 7 cost time: 8.410446643829346
Epoch: 7, Steps: 570 | Train Loss: 0.1437394 Vali Loss: 0.0375999 Test Loss: 0.1292526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13001427054405212, mae:0.22678065299987793
>>> MS_Pen LR=5e-4 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2744921
	speed: 0.0303s/iter; left time: 342.1831s
	iters: 200, epoch: 1 | loss: 0.1997632
	speed: 0.0184s/iter; left time: 206.1090s
	iters: 300, epoch: 1 | loss: 0.2601717
	speed: 0.0184s/iter; left time: 204.0586s
	iters: 400, epoch: 1 | loss: 0.2320293
	speed: 0.0170s/iter; left time: 187.3096s
	iters: 500, epoch: 1 | loss: 0.1511500
	speed: 0.0169s/iter; left time: 183.9349s
Epoch: 1 cost time: 11.333147525787354
Epoch: 1, Steps: 570 | Train Loss: 0.2549926 Vali Loss: 0.0459795 Test Loss: 0.1380558
Validation loss decreased (inf --> 0.045980).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3296778
	speed: 0.0515s/iter; left time: 552.3706s
	iters: 200, epoch: 2 | loss: 0.2437784
	speed: 0.0170s/iter; left time: 180.3239s
	iters: 300, epoch: 2 | loss: 0.2618904
	speed: 0.0170s/iter; left time: 178.5299s
	iters: 400, epoch: 2 | loss: 0.1828166
	speed: 0.0169s/iter; left time: 176.6667s
	iters: 500, epoch: 2 | loss: 0.2265285
	speed: 0.0169s/iter; left time: 174.9888s
Epoch: 2 cost time: 9.992257595062256
Epoch: 2, Steps: 570 | Train Loss: 0.2360005 Vali Loss: 0.0489197 Test Loss: 0.1555847
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2072370
	speed: 0.0517s/iter; left time: 525.5860s
	iters: 200, epoch: 3 | loss: 0.1907318
	speed: 0.0169s/iter; left time: 170.2526s
	iters: 300, epoch: 3 | loss: 0.3687034
	speed: 0.0170s/iter; left time: 169.3647s
	iters: 400, epoch: 3 | loss: 0.1754118
	speed: 0.0170s/iter; left time: 167.4169s
	iters: 500, epoch: 3 | loss: 0.1964826
	speed: 0.0170s/iter; left time: 165.7670s
Epoch: 3 cost time: 9.94178056716919
Epoch: 3, Steps: 570 | Train Loss: 0.2102810 Vali Loss: 0.0418692 Test Loss: 0.1310567
Validation loss decreased (0.045980 --> 0.041869).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1440787
	speed: 0.0516s/iter; left time: 494.5586s
	iters: 200, epoch: 4 | loss: 0.1897883
	speed: 0.0169s/iter; left time: 160.4266s
	iters: 300, epoch: 4 | loss: 0.2212724
	speed: 0.0169s/iter; left time: 158.8741s
	iters: 400, epoch: 4 | loss: 0.2139459
	speed: 0.0169s/iter; left time: 157.1416s
	iters: 500, epoch: 4 | loss: 0.2013232
	speed: 0.0169s/iter; left time: 155.5775s
Epoch: 4 cost time: 9.975809335708618
Epoch: 4, Steps: 570 | Train Loss: 0.1888069 Vali Loss: 0.0389621 Test Loss: 0.1325567
Validation loss decreased (0.041869 --> 0.038962).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1280999
	speed: 0.0530s/iter; left time: 478.5361s
	iters: 200, epoch: 5 | loss: 0.2545468
	speed: 0.0169s/iter; left time: 151.0028s
	iters: 300, epoch: 5 | loss: 0.1663933
	speed: 0.0169s/iter; left time: 149.0251s
	iters: 400, epoch: 5 | loss: 0.2217937
	speed: 0.0169s/iter; left time: 147.2891s
	iters: 500, epoch: 5 | loss: 0.1244933
	speed: 0.0169s/iter; left time: 145.7383s
Epoch: 5 cost time: 10.070308685302734
Epoch: 5, Steps: 570 | Train Loss: 0.1761667 Vali Loss: 0.0381214 Test Loss: 0.1321196
Validation loss decreased (0.038962 --> 0.038121).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2076235
	speed: 0.0513s/iter; left time: 433.1732s
	iters: 200, epoch: 6 | loss: 0.1418305
	speed: 0.0169s/iter; left time: 140.7473s
	iters: 300, epoch: 6 | loss: 0.2075805
	speed: 0.0169s/iter; left time: 139.2480s
	iters: 400, epoch: 6 | loss: 0.2468255
	speed: 0.0169s/iter; left time: 137.4118s
	iters: 500, epoch: 6 | loss: 0.1452990
	speed: 0.0169s/iter; left time: 135.6976s
Epoch: 6 cost time: 9.942892074584961
Epoch: 6, Steps: 570 | Train Loss: 0.1698872 Vali Loss: 0.0370260 Test Loss: 0.1277786
Validation loss decreased (0.038121 --> 0.037026).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1612678
	speed: 0.0508s/iter; left time: 400.2303s
	iters: 200, epoch: 7 | loss: 0.1971225
	speed: 0.0169s/iter; left time: 131.3927s
	iters: 300, epoch: 7 | loss: 0.2121734
	speed: 0.0169s/iter; left time: 129.5620s
	iters: 400, epoch: 7 | loss: 0.1239359
	speed: 0.0169s/iter; left time: 128.0414s
	iters: 500, epoch: 7 | loss: 0.1272834
	speed: 0.0169s/iter; left time: 126.1758s
Epoch: 7 cost time: 9.90110445022583
Epoch: 7, Steps: 570 | Train Loss: 0.1649706 Vali Loss: 0.0369862 Test Loss: 0.1293132
Validation loss decreased (0.037026 --> 0.036986).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1598917
	speed: 0.0523s/iter; left time: 382.3703s
	iters: 200, epoch: 8 | loss: 0.0977172
	speed: 0.0169s/iter; left time: 121.6584s
	iters: 300, epoch: 8 | loss: 0.1511189
	speed: 0.0168s/iter; left time: 119.7314s
	iters: 400, epoch: 8 | loss: 0.0987706
	speed: 0.0169s/iter; left time: 118.2675s
	iters: 500, epoch: 8 | loss: 0.1360239
	speed: 0.0168s/iter; left time: 116.3725s
Epoch: 8 cost time: 9.921529293060303
Epoch: 8, Steps: 570 | Train Loss: 0.1636199 Vali Loss: 0.0365498 Test Loss: 0.1295588
Validation loss decreased (0.036986 --> 0.036550).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1548667
	speed: 0.0503s/iter; left time: 339.3551s
	iters: 200, epoch: 9 | loss: 0.1115444
	speed: 0.0169s/iter; left time: 112.2864s
	iters: 300, epoch: 9 | loss: 0.1772573
	speed: 0.0169s/iter; left time: 110.4714s
	iters: 400, epoch: 9 | loss: 0.1888809
	speed: 0.0169s/iter; left time: 108.9025s
	iters: 500, epoch: 9 | loss: 0.2234136
	speed: 0.0169s/iter; left time: 107.2512s
Epoch: 9 cost time: 9.946876764297485
Epoch: 9, Steps: 570 | Train Loss: 0.1624561 Vali Loss: 0.0363739 Test Loss: 0.1286953
Validation loss decreased (0.036550 --> 0.036374).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1909935
	speed: 0.0509s/iter; left time: 314.0818s
	iters: 200, epoch: 10 | loss: 0.0807578
	speed: 0.0169s/iter; left time: 102.5877s
	iters: 300, epoch: 10 | loss: 0.2011869
	speed: 0.0169s/iter; left time: 101.0228s
	iters: 400, epoch: 10 | loss: 0.1806425
	speed: 0.0169s/iter; left time: 99.2037s
	iters: 500, epoch: 10 | loss: 0.1217641
	speed: 0.0169s/iter; left time: 97.2982s
Epoch: 10 cost time: 9.942070722579956
Epoch: 10, Steps: 570 | Train Loss: 0.1623723 Vali Loss: 0.0363148 Test Loss: 0.1290223
Validation loss decreased (0.036374 --> 0.036315).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1084471
	speed: 0.0508s/iter; left time: 284.2827s
	iters: 200, epoch: 11 | loss: 0.1778765
	speed: 0.0169s/iter; left time: 93.1298s
	iters: 300, epoch: 11 | loss: 0.0909555
	speed: 0.0169s/iter; left time: 91.3680s
	iters: 400, epoch: 11 | loss: 0.1808515
	speed: 0.0169s/iter; left time: 89.7496s
	iters: 500, epoch: 11 | loss: 0.2134927
	speed: 0.0169s/iter; left time: 87.7817s
Epoch: 11 cost time: 9.947604417800903
Epoch: 11, Steps: 570 | Train Loss: 0.1625681 Vali Loss: 0.0362311 Test Loss: 0.1291448
Validation loss decreased (0.036315 --> 0.036231).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1985332
	speed: 0.0522s/iter; left time: 262.8503s
	iters: 200, epoch: 12 | loss: 0.1466157
	speed: 0.0169s/iter; left time: 83.2789s
	iters: 300, epoch: 12 | loss: 0.1194674
	speed: 0.0169s/iter; left time: 81.5056s
	iters: 400, epoch: 12 | loss: 0.2015251
	speed: 0.0169s/iter; left time: 79.8235s
	iters: 500, epoch: 12 | loss: 0.1963449
	speed: 0.0169s/iter; left time: 78.2976s
Epoch: 12 cost time: 9.93934440612793
Epoch: 12, Steps: 570 | Train Loss: 0.1623873 Vali Loss: 0.0361431 Test Loss: 0.1290755
Validation loss decreased (0.036231 --> 0.036143).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1728205
	speed: 0.0513s/iter; left time: 228.6468s
	iters: 200, epoch: 13 | loss: 0.2514420
	speed: 0.0169s/iter; left time: 73.7784s
	iters: 300, epoch: 13 | loss: 0.1846725
	speed: 0.0169s/iter; left time: 72.1245s
	iters: 400, epoch: 13 | loss: 0.1506081
	speed: 0.0169s/iter; left time: 70.2954s
	iters: 500, epoch: 13 | loss: 0.1304836
	speed: 0.0169s/iter; left time: 68.7227s
Epoch: 13 cost time: 9.950299739837646
Epoch: 13, Steps: 570 | Train Loss: 0.1621279 Vali Loss: 0.0361303 Test Loss: 0.1291147
Validation loss decreased (0.036143 --> 0.036130).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1586499
	speed: 0.0509s/iter; left time: 198.0586s
	iters: 200, epoch: 14 | loss: 0.1400418
	speed: 0.0169s/iter; left time: 64.1505s
	iters: 300, epoch: 14 | loss: 0.2399580
	speed: 0.0169s/iter; left time: 62.4025s
	iters: 400, epoch: 14 | loss: 0.1098393
	speed: 0.0169s/iter; left time: 60.7128s
	iters: 500, epoch: 14 | loss: 0.1261101
	speed: 0.0169s/iter; left time: 58.9505s
Epoch: 14 cost time: 9.968299150466919
Epoch: 14, Steps: 570 | Train Loss: 0.1632261 Vali Loss: 0.0363390 Test Loss: 0.1291307
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1874460
	speed: 0.0521s/iter; left time: 173.0653s
	iters: 200, epoch: 15 | loss: 0.2160511
	speed: 0.0169s/iter; left time: 54.5532s
	iters: 300, epoch: 15 | loss: 0.1692927
	speed: 0.0169s/iter; left time: 52.8529s
	iters: 400, epoch: 15 | loss: 0.1692064
	speed: 0.0169s/iter; left time: 51.1529s
	iters: 500, epoch: 15 | loss: 0.1684602
	speed: 0.0169s/iter; left time: 49.4614s
Epoch: 15 cost time: 9.97062373161316
Epoch: 15, Steps: 570 | Train Loss: 0.1616094 Vali Loss: 0.0362375 Test Loss: 0.1291250
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.2160935
	speed: 0.0498s/iter; left time: 136.8908s
	iters: 200, epoch: 16 | loss: 0.2509449
	speed: 0.0169s/iter; left time: 44.7169s
	iters: 300, epoch: 16 | loss: 0.1350254
	speed: 0.0169s/iter; left time: 43.0258s
	iters: 400, epoch: 16 | loss: 0.1547819
	speed: 0.0169s/iter; left time: 41.3523s
	iters: 500, epoch: 16 | loss: 0.1167356
	speed: 0.0169s/iter; left time: 39.6222s
Epoch: 16 cost time: 9.917937755584717
Epoch: 16, Steps: 570 | Train Loss: 0.1615554 Vali Loss: 0.0361848 Test Loss: 0.1291280
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12926049530506134, mae:0.22049343585968018
>>> MS_Pen LR=5e-4 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2207342
	speed: 0.0282s/iter; left time: 318.8658s
	iters: 200, epoch: 1 | loss: 0.1584844
	speed: 0.0162s/iter; left time: 181.8314s
	iters: 300, epoch: 1 | loss: 0.2983995
	speed: 0.0162s/iter; left time: 180.1130s
	iters: 400, epoch: 1 | loss: 0.2135302
	speed: 0.0163s/iter; left time: 178.7969s
	iters: 500, epoch: 1 | loss: 0.1547397
	speed: 0.0162s/iter; left time: 176.6516s
Epoch: 1 cost time: 10.500386476516724
Epoch: 1, Steps: 570 | Train Loss: 0.2422965 Vali Loss: 0.0418743 Test Loss: 0.1397247
Validation loss decreased (inf --> 0.041874).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1659945
	speed: 0.0523s/iter; left time: 561.6915s
	iters: 200, epoch: 2 | loss: 0.1760354
	speed: 0.0164s/iter; left time: 174.2006s
	iters: 300, epoch: 2 | loss: 0.3103279
	speed: 0.0164s/iter; left time: 172.2482s
	iters: 400, epoch: 2 | loss: 0.3041625
	speed: 0.0164s/iter; left time: 170.9216s
	iters: 500, epoch: 2 | loss: 0.2486238
	speed: 0.0164s/iter; left time: 168.9875s
Epoch: 2 cost time: 9.646210670471191
Epoch: 2, Steps: 570 | Train Loss: 0.2269256 Vali Loss: 0.0479145 Test Loss: 0.1540515
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2286819
	speed: 0.0520s/iter; left time: 528.6234s
	iters: 200, epoch: 3 | loss: 0.2660805
	speed: 0.0179s/iter; left time: 180.1178s
	iters: 300, epoch: 3 | loss: 0.1627487
	speed: 0.0170s/iter; left time: 169.6982s
	iters: 400, epoch: 3 | loss: 0.2786621
	speed: 0.0164s/iter; left time: 161.6137s
	iters: 500, epoch: 3 | loss: 0.1324239
	speed: 0.0164s/iter; left time: 159.8112s
Epoch: 3 cost time: 10.044318199157715
Epoch: 3, Steps: 570 | Train Loss: 0.2159286 Vali Loss: 0.0410631 Test Loss: 0.1302995
Validation loss decreased (0.041874 --> 0.041063).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1819403
	speed: 0.0513s/iter; left time: 491.6292s
	iters: 200, epoch: 4 | loss: 0.3115604
	speed: 0.0164s/iter; left time: 156.0245s
	iters: 300, epoch: 4 | loss: 0.1936538
	speed: 0.0164s/iter; left time: 154.0771s
	iters: 400, epoch: 4 | loss: 0.1384328
	speed: 0.0164s/iter; left time: 152.3510s
	iters: 500, epoch: 4 | loss: 0.2298740
	speed: 0.0164s/iter; left time: 150.4736s
Epoch: 4 cost time: 9.696141242980957
Epoch: 4, Steps: 570 | Train Loss: 0.1917847 Vali Loss: 0.0388768 Test Loss: 0.1266440
Validation loss decreased (0.041063 --> 0.038877).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2008991
	speed: 0.0508s/iter; left time: 458.1403s
	iters: 200, epoch: 5 | loss: 0.2837721
	speed: 0.0163s/iter; left time: 145.1233s
	iters: 300, epoch: 5 | loss: 0.1874991
	speed: 0.0163s/iter; left time: 143.4459s
	iters: 400, epoch: 5 | loss: 0.1279696
	speed: 0.0163s/iter; left time: 141.8629s
	iters: 500, epoch: 5 | loss: 0.2217466
	speed: 0.0163s/iter; left time: 140.3450s
Epoch: 5 cost time: 9.595821619033813
Epoch: 5, Steps: 570 | Train Loss: 0.1815094 Vali Loss: 0.0377429 Test Loss: 0.1222474
Validation loss decreased (0.038877 --> 0.037743).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1823688
	speed: 0.0517s/iter; left time: 437.2532s
	iters: 200, epoch: 6 | loss: 0.2655613
	speed: 0.0164s/iter; left time: 136.9741s
	iters: 300, epoch: 6 | loss: 0.2993753
	speed: 0.0164s/iter; left time: 135.2144s
	iters: 400, epoch: 6 | loss: 0.1813604
	speed: 0.0164s/iter; left time: 133.6350s
	iters: 500, epoch: 6 | loss: 0.1710400
	speed: 0.0164s/iter; left time: 131.8799s
Epoch: 6 cost time: 9.679982900619507
Epoch: 6, Steps: 570 | Train Loss: 0.1747668 Vali Loss: 0.0363492 Test Loss: 0.1212416
Validation loss decreased (0.037743 --> 0.036349).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2355233
	speed: 0.0510s/iter; left time: 401.9753s
	iters: 200, epoch: 7 | loss: 0.1143212
	speed: 0.0163s/iter; left time: 126.7562s
	iters: 300, epoch: 7 | loss: 0.1565411
	speed: 0.0163s/iter; left time: 125.2149s
	iters: 400, epoch: 7 | loss: 0.2213267
	speed: 0.0163s/iter; left time: 123.6323s
	iters: 500, epoch: 7 | loss: 0.2696986
	speed: 0.0163s/iter; left time: 121.9011s
Epoch: 7 cost time: 9.622576475143433
Epoch: 7, Steps: 570 | Train Loss: 0.1736361 Vali Loss: 0.0359482 Test Loss: 0.1202715
Validation loss decreased (0.036349 --> 0.035948).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1036158
	speed: 0.0512s/iter; left time: 374.0562s
	iters: 200, epoch: 8 | loss: 0.2516436
	speed: 0.0163s/iter; left time: 117.7676s
	iters: 300, epoch: 8 | loss: 0.2028979
	speed: 0.0164s/iter; left time: 116.3580s
	iters: 400, epoch: 8 | loss: 0.2084833
	speed: 0.0164s/iter; left time: 114.6865s
	iters: 500, epoch: 8 | loss: 0.1679467
	speed: 0.0163s/iter; left time: 112.9592s
Epoch: 8 cost time: 9.655128240585327
Epoch: 8, Steps: 570 | Train Loss: 0.1707405 Vali Loss: 0.0356804 Test Loss: 0.1190394
Validation loss decreased (0.035948 --> 0.035680).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1078033
	speed: 0.0510s/iter; left time: 343.6146s
	iters: 200, epoch: 9 | loss: 0.1605292
	speed: 0.0163s/iter; left time: 108.5448s
	iters: 300, epoch: 9 | loss: 0.1115774
	speed: 0.0163s/iter; left time: 106.7856s
	iters: 400, epoch: 9 | loss: 0.1387155
	speed: 0.0163s/iter; left time: 105.1707s
	iters: 500, epoch: 9 | loss: 0.0850878
	speed: 0.0163s/iter; left time: 103.5103s
Epoch: 9 cost time: 9.63574767112732
Epoch: 9, Steps: 570 | Train Loss: 0.1704822 Vali Loss: 0.0358792 Test Loss: 0.1190285
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1885540
	speed: 0.0516s/iter; left time: 318.5285s
	iters: 200, epoch: 10 | loss: 0.1682003
	speed: 0.0163s/iter; left time: 99.2350s
	iters: 300, epoch: 10 | loss: 0.1303323
	speed: 0.0163s/iter; left time: 97.4477s
	iters: 400, epoch: 10 | loss: 0.1890784
	speed: 0.0163s/iter; left time: 95.8618s
	iters: 500, epoch: 10 | loss: 0.1378638
	speed: 0.0163s/iter; left time: 94.2307s
Epoch: 10 cost time: 9.631267309188843
Epoch: 10, Steps: 570 | Train Loss: 0.1700160 Vali Loss: 0.0357406 Test Loss: 0.1189361
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1184344
	speed: 0.0498s/iter; left time: 279.1852s
	iters: 200, epoch: 11 | loss: 0.1282821
	speed: 0.0164s/iter; left time: 90.3758s
	iters: 300, epoch: 11 | loss: 0.1169893
	speed: 0.0164s/iter; left time: 88.7349s
	iters: 400, epoch: 11 | loss: 0.1793861
	speed: 0.0164s/iter; left time: 87.1462s
	iters: 500, epoch: 11 | loss: 0.1558838
	speed: 0.0164s/iter; left time: 85.4843s
Epoch: 11 cost time: 9.699548482894897
Epoch: 11, Steps: 570 | Train Loss: 0.1703504 Vali Loss: 0.0357508 Test Loss: 0.1188917
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11918734014034271, mae:0.212398961186409
>>> MS_Pen LR=5e-4 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2786548
	speed: 0.0270s/iter; left time: 305.1959s
	iters: 200, epoch: 1 | loss: 0.2707973
	speed: 0.0155s/iter; left time: 173.7019s
	iters: 300, epoch: 1 | loss: 0.2053491
	speed: 0.0155s/iter; left time: 171.8501s
	iters: 400, epoch: 1 | loss: 0.3187843
	speed: 0.0155s/iter; left time: 170.6757s
	iters: 500, epoch: 1 | loss: 0.4503751
	speed: 0.0155s/iter; left time: 168.9182s
Epoch: 1 cost time: 10.040112733840942
Epoch: 1, Steps: 570 | Train Loss: 0.2701491 Vali Loss: 0.0474322 Test Loss: 0.1644649
Validation loss decreased (inf --> 0.047432).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3415541
	speed: 0.0506s/iter; left time: 543.2527s
	iters: 200, epoch: 2 | loss: 0.1961352
	speed: 0.0155s/iter; left time: 164.7227s
	iters: 300, epoch: 2 | loss: 0.3407129
	speed: 0.0155s/iter; left time: 163.1201s
	iters: 400, epoch: 2 | loss: 0.2627839
	speed: 0.0154s/iter; left time: 160.8374s
	iters: 500, epoch: 2 | loss: 0.3966551
	speed: 0.0154s/iter; left time: 159.3894s
Epoch: 2 cost time: 9.140087366104126
Epoch: 2, Steps: 570 | Train Loss: 0.2886270 Vali Loss: 0.0617476 Test Loss: 0.1805957
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3021851
	speed: 0.0493s/iter; left time: 500.8550s
	iters: 200, epoch: 3 | loss: 0.1825390
	speed: 0.0155s/iter; left time: 156.2394s
	iters: 300, epoch: 3 | loss: 0.3774316
	speed: 0.0155s/iter; left time: 154.5547s
	iters: 400, epoch: 3 | loss: 0.2929457
	speed: 0.0155s/iter; left time: 152.9395s
	iters: 500, epoch: 3 | loss: 0.2834208
	speed: 0.0155s/iter; left time: 151.3335s
Epoch: 3 cost time: 9.143384456634521
Epoch: 3, Steps: 570 | Train Loss: 0.2677527 Vali Loss: 0.0557855 Test Loss: 0.1595632
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2147990
	speed: 0.0476s/iter; left time: 456.1102s
	iters: 200, epoch: 4 | loss: 0.3831518
	speed: 0.0154s/iter; left time: 145.8028s
	iters: 300, epoch: 4 | loss: 0.3750640
	speed: 0.0154s/iter; left time: 144.3056s
	iters: 400, epoch: 4 | loss: 0.1934877
	speed: 0.0154s/iter; left time: 142.7723s
	iters: 500, epoch: 4 | loss: 0.3195795
	speed: 0.0154s/iter; left time: 141.1727s
Epoch: 4 cost time: 9.029419183731079
Epoch: 4, Steps: 570 | Train Loss: 0.2550107 Vali Loss: 0.0564609 Test Loss: 0.1617350
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16463591158390045, mae:0.2554605007171631
>>> MS_Pen LR=5e-4 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1875960
	speed: 0.0304s/iter; left time: 343.8719s
	iters: 200, epoch: 1 | loss: 0.2369463
	speed: 0.0187s/iter; left time: 209.5538s
	iters: 300, epoch: 1 | loss: 0.3924615
	speed: 0.0187s/iter; left time: 208.0539s
	iters: 400, epoch: 1 | loss: 0.2102174
	speed: 0.0187s/iter; left time: 205.7016s
	iters: 500, epoch: 1 | loss: 0.1760153
	speed: 0.0187s/iter; left time: 204.0673s
Epoch: 1 cost time: 11.88767671585083
Epoch: 1, Steps: 570 | Train Loss: 0.2449494 Vali Loss: 0.0455504 Test Loss: 0.1353050
Validation loss decreased (inf --> 0.045550).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3914514
	speed: 0.0588s/iter; left time: 631.1088s
	iters: 200, epoch: 2 | loss: 0.1824565
	speed: 0.0186s/iter; left time: 198.1803s
	iters: 300, epoch: 2 | loss: 0.1529392
	speed: 0.0186s/iter; left time: 196.0787s
	iters: 400, epoch: 2 | loss: 0.1783425
	speed: 0.0186s/iter; left time: 193.5064s
	iters: 500, epoch: 2 | loss: 0.1554777
	speed: 0.0186s/iter; left time: 192.1715s
Epoch: 2 cost time: 10.910116910934448
Epoch: 2, Steps: 570 | Train Loss: 0.2060547 Vali Loss: 0.0384956 Test Loss: 0.1320423
Validation loss decreased (0.045550 --> 0.038496).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1478484
	speed: 0.0584s/iter; left time: 593.3007s
	iters: 200, epoch: 3 | loss: 0.1714430
	speed: 0.0186s/iter; left time: 187.3664s
	iters: 300, epoch: 3 | loss: 0.1550239
	speed: 0.0186s/iter; left time: 185.1640s
	iters: 400, epoch: 3 | loss: 0.1047563
	speed: 0.0187s/iter; left time: 184.1070s
	iters: 500, epoch: 3 | loss: 0.1593692
	speed: 0.0186s/iter; left time: 181.8363s
Epoch: 3 cost time: 10.923144102096558
Epoch: 3, Steps: 570 | Train Loss: 0.1770427 Vali Loss: 0.0363532 Test Loss: 0.1300013
Validation loss decreased (0.038496 --> 0.036353).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1768843
	speed: 0.0573s/iter; left time: 549.4627s
	iters: 200, epoch: 4 | loss: 0.2177884
	speed: 0.0187s/iter; left time: 177.4026s
	iters: 300, epoch: 4 | loss: 0.1610310
	speed: 0.0209s/iter; left time: 196.0148s
	iters: 400, epoch: 4 | loss: 0.0975492
	speed: 0.0209s/iter; left time: 193.9532s
	iters: 500, epoch: 4 | loss: 0.1714042
	speed: 0.0209s/iter; left time: 191.9143s
Epoch: 4 cost time: 11.852875232696533
Epoch: 4, Steps: 570 | Train Loss: 0.1578853 Vali Loss: 0.0356088 Test Loss: 0.1382291
Validation loss decreased (0.036353 --> 0.035609).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1728905
	speed: 0.0577s/iter; left time: 520.5261s
	iters: 200, epoch: 5 | loss: 0.1566795
	speed: 0.0187s/iter; left time: 166.7062s
	iters: 300, epoch: 5 | loss: 0.1298384
	speed: 0.0187s/iter; left time: 164.5877s
	iters: 400, epoch: 5 | loss: 0.1367474
	speed: 0.0187s/iter; left time: 163.0455s
	iters: 500, epoch: 5 | loss: 0.1198580
	speed: 0.0187s/iter; left time: 160.9779s
Epoch: 5 cost time: 10.950404644012451
Epoch: 5, Steps: 570 | Train Loss: 0.1477127 Vali Loss: 0.0346281 Test Loss: 0.1335547
Validation loss decreased (0.035609 --> 0.034628).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0768122
	speed: 0.0569s/iter; left time: 480.8764s
	iters: 200, epoch: 6 | loss: 0.1449381
	speed: 0.0187s/iter; left time: 156.0601s
	iters: 300, epoch: 6 | loss: 0.1276613
	speed: 0.0187s/iter; left time: 154.2326s
	iters: 400, epoch: 6 | loss: 0.1721956
	speed: 0.0187s/iter; left time: 152.2861s
	iters: 500, epoch: 6 | loss: 0.1218348
	speed: 0.0187s/iter; left time: 150.3941s
Epoch: 6 cost time: 10.958093166351318
Epoch: 6, Steps: 570 | Train Loss: 0.1424293 Vali Loss: 0.0355569 Test Loss: 0.1353112
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1107996
	speed: 0.0561s/iter; left time: 442.4755s
	iters: 200, epoch: 7 | loss: 0.1231052
	speed: 0.0186s/iter; left time: 144.4553s
	iters: 300, epoch: 7 | loss: 0.1141688
	speed: 0.0186s/iter; left time: 142.5804s
	iters: 400, epoch: 7 | loss: 0.1477197
	speed: 0.0186s/iter; left time: 140.6651s
	iters: 500, epoch: 7 | loss: 0.2153810
	speed: 0.0186s/iter; left time: 138.9149s
Epoch: 7 cost time: 10.892132759094238
Epoch: 7, Steps: 570 | Train Loss: 0.1387796 Vali Loss: 0.0349926 Test Loss: 0.1333427
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1238461
	speed: 0.0568s/iter; left time: 414.9444s
	iters: 200, epoch: 8 | loss: 0.1228239
	speed: 0.0185s/iter; left time: 133.5005s
	iters: 300, epoch: 8 | loss: 0.1081930
	speed: 0.0185s/iter; left time: 131.6826s
	iters: 400, epoch: 8 | loss: 0.1767600
	speed: 0.0186s/iter; left time: 130.4926s
	iters: 500, epoch: 8 | loss: 0.1117854
	speed: 0.0187s/iter; left time: 128.9392s
Epoch: 8 cost time: 10.832719087600708
Epoch: 8, Steps: 570 | Train Loss: 0.1377450 Vali Loss: 0.0352317 Test Loss: 0.1335709
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13370347023010254, mae:0.22512489557266235
>>> MS_Pen LR=5e-4 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.4043591
	speed: 0.0324s/iter; left time: 366.4929s
	iters: 200, epoch: 1 | loss: 0.2566531
	speed: 0.0206s/iter; left time: 230.6994s
	iters: 300, epoch: 1 | loss: 0.1906523
	speed: 0.0206s/iter; left time: 228.7188s
	iters: 400, epoch: 1 | loss: 0.1829839
	speed: 0.0192s/iter; left time: 210.9757s
	iters: 500, epoch: 1 | loss: 0.2502130
	speed: 0.0184s/iter; left time: 201.0438s
Epoch: 1 cost time: 12.571488857269287
Epoch: 1, Steps: 570 | Train Loss: 0.2250840 Vali Loss: 0.0394144 Test Loss: 0.1289950
Validation loss decreased (inf --> 0.039414).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1512176
	speed: 0.0592s/iter; left time: 635.4594s
	iters: 200, epoch: 2 | loss: 0.2494637
	speed: 0.0185s/iter; left time: 196.6723s
	iters: 300, epoch: 2 | loss: 0.3329107
	speed: 0.0184s/iter; left time: 194.1878s
	iters: 400, epoch: 2 | loss: 0.1777253
	speed: 0.0184s/iter; left time: 192.0118s
	iters: 500, epoch: 2 | loss: 0.1345566
	speed: 0.0184s/iter; left time: 190.0926s
Epoch: 2 cost time: 10.833268404006958
Epoch: 2, Steps: 570 | Train Loss: 0.1952172 Vali Loss: 0.0410069 Test Loss: 0.1276989
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1202179
	speed: 0.0565s/iter; left time: 574.4003s
	iters: 200, epoch: 3 | loss: 0.1614020
	speed: 0.0185s/iter; left time: 185.6687s
	iters: 300, epoch: 3 | loss: 0.1671818
	speed: 0.0184s/iter; left time: 183.2016s
	iters: 400, epoch: 3 | loss: 0.1345083
	speed: 0.0184s/iter; left time: 181.1051s
	iters: 500, epoch: 3 | loss: 0.1157913
	speed: 0.0184s/iter; left time: 179.7257s
Epoch: 3 cost time: 10.808817386627197
Epoch: 3, Steps: 570 | Train Loss: 0.1698431 Vali Loss: 0.0379888 Test Loss: 0.1212017
Validation loss decreased (0.039414 --> 0.037989).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1980232
	speed: 0.0564s/iter; left time: 540.6144s
	iters: 200, epoch: 4 | loss: 0.1039328
	speed: 0.0185s/iter; left time: 176.0115s
	iters: 300, epoch: 4 | loss: 0.2892313
	speed: 0.0185s/iter; left time: 173.8821s
	iters: 400, epoch: 4 | loss: 0.1441124
	speed: 0.0185s/iter; left time: 172.1274s
	iters: 500, epoch: 4 | loss: 0.1243022
	speed: 0.0185s/iter; left time: 170.4025s
Epoch: 4 cost time: 10.88824200630188
Epoch: 4, Steps: 570 | Train Loss: 0.1571568 Vali Loss: 0.0342906 Test Loss: 0.1174034
Validation loss decreased (0.037989 --> 0.034291).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1215048
	speed: 0.0559s/iter; left time: 504.5236s
	iters: 200, epoch: 5 | loss: 0.1680865
	speed: 0.0184s/iter; left time: 163.7101s
	iters: 300, epoch: 5 | loss: 0.1496899
	speed: 0.0184s/iter; left time: 162.0096s
	iters: 400, epoch: 5 | loss: 0.1255071
	speed: 0.0183s/iter; left time: 160.0280s
	iters: 500, epoch: 5 | loss: 0.1712449
	speed: 0.0184s/iter; left time: 158.2143s
Epoch: 5 cost time: 10.77303409576416
Epoch: 5, Steps: 570 | Train Loss: 0.1487590 Vali Loss: 0.0339588 Test Loss: 0.1158423
Validation loss decreased (0.034291 --> 0.033959).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1896864
	speed: 0.0563s/iter; left time: 475.6137s
	iters: 200, epoch: 6 | loss: 0.1173584
	speed: 0.0183s/iter; left time: 152.6999s
	iters: 300, epoch: 6 | loss: 0.1737171
	speed: 0.0183s/iter; left time: 150.8564s
	iters: 400, epoch: 6 | loss: 0.1216786
	speed: 0.0183s/iter; left time: 148.9595s
	iters: 500, epoch: 6 | loss: 0.0904674
	speed: 0.0183s/iter; left time: 147.1478s
Epoch: 6 cost time: 10.70216965675354
Epoch: 6, Steps: 570 | Train Loss: 0.1444887 Vali Loss: 0.0338490 Test Loss: 0.1159451
Validation loss decreased (0.033959 --> 0.033849).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1287546
	speed: 0.0589s/iter; left time: 464.1099s
	iters: 200, epoch: 7 | loss: 0.1785934
	speed: 0.0202s/iter; left time: 157.5626s
	iters: 300, epoch: 7 | loss: 0.1035068
	speed: 0.0194s/iter; left time: 148.9988s
	iters: 400, epoch: 7 | loss: 0.1515770
	speed: 0.0206s/iter; left time: 156.0047s
	iters: 500, epoch: 7 | loss: 0.1309258
	speed: 0.0184s/iter; left time: 137.7659s
Epoch: 7 cost time: 11.530116558074951
Epoch: 7, Steps: 570 | Train Loss: 0.1408724 Vali Loss: 0.0338286 Test Loss: 0.1168294
Validation loss decreased (0.033849 --> 0.033829).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1186113
	speed: 0.0588s/iter; left time: 429.6056s
	iters: 200, epoch: 8 | loss: 0.1259463
	speed: 0.0206s/iter; left time: 148.6533s
	iters: 300, epoch: 8 | loss: 0.1307749
	speed: 0.0188s/iter; left time: 133.8702s
	iters: 400, epoch: 8 | loss: 0.1398703
	speed: 0.0184s/iter; left time: 128.8228s
	iters: 500, epoch: 8 | loss: 0.1635105
	speed: 0.0184s/iter; left time: 126.8174s
Epoch: 8 cost time: 11.27395510673523
Epoch: 8, Steps: 570 | Train Loss: 0.1390789 Vali Loss: 0.0335540 Test Loss: 0.1164199
Validation loss decreased (0.033829 --> 0.033554).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0861563
	speed: 0.0565s/iter; left time: 381.1607s
	iters: 200, epoch: 9 | loss: 0.1154009
	speed: 0.0183s/iter; left time: 121.7947s
	iters: 300, epoch: 9 | loss: 0.1414717
	speed: 0.0183s/iter; left time: 119.9108s
	iters: 400, epoch: 9 | loss: 0.1386064
	speed: 0.0183s/iter; left time: 118.0348s
	iters: 500, epoch: 9 | loss: 0.1255198
	speed: 0.0183s/iter; left time: 116.1735s
Epoch: 9 cost time: 10.722859382629395
Epoch: 9, Steps: 570 | Train Loss: 0.1385804 Vali Loss: 0.0335685 Test Loss: 0.1161650
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1055291
	speed: 0.0567s/iter; left time: 349.8419s
	iters: 200, epoch: 10 | loss: 0.1104119
	speed: 0.0183s/iter; left time: 111.4008s
	iters: 300, epoch: 10 | loss: 0.1821262
	speed: 0.0183s/iter; left time: 109.4792s
	iters: 400, epoch: 10 | loss: 0.1370669
	speed: 0.0183s/iter; left time: 107.6507s
	iters: 500, epoch: 10 | loss: 0.1340891
	speed: 0.0183s/iter; left time: 105.8252s
Epoch: 10 cost time: 10.747255563735962
Epoch: 10, Steps: 570 | Train Loss: 0.1390933 Vali Loss: 0.0334171 Test Loss: 0.1159927
Validation loss decreased (0.033554 --> 0.033417).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1733461
	speed: 0.0565s/iter; left time: 316.5762s
	iters: 200, epoch: 11 | loss: 0.1452921
	speed: 0.0184s/iter; left time: 101.1750s
	iters: 300, epoch: 11 | loss: 0.1024277
	speed: 0.0184s/iter; left time: 99.3789s
	iters: 400, epoch: 11 | loss: 0.1915343
	speed: 0.0184s/iter; left time: 97.4877s
	iters: 500, epoch: 11 | loss: 0.1541828
	speed: 0.0184s/iter; left time: 95.6966s
Epoch: 11 cost time: 10.817573547363281
Epoch: 11, Steps: 570 | Train Loss: 0.1393958 Vali Loss: 0.0333950 Test Loss: 0.1160870
Validation loss decreased (0.033417 --> 0.033395).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.2096739
	speed: 0.0563s/iter; left time: 283.2100s
	iters: 200, epoch: 12 | loss: 0.1269885
	speed: 0.0184s/iter; left time: 90.7701s
	iters: 300, epoch: 12 | loss: 0.0916509
	speed: 0.0182s/iter; left time: 87.7739s
	iters: 400, epoch: 12 | loss: 0.1423877
	speed: 0.0183s/iter; left time: 86.6981s
	iters: 500, epoch: 12 | loss: 0.1244269
	speed: 0.0183s/iter; left time: 84.5181s
Epoch: 12 cost time: 10.748356342315674
Epoch: 12, Steps: 570 | Train Loss: 0.1388093 Vali Loss: 0.0334197 Test Loss: 0.1160934
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1160407
	speed: 0.0573s/iter; left time: 255.7048s
	iters: 200, epoch: 13 | loss: 0.1917858
	speed: 0.0185s/iter; left time: 80.5237s
	iters: 300, epoch: 13 | loss: 0.1115429
	speed: 0.0185s/iter; left time: 78.7534s
	iters: 400, epoch: 13 | loss: 0.1507843
	speed: 0.0184s/iter; left time: 76.7348s
	iters: 500, epoch: 13 | loss: 0.2093872
	speed: 0.0184s/iter; left time: 74.6535s
Epoch: 13 cost time: 10.770684957504272
Epoch: 13, Steps: 570 | Train Loss: 0.1392662 Vali Loss: 0.0334468 Test Loss: 0.1161216
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1411745
	speed: 0.0543s/iter; left time: 211.3484s
	iters: 200, epoch: 14 | loss: 0.1809930
	speed: 0.0182s/iter; left time: 68.9494s
	iters: 300, epoch: 14 | loss: 0.1404366
	speed: 0.0182s/iter; left time: 67.0445s
	iters: 400, epoch: 14 | loss: 0.1178212
	speed: 0.0182s/iter; left time: 65.3239s
	iters: 500, epoch: 14 | loss: 0.1315754
	speed: 0.0182s/iter; left time: 63.4239s
Epoch: 14 cost time: 10.647661209106445
Epoch: 14, Steps: 570 | Train Loss: 0.1391297 Vali Loss: 0.0335111 Test Loss: 0.1161220
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11618796736001968, mae:0.2047298550605774
>>> MS_Pen LR=5e-4 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2801234
	speed: 0.0298s/iter; left time: 336.5258s
	iters: 200, epoch: 1 | loss: 0.1984101
	speed: 0.0185s/iter; left time: 207.0605s
	iters: 300, epoch: 1 | loss: 0.2940540
	speed: 0.0205s/iter; left time: 227.7405s
	iters: 400, epoch: 1 | loss: 0.2862757
	speed: 0.0205s/iter; left time: 225.6989s
	iters: 500, epoch: 1 | loss: 0.2826641
	speed: 0.0201s/iter; left time: 218.6752s
Epoch: 1 cost time: 12.272214889526367
Epoch: 1, Steps: 570 | Train Loss: 0.2509208 Vali Loss: 0.0455939 Test Loss: 0.1455714
Validation loss decreased (inf --> 0.045594).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2704329
	speed: 0.0579s/iter; left time: 621.4705s
	iters: 200, epoch: 2 | loss: 0.2751792
	speed: 0.0206s/iter; left time: 218.6772s
	iters: 300, epoch: 2 | loss: 0.4740530
	speed: 0.0206s/iter; left time: 217.0714s
	iters: 400, epoch: 2 | loss: 0.1837599
	speed: 0.0207s/iter; left time: 216.1044s
	iters: 500, epoch: 2 | loss: 0.1742886
	speed: 0.0207s/iter; left time: 213.6118s
Epoch: 2 cost time: 12.06709361076355
Epoch: 2, Steps: 570 | Train Loss: 0.2144714 Vali Loss: 0.0451143 Test Loss: 0.1477426
Validation loss decreased (0.045594 --> 0.045114).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1267492
	speed: 0.0618s/iter; left time: 627.7260s
	iters: 200, epoch: 3 | loss: 0.1863087
	speed: 0.0207s/iter; left time: 207.9360s
	iters: 300, epoch: 3 | loss: 0.2044407
	speed: 0.0206s/iter; left time: 204.8021s
	iters: 400, epoch: 3 | loss: 0.2040002
	speed: 0.0206s/iter; left time: 202.8395s
	iters: 500, epoch: 3 | loss: 0.1659734
	speed: 0.0205s/iter; left time: 200.4628s
Epoch: 3 cost time: 11.954648494720459
Epoch: 3, Steps: 570 | Train Loss: 0.1793948 Vali Loss: 0.0386699 Test Loss: 0.1348920
Validation loss decreased (0.045114 --> 0.038670).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1181576
	speed: 0.0561s/iter; left time: 537.8925s
	iters: 200, epoch: 4 | loss: 0.1801681
	speed: 0.0182s/iter; left time: 173.1966s
	iters: 300, epoch: 4 | loss: 0.1435104
	speed: 0.0182s/iter; left time: 171.2241s
	iters: 400, epoch: 4 | loss: 0.1725910
	speed: 0.0182s/iter; left time: 169.3381s
	iters: 500, epoch: 4 | loss: 0.1078571
	speed: 0.0182s/iter; left time: 167.4734s
Epoch: 4 cost time: 10.696836948394775
Epoch: 4, Steps: 570 | Train Loss: 0.1581231 Vali Loss: 0.0377872 Test Loss: 0.1324803
Validation loss decreased (0.038670 --> 0.037787).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1189948
	speed: 0.0562s/iter; left time: 507.2439s
	iters: 200, epoch: 5 | loss: 0.1329497
	speed: 0.0183s/iter; left time: 163.0420s
	iters: 300, epoch: 5 | loss: 0.1199373
	speed: 0.0182s/iter; left time: 160.9689s
	iters: 400, epoch: 5 | loss: 0.1223274
	speed: 0.0182s/iter; left time: 158.7362s
	iters: 500, epoch: 5 | loss: 0.0840615
	speed: 0.0183s/iter; left time: 157.3572s
Epoch: 5 cost time: 10.713002443313599
Epoch: 5, Steps: 570 | Train Loss: 0.1466016 Vali Loss: 0.0372423 Test Loss: 0.1324768
Validation loss decreased (0.037787 --> 0.037242).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1954914
	speed: 0.0563s/iter; left time: 475.5080s
	iters: 200, epoch: 6 | loss: 0.1002515
	speed: 0.0184s/iter; left time: 153.6704s
	iters: 300, epoch: 6 | loss: 0.2203482
	speed: 0.0184s/iter; left time: 151.6596s
	iters: 400, epoch: 6 | loss: 0.1152724
	speed: 0.0184s/iter; left time: 149.8318s
	iters: 500, epoch: 6 | loss: 0.1496787
	speed: 0.0184s/iter; left time: 147.9343s
Epoch: 6 cost time: 10.733912944793701
Epoch: 6, Steps: 570 | Train Loss: 0.1418443 Vali Loss: 0.0361954 Test Loss: 0.1314713
Validation loss decreased (0.037242 --> 0.036195).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1479209
	speed: 0.0556s/iter; left time: 438.2229s
	iters: 200, epoch: 7 | loss: 0.0954806
	speed: 0.0185s/iter; left time: 144.0535s
	iters: 300, epoch: 7 | loss: 0.1491728
	speed: 0.0185s/iter; left time: 142.3545s
	iters: 400, epoch: 7 | loss: 0.1496421
	speed: 0.0186s/iter; left time: 140.6615s
	iters: 500, epoch: 7 | loss: 0.1061493
	speed: 0.0185s/iter; left time: 138.7331s
Epoch: 7 cost time: 10.871776103973389
Epoch: 7, Steps: 570 | Train Loss: 0.1409716 Vali Loss: 0.0363430 Test Loss: 0.1316721
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1105867
	speed: 0.0579s/iter; left time: 422.9857s
	iters: 200, epoch: 8 | loss: 0.0943921
	speed: 0.0209s/iter; left time: 150.5293s
	iters: 300, epoch: 8 | loss: 0.1413385
	speed: 0.0200s/iter; left time: 142.2931s
	iters: 400, epoch: 8 | loss: 0.1692892
	speed: 0.0184s/iter; left time: 129.2324s
	iters: 500, epoch: 8 | loss: 0.1060155
	speed: 0.0184s/iter; left time: 127.3830s
Epoch: 8 cost time: 11.428367614746094
Epoch: 8, Steps: 570 | Train Loss: 0.1381020 Vali Loss: 0.0362339 Test Loss: 0.1307253
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1338342
	speed: 0.0566s/iter; left time: 381.5899s
	iters: 200, epoch: 9 | loss: 0.1988005
	speed: 0.0185s/iter; left time: 123.1037s
	iters: 300, epoch: 9 | loss: 0.1642600
	speed: 0.0185s/iter; left time: 121.1380s
	iters: 400, epoch: 9 | loss: 0.2597745
	speed: 0.0185s/iter; left time: 119.1842s
	iters: 500, epoch: 9 | loss: 0.1011456
	speed: 0.0184s/iter; left time: 116.7133s
Epoch: 9 cost time: 10.817605257034302
Epoch: 9, Steps: 570 | Train Loss: 0.1373523 Vali Loss: 0.0362300 Test Loss: 0.1308954
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13154730200767517, mae:0.2257041335105896
>>> MS_Pen LR=5e-4 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2103922
	speed: 0.0362s/iter; left time: 409.1600s
	iters: 200, epoch: 1 | loss: 0.2087047
	speed: 0.0240s/iter; left time: 269.2769s
	iters: 300, epoch: 1 | loss: 0.2154527
	speed: 0.0241s/iter; left time: 267.4009s
	iters: 400, epoch: 1 | loss: 0.3583503
	speed: 0.0226s/iter; left time: 248.3266s
	iters: 500, epoch: 1 | loss: 0.2286201
	speed: 0.0221s/iter; left time: 241.3523s
Epoch: 1 cost time: 14.516026496887207
Epoch: 1, Steps: 570 | Train Loss: 0.2603102 Vali Loss: 0.0482213 Test Loss: 0.1475132
Validation loss decreased (inf --> 0.048221).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2932865
	speed: 0.0689s/iter; left time: 739.7671s
	iters: 200, epoch: 2 | loss: 0.3117793
	speed: 0.0241s/iter; left time: 255.8844s
	iters: 300, epoch: 2 | loss: 0.3004867
	speed: 0.0241s/iter; left time: 253.4260s
	iters: 400, epoch: 2 | loss: 0.2443237
	speed: 0.0225s/iter; left time: 234.6770s
	iters: 500, epoch: 2 | loss: 0.2651859
	speed: 0.0222s/iter; left time: 229.4479s
Epoch: 2 cost time: 13.615216732025146
Epoch: 2, Steps: 570 | Train Loss: 0.2756121 Vali Loss: 0.0574841 Test Loss: 0.1738691
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.5090204
	speed: 0.0632s/iter; left time: 642.2969s
	iters: 200, epoch: 3 | loss: 0.2122248
	speed: 0.0222s/iter; left time: 223.7242s
	iters: 300, epoch: 3 | loss: 0.3009754
	speed: 0.0222s/iter; left time: 221.4321s
	iters: 400, epoch: 3 | loss: 0.2495842
	speed: 0.0222s/iter; left time: 219.2089s
	iters: 500, epoch: 3 | loss: 0.1829491
	speed: 0.0222s/iter; left time: 216.8980s
Epoch: 3 cost time: 12.98122239112854
Epoch: 3, Steps: 570 | Train Loss: 0.2644004 Vali Loss: 0.0560189 Test Loss: 0.1572153
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1888741
	speed: 0.0647s/iter; left time: 620.5829s
	iters: 200, epoch: 4 | loss: 0.2172974
	speed: 0.0241s/iter; left time: 228.3874s
	iters: 300, epoch: 4 | loss: 0.2552030
	speed: 0.0240s/iter; left time: 225.7642s
	iters: 400, epoch: 4 | loss: 0.2361687
	speed: 0.0241s/iter; left time: 223.5965s
	iters: 500, epoch: 4 | loss: 0.2967699
	speed: 0.0230s/iter; left time: 211.3557s
Epoch: 4 cost time: 13.687172651290894
Epoch: 4, Steps: 570 | Train Loss: 0.2478887 Vali Loss: 0.0536321 Test Loss: 0.1559692
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14769545197486877, mae:0.24507032334804535
>>> MS_Pen LR=5e-4 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2307791
	speed: 0.0354s/iter; left time: 400.3771s
	iters: 200, epoch: 1 | loss: 0.1321966
	speed: 0.0232s/iter; left time: 259.6185s
	iters: 300, epoch: 1 | loss: 0.2098604
	speed: 0.0233s/iter; left time: 258.2458s
	iters: 400, epoch: 1 | loss: 0.2515854
	speed: 0.0216s/iter; left time: 237.3061s
	iters: 500, epoch: 1 | loss: 0.2386050
	speed: 0.0213s/iter; left time: 231.9565s
Epoch: 1 cost time: 14.019201040267944
Epoch: 1, Steps: 570 | Train Loss: 0.2482850 Vali Loss: 0.0497810 Test Loss: 0.1452344
Validation loss decreased (inf --> 0.049781).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2548980
	speed: 0.0622s/iter; left time: 667.8723s
	iters: 200, epoch: 2 | loss: 0.1884715
	speed: 0.0213s/iter; left time: 226.4618s
	iters: 300, epoch: 2 | loss: 0.4305495
	speed: 0.0213s/iter; left time: 223.7950s
	iters: 400, epoch: 2 | loss: 0.3273572
	speed: 0.0212s/iter; left time: 221.5183s
	iters: 500, epoch: 2 | loss: 0.2098874
	speed: 0.0212s/iter; left time: 219.3581s
Epoch: 2 cost time: 12.437807559967041
Epoch: 2, Steps: 570 | Train Loss: 0.2785942 Vali Loss: 0.0596785 Test Loss: 0.1693660
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2652036
	speed: 0.0602s/iter; left time: 611.3833s
	iters: 200, epoch: 3 | loss: 0.2358183
	speed: 0.0214s/iter; left time: 215.1522s
	iters: 300, epoch: 3 | loss: 0.1668897
	speed: 0.0214s/iter; left time: 212.6974s
	iters: 400, epoch: 3 | loss: 0.1899019
	speed: 0.0213s/iter; left time: 210.5220s
	iters: 500, epoch: 3 | loss: 0.2518775
	speed: 0.0213s/iter; left time: 207.9394s
Epoch: 3 cost time: 12.434560060501099
Epoch: 3, Steps: 570 | Train Loss: 0.2582513 Vali Loss: 0.0573630 Test Loss: 0.1603132
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1791334
	speed: 0.0622s/iter; left time: 596.4453s
	iters: 200, epoch: 4 | loss: 0.2478080
	speed: 0.0222s/iter; left time: 210.5484s
	iters: 300, epoch: 4 | loss: 0.2116308
	speed: 0.0213s/iter; left time: 200.0473s
	iters: 400, epoch: 4 | loss: 0.3394597
	speed: 0.0213s/iter; left time: 197.8220s
	iters: 500, epoch: 4 | loss: 0.1840177
	speed: 0.0213s/iter; left time: 195.8986s
Epoch: 4 cost time: 12.72749662399292
Epoch: 4, Steps: 570 | Train Loss: 0.2428358 Vali Loss: 0.0535154 Test Loss: 0.1504774
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14543555676937103, mae:0.2460588812828064
>>> MS_Pen LR=5e-4 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2915831
	speed: 0.0341s/iter; left time: 385.1336s
	iters: 200, epoch: 1 | loss: 0.2452031
	speed: 0.0220s/iter; left time: 246.8256s
	iters: 300, epoch: 1 | loss: 0.3186620
	speed: 0.0221s/iter; left time: 245.0760s
	iters: 400, epoch: 1 | loss: 0.2703910
	speed: 0.0208s/iter; left time: 229.0136s
	iters: 500, epoch: 1 | loss: 0.2649579
	speed: 0.0200s/iter; left time: 217.6869s
Epoch: 1 cost time: 13.352492570877075
Epoch: 1, Steps: 570 | Train Loss: 0.2677776 Vali Loss: 0.0502532 Test Loss: 0.1569100
Validation loss decreased (inf --> 0.050253).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1896321
	speed: 0.0588s/iter; left time: 630.9289s
	iters: 200, epoch: 2 | loss: 0.3902757
	speed: 0.0200s/iter; left time: 212.6536s
	iters: 300, epoch: 2 | loss: 0.2269230
	speed: 0.0200s/iter; left time: 210.7005s
	iters: 400, epoch: 2 | loss: 0.2028211
	speed: 0.0200s/iter; left time: 208.8458s
	iters: 500, epoch: 2 | loss: 0.1966562
	speed: 0.0200s/iter; left time: 206.6942s
Epoch: 2 cost time: 11.670868873596191
Epoch: 2, Steps: 570 | Train Loss: 0.2645767 Vali Loss: 0.0588880 Test Loss: 0.1716770
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1788348
	speed: 0.0580s/iter; left time: 588.8355s
	iters: 200, epoch: 3 | loss: 0.2109904
	speed: 0.0201s/iter; left time: 202.3608s
	iters: 300, epoch: 3 | loss: 0.2083894
	speed: 0.0201s/iter; left time: 200.6206s
	iters: 400, epoch: 3 | loss: 0.2372968
	speed: 0.0202s/iter; left time: 198.8928s
	iters: 500, epoch: 3 | loss: 0.1980147
	speed: 0.0201s/iter; left time: 196.5532s
Epoch: 3 cost time: 11.71666431427002
Epoch: 3, Steps: 570 | Train Loss: 0.2556913 Vali Loss: 0.0561725 Test Loss: 0.1582437
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1468136
	speed: 0.0600s/iter; left time: 575.1991s
	iters: 200, epoch: 4 | loss: 0.4642644
	speed: 0.0199s/iter; left time: 189.0807s
	iters: 300, epoch: 4 | loss: 0.1827833
	speed: 0.0199s/iter; left time: 186.5512s
	iters: 400, epoch: 4 | loss: 0.2671061
	speed: 0.0199s/iter; left time: 184.7013s
	iters: 500, epoch: 4 | loss: 0.1950835
	speed: 0.0199s/iter; left time: 182.6577s
Epoch: 4 cost time: 11.586709976196289
Epoch: 4, Steps: 570 | Train Loss: 0.2404508 Vali Loss: 0.0541755 Test Loss: 0.1565067
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15711155533790588, mae:0.25458985567092896
>>> MS_Pen LR=1e-4 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1621229
	speed: 0.0230s/iter; left time: 259.9723s
	iters: 200, epoch: 1 | loss: 0.1776204
	speed: 0.0115s/iter; left time: 128.3022s
	iters: 300, epoch: 1 | loss: 0.1751000
	speed: 0.0114s/iter; left time: 126.6739s
	iters: 400, epoch: 1 | loss: 0.2009439
	speed: 0.0114s/iter; left time: 125.7445s
	iters: 500, epoch: 1 | loss: 0.1793981
	speed: 0.0110s/iter; left time: 119.9910s
Epoch: 1 cost time: 7.684757947921753
Epoch: 1, Steps: 570 | Train Loss: 0.1817086 Vali Loss: 0.0435687 Test Loss: 0.1298055
Validation loss decreased (inf --> 0.043569).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2138913
	speed: 0.0378s/iter; left time: 406.1665s
	iters: 200, epoch: 2 | loss: 0.2406014
	speed: 0.0114s/iter; left time: 121.2519s
	iters: 300, epoch: 2 | loss: 0.1211766
	speed: 0.0114s/iter; left time: 120.2671s
	iters: 400, epoch: 2 | loss: 0.1135445
	speed: 0.0114s/iter; left time: 119.2638s
	iters: 500, epoch: 2 | loss: 0.1121596
	speed: 0.0114s/iter; left time: 117.8727s
Epoch: 2 cost time: 6.779499053955078
Epoch: 2, Steps: 570 | Train Loss: 0.1359094 Vali Loss: 0.0418142 Test Loss: 0.1254427
Validation loss decreased (0.043569 --> 0.041814).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0768522
	speed: 0.0391s/iter; left time: 397.2804s
	iters: 200, epoch: 3 | loss: 0.1347376
	speed: 0.0115s/iter; left time: 115.4035s
	iters: 300, epoch: 3 | loss: 0.1088031
	speed: 0.0114s/iter; left time: 113.9743s
	iters: 400, epoch: 3 | loss: 0.1147992
	speed: 0.0115s/iter; left time: 113.1043s
	iters: 500, epoch: 3 | loss: 0.1575290
	speed: 0.0115s/iter; left time: 111.9237s
Epoch: 3 cost time: 6.852844953536987
Epoch: 3, Steps: 570 | Train Loss: 0.1085685 Vali Loss: 0.0371444 Test Loss: 0.1296323
Validation loss decreased (0.041814 --> 0.037144).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1113331
	speed: 0.0381s/iter; left time: 365.4669s
	iters: 200, epoch: 4 | loss: 0.0628882
	speed: 0.0112s/iter; left time: 106.6404s
	iters: 300, epoch: 4 | loss: 0.0932039
	speed: 0.0099s/iter; left time: 92.9291s
	iters: 400, epoch: 4 | loss: 0.1000348
	speed: 0.0099s/iter; left time: 92.0989s
	iters: 500, epoch: 4 | loss: 0.0983567
	speed: 0.0099s/iter; left time: 91.2307s
Epoch: 4 cost time: 6.210867643356323
Epoch: 4, Steps: 570 | Train Loss: 0.0949576 Vali Loss: 0.0352784 Test Loss: 0.1294727
Validation loss decreased (0.037144 --> 0.035278).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0927431
	speed: 0.0359s/iter; left time: 323.7987s
	iters: 200, epoch: 5 | loss: 0.1024962
	speed: 0.0111s/iter; left time: 99.2307s
	iters: 300, epoch: 5 | loss: 0.0617987
	speed: 0.0111s/iter; left time: 98.0905s
	iters: 400, epoch: 5 | loss: 0.0945018
	speed: 0.0103s/iter; left time: 89.8847s
	iters: 500, epoch: 5 | loss: 0.0844544
	speed: 0.0099s/iter; left time: 84.9537s
Epoch: 5 cost time: 6.247347593307495
Epoch: 5, Steps: 570 | Train Loss: 0.0878310 Vali Loss: 0.0350776 Test Loss: 0.1269031
Validation loss decreased (0.035278 --> 0.035078).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0719824
	speed: 0.0358s/iter; left time: 302.6716s
	iters: 200, epoch: 6 | loss: 0.0545358
	speed: 0.0099s/iter; left time: 82.5543s
	iters: 300, epoch: 6 | loss: 0.0816357
	speed: 0.0099s/iter; left time: 81.7433s
	iters: 400, epoch: 6 | loss: 0.1021996
	speed: 0.0099s/iter; left time: 80.8709s
	iters: 500, epoch: 6 | loss: 0.1257755
	speed: 0.0099s/iter; left time: 79.8082s
Epoch: 6 cost time: 5.931880235671997
Epoch: 6, Steps: 570 | Train Loss: 0.0842951 Vali Loss: 0.0348257 Test Loss: 0.1280571
Validation loss decreased (0.035078 --> 0.034826).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0748298
	speed: 0.0348s/iter; left time: 274.6182s
	iters: 200, epoch: 7 | loss: 0.0868388
	speed: 0.0099s/iter; left time: 76.6504s
	iters: 300, epoch: 7 | loss: 0.0699191
	speed: 0.0099s/iter; left time: 75.8595s
	iters: 400, epoch: 7 | loss: 0.0659485
	speed: 0.0099s/iter; left time: 74.8699s
	iters: 500, epoch: 7 | loss: 0.0503257
	speed: 0.0099s/iter; left time: 73.8522s
Epoch: 7 cost time: 5.910386323928833
Epoch: 7, Steps: 570 | Train Loss: 0.0824540 Vali Loss: 0.0354178 Test Loss: 0.1323949
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0986293
	speed: 0.0356s/iter; left time: 260.5996s
	iters: 200, epoch: 8 | loss: 0.0890019
	speed: 0.0099s/iter; left time: 71.5174s
	iters: 300, epoch: 8 | loss: 0.0848282
	speed: 0.0099s/iter; left time: 70.1593s
	iters: 400, epoch: 8 | loss: 0.1306048
	speed: 0.0099s/iter; left time: 69.5299s
	iters: 500, epoch: 8 | loss: 0.0829074
	speed: 0.0100s/iter; left time: 68.9813s
Epoch: 8 cost time: 5.91684889793396
Epoch: 8, Steps: 570 | Train Loss: 0.0814944 Vali Loss: 0.0351508 Test Loss: 0.1308032
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0679751
	speed: 0.0346s/iter; left time: 233.5527s
	iters: 200, epoch: 9 | loss: 0.0845580
	speed: 0.0099s/iter; left time: 65.7471s
	iters: 300, epoch: 9 | loss: 0.0487372
	speed: 0.0099s/iter; left time: 64.9014s
	iters: 400, epoch: 9 | loss: 0.0529258
	speed: 0.0100s/iter; left time: 64.0942s
	iters: 500, epoch: 9 | loss: 0.0809686
	speed: 0.0099s/iter; left time: 62.9774s
Epoch: 9 cost time: 5.92818546295166
Epoch: 9, Steps: 570 | Train Loss: 0.0810531 Vali Loss: 0.0353080 Test Loss: 0.1299795
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12819300591945648, mae:0.227902352809906
>>> MS_Pen LR=1e-4 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1330896
	speed: 0.0214s/iter; left time: 242.1331s
	iters: 200, epoch: 1 | loss: 0.1497930
	speed: 0.0097s/iter; left time: 108.5174s
	iters: 300, epoch: 1 | loss: 0.2152147
	speed: 0.0097s/iter; left time: 107.7002s
	iters: 400, epoch: 1 | loss: 0.1501365
	speed: 0.0097s/iter; left time: 106.5930s
	iters: 500, epoch: 1 | loss: 0.1460952
	speed: 0.0097s/iter; left time: 105.6491s
Epoch: 1 cost time: 6.7536561489105225
Epoch: 1, Steps: 570 | Train Loss: 0.1527366 Vali Loss: 0.0363813 Test Loss: 0.1156456
Validation loss decreased (inf --> 0.036381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1151416
	speed: 0.0353s/iter; left time: 378.7984s
	iters: 200, epoch: 2 | loss: 0.1167583
	speed: 0.0098s/iter; left time: 104.3465s
	iters: 300, epoch: 2 | loss: 0.0806794
	speed: 0.0097s/iter; left time: 102.4896s
	iters: 400, epoch: 2 | loss: 0.1021064
	speed: 0.0097s/iter; left time: 101.5350s
	iters: 500, epoch: 2 | loss: 0.1055827
	speed: 0.0097s/iter; left time: 100.4022s
Epoch: 2 cost time: 5.853678226470947
Epoch: 2, Steps: 570 | Train Loss: 0.1182926 Vali Loss: 0.0339298 Test Loss: 0.1177446
Validation loss decreased (0.036381 --> 0.033930).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0596350
	speed: 0.0358s/iter; left time: 363.3337s
	iters: 200, epoch: 3 | loss: 0.0918881
	speed: 0.0097s/iter; left time: 97.8646s
	iters: 300, epoch: 3 | loss: 0.1712983
	speed: 0.0098s/iter; left time: 97.3714s
	iters: 400, epoch: 3 | loss: 0.0882179
	speed: 0.0097s/iter; left time: 95.8618s
	iters: 500, epoch: 3 | loss: 0.0802318
	speed: 0.0097s/iter; left time: 95.0178s
Epoch: 3 cost time: 5.829240322113037
Epoch: 3, Steps: 570 | Train Loss: 0.0956220 Vali Loss: 0.0322631 Test Loss: 0.1218539
Validation loss decreased (0.033930 --> 0.032263).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0661222
	speed: 0.0347s/iter; left time: 332.3851s
	iters: 200, epoch: 4 | loss: 0.0560031
	speed: 0.0097s/iter; left time: 91.5920s
	iters: 300, epoch: 4 | loss: 0.0616874
	speed: 0.0097s/iter; left time: 90.6914s
	iters: 400, epoch: 4 | loss: 0.0554788
	speed: 0.0097s/iter; left time: 89.9507s
	iters: 500, epoch: 4 | loss: 0.0835108
	speed: 0.0096s/iter; left time: 88.6044s
Epoch: 4 cost time: 5.76263165473938
Epoch: 4, Steps: 570 | Train Loss: 0.0838992 Vali Loss: 0.0327651 Test Loss: 0.1234813
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0689471
	speed: 0.0334s/iter; left time: 301.7250s
	iters: 200, epoch: 5 | loss: 0.1114149
	speed: 0.0097s/iter; left time: 86.4935s
	iters: 300, epoch: 5 | loss: 0.0744229
	speed: 0.0097s/iter; left time: 85.6571s
	iters: 400, epoch: 5 | loss: 0.0765360
	speed: 0.0097s/iter; left time: 84.6896s
	iters: 500, epoch: 5 | loss: 0.0884891
	speed: 0.0097s/iter; left time: 83.8011s
Epoch: 5 cost time: 5.7811737060546875
Epoch: 5, Steps: 570 | Train Loss: 0.0778286 Vali Loss: 0.0337480 Test Loss: 0.1258224
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0476849
	speed: 0.0338s/iter; left time: 285.4097s
	iters: 200, epoch: 6 | loss: 0.1018444
	speed: 0.0097s/iter; left time: 80.7204s
	iters: 300, epoch: 6 | loss: 0.0883378
	speed: 0.0097s/iter; left time: 79.6553s
	iters: 400, epoch: 6 | loss: 0.0570945
	speed: 0.0096s/iter; left time: 78.4089s
	iters: 500, epoch: 6 | loss: 0.0762804
	speed: 0.0096s/iter; left time: 77.3291s
Epoch: 6 cost time: 5.755339622497559
Epoch: 6, Steps: 570 | Train Loss: 0.0748220 Vali Loss: 0.0333969 Test Loss: 0.1274433
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12197543680667877, mae:0.21644380688667297
>>> MS_Pen LR=1e-4 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1806068
	speed: 0.0222s/iter; left time: 250.8636s
	iters: 200, epoch: 1 | loss: 0.1330624
	speed: 0.0108s/iter; left time: 120.8877s
	iters: 300, epoch: 1 | loss: 0.1259912
	speed: 0.0112s/iter; left time: 124.0806s
	iters: 400, epoch: 1 | loss: 0.1167485
	speed: 0.0112s/iter; left time: 123.1056s
	iters: 500, epoch: 1 | loss: 0.1525764
	speed: 0.0112s/iter; left time: 122.4731s
Epoch: 1 cost time: 7.494372129440308
Epoch: 1, Steps: 570 | Train Loss: 0.1863703 Vali Loss: 0.0434450 Test Loss: 0.1402353
Validation loss decreased (inf --> 0.043445).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1557603
	speed: 0.0387s/iter; left time: 415.4153s
	iters: 200, epoch: 2 | loss: 0.2406112
	speed: 0.0110s/iter; left time: 116.5390s
	iters: 300, epoch: 2 | loss: 0.1412663
	speed: 0.0110s/iter; left time: 115.9106s
	iters: 400, epoch: 2 | loss: 0.2112997
	speed: 0.0110s/iter; left time: 114.4808s
	iters: 500, epoch: 2 | loss: 0.1300439
	speed: 0.0110s/iter; left time: 113.6560s
Epoch: 2 cost time: 6.525387763977051
Epoch: 2, Steps: 570 | Train Loss: 0.1397138 Vali Loss: 0.0382057 Test Loss: 0.1310028
Validation loss decreased (0.043445 --> 0.038206).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0864218
	speed: 0.0367s/iter; left time: 372.4381s
	iters: 200, epoch: 3 | loss: 0.0825816
	speed: 0.0098s/iter; left time: 98.3705s
	iters: 300, epoch: 3 | loss: 0.1351197
	speed: 0.0098s/iter; left time: 97.5256s
	iters: 400, epoch: 3 | loss: 0.1059851
	speed: 0.0098s/iter; left time: 96.2570s
	iters: 500, epoch: 3 | loss: 0.0844773
	speed: 0.0098s/iter; left time: 95.5989s
Epoch: 3 cost time: 5.867000579833984
Epoch: 3, Steps: 570 | Train Loss: 0.1136385 Vali Loss: 0.0389348 Test Loss: 0.1363787
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0768163
	speed: 0.0347s/iter; left time: 332.7149s
	iters: 200, epoch: 4 | loss: 0.0842355
	speed: 0.0098s/iter; left time: 92.9062s
	iters: 300, epoch: 4 | loss: 0.0914899
	speed: 0.0098s/iter; left time: 92.1557s
	iters: 400, epoch: 4 | loss: 0.1137490
	speed: 0.0098s/iter; left time: 91.1831s
	iters: 500, epoch: 4 | loss: 0.0948187
	speed: 0.0098s/iter; left time: 89.8628s
Epoch: 4 cost time: 5.845001697540283
Epoch: 4, Steps: 570 | Train Loss: 0.0997203 Vali Loss: 0.0390628 Test Loss: 0.1417433
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1088636
	speed: 0.0351s/iter; left time: 316.8192s
	iters: 200, epoch: 5 | loss: 0.0569215
	speed: 0.0097s/iter; left time: 86.8531s
	iters: 300, epoch: 5 | loss: 0.1021267
	speed: 0.0097s/iter; left time: 85.8984s
	iters: 400, epoch: 5 | loss: 0.0748435
	speed: 0.0097s/iter; left time: 84.9940s
	iters: 500, epoch: 5 | loss: 0.1122390
	speed: 0.0098s/iter; left time: 84.3088s
Epoch: 5 cost time: 5.838915824890137
Epoch: 5, Steps: 570 | Train Loss: 0.0920744 Vali Loss: 0.0384932 Test Loss: 0.1423570
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13118214905261993, mae:0.23255833983421326
>>> MS_Pen LR=1e-4 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2290800
	speed: 0.0231s/iter; left time: 261.3199s
	iters: 200, epoch: 1 | loss: 0.1984270
	speed: 0.0115s/iter; left time: 128.6198s
	iters: 300, epoch: 1 | loss: 0.1666910
	speed: 0.0114s/iter; left time: 126.7499s
	iters: 400, epoch: 1 | loss: 0.0994570
	speed: 0.0114s/iter; left time: 125.1107s
	iters: 500, epoch: 1 | loss: 0.1680391
	speed: 0.0114s/iter; left time: 123.9579s
Epoch: 1 cost time: 7.7227396965026855
Epoch: 1, Steps: 570 | Train Loss: 0.1781644 Vali Loss: 0.0395395 Test Loss: 0.1242707
Validation loss decreased (inf --> 0.039539).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1211852
	speed: 0.0393s/iter; left time: 421.9831s
	iters: 200, epoch: 2 | loss: 0.1115378
	speed: 0.0114s/iter; left time: 121.6452s
	iters: 300, epoch: 2 | loss: 0.0845024
	speed: 0.0115s/iter; left time: 120.6882s
	iters: 400, epoch: 2 | loss: 0.0728717
	speed: 0.0114s/iter; left time: 119.2832s
	iters: 500, epoch: 2 | loss: 0.1336014
	speed: 0.0114s/iter; left time: 118.1485s
Epoch: 2 cost time: 6.863337516784668
Epoch: 2, Steps: 570 | Train Loss: 0.1268862 Vali Loss: 0.0379405 Test Loss: 0.1311331
Validation loss decreased (0.039539 --> 0.037940).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0959460
	speed: 0.0406s/iter; left time: 412.8686s
	iters: 200, epoch: 3 | loss: 0.1004133
	speed: 0.0114s/iter; left time: 114.9526s
	iters: 300, epoch: 3 | loss: 0.0615764
	speed: 0.0114s/iter; left time: 113.9288s
	iters: 400, epoch: 3 | loss: 0.0659268
	speed: 0.0114s/iter; left time: 112.7305s
	iters: 500, epoch: 3 | loss: 0.0794113
	speed: 0.0114s/iter; left time: 111.5449s
Epoch: 3 cost time: 6.80659818649292
Epoch: 3, Steps: 570 | Train Loss: 0.0889106 Vali Loss: 0.0364677 Test Loss: 0.1360816
Validation loss decreased (0.037940 --> 0.036468).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0616551
	speed: 0.0382s/iter; left time: 366.3323s
	iters: 200, epoch: 4 | loss: 0.0775506
	speed: 0.0114s/iter; left time: 108.1596s
	iters: 300, epoch: 4 | loss: 0.0498155
	speed: 0.0114s/iter; left time: 107.1394s
	iters: 400, epoch: 4 | loss: 0.0640740
	speed: 0.0114s/iter; left time: 106.0954s
	iters: 500, epoch: 4 | loss: 0.0767239
	speed: 0.0114s/iter; left time: 104.8721s
Epoch: 4 cost time: 6.810139894485474
Epoch: 4, Steps: 570 | Train Loss: 0.0711332 Vali Loss: 0.0366057 Test Loss: 0.1440215
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0607093
	speed: 0.0377s/iter; left time: 340.2494s
	iters: 200, epoch: 5 | loss: 0.0462542
	speed: 0.0115s/iter; left time: 102.1487s
	iters: 300, epoch: 5 | loss: 0.0789210
	speed: 0.0115s/iter; left time: 101.0484s
	iters: 400, epoch: 5 | loss: 0.0528346
	speed: 0.0114s/iter; left time: 99.3351s
	iters: 500, epoch: 5 | loss: 0.0704773
	speed: 0.0114s/iter; left time: 98.1848s
Epoch: 5 cost time: 6.774209260940552
Epoch: 5, Steps: 570 | Train Loss: 0.0620617 Vali Loss: 0.0360035 Test Loss: 0.1479697
Validation loss decreased (0.036468 --> 0.036003).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0519758
	speed: 0.0377s/iter; left time: 318.8383s
	iters: 200, epoch: 6 | loss: 0.0430103
	speed: 0.0114s/iter; left time: 95.0863s
	iters: 300, epoch: 6 | loss: 0.0611792
	speed: 0.0114s/iter; left time: 93.8418s
	iters: 400, epoch: 6 | loss: 0.0480496
	speed: 0.0114s/iter; left time: 92.7774s
	iters: 500, epoch: 6 | loss: 0.0479657
	speed: 0.0114s/iter; left time: 91.6249s
Epoch: 6 cost time: 6.789271831512451
Epoch: 6, Steps: 570 | Train Loss: 0.0574905 Vali Loss: 0.0362110 Test Loss: 0.1503702
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0489193
	speed: 0.0371s/iter; left time: 292.4150s
	iters: 200, epoch: 7 | loss: 0.0492358
	speed: 0.0113s/iter; left time: 88.2574s
	iters: 300, epoch: 7 | loss: 0.0618594
	speed: 0.0114s/iter; left time: 87.2410s
	iters: 400, epoch: 7 | loss: 0.0482835
	speed: 0.0113s/iter; left time: 85.9794s
	iters: 500, epoch: 7 | loss: 0.0610141
	speed: 0.0114s/iter; left time: 85.0981s
Epoch: 7 cost time: 6.7581586837768555
Epoch: 7, Steps: 570 | Train Loss: 0.0551187 Vali Loss: 0.0361290 Test Loss: 0.1523157
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0400130
	speed: 0.0383s/iter; left time: 280.0288s
	iters: 200, epoch: 8 | loss: 0.0698253
	speed: 0.0114s/iter; left time: 82.3343s
	iters: 300, epoch: 8 | loss: 0.0409681
	speed: 0.0114s/iter; left time: 80.9520s
	iters: 400, epoch: 8 | loss: 0.0505069
	speed: 0.0114s/iter; left time: 79.8079s
	iters: 500, epoch: 8 | loss: 0.0578457
	speed: 0.0114s/iter; left time: 78.9625s
Epoch: 8 cost time: 6.828315258026123
Epoch: 8, Steps: 570 | Train Loss: 0.0539298 Vali Loss: 0.0363233 Test Loss: 0.1524228
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1481112390756607, mae:0.24417005479335785
>>> MS_Pen LR=1e-4 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.0849816
	speed: 0.0227s/iter; left time: 256.9015s
	iters: 200, epoch: 1 | loss: 0.2110824
	speed: 0.0110s/iter; left time: 123.7195s
	iters: 300, epoch: 1 | loss: 0.1199775
	speed: 0.0111s/iter; left time: 122.7498s
	iters: 400, epoch: 1 | loss: 0.1436234
	speed: 0.0110s/iter; left time: 121.4763s
	iters: 500, epoch: 1 | loss: 0.1273525
	speed: 0.0111s/iter; left time: 120.4746s
Epoch: 1 cost time: 7.51636266708374
Epoch: 1, Steps: 570 | Train Loss: 0.1504047 Vali Loss: 0.0380494 Test Loss: 0.1220139
Validation loss decreased (inf --> 0.038049).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1165143
	speed: 0.0382s/iter; left time: 409.8055s
	iters: 200, epoch: 2 | loss: 0.0705076
	speed: 0.0110s/iter; left time: 117.4580s
	iters: 300, epoch: 2 | loss: 0.0974498
	speed: 0.0110s/iter; left time: 116.0734s
	iters: 400, epoch: 2 | loss: 0.1201246
	speed: 0.0111s/iter; left time: 115.2659s
	iters: 500, epoch: 2 | loss: 0.1405082
	speed: 0.0110s/iter; left time: 114.1417s
Epoch: 2 cost time: 6.622708320617676
Epoch: 2, Steps: 570 | Train Loss: 0.1092670 Vali Loss: 0.0354940 Test Loss: 0.1258671
Validation loss decreased (0.038049 --> 0.035494).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1016904
	speed: 0.0377s/iter; left time: 383.1395s
	iters: 200, epoch: 3 | loss: 0.0652862
	speed: 0.0111s/iter; left time: 111.4629s
	iters: 300, epoch: 3 | loss: 0.0749507
	speed: 0.0110s/iter; left time: 109.7791s
	iters: 400, epoch: 3 | loss: 0.1026016
	speed: 0.0110s/iter; left time: 108.8363s
	iters: 500, epoch: 3 | loss: 0.0682550
	speed: 0.0110s/iter; left time: 107.6165s
Epoch: 3 cost time: 6.588038206100464
Epoch: 3, Steps: 570 | Train Loss: 0.0786528 Vali Loss: 0.0332744 Test Loss: 0.1287154
Validation loss decreased (0.035494 --> 0.033274).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0669898
	speed: 0.0382s/iter; left time: 366.3015s
	iters: 200, epoch: 4 | loss: 0.0531296
	speed: 0.0111s/iter; left time: 105.0246s
	iters: 300, epoch: 4 | loss: 0.0388000
	speed: 0.0111s/iter; left time: 103.7746s
	iters: 400, epoch: 4 | loss: 0.0539334
	speed: 0.0111s/iter; left time: 102.8775s
	iters: 500, epoch: 4 | loss: 0.0667274
	speed: 0.0111s/iter; left time: 101.9480s
Epoch: 4 cost time: 6.606606483459473
Epoch: 4, Steps: 570 | Train Loss: 0.0630077 Vali Loss: 0.0333254 Test Loss: 0.1321085
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0492652
	speed: 0.0377s/iter; left time: 339.9031s
	iters: 200, epoch: 5 | loss: 0.0458060
	speed: 0.0111s/iter; left time: 98.8758s
	iters: 300, epoch: 5 | loss: 0.0746971
	speed: 0.0111s/iter; left time: 97.6615s
	iters: 400, epoch: 5 | loss: 0.0569119
	speed: 0.0111s/iter; left time: 96.6249s
	iters: 500, epoch: 5 | loss: 0.0459532
	speed: 0.0111s/iter; left time: 95.8656s
Epoch: 5 cost time: 6.61307954788208
Epoch: 5, Steps: 570 | Train Loss: 0.0552191 Vali Loss: 0.0344243 Test Loss: 0.1344911
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0772860
	speed: 0.0372s/iter; left time: 314.3550s
	iters: 200, epoch: 6 | loss: 0.0445817
	speed: 0.0110s/iter; left time: 91.9908s
	iters: 300, epoch: 6 | loss: 0.0494967
	speed: 0.0110s/iter; left time: 91.1641s
	iters: 400, epoch: 6 | loss: 0.0453695
	speed: 0.0110s/iter; left time: 89.9312s
	iters: 500, epoch: 6 | loss: 0.0489519
	speed: 0.0110s/iter; left time: 88.6915s
Epoch: 6 cost time: 6.548296689987183
Epoch: 6, Steps: 570 | Train Loss: 0.0512661 Vali Loss: 0.0350564 Test Loss: 0.1360733
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12883634865283966, mae:0.22245939075946808
>>> MS_Pen LR=1e-4 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2104485
	speed: 0.0233s/iter; left time: 263.6103s
	iters: 200, epoch: 1 | loss: 0.2100265
	speed: 0.0113s/iter; left time: 126.6722s
	iters: 300, epoch: 1 | loss: 0.2610968
	speed: 0.0113s/iter; left time: 125.8085s
	iters: 400, epoch: 1 | loss: 0.1367320
	speed: 0.0113s/iter; left time: 124.3585s
	iters: 500, epoch: 1 | loss: 0.1569805
	speed: 0.0113s/iter; left time: 123.5822s
Epoch: 1 cost time: 7.69862174987793
Epoch: 1, Steps: 570 | Train Loss: 0.1796115 Vali Loss: 0.0419040 Test Loss: 0.1352446
Validation loss decreased (inf --> 0.041904).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1895560
	speed: 0.0378s/iter; left time: 405.5891s
	iters: 200, epoch: 2 | loss: 0.2341055
	speed: 0.0103s/iter; left time: 109.0394s
	iters: 300, epoch: 2 | loss: 0.1198907
	speed: 0.0103s/iter; left time: 108.2873s
	iters: 400, epoch: 2 | loss: 0.1212812
	speed: 0.0103s/iter; left time: 107.1349s
	iters: 500, epoch: 2 | loss: 0.1137801
	speed: 0.0103s/iter; left time: 106.2907s
Epoch: 2 cost time: 6.156515121459961
Epoch: 2, Steps: 570 | Train Loss: 0.1290637 Vali Loss: 0.0437909 Test Loss: 0.1480922
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1161442
	speed: 0.0382s/iter; left time: 388.5441s
	iters: 200, epoch: 3 | loss: 0.0740235
	speed: 0.0103s/iter; left time: 103.5929s
	iters: 300, epoch: 3 | loss: 0.1028902
	speed: 0.0103s/iter; left time: 102.3957s
	iters: 400, epoch: 3 | loss: 0.0674666
	speed: 0.0103s/iter; left time: 101.3445s
	iters: 500, epoch: 3 | loss: 0.1188950
	speed: 0.0102s/iter; left time: 100.0416s
Epoch: 3 cost time: 6.231300115585327
Epoch: 3, Steps: 570 | Train Loss: 0.0916885 Vali Loss: 0.0382248 Test Loss: 0.1464453
Validation loss decreased (0.041904 --> 0.038225).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0587352
	speed: 0.0373s/iter; left time: 357.6897s
	iters: 200, epoch: 4 | loss: 0.0791870
	speed: 0.0102s/iter; left time: 97.0311s
	iters: 300, epoch: 4 | loss: 0.0678911
	speed: 0.0102s/iter; left time: 96.1507s
	iters: 400, epoch: 4 | loss: 0.1027076
	speed: 0.0102s/iter; left time: 94.8901s
	iters: 500, epoch: 4 | loss: 0.0609350
	speed: 0.0102s/iter; left time: 93.9745s
Epoch: 4 cost time: 6.1435465812683105
Epoch: 4, Steps: 570 | Train Loss: 0.0717466 Vali Loss: 0.0393556 Test Loss: 0.1508835
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0602872
	speed: 0.0363s/iter; left time: 327.1006s
	iters: 200, epoch: 5 | loss: 0.0661278
	speed: 0.0102s/iter; left time: 90.9582s
	iters: 300, epoch: 5 | loss: 0.0694118
	speed: 0.0102s/iter; left time: 90.0649s
	iters: 400, epoch: 5 | loss: 0.0402368
	speed: 0.0102s/iter; left time: 88.9232s
	iters: 500, epoch: 5 | loss: 0.0863514
	speed: 0.0102s/iter; left time: 88.0848s
Epoch: 5 cost time: 6.102572441101074
Epoch: 5, Steps: 570 | Train Loss: 0.0619028 Vali Loss: 0.0395697 Test Loss: 0.1529218
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0606997
	speed: 0.0363s/iter; left time: 306.9677s
	iters: 200, epoch: 6 | loss: 0.0538693
	speed: 0.0103s/iter; left time: 85.8272s
	iters: 300, epoch: 6 | loss: 0.0447791
	speed: 0.0103s/iter; left time: 84.7576s
	iters: 400, epoch: 6 | loss: 0.0456520
	speed: 0.0103s/iter; left time: 83.8540s
	iters: 500, epoch: 6 | loss: 0.0562930
	speed: 0.0103s/iter; left time: 82.8181s
Epoch: 6 cost time: 6.172049522399902
Epoch: 6, Steps: 570 | Train Loss: 0.0570151 Vali Loss: 0.0395987 Test Loss: 0.1535312
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1466112583875656, mae:0.24757108092308044
>>> MS_Pen LR=1e-4 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1373215
	speed: 0.0274s/iter; left time: 309.5783s
	iters: 200, epoch: 1 | loss: 0.1300512
	speed: 0.0153s/iter; left time: 171.0433s
	iters: 300, epoch: 1 | loss: 0.2647642
	speed: 0.0155s/iter; left time: 172.0670s
	iters: 400, epoch: 1 | loss: 0.1357386
	speed: 0.0156s/iter; left time: 171.3699s
	iters: 500, epoch: 1 | loss: 0.1326106
	speed: 0.0156s/iter; left time: 169.7325s
Epoch: 1 cost time: 10.02921199798584
Epoch: 1, Steps: 570 | Train Loss: 0.1786299 Vali Loss: 0.0413365 Test Loss: 0.1295805
Validation loss decreased (inf --> 0.041337).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1772802
	speed: 0.0463s/iter; left time: 496.5140s
	iters: 200, epoch: 2 | loss: 0.1179653
	speed: 0.0139s/iter; left time: 147.9530s
	iters: 300, epoch: 2 | loss: 0.1196589
	speed: 0.0139s/iter; left time: 146.0415s
	iters: 400, epoch: 2 | loss: 0.1021989
	speed: 0.0139s/iter; left time: 144.7173s
	iters: 500, epoch: 2 | loss: 0.1541142
	speed: 0.0139s/iter; left time: 143.3213s
Epoch: 2 cost time: 8.20028305053711
Epoch: 2, Steps: 570 | Train Loss: 0.1336578 Vali Loss: 0.0376964 Test Loss: 0.1273766
Validation loss decreased (0.041337 --> 0.037696).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1819774
	speed: 0.0459s/iter; left time: 466.0795s
	iters: 200, epoch: 3 | loss: 0.1080760
	speed: 0.0139s/iter; left time: 139.3642s
	iters: 300, epoch: 3 | loss: 0.0796108
	speed: 0.0139s/iter; left time: 137.9878s
	iters: 400, epoch: 3 | loss: 0.0644000
	speed: 0.0139s/iter; left time: 136.6077s
	iters: 500, epoch: 3 | loss: 0.0758902
	speed: 0.0139s/iter; left time: 135.3688s
Epoch: 3 cost time: 8.198991775512695
Epoch: 3, Steps: 570 | Train Loss: 0.1034940 Vali Loss: 0.0338919 Test Loss: 0.1230429
Validation loss decreased (0.037696 --> 0.033892).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0934337
	speed: 0.0459s/iter; left time: 440.4732s
	iters: 200, epoch: 4 | loss: 0.0656561
	speed: 0.0139s/iter; left time: 131.6331s
	iters: 300, epoch: 4 | loss: 0.1575601
	speed: 0.0139s/iter; left time: 130.5055s
	iters: 400, epoch: 4 | loss: 0.0956760
	speed: 0.0138s/iter; left time: 128.5438s
	iters: 500, epoch: 4 | loss: 0.0784618
	speed: 0.0139s/iter; left time: 127.4845s
Epoch: 4 cost time: 8.210010528564453
Epoch: 4, Steps: 570 | Train Loss: 0.0867798 Vali Loss: 0.0345526 Test Loss: 0.1273272
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0782573
	speed: 0.0481s/iter; left time: 434.0361s
	iters: 200, epoch: 5 | loss: 0.0782475
	speed: 0.0138s/iter; left time: 123.4251s
	iters: 300, epoch: 5 | loss: 0.0661041
	speed: 0.0138s/iter; left time: 121.7423s
	iters: 400, epoch: 5 | loss: 0.0741376
	speed: 0.0138s/iter; left time: 119.9955s
	iters: 500, epoch: 5 | loss: 0.0559326
	speed: 0.0138s/iter; left time: 118.9777s
Epoch: 5 cost time: 8.16446328163147
Epoch: 5, Steps: 570 | Train Loss: 0.0788099 Vali Loss: 0.0339274 Test Loss: 0.1264254
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0634244
	speed: 0.0461s/iter; left time: 389.2282s
	iters: 200, epoch: 6 | loss: 0.1046953
	speed: 0.0153s/iter; left time: 127.8851s
	iters: 300, epoch: 6 | loss: 0.0543492
	speed: 0.0156s/iter; left time: 128.4085s
	iters: 400, epoch: 6 | loss: 0.0737267
	speed: 0.0155s/iter; left time: 126.6549s
	iters: 500, epoch: 6 | loss: 0.0701077
	speed: 0.0155s/iter; left time: 125.0683s
Epoch: 6 cost time: 9.123941421508789
Epoch: 6, Steps: 570 | Train Loss: 0.0745492 Vali Loss: 0.0339280 Test Loss: 0.1279517
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1231585294008255, mae:0.2215442955493927
>>> MS_Pen LR=1e-4 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2228680
	speed: 0.0268s/iter; left time: 302.9764s
	iters: 200, epoch: 1 | loss: 0.1302755
	speed: 0.0151s/iter; left time: 169.4058s
	iters: 300, epoch: 1 | loss: 0.0923633
	speed: 0.0151s/iter; left time: 168.0413s
	iters: 400, epoch: 1 | loss: 0.1942106
	speed: 0.0152s/iter; left time: 166.9635s
	iters: 500, epoch: 1 | loss: 0.1519071
	speed: 0.0152s/iter; left time: 165.5289s
Epoch: 1 cost time: 9.854565858840942
Epoch: 1, Steps: 570 | Train Loss: 0.1517454 Vali Loss: 0.0358425 Test Loss: 0.1151307
Validation loss decreased (inf --> 0.035843).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0873876
	speed: 0.0461s/iter; left time: 494.7860s
	iters: 200, epoch: 2 | loss: 0.2040911
	speed: 0.0136s/iter; left time: 144.1443s
	iters: 300, epoch: 2 | loss: 0.1359060
	speed: 0.0135s/iter; left time: 142.2088s
	iters: 400, epoch: 2 | loss: 0.0882370
	speed: 0.0135s/iter; left time: 141.0983s
	iters: 500, epoch: 2 | loss: 0.1024536
	speed: 0.0135s/iter; left time: 139.3901s
Epoch: 2 cost time: 8.028257369995117
Epoch: 2, Steps: 570 | Train Loss: 0.1145722 Vali Loss: 0.0357079 Test Loss: 0.1219551
Validation loss decreased (0.035843 --> 0.035708).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0932652
	speed: 0.0459s/iter; left time: 466.2868s
	iters: 200, epoch: 3 | loss: 0.0489253
	speed: 0.0136s/iter; left time: 136.5977s
	iters: 300, epoch: 3 | loss: 0.0962988
	speed: 0.0136s/iter; left time: 135.2297s
	iters: 400, epoch: 3 | loss: 0.0695900
	speed: 0.0136s/iter; left time: 133.6782s
	iters: 500, epoch: 3 | loss: 0.0648711
	speed: 0.0135s/iter; left time: 132.0912s
Epoch: 3 cost time: 8.043998718261719
Epoch: 3, Steps: 570 | Train Loss: 0.0889892 Vali Loss: 0.0335591 Test Loss: 0.1218938
Validation loss decreased (0.035708 --> 0.033559).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0467530
	speed: 0.0482s/iter; left time: 462.0731s
	iters: 200, epoch: 4 | loss: 0.0777251
	speed: 0.0136s/iter; left time: 129.0944s
	iters: 300, epoch: 4 | loss: 0.0924030
	speed: 0.0136s/iter; left time: 127.6918s
	iters: 400, epoch: 4 | loss: 0.0593087
	speed: 0.0136s/iter; left time: 126.3007s
	iters: 500, epoch: 4 | loss: 0.0475164
	speed: 0.0136s/iter; left time: 125.0667s
Epoch: 4 cost time: 8.170675277709961
Epoch: 4, Steps: 570 | Train Loss: 0.0754846 Vali Loss: 0.0326997 Test Loss: 0.1251642
Validation loss decreased (0.033559 --> 0.032700).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0439294
	speed: 0.0456s/iter; left time: 411.3737s
	iters: 200, epoch: 5 | loss: 0.0731544
	speed: 0.0147s/iter; left time: 131.0914s
	iters: 300, epoch: 5 | loss: 0.0604779
	speed: 0.0143s/iter; left time: 126.0331s
	iters: 400, epoch: 5 | loss: 0.0685933
	speed: 0.0152s/iter; left time: 132.1416s
	iters: 500, epoch: 5 | loss: 0.0657281
	speed: 0.0152s/iter; left time: 130.9161s
Epoch: 5 cost time: 8.65649127960205
Epoch: 5, Steps: 570 | Train Loss: 0.0684629 Vali Loss: 0.0334222 Test Loss: 0.1261797
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0646953
	speed: 0.0470s/iter; left time: 396.8069s
	iters: 200, epoch: 6 | loss: 0.0931139
	speed: 0.0134s/iter; left time: 111.8120s
	iters: 300, epoch: 6 | loss: 0.0684405
	speed: 0.0134s/iter; left time: 110.5378s
	iters: 400, epoch: 6 | loss: 0.0913460
	speed: 0.0134s/iter; left time: 109.1484s
	iters: 500, epoch: 6 | loss: 0.0721350
	speed: 0.0134s/iter; left time: 107.7846s
Epoch: 6 cost time: 7.914351463317871
Epoch: 6, Steps: 570 | Train Loss: 0.0648065 Vali Loss: 0.0335045 Test Loss: 0.1271101
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0371621
	speed: 0.0436s/iter; left time: 343.9146s
	iters: 200, epoch: 7 | loss: 0.0737689
	speed: 0.0134s/iter; left time: 104.5893s
	iters: 300, epoch: 7 | loss: 0.0528295
	speed: 0.0134s/iter; left time: 103.0713s
	iters: 400, epoch: 7 | loss: 0.0952668
	speed: 0.0134s/iter; left time: 101.6204s
	iters: 500, epoch: 7 | loss: 0.0825908
	speed: 0.0134s/iter; left time: 100.1691s
Epoch: 7 cost time: 7.92781662940979
Epoch: 7, Steps: 570 | Train Loss: 0.0629649 Vali Loss: 0.0334596 Test Loss: 0.1273330
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12528149783611298, mae:0.2193782478570938
>>> MS_Pen LR=1e-4 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1192097
	speed: 0.0269s/iter; left time: 303.6678s
	iters: 200, epoch: 1 | loss: 0.2324761
	speed: 0.0151s/iter; left time: 168.6125s
	iters: 300, epoch: 1 | loss: 0.2286795
	speed: 0.0150s/iter; left time: 166.8848s
	iters: 400, epoch: 1 | loss: 0.1783324
	speed: 0.0150s/iter; left time: 165.3786s
	iters: 500, epoch: 1 | loss: 0.2329967
	speed: 0.0151s/iter; left time: 164.5713s
Epoch: 1 cost time: 9.812807321548462
Epoch: 1, Steps: 570 | Train Loss: 0.1842826 Vali Loss: 0.0445236 Test Loss: 0.1375369
Validation loss decreased (inf --> 0.044524).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1110856
	speed: 0.0479s/iter; left time: 514.5414s
	iters: 200, epoch: 2 | loss: 0.0989821
	speed: 0.0136s/iter; left time: 144.7776s
	iters: 300, epoch: 2 | loss: 0.0766269
	speed: 0.0136s/iter; left time: 143.1705s
	iters: 400, epoch: 2 | loss: 0.1038766
	speed: 0.0136s/iter; left time: 141.9330s
	iters: 500, epoch: 2 | loss: 0.1279820
	speed: 0.0136s/iter; left time: 140.2328s
Epoch: 2 cost time: 8.068837642669678
Epoch: 2, Steps: 570 | Train Loss: 0.1358967 Vali Loss: 0.0389350 Test Loss: 0.1325036
Validation loss decreased (0.044524 --> 0.038935).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1352002
	speed: 0.0463s/iter; left time: 470.4450s
	iters: 200, epoch: 3 | loss: 0.1304291
	speed: 0.0134s/iter; left time: 134.5066s
	iters: 300, epoch: 3 | loss: 0.1044223
	speed: 0.0134s/iter; left time: 133.1928s
	iters: 400, epoch: 3 | loss: 0.1038998
	speed: 0.0134s/iter; left time: 132.1085s
	iters: 500, epoch: 3 | loss: 0.0798049
	speed: 0.0134s/iter; left time: 130.9451s
Epoch: 3 cost time: 7.920952796936035
Epoch: 3, Steps: 570 | Train Loss: 0.1049488 Vali Loss: 0.0395220 Test Loss: 0.1362560
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0993541
	speed: 0.0461s/iter; left time: 442.4998s
	iters: 200, epoch: 4 | loss: 0.1011510
	speed: 0.0134s/iter; left time: 127.5503s
	iters: 300, epoch: 4 | loss: 0.0930419
	speed: 0.0135s/iter; left time: 126.7493s
	iters: 400, epoch: 4 | loss: 0.1054126
	speed: 0.0134s/iter; left time: 124.7713s
	iters: 500, epoch: 4 | loss: 0.0654402
	speed: 0.0134s/iter; left time: 123.5607s
Epoch: 4 cost time: 7.940704345703125
Epoch: 4, Steps: 570 | Train Loss: 0.0893992 Vali Loss: 0.0380966 Test Loss: 0.1394856
Validation loss decreased (0.038935 --> 0.038097).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1080043
	speed: 0.0483s/iter; left time: 435.3828s
	iters: 200, epoch: 5 | loss: 0.0968780
	speed: 0.0156s/iter; left time: 139.1757s
	iters: 300, epoch: 5 | loss: 0.0794996
	speed: 0.0155s/iter; left time: 136.9511s
	iters: 400, epoch: 5 | loss: 0.1177314
	speed: 0.0155s/iter; left time: 135.4305s
	iters: 500, epoch: 5 | loss: 0.0759443
	speed: 0.0155s/iter; left time: 133.8684s
Epoch: 5 cost time: 9.09155559539795
Epoch: 5, Steps: 570 | Train Loss: 0.0806721 Vali Loss: 0.0384994 Test Loss: 0.1404670
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0838713
	speed: 0.0478s/iter; left time: 404.1091s
	iters: 200, epoch: 6 | loss: 0.0799774
	speed: 0.0135s/iter; left time: 112.7491s
	iters: 300, epoch: 6 | loss: 0.0624236
	speed: 0.0135s/iter; left time: 111.7202s
	iters: 400, epoch: 6 | loss: 0.1305891
	speed: 0.0136s/iter; left time: 110.5777s
	iters: 500, epoch: 6 | loss: 0.0754681
	speed: 0.0135s/iter; left time: 108.9673s
Epoch: 6 cost time: 8.023685216903687
Epoch: 6, Steps: 570 | Train Loss: 0.0760878 Vali Loss: 0.0385548 Test Loss: 0.1416423
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0639554
	speed: 0.0471s/iter; left time: 371.0092s
	iters: 200, epoch: 7 | loss: 0.0654968
	speed: 0.0135s/iter; left time: 105.3284s
	iters: 300, epoch: 7 | loss: 0.0651875
	speed: 0.0135s/iter; left time: 103.6023s
	iters: 400, epoch: 7 | loss: 0.1015227
	speed: 0.0135s/iter; left time: 102.0984s
	iters: 500, epoch: 7 | loss: 0.0568726
	speed: 0.0135s/iter; left time: 100.6449s
Epoch: 7 cost time: 8.027069091796875
Epoch: 7, Steps: 570 | Train Loss: 0.0737214 Vali Loss: 0.0388906 Test Loss: 0.1413176
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13961341977119446, mae:0.23763813078403473
>>> MS_Pen LR=1e-4 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1759196
	speed: 0.0300s/iter; left time: 338.6313s
	iters: 200, epoch: 1 | loss: 0.1267276
	speed: 0.0175s/iter; left time: 196.1466s
	iters: 300, epoch: 1 | loss: 0.2101160
	speed: 0.0171s/iter; left time: 189.5169s
	iters: 400, epoch: 1 | loss: 0.1698066
	speed: 0.0171s/iter; left time: 187.7665s
	iters: 500, epoch: 1 | loss: 0.1186180
	speed: 0.0164s/iter; left time: 178.9511s
Epoch: 1 cost time: 10.995859384536743
Epoch: 1, Steps: 570 | Train Loss: 0.1764370 Vali Loss: 0.0472840 Test Loss: 0.1422367
Validation loss decreased (inf --> 0.047284).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1635251
	speed: 0.0499s/iter; left time: 535.6020s
	iters: 200, epoch: 2 | loss: 0.1177433
	speed: 0.0164s/iter; left time: 174.3680s
	iters: 300, epoch: 2 | loss: 0.1689897
	speed: 0.0164s/iter; left time: 172.3428s
	iters: 400, epoch: 2 | loss: 0.0971924
	speed: 0.0163s/iter; left time: 170.5415s
	iters: 500, epoch: 2 | loss: 0.0841979
	speed: 0.0164s/iter; left time: 168.9149s
Epoch: 2 cost time: 9.6500244140625
Epoch: 2, Steps: 570 | Train Loss: 0.1236040 Vali Loss: 0.0392487 Test Loss: 0.1350202
Validation loss decreased (0.047284 --> 0.039249).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0871864
	speed: 0.0521s/iter; left time: 529.0709s
	iters: 200, epoch: 3 | loss: 0.0848533
	speed: 0.0164s/iter; left time: 164.5759s
	iters: 300, epoch: 3 | loss: 0.1564793
	speed: 0.0163s/iter; left time: 162.6521s
	iters: 400, epoch: 3 | loss: 0.0699797
	speed: 0.0163s/iter; left time: 161.0915s
	iters: 500, epoch: 3 | loss: 0.0740545
	speed: 0.0163s/iter; left time: 159.4840s
Epoch: 3 cost time: 9.635157585144043
Epoch: 3, Steps: 570 | Train Loss: 0.0835660 Vali Loss: 0.0342583 Test Loss: 0.1301725
Validation loss decreased (0.039249 --> 0.034258).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0641465
	speed: 0.0499s/iter; left time: 478.1897s
	iters: 200, epoch: 4 | loss: 0.0671999
	speed: 0.0163s/iter; left time: 155.0406s
	iters: 300, epoch: 4 | loss: 0.0350973
	speed: 0.0163s/iter; left time: 153.4839s
	iters: 400, epoch: 4 | loss: 0.0855201
	speed: 0.0163s/iter; left time: 151.5669s
	iters: 500, epoch: 4 | loss: 0.0652469
	speed: 0.0163s/iter; left time: 150.0112s
Epoch: 4 cost time: 9.593931913375854
Epoch: 4, Steps: 570 | Train Loss: 0.0627335 Vali Loss: 0.0360190 Test Loss: 0.1380485
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0386451
	speed: 0.0484s/iter; left time: 436.7003s
	iters: 200, epoch: 5 | loss: 0.0667844
	speed: 0.0163s/iter; left time: 145.5351s
	iters: 300, epoch: 5 | loss: 0.0482622
	speed: 0.0163s/iter; left time: 143.7745s
	iters: 400, epoch: 5 | loss: 0.0696428
	speed: 0.0163s/iter; left time: 142.0851s
	iters: 500, epoch: 5 | loss: 0.0488501
	speed: 0.0163s/iter; left time: 140.4314s
Epoch: 5 cost time: 9.586678743362427
Epoch: 5, Steps: 570 | Train Loss: 0.0522892 Vali Loss: 0.0360802 Test Loss: 0.1406212
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0496656
	speed: 0.0506s/iter; left time: 427.6247s
	iters: 200, epoch: 6 | loss: 0.0355674
	speed: 0.0163s/iter; left time: 136.0740s
	iters: 300, epoch: 6 | loss: 0.0398934
	speed: 0.0163s/iter; left time: 134.4621s
	iters: 400, epoch: 6 | loss: 0.0465583
	speed: 0.0163s/iter; left time: 132.8229s
	iters: 500, epoch: 6 | loss: 0.0379409
	speed: 0.0163s/iter; left time: 131.1776s
Epoch: 6 cost time: 9.562894105911255
Epoch: 6, Steps: 570 | Train Loss: 0.0472073 Vali Loss: 0.0366653 Test Loss: 0.1417315
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1303025782108307, mae:0.22700773179531097
>>> MS_Pen LR=1e-4 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1372920
	speed: 0.0275s/iter; left time: 310.6249s
	iters: 200, epoch: 1 | loss: 0.0764539
	speed: 0.0157s/iter; left time: 176.3226s
	iters: 300, epoch: 1 | loss: 0.2052007
	speed: 0.0157s/iter; left time: 174.4824s
	iters: 400, epoch: 1 | loss: 0.1107718
	speed: 0.0157s/iter; left time: 173.2091s
	iters: 500, epoch: 1 | loss: 0.0841521
	speed: 0.0157s/iter; left time: 171.4922s
Epoch: 1 cost time: 10.197312355041504
Epoch: 1, Steps: 570 | Train Loss: 0.1469041 Vali Loss: 0.0363705 Test Loss: 0.1176619
Validation loss decreased (inf --> 0.036370).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1054447
	speed: 0.0498s/iter; left time: 534.8157s
	iters: 200, epoch: 2 | loss: 0.0855603
	speed: 0.0158s/iter; left time: 167.9648s
	iters: 300, epoch: 2 | loss: 0.1499444
	speed: 0.0158s/iter; left time: 166.2819s
	iters: 400, epoch: 2 | loss: 0.0843496
	speed: 0.0158s/iter; left time: 164.7417s
	iters: 500, epoch: 2 | loss: 0.0653909
	speed: 0.0158s/iter; left time: 163.1510s
Epoch: 2 cost time: 9.414154767990112
Epoch: 2, Steps: 570 | Train Loss: 0.1031220 Vali Loss: 0.0381091 Test Loss: 0.1257409
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0602717
	speed: 0.0486s/iter; left time: 493.4548s
	iters: 200, epoch: 3 | loss: 0.0818437
	speed: 0.0158s/iter; left time: 159.0099s
	iters: 300, epoch: 3 | loss: 0.0726178
	speed: 0.0158s/iter; left time: 157.0570s
	iters: 400, epoch: 3 | loss: 0.0742426
	speed: 0.0158s/iter; left time: 155.7207s
	iters: 500, epoch: 3 | loss: 0.0476536
	speed: 0.0158s/iter; left time: 154.2595s
Epoch: 3 cost time: 9.308857440948486
Epoch: 3, Steps: 570 | Train Loss: 0.0698747 Vali Loss: 0.0361446 Test Loss: 0.1297114
Validation loss decreased (0.036370 --> 0.036145).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0553419
	speed: 0.0492s/iter; left time: 471.8179s
	iters: 200, epoch: 4 | loss: 0.0749230
	speed: 0.0157s/iter; left time: 149.4189s
	iters: 300, epoch: 4 | loss: 0.0369944
	speed: 0.0157s/iter; left time: 147.6183s
	iters: 400, epoch: 4 | loss: 0.0409084
	speed: 0.0157s/iter; left time: 145.9900s
	iters: 500, epoch: 4 | loss: 0.0584396
	speed: 0.0157s/iter; left time: 144.4718s
Epoch: 4 cost time: 9.296712398529053
Epoch: 4, Steps: 570 | Train Loss: 0.0531146 Vali Loss: 0.0345984 Test Loss: 0.1293118
Validation loss decreased (0.036145 --> 0.034598).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0448099
	speed: 0.0484s/iter; left time: 436.6929s
	iters: 200, epoch: 5 | loss: 0.0505516
	speed: 0.0158s/iter; left time: 140.7506s
	iters: 300, epoch: 5 | loss: 0.0380318
	speed: 0.0157s/iter; left time: 138.8043s
	iters: 400, epoch: 5 | loss: 0.0321284
	speed: 0.0157s/iter; left time: 136.8821s
	iters: 500, epoch: 5 | loss: 0.0514369
	speed: 0.0157s/iter; left time: 135.4634s
Epoch: 5 cost time: 9.270320415496826
Epoch: 5, Steps: 570 | Train Loss: 0.0447660 Vali Loss: 0.0346596 Test Loss: 0.1285391
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0364413
	speed: 0.0508s/iter; left time: 429.5076s
	iters: 200, epoch: 6 | loss: 0.0408106
	speed: 0.0159s/iter; left time: 132.9841s
	iters: 300, epoch: 6 | loss: 0.0488230
	speed: 0.0157s/iter; left time: 129.5620s
	iters: 400, epoch: 6 | loss: 0.0457812
	speed: 0.0157s/iter; left time: 127.9812s
	iters: 500, epoch: 6 | loss: 0.0358858
	speed: 0.0164s/iter; left time: 132.2562s
Epoch: 6 cost time: 9.57003927230835
Epoch: 6, Steps: 570 | Train Loss: 0.0407481 Vali Loss: 0.0349526 Test Loss: 0.1301557
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0394036
	speed: 0.0499s/iter; left time: 393.0014s
	iters: 200, epoch: 7 | loss: 0.0321462
	speed: 0.0158s/iter; left time: 122.7123s
	iters: 300, epoch: 7 | loss: 0.0332454
	speed: 0.0158s/iter; left time: 121.1125s
	iters: 400, epoch: 7 | loss: 0.0505031
	speed: 0.0158s/iter; left time: 119.5879s
	iters: 500, epoch: 7 | loss: 0.0332473
	speed: 0.0158s/iter; left time: 118.0482s
Epoch: 7 cost time: 9.287243127822876
Epoch: 7, Steps: 570 | Train Loss: 0.0386668 Vali Loss: 0.0351835 Test Loss: 0.1309135
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12943239510059357, mae:0.22549115121364594
>>> MS_Pen LR=1e-4 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2118898
	speed: 0.0262s/iter; left time: 296.1988s
	iters: 200, epoch: 1 | loss: 0.1329838
	speed: 0.0146s/iter; left time: 163.3703s
	iters: 300, epoch: 1 | loss: 0.2071586
	speed: 0.0146s/iter; left time: 162.3517s
	iters: 400, epoch: 1 | loss: 0.1767960
	speed: 0.0146s/iter; left time: 160.8586s
	iters: 500, epoch: 1 | loss: 0.1940475
	speed: 0.0146s/iter; left time: 159.4903s
Epoch: 1 cost time: 9.54017949104309
Epoch: 1, Steps: 570 | Train Loss: 0.1817535 Vali Loss: 0.0421079 Test Loss: 0.1406657
Validation loss decreased (inf --> 0.042108).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1960487
	speed: 0.0468s/iter; left time: 502.0139s
	iters: 200, epoch: 2 | loss: 0.0783110
	speed: 0.0146s/iter; left time: 155.6467s
	iters: 300, epoch: 2 | loss: 0.1374647
	speed: 0.0147s/iter; left time: 154.6062s
	iters: 400, epoch: 2 | loss: 0.1197547
	speed: 0.0147s/iter; left time: 153.0538s
	iters: 500, epoch: 2 | loss: 0.1252432
	speed: 0.0147s/iter; left time: 151.4419s
Epoch: 2 cost time: 8.659833908081055
Epoch: 2, Steps: 570 | Train Loss: 0.1227230 Vali Loss: 0.0389388 Test Loss: 0.1455953
Validation loss decreased (0.042108 --> 0.038939).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0730550
	speed: 0.0474s/iter; left time: 481.8235s
	iters: 200, epoch: 3 | loss: 0.0530243
	speed: 0.0146s/iter; left time: 146.7906s
	iters: 300, epoch: 3 | loss: 0.1100160
	speed: 0.0146s/iter; left time: 145.7277s
	iters: 400, epoch: 3 | loss: 0.0614957
	speed: 0.0145s/iter; left time: 143.4606s
	iters: 500, epoch: 3 | loss: 0.0889617
	speed: 0.0146s/iter; left time: 142.4545s
Epoch: 3 cost time: 8.589923620223999
Epoch: 3, Steps: 570 | Train Loss: 0.0763999 Vali Loss: 0.0401208 Test Loss: 0.1402703
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0472067
	speed: 0.0449s/iter; left time: 430.8836s
	iters: 200, epoch: 4 | loss: 0.0886325
	speed: 0.0145s/iter; left time: 137.8614s
	iters: 300, epoch: 4 | loss: 0.0556165
	speed: 0.0146s/iter; left time: 136.6428s
	iters: 400, epoch: 4 | loss: 0.0450946
	speed: 0.0146s/iter; left time: 135.2498s
	iters: 500, epoch: 4 | loss: 0.0716911
	speed: 0.0145s/iter; left time: 133.6653s
Epoch: 4 cost time: 8.570652484893799
Epoch: 4, Steps: 570 | Train Loss: 0.0556290 Vali Loss: 0.0389033 Test Loss: 0.1440116
Validation loss decreased (0.038939 --> 0.038903).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0472080
	speed: 0.0488s/iter; left time: 439.9144s
	iters: 200, epoch: 5 | loss: 0.0378056
	speed: 0.0161s/iter; left time: 143.4727s
	iters: 300, epoch: 5 | loss: 0.0487541
	speed: 0.0161s/iter; left time: 141.6843s
	iters: 400, epoch: 5 | loss: 0.0425786
	speed: 0.0161s/iter; left time: 140.6852s
	iters: 500, epoch: 5 | loss: 0.0401822
	speed: 0.0160s/iter; left time: 138.3122s
Epoch: 5 cost time: 9.454423904418945
Epoch: 5, Steps: 570 | Train Loss: 0.0458867 Vali Loss: 0.0394540 Test Loss: 0.1467995
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0301743
	speed: 0.0482s/iter; left time: 406.9373s
	iters: 200, epoch: 6 | loss: 0.0315509
	speed: 0.0146s/iter; left time: 121.5677s
	iters: 300, epoch: 6 | loss: 0.0318910
	speed: 0.0145s/iter; left time: 119.7956s
	iters: 400, epoch: 6 | loss: 0.0378544
	speed: 0.0145s/iter; left time: 118.2190s
	iters: 500, epoch: 6 | loss: 0.0301925
	speed: 0.0145s/iter; left time: 116.7774s
Epoch: 6 cost time: 8.561216354370117
Epoch: 6, Steps: 570 | Train Loss: 0.0412993 Vali Loss: 0.0397541 Test Loss: 0.1474905
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0430175
	speed: 0.0457s/iter; left time: 360.2802s
	iters: 200, epoch: 7 | loss: 0.0369211
	speed: 0.0146s/iter; left time: 113.5208s
	iters: 300, epoch: 7 | loss: 0.0538213
	speed: 0.0146s/iter; left time: 111.7978s
	iters: 400, epoch: 7 | loss: 0.0359546
	speed: 0.0146s/iter; left time: 110.3587s
	iters: 500, epoch: 7 | loss: 0.0525962
	speed: 0.0146s/iter; left time: 108.9024s
Epoch: 7 cost time: 8.585585355758667
Epoch: 7, Steps: 570 | Train Loss: 0.0389983 Vali Loss: 0.0398096 Test Loss: 0.1475395
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14418524503707886, mae:0.24457624554634094
>>> MS_Pen LR=1e-4 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1150220
	speed: 0.0292s/iter; left time: 330.1743s
	iters: 200, epoch: 1 | loss: 0.1499247
	speed: 0.0176s/iter; left time: 196.7762s
	iters: 300, epoch: 1 | loss: 0.2345640
	speed: 0.0176s/iter; left time: 194.9010s
	iters: 400, epoch: 1 | loss: 0.1542042
	speed: 0.0176s/iter; left time: 193.3333s
	iters: 500, epoch: 1 | loss: 0.1328831
	speed: 0.0176s/iter; left time: 191.8406s
Epoch: 1 cost time: 11.226902961730957
Epoch: 1, Steps: 570 | Train Loss: 0.1820148 Vali Loss: 0.0426368 Test Loss: 0.1328681
Validation loss decreased (inf --> 0.042637).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1674118
	speed: 0.0551s/iter; left time: 590.7604s
	iters: 200, epoch: 2 | loss: 0.1582101
	speed: 0.0177s/iter; left time: 188.3881s
	iters: 300, epoch: 2 | loss: 0.1108278
	speed: 0.0177s/iter; left time: 186.3738s
	iters: 400, epoch: 2 | loss: 0.0937998
	speed: 0.0177s/iter; left time: 184.4670s
	iters: 500, epoch: 2 | loss: 0.0954217
	speed: 0.0177s/iter; left time: 182.7583s
Epoch: 2 cost time: 10.391124725341797
Epoch: 2, Steps: 570 | Train Loss: 0.1325407 Vali Loss: 0.0366802 Test Loss: 0.1290185
Validation loss decreased (0.042637 --> 0.036680).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1084721
	speed: 0.0546s/iter; left time: 554.5770s
	iters: 200, epoch: 3 | loss: 0.0780504
	speed: 0.0176s/iter; left time: 176.7190s
	iters: 300, epoch: 3 | loss: 0.0854312
	speed: 0.0175s/iter; left time: 174.6982s
	iters: 400, epoch: 3 | loss: 0.0658905
	speed: 0.0176s/iter; left time: 173.2418s
	iters: 500, epoch: 3 | loss: 0.0846867
	speed: 0.0176s/iter; left time: 171.3584s
Epoch: 3 cost time: 10.316999197006226
Epoch: 3, Steps: 570 | Train Loss: 0.1008092 Vali Loss: 0.0366486 Test Loss: 0.1305905
Validation loss decreased (0.036680 --> 0.036649).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0902637
	speed: 0.0575s/iter; left time: 551.4199s
	iters: 200, epoch: 4 | loss: 0.0887977
	speed: 0.0174s/iter; left time: 165.1188s
	iters: 300, epoch: 4 | loss: 0.0892234
	speed: 0.0174s/iter; left time: 163.6257s
	iters: 400, epoch: 4 | loss: 0.0712602
	speed: 0.0174s/iter; left time: 161.5925s
	iters: 500, epoch: 4 | loss: 0.0958948
	speed: 0.0174s/iter; left time: 159.5398s
Epoch: 4 cost time: 10.196507692337036
Epoch: 4, Steps: 570 | Train Loss: 0.0843208 Vali Loss: 0.0343327 Test Loss: 0.1350327
Validation loss decreased (0.036649 --> 0.034333).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0995667
	speed: 0.0540s/iter; left time: 487.5333s
	iters: 200, epoch: 5 | loss: 0.0649312
	speed: 0.0175s/iter; left time: 155.8025s
	iters: 300, epoch: 5 | loss: 0.0761006
	speed: 0.0175s/iter; left time: 154.0834s
	iters: 400, epoch: 5 | loss: 0.0720617
	speed: 0.0174s/iter; left time: 151.7491s
	iters: 500, epoch: 5 | loss: 0.0863629
	speed: 0.0174s/iter; left time: 149.7900s
Epoch: 5 cost time: 10.23042345046997
Epoch: 5, Steps: 570 | Train Loss: 0.0756158 Vali Loss: 0.0334083 Test Loss: 0.1333148
Validation loss decreased (0.034333 --> 0.033408).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0571307
	speed: 0.0533s/iter; left time: 450.6979s
	iters: 200, epoch: 6 | loss: 0.0839198
	speed: 0.0174s/iter; left time: 145.2779s
	iters: 300, epoch: 6 | loss: 0.0627774
	speed: 0.0174s/iter; left time: 143.5398s
	iters: 400, epoch: 6 | loss: 0.0913900
	speed: 0.0174s/iter; left time: 141.7403s
	iters: 500, epoch: 6 | loss: 0.0600672
	speed: 0.0174s/iter; left time: 139.8900s
Epoch: 6 cost time: 10.182050943374634
Epoch: 6, Steps: 570 | Train Loss: 0.0709026 Vali Loss: 0.0335746 Test Loss: 0.1316629
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0699431
	speed: 0.0529s/iter; left time: 417.2756s
	iters: 200, epoch: 7 | loss: 0.0701702
	speed: 0.0174s/iter; left time: 135.3603s
	iters: 300, epoch: 7 | loss: 0.0812387
	speed: 0.0174s/iter; left time: 133.7770s
	iters: 400, epoch: 7 | loss: 0.0777269
	speed: 0.0174s/iter; left time: 131.8998s
	iters: 500, epoch: 7 | loss: 0.0660269
	speed: 0.0174s/iter; left time: 130.3863s
Epoch: 7 cost time: 10.211160659790039
Epoch: 7, Steps: 570 | Train Loss: 0.0685533 Vali Loss: 0.0336141 Test Loss: 0.1315215
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0754361
	speed: 0.0549s/iter; left time: 401.3101s
	iters: 200, epoch: 8 | loss: 0.0532798
	speed: 0.0174s/iter; left time: 125.3602s
	iters: 300, epoch: 8 | loss: 0.0518592
	speed: 0.0174s/iter; left time: 123.8502s
	iters: 400, epoch: 8 | loss: 0.0716529
	speed: 0.0174s/iter; left time: 122.1168s
	iters: 500, epoch: 8 | loss: 0.0480053
	speed: 0.0174s/iter; left time: 120.3317s
Epoch: 8 cost time: 10.203526020050049
Epoch: 8, Steps: 570 | Train Loss: 0.0673530 Vali Loss: 0.0346647 Test Loss: 0.1320564
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13345970213413239, mae:0.22907643020153046
>>> MS_Pen LR=1e-4 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3338994
	speed: 0.0317s/iter; left time: 357.8609s
	iters: 200, epoch: 1 | loss: 0.1796010
	speed: 0.0176s/iter; left time: 197.0060s
	iters: 300, epoch: 1 | loss: 0.1619183
	speed: 0.0172s/iter; left time: 190.5806s
	iters: 400, epoch: 1 | loss: 0.1244985
	speed: 0.0183s/iter; left time: 201.2652s
	iters: 500, epoch: 1 | loss: 0.1856946
	speed: 0.0192s/iter; left time: 209.4429s
Epoch: 1 cost time: 11.793582201004028
Epoch: 1, Steps: 570 | Train Loss: 0.1515402 Vali Loss: 0.0368684 Test Loss: 0.1184645
Validation loss decreased (inf --> 0.036868).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0973058
	speed: 0.0563s/iter; left time: 603.8197s
	iters: 200, epoch: 2 | loss: 0.1524188
	speed: 0.0172s/iter; left time: 182.4391s
	iters: 300, epoch: 2 | loss: 0.1811625
	speed: 0.0172s/iter; left time: 180.7615s
	iters: 400, epoch: 2 | loss: 0.0977657
	speed: 0.0171s/iter; left time: 178.8042s
	iters: 500, epoch: 2 | loss: 0.1133257
	speed: 0.0172s/iter; left time: 177.2542s
Epoch: 2 cost time: 10.073980569839478
Epoch: 2, Steps: 570 | Train Loss: 0.1133098 Vali Loss: 0.0343605 Test Loss: 0.1207981
Validation loss decreased (0.036868 --> 0.034360).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0824440
	speed: 0.0569s/iter; left time: 578.2310s
	iters: 200, epoch: 3 | loss: 0.0843710
	speed: 0.0172s/iter; left time: 173.2916s
	iters: 300, epoch: 3 | loss: 0.0961003
	speed: 0.0172s/iter; left time: 171.1999s
	iters: 400, epoch: 3 | loss: 0.0574123
	speed: 0.0172s/iter; left time: 169.1801s
	iters: 500, epoch: 3 | loss: 0.0663986
	speed: 0.0171s/iter; left time: 167.1117s
Epoch: 3 cost time: 10.077546119689941
Epoch: 3, Steps: 570 | Train Loss: 0.0858438 Vali Loss: 0.0330864 Test Loss: 0.1207748
Validation loss decreased (0.034360 --> 0.033086).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0777388
	speed: 0.0538s/iter; left time: 515.7213s
	iters: 200, epoch: 4 | loss: 0.0478079
	speed: 0.0172s/iter; left time: 163.0224s
	iters: 300, epoch: 4 | loss: 0.0737433
	speed: 0.0172s/iter; left time: 161.3073s
	iters: 400, epoch: 4 | loss: 0.0757761
	speed: 0.0172s/iter; left time: 159.7601s
	iters: 500, epoch: 4 | loss: 0.0528056
	speed: 0.0172s/iter; left time: 157.9754s
Epoch: 4 cost time: 10.116510391235352
Epoch: 4, Steps: 570 | Train Loss: 0.0712228 Vali Loss: 0.0331717 Test Loss: 0.1261781
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0596757
	speed: 0.0552s/iter; left time: 498.1475s
	iters: 200, epoch: 5 | loss: 0.0799917
	speed: 0.0171s/iter; left time: 152.8734s
	iters: 300, epoch: 5 | loss: 0.0685445
	speed: 0.0171s/iter; left time: 150.9526s
	iters: 400, epoch: 5 | loss: 0.0539327
	speed: 0.0171s/iter; left time: 149.2503s
	iters: 500, epoch: 5 | loss: 0.0655414
	speed: 0.0171s/iter; left time: 147.5846s
Epoch: 5 cost time: 10.053533554077148
Epoch: 5, Steps: 570 | Train Loss: 0.0633549 Vali Loss: 0.0334839 Test Loss: 0.1278876
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0752158
	speed: 0.0528s/iter; left time: 445.8406s
	iters: 200, epoch: 6 | loss: 0.0415537
	speed: 0.0171s/iter; left time: 142.7260s
	iters: 300, epoch: 6 | loss: 0.0616028
	speed: 0.0171s/iter; left time: 141.0063s
	iters: 400, epoch: 6 | loss: 0.0496182
	speed: 0.0171s/iter; left time: 139.7642s
	iters: 500, epoch: 6 | loss: 0.0419711
	speed: 0.0171s/iter; left time: 138.0524s
Epoch: 6 cost time: 10.045027256011963
Epoch: 6, Steps: 570 | Train Loss: 0.0592993 Vali Loss: 0.0333615 Test Loss: 0.1278972
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12085288763046265, mae:0.21425960958003998
>>> MS_Pen LR=1e-4 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2322250
	speed: 0.0315s/iter; left time: 356.3334s
	iters: 200, epoch: 1 | loss: 0.1792148
	speed: 0.0194s/iter; left time: 217.2186s
	iters: 300, epoch: 1 | loss: 0.1772988
	speed: 0.0194s/iter; left time: 215.1414s
	iters: 400, epoch: 1 | loss: 0.1921186
	speed: 0.0195s/iter; left time: 214.1423s
	iters: 500, epoch: 1 | loss: 0.2325668
	speed: 0.0194s/iter; left time: 211.1174s
Epoch: 1 cost time: 12.327716588973999
Epoch: 1, Steps: 570 | Train Loss: 0.1862406 Vali Loss: 0.0425687 Test Loss: 0.1397256
Validation loss decreased (inf --> 0.042569).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2093691
	speed: 0.0560s/iter; left time: 600.8217s
	iters: 200, epoch: 2 | loss: 0.1544228
	speed: 0.0173s/iter; left time: 184.2927s
	iters: 300, epoch: 2 | loss: 0.2558299
	speed: 0.0173s/iter; left time: 182.6806s
	iters: 400, epoch: 2 | loss: 0.0934384
	speed: 0.0173s/iter; left time: 180.5931s
	iters: 500, epoch: 2 | loss: 0.0705453
	speed: 0.0173s/iter; left time: 179.0181s
Epoch: 2 cost time: 10.199413299560547
Epoch: 2, Steps: 570 | Train Loss: 0.1353796 Vali Loss: 0.0411786 Test Loss: 0.1397632
Validation loss decreased (0.042569 --> 0.041179).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0955621
	speed: 0.0591s/iter; left time: 600.5521s
	iters: 200, epoch: 3 | loss: 0.1130584
	speed: 0.0194s/iter; left time: 194.7660s
	iters: 300, epoch: 3 | loss: 0.1091566
	speed: 0.0193s/iter; left time: 192.3761s
	iters: 400, epoch: 3 | loss: 0.0789870
	speed: 0.0194s/iter; left time: 190.9571s
	iters: 500, epoch: 3 | loss: 0.0858129
	speed: 0.0178s/iter; left time: 174.1571s
Epoch: 3 cost time: 11.055097579956055
Epoch: 3, Steps: 570 | Train Loss: 0.0998665 Vali Loss: 0.0364324 Test Loss: 0.1385246
Validation loss decreased (0.041179 --> 0.036432).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0738433
	speed: 0.0542s/iter; left time: 520.1567s
	iters: 200, epoch: 4 | loss: 0.1064005
	speed: 0.0173s/iter; left time: 164.3447s
	iters: 300, epoch: 4 | loss: 0.0866908
	speed: 0.0173s/iter; left time: 162.1997s
	iters: 400, epoch: 4 | loss: 0.0750578
	speed: 0.0173s/iter; left time: 160.7989s
	iters: 500, epoch: 4 | loss: 0.0665464
	speed: 0.0173s/iter; left time: 158.6122s
Epoch: 4 cost time: 10.156375408172607
Epoch: 4, Steps: 570 | Train Loss: 0.0809814 Vali Loss: 0.0378689 Test Loss: 0.1461428
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0738422
	speed: 0.0563s/iter; left time: 507.6827s
	iters: 200, epoch: 5 | loss: 0.0636869
	speed: 0.0194s/iter; left time: 172.7747s
	iters: 300, epoch: 5 | loss: 0.0544584
	speed: 0.0174s/iter; left time: 153.1590s
	iters: 400, epoch: 5 | loss: 0.0652363
	speed: 0.0172s/iter; left time: 150.2202s
	iters: 500, epoch: 5 | loss: 0.0556768
	speed: 0.0172s/iter; left time: 148.4908s
Epoch: 5 cost time: 10.555840253829956
Epoch: 5, Steps: 570 | Train Loss: 0.0705972 Vali Loss: 0.0386983 Test Loss: 0.1493132
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0631399
	speed: 0.0540s/iter; left time: 456.5226s
	iters: 200, epoch: 6 | loss: 0.0655578
	speed: 0.0173s/iter; left time: 144.5911s
	iters: 300, epoch: 6 | loss: 0.0966267
	speed: 0.0173s/iter; left time: 142.5453s
	iters: 400, epoch: 6 | loss: 0.0603286
	speed: 0.0173s/iter; left time: 140.9011s
	iters: 500, epoch: 6 | loss: 0.0576640
	speed: 0.0173s/iter; left time: 139.1254s
Epoch: 6 cost time: 10.123034238815308
Epoch: 6, Steps: 570 | Train Loss: 0.0653248 Vali Loss: 0.0389955 Test Loss: 0.1501301
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13868404924869537, mae:0.23791635036468506
>>> MS_Pen LR=1e-4 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1724990
	speed: 0.0329s/iter; left time: 371.4496s
	iters: 200, epoch: 1 | loss: 0.1490969
	speed: 0.0219s/iter; left time: 245.2018s
	iters: 300, epoch: 1 | loss: 0.1121281
	speed: 0.0217s/iter; left time: 240.8990s
	iters: 400, epoch: 1 | loss: 0.2803105
	speed: 0.0213s/iter; left time: 234.4864s
	iters: 500, epoch: 1 | loss: 0.1569277
	speed: 0.0213s/iter; left time: 232.2173s
Epoch: 1 cost time: 13.443018674850464
Epoch: 1, Steps: 570 | Train Loss: 0.1785499 Vali Loss: 0.0416100 Test Loss: 0.1341973
Validation loss decreased (inf --> 0.041610).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1615717
	speed: 0.0637s/iter; left time: 683.4079s
	iters: 200, epoch: 2 | loss: 0.0988447
	speed: 0.0214s/iter; left time: 227.5511s
	iters: 300, epoch: 2 | loss: 0.1062519
	speed: 0.0214s/iter; left time: 225.2913s
	iters: 400, epoch: 2 | loss: 0.1081250
	speed: 0.0214s/iter; left time: 223.0961s
	iters: 500, epoch: 2 | loss: 0.0831929
	speed: 0.0214s/iter; left time: 221.1631s
Epoch: 2 cost time: 12.469734907150269
Epoch: 2, Steps: 570 | Train Loss: 0.1163672 Vali Loss: 0.0395175 Test Loss: 0.1476494
Validation loss decreased (0.041610 --> 0.039517).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0839601
	speed: 0.0615s/iter; left time: 624.6024s
	iters: 200, epoch: 3 | loss: 0.0640807
	speed: 0.0214s/iter; left time: 215.3422s
	iters: 300, epoch: 3 | loss: 0.1131912
	speed: 0.0213s/iter; left time: 212.5121s
	iters: 400, epoch: 3 | loss: 0.0561757
	speed: 0.0214s/iter; left time: 210.7141s
	iters: 500, epoch: 3 | loss: 0.0536878
	speed: 0.0214s/iter; left time: 208.6518s
Epoch: 3 cost time: 12.455020666122437
Epoch: 3, Steps: 570 | Train Loss: 0.0741622 Vali Loss: 0.0346118 Test Loss: 0.1433197
Validation loss decreased (0.039517 --> 0.034612).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0493033
	speed: 0.0636s/iter; left time: 609.9000s
	iters: 200, epoch: 4 | loss: 0.0433765
	speed: 0.0214s/iter; left time: 203.3341s
	iters: 300, epoch: 4 | loss: 0.0516626
	speed: 0.0214s/iter; left time: 200.6368s
	iters: 400, epoch: 4 | loss: 0.0380545
	speed: 0.0214s/iter; left time: 198.8861s
	iters: 500, epoch: 4 | loss: 0.0879772
	speed: 0.0214s/iter; left time: 196.8506s
Epoch: 4 cost time: 12.682671308517456
Epoch: 4, Steps: 570 | Train Loss: 0.0539053 Vali Loss: 0.0357035 Test Loss: 0.1498173
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0746685
	speed: 0.0605s/iter; left time: 545.7485s
	iters: 200, epoch: 5 | loss: 0.0459006
	speed: 0.0213s/iter; left time: 190.2472s
	iters: 300, epoch: 5 | loss: 0.0329338
	speed: 0.0213s/iter; left time: 188.1309s
	iters: 400, epoch: 5 | loss: 0.0386375
	speed: 0.0213s/iter; left time: 185.8037s
	iters: 500, epoch: 5 | loss: 0.0439508
	speed: 0.0213s/iter; left time: 183.6671s
Epoch: 5 cost time: 12.408432006835938
Epoch: 5, Steps: 570 | Train Loss: 0.0444193 Vali Loss: 0.0363598 Test Loss: 0.1457829
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0255591
	speed: 0.0604s/iter; left time: 510.1478s
	iters: 200, epoch: 6 | loss: 0.0367341
	speed: 0.0213s/iter; left time: 178.0509s
	iters: 300, epoch: 6 | loss: 0.0377284
	speed: 0.0213s/iter; left time: 175.9857s
	iters: 400, epoch: 6 | loss: 0.0335574
	speed: 0.0213s/iter; left time: 173.7258s
	iters: 500, epoch: 6 | loss: 0.0565157
	speed: 0.0213s/iter; left time: 171.6616s
Epoch: 6 cost time: 12.57713532447815
Epoch: 6, Steps: 570 | Train Loss: 0.0397274 Vali Loss: 0.0361826 Test Loss: 0.1498160
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1433425098657608, mae:0.24094156920909882
>>> MS_Pen LR=1e-4 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1338297
	speed: 0.0344s/iter; left time: 388.9999s
	iters: 200, epoch: 1 | loss: 0.0748999
	speed: 0.0224s/iter; left time: 250.8804s
	iters: 300, epoch: 1 | loss: 0.1465509
	speed: 0.0223s/iter; left time: 247.1072s
	iters: 400, epoch: 1 | loss: 0.1183560
	speed: 0.0221s/iter; left time: 243.0484s
	iters: 500, epoch: 1 | loss: 0.1747695
	speed: 0.0221s/iter; left time: 240.7788s
Epoch: 1 cost time: 13.929463386535645
Epoch: 1, Steps: 570 | Train Loss: 0.1487776 Vali Loss: 0.0357871 Test Loss: 0.1200856
Validation loss decreased (inf --> 0.035787).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0962278
	speed: 0.0648s/iter; left time: 695.2394s
	iters: 200, epoch: 2 | loss: 0.0906178
	speed: 0.0223s/iter; left time: 237.5928s
	iters: 300, epoch: 2 | loss: 0.1072246
	speed: 0.0224s/iter; left time: 235.3986s
	iters: 400, epoch: 2 | loss: 0.1104877
	speed: 0.0224s/iter; left time: 233.1697s
	iters: 500, epoch: 2 | loss: 0.0678410
	speed: 0.0223s/iter; left time: 230.6861s
Epoch: 2 cost time: 13.092710494995117
Epoch: 2, Steps: 570 | Train Loss: 0.1005945 Vali Loss: 0.0326990 Test Loss: 0.1233666
Validation loss decreased (0.035787 --> 0.032699).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0827167
	speed: 0.0644s/iter; left time: 654.2503s
	iters: 200, epoch: 3 | loss: 0.0513358
	speed: 0.0221s/iter; left time: 222.7572s
	iters: 300, epoch: 3 | loss: 0.0629084
	speed: 0.0222s/iter; left time: 220.7963s
	iters: 400, epoch: 3 | loss: 0.0656359
	speed: 0.0221s/iter; left time: 218.3210s
	iters: 500, epoch: 3 | loss: 0.0396604
	speed: 0.0221s/iter; left time: 215.4885s
Epoch: 3 cost time: 12.801794290542603
Epoch: 3, Steps: 570 | Train Loss: 0.0651249 Vali Loss: 0.0365390 Test Loss: 0.1359487
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0380869
	speed: 0.0615s/iter; left time: 589.9954s
	iters: 200, epoch: 4 | loss: 0.0497236
	speed: 0.0207s/iter; left time: 196.2336s
	iters: 300, epoch: 4 | loss: 0.0582301
	speed: 0.0207s/iter; left time: 194.3408s
	iters: 400, epoch: 4 | loss: 0.0424461
	speed: 0.0207s/iter; left time: 192.2789s
	iters: 500, epoch: 4 | loss: 0.0430932
	speed: 0.0207s/iter; left time: 189.9911s
Epoch: 4 cost time: 12.154500007629395
Epoch: 4, Steps: 570 | Train Loss: 0.0475166 Vali Loss: 0.0364800 Test Loss: 0.1343531
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0341395
	speed: 0.0625s/iter; left time: 563.6680s
	iters: 200, epoch: 5 | loss: 0.0443751
	speed: 0.0206s/iter; left time: 183.7971s
	iters: 300, epoch: 5 | loss: 0.0395366
	speed: 0.0206s/iter; left time: 181.7390s
	iters: 400, epoch: 5 | loss: 0.0457442
	speed: 0.0206s/iter; left time: 179.4603s
	iters: 500, epoch: 5 | loss: 0.0341508
	speed: 0.0206s/iter; left time: 177.2983s
Epoch: 5 cost time: 12.092476606369019
Epoch: 5, Steps: 570 | Train Loss: 0.0388498 Vali Loss: 0.0365649 Test Loss: 0.1343700
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1235012635588646, mae:0.2168276309967041
>>> MS_Pen LR=1e-4 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2044479
	speed: 0.0326s/iter; left time: 368.2579s
	iters: 200, epoch: 1 | loss: 0.1705818
	speed: 0.0189s/iter; left time: 211.9493s
	iters: 300, epoch: 1 | loss: 0.1807166
	speed: 0.0189s/iter; left time: 210.0387s
	iters: 400, epoch: 1 | loss: 0.1696811
	speed: 0.0189s/iter; left time: 208.2311s
	iters: 500, epoch: 1 | loss: 0.1473837
	speed: 0.0189s/iter; left time: 206.1791s
Epoch: 1 cost time: 12.19546914100647
Epoch: 1, Steps: 570 | Train Loss: 0.1757269 Vali Loss: 0.0422003 Test Loss: 0.1375703
Validation loss decreased (inf --> 0.042200).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0832674
	speed: 0.0600s/iter; left time: 643.4824s
	iters: 200, epoch: 2 | loss: 0.1712953
	speed: 0.0189s/iter; left time: 200.6489s
	iters: 300, epoch: 2 | loss: 0.0821829
	speed: 0.0189s/iter; left time: 198.7392s
	iters: 400, epoch: 2 | loss: 0.0883870
	speed: 0.0189s/iter; left time: 196.7658s
	iters: 500, epoch: 2 | loss: 0.0828551
	speed: 0.0189s/iter; left time: 194.8077s
Epoch: 2 cost time: 11.068297386169434
Epoch: 2, Steps: 570 | Train Loss: 0.1175341 Vali Loss: 0.0391748 Test Loss: 0.1369182
Validation loss decreased (0.042200 --> 0.039175).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0606994
	speed: 0.0578s/iter; left time: 587.8065s
	iters: 200, epoch: 3 | loss: 0.0656059
	speed: 0.0189s/iter; left time: 190.3674s
	iters: 300, epoch: 3 | loss: 0.0635678
	speed: 0.0189s/iter; left time: 188.1571s
	iters: 400, epoch: 3 | loss: 0.0609627
	speed: 0.0189s/iter; left time: 186.5175s
	iters: 500, epoch: 3 | loss: 0.0885378
	speed: 0.0189s/iter; left time: 184.4716s
Epoch: 3 cost time: 11.058223009109497
Epoch: 3, Steps: 570 | Train Loss: 0.0713710 Vali Loss: 0.0403507 Test Loss: 0.1427335
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0331867
	speed: 0.0556s/iter; left time: 532.9287s
	iters: 200, epoch: 4 | loss: 0.0441543
	speed: 0.0189s/iter; left time: 179.3357s
	iters: 300, epoch: 4 | loss: 0.0390166
	speed: 0.0189s/iter; left time: 177.5395s
	iters: 400, epoch: 4 | loss: 0.0542588
	speed: 0.0189s/iter; left time: 175.4254s
	iters: 500, epoch: 4 | loss: 0.0368244
	speed: 0.0189s/iter; left time: 173.3993s
Epoch: 4 cost time: 11.045076847076416
Epoch: 4, Steps: 570 | Train Loss: 0.0491385 Vali Loss: 0.0401085 Test Loss: 0.1422512
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0397544
	speed: 0.0566s/iter; left time: 510.7262s
	iters: 200, epoch: 5 | loss: 0.0302381
	speed: 0.0203s/iter; left time: 180.8231s
	iters: 300, epoch: 5 | loss: 0.0435129
	speed: 0.0218s/iter; left time: 192.6864s
	iters: 400, epoch: 5 | loss: 0.0310103
	speed: 0.0218s/iter; left time: 190.5274s
	iters: 500, epoch: 5 | loss: 0.0356764
	speed: 0.0219s/iter; left time: 188.3852s
Epoch: 5 cost time: 12.303919553756714
Epoch: 5, Steps: 570 | Train Loss: 0.0394837 Vali Loss: 0.0419534 Test Loss: 0.1433358
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1370842605829239, mae:0.24215324223041534
>>> MS_Pen LR=1e-4 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1719496
	speed: 0.0220s/iter; left time: 248.2468s
	iters: 200, epoch: 1 | loss: 0.1998513
	speed: 0.0105s/iter; left time: 118.0390s
	iters: 300, epoch: 1 | loss: 0.1910471
	speed: 0.0106s/iter; left time: 117.2456s
	iters: 400, epoch: 1 | loss: 0.2508040
	speed: 0.0105s/iter; left time: 115.8366s
	iters: 500, epoch: 1 | loss: 0.1891861
	speed: 0.0106s/iter; left time: 115.1850s
Epoch: 1 cost time: 7.20225191116333
Epoch: 1, Steps: 570 | Train Loss: 0.2154629 Vali Loss: 0.0460680 Test Loss: 0.1411133
Validation loss decreased (inf --> 0.046068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2864730
	speed: 0.0375s/iter; left time: 402.6941s
	iters: 200, epoch: 2 | loss: 0.2943122
	speed: 0.0105s/iter; left time: 111.5774s
	iters: 300, epoch: 2 | loss: 0.1785917
	speed: 0.0105s/iter; left time: 110.7764s
	iters: 400, epoch: 2 | loss: 0.1436113
	speed: 0.0105s/iter; left time: 109.2403s
	iters: 500, epoch: 2 | loss: 0.1380503
	speed: 0.0105s/iter; left time: 108.1912s
Epoch: 2 cost time: 6.414593458175659
Epoch: 2, Steps: 570 | Train Loss: 0.1755733 Vali Loss: 0.0398073 Test Loss: 0.1243516
Validation loss decreased (0.046068 --> 0.039807).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1297656
	speed: 0.0363s/iter; left time: 368.4697s
	iters: 200, epoch: 3 | loss: 0.1976234
	speed: 0.0105s/iter; left time: 105.9443s
	iters: 300, epoch: 3 | loss: 0.1438993
	speed: 0.0106s/iter; left time: 105.1511s
	iters: 400, epoch: 3 | loss: 0.1679950
	speed: 0.0105s/iter; left time: 103.6165s
	iters: 500, epoch: 3 | loss: 0.2090750
	speed: 0.0105s/iter; left time: 102.9522s
Epoch: 3 cost time: 6.271576642990112
Epoch: 3, Steps: 570 | Train Loss: 0.1563615 Vali Loss: 0.0362613 Test Loss: 0.1223396
Validation loss decreased (0.039807 --> 0.036261).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1658980
	speed: 0.0369s/iter; left time: 353.7669s
	iters: 200, epoch: 4 | loss: 0.0914163
	speed: 0.0105s/iter; left time: 99.9642s
	iters: 300, epoch: 4 | loss: 0.1506903
	speed: 0.0105s/iter; left time: 98.9822s
	iters: 400, epoch: 4 | loss: 0.1703089
	speed: 0.0105s/iter; left time: 97.3652s
	iters: 500, epoch: 4 | loss: 0.1503664
	speed: 0.0105s/iter; left time: 96.1693s
Epoch: 4 cost time: 6.305489540100098
Epoch: 4, Steps: 570 | Train Loss: 0.1471017 Vali Loss: 0.0352614 Test Loss: 0.1216662
Validation loss decreased (0.036261 --> 0.035261).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1560968
	speed: 0.0358s/iter; left time: 323.2715s
	iters: 200, epoch: 5 | loss: 0.1554629
	speed: 0.0105s/iter; left time: 93.5907s
	iters: 300, epoch: 5 | loss: 0.0898289
	speed: 0.0105s/iter; left time: 92.6103s
	iters: 400, epoch: 5 | loss: 0.1392360
	speed: 0.0105s/iter; left time: 91.5598s
	iters: 500, epoch: 5 | loss: 0.1343300
	speed: 0.0105s/iter; left time: 90.4002s
Epoch: 5 cost time: 6.273924827575684
Epoch: 5, Steps: 570 | Train Loss: 0.1431298 Vali Loss: 0.0350267 Test Loss: 0.1211847
Validation loss decreased (0.035261 --> 0.035027).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1182116
	speed: 0.0381s/iter; left time: 321.8533s
	iters: 200, epoch: 6 | loss: 0.0973888
	speed: 0.0105s/iter; left time: 87.7234s
	iters: 300, epoch: 6 | loss: 0.1424391
	speed: 0.0105s/iter; left time: 86.7350s
	iters: 400, epoch: 6 | loss: 0.1462137
	speed: 0.0105s/iter; left time: 85.5056s
	iters: 500, epoch: 6 | loss: 0.1562382
	speed: 0.0105s/iter; left time: 84.4644s
Epoch: 6 cost time: 6.290866374969482
Epoch: 6, Steps: 570 | Train Loss: 0.1394252 Vali Loss: 0.0346922 Test Loss: 0.1218110
Validation loss decreased (0.035027 --> 0.034692).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1530106
	speed: 0.0358s/iter; left time: 281.9167s
	iters: 200, epoch: 7 | loss: 0.1771487
	speed: 0.0104s/iter; left time: 81.1629s
	iters: 300, epoch: 7 | loss: 0.1187144
	speed: 0.0104s/iter; left time: 80.1177s
	iters: 400, epoch: 7 | loss: 0.1068207
	speed: 0.0105s/iter; left time: 79.2532s
	iters: 500, epoch: 7 | loss: 0.1153624
	speed: 0.0105s/iter; left time: 78.2822s
Epoch: 7 cost time: 6.258270978927612
Epoch: 7, Steps: 570 | Train Loss: 0.1399987 Vali Loss: 0.0343921 Test Loss: 0.1225120
Validation loss decreased (0.034692 --> 0.034392).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1506490
	speed: 0.0385s/iter; left time: 281.4219s
	iters: 200, epoch: 8 | loss: 0.1250787
	speed: 0.0106s/iter; left time: 76.3140s
	iters: 300, epoch: 8 | loss: 0.1598566
	speed: 0.0106s/iter; left time: 75.1670s
	iters: 400, epoch: 8 | loss: 0.2173422
	speed: 0.0106s/iter; left time: 74.1377s
	iters: 500, epoch: 8 | loss: 0.1342677
	speed: 0.0106s/iter; left time: 73.0975s
Epoch: 8 cost time: 6.4188549518585205
Epoch: 8, Steps: 570 | Train Loss: 0.1383135 Vali Loss: 0.0343108 Test Loss: 0.1217182
Validation loss decreased (0.034392 --> 0.034311).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1871781
	speed: 0.0368s/iter; left time: 247.7689s
	iters: 200, epoch: 9 | loss: 0.1477104
	speed: 0.0106s/iter; left time: 70.1764s
	iters: 300, epoch: 9 | loss: 0.0610481
	speed: 0.0106s/iter; left time: 69.2957s
	iters: 400, epoch: 9 | loss: 0.1038176
	speed: 0.0106s/iter; left time: 68.2301s
	iters: 500, epoch: 9 | loss: 0.1236005
	speed: 0.0106s/iter; left time: 67.2195s
Epoch: 9 cost time: 6.2855165004730225
Epoch: 9, Steps: 570 | Train Loss: 0.1378241 Vali Loss: 0.0345833 Test Loss: 0.1220419
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1445298
	speed: 0.0357s/iter; left time: 220.5933s
	iters: 200, epoch: 10 | loss: 0.1517658
	speed: 0.0105s/iter; left time: 63.9684s
	iters: 300, epoch: 10 | loss: 0.1109438
	speed: 0.0105s/iter; left time: 62.9531s
	iters: 400, epoch: 10 | loss: 0.1353671
	speed: 0.0105s/iter; left time: 61.9133s
	iters: 500, epoch: 10 | loss: 0.1813613
	speed: 0.0106s/iter; left time: 60.8899s
Epoch: 10 cost time: 6.2470808029174805
Epoch: 10, Steps: 570 | Train Loss: 0.1374829 Vali Loss: 0.0345252 Test Loss: 0.1219270
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1564663
	speed: 0.0375s/iter; left time: 209.8685s
	iters: 200, epoch: 11 | loss: 0.1197651
	speed: 0.0106s/iter; left time: 58.5306s
	iters: 300, epoch: 11 | loss: 0.1068604
	speed: 0.0106s/iter; left time: 57.2406s
	iters: 400, epoch: 11 | loss: 0.1550909
	speed: 0.0107s/iter; left time: 56.4926s
	iters: 500, epoch: 11 | loss: 0.1244071
	speed: 0.0106s/iter; left time: 55.2909s
Epoch: 11 cost time: 6.359173774719238
Epoch: 11, Steps: 570 | Train Loss: 0.1388985 Vali Loss: 0.0344027 Test Loss: 0.1220020
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12185133993625641, mae:0.21599167585372925
>>> MS_Pen LR=1e-4 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1664696
	speed: 0.0219s/iter; left time: 247.9843s
	iters: 200, epoch: 1 | loss: 0.1985346
	speed: 0.0103s/iter; left time: 115.4055s
	iters: 300, epoch: 1 | loss: 0.2624118
	speed: 0.0103s/iter; left time: 114.5279s
	iters: 400, epoch: 1 | loss: 0.1821701
	speed: 0.0103s/iter; left time: 113.4039s
	iters: 500, epoch: 1 | loss: 0.1771367
	speed: 0.0103s/iter; left time: 112.4079s
Epoch: 1 cost time: 7.090036869049072
Epoch: 1, Steps: 570 | Train Loss: 0.1890120 Vali Loss: 0.0369552 Test Loss: 0.1149543
Validation loss decreased (inf --> 0.036955).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1269257
	speed: 0.0369s/iter; left time: 396.4345s
	iters: 200, epoch: 2 | loss: 0.1685471
	speed: 0.0103s/iter; left time: 109.3897s
	iters: 300, epoch: 2 | loss: 0.1197941
	speed: 0.0102s/iter; left time: 107.7422s
	iters: 400, epoch: 2 | loss: 0.1366245
	speed: 0.0103s/iter; left time: 107.1358s
	iters: 500, epoch: 2 | loss: 0.1476818
	speed: 0.0103s/iter; left time: 106.1110s
Epoch: 2 cost time: 6.14545750617981
Epoch: 2, Steps: 570 | Train Loss: 0.1604120 Vali Loss: 0.0352358 Test Loss: 0.1166142
Validation loss decreased (0.036955 --> 0.035236).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0777712
	speed: 0.0351s/iter; left time: 356.6999s
	iters: 200, epoch: 3 | loss: 0.1222167
	speed: 0.0102s/iter; left time: 102.8570s
	iters: 300, epoch: 3 | loss: 0.2759154
	speed: 0.0102s/iter; left time: 101.4067s
	iters: 400, epoch: 3 | loss: 0.1336717
	speed: 0.0102s/iter; left time: 100.3872s
	iters: 500, epoch: 3 | loss: 0.1119854
	speed: 0.0102s/iter; left time: 99.4937s
Epoch: 3 cost time: 6.106584310531616
Epoch: 3, Steps: 570 | Train Loss: 0.1437085 Vali Loss: 0.0329936 Test Loss: 0.1143397
Validation loss decreased (0.035236 --> 0.032994).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1166658
	speed: 0.0361s/iter; left time: 346.4576s
	iters: 200, epoch: 4 | loss: 0.0957391
	speed: 0.0102s/iter; left time: 96.7761s
	iters: 300, epoch: 4 | loss: 0.0862395
	speed: 0.0103s/iter; left time: 96.3313s
	iters: 400, epoch: 4 | loss: 0.1053890
	speed: 0.0102s/iter; left time: 95.1743s
	iters: 500, epoch: 4 | loss: 0.1601852
	speed: 0.0102s/iter; left time: 94.0617s
Epoch: 4 cost time: 6.117916584014893
Epoch: 4, Steps: 570 | Train Loss: 0.1357489 Vali Loss: 0.0329021 Test Loss: 0.1141810
Validation loss decreased (0.032994 --> 0.032902).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1008916
	speed: 0.0351s/iter; left time: 316.4221s
	iters: 200, epoch: 5 | loss: 0.1660978
	speed: 0.0102s/iter; left time: 91.0718s
	iters: 300, epoch: 5 | loss: 0.1134203
	speed: 0.0102s/iter; left time: 90.2977s
	iters: 400, epoch: 5 | loss: 0.1081730
	speed: 0.0102s/iter; left time: 89.0312s
	iters: 500, epoch: 5 | loss: 0.1320813
	speed: 0.0102s/iter; left time: 87.9997s
Epoch: 5 cost time: 6.1140968799591064
Epoch: 5, Steps: 570 | Train Loss: 0.1322586 Vali Loss: 0.0326291 Test Loss: 0.1148021
Validation loss decreased (0.032902 --> 0.032629).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1016830
	speed: 0.0357s/iter; left time: 301.2981s
	iters: 200, epoch: 6 | loss: 0.1931327
	speed: 0.0102s/iter; left time: 85.3631s
	iters: 300, epoch: 6 | loss: 0.1399764
	speed: 0.0102s/iter; left time: 84.3561s
	iters: 400, epoch: 6 | loss: 0.0997623
	speed: 0.0102s/iter; left time: 83.3513s
	iters: 500, epoch: 6 | loss: 0.0877725
	speed: 0.0102s/iter; left time: 82.4164s
Epoch: 6 cost time: 6.153048753738403
Epoch: 6, Steps: 570 | Train Loss: 0.1308363 Vali Loss: 0.0323013 Test Loss: 0.1145498
Validation loss decreased (0.032629 --> 0.032301).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1175093
	speed: 0.0366s/iter; left time: 288.1794s
	iters: 200, epoch: 7 | loss: 0.1357233
	speed: 0.0103s/iter; left time: 79.8629s
	iters: 300, epoch: 7 | loss: 0.2149235
	speed: 0.0102s/iter; left time: 78.4572s
	iters: 400, epoch: 7 | loss: 0.1809878
	speed: 0.0102s/iter; left time: 77.3546s
	iters: 500, epoch: 7 | loss: 0.1368710
	speed: 0.0102s/iter; left time: 76.4918s
Epoch: 7 cost time: 6.132075071334839
Epoch: 7, Steps: 570 | Train Loss: 0.1300451 Vali Loss: 0.0320962 Test Loss: 0.1144520
Validation loss decreased (0.032301 --> 0.032096).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1076242
	speed: 0.0369s/iter; left time: 269.4635s
	iters: 200, epoch: 8 | loss: 0.1101534
	speed: 0.0102s/iter; left time: 73.5652s
	iters: 300, epoch: 8 | loss: 0.1054400
	speed: 0.0102s/iter; left time: 72.6972s
	iters: 400, epoch: 8 | loss: 0.1258056
	speed: 0.0102s/iter; left time: 71.6339s
	iters: 500, epoch: 8 | loss: 0.0783825
	speed: 0.0102s/iter; left time: 70.6020s
Epoch: 8 cost time: 6.144455432891846
Epoch: 8, Steps: 570 | Train Loss: 0.1301483 Vali Loss: 0.0321117 Test Loss: 0.1146296
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0988859
	speed: 0.0362s/iter; left time: 243.8659s
	iters: 200, epoch: 9 | loss: 0.1304029
	speed: 0.0103s/iter; left time: 68.0886s
	iters: 300, epoch: 9 | loss: 0.1231384
	speed: 0.0103s/iter; left time: 67.0687s
	iters: 400, epoch: 9 | loss: 0.1491782
	speed: 0.0103s/iter; left time: 66.0447s
	iters: 500, epoch: 9 | loss: 0.1236292
	speed: 0.0103s/iter; left time: 65.0142s
Epoch: 9 cost time: 6.1184844970703125
Epoch: 9, Steps: 570 | Train Loss: 0.1290369 Vali Loss: 0.0322127 Test Loss: 0.1147443
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1375514
	speed: 0.0359s/iter; left time: 221.2675s
	iters: 200, epoch: 10 | loss: 0.1109834
	speed: 0.0102s/iter; left time: 62.1486s
	iters: 300, epoch: 10 | loss: 0.1135557
	speed: 0.0103s/iter; left time: 61.2321s
	iters: 400, epoch: 10 | loss: 0.0957920
	speed: 0.0103s/iter; left time: 60.2145s
	iters: 500, epoch: 10 | loss: 0.0844192
	speed: 0.0103s/iter; left time: 59.1954s
Epoch: 10 cost time: 6.082311391830444
Epoch: 10, Steps: 570 | Train Loss: 0.1297181 Vali Loss: 0.0322172 Test Loss: 0.1147819
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11457034945487976, mae:0.20520535111427307
>>> MS_Pen LR=1e-4 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2161693
	speed: 0.0236s/iter; left time: 266.4219s
	iters: 200, epoch: 1 | loss: 0.1624372
	speed: 0.0117s/iter; left time: 130.5257s
	iters: 300, epoch: 1 | loss: 0.1522583
	speed: 0.0116s/iter; left time: 129.0613s
	iters: 400, epoch: 1 | loss: 0.1370400
	speed: 0.0116s/iter; left time: 128.0200s
	iters: 500, epoch: 1 | loss: 0.2049144
	speed: 0.0116s/iter; left time: 126.9575s
Epoch: 1 cost time: 7.882262229919434
Epoch: 1, Steps: 570 | Train Loss: 0.2218466 Vali Loss: 0.0439170 Test Loss: 0.1358997
Validation loss decreased (inf --> 0.043917).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1796466
	speed: 0.0395s/iter; left time: 424.2046s
	iters: 200, epoch: 2 | loss: 0.2470513
	speed: 0.0103s/iter; left time: 109.4569s
	iters: 300, epoch: 2 | loss: 0.1799447
	speed: 0.0103s/iter; left time: 108.5080s
	iters: 400, epoch: 2 | loss: 0.2619389
	speed: 0.0103s/iter; left time: 107.3085s
	iters: 500, epoch: 2 | loss: 0.1909956
	speed: 0.0103s/iter; left time: 106.4036s
Epoch: 2 cost time: 6.191450119018555
Epoch: 2, Steps: 570 | Train Loss: 0.1822203 Vali Loss: 0.0384171 Test Loss: 0.1269236
Validation loss decreased (0.043917 --> 0.038417).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1161676
	speed: 0.0374s/iter; left time: 380.4925s
	iters: 200, epoch: 3 | loss: 0.1557466
	speed: 0.0103s/iter; left time: 103.8731s
	iters: 300, epoch: 3 | loss: 0.2130777
	speed: 0.0103s/iter; left time: 103.0216s
	iters: 400, epoch: 3 | loss: 0.1588028
	speed: 0.0104s/iter; left time: 102.1088s
	iters: 500, epoch: 3 | loss: 0.1016678
	speed: 0.0103s/iter; left time: 100.8487s
Epoch: 3 cost time: 6.197790145874023
Epoch: 3, Steps: 570 | Train Loss: 0.1650953 Vali Loss: 0.0382906 Test Loss: 0.1285249
Validation loss decreased (0.038417 --> 0.038291).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0931064
	speed: 0.0365s/iter; left time: 349.6075s
	iters: 200, epoch: 4 | loss: 0.1271005
	speed: 0.0103s/iter; left time: 98.0150s
	iters: 300, epoch: 4 | loss: 0.1231851
	speed: 0.0103s/iter; left time: 96.9500s
	iters: 400, epoch: 4 | loss: 0.1933626
	speed: 0.0103s/iter; left time: 96.0777s
	iters: 500, epoch: 4 | loss: 0.1407183
	speed: 0.0103s/iter; left time: 94.8955s
Epoch: 4 cost time: 6.160608768463135
Epoch: 4, Steps: 570 | Train Loss: 0.1556740 Vali Loss: 0.0376937 Test Loss: 0.1317336
Validation loss decreased (0.038291 --> 0.037694).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1408135
	speed: 0.0364s/iter; left time: 327.9857s
	iters: 200, epoch: 5 | loss: 0.0844524
	speed: 0.0103s/iter; left time: 91.6352s
	iters: 300, epoch: 5 | loss: 0.1671930
	speed: 0.0103s/iter; left time: 90.6757s
	iters: 400, epoch: 5 | loss: 0.1323951
	speed: 0.0103s/iter; left time: 89.9915s
	iters: 500, epoch: 5 | loss: 0.1845860
	speed: 0.0103s/iter; left time: 88.8109s
Epoch: 5 cost time: 6.164100170135498
Epoch: 5, Steps: 570 | Train Loss: 0.1517510 Vali Loss: 0.0372107 Test Loss: 0.1311631
Validation loss decreased (0.037694 --> 0.037211).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1114717
	speed: 0.0363s/iter; left time: 307.0621s
	iters: 200, epoch: 6 | loss: 0.1427838
	speed: 0.0111s/iter; left time: 92.2822s
	iters: 300, epoch: 6 | loss: 0.1481942
	speed: 0.0103s/iter; left time: 85.2397s
	iters: 400, epoch: 6 | loss: 0.1095712
	speed: 0.0103s/iter; left time: 84.0959s
	iters: 500, epoch: 6 | loss: 0.1491655
	speed: 0.0103s/iter; left time: 82.9916s
Epoch: 6 cost time: 6.306909084320068
Epoch: 6, Steps: 570 | Train Loss: 0.1483894 Vali Loss: 0.0370420 Test Loss: 0.1309457
Validation loss decreased (0.037211 --> 0.037042).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1265273
	speed: 0.0386s/iter; left time: 304.1573s
	iters: 200, epoch: 7 | loss: 0.1255224
	speed: 0.0104s/iter; left time: 80.9043s
	iters: 300, epoch: 7 | loss: 0.1256126
	speed: 0.0103s/iter; left time: 79.4797s
	iters: 400, epoch: 7 | loss: 0.1032805
	speed: 0.0104s/iter; left time: 78.5028s
	iters: 500, epoch: 7 | loss: 0.1684769
	speed: 0.0104s/iter; left time: 77.5239s
Epoch: 7 cost time: 6.220390796661377
Epoch: 7, Steps: 570 | Train Loss: 0.1471085 Vali Loss: 0.0369721 Test Loss: 0.1309094
Validation loss decreased (0.037042 --> 0.036972).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1160325
	speed: 0.0363s/iter; left time: 265.6433s
	iters: 200, epoch: 8 | loss: 0.1323023
	speed: 0.0106s/iter; left time: 76.7399s
	iters: 300, epoch: 8 | loss: 0.1261945
	speed: 0.0116s/iter; left time: 82.2995s
	iters: 400, epoch: 8 | loss: 0.1962274
	speed: 0.0116s/iter; left time: 81.0189s
	iters: 500, epoch: 8 | loss: 0.1253583
	speed: 0.0116s/iter; left time: 79.8828s
Epoch: 8 cost time: 6.646573305130005
Epoch: 8, Steps: 570 | Train Loss: 0.1461507 Vali Loss: 0.0369297 Test Loss: 0.1312595
Validation loss decreased (0.036972 --> 0.036930).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1370313
	speed: 0.0368s/iter; left time: 247.7784s
	iters: 200, epoch: 9 | loss: 0.1667609
	speed: 0.0104s/iter; left time: 68.7529s
	iters: 300, epoch: 9 | loss: 0.1363150
	speed: 0.0103s/iter; left time: 67.5793s
	iters: 400, epoch: 9 | loss: 0.1091185
	speed: 0.0103s/iter; left time: 66.5703s
	iters: 500, epoch: 9 | loss: 0.1466749
	speed: 0.0104s/iter; left time: 65.7484s
Epoch: 9 cost time: 6.192858457565308
Epoch: 9, Steps: 570 | Train Loss: 0.1454543 Vali Loss: 0.0370217 Test Loss: 0.1314898
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1191931
	speed: 0.0360s/iter; left time: 222.2226s
	iters: 200, epoch: 10 | loss: 0.2026815
	speed: 0.0104s/iter; left time: 62.8959s
	iters: 300, epoch: 10 | loss: 0.1949939
	speed: 0.0103s/iter; left time: 61.7113s
	iters: 400, epoch: 10 | loss: 0.1660717
	speed: 0.0104s/iter; left time: 60.8029s
	iters: 500, epoch: 10 | loss: 0.1577466
	speed: 0.0104s/iter; left time: 59.7389s
Epoch: 10 cost time: 6.177738904953003
Epoch: 10, Steps: 570 | Train Loss: 0.1475808 Vali Loss: 0.0370427 Test Loss: 0.1313664
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1577452
	speed: 0.0354s/iter; left time: 198.2145s
	iters: 200, epoch: 11 | loss: 0.1517709
	speed: 0.0103s/iter; left time: 56.7476s
	iters: 300, epoch: 11 | loss: 0.1623220
	speed: 0.0103s/iter; left time: 55.6822s
	iters: 400, epoch: 11 | loss: 0.1601287
	speed: 0.0103s/iter; left time: 54.6394s
	iters: 500, epoch: 11 | loss: 0.1494824
	speed: 0.0103s/iter; left time: 53.6143s
Epoch: 11 cost time: 6.195049524307251
Epoch: 11, Steps: 570 | Train Loss: 0.1465541 Vali Loss: 0.0368445 Test Loss: 0.1313881
Validation loss decreased (0.036930 --> 0.036845).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1476484
	speed: 0.0373s/iter; left time: 187.8604s
	iters: 200, epoch: 12 | loss: 0.1483824
	speed: 0.0109s/iter; left time: 53.7969s
	iters: 300, epoch: 12 | loss: 0.0863185
	speed: 0.0102s/iter; left time: 49.4904s
	iters: 400, epoch: 12 | loss: 0.1431686
	speed: 0.0102s/iter; left time: 48.4470s
	iters: 500, epoch: 12 | loss: 0.0904431
	speed: 0.0102s/iter; left time: 47.4355s
Epoch: 12 cost time: 6.33977746963501
Epoch: 12, Steps: 570 | Train Loss: 0.1454609 Vali Loss: 0.0367776 Test Loss: 0.1313834
Validation loss decreased (0.036845 --> 0.036778).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1360907
	speed: 0.0375s/iter; left time: 167.1431s
	iters: 200, epoch: 13 | loss: 0.1406147
	speed: 0.0104s/iter; left time: 45.2043s
	iters: 300, epoch: 13 | loss: 0.1469557
	speed: 0.0104s/iter; left time: 44.1910s
	iters: 400, epoch: 13 | loss: 0.1944424
	speed: 0.0104s/iter; left time: 43.0899s
	iters: 500, epoch: 13 | loss: 0.1286121
	speed: 0.0104s/iter; left time: 42.1008s
Epoch: 13 cost time: 6.22031044960022
Epoch: 13, Steps: 570 | Train Loss: 0.1470803 Vali Loss: 0.0369403 Test Loss: 0.1313862
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1211892
	speed: 0.0369s/iter; left time: 143.7359s
	iters: 200, epoch: 14 | loss: 0.1702662
	speed: 0.0104s/iter; left time: 39.3999s
	iters: 300, epoch: 14 | loss: 0.1183395
	speed: 0.0104s/iter; left time: 38.3374s
	iters: 400, epoch: 14 | loss: 0.0970065
	speed: 0.0104s/iter; left time: 37.3277s
	iters: 500, epoch: 14 | loss: 0.2290456
	speed: 0.0103s/iter; left time: 36.0891s
Epoch: 14 cost time: 6.226337432861328
Epoch: 14, Steps: 570 | Train Loss: 0.1452662 Vali Loss: 0.0367957 Test Loss: 0.1313983
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1017067
	speed: 0.0385s/iter; left time: 127.7254s
	iters: 200, epoch: 15 | loss: 0.1912706
	speed: 0.0116s/iter; left time: 37.5009s
	iters: 300, epoch: 15 | loss: 0.0895187
	speed: 0.0116s/iter; left time: 36.2651s
	iters: 400, epoch: 15 | loss: 0.0677300
	speed: 0.0117s/iter; left time: 35.2084s
	iters: 500, epoch: 15 | loss: 0.2048759
	speed: 0.0117s/iter; left time: 34.0599s
Epoch: 15 cost time: 6.93754506111145
Epoch: 15, Steps: 570 | Train Loss: 0.1463176 Vali Loss: 0.0368768 Test Loss: 0.1313946
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13152168691158295, mae:0.22729942202568054
>>> MS_Pen LR=1e-4 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2682925
	speed: 0.0248s/iter; left time: 280.3415s
	iters: 200, epoch: 1 | loss: 0.2245203
	speed: 0.0129s/iter; left time: 144.1853s
	iters: 300, epoch: 1 | loss: 0.1765386
	speed: 0.0128s/iter; left time: 142.4684s
	iters: 400, epoch: 1 | loss: 0.1149841
	speed: 0.0118s/iter; left time: 129.9442s
	iters: 500, epoch: 1 | loss: 0.2084410
	speed: 0.0118s/iter; left time: 128.6733s
Epoch: 1 cost time: 8.290530681610107
Epoch: 1, Steps: 570 | Train Loss: 0.2120223 Vali Loss: 0.0404321 Test Loss: 0.1253239
Validation loss decreased (inf --> 0.040432).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1558243
	speed: 0.0402s/iter; left time: 431.2350s
	iters: 200, epoch: 2 | loss: 0.1402760
	speed: 0.0118s/iter; left time: 125.9084s
	iters: 300, epoch: 2 | loss: 0.1251508
	speed: 0.0118s/iter; left time: 124.1740s
	iters: 400, epoch: 2 | loss: 0.0979951
	speed: 0.0118s/iter; left time: 122.6252s
	iters: 500, epoch: 2 | loss: 0.1764570
	speed: 0.0117s/iter; left time: 121.3637s
Epoch: 2 cost time: 7.0520970821380615
Epoch: 2, Steps: 570 | Train Loss: 0.1683234 Vali Loss: 0.0384451 Test Loss: 0.1233765
Validation loss decreased (0.040432 --> 0.038445).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1760215
	speed: 0.0408s/iter; left time: 414.8506s
	iters: 200, epoch: 3 | loss: 0.1767360
	speed: 0.0118s/iter; left time: 118.4527s
	iters: 300, epoch: 3 | loss: 0.0917213
	speed: 0.0118s/iter; left time: 117.1418s
	iters: 400, epoch: 3 | loss: 0.1161622
	speed: 0.0118s/iter; left time: 116.2964s
	iters: 500, epoch: 3 | loss: 0.1029743
	speed: 0.0118s/iter; left time: 114.7470s
Epoch: 3 cost time: 7.033678770065308
Epoch: 3, Steps: 570 | Train Loss: 0.1417551 Vali Loss: 0.0366158 Test Loss: 0.1219738
Validation loss decreased (0.038445 --> 0.036616).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1111840
	speed: 0.0392s/iter; left time: 376.1276s
	iters: 200, epoch: 4 | loss: 0.1700194
	speed: 0.0118s/iter; left time: 112.2997s
	iters: 300, epoch: 4 | loss: 0.0893771
	speed: 0.0118s/iter; left time: 111.2277s
	iters: 400, epoch: 4 | loss: 0.0994950
	speed: 0.0118s/iter; left time: 110.0840s
	iters: 500, epoch: 4 | loss: 0.1100393
	speed: 0.0118s/iter; left time: 108.8396s
Epoch: 4 cost time: 7.044426679611206
Epoch: 4, Steps: 570 | Train Loss: 0.1284504 Vali Loss: 0.0352721 Test Loss: 0.1207113
Validation loss decreased (0.036616 --> 0.035272).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1129944
	speed: 0.0397s/iter; left time: 358.2574s
	iters: 200, epoch: 5 | loss: 0.0975735
	speed: 0.0118s/iter; left time: 105.5887s
	iters: 300, epoch: 5 | loss: 0.1626967
	speed: 0.0128s/iter; left time: 112.8927s
	iters: 400, epoch: 5 | loss: 0.1148136
	speed: 0.0129s/iter; left time: 112.1317s
	iters: 500, epoch: 5 | loss: 0.1112475
	speed: 0.0129s/iter; left time: 111.0394s
Epoch: 5 cost time: 7.44162654876709
Epoch: 5, Steps: 570 | Train Loss: 0.1231461 Vali Loss: 0.0351475 Test Loss: 0.1212924
Validation loss decreased (0.035272 --> 0.035147).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1079658
	speed: 0.0399s/iter; left time: 336.9692s
	iters: 200, epoch: 6 | loss: 0.0943322
	speed: 0.0118s/iter; left time: 98.5974s
	iters: 300, epoch: 6 | loss: 0.1207696
	speed: 0.0118s/iter; left time: 97.4239s
	iters: 400, epoch: 6 | loss: 0.1326253
	speed: 0.0118s/iter; left time: 96.2292s
	iters: 500, epoch: 6 | loss: 0.0846662
	speed: 0.0118s/iter; left time: 95.0688s
Epoch: 6 cost time: 7.049501657485962
Epoch: 6, Steps: 570 | Train Loss: 0.1198779 Vali Loss: 0.0339950 Test Loss: 0.1214262
Validation loss decreased (0.035147 --> 0.033995).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1110067
	speed: 0.0410s/iter; left time: 323.3126s
	iters: 200, epoch: 7 | loss: 0.1044225
	speed: 0.0129s/iter; left time: 100.7419s
	iters: 300, epoch: 7 | loss: 0.1254848
	speed: 0.0129s/iter; left time: 99.3368s
	iters: 400, epoch: 7 | loss: 0.0831704
	speed: 0.0129s/iter; left time: 97.8186s
	iters: 500, epoch: 7 | loss: 0.1177112
	speed: 0.0129s/iter; left time: 96.4914s
Epoch: 7 cost time: 7.701064586639404
Epoch: 7, Steps: 570 | Train Loss: 0.1176630 Vali Loss: 0.0338189 Test Loss: 0.1223816
Validation loss decreased (0.033995 --> 0.033819).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0996518
	speed: 0.0404s/iter; left time: 295.0032s
	iters: 200, epoch: 8 | loss: 0.1162304
	speed: 0.0118s/iter; left time: 84.7893s
	iters: 300, epoch: 8 | loss: 0.1040791
	speed: 0.0117s/iter; left time: 83.4431s
	iters: 400, epoch: 8 | loss: 0.0928998
	speed: 0.0117s/iter; left time: 82.2969s
	iters: 500, epoch: 8 | loss: 0.0964180
	speed: 0.0117s/iter; left time: 81.1113s
Epoch: 8 cost time: 7.029438734054565
Epoch: 8, Steps: 570 | Train Loss: 0.1175055 Vali Loss: 0.0339818 Test Loss: 0.1213141
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0830969
	speed: 0.0389s/iter; left time: 262.2942s
	iters: 200, epoch: 9 | loss: 0.1031426
	speed: 0.0118s/iter; left time: 78.4415s
	iters: 300, epoch: 9 | loss: 0.1273969
	speed: 0.0118s/iter; left time: 77.1574s
	iters: 400, epoch: 9 | loss: 0.0935761
	speed: 0.0118s/iter; left time: 75.8435s
	iters: 500, epoch: 9 | loss: 0.1221326
	speed: 0.0118s/iter; left time: 74.6611s
Epoch: 9 cost time: 7.010517120361328
Epoch: 9, Steps: 570 | Train Loss: 0.1179751 Vali Loss: 0.0337733 Test Loss: 0.1214991
Validation loss decreased (0.033819 --> 0.033773).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1092000
	speed: 0.0396s/iter; left time: 244.5469s
	iters: 200, epoch: 10 | loss: 0.1274854
	speed: 0.0117s/iter; left time: 71.3038s
	iters: 300, epoch: 10 | loss: 0.1121873
	speed: 0.0117s/iter; left time: 70.1241s
	iters: 400, epoch: 10 | loss: 0.0965332
	speed: 0.0117s/iter; left time: 68.9610s
	iters: 500, epoch: 10 | loss: 0.1756359
	speed: 0.0117s/iter; left time: 67.7951s
Epoch: 10 cost time: 7.028184652328491
Epoch: 10, Steps: 570 | Train Loss: 0.1178543 Vali Loss: 0.0339950 Test Loss: 0.1212892
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0949260
	speed: 0.0390s/iter; left time: 218.3405s
	iters: 200, epoch: 11 | loss: 0.1574293
	speed: 0.0118s/iter; left time: 64.8058s
	iters: 300, epoch: 11 | loss: 0.1021439
	speed: 0.0118s/iter; left time: 63.8462s
	iters: 400, epoch: 11 | loss: 0.1203960
	speed: 0.0118s/iter; left time: 62.5274s
	iters: 500, epoch: 11 | loss: 0.1568638
	speed: 0.0118s/iter; left time: 61.4802s
Epoch: 11 cost time: 7.020429849624634
Epoch: 11, Steps: 570 | Train Loss: 0.1166994 Vali Loss: 0.0338951 Test Loss: 0.1214745
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0875340
	speed: 0.0388s/iter; left time: 195.0991s
	iters: 200, epoch: 12 | loss: 0.0922523
	speed: 0.0118s/iter; left time: 57.9436s
	iters: 300, epoch: 12 | loss: 0.0712340
	speed: 0.0117s/iter; left time: 56.6567s
	iters: 400, epoch: 12 | loss: 0.0914253
	speed: 0.0117s/iter; left time: 55.4894s
	iters: 500, epoch: 12 | loss: 0.1146528
	speed: 0.0118s/iter; left time: 54.4278s
Epoch: 12 cost time: 7.014226913452148
Epoch: 12, Steps: 570 | Train Loss: 0.1163134 Vali Loss: 0.0340062 Test Loss: 0.1214564
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12156736850738525, mae:0.21801316738128662
>>> MS_Pen LR=1e-4 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1052946
	speed: 0.0233s/iter; left time: 263.8410s
	iters: 200, epoch: 1 | loss: 0.2843314
	speed: 0.0114s/iter; left time: 128.0895s
	iters: 300, epoch: 1 | loss: 0.1388604
	speed: 0.0114s/iter; left time: 127.0701s
	iters: 400, epoch: 1 | loss: 0.1731460
	speed: 0.0114s/iter; left time: 125.1973s
	iters: 500, epoch: 1 | loss: 0.1468909
	speed: 0.0114s/iter; left time: 124.0819s
Epoch: 1 cost time: 7.7466208934783936
Epoch: 1, Steps: 570 | Train Loss: 0.1864431 Vali Loss: 0.0375620 Test Loss: 0.1157137
Validation loss decreased (inf --> 0.037562).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1517151
	speed: 0.0409s/iter; left time: 439.2107s
	iters: 200, epoch: 2 | loss: 0.1040831
	speed: 0.0115s/iter; left time: 121.8246s
	iters: 300, epoch: 2 | loss: 0.1604422
	speed: 0.0115s/iter; left time: 120.7714s
	iters: 400, epoch: 2 | loss: 0.2251911
	speed: 0.0115s/iter; left time: 119.8292s
	iters: 500, epoch: 2 | loss: 0.2429643
	speed: 0.0115s/iter; left time: 118.4435s
Epoch: 2 cost time: 6.8629841804504395
Epoch: 2, Steps: 570 | Train Loss: 0.1537441 Vali Loss: 0.0362807 Test Loss: 0.1193256
Validation loss decreased (0.037562 --> 0.036281).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1685045
	speed: 0.0408s/iter; left time: 414.4557s
	iters: 200, epoch: 3 | loss: 0.0853249
	speed: 0.0114s/iter; left time: 114.5837s
	iters: 300, epoch: 3 | loss: 0.1544664
	speed: 0.0115s/iter; left time: 114.7620s
	iters: 400, epoch: 3 | loss: 0.1346676
	speed: 0.0125s/iter; left time: 123.5298s
	iters: 500, epoch: 3 | loss: 0.1528614
	speed: 0.0120s/iter; left time: 117.3698s
Epoch: 3 cost time: 7.031597852706909
Epoch: 3, Steps: 570 | Train Loss: 0.1324480 Vali Loss: 0.0329157 Test Loss: 0.1163812
Validation loss decreased (0.036281 --> 0.032916).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1235090
	speed: 0.0384s/iter; left time: 368.1993s
	iters: 200, epoch: 4 | loss: 0.0885451
	speed: 0.0114s/iter; left time: 108.5993s
	iters: 300, epoch: 4 | loss: 0.0774527
	speed: 0.0114s/iter; left time: 107.4760s
	iters: 400, epoch: 4 | loss: 0.1004082
	speed: 0.0114s/iter; left time: 106.3391s
	iters: 500, epoch: 4 | loss: 0.1219780
	speed: 0.0114s/iter; left time: 105.2353s
Epoch: 4 cost time: 6.834630727767944
Epoch: 4, Steps: 570 | Train Loss: 0.1205458 Vali Loss: 0.0324788 Test Loss: 0.1198318
Validation loss decreased (0.032916 --> 0.032479).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1045246
	speed: 0.0384s/iter; left time: 346.3220s
	iters: 200, epoch: 5 | loss: 0.0931280
	speed: 0.0115s/iter; left time: 102.4072s
	iters: 300, epoch: 5 | loss: 0.1679341
	speed: 0.0115s/iter; left time: 101.2665s
	iters: 400, epoch: 5 | loss: 0.0985605
	speed: 0.0115s/iter; left time: 100.0931s
	iters: 500, epoch: 5 | loss: 0.0930102
	speed: 0.0115s/iter; left time: 98.9697s
Epoch: 5 cost time: 6.865221977233887
Epoch: 5, Steps: 570 | Train Loss: 0.1148016 Vali Loss: 0.0318454 Test Loss: 0.1184779
Validation loss decreased (0.032479 --> 0.031845).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1574378
	speed: 0.0389s/iter; left time: 328.5160s
	iters: 200, epoch: 6 | loss: 0.1260528
	speed: 0.0115s/iter; left time: 96.1634s
	iters: 300, epoch: 6 | loss: 0.0985109
	speed: 0.0115s/iter; left time: 95.0015s
	iters: 400, epoch: 6 | loss: 0.0865977
	speed: 0.0115s/iter; left time: 93.8682s
	iters: 500, epoch: 6 | loss: 0.0956215
	speed: 0.0115s/iter; left time: 92.6975s
Epoch: 6 cost time: 6.892168045043945
Epoch: 6, Steps: 570 | Train Loss: 0.1122934 Vali Loss: 0.0315391 Test Loss: 0.1183540
Validation loss decreased (0.031845 --> 0.031539).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0806915
	speed: 0.0392s/iter; left time: 308.5601s
	iters: 200, epoch: 7 | loss: 0.1482215
	speed: 0.0114s/iter; left time: 88.9229s
	iters: 300, epoch: 7 | loss: 0.0725973
	speed: 0.0114s/iter; left time: 87.7898s
	iters: 400, epoch: 7 | loss: 0.0878177
	speed: 0.0114s/iter; left time: 86.6145s
	iters: 500, epoch: 7 | loss: 0.0874413
	speed: 0.0114s/iter; left time: 85.5978s
Epoch: 7 cost time: 6.833427906036377
Epoch: 7, Steps: 570 | Train Loss: 0.1100286 Vali Loss: 0.0314064 Test Loss: 0.1190622
Validation loss decreased (0.031539 --> 0.031406).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0992520
	speed: 0.0389s/iter; left time: 284.0713s
	iters: 200, epoch: 8 | loss: 0.1427666
	speed: 0.0115s/iter; left time: 82.5987s
	iters: 300, epoch: 8 | loss: 0.0762287
	speed: 0.0114s/iter; left time: 81.2423s
	iters: 400, epoch: 8 | loss: 0.1069980
	speed: 0.0114s/iter; left time: 80.1360s
	iters: 500, epoch: 8 | loss: 0.0855067
	speed: 0.0114s/iter; left time: 78.9712s
Epoch: 8 cost time: 6.836212396621704
Epoch: 8, Steps: 570 | Train Loss: 0.1101580 Vali Loss: 0.0315325 Test Loss: 0.1187142
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1495053
	speed: 0.0390s/iter; left time: 263.0294s
	iters: 200, epoch: 9 | loss: 0.0827303
	speed: 0.0114s/iter; left time: 75.9770s
	iters: 300, epoch: 9 | loss: 0.1163218
	speed: 0.0114s/iter; left time: 74.8239s
	iters: 400, epoch: 9 | loss: 0.1203417
	speed: 0.0114s/iter; left time: 73.7207s
	iters: 500, epoch: 9 | loss: 0.1695889
	speed: 0.0115s/iter; left time: 72.7330s
Epoch: 9 cost time: 6.841578960418701
Epoch: 9, Steps: 570 | Train Loss: 0.1101511 Vali Loss: 0.0312974 Test Loss: 0.1188175
Validation loss decreased (0.031406 --> 0.031297).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1012897
	speed: 0.0387s/iter; left time: 238.6133s
	iters: 200, epoch: 10 | loss: 0.0987232
	speed: 0.0114s/iter; left time: 69.4742s
	iters: 300, epoch: 10 | loss: 0.0844858
	speed: 0.0114s/iter; left time: 68.3659s
	iters: 400, epoch: 10 | loss: 0.1248828
	speed: 0.0114s/iter; left time: 67.1838s
	iters: 500, epoch: 10 | loss: 0.1403313
	speed: 0.0115s/iter; left time: 66.1304s
Epoch: 10 cost time: 6.837207794189453
Epoch: 10, Steps: 570 | Train Loss: 0.1098678 Vali Loss: 0.0313941 Test Loss: 0.1188035
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0934139
	speed: 0.0390s/iter; left time: 218.5796s
	iters: 200, epoch: 11 | loss: 0.0970429
	speed: 0.0115s/iter; left time: 63.2904s
	iters: 300, epoch: 11 | loss: 0.0884662
	speed: 0.0115s/iter; left time: 62.1240s
	iters: 400, epoch: 11 | loss: 0.1467729
	speed: 0.0115s/iter; left time: 60.9877s
	iters: 500, epoch: 11 | loss: 0.1244773
	speed: 0.0127s/iter; left time: 65.8597s
Epoch: 11 cost time: 7.029642105102539
Epoch: 11, Steps: 570 | Train Loss: 0.1106325 Vali Loss: 0.0313488 Test Loss: 0.1187619
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1064152
	speed: 0.0410s/iter; left time: 206.1380s
	iters: 200, epoch: 12 | loss: 0.0978518
	speed: 0.0127s/iter; left time: 62.6509s
	iters: 300, epoch: 12 | loss: 0.1092770
	speed: 0.0127s/iter; left time: 61.2958s
	iters: 400, epoch: 12 | loss: 0.1362936
	speed: 0.0127s/iter; left time: 60.2960s
	iters: 500, epoch: 12 | loss: 0.1179743
	speed: 0.0127s/iter; left time: 58.9283s
Epoch: 12 cost time: 7.509403944015503
Epoch: 12, Steps: 570 | Train Loss: 0.1097983 Vali Loss: 0.0315758 Test Loss: 0.1186907
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11894434690475464, mae:0.21096797287464142
>>> MS_Pen LR=1e-4 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2675210
	speed: 0.0225s/iter; left time: 254.5521s
	iters: 200, epoch: 1 | loss: 0.2658482
	speed: 0.0108s/iter; left time: 121.3463s
	iters: 300, epoch: 1 | loss: 0.3143868
	speed: 0.0108s/iter; left time: 120.0474s
	iters: 400, epoch: 1 | loss: 0.1942937
	speed: 0.0108s/iter; left time: 118.9626s
	iters: 500, epoch: 1 | loss: 0.2097503
	speed: 0.0108s/iter; left time: 118.1350s
Epoch: 1 cost time: 7.390064239501953
Epoch: 1, Steps: 570 | Train Loss: 0.2140256 Vali Loss: 0.0425072 Test Loss: 0.1347638
Validation loss decreased (inf --> 0.042507).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2542851
	speed: 0.0394s/iter; left time: 422.3695s
	iters: 200, epoch: 2 | loss: 0.3025029
	speed: 0.0108s/iter; left time: 114.9512s
	iters: 300, epoch: 2 | loss: 0.1488115
	speed: 0.0108s/iter; left time: 114.0828s
	iters: 400, epoch: 2 | loss: 0.1579887
	speed: 0.0109s/iter; left time: 113.2331s
	iters: 500, epoch: 2 | loss: 0.1344406
	speed: 0.0108s/iter; left time: 111.9675s
Epoch: 2 cost time: 6.47609806060791
Epoch: 2, Steps: 570 | Train Loss: 0.1745478 Vali Loss: 0.0411156 Test Loss: 0.1358336
Validation loss decreased (0.042507 --> 0.041116).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1504707
	speed: 0.0376s/iter; left time: 382.2365s
	iters: 200, epoch: 3 | loss: 0.1062486
	speed: 0.0108s/iter; left time: 109.0700s
	iters: 300, epoch: 3 | loss: 0.1508308
	speed: 0.0109s/iter; left time: 108.4430s
	iters: 400, epoch: 3 | loss: 0.1052788
	speed: 0.0109s/iter; left time: 107.4003s
	iters: 500, epoch: 3 | loss: 0.1805119
	speed: 0.0108s/iter; left time: 105.5393s
Epoch: 3 cost time: 6.453354835510254
Epoch: 3, Steps: 570 | Train Loss: 0.1483576 Vali Loss: 0.0387300 Test Loss: 0.1337658
Validation loss decreased (0.041116 --> 0.038730).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1132291
	speed: 0.0363s/iter; left time: 348.0343s
	iters: 200, epoch: 4 | loss: 0.0992979
	speed: 0.0108s/iter; left time: 102.8291s
	iters: 300, epoch: 4 | loss: 0.1188850
	speed: 0.0109s/iter; left time: 102.3438s
	iters: 400, epoch: 4 | loss: 0.2026923
	speed: 0.0109s/iter; left time: 101.0726s
	iters: 500, epoch: 4 | loss: 0.1211394
	speed: 0.0109s/iter; left time: 99.8123s
Epoch: 4 cost time: 6.495572328567505
Epoch: 4, Steps: 570 | Train Loss: 0.1363543 Vali Loss: 0.0381012 Test Loss: 0.1368943
Validation loss decreased (0.038730 --> 0.038101).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1221041
	speed: 0.0370s/iter; left time: 333.3301s
	iters: 200, epoch: 5 | loss: 0.1213709
	speed: 0.0108s/iter; left time: 96.7818s
	iters: 300, epoch: 5 | loss: 0.1605553
	speed: 0.0109s/iter; left time: 96.0640s
	iters: 400, epoch: 5 | loss: 0.0944523
	speed: 0.0109s/iter; left time: 94.9264s
	iters: 500, epoch: 5 | loss: 0.1875032
	speed: 0.0109s/iter; left time: 93.7603s
Epoch: 5 cost time: 6.48178505897522
Epoch: 5, Steps: 570 | Train Loss: 0.1291216 Vali Loss: 0.0373291 Test Loss: 0.1338543
Validation loss decreased (0.038101 --> 0.037329).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1335579
	speed: 0.0383s/iter; left time: 323.4890s
	iters: 200, epoch: 6 | loss: 0.0947759
	speed: 0.0108s/iter; left time: 90.2399s
	iters: 300, epoch: 6 | loss: 0.1112693
	speed: 0.0108s/iter; left time: 89.2676s
	iters: 400, epoch: 6 | loss: 0.1243926
	speed: 0.0108s/iter; left time: 88.1597s
	iters: 500, epoch: 6 | loss: 0.1436600
	speed: 0.0108s/iter; left time: 87.0784s
Epoch: 6 cost time: 6.542916297912598
Epoch: 6, Steps: 570 | Train Loss: 0.1253666 Vali Loss: 0.0373907 Test Loss: 0.1372481
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1080248
	speed: 0.0371s/iter; left time: 292.4755s
	iters: 200, epoch: 7 | loss: 0.1091338
	speed: 0.0109s/iter; left time: 84.6947s
	iters: 300, epoch: 7 | loss: 0.0905906
	speed: 0.0109s/iter; left time: 83.5697s
	iters: 400, epoch: 7 | loss: 0.1036006
	speed: 0.0109s/iter; left time: 82.5482s
	iters: 500, epoch: 7 | loss: 0.0929777
	speed: 0.0109s/iter; left time: 81.3986s
Epoch: 7 cost time: 6.485426902770996
Epoch: 7, Steps: 570 | Train Loss: 0.1239022 Vali Loss: 0.0374822 Test Loss: 0.1362828
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0887321
	speed: 0.0374s/iter; left time: 273.2358s
	iters: 200, epoch: 8 | loss: 0.1630053
	speed: 0.0109s/iter; left time: 78.7573s
	iters: 300, epoch: 8 | loss: 0.1780097
	speed: 0.0109s/iter; left time: 77.6344s
	iters: 400, epoch: 8 | loss: 0.1241401
	speed: 0.0109s/iter; left time: 76.5039s
	iters: 500, epoch: 8 | loss: 0.0969879
	speed: 0.0109s/iter; left time: 75.3961s
Epoch: 8 cost time: 6.614137887954712
Epoch: 8, Steps: 570 | Train Loss: 0.1230511 Vali Loss: 0.0370189 Test Loss: 0.1358983
Validation loss decreased (0.037329 --> 0.037019).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1115710
	speed: 0.0368s/iter; left time: 248.0447s
	iters: 200, epoch: 9 | loss: 0.1061715
	speed: 0.0109s/iter; left time: 72.2579s
	iters: 300, epoch: 9 | loss: 0.1557114
	speed: 0.0109s/iter; left time: 71.1676s
	iters: 400, epoch: 9 | loss: 0.1283638
	speed: 0.0109s/iter; left time: 70.0500s
	iters: 500, epoch: 9 | loss: 0.0842836
	speed: 0.0109s/iter; left time: 68.9401s
Epoch: 9 cost time: 6.488647937774658
Epoch: 9, Steps: 570 | Train Loss: 0.1216978 Vali Loss: 0.0369651 Test Loss: 0.1357302
Validation loss decreased (0.037019 --> 0.036965).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1303635
	speed: 0.0370s/iter; left time: 228.1217s
	iters: 200, epoch: 10 | loss: 0.0678591
	speed: 0.0108s/iter; left time: 65.7939s
	iters: 300, epoch: 10 | loss: 0.1292266
	speed: 0.0109s/iter; left time: 64.8360s
	iters: 400, epoch: 10 | loss: 0.1076432
	speed: 0.0108s/iter; left time: 63.6077s
	iters: 500, epoch: 10 | loss: 0.1304404
	speed: 0.0108s/iter; left time: 62.1723s
Epoch: 10 cost time: 6.461469650268555
Epoch: 10, Steps: 570 | Train Loss: 0.1217792 Vali Loss: 0.0372586 Test Loss: 0.1359842
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0831549
	speed: 0.0372s/iter; left time: 208.6347s
	iters: 200, epoch: 11 | loss: 0.1325837
	speed: 0.0109s/iter; left time: 60.1055s
	iters: 300, epoch: 11 | loss: 0.1140661
	speed: 0.0110s/iter; left time: 59.1697s
	iters: 400, epoch: 11 | loss: 0.0923896
	speed: 0.0108s/iter; left time: 57.4292s
	iters: 500, epoch: 11 | loss: 0.1108865
	speed: 0.0108s/iter; left time: 56.1213s
Epoch: 11 cost time: 6.473397254943848
Epoch: 11, Steps: 570 | Train Loss: 0.1228420 Vali Loss: 0.0371663 Test Loss: 0.1356575
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1216975
	speed: 0.0364s/iter; left time: 183.2857s
	iters: 200, epoch: 12 | loss: 0.1644564
	speed: 0.0108s/iter; left time: 53.4018s
	iters: 300, epoch: 12 | loss: 0.1159772
	speed: 0.0109s/iter; left time: 52.4591s
	iters: 400, epoch: 12 | loss: 0.1347874
	speed: 0.0109s/iter; left time: 51.6457s
	iters: 500, epoch: 12 | loss: 0.1295421
	speed: 0.0109s/iter; left time: 50.4518s
Epoch: 12 cost time: 6.468898296356201
Epoch: 12, Steps: 570 | Train Loss: 0.1214805 Vali Loss: 0.0371224 Test Loss: 0.1357866
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1359139382839203, mae:0.23180049657821655
>>> MS_Pen LR=1e-4 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1764980
	speed: 0.0282s/iter; left time: 318.9144s
	iters: 200, epoch: 1 | loss: 0.1571178
	speed: 0.0164s/iter; left time: 183.1816s
	iters: 300, epoch: 1 | loss: 0.3153135
	speed: 0.0163s/iter; left time: 181.0876s
	iters: 400, epoch: 1 | loss: 0.1699391
	speed: 0.0164s/iter; left time: 180.0685s
	iters: 500, epoch: 1 | loss: 0.1486698
	speed: 0.0164s/iter; left time: 178.4172s
Epoch: 1 cost time: 10.560233354568481
Epoch: 1, Steps: 570 | Train Loss: 0.2112325 Vali Loss: 0.0417877 Test Loss: 0.1288581
Validation loss decreased (inf --> 0.041788).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2222538
	speed: 0.0476s/iter; left time: 510.9794s
	iters: 200, epoch: 2 | loss: 0.1588518
	speed: 0.0146s/iter; left time: 155.2866s
	iters: 300, epoch: 2 | loss: 0.1415331
	speed: 0.0146s/iter; left time: 153.7777s
	iters: 400, epoch: 2 | loss: 0.1052117
	speed: 0.0146s/iter; left time: 152.2392s
	iters: 500, epoch: 2 | loss: 0.1845953
	speed: 0.0146s/iter; left time: 150.9899s
Epoch: 2 cost time: 8.639224290847778
Epoch: 2, Steps: 570 | Train Loss: 0.1744785 Vali Loss: 0.0390203 Test Loss: 0.1247664
Validation loss decreased (0.041788 --> 0.039020).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2614705
	speed: 0.0480s/iter; left time: 487.2399s
	iters: 200, epoch: 3 | loss: 0.2131630
	speed: 0.0145s/iter; left time: 146.2399s
	iters: 300, epoch: 3 | loss: 0.0993494
	speed: 0.0146s/iter; left time: 145.3778s
	iters: 400, epoch: 3 | loss: 0.1147987
	speed: 0.0146s/iter; left time: 143.5848s
	iters: 500, epoch: 3 | loss: 0.1170837
	speed: 0.0146s/iter; left time: 142.1589s
Epoch: 3 cost time: 8.625954389572144
Epoch: 3, Steps: 570 | Train Loss: 0.1532344 Vali Loss: 0.0351684 Test Loss: 0.1251142
Validation loss decreased (0.039020 --> 0.035168).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1330888
	speed: 0.0468s/iter; left time: 449.1442s
	iters: 200, epoch: 4 | loss: 0.1053899
	speed: 0.0147s/iter; left time: 139.3212s
	iters: 300, epoch: 4 | loss: 0.1829992
	speed: 0.0147s/iter; left time: 137.8211s
	iters: 400, epoch: 4 | loss: 0.1655998
	speed: 0.0147s/iter; left time: 136.2700s
	iters: 500, epoch: 4 | loss: 0.1249250
	speed: 0.0147s/iter; left time: 134.8318s
Epoch: 4 cost time: 8.685368776321411
Epoch: 4, Steps: 570 | Train Loss: 0.1434844 Vali Loss: 0.0348521 Test Loss: 0.1244759
Validation loss decreased (0.035168 --> 0.034852).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1197401
	speed: 0.0469s/iter; left time: 422.7094s
	iters: 200, epoch: 5 | loss: 0.1295592
	speed: 0.0146s/iter; left time: 130.1171s
	iters: 300, epoch: 5 | loss: 0.1095244
	speed: 0.0146s/iter; left time: 128.7445s
	iters: 400, epoch: 5 | loss: 0.1600650
	speed: 0.0146s/iter; left time: 127.2551s
	iters: 500, epoch: 5 | loss: 0.1257830
	speed: 0.0146s/iter; left time: 125.8464s
Epoch: 5 cost time: 8.629385232925415
Epoch: 5, Steps: 570 | Train Loss: 0.1382032 Vali Loss: 0.0348064 Test Loss: 0.1195776
Validation loss decreased (0.034852 --> 0.034806).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1027615
	speed: 0.0495s/iter; left time: 418.3233s
	iters: 200, epoch: 6 | loss: 0.1379413
	speed: 0.0164s/iter; left time: 136.8569s
	iters: 300, epoch: 6 | loss: 0.0964815
	speed: 0.0147s/iter; left time: 121.1493s
	iters: 400, epoch: 6 | loss: 0.1121342
	speed: 0.0162s/iter; left time: 131.8353s
	iters: 500, epoch: 6 | loss: 0.1331024
	speed: 0.0163s/iter; left time: 131.0843s
Epoch: 6 cost time: 9.446819543838501
Epoch: 6, Steps: 570 | Train Loss: 0.1349465 Vali Loss: 0.0342173 Test Loss: 0.1215011
Validation loss decreased (0.034806 --> 0.034217).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1254355
	speed: 0.0509s/iter; left time: 401.0553s
	iters: 200, epoch: 7 | loss: 0.1084523
	speed: 0.0164s/iter; left time: 127.3123s
	iters: 300, epoch: 7 | loss: 0.1330560
	speed: 0.0146s/iter; left time: 112.1446s
	iters: 400, epoch: 7 | loss: 0.1285636
	speed: 0.0146s/iter; left time: 110.4683s
	iters: 500, epoch: 7 | loss: 0.1847082
	speed: 0.0146s/iter; left time: 108.9512s
Epoch: 7 cost time: 8.95011568069458
Epoch: 7, Steps: 570 | Train Loss: 0.1336335 Vali Loss: 0.0347064 Test Loss: 0.1215962
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1771169
	speed: 0.0467s/iter; left time: 341.2550s
	iters: 200, epoch: 8 | loss: 0.1352384
	speed: 0.0146s/iter; left time: 104.9978s
	iters: 300, epoch: 8 | loss: 0.1744142
	speed: 0.0146s/iter; left time: 103.7557s
	iters: 400, epoch: 8 | loss: 0.0920528
	speed: 0.0146s/iter; left time: 102.1300s
	iters: 500, epoch: 8 | loss: 0.1249315
	speed: 0.0146s/iter; left time: 100.6237s
Epoch: 8 cost time: 8.60287857055664
Epoch: 8, Steps: 570 | Train Loss: 0.1330058 Vali Loss: 0.0343732 Test Loss: 0.1215581
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1811693
	speed: 0.0483s/iter; left time: 325.4880s
	iters: 200, epoch: 9 | loss: 0.1380124
	speed: 0.0164s/iter; left time: 108.8035s
	iters: 300, epoch: 9 | loss: 0.1750983
	speed: 0.0164s/iter; left time: 107.2375s
	iters: 400, epoch: 9 | loss: 0.1658387
	speed: 0.0164s/iter; left time: 105.6518s
	iters: 500, epoch: 9 | loss: 0.1088864
	speed: 0.0163s/iter; left time: 103.4995s
Epoch: 9 cost time: 9.502657175064087
Epoch: 9, Steps: 570 | Train Loss: 0.1322411 Vali Loss: 0.0343040 Test Loss: 0.1212400
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12160640209913254, mae:0.21579447388648987
>>> MS_Pen LR=1e-4 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2855279
	speed: 0.0261s/iter; left time: 295.0214s
	iters: 200, epoch: 1 | loss: 0.1978640
	speed: 0.0143s/iter; left time: 159.9608s
	iters: 300, epoch: 1 | loss: 0.1102007
	speed: 0.0142s/iter; left time: 158.1164s
	iters: 400, epoch: 1 | loss: 0.2551385
	speed: 0.0142s/iter; left time: 156.7598s
	iters: 500, epoch: 1 | loss: 0.1831505
	speed: 0.0143s/iter; left time: 155.5133s
Epoch: 1 cost time: 9.368266344070435
Epoch: 1, Steps: 570 | Train Loss: 0.1873815 Vali Loss: 0.0374750 Test Loss: 0.1162074
Validation loss decreased (inf --> 0.037475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1296331
	speed: 0.0460s/iter; left time: 493.1973s
	iters: 200, epoch: 2 | loss: 0.2647083
	speed: 0.0142s/iter; left time: 151.4117s
	iters: 300, epoch: 2 | loss: 0.1900509
	speed: 0.0144s/iter; left time: 151.4139s
	iters: 400, epoch: 2 | loss: 0.1326965
	speed: 0.0144s/iter; left time: 149.7752s
	iters: 500, epoch: 2 | loss: 0.1427858
	speed: 0.0143s/iter; left time: 147.6521s
Epoch: 2 cost time: 8.458528757095337
Epoch: 2, Steps: 570 | Train Loss: 0.1570822 Vali Loss: 0.0359395 Test Loss: 0.1165769
Validation loss decreased (0.037475 --> 0.035940).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1356650
	speed: 0.0464s/iter; left time: 471.2978s
	iters: 200, epoch: 3 | loss: 0.0784091
	speed: 0.0143s/iter; left time: 143.4560s
	iters: 300, epoch: 3 | loss: 0.1789283
	speed: 0.0142s/iter; left time: 141.7792s
	iters: 400, epoch: 3 | loss: 0.1208640
	speed: 0.0143s/iter; left time: 141.2624s
	iters: 500, epoch: 3 | loss: 0.1176359
	speed: 0.0143s/iter; left time: 139.5472s
Epoch: 3 cost time: 8.461564540863037
Epoch: 3, Steps: 570 | Train Loss: 0.1386820 Vali Loss: 0.0349662 Test Loss: 0.1170288
Validation loss decreased (0.035940 --> 0.034966).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1276917
	speed: 0.0471s/iter; left time: 452.1198s
	iters: 200, epoch: 4 | loss: 0.1362300
	speed: 0.0142s/iter; left time: 135.1369s
	iters: 300, epoch: 4 | loss: 0.1289908
	speed: 0.0143s/iter; left time: 134.2834s
	iters: 400, epoch: 4 | loss: 0.0876272
	speed: 0.0143s/iter; left time: 132.7043s
	iters: 500, epoch: 4 | loss: 0.0880760
	speed: 0.0142s/iter; left time: 130.7610s
Epoch: 4 cost time: 8.43276333808899
Epoch: 4, Steps: 570 | Train Loss: 0.1311144 Vali Loss: 0.0331453 Test Loss: 0.1166348
Validation loss decreased (0.034966 --> 0.033145).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0812158
	speed: 0.0453s/iter; left time: 408.6507s
	iters: 200, epoch: 5 | loss: 0.1625023
	speed: 0.0142s/iter; left time: 126.5951s
	iters: 300, epoch: 5 | loss: 0.1739994
	speed: 0.0142s/iter; left time: 125.5216s
	iters: 400, epoch: 5 | loss: 0.1068905
	speed: 0.0142s/iter; left time: 123.8316s
	iters: 500, epoch: 5 | loss: 0.1526828
	speed: 0.0142s/iter; left time: 122.7691s
Epoch: 5 cost time: 8.39578366279602
Epoch: 5, Steps: 570 | Train Loss: 0.1272153 Vali Loss: 0.0333055 Test Loss: 0.1166683
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1134097
	speed: 0.0471s/iter; left time: 398.3414s
	iters: 200, epoch: 6 | loss: 0.2325853
	speed: 0.0143s/iter; left time: 119.6174s
	iters: 300, epoch: 6 | loss: 0.1698354
	speed: 0.0143s/iter; left time: 117.9206s
	iters: 400, epoch: 6 | loss: 0.1462580
	speed: 0.0143s/iter; left time: 116.2325s
	iters: 500, epoch: 6 | loss: 0.1528667
	speed: 0.0143s/iter; left time: 115.0419s
Epoch: 6 cost time: 8.463465690612793
Epoch: 6, Steps: 570 | Train Loss: 0.1249227 Vali Loss: 0.0325686 Test Loss: 0.1163733
Validation loss decreased (0.033145 --> 0.032569).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0953003
	speed: 0.0464s/iter; left time: 365.9820s
	iters: 200, epoch: 7 | loss: 0.1515044
	speed: 0.0143s/iter; left time: 111.2297s
	iters: 300, epoch: 7 | loss: 0.1763890
	speed: 0.0142s/iter; left time: 109.4296s
	iters: 400, epoch: 7 | loss: 0.1258632
	speed: 0.0142s/iter; left time: 108.0033s
	iters: 500, epoch: 7 | loss: 0.1738232
	speed: 0.0142s/iter; left time: 106.5107s
Epoch: 7 cost time: 8.443301916122437
Epoch: 7, Steps: 570 | Train Loss: 0.1234287 Vali Loss: 0.0326263 Test Loss: 0.1168948
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0986151
	speed: 0.0455s/iter; left time: 332.6699s
	iters: 200, epoch: 8 | loss: 0.1082562
	speed: 0.0142s/iter; left time: 102.1007s
	iters: 300, epoch: 8 | loss: 0.1660586
	speed: 0.0142s/iter; left time: 100.7227s
	iters: 400, epoch: 8 | loss: 0.1354683
	speed: 0.0142s/iter; left time: 99.2561s
	iters: 500, epoch: 8 | loss: 0.1092500
	speed: 0.0142s/iter; left time: 97.7983s
Epoch: 8 cost time: 8.3375825881958
Epoch: 8, Steps: 570 | Train Loss: 0.1227688 Vali Loss: 0.0325270 Test Loss: 0.1166905
Validation loss decreased (0.032569 --> 0.032527).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1076713
	speed: 0.0451s/iter; left time: 304.3000s
	iters: 200, epoch: 9 | loss: 0.1010528
	speed: 0.0142s/iter; left time: 94.2035s
	iters: 300, epoch: 9 | loss: 0.1303408
	speed: 0.0142s/iter; left time: 92.6826s
	iters: 400, epoch: 9 | loss: 0.1175998
	speed: 0.0142s/iter; left time: 91.2961s
	iters: 500, epoch: 9 | loss: 0.1488929
	speed: 0.0142s/iter; left time: 89.9344s
Epoch: 9 cost time: 8.39165997505188
Epoch: 9, Steps: 570 | Train Loss: 0.1221146 Vali Loss: 0.0324583 Test Loss: 0.1167349
Validation loss decreased (0.032527 --> 0.032458).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1036341
	speed: 0.0454s/iter; left time: 280.4648s
	iters: 200, epoch: 10 | loss: 0.0940274
	speed: 0.0142s/iter; left time: 85.9921s
	iters: 300, epoch: 10 | loss: 0.1003159
	speed: 0.0142s/iter; left time: 84.5399s
	iters: 400, epoch: 10 | loss: 0.1155424
	speed: 0.0142s/iter; left time: 83.1616s
	iters: 500, epoch: 10 | loss: 0.1284550
	speed: 0.0142s/iter; left time: 81.7205s
Epoch: 10 cost time: 8.341912031173706
Epoch: 10, Steps: 570 | Train Loss: 0.1223390 Vali Loss: 0.0324715 Test Loss: 0.1167861
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1648486
	speed: 0.0447s/iter; left time: 250.5339s
	iters: 200, epoch: 11 | loss: 0.1566222
	speed: 0.0141s/iter; left time: 77.7935s
	iters: 300, epoch: 11 | loss: 0.1494734
	speed: 0.0141s/iter; left time: 76.3750s
	iters: 400, epoch: 11 | loss: 0.0870131
	speed: 0.0141s/iter; left time: 74.9765s
	iters: 500, epoch: 11 | loss: 0.2166249
	speed: 0.0142s/iter; left time: 73.6600s
Epoch: 11 cost time: 8.35209846496582
Epoch: 11, Steps: 570 | Train Loss: 0.1218560 Vali Loss: 0.0324602 Test Loss: 0.1168078
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1731286
	speed: 0.0450s/iter; left time: 226.3955s
	iters: 200, epoch: 12 | loss: 0.1397466
	speed: 0.0142s/iter; left time: 70.1209s
	iters: 300, epoch: 12 | loss: 0.1067048
	speed: 0.0142s/iter; left time: 68.4920s
	iters: 400, epoch: 12 | loss: 0.1385759
	speed: 0.0142s/iter; left time: 67.1021s
	iters: 500, epoch: 12 | loss: 0.1165000
	speed: 0.0142s/iter; left time: 65.7099s
Epoch: 12 cost time: 8.411513566970825
Epoch: 12, Steps: 570 | Train Loss: 0.1227897 Vali Loss: 0.0325651 Test Loss: 0.1168140
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11687467247247696, mae:0.2087685614824295
>>> MS_Pen LR=1e-4 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1366913
	speed: 0.0279s/iter; left time: 315.7657s
	iters: 200, epoch: 1 | loss: 0.2885553
	speed: 0.0160s/iter; left time: 179.3037s
	iters: 300, epoch: 1 | loss: 0.2754352
	speed: 0.0160s/iter; left time: 177.2669s
	iters: 400, epoch: 1 | loss: 0.2308623
	speed: 0.0160s/iter; left time: 175.7699s
	iters: 500, epoch: 1 | loss: 0.2563530
	speed: 0.0160s/iter; left time: 173.9515s
Epoch: 1 cost time: 10.356199979782104
Epoch: 1, Steps: 570 | Train Loss: 0.2187184 Vali Loss: 0.0445920 Test Loss: 0.1381493
Validation loss decreased (inf --> 0.044592).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1512647
	speed: 0.0484s/iter; left time: 518.9674s
	iters: 200, epoch: 2 | loss: 0.1231331
	speed: 0.0142s/iter; left time: 151.4831s
	iters: 300, epoch: 2 | loss: 0.1029156
	speed: 0.0143s/iter; left time: 150.4376s
	iters: 400, epoch: 2 | loss: 0.1384263
	speed: 0.0143s/iter; left time: 149.1057s
	iters: 500, epoch: 2 | loss: 0.1682283
	speed: 0.0142s/iter; left time: 147.1616s
Epoch: 2 cost time: 8.441406011581421
Epoch: 2, Steps: 570 | Train Loss: 0.1803125 Vali Loss: 0.0406248 Test Loss: 0.1324038
Validation loss decreased (0.044592 --> 0.040625).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2014807
	speed: 0.0471s/iter; left time: 478.4922s
	iters: 200, epoch: 3 | loss: 0.2111602
	speed: 0.0143s/iter; left time: 143.7474s
	iters: 300, epoch: 3 | loss: 0.1383519
	speed: 0.0143s/iter; left time: 142.1016s
	iters: 400, epoch: 3 | loss: 0.1325801
	speed: 0.0143s/iter; left time: 140.6756s
	iters: 500, epoch: 3 | loss: 0.1535771
	speed: 0.0142s/iter; left time: 138.8353s
Epoch: 3 cost time: 8.419345140457153
Epoch: 3, Steps: 570 | Train Loss: 0.1585682 Vali Loss: 0.0382255 Test Loss: 0.1265693
Validation loss decreased (0.040625 --> 0.038225).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1902221
	speed: 0.0459s/iter; left time: 440.2635s
	iters: 200, epoch: 4 | loss: 0.1596988
	speed: 0.0143s/iter; left time: 135.5255s
	iters: 300, epoch: 4 | loss: 0.1762324
	speed: 0.0142s/iter; left time: 133.5317s
	iters: 400, epoch: 4 | loss: 0.1465228
	speed: 0.0143s/iter; left time: 132.5714s
	iters: 500, epoch: 4 | loss: 0.1304359
	speed: 0.0143s/iter; left time: 131.8836s
Epoch: 4 cost time: 8.43556523323059
Epoch: 4, Steps: 570 | Train Loss: 0.1491815 Vali Loss: 0.0366891 Test Loss: 0.1272165
Validation loss decreased (0.038225 --> 0.036689).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1627895
	speed: 0.0465s/iter; left time: 419.6353s
	iters: 200, epoch: 5 | loss: 0.1707366
	speed: 0.0144s/iter; left time: 128.2952s
	iters: 300, epoch: 5 | loss: 0.1396409
	speed: 0.0142s/iter; left time: 125.6576s
	iters: 400, epoch: 5 | loss: 0.1929145
	speed: 0.0142s/iter; left time: 124.0303s
	iters: 500, epoch: 5 | loss: 0.1082746
	speed: 0.0143s/iter; left time: 122.9359s
Epoch: 5 cost time: 8.445585250854492
Epoch: 5, Steps: 570 | Train Loss: 0.1438908 Vali Loss: 0.0372135 Test Loss: 0.1273591
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1615708
	speed: 0.0469s/iter; left time: 396.4576s
	iters: 200, epoch: 6 | loss: 0.1435547
	speed: 0.0144s/iter; left time: 120.1951s
	iters: 300, epoch: 6 | loss: 0.0920761
	speed: 0.0144s/iter; left time: 118.5184s
	iters: 400, epoch: 6 | loss: 0.1902313
	speed: 0.0143s/iter; left time: 116.9661s
	iters: 500, epoch: 6 | loss: 0.1393510
	speed: 0.0144s/iter; left time: 115.6751s
Epoch: 6 cost time: 8.472444534301758
Epoch: 6, Steps: 570 | Train Loss: 0.1407193 Vali Loss: 0.0362382 Test Loss: 0.1285802
Validation loss decreased (0.036689 --> 0.036238).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1677890
	speed: 0.0461s/iter; left time: 362.9273s
	iters: 200, epoch: 7 | loss: 0.1000293
	speed: 0.0143s/iter; left time: 111.2315s
	iters: 300, epoch: 7 | loss: 0.1079057
	speed: 0.0143s/iter; left time: 109.4875s
	iters: 400, epoch: 7 | loss: 0.1900837
	speed: 0.0143s/iter; left time: 108.1517s
	iters: 500, epoch: 7 | loss: 0.1233593
	speed: 0.0142s/iter; left time: 106.2826s
Epoch: 7 cost time: 8.386405229568481
Epoch: 7, Steps: 570 | Train Loss: 0.1403942 Vali Loss: 0.0364911 Test Loss: 0.1282522
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1317260
	speed: 0.0444s/iter; left time: 324.8296s
	iters: 200, epoch: 8 | loss: 0.1089134
	speed: 0.0142s/iter; left time: 102.7034s
	iters: 300, epoch: 8 | loss: 0.1308098
	speed: 0.0142s/iter; left time: 101.2334s
	iters: 400, epoch: 8 | loss: 0.1608602
	speed: 0.0142s/iter; left time: 99.6042s
	iters: 500, epoch: 8 | loss: 0.1124827
	speed: 0.0142s/iter; left time: 98.2539s
Epoch: 8 cost time: 8.396418809890747
Epoch: 8, Steps: 570 | Train Loss: 0.1391467 Vali Loss: 0.0365524 Test Loss: 0.1298027
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1960355
	speed: 0.0474s/iter; left time: 319.5540s
	iters: 200, epoch: 9 | loss: 0.1196795
	speed: 0.0143s/iter; left time: 95.1471s
	iters: 300, epoch: 9 | loss: 0.0860349
	speed: 0.0143s/iter; left time: 93.6317s
	iters: 400, epoch: 9 | loss: 0.1145817
	speed: 0.0143s/iter; left time: 92.0845s
	iters: 500, epoch: 9 | loss: 0.1227425
	speed: 0.0143s/iter; left time: 90.6434s
Epoch: 9 cost time: 8.476845502853394
Epoch: 9, Steps: 570 | Train Loss: 0.1395413 Vali Loss: 0.0364198 Test Loss: 0.1295652
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12870311737060547, mae:0.22588302195072174
>>> MS_Pen LR=1e-4 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2349673
	speed: 0.0287s/iter; left time: 323.9837s
	iters: 200, epoch: 1 | loss: 0.1584841
	speed: 0.0169s/iter; left time: 189.3327s
	iters: 300, epoch: 1 | loss: 0.2438463
	speed: 0.0169s/iter; left time: 188.0331s
	iters: 400, epoch: 1 | loss: 0.2160540
	speed: 0.0170s/iter; left time: 187.0507s
	iters: 500, epoch: 1 | loss: 0.1439209
	speed: 0.0169s/iter; left time: 184.7652s
Epoch: 1 cost time: 10.877471446990967
Epoch: 1, Steps: 570 | Train Loss: 0.2081518 Vali Loss: 0.0453408 Test Loss: 0.1376082
Validation loss decreased (inf --> 0.045341).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2091443
	speed: 0.0516s/iter; left time: 553.2971s
	iters: 200, epoch: 2 | loss: 0.1867460
	speed: 0.0170s/iter; left time: 180.8018s
	iters: 300, epoch: 2 | loss: 0.1967232
	speed: 0.0170s/iter; left time: 179.0270s
	iters: 400, epoch: 2 | loss: 0.1287053
	speed: 0.0169s/iter; left time: 176.6764s
	iters: 500, epoch: 2 | loss: 0.1243524
	speed: 0.0169s/iter; left time: 174.9806s
Epoch: 2 cost time: 9.981512308120728
Epoch: 2, Steps: 570 | Train Loss: 0.1624752 Vali Loss: 0.0396332 Test Loss: 0.1338889
Validation loss decreased (0.045341 --> 0.039633).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1153311
	speed: 0.0513s/iter; left time: 521.3169s
	iters: 200, epoch: 3 | loss: 0.1219919
	speed: 0.0169s/iter; left time: 169.7066s
	iters: 300, epoch: 3 | loss: 0.2680367
	speed: 0.0169s/iter; left time: 167.9725s
	iters: 400, epoch: 3 | loss: 0.1102810
	speed: 0.0169s/iter; left time: 166.4531s
	iters: 500, epoch: 3 | loss: 0.1102733
	speed: 0.0169s/iter; left time: 164.5487s
Epoch: 3 cost time: 9.920771837234497
Epoch: 3, Steps: 570 | Train Loss: 0.1349038 Vali Loss: 0.0364780 Test Loss: 0.1290869
Validation loss decreased (0.039633 --> 0.036478).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1178429
	speed: 0.0503s/iter; left time: 482.3509s
	iters: 200, epoch: 4 | loss: 0.1053792
	speed: 0.0169s/iter; left time: 160.4268s
	iters: 300, epoch: 4 | loss: 0.1101010
	speed: 0.0169s/iter; left time: 158.5761s
	iters: 400, epoch: 4 | loss: 0.1586713
	speed: 0.0169s/iter; left time: 156.7856s
	iters: 500, epoch: 4 | loss: 0.1257400
	speed: 0.0169s/iter; left time: 155.0482s
Epoch: 4 cost time: 9.946680307388306
Epoch: 4, Steps: 570 | Train Loss: 0.1205301 Vali Loss: 0.0353163 Test Loss: 0.1360226
Validation loss decreased (0.036478 --> 0.035316).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0817277
	speed: 0.0509s/iter; left time: 459.4467s
	iters: 200, epoch: 5 | loss: 0.1222657
	speed: 0.0169s/iter; left time: 150.6862s
	iters: 300, epoch: 5 | loss: 0.1030564
	speed: 0.0169s/iter; left time: 148.8701s
	iters: 400, epoch: 5 | loss: 0.1480788
	speed: 0.0169s/iter; left time: 147.1958s
	iters: 500, epoch: 5 | loss: 0.0903544
	speed: 0.0169s/iter; left time: 145.6156s
Epoch: 5 cost time: 9.908414363861084
Epoch: 5, Steps: 570 | Train Loss: 0.1130703 Vali Loss: 0.0353693 Test Loss: 0.1349359
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1182990
	speed: 0.0511s/iter; left time: 431.5283s
	iters: 200, epoch: 6 | loss: 0.1016049
	speed: 0.0169s/iter; left time: 141.0056s
	iters: 300, epoch: 6 | loss: 0.1138808
	speed: 0.0169s/iter; left time: 139.3352s
	iters: 400, epoch: 6 | loss: 0.1521827
	speed: 0.0169s/iter; left time: 137.4631s
	iters: 500, epoch: 6 | loss: 0.0891810
	speed: 0.0169s/iter; left time: 135.7977s
Epoch: 6 cost time: 9.909538984298706
Epoch: 6, Steps: 570 | Train Loss: 0.1098358 Vali Loss: 0.0352160 Test Loss: 0.1310769
Validation loss decreased (0.035316 --> 0.035216).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1233780
	speed: 0.0530s/iter; left time: 417.9449s
	iters: 200, epoch: 7 | loss: 0.1396930
	speed: 0.0168s/iter; left time: 131.0194s
	iters: 300, epoch: 7 | loss: 0.1314055
	speed: 0.0168s/iter; left time: 129.2471s
	iters: 400, epoch: 7 | loss: 0.0957636
	speed: 0.0168s/iter; left time: 127.5156s
	iters: 500, epoch: 7 | loss: 0.0856945
	speed: 0.0168s/iter; left time: 125.8569s
Epoch: 7 cost time: 9.921934843063354
Epoch: 7, Steps: 570 | Train Loss: 0.1080868 Vali Loss: 0.0348803 Test Loss: 0.1327267
Validation loss decreased (0.035216 --> 0.034880).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0905824
	speed: 0.0517s/iter; left time: 378.3422s
	iters: 200, epoch: 8 | loss: 0.0769045
	speed: 0.0169s/iter; left time: 122.0542s
	iters: 300, epoch: 8 | loss: 0.0933346
	speed: 0.0169s/iter; left time: 120.2959s
	iters: 400, epoch: 8 | loss: 0.0674522
	speed: 0.0169s/iter; left time: 118.7506s
	iters: 500, epoch: 8 | loss: 0.0901489
	speed: 0.0169s/iter; left time: 116.8890s
Epoch: 8 cost time: 9.971728801727295
Epoch: 8, Steps: 570 | Train Loss: 0.1077380 Vali Loss: 0.0351386 Test Loss: 0.1332214
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0796890
	speed: 0.0504s/iter; left time: 339.5002s
	iters: 200, epoch: 9 | loss: 0.0756179
	speed: 0.0169s/iter; left time: 112.4202s
	iters: 300, epoch: 9 | loss: 0.0945848
	speed: 0.0169s/iter; left time: 110.8207s
	iters: 400, epoch: 9 | loss: 0.1316199
	speed: 0.0169s/iter; left time: 108.9885s
	iters: 500, epoch: 9 | loss: 0.1372208
	speed: 0.0169s/iter; left time: 107.4299s
Epoch: 9 cost time: 9.92830204963684
Epoch: 9, Steps: 570 | Train Loss: 0.1072449 Vali Loss: 0.0349616 Test Loss: 0.1325255
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1073493
	speed: 0.0525s/iter; left time: 324.0951s
	iters: 200, epoch: 10 | loss: 0.0644052
	speed: 0.0169s/iter; left time: 102.7426s
	iters: 300, epoch: 10 | loss: 0.1357407
	speed: 0.0169s/iter; left time: 100.9187s
	iters: 400, epoch: 10 | loss: 0.1187223
	speed: 0.0169s/iter; left time: 99.2271s
	iters: 500, epoch: 10 | loss: 0.1027460
	speed: 0.0169s/iter; left time: 97.5724s
Epoch: 10 cost time: 9.9353609085083
Epoch: 10, Steps: 570 | Train Loss: 0.1067268 Vali Loss: 0.0352613 Test Loss: 0.1325621
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13286639750003815, mae:0.22661560773849487
>>> MS_Pen LR=1e-4 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1457765
	speed: 0.0290s/iter; left time: 328.2372s
	iters: 200, epoch: 1 | loss: 0.1110508
	speed: 0.0163s/iter; left time: 183.1308s
	iters: 300, epoch: 1 | loss: 0.2388244
	speed: 0.0163s/iter; left time: 181.4585s
	iters: 400, epoch: 1 | loss: 0.1625246
	speed: 0.0164s/iter; left time: 180.3417s
	iters: 500, epoch: 1 | loss: 0.1005044
	speed: 0.0164s/iter; left time: 178.3712s
Epoch: 1 cost time: 10.647556781768799
Epoch: 1, Steps: 570 | Train Loss: 0.1838812 Vali Loss: 0.0364880 Test Loss: 0.1177152
Validation loss decreased (inf --> 0.036488).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1374238
	speed: 0.0510s/iter; left time: 546.8926s
	iters: 200, epoch: 2 | loss: 0.1097090
	speed: 0.0164s/iter; left time: 173.9489s
	iters: 300, epoch: 2 | loss: 0.2084001
	speed: 0.0163s/iter; left time: 172.0936s
	iters: 400, epoch: 2 | loss: 0.1567769
	speed: 0.0163s/iter; left time: 170.2886s
	iters: 500, epoch: 2 | loss: 0.1092150
	speed: 0.0163s/iter; left time: 168.5833s
Epoch: 2 cost time: 9.632511615753174
Epoch: 2, Steps: 570 | Train Loss: 0.1498022 Vali Loss: 0.0354864 Test Loss: 0.1201835
Validation loss decreased (0.036488 --> 0.035486).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1293895
	speed: 0.0502s/iter; left time: 509.8100s
	iters: 200, epoch: 3 | loss: 0.1330597
	speed: 0.0164s/iter; left time: 164.5385s
	iters: 300, epoch: 3 | loss: 0.1130346
	speed: 0.0163s/iter; left time: 162.8253s
	iters: 400, epoch: 3 | loss: 0.1633766
	speed: 0.0164s/iter; left time: 161.2595s
	iters: 500, epoch: 3 | loss: 0.0808550
	speed: 0.0163s/iter; left time: 159.5873s
Epoch: 3 cost time: 9.643749237060547
Epoch: 3, Steps: 570 | Train Loss: 0.1250458 Vali Loss: 0.0358144 Test Loss: 0.1199487
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1123863
	speed: 0.0503s/iter; left time: 482.0051s
	iters: 200, epoch: 4 | loss: 0.1866174
	speed: 0.0164s/iter; left time: 155.8860s
	iters: 300, epoch: 4 | loss: 0.0908457
	speed: 0.0164s/iter; left time: 154.4699s
	iters: 400, epoch: 4 | loss: 0.0780320
	speed: 0.0164s/iter; left time: 152.6083s
	iters: 500, epoch: 4 | loss: 0.1269267
	speed: 0.0164s/iter; left time: 151.0156s
Epoch: 4 cost time: 9.637597799301147
Epoch: 4, Steps: 570 | Train Loss: 0.1125631 Vali Loss: 0.0342854 Test Loss: 0.1181057
Validation loss decreased (0.035486 --> 0.034285).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1205504
	speed: 0.0517s/iter; left time: 465.9854s
	iters: 200, epoch: 5 | loss: 0.1210572
	speed: 0.0164s/iter; left time: 146.5337s
	iters: 300, epoch: 5 | loss: 0.0958991
	speed: 0.0164s/iter; left time: 144.8055s
	iters: 400, epoch: 5 | loss: 0.0617935
	speed: 0.0164s/iter; left time: 143.0009s
	iters: 500, epoch: 5 | loss: 0.1606844
	speed: 0.0164s/iter; left time: 141.4907s
Epoch: 5 cost time: 9.670121669769287
Epoch: 5, Steps: 570 | Train Loss: 0.1071090 Vali Loss: 0.0340993 Test Loss: 0.1179766
Validation loss decreased (0.034285 --> 0.034099).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0863379
	speed: 0.0521s/iter; left time: 440.2995s
	iters: 200, epoch: 6 | loss: 0.1315308
	speed: 0.0164s/iter; left time: 136.8264s
	iters: 300, epoch: 6 | loss: 0.1758305
	speed: 0.0168s/iter; left time: 138.2331s
	iters: 400, epoch: 6 | loss: 0.1109756
	speed: 0.0179s/iter; left time: 145.6071s
	iters: 500, epoch: 6 | loss: 0.1065161
	speed: 0.0179s/iter; left time: 144.0753s
Epoch: 6 cost time: 10.239678382873535
Epoch: 6, Steps: 570 | Train Loss: 0.1050622 Vali Loss: 0.0337256 Test Loss: 0.1180168
Validation loss decreased (0.034099 --> 0.033726).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1221880
	speed: 0.0508s/iter; left time: 400.4424s
	iters: 200, epoch: 7 | loss: 0.0828270
	speed: 0.0164s/iter; left time: 127.7221s
	iters: 300, epoch: 7 | loss: 0.0852905
	speed: 0.0164s/iter; left time: 126.2743s
	iters: 400, epoch: 7 | loss: 0.1506371
	speed: 0.0164s/iter; left time: 124.4143s
	iters: 500, epoch: 7 | loss: 0.0997524
	speed: 0.0164s/iter; left time: 123.0097s
Epoch: 7 cost time: 9.688403129577637
Epoch: 7, Steps: 570 | Train Loss: 0.1031182 Vali Loss: 0.0336959 Test Loss: 0.1182228
Validation loss decreased (0.033726 --> 0.033696).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0765104
	speed: 0.0532s/iter; left time: 388.9812s
	iters: 200, epoch: 8 | loss: 0.1310395
	speed: 0.0164s/iter; left time: 118.0752s
	iters: 300, epoch: 8 | loss: 0.1199249
	speed: 0.0164s/iter; left time: 116.3490s
	iters: 400, epoch: 8 | loss: 0.1224533
	speed: 0.0163s/iter; left time: 114.5613s
	iters: 500, epoch: 8 | loss: 0.0896620
	speed: 0.0163s/iter; left time: 112.9150s
Epoch: 8 cost time: 9.6114661693573
Epoch: 8, Steps: 570 | Train Loss: 0.1021852 Vali Loss: 0.0333899 Test Loss: 0.1173657
Validation loss decreased (0.033696 --> 0.033390).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0665213
	speed: 0.0503s/iter; left time: 339.3464s
	iters: 200, epoch: 9 | loss: 0.0997973
	speed: 0.0171s/iter; left time: 113.7872s
	iters: 300, epoch: 9 | loss: 0.0675504
	speed: 0.0174s/iter; left time: 113.6485s
	iters: 400, epoch: 9 | loss: 0.0864818
	speed: 0.0179s/iter; left time: 115.1777s
	iters: 500, epoch: 9 | loss: 0.0647076
	speed: 0.0173s/iter; left time: 109.9046s
Epoch: 9 cost time: 10.145217895507812
Epoch: 9, Steps: 570 | Train Loss: 0.1019672 Vali Loss: 0.0335647 Test Loss: 0.1176469
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1075697
	speed: 0.0521s/iter; left time: 321.4527s
	iters: 200, epoch: 10 | loss: 0.1211018
	speed: 0.0172s/iter; left time: 104.5915s
	iters: 300, epoch: 10 | loss: 0.0756093
	speed: 0.0178s/iter; left time: 106.2139s
	iters: 400, epoch: 10 | loss: 0.1128112
	speed: 0.0179s/iter; left time: 104.9982s
	iters: 500, epoch: 10 | loss: 0.0967188
	speed: 0.0179s/iter; left time: 103.1187s
Epoch: 10 cost time: 10.344836235046387
Epoch: 10, Steps: 570 | Train Loss: 0.1017881 Vali Loss: 0.0335375 Test Loss: 0.1174926
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0840154
	speed: 0.0529s/iter; left time: 296.3502s
	iters: 200, epoch: 11 | loss: 0.0801207
	speed: 0.0171s/iter; left time: 94.2935s
	iters: 300, epoch: 11 | loss: 0.0668135
	speed: 0.0171s/iter; left time: 92.2023s
	iters: 400, epoch: 11 | loss: 0.1411626
	speed: 0.0170s/iter; left time: 90.1500s
	iters: 500, epoch: 11 | loss: 0.0951679
	speed: 0.0170s/iter; left time: 88.5881s
Epoch: 11 cost time: 10.052781343460083
Epoch: 11, Steps: 570 | Train Loss: 0.1018135 Vali Loss: 0.0336458 Test Loss: 0.1176090
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11745975911617279, mae:0.20985695719718933
>>> MS_Pen LR=1e-4 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2393572
	speed: 0.0291s/iter; left time: 328.5679s
	iters: 200, epoch: 1 | loss: 0.1955507
	speed: 0.0171s/iter; left time: 191.5011s
	iters: 300, epoch: 1 | loss: 0.2232249
	speed: 0.0171s/iter; left time: 189.5164s
	iters: 400, epoch: 1 | loss: 0.2265007
	speed: 0.0171s/iter; left time: 188.5212s
	iters: 500, epoch: 1 | loss: 0.2863513
	speed: 0.0172s/iter; left time: 187.1376s
Epoch: 1 cost time: 10.997776746749878
Epoch: 1, Steps: 570 | Train Loss: 0.2152998 Vali Loss: 0.0421714 Test Loss: 0.1398644
Validation loss decreased (inf --> 0.042171).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2266680
	speed: 0.0497s/iter; left time: 533.4964s
	iters: 200, epoch: 2 | loss: 0.1171568
	speed: 0.0155s/iter; left time: 164.3278s
	iters: 300, epoch: 2 | loss: 0.1846932
	speed: 0.0155s/iter; left time: 162.7498s
	iters: 400, epoch: 2 | loss: 0.1464882
	speed: 0.0154s/iter; left time: 160.9968s
	iters: 500, epoch: 2 | loss: 0.2183311
	speed: 0.0154s/iter; left time: 159.1041s
Epoch: 2 cost time: 9.101191282272339
Epoch: 2, Steps: 570 | Train Loss: 0.1706190 Vali Loss: 0.0404426 Test Loss: 0.1398000
Validation loss decreased (0.042171 --> 0.040443).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1520367
	speed: 0.0489s/iter; left time: 497.0066s
	iters: 200, epoch: 3 | loss: 0.0829606
	speed: 0.0155s/iter; left time: 155.6238s
	iters: 300, epoch: 3 | loss: 0.1669784
	speed: 0.0154s/iter; left time: 153.8614s
	iters: 400, epoch: 3 | loss: 0.1566803
	speed: 0.0155s/iter; left time: 152.5998s
	iters: 500, epoch: 3 | loss: 0.1409288
	speed: 0.0154s/iter; left time: 150.7824s
Epoch: 3 cost time: 9.123961687088013
Epoch: 3, Steps: 570 | Train Loss: 0.1386917 Vali Loss: 0.0396511 Test Loss: 0.1357394
Validation loss decreased (0.040443 --> 0.039651).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0811226
	speed: 0.0485s/iter; left time: 465.2861s
	iters: 200, epoch: 4 | loss: 0.1589232
	speed: 0.0154s/iter; left time: 146.1509s
	iters: 300, epoch: 4 | loss: 0.1171547
	speed: 0.0155s/iter; left time: 145.1277s
	iters: 400, epoch: 4 | loss: 0.1237461
	speed: 0.0154s/iter; left time: 143.2084s
	iters: 500, epoch: 4 | loss: 0.1769572
	speed: 0.0154s/iter; left time: 141.8129s
Epoch: 4 cost time: 9.090030193328857
Epoch: 4, Steps: 570 | Train Loss: 0.1252711 Vali Loss: 0.0384861 Test Loss: 0.1379687
Validation loss decreased (0.039651 --> 0.038486).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1219404
	speed: 0.0499s/iter; left time: 450.4127s
	iters: 200, epoch: 5 | loss: 0.0992031
	speed: 0.0171s/iter; left time: 152.9796s
	iters: 300, epoch: 5 | loss: 0.0963818
	speed: 0.0171s/iter; left time: 151.1976s
	iters: 400, epoch: 5 | loss: 0.0881915
	speed: 0.0171s/iter; left time: 149.5304s
	iters: 500, epoch: 5 | loss: 0.1057450
	speed: 0.0171s/iter; left time: 147.7650s
Epoch: 5 cost time: 10.05929970741272
Epoch: 5, Steps: 570 | Train Loss: 0.1166612 Vali Loss: 0.0379240 Test Loss: 0.1404826
Validation loss decreased (0.038486 --> 0.037924).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0963903
	speed: 0.0486s/iter; left time: 410.5127s
	iters: 200, epoch: 6 | loss: 0.0803046
	speed: 0.0154s/iter; left time: 128.3819s
	iters: 300, epoch: 6 | loss: 0.0741577
	speed: 0.0154s/iter; left time: 126.9016s
	iters: 400, epoch: 6 | loss: 0.0937937
	speed: 0.0154s/iter; left time: 125.2786s
	iters: 500, epoch: 6 | loss: 0.0828899
	speed: 0.0154s/iter; left time: 123.7312s
Epoch: 6 cost time: 9.050459384918213
Epoch: 6, Steps: 570 | Train Loss: 0.1138483 Vali Loss: 0.0376433 Test Loss: 0.1388993
Validation loss decreased (0.037924 --> 0.037643).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1582919
	speed: 0.0476s/iter; left time: 374.7693s
	iters: 200, epoch: 7 | loss: 0.1001909
	speed: 0.0154s/iter; left time: 119.6241s
	iters: 300, epoch: 7 | loss: 0.1126123
	speed: 0.0154s/iter; left time: 118.3569s
	iters: 400, epoch: 7 | loss: 0.1460211
	speed: 0.0154s/iter; left time: 116.8768s
	iters: 500, epoch: 7 | loss: 0.1252745
	speed: 0.0154s/iter; left time: 115.3159s
Epoch: 7 cost time: 9.085551738739014
Epoch: 7, Steps: 570 | Train Loss: 0.1120534 Vali Loss: 0.0372465 Test Loss: 0.1374616
Validation loss decreased (0.037643 --> 0.037247).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0902953
	speed: 0.0516s/iter; left time: 377.3391s
	iters: 200, epoch: 8 | loss: 0.1302617
	speed: 0.0154s/iter; left time: 111.3629s
	iters: 300, epoch: 8 | loss: 0.0769310
	speed: 0.0154s/iter; left time: 109.7779s
	iters: 400, epoch: 8 | loss: 0.0969580
	speed: 0.0154s/iter; left time: 108.2246s
	iters: 500, epoch: 8 | loss: 0.0877051
	speed: 0.0154s/iter; left time: 106.6456s
Epoch: 8 cost time: 9.102996349334717
Epoch: 8, Steps: 570 | Train Loss: 0.1104168 Vali Loss: 0.0374715 Test Loss: 0.1388411
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0949324
	speed: 0.0470s/iter; left time: 316.8824s
	iters: 200, epoch: 9 | loss: 0.1010514
	speed: 0.0154s/iter; left time: 102.4946s
	iters: 300, epoch: 9 | loss: 0.1193262
	speed: 0.0154s/iter; left time: 101.0053s
	iters: 400, epoch: 9 | loss: 0.0933150
	speed: 0.0155s/iter; left time: 99.5571s
	iters: 500, epoch: 9 | loss: 0.1068653
	speed: 0.0154s/iter; left time: 97.9178s
Epoch: 9 cost time: 9.070514440536499
Epoch: 9, Steps: 570 | Train Loss: 0.1097265 Vali Loss: 0.0376096 Test Loss: 0.1388319
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1012376
	speed: 0.0475s/iter; left time: 293.1059s
	iters: 200, epoch: 10 | loss: 0.1180717
	speed: 0.0155s/iter; left time: 94.1428s
	iters: 300, epoch: 10 | loss: 0.0842037
	speed: 0.0155s/iter; left time: 92.5839s
	iters: 400, epoch: 10 | loss: 0.1335445
	speed: 0.0155s/iter; left time: 90.9279s
	iters: 500, epoch: 10 | loss: 0.1600326
	speed: 0.0155s/iter; left time: 89.5742s
Epoch: 10 cost time: 9.13353419303894
Epoch: 10, Steps: 570 | Train Loss: 0.1103737 Vali Loss: 0.0373350 Test Loss: 0.1386403
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1375918984413147, mae:0.23216581344604492
>>> MS_Pen LR=1e-4 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1385026
	speed: 0.0303s/iter; left time: 341.8567s
	iters: 200, epoch: 1 | loss: 0.1962137
	speed: 0.0187s/iter; left time: 209.0029s
	iters: 300, epoch: 1 | loss: 0.3123325
	speed: 0.0186s/iter; left time: 206.7884s
	iters: 400, epoch: 1 | loss: 0.1958548
	speed: 0.0186s/iter; left time: 205.1102s
	iters: 500, epoch: 1 | loss: 0.1570645
	speed: 0.0186s/iter; left time: 202.9410s
Epoch: 1 cost time: 11.834551572799683
Epoch: 1, Steps: 570 | Train Loss: 0.2128247 Vali Loss: 0.0421543 Test Loss: 0.1304111
Validation loss decreased (inf --> 0.042154).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2948731
	speed: 0.0614s/iter; left time: 658.6819s
	iters: 200, epoch: 2 | loss: 0.1862651
	speed: 0.0210s/iter; left time: 223.1233s
	iters: 300, epoch: 2 | loss: 0.1240194
	speed: 0.0209s/iter; left time: 220.3575s
	iters: 400, epoch: 2 | loss: 0.1255032
	speed: 0.0209s/iter; left time: 218.4562s
	iters: 500, epoch: 2 | loss: 0.1173063
	speed: 0.0209s/iter; left time: 216.2903s
Epoch: 2 cost time: 12.238929748535156
Epoch: 2, Steps: 570 | Train Loss: 0.1718849 Vali Loss: 0.0377689 Test Loss: 0.1246308
Validation loss decreased (0.042154 --> 0.037769).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1301201
	speed: 0.0583s/iter; left time: 592.6539s
	iters: 200, epoch: 3 | loss: 0.1177268
	speed: 0.0186s/iter; left time: 187.3984s
	iters: 300, epoch: 3 | loss: 0.1409768
	speed: 0.0186s/iter; left time: 185.5999s
	iters: 400, epoch: 3 | loss: 0.0969224
	speed: 0.0186s/iter; left time: 182.9827s
	iters: 500, epoch: 3 | loss: 0.1198318
	speed: 0.0186s/iter; left time: 181.3504s
Epoch: 3 cost time: 10.915815114974976
Epoch: 3, Steps: 570 | Train Loss: 0.1499705 Vali Loss: 0.0348692 Test Loss: 0.1233139
Validation loss decreased (0.037769 --> 0.034869).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1609536
	speed: 0.0564s/iter; left time: 540.8059s
	iters: 200, epoch: 4 | loss: 0.1874970
	speed: 0.0184s/iter; left time: 174.7507s
	iters: 300, epoch: 4 | loss: 0.1693788
	speed: 0.0185s/iter; left time: 173.4704s
	iters: 400, epoch: 4 | loss: 0.0898275
	speed: 0.0184s/iter; left time: 171.0691s
	iters: 500, epoch: 4 | loss: 0.1348532
	speed: 0.0184s/iter; left time: 169.1374s
Epoch: 4 cost time: 10.786842823028564
Epoch: 4, Steps: 570 | Train Loss: 0.1378591 Vali Loss: 0.0332432 Test Loss: 0.1224907
Validation loss decreased (0.034869 --> 0.033243).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1457817
	speed: 0.0579s/iter; left time: 521.9127s
	iters: 200, epoch: 5 | loss: 0.1355127
	speed: 0.0187s/iter; left time: 166.6198s
	iters: 300, epoch: 5 | loss: 0.1157258
	speed: 0.0187s/iter; left time: 164.6631s
	iters: 400, epoch: 5 | loss: 0.1101029
	speed: 0.0187s/iter; left time: 162.7704s
	iters: 500, epoch: 5 | loss: 0.1270041
	speed: 0.0186s/iter; left time: 160.7631s
Epoch: 5 cost time: 10.892334699630737
Epoch: 5, Steps: 570 | Train Loss: 0.1320563 Vali Loss: 0.0322951 Test Loss: 0.1206672
Validation loss decreased (0.033243 --> 0.032295).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0891818
	speed: 0.0584s/iter; left time: 493.9401s
	iters: 200, epoch: 6 | loss: 0.1325288
	speed: 0.0207s/iter; left time: 173.0804s
	iters: 300, epoch: 6 | loss: 0.0904494
	speed: 0.0196s/iter; left time: 161.3510s
	iters: 400, epoch: 6 | loss: 0.1694669
	speed: 0.0186s/iter; left time: 151.6168s
	iters: 500, epoch: 6 | loss: 0.1094081
	speed: 0.0186s/iter; left time: 149.6870s
Epoch: 6 cost time: 11.413783311843872
Epoch: 6, Steps: 570 | Train Loss: 0.1298414 Vali Loss: 0.0325479 Test Loss: 0.1221350
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1037429
	speed: 0.0557s/iter; left time: 438.6741s
	iters: 200, epoch: 7 | loss: 0.1396546
	speed: 0.0185s/iter; left time: 144.1650s
	iters: 300, epoch: 7 | loss: 0.1314868
	speed: 0.0185s/iter; left time: 142.2709s
	iters: 400, epoch: 7 | loss: 0.1380812
	speed: 0.0185s/iter; left time: 140.4816s
	iters: 500, epoch: 7 | loss: 0.1687829
	speed: 0.0185s/iter; left time: 138.5609s
Epoch: 7 cost time: 10.822044849395752
Epoch: 7, Steps: 570 | Train Loss: 0.1280091 Vali Loss: 0.0326431 Test Loss: 0.1212495
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1415954
	speed: 0.0560s/iter; left time: 409.3420s
	iters: 200, epoch: 8 | loss: 0.0857034
	speed: 0.0186s/iter; left time: 134.0630s
	iters: 300, epoch: 8 | loss: 0.0928476
	speed: 0.0186s/iter; left time: 132.1698s
	iters: 400, epoch: 8 | loss: 0.1457406
	speed: 0.0186s/iter; left time: 130.2931s
	iters: 500, epoch: 8 | loss: 0.0838024
	speed: 0.0186s/iter; left time: 128.3726s
Epoch: 8 cost time: 10.91257119178772
Epoch: 8, Steps: 570 | Train Loss: 0.1278468 Vali Loss: 0.0326289 Test Loss: 0.1212654
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12080337852239609, mae:0.21577446162700653
>>> MS_Pen LR=1e-4 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3890707
	speed: 0.0326s/iter; left time: 368.5913s
	iters: 200, epoch: 1 | loss: 0.2139102
	speed: 0.0211s/iter; left time: 236.0279s
	iters: 300, epoch: 1 | loss: 0.1799842
	speed: 0.0211s/iter; left time: 234.3706s
	iters: 400, epoch: 1 | loss: 0.1541648
	speed: 0.0211s/iter; left time: 231.9303s
	iters: 500, epoch: 1 | loss: 0.2364492
	speed: 0.0210s/iter; left time: 229.1491s
Epoch: 1 cost time: 13.216694593429565
Epoch: 1, Steps: 570 | Train Loss: 0.1868204 Vali Loss: 0.0372968 Test Loss: 0.1174619
Validation loss decreased (inf --> 0.037297).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1325908
	speed: 0.0627s/iter; left time: 672.6662s
	iters: 200, epoch: 2 | loss: 0.2068471
	speed: 0.0209s/iter; left time: 222.6876s
	iters: 300, epoch: 2 | loss: 0.2197770
	speed: 0.0209s/iter; left time: 220.1290s
	iters: 400, epoch: 2 | loss: 0.1267279
	speed: 0.0211s/iter; left time: 220.0743s
	iters: 500, epoch: 2 | loss: 0.1241779
	speed: 0.0186s/iter; left time: 192.0912s
Epoch: 2 cost time: 11.816207647323608
Epoch: 2, Steps: 570 | Train Loss: 0.1550327 Vali Loss: 0.0352326 Test Loss: 0.1180267
Validation loss decreased (0.037297 --> 0.035233).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1008717
	speed: 0.0552s/iter; left time: 560.3888s
	iters: 200, epoch: 3 | loss: 0.1296023
	speed: 0.0182s/iter; left time: 183.3315s
	iters: 300, epoch: 3 | loss: 0.1411125
	speed: 0.0182s/iter; left time: 181.1018s
	iters: 400, epoch: 3 | loss: 0.1185834
	speed: 0.0182s/iter; left time: 179.2675s
	iters: 500, epoch: 3 | loss: 0.0990048
	speed: 0.0182s/iter; left time: 177.3414s
Epoch: 3 cost time: 10.665604591369629
Epoch: 3, Steps: 570 | Train Loss: 0.1346693 Vali Loss: 0.0336478 Test Loss: 0.1156140
Validation loss decreased (0.035233 --> 0.033648).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1385020
	speed: 0.0562s/iter; left time: 538.9629s
	iters: 200, epoch: 4 | loss: 0.0729342
	speed: 0.0185s/iter; left time: 175.2399s
	iters: 300, epoch: 4 | loss: 0.1589977
	speed: 0.0182s/iter; left time: 171.0073s
	iters: 400, epoch: 4 | loss: 0.1237644
	speed: 0.0182s/iter; left time: 169.0333s
	iters: 500, epoch: 4 | loss: 0.0929675
	speed: 0.0182s/iter; left time: 167.4288s
Epoch: 4 cost time: 10.753885746002197
Epoch: 4, Steps: 570 | Train Loss: 0.1257566 Vali Loss: 0.0319830 Test Loss: 0.1163808
Validation loss decreased (0.033648 --> 0.031983).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0978067
	speed: 0.0580s/iter; left time: 523.3589s
	iters: 200, epoch: 5 | loss: 0.1204096
	speed: 0.0183s/iter; left time: 163.6348s
	iters: 300, epoch: 5 | loss: 0.1324210
	speed: 0.0185s/iter; left time: 162.8018s
	iters: 400, epoch: 5 | loss: 0.1051648
	speed: 0.0184s/iter; left time: 160.6052s
	iters: 500, epoch: 5 | loss: 0.1206928
	speed: 0.0182s/iter; left time: 157.1301s
Epoch: 5 cost time: 10.772433757781982
Epoch: 5, Steps: 570 | Train Loss: 0.1206911 Vali Loss: 0.0318310 Test Loss: 0.1171311
Validation loss decreased (0.031983 --> 0.031831).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1725441
	speed: 0.0562s/iter; left time: 474.6549s
	iters: 200, epoch: 6 | loss: 0.0982130
	speed: 0.0182s/iter; left time: 152.0145s
	iters: 300, epoch: 6 | loss: 0.1321680
	speed: 0.0182s/iter; left time: 150.0122s
	iters: 400, epoch: 6 | loss: 0.0859219
	speed: 0.0182s/iter; left time: 148.3897s
	iters: 500, epoch: 6 | loss: 0.0924303
	speed: 0.0182s/iter; left time: 146.3677s
Epoch: 6 cost time: 10.672214031219482
Epoch: 6, Steps: 570 | Train Loss: 0.1186694 Vali Loss: 0.0316087 Test Loss: 0.1165986
Validation loss decreased (0.031831 --> 0.031609).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1010384
	speed: 0.0589s/iter; left time: 464.3843s
	iters: 200, epoch: 7 | loss: 0.1352366
	speed: 0.0181s/iter; left time: 141.1110s
	iters: 300, epoch: 7 | loss: 0.0826680
	speed: 0.0181s/iter; left time: 139.2386s
	iters: 400, epoch: 7 | loss: 0.1395600
	speed: 0.0181s/iter; left time: 137.5348s
	iters: 500, epoch: 7 | loss: 0.1058752
	speed: 0.0181s/iter; left time: 135.7349s
Epoch: 7 cost time: 10.679495096206665
Epoch: 7, Steps: 570 | Train Loss: 0.1167928 Vali Loss: 0.0314220 Test Loss: 0.1166528
Validation loss decreased (0.031609 --> 0.031422).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0862569
	speed: 0.0559s/iter; left time: 408.7156s
	iters: 200, epoch: 8 | loss: 0.1089660
	speed: 0.0184s/iter; left time: 132.5885s
	iters: 300, epoch: 8 | loss: 0.1228676
	speed: 0.0184s/iter; left time: 130.5188s
	iters: 400, epoch: 8 | loss: 0.1111637
	speed: 0.0183s/iter; left time: 128.4961s
	iters: 500, epoch: 8 | loss: 0.1422344
	speed: 0.0182s/iter; left time: 125.5542s
Epoch: 8 cost time: 10.754264116287231
Epoch: 8, Steps: 570 | Train Loss: 0.1155415 Vali Loss: 0.0316702 Test Loss: 0.1168066
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0691579
	speed: 0.0561s/iter; left time: 378.0032s
	iters: 200, epoch: 9 | loss: 0.0966838
	speed: 0.0181s/iter; left time: 120.4308s
	iters: 300, epoch: 9 | loss: 0.1031955
	speed: 0.0182s/iter; left time: 118.7415s
	iters: 400, epoch: 9 | loss: 0.1079421
	speed: 0.0181s/iter; left time: 116.3729s
	iters: 500, epoch: 9 | loss: 0.0966186
	speed: 0.0181s/iter; left time: 114.9271s
Epoch: 9 cost time: 10.740561246871948
Epoch: 9, Steps: 570 | Train Loss: 0.1157532 Vali Loss: 0.0316783 Test Loss: 0.1169542
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0858019
	speed: 0.0555s/iter; left time: 342.3998s
	iters: 200, epoch: 10 | loss: 0.0991035
	speed: 0.0184s/iter; left time: 111.8539s
	iters: 300, epoch: 10 | loss: 0.1578841
	speed: 0.0184s/iter; left time: 109.8602s
	iters: 400, epoch: 10 | loss: 0.1191535
	speed: 0.0184s/iter; left time: 108.0336s
	iters: 500, epoch: 10 | loss: 0.1273192
	speed: 0.0184s/iter; left time: 106.1600s
Epoch: 10 cost time: 10.794877767562866
Epoch: 10, Steps: 570 | Train Loss: 0.1162784 Vali Loss: 0.0315078 Test Loss: 0.1168714
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11676332354545593, mae:0.20764006674289703
>>> MS_Pen LR=1e-4 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2423522
	speed: 0.0318s/iter; left time: 359.6636s
	iters: 200, epoch: 1 | loss: 0.1940999
	speed: 0.0184s/iter; left time: 205.8979s
	iters: 300, epoch: 1 | loss: 0.2068110
	speed: 0.0184s/iter; left time: 203.7176s
	iters: 400, epoch: 1 | loss: 0.2215079
	speed: 0.0184s/iter; left time: 202.4392s
	iters: 500, epoch: 1 | loss: 0.2652158
	speed: 0.0184s/iter; left time: 200.5125s
Epoch: 1 cost time: 11.886036157608032
Epoch: 1, Steps: 570 | Train Loss: 0.2195069 Vali Loss: 0.0425372 Test Loss: 0.1365859
Validation loss decreased (inf --> 0.042537).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2392954
	speed: 0.0589s/iter; left time: 632.2139s
	iters: 200, epoch: 2 | loss: 0.1883339
	speed: 0.0193s/iter; left time: 204.7927s
	iters: 300, epoch: 2 | loss: 0.3297684
	speed: 0.0183s/iter; left time: 193.1232s
	iters: 400, epoch: 2 | loss: 0.1303896
	speed: 0.0183s/iter; left time: 190.6999s
	iters: 500, epoch: 2 | loss: 0.0862147
	speed: 0.0183s/iter; left time: 188.9265s
Epoch: 2 cost time: 11.103140354156494
Epoch: 2, Steps: 570 | Train Loss: 0.1776681 Vali Loss: 0.0422944 Test Loss: 0.1346059
Validation loss decreased (0.042537 --> 0.042294).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1187107
	speed: 0.0569s/iter; left time: 578.5483s
	iters: 200, epoch: 3 | loss: 0.1709137
	speed: 0.0182s/iter; left time: 182.6483s
	iters: 300, epoch: 3 | loss: 0.1647947
	speed: 0.0182s/iter; left time: 181.2237s
	iters: 400, epoch: 3 | loss: 0.1867220
	speed: 0.0182s/iter; left time: 179.9621s
	iters: 500, epoch: 3 | loss: 0.1463745
	speed: 0.0183s/iter; left time: 178.3600s
Epoch: 3 cost time: 10.678241729736328
Epoch: 3, Steps: 570 | Train Loss: 0.1536777 Vali Loss: 0.0388599 Test Loss: 0.1328510
Validation loss decreased (0.042294 --> 0.038860).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1309397
	speed: 0.0586s/iter; left time: 561.9174s
	iters: 200, epoch: 4 | loss: 0.1556724
	speed: 0.0184s/iter; left time: 174.3577s
	iters: 300, epoch: 4 | loss: 0.1385663
	speed: 0.0183s/iter; left time: 171.5706s
	iters: 400, epoch: 4 | loss: 0.1561676
	speed: 0.0183s/iter; left time: 169.9239s
	iters: 500, epoch: 4 | loss: 0.0986360
	speed: 0.0183s/iter; left time: 167.8735s
Epoch: 4 cost time: 10.700028419494629
Epoch: 4, Steps: 570 | Train Loss: 0.1423238 Vali Loss: 0.0373563 Test Loss: 0.1324054
Validation loss decreased (0.038860 --> 0.037356).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0978430
	speed: 0.0552s/iter; left time: 497.7092s
	iters: 200, epoch: 5 | loss: 0.1299503
	speed: 0.0182s/iter; left time: 162.8012s
	iters: 300, epoch: 5 | loss: 0.0952206
	speed: 0.0182s/iter; left time: 160.9127s
	iters: 400, epoch: 5 | loss: 0.1180223
	speed: 0.0183s/iter; left time: 159.1660s
	iters: 500, epoch: 5 | loss: 0.0906136
	speed: 0.0182s/iter; left time: 157.1543s
Epoch: 5 cost time: 10.697081804275513
Epoch: 5, Steps: 570 | Train Loss: 0.1356935 Vali Loss: 0.0371362 Test Loss: 0.1343062
Validation loss decreased (0.037356 --> 0.037136).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1631973
	speed: 0.0559s/iter; left time: 472.6836s
	iters: 200, epoch: 6 | loss: 0.1022429
	speed: 0.0181s/iter; left time: 151.3779s
	iters: 300, epoch: 6 | loss: 0.2228241
	speed: 0.0182s/iter; left time: 149.8011s
	iters: 400, epoch: 6 | loss: 0.1116616
	speed: 0.0181s/iter; left time: 147.6850s
	iters: 500, epoch: 6 | loss: 0.1364310
	speed: 0.0182s/iter; left time: 146.1349s
Epoch: 6 cost time: 10.613104581832886
Epoch: 6, Steps: 570 | Train Loss: 0.1327554 Vali Loss: 0.0366564 Test Loss: 0.1343832
Validation loss decreased (0.037136 --> 0.036656).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1096163
	speed: 0.0551s/iter; left time: 434.2433s
	iters: 200, epoch: 7 | loss: 0.1022783
	speed: 0.0182s/iter; left time: 141.6133s
	iters: 300, epoch: 7 | loss: 0.1613372
	speed: 0.0182s/iter; left time: 139.6892s
	iters: 400, epoch: 7 | loss: 0.1327796
	speed: 0.0182s/iter; left time: 137.9656s
	iters: 500, epoch: 7 | loss: 0.0974869
	speed: 0.0182s/iter; left time: 135.9520s
Epoch: 7 cost time: 10.667569637298584
Epoch: 7, Steps: 570 | Train Loss: 0.1328351 Vali Loss: 0.0366790 Test Loss: 0.1328914
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1241510
	speed: 0.0549s/iter; left time: 401.1536s
	iters: 200, epoch: 8 | loss: 0.0761839
	speed: 0.0182s/iter; left time: 131.5775s
	iters: 300, epoch: 8 | loss: 0.1373439
	speed: 0.0182s/iter; left time: 129.5340s
	iters: 400, epoch: 8 | loss: 0.1468769
	speed: 0.0182s/iter; left time: 127.6931s
	iters: 500, epoch: 8 | loss: 0.0973766
	speed: 0.0182s/iter; left time: 125.7891s
Epoch: 8 cost time: 10.667449474334717
Epoch: 8, Steps: 570 | Train Loss: 0.1315898 Vali Loss: 0.0364758 Test Loss: 0.1339330
Validation loss decreased (0.036656 --> 0.036476).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1375613
	speed: 0.0558s/iter; left time: 375.9588s
	iters: 200, epoch: 9 | loss: 0.2069532
	speed: 0.0181s/iter; left time: 120.4876s
	iters: 300, epoch: 9 | loss: 0.1907695
	speed: 0.0181s/iter; left time: 118.5535s
	iters: 400, epoch: 9 | loss: 0.2127204
	speed: 0.0181s/iter; left time: 116.8107s
	iters: 500, epoch: 9 | loss: 0.0913151
	speed: 0.0181s/iter; left time: 115.0216s
Epoch: 9 cost time: 10.653714418411255
Epoch: 9, Steps: 570 | Train Loss: 0.1313920 Vali Loss: 0.0365733 Test Loss: 0.1336125
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1375226
	speed: 0.0585s/iter; left time: 361.1990s
	iters: 200, epoch: 10 | loss: 0.1297317
	speed: 0.0200s/iter; left time: 121.4960s
	iters: 300, epoch: 10 | loss: 0.1278174
	speed: 0.0204s/iter; left time: 122.0916s
	iters: 400, epoch: 10 | loss: 0.1307207
	speed: 0.0204s/iter; left time: 120.0444s
	iters: 500, epoch: 10 | loss: 0.1533994
	speed: 0.0204s/iter; left time: 117.9194s
Epoch: 10 cost time: 11.894281148910522
Epoch: 10, Steps: 570 | Train Loss: 0.1309924 Vali Loss: 0.0363132 Test Loss: 0.1333555
Validation loss decreased (0.036476 --> 0.036313).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1255172
	speed: 0.0587s/iter; left time: 328.6155s
	iters: 200, epoch: 11 | loss: 0.1223106
	speed: 0.0183s/iter; left time: 100.5781s
	iters: 300, epoch: 11 | loss: 0.1267031
	speed: 0.0183s/iter; left time: 98.7571s
	iters: 400, epoch: 11 | loss: 0.1381189
	speed: 0.0183s/iter; left time: 96.9191s
	iters: 500, epoch: 11 | loss: 0.0987235
	speed: 0.0183s/iter; left time: 95.0333s
Epoch: 11 cost time: 10.721033096313477
Epoch: 11, Steps: 570 | Train Loss: 0.1321435 Vali Loss: 0.0363800 Test Loss: 0.1333587
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1120218
	speed: 0.0549s/iter; left time: 276.2604s
	iters: 200, epoch: 12 | loss: 0.1484503
	speed: 0.0181s/iter; left time: 89.3359s
	iters: 300, epoch: 12 | loss: 0.1304210
	speed: 0.0181s/iter; left time: 87.4018s
	iters: 400, epoch: 12 | loss: 0.1104783
	speed: 0.0180s/iter; left time: 85.3913s
	iters: 500, epoch: 12 | loss: 0.1673468
	speed: 0.0180s/iter; left time: 83.5512s
Epoch: 12 cost time: 10.586308717727661
Epoch: 12, Steps: 570 | Train Loss: 0.1311524 Vali Loss: 0.0363825 Test Loss: 0.1334142
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1114821
	speed: 0.0540s/iter; left time: 241.0016s
	iters: 200, epoch: 13 | loss: 0.0784831
	speed: 0.0181s/iter; left time: 78.8903s
	iters: 300, epoch: 13 | loss: 0.0981291
	speed: 0.0180s/iter; left time: 76.7600s
	iters: 400, epoch: 13 | loss: 0.1009900
	speed: 0.0180s/iter; left time: 75.0787s
	iters: 500, epoch: 13 | loss: 0.0967172
	speed: 0.0180s/iter; left time: 73.2969s
Epoch: 13 cost time: 10.549890518188477
Epoch: 13, Steps: 570 | Train Loss: 0.1307351 Vali Loss: 0.0365456 Test Loss: 0.1334079
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13349568843841553, mae:0.22991561889648438
>>> MS_Pen LR=1e-4 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1935015
	speed: 0.0360s/iter; left time: 407.0101s
	iters: 200, epoch: 1 | loss: 0.1615050
	speed: 0.0235s/iter; left time: 263.5009s
	iters: 300, epoch: 1 | loss: 0.1437842
	speed: 0.0223s/iter; left time: 247.4425s
	iters: 400, epoch: 1 | loss: 0.3219585
	speed: 0.0221s/iter; left time: 242.8333s
	iters: 500, epoch: 1 | loss: 0.1887728
	speed: 0.0220s/iter; left time: 240.2443s
Epoch: 1 cost time: 14.193596601486206
Epoch: 1, Steps: 570 | Train Loss: 0.2098281 Vali Loss: 0.0405719 Test Loss: 0.1281312
Validation loss decreased (inf --> 0.040572).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2003193
	speed: 0.0642s/iter; left time: 688.9280s
	iters: 200, epoch: 2 | loss: 0.1153831
	speed: 0.0221s/iter; left time: 235.0266s
	iters: 300, epoch: 2 | loss: 0.1270728
	speed: 0.0221s/iter; left time: 232.8565s
	iters: 400, epoch: 2 | loss: 0.1490932
	speed: 0.0221s/iter; left time: 230.3412s
	iters: 500, epoch: 2 | loss: 0.1334175
	speed: 0.0221s/iter; left time: 228.1489s
Epoch: 2 cost time: 12.948786497116089
Epoch: 2, Steps: 570 | Train Loss: 0.1614439 Vali Loss: 0.0399475 Test Loss: 0.1321717
Validation loss decreased (0.040572 --> 0.039948).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2730147
	speed: 0.0669s/iter; left time: 679.3415s
	iters: 200, epoch: 3 | loss: 0.1100784
	speed: 0.0239s/iter; left time: 240.4850s
	iters: 300, epoch: 3 | loss: 0.1766683
	speed: 0.0240s/iter; left time: 239.0057s
	iters: 400, epoch: 3 | loss: 0.1073579
	speed: 0.0239s/iter; left time: 235.9438s
	iters: 500, epoch: 3 | loss: 0.1078520
	speed: 0.0233s/iter; left time: 227.8169s
Epoch: 3 cost time: 13.777413368225098
Epoch: 3, Steps: 570 | Train Loss: 0.1306527 Vali Loss: 0.0345240 Test Loss: 0.1273529
Validation loss decreased (0.039948 --> 0.034524).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0982525
	speed: 0.0651s/iter; left time: 623.9791s
	iters: 200, epoch: 4 | loss: 0.0802918
	speed: 0.0221s/iter; left time: 209.6765s
	iters: 300, epoch: 4 | loss: 0.1080945
	speed: 0.0221s/iter; left time: 207.2951s
	iters: 400, epoch: 4 | loss: 0.0839103
	speed: 0.0221s/iter; left time: 205.1880s
	iters: 500, epoch: 4 | loss: 0.1486338
	speed: 0.0221s/iter; left time: 202.9661s
Epoch: 4 cost time: 12.92743992805481
Epoch: 4, Steps: 570 | Train Loss: 0.1148943 Vali Loss: 0.0361125 Test Loss: 0.1292832
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1366803
	speed: 0.0646s/iter; left time: 582.6819s
	iters: 200, epoch: 5 | loss: 0.1162823
	speed: 0.0239s/iter; left time: 213.2683s
	iters: 300, epoch: 5 | loss: 0.0742189
	speed: 0.0239s/iter; left time: 210.9951s
	iters: 400, epoch: 5 | loss: 0.0967542
	speed: 0.0232s/iter; left time: 202.0063s
	iters: 500, epoch: 5 | loss: 0.1168083
	speed: 0.0221s/iter; left time: 190.5877s
Epoch: 5 cost time: 13.55530309677124
Epoch: 5, Steps: 570 | Train Loss: 0.1074624 Vali Loss: 0.0349642 Test Loss: 0.1288708
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0910299
	speed: 0.0633s/iter; left time: 535.0814s
	iters: 200, epoch: 6 | loss: 0.1279198
	speed: 0.0220s/iter; left time: 184.1120s
	iters: 300, epoch: 6 | loss: 0.0822738
	speed: 0.0220s/iter; left time: 181.5368s
	iters: 400, epoch: 6 | loss: 0.0754240
	speed: 0.0220s/iter; left time: 179.3102s
	iters: 500, epoch: 6 | loss: 0.1546401
	speed: 0.0220s/iter; left time: 177.5128s
Epoch: 6 cost time: 12.871006727218628
Epoch: 6, Steps: 570 | Train Loss: 0.1043855 Vali Loss: 0.0360163 Test Loss: 0.1280229
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1274235099554062, mae:0.22337286174297333
>>> MS_Pen LR=1e-4 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1794553
	speed: 0.0351s/iter; left time: 396.7502s
	iters: 200, epoch: 1 | loss: 0.0991130
	speed: 0.0232s/iter; left time: 259.3165s
	iters: 300, epoch: 1 | loss: 0.1501463
	speed: 0.0211s/iter; left time: 234.7773s
	iters: 400, epoch: 1 | loss: 0.1483267
	speed: 0.0212s/iter; left time: 232.7597s
	iters: 500, epoch: 1 | loss: 0.2019386
	speed: 0.0212s/iter; left time: 230.7042s
Epoch: 1 cost time: 13.70940113067627
Epoch: 1, Steps: 570 | Train Loss: 0.1832345 Vali Loss: 0.0382645 Test Loss: 0.1218702
Validation loss decreased (inf --> 0.038264).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1270107
	speed: 0.0645s/iter; left time: 692.2984s
	iters: 200, epoch: 2 | loss: 0.1236528
	speed: 0.0232s/iter; left time: 246.9227s
	iters: 300, epoch: 2 | loss: 0.1513362
	speed: 0.0232s/iter; left time: 244.4828s
	iters: 400, epoch: 2 | loss: 0.1343760
	speed: 0.0232s/iter; left time: 242.1361s
	iters: 500, epoch: 2 | loss: 0.0973379
	speed: 0.0232s/iter; left time: 239.7803s
Epoch: 2 cost time: 13.559107065200806
Epoch: 2, Steps: 570 | Train Loss: 0.1471267 Vali Loss: 0.0340399 Test Loss: 0.1151066
Validation loss decreased (0.038264 --> 0.034040).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1287649
	speed: 0.0625s/iter; left time: 634.9139s
	iters: 200, epoch: 3 | loss: 0.1124745
	speed: 0.0212s/iter; left time: 213.0598s
	iters: 300, epoch: 3 | loss: 0.1047327
	speed: 0.0212s/iter; left time: 210.9309s
	iters: 400, epoch: 3 | loss: 0.1006192
	speed: 0.0212s/iter; left time: 208.7904s
	iters: 500, epoch: 3 | loss: 0.1099817
	speed: 0.0212s/iter; left time: 206.6291s
Epoch: 3 cost time: 12.398142576217651
Epoch: 3, Steps: 570 | Train Loss: 0.1204240 Vali Loss: 0.0326374 Test Loss: 0.1243668
Validation loss decreased (0.034040 --> 0.032637).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0807417
	speed: 0.0626s/iter; left time: 600.6196s
	iters: 200, epoch: 4 | loss: 0.1219675
	speed: 0.0214s/iter; left time: 202.9919s
	iters: 300, epoch: 4 | loss: 0.1140322
	speed: 0.0214s/iter; left time: 201.2368s
	iters: 400, epoch: 4 | loss: 0.1341527
	speed: 0.0214s/iter; left time: 198.9401s
	iters: 500, epoch: 4 | loss: 0.1064849
	speed: 0.0214s/iter; left time: 196.9245s
Epoch: 4 cost time: 12.496634721755981
Epoch: 4, Steps: 570 | Train Loss: 0.1075322 Vali Loss: 0.0316346 Test Loss: 0.1206396
Validation loss decreased (0.032637 --> 0.031635).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1293421
	speed: 0.0610s/iter; left time: 550.2239s
	iters: 200, epoch: 5 | loss: 0.0861866
	speed: 0.0212s/iter; left time: 188.9193s
	iters: 300, epoch: 5 | loss: 0.0868311
	speed: 0.0212s/iter; left time: 186.8444s
	iters: 400, epoch: 5 | loss: 0.1459596
	speed: 0.0212s/iter; left time: 184.8200s
	iters: 500, epoch: 5 | loss: 0.0870237
	speed: 0.0212s/iter; left time: 182.6162s
Epoch: 5 cost time: 12.389139652252197
Epoch: 5, Steps: 570 | Train Loss: 0.1017629 Vali Loss: 0.0320077 Test Loss: 0.1193133
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0804973
	speed: 0.0600s/iter; left time: 506.9846s
	iters: 200, epoch: 6 | loss: 0.1354633
	speed: 0.0212s/iter; left time: 177.3690s
	iters: 300, epoch: 6 | loss: 0.1326325
	speed: 0.0212s/iter; left time: 175.2846s
	iters: 400, epoch: 6 | loss: 0.0755219
	speed: 0.0213s/iter; left time: 173.2583s
	iters: 500, epoch: 6 | loss: 0.0843149
	speed: 0.0213s/iter; left time: 171.0927s
Epoch: 6 cost time: 12.367376804351807
Epoch: 6, Steps: 570 | Train Loss: 0.0974446 Vali Loss: 0.0315336 Test Loss: 0.1199100
Validation loss decreased (0.031635 --> 0.031534).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0703462
	speed: 0.0627s/iter; left time: 494.2972s
	iters: 200, epoch: 7 | loss: 0.1323630
	speed: 0.0213s/iter; left time: 165.8435s
	iters: 300, epoch: 7 | loss: 0.1051507
	speed: 0.0213s/iter; left time: 163.9369s
	iters: 400, epoch: 7 | loss: 0.0661702
	speed: 0.0213s/iter; left time: 161.6373s
	iters: 500, epoch: 7 | loss: 0.1184420
	speed: 0.0213s/iter; left time: 159.4281s
Epoch: 7 cost time: 12.45336127281189
Epoch: 7, Steps: 570 | Train Loss: 0.0960019 Vali Loss: 0.0317164 Test Loss: 0.1203837
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0855569
	speed: 0.0634s/iter; left time: 463.4406s
	iters: 200, epoch: 8 | loss: 0.1024887
	speed: 0.0233s/iter; left time: 168.0367s
	iters: 300, epoch: 8 | loss: 0.1040092
	speed: 0.0232s/iter; left time: 165.3293s
	iters: 400, epoch: 8 | loss: 0.0778671
	speed: 0.0223s/iter; left time: 156.4074s
	iters: 500, epoch: 8 | loss: 0.1582085
	speed: 0.0214s/iter; left time: 147.6099s
Epoch: 8 cost time: 13.100957870483398
Epoch: 8, Steps: 570 | Train Loss: 0.0955101 Vali Loss: 0.0314446 Test Loss: 0.1198766
Validation loss decreased (0.031534 --> 0.031445).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0891067
	speed: 0.0612s/iter; left time: 412.8349s
	iters: 200, epoch: 9 | loss: 0.1288179
	speed: 0.0214s/iter; left time: 141.8974s
	iters: 300, epoch: 9 | loss: 0.1057607
	speed: 0.0214s/iter; left time: 139.7726s
	iters: 400, epoch: 9 | loss: 0.0772616
	speed: 0.0214s/iter; left time: 137.7005s
	iters: 500, epoch: 9 | loss: 0.0637201
	speed: 0.0214s/iter; left time: 135.4811s
Epoch: 9 cost time: 12.498798608779907
Epoch: 9, Steps: 570 | Train Loss: 0.0958658 Vali Loss: 0.0314549 Test Loss: 0.1196141
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0781241
	speed: 0.0606s/iter; left time: 373.8308s
	iters: 200, epoch: 10 | loss: 0.0899503
	speed: 0.0214s/iter; left time: 129.7826s
	iters: 300, epoch: 10 | loss: 0.0791550
	speed: 0.0214s/iter; left time: 127.5995s
	iters: 400, epoch: 10 | loss: 0.0910800
	speed: 0.0214s/iter; left time: 125.5013s
	iters: 500, epoch: 10 | loss: 0.1240392
	speed: 0.0214s/iter; left time: 123.2956s
Epoch: 10 cost time: 12.441567659378052
Epoch: 10, Steps: 570 | Train Loss: 0.0940400 Vali Loss: 0.0314536 Test Loss: 0.1196064
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0941907
	speed: 0.0624s/iter; left time: 349.5545s
	iters: 200, epoch: 11 | loss: 0.0942995
	speed: 0.0213s/iter; left time: 117.2076s
	iters: 300, epoch: 11 | loss: 0.0838516
	speed: 0.0213s/iter; left time: 114.9931s
	iters: 400, epoch: 11 | loss: 0.0653654
	speed: 0.0213s/iter; left time: 112.9183s
	iters: 500, epoch: 11 | loss: 0.1378787
	speed: 0.0213s/iter; left time: 110.6360s
Epoch: 11 cost time: 12.400267124176025
Epoch: 11, Steps: 570 | Train Loss: 0.0950016 Vali Loss: 0.0313516 Test Loss: 0.1197194
Validation loss decreased (0.031445 --> 0.031352).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0950374
	speed: 0.0645s/iter; left time: 324.3042s
	iters: 200, epoch: 12 | loss: 0.0937397
	speed: 0.0232s/iter; left time: 114.4411s
	iters: 300, epoch: 12 | loss: 0.0814501
	speed: 0.0232s/iter; left time: 112.1377s
	iters: 400, epoch: 12 | loss: 0.1472041
	speed: 0.0232s/iter; left time: 109.8425s
	iters: 500, epoch: 12 | loss: 0.0994194
	speed: 0.0232s/iter; left time: 107.6212s
Epoch: 12 cost time: 13.529521942138672
Epoch: 12, Steps: 570 | Train Loss: 0.0936385 Vali Loss: 0.0314046 Test Loss: 0.1197232
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0692728
	speed: 0.0611s/iter; left time: 272.4184s
	iters: 200, epoch: 13 | loss: 0.1043236
	speed: 0.0213s/iter; left time: 92.7051s
	iters: 300, epoch: 13 | loss: 0.1457656
	speed: 0.0213s/iter; left time: 90.5870s
	iters: 400, epoch: 13 | loss: 0.0967904
	speed: 0.0213s/iter; left time: 88.5024s
	iters: 500, epoch: 13 | loss: 0.0928489
	speed: 0.0213s/iter; left time: 86.3628s
Epoch: 13 cost time: 12.398014783859253
Epoch: 13, Steps: 570 | Train Loss: 0.0946243 Vali Loss: 0.0314924 Test Loss: 0.1197113
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0994478
	speed: 0.0607s/iter; left time: 236.0791s
	iters: 200, epoch: 14 | loss: 0.0777617
	speed: 0.0213s/iter; left time: 80.8287s
	iters: 300, epoch: 14 | loss: 0.0749811
	speed: 0.0213s/iter; left time: 78.4836s
	iters: 400, epoch: 14 | loss: 0.0823463
	speed: 0.0213s/iter; left time: 76.3328s
	iters: 500, epoch: 14 | loss: 0.1061826
	speed: 0.0213s/iter; left time: 74.2124s
Epoch: 14 cost time: 12.402333736419678
Epoch: 14, Steps: 570 | Train Loss: 0.0938739 Vali Loss: 0.0314433 Test Loss: 0.1197093
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11981584131717682, mae:0.21027611196041107
>>> MS_Pen LR=1e-4 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2212173
	speed: 0.0321s/iter; left time: 363.2867s
	iters: 200, epoch: 1 | loss: 0.1934050
	speed: 0.0201s/iter; left time: 225.5611s
	iters: 300, epoch: 1 | loss: 0.2104703
	speed: 0.0201s/iter; left time: 223.5977s
	iters: 400, epoch: 1 | loss: 0.2010485
	speed: 0.0201s/iter; left time: 221.5922s
	iters: 500, epoch: 1 | loss: 0.2068369
	speed: 0.0201s/iter; left time: 219.5115s
Epoch: 1 cost time: 12.738824129104614
Epoch: 1, Steps: 570 | Train Loss: 0.2096219 Vali Loss: 0.0412779 Test Loss: 0.1351170
Validation loss decreased (inf --> 0.041278).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1089778
	speed: 0.0609s/iter; left time: 653.4113s
	iters: 200, epoch: 2 | loss: 0.2361680
	speed: 0.0201s/iter; left time: 213.5236s
	iters: 300, epoch: 2 | loss: 0.1316614
	speed: 0.0200s/iter; left time: 211.0411s
	iters: 400, epoch: 2 | loss: 0.1278995
	speed: 0.0200s/iter; left time: 209.0670s
	iters: 500, epoch: 2 | loss: 0.1177337
	speed: 0.0201s/iter; left time: 207.4071s
Epoch: 2 cost time: 11.771202802658081
Epoch: 2, Steps: 570 | Train Loss: 0.1652078 Vali Loss: 0.0399364 Test Loss: 0.1366699
Validation loss decreased (0.041278 --> 0.039936).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0938482
	speed: 0.0592s/iter; left time: 601.2954s
	iters: 200, epoch: 3 | loss: 0.1106338
	speed: 0.0200s/iter; left time: 201.5830s
	iters: 300, epoch: 3 | loss: 0.1143470
	speed: 0.0200s/iter; left time: 199.3608s
	iters: 400, epoch: 3 | loss: 0.1228005
	speed: 0.0200s/iter; left time: 197.4444s
	iters: 500, epoch: 3 | loss: 0.1178487
	speed: 0.0200s/iter; left time: 195.2045s
Epoch: 3 cost time: 11.700014114379883
Epoch: 3, Steps: 570 | Train Loss: 0.1328535 Vali Loss: 0.0381823 Test Loss: 0.1392014
Validation loss decreased (0.039936 --> 0.038182).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0690930
	speed: 0.0608s/iter; left time: 583.4717s
	iters: 200, epoch: 4 | loss: 0.1500000
	speed: 0.0200s/iter; left time: 189.6553s
	iters: 300, epoch: 4 | loss: 0.0981132
	speed: 0.0200s/iter; left time: 187.6109s
	iters: 400, epoch: 4 | loss: 0.1305449
	speed: 0.0200s/iter; left time: 185.5788s
	iters: 500, epoch: 4 | loss: 0.0704479
	speed: 0.0200s/iter; left time: 183.5144s
Epoch: 4 cost time: 11.667773962020874
Epoch: 4, Steps: 570 | Train Loss: 0.1185366 Vali Loss: 0.0368938 Test Loss: 0.1369881
Validation loss decreased (0.038182 --> 0.036894).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1221409
	speed: 0.0591s/iter; left time: 533.3784s
	iters: 200, epoch: 5 | loss: 0.0960109
	speed: 0.0201s/iter; left time: 179.5423s
	iters: 300, epoch: 5 | loss: 0.1480011
	speed: 0.0201s/iter; left time: 177.5797s
	iters: 400, epoch: 5 | loss: 0.1079844
	speed: 0.0202s/iter; left time: 175.8930s
	iters: 500, epoch: 5 | loss: 0.1054625
	speed: 0.0202s/iter; left time: 173.9841s
Epoch: 5 cost time: 11.79914402961731
Epoch: 5, Steps: 570 | Train Loss: 0.1099128 Vali Loss: 0.0364596 Test Loss: 0.1396770
Validation loss decreased (0.036894 --> 0.036460).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1188458
	speed: 0.0622s/iter; left time: 525.7900s
	iters: 200, epoch: 6 | loss: 0.1008324
	speed: 0.0201s/iter; left time: 168.0292s
	iters: 300, epoch: 6 | loss: 0.0811815
	speed: 0.0201s/iter; left time: 166.0618s
	iters: 400, epoch: 6 | loss: 0.0722313
	speed: 0.0201s/iter; left time: 164.0461s
	iters: 500, epoch: 6 | loss: 0.1554471
	speed: 0.0201s/iter; left time: 161.8811s
Epoch: 6 cost time: 11.756945848464966
Epoch: 6, Steps: 570 | Train Loss: 0.1059797 Vali Loss: 0.0362395 Test Loss: 0.1399744
Validation loss decreased (0.036460 --> 0.036239).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1292309
	speed: 0.0588s/iter; left time: 463.5389s
	iters: 200, epoch: 7 | loss: 0.1103479
	speed: 0.0200s/iter; left time: 155.9554s
	iters: 300, epoch: 7 | loss: 0.1252616
	speed: 0.0201s/iter; left time: 154.0312s
	iters: 400, epoch: 7 | loss: 0.1014493
	speed: 0.0200s/iter; left time: 151.8574s
	iters: 500, epoch: 7 | loss: 0.0679872
	speed: 0.0200s/iter; left time: 149.7167s
Epoch: 7 cost time: 11.68971848487854
Epoch: 7, Steps: 570 | Train Loss: 0.1048527 Vali Loss: 0.0362908 Test Loss: 0.1400698
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1269005
	speed: 0.0633s/iter; left time: 462.4490s
	iters: 200, epoch: 8 | loss: 0.1447410
	speed: 0.0222s/iter; left time: 160.1017s
	iters: 300, epoch: 8 | loss: 0.1175542
	speed: 0.0222s/iter; left time: 157.8196s
	iters: 400, epoch: 8 | loss: 0.0702553
	speed: 0.0221s/iter; left time: 155.0664s
	iters: 500, epoch: 8 | loss: 0.1197829
	speed: 0.0221s/iter; left time: 152.8243s
Epoch: 8 cost time: 12.907356023788452
Epoch: 8, Steps: 570 | Train Loss: 0.1032983 Vali Loss: 0.0366446 Test Loss: 0.1398406
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1148566
	speed: 0.0595s/iter; left time: 400.9527s
	iters: 200, epoch: 9 | loss: 0.0962237
	speed: 0.0200s/iter; left time: 133.1363s
	iters: 300, epoch: 9 | loss: 0.1407297
	speed: 0.0201s/iter; left time: 131.2699s
	iters: 400, epoch: 9 | loss: 0.1055528
	speed: 0.0201s/iter; left time: 129.2250s
	iters: 500, epoch: 9 | loss: 0.0862103
	speed: 0.0201s/iter; left time: 127.1739s
Epoch: 9 cost time: 11.711729049682617
Epoch: 9, Steps: 570 | Train Loss: 0.1032208 Vali Loss: 0.0366243 Test Loss: 0.1402000
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14009012281894684, mae:0.23794491589069366
>>> MS_Pen LR=1e-4 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1865395
	speed: 0.0224s/iter; left time: 253.0851s
	iters: 200, epoch: 1 | loss: 0.2433278
	speed: 0.0112s/iter; left time: 124.9327s
	iters: 300, epoch: 1 | loss: 0.1994706
	speed: 0.0105s/iter; left time: 116.2833s
	iters: 400, epoch: 1 | loss: 0.2630361
	speed: 0.0104s/iter; left time: 114.8910s
	iters: 500, epoch: 1 | loss: 0.2098977
	speed: 0.0105s/iter; left time: 113.9405s
Epoch: 1 cost time: 7.268676042556763
Epoch: 1, Steps: 570 | Train Loss: 0.2487098 Vali Loss: 0.0462147 Test Loss: 0.1433724
Validation loss decreased (inf --> 0.046215).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4212867
	speed: 0.0373s/iter; left time: 399.8282s
	iters: 200, epoch: 2 | loss: 0.2937344
	speed: 0.0105s/iter; left time: 111.6623s
	iters: 300, epoch: 2 | loss: 0.2274806
	speed: 0.0104s/iter; left time: 109.5434s
	iters: 400, epoch: 2 | loss: 0.1611921
	speed: 0.0104s/iter; left time: 108.6187s
	iters: 500, epoch: 2 | loss: 0.1763334
	speed: 0.0104s/iter; left time: 107.6244s
Epoch: 2 cost time: 6.267714023590088
Epoch: 2, Steps: 570 | Train Loss: 0.2119634 Vali Loss: 0.0413489 Test Loss: 0.1281798
Validation loss decreased (0.046215 --> 0.041349).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1641876
	speed: 0.0368s/iter; left time: 373.9509s
	iters: 200, epoch: 3 | loss: 0.2370941
	speed: 0.0105s/iter; left time: 106.0885s
	iters: 300, epoch: 3 | loss: 0.1694890
	speed: 0.0106s/iter; left time: 105.4307s
	iters: 400, epoch: 3 | loss: 0.1895638
	speed: 0.0106s/iter; left time: 104.5074s
	iters: 500, epoch: 3 | loss: 0.2505232
	speed: 0.0106s/iter; left time: 103.4575s
Epoch: 3 cost time: 6.382233381271362
Epoch: 3, Steps: 570 | Train Loss: 0.1962982 Vali Loss: 0.0381104 Test Loss: 0.1211019
Validation loss decreased (0.041349 --> 0.038110).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2157714
	speed: 0.0382s/iter; left time: 366.3492s
	iters: 200, epoch: 4 | loss: 0.1054335
	speed: 0.0104s/iter; left time: 98.9363s
	iters: 300, epoch: 4 | loss: 0.1874819
	speed: 0.0104s/iter; left time: 97.7361s
	iters: 400, epoch: 4 | loss: 0.2052445
	speed: 0.0104s/iter; left time: 96.6639s
	iters: 500, epoch: 4 | loss: 0.1800084
	speed: 0.0104s/iter; left time: 95.7277s
Epoch: 4 cost time: 6.228146314620972
Epoch: 4, Steps: 570 | Train Loss: 0.1885545 Vali Loss: 0.0375072 Test Loss: 0.1205592
Validation loss decreased (0.038110 --> 0.037507).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1910293
	speed: 0.0372s/iter; left time: 335.7689s
	iters: 200, epoch: 5 | loss: 0.1877779
	speed: 0.0105s/iter; left time: 94.1016s
	iters: 300, epoch: 5 | loss: 0.1132683
	speed: 0.0105s/iter; left time: 92.9240s
	iters: 400, epoch: 5 | loss: 0.1756282
	speed: 0.0105s/iter; left time: 91.7899s
	iters: 500, epoch: 5 | loss: 0.2003171
	speed: 0.0105s/iter; left time: 90.7210s
Epoch: 5 cost time: 6.30757737159729
Epoch: 5, Steps: 570 | Train Loss: 0.1854038 Vali Loss: 0.0373550 Test Loss: 0.1204944
Validation loss decreased (0.037507 --> 0.037355).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1514102
	speed: 0.0363s/iter; left time: 306.4512s
	iters: 200, epoch: 6 | loss: 0.1179630
	speed: 0.0105s/iter; left time: 87.4564s
	iters: 300, epoch: 6 | loss: 0.1876191
	speed: 0.0106s/iter; left time: 87.1340s
	iters: 400, epoch: 6 | loss: 0.2092472
	speed: 0.0106s/iter; left time: 86.0722s
	iters: 500, epoch: 6 | loss: 0.1809858
	speed: 0.0106s/iter; left time: 85.0131s
Epoch: 6 cost time: 6.259077310562134
Epoch: 6, Steps: 570 | Train Loss: 0.1830905 Vali Loss: 0.0370744 Test Loss: 0.1202200
Validation loss decreased (0.037355 --> 0.037074).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1922142
	speed: 0.0356s/iter; left time: 280.3458s
	iters: 200, epoch: 7 | loss: 0.2550375
	speed: 0.0104s/iter; left time: 81.3089s
	iters: 300, epoch: 7 | loss: 0.1546160
	speed: 0.0104s/iter; left time: 80.2631s
	iters: 400, epoch: 7 | loss: 0.1568852
	speed: 0.0104s/iter; left time: 79.1175s
	iters: 500, epoch: 7 | loss: 0.1539902
	speed: 0.0105s/iter; left time: 78.1943s
Epoch: 7 cost time: 6.227574825286865
Epoch: 7, Steps: 570 | Train Loss: 0.1827437 Vali Loss: 0.0367046 Test Loss: 0.1201485
Validation loss decreased (0.037074 --> 0.036705).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1976799
	speed: 0.0365s/iter; left time: 266.4960s
	iters: 200, epoch: 8 | loss: 0.1725475
	speed: 0.0104s/iter; left time: 75.2611s
	iters: 300, epoch: 8 | loss: 0.2077451
	speed: 0.0110s/iter; left time: 77.9674s
	iters: 400, epoch: 8 | loss: 0.2701963
	speed: 0.0117s/iter; left time: 82.3057s
	iters: 500, epoch: 8 | loss: 0.1411973
	speed: 0.0111s/iter; left time: 76.6536s
Epoch: 8 cost time: 6.50197696685791
Epoch: 8, Steps: 570 | Train Loss: 0.1815397 Vali Loss: 0.0366145 Test Loss: 0.1197866
Validation loss decreased (0.036705 --> 0.036614).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2321830
	speed: 0.0360s/iter; left time: 242.4412s
	iters: 200, epoch: 9 | loss: 0.1883131
	speed: 0.0105s/iter; left time: 69.9249s
	iters: 300, epoch: 9 | loss: 0.0845666
	speed: 0.0105s/iter; left time: 68.8488s
	iters: 400, epoch: 9 | loss: 0.1455337
	speed: 0.0105s/iter; left time: 67.9123s
	iters: 500, epoch: 9 | loss: 0.1477286
	speed: 0.0105s/iter; left time: 66.5723s
Epoch: 9 cost time: 6.275107383728027
Epoch: 9, Steps: 570 | Train Loss: 0.1815375 Vali Loss: 0.0368931 Test Loss: 0.1197940
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1685637
	speed: 0.0351s/iter; left time: 216.4429s
	iters: 200, epoch: 10 | loss: 0.1716906
	speed: 0.0105s/iter; left time: 63.7925s
	iters: 300, epoch: 10 | loss: 0.1328819
	speed: 0.0105s/iter; left time: 62.4885s
	iters: 400, epoch: 10 | loss: 0.1754608
	speed: 0.0105s/iter; left time: 61.4734s
	iters: 500, epoch: 10 | loss: 0.2505477
	speed: 0.0104s/iter; left time: 60.2716s
Epoch: 10 cost time: 6.256794691085815
Epoch: 10, Steps: 570 | Train Loss: 0.1803626 Vali Loss: 0.0367288 Test Loss: 0.1197470
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2061473
	speed: 0.0354s/iter; left time: 198.2500s
	iters: 200, epoch: 11 | loss: 0.1803319
	speed: 0.0105s/iter; left time: 57.7214s
	iters: 300, epoch: 11 | loss: 0.1435636
	speed: 0.0105s/iter; left time: 56.6765s
	iters: 400, epoch: 11 | loss: 0.2726942
	speed: 0.0105s/iter; left time: 55.6440s
	iters: 500, epoch: 11 | loss: 0.1465995
	speed: 0.0105s/iter; left time: 54.6163s
Epoch: 11 cost time: 6.271445989608765
Epoch: 11, Steps: 570 | Train Loss: 0.1827790 Vali Loss: 0.0365804 Test Loss: 0.1197654
Validation loss decreased (0.036614 --> 0.036580).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1743368
	speed: 0.0367s/iter; left time: 184.6422s
	iters: 200, epoch: 12 | loss: 0.1681883
	speed: 0.0104s/iter; left time: 51.4771s
	iters: 300, epoch: 12 | loss: 0.1452588
	speed: 0.0104s/iter; left time: 50.4100s
	iters: 400, epoch: 12 | loss: 0.1456843
	speed: 0.0104s/iter; left time: 49.3833s
	iters: 500, epoch: 12 | loss: 0.2579778
	speed: 0.0104s/iter; left time: 48.3147s
Epoch: 12 cost time: 6.2810280323028564
Epoch: 12, Steps: 570 | Train Loss: 0.1810425 Vali Loss: 0.0366222 Test Loss: 0.1197447
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0847912
	speed: 0.0365s/iter; left time: 162.9476s
	iters: 200, epoch: 13 | loss: 0.2041036
	speed: 0.0105s/iter; left time: 45.7469s
	iters: 300, epoch: 13 | loss: 0.1451532
	speed: 0.0105s/iter; left time: 44.6350s
	iters: 400, epoch: 13 | loss: 0.1436882
	speed: 0.0105s/iter; left time: 43.5423s
	iters: 500, epoch: 13 | loss: 0.1953625
	speed: 0.0105s/iter; left time: 42.4902s
Epoch: 13 cost time: 6.240729331970215
Epoch: 13, Steps: 570 | Train Loss: 0.1820247 Vali Loss: 0.0366505 Test Loss: 0.1197357
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1377138
	speed: 0.0380s/iter; left time: 147.6926s
	iters: 200, epoch: 14 | loss: 0.1609825
	speed: 0.0118s/iter; left time: 44.6067s
	iters: 300, epoch: 14 | loss: 0.2082974
	speed: 0.0116s/iter; left time: 42.7154s
	iters: 400, epoch: 14 | loss: 0.1988460
	speed: 0.0104s/iter; left time: 37.4097s
	iters: 500, epoch: 14 | loss: 0.1823320
	speed: 0.0104s/iter; left time: 36.3870s
Epoch: 14 cost time: 6.571357250213623
Epoch: 14, Steps: 570 | Train Loss: 0.1819395 Vali Loss: 0.0366229 Test Loss: 0.1197302
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11989911645650864, mae:0.2097177952528
>>> MS_Pen LR=1e-4 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1848151
	speed: 0.0218s/iter; left time: 246.7104s
	iters: 200, epoch: 1 | loss: 0.2475991
	speed: 0.0104s/iter; left time: 115.9999s
	iters: 300, epoch: 1 | loss: 0.3182305
	speed: 0.0103s/iter; left time: 114.2471s
	iters: 400, epoch: 1 | loss: 0.2259017
	speed: 0.0103s/iter; left time: 112.8798s
	iters: 500, epoch: 1 | loss: 0.2242463
	speed: 0.0103s/iter; left time: 112.1591s
Epoch: 1 cost time: 7.070756673812866
Epoch: 1, Steps: 570 | Train Loss: 0.2238468 Vali Loss: 0.0383266 Test Loss: 0.1171995
Validation loss decreased (inf --> 0.038327).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1550873
	speed: 0.0357s/iter; left time: 382.7212s
	iters: 200, epoch: 2 | loss: 0.2070253
	speed: 0.0103s/iter; left time: 109.4712s
	iters: 300, epoch: 2 | loss: 0.1670241
	speed: 0.0103s/iter; left time: 108.3921s
	iters: 400, epoch: 2 | loss: 0.1770594
	speed: 0.0103s/iter; left time: 107.3952s
	iters: 500, epoch: 2 | loss: 0.2039486
	speed: 0.0103s/iter; left time: 106.2973s
Epoch: 2 cost time: 6.176697254180908
Epoch: 2, Steps: 570 | Train Loss: 0.1959970 Vali Loss: 0.0362843 Test Loss: 0.1160979
Validation loss decreased (0.038327 --> 0.036284).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1019882
	speed: 0.0359s/iter; left time: 364.5071s
	iters: 200, epoch: 3 | loss: 0.1432147
	speed: 0.0104s/iter; left time: 104.2572s
	iters: 300, epoch: 3 | loss: 0.3329154
	speed: 0.0104s/iter; left time: 103.7457s
	iters: 400, epoch: 3 | loss: 0.1855495
	speed: 0.0104s/iter; left time: 102.2610s
	iters: 500, epoch: 3 | loss: 0.1527667
	speed: 0.0103s/iter; left time: 100.9784s
Epoch: 3 cost time: 6.201509475708008
Epoch: 3, Steps: 570 | Train Loss: 0.1828538 Vali Loss: 0.0355886 Test Loss: 0.1157485
Validation loss decreased (0.036284 --> 0.035589).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1641247
	speed: 0.0360s/iter; left time: 345.7509s
	iters: 200, epoch: 4 | loss: 0.1375686
	speed: 0.0103s/iter; left time: 98.0701s
	iters: 300, epoch: 4 | loss: 0.0955682
	speed: 0.0103s/iter; left time: 96.9150s
	iters: 400, epoch: 4 | loss: 0.1459756
	speed: 0.0103s/iter; left time: 95.7595s
	iters: 500, epoch: 4 | loss: 0.2045879
	speed: 0.0103s/iter; left time: 94.4485s
Epoch: 4 cost time: 6.156899690628052
Epoch: 4, Steps: 570 | Train Loss: 0.1757143 Vali Loss: 0.0347328 Test Loss: 0.1137263
Validation loss decreased (0.035589 --> 0.034733).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1313187
	speed: 0.0357s/iter; left time: 322.3528s
	iters: 200, epoch: 5 | loss: 0.2311892
	speed: 0.0103s/iter; left time: 91.8236s
	iters: 300, epoch: 5 | loss: 0.1570411
	speed: 0.0103s/iter; left time: 91.0012s
	iters: 400, epoch: 5 | loss: 0.1433168
	speed: 0.0103s/iter; left time: 90.1579s
	iters: 500, epoch: 5 | loss: 0.1918563
	speed: 0.0103s/iter; left time: 89.0689s
Epoch: 5 cost time: 6.170235872268677
Epoch: 5, Steps: 570 | Train Loss: 0.1728739 Vali Loss: 0.0342718 Test Loss: 0.1128363
Validation loss decreased (0.034733 --> 0.034272).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1267581
	speed: 0.0382s/iter; left time: 323.2278s
	iters: 200, epoch: 6 | loss: 0.2407428
	speed: 0.0104s/iter; left time: 86.9014s
	iters: 300, epoch: 6 | loss: 0.1742729
	speed: 0.0104s/iter; left time: 85.7516s
	iters: 400, epoch: 6 | loss: 0.1449354
	speed: 0.0104s/iter; left time: 84.4715s
	iters: 500, epoch: 6 | loss: 0.0973028
	speed: 0.0104s/iter; left time: 83.3351s
Epoch: 6 cost time: 6.236871719360352
Epoch: 6, Steps: 570 | Train Loss: 0.1715373 Vali Loss: 0.0342589 Test Loss: 0.1130404
Validation loss decreased (0.034272 --> 0.034259).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1680217
	speed: 0.0378s/iter; left time: 297.7979s
	iters: 200, epoch: 7 | loss: 0.1922475
	speed: 0.0104s/iter; left time: 80.6082s
	iters: 300, epoch: 7 | loss: 0.2955881
	speed: 0.0103s/iter; left time: 79.1045s
	iters: 400, epoch: 7 | loss: 0.2260503
	speed: 0.0103s/iter; left time: 78.1418s
	iters: 500, epoch: 7 | loss: 0.1552220
	speed: 0.0113s/iter; left time: 84.4369s
Epoch: 7 cost time: 6.368924856185913
Epoch: 7, Steps: 570 | Train Loss: 0.1709697 Vali Loss: 0.0340679 Test Loss: 0.1129243
Validation loss decreased (0.034259 --> 0.034068).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1401494
	speed: 0.0367s/iter; left time: 268.6254s
	iters: 200, epoch: 8 | loss: 0.1432565
	speed: 0.0103s/iter; left time: 74.2422s
	iters: 300, epoch: 8 | loss: 0.1371118
	speed: 0.0103s/iter; left time: 73.3360s
	iters: 400, epoch: 8 | loss: 0.1643611
	speed: 0.0103s/iter; left time: 72.2601s
	iters: 500, epoch: 8 | loss: 0.0951073
	speed: 0.0103s/iter; left time: 71.2102s
Epoch: 8 cost time: 6.140061616897583
Epoch: 8, Steps: 570 | Train Loss: 0.1719055 Vali Loss: 0.0340163 Test Loss: 0.1128065
Validation loss decreased (0.034068 --> 0.034016).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1272931
	speed: 0.0346s/iter; left time: 233.5412s
	iters: 200, epoch: 9 | loss: 0.1618168
	speed: 0.0104s/iter; left time: 68.7351s
	iters: 300, epoch: 9 | loss: 0.1569292
	speed: 0.0104s/iter; left time: 67.8795s
	iters: 400, epoch: 9 | loss: 0.2025677
	speed: 0.0104s/iter; left time: 66.7244s
	iters: 500, epoch: 9 | loss: 0.1582296
	speed: 0.0104s/iter; left time: 65.6643s
Epoch: 9 cost time: 6.201639652252197
Epoch: 9, Steps: 570 | Train Loss: 0.1700711 Vali Loss: 0.0341231 Test Loss: 0.1128688
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1865007
	speed: 0.0371s/iter; left time: 228.8397s
	iters: 200, epoch: 10 | loss: 0.1394930
	speed: 0.0104s/iter; left time: 63.3965s
	iters: 300, epoch: 10 | loss: 0.1327388
	speed: 0.0104s/iter; left time: 62.2861s
	iters: 400, epoch: 10 | loss: 0.1106431
	speed: 0.0104s/iter; left time: 61.1258s
	iters: 500, epoch: 10 | loss: 0.1158681
	speed: 0.0104s/iter; left time: 59.9063s
Epoch: 10 cost time: 6.218969821929932
Epoch: 10, Steps: 570 | Train Loss: 0.1714824 Vali Loss: 0.0341354 Test Loss: 0.1129107
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1622757
	speed: 0.0361s/iter; left time: 202.2663s
	iters: 200, epoch: 11 | loss: 0.1750644
	speed: 0.0103s/iter; left time: 56.7161s
	iters: 300, epoch: 11 | loss: 0.2059873
	speed: 0.0103s/iter; left time: 55.7923s
	iters: 400, epoch: 11 | loss: 0.1566436
	speed: 0.0103s/iter; left time: 54.8117s
	iters: 500, epoch: 11 | loss: 0.1512282
	speed: 0.0103s/iter; left time: 53.7235s
Epoch: 11 cost time: 6.173000812530518
Epoch: 11, Steps: 570 | Train Loss: 0.1690909 Vali Loss: 0.0340333 Test Loss: 0.1129140
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11293765902519226, mae:0.2021801918745041
>>> MS_Pen LR=1e-4 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2642080
	speed: 0.0219s/iter; left time: 247.0161s
	iters: 200, epoch: 1 | loss: 0.1983837
	speed: 0.0103s/iter; left time: 115.3795s
	iters: 300, epoch: 1 | loss: 0.1786887
	speed: 0.0103s/iter; left time: 114.5511s
	iters: 400, epoch: 1 | loss: 0.2143017
	speed: 0.0103s/iter; left time: 113.0302s
	iters: 500, epoch: 1 | loss: 0.2239678
	speed: 0.0103s/iter; left time: 112.3378s
Epoch: 1 cost time: 7.073084592819214
Epoch: 1, Steps: 570 | Train Loss: 0.2552256 Vali Loss: 0.0446820 Test Loss: 0.1360241
Validation loss decreased (inf --> 0.044682).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2015534
	speed: 0.0378s/iter; left time: 405.9565s
	iters: 200, epoch: 2 | loss: 0.2751262
	speed: 0.0103s/iter; left time: 109.8453s
	iters: 300, epoch: 2 | loss: 0.2146488
	speed: 0.0103s/iter; left time: 108.3392s
	iters: 400, epoch: 2 | loss: 0.3058339
	speed: 0.0103s/iter; left time: 107.7862s
	iters: 500, epoch: 2 | loss: 0.2478689
	speed: 0.0103s/iter; left time: 106.5341s
Epoch: 2 cost time: 6.154362201690674
Epoch: 2, Steps: 570 | Train Loss: 0.2164384 Vali Loss: 0.0397765 Test Loss: 0.1277835
Validation loss decreased (0.044682 --> 0.039777).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1393592
	speed: 0.0373s/iter; left time: 378.8835s
	iters: 200, epoch: 3 | loss: 0.1933073
	speed: 0.0105s/iter; left time: 105.3057s
	iters: 300, epoch: 3 | loss: 0.2732522
	speed: 0.0105s/iter; left time: 104.9538s
	iters: 400, epoch: 3 | loss: 0.2050154
	speed: 0.0104s/iter; left time: 102.1888s
	iters: 500, epoch: 3 | loss: 0.1457550
	speed: 0.0104s/iter; left time: 101.5976s
Epoch: 3 cost time: 6.348169326782227
Epoch: 3, Steps: 570 | Train Loss: 0.2035547 Vali Loss: 0.0383121 Test Loss: 0.1255429
Validation loss decreased (0.039777 --> 0.038312).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1174179
	speed: 0.0363s/iter; left time: 347.9545s
	iters: 200, epoch: 4 | loss: 0.1602435
	speed: 0.0103s/iter; left time: 97.9690s
	iters: 300, epoch: 4 | loss: 0.1736790
	speed: 0.0103s/iter; left time: 96.8344s
	iters: 400, epoch: 4 | loss: 0.2363059
	speed: 0.0103s/iter; left time: 95.8623s
	iters: 500, epoch: 4 | loss: 0.1831711
	speed: 0.0103s/iter; left time: 94.5732s
Epoch: 4 cost time: 6.163144111633301
Epoch: 4, Steps: 570 | Train Loss: 0.1971908 Vali Loss: 0.0381839 Test Loss: 0.1260440
Validation loss decreased (0.038312 --> 0.038184).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1771592
	speed: 0.0365s/iter; left time: 329.6869s
	iters: 200, epoch: 5 | loss: 0.1172878
	speed: 0.0103s/iter; left time: 92.1830s
	iters: 300, epoch: 5 | loss: 0.2326478
	speed: 0.0104s/iter; left time: 91.3485s
	iters: 400, epoch: 5 | loss: 0.1717207
	speed: 0.0104s/iter; left time: 90.9926s
	iters: 500, epoch: 5 | loss: 0.2490027
	speed: 0.0104s/iter; left time: 89.8694s
Epoch: 5 cost time: 6.214114427566528
Epoch: 5, Steps: 570 | Train Loss: 0.1933163 Vali Loss: 0.0380645 Test Loss: 0.1264007
Validation loss decreased (0.038184 --> 0.038064).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1702949
	speed: 0.0362s/iter; left time: 306.2014s
	iters: 200, epoch: 6 | loss: 0.1902012
	speed: 0.0104s/iter; left time: 86.7794s
	iters: 300, epoch: 6 | loss: 0.1663698
	speed: 0.0104s/iter; left time: 85.9577s
	iters: 400, epoch: 6 | loss: 0.1335502
	speed: 0.0103s/iter; left time: 84.1289s
	iters: 500, epoch: 6 | loss: 0.2127829
	speed: 0.0103s/iter; left time: 82.9953s
Epoch: 6 cost time: 6.188178062438965
Epoch: 6, Steps: 570 | Train Loss: 0.1912425 Vali Loss: 0.0377713 Test Loss: 0.1254649
Validation loss decreased (0.038064 --> 0.037771).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1327125
	speed: 0.0374s/iter; left time: 294.5165s
	iters: 200, epoch: 7 | loss: 0.1470341
	speed: 0.0104s/iter; left time: 80.9912s
	iters: 300, epoch: 7 | loss: 0.1695256
	speed: 0.0104s/iter; left time: 80.2066s
	iters: 400, epoch: 7 | loss: 0.1195396
	speed: 0.0104s/iter; left time: 79.0444s
	iters: 500, epoch: 7 | loss: 0.2404021
	speed: 0.0104s/iter; left time: 78.0201s
Epoch: 7 cost time: 6.221921443939209
Epoch: 7, Steps: 570 | Train Loss: 0.1898739 Vali Loss: 0.0377238 Test Loss: 0.1256263
Validation loss decreased (0.037771 --> 0.037724).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1527850
	speed: 0.0358s/iter; left time: 261.6353s
	iters: 200, epoch: 8 | loss: 0.1547710
	speed: 0.0104s/iter; left time: 74.7854s
	iters: 300, epoch: 8 | loss: 0.1971428
	speed: 0.0104s/iter; left time: 73.6762s
	iters: 400, epoch: 8 | loss: 0.2518228
	speed: 0.0103s/iter; left time: 72.5387s
	iters: 500, epoch: 8 | loss: 0.1908986
	speed: 0.0104s/iter; left time: 71.5524s
Epoch: 8 cost time: 6.1885645389556885
Epoch: 8, Steps: 570 | Train Loss: 0.1900345 Vali Loss: 0.0376598 Test Loss: 0.1257251
Validation loss decreased (0.037724 --> 0.037660).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1766541
	speed: 0.0360s/iter; left time: 242.5976s
	iters: 200, epoch: 9 | loss: 0.2117126
	speed: 0.0104s/iter; left time: 68.8062s
	iters: 300, epoch: 9 | loss: 0.1497053
	speed: 0.0103s/iter; left time: 67.6518s
	iters: 400, epoch: 9 | loss: 0.1369807
	speed: 0.0103s/iter; left time: 66.5073s
	iters: 500, epoch: 9 | loss: 0.1991231
	speed: 0.0103s/iter; left time: 65.5842s
Epoch: 9 cost time: 6.2489705085754395
Epoch: 9, Steps: 570 | Train Loss: 0.1888622 Vali Loss: 0.0377089 Test Loss: 0.1255361
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1524509
	speed: 0.0351s/iter; left time: 216.4294s
	iters: 200, epoch: 10 | loss: 0.2712312
	speed: 0.0103s/iter; left time: 62.4265s
	iters: 300, epoch: 10 | loss: 0.2663701
	speed: 0.0103s/iter; left time: 61.5543s
	iters: 400, epoch: 10 | loss: 0.2279763
	speed: 0.0103s/iter; left time: 60.4167s
	iters: 500, epoch: 10 | loss: 0.2050593
	speed: 0.0103s/iter; left time: 59.5351s
Epoch: 10 cost time: 6.145267009735107
Epoch: 10, Steps: 570 | Train Loss: 0.1908917 Vali Loss: 0.0377538 Test Loss: 0.1255462
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2052414
	speed: 0.0376s/iter; left time: 210.6887s
	iters: 200, epoch: 11 | loss: 0.1784044
	speed: 0.0104s/iter; left time: 57.3533s
	iters: 300, epoch: 11 | loss: 0.2138636
	speed: 0.0104s/iter; left time: 56.1210s
	iters: 400, epoch: 11 | loss: 0.2100773
	speed: 0.0103s/iter; left time: 54.8426s
	iters: 500, epoch: 11 | loss: 0.2287650
	speed: 0.0104s/iter; left time: 53.8804s
Epoch: 11 cost time: 6.23048996925354
Epoch: 11, Steps: 570 | Train Loss: 0.1902334 Vali Loss: 0.0375404 Test Loss: 0.1255826
Validation loss decreased (0.037660 --> 0.037540).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1759665
	speed: 0.0369s/iter; left time: 185.5631s
	iters: 200, epoch: 12 | loss: 0.1778501
	speed: 0.0105s/iter; left time: 51.5337s
	iters: 300, epoch: 12 | loss: 0.1417590
	speed: 0.0104s/iter; left time: 50.3779s
	iters: 400, epoch: 12 | loss: 0.1861676
	speed: 0.0104s/iter; left time: 49.3511s
	iters: 500, epoch: 12 | loss: 0.1083493
	speed: 0.0104s/iter; left time: 48.3185s
Epoch: 12 cost time: 6.262271404266357
Epoch: 12, Steps: 570 | Train Loss: 0.1896963 Vali Loss: 0.0375163 Test Loss: 0.1255871
Validation loss decreased (0.037540 --> 0.037516).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1619085
	speed: 0.0378s/iter; left time: 168.4289s
	iters: 200, epoch: 13 | loss: 0.1986689
	speed: 0.0103s/iter; left time: 44.9946s
	iters: 300, epoch: 13 | loss: 0.1998067
	speed: 0.0103s/iter; left time: 44.0284s
	iters: 400, epoch: 13 | loss: 0.2325505
	speed: 0.0103s/iter; left time: 42.7233s
	iters: 500, epoch: 13 | loss: 0.1732632
	speed: 0.0102s/iter; left time: 41.5393s
Epoch: 13 cost time: 6.149775505065918
Epoch: 13, Steps: 570 | Train Loss: 0.1904392 Vali Loss: 0.0376230 Test Loss: 0.1255859
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1543816
	speed: 0.0367s/iter; left time: 142.9602s
	iters: 200, epoch: 14 | loss: 0.2604511
	speed: 0.0103s/iter; left time: 39.1866s
	iters: 300, epoch: 14 | loss: 0.1361327
	speed: 0.0103s/iter; left time: 38.0735s
	iters: 400, epoch: 14 | loss: 0.1168516
	speed: 0.0103s/iter; left time: 37.0144s
	iters: 500, epoch: 14 | loss: 0.2687312
	speed: 0.0103s/iter; left time: 35.9730s
Epoch: 14 cost time: 6.189489126205444
Epoch: 14, Steps: 570 | Train Loss: 0.1889090 Vali Loss: 0.0375042 Test Loss: 0.1255993
Validation loss decreased (0.037516 --> 0.037504).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1617043
	speed: 0.0373s/iter; left time: 123.9305s
	iters: 200, epoch: 15 | loss: 0.2496784
	speed: 0.0103s/iter; left time: 33.2473s
	iters: 300, epoch: 15 | loss: 0.1041665
	speed: 0.0103s/iter; left time: 32.1888s
	iters: 400, epoch: 15 | loss: 0.0863347
	speed: 0.0103s/iter; left time: 31.1562s
	iters: 500, epoch: 15 | loss: 0.2579130
	speed: 0.0103s/iter; left time: 30.1043s
Epoch: 15 cost time: 6.17620325088501
Epoch: 15, Steps: 570 | Train Loss: 0.1898438 Vali Loss: 0.0375608 Test Loss: 0.1255871
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2056899
	speed: 0.0371s/iter; left time: 102.1864s
	iters: 200, epoch: 16 | loss: 0.1270622
	speed: 0.0103s/iter; left time: 27.2396s
	iters: 300, epoch: 16 | loss: 0.1900458
	speed: 0.0103s/iter; left time: 26.2676s
	iters: 400, epoch: 16 | loss: 0.1922959
	speed: 0.0103s/iter; left time: 25.2262s
	iters: 500, epoch: 16 | loss: 0.2073401
	speed: 0.0103s/iter; left time: 24.2156s
Epoch: 16 cost time: 6.116270303726196
Epoch: 16, Steps: 570 | Train Loss: 0.1908254 Vali Loss: 0.0377179 Test Loss: 0.1255825
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1505545
	speed: 0.0376s/iter; left time: 82.0009s
	iters: 200, epoch: 17 | loss: 0.1163892
	speed: 0.0116s/iter; left time: 24.2243s
	iters: 300, epoch: 17 | loss: 0.1068639
	speed: 0.0111s/iter; left time: 21.8960s
	iters: 400, epoch: 17 | loss: 0.2275882
	speed: 0.0104s/iter; left time: 19.4860s
	iters: 500, epoch: 17 | loss: 0.1120334
	speed: 0.0104s/iter; left time: 18.4566s
Epoch: 17 cost time: 6.499368667602539
Epoch: 17, Steps: 570 | Train Loss: 0.1892932 Vali Loss: 0.0377519 Test Loss: 0.1255823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12572598457336426, mae:0.2197234332561493
>>> MS_Pen LR=1e-4 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2868483
	speed: 0.0250s/iter; left time: 282.0636s
	iters: 200, epoch: 1 | loss: 0.2845353
	speed: 0.0129s/iter; left time: 144.4408s
	iters: 300, epoch: 1 | loss: 0.1962079
	speed: 0.0128s/iter; left time: 141.6108s
	iters: 400, epoch: 1 | loss: 0.1315847
	speed: 0.0127s/iter; left time: 139.5573s
	iters: 500, epoch: 1 | loss: 0.2290587
	speed: 0.0127s/iter; left time: 138.5791s
Epoch: 1 cost time: 8.547019720077515
Epoch: 1, Steps: 570 | Train Loss: 0.2450879 Vali Loss: 0.0420422 Test Loss: 0.1288486
Validation loss decreased (inf --> 0.042042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2116661
	speed: 0.0416s/iter; left time: 446.6391s
	iters: 200, epoch: 2 | loss: 0.1578942
	speed: 0.0127s/iter; left time: 135.1532s
	iters: 300, epoch: 2 | loss: 0.1615304
	speed: 0.0125s/iter; left time: 131.4386s
	iters: 400, epoch: 2 | loss: 0.1215644
	speed: 0.0118s/iter; left time: 123.1354s
	iters: 500, epoch: 2 | loss: 0.2096097
	speed: 0.0118s/iter; left time: 122.2275s
Epoch: 2 cost time: 7.3051464557647705
Epoch: 2, Steps: 570 | Train Loss: 0.2059898 Vali Loss: 0.0401445 Test Loss: 0.1238625
Validation loss decreased (0.042042 --> 0.040144).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2735049
	speed: 0.0399s/iter; left time: 405.1995s
	iters: 200, epoch: 3 | loss: 0.2151803
	speed: 0.0118s/iter; left time: 119.1391s
	iters: 300, epoch: 3 | loss: 0.1278989
	speed: 0.0118s/iter; left time: 118.0193s
	iters: 400, epoch: 3 | loss: 0.1595905
	speed: 0.0118s/iter; left time: 116.8508s
	iters: 500, epoch: 3 | loss: 0.1331496
	speed: 0.0119s/iter; left time: 115.8314s
Epoch: 3 cost time: 7.035785436630249
Epoch: 3, Steps: 570 | Train Loss: 0.1832344 Vali Loss: 0.0369288 Test Loss: 0.1203825
Validation loss decreased (0.040144 --> 0.036929).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1258553
	speed: 0.0385s/iter; left time: 368.7879s
	iters: 200, epoch: 4 | loss: 0.2660788
	speed: 0.0119s/iter; left time: 112.8115s
	iters: 300, epoch: 4 | loss: 0.1050168
	speed: 0.0119s/iter; left time: 111.6582s
	iters: 400, epoch: 4 | loss: 0.1274966
	speed: 0.0119s/iter; left time: 110.4589s
	iters: 500, epoch: 4 | loss: 0.1339640
	speed: 0.0119s/iter; left time: 109.1973s
Epoch: 4 cost time: 7.054092645645142
Epoch: 4, Steps: 570 | Train Loss: 0.1719650 Vali Loss: 0.0355502 Test Loss: 0.1189762
Validation loss decreased (0.036929 --> 0.035550).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1456669
	speed: 0.0424s/iter; left time: 382.3213s
	iters: 200, epoch: 5 | loss: 0.1303991
	speed: 0.0127s/iter; left time: 113.3244s
	iters: 300, epoch: 5 | loss: 0.2180226
	speed: 0.0127s/iter; left time: 112.3539s
	iters: 400, epoch: 5 | loss: 0.1616942
	speed: 0.0127s/iter; left time: 111.1589s
	iters: 500, epoch: 5 | loss: 0.1487331
	speed: 0.0129s/iter; left time: 110.9764s
Epoch: 5 cost time: 7.6024980545043945
Epoch: 5, Steps: 570 | Train Loss: 0.1673507 Vali Loss: 0.0353527 Test Loss: 0.1186162
Validation loss decreased (0.035550 --> 0.035353).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1513707
	speed: 0.0405s/iter; left time: 342.2619s
	iters: 200, epoch: 6 | loss: 0.1116882
	speed: 0.0118s/iter; left time: 98.6101s
	iters: 300, epoch: 6 | loss: 0.1699877
	speed: 0.0118s/iter; left time: 97.4141s
	iters: 400, epoch: 6 | loss: 0.2070508
	speed: 0.0118s/iter; left time: 96.4781s
	iters: 500, epoch: 6 | loss: 0.1076586
	speed: 0.0118s/iter; left time: 95.3773s
Epoch: 6 cost time: 7.112802028656006
Epoch: 6, Steps: 570 | Train Loss: 0.1649959 Vali Loss: 0.0346459 Test Loss: 0.1173624
Validation loss decreased (0.035353 --> 0.034646).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1660981
	speed: 0.0415s/iter; left time: 326.7503s
	iters: 200, epoch: 7 | loss: 0.1419035
	speed: 0.0127s/iter; left time: 98.7242s
	iters: 300, epoch: 7 | loss: 0.1524366
	speed: 0.0119s/iter; left time: 91.6490s
	iters: 400, epoch: 7 | loss: 0.1049389
	speed: 0.0118s/iter; left time: 89.5335s
	iters: 500, epoch: 7 | loss: 0.1504382
	speed: 0.0121s/iter; left time: 90.2256s
Epoch: 7 cost time: 7.292432546615601
Epoch: 7, Steps: 570 | Train Loss: 0.1623062 Vali Loss: 0.0345466 Test Loss: 0.1190183
Validation loss decreased (0.034646 --> 0.034547).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1249937
	speed: 0.0422s/iter; left time: 308.5032s
	iters: 200, epoch: 8 | loss: 0.1764741
	speed: 0.0127s/iter; left time: 91.8159s
	iters: 300, epoch: 8 | loss: 0.1602486
	speed: 0.0127s/iter; left time: 90.6392s
	iters: 400, epoch: 8 | loss: 0.1374849
	speed: 0.0128s/iter; left time: 89.4133s
	iters: 500, epoch: 8 | loss: 0.1140059
	speed: 0.0127s/iter; left time: 88.0465s
Epoch: 8 cost time: 7.569298505783081
Epoch: 8, Steps: 570 | Train Loss: 0.1632199 Vali Loss: 0.0347587 Test Loss: 0.1177083
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1158596
	speed: 0.0408s/iter; left time: 274.8363s
	iters: 200, epoch: 9 | loss: 0.1468614
	speed: 0.0118s/iter; left time: 78.2595s
	iters: 300, epoch: 9 | loss: 0.1566997
	speed: 0.0118s/iter; left time: 77.0411s
	iters: 400, epoch: 9 | loss: 0.1130242
	speed: 0.0118s/iter; left time: 75.8307s
	iters: 500, epoch: 9 | loss: 0.1712124
	speed: 0.0118s/iter; left time: 74.6424s
Epoch: 9 cost time: 7.113807201385498
Epoch: 9, Steps: 570 | Train Loss: 0.1633132 Vali Loss: 0.0345289 Test Loss: 0.1175579
Validation loss decreased (0.034547 --> 0.034529).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1371941
	speed: 0.0393s/iter; left time: 242.2520s
	iters: 200, epoch: 10 | loss: 0.2242638
	speed: 0.0118s/iter; left time: 71.4000s
	iters: 300, epoch: 10 | loss: 0.1540557
	speed: 0.0118s/iter; left time: 70.2323s
	iters: 400, epoch: 10 | loss: 0.1436105
	speed: 0.0118s/iter; left time: 69.3548s
	iters: 500, epoch: 10 | loss: 0.2204045
	speed: 0.0118s/iter; left time: 68.3283s
Epoch: 10 cost time: 7.001166105270386
Epoch: 10, Steps: 570 | Train Loss: 0.1623186 Vali Loss: 0.0346267 Test Loss: 0.1174552
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1392295
	speed: 0.0381s/iter; left time: 213.6438s
	iters: 200, epoch: 11 | loss: 0.2428194
	speed: 0.0126s/iter; left time: 69.5249s
	iters: 300, epoch: 11 | loss: 0.1875036
	speed: 0.0127s/iter; left time: 68.4552s
	iters: 400, epoch: 11 | loss: 0.1642262
	speed: 0.0127s/iter; left time: 67.2485s
	iters: 500, epoch: 11 | loss: 0.2259284
	speed: 0.0127s/iter; left time: 65.9497s
Epoch: 11 cost time: 7.396939277648926
Epoch: 11, Steps: 570 | Train Loss: 0.1618505 Vali Loss: 0.0345554 Test Loss: 0.1176371
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1395919
	speed: 0.0407s/iter; left time: 204.8956s
	iters: 200, epoch: 12 | loss: 0.1344362
	speed: 0.0129s/iter; left time: 63.6009s
	iters: 300, epoch: 12 | loss: 0.1061849
	speed: 0.0129s/iter; left time: 62.1194s
	iters: 400, epoch: 12 | loss: 0.1403834
	speed: 0.0122s/iter; left time: 57.8150s
	iters: 500, epoch: 12 | loss: 0.1747510
	speed: 0.0119s/iter; left time: 54.9037s
Epoch: 12 cost time: 7.467556715011597
Epoch: 12, Steps: 570 | Train Loss: 0.1624775 Vali Loss: 0.0347182 Test Loss: 0.1175233
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11764750629663467, mae:0.20983272790908813
>>> MS_Pen LR=1e-4 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1376499
	speed: 0.0246s/iter; left time: 277.5991s
	iters: 200, epoch: 1 | loss: 0.3347834
	speed: 0.0125s/iter; left time: 140.3158s
	iters: 300, epoch: 1 | loss: 0.1742408
	speed: 0.0127s/iter; left time: 140.7317s
	iters: 400, epoch: 1 | loss: 0.2173970
	speed: 0.0127s/iter; left time: 139.5912s
	iters: 500, epoch: 1 | loss: 0.1810365
	speed: 0.0127s/iter; left time: 138.3752s
Epoch: 1 cost time: 8.455475807189941
Epoch: 1, Steps: 570 | Train Loss: 0.2216402 Vali Loss: 0.0385178 Test Loss: 0.1180675
Validation loss decreased (inf --> 0.038518).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1850036
	speed: 0.0423s/iter; left time: 453.4969s
	iters: 200, epoch: 2 | loss: 0.1242649
	speed: 0.0127s/iter; left time: 134.6135s
	iters: 300, epoch: 2 | loss: 0.1823880
	speed: 0.0127s/iter; left time: 133.7728s
	iters: 400, epoch: 2 | loss: 0.2611916
	speed: 0.0122s/iter; left time: 127.3627s
	iters: 500, epoch: 2 | loss: 0.2853755
	speed: 0.0114s/iter; left time: 117.6959s
Epoch: 2 cost time: 7.277451038360596
Epoch: 2, Steps: 570 | Train Loss: 0.1914280 Vali Loss: 0.0370437 Test Loss: 0.1159592
Validation loss decreased (0.038518 --> 0.037044).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2179722
	speed: 0.0414s/iter; left time: 420.5320s
	iters: 200, epoch: 3 | loss: 0.1037350
	speed: 0.0125s/iter; left time: 126.1799s
	iters: 300, epoch: 3 | loss: 0.1998007
	speed: 0.0125s/iter; left time: 124.5753s
	iters: 400, epoch: 3 | loss: 0.1702902
	speed: 0.0125s/iter; left time: 123.3569s
	iters: 500, epoch: 3 | loss: 0.2034706
	speed: 0.0125s/iter; left time: 122.0489s
Epoch: 3 cost time: 7.464237928390503
Epoch: 3, Steps: 570 | Train Loss: 0.1750122 Vali Loss: 0.0345897 Test Loss: 0.1157569
Validation loss decreased (0.037044 --> 0.034590).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1487424
	speed: 0.0401s/iter; left time: 384.9979s
	iters: 200, epoch: 4 | loss: 0.1109861
	speed: 0.0114s/iter; left time: 108.2283s
	iters: 300, epoch: 4 | loss: 0.0922989
	speed: 0.0114s/iter; left time: 107.1897s
	iters: 400, epoch: 4 | loss: 0.1331999
	speed: 0.0114s/iter; left time: 106.0547s
	iters: 500, epoch: 4 | loss: 0.1656473
	speed: 0.0121s/iter; left time: 110.9293s
Epoch: 4 cost time: 6.9530980587005615
Epoch: 4, Steps: 570 | Train Loss: 0.1645960 Vali Loss: 0.0339228 Test Loss: 0.1158542
Validation loss decreased (0.034590 --> 0.033923).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1678441
	speed: 0.0414s/iter; left time: 373.4206s
	iters: 200, epoch: 5 | loss: 0.1078809
	speed: 0.0127s/iter; left time: 113.3312s
	iters: 300, epoch: 5 | loss: 0.2299811
	speed: 0.0127s/iter; left time: 112.3492s
	iters: 400, epoch: 5 | loss: 0.1544437
	speed: 0.0127s/iter; left time: 111.0381s
	iters: 500, epoch: 5 | loss: 0.1344692
	speed: 0.0127s/iter; left time: 109.4708s
Epoch: 5 cost time: 7.474609375
Epoch: 5, Steps: 570 | Train Loss: 0.1606941 Vali Loss: 0.0336404 Test Loss: 0.1153339
Validation loss decreased (0.033923 --> 0.033640).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1941540
	speed: 0.0384s/iter; left time: 324.7103s
	iters: 200, epoch: 6 | loss: 0.1731629
	speed: 0.0115s/iter; left time: 95.6471s
	iters: 300, epoch: 6 | loss: 0.1145115
	speed: 0.0115s/iter; left time: 94.5052s
	iters: 400, epoch: 6 | loss: 0.1165641
	speed: 0.0115s/iter; left time: 93.3441s
	iters: 500, epoch: 6 | loss: 0.1209074
	speed: 0.0115s/iter; left time: 92.2056s
Epoch: 6 cost time: 6.843639135360718
Epoch: 6, Steps: 570 | Train Loss: 0.1578180 Vali Loss: 0.0332348 Test Loss: 0.1149191
Validation loss decreased (0.033640 --> 0.033235).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1069187
	speed: 0.0382s/iter; left time: 300.9436s
	iters: 200, epoch: 7 | loss: 0.2080019
	speed: 0.0115s/iter; left time: 89.1782s
	iters: 300, epoch: 7 | loss: 0.0960604
	speed: 0.0115s/iter; left time: 88.0412s
	iters: 400, epoch: 7 | loss: 0.1255588
	speed: 0.0115s/iter; left time: 86.9246s
	iters: 500, epoch: 7 | loss: 0.1490814
	speed: 0.0115s/iter; left time: 85.8023s
Epoch: 7 cost time: 6.85618257522583
Epoch: 7, Steps: 570 | Train Loss: 0.1572498 Vali Loss: 0.0331582 Test Loss: 0.1148065
Validation loss decreased (0.033235 --> 0.033158).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1108311
	speed: 0.0403s/iter; left time: 294.3336s
	iters: 200, epoch: 8 | loss: 0.1789974
	speed: 0.0114s/iter; left time: 82.3277s
	iters: 300, epoch: 8 | loss: 0.1097472
	speed: 0.0114s/iter; left time: 81.1559s
	iters: 400, epoch: 8 | loss: 0.1341088
	speed: 0.0114s/iter; left time: 80.0005s
	iters: 500, epoch: 8 | loss: 0.1197811
	speed: 0.0114s/iter; left time: 78.8716s
Epoch: 8 cost time: 6.802656412124634
Epoch: 8, Steps: 570 | Train Loss: 0.1564419 Vali Loss: 0.0330753 Test Loss: 0.1149265
Validation loss decreased (0.033158 --> 0.033075).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2366606
	speed: 0.0386s/iter; left time: 260.1743s
	iters: 200, epoch: 9 | loss: 0.0974330
	speed: 0.0114s/iter; left time: 75.7377s
	iters: 300, epoch: 9 | loss: 0.1771183
	speed: 0.0114s/iter; left time: 74.5806s
	iters: 400, epoch: 9 | loss: 0.1559212
	speed: 0.0114s/iter; left time: 73.5260s
	iters: 500, epoch: 9 | loss: 0.2352924
	speed: 0.0114s/iter; left time: 72.2845s
Epoch: 9 cost time: 6.792601823806763
Epoch: 9, Steps: 570 | Train Loss: 0.1559884 Vali Loss: 0.0329286 Test Loss: 0.1148399
Validation loss decreased (0.033075 --> 0.032929).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1544387
	speed: 0.0378s/iter; left time: 233.4212s
	iters: 200, epoch: 10 | loss: 0.1312058
	speed: 0.0115s/iter; left time: 69.7896s
	iters: 300, epoch: 10 | loss: 0.1314943
	speed: 0.0115s/iter; left time: 68.4299s
	iters: 400, epoch: 10 | loss: 0.1537002
	speed: 0.0124s/iter; left time: 72.6720s
	iters: 500, epoch: 10 | loss: 0.1846287
	speed: 0.0127s/iter; left time: 73.5398s
Epoch: 10 cost time: 7.160845756530762
Epoch: 10, Steps: 570 | Train Loss: 0.1570311 Vali Loss: 0.0329866 Test Loss: 0.1148050
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1095827
	speed: 0.0415s/iter; left time: 232.5837s
	iters: 200, epoch: 11 | loss: 0.1651166
	speed: 0.0128s/iter; left time: 70.3328s
	iters: 300, epoch: 11 | loss: 0.1487937
	speed: 0.0128s/iter; left time: 68.9037s
	iters: 400, epoch: 11 | loss: 0.1888719
	speed: 0.0128s/iter; left time: 67.7903s
	iters: 500, epoch: 11 | loss: 0.2253432
	speed: 0.0128s/iter; left time: 66.4236s
Epoch: 11 cost time: 7.5437331199646
Epoch: 11, Steps: 570 | Train Loss: 0.1579002 Vali Loss: 0.0329564 Test Loss: 0.1147904
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1421719
	speed: 0.0412s/iter; left time: 207.3762s
	iters: 200, epoch: 12 | loss: 0.1545370
	speed: 0.0127s/iter; left time: 62.6008s
	iters: 300, epoch: 12 | loss: 0.1321058
	speed: 0.0127s/iter; left time: 61.1542s
	iters: 400, epoch: 12 | loss: 0.2140703
	speed: 0.0114s/iter; left time: 54.0668s
	iters: 500, epoch: 12 | loss: 0.1480176
	speed: 0.0120s/iter; left time: 55.7523s
Epoch: 12 cost time: 7.343310594558716
Epoch: 12, Steps: 570 | Train Loss: 0.1564680 Vali Loss: 0.0331885 Test Loss: 0.1147886
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11496024578809738, mae:0.20377051830291748
>>> MS_Pen LR=1e-4 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2957368
	speed: 0.0224s/iter; left time: 252.8732s
	iters: 200, epoch: 1 | loss: 0.3116432
	speed: 0.0108s/iter; left time: 120.6352s
	iters: 300, epoch: 1 | loss: 0.3468147
	speed: 0.0108s/iter; left time: 119.8913s
	iters: 400, epoch: 1 | loss: 0.2610824
	speed: 0.0108s/iter; left time: 118.5592s
	iters: 500, epoch: 1 | loss: 0.2366723
	speed: 0.0108s/iter; left time: 117.5663s
Epoch: 1 cost time: 7.354534149169922
Epoch: 1, Steps: 570 | Train Loss: 0.2473057 Vali Loss: 0.0426199 Test Loss: 0.1317750
Validation loss decreased (inf --> 0.042620).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2848426
	speed: 0.0365s/iter; left time: 392.2093s
	iters: 200, epoch: 2 | loss: 0.2974930
	speed: 0.0108s/iter; left time: 115.2148s
	iters: 300, epoch: 2 | loss: 0.1796360
	speed: 0.0108s/iter; left time: 114.0516s
	iters: 400, epoch: 2 | loss: 0.1760403
	speed: 0.0108s/iter; left time: 112.9554s
	iters: 500, epoch: 2 | loss: 0.1737424
	speed: 0.0108s/iter; left time: 111.4558s
Epoch: 2 cost time: 6.467919826507568
Epoch: 2, Steps: 570 | Train Loss: 0.2125971 Vali Loss: 0.0416446 Test Loss: 0.1344191
Validation loss decreased (0.042620 --> 0.041645).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1667466
	speed: 0.0390s/iter; left time: 395.8062s
	iters: 200, epoch: 3 | loss: 0.1461052
	speed: 0.0113s/iter; left time: 113.5273s
	iters: 300, epoch: 3 | loss: 0.2261353
	speed: 0.0109s/iter; left time: 108.1052s
	iters: 400, epoch: 3 | loss: 0.1504988
	speed: 0.0108s/iter; left time: 106.9651s
	iters: 500, epoch: 3 | loss: 0.1792159
	speed: 0.0108s/iter; left time: 105.7580s
Epoch: 3 cost time: 6.635428428649902
Epoch: 3, Steps: 570 | Train Loss: 0.1931780 Vali Loss: 0.0396206 Test Loss: 0.1278595
Validation loss decreased (0.041645 --> 0.039621).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1745459
	speed: 0.0377s/iter; left time: 361.4359s
	iters: 200, epoch: 4 | loss: 0.1221418
	speed: 0.0108s/iter; left time: 102.5781s
	iters: 300, epoch: 4 | loss: 0.1601785
	speed: 0.0108s/iter; left time: 101.6258s
	iters: 400, epoch: 4 | loss: 0.2872136
	speed: 0.0108s/iter; left time: 100.6534s
	iters: 500, epoch: 4 | loss: 0.1871723
	speed: 0.0108s/iter; left time: 99.2868s
Epoch: 4 cost time: 6.470252990722656
Epoch: 4, Steps: 570 | Train Loss: 0.1821647 Vali Loss: 0.0383715 Test Loss: 0.1304368
Validation loss decreased (0.039621 --> 0.038372).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1721859
	speed: 0.0367s/iter; left time: 331.1077s
	iters: 200, epoch: 5 | loss: 0.1675583
	speed: 0.0108s/iter; left time: 96.7482s
	iters: 300, epoch: 5 | loss: 0.1746711
	speed: 0.0108s/iter; left time: 95.6154s
	iters: 400, epoch: 5 | loss: 0.1280153
	speed: 0.0108s/iter; left time: 94.2638s
	iters: 500, epoch: 5 | loss: 0.2370186
	speed: 0.0108s/iter; left time: 93.1287s
Epoch: 5 cost time: 6.474569082260132
Epoch: 5, Steps: 570 | Train Loss: 0.1764155 Vali Loss: 0.0375332 Test Loss: 0.1294513
Validation loss decreased (0.038372 --> 0.037533).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1674798
	speed: 0.0380s/iter; left time: 321.0030s
	iters: 200, epoch: 6 | loss: 0.1578027
	speed: 0.0109s/iter; left time: 90.6650s
	iters: 300, epoch: 6 | loss: 0.1725442
	speed: 0.0108s/iter; left time: 89.4179s
	iters: 400, epoch: 6 | loss: 0.1428881
	speed: 0.0108s/iter; left time: 87.9392s
	iters: 500, epoch: 6 | loss: 0.1940344
	speed: 0.0108s/iter; left time: 86.6782s
Epoch: 6 cost time: 6.461792469024658
Epoch: 6, Steps: 570 | Train Loss: 0.1739720 Vali Loss: 0.0376300 Test Loss: 0.1310464
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1575330
	speed: 0.0361s/iter; left time: 284.2402s
	iters: 200, epoch: 7 | loss: 0.1507619
	speed: 0.0108s/iter; left time: 84.2627s
	iters: 300, epoch: 7 | loss: 0.1085737
	speed: 0.0108s/iter; left time: 83.2827s
	iters: 400, epoch: 7 | loss: 0.1701179
	speed: 0.0109s/iter; left time: 82.2887s
	iters: 500, epoch: 7 | loss: 0.1279794
	speed: 0.0108s/iter; left time: 81.1014s
Epoch: 7 cost time: 6.425813436508179
Epoch: 7, Steps: 570 | Train Loss: 0.1725397 Vali Loss: 0.0374869 Test Loss: 0.1292663
Validation loss decreased (0.037533 --> 0.037487).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1291538
	speed: 0.0364s/iter; left time: 266.2805s
	iters: 200, epoch: 8 | loss: 0.2255145
	speed: 0.0108s/iter; left time: 78.0527s
	iters: 300, epoch: 8 | loss: 0.2317101
	speed: 0.0108s/iter; left time: 76.9104s
	iters: 400, epoch: 8 | loss: 0.1463729
	speed: 0.0108s/iter; left time: 75.5005s
	iters: 500, epoch: 8 | loss: 0.1272588
	speed: 0.0107s/iter; left time: 74.2631s
Epoch: 8 cost time: 6.419845342636108
Epoch: 8, Steps: 570 | Train Loss: 0.1718743 Vali Loss: 0.0372106 Test Loss: 0.1301197
Validation loss decreased (0.037487 --> 0.037211).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1801119
	speed: 0.0379s/iter; left time: 255.3085s
	iters: 200, epoch: 9 | loss: 0.1592484
	speed: 0.0108s/iter; left time: 71.9983s
	iters: 300, epoch: 9 | loss: 0.1967168
	speed: 0.0109s/iter; left time: 71.2807s
	iters: 400, epoch: 9 | loss: 0.1947207
	speed: 0.0109s/iter; left time: 69.9792s
	iters: 500, epoch: 9 | loss: 0.1097460
	speed: 0.0109s/iter; left time: 68.8003s
Epoch: 9 cost time: 6.49365234375
Epoch: 9, Steps: 570 | Train Loss: 0.1711037 Vali Loss: 0.0371267 Test Loss: 0.1298838
Validation loss decreased (0.037211 --> 0.037127).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2030439
	speed: 0.0385s/iter; left time: 237.3950s
	iters: 200, epoch: 10 | loss: 0.1026780
	speed: 0.0108s/iter; left time: 65.7140s
	iters: 300, epoch: 10 | loss: 0.1820401
	speed: 0.0108s/iter; left time: 64.6309s
	iters: 400, epoch: 10 | loss: 0.1471161
	speed: 0.0108s/iter; left time: 63.5049s
	iters: 500, epoch: 10 | loss: 0.1762606
	speed: 0.0108s/iter; left time: 62.2981s
Epoch: 10 cost time: 6.448640584945679
Epoch: 10, Steps: 570 | Train Loss: 0.1714216 Vali Loss: 0.0373481 Test Loss: 0.1298840
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1168900
	speed: 0.0357s/iter; left time: 199.9244s
	iters: 200, epoch: 11 | loss: 0.1614511
	speed: 0.0108s/iter; left time: 59.4493s
	iters: 300, epoch: 11 | loss: 0.1467322
	speed: 0.0108s/iter; left time: 58.3005s
	iters: 400, epoch: 11 | loss: 0.1143209
	speed: 0.0108s/iter; left time: 57.2449s
	iters: 500, epoch: 11 | loss: 0.1453470
	speed: 0.0108s/iter; left time: 56.1667s
Epoch: 11 cost time: 6.400113821029663
Epoch: 11, Steps: 570 | Train Loss: 0.1712391 Vali Loss: 0.0372801 Test Loss: 0.1298055
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1659057
	speed: 0.0372s/iter; left time: 187.0656s
	iters: 200, epoch: 12 | loss: 0.2130651
	speed: 0.0108s/iter; left time: 53.2290s
	iters: 300, epoch: 12 | loss: 0.1866367
	speed: 0.0108s/iter; left time: 52.0086s
	iters: 400, epoch: 12 | loss: 0.1676552
	speed: 0.0108s/iter; left time: 51.1057s
	iters: 500, epoch: 12 | loss: 0.2071272
	speed: 0.0108s/iter; left time: 50.0593s
Epoch: 12 cost time: 6.435461044311523
Epoch: 12, Steps: 570 | Train Loss: 0.1713452 Vali Loss: 0.0372611 Test Loss: 0.1298775
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1300416886806488, mae:0.22313885390758514
>>> MS_Pen LR=1e-4 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2076915
	speed: 0.0263s/iter; left time: 297.4597s
	iters: 200, epoch: 1 | loss: 0.1669673
	speed: 0.0146s/iter; left time: 163.6978s
	iters: 300, epoch: 1 | loss: 0.3420948
	speed: 0.0146s/iter; left time: 161.8917s
	iters: 400, epoch: 1 | loss: 0.2008129
	speed: 0.0146s/iter; left time: 160.6959s
	iters: 500, epoch: 1 | loss: 0.1757239
	speed: 0.0146s/iter; left time: 159.2523s
Epoch: 1 cost time: 9.550593852996826
Epoch: 1, Steps: 570 | Train Loss: 0.2449474 Vali Loss: 0.0437543 Test Loss: 0.1329876
Validation loss decreased (inf --> 0.043754).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2543024
	speed: 0.0473s/iter; left time: 507.2016s
	iters: 200, epoch: 2 | loss: 0.1967389
	speed: 0.0145s/iter; left time: 154.3430s
	iters: 300, epoch: 2 | loss: 0.1612048
	speed: 0.0145s/iter; left time: 152.5989s
	iters: 400, epoch: 2 | loss: 0.1164342
	speed: 0.0145s/iter; left time: 151.3973s
	iters: 500, epoch: 2 | loss: 0.2219533
	speed: 0.0145s/iter; left time: 149.9175s
Epoch: 2 cost time: 8.573152303695679
Epoch: 2, Steps: 570 | Train Loss: 0.2093366 Vali Loss: 0.0407388 Test Loss: 0.1284567
Validation loss decreased (0.043754 --> 0.040739).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3145721
	speed: 0.0475s/iter; left time: 482.4144s
	iters: 200, epoch: 3 | loss: 0.2141737
	speed: 0.0146s/iter; left time: 146.4718s
	iters: 300, epoch: 3 | loss: 0.1107289
	speed: 0.0146s/iter; left time: 145.0222s
	iters: 400, epoch: 3 | loss: 0.1587793
	speed: 0.0146s/iter; left time: 143.4798s
	iters: 500, epoch: 3 | loss: 0.1313727
	speed: 0.0145s/iter; left time: 141.6182s
Epoch: 3 cost time: 8.58457899093628
Epoch: 3, Steps: 570 | Train Loss: 0.1921951 Vali Loss: 0.0376989 Test Loss: 0.1240514
Validation loss decreased (0.040739 --> 0.037699).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1660668
	speed: 0.0455s/iter; left time: 436.6281s
	iters: 200, epoch: 4 | loss: 0.1478859
	speed: 0.0145s/iter; left time: 137.4425s
	iters: 300, epoch: 4 | loss: 0.2174951
	speed: 0.0145s/iter; left time: 136.2427s
	iters: 400, epoch: 4 | loss: 0.2254899
	speed: 0.0145s/iter; left time: 134.6910s
	iters: 500, epoch: 4 | loss: 0.1575326
	speed: 0.0145s/iter; left time: 133.2165s
Epoch: 4 cost time: 8.556115865707397
Epoch: 4, Steps: 570 | Train Loss: 0.1834718 Vali Loss: 0.0369107 Test Loss: 0.1214162
Validation loss decreased (0.037699 --> 0.036911).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1550264
	speed: 0.0459s/iter; left time: 413.7585s
	iters: 200, epoch: 5 | loss: 0.1743245
	speed: 0.0144s/iter; left time: 128.6830s
	iters: 300, epoch: 5 | loss: 0.1526030
	speed: 0.0144s/iter; left time: 127.3086s
	iters: 400, epoch: 5 | loss: 0.2383400
	speed: 0.0144s/iter; left time: 125.6813s
	iters: 500, epoch: 5 | loss: 0.1946024
	speed: 0.0144s/iter; left time: 124.2283s
Epoch: 5 cost time: 8.505615949630737
Epoch: 5, Steps: 570 | Train Loss: 0.1802595 Vali Loss: 0.0367323 Test Loss: 0.1203340
Validation loss decreased (0.036911 --> 0.036732).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1309354
	speed: 0.0482s/iter; left time: 407.3493s
	iters: 200, epoch: 6 | loss: 0.1558446
	speed: 0.0145s/iter; left time: 120.6969s
	iters: 300, epoch: 6 | loss: 0.1183258
	speed: 0.0144s/iter; left time: 119.1909s
	iters: 400, epoch: 6 | loss: 0.1289058
	speed: 0.0145s/iter; left time: 118.0970s
	iters: 500, epoch: 6 | loss: 0.1810297
	speed: 0.0145s/iter; left time: 116.5081s
Epoch: 6 cost time: 8.55304479598999
Epoch: 6, Steps: 570 | Train Loss: 0.1774192 Vali Loss: 0.0365234 Test Loss: 0.1205895
Validation loss decreased (0.036732 --> 0.036523).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1655728
	speed: 0.0473s/iter; left time: 372.8791s
	iters: 200, epoch: 7 | loss: 0.1363716
	speed: 0.0146s/iter; left time: 113.7612s
	iters: 300, epoch: 7 | loss: 0.1650240
	speed: 0.0146s/iter; left time: 112.2119s
	iters: 400, epoch: 7 | loss: 0.1740936
	speed: 0.0146s/iter; left time: 110.3707s
	iters: 500, epoch: 7 | loss: 0.2833721
	speed: 0.0146s/iter; left time: 109.3579s
Epoch: 7 cost time: 8.613916873931885
Epoch: 7, Steps: 570 | Train Loss: 0.1773736 Vali Loss: 0.0365614 Test Loss: 0.1203906
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2515069
	speed: 0.0461s/iter; left time: 336.7892s
	iters: 200, epoch: 8 | loss: 0.2063299
	speed: 0.0145s/iter; left time: 104.5478s
	iters: 300, epoch: 8 | loss: 0.2526332
	speed: 0.0145s/iter; left time: 103.1777s
	iters: 400, epoch: 8 | loss: 0.1260950
	speed: 0.0145s/iter; left time: 101.7546s
	iters: 500, epoch: 8 | loss: 0.1727222
	speed: 0.0145s/iter; left time: 100.5345s
Epoch: 8 cost time: 8.564666032791138
Epoch: 8, Steps: 570 | Train Loss: 0.1762861 Vali Loss: 0.0365030 Test Loss: 0.1204473
Validation loss decreased (0.036523 --> 0.036503).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2799229
	speed: 0.0476s/iter; left time: 321.0437s
	iters: 200, epoch: 9 | loss: 0.2036543
	speed: 0.0145s/iter; left time: 96.3707s
	iters: 300, epoch: 9 | loss: 0.2710684
	speed: 0.0146s/iter; left time: 95.1865s
	iters: 400, epoch: 9 | loss: 0.2192649
	speed: 0.0146s/iter; left time: 93.7237s
	iters: 500, epoch: 9 | loss: 0.1402839
	speed: 0.0146s/iter; left time: 92.3170s
Epoch: 9 cost time: 8.593843936920166
Epoch: 9, Steps: 570 | Train Loss: 0.1751819 Vali Loss: 0.0365215 Test Loss: 0.1202174
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2131045
	speed: 0.0454s/iter; left time: 280.2212s
	iters: 200, epoch: 10 | loss: 0.1263691
	speed: 0.0145s/iter; left time: 88.1814s
	iters: 300, epoch: 10 | loss: 0.1346086
	speed: 0.0145s/iter; left time: 86.8580s
	iters: 400, epoch: 10 | loss: 0.1274619
	speed: 0.0146s/iter; left time: 85.5771s
	iters: 500, epoch: 10 | loss: 0.1968619
	speed: 0.0145s/iter; left time: 83.8436s
Epoch: 10 cost time: 8.57069706916809
Epoch: 10, Steps: 570 | Train Loss: 0.1767008 Vali Loss: 0.0363056 Test Loss: 0.1200935
Validation loss decreased (0.036503 --> 0.036306).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1381898
	speed: 0.0478s/iter; left time: 267.5796s
	iters: 200, epoch: 11 | loss: 0.1513432
	speed: 0.0146s/iter; left time: 80.2072s
	iters: 300, epoch: 11 | loss: 0.1540714
	speed: 0.0146s/iter; left time: 78.9658s
	iters: 400, epoch: 11 | loss: 0.1391309
	speed: 0.0155s/iter; left time: 82.2119s
	iters: 500, epoch: 11 | loss: 0.1656446
	speed: 0.0163s/iter; left time: 84.7578s
Epoch: 11 cost time: 9.063497304916382
Epoch: 11, Steps: 570 | Train Loss: 0.1759668 Vali Loss: 0.0363562 Test Loss: 0.1200733
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1364668
	speed: 0.0491s/iter; left time: 247.0070s
	iters: 200, epoch: 12 | loss: 0.1297549
	speed: 0.0145s/iter; left time: 71.6908s
	iters: 300, epoch: 12 | loss: 0.2128720
	speed: 0.0146s/iter; left time: 70.3154s
	iters: 400, epoch: 12 | loss: 0.2007768
	speed: 0.0145s/iter; left time: 68.7916s
	iters: 500, epoch: 12 | loss: 0.1548320
	speed: 0.0146s/iter; left time: 67.4192s
Epoch: 12 cost time: 8.608341217041016
Epoch: 12, Steps: 570 | Train Loss: 0.1754436 Vali Loss: 0.0363805 Test Loss: 0.1200651
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1936179
	speed: 0.0474s/iter; left time: 211.4258s
	iters: 200, epoch: 13 | loss: 0.2701243
	speed: 0.0145s/iter; left time: 63.2103s
	iters: 300, epoch: 13 | loss: 0.2516116
	speed: 0.0145s/iter; left time: 61.7275s
	iters: 400, epoch: 13 | loss: 0.1130642
	speed: 0.0145s/iter; left time: 60.2370s
	iters: 500, epoch: 13 | loss: 0.1779097
	speed: 0.0145s/iter; left time: 58.8392s
Epoch: 13 cost time: 8.535890340805054
Epoch: 13, Steps: 570 | Train Loss: 0.1762574 Vali Loss: 0.0363155 Test Loss: 0.1200614
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12021231651306152, mae:0.20964296162128448
>>> MS_Pen LR=1e-4 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.3318382
	speed: 0.0280s/iter; left time: 316.3457s
	iters: 200, epoch: 1 | loss: 0.2646594
	speed: 0.0161s/iter; left time: 180.0602s
	iters: 300, epoch: 1 | loss: 0.1235915
	speed: 0.0161s/iter; left time: 178.3614s
	iters: 400, epoch: 1 | loss: 0.3208022
	speed: 0.0161s/iter; left time: 176.8008s
	iters: 500, epoch: 1 | loss: 0.1957245
	speed: 0.0161s/iter; left time: 175.1346s
Epoch: 1 cost time: 10.406342506408691
Epoch: 1, Steps: 570 | Train Loss: 0.2220911 Vali Loss: 0.0390707 Test Loss: 0.1188754
Validation loss decreased (inf --> 0.039071).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1654077
	speed: 0.0472s/iter; left time: 506.9136s
	iters: 200, epoch: 2 | loss: 0.2960847
	speed: 0.0143s/iter; left time: 152.2374s
	iters: 300, epoch: 2 | loss: 0.2026319
	speed: 0.0144s/iter; left time: 151.3025s
	iters: 400, epoch: 2 | loss: 0.1590572
	speed: 0.0143s/iter; left time: 149.5090s
	iters: 500, epoch: 2 | loss: 0.1841556
	speed: 0.0143s/iter; left time: 147.8278s
Epoch: 2 cost time: 8.456781148910522
Epoch: 2, Steps: 570 | Train Loss: 0.1929021 Vali Loss: 0.0369388 Test Loss: 0.1164238
Validation loss decreased (0.039071 --> 0.036939).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1697481
	speed: 0.0465s/iter; left time: 472.8716s
	iters: 200, epoch: 3 | loss: 0.0890073
	speed: 0.0143s/iter; left time: 144.2186s
	iters: 300, epoch: 3 | loss: 0.2521964
	speed: 0.0144s/iter; left time: 142.9623s
	iters: 400, epoch: 3 | loss: 0.1432861
	speed: 0.0157s/iter; left time: 154.9320s
	iters: 500, epoch: 3 | loss: 0.1559645
	speed: 0.0165s/iter; left time: 160.9454s
Epoch: 3 cost time: 8.974557399749756
Epoch: 3, Steps: 570 | Train Loss: 0.1765948 Vali Loss: 0.0363700 Test Loss: 0.1180098
Validation loss decreased (0.036939 --> 0.036370).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1766226
	speed: 0.0493s/iter; left time: 472.4326s
	iters: 200, epoch: 4 | loss: 0.1851915
	speed: 0.0165s/iter; left time: 156.6229s
	iters: 300, epoch: 4 | loss: 0.2146439
	speed: 0.0165s/iter; left time: 154.6794s
	iters: 400, epoch: 4 | loss: 0.1153745
	speed: 0.0165s/iter; left time: 153.1458s
	iters: 500, epoch: 4 | loss: 0.1115613
	speed: 0.0165s/iter; left time: 151.2832s
Epoch: 4 cost time: 9.67815637588501
Epoch: 4, Steps: 570 | Train Loss: 0.1716502 Vali Loss: 0.0350995 Test Loss: 0.1160061
Validation loss decreased (0.036370 --> 0.035100).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1115144
	speed: 0.0480s/iter; left time: 433.0837s
	iters: 200, epoch: 5 | loss: 0.2164409
	speed: 0.0142s/iter; left time: 126.8886s
	iters: 300, epoch: 5 | loss: 0.2065855
	speed: 0.0142s/iter; left time: 125.3968s
	iters: 400, epoch: 5 | loss: 0.1339945
	speed: 0.0142s/iter; left time: 124.2233s
	iters: 500, epoch: 5 | loss: 0.1916317
	speed: 0.0142s/iter; left time: 122.8353s
Epoch: 5 cost time: 8.539005517959595
Epoch: 5, Steps: 570 | Train Loss: 0.1678726 Vali Loss: 0.0353282 Test Loss: 0.1152311
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1640269
	speed: 0.0488s/iter; left time: 412.4297s
	iters: 200, epoch: 6 | loss: 0.2883618
	speed: 0.0160s/iter; left time: 133.7313s
	iters: 300, epoch: 6 | loss: 0.2543339
	speed: 0.0160s/iter; left time: 132.1152s
	iters: 400, epoch: 6 | loss: 0.1717510
	speed: 0.0160s/iter; left time: 130.5380s
	iters: 500, epoch: 6 | loss: 0.1912903
	speed: 0.0160s/iter; left time: 128.9370s
Epoch: 6 cost time: 9.406858205795288
Epoch: 6, Steps: 570 | Train Loss: 0.1674088 Vali Loss: 0.0345374 Test Loss: 0.1144441
Validation loss decreased (0.035100 --> 0.034537).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1227947
	speed: 0.0478s/iter; left time: 376.3559s
	iters: 200, epoch: 7 | loss: 0.1726050
	speed: 0.0142s/iter; left time: 110.1705s
	iters: 300, epoch: 7 | loss: 0.2558137
	speed: 0.0142s/iter; left time: 108.7572s
	iters: 400, epoch: 7 | loss: 0.1526000
	speed: 0.0142s/iter; left time: 107.3721s
	iters: 500, epoch: 7 | loss: 0.2200907
	speed: 0.0142s/iter; left time: 105.9981s
Epoch: 7 cost time: 8.379677534103394
Epoch: 7, Steps: 570 | Train Loss: 0.1656428 Vali Loss: 0.0346819 Test Loss: 0.1147758
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1179875
	speed: 0.0457s/iter; left time: 334.2007s
	iters: 200, epoch: 8 | loss: 0.1460300
	speed: 0.0143s/iter; left time: 102.9460s
	iters: 300, epoch: 8 | loss: 0.2342202
	speed: 0.0154s/iter; left time: 109.6948s
	iters: 400, epoch: 8 | loss: 0.1758269
	speed: 0.0165s/iter; left time: 115.8301s
	iters: 500, epoch: 8 | loss: 0.1732931
	speed: 0.0165s/iter; left time: 114.0838s
Epoch: 8 cost time: 9.1512291431427
Epoch: 8, Steps: 570 | Train Loss: 0.1652026 Vali Loss: 0.0346103 Test Loss: 0.1145298
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1394207
	speed: 0.0514s/iter; left time: 346.3057s
	iters: 200, epoch: 9 | loss: 0.1313790
	speed: 0.0164s/iter; left time: 109.2064s
	iters: 300, epoch: 9 | loss: 0.1973137
	speed: 0.0164s/iter; left time: 107.3513s
	iters: 400, epoch: 9 | loss: 0.1685974
	speed: 0.0164s/iter; left time: 105.7847s
	iters: 500, epoch: 9 | loss: 0.1991745
	speed: 0.0164s/iter; left time: 104.0668s
Epoch: 9 cost time: 9.639786720275879
Epoch: 9, Steps: 570 | Train Loss: 0.1643503 Vali Loss: 0.0345283 Test Loss: 0.1146079
Validation loss decreased (0.034537 --> 0.034528).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1666296
	speed: 0.0494s/iter; left time: 304.8078s
	iters: 200, epoch: 10 | loss: 0.1288713
	speed: 0.0162s/iter; left time: 98.0885s
	iters: 300, epoch: 10 | loss: 0.1530732
	speed: 0.0148s/iter; left time: 88.2008s
	iters: 400, epoch: 10 | loss: 0.1500295
	speed: 0.0143s/iter; left time: 83.9324s
	iters: 500, epoch: 10 | loss: 0.1789586
	speed: 0.0143s/iter; left time: 82.5283s
Epoch: 10 cost time: 8.888127088546753
Epoch: 10, Steps: 570 | Train Loss: 0.1642043 Vali Loss: 0.0345274 Test Loss: 0.1146160
Validation loss decreased (0.034528 --> 0.034527).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2401495
	speed: 0.0469s/iter; left time: 262.4416s
	iters: 200, epoch: 11 | loss: 0.1937545
	speed: 0.0143s/iter; left time: 78.7495s
	iters: 300, epoch: 11 | loss: 0.1908901
	speed: 0.0143s/iter; left time: 77.0781s
	iters: 400, epoch: 11 | loss: 0.1103651
	speed: 0.0143s/iter; left time: 75.7037s
	iters: 500, epoch: 11 | loss: 0.2983982
	speed: 0.0143s/iter; left time: 74.1554s
Epoch: 11 cost time: 8.437992334365845
Epoch: 11, Steps: 570 | Train Loss: 0.1635729 Vali Loss: 0.0345308 Test Loss: 0.1146267
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2358661
	speed: 0.0505s/iter; left time: 253.8340s
	iters: 200, epoch: 12 | loss: 0.1887277
	speed: 0.0161s/iter; left time: 79.5731s
	iters: 300, epoch: 12 | loss: 0.1250973
	speed: 0.0162s/iter; left time: 78.0270s
	iters: 400, epoch: 12 | loss: 0.1747892
	speed: 0.0152s/iter; left time: 71.7481s
	iters: 500, epoch: 12 | loss: 0.1884075
	speed: 0.0143s/iter; left time: 66.3018s
Epoch: 12 cost time: 9.094375371932983
Epoch: 12, Steps: 570 | Train Loss: 0.1656141 Vali Loss: 0.0345844 Test Loss: 0.1146329
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1328822
	speed: 0.0463s/iter; left time: 206.7589s
	iters: 200, epoch: 13 | loss: 0.1215490
	speed: 0.0143s/iter; left time: 62.3754s
	iters: 300, epoch: 13 | loss: 0.1337677
	speed: 0.0143s/iter; left time: 60.9353s
	iters: 400, epoch: 13 | loss: 0.1044099
	speed: 0.0143s/iter; left time: 59.5642s
	iters: 500, epoch: 13 | loss: 0.1869902
	speed: 0.0143s/iter; left time: 58.1276s
Epoch: 13 cost time: 8.423014163970947
Epoch: 13, Steps: 570 | Train Loss: 0.1644760 Vali Loss: 0.0345125 Test Loss: 0.1146341
Validation loss decreased (0.034527 --> 0.034513).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1420435
	speed: 0.0457s/iter; left time: 177.7285s
	iters: 200, epoch: 14 | loss: 0.2486636
	speed: 0.0142s/iter; left time: 53.9843s
	iters: 300, epoch: 14 | loss: 0.1131210
	speed: 0.0143s/iter; left time: 52.6062s
	iters: 400, epoch: 14 | loss: 0.1114499
	speed: 0.0142s/iter; left time: 51.1659s
	iters: 500, epoch: 14 | loss: 0.1427300
	speed: 0.0142s/iter; left time: 49.7243s
Epoch: 14 cost time: 8.417864084243774
Epoch: 14, Steps: 570 | Train Loss: 0.1633263 Vali Loss: 0.0345608 Test Loss: 0.1146327
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1417647
	speed: 0.0472s/iter; left time: 156.7759s
	iters: 200, epoch: 15 | loss: 0.1213435
	speed: 0.0164s/iter; left time: 52.7469s
	iters: 300, epoch: 15 | loss: 0.1835667
	speed: 0.0164s/iter; left time: 51.1956s
	iters: 400, epoch: 15 | loss: 0.1689920
	speed: 0.0164s/iter; left time: 49.5480s
	iters: 500, epoch: 15 | loss: 0.2062181
	speed: 0.0164s/iter; left time: 47.8933s
Epoch: 15 cost time: 9.577792644500732
Epoch: 15, Steps: 570 | Train Loss: 0.1641809 Vali Loss: 0.0345108 Test Loss: 0.1146316
Validation loss decreased (0.034513 --> 0.034511).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1735362
	speed: 0.0487s/iter; left time: 133.9444s
	iters: 200, epoch: 16 | loss: 0.1663694
	speed: 0.0163s/iter; left time: 43.2711s
	iters: 300, epoch: 16 | loss: 0.1547249
	speed: 0.0163s/iter; left time: 41.6873s
	iters: 400, epoch: 16 | loss: 0.1879139
	speed: 0.0163s/iter; left time: 40.0000s
	iters: 500, epoch: 16 | loss: 0.1363570
	speed: 0.0163s/iter; left time: 38.3678s
Epoch: 16 cost time: 9.59330439567566
Epoch: 16, Steps: 570 | Train Loss: 0.1640498 Vali Loss: 0.0346559 Test Loss: 0.1146313
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1279487
	speed: 0.0509s/iter; left time: 110.9320s
	iters: 200, epoch: 17 | loss: 0.1819420
	speed: 0.0154s/iter; left time: 32.1456s
	iters: 300, epoch: 17 | loss: 0.1353915
	speed: 0.0143s/iter; left time: 28.3652s
	iters: 400, epoch: 17 | loss: 0.1508448
	speed: 0.0143s/iter; left time: 26.9256s
	iters: 500, epoch: 17 | loss: 0.1643781
	speed: 0.0143s/iter; left time: 25.4760s
Epoch: 17 cost time: 8.731524229049683
Epoch: 17, Steps: 570 | Train Loss: 0.1647285 Vali Loss: 0.0347395 Test Loss: 0.1146317
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1636906
	speed: 0.0465s/iter; left time: 74.8526s
	iters: 200, epoch: 18 | loss: 0.1440516
	speed: 0.0160s/iter; left time: 24.1850s
	iters: 300, epoch: 18 | loss: 0.2172034
	speed: 0.0160s/iter; left time: 22.5912s
	iters: 400, epoch: 18 | loss: 0.1288206
	speed: 0.0160s/iter; left time: 20.9949s
	iters: 500, epoch: 18 | loss: 0.1374308
	speed: 0.0149s/iter; left time: 18.0421s
Epoch: 18 cost time: 9.265817642211914
Epoch: 18, Steps: 570 | Train Loss: 0.1635992 Vali Loss: 0.0346753 Test Loss: 0.1146316
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11474120616912842, mae:0.2041730135679245
>>> MS_Pen LR=1e-4 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1485409
	speed: 0.0280s/iter; left time: 316.5233s
	iters: 200, epoch: 1 | loss: 0.3358210
	speed: 0.0160s/iter; left time: 179.5130s
	iters: 300, epoch: 1 | loss: 0.3098524
	speed: 0.0160s/iter; left time: 177.6816s
	iters: 400, epoch: 1 | loss: 0.2429222
	speed: 0.0160s/iter; left time: 176.4355s
	iters: 500, epoch: 1 | loss: 0.2733594
	speed: 0.0161s/iter; left time: 175.3217s
Epoch: 1 cost time: 10.387446641921997
Epoch: 1, Steps: 570 | Train Loss: 0.2509659 Vali Loss: 0.0450613 Test Loss: 0.1405806
Validation loss decreased (inf --> 0.045061).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1815225
	speed: 0.0502s/iter; left time: 538.8522s
	iters: 200, epoch: 2 | loss: 0.1459487
	speed: 0.0143s/iter; left time: 151.7324s
	iters: 300, epoch: 2 | loss: 0.1371435
	speed: 0.0143s/iter; left time: 150.1792s
	iters: 400, epoch: 2 | loss: 0.1535204
	speed: 0.0143s/iter; left time: 149.1864s
	iters: 500, epoch: 2 | loss: 0.2092780
	speed: 0.0158s/iter; left time: 163.6579s
Epoch: 2 cost time: 8.745670795440674
Epoch: 2, Steps: 570 | Train Loss: 0.2146490 Vali Loss: 0.0420394 Test Loss: 0.1341150
Validation loss decreased (0.045061 --> 0.042039).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2321647
	speed: 0.0496s/iter; left time: 504.4729s
	iters: 200, epoch: 3 | loss: 0.2423976
	speed: 0.0142s/iter; left time: 142.3880s
	iters: 300, epoch: 3 | loss: 0.1600477
	speed: 0.0142s/iter; left time: 141.1390s
	iters: 400, epoch: 3 | loss: 0.1810560
	speed: 0.0141s/iter; left time: 139.2015s
	iters: 500, epoch: 3 | loss: 0.2288408
	speed: 0.0142s/iter; left time: 138.4388s
Epoch: 3 cost time: 8.545275688171387
Epoch: 3, Steps: 570 | Train Loss: 0.1982034 Vali Loss: 0.0397255 Test Loss: 0.1266454
Validation loss decreased (0.042039 --> 0.039726).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2431486
	speed: 0.0457s/iter; left time: 437.8464s
	iters: 200, epoch: 4 | loss: 0.1845106
	speed: 0.0143s/iter; left time: 135.3438s
	iters: 300, epoch: 4 | loss: 0.2028913
	speed: 0.0143s/iter; left time: 133.9014s
	iters: 400, epoch: 4 | loss: 0.1892269
	speed: 0.0143s/iter; left time: 132.5057s
	iters: 500, epoch: 4 | loss: 0.1570657
	speed: 0.0143s/iter; left time: 131.0766s
Epoch: 4 cost time: 8.415989398956299
Epoch: 4, Steps: 570 | Train Loss: 0.1906814 Vali Loss: 0.0383264 Test Loss: 0.1269190
Validation loss decreased (0.039726 --> 0.038326).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1749011
	speed: 0.0463s/iter; left time: 417.2890s
	iters: 200, epoch: 5 | loss: 0.1969949
	speed: 0.0143s/iter; left time: 127.6847s
	iters: 300, epoch: 5 | loss: 0.1810000
	speed: 0.0143s/iter; left time: 126.4265s
	iters: 400, epoch: 5 | loss: 0.2574799
	speed: 0.0143s/iter; left time: 124.9128s
	iters: 500, epoch: 5 | loss: 0.1347247
	speed: 0.0144s/iter; left time: 123.7809s
Epoch: 5 cost time: 8.487702131271362
Epoch: 5, Steps: 570 | Train Loss: 0.1860804 Vali Loss: 0.0383466 Test Loss: 0.1255950
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2302452
	speed: 0.0480s/iter; left time: 406.0633s
	iters: 200, epoch: 6 | loss: 0.1818610
	speed: 0.0164s/iter; left time: 136.7224s
	iters: 300, epoch: 6 | loss: 0.1117765
	speed: 0.0164s/iter; left time: 135.1448s
	iters: 400, epoch: 6 | loss: 0.2075163
	speed: 0.0164s/iter; left time: 133.6113s
	iters: 500, epoch: 6 | loss: 0.1755575
	speed: 0.0164s/iter; left time: 131.7171s
Epoch: 6 cost time: 9.5783109664917
Epoch: 6, Steps: 570 | Train Loss: 0.1839553 Vali Loss: 0.0379689 Test Loss: 0.1264438
Validation loss decreased (0.038326 --> 0.037969).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2429986
	speed: 0.0495s/iter; left time: 390.1842s
	iters: 200, epoch: 7 | loss: 0.1203154
	speed: 0.0165s/iter; left time: 128.1590s
	iters: 300, epoch: 7 | loss: 0.1292469
	speed: 0.0143s/iter; left time: 110.0452s
	iters: 400, epoch: 7 | loss: 0.2643755
	speed: 0.0143s/iter; left time: 108.4831s
	iters: 500, epoch: 7 | loss: 0.1680167
	speed: 0.0143s/iter; left time: 107.1821s
Epoch: 7 cost time: 8.911390781402588
Epoch: 7, Steps: 570 | Train Loss: 0.1840649 Vali Loss: 0.0378397 Test Loss: 0.1255145
Validation loss decreased (0.037969 --> 0.037840).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1715347
	speed: 0.0464s/iter; left time: 339.0728s
	iters: 200, epoch: 8 | loss: 0.1541579
	speed: 0.0144s/iter; left time: 103.5934s
	iters: 300, epoch: 8 | loss: 0.1687274
	speed: 0.0144s/iter; left time: 102.1229s
	iters: 400, epoch: 8 | loss: 0.1905409
	speed: 0.0144s/iter; left time: 100.7129s
	iters: 500, epoch: 8 | loss: 0.1412321
	speed: 0.0143s/iter; left time: 99.1031s
Epoch: 8 cost time: 8.466654062271118
Epoch: 8, Steps: 570 | Train Loss: 0.1838720 Vali Loss: 0.0380085 Test Loss: 0.1263936
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2375595
	speed: 0.0458s/iter; left time: 308.6559s
	iters: 200, epoch: 9 | loss: 0.1508759
	speed: 0.0143s/iter; left time: 94.6350s
	iters: 300, epoch: 9 | loss: 0.1181668
	speed: 0.0142s/iter; left time: 92.7913s
	iters: 400, epoch: 9 | loss: 0.1626755
	speed: 0.0142s/iter; left time: 91.5359s
	iters: 500, epoch: 9 | loss: 0.1779878
	speed: 0.0142s/iter; left time: 90.0138s
Epoch: 9 cost time: 8.375670433044434
Epoch: 9, Steps: 570 | Train Loss: 0.1826449 Vali Loss: 0.0378346 Test Loss: 0.1263723
Validation loss decreased (0.037840 --> 0.037835).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2415984
	speed: 0.0477s/iter; left time: 294.2958s
	iters: 200, epoch: 10 | loss: 0.2182284
	speed: 0.0143s/iter; left time: 86.7618s
	iters: 300, epoch: 10 | loss: 0.1567881
	speed: 0.0143s/iter; left time: 85.4251s
	iters: 400, epoch: 10 | loss: 0.2137944
	speed: 0.0143s/iter; left time: 83.6941s
	iters: 500, epoch: 10 | loss: 0.1729621
	speed: 0.0143s/iter; left time: 82.4195s
Epoch: 10 cost time: 8.429018259048462
Epoch: 10, Steps: 570 | Train Loss: 0.1823676 Vali Loss: 0.0379452 Test Loss: 0.1261948
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2413671
	speed: 0.0456s/iter; left time: 255.2061s
	iters: 200, epoch: 11 | loss: 0.1655736
	speed: 0.0142s/iter; left time: 78.0059s
	iters: 300, epoch: 11 | loss: 0.1559473
	speed: 0.0142s/iter; left time: 76.6078s
	iters: 400, epoch: 11 | loss: 0.1777966
	speed: 0.0142s/iter; left time: 75.3027s
	iters: 500, epoch: 11 | loss: 0.1475928
	speed: 0.0142s/iter; left time: 73.7682s
Epoch: 11 cost time: 8.354814291000366
Epoch: 11, Steps: 570 | Train Loss: 0.1822599 Vali Loss: 0.0379346 Test Loss: 0.1262294
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1338001
	speed: 0.0472s/iter; left time: 237.5023s
	iters: 200, epoch: 12 | loss: 0.1267924
	speed: 0.0142s/iter; left time: 69.7787s
	iters: 300, epoch: 12 | loss: 0.1908676
	speed: 0.0142s/iter; left time: 68.4987s
	iters: 400, epoch: 12 | loss: 0.1075668
	speed: 0.0142s/iter; left time: 66.9514s
	iters: 500, epoch: 12 | loss: 0.2560067
	speed: 0.0142s/iter; left time: 65.5761s
Epoch: 12 cost time: 8.39227294921875
Epoch: 12, Steps: 570 | Train Loss: 0.1828384 Vali Loss: 0.0377621 Test Loss: 0.1262908
Validation loss decreased (0.037835 --> 0.037762).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1496180
	speed: 0.0460s/iter; left time: 205.3179s
	iters: 200, epoch: 13 | loss: 0.1593371
	speed: 0.0142s/iter; left time: 61.7371s
	iters: 300, epoch: 13 | loss: 0.1774851
	speed: 0.0142s/iter; left time: 60.4131s
	iters: 400, epoch: 13 | loss: 0.1819085
	speed: 0.0142s/iter; left time: 58.9560s
	iters: 500, epoch: 13 | loss: 0.1919512
	speed: 0.0141s/iter; left time: 57.4322s
Epoch: 13 cost time: 8.38829493522644
Epoch: 13, Steps: 570 | Train Loss: 0.1829546 Vali Loss: 0.0380521 Test Loss: 0.1263134
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1849158
	speed: 0.0449s/iter; left time: 174.7764s
	iters: 200, epoch: 14 | loss: 0.2023634
	speed: 0.0143s/iter; left time: 54.1888s
	iters: 300, epoch: 14 | loss: 0.1791568
	speed: 0.0143s/iter; left time: 52.7229s
	iters: 400, epoch: 14 | loss: 0.2239385
	speed: 0.0143s/iter; left time: 51.3172s
	iters: 500, epoch: 14 | loss: 0.1280569
	speed: 0.0142s/iter; left time: 49.7027s
Epoch: 14 cost time: 8.397218704223633
Epoch: 14, Steps: 570 | Train Loss: 0.1817802 Vali Loss: 0.0381035 Test Loss: 0.1263189
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1882418
	speed: 0.0468s/iter; left time: 155.4422s
	iters: 200, epoch: 15 | loss: 0.1382252
	speed: 0.0141s/iter; left time: 45.5069s
	iters: 300, epoch: 15 | loss: 0.2193954
	speed: 0.0141s/iter; left time: 44.0942s
	iters: 400, epoch: 15 | loss: 0.1838796
	speed: 0.0141s/iter; left time: 42.6412s
	iters: 500, epoch: 15 | loss: 0.1462825
	speed: 0.0141s/iter; left time: 41.2134s
Epoch: 15 cost time: 8.334733009338379
Epoch: 15, Steps: 570 | Train Loss: 0.1825597 Vali Loss: 0.0378767 Test Loss: 0.1263238
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12641552090644836, mae:0.22043468058109283
>>> MS_Pen LR=1e-4 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2660874
	speed: 0.0304s/iter; left time: 343.0495s
	iters: 200, epoch: 1 | loss: 0.1986250
	speed: 0.0183s/iter; left time: 205.3606s
	iters: 300, epoch: 1 | loss: 0.2782645
	speed: 0.0184s/iter; left time: 204.2098s
	iters: 400, epoch: 1 | loss: 0.2430459
	speed: 0.0184s/iter; left time: 202.4775s
	iters: 500, epoch: 1 | loss: 0.1784471
	speed: 0.0183s/iter; left time: 199.9575s
Epoch: 1 cost time: 11.718094825744629
Epoch: 1, Steps: 570 | Train Loss: 0.2393464 Vali Loss: 0.0433766 Test Loss: 0.1336387
Validation loss decreased (inf --> 0.043377).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2443941
	speed: 0.0540s/iter; left time: 579.2809s
	iters: 200, epoch: 2 | loss: 0.2416996
	speed: 0.0169s/iter; left time: 179.5622s
	iters: 300, epoch: 2 | loss: 0.2381624
	speed: 0.0169s/iter; left time: 177.9345s
	iters: 400, epoch: 2 | loss: 0.1520671
	speed: 0.0169s/iter; left time: 175.8771s
	iters: 500, epoch: 2 | loss: 0.1570665
	speed: 0.0169s/iter; left time: 174.4917s
Epoch: 2 cost time: 9.906850337982178
Epoch: 2, Steps: 570 | Train Loss: 0.2007228 Vali Loss: 0.0390835 Test Loss: 0.1286327
Validation loss decreased (0.043377 --> 0.039083).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1505983
	speed: 0.0528s/iter; left time: 536.3974s
	iters: 200, epoch: 3 | loss: 0.1703420
	speed: 0.0177s/iter; left time: 177.8642s
	iters: 300, epoch: 3 | loss: 0.3037881
	speed: 0.0184s/iter; left time: 183.2695s
	iters: 400, epoch: 3 | loss: 0.1657946
	speed: 0.0184s/iter; left time: 181.3813s
	iters: 500, epoch: 3 | loss: 0.1531994
	speed: 0.0184s/iter; left time: 179.8572s
Epoch: 3 cost time: 10.593873023986816
Epoch: 3, Steps: 570 | Train Loss: 0.1794783 Vali Loss: 0.0362575 Test Loss: 0.1240489
Validation loss decreased (0.039083 --> 0.036257).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1242284
	speed: 0.0527s/iter; left time: 505.7575s
	iters: 200, epoch: 4 | loss: 0.1862285
	speed: 0.0170s/iter; left time: 161.1136s
	iters: 300, epoch: 4 | loss: 0.1882655
	speed: 0.0170s/iter; left time: 159.3994s
	iters: 400, epoch: 4 | loss: 0.2238969
	speed: 0.0169s/iter; left time: 157.4072s
	iters: 500, epoch: 4 | loss: 0.1548983
	speed: 0.0169s/iter; left time: 155.5852s
Epoch: 4 cost time: 10.076270818710327
Epoch: 4, Steps: 570 | Train Loss: 0.1684444 Vali Loss: 0.0345750 Test Loss: 0.1236301
Validation loss decreased (0.036257 --> 0.034575).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1289224
	speed: 0.0514s/iter; left time: 463.5689s
	iters: 200, epoch: 5 | loss: 0.1971422
	speed: 0.0169s/iter; left time: 150.5758s
	iters: 300, epoch: 5 | loss: 0.1663008
	speed: 0.0169s/iter; left time: 148.9110s
	iters: 400, epoch: 5 | loss: 0.1788763
	speed: 0.0169s/iter; left time: 147.1555s
	iters: 500, epoch: 5 | loss: 0.1209621
	speed: 0.0169s/iter; left time: 145.5106s
Epoch: 5 cost time: 9.90195631980896
Epoch: 5, Steps: 570 | Train Loss: 0.1621844 Vali Loss: 0.0344574 Test Loss: 0.1243177
Validation loss decreased (0.034575 --> 0.034457).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2032246
	speed: 0.0528s/iter; left time: 446.5912s
	iters: 200, epoch: 6 | loss: 0.1393926
	speed: 0.0169s/iter; left time: 141.1751s
	iters: 300, epoch: 6 | loss: 0.1823348
	speed: 0.0179s/iter; left time: 147.7209s
	iters: 400, epoch: 6 | loss: 0.2353372
	speed: 0.0181s/iter; left time: 147.5965s
	iters: 500, epoch: 6 | loss: 0.1327100
	speed: 0.0181s/iter; left time: 145.7720s
Epoch: 6 cost time: 10.378138780593872
Epoch: 6, Steps: 570 | Train Loss: 0.1591106 Vali Loss: 0.0345226 Test Loss: 0.1232189
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1508404
	speed: 0.0530s/iter; left time: 417.7610s
	iters: 200, epoch: 7 | loss: 0.1900335
	speed: 0.0181s/iter; left time: 140.5837s
	iters: 300, epoch: 7 | loss: 0.1845222
	speed: 0.0181s/iter; left time: 138.7348s
	iters: 400, epoch: 7 | loss: 0.1260091
	speed: 0.0181s/iter; left time: 136.9680s
	iters: 500, epoch: 7 | loss: 0.1484068
	speed: 0.0182s/iter; left time: 136.1443s
Epoch: 7 cost time: 10.524833679199219
Epoch: 7, Steps: 570 | Train Loss: 0.1578321 Vali Loss: 0.0339050 Test Loss: 0.1228313
Validation loss decreased (0.034457 --> 0.033905).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1542115
	speed: 0.0524s/iter; left time: 382.8302s
	iters: 200, epoch: 8 | loss: 0.0996163
	speed: 0.0168s/iter; left time: 121.4732s
	iters: 300, epoch: 8 | loss: 0.1450516
	speed: 0.0168s/iter; left time: 119.7584s
	iters: 400, epoch: 8 | loss: 0.0907396
	speed: 0.0168s/iter; left time: 118.0738s
	iters: 500, epoch: 8 | loss: 0.1351144
	speed: 0.0168s/iter; left time: 116.3656s
Epoch: 8 cost time: 9.919688701629639
Epoch: 8, Steps: 570 | Train Loss: 0.1571811 Vali Loss: 0.0340199 Test Loss: 0.1228729
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1404670
	speed: 0.0500s/iter; left time: 337.3246s
	iters: 200, epoch: 9 | loss: 0.1099864
	speed: 0.0169s/iter; left time: 112.3277s
	iters: 300, epoch: 9 | loss: 0.1568083
	speed: 0.0181s/iter; left time: 118.6449s
	iters: 400, epoch: 9 | loss: 0.1541100
	speed: 0.0181s/iter; left time: 116.8509s
	iters: 500, epoch: 9 | loss: 0.2079807
	speed: 0.0182s/iter; left time: 115.0967s
Epoch: 9 cost time: 10.389451265335083
Epoch: 9, Steps: 570 | Train Loss: 0.1566081 Vali Loss: 0.0338634 Test Loss: 0.1229309
Validation loss decreased (0.033905 --> 0.033863).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2113638
	speed: 0.0532s/iter; left time: 328.2760s
	iters: 200, epoch: 10 | loss: 0.0754247
	speed: 0.0168s/iter; left time: 102.0227s
	iters: 300, epoch: 10 | loss: 0.1814942
	speed: 0.0168s/iter; left time: 100.3272s
	iters: 400, epoch: 10 | loss: 0.1910574
	speed: 0.0168s/iter; left time: 98.6136s
	iters: 500, epoch: 10 | loss: 0.1229500
	speed: 0.0168s/iter; left time: 97.1770s
Epoch: 10 cost time: 9.998546600341797
Epoch: 10, Steps: 570 | Train Loss: 0.1563473 Vali Loss: 0.0340521 Test Loss: 0.1228470
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1096210
	speed: 0.0511s/iter; left time: 286.2622s
	iters: 200, epoch: 11 | loss: 0.1649837
	speed: 0.0183s/iter; left time: 100.9079s
	iters: 300, epoch: 11 | loss: 0.0970127
	speed: 0.0184s/iter; left time: 99.1409s
	iters: 400, epoch: 11 | loss: 0.1576123
	speed: 0.0170s/iter; left time: 90.2221s
	iters: 500, epoch: 11 | loss: 0.2049955
	speed: 0.0168s/iter; left time: 87.5821s
Epoch: 11 cost time: 10.349653720855713
Epoch: 11, Steps: 570 | Train Loss: 0.1565178 Vali Loss: 0.0339963 Test Loss: 0.1228833
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2001580
	speed: 0.0499s/iter; left time: 250.8727s
	iters: 200, epoch: 12 | loss: 0.1692941
	speed: 0.0169s/iter; left time: 83.1026s
	iters: 300, epoch: 12 | loss: 0.1377749
	speed: 0.0169s/iter; left time: 81.4130s
	iters: 400, epoch: 12 | loss: 0.1928929
	speed: 0.0169s/iter; left time: 79.7439s
	iters: 500, epoch: 12 | loss: 0.1886437
	speed: 0.0169s/iter; left time: 78.2140s
Epoch: 12 cost time: 9.872167587280273
Epoch: 12, Steps: 570 | Train Loss: 0.1566569 Vali Loss: 0.0339060 Test Loss: 0.1228779
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12301203608512878, mae:0.2132801115512848
>>> MS_Pen LR=1e-4 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1834204
	speed: 0.0283s/iter; left time: 319.4643s
	iters: 200, epoch: 1 | loss: 0.1374502
	speed: 0.0164s/iter; left time: 183.6593s
	iters: 300, epoch: 1 | loss: 0.2700530
	speed: 0.0164s/iter; left time: 181.6055s
	iters: 400, epoch: 1 | loss: 0.2107592
	speed: 0.0164s/iter; left time: 180.5036s
	iters: 500, epoch: 1 | loss: 0.1209661
	speed: 0.0164s/iter; left time: 178.8389s
Epoch: 1 cost time: 10.583662748336792
Epoch: 1, Steps: 570 | Train Loss: 0.2189329 Vali Loss: 0.0378810 Test Loss: 0.1185543
Validation loss decreased (inf --> 0.037881).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1534948
	speed: 0.0527s/iter; left time: 565.1010s
	iters: 200, epoch: 2 | loss: 0.1417964
	speed: 0.0168s/iter; left time: 179.1163s
	iters: 300, epoch: 2 | loss: 0.2409755
	speed: 0.0179s/iter; left time: 188.3593s
	iters: 400, epoch: 2 | loss: 0.2383643
	speed: 0.0179s/iter; left time: 186.5789s
	iters: 500, epoch: 2 | loss: 0.1785561
	speed: 0.0179s/iter; left time: 184.5394s
Epoch: 2 cost time: 10.412706851959229
Epoch: 2, Steps: 570 | Train Loss: 0.1896234 Vali Loss: 0.0377725 Test Loss: 0.1214357
Validation loss decreased (0.037881 --> 0.037772).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1651219
	speed: 0.0517s/iter; left time: 525.6777s
	iters: 200, epoch: 3 | loss: 0.1717735
	speed: 0.0164s/iter; left time: 165.0767s
	iters: 300, epoch: 3 | loss: 0.1441551
	speed: 0.0164s/iter; left time: 163.3505s
	iters: 400, epoch: 3 | loss: 0.2333685
	speed: 0.0164s/iter; left time: 161.8291s
	iters: 500, epoch: 3 | loss: 0.1132580
	speed: 0.0164s/iter; left time: 160.0569s
Epoch: 3 cost time: 9.670317649841309
Epoch: 3, Steps: 570 | Train Loss: 0.1696404 Vali Loss: 0.0356778 Test Loss: 0.1177135
Validation loss decreased (0.037772 --> 0.035678).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1583974
	speed: 0.0506s/iter; left time: 485.5248s
	iters: 200, epoch: 4 | loss: 0.2781526
	speed: 0.0163s/iter; left time: 154.6442s
	iters: 300, epoch: 4 | loss: 0.1576161
	speed: 0.0163s/iter; left time: 153.0802s
	iters: 400, epoch: 4 | loss: 0.1049025
	speed: 0.0164s/iter; left time: 151.9335s
	iters: 500, epoch: 4 | loss: 0.2086957
	speed: 0.0164s/iter; left time: 150.5763s
Epoch: 4 cost time: 9.621369361877441
Epoch: 4, Steps: 570 | Train Loss: 0.1597215 Vali Loss: 0.0343256 Test Loss: 0.1164987
Validation loss decreased (0.035678 --> 0.034326).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1751219
	speed: 0.0528s/iter; left time: 476.0811s
	iters: 200, epoch: 5 | loss: 0.1923386
	speed: 0.0164s/iter; left time: 146.6583s
	iters: 300, epoch: 5 | loss: 0.1403746
	speed: 0.0164s/iter; left time: 144.9115s
	iters: 400, epoch: 5 | loss: 0.0942754
	speed: 0.0164s/iter; left time: 143.1581s
	iters: 500, epoch: 5 | loss: 0.2200446
	speed: 0.0164s/iter; left time: 141.6736s
Epoch: 5 cost time: 9.687691926956177
Epoch: 5, Steps: 570 | Train Loss: 0.1550071 Vali Loss: 0.0347153 Test Loss: 0.1171305
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1461784
	speed: 0.0516s/iter; left time: 435.9389s
	iters: 200, epoch: 6 | loss: 0.1927384
	speed: 0.0164s/iter; left time: 136.6366s
	iters: 300, epoch: 6 | loss: 0.2640187
	speed: 0.0163s/iter; left time: 134.8934s
	iters: 400, epoch: 6 | loss: 0.1496363
	speed: 0.0163s/iter; left time: 133.2590s
	iters: 500, epoch: 6 | loss: 0.1625941
	speed: 0.0163s/iter; left time: 131.5179s
Epoch: 6 cost time: 9.591333627700806
Epoch: 6, Steps: 570 | Train Loss: 0.1529667 Vali Loss: 0.0343755 Test Loss: 0.1170314
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2104669
	speed: 0.0494s/iter; left time: 389.3361s
	iters: 200, epoch: 7 | loss: 0.1102350
	speed: 0.0164s/iter; left time: 127.4069s
	iters: 300, epoch: 7 | loss: 0.1358421
	speed: 0.0163s/iter; left time: 125.4367s
	iters: 400, epoch: 7 | loss: 0.1985482
	speed: 0.0164s/iter; left time: 123.9692s
	iters: 500, epoch: 7 | loss: 0.2132091
	speed: 0.0164s/iter; left time: 122.3883s
Epoch: 7 cost time: 9.605531930923462
Epoch: 7, Steps: 570 | Train Loss: 0.1528961 Vali Loss: 0.0344288 Test Loss: 0.1173629
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11661824584007263, mae:0.20673932135105133
>>> MS_Pen LR=1e-4 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2731713
	speed: 0.0291s/iter; left time: 329.3374s
	iters: 200, epoch: 1 | loss: 0.2453779
	speed: 0.0170s/iter; left time: 190.7321s
	iters: 300, epoch: 1 | loss: 0.2364493
	speed: 0.0170s/iter; left time: 188.9372s
	iters: 400, epoch: 1 | loss: 0.2687343
	speed: 0.0170s/iter; left time: 187.3858s
	iters: 500, epoch: 1 | loss: 0.3747029
	speed: 0.0170s/iter; left time: 185.6486s
Epoch: 1 cost time: 10.969738721847534
Epoch: 1, Steps: 570 | Train Loss: 0.2474790 Vali Loss: 0.0427151 Test Loss: 0.1368728
Validation loss decreased (inf --> 0.042715).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2829244
	speed: 0.0512s/iter; left time: 548.9314s
	iters: 200, epoch: 2 | loss: 0.1302194
	speed: 0.0154s/iter; left time: 163.6163s
	iters: 300, epoch: 2 | loss: 0.2611394
	speed: 0.0154s/iter; left time: 162.2020s
	iters: 400, epoch: 2 | loss: 0.1630992
	speed: 0.0154s/iter; left time: 160.4229s
	iters: 500, epoch: 2 | loss: 0.2736386
	speed: 0.0154s/iter; left time: 158.9788s
Epoch: 2 cost time: 9.058729648590088
Epoch: 2, Steps: 570 | Train Loss: 0.2073698 Vali Loss: 0.0410264 Test Loss: 0.1377500
Validation loss decreased (0.042715 --> 0.041026).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2026136
	speed: 0.0511s/iter; left time: 519.2753s
	iters: 200, epoch: 3 | loss: 0.1143342
	speed: 0.0177s/iter; left time: 178.2240s
	iters: 300, epoch: 3 | loss: 0.1955523
	speed: 0.0177s/iter; left time: 176.4293s
	iters: 400, epoch: 3 | loss: 0.1840575
	speed: 0.0177s/iter; left time: 174.6542s
	iters: 500, epoch: 3 | loss: 0.2166976
	speed: 0.0177s/iter; left time: 172.7476s
Epoch: 3 cost time: 10.399998426437378
Epoch: 3, Steps: 570 | Train Loss: 0.1831857 Vali Loss: 0.0396728 Test Loss: 0.1350996
Validation loss decreased (0.041026 --> 0.039673).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1168094
	speed: 0.0522s/iter; left time: 500.6060s
	iters: 200, epoch: 4 | loss: 0.2126705
	speed: 0.0177s/iter; left time: 167.5779s
	iters: 300, epoch: 4 | loss: 0.1661347
	speed: 0.0176s/iter; left time: 165.7270s
	iters: 400, epoch: 4 | loss: 0.1539755
	speed: 0.0176s/iter; left time: 163.9413s
	iters: 500, epoch: 4 | loss: 0.2224082
	speed: 0.0177s/iter; left time: 162.3426s
Epoch: 4 cost time: 10.363513946533203
Epoch: 4, Steps: 570 | Train Loss: 0.1745420 Vali Loss: 0.0379635 Test Loss: 0.1335229
Validation loss decreased (0.039673 --> 0.037964).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1454542
	speed: 0.0534s/iter; left time: 481.5418s
	iters: 200, epoch: 5 | loss: 0.1386203
	speed: 0.0177s/iter; left time: 157.7647s
	iters: 300, epoch: 5 | loss: 0.1333929
	speed: 0.0177s/iter; left time: 155.9160s
	iters: 400, epoch: 5 | loss: 0.1253852
	speed: 0.0177s/iter; left time: 154.0445s
	iters: 500, epoch: 5 | loss: 0.1400478
	speed: 0.0177s/iter; left time: 152.2456s
Epoch: 5 cost time: 10.375600337982178
Epoch: 5, Steps: 570 | Train Loss: 0.1663505 Vali Loss: 0.0379647 Test Loss: 0.1376061
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1596566
	speed: 0.0518s/iter; left time: 438.0513s
	iters: 200, epoch: 6 | loss: 0.1383630
	speed: 0.0177s/iter; left time: 148.1918s
	iters: 300, epoch: 6 | loss: 0.1093579
	speed: 0.0177s/iter; left time: 146.0492s
	iters: 400, epoch: 6 | loss: 0.1152371
	speed: 0.0176s/iter; left time: 143.5409s
	iters: 500, epoch: 6 | loss: 0.1367314
	speed: 0.0177s/iter; left time: 142.4947s
Epoch: 6 cost time: 10.36473536491394
Epoch: 6, Steps: 570 | Train Loss: 0.1639244 Vali Loss: 0.0372351 Test Loss: 0.1334298
Validation loss decreased (0.037964 --> 0.037235).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1912026
	speed: 0.0507s/iter; left time: 399.7280s
	iters: 200, epoch: 7 | loss: 0.1425142
	speed: 0.0176s/iter; left time: 136.8517s
	iters: 300, epoch: 7 | loss: 0.1354185
	speed: 0.0176s/iter; left time: 135.0009s
	iters: 400, epoch: 7 | loss: 0.1843056
	speed: 0.0176s/iter; left time: 133.1811s
	iters: 500, epoch: 7 | loss: 0.1735292
	speed: 0.0176s/iter; left time: 131.3496s
Epoch: 7 cost time: 10.186649322509766
Epoch: 7, Steps: 570 | Train Loss: 0.1618544 Vali Loss: 0.0371654 Test Loss: 0.1340055
Validation loss decreased (0.037235 --> 0.037165).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1403207
	speed: 0.0513s/iter; left time: 375.0810s
	iters: 200, epoch: 8 | loss: 0.2043249
	speed: 0.0155s/iter; left time: 111.5378s
	iters: 300, epoch: 8 | loss: 0.1110586
	speed: 0.0155s/iter; left time: 109.8825s
	iters: 400, epoch: 8 | loss: 0.1466005
	speed: 0.0154s/iter; left time: 108.2046s
	iters: 500, epoch: 8 | loss: 0.1331639
	speed: 0.0155s/iter; left time: 107.0473s
Epoch: 8 cost time: 9.18033480644226
Epoch: 8, Steps: 570 | Train Loss: 0.1601892 Vali Loss: 0.0373980 Test Loss: 0.1346640
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1537418
	speed: 0.0478s/iter; left time: 321.9912s
	iters: 200, epoch: 9 | loss: 0.1305310
	speed: 0.0155s/iter; left time: 102.9010s
	iters: 300, epoch: 9 | loss: 0.1548612
	speed: 0.0155s/iter; left time: 101.4177s
	iters: 400, epoch: 9 | loss: 0.1230187
	speed: 0.0177s/iter; left time: 113.9010s
	iters: 500, epoch: 9 | loss: 0.1554973
	speed: 0.0177s/iter; left time: 112.1646s
Epoch: 9 cost time: 9.736636400222778
Epoch: 9, Steps: 570 | Train Loss: 0.1598744 Vali Loss: 0.0373075 Test Loss: 0.1342082
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1627093
	speed: 0.0512s/iter; left time: 315.7258s
	iters: 200, epoch: 10 | loss: 0.1794280
	speed: 0.0176s/iter; left time: 106.9163s
	iters: 300, epoch: 10 | loss: 0.1415028
	speed: 0.0176s/iter; left time: 105.2562s
	iters: 400, epoch: 10 | loss: 0.1833973
	speed: 0.0176s/iter; left time: 103.5810s
	iters: 500, epoch: 10 | loss: 0.2827156
	speed: 0.0176s/iter; left time: 101.8441s
Epoch: 10 cost time: 10.337228059768677
Epoch: 10, Steps: 570 | Train Loss: 0.1623830 Vali Loss: 0.0371812 Test Loss: 0.1341353
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1341361105442047, mae:0.22636230289936066
>>> MS_Pen LR=1e-4 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.1709137
	speed: 0.0307s/iter; left time: 347.1738s
	iters: 200, epoch: 1 | loss: 0.2308134
	speed: 0.0186s/iter; left time: 208.4119s
	iters: 300, epoch: 1 | loss: 0.3606904
	speed: 0.0186s/iter; left time: 206.9853s
	iters: 400, epoch: 1 | loss: 0.2080891
	speed: 0.0187s/iter; left time: 205.3876s
	iters: 500, epoch: 1 | loss: 0.1753674
	speed: 0.0188s/iter; left time: 204.4908s
Epoch: 1 cost time: 11.90416955947876
Epoch: 1, Steps: 570 | Train Loss: 0.2438920 Vali Loss: 0.0420431 Test Loss: 0.1310521
Validation loss decreased (inf --> 0.042043).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4057190
	speed: 0.0573s/iter; left time: 615.3667s
	iters: 200, epoch: 2 | loss: 0.2041160
	speed: 0.0187s/iter; left time: 198.3710s
	iters: 300, epoch: 2 | loss: 0.1421609
	speed: 0.0186s/iter; left time: 196.1708s
	iters: 400, epoch: 2 | loss: 0.1769806
	speed: 0.0186s/iter; left time: 194.1799s
	iters: 500, epoch: 2 | loss: 0.1476927
	speed: 0.0186s/iter; left time: 192.3998s
Epoch: 2 cost time: 10.946888208389282
Epoch: 2, Steps: 570 | Train Loss: 0.2071328 Vali Loss: 0.0402176 Test Loss: 0.1246893
Validation loss decreased (0.042043 --> 0.040218).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1532692
	speed: 0.0569s/iter; left time: 578.3256s
	iters: 200, epoch: 3 | loss: 0.1709834
	speed: 0.0189s/iter; left time: 190.2524s
	iters: 300, epoch: 3 | loss: 0.1862775
	speed: 0.0189s/iter; left time: 188.6334s
	iters: 400, epoch: 3 | loss: 0.1094596
	speed: 0.0189s/iter; left time: 186.0256s
	iters: 500, epoch: 3 | loss: 0.1766809
	speed: 0.0189s/iter; left time: 184.6339s
Epoch: 3 cost time: 11.073055982589722
Epoch: 3, Steps: 570 | Train Loss: 0.1897247 Vali Loss: 0.0372123 Test Loss: 0.1233836
Validation loss decreased (0.040218 --> 0.037212).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2316866
	speed: 0.0614s/iter; left time: 588.5276s
	iters: 200, epoch: 4 | loss: 0.2390790
	speed: 0.0193s/iter; left time: 183.3270s
	iters: 300, epoch: 4 | loss: 0.2261282
	speed: 0.0185s/iter; left time: 173.6827s
	iters: 400, epoch: 4 | loss: 0.1198334
	speed: 0.0185s/iter; left time: 171.8090s
	iters: 500, epoch: 4 | loss: 0.1691685
	speed: 0.0185s/iter; left time: 170.3887s
Epoch: 4 cost time: 11.16836404800415
Epoch: 4, Steps: 570 | Train Loss: 0.1809481 Vali Loss: 0.0364548 Test Loss: 0.1212288
Validation loss decreased (0.037212 --> 0.036455).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1938308
	speed: 0.0555s/iter; left time: 500.3087s
	iters: 200, epoch: 5 | loss: 0.1675760
	speed: 0.0187s/iter; left time: 166.4225s
	iters: 300, epoch: 5 | loss: 0.1565518
	speed: 0.0187s/iter; left time: 164.8241s
	iters: 400, epoch: 5 | loss: 0.1500979
	speed: 0.0187s/iter; left time: 162.6749s
	iters: 500, epoch: 5 | loss: 0.1610461
	speed: 0.0186s/iter; left time: 160.7625s
Epoch: 5 cost time: 10.925723314285278
Epoch: 5, Steps: 570 | Train Loss: 0.1771802 Vali Loss: 0.0356789 Test Loss: 0.1208069
Validation loss decreased (0.036455 --> 0.035679).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0993022
	speed: 0.0583s/iter; left time: 492.4897s
	iters: 200, epoch: 6 | loss: 0.1767641
	speed: 0.0186s/iter; left time: 155.2100s
	iters: 300, epoch: 6 | loss: 0.1352387
	speed: 0.0186s/iter; left time: 153.5258s
	iters: 400, epoch: 6 | loss: 0.2002055
	speed: 0.0186s/iter; left time: 151.8851s
	iters: 500, epoch: 6 | loss: 0.1813891
	speed: 0.0186s/iter; left time: 149.7955s
Epoch: 6 cost time: 10.889015674591064
Epoch: 6, Steps: 570 | Train Loss: 0.1737618 Vali Loss: 0.0356500 Test Loss: 0.1203060
Validation loss decreased (0.035679 --> 0.035650).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1257808
	speed: 0.0570s/iter; left time: 449.0509s
	iters: 200, epoch: 7 | loss: 0.1797550
	speed: 0.0186s/iter; left time: 144.5061s
	iters: 300, epoch: 7 | loss: 0.1585271
	speed: 0.0185s/iter; left time: 142.3596s
	iters: 400, epoch: 7 | loss: 0.1921022
	speed: 0.0185s/iter; left time: 140.6156s
	iters: 500, epoch: 7 | loss: 0.2531989
	speed: 0.0185s/iter; left time: 138.3806s
Epoch: 7 cost time: 10.857640743255615
Epoch: 7, Steps: 570 | Train Loss: 0.1723405 Vali Loss: 0.0357006 Test Loss: 0.1200679
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2089569
	speed: 0.0553s/iter; left time: 404.4537s
	iters: 200, epoch: 8 | loss: 0.1257425
	speed: 0.0187s/iter; left time: 134.9305s
	iters: 300, epoch: 8 | loss: 0.1237189
	speed: 0.0188s/iter; left time: 133.4243s
	iters: 400, epoch: 8 | loss: 0.2026295
	speed: 0.0187s/iter; left time: 131.0073s
	iters: 500, epoch: 8 | loss: 0.1267788
	speed: 0.0186s/iter; left time: 128.4491s
Epoch: 8 cost time: 10.892438173294067
Epoch: 8, Steps: 570 | Train Loss: 0.1723999 Vali Loss: 0.0355275 Test Loss: 0.1199031
Validation loss decreased (0.035650 --> 0.035527).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1030845
	speed: 0.0572s/iter; left time: 385.4065s
	iters: 200, epoch: 9 | loss: 0.2296293
	speed: 0.0187s/iter; left time: 124.0790s
	iters: 300, epoch: 9 | loss: 0.1101003
	speed: 0.0187s/iter; left time: 122.0459s
	iters: 400, epoch: 9 | loss: 0.1946834
	speed: 0.0187s/iter; left time: 120.2137s
	iters: 500, epoch: 9 | loss: 0.0711525
	speed: 0.0186s/iter; left time: 118.2341s
Epoch: 9 cost time: 11.009509563446045
Epoch: 9, Steps: 570 | Train Loss: 0.1728120 Vali Loss: 0.0356404 Test Loss: 0.1198603
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1515295
	speed: 0.0551s/iter; left time: 340.3011s
	iters: 200, epoch: 10 | loss: 0.2157421
	speed: 0.0186s/iter; left time: 113.0241s
	iters: 300, epoch: 10 | loss: 0.1135183
	speed: 0.0186s/iter; left time: 111.1666s
	iters: 400, epoch: 10 | loss: 0.1589860
	speed: 0.0186s/iter; left time: 109.4042s
	iters: 500, epoch: 10 | loss: 0.1472874
	speed: 0.0186s/iter; left time: 107.3777s
Epoch: 10 cost time: 10.899936199188232
Epoch: 10, Steps: 570 | Train Loss: 0.1717624 Vali Loss: 0.0353215 Test Loss: 0.1196793
Validation loss decreased (0.035527 --> 0.035322).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1239030
	speed: 0.0560s/iter; left time: 313.9072s
	iters: 200, epoch: 11 | loss: 0.2333131
	speed: 0.0185s/iter; left time: 101.6432s
	iters: 300, epoch: 11 | loss: 0.1946475
	speed: 0.0184s/iter; left time: 99.6224s
	iters: 400, epoch: 11 | loss: 0.1067236
	speed: 0.0185s/iter; left time: 97.8587s
	iters: 500, epoch: 11 | loss: 0.2254997
	speed: 0.0184s/iter; left time: 95.7695s
Epoch: 11 cost time: 10.81189227104187
Epoch: 11, Steps: 570 | Train Loss: 0.1727667 Vali Loss: 0.0353746 Test Loss: 0.1196925
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1821580
	speed: 0.0549s/iter; left time: 276.2815s
	iters: 200, epoch: 12 | loss: 0.2109123
	speed: 0.0186s/iter; left time: 91.5571s
	iters: 300, epoch: 12 | loss: 0.0969667
	speed: 0.0186s/iter; left time: 89.6192s
	iters: 400, epoch: 12 | loss: 0.1788683
	speed: 0.0186s/iter; left time: 87.8569s
	iters: 500, epoch: 12 | loss: 0.1485516
	speed: 0.0186s/iter; left time: 85.9483s
Epoch: 12 cost time: 10.843854665756226
Epoch: 12, Steps: 570 | Train Loss: 0.1727224 Vali Loss: 0.0353017 Test Loss: 0.1197102
Validation loss decreased (0.035322 --> 0.035302).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2225920
	speed: 0.0572s/iter; left time: 255.1769s
	iters: 200, epoch: 13 | loss: 0.1539016
	speed: 0.0186s/iter; left time: 81.2517s
	iters: 300, epoch: 13 | loss: 0.1983755
	speed: 0.0186s/iter; left time: 79.2574s
	iters: 400, epoch: 13 | loss: 0.1002510
	speed: 0.0186s/iter; left time: 77.2794s
	iters: 500, epoch: 13 | loss: 0.2088372
	speed: 0.0186s/iter; left time: 75.4595s
Epoch: 13 cost time: 10.912229537963867
Epoch: 13, Steps: 570 | Train Loss: 0.1721789 Vali Loss: 0.0353277 Test Loss: 0.1196912
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1753949
	speed: 0.0557s/iter; left time: 216.8646s
	iters: 200, epoch: 14 | loss: 0.1233744
	speed: 0.0186s/iter; left time: 70.3515s
	iters: 300, epoch: 14 | loss: 0.1295138
	speed: 0.0186s/iter; left time: 68.5186s
	iters: 400, epoch: 14 | loss: 0.1986052
	speed: 0.0185s/iter; left time: 66.5906s
	iters: 500, epoch: 14 | loss: 0.2005108
	speed: 0.0185s/iter; left time: 64.7469s
Epoch: 14 cost time: 10.865437507629395
Epoch: 14, Steps: 570 | Train Loss: 0.1720964 Vali Loss: 0.0353248 Test Loss: 0.1196923
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1128674
	speed: 0.0555s/iter; left time: 184.4695s
	iters: 200, epoch: 15 | loss: 0.1714519
	speed: 0.0186s/iter; left time: 59.9331s
	iters: 300, epoch: 15 | loss: 0.1350021
	speed: 0.0186s/iter; left time: 58.0660s
	iters: 400, epoch: 15 | loss: 0.2152110
	speed: 0.0186s/iter; left time: 56.1902s
	iters: 500, epoch: 15 | loss: 0.1666332
	speed: 0.0187s/iter; left time: 54.5350s
Epoch: 15 cost time: 10.893594980239868
Epoch: 15, Steps: 570 | Train Loss: 0.1723603 Vali Loss: 0.0353728 Test Loss: 0.1196884
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11983422935009003, mae:0.20932969450950623
>>> MS_Pen LR=1e-4 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.4396553
	speed: 0.0303s/iter; left time: 342.4051s
	iters: 200, epoch: 1 | loss: 0.2448263
	speed: 0.0184s/iter; left time: 205.8844s
	iters: 300, epoch: 1 | loss: 0.2117594
	speed: 0.0184s/iter; left time: 203.9997s
	iters: 400, epoch: 1 | loss: 0.1769386
	speed: 0.0184s/iter; left time: 202.4181s
	iters: 500, epoch: 1 | loss: 0.2501454
	speed: 0.0184s/iter; left time: 200.6645s
Epoch: 1 cost time: 11.727201223373413
Epoch: 1, Steps: 570 | Train Loss: 0.2211369 Vali Loss: 0.0375516 Test Loss: 0.1184770
Validation loss decreased (inf --> 0.037552).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1533919
	speed: 0.0553s/iter; left time: 593.9431s
	iters: 200, epoch: 2 | loss: 0.2456800
	speed: 0.0182s/iter; left time: 193.9647s
	iters: 300, epoch: 2 | loss: 0.3352391
	speed: 0.0182s/iter; left time: 192.1226s
	iters: 400, epoch: 2 | loss: 0.1649849
	speed: 0.0183s/iter; left time: 190.4869s
	iters: 500, epoch: 2 | loss: 0.1369740
	speed: 0.0182s/iter; left time: 188.4716s
Epoch: 2 cost time: 10.70423674583435
Epoch: 2, Steps: 570 | Train Loss: 0.1930213 Vali Loss: 0.0368509 Test Loss: 0.1179716
Validation loss decreased (0.037552 --> 0.036851).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1258450
	speed: 0.0562s/iter; left time: 571.3500s
	iters: 200, epoch: 3 | loss: 0.1723416
	speed: 0.0184s/iter; left time: 184.9736s
	iters: 300, epoch: 3 | loss: 0.1796551
	speed: 0.0184s/iter; left time: 182.8287s
	iters: 400, epoch: 3 | loss: 0.1589561
	speed: 0.0184s/iter; left time: 181.1930s
	iters: 500, epoch: 3 | loss: 0.1224223
	speed: 0.0184s/iter; left time: 179.4066s
Epoch: 3 cost time: 10.761137962341309
Epoch: 3, Steps: 570 | Train Loss: 0.1757123 Vali Loss: 0.0350625 Test Loss: 0.1161804
Validation loss decreased (0.036851 --> 0.035062).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1941771
	speed: 0.0586s/iter; left time: 562.4644s
	iters: 200, epoch: 4 | loss: 0.1131709
	speed: 0.0184s/iter; left time: 174.6087s
	iters: 300, epoch: 4 | loss: 0.2900806
	speed: 0.0184s/iter; left time: 172.5834s
	iters: 400, epoch: 4 | loss: 0.1511062
	speed: 0.0184s/iter; left time: 170.7413s
	iters: 500, epoch: 4 | loss: 0.1255221
	speed: 0.0184s/iter; left time: 168.8791s
Epoch: 4 cost time: 10.744314432144165
Epoch: 4, Steps: 570 | Train Loss: 0.1689493 Vali Loss: 0.0339825 Test Loss: 0.1154587
Validation loss decreased (0.035062 --> 0.033983).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1330719
	speed: 0.0559s/iter; left time: 503.8490s
	iters: 200, epoch: 5 | loss: 0.1591281
	speed: 0.0183s/iter; left time: 162.8192s
	iters: 300, epoch: 5 | loss: 0.1569480
	speed: 0.0182s/iter; left time: 160.4830s
	iters: 400, epoch: 5 | loss: 0.1318052
	speed: 0.0182s/iter; left time: 158.6767s
	iters: 500, epoch: 5 | loss: 0.1650784
	speed: 0.0182s/iter; left time: 157.2472s
Epoch: 5 cost time: 10.656714916229248
Epoch: 5, Steps: 570 | Train Loss: 0.1654104 Vali Loss: 0.0340996 Test Loss: 0.1156983
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2319948
	speed: 0.0588s/iter; left time: 496.5458s
	iters: 200, epoch: 6 | loss: 0.1433161
	speed: 0.0206s/iter; left time: 171.8313s
	iters: 300, epoch: 6 | loss: 0.1849886
	speed: 0.0205s/iter; left time: 169.3018s
	iters: 400, epoch: 6 | loss: 0.1324769
	speed: 0.0205s/iter; left time: 167.3901s
	iters: 500, epoch: 6 | loss: 0.1077434
	speed: 0.0205s/iter; left time: 165.2098s
Epoch: 6 cost time: 11.990459442138672
Epoch: 6, Steps: 570 | Train Loss: 0.1641021 Vali Loss: 0.0333352 Test Loss: 0.1142253
Validation loss decreased (0.033983 --> 0.033335).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1624742
	speed: 0.0591s/iter; left time: 465.8945s
	iters: 200, epoch: 7 | loss: 0.1931826
	speed: 0.0183s/iter; left time: 142.5242s
	iters: 300, epoch: 7 | loss: 0.1205237
	speed: 0.0183s/iter; left time: 140.7104s
	iters: 400, epoch: 7 | loss: 0.1871207
	speed: 0.0184s/iter; left time: 139.2320s
	iters: 500, epoch: 7 | loss: 0.1405184
	speed: 0.0183s/iter; left time: 136.9024s
Epoch: 7 cost time: 10.705606460571289
Epoch: 7, Steps: 570 | Train Loss: 0.1609521 Vali Loss: 0.0334741 Test Loss: 0.1149027
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1154754
	speed: 0.0548s/iter; left time: 400.6486s
	iters: 200, epoch: 8 | loss: 0.1409078
	speed: 0.0184s/iter; left time: 132.9040s
	iters: 300, epoch: 8 | loss: 0.1604783
	speed: 0.0184s/iter; left time: 131.1524s
	iters: 400, epoch: 8 | loss: 0.1656143
	speed: 0.0184s/iter; left time: 129.0194s
	iters: 500, epoch: 8 | loss: 0.2035395
	speed: 0.0184s/iter; left time: 127.4832s
Epoch: 8 cost time: 10.802133083343506
Epoch: 8, Steps: 570 | Train Loss: 0.1604150 Vali Loss: 0.0335454 Test Loss: 0.1147688
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0889151
	speed: 0.0554s/iter; left time: 373.1572s
	iters: 200, epoch: 9 | loss: 0.1241997
	speed: 0.0182s/iter; left time: 121.0996s
	iters: 300, epoch: 9 | loss: 0.1563414
	speed: 0.0183s/iter; left time: 119.6231s
	iters: 400, epoch: 9 | loss: 0.1526751
	speed: 0.0183s/iter; left time: 117.8224s
	iters: 500, epoch: 9 | loss: 0.1376898
	speed: 0.0183s/iter; left time: 115.9262s
Epoch: 9 cost time: 10.69154143333435
Epoch: 9, Steps: 570 | Train Loss: 0.1608162 Vali Loss: 0.0336615 Test Loss: 0.1147417
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11433041095733643, mae:0.20303139090538025
>>> MS_Pen LR=1e-4 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2544486
	speed: 0.0326s/iter; left time: 368.3828s
	iters: 200, epoch: 1 | loss: 0.2150759
	speed: 0.0205s/iter; left time: 229.9298s
	iters: 300, epoch: 1 | loss: 0.2547072
	speed: 0.0205s/iter; left time: 228.0001s
	iters: 400, epoch: 1 | loss: 0.2807477
	speed: 0.0189s/iter; left time: 208.2697s
	iters: 500, epoch: 1 | loss: 0.3188817
	speed: 0.0183s/iter; left time: 199.8435s
Epoch: 1 cost time: 12.432254791259766
Epoch: 1, Steps: 570 | Train Loss: 0.2511688 Vali Loss: 0.0434576 Test Loss: 0.1381824
Validation loss decreased (inf --> 0.043458).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2692248
	speed: 0.0561s/iter; left time: 602.0433s
	iters: 200, epoch: 2 | loss: 0.2552969
	speed: 0.0184s/iter; left time: 195.9463s
	iters: 300, epoch: 2 | loss: 0.4267295
	speed: 0.0184s/iter; left time: 193.4112s
	iters: 400, epoch: 2 | loss: 0.1654845
	speed: 0.0182s/iter; left time: 190.3129s
	iters: 500, epoch: 2 | loss: 0.1427836
	speed: 0.0182s/iter; left time: 188.4439s
Epoch: 2 cost time: 10.77311110496521
Epoch: 2, Steps: 570 | Train Loss: 0.2141059 Vali Loss: 0.0421049 Test Loss: 0.1329611
Validation loss decreased (0.043458 --> 0.042105).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1377613
	speed: 0.0555s/iter; left time: 564.1728s
	iters: 200, epoch: 3 | loss: 0.2003736
	speed: 0.0182s/iter; left time: 183.2257s
	iters: 300, epoch: 3 | loss: 0.2012254
	speed: 0.0182s/iter; left time: 181.5538s
	iters: 400, epoch: 3 | loss: 0.2328718
	speed: 0.0182s/iter; left time: 179.6675s
	iters: 500, epoch: 3 | loss: 0.2204434
	speed: 0.0182s/iter; left time: 177.8453s
Epoch: 3 cost time: 10.677064180374146
Epoch: 3, Steps: 570 | Train Loss: 0.1957982 Vali Loss: 0.0399418 Test Loss: 0.1359689
Validation loss decreased (0.042105 --> 0.039942).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1413623
	speed: 0.0581s/iter; left time: 556.8471s
	iters: 200, epoch: 4 | loss: 0.1949905
	speed: 0.0182s/iter; left time: 172.9151s
	iters: 300, epoch: 4 | loss: 0.1859669
	speed: 0.0183s/iter; left time: 171.4029s
	iters: 400, epoch: 4 | loss: 0.2395496
	speed: 0.0184s/iter; left time: 170.7090s
	iters: 500, epoch: 4 | loss: 0.1191509
	speed: 0.0184s/iter; left time: 168.8704s
Epoch: 4 cost time: 10.713866472244263
Epoch: 4, Steps: 570 | Train Loss: 0.1867763 Vali Loss: 0.0386148 Test Loss: 0.1300829
Validation loss decreased (0.039942 --> 0.038615).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1378151
	speed: 0.0592s/iter; left time: 533.8406s
	iters: 200, epoch: 5 | loss: 0.1781678
	speed: 0.0182s/iter; left time: 162.0819s
	iters: 300, epoch: 5 | loss: 0.1342643
	speed: 0.0182s/iter; left time: 160.3137s
	iters: 400, epoch: 5 | loss: 0.1742966
	speed: 0.0182s/iter; left time: 158.3465s
	iters: 500, epoch: 5 | loss: 0.0977216
	speed: 0.0182s/iter; left time: 156.6093s
Epoch: 5 cost time: 10.638189315795898
Epoch: 5, Steps: 570 | Train Loss: 0.1810366 Vali Loss: 0.0377400 Test Loss: 0.1284132
Validation loss decreased (0.038615 --> 0.037740).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2360715
	speed: 0.0552s/iter; left time: 466.7448s
	iters: 200, epoch: 6 | loss: 0.1312654
	speed: 0.0184s/iter; left time: 153.4924s
	iters: 300, epoch: 6 | loss: 0.3193274
	speed: 0.0184s/iter; left time: 151.5594s
	iters: 400, epoch: 6 | loss: 0.1448178
	speed: 0.0184s/iter; left time: 149.7015s
	iters: 500, epoch: 6 | loss: 0.2088272
	speed: 0.0183s/iter; left time: 147.7207s
Epoch: 6 cost time: 10.733294010162354
Epoch: 6, Steps: 570 | Train Loss: 0.1797413 Vali Loss: 0.0377395 Test Loss: 0.1289344
Validation loss decreased (0.037740 --> 0.037739).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1564613
	speed: 0.0559s/iter; left time: 440.5857s
	iters: 200, epoch: 7 | loss: 0.1534297
	speed: 0.0186s/iter; left time: 144.8297s
	iters: 300, epoch: 7 | loss: 0.2006686
	speed: 0.0185s/iter; left time: 142.4573s
	iters: 400, epoch: 7 | loss: 0.1766013
	speed: 0.0185s/iter; left time: 140.4470s
	iters: 500, epoch: 7 | loss: 0.1220636
	speed: 0.0186s/iter; left time: 139.0157s
Epoch: 7 cost time: 10.879834175109863
Epoch: 7, Steps: 570 | Train Loss: 0.1794646 Vali Loss: 0.0377451 Test Loss: 0.1286501
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1575132
	speed: 0.0554s/iter; left time: 404.7904s
	iters: 200, epoch: 8 | loss: 0.1078925
	speed: 0.0182s/iter; left time: 131.5571s
	iters: 300, epoch: 8 | loss: 0.1862331
	speed: 0.0182s/iter; left time: 129.7250s
	iters: 400, epoch: 8 | loss: 0.2043630
	speed: 0.0182s/iter; left time: 127.8061s
	iters: 500, epoch: 8 | loss: 0.1488631
	speed: 0.0182s/iter; left time: 125.5755s
Epoch: 8 cost time: 10.640362739562988
Epoch: 8, Steps: 570 | Train Loss: 0.1783952 Vali Loss: 0.0377137 Test Loss: 0.1290926
Validation loss decreased (0.037739 --> 0.037714).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1663008
	speed: 0.0572s/iter; left time: 385.3931s
	iters: 200, epoch: 9 | loss: 0.2356630
	speed: 0.0183s/iter; left time: 121.7588s
	iters: 300, epoch: 9 | loss: 0.2268867
	speed: 0.0183s/iter; left time: 119.7406s
	iters: 400, epoch: 9 | loss: 0.3095233
	speed: 0.0183s/iter; left time: 117.9187s
	iters: 500, epoch: 9 | loss: 0.1291939
	speed: 0.0183s/iter; left time: 116.1472s
Epoch: 9 cost time: 10.725277662277222
Epoch: 9, Steps: 570 | Train Loss: 0.1782977 Vali Loss: 0.0378554 Test Loss: 0.1289069
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1816097
	speed: 0.0566s/iter; left time: 349.2729s
	iters: 200, epoch: 10 | loss: 0.1590168
	speed: 0.0183s/iter; left time: 111.3440s
	iters: 300, epoch: 10 | loss: 0.1859018
	speed: 0.0184s/iter; left time: 109.6411s
	iters: 400, epoch: 10 | loss: 0.1983384
	speed: 0.0183s/iter; left time: 107.7001s
	iters: 500, epoch: 10 | loss: 0.2033496
	speed: 0.0183s/iter; left time: 105.8440s
Epoch: 10 cost time: 10.779942512512207
Epoch: 10, Steps: 570 | Train Loss: 0.1780515 Vali Loss: 0.0375097 Test Loss: 0.1287901
Validation loss decreased (0.037714 --> 0.037510).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1674898
	speed: 0.0583s/iter; left time: 326.2759s
	iters: 200, epoch: 11 | loss: 0.1708925
	speed: 0.0206s/iter; left time: 113.1187s
	iters: 300, epoch: 11 | loss: 0.1728331
	speed: 0.0205s/iter; left time: 110.9442s
	iters: 400, epoch: 11 | loss: 0.1909178
	speed: 0.0205s/iter; left time: 108.8508s
	iters: 500, epoch: 11 | loss: 0.1683420
	speed: 0.0205s/iter; left time: 106.8403s
Epoch: 11 cost time: 12.03119421005249
Epoch: 11, Steps: 570 | Train Loss: 0.1797237 Vali Loss: 0.0375549 Test Loss: 0.1287336
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1412026
	speed: 0.0569s/iter; left time: 286.2761s
	iters: 200, epoch: 12 | loss: 0.2077287
	speed: 0.0182s/iter; left time: 89.7005s
	iters: 300, epoch: 12 | loss: 0.1779422
	speed: 0.0182s/iter; left time: 87.8670s
	iters: 400, epoch: 12 | loss: 0.1321271
	speed: 0.0182s/iter; left time: 86.0025s
	iters: 500, epoch: 12 | loss: 0.2428902
	speed: 0.0183s/iter; left time: 84.5183s
Epoch: 12 cost time: 10.641511678695679
Epoch: 12, Steps: 570 | Train Loss: 0.1782421 Vali Loss: 0.0375818 Test Loss: 0.1287836
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1581339
	speed: 0.0562s/iter; left time: 250.7570s
	iters: 200, epoch: 13 | loss: 0.1009355
	speed: 0.0184s/iter; left time: 80.1685s
	iters: 300, epoch: 13 | loss: 0.1417372
	speed: 0.0184s/iter; left time: 78.2610s
	iters: 400, epoch: 13 | loss: 0.1271639
	speed: 0.0183s/iter; left time: 76.0053s
	iters: 500, epoch: 13 | loss: 0.1108282
	speed: 0.0183s/iter; left time: 74.1161s
Epoch: 13 cost time: 10.701945304870605
Epoch: 13, Steps: 570 | Train Loss: 0.1785027 Vali Loss: 0.0377535 Test Loss: 0.1287606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1289108693599701, mae:0.222467303276062
>>> MS_Pen LR=1e-4 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2197853
	speed: 0.0341s/iter; left time: 385.2732s
	iters: 200, epoch: 1 | loss: 0.1925970
	speed: 0.0221s/iter; left time: 247.8363s
	iters: 300, epoch: 1 | loss: 0.1808281
	speed: 0.0221s/iter; left time: 245.6829s
	iters: 400, epoch: 1 | loss: 0.3527016
	speed: 0.0221s/iter; left time: 243.4723s
	iters: 500, epoch: 1 | loss: 0.2230179
	speed: 0.0221s/iter; left time: 241.2831s
Epoch: 1 cost time: 13.868837118148804
Epoch: 1, Steps: 570 | Train Loss: 0.2406961 Vali Loss: 0.0419031 Test Loss: 0.1320193
Validation loss decreased (inf --> 0.041903).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2763529
	speed: 0.0658s/iter; left time: 706.3300s
	iters: 200, epoch: 2 | loss: 0.1738297
	speed: 0.0220s/iter; left time: 234.3921s
	iters: 300, epoch: 2 | loss: 0.1532702
	speed: 0.0220s/iter; left time: 232.1997s
	iters: 400, epoch: 2 | loss: 0.1669050
	speed: 0.0220s/iter; left time: 229.5792s
	iters: 500, epoch: 2 | loss: 0.1966718
	speed: 0.0220s/iter; left time: 227.4174s
Epoch: 2 cost time: 12.9989492893219
Epoch: 2, Steps: 570 | Train Loss: 0.2006107 Vali Loss: 0.0416614 Test Loss: 0.1301996
Validation loss decreased (0.041903 --> 0.041661).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4072880
	speed: 0.0638s/iter; left time: 648.5690s
	iters: 200, epoch: 3 | loss: 0.1317980
	speed: 0.0230s/iter; left time: 231.0217s
	iters: 300, epoch: 3 | loss: 0.2153293
	speed: 0.0221s/iter; left time: 220.5876s
	iters: 400, epoch: 3 | loss: 0.1322950
	speed: 0.0222s/iter; left time: 218.5943s
	iters: 500, epoch: 3 | loss: 0.1209075
	speed: 0.0221s/iter; left time: 216.0944s
Epoch: 3 cost time: 13.070305824279785
Epoch: 3, Steps: 570 | Train Loss: 0.1748671 Vali Loss: 0.0359966 Test Loss: 0.1237229
Validation loss decreased (0.041661 --> 0.035997).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1350148
	speed: 0.0663s/iter; left time: 635.6381s
	iters: 200, epoch: 4 | loss: 0.1445884
	speed: 0.0222s/iter; left time: 210.7614s
	iters: 300, epoch: 4 | loss: 0.1466320
	speed: 0.0222s/iter; left time: 208.5802s
	iters: 400, epoch: 4 | loss: 0.1146087
	speed: 0.0222s/iter; left time: 205.8044s
	iters: 500, epoch: 4 | loss: 0.1953056
	speed: 0.0221s/iter; left time: 203.1269s
Epoch: 4 cost time: 12.965248346328735
Epoch: 4, Steps: 570 | Train Loss: 0.1627841 Vali Loss: 0.0361275 Test Loss: 0.1250468
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1854331
	speed: 0.0666s/iter; left time: 600.7278s
	iters: 200, epoch: 5 | loss: 0.1839792
	speed: 0.0221s/iter; left time: 197.4465s
	iters: 300, epoch: 5 | loss: 0.1420389
	speed: 0.0221s/iter; left time: 195.0666s
	iters: 400, epoch: 5 | loss: 0.1400107
	speed: 0.0222s/iter; left time: 193.2771s
	iters: 500, epoch: 5 | loss: 0.1646308
	speed: 0.0221s/iter; left time: 190.7208s
Epoch: 5 cost time: 12.968944072723389
Epoch: 5, Steps: 570 | Train Loss: 0.1562169 Vali Loss: 0.0342030 Test Loss: 0.1226252
Validation loss decreased (0.035997 --> 0.034203).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1308820
	speed: 0.0640s/iter; left time: 540.7447s
	iters: 200, epoch: 6 | loss: 0.1916060
	speed: 0.0221s/iter; left time: 184.4181s
	iters: 300, epoch: 6 | loss: 0.1200489
	speed: 0.0221s/iter; left time: 182.3190s
	iters: 400, epoch: 6 | loss: 0.1449733
	speed: 0.0221s/iter; left time: 179.9814s
	iters: 500, epoch: 6 | loss: 0.2351757
	speed: 0.0221s/iter; left time: 177.7873s
Epoch: 6 cost time: 12.911381721496582
Epoch: 6, Steps: 570 | Train Loss: 0.1535608 Vali Loss: 0.0350800 Test Loss: 0.1230376
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1933442
	speed: 0.0644s/iter; left time: 507.2709s
	iters: 200, epoch: 7 | loss: 0.1719446
	speed: 0.0221s/iter; left time: 171.9804s
	iters: 300, epoch: 7 | loss: 0.1240831
	speed: 0.0221s/iter; left time: 169.6504s
	iters: 400, epoch: 7 | loss: 0.1424866
	speed: 0.0221s/iter; left time: 167.3850s
	iters: 500, epoch: 7 | loss: 0.1594121
	speed: 0.0221s/iter; left time: 165.2023s
Epoch: 7 cost time: 12.854217052459717
Epoch: 7, Steps: 570 | Train Loss: 0.1498038 Vali Loss: 0.0350042 Test Loss: 0.1218642
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1160587
	speed: 0.0618s/iter; left time: 451.9214s
	iters: 200, epoch: 8 | loss: 0.3359626
	speed: 0.0220s/iter; left time: 158.6412s
	iters: 300, epoch: 8 | loss: 0.1058093
	speed: 0.0220s/iter; left time: 156.4553s
	iters: 400, epoch: 8 | loss: 0.1260607
	speed: 0.0220s/iter; left time: 154.3900s
	iters: 500, epoch: 8 | loss: 0.1319642
	speed: 0.0220s/iter; left time: 152.1160s
Epoch: 8 cost time: 12.811904430389404
Epoch: 8, Steps: 570 | Train Loss: 0.1505249 Vali Loss: 0.0343761 Test Loss: 0.1220493
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12271419167518616, mae:0.21550896763801575
>>> MS_Pen LR=1e-4 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2274622
	speed: 0.0329s/iter; left time: 372.1572s
	iters: 200, epoch: 1 | loss: 0.1136143
	speed: 0.0212s/iter; left time: 237.9885s
	iters: 300, epoch: 1 | loss: 0.1705421
	speed: 0.0212s/iter; left time: 235.7743s
	iters: 400, epoch: 1 | loss: 0.2056620
	speed: 0.0212s/iter; left time: 233.6667s
	iters: 500, epoch: 1 | loss: 0.2158805
	speed: 0.0212s/iter; left time: 231.6153s
Epoch: 1 cost time: 13.333274602890015
Epoch: 1, Steps: 570 | Train Loss: 0.2179689 Vali Loss: 0.0392004 Test Loss: 0.1229858
Validation loss decreased (inf --> 0.039200).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1772070
	speed: 0.0613s/iter; left time: 657.9025s
	iters: 200, epoch: 2 | loss: 0.1425899
	speed: 0.0214s/iter; left time: 227.0046s
	iters: 300, epoch: 2 | loss: 0.2130409
	speed: 0.0214s/iter; left time: 224.9181s
	iters: 400, epoch: 2 | loss: 0.1895537
	speed: 0.0213s/iter; left time: 222.2943s
	iters: 500, epoch: 2 | loss: 0.1357628
	speed: 0.0213s/iter; left time: 220.1879s
Epoch: 2 cost time: 12.468482494354248
Epoch: 2, Steps: 570 | Train Loss: 0.1873464 Vali Loss: 0.0364392 Test Loss: 0.1181780
Validation loss decreased (0.039200 --> 0.036439).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1686212
	speed: 0.0618s/iter; left time: 627.5524s
	iters: 200, epoch: 3 | loss: 0.1348617
	speed: 0.0214s/iter; left time: 215.5845s
	iters: 300, epoch: 3 | loss: 0.1428706
	speed: 0.0214s/iter; left time: 213.1827s
	iters: 400, epoch: 3 | loss: 0.1264223
	speed: 0.0214s/iter; left time: 210.9701s
	iters: 500, epoch: 3 | loss: 0.1481027
	speed: 0.0214s/iter; left time: 209.1374s
Epoch: 3 cost time: 12.52566146850586
Epoch: 3, Steps: 570 | Train Loss: 0.1658907 Vali Loss: 0.0325057 Test Loss: 0.1170637
Validation loss decreased (0.036439 --> 0.032506).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1147110
	speed: 0.0619s/iter; left time: 593.6634s
	iters: 200, epoch: 4 | loss: 0.1636937
	speed: 0.0213s/iter; left time: 202.0911s
	iters: 300, epoch: 4 | loss: 0.1575675
	speed: 0.0213s/iter; left time: 199.6821s
	iters: 400, epoch: 4 | loss: 0.1912058
	speed: 0.0213s/iter; left time: 197.5167s
	iters: 500, epoch: 4 | loss: 0.1407446
	speed: 0.0213s/iter; left time: 195.3867s
Epoch: 4 cost time: 12.448978424072266
Epoch: 4, Steps: 570 | Train Loss: 0.1544982 Vali Loss: 0.0323517 Test Loss: 0.1162579
Validation loss decreased (0.032506 --> 0.032352).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1969281
	speed: 0.0618s/iter; left time: 557.5027s
	iters: 200, epoch: 5 | loss: 0.1202165
	speed: 0.0212s/iter; left time: 189.3438s
	iters: 300, epoch: 5 | loss: 0.1574411
	speed: 0.0212s/iter; left time: 187.2358s
	iters: 400, epoch: 5 | loss: 0.1845646
	speed: 0.0212s/iter; left time: 185.0576s
	iters: 500, epoch: 5 | loss: 0.1159923
	speed: 0.0212s/iter; left time: 182.9045s
Epoch: 5 cost time: 12.384539127349854
Epoch: 5, Steps: 570 | Train Loss: 0.1498157 Vali Loss: 0.0313998 Test Loss: 0.1159300
Validation loss decreased (0.032352 --> 0.031400).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1326744
	speed: 0.0632s/iter; left time: 533.9759s
	iters: 200, epoch: 6 | loss: 0.1758094
	speed: 0.0213s/iter; left time: 178.0347s
	iters: 300, epoch: 6 | loss: 0.1994824
	speed: 0.0212s/iter; left time: 175.2233s
	iters: 400, epoch: 6 | loss: 0.1155448
	speed: 0.0212s/iter; left time: 173.1082s
	iters: 500, epoch: 6 | loss: 0.1041695
	speed: 0.0213s/iter; left time: 171.1475s
Epoch: 6 cost time: 12.615644931793213
Epoch: 6, Steps: 570 | Train Loss: 0.1464623 Vali Loss: 0.0314844 Test Loss: 0.1167784
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1231355
	speed: 0.0629s/iter; left time: 495.6740s
	iters: 200, epoch: 7 | loss: 0.1922658
	speed: 0.0219s/iter; left time: 170.5817s
	iters: 300, epoch: 7 | loss: 0.1774006
	speed: 0.0214s/iter; left time: 164.2971s
	iters: 400, epoch: 7 | loss: 0.1001681
	speed: 0.0214s/iter; left time: 162.1962s
	iters: 500, epoch: 7 | loss: 0.1540097
	speed: 0.0214s/iter; left time: 160.2945s
Epoch: 7 cost time: 12.796993732452393
Epoch: 7, Steps: 570 | Train Loss: 0.1450454 Vali Loss: 0.0315684 Test Loss: 0.1158958
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1415183
	speed: 0.0630s/iter; left time: 460.9233s
	iters: 200, epoch: 8 | loss: 0.1658622
	speed: 0.0213s/iter; left time: 153.8937s
	iters: 300, epoch: 8 | loss: 0.1390379
	speed: 0.0214s/iter; left time: 151.8838s
	iters: 400, epoch: 8 | loss: 0.1263463
	speed: 0.0213s/iter; left time: 149.6811s
	iters: 500, epoch: 8 | loss: 0.2481560
	speed: 0.0213s/iter; left time: 147.4405s
Epoch: 8 cost time: 12.549593210220337
Epoch: 8, Steps: 570 | Train Loss: 0.1456624 Vali Loss: 0.0312195 Test Loss: 0.1158942
Validation loss decreased (0.031400 --> 0.031220).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1436033
	speed: 0.0635s/iter; left time: 428.0715s
	iters: 200, epoch: 9 | loss: 0.1923382
	speed: 0.0232s/iter; left time: 153.9648s
	iters: 300, epoch: 9 | loss: 0.1770875
	speed: 0.0232s/iter; left time: 151.9224s
	iters: 400, epoch: 9 | loss: 0.1317793
	speed: 0.0214s/iter; left time: 138.0729s
	iters: 500, epoch: 9 | loss: 0.0873917
	speed: 0.0213s/iter; left time: 135.1842s
Epoch: 9 cost time: 13.05226993560791
Epoch: 9, Steps: 570 | Train Loss: 0.1443447 Vali Loss: 0.0312188 Test Loss: 0.1158902
Validation loss decreased (0.031220 --> 0.031219).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1039905
	speed: 0.0609s/iter; left time: 375.6048s
	iters: 200, epoch: 10 | loss: 0.1340434
	speed: 0.0212s/iter; left time: 128.5896s
	iters: 300, epoch: 10 | loss: 0.1337566
	speed: 0.0212s/iter; left time: 126.4717s
	iters: 400, epoch: 10 | loss: 0.1273183
	speed: 0.0212s/iter; left time: 124.3557s
	iters: 500, epoch: 10 | loss: 0.1663183
	speed: 0.0212s/iter; left time: 122.2520s
Epoch: 10 cost time: 12.388587713241577
Epoch: 10, Steps: 570 | Train Loss: 0.1434969 Vali Loss: 0.0312185 Test Loss: 0.1158833
Validation loss decreased (0.031219 --> 0.031218).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1743431
	speed: 0.0648s/iter; left time: 362.8429s
	iters: 200, epoch: 11 | loss: 0.1173114
	speed: 0.0232s/iter; left time: 127.4965s
	iters: 300, epoch: 11 | loss: 0.1341772
	speed: 0.0223s/iter; left time: 120.6768s
	iters: 400, epoch: 11 | loss: 0.1075755
	speed: 0.0213s/iter; left time: 113.0197s
	iters: 500, epoch: 11 | loss: 0.1730172
	speed: 0.0213s/iter; left time: 110.8379s
Epoch: 11 cost time: 12.931970119476318
Epoch: 11, Steps: 570 | Train Loss: 0.1445515 Vali Loss: 0.0311056 Test Loss: 0.1159174
Validation loss decreased (0.031218 --> 0.031106).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1721211
	speed: 0.0626s/iter; left time: 315.0912s
	iters: 200, epoch: 12 | loss: 0.1520546
	speed: 0.0214s/iter; left time: 105.7577s
	iters: 300, epoch: 12 | loss: 0.1273582
	speed: 0.0215s/iter; left time: 103.6525s
	iters: 400, epoch: 12 | loss: 0.2446603
	speed: 0.0215s/iter; left time: 101.4832s
	iters: 500, epoch: 12 | loss: 0.1269606
	speed: 0.0214s/iter; left time: 98.9452s
Epoch: 12 cost time: 12.527559280395508
Epoch: 12, Steps: 570 | Train Loss: 0.1434185 Vali Loss: 0.0311333 Test Loss: 0.1159346
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1224341
	speed: 0.0641s/iter; left time: 286.0303s
	iters: 200, epoch: 13 | loss: 0.1690457
	speed: 0.0232s/iter; left time: 101.0258s
	iters: 300, epoch: 13 | loss: 0.2108960
	speed: 0.0232s/iter; left time: 98.7082s
	iters: 400, epoch: 13 | loss: 0.1233488
	speed: 0.0232s/iter; left time: 96.3985s
	iters: 500, epoch: 13 | loss: 0.1405992
	speed: 0.0232s/iter; left time: 94.0643s
Epoch: 13 cost time: 13.41828966140747
Epoch: 13, Steps: 570 | Train Loss: 0.1436315 Vali Loss: 0.0312132 Test Loss: 0.1159289
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1276548
	speed: 0.0607s/iter; left time: 236.0138s
	iters: 200, epoch: 14 | loss: 0.1334835
	speed: 0.0213s/iter; left time: 80.6954s
	iters: 300, epoch: 14 | loss: 0.1393760
	speed: 0.0212s/iter; left time: 78.3577s
	iters: 400, epoch: 14 | loss: 0.1094266
	speed: 0.0212s/iter; left time: 76.3051s
	iters: 500, epoch: 14 | loss: 0.1627827
	speed: 0.0212s/iter; left time: 74.0378s
Epoch: 14 cost time: 12.396475315093994
Epoch: 14, Steps: 570 | Train Loss: 0.1440781 Vali Loss: 0.0311370 Test Loss: 0.1159258
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11602231115102768, mae:0.2052747905254364
>>> MS_Pen LR=1e-4 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Pen   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_penetration,wind_penetration

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             3                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Pen         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
train 18219
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
val 2608
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
	iters: 100, epoch: 1 | loss: 0.2567706
	speed: 0.0342s/iter; left time: 386.2279s
	iters: 200, epoch: 1 | loss: 0.2142489
	speed: 0.0210s/iter; left time: 235.6984s
	iters: 300, epoch: 1 | loss: 0.2528908
	speed: 0.0217s/iter; left time: 240.5933s
	iters: 400, epoch: 1 | loss: 0.2229029
	speed: 0.0221s/iter; left time: 243.0002s
	iters: 500, epoch: 1 | loss: 0.2572404
	speed: 0.0201s/iter; left time: 218.8591s
Epoch: 1 cost time: 13.362463474273682
Epoch: 1, Steps: 570 | Train Loss: 0.2417724 Vali Loss: 0.0427707 Test Loss: 0.1382565
Validation loss decreased (inf --> 0.042771).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1239305
	speed: 0.0604s/iter; left time: 648.6421s
	iters: 200, epoch: 2 | loss: 0.2925339
	speed: 0.0200s/iter; left time: 212.8801s
	iters: 300, epoch: 2 | loss: 0.1789535
	speed: 0.0200s/iter; left time: 211.0029s
	iters: 400, epoch: 2 | loss: 0.1532856
	speed: 0.0200s/iter; left time: 208.7169s
	iters: 500, epoch: 2 | loss: 0.1584373
	speed: 0.0200s/iter; left time: 206.8939s
Epoch: 2 cost time: 11.748602867126465
Epoch: 2, Steps: 570 | Train Loss: 0.2058905 Vali Loss: 0.0403801 Test Loss: 0.1364198
Validation loss decreased (0.042771 --> 0.040380).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1154328
	speed: 0.0619s/iter; left time: 629.0581s
	iters: 200, epoch: 3 | loss: 0.1453970
	speed: 0.0201s/iter; left time: 201.8811s
	iters: 300, epoch: 3 | loss: 0.1838019
	speed: 0.0200s/iter; left time: 199.5659s
	iters: 400, epoch: 3 | loss: 0.1860655
	speed: 0.0200s/iter; left time: 197.7064s
	iters: 500, epoch: 3 | loss: 0.1407610
	speed: 0.0200s/iter; left time: 195.5472s
Epoch: 3 cost time: 11.747697830200195
Epoch: 3, Steps: 570 | Train Loss: 0.1787053 Vali Loss: 0.0385960 Test Loss: 0.1308118
Validation loss decreased (0.040380 --> 0.038596).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1281968
	speed: 0.0614s/iter; left time: 588.8104s
	iters: 200, epoch: 4 | loss: 0.2452919
	speed: 0.0200s/iter; left time: 189.4604s
	iters: 300, epoch: 4 | loss: 0.1402371
	speed: 0.0200s/iter; left time: 187.4909s
	iters: 400, epoch: 4 | loss: 0.1856157
	speed: 0.0200s/iter; left time: 185.7413s
	iters: 500, epoch: 4 | loss: 0.1183619
	speed: 0.0200s/iter; left time: 183.3674s
Epoch: 4 cost time: 11.67385983467102
Epoch: 4, Steps: 570 | Train Loss: 0.1681408 Vali Loss: 0.0375157 Test Loss: 0.1326048
Validation loss decreased (0.038596 --> 0.037516).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1633693
	speed: 0.0602s/iter; left time: 542.7376s
	iters: 200, epoch: 5 | loss: 0.1993430
	speed: 0.0200s/iter; left time: 178.7681s
	iters: 300, epoch: 5 | loss: 0.1846220
	speed: 0.0200s/iter; left time: 176.7765s
	iters: 400, epoch: 5 | loss: 0.1507974
	speed: 0.0200s/iter; left time: 174.7049s
	iters: 500, epoch: 5 | loss: 0.1492680
	speed: 0.0200s/iter; left time: 172.6586s
Epoch: 5 cost time: 12.089607954025269
Epoch: 5, Steps: 570 | Train Loss: 0.1597067 Vali Loss: 0.0364650 Test Loss: 0.1326645
Validation loss decreased (0.037516 --> 0.036465).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1818677
	speed: 0.0639s/iter; left time: 539.7025s
	iters: 200, epoch: 6 | loss: 0.1553213
	speed: 0.0212s/iter; left time: 176.8318s
	iters: 300, epoch: 6 | loss: 0.1427901
	speed: 0.0201s/iter; left time: 165.6047s
	iters: 400, epoch: 6 | loss: 0.0946978
	speed: 0.0201s/iter; left time: 163.5143s
	iters: 500, epoch: 6 | loss: 0.2577644
	speed: 0.0201s/iter; left time: 161.4957s
Epoch: 6 cost time: 12.156684637069702
Epoch: 6, Steps: 570 | Train Loss: 0.1575563 Vali Loss: 0.0360521 Test Loss: 0.1330064
Validation loss decreased (0.036465 --> 0.036052).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2035481
	speed: 0.0598s/iter; left time: 471.5976s
	iters: 200, epoch: 7 | loss: 0.1561078
	speed: 0.0201s/iter; left time: 156.0514s
	iters: 300, epoch: 7 | loss: 0.1796922
	speed: 0.0200s/iter; left time: 153.8804s
	iters: 400, epoch: 7 | loss: 0.1770576
	speed: 0.0200s/iter; left time: 151.7866s
	iters: 500, epoch: 7 | loss: 0.1408308
	speed: 0.0201s/iter; left time: 150.1044s
Epoch: 7 cost time: 11.776024103164673
Epoch: 7, Steps: 570 | Train Loss: 0.1569338 Vali Loss: 0.0359241 Test Loss: 0.1316430
Validation loss decreased (0.036052 --> 0.035924).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1866147
	speed: 0.0612s/iter; left time: 447.1609s
	iters: 200, epoch: 8 | loss: 0.2156847
	speed: 0.0201s/iter; left time: 145.2136s
	iters: 300, epoch: 8 | loss: 0.1801013
	speed: 0.0200s/iter; left time: 142.4531s
	iters: 400, epoch: 8 | loss: 0.1036639
	speed: 0.0200s/iter; left time: 140.2952s
	iters: 500, epoch: 8 | loss: 0.1960306
	speed: 0.0200s/iter; left time: 138.1204s
Epoch: 8 cost time: 11.758761405944824
Epoch: 8, Steps: 570 | Train Loss: 0.1558806 Vali Loss: 0.0361340 Test Loss: 0.1318447
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1650240
	speed: 0.0585s/iter; left time: 394.5277s
	iters: 200, epoch: 9 | loss: 0.1448478
	speed: 0.0201s/iter; left time: 133.6610s
	iters: 300, epoch: 9 | loss: 0.2067760
	speed: 0.0201s/iter; left time: 131.7060s
	iters: 400, epoch: 9 | loss: 0.1304174
	speed: 0.0201s/iter; left time: 129.3608s
	iters: 500, epoch: 9 | loss: 0.1005794
	speed: 0.0201s/iter; left time: 127.5032s
Epoch: 9 cost time: 11.750524997711182
Epoch: 9, Steps: 570 | Train Loss: 0.1540235 Vali Loss: 0.0360223 Test Loss: 0.1316782
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1512538
	speed: 0.0581s/iter; left time: 358.6035s
	iters: 200, epoch: 10 | loss: 0.1181865
	speed: 0.0201s/iter; left time: 121.7686s
	iters: 300, epoch: 10 | loss: 0.2725187
	speed: 0.0201s/iter; left time: 119.7365s
	iters: 400, epoch: 10 | loss: 0.1949140
	speed: 0.0200s/iter; left time: 117.4906s
	iters: 500, epoch: 10 | loss: 0.1667861
	speed: 0.0200s/iter; left time: 115.3706s
Epoch: 10 cost time: 11.680200815200806
Epoch: 10, Steps: 570 | Train Loss: 0.1541160 Vali Loss: 0.0361794 Test Loss: 0.1317231
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Pen_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Pen_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_penetration', 'wind_penetration']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1317797154188156, mae:0.226481094956398
