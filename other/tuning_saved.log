True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1668184
	speed: 0.0232s/iter; left time: 261.6856s
	iters: 200, epoch: 1 | loss: 0.1968358
	speed: 0.0112s/iter; left time: 125.7434s
	iters: 300, epoch: 1 | loss: 0.1832968
	speed: 0.0114s/iter; left time: 126.2866s
	iters: 400, epoch: 1 | loss: 0.1859085
	speed: 0.0114s/iter; left time: 125.2163s
	iters: 500, epoch: 1 | loss: 0.2158217
	speed: 0.0114s/iter; left time: 124.4637s
Epoch: 1 cost time: 7.703599452972412
Epoch: 1, Steps: 570 | Train Loss: 0.2083975 Vali Loss: 0.0515174 Test Loss: 0.1629780
Validation loss decreased (inf --> 0.051517).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3291485
	speed: 0.0384s/iter; left time: 411.6185s
	iters: 200, epoch: 2 | loss: 0.2241254
	speed: 0.0114s/iter; left time: 120.9441s
	iters: 300, epoch: 2 | loss: 0.1987359
	speed: 0.0114s/iter; left time: 119.7528s
	iters: 400, epoch: 2 | loss: 0.2423836
	speed: 0.0114s/iter; left time: 119.0787s
	iters: 500, epoch: 2 | loss: 0.2867766
	speed: 0.0114s/iter; left time: 117.5867s
Epoch: 2 cost time: 6.824478387832642
Epoch: 2, Steps: 570 | Train Loss: 0.2576519 Vali Loss: 0.0684576 Test Loss: 0.1809007
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1952623
	speed: 0.0381s/iter; left time: 387.1759s
	iters: 200, epoch: 3 | loss: 0.2611968
	speed: 0.0114s/iter; left time: 114.8335s
	iters: 300, epoch: 3 | loss: 0.1721100
	speed: 0.0114s/iter; left time: 113.2038s
	iters: 400, epoch: 3 | loss: 0.2667773
	speed: 0.0114s/iter; left time: 112.0488s
	iters: 500, epoch: 3 | loss: 0.3224335
	speed: 0.0113s/iter; left time: 110.5000s
Epoch: 3 cost time: 6.6749584674835205
Epoch: 3, Steps: 570 | Train Loss: 0.2467329 Vali Loss: 0.0648856 Test Loss: 0.1647076
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3145069
	speed: 0.0370s/iter; left time: 354.6019s
	iters: 200, epoch: 4 | loss: 0.1908078
	speed: 0.0111s/iter; left time: 105.0886s
	iters: 300, epoch: 4 | loss: 0.2720823
	speed: 0.0115s/iter; left time: 108.3005s
	iters: 400, epoch: 4 | loss: 0.2160956
	speed: 0.0122s/iter; left time: 113.0037s
	iters: 500, epoch: 4 | loss: 0.2266363
	speed: 0.0115s/iter; left time: 105.3902s
Epoch: 4 cost time: 6.791365623474121
Epoch: 4, Steps: 570 | Train Loss: 0.2179058 Vali Loss: 0.0635907 Test Loss: 0.1608318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1631806194782257, mae:0.26068833470344543
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1879944
	speed: 0.0215s/iter; left time: 243.0087s
	iters: 200, epoch: 1 | loss: 0.1874471
	speed: 0.0098s/iter; left time: 109.7131s
	iters: 300, epoch: 1 | loss: 0.2482666
	speed: 0.0098s/iter; left time: 108.8628s
	iters: 400, epoch: 1 | loss: 0.1488428
	speed: 0.0098s/iter; left time: 107.5978s
	iters: 500, epoch: 1 | loss: 0.1444412
	speed: 0.0098s/iter; left time: 106.6762s
Epoch: 1 cost time: 6.804545879364014
Epoch: 1, Steps: 570 | Train Loss: 0.1682830 Vali Loss: 0.0436042 Test Loss: 0.1377011
Validation loss decreased (inf --> 0.043604).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1398871
	speed: 0.0348s/iter; left time: 373.0056s
	iters: 200, epoch: 2 | loss: 0.1850255
	speed: 0.0096s/iter; left time: 102.5690s
	iters: 300, epoch: 2 | loss: 0.1077379
	speed: 0.0096s/iter; left time: 101.3430s
	iters: 400, epoch: 2 | loss: 0.1096446
	speed: 0.0096s/iter; left time: 100.6020s
	iters: 500, epoch: 2 | loss: 0.2028266
	speed: 0.0096s/iter; left time: 99.4225s
Epoch: 2 cost time: 5.789113998413086
Epoch: 2, Steps: 570 | Train Loss: 0.1612543 Vali Loss: 0.0431032 Test Loss: 0.1407291
Validation loss decreased (0.043604 --> 0.043103).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0767745
	speed: 0.0356s/iter; left time: 361.8705s
	iters: 200, epoch: 3 | loss: 0.1207427
	speed: 0.0097s/iter; left time: 98.0368s
	iters: 300, epoch: 3 | loss: 0.2777740
	speed: 0.0097s/iter; left time: 96.9716s
	iters: 400, epoch: 3 | loss: 0.1337653
	speed: 0.0097s/iter; left time: 95.8635s
	iters: 500, epoch: 3 | loss: 0.1266848
	speed: 0.0097s/iter; left time: 94.9676s
Epoch: 3 cost time: 5.872825384140015
Epoch: 3, Steps: 570 | Train Loss: 0.1380364 Vali Loss: 0.0397742 Test Loss: 0.1264060
Validation loss decreased (0.043103 --> 0.039774).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0792852
	speed: 0.0352s/iter; left time: 337.5416s
	iters: 200, epoch: 4 | loss: 0.0799794
	speed: 0.0097s/iter; left time: 91.9266s
	iters: 300, epoch: 4 | loss: 0.0885246
	speed: 0.0097s/iter; left time: 91.2989s
	iters: 400, epoch: 4 | loss: 0.0728028
	speed: 0.0097s/iter; left time: 90.2095s
	iters: 500, epoch: 4 | loss: 0.1350426
	speed: 0.0097s/iter; left time: 88.7340s
Epoch: 4 cost time: 5.789398670196533
Epoch: 4, Steps: 570 | Train Loss: 0.1146851 Vali Loss: 0.0357869 Test Loss: 0.1162586
Validation loss decreased (0.039774 --> 0.035787).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1119463
	speed: 0.0359s/iter; left time: 323.6704s
	iters: 200, epoch: 5 | loss: 0.1653396
	speed: 0.0097s/iter; left time: 86.7166s
	iters: 300, epoch: 5 | loss: 0.1019746
	speed: 0.0097s/iter; left time: 85.7275s
	iters: 400, epoch: 5 | loss: 0.1152093
	speed: 0.0097s/iter; left time: 84.7205s
	iters: 500, epoch: 5 | loss: 0.0985917
	speed: 0.0097s/iter; left time: 83.7328s
Epoch: 5 cost time: 5.8364338874816895
Epoch: 5, Steps: 570 | Train Loss: 0.1009639 Vali Loss: 0.0364314 Test Loss: 0.1136684
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0581600
	speed: 0.0347s/iter; left time: 293.2471s
	iters: 200, epoch: 6 | loss: 0.1095032
	speed: 0.0097s/iter; left time: 80.9160s
	iters: 300, epoch: 6 | loss: 0.1278585
	speed: 0.0097s/iter; left time: 79.9372s
	iters: 400, epoch: 6 | loss: 0.0641890
	speed: 0.0097s/iter; left time: 78.9614s
	iters: 500, epoch: 6 | loss: 0.0766375
	speed: 0.0097s/iter; left time: 77.9750s
Epoch: 6 cost time: 5.806777000427246
Epoch: 6, Steps: 570 | Train Loss: 0.0925622 Vali Loss: 0.0370014 Test Loss: 0.1155212
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0849662
	speed: 0.0348s/iter; left time: 274.4081s
	iters: 200, epoch: 7 | loss: 0.0992069
	speed: 0.0097s/iter; left time: 75.4419s
	iters: 300, epoch: 7 | loss: 0.1484343
	speed: 0.0097s/iter; left time: 74.4624s
	iters: 400, epoch: 7 | loss: 0.1500152
	speed: 0.0097s/iter; left time: 73.4141s
	iters: 500, epoch: 7 | loss: 0.1286581
	speed: 0.0097s/iter; left time: 72.4792s
Epoch: 7 cost time: 5.80428409576416
Epoch: 7, Steps: 570 | Train Loss: 0.0875537 Vali Loss: 0.0360128 Test Loss: 0.1157063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11642131209373474, mae:0.20923534035682678
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2429955
	speed: 0.0214s/iter; left time: 241.5398s
	iters: 200, epoch: 1 | loss: 0.1262257
	speed: 0.0098s/iter; left time: 109.9802s
	iters: 300, epoch: 1 | loss: 0.1267452
	speed: 0.0098s/iter; left time: 109.2423s
	iters: 400, epoch: 1 | loss: 0.1871254
	speed: 0.0098s/iter; left time: 107.9808s
	iters: 500, epoch: 1 | loss: 0.2177178
	speed: 0.0098s/iter; left time: 107.1591s
Epoch: 1 cost time: 6.801011562347412
Epoch: 1, Steps: 570 | Train Loss: 0.2265803 Vali Loss: 0.0527771 Test Loss: 0.1677906
Validation loss decreased (inf --> 0.052777).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1989672
	speed: 0.0354s/iter; left time: 379.5368s
	iters: 200, epoch: 2 | loss: 0.2996998
	speed: 0.0097s/iter; left time: 103.5555s
	iters: 300, epoch: 2 | loss: 0.1947185
	speed: 0.0097s/iter; left time: 101.7320s
	iters: 400, epoch: 2 | loss: 0.2522361
	speed: 0.0097s/iter; left time: 100.9366s
	iters: 500, epoch: 2 | loss: 0.2612756
	speed: 0.0097s/iter; left time: 99.7859s
Epoch: 2 cost time: 5.831964731216431
Epoch: 2, Steps: 570 | Train Loss: 0.2259816 Vali Loss: 0.0574514 Test Loss: 0.1699410
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1365477
	speed: 0.0384s/iter; left time: 389.9169s
	iters: 200, epoch: 3 | loss: 0.1770229
	speed: 0.0098s/iter; left time: 98.7192s
	iters: 300, epoch: 3 | loss: 0.2543505
	speed: 0.0098s/iter; left time: 97.3624s
	iters: 400, epoch: 3 | loss: 0.1783216
	speed: 0.0098s/iter; left time: 96.4835s
	iters: 500, epoch: 3 | loss: 0.1370625
	speed: 0.0098s/iter; left time: 95.5055s
Epoch: 3 cost time: 5.9805006980896
Epoch: 3, Steps: 570 | Train Loss: 0.2107144 Vali Loss: 0.0469428 Test Loss: 0.1451066
Validation loss decreased (0.052777 --> 0.046943).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1333973
	speed: 0.0356s/iter; left time: 341.0515s
	iters: 200, epoch: 4 | loss: 0.0943953
	speed: 0.0097s/iter; left time: 92.1147s
	iters: 300, epoch: 4 | loss: 0.1297451
	speed: 0.0097s/iter; left time: 91.1326s
	iters: 400, epoch: 4 | loss: 0.2211343
	speed: 0.0097s/iter; left time: 90.1527s
	iters: 500, epoch: 4 | loss: 0.1433680
	speed: 0.0097s/iter; left time: 88.9767s
Epoch: 4 cost time: 5.840884208679199
Epoch: 4, Steps: 570 | Train Loss: 0.1749125 Vali Loss: 0.0473251 Test Loss: 0.1498124
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1313210
	speed: 0.0352s/iter; left time: 317.5489s
	iters: 200, epoch: 5 | loss: 0.1570131
	speed: 0.0098s/iter; left time: 87.2822s
	iters: 300, epoch: 5 | loss: 0.2370802
	speed: 0.0098s/iter; left time: 86.4381s
	iters: 400, epoch: 5 | loss: 0.1019689
	speed: 0.0097s/iter; left time: 85.0051s
	iters: 500, epoch: 5 | loss: 0.2425003
	speed: 0.0097s/iter; left time: 83.9112s
Epoch: 5 cost time: 5.827359914779663
Epoch: 5, Steps: 570 | Train Loss: 0.1612860 Vali Loss: 0.0438437 Test Loss: 0.1477919
Validation loss decreased (0.046943 --> 0.043844).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1151529
	speed: 0.0353s/iter; left time: 298.6379s
	iters: 200, epoch: 6 | loss: 0.1784842
	speed: 0.0097s/iter; left time: 80.8533s
	iters: 300, epoch: 6 | loss: 0.1698503
	speed: 0.0097s/iter; left time: 79.7852s
	iters: 400, epoch: 6 | loss: 0.1325180
	speed: 0.0097s/iter; left time: 78.8975s
	iters: 500, epoch: 6 | loss: 0.1904864
	speed: 0.0097s/iter; left time: 77.8109s
Epoch: 6 cost time: 5.821336030960083
Epoch: 6, Steps: 570 | Train Loss: 0.1502975 Vali Loss: 0.0432721 Test Loss: 0.1421744
Validation loss decreased (0.043844 --> 0.043272).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0912671
	speed: 0.0353s/iter; left time: 278.4266s
	iters: 200, epoch: 7 | loss: 0.1507141
	speed: 0.0097s/iter; left time: 75.5434s
	iters: 300, epoch: 7 | loss: 0.1111932
	speed: 0.0097s/iter; left time: 74.5456s
	iters: 400, epoch: 7 | loss: 0.0750316
	speed: 0.0097s/iter; left time: 73.6544s
	iters: 500, epoch: 7 | loss: 0.1784825
	speed: 0.0097s/iter; left time: 72.6308s
Epoch: 7 cost time: 5.84650731086731
Epoch: 7, Steps: 570 | Train Loss: 0.1443310 Vali Loss: 0.0433332 Test Loss: 0.1409613
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0878188
	speed: 0.0354s/iter; left time: 258.8508s
	iters: 200, epoch: 8 | loss: 0.1318479
	speed: 0.0097s/iter; left time: 69.8767s
	iters: 300, epoch: 8 | loss: 0.1270279
	speed: 0.0097s/iter; left time: 68.8890s
	iters: 400, epoch: 8 | loss: 0.1578188
	speed: 0.0097s/iter; left time: 67.9465s
	iters: 500, epoch: 8 | loss: 0.1500511
	speed: 0.0097s/iter; left time: 66.9711s
Epoch: 8 cost time: 5.831233501434326
Epoch: 8, Steps: 570 | Train Loss: 0.1401656 Vali Loss: 0.0427601 Test Loss: 0.1404220
Validation loss decreased (0.043272 --> 0.042760).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1381372
	speed: 0.0354s/iter; left time: 238.6854s
	iters: 200, epoch: 9 | loss: 0.1403579
	speed: 0.0097s/iter; left time: 64.6457s
	iters: 300, epoch: 9 | loss: 0.1187568
	speed: 0.0097s/iter; left time: 63.6444s
	iters: 400, epoch: 9 | loss: 0.0885384
	speed: 0.0097s/iter; left time: 62.6814s
	iters: 500, epoch: 9 | loss: 0.1417777
	speed: 0.0097s/iter; left time: 61.6799s
Epoch: 9 cost time: 5.867711305618286
Epoch: 9, Steps: 570 | Train Loss: 0.1382025 Vali Loss: 0.0433924 Test Loss: 0.1427714
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1171558
	speed: 0.0357s/iter; left time: 220.5606s
	iters: 200, epoch: 10 | loss: 0.1783067
	speed: 0.0097s/iter; left time: 59.0521s
	iters: 300, epoch: 10 | loss: 0.1544783
	speed: 0.0097s/iter; left time: 58.0650s
	iters: 400, epoch: 10 | loss: 0.1501161
	speed: 0.0097s/iter; left time: 57.0939s
	iters: 500, epoch: 10 | loss: 0.1953642
	speed: 0.0097s/iter; left time: 56.0842s
Epoch: 10 cost time: 5.868743896484375
Epoch: 10, Steps: 570 | Train Loss: 0.1372004 Vali Loss: 0.0433279 Test Loss: 0.1432870
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1529302
	speed: 0.0352s/iter; left time: 197.0089s
	iters: 200, epoch: 11 | loss: 0.1255644
	speed: 0.0097s/iter; left time: 53.4429s
	iters: 300, epoch: 11 | loss: 0.1809491
	speed: 0.0097s/iter; left time: 52.4519s
	iters: 400, epoch: 11 | loss: 0.1512925
	speed: 0.0097s/iter; left time: 51.4639s
	iters: 500, epoch: 11 | loss: 0.1629266
	speed: 0.0097s/iter; left time: 50.4600s
Epoch: 11 cost time: 5.854115962982178
Epoch: 11, Steps: 570 | Train Loss: 0.1363042 Vali Loss: 0.0431477 Test Loss: 0.1432028
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1405969113111496, mae:0.24108478426933289
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2673554
	speed: 0.0246s/iter; left time: 277.4486s
	iters: 200, epoch: 1 | loss: 0.2358598
	speed: 0.0124s/iter; left time: 139.2547s
	iters: 300, epoch: 1 | loss: 0.1605896
	speed: 0.0124s/iter; left time: 138.2013s
	iters: 400, epoch: 1 | loss: 0.2092649
	speed: 0.0124s/iter; left time: 136.5681s
	iters: 500, epoch: 1 | loss: 0.3037598
	speed: 0.0125s/iter; left time: 135.8223s
Epoch: 1 cost time: 8.350462436676025
Epoch: 1, Steps: 570 | Train Loss: 0.2843307 Vali Loss: 0.0668196 Test Loss: 0.1870127
Validation loss decreased (inf --> 0.066820).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2432782
	speed: 0.0403s/iter; left time: 432.2204s
	iters: 200, epoch: 2 | loss: 0.1925197
	speed: 0.0114s/iter; left time: 121.0829s
	iters: 300, epoch: 2 | loss: 0.1782432
	speed: 0.0114s/iter; left time: 119.8990s
	iters: 400, epoch: 2 | loss: 0.1232579
	speed: 0.0114s/iter; left time: 118.7097s
	iters: 500, epoch: 2 | loss: 0.2400337
	speed: 0.0114s/iter; left time: 117.6306s
Epoch: 2 cost time: 6.807101488113403
Epoch: 2, Steps: 570 | Train Loss: 0.2810881 Vali Loss: 0.0608437 Test Loss: 0.1798609
Validation loss decreased (0.066820 --> 0.060844).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3295406
	speed: 0.0404s/iter; left time: 410.9003s
	iters: 200, epoch: 3 | loss: 0.4188828
	speed: 0.0125s/iter; left time: 125.4526s
	iters: 300, epoch: 3 | loss: 0.1578331
	speed: 0.0124s/iter; left time: 123.9663s
	iters: 400, epoch: 3 | loss: 0.2161615
	speed: 0.0125s/iter; left time: 122.8127s
	iters: 500, epoch: 3 | loss: 0.2143182
	speed: 0.0125s/iter; left time: 121.6186s
Epoch: 3 cost time: 7.421802043914795
Epoch: 3, Steps: 570 | Train Loss: 0.2520068 Vali Loss: 0.0636789 Test Loss: 0.1797697
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1728122
	speed: 0.0381s/iter; left time: 365.7660s
	iters: 200, epoch: 4 | loss: 0.2393166
	speed: 0.0114s/iter; left time: 108.0863s
	iters: 300, epoch: 4 | loss: 0.1626475
	speed: 0.0114s/iter; left time: 107.0831s
	iters: 400, epoch: 4 | loss: 0.1333545
	speed: 0.0114s/iter; left time: 105.8298s
	iters: 500, epoch: 4 | loss: 0.1654302
	speed: 0.0114s/iter; left time: 104.7101s
Epoch: 4 cost time: 6.775732755661011
Epoch: 4, Steps: 570 | Train Loss: 0.2222100 Vali Loss: 0.0608348 Test Loss: 0.1682695
Validation loss decreased (0.060844 --> 0.060835).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1581249
	speed: 0.0390s/iter; left time: 351.6616s
	iters: 200, epoch: 5 | loss: 0.1555440
	speed: 0.0114s/iter; left time: 101.8474s
	iters: 300, epoch: 5 | loss: 0.2902546
	speed: 0.0114s/iter; left time: 100.8013s
	iters: 400, epoch: 5 | loss: 0.1749023
	speed: 0.0114s/iter; left time: 99.5991s
	iters: 500, epoch: 5 | loss: 0.2035597
	speed: 0.0114s/iter; left time: 98.6323s
Epoch: 5 cost time: 6.852463245391846
Epoch: 5, Steps: 570 | Train Loss: 0.2089508 Vali Loss: 0.0620068 Test Loss: 0.1694303
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1826471
	speed: 0.0393s/iter; left time: 332.0718s
	iters: 200, epoch: 6 | loss: 0.1136283
	speed: 0.0114s/iter; left time: 95.5420s
	iters: 300, epoch: 6 | loss: 0.2019654
	speed: 0.0114s/iter; left time: 94.4027s
	iters: 400, epoch: 6 | loss: 0.1772547
	speed: 0.0115s/iter; left time: 93.4760s
	iters: 500, epoch: 6 | loss: 0.1489908
	speed: 0.0115s/iter; left time: 92.2022s
Epoch: 6 cost time: 6.887919902801514
Epoch: 6, Steps: 570 | Train Loss: 0.2033361 Vali Loss: 0.0616341 Test Loss: 0.1669102
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2622835
	speed: 0.0386s/iter; left time: 304.3293s
	iters: 200, epoch: 7 | loss: 0.2151243
	speed: 0.0116s/iter; left time: 90.2471s
	iters: 300, epoch: 7 | loss: 0.2167960
	speed: 0.0114s/iter; left time: 87.4714s
	iters: 400, epoch: 7 | loss: 0.1562091
	speed: 0.0114s/iter; left time: 86.2599s
	iters: 500, epoch: 7 | loss: 0.2143835
	speed: 0.0114s/iter; left time: 85.1803s
Epoch: 7 cost time: 6.901947021484375
Epoch: 7, Steps: 570 | Train Loss: 0.1996851 Vali Loss: 0.0609210 Test Loss: 0.1667071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1685466766357422, mae:0.27037519216537476
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1208526
	speed: 0.0230s/iter; left time: 259.3597s
	iters: 200, epoch: 1 | loss: 0.2859458
	speed: 0.0110s/iter; left time: 123.1896s
	iters: 300, epoch: 1 | loss: 0.1719414
	speed: 0.0110s/iter; left time: 122.2438s
	iters: 400, epoch: 1 | loss: 0.2156864
	speed: 0.0110s/iter; left time: 120.9763s
	iters: 500, epoch: 1 | loss: 0.1559027
	speed: 0.0110s/iter; left time: 120.0080s
Epoch: 1 cost time: 7.515220880508423
Epoch: 1, Steps: 570 | Train Loss: 0.2086973 Vali Loss: 0.0515904 Test Loss: 0.1532065
Validation loss decreased (inf --> 0.051590).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2164857
	speed: 0.0384s/iter; left time: 412.4486s
	iters: 200, epoch: 2 | loss: 0.1621193
	speed: 0.0110s/iter; left time: 117.0340s
	iters: 300, epoch: 2 | loss: 0.2461625
	speed: 0.0110s/iter; left time: 115.8736s
	iters: 400, epoch: 2 | loss: 0.3248372
	speed: 0.0110s/iter; left time: 114.4949s
	iters: 500, epoch: 2 | loss: 0.3872446
	speed: 0.0110s/iter; left time: 113.5162s
Epoch: 2 cost time: 6.597521066665649
Epoch: 2, Steps: 570 | Train Loss: 0.2381216 Vali Loss: 0.0526147 Test Loss: 0.1589930
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2298876
	speed: 0.0381s/iter; left time: 387.4630s
	iters: 200, epoch: 3 | loss: 0.0892347
	speed: 0.0111s/iter; left time: 111.2457s
	iters: 300, epoch: 3 | loss: 0.2041319
	speed: 0.0110s/iter; left time: 109.6310s
	iters: 400, epoch: 3 | loss: 0.2050402
	speed: 0.0110s/iter; left time: 108.4128s
	iters: 500, epoch: 3 | loss: 0.2003963
	speed: 0.0110s/iter; left time: 107.1588s
Epoch: 3 cost time: 6.672077417373657
Epoch: 3, Steps: 570 | Train Loss: 0.1838980 Vali Loss: 0.0454281 Test Loss: 0.1411109
Validation loss decreased (0.051590 --> 0.045428).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1862133
	speed: 0.0394s/iter; left time: 378.0582s
	iters: 200, epoch: 4 | loss: 0.1526703
	speed: 0.0121s/iter; left time: 114.9258s
	iters: 300, epoch: 4 | loss: 0.0859537
	speed: 0.0121s/iter; left time: 113.3613s
	iters: 400, epoch: 4 | loss: 0.1531971
	speed: 0.0121s/iter; left time: 112.2108s
	iters: 500, epoch: 4 | loss: 0.1257672
	speed: 0.0115s/iter; left time: 105.5564s
Epoch: 4 cost time: 7.066507577896118
Epoch: 4, Steps: 570 | Train Loss: 0.1588286 Vali Loss: 0.0467338 Test Loss: 0.1424807
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1165126
	speed: 0.0375s/iter; left time: 338.0736s
	iters: 200, epoch: 5 | loss: 0.1202716
	speed: 0.0110s/iter; left time: 98.3584s
	iters: 300, epoch: 5 | loss: 0.1846251
	speed: 0.0111s/iter; left time: 97.7525s
	iters: 400, epoch: 5 | loss: 0.1324604
	speed: 0.0111s/iter; left time: 96.4726s
	iters: 500, epoch: 5 | loss: 0.1090243
	speed: 0.0110s/iter; left time: 95.2249s
Epoch: 5 cost time: 6.622970104217529
Epoch: 5, Steps: 570 | Train Loss: 0.1417700 Vali Loss: 0.0407827 Test Loss: 0.1379961
Validation loss decreased (0.045428 --> 0.040783).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1700202
	speed: 0.0377s/iter; left time: 318.8579s
	iters: 200, epoch: 6 | loss: 0.1496533
	speed: 0.0110s/iter; left time: 92.0231s
	iters: 300, epoch: 6 | loss: 0.0920784
	speed: 0.0110s/iter; left time: 91.1246s
	iters: 400, epoch: 6 | loss: 0.0841550
	speed: 0.0110s/iter; left time: 89.9901s
	iters: 500, epoch: 6 | loss: 0.1100778
	speed: 0.0110s/iter; left time: 88.7411s
Epoch: 6 cost time: 6.595178842544556
Epoch: 6, Steps: 570 | Train Loss: 0.1324151 Vali Loss: 0.0401964 Test Loss: 0.1361016
Validation loss decreased (0.040783 --> 0.040196).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0873016
	speed: 0.0397s/iter; left time: 312.8614s
	iters: 200, epoch: 7 | loss: 0.1881062
	speed: 0.0111s/iter; left time: 86.0055s
	iters: 300, epoch: 7 | loss: 0.1087534
	speed: 0.0110s/iter; left time: 84.6569s
	iters: 400, epoch: 7 | loss: 0.1095457
	speed: 0.0110s/iter; left time: 83.5582s
	iters: 500, epoch: 7 | loss: 0.0909741
	speed: 0.0110s/iter; left time: 82.5666s
Epoch: 7 cost time: 6.594077825546265
Epoch: 7, Steps: 570 | Train Loss: 0.1267670 Vali Loss: 0.0402969 Test Loss: 0.1349403
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1074128
	speed: 0.0385s/iter; left time: 281.5454s
	iters: 200, epoch: 8 | loss: 0.1466217
	speed: 0.0121s/iter; left time: 87.0233s
	iters: 300, epoch: 8 | loss: 0.1092096
	speed: 0.0120s/iter; left time: 85.6172s
	iters: 400, epoch: 8 | loss: 0.0924052
	speed: 0.0120s/iter; left time: 84.4063s
	iters: 500, epoch: 8 | loss: 0.1204413
	speed: 0.0120s/iter; left time: 83.2477s
Epoch: 8 cost time: 7.180884838104248
Epoch: 8, Steps: 570 | Train Loss: 0.1230836 Vali Loss: 0.0399046 Test Loss: 0.1353944
Validation loss decreased (0.040196 --> 0.039905).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1407759
	speed: 0.0401s/iter; left time: 270.4314s
	iters: 200, epoch: 9 | loss: 0.0852659
	speed: 0.0110s/iter; left time: 73.1085s
	iters: 300, epoch: 9 | loss: 0.1555552
	speed: 0.0110s/iter; left time: 71.9556s
	iters: 400, epoch: 9 | loss: 0.1433156
	speed: 0.0110s/iter; left time: 71.0808s
	iters: 500, epoch: 9 | loss: 0.1607147
	speed: 0.0110s/iter; left time: 69.9153s
Epoch: 9 cost time: 6.589288711547852
Epoch: 9, Steps: 570 | Train Loss: 0.1213381 Vali Loss: 0.0391797 Test Loss: 0.1352211
Validation loss decreased (0.039905 --> 0.039180).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1191340
	speed: 0.0380s/iter; left time: 234.4037s
	iters: 200, epoch: 10 | loss: 0.0910964
	speed: 0.0110s/iter; left time: 67.0451s
	iters: 300, epoch: 10 | loss: 0.1056505
	speed: 0.0111s/iter; left time: 66.0089s
	iters: 400, epoch: 10 | loss: 0.1334907
	speed: 0.0111s/iter; left time: 64.9510s
	iters: 500, epoch: 10 | loss: 0.1398455
	speed: 0.0111s/iter; left time: 63.8760s
Epoch: 10 cost time: 6.587714672088623
Epoch: 10, Steps: 570 | Train Loss: 0.1202429 Vali Loss: 0.0395060 Test Loss: 0.1355136
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0820738
	speed: 0.0369s/iter; left time: 206.9044s
	iters: 200, epoch: 11 | loss: 0.0953467
	speed: 0.0110s/iter; left time: 60.4672s
	iters: 300, epoch: 11 | loss: 0.1034635
	speed: 0.0110s/iter; left time: 59.5186s
	iters: 400, epoch: 11 | loss: 0.1124705
	speed: 0.0110s/iter; left time: 58.2764s
	iters: 500, epoch: 11 | loss: 0.1682471
	speed: 0.0110s/iter; left time: 57.2027s
Epoch: 11 cost time: 6.561575889587402
Epoch: 11, Steps: 570 | Train Loss: 0.1195659 Vali Loss: 0.0396204 Test Loss: 0.1359874
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1432239
	speed: 0.0390s/iter; left time: 196.2183s
	iters: 200, epoch: 12 | loss: 0.0984666
	speed: 0.0120s/iter; left time: 59.3885s
	iters: 300, epoch: 12 | loss: 0.0857073
	speed: 0.0120s/iter; left time: 58.0878s
	iters: 400, epoch: 12 | loss: 0.1472204
	speed: 0.0121s/iter; left time: 57.0231s
	iters: 500, epoch: 12 | loss: 0.1346401
	speed: 0.0113s/iter; left time: 52.3649s
Epoch: 12 cost time: 7.053299903869629
Epoch: 12, Steps: 570 | Train Loss: 0.1190357 Vali Loss: 0.0397651 Test Loss: 0.1360321
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13543544709682465, mae:0.23163580894470215
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2081373
	speed: 0.0221s/iter; left time: 249.9206s
	iters: 200, epoch: 1 | loss: 0.3531043
	speed: 0.0102s/iter; left time: 114.6250s
	iters: 300, epoch: 1 | loss: 0.3283095
	speed: 0.0102s/iter; left time: 113.7782s
	iters: 400, epoch: 1 | loss: 0.2961910
	speed: 0.0102s/iter; left time: 112.4737s
	iters: 500, epoch: 1 | loss: 0.2852784
	speed: 0.0102s/iter; left time: 111.5174s
Epoch: 1 cost time: 7.073476791381836
Epoch: 1, Steps: 570 | Train Loss: 0.2701385 Vali Loss: 0.0734769 Test Loss: 0.2123958
Validation loss decreased (inf --> 0.073477).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2973227
	speed: 0.0367s/iter; left time: 393.9319s
	iters: 200, epoch: 2 | loss: 0.2906811
	speed: 0.0102s/iter; left time: 108.9230s
	iters: 300, epoch: 2 | loss: 0.1953369
	speed: 0.0102s/iter; left time: 107.5501s
	iters: 400, epoch: 2 | loss: 0.2043611
	speed: 0.0102s/iter; left time: 106.6449s
	iters: 500, epoch: 2 | loss: 0.2483530
	speed: 0.0102s/iter; left time: 105.4227s
Epoch: 2 cost time: 6.165688991546631
Epoch: 2, Steps: 570 | Train Loss: 0.2728299 Vali Loss: 0.0679701 Test Loss: 0.1997746
Validation loss decreased (0.073477 --> 0.067970).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1554442
	speed: 0.0373s/iter; left time: 378.6739s
	iters: 200, epoch: 3 | loss: 0.1863188
	speed: 0.0103s/iter; left time: 103.3202s
	iters: 300, epoch: 3 | loss: 0.2836081
	speed: 0.0103s/iter; left time: 102.5671s
	iters: 400, epoch: 3 | loss: 0.2544675
	speed: 0.0103s/iter; left time: 101.4825s
	iters: 500, epoch: 3 | loss: 0.2589924
	speed: 0.0103s/iter; left time: 100.2030s
Epoch: 3 cost time: 6.174490213394165
Epoch: 3, Steps: 570 | Train Loss: 0.2451306 Vali Loss: 0.0637612 Test Loss: 0.1744619
Validation loss decreased (0.067970 --> 0.063761).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2316469
	speed: 0.0376s/iter; left time: 360.2339s
	iters: 200, epoch: 4 | loss: 0.1120871
	speed: 0.0103s/iter; left time: 97.4191s
	iters: 300, epoch: 4 | loss: 0.2192818
	speed: 0.0103s/iter; left time: 96.8030s
	iters: 400, epoch: 4 | loss: 0.3106847
	speed: 0.0103s/iter; left time: 95.8498s
	iters: 500, epoch: 4 | loss: 0.2026028
	speed: 0.0103s/iter; left time: 94.7682s
Epoch: 4 cost time: 6.2024242877960205
Epoch: 4, Steps: 570 | Train Loss: 0.2175378 Vali Loss: 0.0593487 Test Loss: 0.1607444
Validation loss decreased (0.063761 --> 0.059349).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1770361
	speed: 0.0371s/iter; left time: 334.8778s
	iters: 200, epoch: 5 | loss: 0.1810164
	speed: 0.0103s/iter; left time: 91.8261s
	iters: 300, epoch: 5 | loss: 0.2119149
	speed: 0.0103s/iter; left time: 90.6111s
	iters: 400, epoch: 5 | loss: 0.1309484
	speed: 0.0103s/iter; left time: 89.4972s
	iters: 500, epoch: 5 | loss: 0.2969440
	speed: 0.0103s/iter; left time: 88.5535s
Epoch: 5 cost time: 6.18122935295105
Epoch: 5, Steps: 570 | Train Loss: 0.1965188 Vali Loss: 0.0559909 Test Loss: 0.1539086
Validation loss decreased (0.059349 --> 0.055991).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1419153
	speed: 0.0381s/iter; left time: 322.2824s
	iters: 200, epoch: 6 | loss: 0.1659421
	speed: 0.0114s/iter; left time: 95.1239s
	iters: 300, epoch: 6 | loss: 0.2197290
	speed: 0.0114s/iter; left time: 94.0517s
	iters: 400, epoch: 6 | loss: 0.1411058
	speed: 0.0114s/iter; left time: 92.9358s
	iters: 500, epoch: 6 | loss: 0.1455500
	speed: 0.0114s/iter; left time: 91.8088s
Epoch: 6 cost time: 6.735754489898682
Epoch: 6, Steps: 570 | Train Loss: 0.1863750 Vali Loss: 0.0566236 Test Loss: 0.1557629
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1294671
	speed: 0.0366s/iter; left time: 288.4193s
	iters: 200, epoch: 7 | loss: 0.1749182
	speed: 0.0102s/iter; left time: 79.6240s
	iters: 300, epoch: 7 | loss: 0.1338294
	speed: 0.0102s/iter; left time: 78.5928s
	iters: 400, epoch: 7 | loss: 0.2332579
	speed: 0.0102s/iter; left time: 77.5106s
	iters: 500, epoch: 7 | loss: 0.1354468
	speed: 0.0102s/iter; left time: 76.4637s
Epoch: 7 cost time: 6.12508487701416
Epoch: 7, Steps: 570 | Train Loss: 0.1792891 Vali Loss: 0.0548309 Test Loss: 0.1546936
Validation loss decreased (0.055991 --> 0.054831).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1518206
	speed: 0.0363s/iter; left time: 265.5282s
	iters: 200, epoch: 8 | loss: 0.2262946
	speed: 0.0102s/iter; left time: 73.9107s
	iters: 300, epoch: 8 | loss: 0.2203848
	speed: 0.0103s/iter; left time: 73.0005s
	iters: 400, epoch: 8 | loss: 0.1756611
	speed: 0.0103s/iter; left time: 71.9909s
	iters: 500, epoch: 8 | loss: 0.1367280
	speed: 0.0103s/iter; left time: 70.9266s
Epoch: 8 cost time: 6.151458501815796
Epoch: 8, Steps: 570 | Train Loss: 0.1763261 Vali Loss: 0.0542998 Test Loss: 0.1541872
Validation loss decreased (0.054831 --> 0.054300).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1023468
	speed: 0.0373s/iter; left time: 251.6671s
	iters: 200, epoch: 9 | loss: 0.1155551
	speed: 0.0103s/iter; left time: 68.5821s
	iters: 300, epoch: 9 | loss: 0.2510663
	speed: 0.0102s/iter; left time: 67.0234s
	iters: 400, epoch: 9 | loss: 0.2702790
	speed: 0.0102s/iter; left time: 65.7576s
	iters: 500, epoch: 9 | loss: 0.0944196
	speed: 0.0102s/iter; left time: 64.7729s
Epoch: 9 cost time: 6.1549718379974365
Epoch: 9, Steps: 570 | Train Loss: 0.1741916 Vali Loss: 0.0551400 Test Loss: 0.1549536
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2340378
	speed: 0.0367s/iter; left time: 226.7567s
	iters: 200, epoch: 10 | loss: 0.0925931
	speed: 0.0102s/iter; left time: 62.2094s
	iters: 300, epoch: 10 | loss: 0.1878417
	speed: 0.0102s/iter; left time: 60.8247s
	iters: 400, epoch: 10 | loss: 0.0969002
	speed: 0.0102s/iter; left time: 59.8477s
	iters: 500, epoch: 10 | loss: 0.1904809
	speed: 0.0102s/iter; left time: 58.8705s
Epoch: 10 cost time: 6.138896703720093
Epoch: 10, Steps: 570 | Train Loss: 0.1730067 Vali Loss: 0.0548287 Test Loss: 0.1543280
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1151982
	speed: 0.0359s/iter; left time: 201.2769s
	iters: 200, epoch: 11 | loss: 0.1987495
	speed: 0.0103s/iter; left time: 56.5227s
	iters: 300, epoch: 11 | loss: 0.1097980
	speed: 0.0103s/iter; left time: 55.4841s
	iters: 400, epoch: 11 | loss: 0.1088090
	speed: 0.0103s/iter; left time: 54.5856s
	iters: 500, epoch: 11 | loss: 0.1258720
	speed: 0.0103s/iter; left time: 53.5481s
Epoch: 11 cost time: 6.190441370010376
Epoch: 11, Steps: 570 | Train Loss: 0.1726455 Vali Loss: 0.0548595 Test Loss: 0.1545657
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15438935160636902, mae:0.2481307089328766
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1910524
	speed: 0.0274s/iter; left time: 309.0834s
	iters: 200, epoch: 1 | loss: 0.1724668
	speed: 0.0154s/iter; left time: 172.3475s
	iters: 300, epoch: 1 | loss: 0.2917525
	speed: 0.0154s/iter; left time: 171.1032s
	iters: 400, epoch: 1 | loss: 0.1924879
	speed: 0.0155s/iter; left time: 170.0685s
	iters: 500, epoch: 1 | loss: 0.1730633
	speed: 0.0155s/iter; left time: 168.6396s
Epoch: 1 cost time: 10.041582822799683
Epoch: 1, Steps: 570 | Train Loss: 0.2224579 Vali Loss: 0.0565231 Test Loss: 0.1590333
Validation loss decreased (inf --> 0.056523).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2762584
	speed: 0.0515s/iter; left time: 552.8862s
	iters: 200, epoch: 2 | loss: 0.2946938
	speed: 0.0155s/iter; left time: 165.0776s
	iters: 300, epoch: 2 | loss: 0.2403137
	speed: 0.0155s/iter; left time: 163.2629s
	iters: 400, epoch: 2 | loss: 0.2267851
	speed: 0.0155s/iter; left time: 161.8370s
	iters: 500, epoch: 2 | loss: 0.3126200
	speed: 0.0155s/iter; left time: 159.9422s
Epoch: 2 cost time: 9.166327476501465
Epoch: 2, Steps: 570 | Train Loss: 0.2804122 Vali Loss: 0.0803362 Test Loss: 0.2180425
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4174822
	speed: 0.0457s/iter; left time: 464.7789s
	iters: 200, epoch: 3 | loss: 0.3376241
	speed: 0.0137s/iter; left time: 137.6963s
	iters: 300, epoch: 3 | loss: 0.1651516
	speed: 0.0137s/iter; left time: 136.2773s
	iters: 400, epoch: 3 | loss: 0.2693733
	speed: 0.0137s/iter; left time: 134.9807s
	iters: 500, epoch: 3 | loss: 0.2479194
	speed: 0.0137s/iter; left time: 133.7863s
Epoch: 3 cost time: 8.090153217315674
Epoch: 3, Steps: 570 | Train Loss: 0.2874916 Vali Loss: 0.0774770 Test Loss: 0.1967589
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2508566
	speed: 0.0458s/iter; left time: 438.9825s
	iters: 200, epoch: 4 | loss: 0.2272388
	speed: 0.0139s/iter; left time: 131.4616s
	iters: 300, epoch: 4 | loss: 0.2643112
	speed: 0.0138s/iter; left time: 129.9154s
	iters: 400, epoch: 4 | loss: 0.2609861
	speed: 0.0138s/iter; left time: 128.4933s
	iters: 500, epoch: 4 | loss: 0.2996611
	speed: 0.0138s/iter; left time: 126.8765s
Epoch: 4 cost time: 8.185348987579346
Epoch: 4, Steps: 570 | Train Loss: 0.2648740 Vali Loss: 0.0613281 Test Loss: 0.1687082
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1592792421579361, mae:0.2639329433441162
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2919293
	speed: 0.0271s/iter; left time: 305.8642s
	iters: 200, epoch: 1 | loss: 0.1859017
	speed: 0.0152s/iter; left time: 170.0001s
	iters: 300, epoch: 1 | loss: 0.1094763
	speed: 0.0152s/iter; left time: 168.2682s
	iters: 400, epoch: 1 | loss: 0.2039593
	speed: 0.0152s/iter; left time: 166.9819s
	iters: 500, epoch: 1 | loss: 0.2330858
	speed: 0.0151s/iter; left time: 164.9827s
Epoch: 1 cost time: 9.88548493385315
Epoch: 1, Steps: 570 | Train Loss: 0.1849884 Vali Loss: 0.0479409 Test Loss: 0.1547139
Validation loss decreased (inf --> 0.047941).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1143082
	speed: 0.0489s/iter; left time: 524.4933s
	iters: 200, epoch: 2 | loss: 0.3537095
	speed: 0.0152s/iter; left time: 161.6597s
	iters: 300, epoch: 2 | loss: 0.3505127
	speed: 0.0152s/iter; left time: 159.6306s
	iters: 400, epoch: 2 | loss: 0.2553155
	speed: 0.0141s/iter; left time: 147.1699s
	iters: 500, epoch: 2 | loss: 0.2997040
	speed: 0.0135s/iter; left time: 139.1841s
Epoch: 2 cost time: 8.584050416946411
Epoch: 2, Steps: 570 | Train Loss: 0.2630000 Vali Loss: 0.0724070 Test Loss: 0.1898956
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2477942
	speed: 0.0452s/iter; left time: 458.7992s
	iters: 200, epoch: 3 | loss: 0.1261086
	speed: 0.0135s/iter; left time: 135.8987s
	iters: 300, epoch: 3 | loss: 0.2619452
	speed: 0.0135s/iter; left time: 134.3725s
	iters: 400, epoch: 3 | loss: 0.1103649
	speed: 0.0135s/iter; left time: 132.8750s
	iters: 500, epoch: 3 | loss: 0.2083330
	speed: 0.0135s/iter; left time: 131.7530s
Epoch: 3 cost time: 8.001125812530518
Epoch: 3, Steps: 570 | Train Loss: 0.2439919 Vali Loss: 0.0668979 Test Loss: 0.1739569
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1651082
	speed: 0.0441s/iter; left time: 423.1318s
	iters: 200, epoch: 4 | loss: 0.2440787
	speed: 0.0135s/iter; left time: 128.3493s
	iters: 300, epoch: 4 | loss: 0.3100405
	speed: 0.0135s/iter; left time: 127.1786s
	iters: 400, epoch: 4 | loss: 0.1410217
	speed: 0.0135s/iter; left time: 125.7899s
	iters: 500, epoch: 4 | loss: 0.1318116
	speed: 0.0135s/iter; left time: 124.2897s
Epoch: 4 cost time: 8.02341604232788
Epoch: 4, Steps: 570 | Train Loss: 0.2142600 Vali Loss: 0.0600810 Test Loss: 0.1641871
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1549413502216339, mae:0.2512667179107666
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1190500
	speed: 0.0249s/iter; left time: 281.3236s
	iters: 200, epoch: 1 | loss: 0.3118449
	speed: 0.0134s/iter; left time: 149.8381s
	iters: 300, epoch: 1 | loss: 0.3297839
	speed: 0.0134s/iter; left time: 148.2572s
	iters: 400, epoch: 1 | loss: 0.2602028
	speed: 0.0134s/iter; left time: 146.9362s
	iters: 500, epoch: 1 | loss: 0.2521578
	speed: 0.0134s/iter; left time: 145.8457s
Epoch: 1 cost time: 8.82106637954712
Epoch: 1, Steps: 570 | Train Loss: 0.2388101 Vali Loss: 0.0638805 Test Loss: 0.1876526
Validation loss decreased (inf --> 0.063880).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2265279
	speed: 0.0447s/iter; left time: 479.8204s
	iters: 200, epoch: 2 | loss: 0.1576295
	speed: 0.0134s/iter; left time: 142.1581s
	iters: 300, epoch: 2 | loss: 0.1770525
	speed: 0.0134s/iter; left time: 140.8819s
	iters: 400, epoch: 2 | loss: 0.2324228
	speed: 0.0134s/iter; left time: 139.7155s
	iters: 500, epoch: 2 | loss: 0.3294505
	speed: 0.0134s/iter; left time: 138.3034s
Epoch: 2 cost time: 7.933163642883301
Epoch: 2, Steps: 570 | Train Loss: 0.2661254 Vali Loss: 0.0713454 Test Loss: 0.1848145
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2670662
	speed: 0.0471s/iter; left time: 478.9106s
	iters: 200, epoch: 3 | loss: 0.2732421
	speed: 0.0134s/iter; left time: 135.0131s
	iters: 300, epoch: 3 | loss: 0.2004428
	speed: 0.0134s/iter; left time: 133.5236s
	iters: 400, epoch: 3 | loss: 0.1749303
	speed: 0.0134s/iter; left time: 131.8350s
	iters: 500, epoch: 3 | loss: 0.2124099
	speed: 0.0134s/iter; left time: 130.3521s
Epoch: 3 cost time: 7.914586067199707
Epoch: 3, Steps: 570 | Train Loss: 0.2391176 Vali Loss: 0.0647277 Test Loss: 0.1720510
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2196204
	speed: 0.0442s/iter; left time: 424.1994s
	iters: 200, epoch: 4 | loss: 0.1945581
	speed: 0.0135s/iter; left time: 128.1547s
	iters: 300, epoch: 4 | loss: 0.1817180
	speed: 0.0135s/iter; left time: 126.8518s
	iters: 400, epoch: 4 | loss: 0.1947605
	speed: 0.0135s/iter; left time: 125.7008s
	iters: 500, epoch: 4 | loss: 0.1333836
	speed: 0.0135s/iter; left time: 123.7967s
Epoch: 4 cost time: 7.973385334014893
Epoch: 4, Steps: 570 | Train Loss: 0.2129358 Vali Loss: 0.0605438 Test Loss: 0.1664300
Validation loss decreased (0.063880 --> 0.060544).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1738715
	speed: 0.0454s/iter; left time: 409.1702s
	iters: 200, epoch: 5 | loss: 0.2195346
	speed: 0.0135s/iter; left time: 120.0968s
	iters: 300, epoch: 5 | loss: 0.1826030
	speed: 0.0135s/iter; left time: 118.7707s
	iters: 400, epoch: 5 | loss: 0.2756516
	speed: 0.0134s/iter; left time: 117.2315s
	iters: 500, epoch: 5 | loss: 0.1223429
	speed: 0.0134s/iter; left time: 115.6241s
Epoch: 5 cost time: 8.075530290603638
Epoch: 5, Steps: 570 | Train Loss: 0.1918286 Vali Loss: 0.0575880 Test Loss: 0.1577104
Validation loss decreased (0.060544 --> 0.057588).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2719165
	speed: 0.0478s/iter; left time: 403.8005s
	iters: 200, epoch: 6 | loss: 0.1927407
	speed: 0.0144s/iter; left time: 120.4611s
	iters: 300, epoch: 6 | loss: 0.0962062
	speed: 0.0135s/iter; left time: 111.2607s
	iters: 400, epoch: 6 | loss: 0.2174937
	speed: 0.0135s/iter; left time: 109.8067s
	iters: 500, epoch: 6 | loss: 0.1846272
	speed: 0.0135s/iter; left time: 108.5833s
Epoch: 6 cost time: 8.243571519851685
Epoch: 6, Steps: 570 | Train Loss: 0.1781630 Vali Loss: 0.0573460 Test Loss: 0.1543588
Validation loss decreased (0.057588 --> 0.057346).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1491029
	speed: 0.0467s/iter; left time: 367.9004s
	iters: 200, epoch: 7 | loss: 0.0993516
	speed: 0.0151s/iter; left time: 117.2180s
	iters: 300, epoch: 7 | loss: 0.1379019
	speed: 0.0151s/iter; left time: 115.6785s
	iters: 400, epoch: 7 | loss: 0.2205217
	speed: 0.0151s/iter; left time: 114.2879s
	iters: 500, epoch: 7 | loss: 0.1336048
	speed: 0.0150s/iter; left time: 112.3944s
Epoch: 7 cost time: 8.87835168838501
Epoch: 7, Steps: 570 | Train Loss: 0.1709848 Vali Loss: 0.0576333 Test Loss: 0.1552133
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1184507
	speed: 0.0474s/iter; left time: 346.8295s
	iters: 200, epoch: 8 | loss: 0.1265137
	speed: 0.0134s/iter; left time: 96.5043s
	iters: 300, epoch: 8 | loss: 0.1915678
	speed: 0.0133s/iter; left time: 94.8034s
	iters: 400, epoch: 8 | loss: 0.2026834
	speed: 0.0133s/iter; left time: 93.3049s
	iters: 500, epoch: 8 | loss: 0.1000716
	speed: 0.0133s/iter; left time: 91.8657s
Epoch: 8 cost time: 7.886708974838257
Epoch: 8, Steps: 570 | Train Loss: 0.1666280 Vali Loss: 0.0592988 Test Loss: 0.1568683
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1650104
	speed: 0.0442s/iter; left time: 298.2428s
	iters: 200, epoch: 9 | loss: 0.1470891
	speed: 0.0133s/iter; left time: 88.5911s
	iters: 300, epoch: 9 | loss: 0.1308380
	speed: 0.0134s/iter; left time: 87.3612s
	iters: 400, epoch: 9 | loss: 0.1730627
	speed: 0.0134s/iter; left time: 86.2064s
	iters: 500, epoch: 9 | loss: 0.1253441
	speed: 0.0134s/iter; left time: 84.6815s
Epoch: 9 cost time: 7.9226438999176025
Epoch: 9, Steps: 570 | Train Loss: 0.1645545 Vali Loss: 0.0580829 Test Loss: 0.1555741
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15459345281124115, mae:0.2520411014556885
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2702464
	speed: 0.0298s/iter; left time: 337.0178s
	iters: 200, epoch: 1 | loss: 0.2674955
	speed: 0.0177s/iter; left time: 198.7197s
	iters: 300, epoch: 1 | loss: 0.3488625
	speed: 0.0170s/iter; left time: 188.7366s
	iters: 400, epoch: 1 | loss: 0.2293683
	speed: 0.0170s/iter; left time: 186.5746s
	iters: 500, epoch: 1 | loss: 0.2553122
	speed: 0.0178s/iter; left time: 193.8008s
Epoch: 1 cost time: 11.225436925888062
Epoch: 1, Steps: 570 | Train Loss: 0.3194285 Vali Loss: 0.0671749 Test Loss: 0.1898966
Validation loss decreased (inf --> 0.067175).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3389419
	speed: 0.0517s/iter; left time: 554.8784s
	iters: 200, epoch: 2 | loss: 0.3397476
	speed: 0.0164s/iter; left time: 174.7887s
	iters: 300, epoch: 2 | loss: 0.3092797
	speed: 0.0164s/iter; left time: 172.8320s
	iters: 400, epoch: 2 | loss: 0.2053859
	speed: 0.0164s/iter; left time: 171.1342s
	iters: 500, epoch: 2 | loss: 0.2841223
	speed: 0.0164s/iter; left time: 169.4287s
Epoch: 2 cost time: 9.691531419754028
Epoch: 2, Steps: 570 | Train Loss: 0.2695681 Vali Loss: 0.0684227 Test Loss: 0.1898351
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2059644
	speed: 0.0497s/iter; left time: 505.4377s
	iters: 200, epoch: 3 | loss: 0.2477117
	speed: 0.0164s/iter; left time: 164.7611s
	iters: 300, epoch: 3 | loss: 0.3639211
	speed: 0.0164s/iter; left time: 163.2079s
	iters: 400, epoch: 3 | loss: 0.2139793
	speed: 0.0164s/iter; left time: 161.5522s
	iters: 500, epoch: 3 | loss: 0.2109823
	speed: 0.0164s/iter; left time: 159.7817s
Epoch: 3 cost time: 9.617807149887085
Epoch: 3, Steps: 570 | Train Loss: 0.2380238 Vali Loss: 0.0639201 Test Loss: 0.1737082
Validation loss decreased (0.067175 --> 0.063920).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2504411
	speed: 0.0499s/iter; left time: 478.9693s
	iters: 200, epoch: 4 | loss: 0.1834994
	speed: 0.0164s/iter; left time: 155.3636s
	iters: 300, epoch: 4 | loss: 0.2105092
	speed: 0.0164s/iter; left time: 153.8845s
	iters: 400, epoch: 4 | loss: 0.2755169
	speed: 0.0164s/iter; left time: 152.0944s
	iters: 500, epoch: 4 | loss: 0.2003397
	speed: 0.0164s/iter; left time: 150.4920s
Epoch: 4 cost time: 9.670193672180176
Epoch: 4, Steps: 570 | Train Loss: 0.2210738 Vali Loss: 0.0653202 Test Loss: 0.1676902
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1212686
	speed: 0.0498s/iter; left time: 449.6692s
	iters: 200, epoch: 5 | loss: 0.2460476
	speed: 0.0164s/iter; left time: 146.3449s
	iters: 300, epoch: 5 | loss: 0.1491101
	speed: 0.0164s/iter; left time: 144.8363s
	iters: 400, epoch: 5 | loss: 0.1874050
	speed: 0.0164s/iter; left time: 143.0329s
	iters: 500, epoch: 5 | loss: 0.1471154
	speed: 0.0164s/iter; left time: 141.3561s
Epoch: 5 cost time: 9.64632272720337
Epoch: 5, Steps: 570 | Train Loss: 0.2057814 Vali Loss: 0.0583800 Test Loss: 0.1598453
Validation loss decreased (0.063920 --> 0.058380).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2401012
	speed: 0.0501s/iter; left time: 423.5663s
	iters: 200, epoch: 6 | loss: 0.1714445
	speed: 0.0164s/iter; left time: 136.9902s
	iters: 300, epoch: 6 | loss: 0.2459915
	speed: 0.0164s/iter; left time: 135.2751s
	iters: 400, epoch: 6 | loss: 0.1931977
	speed: 0.0164s/iter; left time: 133.6797s
	iters: 500, epoch: 6 | loss: 0.1885254
	speed: 0.0164s/iter; left time: 131.9552s
Epoch: 6 cost time: 9.673161029815674
Epoch: 6, Steps: 570 | Train Loss: 0.1941076 Vali Loss: 0.0599090 Test Loss: 0.1608659
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1485454
	speed: 0.0497s/iter; left time: 391.5228s
	iters: 200, epoch: 7 | loss: 0.2220893
	speed: 0.0163s/iter; left time: 127.1430s
	iters: 300, epoch: 7 | loss: 0.2589035
	speed: 0.0163s/iter; left time: 125.4867s
	iters: 400, epoch: 7 | loss: 0.1114334
	speed: 0.0163s/iter; left time: 123.7435s
	iters: 500, epoch: 7 | loss: 0.1242444
	speed: 0.0163s/iter; left time: 122.2302s
Epoch: 7 cost time: 9.623483896255493
Epoch: 7, Steps: 570 | Train Loss: 0.1875073 Vali Loss: 0.0603522 Test Loss: 0.1618410
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1701197
	speed: 0.0515s/iter; left time: 376.4528s
	iters: 200, epoch: 8 | loss: 0.1515106
	speed: 0.0164s/iter; left time: 118.0863s
	iters: 300, epoch: 8 | loss: 0.2233585
	speed: 0.0164s/iter; left time: 116.4616s
	iters: 400, epoch: 8 | loss: 0.0997724
	speed: 0.0164s/iter; left time: 114.8483s
	iters: 500, epoch: 8 | loss: 0.1245760
	speed: 0.0164s/iter; left time: 113.2127s
Epoch: 8 cost time: 9.64261245727539
Epoch: 8, Steps: 570 | Train Loss: 0.1838400 Vali Loss: 0.0598232 Test Loss: 0.1601604
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1600600779056549, mae:0.25847792625427246
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2592842
	speed: 0.0274s/iter; left time: 310.1015s
	iters: 200, epoch: 1 | loss: 0.1940206
	speed: 0.0158s/iter; left time: 177.0292s
	iters: 300, epoch: 1 | loss: 0.3411418
	speed: 0.0158s/iter; left time: 175.1872s
	iters: 400, epoch: 1 | loss: 0.2999641
	speed: 0.0158s/iter; left time: 173.7033s
	iters: 500, epoch: 1 | loss: 0.1544883
	speed: 0.0158s/iter; left time: 172.6549s
Epoch: 1 cost time: 10.22491192817688
Epoch: 1, Steps: 570 | Train Loss: 0.3029523 Vali Loss: 0.0649792 Test Loss: 0.1817163
Validation loss decreased (inf --> 0.064979).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2204731
	speed: 0.0507s/iter; left time: 543.6067s
	iters: 200, epoch: 2 | loss: 0.2015020
	speed: 0.0159s/iter; left time: 168.5615s
	iters: 300, epoch: 2 | loss: 0.3120509
	speed: 0.0159s/iter; left time: 167.1609s
	iters: 400, epoch: 2 | loss: 0.4567918
	speed: 0.0158s/iter; left time: 165.2598s
	iters: 500, epoch: 2 | loss: 0.2119895
	speed: 0.0159s/iter; left time: 163.9082s
Epoch: 2 cost time: 9.354524374008179
Epoch: 2, Steps: 570 | Train Loss: 0.2555726 Vali Loss: 0.0691800 Test Loss: 0.1844113
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2225079
	speed: 0.0511s/iter; left time: 518.9241s
	iters: 200, epoch: 3 | loss: 0.2669656
	speed: 0.0157s/iter; left time: 158.2933s
	iters: 300, epoch: 3 | loss: 0.1537148
	speed: 0.0157s/iter; left time: 156.5999s
	iters: 400, epoch: 3 | loss: 0.2292681
	speed: 0.0157s/iter; left time: 155.1448s
	iters: 500, epoch: 3 | loss: 0.2172293
	speed: 0.0157s/iter; left time: 153.5372s
Epoch: 3 cost time: 9.27711820602417
Epoch: 3, Steps: 570 | Train Loss: 0.2331770 Vali Loss: 0.0565890 Test Loss: 0.1642408
Validation loss decreased (0.064979 --> 0.056589).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2177852
	speed: 0.0496s/iter; left time: 475.9562s
	iters: 200, epoch: 4 | loss: 0.3362504
	speed: 0.0158s/iter; left time: 150.1096s
	iters: 300, epoch: 4 | loss: 0.2126502
	speed: 0.0158s/iter; left time: 148.4289s
	iters: 400, epoch: 4 | loss: 0.1504691
	speed: 0.0158s/iter; left time: 146.6682s
	iters: 500, epoch: 4 | loss: 0.3105541
	speed: 0.0158s/iter; left time: 145.1756s
Epoch: 4 cost time: 9.315791130065918
Epoch: 4, Steps: 570 | Train Loss: 0.2091449 Vali Loss: 0.0589450 Test Loss: 0.1651395
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2018463
	speed: 0.0501s/iter; left time: 451.7945s
	iters: 200, epoch: 5 | loss: 0.3313251
	speed: 0.0159s/iter; left time: 141.8021s
	iters: 300, epoch: 5 | loss: 0.2012002
	speed: 0.0159s/iter; left time: 140.0136s
	iters: 400, epoch: 5 | loss: 0.1302354
	speed: 0.0159s/iter; left time: 138.4021s
	iters: 500, epoch: 5 | loss: 0.2003354
	speed: 0.0159s/iter; left time: 136.8616s
Epoch: 5 cost time: 9.35083794593811
Epoch: 5, Steps: 570 | Train Loss: 0.1946756 Vali Loss: 0.0567082 Test Loss: 0.1582989
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2129356
	speed: 0.0503s/iter; left time: 424.6683s
	iters: 200, epoch: 6 | loss: 0.2304875
	speed: 0.0158s/iter; left time: 131.8490s
	iters: 300, epoch: 6 | loss: 0.2754611
	speed: 0.0158s/iter; left time: 130.2631s
	iters: 400, epoch: 6 | loss: 0.1710404
	speed: 0.0158s/iter; left time: 128.6656s
	iters: 500, epoch: 6 | loss: 0.1663898
	speed: 0.0158s/iter; left time: 127.0884s
Epoch: 6 cost time: 9.311377763748169
Epoch: 6, Steps: 570 | Train Loss: 0.1853511 Vali Loss: 0.0544491 Test Loss: 0.1538800
Validation loss decreased (0.056589 --> 0.054449).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2040665
	speed: 0.0499s/iter; left time: 393.5417s
	iters: 200, epoch: 7 | loss: 0.1018395
	speed: 0.0158s/iter; left time: 122.6769s
	iters: 300, epoch: 7 | loss: 0.1823076
	speed: 0.0158s/iter; left time: 121.1982s
	iters: 400, epoch: 7 | loss: 0.1981986
	speed: 0.0158s/iter; left time: 119.4372s
	iters: 500, epoch: 7 | loss: 0.3003233
	speed: 0.0157s/iter; left time: 117.7130s
Epoch: 7 cost time: 9.295251369476318
Epoch: 7, Steps: 570 | Train Loss: 0.1801386 Vali Loss: 0.0555357 Test Loss: 0.1576312
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1524271
	speed: 0.0483s/iter; left time: 353.4011s
	iters: 200, epoch: 8 | loss: 0.2910529
	speed: 0.0157s/iter; left time: 113.5314s
	iters: 300, epoch: 8 | loss: 0.2003015
	speed: 0.0158s/iter; left time: 112.0484s
	iters: 400, epoch: 8 | loss: 0.1914104
	speed: 0.0157s/iter; left time: 110.3477s
	iters: 500, epoch: 8 | loss: 0.1669760
	speed: 0.0157s/iter; left time: 108.8451s
Epoch: 8 cost time: 9.261744737625122
Epoch: 8, Steps: 570 | Train Loss: 0.1769568 Vali Loss: 0.0551039 Test Loss: 0.1566411
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1595635
	speed: 0.0485s/iter; left time: 326.9941s
	iters: 200, epoch: 9 | loss: 0.1816410
	speed: 0.0158s/iter; left time: 105.1071s
	iters: 300, epoch: 9 | loss: 0.0986668
	speed: 0.0158s/iter; left time: 103.4376s
	iters: 400, epoch: 9 | loss: 0.1745072
	speed: 0.0158s/iter; left time: 101.8514s
	iters: 500, epoch: 9 | loss: 0.1041569
	speed: 0.0158s/iter; left time: 100.2689s
Epoch: 9 cost time: 9.30659532546997
Epoch: 9, Steps: 570 | Train Loss: 0.1748284 Vali Loss: 0.0550290 Test Loss: 0.1563157
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15406329929828644, mae:0.2528390884399414
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3087568
	speed: 0.0282s/iter; left time: 318.8683s
	iters: 200, epoch: 1 | loss: 0.3462889
	speed: 0.0161s/iter; left time: 180.7187s
	iters: 300, epoch: 1 | loss: 0.2530968
	speed: 0.0161s/iter; left time: 178.8719s
	iters: 400, epoch: 1 | loss: 0.3330573
	speed: 0.0162s/iter; left time: 177.7042s
	iters: 500, epoch: 1 | loss: 0.4840830
	speed: 0.0162s/iter; left time: 176.4111s
Epoch: 1 cost time: 10.460922718048096
Epoch: 1, Steps: 570 | Train Loss: 0.2991262 Vali Loss: 0.0749524 Test Loss: 0.2021642
Validation loss decreased (inf --> 0.074952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4184516
	speed: 0.0480s/iter; left time: 515.2724s
	iters: 200, epoch: 2 | loss: 0.1698274
	speed: 0.0147s/iter; left time: 156.0762s
	iters: 300, epoch: 2 | loss: 0.3770357
	speed: 0.0147s/iter; left time: 154.5890s
	iters: 400, epoch: 2 | loss: 0.2762246
	speed: 0.0147s/iter; left time: 153.1603s
	iters: 500, epoch: 2 | loss: 0.2991737
	speed: 0.0147s/iter; left time: 151.7195s
Epoch: 2 cost time: 8.684026956558228
Epoch: 2, Steps: 570 | Train Loss: 0.2748205 Vali Loss: 0.0604024 Test Loss: 0.1754508
Validation loss decreased (0.074952 --> 0.060402).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2303173
	speed: 0.0477s/iter; left time: 484.6669s
	iters: 200, epoch: 3 | loss: 0.1447184
	speed: 0.0146s/iter; left time: 146.9449s
	iters: 300, epoch: 3 | loss: 0.2395865
	speed: 0.0146s/iter; left time: 145.6360s
	iters: 400, epoch: 3 | loss: 0.3493069
	speed: 0.0146s/iter; left time: 144.2470s
	iters: 500, epoch: 3 | loss: 0.2475004
	speed: 0.0146s/iter; left time: 142.2912s
Epoch: 3 cost time: 8.606404304504395
Epoch: 3, Steps: 570 | Train Loss: 0.2622324 Vali Loss: 0.0659564 Test Loss: 0.1945945
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1808744
	speed: 0.0465s/iter; left time: 445.6756s
	iters: 200, epoch: 4 | loss: 0.3168277
	speed: 0.0147s/iter; left time: 139.1352s
	iters: 300, epoch: 4 | loss: 0.3154862
	speed: 0.0146s/iter; left time: 137.2595s
	iters: 400, epoch: 4 | loss: 0.2198539
	speed: 0.0146s/iter; left time: 135.6550s
	iters: 500, epoch: 4 | loss: 0.2445161
	speed: 0.0146s/iter; left time: 134.0429s
Epoch: 4 cost time: 8.612568616867065
Epoch: 4, Steps: 570 | Train Loss: 0.2500855 Vali Loss: 0.0656367 Test Loss: 0.1755282
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2021067
	speed: 0.0484s/iter; left time: 436.4588s
	iters: 200, epoch: 5 | loss: 0.1661894
	speed: 0.0163s/iter; left time: 145.7411s
	iters: 300, epoch: 5 | loss: 0.1782910
	speed: 0.0163s/iter; left time: 143.5725s
	iters: 400, epoch: 5 | loss: 0.1894042
	speed: 0.0162s/iter; left time: 141.3708s
	iters: 500, epoch: 5 | loss: 0.2144025
	speed: 0.0167s/iter; left time: 144.1865s
Epoch: 5 cost time: 9.633060455322266
Epoch: 5, Steps: 570 | Train Loss: 0.2293930 Vali Loss: 0.0615150 Test Loss: 0.1702067
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.175662562251091, mae:0.26966238021850586
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2576005
	speed: 0.0315s/iter; left time: 356.2860s
	iters: 200, epoch: 1 | loss: 0.3177054
	speed: 0.0196s/iter; left time: 219.6130s
	iters: 300, epoch: 1 | loss: 0.4582160
	speed: 0.0196s/iter; left time: 217.2706s
	iters: 400, epoch: 1 | loss: 0.2453062
	speed: 0.0196s/iter; left time: 215.5371s
	iters: 500, epoch: 1 | loss: 0.1802820
	speed: 0.0196s/iter; left time: 213.5347s
Epoch: 1 cost time: 12.40468692779541
Epoch: 1, Steps: 570 | Train Loss: 0.2986423 Vali Loss: 0.0624207 Test Loss: 0.1859441
Validation loss decreased (inf --> 0.062421).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3728313
	speed: 0.0572s/iter; left time: 613.7432s
	iters: 200, epoch: 2 | loss: 0.1625194
	speed: 0.0176s/iter; left time: 186.8628s
	iters: 300, epoch: 2 | loss: 0.2098111
	speed: 0.0175s/iter; left time: 184.3792s
	iters: 400, epoch: 2 | loss: 0.2316139
	speed: 0.0175s/iter; left time: 183.0424s
	iters: 500, epoch: 2 | loss: 0.2099084
	speed: 0.0175s/iter; left time: 180.9769s
Epoch: 2 cost time: 10.314679861068726
Epoch: 2, Steps: 570 | Train Loss: 0.2463334 Vali Loss: 0.0672368 Test Loss: 0.1854389
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1567222
	speed: 0.0567s/iter; left time: 575.8538s
	iters: 200, epoch: 3 | loss: 0.2328888
	speed: 0.0175s/iter; left time: 175.9697s
	iters: 300, epoch: 3 | loss: 0.2081664
	speed: 0.0175s/iter; left time: 173.8918s
	iters: 400, epoch: 3 | loss: 0.1160073
	speed: 0.0175s/iter; left time: 172.2789s
	iters: 500, epoch: 3 | loss: 0.1852383
	speed: 0.0174s/iter; left time: 170.3212s
Epoch: 3 cost time: 10.270918846130371
Epoch: 3, Steps: 570 | Train Loss: 0.2161097 Vali Loss: 0.0575502 Test Loss: 0.1623097
Validation loss decreased (0.062421 --> 0.057550).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2091047
	speed: 0.0556s/iter; left time: 533.4030s
	iters: 200, epoch: 4 | loss: 0.1903538
	speed: 0.0176s/iter; left time: 166.8254s
	iters: 300, epoch: 4 | loss: 0.2823515
	speed: 0.0175s/iter; left time: 164.6558s
	iters: 400, epoch: 4 | loss: 0.1222386
	speed: 0.0175s/iter; left time: 162.9539s
	iters: 500, epoch: 4 | loss: 0.2279944
	speed: 0.0175s/iter; left time: 161.2816s
Epoch: 4 cost time: 10.309531927108765
Epoch: 4, Steps: 570 | Train Loss: 0.1895393 Vali Loss: 0.0610897 Test Loss: 0.1650018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2419203
	speed: 0.0558s/iter; left time: 503.6968s
	iters: 200, epoch: 5 | loss: 0.1397381
	speed: 0.0174s/iter; left time: 155.3954s
	iters: 300, epoch: 5 | loss: 0.1961470
	speed: 0.0175s/iter; left time: 154.1780s
	iters: 400, epoch: 5 | loss: 0.2142258
	speed: 0.0174s/iter; left time: 152.0249s
	iters: 500, epoch: 5 | loss: 0.2020703
	speed: 0.0174s/iter; left time: 150.3658s
Epoch: 5 cost time: 10.23247241973877
Epoch: 5, Steps: 570 | Train Loss: 0.1776697 Vali Loss: 0.0597592 Test Loss: 0.1574803
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1256947
	speed: 0.0542s/iter; left time: 458.4086s
	iters: 200, epoch: 6 | loss: 0.1939256
	speed: 0.0175s/iter; left time: 145.9394s
	iters: 300, epoch: 6 | loss: 0.1321706
	speed: 0.0174s/iter; left time: 143.8194s
	iters: 400, epoch: 6 | loss: 0.1912255
	speed: 0.0174s/iter; left time: 142.0392s
	iters: 500, epoch: 6 | loss: 0.1801842
	speed: 0.0174s/iter; left time: 140.2188s
Epoch: 6 cost time: 10.225826501846313
Epoch: 6, Steps: 570 | Train Loss: 0.1691510 Vali Loss: 0.0597679 Test Loss: 0.1599545
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16255781054496765, mae:0.2579495906829834
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4043203
	speed: 0.0313s/iter; left time: 353.4635s
	iters: 200, epoch: 1 | loss: 0.1992670
	speed: 0.0193s/iter; left time: 215.9496s
	iters: 300, epoch: 1 | loss: 0.1797327
	speed: 0.0193s/iter; left time: 214.2874s
	iters: 400, epoch: 1 | loss: 0.1445734
	speed: 0.0193s/iter; left time: 212.7271s
	iters: 500, epoch: 1 | loss: 0.1533082
	speed: 0.0189s/iter; left time: 206.1324s
Epoch: 1 cost time: 12.066618919372559
Epoch: 1, Steps: 570 | Train Loss: 0.2059793 Vali Loss: 0.0638378 Test Loss: 0.1858505
Validation loss decreased (inf --> 0.063838).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3128408
	speed: 0.0544s/iter; left time: 583.4539s
	iters: 200, epoch: 2 | loss: 0.3340852
	speed: 0.0173s/iter; left time: 184.2655s
	iters: 300, epoch: 2 | loss: 0.4815163
	speed: 0.0174s/iter; left time: 182.7482s
	iters: 400, epoch: 2 | loss: 0.2596833
	speed: 0.0173s/iter; left time: 180.5538s
	iters: 500, epoch: 2 | loss: 0.1839698
	speed: 0.0173s/iter; left time: 178.4669s
Epoch: 2 cost time: 10.182690620422363
Epoch: 2, Steps: 570 | Train Loss: 0.2772075 Vali Loss: 0.0627708 Test Loss: 0.1783495
Validation loss decreased (0.063838 --> 0.062771).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1760170
	speed: 0.0547s/iter; left time: 555.9249s
	iters: 200, epoch: 3 | loss: 0.1966718
	speed: 0.0172s/iter; left time: 172.9101s
	iters: 300, epoch: 3 | loss: 0.1913995
	speed: 0.0172s/iter; left time: 171.5888s
	iters: 400, epoch: 3 | loss: 0.1781942
	speed: 0.0172s/iter; left time: 169.4872s
	iters: 500, epoch: 3 | loss: 0.1715818
	speed: 0.0172s/iter; left time: 167.6294s
Epoch: 3 cost time: 10.12765383720398
Epoch: 3, Steps: 570 | Train Loss: 0.2209164 Vali Loss: 0.0596031 Test Loss: 0.1728491
Validation loss decreased (0.062771 --> 0.059603).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1805340
	speed: 0.0588s/iter; left time: 564.3923s
	iters: 200, epoch: 4 | loss: 0.0905904
	speed: 0.0179s/iter; left time: 169.7601s
	iters: 300, epoch: 4 | loss: 0.2791197
	speed: 0.0173s/iter; left time: 162.2792s
	iters: 400, epoch: 4 | loss: 0.1629296
	speed: 0.0173s/iter; left time: 160.7180s
	iters: 500, epoch: 4 | loss: 0.1282458
	speed: 0.0173s/iter; left time: 158.9838s
Epoch: 4 cost time: 10.439244031906128
Epoch: 4, Steps: 570 | Train Loss: 0.1975164 Vali Loss: 0.0578438 Test Loss: 0.1621911
Validation loss decreased (0.059603 --> 0.057844).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1482425
	speed: 0.0543s/iter; left time: 489.4556s
	iters: 200, epoch: 5 | loss: 0.1782770
	speed: 0.0173s/iter; left time: 153.9991s
	iters: 300, epoch: 5 | loss: 0.1629610
	speed: 0.0172s/iter; left time: 152.0288s
	iters: 400, epoch: 5 | loss: 0.1764713
	speed: 0.0172s/iter; left time: 150.3144s
	iters: 500, epoch: 5 | loss: 0.1842960
	speed: 0.0172s/iter; left time: 148.6850s
Epoch: 5 cost time: 10.140869617462158
Epoch: 5, Steps: 570 | Train Loss: 0.1851035 Vali Loss: 0.0581966 Test Loss: 0.1593677
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2247585
	speed: 0.0541s/iter; left time: 457.2094s
	iters: 200, epoch: 6 | loss: 0.1118122
	speed: 0.0173s/iter; left time: 144.2507s
	iters: 300, epoch: 6 | loss: 0.1594950
	speed: 0.0173s/iter; left time: 142.7202s
	iters: 400, epoch: 6 | loss: 0.1419411
	speed: 0.0173s/iter; left time: 140.8550s
	iters: 500, epoch: 6 | loss: 0.1376313
	speed: 0.0173s/iter; left time: 139.0808s
Epoch: 6 cost time: 10.162371158599854
Epoch: 6, Steps: 570 | Train Loss: 0.1773759 Vali Loss: 0.0558292 Test Loss: 0.1570787
Validation loss decreased (0.057844 --> 0.055829).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1612963
	speed: 0.0541s/iter; left time: 426.6229s
	iters: 200, epoch: 7 | loss: 0.1753921
	speed: 0.0172s/iter; left time: 134.0789s
	iters: 300, epoch: 7 | loss: 0.1152870
	speed: 0.0172s/iter; left time: 132.2438s
	iters: 400, epoch: 7 | loss: 0.1577708
	speed: 0.0172s/iter; left time: 130.4922s
	iters: 500, epoch: 7 | loss: 0.1604751
	speed: 0.0172s/iter; left time: 128.7757s
Epoch: 7 cost time: 10.156202554702759
Epoch: 7, Steps: 570 | Train Loss: 0.1730504 Vali Loss: 0.0571969 Test Loss: 0.1591050
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1169839
	speed: 0.0536s/iter; left time: 391.5147s
	iters: 200, epoch: 8 | loss: 0.1007759
	speed: 0.0199s/iter; left time: 143.8191s
	iters: 300, epoch: 8 | loss: 0.2006591
	speed: 0.0194s/iter; left time: 137.9045s
	iters: 400, epoch: 8 | loss: 0.2258077
	speed: 0.0199s/iter; left time: 139.6781s
	iters: 500, epoch: 8 | loss: 0.2066380
	speed: 0.0199s/iter; left time: 137.7371s
Epoch: 8 cost time: 11.33980107307434
Epoch: 8, Steps: 570 | Train Loss: 0.1705565 Vali Loss: 0.0568154 Test Loss: 0.1585337
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1093133
	speed: 0.0589s/iter; left time: 397.0737s
	iters: 200, epoch: 9 | loss: 0.1208550
	speed: 0.0198s/iter; left time: 131.6364s
	iters: 300, epoch: 9 | loss: 0.1547902
	speed: 0.0198s/iter; left time: 129.6688s
	iters: 400, epoch: 9 | loss: 0.1336278
	speed: 0.0198s/iter; left time: 127.8479s
	iters: 500, epoch: 9 | loss: 0.1185609
	speed: 0.0198s/iter; left time: 125.8073s
Epoch: 9 cost time: 11.635049104690552
Epoch: 9, Steps: 570 | Train Loss: 0.1690572 Vali Loss: 0.0568122 Test Loss: 0.1580576
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15728867053985596, mae:0.2547375559806824
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2556352
	speed: 0.0311s/iter; left time: 350.9106s
	iters: 200, epoch: 1 | loss: 0.1872244
	speed: 0.0193s/iter; left time: 216.4136s
	iters: 300, epoch: 1 | loss: 0.2462130
	speed: 0.0193s/iter; left time: 214.3134s
	iters: 400, epoch: 1 | loss: 0.2578883
	speed: 0.0193s/iter; left time: 212.3728s
	iters: 500, epoch: 1 | loss: 0.3866651
	speed: 0.0193s/iter; left time: 210.5114s
Epoch: 1 cost time: 12.235405921936035
Epoch: 1, Steps: 570 | Train Loss: 0.2572709 Vali Loss: 0.0606518 Test Loss: 0.1839672
Validation loss decreased (inf --> 0.060652).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4579217
	speed: 0.0582s/iter; left time: 624.3098s
	iters: 200, epoch: 2 | loss: 0.3687385
	speed: 0.0171s/iter; left time: 182.3182s
	iters: 300, epoch: 2 | loss: 0.3783978
	speed: 0.0172s/iter; left time: 181.1454s
	iters: 400, epoch: 2 | loss: 0.2041424
	speed: 0.0171s/iter; left time: 178.7737s
	iters: 500, epoch: 2 | loss: 0.3030787
	speed: 0.0172s/iter; left time: 177.3929s
Epoch: 2 cost time: 10.086570978164673
Epoch: 2, Steps: 570 | Train Loss: 0.2547372 Vali Loss: 0.0611325 Test Loss: 0.1727885
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1552677
	speed: 0.0536s/iter; left time: 544.5693s
	iters: 200, epoch: 3 | loss: 0.2073597
	speed: 0.0173s/iter; left time: 174.1127s
	iters: 300, epoch: 3 | loss: 0.2164321
	speed: 0.0173s/iter; left time: 172.1521s
	iters: 400, epoch: 3 | loss: 0.2554320
	speed: 0.0173s/iter; left time: 170.3324s
	iters: 500, epoch: 3 | loss: 0.2286625
	speed: 0.0173s/iter; left time: 168.5008s
Epoch: 3 cost time: 10.11748218536377
Epoch: 3, Steps: 570 | Train Loss: 0.2108641 Vali Loss: 0.0606534 Test Loss: 0.1671809
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1449989
	speed: 0.0557s/iter; left time: 533.8752s
	iters: 200, epoch: 4 | loss: 0.1873359
	speed: 0.0172s/iter; left time: 162.8986s
	iters: 300, epoch: 4 | loss: 0.1576527
	speed: 0.0171s/iter; left time: 161.0213s
	iters: 400, epoch: 4 | loss: 0.2044394
	speed: 0.0171s/iter; left time: 159.2798s
	iters: 500, epoch: 4 | loss: 0.1120493
	speed: 0.0172s/iter; left time: 157.6555s
Epoch: 4 cost time: 10.051607131958008
Epoch: 4, Steps: 570 | Train Loss: 0.1912532 Vali Loss: 0.0578707 Test Loss: 0.1583105
Validation loss decreased (0.060652 --> 0.057871).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1316964
	speed: 0.0533s/iter; left time: 480.7882s
	iters: 200, epoch: 5 | loss: 0.1546748
	speed: 0.0173s/iter; left time: 154.3099s
	iters: 300, epoch: 5 | loss: 0.1557725
	speed: 0.0173s/iter; left time: 152.3911s
	iters: 400, epoch: 5 | loss: 0.2160063
	speed: 0.0173s/iter; left time: 150.5254s
	iters: 500, epoch: 5 | loss: 0.1194131
	speed: 0.0173s/iter; left time: 148.7704s
Epoch: 5 cost time: 10.136269569396973
Epoch: 5, Steps: 570 | Train Loss: 0.1778205 Vali Loss: 0.0576764 Test Loss: 0.1575596
Validation loss decreased (0.057871 --> 0.057676).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2322009
	speed: 0.0540s/iter; left time: 456.3205s
	iters: 200, epoch: 6 | loss: 0.1299272
	speed: 0.0172s/iter; left time: 143.5143s
	iters: 300, epoch: 6 | loss: 0.3989783
	speed: 0.0172s/iter; left time: 141.5518s
	iters: 400, epoch: 6 | loss: 0.1361643
	speed: 0.0172s/iter; left time: 139.9575s
	iters: 500, epoch: 6 | loss: 0.2072702
	speed: 0.0172s/iter; left time: 138.3540s
Epoch: 6 cost time: 10.071016550064087
Epoch: 6, Steps: 570 | Train Loss: 0.1666638 Vali Loss: 0.0567906 Test Loss: 0.1548798
Validation loss decreased (0.057676 --> 0.056791).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1350531
	speed: 0.0562s/iter; left time: 442.7479s
	iters: 200, epoch: 7 | loss: 0.1668256
	speed: 0.0174s/iter; left time: 135.0755s
	iters: 300, epoch: 7 | loss: 0.1984801
	speed: 0.0173s/iter; left time: 133.1492s
	iters: 400, epoch: 7 | loss: 0.1426664
	speed: 0.0173s/iter; left time: 131.3446s
	iters: 500, epoch: 7 | loss: 0.1303774
	speed: 0.0173s/iter; left time: 129.6043s
Epoch: 7 cost time: 10.193880081176758
Epoch: 7, Steps: 570 | Train Loss: 0.1604715 Vali Loss: 0.0566994 Test Loss: 0.1539143
Validation loss decreased (0.056791 --> 0.056699).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0793495
	speed: 0.0555s/iter; left time: 405.8468s
	iters: 200, epoch: 8 | loss: 0.0816441
	speed: 0.0172s/iter; left time: 123.7689s
	iters: 300, epoch: 8 | loss: 0.1428428
	speed: 0.0172s/iter; left time: 122.1539s
	iters: 400, epoch: 8 | loss: 0.1213741
	speed: 0.0172s/iter; left time: 120.3683s
	iters: 500, epoch: 8 | loss: 0.1387340
	speed: 0.0172s/iter; left time: 118.6156s
Epoch: 8 cost time: 10.098626613616943
Epoch: 8, Steps: 570 | Train Loss: 0.1568428 Vali Loss: 0.0571787 Test Loss: 0.1558457
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2026256
	speed: 0.0534s/iter; left time: 359.7216s
	iters: 200, epoch: 9 | loss: 0.1673106
	speed: 0.0173s/iter; left time: 114.9227s
	iters: 300, epoch: 9 | loss: 0.1801844
	speed: 0.0173s/iter; left time: 113.1252s
	iters: 400, epoch: 9 | loss: 0.2959049
	speed: 0.0173s/iter; left time: 111.4560s
	iters: 500, epoch: 9 | loss: 0.1356361
	speed: 0.0173s/iter; left time: 109.6931s
Epoch: 9 cost time: 10.126974105834961
Epoch: 9, Steps: 570 | Train Loss: 0.1549962 Vali Loss: 0.0568263 Test Loss: 0.1550211
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1370055
	speed: 0.0531s/iter; left time: 327.4834s
	iters: 200, epoch: 10 | loss: 0.1289415
	speed: 0.0173s/iter; left time: 105.2008s
	iters: 300, epoch: 10 | loss: 0.1983363
	speed: 0.0174s/iter; left time: 103.6458s
	iters: 400, epoch: 10 | loss: 0.1467326
	speed: 0.0173s/iter; left time: 101.8222s
	iters: 500, epoch: 10 | loss: 0.1663210
	speed: 0.0174s/iter; left time: 100.3661s
Epoch: 10 cost time: 10.15054965019226
Epoch: 10, Steps: 570 | Train Loss: 0.1536804 Vali Loss: 0.0567571 Test Loss: 0.1549835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15411075949668884, mae:0.2524541914463043
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2633941
	speed: 0.0352s/iter; left time: 397.3620s
	iters: 200, epoch: 1 | loss: 0.2882230
	speed: 0.0232s/iter; left time: 259.9095s
	iters: 300, epoch: 1 | loss: 0.3079577
	speed: 0.0231s/iter; left time: 256.8693s
	iters: 400, epoch: 1 | loss: 0.4719545
	speed: 0.0231s/iter; left time: 254.0437s
	iters: 500, epoch: 1 | loss: 0.3473301
	speed: 0.0231s/iter; left time: 251.5872s
Epoch: 1 cost time: 14.443045616149902
Epoch: 1, Steps: 570 | Train Loss: 0.3496201 Vali Loss: 0.0691530 Test Loss: 0.2032876
Validation loss decreased (inf --> 0.069153).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3026515
	speed: 0.0636s/iter; left time: 682.8651s
	iters: 200, epoch: 2 | loss: 0.2586778
	speed: 0.0214s/iter; left time: 227.1344s
	iters: 300, epoch: 2 | loss: 0.2658741
	speed: 0.0214s/iter; left time: 224.9063s
	iters: 400, epoch: 2 | loss: 0.3067841
	speed: 0.0213s/iter; left time: 222.6413s
	iters: 500, epoch: 2 | loss: 0.2336292
	speed: 0.0214s/iter; left time: 220.7424s
Epoch: 2 cost time: 12.466941118240356
Epoch: 2, Steps: 570 | Train Loss: 0.2770482 Vali Loss: 0.0684681 Test Loss: 0.1803966
Validation loss decreased (0.069153 --> 0.068468).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5014133
	speed: 0.0635s/iter; left time: 644.7410s
	iters: 200, epoch: 3 | loss: 0.3132436
	speed: 0.0213s/iter; left time: 214.6039s
	iters: 300, epoch: 3 | loss: 0.3100383
	speed: 0.0213s/iter; left time: 212.1743s
	iters: 400, epoch: 3 | loss: 0.2355167
	speed: 0.0213s/iter; left time: 210.1502s
	iters: 500, epoch: 3 | loss: 0.2293372
	speed: 0.0213s/iter; left time: 208.2519s
Epoch: 3 cost time: 12.45596170425415
Epoch: 3, Steps: 570 | Train Loss: 0.2852790 Vali Loss: 0.0618621 Test Loss: 0.1858376
Validation loss decreased (0.068468 --> 0.061862).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1910913
	speed: 0.0613s/iter; left time: 587.7800s
	iters: 200, epoch: 4 | loss: 0.2064937
	speed: 0.0214s/iter; left time: 202.6936s
	iters: 300, epoch: 4 | loss: 0.3060553
	speed: 0.0213s/iter; left time: 200.4788s
	iters: 400, epoch: 4 | loss: 0.2156951
	speed: 0.0214s/iter; left time: 198.4220s
	iters: 500, epoch: 4 | loss: 0.2605067
	speed: 0.0213s/iter; left time: 196.2225s
Epoch: 4 cost time: 12.473122358322144
Epoch: 4, Steps: 570 | Train Loss: 0.2557708 Vali Loss: 0.0617414 Test Loss: 0.1765215
Validation loss decreased (0.061862 --> 0.061741).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2731111
	speed: 0.0639s/iter; left time: 576.1748s
	iters: 200, epoch: 5 | loss: 0.1924176
	speed: 0.0213s/iter; left time: 190.0214s
	iters: 300, epoch: 5 | loss: 0.1932702
	speed: 0.0213s/iter; left time: 188.1911s
	iters: 400, epoch: 5 | loss: 0.2116029
	speed: 0.0213s/iter; left time: 185.9539s
	iters: 500, epoch: 5 | loss: 0.2595659
	speed: 0.0213s/iter; left time: 183.6982s
Epoch: 5 cost time: 12.47373080253601
Epoch: 5, Steps: 570 | Train Loss: 0.2348923 Vali Loss: 0.0627406 Test Loss: 0.1726262
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2130222
	speed: 0.0608s/iter; left time: 514.1418s
	iters: 200, epoch: 6 | loss: 0.3572890
	speed: 0.0214s/iter; left time: 178.5749s
	iters: 300, epoch: 6 | loss: 0.2064936
	speed: 0.0214s/iter; left time: 176.4720s
	iters: 400, epoch: 6 | loss: 0.2617048
	speed: 0.0214s/iter; left time: 174.1751s
	iters: 500, epoch: 6 | loss: 0.3124670
	speed: 0.0214s/iter; left time: 172.0661s
Epoch: 6 cost time: 12.449581146240234
Epoch: 6, Steps: 570 | Train Loss: 0.2221600 Vali Loss: 0.0617320 Test Loss: 0.1794897
Validation loss decreased (0.061741 --> 0.061732).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2988350
	speed: 0.0612s/iter; left time: 481.9871s
	iters: 200, epoch: 7 | loss: 0.1856506
	speed: 0.0213s/iter; left time: 165.7617s
	iters: 300, epoch: 7 | loss: 0.1715053
	speed: 0.0213s/iter; left time: 163.6100s
	iters: 400, epoch: 7 | loss: 0.2193801
	speed: 0.0213s/iter; left time: 161.5462s
	iters: 500, epoch: 7 | loss: 0.2082414
	speed: 0.0213s/iter; left time: 159.2258s
Epoch: 7 cost time: 12.447759866714478
Epoch: 7, Steps: 570 | Train Loss: 0.2201508 Vali Loss: 0.0617448 Test Loss: 0.1733547
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1307898
	speed: 0.0627s/iter; left time: 458.7546s
	iters: 200, epoch: 8 | loss: 0.3508490
	speed: 0.0231s/iter; left time: 166.8731s
	iters: 300, epoch: 8 | loss: 0.1427951
	speed: 0.0232s/iter; left time: 164.7588s
	iters: 400, epoch: 8 | loss: 0.1989607
	speed: 0.0232s/iter; left time: 162.4993s
	iters: 500, epoch: 8 | loss: 0.2051648
	speed: 0.0231s/iter; left time: 159.7937s
Epoch: 8 cost time: 13.332557201385498
Epoch: 8, Steps: 570 | Train Loss: 0.2198184 Vali Loss: 0.0605993 Test Loss: 0.1703959
Validation loss decreased (0.061732 --> 0.060599).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2086617
	speed: 0.0656s/iter; left time: 441.9386s
	iters: 200, epoch: 9 | loss: 0.1701879
	speed: 0.0232s/iter; left time: 153.7824s
	iters: 300, epoch: 9 | loss: 0.2340400
	speed: 0.0232s/iter; left time: 151.6869s
	iters: 400, epoch: 9 | loss: 0.2145180
	speed: 0.0232s/iter; left time: 149.1860s
	iters: 500, epoch: 9 | loss: 0.1757907
	speed: 0.0232s/iter; left time: 147.0663s
Epoch: 9 cost time: 13.537116289138794
Epoch: 9, Steps: 570 | Train Loss: 0.2117511 Vali Loss: 0.0595498 Test Loss: 0.1690634
Validation loss decreased (0.060599 --> 0.059550).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1913969
	speed: 0.0629s/iter; left time: 388.0867s
	iters: 200, epoch: 10 | loss: 0.1887120
	speed: 0.0214s/iter; left time: 129.7419s
	iters: 300, epoch: 10 | loss: 0.1581029
	speed: 0.0214s/iter; left time: 127.5056s
	iters: 400, epoch: 10 | loss: 0.3914342
	speed: 0.0214s/iter; left time: 125.5075s
	iters: 500, epoch: 10 | loss: 0.2320722
	speed: 0.0214s/iter; left time: 123.2797s
Epoch: 10 cost time: 12.487029552459717
Epoch: 10, Steps: 570 | Train Loss: 0.2091234 Vali Loss: 0.0599943 Test Loss: 0.1690989
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1834012
	speed: 0.0623s/iter; left time: 348.7611s
	iters: 200, epoch: 11 | loss: 0.1807611
	speed: 0.0213s/iter; left time: 117.4365s
	iters: 300, epoch: 11 | loss: 0.1376544
	speed: 0.0214s/iter; left time: 115.3364s
	iters: 400, epoch: 11 | loss: 0.1764182
	speed: 0.0214s/iter; left time: 113.1866s
	iters: 500, epoch: 11 | loss: 0.1822242
	speed: 0.0214s/iter; left time: 111.0460s
Epoch: 11 cost time: 12.49424695968628
Epoch: 11, Steps: 570 | Train Loss: 0.2081567 Vali Loss: 0.0601298 Test Loss: 0.1693076
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2462718
	speed: 0.0608s/iter; left time: 305.9487s
	iters: 200, epoch: 12 | loss: 0.1744411
	speed: 0.0213s/iter; left time: 105.2169s
	iters: 300, epoch: 12 | loss: 0.3393806
	speed: 0.0213s/iter; left time: 103.0944s
	iters: 400, epoch: 12 | loss: 0.1140367
	speed: 0.0213s/iter; left time: 100.9530s
	iters: 500, epoch: 12 | loss: 0.2412114
	speed: 0.0213s/iter; left time: 98.8452s
Epoch: 12 cost time: 12.461491107940674
Epoch: 12, Steps: 570 | Train Loss: 0.2077105 Vali Loss: 0.0600915 Test Loss: 0.1693314
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16930536925792694, mae:0.26500973105430603
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.5048662
	speed: 0.0329s/iter; left time: 371.6249s
	iters: 200, epoch: 1 | loss: 0.1369040
	speed: 0.0207s/iter; left time: 231.7189s
	iters: 300, epoch: 1 | loss: 0.2355949
	speed: 0.0207s/iter; left time: 229.2944s
	iters: 400, epoch: 1 | loss: 0.2787115
	speed: 0.0206s/iter; left time: 227.1397s
	iters: 500, epoch: 1 | loss: 0.2199036
	speed: 0.0206s/iter; left time: 225.0469s
Epoch: 1 cost time: 13.053419589996338
Epoch: 1, Steps: 570 | Train Loss: 0.3321772 Vali Loss: 0.0685171 Test Loss: 0.1871986
Validation loss decreased (inf --> 0.068517).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2593084
	speed: 0.0595s/iter; left time: 638.9177s
	iters: 200, epoch: 2 | loss: 0.1782596
	speed: 0.0206s/iter; left time: 219.0154s
	iters: 300, epoch: 2 | loss: 0.3906453
	speed: 0.0206s/iter; left time: 216.7526s
	iters: 400, epoch: 2 | loss: 0.1749899
	speed: 0.0206s/iter; left time: 215.0112s
	iters: 500, epoch: 2 | loss: 0.2072232
	speed: 0.0206s/iter; left time: 212.7726s
Epoch: 2 cost time: 12.013784408569336
Epoch: 2, Steps: 570 | Train Loss: 0.2578903 Vali Loss: 0.0668498 Test Loss: 0.1912969
Validation loss decreased (0.068517 --> 0.066850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2249382
	speed: 0.0593s/iter; left time: 602.9503s
	iters: 200, epoch: 3 | loss: 0.1607056
	speed: 0.0206s/iter; left time: 206.9130s
	iters: 300, epoch: 3 | loss: 0.1565936
	speed: 0.0206s/iter; left time: 204.7882s
	iters: 400, epoch: 3 | loss: 0.1524085
	speed: 0.0206s/iter; left time: 202.8051s
	iters: 500, epoch: 3 | loss: 0.1550296
	speed: 0.0206s/iter; left time: 200.8758s
Epoch: 3 cost time: 12.00016188621521
Epoch: 3, Steps: 570 | Train Loss: 0.2275447 Vali Loss: 0.0636690 Test Loss: 0.1738327
Validation loss decreased (0.066850 --> 0.063669).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1582057
	speed: 0.0599s/iter; left time: 574.4288s
	iters: 200, epoch: 4 | loss: 0.2079531
	speed: 0.0206s/iter; left time: 195.8931s
	iters: 300, epoch: 4 | loss: 0.1579667
	speed: 0.0206s/iter; left time: 193.8836s
	iters: 400, epoch: 4 | loss: 0.2145253
	speed: 0.0206s/iter; left time: 191.8073s
	iters: 500, epoch: 4 | loss: 0.1629684
	speed: 0.0207s/iter; left time: 189.8165s
Epoch: 4 cost time: 12.051313400268555
Epoch: 4, Steps: 570 | Train Loss: 0.1952149 Vali Loss: 0.0597343 Test Loss: 0.1581925
Validation loss decreased (0.063669 --> 0.059734).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2804677
	speed: 0.0599s/iter; left time: 540.5499s
	iters: 200, epoch: 5 | loss: 0.1796376
	speed: 0.0207s/iter; left time: 184.7721s
	iters: 300, epoch: 5 | loss: 0.1583485
	speed: 0.0207s/iter; left time: 182.7355s
	iters: 400, epoch: 5 | loss: 0.1763235
	speed: 0.0207s/iter; left time: 180.1649s
	iters: 500, epoch: 5 | loss: 0.1554981
	speed: 0.0206s/iter; left time: 177.7260s
Epoch: 5 cost time: 12.061827421188354
Epoch: 5, Steps: 570 | Train Loss: 0.1784757 Vali Loss: 0.0619457 Test Loss: 0.1574815
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1472059
	speed: 0.0582s/iter; left time: 491.4584s
	iters: 200, epoch: 6 | loss: 0.1663551
	speed: 0.0206s/iter; left time: 172.1909s
	iters: 300, epoch: 6 | loss: 0.1644344
	speed: 0.0206s/iter; left time: 170.0670s
	iters: 400, epoch: 6 | loss: 0.1136185
	speed: 0.0206s/iter; left time: 167.8508s
	iters: 500, epoch: 6 | loss: 0.1272855
	speed: 0.0205s/iter; left time: 164.8979s
Epoch: 6 cost time: 11.977345705032349
Epoch: 6, Steps: 570 | Train Loss: 0.1690723 Vali Loss: 0.0634737 Test Loss: 0.1590462
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1238686
	speed: 0.0584s/iter; left time: 460.4659s
	iters: 200, epoch: 7 | loss: 0.1984115
	speed: 0.0207s/iter; left time: 160.9426s
	iters: 300, epoch: 7 | loss: 0.1817501
	speed: 0.0206s/iter; left time: 158.6064s
	iters: 400, epoch: 7 | loss: 0.1394706
	speed: 0.0207s/iter; left time: 156.6326s
	iters: 500, epoch: 7 | loss: 0.1559870
	speed: 0.0207s/iter; left time: 154.5063s
Epoch: 7 cost time: 12.02893877029419
Epoch: 7, Steps: 570 | Train Loss: 0.1623321 Vali Loss: 0.0616060 Test Loss: 0.1566058
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1584259569644928, mae:0.2586020827293396
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3459812
	speed: 0.0333s/iter; left time: 376.0633s
	iters: 200, epoch: 1 | loss: 0.2204933
	speed: 0.0210s/iter; left time: 234.7481s
	iters: 300, epoch: 1 | loss: 0.3470292
	speed: 0.0210s/iter; left time: 233.3353s
	iters: 400, epoch: 1 | loss: 0.3688976
	speed: 0.0210s/iter; left time: 230.9924s
	iters: 500, epoch: 1 | loss: 0.3242333
	speed: 0.0210s/iter; left time: 228.4110s
Epoch: 1 cost time: 13.244526624679565
Epoch: 1, Steps: 570 | Train Loss: 0.3072776 Vali Loss: 0.0635447 Test Loss: 0.1786053
Validation loss decreased (inf --> 0.063545).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1897742
	speed: 0.0593s/iter; left time: 636.4411s
	iters: 200, epoch: 2 | loss: 0.5891153
	speed: 0.0190s/iter; left time: 201.8619s
	iters: 300, epoch: 2 | loss: 0.2883355
	speed: 0.0190s/iter; left time: 199.7946s
	iters: 400, epoch: 2 | loss: 0.1507711
	speed: 0.0190s/iter; left time: 198.6357s
	iters: 500, epoch: 2 | loss: 0.1833827
	speed: 0.0190s/iter; left time: 196.7061s
Epoch: 2 cost time: 11.163628578186035
Epoch: 2, Steps: 570 | Train Loss: 0.2681090 Vali Loss: 0.0624694 Test Loss: 0.1786789
Validation loss decreased (0.063545 --> 0.062469).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1649375
	speed: 0.0574s/iter; left time: 583.3955s
	iters: 200, epoch: 3 | loss: 0.1788609
	speed: 0.0190s/iter; left time: 190.9959s
	iters: 300, epoch: 3 | loss: 0.1947482
	speed: 0.0190s/iter; left time: 189.1120s
	iters: 400, epoch: 3 | loss: 0.2425351
	speed: 0.0190s/iter; left time: 186.9471s
	iters: 500, epoch: 3 | loss: 0.2817035
	speed: 0.0190s/iter; left time: 185.2719s
Epoch: 3 cost time: 11.126565217971802
Epoch: 3, Steps: 570 | Train Loss: 0.2410358 Vali Loss: 0.0631183 Test Loss: 0.1702424
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1540900
	speed: 0.0568s/iter; left time: 544.9970s
	iters: 200, epoch: 4 | loss: 0.2941101
	speed: 0.0190s/iter; left time: 180.1468s
	iters: 300, epoch: 4 | loss: 0.1636501
	speed: 0.0190s/iter; left time: 178.5742s
	iters: 400, epoch: 4 | loss: 0.2417484
	speed: 0.0190s/iter; left time: 176.2847s
	iters: 500, epoch: 4 | loss: 0.1856163
	speed: 0.0190s/iter; left time: 174.2905s
Epoch: 4 cost time: 11.116266250610352
Epoch: 4, Steps: 570 | Train Loss: 0.2178987 Vali Loss: 0.0632832 Test Loss: 0.1700603
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1762531
	speed: 0.0572s/iter; left time: 516.2396s
	iters: 200, epoch: 5 | loss: 0.3220015
	speed: 0.0190s/iter; left time: 169.8490s
	iters: 300, epoch: 5 | loss: 0.1489344
	speed: 0.0189s/iter; left time: 166.8760s
	iters: 400, epoch: 5 | loss: 0.1708648
	speed: 0.0189s/iter; left time: 165.0910s
	iters: 500, epoch: 5 | loss: 0.1593254
	speed: 0.0190s/iter; left time: 163.3875s
Epoch: 5 cost time: 11.109708547592163
Epoch: 5, Steps: 570 | Train Loss: 0.2111658 Vali Loss: 0.0593761 Test Loss: 0.1635990
Validation loss decreased (0.062469 --> 0.059376).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2397203
	speed: 0.0576s/iter; left time: 487.0778s
	iters: 200, epoch: 6 | loss: 0.2457219
	speed: 0.0191s/iter; left time: 159.8599s
	iters: 300, epoch: 6 | loss: 0.1633635
	speed: 0.0191s/iter; left time: 157.3469s
	iters: 400, epoch: 6 | loss: 0.1521265
	speed: 0.0191s/iter; left time: 155.8222s
	iters: 500, epoch: 6 | loss: 0.2515264
	speed: 0.0191s/iter; left time: 153.4764s
Epoch: 6 cost time: 11.206693410873413
Epoch: 6, Steps: 570 | Train Loss: 0.2006975 Vali Loss: 0.0586759 Test Loss: 0.1642092
Validation loss decreased (0.059376 --> 0.058676).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2224349
	speed: 0.0599s/iter; left time: 471.9218s
	iters: 200, epoch: 7 | loss: 0.2338411
	speed: 0.0190s/iter; left time: 148.1932s
	iters: 300, epoch: 7 | loss: 0.2719557
	speed: 0.0190s/iter; left time: 146.2796s
	iters: 400, epoch: 7 | loss: 0.3161416
	speed: 0.0190s/iter; left time: 144.0270s
	iters: 500, epoch: 7 | loss: 0.1665621
	speed: 0.0190s/iter; left time: 141.9812s
Epoch: 7 cost time: 11.134984254837036
Epoch: 7, Steps: 570 | Train Loss: 0.1945284 Vali Loss: 0.0596985 Test Loss: 0.1651743
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2725866
	speed: 0.0595s/iter; left time: 434.6592s
	iters: 200, epoch: 8 | loss: 0.2585613
	speed: 0.0191s/iter; left time: 137.5102s
	iters: 300, epoch: 8 | loss: 0.2563990
	speed: 0.0191s/iter; left time: 135.8787s
	iters: 400, epoch: 8 | loss: 0.1603610
	speed: 0.0191s/iter; left time: 133.6520s
	iters: 500, epoch: 8 | loss: 0.2072012
	speed: 0.0191s/iter; left time: 131.7084s
Epoch: 8 cost time: 11.188389778137207
Epoch: 8, Steps: 570 | Train Loss: 0.1912372 Vali Loss: 0.0585950 Test Loss: 0.1643800
Validation loss decreased (0.058676 --> 0.058595).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1484015
	speed: 0.0574s/iter; left time: 387.2089s
	iters: 200, epoch: 9 | loss: 0.1572453
	speed: 0.0190s/iter; left time: 126.0428s
	iters: 300, epoch: 9 | loss: 0.2903929
	speed: 0.0190s/iter; left time: 124.0938s
	iters: 400, epoch: 9 | loss: 0.1727037
	speed: 0.0190s/iter; left time: 122.1237s
	iters: 500, epoch: 9 | loss: 0.1098155
	speed: 0.0190s/iter; left time: 120.3210s
Epoch: 9 cost time: 11.095708847045898
Epoch: 9, Steps: 570 | Train Loss: 0.1892703 Vali Loss: 0.0585207 Test Loss: 0.1643788
Validation loss decreased (0.058595 --> 0.058521).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2391348
	speed: 0.0571s/iter; left time: 352.4778s
	iters: 200, epoch: 10 | loss: 0.1191047
	speed: 0.0190s/iter; left time: 115.1776s
	iters: 300, epoch: 10 | loss: 0.2457750
	speed: 0.0189s/iter; left time: 113.0569s
	iters: 400, epoch: 10 | loss: 0.2172185
	speed: 0.0189s/iter; left time: 111.2023s
	iters: 500, epoch: 10 | loss: 0.1814567
	speed: 0.0189s/iter; left time: 109.2850s
Epoch: 10 cost time: 11.124875545501709
Epoch: 10, Steps: 570 | Train Loss: 0.1883511 Vali Loss: 0.0584853 Test Loss: 0.1639752
Validation loss decreased (0.058521 --> 0.058485).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1710032
	speed: 0.0575s/iter; left time: 322.1879s
	iters: 200, epoch: 11 | loss: 0.1714001
	speed: 0.0191s/iter; left time: 105.1636s
	iters: 300, epoch: 11 | loss: 0.1431176
	speed: 0.0191s/iter; left time: 103.0011s
	iters: 400, epoch: 11 | loss: 0.2365137
	speed: 0.0191s/iter; left time: 101.3149s
	iters: 500, epoch: 11 | loss: 0.1492564
	speed: 0.0191s/iter; left time: 99.5828s
Epoch: 11 cost time: 11.18666386604309
Epoch: 11, Steps: 570 | Train Loss: 0.1880311 Vali Loss: 0.0585991 Test Loss: 0.1641587
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1611707
	speed: 0.0589s/iter; left time: 296.4489s
	iters: 200, epoch: 12 | loss: 0.1814352
	speed: 0.0210s/iter; left time: 103.4300s
	iters: 300, epoch: 12 | loss: 0.3350646
	speed: 0.0210s/iter; left time: 101.4233s
	iters: 400, epoch: 12 | loss: 0.2441531
	speed: 0.0210s/iter; left time: 99.2175s
	iters: 500, epoch: 12 | loss: 0.2772302
	speed: 0.0210s/iter; left time: 97.2910s
Epoch: 12 cost time: 12.20010495185852
Epoch: 12, Steps: 570 | Train Loss: 0.1877626 Vali Loss: 0.0584666 Test Loss: 0.1642219
Validation loss decreased (0.058485 --> 0.058467).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1725542
	speed: 0.0602s/iter; left time: 268.5739s
	iters: 200, epoch: 13 | loss: 0.1736616
	speed: 0.0190s/iter; left time: 82.9481s
	iters: 300, epoch: 13 | loss: 0.1994443
	speed: 0.0190s/iter; left time: 81.0118s
	iters: 400, epoch: 13 | loss: 0.1422995
	speed: 0.0190s/iter; left time: 79.0694s
	iters: 500, epoch: 13 | loss: 0.1748704
	speed: 0.0190s/iter; left time: 77.2258s
Epoch: 13 cost time: 11.179510593414307
Epoch: 13, Steps: 570 | Train Loss: 0.1873977 Vali Loss: 0.0586605 Test Loss: 0.1642319
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2812103
	speed: 0.0560s/iter; left time: 218.0879s
	iters: 200, epoch: 14 | loss: 0.2077650
	speed: 0.0190s/iter; left time: 72.1819s
	iters: 300, epoch: 14 | loss: 0.1620535
	speed: 0.0190s/iter; left time: 70.3119s
	iters: 400, epoch: 14 | loss: 0.1186182
	speed: 0.0190s/iter; left time: 68.4071s
	iters: 500, epoch: 14 | loss: 0.1526008
	speed: 0.0190s/iter; left time: 66.4830s
Epoch: 14 cost time: 11.130144357681274
Epoch: 14, Steps: 570 | Train Loss: 0.1874303 Vali Loss: 0.0584769 Test Loss: 0.1642397
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1220352
	speed: 0.0574s/iter; left time: 190.5608s
	iters: 200, epoch: 15 | loss: 0.2429871
	speed: 0.0191s/iter; left time: 61.4561s
	iters: 300, epoch: 15 | loss: 0.1776120
	speed: 0.0191s/iter; left time: 59.5207s
	iters: 400, epoch: 15 | loss: 0.1808693
	speed: 0.0191s/iter; left time: 57.6255s
	iters: 500, epoch: 15 | loss: 0.1404826
	speed: 0.0191s/iter; left time: 55.7275s
Epoch: 15 cost time: 11.212652444839478
Epoch: 15, Steps: 570 | Train Loss: 0.1875341 Vali Loss: 0.0586241 Test Loss: 0.1642427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16442342102527618, mae:0.2625240385532379
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1777191
	speed: 0.0236s/iter; left time: 266.1433s
	iters: 200, epoch: 1 | loss: 0.1935108
	speed: 0.0119s/iter; left time: 133.2886s
	iters: 300, epoch: 1 | loss: 0.2110804
	speed: 0.0109s/iter; left time: 121.3602s
	iters: 400, epoch: 1 | loss: 0.2278834
	speed: 0.0106s/iter; left time: 116.3988s
	iters: 500, epoch: 1 | loss: 0.2286975
	speed: 0.0106s/iter; left time: 115.2906s
Epoch: 1 cost time: 7.545633316040039
Epoch: 1, Steps: 570 | Train Loss: 0.2393754 Vali Loss: 0.0499301 Test Loss: 0.1551164
Validation loss decreased (inf --> 0.049930).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3729154
	speed: 0.0366s/iter; left time: 392.5611s
	iters: 200, epoch: 2 | loss: 0.3245559
	speed: 0.0106s/iter; left time: 112.2214s
	iters: 300, epoch: 2 | loss: 0.2269728
	speed: 0.0106s/iter; left time: 111.2207s
	iters: 400, epoch: 2 | loss: 0.1790629
	speed: 0.0105s/iter; left time: 109.8423s
	iters: 500, epoch: 2 | loss: 0.2005681
	speed: 0.0105s/iter; left time: 108.9586s
Epoch: 2 cost time: 6.328356742858887
Epoch: 2, Steps: 570 | Train Loss: 0.2194005 Vali Loss: 0.0467984 Test Loss: 0.1458801
Validation loss decreased (0.049930 --> 0.046798).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1609079
	speed: 0.0363s/iter; left time: 368.3548s
	iters: 200, epoch: 3 | loss: 0.2279218
	speed: 0.0105s/iter; left time: 105.6526s
	iters: 300, epoch: 3 | loss: 0.1517598
	speed: 0.0105s/iter; left time: 104.7625s
	iters: 400, epoch: 3 | loss: 0.1926924
	speed: 0.0105s/iter; left time: 103.6667s
	iters: 500, epoch: 3 | loss: 0.2619040
	speed: 0.0105s/iter; left time: 102.3897s
Epoch: 3 cost time: 6.2816174030303955
Epoch: 3, Steps: 570 | Train Loss: 0.1928285 Vali Loss: 0.0434940 Test Loss: 0.1316906
Validation loss decreased (0.046798 --> 0.043494).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1974011
	speed: 0.0379s/iter; left time: 363.8252s
	iters: 200, epoch: 4 | loss: 0.0997751
	speed: 0.0105s/iter; left time: 100.1135s
	iters: 300, epoch: 4 | loss: 0.1813466
	speed: 0.0105s/iter; left time: 98.8256s
	iters: 400, epoch: 4 | loss: 0.1814042
	speed: 0.0105s/iter; left time: 97.8537s
	iters: 500, epoch: 4 | loss: 0.1456451
	speed: 0.0105s/iter; left time: 96.9351s
Epoch: 4 cost time: 6.326786041259766
Epoch: 4, Steps: 570 | Train Loss: 0.1741642 Vali Loss: 0.0419364 Test Loss: 0.1319740
Validation loss decreased (0.043494 --> 0.041936).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2005041
	speed: 0.0384s/iter; left time: 346.2140s
	iters: 200, epoch: 5 | loss: 0.1612382
	speed: 0.0106s/iter; left time: 94.5116s
	iters: 300, epoch: 5 | loss: 0.1828484
	speed: 0.0106s/iter; left time: 93.7661s
	iters: 400, epoch: 5 | loss: 0.1539630
	speed: 0.0106s/iter; left time: 92.7666s
	iters: 500, epoch: 5 | loss: 0.1531187
	speed: 0.0106s/iter; left time: 91.6864s
Epoch: 5 cost time: 6.355587959289551
Epoch: 5, Steps: 570 | Train Loss: 0.1631698 Vali Loss: 0.0412901 Test Loss: 0.1334837
Validation loss decreased (0.041936 --> 0.041290).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1511397
	speed: 0.0365s/iter; left time: 308.0851s
	iters: 200, epoch: 6 | loss: 0.1123220
	speed: 0.0106s/iter; left time: 88.3079s
	iters: 300, epoch: 6 | loss: 0.2148315
	speed: 0.0106s/iter; left time: 87.5644s
	iters: 400, epoch: 6 | loss: 0.1687021
	speed: 0.0106s/iter; left time: 86.3210s
	iters: 500, epoch: 6 | loss: 0.1469876
	speed: 0.0114s/iter; left time: 91.6978s
Epoch: 6 cost time: 6.510421991348267
Epoch: 6, Steps: 570 | Train Loss: 0.1537006 Vali Loss: 0.0401119 Test Loss: 0.1313482
Validation loss decreased (0.041290 --> 0.040112).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1674063
	speed: 0.0408s/iter; left time: 321.4466s
	iters: 200, epoch: 7 | loss: 0.2014802
	speed: 0.0121s/iter; left time: 94.0672s
	iters: 300, epoch: 7 | loss: 0.1516421
	speed: 0.0121s/iter; left time: 92.6287s
	iters: 400, epoch: 7 | loss: 0.1144426
	speed: 0.0120s/iter; left time: 91.1781s
	iters: 500, epoch: 7 | loss: 0.1227431
	speed: 0.0120s/iter; left time: 89.9743s
Epoch: 7 cost time: 7.187563419342041
Epoch: 7, Steps: 570 | Train Loss: 0.1511042 Vali Loss: 0.0403949 Test Loss: 0.1302827
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1535092
	speed: 0.0393s/iter; left time: 287.1929s
	iters: 200, epoch: 8 | loss: 0.1330004
	speed: 0.0120s/iter; left time: 86.5201s
	iters: 300, epoch: 8 | loss: 0.1745556
	speed: 0.0120s/iter; left time: 85.4150s
	iters: 400, epoch: 8 | loss: 0.2076908
	speed: 0.0106s/iter; left time: 74.1341s
	iters: 500, epoch: 8 | loss: 0.1386951
	speed: 0.0105s/iter; left time: 72.6999s
Epoch: 8 cost time: 6.742974519729614
Epoch: 8, Steps: 570 | Train Loss: 0.1473867 Vali Loss: 0.0400983 Test Loss: 0.1308237
Validation loss decreased (0.040112 --> 0.040098).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2033126
	speed: 0.0379s/iter; left time: 255.7400s
	iters: 200, epoch: 9 | loss: 0.1391253
	speed: 0.0105s/iter; left time: 69.8863s
	iters: 300, epoch: 9 | loss: 0.0781884
	speed: 0.0113s/iter; left time: 73.6096s
	iters: 400, epoch: 9 | loss: 0.1423060
	speed: 0.0120s/iter; left time: 77.3829s
	iters: 500, epoch: 9 | loss: 0.1406676
	speed: 0.0120s/iter; left time: 76.2090s
Epoch: 9 cost time: 6.768323659896851
Epoch: 9, Steps: 570 | Train Loss: 0.1468509 Vali Loss: 0.0405770 Test Loss: 0.1315916
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1316060
	speed: 0.0388s/iter; left time: 239.2590s
	iters: 200, epoch: 10 | loss: 0.1492279
	speed: 0.0120s/iter; left time: 72.7464s
	iters: 300, epoch: 10 | loss: 0.1004063
	speed: 0.0120s/iter; left time: 71.4599s
	iters: 400, epoch: 10 | loss: 0.1272062
	speed: 0.0120s/iter; left time: 70.6478s
	iters: 500, epoch: 10 | loss: 0.1947585
	speed: 0.0120s/iter; left time: 69.4094s
Epoch: 10 cost time: 7.11151909828186
Epoch: 10, Steps: 570 | Train Loss: 0.1463307 Vali Loss: 0.0401553 Test Loss: 0.1311446
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1390495
	speed: 0.0393s/iter; left time: 220.3936s
	iters: 200, epoch: 11 | loss: 0.1162399
	speed: 0.0120s/iter; left time: 66.0204s
	iters: 300, epoch: 11 | loss: 0.1146599
	speed: 0.0120s/iter; left time: 64.8200s
	iters: 400, epoch: 11 | loss: 0.1900888
	speed: 0.0120s/iter; left time: 63.6200s
	iters: 500, epoch: 11 | loss: 0.1377741
	speed: 0.0120s/iter; left time: 62.5150s
Epoch: 11 cost time: 7.155396938323975
Epoch: 11, Steps: 570 | Train Loss: 0.1467670 Vali Loss: 0.0401198 Test Loss: 0.1309380
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1310017704963684, mae:0.22413523495197296
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2011288
	speed: 0.0220s/iter; left time: 248.1608s
	iters: 200, epoch: 1 | loss: 0.2121019
	speed: 0.0103s/iter; left time: 115.8290s
	iters: 300, epoch: 1 | loss: 0.2554605
	speed: 0.0104s/iter; left time: 115.0610s
	iters: 400, epoch: 1 | loss: 0.2007774
	speed: 0.0103s/iter; left time: 113.8543s
	iters: 500, epoch: 1 | loss: 0.1596668
	speed: 0.0104s/iter; left time: 112.9831s
Epoch: 1 cost time: 7.112987041473389
Epoch: 1, Steps: 570 | Train Loss: 0.1986092 Vali Loss: 0.0408514 Test Loss: 0.1363988
Validation loss decreased (inf --> 0.040851).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1544909
	speed: 0.0353s/iter; left time: 378.2975s
	iters: 200, epoch: 2 | loss: 0.1977520
	speed: 0.0103s/iter; left time: 109.5473s
	iters: 300, epoch: 2 | loss: 0.1335832
	speed: 0.0104s/iter; left time: 109.5863s
	iters: 400, epoch: 2 | loss: 0.1909222
	speed: 0.0104s/iter; left time: 108.5082s
	iters: 500, epoch: 2 | loss: 0.1895629
	speed: 0.0103s/iter; left time: 106.8931s
Epoch: 2 cost time: 6.145948648452759
Epoch: 2, Steps: 570 | Train Loss: 0.1816486 Vali Loss: 0.0411289 Test Loss: 0.1282441
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0831251
	speed: 0.0349s/iter; left time: 354.6057s
	iters: 200, epoch: 3 | loss: 0.1447144
	speed: 0.0104s/iter; left time: 104.7075s
	iters: 300, epoch: 3 | loss: 0.3137289
	speed: 0.0104s/iter; left time: 103.3650s
	iters: 400, epoch: 3 | loss: 0.1911944
	speed: 0.0104s/iter; left time: 102.5886s
	iters: 500, epoch: 3 | loss: 0.1429696
	speed: 0.0104s/iter; left time: 101.2718s
Epoch: 3 cost time: 6.15851092338562
Epoch: 3, Steps: 570 | Train Loss: 0.1624195 Vali Loss: 0.0374713 Test Loss: 0.1170176
Validation loss decreased (0.040851 --> 0.037471).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1103782
	speed: 0.0351s/iter; left time: 336.4517s
	iters: 200, epoch: 4 | loss: 0.1187697
	speed: 0.0103s/iter; left time: 98.0373s
	iters: 300, epoch: 4 | loss: 0.0884880
	speed: 0.0104s/iter; left time: 97.3973s
	iters: 400, epoch: 4 | loss: 0.0976685
	speed: 0.0104s/iter; left time: 96.3311s
	iters: 500, epoch: 4 | loss: 0.1811225
	speed: 0.0102s/iter; left time: 94.1264s
Epoch: 4 cost time: 6.142638921737671
Epoch: 4, Steps: 570 | Train Loss: 0.1434960 Vali Loss: 0.0341161 Test Loss: 0.1104835
Validation loss decreased (0.037471 --> 0.034116).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1103035
	speed: 0.0345s/iter; left time: 311.1085s
	iters: 200, epoch: 5 | loss: 0.1790779
	speed: 0.0102s/iter; left time: 91.1114s
	iters: 300, epoch: 5 | loss: 0.1173813
	speed: 0.0103s/iter; left time: 90.5466s
	iters: 400, epoch: 5 | loss: 0.1384535
	speed: 0.0103s/iter; left time: 89.7487s
	iters: 500, epoch: 5 | loss: 0.1380685
	speed: 0.0103s/iter; left time: 88.4119s
Epoch: 5 cost time: 6.091769456863403
Epoch: 5, Steps: 570 | Train Loss: 0.1332018 Vali Loss: 0.0354310 Test Loss: 0.1137024
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0893482
	speed: 0.0351s/iter; left time: 296.8090s
	iters: 200, epoch: 6 | loss: 0.1794420
	speed: 0.0103s/iter; left time: 85.7462s
	iters: 300, epoch: 6 | loss: 0.1483492
	speed: 0.0103s/iter; left time: 84.7140s
	iters: 400, epoch: 6 | loss: 0.0914391
	speed: 0.0103s/iter; left time: 83.7423s
	iters: 500, epoch: 6 | loss: 0.0890388
	speed: 0.0103s/iter; left time: 83.0541s
Epoch: 6 cost time: 6.122091293334961
Epoch: 6, Steps: 570 | Train Loss: 0.1277808 Vali Loss: 0.0344818 Test Loss: 0.1114692
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1217993
	speed: 0.0343s/iter; left time: 270.0012s
	iters: 200, epoch: 7 | loss: 0.1507055
	speed: 0.0103s/iter; left time: 79.7674s
	iters: 300, epoch: 7 | loss: 0.2469890
	speed: 0.0103s/iter; left time: 78.7820s
	iters: 400, epoch: 7 | loss: 0.1859451
	speed: 0.0103s/iter; left time: 77.8831s
	iters: 500, epoch: 7 | loss: 0.1438853
	speed: 0.0103s/iter; left time: 76.6955s
Epoch: 7 cost time: 6.094702482223511
Epoch: 7, Steps: 570 | Train Loss: 0.1256190 Vali Loss: 0.0339808 Test Loss: 0.1099915
Validation loss decreased (0.034116 --> 0.033981).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1184343
	speed: 0.0347s/iter; left time: 253.7964s
	iters: 200, epoch: 8 | loss: 0.0885658
	speed: 0.0104s/iter; left time: 75.1712s
	iters: 300, epoch: 8 | loss: 0.1112555
	speed: 0.0104s/iter; left time: 73.8762s
	iters: 400, epoch: 8 | loss: 0.1127180
	speed: 0.0103s/iter; left time: 72.5619s
	iters: 500, epoch: 8 | loss: 0.0920499
	speed: 0.0104s/iter; left time: 71.5468s
Epoch: 8 cost time: 6.168047666549683
Epoch: 8, Steps: 570 | Train Loss: 0.1232764 Vali Loss: 0.0343710 Test Loss: 0.1123049
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1152850
	speed: 0.0345s/iter; left time: 232.2962s
	iters: 200, epoch: 9 | loss: 0.1366268
	speed: 0.0103s/iter; left time: 68.0796s
	iters: 300, epoch: 9 | loss: 0.1035083
	speed: 0.0103s/iter; left time: 67.0494s
	iters: 400, epoch: 9 | loss: 0.1578759
	speed: 0.0102s/iter; left time: 65.9086s
	iters: 500, epoch: 9 | loss: 0.1022582
	speed: 0.0102s/iter; left time: 64.9063s
Epoch: 9 cost time: 6.085042476654053
Epoch: 9, Steps: 570 | Train Loss: 0.1214196 Vali Loss: 0.0341249 Test Loss: 0.1114252
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1141844
	speed: 0.0346s/iter; left time: 213.7459s
	iters: 200, epoch: 10 | loss: 0.1014069
	speed: 0.0102s/iter; left time: 61.7690s
	iters: 300, epoch: 10 | loss: 0.1240180
	speed: 0.0103s/iter; left time: 61.3894s
	iters: 400, epoch: 10 | loss: 0.0875974
	speed: 0.0103s/iter; left time: 60.4837s
	iters: 500, epoch: 10 | loss: 0.0761100
	speed: 0.0103s/iter; left time: 59.4337s
Epoch: 10 cost time: 6.094587087631226
Epoch: 10, Steps: 570 | Train Loss: 0.1217547 Vali Loss: 0.0341139 Test Loss: 0.1113909
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11014990508556366, mae:0.20213402807712555
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2760210
	speed: 0.0221s/iter; left time: 249.6275s
	iters: 200, epoch: 1 | loss: 0.1569620
	speed: 0.0104s/iter; left time: 116.1553s
	iters: 300, epoch: 1 | loss: 0.1703339
	speed: 0.0104s/iter; left time: 114.9946s
	iters: 400, epoch: 1 | loss: 0.1834075
	speed: 0.0103s/iter; left time: 113.5458s
	iters: 500, epoch: 1 | loss: 0.2316654
	speed: 0.0103s/iter; left time: 112.6484s
Epoch: 1 cost time: 7.1259284019470215
Epoch: 1, Steps: 570 | Train Loss: 0.2487522 Vali Loss: 0.0535518 Test Loss: 0.1598241
Validation loss decreased (inf --> 0.053552).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2102094
	speed: 0.0363s/iter; left time: 389.2785s
	iters: 200, epoch: 2 | loss: 0.5037255
	speed: 0.0104s/iter; left time: 110.5636s
	iters: 300, epoch: 2 | loss: 0.3371377
	speed: 0.0104s/iter; left time: 109.6513s
	iters: 400, epoch: 2 | loss: 0.4152882
	speed: 0.0104s/iter; left time: 108.2592s
	iters: 500, epoch: 2 | loss: 0.3067176
	speed: 0.0104s/iter; left time: 107.3752s
Epoch: 2 cost time: 6.217277765274048
Epoch: 2, Steps: 570 | Train Loss: 0.2717112 Vali Loss: 0.0605821 Test Loss: 0.1763985
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1737072
	speed: 0.0365s/iter; left time: 370.8607s
	iters: 200, epoch: 3 | loss: 0.2173738
	speed: 0.0103s/iter; left time: 103.9524s
	iters: 300, epoch: 3 | loss: 0.3133671
	speed: 0.0103s/iter; left time: 102.9243s
	iters: 400, epoch: 3 | loss: 0.2098190
	speed: 0.0104s/iter; left time: 102.1212s
	iters: 500, epoch: 3 | loss: 0.2057551
	speed: 0.0103s/iter; left time: 100.9544s
Epoch: 3 cost time: 6.221595287322998
Epoch: 3, Steps: 570 | Train Loss: 0.2512181 Vali Loss: 0.0534191 Test Loss: 0.1621263
Validation loss decreased (0.053552 --> 0.053419).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1413024
	speed: 0.0365s/iter; left time: 350.1955s
	iters: 200, epoch: 4 | loss: 0.1723188
	speed: 0.0103s/iter; left time: 97.2911s
	iters: 300, epoch: 4 | loss: 0.1920038
	speed: 0.0103s/iter; left time: 96.4166s
	iters: 400, epoch: 4 | loss: 0.3015375
	speed: 0.0102s/iter; left time: 95.2151s
	iters: 500, epoch: 4 | loss: 0.1878215
	speed: 0.0103s/iter; left time: 94.2326s
Epoch: 4 cost time: 6.165150880813599
Epoch: 4, Steps: 570 | Train Loss: 0.2239809 Vali Loss: 0.0535721 Test Loss: 0.1619853
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2102711
	speed: 0.0360s/iter; left time: 324.5524s
	iters: 200, epoch: 5 | loss: 0.1812565
	speed: 0.0103s/iter; left time: 91.6072s
	iters: 300, epoch: 5 | loss: 0.2270057
	speed: 0.0103s/iter; left time: 90.4180s
	iters: 400, epoch: 5 | loss: 0.1802817
	speed: 0.0103s/iter; left time: 89.4781s
	iters: 500, epoch: 5 | loss: 0.3264125
	speed: 0.0103s/iter; left time: 88.5428s
Epoch: 5 cost time: 6.105363368988037
Epoch: 5, Steps: 570 | Train Loss: 0.2111830 Vali Loss: 0.0497295 Test Loss: 0.1540494
Validation loss decreased (0.053419 --> 0.049729).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1856858
	speed: 0.0357s/iter; left time: 301.7106s
	iters: 200, epoch: 6 | loss: 0.2089431
	speed: 0.0103s/iter; left time: 86.1090s
	iters: 300, epoch: 6 | loss: 0.1692455
	speed: 0.0103s/iter; left time: 85.1572s
	iters: 400, epoch: 6 | loss: 0.1765668
	speed: 0.0103s/iter; left time: 84.0178s
	iters: 500, epoch: 6 | loss: 0.2485469
	speed: 0.0103s/iter; left time: 83.0665s
Epoch: 6 cost time: 6.20879054069519
Epoch: 6, Steps: 570 | Train Loss: 0.2018977 Vali Loss: 0.0494379 Test Loss: 0.1522202
Validation loss decreased (0.049729 --> 0.049438).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1340874
	speed: 0.0384s/iter; left time: 302.7710s
	iters: 200, epoch: 7 | loss: 0.1357253
	speed: 0.0116s/iter; left time: 90.6325s
	iters: 300, epoch: 7 | loss: 0.1856140
	speed: 0.0116s/iter; left time: 89.2359s
	iters: 400, epoch: 7 | loss: 0.1292744
	speed: 0.0116s/iter; left time: 88.0704s
	iters: 500, epoch: 7 | loss: 0.2150543
	speed: 0.0116s/iter; left time: 86.9231s
Epoch: 7 cost time: 6.927873611450195
Epoch: 7, Steps: 570 | Train Loss: 0.1983729 Vali Loss: 0.0494550 Test Loss: 0.1508071
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1108174
	speed: 0.0374s/iter; left time: 273.6816s
	iters: 200, epoch: 8 | loss: 0.1593016
	speed: 0.0104s/iter; left time: 74.6510s
	iters: 300, epoch: 8 | loss: 0.1904207
	speed: 0.0103s/iter; left time: 73.5963s
	iters: 400, epoch: 8 | loss: 0.1893917
	speed: 0.0104s/iter; left time: 72.5981s
	iters: 500, epoch: 8 | loss: 0.1773364
	speed: 0.0104s/iter; left time: 71.5383s
Epoch: 8 cost time: 6.225088834762573
Epoch: 8, Steps: 570 | Train Loss: 0.1954682 Vali Loss: 0.0490171 Test Loss: 0.1501433
Validation loss decreased (0.049438 --> 0.049017).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1811720
	speed: 0.0365s/iter; left time: 245.8161s
	iters: 200, epoch: 9 | loss: 0.2337634
	speed: 0.0103s/iter; left time: 68.6211s
	iters: 300, epoch: 9 | loss: 0.1826662
	speed: 0.0103s/iter; left time: 67.6745s
	iters: 400, epoch: 9 | loss: 0.1685027
	speed: 0.0104s/iter; left time: 66.7988s
	iters: 500, epoch: 9 | loss: 0.2114587
	speed: 0.0103s/iter; left time: 65.0349s
Epoch: 9 cost time: 6.207677602767944
Epoch: 9, Steps: 570 | Train Loss: 0.1932855 Vali Loss: 0.0489839 Test Loss: 0.1497300
Validation loss decreased (0.049017 --> 0.048984).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1468959
	speed: 0.0370s/iter; left time: 228.4504s
	iters: 200, epoch: 10 | loss: 0.2943932
	speed: 0.0104s/iter; left time: 63.1307s
	iters: 300, epoch: 10 | loss: 0.2734065
	speed: 0.0104s/iter; left time: 61.8112s
	iters: 400, epoch: 10 | loss: 0.2248660
	speed: 0.0103s/iter; left time: 60.7223s
	iters: 500, epoch: 10 | loss: 0.2291971
	speed: 0.0104s/iter; left time: 59.9693s
Epoch: 10 cost time: 6.239911079406738
Epoch: 10, Steps: 570 | Train Loss: 0.1929867 Vali Loss: 0.0490412 Test Loss: 0.1497344
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2016304
	speed: 0.0363s/iter; left time: 203.0829s
	iters: 200, epoch: 11 | loss: 0.1890531
	speed: 0.0104s/iter; left time: 57.0521s
	iters: 300, epoch: 11 | loss: 0.2562253
	speed: 0.0104s/iter; left time: 56.0377s
	iters: 400, epoch: 11 | loss: 0.1936106
	speed: 0.0103s/iter; left time: 54.8067s
	iters: 500, epoch: 11 | loss: 0.1959444
	speed: 0.0103s/iter; left time: 53.7505s
Epoch: 11 cost time: 6.185500860214233
Epoch: 11, Steps: 570 | Train Loss: 0.1928420 Vali Loss: 0.0488997 Test Loss: 0.1497000
Validation loss decreased (0.048984 --> 0.048900).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1751735
	speed: 0.0358s/iter; left time: 179.8907s
	iters: 200, epoch: 12 | loss: 0.2051178
	speed: 0.0102s/iter; left time: 50.5045s
	iters: 300, epoch: 12 | loss: 0.1418368
	speed: 0.0103s/iter; left time: 49.5596s
	iters: 400, epoch: 12 | loss: 0.1730569
	speed: 0.0103s/iter; left time: 48.5569s
	iters: 500, epoch: 12 | loss: 0.0879592
	speed: 0.0103s/iter; left time: 47.6042s
Epoch: 12 cost time: 6.12819504737854
Epoch: 12, Steps: 570 | Train Loss: 0.1935263 Vali Loss: 0.0489174 Test Loss: 0.1497241
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1612099
	speed: 0.0367s/iter; left time: 163.5257s
	iters: 200, epoch: 13 | loss: 0.2018778
	speed: 0.0104s/iter; left time: 45.3403s
	iters: 300, epoch: 13 | loss: 0.1750134
	speed: 0.0104s/iter; left time: 44.1676s
	iters: 400, epoch: 13 | loss: 0.2200643
	speed: 0.0104s/iter; left time: 43.1754s
	iters: 500, epoch: 13 | loss: 0.1767964
	speed: 0.0104s/iter; left time: 42.1988s
Epoch: 13 cost time: 6.198461532592773
Epoch: 13, Steps: 570 | Train Loss: 0.1924223 Vali Loss: 0.0490513 Test Loss: 0.1496656
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1728437
	speed: 0.0367s/iter; left time: 142.8753s
	iters: 200, epoch: 14 | loss: 0.2402483
	speed: 0.0103s/iter; left time: 39.1956s
	iters: 300, epoch: 14 | loss: 0.1398079
	speed: 0.0104s/iter; left time: 38.2435s
	iters: 400, epoch: 14 | loss: 0.1153657
	speed: 0.0104s/iter; left time: 37.1823s
	iters: 500, epoch: 14 | loss: 0.2750791
	speed: 0.0103s/iter; left time: 36.1039s
Epoch: 14 cost time: 6.181631088256836
Epoch: 14, Steps: 570 | Train Loss: 0.1909967 Vali Loss: 0.0488073 Test Loss: 0.1496678
Validation loss decreased (0.048900 --> 0.048807).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1617509
	speed: 0.0364s/iter; left time: 120.7817s
	iters: 200, epoch: 15 | loss: 0.2353400
	speed: 0.0104s/iter; left time: 33.3615s
	iters: 300, epoch: 15 | loss: 0.1058330
	speed: 0.0104s/iter; left time: 32.3428s
	iters: 400, epoch: 15 | loss: 0.0849429
	speed: 0.0104s/iter; left time: 31.2978s
	iters: 500, epoch: 15 | loss: 0.2182889
	speed: 0.0103s/iter; left time: 30.1139s
Epoch: 15 cost time: 6.1944990158081055
Epoch: 15, Steps: 570 | Train Loss: 0.1929903 Vali Loss: 0.0488566 Test Loss: 0.1496770
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.1995316
	speed: 0.0364s/iter; left time: 100.1507s
	iters: 200, epoch: 16 | loss: 0.1273779
	speed: 0.0103s/iter; left time: 27.2608s
	iters: 300, epoch: 16 | loss: 0.1738085
	speed: 0.0103s/iter; left time: 26.1846s
	iters: 400, epoch: 16 | loss: 0.1989763
	speed: 0.0103s/iter; left time: 25.1576s
	iters: 500, epoch: 16 | loss: 0.1810515
	speed: 0.0103s/iter; left time: 24.1430s
Epoch: 16 cost time: 6.132954120635986
Epoch: 16, Steps: 570 | Train Loss: 0.1922915 Vali Loss: 0.0491062 Test Loss: 0.1496811
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1572271
	speed: 0.0358s/iter; left time: 77.9948s
	iters: 200, epoch: 17 | loss: 0.1318000
	speed: 0.0104s/iter; left time: 21.7323s
	iters: 300, epoch: 17 | loss: 0.1215536
	speed: 0.0103s/iter; left time: 20.3828s
	iters: 400, epoch: 17 | loss: 0.1946611
	speed: 0.0103s/iter; left time: 19.3525s
	iters: 500, epoch: 17 | loss: 0.1164205
	speed: 0.0103s/iter; left time: 18.3447s
Epoch: 17 cost time: 6.1892664432525635
Epoch: 17, Steps: 570 | Train Loss: 0.1921213 Vali Loss: 0.0491891 Test Loss: 0.1496846
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14987124502658844, mae:0.24645471572875977
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3265904
	speed: 0.0234s/iter; left time: 264.2897s
	iters: 200, epoch: 1 | loss: 0.2824314
	speed: 0.0118s/iter; left time: 132.2920s
	iters: 300, epoch: 1 | loss: 0.2027302
	speed: 0.0118s/iter; left time: 131.1623s
	iters: 400, epoch: 1 | loss: 0.1829416
	speed: 0.0118s/iter; left time: 129.8434s
	iters: 500, epoch: 1 | loss: 0.2720419
	speed: 0.0118s/iter; left time: 128.7465s
Epoch: 1 cost time: 7.936777353286743
Epoch: 1, Steps: 570 | Train Loss: 0.2819023 Vali Loss: 0.0710527 Test Loss: 0.1796554
Validation loss decreased (inf --> 0.071053).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2995609
	speed: 0.0399s/iter; left time: 428.6000s
	iters: 200, epoch: 2 | loss: 0.2093853
	speed: 0.0118s/iter; left time: 125.8983s
	iters: 300, epoch: 2 | loss: 0.2064758
	speed: 0.0119s/iter; left time: 124.8264s
	iters: 400, epoch: 2 | loss: 0.1652062
	speed: 0.0119s/iter; left time: 123.8096s
	iters: 500, epoch: 2 | loss: 0.2448857
	speed: 0.0118s/iter; left time: 122.4130s
Epoch: 2 cost time: 7.090646743774414
Epoch: 2, Steps: 570 | Train Loss: 0.3054748 Vali Loss: 0.0641825 Test Loss: 0.1975380
Validation loss decreased (0.071053 --> 0.064182).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3358017
	speed: 0.0390s/iter; left time: 395.8983s
	iters: 200, epoch: 3 | loss: 0.4676081
	speed: 0.0118s/iter; left time: 119.2204s
	iters: 300, epoch: 3 | loss: 0.1594378
	speed: 0.0119s/iter; left time: 118.1408s
	iters: 400, epoch: 3 | loss: 0.2910548
	speed: 0.0119s/iter; left time: 116.8730s
	iters: 500, epoch: 3 | loss: 0.2464300
	speed: 0.0119s/iter; left time: 115.6725s
Epoch: 3 cost time: 7.076974153518677
Epoch: 3, Steps: 570 | Train Loss: 0.2865843 Vali Loss: 0.0679678 Test Loss: 0.1888290
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1879116
	speed: 0.0399s/iter; left time: 382.5808s
	iters: 200, epoch: 4 | loss: 0.3424387
	speed: 0.0129s/iter; left time: 122.7279s
	iters: 300, epoch: 4 | loss: 0.1733771
	speed: 0.0129s/iter; left time: 121.4030s
	iters: 400, epoch: 4 | loss: 0.1620296
	speed: 0.0129s/iter; left time: 120.1100s
	iters: 500, epoch: 4 | loss: 0.2221527
	speed: 0.0129s/iter; left time: 118.8398s
Epoch: 4 cost time: 7.636206388473511
Epoch: 4, Steps: 570 | Train Loss: 0.2680516 Vali Loss: 0.0610722 Test Loss: 0.1731480
Validation loss decreased (0.064182 --> 0.061072).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2432520
	speed: 0.0406s/iter; left time: 366.5708s
	iters: 200, epoch: 5 | loss: 0.2601934
	speed: 0.0119s/iter; left time: 106.5654s
	iters: 300, epoch: 5 | loss: 0.2983795
	speed: 0.0119s/iter; left time: 105.0648s
	iters: 400, epoch: 5 | loss: 0.2202662
	speed: 0.0119s/iter; left time: 103.7478s
	iters: 500, epoch: 5 | loss: 0.2291308
	speed: 0.0119s/iter; left time: 102.8923s
Epoch: 5 cost time: 7.117336750030518
Epoch: 5, Steps: 570 | Train Loss: 0.2547676 Vali Loss: 0.0613823 Test Loss: 0.1707520
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2284081
	speed: 0.0412s/iter; left time: 347.8764s
	iters: 200, epoch: 6 | loss: 0.1313824
	speed: 0.0119s/iter; left time: 99.6252s
	iters: 300, epoch: 6 | loss: 0.2413198
	speed: 0.0119s/iter; left time: 97.9891s
	iters: 400, epoch: 6 | loss: 0.3221701
	speed: 0.0119s/iter; left time: 96.8580s
	iters: 500, epoch: 6 | loss: 0.1760595
	speed: 0.0119s/iter; left time: 95.7902s
Epoch: 6 cost time: 7.091256618499756
Epoch: 6, Steps: 570 | Train Loss: 0.2456368 Vali Loss: 0.0611322 Test Loss: 0.1657845
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2951231
	speed: 0.0391s/iter; left time: 308.2787s
	iters: 200, epoch: 7 | loss: 0.2469725
	speed: 0.0119s/iter; left time: 92.4948s
	iters: 300, epoch: 7 | loss: 0.2372079
	speed: 0.0119s/iter; left time: 91.3821s
	iters: 400, epoch: 7 | loss: 0.1685892
	speed: 0.0119s/iter; left time: 90.2972s
	iters: 500, epoch: 7 | loss: 0.2855080
	speed: 0.0119s/iter; left time: 88.8895s
Epoch: 7 cost time: 7.08808708190918
Epoch: 7, Steps: 570 | Train Loss: 0.2416486 Vali Loss: 0.0592097 Test Loss: 0.1649025
Validation loss decreased (0.061072 --> 0.059210).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1336527
	speed: 0.0400s/iter; left time: 292.2528s
	iters: 200, epoch: 8 | loss: 0.2625571
	speed: 0.0119s/iter; left time: 85.7933s
	iters: 300, epoch: 8 | loss: 0.1553656
	speed: 0.0119s/iter; left time: 84.7073s
	iters: 400, epoch: 8 | loss: 0.1543682
	speed: 0.0118s/iter; left time: 82.9662s
	iters: 500, epoch: 8 | loss: 0.2160325
	speed: 0.0119s/iter; left time: 82.0296s
Epoch: 8 cost time: 7.087522268295288
Epoch: 8, Steps: 570 | Train Loss: 0.2399890 Vali Loss: 0.0591067 Test Loss: 0.1641041
Validation loss decreased (0.059210 --> 0.059107).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1801660
	speed: 0.0414s/iter; left time: 278.8654s
	iters: 200, epoch: 9 | loss: 0.1819342
	speed: 0.0121s/iter; left time: 80.1549s
	iters: 300, epoch: 9 | loss: 0.2147153
	speed: 0.0119s/iter; left time: 77.9347s
	iters: 400, epoch: 9 | loss: 0.2052983
	speed: 0.0119s/iter; left time: 76.9416s
	iters: 500, epoch: 9 | loss: 0.2915892
	speed: 0.0119s/iter; left time: 75.6071s
Epoch: 9 cost time: 7.26894736289978
Epoch: 9, Steps: 570 | Train Loss: 0.2384743 Vali Loss: 0.0582299 Test Loss: 0.1634074
Validation loss decreased (0.059107 --> 0.058230).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1885498
	speed: 0.0412s/iter; left time: 253.9782s
	iters: 200, epoch: 10 | loss: 0.2248306
	speed: 0.0130s/iter; left time: 78.9659s
	iters: 300, epoch: 10 | loss: 0.1583959
	speed: 0.0130s/iter; left time: 77.4008s
	iters: 400, epoch: 10 | loss: 0.2134813
	speed: 0.0129s/iter; left time: 76.0024s
	iters: 500, epoch: 10 | loss: 0.4080054
	speed: 0.0129s/iter; left time: 74.6826s
Epoch: 10 cost time: 7.690529823303223
Epoch: 10, Steps: 570 | Train Loss: 0.2358646 Vali Loss: 0.0583463 Test Loss: 0.1634760
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1674199
	speed: 0.0414s/iter; left time: 231.7299s
	iters: 200, epoch: 11 | loss: 0.3668125
	speed: 0.0119s/iter; left time: 65.2996s
	iters: 300, epoch: 11 | loss: 0.2715604
	speed: 0.0119s/iter; left time: 64.1036s
	iters: 400, epoch: 11 | loss: 0.2415816
	speed: 0.0119s/iter; left time: 62.9370s
	iters: 500, epoch: 11 | loss: 0.2843077
	speed: 0.0119s/iter; left time: 61.7204s
Epoch: 11 cost time: 7.0616326332092285
Epoch: 11, Steps: 570 | Train Loss: 0.2364390 Vali Loss: 0.0585822 Test Loss: 0.1633486
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2286063
	speed: 0.0403s/iter; left time: 202.7325s
	iters: 200, epoch: 12 | loss: 0.1283193
	speed: 0.0129s/iter; left time: 63.8055s
	iters: 300, epoch: 12 | loss: 0.2065744
	speed: 0.0129s/iter; left time: 62.5056s
	iters: 400, epoch: 12 | loss: 0.2635843
	speed: 0.0129s/iter; left time: 61.2123s
	iters: 500, epoch: 12 | loss: 0.2058234
	speed: 0.0124s/iter; left time: 57.2785s
Epoch: 12 cost time: 7.540778636932373
Epoch: 12, Steps: 570 | Train Loss: 0.2372949 Vali Loss: 0.0585811 Test Loss: 0.1633064
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16357727348804474, mae:0.25873905420303345
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1796685
	speed: 0.0247s/iter; left time: 278.7058s
	iters: 200, epoch: 1 | loss: 0.3203726
	speed: 0.0126s/iter; left time: 141.1232s
	iters: 300, epoch: 1 | loss: 0.2118618
	speed: 0.0126s/iter; left time: 139.5380s
	iters: 400, epoch: 1 | loss: 0.2701736
	speed: 0.0126s/iter; left time: 138.5407s
	iters: 500, epoch: 1 | loss: 0.2387635
	speed: 0.0126s/iter; left time: 137.8519s
Epoch: 1 cost time: 8.441968441009521
Epoch: 1, Steps: 570 | Train Loss: 0.2496155 Vali Loss: 0.0789338 Test Loss: 0.2181921
Validation loss decreased (inf --> 0.078934).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2929499
	speed: 0.0401s/iter; left time: 430.2132s
	iters: 200, epoch: 2 | loss: 0.2174159
	speed: 0.0115s/iter; left time: 121.8703s
	iters: 300, epoch: 2 | loss: 0.2474419
	speed: 0.0115s/iter; left time: 120.9723s
	iters: 400, epoch: 2 | loss: 0.3588068
	speed: 0.0115s/iter; left time: 119.6934s
	iters: 500, epoch: 2 | loss: 0.5979308
	speed: 0.0115s/iter; left time: 118.4081s
Epoch: 2 cost time: 6.873464822769165
Epoch: 2, Steps: 570 | Train Loss: 0.3421846 Vali Loss: 0.0665686 Test Loss: 0.1938915
Validation loss decreased (0.078934 --> 0.066569).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3956637
	speed: 0.0394s/iter; left time: 400.1699s
	iters: 200, epoch: 3 | loss: 0.1582731
	speed: 0.0115s/iter; left time: 115.8283s
	iters: 300, epoch: 3 | loss: 0.3669603
	speed: 0.0115s/iter; left time: 114.5688s
	iters: 400, epoch: 3 | loss: 0.2793542
	speed: 0.0115s/iter; left time: 113.4541s
	iters: 500, epoch: 3 | loss: 0.3144830
	speed: 0.0115s/iter; left time: 112.4047s
Epoch: 3 cost time: 6.904554605484009
Epoch: 3, Steps: 570 | Train Loss: 0.2952531 Vali Loss: 0.0628071 Test Loss: 0.1831682
Validation loss decreased (0.066569 --> 0.062807).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2594198
	speed: 0.0384s/iter; left time: 367.8684s
	iters: 200, epoch: 4 | loss: 0.1618074
	speed: 0.0115s/iter; left time: 108.7779s
	iters: 300, epoch: 4 | loss: 0.1491181
	speed: 0.0115s/iter; left time: 107.6711s
	iters: 400, epoch: 4 | loss: 0.2702274
	speed: 0.0115s/iter; left time: 106.5877s
	iters: 500, epoch: 4 | loss: 0.2366442
	speed: 0.0115s/iter; left time: 105.3176s
Epoch: 4 cost time: 6.855206489562988
Epoch: 4, Steps: 570 | Train Loss: 0.2701998 Vali Loss: 0.0637959 Test Loss: 0.1755745
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2900212
	speed: 0.0394s/iter; left time: 355.1959s
	iters: 200, epoch: 5 | loss: 0.2182794
	speed: 0.0115s/iter; left time: 102.6770s
	iters: 300, epoch: 5 | loss: 0.3421086
	speed: 0.0115s/iter; left time: 101.4444s
	iters: 400, epoch: 5 | loss: 0.1955701
	speed: 0.0115s/iter; left time: 100.3447s
	iters: 500, epoch: 5 | loss: 0.2884355
	speed: 0.0115s/iter; left time: 99.1132s
Epoch: 5 cost time: 6.8312294483184814
Epoch: 5, Steps: 570 | Train Loss: 0.2586808 Vali Loss: 0.0617454 Test Loss: 0.1717319
Validation loss decreased (0.062807 --> 0.061745).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2905227
	speed: 0.0389s/iter; left time: 328.6812s
	iters: 200, epoch: 6 | loss: 0.2730651
	speed: 0.0115s/iter; left time: 95.8443s
	iters: 300, epoch: 6 | loss: 0.1626481
	speed: 0.0122s/iter; left time: 100.6955s
	iters: 400, epoch: 6 | loss: 0.1758117
	speed: 0.0126s/iter; left time: 102.7584s
	iters: 500, epoch: 6 | loss: 0.2027135
	speed: 0.0126s/iter; left time: 101.2582s
Epoch: 6 cost time: 7.2682623863220215
Epoch: 6, Steps: 570 | Train Loss: 0.2503739 Vali Loss: 0.0603163 Test Loss: 0.1696076
Validation loss decreased (0.061745 --> 0.060316).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1629372
	speed: 0.0400s/iter; left time: 315.5678s
	iters: 200, epoch: 7 | loss: 0.4093698
	speed: 0.0115s/iter; left time: 89.7954s
	iters: 300, epoch: 7 | loss: 0.2375754
	speed: 0.0116s/iter; left time: 88.8021s
	iters: 400, epoch: 7 | loss: 0.1748221
	speed: 0.0116s/iter; left time: 87.5896s
	iters: 500, epoch: 7 | loss: 0.1773041
	speed: 0.0115s/iter; left time: 86.0133s
Epoch: 7 cost time: 6.8954126834869385
Epoch: 7, Steps: 570 | Train Loss: 0.2470633 Vali Loss: 0.0601705 Test Loss: 0.1683172
Validation loss decreased (0.060316 --> 0.060171).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1559660
	speed: 0.0405s/iter; left time: 296.0186s
	iters: 200, epoch: 8 | loss: 0.2440483
	speed: 0.0115s/iter; left time: 83.1260s
	iters: 300, epoch: 8 | loss: 0.2035100
	speed: 0.0115s/iter; left time: 81.9826s
	iters: 400, epoch: 8 | loss: 0.2517019
	speed: 0.0115s/iter; left time: 80.8048s
	iters: 500, epoch: 8 | loss: 0.1877975
	speed: 0.0115s/iter; left time: 79.6925s
Epoch: 8 cost time: 6.906211853027344
Epoch: 8, Steps: 570 | Train Loss: 0.2481832 Vali Loss: 0.0595144 Test Loss: 0.1678012
Validation loss decreased (0.060171 --> 0.059514).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3043793
	speed: 0.0417s/iter; left time: 281.1454s
	iters: 200, epoch: 9 | loss: 0.1733602
	speed: 0.0115s/iter; left time: 76.5444s
	iters: 300, epoch: 9 | loss: 0.3501782
	speed: 0.0115s/iter; left time: 75.4126s
	iters: 400, epoch: 9 | loss: 0.3207723
	speed: 0.0115s/iter; left time: 74.1635s
	iters: 500, epoch: 9 | loss: 0.3596117
	speed: 0.0115s/iter; left time: 72.9450s
Epoch: 9 cost time: 6.8962085247039795
Epoch: 9, Steps: 570 | Train Loss: 0.2453948 Vali Loss: 0.0594102 Test Loss: 0.1675649
Validation loss decreased (0.059514 --> 0.059410).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1794396
	speed: 0.0401s/iter; left time: 247.2466s
	iters: 200, epoch: 10 | loss: 0.2279155
	speed: 0.0115s/iter; left time: 69.7413s
	iters: 300, epoch: 10 | loss: 0.1558017
	speed: 0.0115s/iter; left time: 68.5841s
	iters: 400, epoch: 10 | loss: 0.2411603
	speed: 0.0115s/iter; left time: 67.4029s
	iters: 500, epoch: 10 | loss: 0.2668256
	speed: 0.0115s/iter; left time: 66.2734s
Epoch: 10 cost time: 6.88175106048584
Epoch: 10, Steps: 570 | Train Loss: 0.2453270 Vali Loss: 0.0596609 Test Loss: 0.1673820
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1222677
	speed: 0.0395s/iter; left time: 221.3738s
	iters: 200, epoch: 11 | loss: 0.1957473
	speed: 0.0115s/iter; left time: 62.9936s
	iters: 300, epoch: 11 | loss: 0.2241580
	speed: 0.0115s/iter; left time: 61.9691s
	iters: 400, epoch: 11 | loss: 0.2861233
	speed: 0.0115s/iter; left time: 60.7823s
	iters: 500, epoch: 11 | loss: 0.3761418
	speed: 0.0115s/iter; left time: 59.6821s
Epoch: 11 cost time: 6.832703113555908
Epoch: 11, Steps: 570 | Train Loss: 0.2456568 Vali Loss: 0.0596132 Test Loss: 0.1673657
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2111523
	speed: 0.0391s/iter; left time: 196.8936s
	iters: 200, epoch: 12 | loss: 0.1821611
	speed: 0.0115s/iter; left time: 56.4926s
	iters: 300, epoch: 12 | loss: 0.1647033
	speed: 0.0115s/iter; left time: 55.3849s
	iters: 400, epoch: 12 | loss: 0.3011793
	speed: 0.0115s/iter; left time: 54.2016s
	iters: 500, epoch: 12 | loss: 0.2388800
	speed: 0.0115s/iter; left time: 53.0567s
Epoch: 12 cost time: 6.816465377807617
Epoch: 12, Steps: 570 | Train Loss: 0.2440781 Vali Loss: 0.0597405 Test Loss: 0.1674265
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16781757771968842, mae:0.2611628472805023
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3327174
	speed: 0.0225s/iter; left time: 254.1465s
	iters: 200, epoch: 1 | loss: 0.3182364
	speed: 0.0108s/iter; left time: 121.0584s
	iters: 300, epoch: 1 | loss: 0.3426073
	speed: 0.0108s/iter; left time: 120.1339s
	iters: 400, epoch: 1 | loss: 0.3059278
	speed: 0.0108s/iter; left time: 118.8458s
	iters: 500, epoch: 1 | loss: 0.4027936
	speed: 0.0108s/iter; left time: 117.8089s
Epoch: 1 cost time: 7.38435173034668
Epoch: 1, Steps: 570 | Train Loss: 0.3039419 Vali Loss: 0.0807907 Test Loss: 0.2209334
Validation loss decreased (inf --> 0.080791).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3536313
	speed: 0.0392s/iter; left time: 420.6887s
	iters: 200, epoch: 2 | loss: 0.3966191
	speed: 0.0108s/iter; left time: 115.2626s
	iters: 300, epoch: 2 | loss: 0.2305571
	speed: 0.0108s/iter; left time: 113.8976s
	iters: 400, epoch: 2 | loss: 0.2279711
	speed: 0.0108s/iter; left time: 112.6158s
	iters: 500, epoch: 2 | loss: 0.2820280
	speed: 0.0108s/iter; left time: 111.5863s
Epoch: 2 cost time: 6.4819018840789795
Epoch: 2, Steps: 570 | Train Loss: 0.3421060 Vali Loss: 0.0724195 Test Loss: 0.1958509
Validation loss decreased (0.080791 --> 0.072419).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2353123
	speed: 0.0389s/iter; left time: 394.9965s
	iters: 200, epoch: 3 | loss: 0.2257837
	speed: 0.0108s/iter; left time: 108.8133s
	iters: 300, epoch: 3 | loss: 0.2265708
	speed: 0.0108s/iter; left time: 107.5865s
	iters: 400, epoch: 3 | loss: 0.2759785
	speed: 0.0109s/iter; left time: 107.1905s
	iters: 500, epoch: 3 | loss: 0.2378863
	speed: 0.0109s/iter; left time: 106.0180s
Epoch: 3 cost time: 6.473947525024414
Epoch: 3, Steps: 570 | Train Loss: 0.2737085 Vali Loss: 0.0630089 Test Loss: 0.1675890
Validation loss decreased (0.072419 --> 0.063009).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2410200
	speed: 0.0370s/iter; left time: 355.0066s
	iters: 200, epoch: 4 | loss: 0.1390311
	speed: 0.0108s/iter; left time: 102.6927s
	iters: 300, epoch: 4 | loss: 0.2606155
	speed: 0.0108s/iter; left time: 101.6468s
	iters: 400, epoch: 4 | loss: 0.4015678
	speed: 0.0108s/iter; left time: 100.5444s
	iters: 500, epoch: 4 | loss: 0.2342789
	speed: 0.0108s/iter; left time: 99.5030s
Epoch: 4 cost time: 6.484527349472046
Epoch: 4, Steps: 570 | Train Loss: 0.2503709 Vali Loss: 0.0647304 Test Loss: 0.1658181
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2422166
	speed: 0.0373s/iter; left time: 336.0405s
	iters: 200, epoch: 5 | loss: 0.1894854
	speed: 0.0108s/iter; left time: 96.1085s
	iters: 300, epoch: 5 | loss: 0.2011713
	speed: 0.0108s/iter; left time: 95.0381s
	iters: 400, epoch: 5 | loss: 0.1729721
	speed: 0.0108s/iter; left time: 94.2527s
	iters: 500, epoch: 5 | loss: 0.3241611
	speed: 0.0108s/iter; left time: 92.8559s
Epoch: 5 cost time: 6.444623947143555
Epoch: 5, Steps: 570 | Train Loss: 0.2379840 Vali Loss: 0.0632330 Test Loss: 0.1627935
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1657743
	speed: 0.0366s/iter; left time: 309.0723s
	iters: 200, epoch: 6 | loss: 0.2104838
	speed: 0.0108s/iter; left time: 90.2418s
	iters: 300, epoch: 6 | loss: 0.2671312
	speed: 0.0108s/iter; left time: 89.1504s
	iters: 400, epoch: 6 | loss: 0.2211233
	speed: 0.0108s/iter; left time: 88.1613s
	iters: 500, epoch: 6 | loss: 0.1637257
	speed: 0.0108s/iter; left time: 86.9881s
Epoch: 6 cost time: 6.447439432144165
Epoch: 6, Steps: 570 | Train Loss: 0.2299352 Vali Loss: 0.0637382 Test Loss: 0.1610361
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16782337427139282, mae:0.265283465385437
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2021424
	speed: 0.0263s/iter; left time: 296.8362s
	iters: 200, epoch: 1 | loss: 0.1925161
	speed: 0.0146s/iter; left time: 163.4683s
	iters: 300, epoch: 1 | loss: 0.3646648
	speed: 0.0145s/iter; left time: 161.3904s
	iters: 400, epoch: 1 | loss: 0.3172990
	speed: 0.0145s/iter; left time: 159.6204s
	iters: 500, epoch: 1 | loss: 0.1780760
	speed: 0.0146s/iter; left time: 158.9163s
Epoch: 1 cost time: 9.520718812942505
Epoch: 1, Steps: 570 | Train Loss: 0.2514787 Vali Loss: 0.0618211 Test Loss: 0.1670834
Validation loss decreased (inf --> 0.061821).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3758127
	speed: 0.0478s/iter; left time: 512.9086s
	iters: 200, epoch: 2 | loss: 0.2328117
	speed: 0.0147s/iter; left time: 156.1674s
	iters: 300, epoch: 2 | loss: 0.2166753
	speed: 0.0146s/iter; left time: 154.2770s
	iters: 400, epoch: 2 | loss: 0.1600483
	speed: 0.0147s/iter; left time: 153.0867s
	iters: 500, epoch: 2 | loss: 0.2440310
	speed: 0.0146s/iter; left time: 151.2053s
Epoch: 2 cost time: 8.67594313621521
Epoch: 2, Steps: 570 | Train Loss: 0.2545696 Vali Loss: 0.0566529 Test Loss: 0.1636013
Validation loss decreased (0.061821 --> 0.056653).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3808836
	speed: 0.0475s/iter; left time: 482.3335s
	iters: 200, epoch: 3 | loss: 0.2466947
	speed: 0.0146s/iter; left time: 146.5876s
	iters: 300, epoch: 3 | loss: 0.1148460
	speed: 0.0146s/iter; left time: 145.2056s
	iters: 400, epoch: 3 | loss: 0.1709522
	speed: 0.0146s/iter; left time: 143.6059s
	iters: 500, epoch: 3 | loss: 0.1981073
	speed: 0.0146s/iter; left time: 142.1807s
Epoch: 3 cost time: 8.694891452789307
Epoch: 3, Steps: 570 | Train Loss: 0.2202817 Vali Loss: 0.0512793 Test Loss: 0.1501765
Validation loss decreased (0.056653 --> 0.051279).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1944005
	speed: 0.0476s/iter; left time: 456.9583s
	iters: 200, epoch: 4 | loss: 0.1566377
	speed: 0.0146s/iter; left time: 138.4783s
	iters: 300, epoch: 4 | loss: 0.2081069
	speed: 0.0146s/iter; left time: 136.8303s
	iters: 400, epoch: 4 | loss: 0.1892206
	speed: 0.0146s/iter; left time: 135.2711s
	iters: 500, epoch: 4 | loss: 0.2124998
	speed: 0.0146s/iter; left time: 133.8030s
Epoch: 4 cost time: 8.613909244537354
Epoch: 4, Steps: 570 | Train Loss: 0.1995000 Vali Loss: 0.0463360 Test Loss: 0.1446078
Validation loss decreased (0.051279 --> 0.046336).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1876682
	speed: 0.0465s/iter; left time: 419.5015s
	iters: 200, epoch: 5 | loss: 0.1668259
	speed: 0.0146s/iter; left time: 129.8457s
	iters: 300, epoch: 5 | loss: 0.1381411
	speed: 0.0146s/iter; left time: 128.3651s
	iters: 400, epoch: 5 | loss: 0.2317812
	speed: 0.0146s/iter; left time: 126.9796s
	iters: 500, epoch: 5 | loss: 0.1862955
	speed: 0.0146s/iter; left time: 125.4827s
Epoch: 5 cost time: 8.596188068389893
Epoch: 5, Steps: 570 | Train Loss: 0.1858906 Vali Loss: 0.0453545 Test Loss: 0.1382442
Validation loss decreased (0.046336 --> 0.045354).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1635985
	speed: 0.0469s/iter; left time: 396.2248s
	iters: 200, epoch: 6 | loss: 0.1883183
	speed: 0.0146s/iter; left time: 121.7540s
	iters: 300, epoch: 6 | loss: 0.1240506
	speed: 0.0146s/iter; left time: 120.3248s
	iters: 400, epoch: 6 | loss: 0.1124600
	speed: 0.0146s/iter; left time: 118.8672s
	iters: 500, epoch: 6 | loss: 0.1650752
	speed: 0.0146s/iter; left time: 117.3474s
Epoch: 6 cost time: 8.62702465057373
Epoch: 6, Steps: 570 | Train Loss: 0.1777709 Vali Loss: 0.0447077 Test Loss: 0.1378238
Validation loss decreased (0.045354 --> 0.044708).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1421961
	speed: 0.0478s/iter; left time: 377.0995s
	iters: 200, epoch: 7 | loss: 0.1592079
	speed: 0.0146s/iter; left time: 113.2456s
	iters: 300, epoch: 7 | loss: 0.1536149
	speed: 0.0145s/iter; left time: 111.6701s
	iters: 400, epoch: 7 | loss: 0.1435184
	speed: 0.0145s/iter; left time: 110.0885s
	iters: 500, epoch: 7 | loss: 0.1989434
	speed: 0.0145s/iter; left time: 108.6191s
Epoch: 7 cost time: 8.573155879974365
Epoch: 7, Steps: 570 | Train Loss: 0.1743078 Vali Loss: 0.0442103 Test Loss: 0.1381981
Validation loss decreased (0.044708 --> 0.044210).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2754486
	speed: 0.0483s/iter; left time: 352.7767s
	iters: 200, epoch: 8 | loss: 0.1697963
	speed: 0.0145s/iter; left time: 104.7873s
	iters: 300, epoch: 8 | loss: 0.2003881
	speed: 0.0145s/iter; left time: 103.0513s
	iters: 400, epoch: 8 | loss: 0.1058447
	speed: 0.0145s/iter; left time: 101.5738s
	iters: 500, epoch: 8 | loss: 0.2092163
	speed: 0.0145s/iter; left time: 100.3131s
Epoch: 8 cost time: 8.578622341156006
Epoch: 8, Steps: 570 | Train Loss: 0.1720699 Vali Loss: 0.0444646 Test Loss: 0.1381192
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2775129
	speed: 0.0458s/iter; left time: 308.9405s
	iters: 200, epoch: 9 | loss: 0.1869513
	speed: 0.0147s/iter; left time: 97.3422s
	iters: 300, epoch: 9 | loss: 0.2404243
	speed: 0.0147s/iter; left time: 95.8838s
	iters: 400, epoch: 9 | loss: 0.1877683
	speed: 0.0147s/iter; left time: 94.4225s
	iters: 500, epoch: 9 | loss: 0.1491519
	speed: 0.0147s/iter; left time: 93.1813s
Epoch: 9 cost time: 8.6262948513031
Epoch: 9, Steps: 570 | Train Loss: 0.1709610 Vali Loss: 0.0442922 Test Loss: 0.1373717
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1937200
	speed: 0.0492s/iter; left time: 303.3231s
	iters: 200, epoch: 10 | loss: 0.1355558
	speed: 0.0146s/iter; left time: 88.5715s
	iters: 300, epoch: 10 | loss: 0.1136709
	speed: 0.0146s/iter; left time: 87.0624s
	iters: 400, epoch: 10 | loss: 0.1265586
	speed: 0.0146s/iter; left time: 85.6768s
	iters: 500, epoch: 10 | loss: 0.2174215
	speed: 0.0146s/iter; left time: 84.1958s
Epoch: 10 cost time: 8.631231307983398
Epoch: 10, Steps: 570 | Train Loss: 0.1704257 Vali Loss: 0.0441107 Test Loss: 0.1373031
Validation loss decreased (0.044210 --> 0.044111).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1637001
	speed: 0.0465s/iter; left time: 260.6175s
	iters: 200, epoch: 11 | loss: 0.1189625
	speed: 0.0146s/iter; left time: 80.1828s
	iters: 300, epoch: 11 | loss: 0.1546430
	speed: 0.0146s/iter; left time: 78.7249s
	iters: 400, epoch: 11 | loss: 0.1115248
	speed: 0.0146s/iter; left time: 77.2704s
	iters: 500, epoch: 11 | loss: 0.1244606
	speed: 0.0146s/iter; left time: 75.7880s
Epoch: 11 cost time: 8.617980003356934
Epoch: 11, Steps: 570 | Train Loss: 0.1703624 Vali Loss: 0.0442272 Test Loss: 0.1372467
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1294420
	speed: 0.0474s/iter; left time: 238.5052s
	iters: 200, epoch: 12 | loss: 0.1040739
	speed: 0.0163s/iter; left time: 80.4595s
	iters: 300, epoch: 12 | loss: 0.1994811
	speed: 0.0163s/iter; left time: 78.8603s
	iters: 400, epoch: 12 | loss: 0.1641083
	speed: 0.0163s/iter; left time: 77.1955s
	iters: 500, epoch: 12 | loss: 0.1259927
	speed: 0.0163s/iter; left time: 75.6012s
Epoch: 12 cost time: 9.574938297271729
Epoch: 12, Steps: 570 | Train Loss: 0.1692939 Vali Loss: 0.0441475 Test Loss: 0.1371971
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2209660
	speed: 0.0477s/iter; left time: 212.7996s
	iters: 200, epoch: 13 | loss: 0.2390860
	speed: 0.0147s/iter; left time: 64.0170s
	iters: 300, epoch: 13 | loss: 0.2171553
	speed: 0.0147s/iter; left time: 62.5122s
	iters: 400, epoch: 13 | loss: 0.1052573
	speed: 0.0147s/iter; left time: 61.0521s
	iters: 500, epoch: 13 | loss: 0.1743914
	speed: 0.0147s/iter; left time: 59.6608s
Epoch: 13 cost time: 8.68053126335144
Epoch: 13, Steps: 570 | Train Loss: 0.1694824 Vali Loss: 0.0442130 Test Loss: 0.1371884
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13750919699668884, mae:0.2309766709804535
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3579784
	speed: 0.0280s/iter; left time: 316.0873s
	iters: 200, epoch: 1 | loss: 0.2492652
	speed: 0.0154s/iter; left time: 173.0549s
	iters: 300, epoch: 1 | loss: 0.1267075
	speed: 0.0144s/iter; left time: 159.8214s
	iters: 400, epoch: 1 | loss: 0.2885725
	speed: 0.0144s/iter; left time: 158.6667s
	iters: 500, epoch: 1 | loss: 0.1961450
	speed: 0.0144s/iter; left time: 157.3870s
Epoch: 1 cost time: 9.728955268859863
Epoch: 1, Steps: 570 | Train Loss: 0.2143978 Vali Loss: 0.0422654 Test Loss: 0.1404254
Validation loss decreased (inf --> 0.042265).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1853428
	speed: 0.0508s/iter; left time: 544.8091s
	iters: 200, epoch: 2 | loss: 0.3092574
	speed: 0.0166s/iter; left time: 176.3662s
	iters: 300, epoch: 2 | loss: 0.2416447
	speed: 0.0145s/iter; left time: 152.8807s
	iters: 400, epoch: 2 | loss: 0.1907769
	speed: 0.0144s/iter; left time: 150.4672s
	iters: 500, epoch: 2 | loss: 0.3004417
	speed: 0.0144s/iter; left time: 148.8610s
Epoch: 2 cost time: 8.981372356414795
Epoch: 2, Steps: 570 | Train Loss: 0.2455699 Vali Loss: 0.0700985 Test Loss: 0.1969756
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3261602
	speed: 0.0453s/iter; left time: 460.2564s
	iters: 200, epoch: 3 | loss: 0.1153121
	speed: 0.0143s/iter; left time: 143.4582s
	iters: 300, epoch: 3 | loss: 0.3054507
	speed: 0.0143s/iter; left time: 142.1340s
	iters: 400, epoch: 3 | loss: 0.1318701
	speed: 0.0143s/iter; left time: 140.8352s
	iters: 500, epoch: 3 | loss: 0.2147380
	speed: 0.0143s/iter; left time: 139.4629s
Epoch: 3 cost time: 8.418151617050171
Epoch: 3, Steps: 570 | Train Loss: 0.2506641 Vali Loss: 0.0531762 Test Loss: 0.1599999
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2274706
	speed: 0.0472s/iter; left time: 452.2841s
	iters: 200, epoch: 4 | loss: 0.1663541
	speed: 0.0143s/iter; left time: 135.5332s
	iters: 300, epoch: 4 | loss: 0.3156635
	speed: 0.0143s/iter; left time: 134.3928s
	iters: 400, epoch: 4 | loss: 0.1417001
	speed: 0.0143s/iter; left time: 132.8292s
	iters: 500, epoch: 4 | loss: 0.1505014
	speed: 0.0143s/iter; left time: 131.2975s
Epoch: 4 cost time: 8.432449102401733
Epoch: 4, Steps: 570 | Train Loss: 0.2101283 Vali Loss: 0.0509230 Test Loss: 0.1516359
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1406233012676239, mae:0.23075206577777863
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1255287
	speed: 0.0280s/iter; left time: 316.2098s
	iters: 200, epoch: 1 | loss: 0.3506041
	speed: 0.0161s/iter; left time: 180.0018s
	iters: 300, epoch: 1 | loss: 0.3245904
	speed: 0.0147s/iter; left time: 163.7001s
	iters: 400, epoch: 1 | loss: 0.2325457
	speed: 0.0143s/iter; left time: 157.8053s
	iters: 500, epoch: 1 | loss: 0.2726045
	speed: 0.0143s/iter; left time: 155.7659s
Epoch: 1 cost time: 9.800244808197021
Epoch: 1, Steps: 570 | Train Loss: 0.2607614 Vali Loss: 0.0578785 Test Loss: 0.1718232
Validation loss decreased (inf --> 0.057879).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2770151
	speed: 0.0462s/iter; left time: 495.4485s
	iters: 200, epoch: 2 | loss: 0.2334131
	speed: 0.0143s/iter; left time: 151.8562s
	iters: 300, epoch: 2 | loss: 0.1974951
	speed: 0.0143s/iter; left time: 150.1260s
	iters: 400, epoch: 2 | loss: 0.2227008
	speed: 0.0143s/iter; left time: 148.9876s
	iters: 500, epoch: 2 | loss: 0.3233249
	speed: 0.0143s/iter; left time: 147.4253s
Epoch: 2 cost time: 8.456159830093384
Epoch: 2, Steps: 570 | Train Loss: 0.2962000 Vali Loss: 0.0627234 Test Loss: 0.1698018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2439906
	speed: 0.0468s/iter; left time: 475.7972s
	iters: 200, epoch: 3 | loss: 0.3127278
	speed: 0.0144s/iter; left time: 144.3938s
	iters: 300, epoch: 3 | loss: 0.2239275
	speed: 0.0144s/iter; left time: 143.0111s
	iters: 400, epoch: 3 | loss: 0.2060677
	speed: 0.0157s/iter; left time: 154.7470s
	iters: 500, epoch: 3 | loss: 0.2406228
	speed: 0.0144s/iter; left time: 140.3397s
Epoch: 3 cost time: 8.591138124465942
Epoch: 3, Steps: 570 | Train Loss: 0.2465655 Vali Loss: 0.0627705 Test Loss: 0.1686419
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3114236
	speed: 0.0473s/iter; left time: 454.0787s
	iters: 200, epoch: 4 | loss: 0.1990649
	speed: 0.0144s/iter; left time: 136.2158s
	iters: 300, epoch: 4 | loss: 0.2273496
	speed: 0.0144s/iter; left time: 134.9313s
	iters: 400, epoch: 4 | loss: 0.2008995
	speed: 0.0143s/iter; left time: 132.8287s
	iters: 500, epoch: 4 | loss: 0.1867630
	speed: 0.0143s/iter; left time: 131.7265s
Epoch: 4 cost time: 8.439200162887573
Epoch: 4, Steps: 570 | Train Loss: 0.2317419 Vali Loss: 0.0565305 Test Loss: 0.1541988
Validation loss decreased (0.057879 --> 0.056530).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1827768
	speed: 0.0483s/iter; left time: 435.5009s
	iters: 200, epoch: 5 | loss: 0.2424145
	speed: 0.0143s/iter; left time: 127.3777s
	iters: 300, epoch: 5 | loss: 0.1769633
	speed: 0.0165s/iter; left time: 145.7364s
	iters: 400, epoch: 5 | loss: 0.3183462
	speed: 0.0164s/iter; left time: 143.4048s
	iters: 500, epoch: 5 | loss: 0.1517796
	speed: 0.0152s/iter; left time: 131.3386s
Epoch: 5 cost time: 8.962648391723633
Epoch: 5, Steps: 570 | Train Loss: 0.2206718 Vali Loss: 0.0559052 Test Loss: 0.1531190
Validation loss decreased (0.056530 --> 0.055905).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2887405
	speed: 0.0461s/iter; left time: 389.7776s
	iters: 200, epoch: 6 | loss: 0.2290369
	speed: 0.0142s/iter; left time: 118.6633s
	iters: 300, epoch: 6 | loss: 0.1388823
	speed: 0.0142s/iter; left time: 117.2411s
	iters: 400, epoch: 6 | loss: 0.2632432
	speed: 0.0142s/iter; left time: 115.7841s
	iters: 500, epoch: 6 | loss: 0.2012624
	speed: 0.0142s/iter; left time: 114.3449s
Epoch: 6 cost time: 8.407126903533936
Epoch: 6, Steps: 570 | Train Loss: 0.2157504 Vali Loss: 0.0545692 Test Loss: 0.1535233
Validation loss decreased (0.055905 --> 0.054569).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2609769
	speed: 0.0464s/iter; left time: 365.8039s
	iters: 200, epoch: 7 | loss: 0.1198593
	speed: 0.0142s/iter; left time: 110.7750s
	iters: 300, epoch: 7 | loss: 0.1548982
	speed: 0.0142s/iter; left time: 109.3524s
	iters: 400, epoch: 7 | loss: 0.2881845
	speed: 0.0142s/iter; left time: 107.9363s
	iters: 500, epoch: 7 | loss: 0.1886747
	speed: 0.0142s/iter; left time: 106.4953s
Epoch: 7 cost time: 8.419147729873657
Epoch: 7, Steps: 570 | Train Loss: 0.2104953 Vali Loss: 0.0552722 Test Loss: 0.1542632
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1520666
	speed: 0.0465s/iter; left time: 339.9314s
	iters: 200, epoch: 8 | loss: 0.1610115
	speed: 0.0143s/iter; left time: 103.2733s
	iters: 300, epoch: 8 | loss: 0.2201933
	speed: 0.0143s/iter; left time: 101.8869s
	iters: 400, epoch: 8 | loss: 0.1989685
	speed: 0.0143s/iter; left time: 100.3769s
	iters: 500, epoch: 8 | loss: 0.1495541
	speed: 0.0144s/iter; left time: 99.4023s
Epoch: 8 cost time: 8.499264001846313
Epoch: 8, Steps: 570 | Train Loss: 0.2098225 Vali Loss: 0.0553594 Test Loss: 0.1540214
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2585093
	speed: 0.0474s/iter; left time: 319.2472s
	iters: 200, epoch: 9 | loss: 0.1992339
	speed: 0.0164s/iter; left time: 108.6401s
	iters: 300, epoch: 9 | loss: 0.1346188
	speed: 0.0155s/iter; left time: 101.2095s
	iters: 400, epoch: 9 | loss: 0.1820253
	speed: 0.0143s/iter; left time: 92.3034s
	iters: 500, epoch: 9 | loss: 0.1771368
	speed: 0.0143s/iter; left time: 90.8612s
Epoch: 9 cost time: 8.943140983581543
Epoch: 9, Steps: 570 | Train Loss: 0.2070904 Vali Loss: 0.0549729 Test Loss: 0.1534572
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15372373163700104, mae:0.25145941972732544
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3330847
	speed: 0.0288s/iter; left time: 324.9156s
	iters: 200, epoch: 1 | loss: 0.4218915
	speed: 0.0169s/iter; left time: 189.1219s
	iters: 300, epoch: 1 | loss: 0.2805955
	speed: 0.0169s/iter; left time: 187.4978s
	iters: 400, epoch: 1 | loss: 0.3035471
	speed: 0.0169s/iter; left time: 186.2265s
	iters: 500, epoch: 1 | loss: 0.2725039
	speed: 0.0169s/iter; left time: 184.1043s
Epoch: 1 cost time: 10.87680721282959
Epoch: 1, Steps: 570 | Train Loss: 0.3454965 Vali Loss: 0.0697863 Test Loss: 0.1908302
Validation loss decreased (inf --> 0.069786).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4603559
	speed: 0.0526s/iter; left time: 564.8563s
	iters: 200, epoch: 2 | loss: 0.3383348
	speed: 0.0169s/iter; left time: 179.6173s
	iters: 300, epoch: 2 | loss: 0.2927231
	speed: 0.0169s/iter; left time: 177.5351s
	iters: 400, epoch: 2 | loss: 0.3209269
	speed: 0.0169s/iter; left time: 175.9175s
	iters: 500, epoch: 2 | loss: 0.3092749
	speed: 0.0169s/iter; left time: 174.3392s
Epoch: 2 cost time: 9.947781324386597
Epoch: 2, Steps: 570 | Train Loss: 0.2911564 Vali Loss: 0.0641279 Test Loss: 0.1778177
Validation loss decreased (0.069786 --> 0.064128).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2104033
	speed: 0.0529s/iter; left time: 537.6355s
	iters: 200, epoch: 3 | loss: 0.2310549
	speed: 0.0169s/iter; left time: 169.9030s
	iters: 300, epoch: 3 | loss: 0.4158018
	speed: 0.0169s/iter; left time: 167.8791s
	iters: 400, epoch: 3 | loss: 0.2733926
	speed: 0.0169s/iter; left time: 166.4417s
	iters: 500, epoch: 3 | loss: 0.2293164
	speed: 0.0169s/iter; left time: 164.5858s
Epoch: 3 cost time: 9.967597246170044
Epoch: 3, Steps: 570 | Train Loss: 0.2670521 Vali Loss: 0.0600581 Test Loss: 0.1713327
Validation loss decreased (0.064128 --> 0.060058).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3341044
	speed: 0.0519s/iter; left time: 498.1464s
	iters: 200, epoch: 4 | loss: 0.2223510
	speed: 0.0170s/iter; left time: 161.2565s
	iters: 300, epoch: 4 | loss: 0.2641203
	speed: 0.0169s/iter; left time: 159.0700s
	iters: 400, epoch: 4 | loss: 0.3035638
	speed: 0.0169s/iter; left time: 157.0756s
	iters: 500, epoch: 4 | loss: 0.2579872
	speed: 0.0169s/iter; left time: 155.6794s
Epoch: 4 cost time: 10.000986576080322
Epoch: 4, Steps: 570 | Train Loss: 0.2549842 Vali Loss: 0.0583454 Test Loss: 0.1644505
Validation loss decreased (0.060058 --> 0.058345).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1485283
	speed: 0.0524s/iter; left time: 472.8873s
	iters: 200, epoch: 5 | loss: 0.3071730
	speed: 0.0168s/iter; left time: 150.1587s
	iters: 300, epoch: 5 | loss: 0.2212565
	speed: 0.0169s/iter; left time: 148.8001s
	iters: 400, epoch: 5 | loss: 0.2692057
	speed: 0.0168s/iter; left time: 146.7965s
	iters: 500, epoch: 5 | loss: 0.1740633
	speed: 0.0169s/iter; left time: 145.3776s
Epoch: 5 cost time: 9.929325580596924
Epoch: 5, Steps: 570 | Train Loss: 0.2406700 Vali Loss: 0.0549469 Test Loss: 0.1616737
Validation loss decreased (0.058345 --> 0.054947).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3004594
	speed: 0.0520s/iter; left time: 439.6270s
	iters: 200, epoch: 6 | loss: 0.2355074
	speed: 0.0170s/iter; left time: 141.7596s
	iters: 300, epoch: 6 | loss: 0.3626229
	speed: 0.0170s/iter; left time: 139.9440s
	iters: 400, epoch: 6 | loss: 0.2579860
	speed: 0.0169s/iter; left time: 138.1127s
	iters: 500, epoch: 6 | loss: 0.2163518
	speed: 0.0169s/iter; left time: 136.1207s
Epoch: 6 cost time: 9.982840299606323
Epoch: 6, Steps: 570 | Train Loss: 0.2339336 Vali Loss: 0.0543129 Test Loss: 0.1576901
Validation loss decreased (0.054947 --> 0.054313).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1825576
	speed: 0.0520s/iter; left time: 410.1943s
	iters: 200, epoch: 7 | loss: 0.2221727
	speed: 0.0169s/iter; left time: 131.7520s
	iters: 300, epoch: 7 | loss: 0.3218852
	speed: 0.0170s/iter; left time: 130.1968s
	iters: 400, epoch: 7 | loss: 0.1682148
	speed: 0.0170s/iter; left time: 128.6139s
	iters: 500, epoch: 7 | loss: 0.1819262
	speed: 0.0169s/iter; left time: 126.5412s
Epoch: 7 cost time: 9.989230394363403
Epoch: 7, Steps: 570 | Train Loss: 0.2284274 Vali Loss: 0.0537960 Test Loss: 0.1573032
Validation loss decreased (0.054313 --> 0.053796).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2675963
	speed: 0.0517s/iter; left time: 378.1556s
	iters: 200, epoch: 8 | loss: 0.1502899
	speed: 0.0169s/iter; left time: 121.9491s
	iters: 300, epoch: 8 | loss: 0.2123189
	speed: 0.0169s/iter; left time: 120.2156s
	iters: 400, epoch: 8 | loss: 0.1475389
	speed: 0.0169s/iter; left time: 118.4812s
	iters: 500, epoch: 8 | loss: 0.1974163
	speed: 0.0169s/iter; left time: 116.7901s
Epoch: 8 cost time: 9.979647397994995
Epoch: 8, Steps: 570 | Train Loss: 0.2272331 Vali Loss: 0.0537581 Test Loss: 0.1568641
Validation loss decreased (0.053796 --> 0.053758).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2166151
	speed: 0.0527s/iter; left time: 355.4052s
	iters: 200, epoch: 9 | loss: 0.1553343
	speed: 0.0169s/iter; left time: 112.5585s
	iters: 300, epoch: 9 | loss: 0.2586129
	speed: 0.0169s/iter; left time: 110.7320s
	iters: 400, epoch: 9 | loss: 0.2952958
	speed: 0.0169s/iter; left time: 109.0550s
	iters: 500, epoch: 9 | loss: 0.3034004
	speed: 0.0169s/iter; left time: 107.3487s
Epoch: 9 cost time: 10.003300666809082
Epoch: 9, Steps: 570 | Train Loss: 0.2247944 Vali Loss: 0.0537391 Test Loss: 0.1563775
Validation loss decreased (0.053758 --> 0.053739).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3168563
	speed: 0.0517s/iter; left time: 319.0436s
	iters: 200, epoch: 10 | loss: 0.0878856
	speed: 0.0169s/iter; left time: 102.5931s
	iters: 300, epoch: 10 | loss: 0.3373968
	speed: 0.0169s/iter; left time: 100.8938s
	iters: 400, epoch: 10 | loss: 0.2689933
	speed: 0.0169s/iter; left time: 99.3905s
	iters: 500, epoch: 10 | loss: 0.2301403
	speed: 0.0170s/iter; left time: 97.8254s
Epoch: 10 cost time: 9.979855060577393
Epoch: 10, Steps: 570 | Train Loss: 0.2245514 Vali Loss: 0.0535284 Test Loss: 0.1562473
Validation loss decreased (0.053739 --> 0.053528).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1871051
	speed: 0.0531s/iter; left time: 297.4122s
	iters: 200, epoch: 11 | loss: 0.2793106
	speed: 0.0169s/iter; left time: 92.9101s
	iters: 300, epoch: 11 | loss: 0.1377579
	speed: 0.0169s/iter; left time: 91.1119s
	iters: 400, epoch: 11 | loss: 0.2009258
	speed: 0.0168s/iter; left time: 89.2558s
	iters: 500, epoch: 11 | loss: 0.3015958
	speed: 0.0168s/iter; left time: 87.6068s
Epoch: 11 cost time: 9.946401834487915
Epoch: 11, Steps: 570 | Train Loss: 0.2249263 Vali Loss: 0.0536926 Test Loss: 0.1561432
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2742327
	speed: 0.0518s/iter; left time: 260.5698s
	iters: 200, epoch: 12 | loss: 0.2219787
	speed: 0.0169s/iter; left time: 83.1830s
	iters: 300, epoch: 12 | loss: 0.1666441
	speed: 0.0169s/iter; left time: 81.7021s
	iters: 400, epoch: 12 | loss: 0.2601201
	speed: 0.0169s/iter; left time: 80.1760s
	iters: 500, epoch: 12 | loss: 0.2562214
	speed: 0.0169s/iter; left time: 78.4356s
Epoch: 12 cost time: 9.965986490249634
Epoch: 12, Steps: 570 | Train Loss: 0.2220818 Vali Loss: 0.0534947 Test Loss: 0.1561710
Validation loss decreased (0.053528 --> 0.053495).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2680194
	speed: 0.0522s/iter; left time: 233.0724s
	iters: 200, epoch: 13 | loss: 0.2794768
	speed: 0.0169s/iter; left time: 73.5231s
	iters: 300, epoch: 13 | loss: 0.2121294
	speed: 0.0169s/iter; left time: 71.7982s
	iters: 400, epoch: 13 | loss: 0.1974308
	speed: 0.0168s/iter; left time: 70.0995s
	iters: 500, epoch: 13 | loss: 0.1572743
	speed: 0.0168s/iter; left time: 68.4236s
Epoch: 13 cost time: 9.946398973464966
Epoch: 13, Steps: 570 | Train Loss: 0.2236310 Vali Loss: 0.0535584 Test Loss: 0.1561416
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2315268
	speed: 0.0517s/iter; left time: 201.2303s
	iters: 200, epoch: 14 | loss: 0.1732250
	speed: 0.0168s/iter; left time: 63.7727s
	iters: 300, epoch: 14 | loss: 0.3574424
	speed: 0.0168s/iter; left time: 62.0904s
	iters: 400, epoch: 14 | loss: 0.1625539
	speed: 0.0168s/iter; left time: 60.4024s
	iters: 500, epoch: 14 | loss: 0.1681940
	speed: 0.0168s/iter; left time: 58.7248s
Epoch: 14 cost time: 9.894289016723633
Epoch: 14, Steps: 570 | Train Loss: 0.2241748 Vali Loss: 0.0537431 Test Loss: 0.1561242
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2904820
	speed: 0.0510s/iter; left time: 169.4281s
	iters: 200, epoch: 15 | loss: 0.2192653
	speed: 0.0170s/iter; left time: 54.6811s
	iters: 300, epoch: 15 | loss: 0.2122760
	speed: 0.0170s/iter; left time: 52.9550s
	iters: 400, epoch: 15 | loss: 0.2134637
	speed: 0.0170s/iter; left time: 51.2131s
	iters: 500, epoch: 15 | loss: 0.1997483
	speed: 0.0170s/iter; left time: 49.6092s
Epoch: 15 cost time: 10.001797676086426
Epoch: 15, Steps: 570 | Train Loss: 0.2233492 Vali Loss: 0.0536967 Test Loss: 0.1561356
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15627369284629822, mae:0.25418999791145325
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2144737
	speed: 0.0300s/iter; left time: 339.0269s
	iters: 200, epoch: 1 | loss: 0.3402271
	speed: 0.0170s/iter; left time: 189.8981s
	iters: 300, epoch: 1 | loss: 0.4058509
	speed: 0.0164s/iter; left time: 182.1504s
	iters: 400, epoch: 1 | loss: 0.2971203
	speed: 0.0164s/iter; left time: 180.7162s
	iters: 500, epoch: 1 | loss: 0.1734860
	speed: 0.0165s/iter; left time: 179.3437s
Epoch: 1 cost time: 10.828068494796753
Epoch: 1, Steps: 570 | Train Loss: 0.3428784 Vali Loss: 0.0651933 Test Loss: 0.1866074
Validation loss decreased (inf --> 0.065193).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2711714
	speed: 0.0519s/iter; left time: 556.6135s
	iters: 200, epoch: 2 | loss: 0.1883248
	speed: 0.0164s/iter; left time: 174.1201s
	iters: 300, epoch: 2 | loss: 0.2948382
	speed: 0.0164s/iter; left time: 172.4340s
	iters: 400, epoch: 2 | loss: 0.3790845
	speed: 0.0163s/iter; left time: 170.5341s
	iters: 500, epoch: 2 | loss: 0.2702579
	speed: 0.0163s/iter; left time: 168.8924s
Epoch: 2 cost time: 9.679903984069824
Epoch: 2, Steps: 570 | Train Loss: 0.2971498 Vali Loss: 0.0673031 Test Loss: 0.1794859
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2691230
	speed: 0.0506s/iter; left time: 514.2141s
	iters: 200, epoch: 3 | loss: 0.2847893
	speed: 0.0164s/iter; left time: 165.2632s
	iters: 300, epoch: 3 | loss: 0.1823582
	speed: 0.0165s/iter; left time: 163.9660s
	iters: 400, epoch: 3 | loss: 0.3311642
	speed: 0.0164s/iter; left time: 161.8889s
	iters: 500, epoch: 3 | loss: 0.1644257
	speed: 0.0164s/iter; left time: 160.5037s
Epoch: 3 cost time: 9.681769371032715
Epoch: 3, Steps: 570 | Train Loss: 0.2645965 Vali Loss: 0.0609325 Test Loss: 0.1718027
Validation loss decreased (0.065193 --> 0.060933).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2358768
	speed: 0.0520s/iter; left time: 498.5706s
	iters: 200, epoch: 4 | loss: 0.5337734
	speed: 0.0164s/iter; left time: 156.1127s
	iters: 300, epoch: 4 | loss: 0.2043590
	speed: 0.0164s/iter; left time: 153.9982s
	iters: 400, epoch: 4 | loss: 0.1743312
	speed: 0.0164s/iter; left time: 152.6949s
	iters: 500, epoch: 4 | loss: 0.3348444
	speed: 0.0164s/iter; left time: 150.9156s
Epoch: 4 cost time: 9.689658403396606
Epoch: 4, Steps: 570 | Train Loss: 0.2481150 Vali Loss: 0.0584789 Test Loss: 0.1644980
Validation loss decreased (0.060933 --> 0.058479).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2391319
	speed: 0.0523s/iter; left time: 472.2239s
	iters: 200, epoch: 5 | loss: 0.3235899
	speed: 0.0164s/iter; left time: 146.5559s
	iters: 300, epoch: 5 | loss: 0.1979586
	speed: 0.0165s/iter; left time: 145.2771s
	iters: 400, epoch: 5 | loss: 0.1689177
	speed: 0.0165s/iter; left time: 143.4834s
	iters: 500, epoch: 5 | loss: 0.2987221
	speed: 0.0164s/iter; left time: 141.6611s
Epoch: 5 cost time: 9.69760775566101
Epoch: 5, Steps: 570 | Train Loss: 0.2362265 Vali Loss: 0.0601912 Test Loss: 0.1622988
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2104980
	speed: 0.0505s/iter; left time: 427.1781s
	iters: 200, epoch: 6 | loss: 0.3277321
	speed: 0.0165s/iter; left time: 137.6332s
	iters: 300, epoch: 6 | loss: 0.4561567
	speed: 0.0165s/iter; left time: 135.9402s
	iters: 400, epoch: 6 | loss: 0.2088858
	speed: 0.0165s/iter; left time: 134.2362s
	iters: 500, epoch: 6 | loss: 0.2088178
	speed: 0.0165s/iter; left time: 132.5865s
Epoch: 6 cost time: 9.717436075210571
Epoch: 6, Steps: 570 | Train Loss: 0.2292538 Vali Loss: 0.0588901 Test Loss: 0.1615104
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3115033
	speed: 0.0516s/iter; left time: 407.0440s
	iters: 200, epoch: 7 | loss: 0.1426938
	speed: 0.0180s/iter; left time: 139.7563s
	iters: 300, epoch: 7 | loss: 0.2557999
	speed: 0.0179s/iter; left time: 137.8173s
	iters: 400, epoch: 7 | loss: 0.3230401
	speed: 0.0179s/iter; left time: 135.9202s
	iters: 500, epoch: 7 | loss: 0.3296988
	speed: 0.0172s/iter; left time: 128.9594s
Epoch: 7 cost time: 10.368970155715942
Epoch: 7, Steps: 570 | Train Loss: 0.2278809 Vali Loss: 0.0594008 Test Loss: 0.1616243
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16471463441848755, mae:0.2595165967941284
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2977015
	speed: 0.0286s/iter; left time: 322.8431s
	iters: 200, epoch: 1 | loss: 0.3025633
	speed: 0.0155s/iter; left time: 173.1965s
	iters: 300, epoch: 1 | loss: 0.2813328
	speed: 0.0154s/iter; left time: 171.3234s
	iters: 400, epoch: 1 | loss: 0.3453762
	speed: 0.0154s/iter; left time: 169.8357s
	iters: 500, epoch: 1 | loss: 0.6158192
	speed: 0.0155s/iter; left time: 168.7397s
Epoch: 1 cost time: 10.169834852218628
Epoch: 1, Steps: 570 | Train Loss: 0.3398425 Vali Loss: 0.0795060 Test Loss: 0.2115769
Validation loss decreased (inf --> 0.079506).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4421618
	speed: 0.0495s/iter; left time: 531.5759s
	iters: 200, epoch: 2 | loss: 0.1749569
	speed: 0.0155s/iter; left time: 165.2398s
	iters: 300, epoch: 2 | loss: 0.2967185
	speed: 0.0155s/iter; left time: 163.3051s
	iters: 400, epoch: 2 | loss: 0.2667936
	speed: 0.0155s/iter; left time: 161.7975s
	iters: 500, epoch: 2 | loss: 0.3372166
	speed: 0.0155s/iter; left time: 159.8435s
Epoch: 2 cost time: 9.141471862792969
Epoch: 2, Steps: 570 | Train Loss: 0.2999388 Vali Loss: 0.0653191 Test Loss: 0.1817264
Validation loss decreased (0.079506 --> 0.065319).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2608772
	speed: 0.0494s/iter; left time: 501.5137s
	iters: 200, epoch: 3 | loss: 0.1706884
	speed: 0.0155s/iter; left time: 155.9068s
	iters: 300, epoch: 3 | loss: 0.3815733
	speed: 0.0155s/iter; left time: 154.0087s
	iters: 400, epoch: 3 | loss: 0.2664266
	speed: 0.0155s/iter; left time: 152.6269s
	iters: 500, epoch: 3 | loss: 0.2473663
	speed: 0.0155s/iter; left time: 150.8636s
Epoch: 3 cost time: 9.108070373535156
Epoch: 3, Steps: 570 | Train Loss: 0.2685149 Vali Loss: 0.0612395 Test Loss: 0.1667740
Validation loss decreased (0.065319 --> 0.061240).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2239064
	speed: 0.0476s/iter; left time: 456.5434s
	iters: 200, epoch: 4 | loss: 0.2824219
	speed: 0.0155s/iter; left time: 147.4512s
	iters: 300, epoch: 4 | loss: 0.3538493
	speed: 0.0155s/iter; left time: 145.9167s
	iters: 400, epoch: 4 | loss: 0.2288669
	speed: 0.0162s/iter; left time: 150.1215s
	iters: 500, epoch: 4 | loss: 0.3610906
	speed: 0.0178s/iter; left time: 164.0065s
Epoch: 4 cost time: 9.600301027297974
Epoch: 4, Steps: 570 | Train Loss: 0.2505508 Vali Loss: 0.0605412 Test Loss: 0.1656972
Validation loss decreased (0.061240 --> 0.060541).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2240075
	speed: 0.0528s/iter; left time: 476.6724s
	iters: 200, epoch: 5 | loss: 0.2118904
	speed: 0.0178s/iter; left time: 158.5509s
	iters: 300, epoch: 5 | loss: 0.2205756
	speed: 0.0178s/iter; left time: 156.5945s
	iters: 400, epoch: 5 | loss: 0.2091028
	speed: 0.0178s/iter; left time: 154.8849s
	iters: 500, epoch: 5 | loss: 0.1949403
	speed: 0.0177s/iter; left time: 152.9924s
Epoch: 5 cost time: 10.436367750167847
Epoch: 5, Steps: 570 | Train Loss: 0.2422824 Vali Loss: 0.0583978 Test Loss: 0.1641003
Validation loss decreased (0.060541 --> 0.058398).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2339019
	speed: 0.0522s/iter; left time: 441.2825s
	iters: 200, epoch: 6 | loss: 0.1755083
	speed: 0.0178s/iter; left time: 148.4457s
	iters: 300, epoch: 6 | loss: 0.1500492
	speed: 0.0178s/iter; left time: 146.7308s
	iters: 400, epoch: 6 | loss: 0.1486233
	speed: 0.0178s/iter; left time: 144.9127s
	iters: 500, epoch: 6 | loss: 0.2213362
	speed: 0.0178s/iter; left time: 143.2092s
Epoch: 6 cost time: 10.446432828903198
Epoch: 6, Steps: 570 | Train Loss: 0.2372961 Vali Loss: 0.0585612 Test Loss: 0.1626155
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3091866
	speed: 0.0504s/iter; left time: 397.4824s
	iters: 200, epoch: 7 | loss: 0.2188091
	speed: 0.0167s/iter; left time: 130.1581s
	iters: 300, epoch: 7 | loss: 0.1809100
	speed: 0.0154s/iter; left time: 118.5125s
	iters: 400, epoch: 7 | loss: 0.2696238
	speed: 0.0154s/iter; left time: 116.9739s
	iters: 500, epoch: 7 | loss: 0.3083701
	speed: 0.0154s/iter; left time: 115.4205s
Epoch: 7 cost time: 9.36635446548462
Epoch: 7, Steps: 570 | Train Loss: 0.2330361 Vali Loss: 0.0587148 Test Loss: 0.1625889
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2236156
	speed: 0.0498s/iter; left time: 363.7860s
	iters: 200, epoch: 8 | loss: 0.2934226
	speed: 0.0177s/iter; left time: 127.9749s
	iters: 300, epoch: 8 | loss: 0.1606408
	speed: 0.0177s/iter; left time: 126.1457s
	iters: 400, epoch: 8 | loss: 0.2432509
	speed: 0.0177s/iter; left time: 124.3595s
	iters: 500, epoch: 8 | loss: 0.1970395
	speed: 0.0177s/iter; left time: 122.5923s
Epoch: 8 cost time: 10.153965711593628
Epoch: 8, Steps: 570 | Train Loss: 0.2315208 Vali Loss: 0.0578444 Test Loss: 0.1620613
Validation loss decreased (0.058398 --> 0.057844).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1934782
	speed: 0.0522s/iter; left time: 351.8914s
	iters: 200, epoch: 9 | loss: 0.2204364
	speed: 0.0178s/iter; left time: 118.2163s
	iters: 300, epoch: 9 | loss: 0.2244284
	speed: 0.0178s/iter; left time: 116.2774s
	iters: 400, epoch: 9 | loss: 0.1628443
	speed: 0.0178s/iter; left time: 114.5288s
	iters: 500, epoch: 9 | loss: 0.2247437
	speed: 0.0178s/iter; left time: 112.7513s
Epoch: 9 cost time: 10.43529987335205
Epoch: 9, Steps: 570 | Train Loss: 0.2303209 Vali Loss: 0.0581975 Test Loss: 0.1621438
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2562991
	speed: 0.0512s/iter; left time: 315.7515s
	iters: 200, epoch: 10 | loss: 0.2500834
	speed: 0.0178s/iter; left time: 108.3417s
	iters: 300, epoch: 10 | loss: 0.2114974
	speed: 0.0178s/iter; left time: 106.5411s
	iters: 400, epoch: 10 | loss: 0.2712291
	speed: 0.0178s/iter; left time: 104.6796s
	iters: 500, epoch: 10 | loss: 0.3080527
	speed: 0.0178s/iter; left time: 102.9163s
Epoch: 10 cost time: 10.456926107406616
Epoch: 10, Steps: 570 | Train Loss: 0.2312544 Vali Loss: 0.0581431 Test Loss: 0.1621729
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2140190
	speed: 0.0511s/iter; left time: 286.0084s
	iters: 200, epoch: 11 | loss: 0.1459406
	speed: 0.0177s/iter; left time: 97.4713s
	iters: 300, epoch: 11 | loss: 0.2325401
	speed: 0.0177s/iter; left time: 95.6786s
	iters: 400, epoch: 11 | loss: 0.2320054
	speed: 0.0177s/iter; left time: 93.9277s
	iters: 500, epoch: 11 | loss: 0.3245713
	speed: 0.0177s/iter; left time: 92.1598s
Epoch: 11 cost time: 10.39211368560791
Epoch: 11, Steps: 570 | Train Loss: 0.2307453 Vali Loss: 0.0582252 Test Loss: 0.1622383
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16231337189674377, mae:0.25703009963035583
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1897985
	speed: 0.0328s/iter; left time: 371.1689s
	iters: 200, epoch: 1 | loss: 0.2887057
	speed: 0.0209s/iter; left time: 234.1929s
	iters: 300, epoch: 1 | loss: 0.4413811
	speed: 0.0209s/iter; left time: 232.5541s
	iters: 400, epoch: 1 | loss: 0.2888007
	speed: 0.0210s/iter; left time: 231.0601s
	iters: 500, epoch: 1 | loss: 0.2090833
	speed: 0.0210s/iter; left time: 228.5008s
Epoch: 1 cost time: 13.18981385231018
Epoch: 1, Steps: 570 | Train Loss: 0.2503787 Vali Loss: 0.0560616 Test Loss: 0.1611836
Validation loss decreased (inf --> 0.056062).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3634200
	speed: 0.0581s/iter; left time: 623.8268s
	iters: 200, epoch: 2 | loss: 0.2976031
	speed: 0.0187s/iter; left time: 198.4495s
	iters: 300, epoch: 2 | loss: 0.2022951
	speed: 0.0187s/iter; left time: 196.5146s
	iters: 400, epoch: 2 | loss: 0.2796339
	speed: 0.0187s/iter; left time: 194.6377s
	iters: 500, epoch: 2 | loss: 0.2375820
	speed: 0.0187s/iter; left time: 192.7336s
Epoch: 2 cost time: 10.943004608154297
Epoch: 2, Steps: 570 | Train Loss: 0.2878703 Vali Loss: 0.0673999 Test Loss: 0.1945417
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1964109
	speed: 0.0572s/iter; left time: 581.6766s
	iters: 200, epoch: 3 | loss: 0.2394517
	speed: 0.0188s/iter; left time: 189.0653s
	iters: 300, epoch: 3 | loss: 0.2163593
	speed: 0.0188s/iter; left time: 187.0157s
	iters: 400, epoch: 3 | loss: 0.1630104
	speed: 0.0188s/iter; left time: 185.0011s
	iters: 500, epoch: 3 | loss: 0.2052260
	speed: 0.0188s/iter; left time: 183.3919s
Epoch: 3 cost time: 11.016671895980835
Epoch: 3, Steps: 570 | Train Loss: 0.2572694 Vali Loss: 0.0582203 Test Loss: 0.1707456
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2638965
	speed: 0.0558s/iter; left time: 535.3289s
	iters: 200, epoch: 4 | loss: 0.2769852
	speed: 0.0188s/iter; left time: 178.7631s
	iters: 300, epoch: 4 | loss: 0.2741510
	speed: 0.0188s/iter; left time: 176.8290s
	iters: 400, epoch: 4 | loss: 0.1484838
	speed: 0.0188s/iter; left time: 174.8902s
	iters: 500, epoch: 4 | loss: 0.2438200
	speed: 0.0189s/iter; left time: 173.2674s
Epoch: 4 cost time: 11.037014722824097
Epoch: 4, Steps: 570 | Train Loss: 0.2353540 Vali Loss: 0.0568876 Test Loss: 0.1671759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16143308579921722, mae:0.261800080537796
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4577753
	speed: 0.0324s/iter; left time: 366.3505s
	iters: 200, epoch: 1 | loss: 0.1889921
	speed: 0.0205s/iter; left time: 229.1178s
	iters: 300, epoch: 1 | loss: 0.1929015
	speed: 0.0204s/iter; left time: 226.9439s
	iters: 400, epoch: 1 | loss: 0.1672915
	speed: 0.0204s/iter; left time: 224.6368s
	iters: 500, epoch: 1 | loss: 0.3148077
	speed: 0.0205s/iter; left time: 223.6794s
Epoch: 1 cost time: 12.912228107452393
Epoch: 1, Steps: 570 | Train Loss: 0.2371157 Vali Loss: 0.0581155 Test Loss: 0.1931640
Validation loss decreased (inf --> 0.058115).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1904044
	speed: 0.0598s/iter; left time: 641.4927s
	iters: 200, epoch: 2 | loss: 0.3319464
	speed: 0.0205s/iter; left time: 217.7749s
	iters: 300, epoch: 2 | loss: 0.5493437
	speed: 0.0205s/iter; left time: 215.7289s
	iters: 400, epoch: 2 | loss: 0.2594875
	speed: 0.0205s/iter; left time: 213.7115s
	iters: 500, epoch: 2 | loss: 0.1825258
	speed: 0.0205s/iter; left time: 211.8898s
Epoch: 2 cost time: 11.998517990112305
Epoch: 2, Steps: 570 | Train Loss: 0.2861869 Vali Loss: 0.0610071 Test Loss: 0.1707035
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1784080
	speed: 0.0601s/iter; left time: 610.9059s
	iters: 200, epoch: 3 | loss: 0.1907181
	speed: 0.0211s/iter; left time: 212.1749s
	iters: 300, epoch: 3 | loss: 0.2150978
	speed: 0.0211s/iter; left time: 209.7690s
	iters: 400, epoch: 3 | loss: 0.1987578
	speed: 0.0211s/iter; left time: 207.5847s
	iters: 500, epoch: 3 | loss: 0.1934327
	speed: 0.0211s/iter; left time: 205.5198s
Epoch: 3 cost time: 12.324219703674316
Epoch: 3, Steps: 570 | Train Loss: 0.2373628 Vali Loss: 0.0554212 Test Loss: 0.1654473
Validation loss decreased (0.058115 --> 0.055421).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2528630
	speed: 0.0614s/iter; left time: 588.9901s
	iters: 200, epoch: 4 | loss: 0.1235906
	speed: 0.0210s/iter; left time: 199.4112s
	iters: 300, epoch: 4 | loss: 0.2539161
	speed: 0.0210s/iter; left time: 197.3897s
	iters: 400, epoch: 4 | loss: 0.1838807
	speed: 0.0210s/iter; left time: 195.4634s
	iters: 500, epoch: 4 | loss: 0.1295810
	speed: 0.0210s/iter; left time: 193.0568s
Epoch: 4 cost time: 12.312519073486328
Epoch: 4, Steps: 570 | Train Loss: 0.2169620 Vali Loss: 0.0554162 Test Loss: 0.1523077
Validation loss decreased (0.055421 --> 0.055416).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1547552
	speed: 0.0612s/iter; left time: 552.2792s
	iters: 200, epoch: 5 | loss: 0.2026396
	speed: 0.0210s/iter; left time: 187.6662s
	iters: 300, epoch: 5 | loss: 0.1919032
	speed: 0.0210s/iter; left time: 185.2839s
	iters: 400, epoch: 5 | loss: 0.2043490
	speed: 0.0210s/iter; left time: 182.7867s
	iters: 500, epoch: 5 | loss: 0.1990732
	speed: 0.0210s/iter; left time: 180.7783s
Epoch: 5 cost time: 12.266993761062622
Epoch: 5, Steps: 570 | Train Loss: 0.2062961 Vali Loss: 0.0577610 Test Loss: 0.1532470
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2716459
	speed: 0.0598s/iter; left time: 505.2795s
	iters: 200, epoch: 6 | loss: 0.1615687
	speed: 0.0210s/iter; left time: 175.0961s
	iters: 300, epoch: 6 | loss: 0.2168526
	speed: 0.0210s/iter; left time: 173.0481s
	iters: 400, epoch: 6 | loss: 0.1593640
	speed: 0.0209s/iter; left time: 170.7335s
	iters: 500, epoch: 6 | loss: 0.1377405
	speed: 0.0209s/iter; left time: 168.5486s
Epoch: 6 cost time: 12.224653720855713
Epoch: 6, Steps: 570 | Train Loss: 0.2025473 Vali Loss: 0.0542774 Test Loss: 0.1501711
Validation loss decreased (0.055416 --> 0.054277).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1793858
	speed: 0.0609s/iter; left time: 480.0012s
	iters: 200, epoch: 7 | loss: 0.3043558
	speed: 0.0210s/iter; left time: 163.7271s
	iters: 300, epoch: 7 | loss: 0.1265976
	speed: 0.0210s/iter; left time: 161.2509s
	iters: 400, epoch: 7 | loss: 0.2142242
	speed: 0.0210s/iter; left time: 159.0914s
	iters: 500, epoch: 7 | loss: 0.1831573
	speed: 0.0210s/iter; left time: 157.0073s
Epoch: 7 cost time: 12.294317722320557
Epoch: 7, Steps: 570 | Train Loss: 0.1984276 Vali Loss: 0.0547133 Test Loss: 0.1501346
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1364244
	speed: 0.0593s/iter; left time: 433.4725s
	iters: 200, epoch: 8 | loss: 0.1428776
	speed: 0.0210s/iter; left time: 151.1998s
	iters: 300, epoch: 8 | loss: 0.2285191
	speed: 0.0210s/iter; left time: 149.1103s
	iters: 400, epoch: 8 | loss: 0.2212646
	speed: 0.0210s/iter; left time: 147.0149s
	iters: 500, epoch: 8 | loss: 0.2518257
	speed: 0.0210s/iter; left time: 144.9128s
Epoch: 8 cost time: 12.23184323310852
Epoch: 8, Steps: 570 | Train Loss: 0.1964491 Vali Loss: 0.0545418 Test Loss: 0.1491979
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1176716
	speed: 0.0608s/iter; left time: 409.7838s
	iters: 200, epoch: 9 | loss: 0.2062732
	speed: 0.0210s/iter; left time: 139.2764s
	iters: 300, epoch: 9 | loss: 0.2390584
	speed: 0.0210s/iter; left time: 137.0546s
	iters: 400, epoch: 9 | loss: 0.1789776
	speed: 0.0210s/iter; left time: 135.0752s
	iters: 500, epoch: 9 | loss: 0.1672723
	speed: 0.0209s/iter; left time: 132.6759s
Epoch: 9 cost time: 12.24669337272644
Epoch: 9, Steps: 570 | Train Loss: 0.1971224 Vali Loss: 0.0542637 Test Loss: 0.1488945
Validation loss decreased (0.054277 --> 0.054264).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1279312
	speed: 0.0647s/iter; left time: 398.9706s
	iters: 200, epoch: 10 | loss: 0.1533802
	speed: 0.0211s/iter; left time: 128.1492s
	iters: 300, epoch: 10 | loss: 0.2471815
	speed: 0.0211s/iter; left time: 125.7132s
	iters: 400, epoch: 10 | loss: 0.2247956
	speed: 0.0211s/iter; left time: 123.8059s
	iters: 500, epoch: 10 | loss: 0.2233932
	speed: 0.0193s/iter; left time: 111.2872s
Epoch: 10 cost time: 12.051947116851807
Epoch: 10, Steps: 570 | Train Loss: 0.1957112 Vali Loss: 0.0542442 Test Loss: 0.1490749
Validation loss decreased (0.054264 --> 0.054244).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2585023
	speed: 0.0593s/iter; left time: 332.0056s
	iters: 200, epoch: 11 | loss: 0.2559385
	speed: 0.0210s/iter; left time: 115.5468s
	iters: 300, epoch: 11 | loss: 0.1487543
	speed: 0.0210s/iter; left time: 113.5195s
	iters: 400, epoch: 11 | loss: 0.2045055
	speed: 0.0210s/iter; left time: 111.2546s
	iters: 500, epoch: 11 | loss: 0.1912563
	speed: 0.0210s/iter; left time: 109.0162s
Epoch: 11 cost time: 12.263322114944458
Epoch: 11, Steps: 570 | Train Loss: 0.1963690 Vali Loss: 0.0544495 Test Loss: 0.1492017
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2479386
	speed: 0.0594s/iter; left time: 298.7573s
	iters: 200, epoch: 12 | loss: 0.2418561
	speed: 0.0209s/iter; left time: 103.2362s
	iters: 300, epoch: 12 | loss: 0.1374248
	speed: 0.0209s/iter; left time: 101.1149s
	iters: 400, epoch: 12 | loss: 0.1622343
	speed: 0.0209s/iter; left time: 98.9449s
	iters: 500, epoch: 12 | loss: 0.1916432
	speed: 0.0209s/iter; left time: 96.8776s
Epoch: 12 cost time: 12.218897819519043
Epoch: 12, Steps: 570 | Train Loss: 0.1951744 Vali Loss: 0.0542789 Test Loss: 0.1491429
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1677894
	speed: 0.0618s/iter; left time: 275.6192s
	iters: 200, epoch: 13 | loss: 0.2673208
	speed: 0.0210s/iter; left time: 91.6471s
	iters: 300, epoch: 13 | loss: 0.1751967
	speed: 0.0210s/iter; left time: 89.4249s
	iters: 400, epoch: 13 | loss: 0.2055026
	speed: 0.0210s/iter; left time: 87.4141s
	iters: 500, epoch: 13 | loss: 0.2717972
	speed: 0.0210s/iter; left time: 85.3076s
Epoch: 13 cost time: 12.30660343170166
Epoch: 13, Steps: 570 | Train Loss: 0.1961132 Vali Loss: 0.0543760 Test Loss: 0.1491305
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14925047755241394, mae:0.24429486691951752
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3445646
	speed: 0.0327s/iter; left time: 370.0454s
	iters: 200, epoch: 1 | loss: 0.1877764
	speed: 0.0206s/iter; left time: 230.7582s
	iters: 300, epoch: 1 | loss: 0.3729849
	speed: 0.0206s/iter; left time: 228.5416s
	iters: 400, epoch: 1 | loss: 0.3171844
	speed: 0.0206s/iter; left time: 226.2911s
	iters: 500, epoch: 1 | loss: 0.3730814
	speed: 0.0206s/iter; left time: 224.9581s
Epoch: 1 cost time: 13.010758876800537
Epoch: 1, Steps: 570 | Train Loss: 0.2813609 Vali Loss: 0.0633417 Test Loss: 0.1786923
Validation loss decreased (inf --> 0.063342).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3185824
	speed: 0.0596s/iter; left time: 639.2799s
	iters: 200, epoch: 2 | loss: 0.3732510
	speed: 0.0184s/iter; left time: 195.4386s
	iters: 300, epoch: 2 | loss: 0.4587632
	speed: 0.0184s/iter; left time: 193.4643s
	iters: 400, epoch: 2 | loss: 0.2056504
	speed: 0.0183s/iter; left time: 191.3464s
	iters: 500, epoch: 2 | loss: 0.1887688
	speed: 0.0184s/iter; left time: 189.9993s
Epoch: 2 cost time: 10.775303602218628
Epoch: 2, Steps: 570 | Train Loss: 0.2697050 Vali Loss: 0.0622225 Test Loss: 0.1683851
Validation loss decreased (0.063342 --> 0.062223).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1565359
	speed: 0.0563s/iter; left time: 572.5641s
	iters: 200, epoch: 3 | loss: 0.2706599
	speed: 0.0183s/iter; left time: 184.2294s
	iters: 300, epoch: 3 | loss: 0.2815258
	speed: 0.0183s/iter; left time: 182.6117s
	iters: 400, epoch: 3 | loss: 0.3146517
	speed: 0.0183s/iter; left time: 180.5477s
	iters: 500, epoch: 3 | loss: 0.2551386
	speed: 0.0183s/iter; left time: 178.7122s
Epoch: 3 cost time: 10.730594873428345
Epoch: 3, Steps: 570 | Train Loss: 0.2377717 Vali Loss: 0.0598904 Test Loss: 0.1628170
Validation loss decreased (0.062223 --> 0.059890).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2135967
	speed: 0.0556s/iter; left time: 533.3106s
	iters: 200, epoch: 4 | loss: 0.2030511
	speed: 0.0212s/iter; left time: 201.2583s
	iters: 300, epoch: 4 | loss: 0.1808579
	speed: 0.0212s/iter; left time: 198.9006s
	iters: 400, epoch: 4 | loss: 0.2235925
	speed: 0.0212s/iter; left time: 196.8083s
	iters: 500, epoch: 4 | loss: 0.1414864
	speed: 0.0212s/iter; left time: 194.4926s
Epoch: 4 cost time: 12.093401670455933
Epoch: 4, Steps: 570 | Train Loss: 0.2207926 Vali Loss: 0.0544014 Test Loss: 0.1543365
Validation loss decreased (0.059890 --> 0.054401).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1340903
	speed: 0.0614s/iter; left time: 553.8832s
	iters: 200, epoch: 5 | loss: 0.2077597
	speed: 0.0212s/iter; left time: 188.7091s
	iters: 300, epoch: 5 | loss: 0.1357080
	speed: 0.0211s/iter; left time: 186.1102s
	iters: 400, epoch: 5 | loss: 0.1882963
	speed: 0.0211s/iter; left time: 183.9317s
	iters: 500, epoch: 5 | loss: 0.1163111
	speed: 0.0211s/iter; left time: 182.2118s
Epoch: 5 cost time: 12.378915309906006
Epoch: 5, Steps: 570 | Train Loss: 0.2083121 Vali Loss: 0.0520057 Test Loss: 0.1467012
Validation loss decreased (0.054401 --> 0.052006).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2263478
	speed: 0.0610s/iter; left time: 515.2119s
	iters: 200, epoch: 6 | loss: 0.1294562
	speed: 0.0196s/iter; left time: 163.2677s
	iters: 300, epoch: 6 | loss: 0.4127450
	speed: 0.0184s/iter; left time: 151.4877s
	iters: 400, epoch: 6 | loss: 0.1523789
	speed: 0.0184s/iter; left time: 149.7022s
	iters: 500, epoch: 6 | loss: 0.2137214
	speed: 0.0183s/iter; left time: 147.6999s
Epoch: 6 cost time: 11.169806718826294
Epoch: 6, Steps: 570 | Train Loss: 0.1999501 Vali Loss: 0.0507813 Test Loss: 0.1440697
Validation loss decreased (0.052006 --> 0.050781).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1522244
	speed: 0.0593s/iter; left time: 467.1045s
	iters: 200, epoch: 7 | loss: 0.1638225
	speed: 0.0211s/iter; left time: 164.3731s
	iters: 300, epoch: 7 | loss: 0.2337635
	speed: 0.0211s/iter; left time: 162.0424s
	iters: 400, epoch: 7 | loss: 0.1708054
	speed: 0.0211s/iter; left time: 160.3249s
	iters: 500, epoch: 7 | loss: 0.1548209
	speed: 0.0211s/iter; left time: 157.9601s
Epoch: 7 cost time: 12.357621669769287
Epoch: 7, Steps: 570 | Train Loss: 0.1966750 Vali Loss: 0.0515746 Test Loss: 0.1437420
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1198446
	speed: 0.0617s/iter; left time: 450.8157s
	iters: 200, epoch: 8 | loss: 0.1399414
	speed: 0.0211s/iter; left time: 151.9004s
	iters: 300, epoch: 8 | loss: 0.1922701
	speed: 0.0192s/iter; left time: 136.5666s
	iters: 400, epoch: 8 | loss: 0.2479041
	speed: 0.0183s/iter; left time: 128.1241s
	iters: 500, epoch: 8 | loss: 0.1562815
	speed: 0.0183s/iter; left time: 126.5396s
Epoch: 8 cost time: 11.400978326797485
Epoch: 8, Steps: 570 | Train Loss: 0.1939699 Vali Loss: 0.0508912 Test Loss: 0.1437241
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2116522
	speed: 0.0577s/iter; left time: 389.0061s
	iters: 200, epoch: 9 | loss: 0.2552299
	speed: 0.0183s/iter; left time: 121.3209s
	iters: 300, epoch: 9 | loss: 0.2623025
	speed: 0.0183s/iter; left time: 119.5833s
	iters: 400, epoch: 9 | loss: 0.3542818
	speed: 0.0182s/iter; left time: 117.5277s
	iters: 500, epoch: 9 | loss: 0.1560402
	speed: 0.0190s/iter; left time: 120.3370s
Epoch: 9 cost time: 10.987032890319824
Epoch: 9, Steps: 570 | Train Loss: 0.1923798 Vali Loss: 0.0505789 Test Loss: 0.1431689
Validation loss decreased (0.050781 --> 0.050579).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1748650
	speed: 0.0604s/iter; left time: 372.9998s
	iters: 200, epoch: 10 | loss: 0.1834387
	speed: 0.0212s/iter; left time: 128.8555s
	iters: 300, epoch: 10 | loss: 0.2298550
	speed: 0.0212s/iter; left time: 126.6627s
	iters: 400, epoch: 10 | loss: 0.2008950
	speed: 0.0212s/iter; left time: 124.5598s
	iters: 500, epoch: 10 | loss: 0.2051430
	speed: 0.0212s/iter; left time: 122.6309s
Epoch: 10 cost time: 12.411158084869385
Epoch: 10, Steps: 570 | Train Loss: 0.1923975 Vali Loss: 0.0504339 Test Loss: 0.1432166
Validation loss decreased (0.050579 --> 0.050434).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1846491
	speed: 0.0631s/iter; left time: 353.2344s
	iters: 200, epoch: 11 | loss: 0.2004280
	speed: 0.0206s/iter; left time: 113.3789s
	iters: 300, epoch: 11 | loss: 0.1794293
	speed: 0.0206s/iter; left time: 111.3012s
	iters: 400, epoch: 11 | loss: 0.1951572
	speed: 0.0207s/iter; left time: 109.5230s
	iters: 500, epoch: 11 | loss: 0.1286800
	speed: 0.0207s/iter; left time: 107.5376s
Epoch: 11 cost time: 11.933206796646118
Epoch: 11, Steps: 570 | Train Loss: 0.1942597 Vali Loss: 0.0503781 Test Loss: 0.1431744
Validation loss decreased (0.050434 --> 0.050378).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1566080
	speed: 0.0574s/iter; left time: 288.7348s
	iters: 200, epoch: 12 | loss: 0.2663315
	speed: 0.0183s/iter; left time: 90.1493s
	iters: 300, epoch: 12 | loss: 0.1894167
	speed: 0.0183s/iter; left time: 88.6208s
	iters: 400, epoch: 12 | loss: 0.1221318
	speed: 0.0212s/iter; left time: 100.2801s
	iters: 500, epoch: 12 | loss: 0.2709911
	speed: 0.0212s/iter; left time: 98.2372s
Epoch: 12 cost time: 11.524925947189331
Epoch: 12, Steps: 570 | Train Loss: 0.1917216 Vali Loss: 0.0504367 Test Loss: 0.1431719
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1706440
	speed: 0.0599s/iter; left time: 267.1146s
	iters: 200, epoch: 13 | loss: 0.1085223
	speed: 0.0211s/iter; left time: 92.1074s
	iters: 300, epoch: 13 | loss: 0.1748090
	speed: 0.0211s/iter; left time: 89.9501s
	iters: 400, epoch: 13 | loss: 0.1320335
	speed: 0.0211s/iter; left time: 87.9002s
	iters: 500, epoch: 13 | loss: 0.1230229
	speed: 0.0212s/iter; left time: 85.9271s
Epoch: 13 cost time: 12.327481508255005
Epoch: 13, Steps: 570 | Train Loss: 0.1911351 Vali Loss: 0.0506621 Test Loss: 0.1431873
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1293672
	speed: 0.0608s/iter; left time: 236.5227s
	iters: 200, epoch: 14 | loss: 0.1320582
	speed: 0.0212s/iter; left time: 80.3628s
	iters: 300, epoch: 14 | loss: 0.1745252
	speed: 0.0212s/iter; left time: 78.2111s
	iters: 400, epoch: 14 | loss: 0.1491092
	speed: 0.0212s/iter; left time: 76.1790s
	iters: 500, epoch: 14 | loss: 0.1423359
	speed: 0.0212s/iter; left time: 74.0141s
Epoch: 14 cost time: 12.367737293243408
Epoch: 14, Steps: 570 | Train Loss: 0.1921796 Vali Loss: 0.0504895 Test Loss: 0.1431945
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14335070550441742, mae:0.24025031924247742
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2392795
	speed: 0.0342s/iter; left time: 385.9590s
	iters: 200, epoch: 1 | loss: 0.3235706
	speed: 0.0220s/iter; left time: 246.4293s
	iters: 300, epoch: 1 | loss: 0.2933561
	speed: 0.0220s/iter; left time: 244.1635s
	iters: 400, epoch: 1 | loss: 0.4406134
	speed: 0.0220s/iter; left time: 241.7903s
	iters: 500, epoch: 1 | loss: 0.4308271
	speed: 0.0220s/iter; left time: 239.9149s
Epoch: 1 cost time: 13.80452275276184
Epoch: 1, Steps: 570 | Train Loss: 0.3484697 Vali Loss: 0.0637454 Test Loss: 0.1881898
Validation loss decreased (inf --> 0.063745).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3287198
	speed: 0.0654s/iter; left time: 701.9004s
	iters: 200, epoch: 2 | loss: 0.2529510
	speed: 0.0222s/iter; left time: 235.4774s
	iters: 300, epoch: 2 | loss: 0.2642837
	speed: 0.0221s/iter; left time: 232.5161s
	iters: 400, epoch: 2 | loss: 0.2760209
	speed: 0.0221s/iter; left time: 230.2935s
	iters: 500, epoch: 2 | loss: 0.2563839
	speed: 0.0221s/iter; left time: 228.0722s
Epoch: 2 cost time: 12.935076713562012
Epoch: 2, Steps: 570 | Train Loss: 0.2911943 Vali Loss: 0.0618177 Test Loss: 0.1784082
Validation loss decreased (0.063745 --> 0.061818).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5450932
	speed: 0.0656s/iter; left time: 666.6968s
	iters: 200, epoch: 3 | loss: 0.2047932
	speed: 0.0221s/iter; left time: 222.0679s
	iters: 300, epoch: 3 | loss: 0.3956991
	speed: 0.0221s/iter; left time: 220.0184s
	iters: 400, epoch: 3 | loss: 0.2368403
	speed: 0.0221s/iter; left time: 217.7204s
	iters: 500, epoch: 3 | loss: 0.2099386
	speed: 0.0221s/iter; left time: 215.5113s
Epoch: 3 cost time: 12.90898585319519
Epoch: 3, Steps: 570 | Train Loss: 0.2846029 Vali Loss: 0.0579255 Test Loss: 0.1641819
Validation loss decreased (0.061818 --> 0.057925).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2046410
	speed: 0.0651s/iter; left time: 624.7047s
	iters: 200, epoch: 4 | loss: 0.2222010
	speed: 0.0220s/iter; left time: 209.2450s
	iters: 300, epoch: 4 | loss: 0.2790974
	speed: 0.0221s/iter; left time: 207.3320s
	iters: 400, epoch: 4 | loss: 0.2107026
	speed: 0.0221s/iter; left time: 204.9920s
	iters: 500, epoch: 4 | loss: 0.3143312
	speed: 0.0221s/iter; left time: 203.1836s
Epoch: 4 cost time: 12.904078483581543
Epoch: 4, Steps: 570 | Train Loss: 0.2583972 Vali Loss: 0.0568851 Test Loss: 0.1662834
Validation loss decreased (0.057925 --> 0.056885).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2783979
	speed: 0.0648s/iter; left time: 584.1163s
	iters: 200, epoch: 5 | loss: 0.2492633
	speed: 0.0221s/iter; left time: 197.3167s
	iters: 300, epoch: 5 | loss: 0.1835204
	speed: 0.0221s/iter; left time: 194.6991s
	iters: 400, epoch: 5 | loss: 0.2364521
	speed: 0.0221s/iter; left time: 192.5366s
	iters: 500, epoch: 5 | loss: 0.2786642
	speed: 0.0221s/iter; left time: 190.3170s
Epoch: 5 cost time: 12.921745777130127
Epoch: 5, Steps: 570 | Train Loss: 0.2471538 Vali Loss: 0.0547942 Test Loss: 0.1584070
Validation loss decreased (0.056885 --> 0.054794).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2043900
	speed: 0.0633s/iter; left time: 534.9719s
	iters: 200, epoch: 6 | loss: 0.3686359
	speed: 0.0221s/iter; left time: 184.5360s
	iters: 300, epoch: 6 | loss: 0.2122341
	speed: 0.0221s/iter; left time: 182.2477s
	iters: 400, epoch: 6 | loss: 0.1944636
	speed: 0.0221s/iter; left time: 180.0200s
	iters: 500, epoch: 6 | loss: 0.3643658
	speed: 0.0221s/iter; left time: 177.8983s
Epoch: 6 cost time: 12.916518688201904
Epoch: 6, Steps: 570 | Train Loss: 0.2404939 Vali Loss: 0.0540997 Test Loss: 0.1588474
Validation loss decreased (0.054794 --> 0.054100).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2972192
	speed: 0.0637s/iter; left time: 501.9093s
	iters: 200, epoch: 7 | loss: 0.1989725
	speed: 0.0221s/iter; left time: 172.1979s
	iters: 300, epoch: 7 | loss: 0.1605517
	speed: 0.0221s/iter; left time: 170.0532s
	iters: 400, epoch: 7 | loss: 0.1990369
	speed: 0.0221s/iter; left time: 167.6656s
	iters: 500, epoch: 7 | loss: 0.1980347
	speed: 0.0222s/iter; left time: 165.7722s
Epoch: 7 cost time: 12.940999507904053
Epoch: 7, Steps: 570 | Train Loss: 0.2361313 Vali Loss: 0.0534070 Test Loss: 0.1574572
Validation loss decreased (0.054100 --> 0.053407).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1609631
	speed: 0.0637s/iter; left time: 465.8280s
	iters: 200, epoch: 8 | loss: 0.6042265
	speed: 0.0221s/iter; left time: 159.4811s
	iters: 300, epoch: 8 | loss: 0.1642970
	speed: 0.0221s/iter; left time: 157.3366s
	iters: 400, epoch: 8 | loss: 0.2039292
	speed: 0.0221s/iter; left time: 154.9695s
	iters: 500, epoch: 8 | loss: 0.2035870
	speed: 0.0221s/iter; left time: 152.6820s
Epoch: 8 cost time: 12.941941499710083
Epoch: 8, Steps: 570 | Train Loss: 0.2348030 Vali Loss: 0.0534884 Test Loss: 0.1569922
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2348224
	speed: 0.0618s/iter; left time: 416.7054s
	iters: 200, epoch: 9 | loss: 0.1998831
	speed: 0.0222s/iter; left time: 147.1069s
	iters: 300, epoch: 9 | loss: 0.3595006
	speed: 0.0221s/iter; left time: 144.6450s
	iters: 400, epoch: 9 | loss: 0.1851474
	speed: 0.0221s/iter; left time: 142.4405s
	iters: 500, epoch: 9 | loss: 0.2093672
	speed: 0.0222s/iter; left time: 140.4762s
Epoch: 9 cost time: 12.896367073059082
Epoch: 9, Steps: 570 | Train Loss: 0.2342727 Vali Loss: 0.0532538 Test Loss: 0.1566123
Validation loss decreased (0.053407 --> 0.053254).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2134637
	speed: 0.0625s/iter; left time: 385.6281s
	iters: 200, epoch: 10 | loss: 0.2708219
	speed: 0.0221s/iter; left time: 133.8729s
	iters: 300, epoch: 10 | loss: 0.2378317
	speed: 0.0220s/iter; left time: 131.6573s
	iters: 400, epoch: 10 | loss: 0.3833191
	speed: 0.0221s/iter; left time: 129.6624s
	iters: 500, epoch: 10 | loss: 0.2913111
	speed: 0.0221s/iter; left time: 127.4175s
Epoch: 10 cost time: 12.85918116569519
Epoch: 10, Steps: 570 | Train Loss: 0.2342428 Vali Loss: 0.0534238 Test Loss: 0.1564279
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1943801
	speed: 0.0648s/iter; left time: 362.8753s
	iters: 200, epoch: 11 | loss: 0.1655978
	speed: 0.0222s/iter; left time: 121.8974s
	iters: 300, epoch: 11 | loss: 0.1294974
	speed: 0.0222s/iter; left time: 119.6503s
	iters: 400, epoch: 11 | loss: 0.2129554
	speed: 0.0221s/iter; left time: 117.3431s
	iters: 500, epoch: 11 | loss: 0.1963433
	speed: 0.0222s/iter; left time: 115.2600s
Epoch: 11 cost time: 12.946214437484741
Epoch: 11, Steps: 570 | Train Loss: 0.2345260 Vali Loss: 0.0532203 Test Loss: 0.1563416
Validation loss decreased (0.053254 --> 0.053220).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2545201
	speed: 0.0634s/iter; left time: 318.7655s
	iters: 200, epoch: 12 | loss: 0.1851709
	speed: 0.0221s/iter; left time: 108.8287s
	iters: 300, epoch: 12 | loss: 0.3137481
	speed: 0.0221s/iter; left time: 106.7310s
	iters: 400, epoch: 12 | loss: 0.1479778
	speed: 0.0221s/iter; left time: 104.3485s
	iters: 500, epoch: 12 | loss: 0.2617011
	speed: 0.0221s/iter; left time: 102.1873s
Epoch: 12 cost time: 12.901498794555664
Epoch: 12, Steps: 570 | Train Loss: 0.2333996 Vali Loss: 0.0531982 Test Loss: 0.1563964
Validation loss decreased (0.053220 --> 0.053198).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3771702
	speed: 0.0641s/iter; left time: 286.1465s
	iters: 200, epoch: 13 | loss: 0.1694183
	speed: 0.0221s/iter; left time: 96.3193s
	iters: 300, epoch: 13 | loss: 0.1437278
	speed: 0.0221s/iter; left time: 94.0685s
	iters: 400, epoch: 13 | loss: 0.2160377
	speed: 0.0221s/iter; left time: 91.8655s
	iters: 500, epoch: 13 | loss: 0.4250709
	speed: 0.0221s/iter; left time: 89.6246s
Epoch: 13 cost time: 12.897320985794067
Epoch: 13, Steps: 570 | Train Loss: 0.2338304 Vali Loss: 0.0532326 Test Loss: 0.1563705
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2406413
	speed: 0.0629s/iter; left time: 244.8650s
	iters: 200, epoch: 14 | loss: 0.3010644
	speed: 0.0221s/iter; left time: 83.6072s
	iters: 300, epoch: 14 | loss: 0.2287150
	speed: 0.0220s/iter; left time: 81.3009s
	iters: 400, epoch: 14 | loss: 0.1924923
	speed: 0.0221s/iter; left time: 79.1847s
	iters: 500, epoch: 14 | loss: 0.1605249
	speed: 0.0221s/iter; left time: 77.0535s
Epoch: 14 cost time: 12.902438879013062
Epoch: 14, Steps: 570 | Train Loss: 0.2321255 Vali Loss: 0.0534521 Test Loss: 0.1563781
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2224185
	speed: 0.0624s/iter; left time: 207.1422s
	iters: 200, epoch: 15 | loss: 0.2126149
	speed: 0.0222s/iter; left time: 71.5026s
	iters: 300, epoch: 15 | loss: 0.1061153
	speed: 0.0222s/iter; left time: 69.1318s
	iters: 400, epoch: 15 | loss: 0.2380839
	speed: 0.0222s/iter; left time: 66.9363s
	iters: 500, epoch: 15 | loss: 0.2103924
	speed: 0.0222s/iter; left time: 64.7959s
Epoch: 15 cost time: 12.917304277420044
Epoch: 15, Steps: 570 | Train Loss: 0.2347845 Vali Loss: 0.0533193 Test Loss: 0.1563731
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1566171944141388, mae:0.2542649507522583
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3377392
	speed: 0.0352s/iter; left time: 397.8634s
	iters: 200, epoch: 1 | loss: 0.1646500
	speed: 0.0232s/iter; left time: 259.6305s
	iters: 300, epoch: 1 | loss: 0.2190873
	speed: 0.0232s/iter; left time: 257.2016s
	iters: 400, epoch: 1 | loss: 0.2957370
	speed: 0.0232s/iter; left time: 255.0003s
	iters: 500, epoch: 1 | loss: 0.2291556
	speed: 0.0232s/iter; left time: 252.4068s
Epoch: 1 cost time: 14.469799757003784
Epoch: 1, Steps: 570 | Train Loss: 0.3399138 Vali Loss: 0.0699984 Test Loss: 0.1897158
Validation loss decreased (inf --> 0.069998).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2779487
	speed: 0.0638s/iter; left time: 684.8520s
	iters: 200, epoch: 2 | loss: 0.2231273
	speed: 0.0213s/iter; left time: 226.0006s
	iters: 300, epoch: 2 | loss: 0.3795634
	speed: 0.0213s/iter; left time: 223.7867s
	iters: 400, epoch: 2 | loss: 0.2643101
	speed: 0.0213s/iter; left time: 221.6896s
	iters: 500, epoch: 2 | loss: 0.2047420
	speed: 0.0213s/iter; left time: 219.5466s
Epoch: 2 cost time: 12.469574689865112
Epoch: 2, Steps: 570 | Train Loss: 0.2844722 Vali Loss: 0.0626669 Test Loss: 0.1898932
Validation loss decreased (0.069998 --> 0.062667).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2739033
	speed: 0.0638s/iter; left time: 648.3477s
	iters: 200, epoch: 3 | loss: 0.2690250
	speed: 0.0214s/iter; left time: 214.9253s
	iters: 300, epoch: 3 | loss: 0.1724478
	speed: 0.0213s/iter; left time: 212.2107s
	iters: 400, epoch: 3 | loss: 0.1621042
	speed: 0.0213s/iter; left time: 210.4041s
	iters: 500, epoch: 3 | loss: 0.2729535
	speed: 0.0213s/iter; left time: 207.9798s
Epoch: 3 cost time: 12.503925085067749
Epoch: 3, Steps: 570 | Train Loss: 0.2619222 Vali Loss: 0.0608310 Test Loss: 0.1616126
Validation loss decreased (0.062667 --> 0.060831).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1626700
	speed: 0.0621s/iter; left time: 595.1566s
	iters: 200, epoch: 4 | loss: 0.2158362
	speed: 0.0213s/iter; left time: 202.3355s
	iters: 300, epoch: 4 | loss: 0.2240596
	speed: 0.0213s/iter; left time: 200.2567s
	iters: 400, epoch: 4 | loss: 0.3337071
	speed: 0.0213s/iter; left time: 198.1321s
	iters: 500, epoch: 4 | loss: 0.1876449
	speed: 0.0213s/iter; left time: 195.8009s
Epoch: 4 cost time: 12.476000785827637
Epoch: 4, Steps: 570 | Train Loss: 0.2398474 Vali Loss: 0.0581919 Test Loss: 0.1548366
Validation loss decreased (0.060831 --> 0.058192).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3035271
	speed: 0.0619s/iter; left time: 558.1060s
	iters: 200, epoch: 5 | loss: 0.1793818
	speed: 0.0214s/iter; left time: 190.8531s
	iters: 300, epoch: 5 | loss: 0.2417612
	speed: 0.0214s/iter; left time: 188.9051s
	iters: 400, epoch: 5 | loss: 0.2484414
	speed: 0.0214s/iter; left time: 186.4470s
	iters: 500, epoch: 5 | loss: 0.1850076
	speed: 0.0214s/iter; left time: 184.3399s
Epoch: 5 cost time: 12.500789880752563
Epoch: 5, Steps: 570 | Train Loss: 0.2259612 Vali Loss: 0.0581790 Test Loss: 0.1517878
Validation loss decreased (0.058192 --> 0.058179).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2080330
	speed: 0.0647s/iter; left time: 546.6759s
	iters: 200, epoch: 6 | loss: 0.3204569
	speed: 0.0213s/iter; left time: 178.0492s
	iters: 300, epoch: 6 | loss: 0.2294517
	speed: 0.0213s/iter; left time: 175.8708s
	iters: 400, epoch: 6 | loss: 0.1415012
	speed: 0.0213s/iter; left time: 173.5542s
	iters: 500, epoch: 6 | loss: 0.1335572
	speed: 0.0213s/iter; left time: 171.3920s
Epoch: 6 cost time: 12.436667442321777
Epoch: 6, Steps: 570 | Train Loss: 0.2220644 Vali Loss: 0.0585967 Test Loss: 0.1529160
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1969465
	speed: 0.0602s/iter; left time: 474.4837s
	iters: 200, epoch: 7 | loss: 0.2675973
	speed: 0.0213s/iter; left time: 165.6491s
	iters: 300, epoch: 7 | loss: 0.2175160
	speed: 0.0213s/iter; left time: 163.4312s
	iters: 400, epoch: 7 | loss: 0.1372379
	speed: 0.0213s/iter; left time: 161.2407s
	iters: 500, epoch: 7 | loss: 0.1875855
	speed: 0.0213s/iter; left time: 159.3479s
Epoch: 7 cost time: 12.456549167633057
Epoch: 7, Steps: 570 | Train Loss: 0.2186270 Vali Loss: 0.0573958 Test Loss: 0.1515518
Validation loss decreased (0.058179 --> 0.057396).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2150478
	speed: 0.0627s/iter; left time: 458.0898s
	iters: 200, epoch: 8 | loss: 0.2058710
	speed: 0.0214s/iter; left time: 154.2618s
	iters: 300, epoch: 8 | loss: 0.2225778
	speed: 0.0222s/iter; left time: 158.1591s
	iters: 400, epoch: 8 | loss: 0.2368623
	speed: 0.0234s/iter; left time: 163.8474s
	iters: 500, epoch: 8 | loss: 0.2915786
	speed: 0.0218s/iter; left time: 150.4513s
Epoch: 8 cost time: 12.8038969039917
Epoch: 8, Steps: 570 | Train Loss: 0.2145763 Vali Loss: 0.0559872 Test Loss: 0.1507481
Validation loss decreased (0.057396 --> 0.055987).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1523317
	speed: 0.0642s/iter; left time: 432.8172s
	iters: 200, epoch: 9 | loss: 0.3080234
	speed: 0.0214s/iter; left time: 141.8015s
	iters: 300, epoch: 9 | loss: 0.1853736
	speed: 0.0213s/iter; left time: 139.5946s
	iters: 400, epoch: 9 | loss: 0.1888307
	speed: 0.0213s/iter; left time: 137.4624s
	iters: 500, epoch: 9 | loss: 0.1443109
	speed: 0.0213s/iter; left time: 135.3236s
Epoch: 9 cost time: 12.511424779891968
Epoch: 9, Steps: 570 | Train Loss: 0.2150063 Vali Loss: 0.0561404 Test Loss: 0.1507259
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1206441
	speed: 0.0623s/iter; left time: 384.4464s
	iters: 200, epoch: 10 | loss: 0.2277396
	speed: 0.0214s/iter; left time: 129.7889s
	iters: 300, epoch: 10 | loss: 0.1638017
	speed: 0.0214s/iter; left time: 127.5904s
	iters: 400, epoch: 10 | loss: 0.2121173
	speed: 0.0214s/iter; left time: 125.4975s
	iters: 500, epoch: 10 | loss: 0.2538242
	speed: 0.0214s/iter; left time: 123.3371s
Epoch: 10 cost time: 12.482203245162964
Epoch: 10, Steps: 570 | Train Loss: 0.2131337 Vali Loss: 0.0561769 Test Loss: 0.1508286
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2837865
	speed: 0.0603s/iter; left time: 337.6466s
	iters: 200, epoch: 11 | loss: 0.2379410
	speed: 0.0213s/iter; left time: 117.2869s
	iters: 300, epoch: 11 | loss: 0.1742121
	speed: 0.0213s/iter; left time: 114.8593s
	iters: 400, epoch: 11 | loss: 0.1710873
	speed: 0.0213s/iter; left time: 112.7079s
	iters: 500, epoch: 11 | loss: 0.2518443
	speed: 0.0213s/iter; left time: 110.7142s
Epoch: 11 cost time: 12.441160440444946
Epoch: 11, Steps: 570 | Train Loss: 0.2131534 Vali Loss: 0.0561333 Test Loss: 0.1507716
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15090881288051605, mae:0.2482869029045105
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3404231
	speed: 0.0319s/iter; left time: 360.3543s
	iters: 200, epoch: 1 | loss: 0.2426745
	speed: 0.0201s/iter; left time: 225.5962s
	iters: 300, epoch: 1 | loss: 0.4168512
	speed: 0.0202s/iter; left time: 223.7566s
	iters: 400, epoch: 1 | loss: 0.3796895
	speed: 0.0201s/iter; left time: 221.6380s
	iters: 500, epoch: 1 | loss: 0.2751806
	speed: 0.0201s/iter; left time: 219.6221s
Epoch: 1 cost time: 12.714741945266724
Epoch: 1, Steps: 570 | Train Loss: 0.3250057 Vali Loss: 0.0661804 Test Loss: 0.1876831
Validation loss decreased (inf --> 0.066180).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1786113
	speed: 0.0617s/iter; left time: 661.8826s
	iters: 200, epoch: 2 | loss: 0.5230356
	speed: 0.0221s/iter; left time: 234.7253s
	iters: 300, epoch: 2 | loss: 0.3196713
	speed: 0.0206s/iter; left time: 216.5512s
	iters: 400, epoch: 2 | loss: 0.1660084
	speed: 0.0223s/iter; left time: 232.1341s
	iters: 500, epoch: 2 | loss: 0.1820250
	speed: 0.0223s/iter; left time: 229.9416s
Epoch: 2 cost time: 12.815780401229858
Epoch: 2, Steps: 570 | Train Loss: 0.2875961 Vali Loss: 0.0598336 Test Loss: 0.1854444
Validation loss decreased (0.066180 --> 0.059834).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1814147
	speed: 0.0634s/iter; left time: 643.8120s
	iters: 200, epoch: 3 | loss: 0.1833535
	speed: 0.0202s/iter; left time: 203.1545s
	iters: 300, epoch: 3 | loss: 0.2722208
	speed: 0.0202s/iter; left time: 201.1450s
	iters: 400, epoch: 3 | loss: 0.2516907
	speed: 0.0202s/iter; left time: 198.8643s
	iters: 500, epoch: 3 | loss: 0.2900542
	speed: 0.0202s/iter; left time: 196.9889s
Epoch: 3 cost time: 11.800395011901855
Epoch: 3, Steps: 570 | Train Loss: 0.2670503 Vali Loss: 0.0646542 Test Loss: 0.1743281
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1391644
	speed: 0.0583s/iter; left time: 559.3144s
	iters: 200, epoch: 4 | loss: 0.4543982
	speed: 0.0202s/iter; left time: 191.6981s
	iters: 300, epoch: 4 | loss: 0.1633909
	speed: 0.0202s/iter; left time: 189.4333s
	iters: 400, epoch: 4 | loss: 0.2394994
	speed: 0.0202s/iter; left time: 187.5083s
	iters: 500, epoch: 4 | loss: 0.2080919
	speed: 0.0202s/iter; left time: 185.4172s
Epoch: 4 cost time: 11.792239904403687
Epoch: 4, Steps: 570 | Train Loss: 0.2490871 Vali Loss: 0.0620873 Test Loss: 0.1656219
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2104890
	speed: 0.0608s/iter; left time: 548.7528s
	iters: 200, epoch: 5 | loss: 0.4366803
	speed: 0.0202s/iter; left time: 180.6438s
	iters: 300, epoch: 5 | loss: 0.2191622
	speed: 0.0202s/iter; left time: 178.2018s
	iters: 400, epoch: 5 | loss: 0.2156383
	speed: 0.0202s/iter; left time: 176.3327s
	iters: 500, epoch: 5 | loss: 0.2265786
	speed: 0.0202s/iter; left time: 174.3555s
Epoch: 5 cost time: 11.826763391494751
Epoch: 5, Steps: 570 | Train Loss: 0.2388819 Vali Loss: 0.0566011 Test Loss: 0.1586045
Validation loss decreased (0.059834 --> 0.056601).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2559460
	speed: 0.0599s/iter; left time: 506.2979s
	iters: 200, epoch: 6 | loss: 0.2333039
	speed: 0.0202s/iter; left time: 168.3319s
	iters: 300, epoch: 6 | loss: 0.2261849
	speed: 0.0202s/iter; left time: 166.3882s
	iters: 400, epoch: 6 | loss: 0.1795142
	speed: 0.0202s/iter; left time: 164.2468s
	iters: 500, epoch: 6 | loss: 0.3686235
	speed: 0.0201s/iter; left time: 162.1186s
Epoch: 6 cost time: 11.77818775177002
Epoch: 6, Steps: 570 | Train Loss: 0.2322234 Vali Loss: 0.0568356 Test Loss: 0.1558356
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2439669
	speed: 0.0587s/iter; left time: 462.3218s
	iters: 200, epoch: 7 | loss: 0.2223335
	speed: 0.0202s/iter; left time: 156.8173s
	iters: 300, epoch: 7 | loss: 0.2759081
	speed: 0.0202s/iter; left time: 154.8007s
	iters: 400, epoch: 7 | loss: 0.4412869
	speed: 0.0202s/iter; left time: 152.8559s
	iters: 500, epoch: 7 | loss: 0.1374561
	speed: 0.0202s/iter; left time: 151.0141s
Epoch: 7 cost time: 11.787142038345337
Epoch: 7, Steps: 570 | Train Loss: 0.2276247 Vali Loss: 0.0568543 Test Loss: 0.1559284
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2687363
	speed: 0.0589s/iter; left time: 430.5944s
	iters: 200, epoch: 8 | loss: 0.3044820
	speed: 0.0201s/iter; left time: 145.0846s
	iters: 300, epoch: 8 | loss: 0.2953758
	speed: 0.0201s/iter; left time: 142.6401s
	iters: 400, epoch: 8 | loss: 0.1874395
	speed: 0.0201s/iter; left time: 140.9104s
	iters: 500, epoch: 8 | loss: 0.2586952
	speed: 0.0201s/iter; left time: 138.8563s
Epoch: 8 cost time: 11.70957899093628
Epoch: 8, Steps: 570 | Train Loss: 0.2268142 Vali Loss: 0.0565078 Test Loss: 0.1549985
Validation loss decreased (0.056601 --> 0.056508).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2243491
	speed: 0.0616s/iter; left time: 415.4247s
	iters: 200, epoch: 9 | loss: 0.1885431
	speed: 0.0202s/iter; left time: 134.3113s
	iters: 300, epoch: 9 | loss: 0.2734574
	speed: 0.0202s/iter; left time: 132.0640s
	iters: 400, epoch: 9 | loss: 0.1793066
	speed: 0.0202s/iter; left time: 130.1710s
	iters: 500, epoch: 9 | loss: 0.1427067
	speed: 0.0202s/iter; left time: 127.7789s
Epoch: 9 cost time: 11.831654071807861
Epoch: 9, Steps: 570 | Train Loss: 0.2260832 Vali Loss: 0.0563967 Test Loss: 0.1547564
Validation loss decreased (0.056508 --> 0.056397).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2403950
	speed: 0.0596s/iter; left time: 367.8769s
	iters: 200, epoch: 10 | loss: 0.1651448
	speed: 0.0204s/iter; left time: 123.6051s
	iters: 300, epoch: 10 | loss: 0.2896049
	speed: 0.0204s/iter; left time: 121.5125s
	iters: 400, epoch: 10 | loss: 0.3092924
	speed: 0.0204s/iter; left time: 119.6092s
	iters: 500, epoch: 10 | loss: 0.2361620
	speed: 0.0203s/iter; left time: 117.3936s
Epoch: 10 cost time: 11.909939050674438
Epoch: 10, Steps: 570 | Train Loss: 0.2255608 Vali Loss: 0.0564119 Test Loss: 0.1546019
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2059657
	speed: 0.0616s/iter; left time: 344.9056s
	iters: 200, epoch: 11 | loss: 0.1982250
	speed: 0.0202s/iter; left time: 110.9073s
	iters: 300, epoch: 11 | loss: 0.1643462
	speed: 0.0201s/iter; left time: 108.7908s
	iters: 400, epoch: 11 | loss: 0.2687558
	speed: 0.0201s/iter; left time: 106.7675s
	iters: 500, epoch: 11 | loss: 0.1734656
	speed: 0.0201s/iter; left time: 104.7518s
Epoch: 11 cost time: 11.746526718139648
Epoch: 11, Steps: 570 | Train Loss: 0.2242707 Vali Loss: 0.0564297 Test Loss: 0.1546341
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2062238
	speed: 0.0606s/iter; left time: 305.1180s
	iters: 200, epoch: 12 | loss: 0.1974917
	speed: 0.0223s/iter; left time: 110.1033s
	iters: 300, epoch: 12 | loss: 0.3693649
	speed: 0.0223s/iter; left time: 107.6365s
	iters: 400, epoch: 12 | loss: 0.2459300
	speed: 0.0223s/iter; left time: 105.3821s
	iters: 500, epoch: 12 | loss: 0.3968561
	speed: 0.0223s/iter; left time: 103.4442s
Epoch: 12 cost time: 13.001673936843872
Epoch: 12, Steps: 570 | Train Loss: 0.2242734 Vali Loss: 0.0563085 Test Loss: 0.1546287
Validation loss decreased (0.056397 --> 0.056308).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2222096
	speed: 0.0620s/iter; left time: 276.5809s
	iters: 200, epoch: 13 | loss: 0.1883194
	speed: 0.0201s/iter; left time: 87.7128s
	iters: 300, epoch: 13 | loss: 0.2055316
	speed: 0.0201s/iter; left time: 85.5570s
	iters: 400, epoch: 13 | loss: 0.1621581
	speed: 0.0201s/iter; left time: 83.5888s
	iters: 500, epoch: 13 | loss: 0.3007304
	speed: 0.0201s/iter; left time: 81.5378s
Epoch: 13 cost time: 11.771286010742188
Epoch: 13, Steps: 570 | Train Loss: 0.2250128 Vali Loss: 0.0565566 Test Loss: 0.1546288
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2919002
	speed: 0.0618s/iter; left time: 240.4059s
	iters: 200, epoch: 14 | loss: 0.2277680
	speed: 0.0202s/iter; left time: 76.5152s
	iters: 300, epoch: 14 | loss: 0.2307416
	speed: 0.0202s/iter; left time: 74.4955s
	iters: 400, epoch: 14 | loss: 0.1529334
	speed: 0.0202s/iter; left time: 72.4418s
	iters: 500, epoch: 14 | loss: 0.1951609
	speed: 0.0202s/iter; left time: 70.3940s
Epoch: 14 cost time: 11.785974502563477
Epoch: 14, Steps: 570 | Train Loss: 0.2229430 Vali Loss: 0.0564357 Test Loss: 0.1546331
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1179616
	speed: 0.0586s/iter; left time: 194.5586s
	iters: 200, epoch: 15 | loss: 0.2970698
	speed: 0.0202s/iter; left time: 65.0475s
	iters: 300, epoch: 15 | loss: 0.2058809
	speed: 0.0202s/iter; left time: 63.0737s
	iters: 400, epoch: 15 | loss: 0.2033745
	speed: 0.0202s/iter; left time: 61.0155s
	iters: 500, epoch: 15 | loss: 0.2084622
	speed: 0.0202s/iter; left time: 59.0030s
Epoch: 15 cost time: 11.788908004760742
Epoch: 15, Steps: 570 | Train Loss: 0.2243458 Vali Loss: 0.0565327 Test Loss: 0.1546283
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15482033789157867, mae:0.25201061367988586
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2117237
	speed: 0.0223s/iter; left time: 251.5261s
	iters: 200, epoch: 1 | loss: 0.1962214
	speed: 0.0106s/iter; left time: 118.2162s
	iters: 300, epoch: 1 | loss: 0.2084974
	speed: 0.0106s/iter; left time: 117.3029s
	iters: 400, epoch: 1 | loss: 0.2296560
	speed: 0.0106s/iter; left time: 116.0777s
	iters: 500, epoch: 1 | loss: 0.2272920
	speed: 0.0106s/iter; left time: 115.1762s
Epoch: 1 cost time: 7.239390850067139
Epoch: 1, Steps: 570 | Train Loss: 0.2698223 Vali Loss: 0.0505259 Test Loss: 0.1521214
Validation loss decreased (inf --> 0.050526).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5054663
	speed: 0.0384s/iter; left time: 411.9819s
	iters: 200, epoch: 2 | loss: 0.3730318
	speed: 0.0109s/iter; left time: 115.7382s
	iters: 300, epoch: 2 | loss: 0.2677314
	speed: 0.0104s/iter; left time: 109.8929s
	iters: 400, epoch: 2 | loss: 0.2034914
	speed: 0.0105s/iter; left time: 109.4446s
	iters: 500, epoch: 2 | loss: 0.2365679
	speed: 0.0106s/iter; left time: 109.2065s
Epoch: 2 cost time: 6.461136341094971
Epoch: 2, Steps: 570 | Train Loss: 0.2636143 Vali Loss: 0.0675508 Test Loss: 0.1951685
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2460580
	speed: 0.0376s/iter; left time: 382.1713s
	iters: 200, epoch: 3 | loss: 0.3752654
	speed: 0.0118s/iter; left time: 118.9396s
	iters: 300, epoch: 3 | loss: 0.2134835
	speed: 0.0118s/iter; left time: 118.0270s
	iters: 400, epoch: 3 | loss: 0.2111763
	speed: 0.0118s/iter; left time: 116.3969s
	iters: 500, epoch: 3 | loss: 0.2905028
	speed: 0.0118s/iter; left time: 115.0224s
Epoch: 3 cost time: 7.002861022949219
Epoch: 3, Steps: 570 | Train Loss: 0.2672945 Vali Loss: 0.0502162 Test Loss: 0.1495679
Validation loss decreased (0.050526 --> 0.050216).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4105504
	speed: 0.0383s/iter; left time: 367.2943s
	iters: 200, epoch: 4 | loss: 0.1554852
	speed: 0.0105s/iter; left time: 100.0772s
	iters: 300, epoch: 4 | loss: 0.2539790
	speed: 0.0105s/iter; left time: 98.9913s
	iters: 400, epoch: 4 | loss: 0.2332794
	speed: 0.0105s/iter; left time: 97.8672s
	iters: 500, epoch: 4 | loss: 0.2072173
	speed: 0.0105s/iter; left time: 96.7575s
Epoch: 4 cost time: 6.321913480758667
Epoch: 4, Steps: 570 | Train Loss: 0.2372657 Vali Loss: 0.0477580 Test Loss: 0.1426489
Validation loss decreased (0.050216 --> 0.047758).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2328312
	speed: 0.0360s/iter; left time: 325.2012s
	iters: 200, epoch: 5 | loss: 0.2216953
	speed: 0.0106s/iter; left time: 94.8716s
	iters: 300, epoch: 5 | loss: 0.1907568
	speed: 0.0106s/iter; left time: 93.7870s
	iters: 400, epoch: 5 | loss: 0.1760155
	speed: 0.0106s/iter; left time: 92.4009s
	iters: 500, epoch: 5 | loss: 0.2505337
	speed: 0.0106s/iter; left time: 91.5475s
Epoch: 5 cost time: 6.344281196594238
Epoch: 5, Steps: 570 | Train Loss: 0.2250188 Vali Loss: 0.0460322 Test Loss: 0.1390025
Validation loss decreased (0.047758 --> 0.046032).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1989035
	speed: 0.0383s/iter; left time: 323.9107s
	iters: 200, epoch: 6 | loss: 0.1535221
	speed: 0.0106s/iter; left time: 88.5298s
	iters: 300, epoch: 6 | loss: 0.2412390
	speed: 0.0117s/iter; left time: 96.3282s
	iters: 400, epoch: 6 | loss: 0.2632490
	speed: 0.0118s/iter; left time: 96.4333s
	iters: 500, epoch: 6 | loss: 0.2396662
	speed: 0.0118s/iter; left time: 95.3610s
Epoch: 6 cost time: 6.75518536567688
Epoch: 6, Steps: 570 | Train Loss: 0.2193443 Vali Loss: 0.0450908 Test Loss: 0.1399323
Validation loss decreased (0.046032 --> 0.045091).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2661636
	speed: 0.0372s/iter; left time: 293.1139s
	iters: 200, epoch: 7 | loss: 0.2804905
	speed: 0.0105s/iter; left time: 81.3983s
	iters: 300, epoch: 7 | loss: 0.1554718
	speed: 0.0105s/iter; left time: 80.7634s
	iters: 400, epoch: 7 | loss: 0.1617900
	speed: 0.0105s/iter; left time: 79.5770s
	iters: 500, epoch: 7 | loss: 0.1971248
	speed: 0.0105s/iter; left time: 78.4045s
Epoch: 7 cost time: 6.289736032485962
Epoch: 7, Steps: 570 | Train Loss: 0.2169546 Vali Loss: 0.0455527 Test Loss: 0.1369280
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2547485
	speed: 0.0362s/iter; left time: 264.4103s
	iters: 200, epoch: 8 | loss: 0.2095753
	speed: 0.0105s/iter; left time: 75.9925s
	iters: 300, epoch: 8 | loss: 0.2478575
	speed: 0.0106s/iter; left time: 75.0948s
	iters: 400, epoch: 8 | loss: 0.2990359
	speed: 0.0105s/iter; left time: 73.9083s
	iters: 500, epoch: 8 | loss: 0.1562864
	speed: 0.0105s/iter; left time: 72.6244s
Epoch: 8 cost time: 6.2791736125946045
Epoch: 8, Steps: 570 | Train Loss: 0.2126635 Vali Loss: 0.0449546 Test Loss: 0.1366721
Validation loss decreased (0.045091 --> 0.044955).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2795043
	speed: 0.0362s/iter; left time: 243.8338s
	iters: 200, epoch: 9 | loss: 0.1916270
	speed: 0.0106s/iter; left time: 70.0720s
	iters: 300, epoch: 9 | loss: 0.1030944
	speed: 0.0105s/iter; left time: 68.7009s
	iters: 400, epoch: 9 | loss: 0.1902943
	speed: 0.0105s/iter; left time: 67.6884s
	iters: 500, epoch: 9 | loss: 0.1884133
	speed: 0.0105s/iter; left time: 66.8527s
Epoch: 9 cost time: 6.272051811218262
Epoch: 9, Steps: 570 | Train Loss: 0.2139503 Vali Loss: 0.0453385 Test Loss: 0.1365460
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1995925
	speed: 0.0364s/iter; left time: 224.5547s
	iters: 200, epoch: 10 | loss: 0.1834594
	speed: 0.0105s/iter; left time: 63.5206s
	iters: 300, epoch: 10 | loss: 0.1525384
	speed: 0.0104s/iter; left time: 62.3664s
	iters: 400, epoch: 10 | loss: 0.1993958
	speed: 0.0105s/iter; left time: 61.5610s
	iters: 500, epoch: 10 | loss: 0.3330832
	speed: 0.0105s/iter; left time: 60.5066s
Epoch: 10 cost time: 6.216636657714844
Epoch: 10, Steps: 570 | Train Loss: 0.2125980 Vali Loss: 0.0449574 Test Loss: 0.1366582
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2353677
	speed: 0.0377s/iter; left time: 210.9072s
	iters: 200, epoch: 11 | loss: 0.1963727
	speed: 0.0120s/iter; left time: 65.9562s
	iters: 300, epoch: 11 | loss: 0.1679645
	speed: 0.0111s/iter; left time: 60.0019s
	iters: 400, epoch: 11 | loss: 0.3239220
	speed: 0.0106s/iter; left time: 56.0750s
	iters: 500, epoch: 11 | loss: 0.1685197
	speed: 0.0106s/iter; left time: 54.9997s
Epoch: 11 cost time: 6.6328699588775635
Epoch: 11, Steps: 570 | Train Loss: 0.2125218 Vali Loss: 0.0449107 Test Loss: 0.1366072
Validation loss decreased (0.044955 --> 0.044911).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2075755
	speed: 0.0361s/iter; left time: 181.4058s
	iters: 200, epoch: 12 | loss: 0.2189093
	speed: 0.0106s/iter; left time: 52.0453s
	iters: 300, epoch: 12 | loss: 0.1716382
	speed: 0.0105s/iter; left time: 50.9386s
	iters: 400, epoch: 12 | loss: 0.1820216
	speed: 0.0105s/iter; left time: 49.8678s
	iters: 500, epoch: 12 | loss: 0.3031299
	speed: 0.0105s/iter; left time: 48.8455s
Epoch: 12 cost time: 6.3062779903411865
Epoch: 12, Steps: 570 | Train Loss: 0.2114540 Vali Loss: 0.0450061 Test Loss: 0.1366529
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1022834
	speed: 0.0376s/iter; left time: 167.5658s
	iters: 200, epoch: 13 | loss: 0.2675892
	speed: 0.0118s/iter; left time: 51.6001s
	iters: 300, epoch: 13 | loss: 0.1558159
	speed: 0.0118s/iter; left time: 50.3838s
	iters: 400, epoch: 13 | loss: 0.1571575
	speed: 0.0118s/iter; left time: 49.1817s
	iters: 500, epoch: 13 | loss: 0.2214960
	speed: 0.0118s/iter; left time: 47.9702s
Epoch: 13 cost time: 7.017001390457153
Epoch: 13, Steps: 570 | Train Loss: 0.2133635 Vali Loss: 0.0450953 Test Loss: 0.1366360
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1524723
	speed: 0.0377s/iter; left time: 146.7559s
	iters: 200, epoch: 14 | loss: 0.1994179
	speed: 0.0105s/iter; left time: 39.8972s
	iters: 300, epoch: 14 | loss: 0.2454288
	speed: 0.0105s/iter; left time: 38.8370s
	iters: 400, epoch: 14 | loss: 0.2762757
	speed: 0.0105s/iter; left time: 37.7912s
	iters: 500, epoch: 14 | loss: 0.2121911
	speed: 0.0105s/iter; left time: 36.7452s
Epoch: 14 cost time: 6.254024028778076
Epoch: 14, Steps: 570 | Train Loss: 0.2123307 Vali Loss: 0.0449673 Test Loss: 0.1366275
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13682235777378082, mae:0.23013094067573547
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2720160
	speed: 0.0238s/iter; left time: 268.4708s
	iters: 200, epoch: 1 | loss: 0.2550612
	speed: 0.0117s/iter; left time: 130.6602s
	iters: 300, epoch: 1 | loss: 0.2996303
	speed: 0.0116s/iter; left time: 129.1860s
	iters: 400, epoch: 1 | loss: 0.2450242
	speed: 0.0117s/iter; left time: 128.3198s
	iters: 500, epoch: 1 | loss: 0.2024878
	speed: 0.0117s/iter; left time: 127.2749s
Epoch: 1 cost time: 7.903503894805908
Epoch: 1, Steps: 570 | Train Loss: 0.2292420 Vali Loss: 0.0406269 Test Loss: 0.1289614
Validation loss decreased (inf --> 0.040627).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1660670
	speed: 0.0380s/iter; left time: 407.7618s
	iters: 200, epoch: 2 | loss: 0.2225348
	speed: 0.0103s/iter; left time: 109.9934s
	iters: 300, epoch: 2 | loss: 0.1696781
	speed: 0.0104s/iter; left time: 109.2627s
	iters: 400, epoch: 2 | loss: 0.2024043
	speed: 0.0104s/iter; left time: 108.1326s
	iters: 500, epoch: 2 | loss: 0.2608290
	speed: 0.0104s/iter; left time: 107.1948s
Epoch: 2 cost time: 6.2236082553863525
Epoch: 2, Steps: 570 | Train Loss: 0.2151188 Vali Loss: 0.0432774 Test Loss: 0.1319082
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1073155
	speed: 0.0365s/iter; left time: 370.8846s
	iters: 200, epoch: 3 | loss: 0.2045198
	speed: 0.0104s/iter; left time: 104.8516s
	iters: 300, epoch: 3 | loss: 0.3562557
	speed: 0.0104s/iter; left time: 103.6907s
	iters: 400, epoch: 3 | loss: 0.1984722
	speed: 0.0104s/iter; left time: 102.9338s
	iters: 500, epoch: 3 | loss: 0.1355830
	speed: 0.0104s/iter; left time: 101.5661s
Epoch: 3 cost time: 6.227769374847412
Epoch: 3, Steps: 570 | Train Loss: 0.1942021 Vali Loss: 0.0354472 Test Loss: 0.1168530
Validation loss decreased (0.040627 --> 0.035447).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1595048
	speed: 0.0363s/iter; left time: 347.7308s
	iters: 200, epoch: 4 | loss: 0.1545954
	speed: 0.0118s/iter; left time: 112.2550s
	iters: 300, epoch: 4 | loss: 0.1039984
	speed: 0.0118s/iter; left time: 110.8012s
	iters: 400, epoch: 4 | loss: 0.1309091
	speed: 0.0118s/iter; left time: 109.6554s
	iters: 500, epoch: 4 | loss: 0.2197086
	speed: 0.0118s/iter; left time: 108.6643s
Epoch: 4 cost time: 6.95213508605957
Epoch: 4, Steps: 570 | Train Loss: 0.1774322 Vali Loss: 0.0345319 Test Loss: 0.1144773
Validation loss decreased (0.035447 --> 0.034532).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1512218
	speed: 0.0390s/iter; left time: 351.4861s
	iters: 200, epoch: 5 | loss: 0.2394757
	speed: 0.0116s/iter; left time: 103.6184s
	iters: 300, epoch: 5 | loss: 0.1671902
	speed: 0.0116s/iter; left time: 102.7444s
	iters: 400, epoch: 5 | loss: 0.1594759
	speed: 0.0116s/iter; left time: 101.4899s
	iters: 500, epoch: 5 | loss: 0.1756693
	speed: 0.0116s/iter; left time: 100.2519s
Epoch: 5 cost time: 6.969079971313477
Epoch: 5, Steps: 570 | Train Loss: 0.1706449 Vali Loss: 0.0340808 Test Loss: 0.1143026
Validation loss decreased (0.034532 --> 0.034081).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1132660
	speed: 0.0380s/iter; left time: 321.1730s
	iters: 200, epoch: 6 | loss: 0.2210791
	speed: 0.0103s/iter; left time: 86.2357s
	iters: 300, epoch: 6 | loss: 0.1718553
	speed: 0.0103s/iter; left time: 85.0338s
	iters: 400, epoch: 6 | loss: 0.1357596
	speed: 0.0103s/iter; left time: 83.9698s
	iters: 500, epoch: 6 | loss: 0.1047990
	speed: 0.0103s/iter; left time: 82.6564s
Epoch: 6 cost time: 6.154315948486328
Epoch: 6, Steps: 570 | Train Loss: 0.1650022 Vali Loss: 0.0340683 Test Loss: 0.1121477
Validation loss decreased (0.034081 --> 0.034068).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1775665
	speed: 0.0355s/iter; left time: 279.9533s
	iters: 200, epoch: 7 | loss: 0.1840083
	speed: 0.0103s/iter; left time: 80.3397s
	iters: 300, epoch: 7 | loss: 0.3098571
	speed: 0.0103s/iter; left time: 79.2376s
	iters: 400, epoch: 7 | loss: 0.2166393
	speed: 0.0103s/iter; left time: 78.1830s
	iters: 500, epoch: 7 | loss: 0.1808318
	speed: 0.0103s/iter; left time: 77.1619s
Epoch: 7 cost time: 6.172895431518555
Epoch: 7, Steps: 570 | Train Loss: 0.1634188 Vali Loss: 0.0334270 Test Loss: 0.1127313
Validation loss decreased (0.034068 --> 0.033427).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1337667
	speed: 0.0375s/iter; left time: 273.9533s
	iters: 200, epoch: 8 | loss: 0.1220730
	speed: 0.0103s/iter; left time: 74.3001s
	iters: 300, epoch: 8 | loss: 0.1137987
	speed: 0.0103s/iter; left time: 73.2675s
	iters: 400, epoch: 8 | loss: 0.1611990
	speed: 0.0103s/iter; left time: 72.4656s
	iters: 500, epoch: 8 | loss: 0.1009670
	speed: 0.0103s/iter; left time: 71.5059s
Epoch: 8 cost time: 6.180626153945923
Epoch: 8, Steps: 570 | Train Loss: 0.1629380 Vali Loss: 0.0332468 Test Loss: 0.1121480
Validation loss decreased (0.033427 --> 0.033247).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1463883
	speed: 0.0375s/iter; left time: 252.4726s
	iters: 200, epoch: 9 | loss: 0.1533737
	speed: 0.0103s/iter; left time: 68.5942s
	iters: 300, epoch: 9 | loss: 0.1479795
	speed: 0.0103s/iter; left time: 67.6010s
	iters: 400, epoch: 9 | loss: 0.2016435
	speed: 0.0103s/iter; left time: 66.5265s
	iters: 500, epoch: 9 | loss: 0.1387911
	speed: 0.0103s/iter; left time: 65.5093s
Epoch: 9 cost time: 6.2134270668029785
Epoch: 9, Steps: 570 | Train Loss: 0.1612467 Vali Loss: 0.0334340 Test Loss: 0.1120927
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2028267
	speed: 0.0362s/iter; left time: 223.1869s
	iters: 200, epoch: 10 | loss: 0.1325454
	speed: 0.0102s/iter; left time: 62.0378s
	iters: 300, epoch: 10 | loss: 0.1501399
	speed: 0.0102s/iter; left time: 61.0097s
	iters: 400, epoch: 10 | loss: 0.1044933
	speed: 0.0102s/iter; left time: 59.9516s
	iters: 500, epoch: 10 | loss: 0.1074002
	speed: 0.0102s/iter; left time: 58.9925s
Epoch: 10 cost time: 6.089453935623169
Epoch: 10, Steps: 570 | Train Loss: 0.1624086 Vali Loss: 0.0333549 Test Loss: 0.1120792
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1523762
	speed: 0.0359s/iter; left time: 201.3244s
	iters: 200, epoch: 11 | loss: 0.1533564
	speed: 0.0104s/iter; left time: 56.9486s
	iters: 300, epoch: 11 | loss: 0.1951946
	speed: 0.0104s/iter; left time: 55.9065s
	iters: 400, epoch: 11 | loss: 0.1608341
	speed: 0.0104s/iter; left time: 54.9291s
	iters: 500, epoch: 11 | loss: 0.1590894
	speed: 0.0103s/iter; left time: 53.7961s
Epoch: 11 cost time: 6.184031248092651
Epoch: 11, Steps: 570 | Train Loss: 0.1606826 Vali Loss: 0.0332173 Test Loss: 0.1120477
Validation loss decreased (0.033247 --> 0.033217).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1488593
	speed: 0.0381s/iter; left time: 191.7601s
	iters: 200, epoch: 12 | loss: 0.1528861
	speed: 0.0104s/iter; left time: 51.3225s
	iters: 300, epoch: 12 | loss: 0.1186375
	speed: 0.0103s/iter; left time: 49.9947s
	iters: 400, epoch: 12 | loss: 0.2596448
	speed: 0.0104s/iter; left time: 49.0523s
	iters: 500, epoch: 12 | loss: 0.1406447
	speed: 0.0104s/iter; left time: 48.0941s
Epoch: 12 cost time: 6.222867250442505
Epoch: 12, Steps: 570 | Train Loss: 0.1614960 Vali Loss: 0.0332660 Test Loss: 0.1121420
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2797479
	speed: 0.0362s/iter; left time: 161.4507s
	iters: 200, epoch: 13 | loss: 0.2159488
	speed: 0.0104s/iter; left time: 45.1846s
	iters: 300, epoch: 13 | loss: 0.1232705
	speed: 0.0103s/iter; left time: 44.0659s
	iters: 400, epoch: 13 | loss: 0.1761489
	speed: 0.0104s/iter; left time: 43.1564s
	iters: 500, epoch: 13 | loss: 0.1888717
	speed: 0.0104s/iter; left time: 42.1540s
Epoch: 13 cost time: 6.183291435241699
Epoch: 13, Steps: 570 | Train Loss: 0.1612591 Vali Loss: 0.0332204 Test Loss: 0.1121158
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1898113
	speed: 0.0375s/iter; left time: 145.9151s
	iters: 200, epoch: 14 | loss: 0.1162388
	speed: 0.0103s/iter; left time: 39.2055s
	iters: 300, epoch: 14 | loss: 0.1605986
	speed: 0.0103s/iter; left time: 38.1144s
	iters: 400, epoch: 14 | loss: 0.1655512
	speed: 0.0103s/iter; left time: 37.1419s
	iters: 500, epoch: 14 | loss: 0.1636503
	speed: 0.0103s/iter; left time: 36.0586s
Epoch: 14 cost time: 6.151569604873657
Epoch: 14, Steps: 570 | Train Loss: 0.1613626 Vali Loss: 0.0332831 Test Loss: 0.1121289
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11220263689756393, mae:0.20432178676128387
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2665744
	speed: 0.0238s/iter; left time: 268.5686s
	iters: 200, epoch: 1 | loss: 0.1625039
	speed: 0.0116s/iter; left time: 130.3553s
	iters: 300, epoch: 1 | loss: 0.1715275
	speed: 0.0116s/iter; left time: 128.8272s
	iters: 400, epoch: 1 | loss: 0.2192196
	speed: 0.0116s/iter; left time: 127.5620s
	iters: 500, epoch: 1 | loss: 0.2436446
	speed: 0.0116s/iter; left time: 126.6041s
Epoch: 1 cost time: 7.8839898109436035
Epoch: 1, Steps: 570 | Train Loss: 0.2679370 Vali Loss: 0.0518775 Test Loss: 0.1528189
Validation loss decreased (inf --> 0.051878).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3995857
	speed: 0.0374s/iter; left time: 401.3050s
	iters: 200, epoch: 2 | loss: 0.3813215
	speed: 0.0103s/iter; left time: 109.9289s
	iters: 300, epoch: 2 | loss: 0.2108474
	speed: 0.0103s/iter; left time: 108.3243s
	iters: 400, epoch: 2 | loss: 0.3423056
	speed: 0.0103s/iter; left time: 107.5345s
	iters: 500, epoch: 2 | loss: 0.3010347
	speed: 0.0103s/iter; left time: 106.0617s
Epoch: 2 cost time: 6.198144197463989
Epoch: 2, Steps: 570 | Train Loss: 0.2640337 Vali Loss: 0.0516810 Test Loss: 0.1591369
Validation loss decreased (0.051878 --> 0.051681).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1683755
	speed: 0.0369s/iter; left time: 374.8009s
	iters: 200, epoch: 3 | loss: 0.2236179
	speed: 0.0103s/iter; left time: 103.7710s
	iters: 300, epoch: 3 | loss: 0.2537792
	speed: 0.0103s/iter; left time: 102.8964s
	iters: 400, epoch: 3 | loss: 0.1891318
	speed: 0.0103s/iter; left time: 101.8164s
	iters: 500, epoch: 3 | loss: 0.1693430
	speed: 0.0103s/iter; left time: 100.7406s
Epoch: 3 cost time: 6.193397283554077
Epoch: 3, Steps: 570 | Train Loss: 0.2363307 Vali Loss: 0.0479477 Test Loss: 0.1425689
Validation loss decreased (0.051681 --> 0.047948).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1491272
	speed: 0.0362s/iter; left time: 347.1986s
	iters: 200, epoch: 4 | loss: 0.1335760
	speed: 0.0103s/iter; left time: 97.8524s
	iters: 300, epoch: 4 | loss: 0.1788428
	speed: 0.0104s/iter; left time: 97.2392s
	iters: 400, epoch: 4 | loss: 0.2666694
	speed: 0.0103s/iter; left time: 95.9990s
	iters: 500, epoch: 4 | loss: 0.1612497
	speed: 0.0103s/iter; left time: 94.7399s
Epoch: 4 cost time: 6.177092552185059
Epoch: 4, Steps: 570 | Train Loss: 0.2194571 Vali Loss: 0.0480028 Test Loss: 0.1399659
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1819476
	speed: 0.0363s/iter; left time: 327.2021s
	iters: 200, epoch: 5 | loss: 0.1414169
	speed: 0.0103s/iter; left time: 91.6610s
	iters: 300, epoch: 5 | loss: 0.2882839
	speed: 0.0103s/iter; left time: 90.8866s
	iters: 400, epoch: 5 | loss: 0.1805757
	speed: 0.0103s/iter; left time: 89.8999s
	iters: 500, epoch: 5 | loss: 0.3003975
	speed: 0.0103s/iter; left time: 88.6588s
Epoch: 5 cost time: 6.187060117721558
Epoch: 5, Steps: 570 | Train Loss: 0.2111736 Vali Loss: 0.0444598 Test Loss: 0.1373426
Validation loss decreased (0.047948 --> 0.044460).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1481559
	speed: 0.0383s/iter; left time: 323.4452s
	iters: 200, epoch: 6 | loss: 0.2157323
	speed: 0.0103s/iter; left time: 85.9478s
	iters: 300, epoch: 6 | loss: 0.2078682
	speed: 0.0103s/iter; left time: 85.1614s
	iters: 400, epoch: 6 | loss: 0.1530166
	speed: 0.0103s/iter; left time: 84.2143s
	iters: 500, epoch: 6 | loss: 0.1808219
	speed: 0.0103s/iter; left time: 82.9722s
Epoch: 6 cost time: 6.284023761749268
Epoch: 6, Steps: 570 | Train Loss: 0.2026788 Vali Loss: 0.0443465 Test Loss: 0.1363007
Validation loss decreased (0.044460 --> 0.044347).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2109874
	speed: 0.0381s/iter; left time: 300.1086s
	iters: 200, epoch: 7 | loss: 0.1694206
	speed: 0.0104s/iter; left time: 80.6958s
	iters: 300, epoch: 7 | loss: 0.1643476
	speed: 0.0104s/iter; left time: 79.6035s
	iters: 400, epoch: 7 | loss: 0.1253503
	speed: 0.0104s/iter; left time: 78.5946s
	iters: 500, epoch: 7 | loss: 0.2321343
	speed: 0.0104s/iter; left time: 77.5691s
Epoch: 7 cost time: 6.247174263000488
Epoch: 7, Steps: 570 | Train Loss: 0.2003247 Vali Loss: 0.0449832 Test Loss: 0.1369952
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1437660
	speed: 0.0375s/iter; left time: 274.1090s
	iters: 200, epoch: 8 | loss: 0.1740367
	speed: 0.0103s/iter; left time: 74.0168s
	iters: 300, epoch: 8 | loss: 0.2138445
	speed: 0.0103s/iter; left time: 73.0096s
	iters: 400, epoch: 8 | loss: 0.2274852
	speed: 0.0103s/iter; left time: 71.9792s
	iters: 500, epoch: 8 | loss: 0.2640571
	speed: 0.0103s/iter; left time: 70.9471s
Epoch: 8 cost time: 6.128490209579468
Epoch: 8, Steps: 570 | Train Loss: 0.1992223 Vali Loss: 0.0450322 Test Loss: 0.1366178
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1558319
	speed: 0.0360s/iter; left time: 242.5639s
	iters: 200, epoch: 9 | loss: 0.2155426
	speed: 0.0103s/iter; left time: 68.1641s
	iters: 300, epoch: 9 | loss: 0.1660830
	speed: 0.0103s/iter; left time: 67.0805s
	iters: 400, epoch: 9 | loss: 0.1353658
	speed: 0.0103s/iter; left time: 66.0729s
	iters: 500, epoch: 9 | loss: 0.2189843
	speed: 0.0103s/iter; left time: 65.0490s
Epoch: 9 cost time: 6.120204448699951
Epoch: 9, Steps: 570 | Train Loss: 0.1988193 Vali Loss: 0.0453159 Test Loss: 0.1367790
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1364724338054657, mae:0.23290593922138214
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3146958
	speed: 0.0250s/iter; left time: 282.2361s
	iters: 200, epoch: 1 | loss: 0.2838693
	speed: 0.0129s/iter; left time: 145.0489s
	iters: 300, epoch: 1 | loss: 0.1965312
	speed: 0.0129s/iter; left time: 143.3113s
	iters: 400, epoch: 1 | loss: 0.1757296
	speed: 0.0129s/iter; left time: 142.2966s
	iters: 500, epoch: 1 | loss: 0.2426057
	speed: 0.0130s/iter; left time: 141.2103s
Epoch: 1 cost time: 8.621425867080688
Epoch: 1, Steps: 570 | Train Loss: 0.3048955 Vali Loss: 0.0569524 Test Loss: 0.1670164
Validation loss decreased (inf --> 0.056952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3564685
	speed: 0.0404s/iter; left time: 433.6651s
	iters: 200, epoch: 2 | loss: 0.2490194
	speed: 0.0119s/iter; left time: 125.9837s
	iters: 300, epoch: 2 | loss: 0.2912205
	speed: 0.0119s/iter; left time: 125.0700s
	iters: 400, epoch: 2 | loss: 0.2075615
	speed: 0.0119s/iter; left time: 123.7893s
	iters: 500, epoch: 2 | loss: 0.3259264
	speed: 0.0119s/iter; left time: 122.4567s
Epoch: 2 cost time: 7.099339485168457
Epoch: 2, Steps: 570 | Train Loss: 0.3621097 Vali Loss: 0.0655616 Test Loss: 0.2010690
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4145622
	speed: 0.0396s/iter; left time: 402.4706s
	iters: 200, epoch: 3 | loss: 0.4263114
	speed: 0.0119s/iter; left time: 119.7856s
	iters: 300, epoch: 3 | loss: 0.1655468
	speed: 0.0119s/iter; left time: 118.3887s
	iters: 400, epoch: 3 | loss: 0.3101531
	speed: 0.0119s/iter; left time: 117.1992s
	iters: 500, epoch: 3 | loss: 0.2383604
	speed: 0.0119s/iter; left time: 116.1098s
Epoch: 3 cost time: 7.126617431640625
Epoch: 3, Steps: 570 | Train Loss: 0.3143142 Vali Loss: 0.0663429 Test Loss: 0.1853718
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2161061
	speed: 0.0400s/iter; left time: 384.0456s
	iters: 200, epoch: 4 | loss: 0.3722821
	speed: 0.0120s/iter; left time: 113.5798s
	iters: 300, epoch: 4 | loss: 0.2015136
	speed: 0.0119s/iter; left time: 112.0137s
	iters: 400, epoch: 4 | loss: 0.1925986
	speed: 0.0123s/iter; left time: 114.4210s
	iters: 500, epoch: 4 | loss: 0.2151652
	speed: 0.0130s/iter; left time: 119.1478s
Epoch: 4 cost time: 7.370324611663818
Epoch: 4, Steps: 570 | Train Loss: 0.2983768 Vali Loss: 0.0602570 Test Loss: 0.1767666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16728396713733673, mae:0.26014572381973267
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1621534
	speed: 0.0243s/iter; left time: 274.4358s
	iters: 200, epoch: 1 | loss: 0.4235111
	speed: 0.0126s/iter; left time: 140.6674s
	iters: 300, epoch: 1 | loss: 0.2352856
	speed: 0.0125s/iter; left time: 139.2953s
	iters: 400, epoch: 1 | loss: 0.4525290
	speed: 0.0126s/iter; left time: 138.0757s
	iters: 500, epoch: 1 | loss: 0.2929428
	speed: 0.0126s/iter; left time: 137.1519s
Epoch: 1 cost time: 8.386117219924927
Epoch: 1, Steps: 570 | Train Loss: 0.3089340 Vali Loss: 0.0703744 Test Loss: 0.2047924
Validation loss decreased (inf --> 0.070374).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2462121
	speed: 0.0425s/iter; left time: 456.2376s
	iters: 200, epoch: 2 | loss: 0.1961503
	speed: 0.0115s/iter; left time: 122.1841s
	iters: 300, epoch: 2 | loss: 0.1915278
	speed: 0.0119s/iter; left time: 125.4259s
	iters: 400, epoch: 2 | loss: 0.3650100
	speed: 0.0126s/iter; left time: 131.0318s
	iters: 500, epoch: 2 | loss: 0.5563440
	speed: 0.0126s/iter; left time: 129.7735s
Epoch: 2 cost time: 7.2849812507629395
Epoch: 2, Steps: 570 | Train Loss: 0.3197718 Vali Loss: 0.0647909 Test Loss: 0.1861613
Validation loss decreased (0.070374 --> 0.064791).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3419395
	speed: 0.0404s/iter; left time: 410.0566s
	iters: 200, epoch: 3 | loss: 0.1741049
	speed: 0.0115s/iter; left time: 116.0088s
	iters: 300, epoch: 3 | loss: 0.3266390
	speed: 0.0115s/iter; left time: 114.9936s
	iters: 400, epoch: 3 | loss: 0.2794829
	speed: 0.0115s/iter; left time: 113.5811s
	iters: 500, epoch: 3 | loss: 0.4134959
	speed: 0.0115s/iter; left time: 112.7265s
Epoch: 3 cost time: 6.915549278259277
Epoch: 3, Steps: 570 | Train Loss: 0.3013770 Vali Loss: 0.0672429 Test Loss: 0.1973960
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2597378
	speed: 0.0390s/iter; left time: 373.5879s
	iters: 200, epoch: 4 | loss: 0.1957911
	speed: 0.0115s/iter; left time: 109.1132s
	iters: 300, epoch: 4 | loss: 0.2042681
	speed: 0.0115s/iter; left time: 108.1493s
	iters: 400, epoch: 4 | loss: 0.2713029
	speed: 0.0115s/iter; left time: 106.7402s
	iters: 500, epoch: 4 | loss: 0.2831668
	speed: 0.0115s/iter; left time: 105.7765s
Epoch: 4 cost time: 6.853731393814087
Epoch: 4, Steps: 570 | Train Loss: 0.3059611 Vali Loss: 0.0696376 Test Loss: 0.1842965
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3049182
	speed: 0.0373s/iter; left time: 336.8962s
	iters: 200, epoch: 5 | loss: 0.2351806
	speed: 0.0115s/iter; left time: 102.3564s
	iters: 300, epoch: 5 | loss: 0.4495172
	speed: 0.0115s/iter; left time: 101.3686s
	iters: 400, epoch: 5 | loss: 0.2376069
	speed: 0.0115s/iter; left time: 100.1688s
	iters: 500, epoch: 5 | loss: 0.2409071
	speed: 0.0115s/iter; left time: 98.9924s
Epoch: 5 cost time: 6.812418460845947
Epoch: 5, Steps: 570 | Train Loss: 0.2914947 Vali Loss: 0.0645789 Test Loss: 0.1771692
Validation loss decreased (0.064791 --> 0.064579).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3137941
	speed: 0.0387s/iter; left time: 327.3756s
	iters: 200, epoch: 6 | loss: 0.3051760
	speed: 0.0114s/iter; left time: 95.5769s
	iters: 300, epoch: 6 | loss: 0.1748664
	speed: 0.0115s/iter; left time: 94.5825s
	iters: 400, epoch: 6 | loss: 0.2137271
	speed: 0.0115s/iter; left time: 93.3676s
	iters: 500, epoch: 6 | loss: 0.2155635
	speed: 0.0117s/iter; left time: 93.9591s
Epoch: 6 cost time: 6.966285467147827
Epoch: 6, Steps: 570 | Train Loss: 0.2856273 Vali Loss: 0.0634681 Test Loss: 0.1763937
Validation loss decreased (0.064579 --> 0.063468).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2200189
	speed: 0.0394s/iter; left time: 310.4943s
	iters: 200, epoch: 7 | loss: 0.3610333
	speed: 0.0115s/iter; left time: 89.5880s
	iters: 300, epoch: 7 | loss: 0.2429709
	speed: 0.0115s/iter; left time: 88.3471s
	iters: 400, epoch: 7 | loss: 0.2551625
	speed: 0.0115s/iter; left time: 87.3280s
	iters: 500, epoch: 7 | loss: 0.2693877
	speed: 0.0115s/iter; left time: 85.9410s
Epoch: 7 cost time: 6.869879722595215
Epoch: 7, Steps: 570 | Train Loss: 0.2844154 Vali Loss: 0.0636506 Test Loss: 0.1754195
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1919257
	speed: 0.0385s/iter; left time: 281.6687s
	iters: 200, epoch: 8 | loss: 0.2944022
	speed: 0.0115s/iter; left time: 83.1066s
	iters: 300, epoch: 8 | loss: 0.2542833
	speed: 0.0115s/iter; left time: 81.6238s
	iters: 400, epoch: 8 | loss: 0.2601533
	speed: 0.0115s/iter; left time: 80.4566s
	iters: 500, epoch: 8 | loss: 0.2570642
	speed: 0.0115s/iter; left time: 79.3134s
Epoch: 8 cost time: 6.83769416809082
Epoch: 8, Steps: 570 | Train Loss: 0.2814559 Vali Loss: 0.0634190 Test Loss: 0.1761353
Validation loss decreased (0.063468 --> 0.063419).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3800250
	speed: 0.0392s/iter; left time: 264.5671s
	iters: 200, epoch: 9 | loss: 0.1612675
	speed: 0.0122s/iter; left time: 81.3097s
	iters: 300, epoch: 9 | loss: 0.3236064
	speed: 0.0114s/iter; left time: 74.8794s
	iters: 400, epoch: 9 | loss: 0.3164397
	speed: 0.0114s/iter; left time: 73.7350s
	iters: 500, epoch: 9 | loss: 0.3997166
	speed: 0.0115s/iter; left time: 72.6159s
Epoch: 9 cost time: 7.036710739135742
Epoch: 9, Steps: 570 | Train Loss: 0.2817927 Vali Loss: 0.0627447 Test Loss: 0.1758721
Validation loss decreased (0.063419 --> 0.062745).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2104461
	speed: 0.0382s/iter; left time: 235.7708s
	iters: 200, epoch: 10 | loss: 0.2363057
	speed: 0.0114s/iter; left time: 69.4060s
	iters: 300, epoch: 10 | loss: 0.2046684
	speed: 0.0115s/iter; left time: 68.4971s
	iters: 400, epoch: 10 | loss: 0.2702019
	speed: 0.0115s/iter; left time: 67.3419s
	iters: 500, epoch: 10 | loss: 0.2903891
	speed: 0.0114s/iter; left time: 65.9359s
Epoch: 10 cost time: 6.830387115478516
Epoch: 10, Steps: 570 | Train Loss: 0.2824371 Vali Loss: 0.0631095 Test Loss: 0.1755162
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1698792
	speed: 0.0396s/iter; left time: 221.7396s
	iters: 200, epoch: 11 | loss: 0.2862641
	speed: 0.0114s/iter; left time: 62.8940s
	iters: 300, epoch: 11 | loss: 0.2626987
	speed: 0.0115s/iter; left time: 61.8995s
	iters: 400, epoch: 11 | loss: 0.3237939
	speed: 0.0115s/iter; left time: 60.7629s
	iters: 500, epoch: 11 | loss: 0.4603405
	speed: 0.0115s/iter; left time: 59.6536s
Epoch: 11 cost time: 6.8439812660217285
Epoch: 11, Steps: 570 | Train Loss: 0.2805423 Vali Loss: 0.0631211 Test Loss: 0.1755228
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2366856
	speed: 0.0385s/iter; left time: 193.7130s
	iters: 200, epoch: 12 | loss: 0.2605909
	speed: 0.0115s/iter; left time: 56.6890s
	iters: 300, epoch: 12 | loss: 0.1787814
	speed: 0.0115s/iter; left time: 55.7159s
	iters: 400, epoch: 12 | loss: 0.3991050
	speed: 0.0118s/iter; left time: 56.0141s
	iters: 500, epoch: 12 | loss: 0.2452077
	speed: 0.0125s/iter; left time: 58.0412s
Epoch: 12 cost time: 7.086598634719849
Epoch: 12, Steps: 570 | Train Loss: 0.2828113 Vali Loss: 0.0631685 Test Loss: 0.1755223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17613042891025543, mae:0.26716727018356323
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3310875
	speed: 0.0227s/iter; left time: 256.6779s
	iters: 200, epoch: 1 | loss: 0.3205411
	speed: 0.0109s/iter; left time: 121.5818s
	iters: 300, epoch: 1 | loss: 0.4598767
	speed: 0.0108s/iter; left time: 120.1761s
	iters: 400, epoch: 1 | loss: 0.3615898
	speed: 0.0108s/iter; left time: 118.9683s
	iters: 500, epoch: 1 | loss: 0.2669631
	speed: 0.0108s/iter; left time: 117.8779s
Epoch: 1 cost time: 7.409855365753174
Epoch: 1, Steps: 570 | Train Loss: 0.3139204 Vali Loss: 0.0577420 Test Loss: 0.1718128
Validation loss decreased (inf --> 0.057742).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2738406
	speed: 0.0376s/iter; left time: 403.1893s
	iters: 200, epoch: 2 | loss: 0.3333329
	speed: 0.0109s/iter; left time: 115.6976s
	iters: 300, epoch: 2 | loss: 0.1958640
	speed: 0.0109s/iter; left time: 114.5756s
	iters: 400, epoch: 2 | loss: 0.2421278
	speed: 0.0109s/iter; left time: 113.6028s
	iters: 500, epoch: 2 | loss: 0.2657471
	speed: 0.0109s/iter; left time: 112.1883s
Epoch: 2 cost time: 6.524508714675903
Epoch: 2, Steps: 570 | Train Loss: 0.3191139 Vali Loss: 0.0683331 Test Loss: 0.1963060
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1974169
	speed: 0.0377s/iter; left time: 383.5223s
	iters: 200, epoch: 3 | loss: 0.2441244
	speed: 0.0109s/iter; left time: 109.1723s
	iters: 300, epoch: 3 | loss: 0.3068202
	speed: 0.0108s/iter; left time: 107.7658s
	iters: 400, epoch: 3 | loss: 0.3356909
	speed: 0.0108s/iter; left time: 106.9533s
	iters: 500, epoch: 3 | loss: 0.3248774
	speed: 0.0108s/iter; left time: 105.7025s
Epoch: 3 cost time: 6.500051736831665
Epoch: 3, Steps: 570 | Train Loss: 0.2982767 Vali Loss: 0.0630827 Test Loss: 0.1717639
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2849285
	speed: 0.0361s/iter; left time: 346.4220s
	iters: 200, epoch: 4 | loss: 0.1341906
	speed: 0.0109s/iter; left time: 103.0152s
	iters: 300, epoch: 4 | loss: 0.3374710
	speed: 0.0108s/iter; left time: 101.7590s
	iters: 400, epoch: 4 | loss: 0.4772728
	speed: 0.0109s/iter; left time: 100.9208s
	iters: 500, epoch: 4 | loss: 0.3229633
	speed: 0.0108s/iter; left time: 99.6354s
Epoch: 4 cost time: 6.459392309188843
Epoch: 4, Steps: 570 | Train Loss: 0.2769645 Vali Loss: 0.0623952 Test Loss: 0.1707577
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17203237116336823, mae:0.27029332518577576
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2435709
	speed: 0.0282s/iter; left time: 318.5640s
	iters: 200, epoch: 1 | loss: 0.1911342
	speed: 0.0163s/iter; left time: 182.0859s
	iters: 300, epoch: 1 | loss: 0.3567736
	speed: 0.0163s/iter; left time: 180.9973s
	iters: 400, epoch: 1 | loss: 0.2810073
	speed: 0.0163s/iter; left time: 178.8012s
	iters: 500, epoch: 1 | loss: 0.2252716
	speed: 0.0163s/iter; left time: 177.7329s
Epoch: 1 cost time: 10.522274494171143
Epoch: 1, Steps: 570 | Train Loss: 0.2713187 Vali Loss: 0.0512629 Test Loss: 0.1473980
Validation loss decreased (inf --> 0.051263).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3252781
	speed: 0.0512s/iter; left time: 549.7177s
	iters: 200, epoch: 2 | loss: 0.2741295
	speed: 0.0163s/iter; left time: 173.8073s
	iters: 300, epoch: 2 | loss: 0.2366938
	speed: 0.0149s/iter; left time: 156.8605s
	iters: 400, epoch: 2 | loss: 0.1830042
	speed: 0.0161s/iter; left time: 168.1395s
	iters: 500, epoch: 2 | loss: 0.3432406
	speed: 0.0163s/iter; left time: 168.4525s
Epoch: 2 cost time: 9.43977665901184
Epoch: 2, Steps: 570 | Train Loss: 0.2852060 Vali Loss: 0.0700450 Test Loss: 0.2050198
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5130218
	speed: 0.0469s/iter; left time: 476.5521s
	iters: 200, epoch: 3 | loss: 0.3435275
	speed: 0.0145s/iter; left time: 145.6535s
	iters: 300, epoch: 3 | loss: 0.1621601
	speed: 0.0145s/iter; left time: 144.3435s
	iters: 400, epoch: 3 | loss: 0.2179836
	speed: 0.0145s/iter; left time: 142.7286s
	iters: 500, epoch: 3 | loss: 0.2560741
	speed: 0.0145s/iter; left time: 141.2412s
Epoch: 3 cost time: 8.533675909042358
Epoch: 3, Steps: 570 | Train Loss: 0.3024391 Vali Loss: 0.0615400 Test Loss: 0.1726220
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2690701
	speed: 0.0455s/iter; left time: 436.5145s
	iters: 200, epoch: 4 | loss: 0.2230475
	speed: 0.0145s/iter; left time: 137.6738s
	iters: 300, epoch: 4 | loss: 0.2580901
	speed: 0.0145s/iter; left time: 136.1329s
	iters: 400, epoch: 4 | loss: 0.2845585
	speed: 0.0145s/iter; left time: 134.6614s
	iters: 500, epoch: 4 | loss: 0.2436915
	speed: 0.0146s/iter; left time: 133.8758s
Epoch: 4 cost time: 8.534708976745605
Epoch: 4, Steps: 570 | Train Loss: 0.2748295 Vali Loss: 0.0567464 Test Loss: 0.1649906
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14764295518398285, mae:0.2447245717048645
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3579422
	speed: 0.0260s/iter; left time: 293.9761s
	iters: 200, epoch: 1 | loss: 0.3188561
	speed: 0.0142s/iter; left time: 159.3032s
	iters: 300, epoch: 1 | loss: 0.1412449
	speed: 0.0142s/iter; left time: 157.3305s
	iters: 400, epoch: 1 | loss: 0.3408230
	speed: 0.0142s/iter; left time: 156.5359s
	iters: 500, epoch: 1 | loss: 0.2369466
	speed: 0.0142s/iter; left time: 154.4089s
Epoch: 1 cost time: 9.32254958152771
Epoch: 1, Steps: 570 | Train Loss: 0.2422368 Vali Loss: 0.0484057 Test Loss: 0.1495427
Validation loss decreased (inf --> 0.048406).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1942520
	speed: 0.0461s/iter; left time: 494.3414s
	iters: 200, epoch: 2 | loss: 0.2967184
	speed: 0.0143s/iter; left time: 151.8953s
	iters: 300, epoch: 2 | loss: 0.2182838
	speed: 0.0142s/iter; left time: 149.8494s
	iters: 400, epoch: 2 | loss: 0.2311323
	speed: 0.0143s/iter; left time: 148.7084s
	iters: 500, epoch: 2 | loss: 0.2057789
	speed: 0.0142s/iter; left time: 147.1770s
Epoch: 2 cost time: 8.450984239578247
Epoch: 2, Steps: 570 | Train Loss: 0.2377276 Vali Loss: 0.0728795 Test Loss: 0.2161092
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3237036
	speed: 0.0477s/iter; left time: 484.6333s
	iters: 200, epoch: 3 | loss: 0.1564135
	speed: 0.0143s/iter; left time: 144.0003s
	iters: 300, epoch: 3 | loss: 0.3661249
	speed: 0.0143s/iter; left time: 142.3225s
	iters: 400, epoch: 3 | loss: 0.1727637
	speed: 0.0143s/iter; left time: 140.9605s
	iters: 500, epoch: 3 | loss: 0.2421882
	speed: 0.0143s/iter; left time: 139.6944s
Epoch: 3 cost time: 8.454082489013672
Epoch: 3, Steps: 570 | Train Loss: 0.2786699 Vali Loss: 0.0570485 Test Loss: 0.1763236
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2777259
	speed: 0.0450s/iter; left time: 431.5252s
	iters: 200, epoch: 4 | loss: 0.2660138
	speed: 0.0143s/iter; left time: 135.2996s
	iters: 300, epoch: 4 | loss: 0.3011681
	speed: 0.0143s/iter; left time: 134.1504s
	iters: 400, epoch: 4 | loss: 0.1803908
	speed: 0.0142s/iter; left time: 132.2711s
	iters: 500, epoch: 4 | loss: 0.1449819
	speed: 0.0143s/iter; left time: 131.0388s
Epoch: 4 cost time: 8.4141526222229
Epoch: 4, Steps: 570 | Train Loss: 0.2481087 Vali Loss: 0.0525879 Test Loss: 0.1558835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.149746373295784, mae:0.24280180037021637
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1354365
	speed: 0.0258s/iter; left time: 292.0768s
	iters: 200, epoch: 1 | loss: 0.3682787
	speed: 0.0142s/iter; left time: 158.9420s
	iters: 300, epoch: 1 | loss: 0.2754350
	speed: 0.0142s/iter; left time: 157.2296s
	iters: 400, epoch: 1 | loss: 0.2626590
	speed: 0.0142s/iter; left time: 156.1920s
	iters: 500, epoch: 1 | loss: 0.2970988
	speed: 0.0142s/iter; left time: 154.6230s
Epoch: 1 cost time: 9.303525447845459
Epoch: 1, Steps: 570 | Train Loss: 0.2840688 Vali Loss: 0.0640136 Test Loss: 0.1812901
Validation loss decreased (inf --> 0.064014).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2767709
	speed: 0.0461s/iter; left time: 494.8299s
	iters: 200, epoch: 2 | loss: 0.1961362
	speed: 0.0142s/iter; left time: 151.0802s
	iters: 300, epoch: 2 | loss: 0.1926715
	speed: 0.0142s/iter; left time: 149.4947s
	iters: 400, epoch: 2 | loss: 0.2650085
	speed: 0.0142s/iter; left time: 148.0944s
	iters: 500, epoch: 2 | loss: 0.3407041
	speed: 0.0142s/iter; left time: 146.8379s
Epoch: 2 cost time: 8.41737675666809
Epoch: 2, Steps: 570 | Train Loss: 0.2870881 Vali Loss: 0.0582459 Test Loss: 0.1693398
Validation loss decreased (0.064014 --> 0.058246).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2637312
	speed: 0.0462s/iter; left time: 469.5869s
	iters: 200, epoch: 3 | loss: 0.3161782
	speed: 0.0142s/iter; left time: 142.7490s
	iters: 300, epoch: 3 | loss: 0.2022959
	speed: 0.0142s/iter; left time: 141.7467s
	iters: 400, epoch: 3 | loss: 0.2054545
	speed: 0.0142s/iter; left time: 139.8869s
	iters: 500, epoch: 3 | loss: 0.2705434
	speed: 0.0142s/iter; left time: 138.6895s
Epoch: 3 cost time: 8.363610029220581
Epoch: 3, Steps: 570 | Train Loss: 0.2598173 Vali Loss: 0.0578059 Test Loss: 0.1630261
Validation loss decreased (0.058246 --> 0.057806).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2894474
	speed: 0.0453s/iter; left time: 434.7892s
	iters: 200, epoch: 4 | loss: 0.2260659
	speed: 0.0143s/iter; left time: 135.7626s
	iters: 300, epoch: 4 | loss: 0.2424885
	speed: 0.0143s/iter; left time: 134.1040s
	iters: 400, epoch: 4 | loss: 0.2020031
	speed: 0.0142s/iter; left time: 132.2669s
	iters: 500, epoch: 4 | loss: 0.1781809
	speed: 0.0141s/iter; left time: 129.9907s
Epoch: 4 cost time: 8.393113613128662
Epoch: 4, Steps: 570 | Train Loss: 0.2434683 Vali Loss: 0.0540485 Test Loss: 0.1607744
Validation loss decreased (0.057806 --> 0.054049).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2027901
	speed: 0.0462s/iter; left time: 416.6592s
	iters: 200, epoch: 5 | loss: 0.3091655
	speed: 0.0142s/iter; left time: 127.0882s
	iters: 300, epoch: 5 | loss: 0.1973173
	speed: 0.0143s/iter; left time: 125.8944s
	iters: 400, epoch: 5 | loss: 0.3333797
	speed: 0.0143s/iter; left time: 124.2778s
	iters: 500, epoch: 5 | loss: 0.2070854
	speed: 0.0142s/iter; left time: 122.3446s
Epoch: 5 cost time: 8.42149043083191
Epoch: 5, Steps: 570 | Train Loss: 0.2325874 Vali Loss: 0.0519195 Test Loss: 0.1577916
Validation loss decreased (0.054049 --> 0.051919).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2825751
	speed: 0.0466s/iter; left time: 393.7059s
	iters: 200, epoch: 6 | loss: 0.2050829
	speed: 0.0141s/iter; left time: 117.9566s
	iters: 300, epoch: 6 | loss: 0.1434190
	speed: 0.0142s/iter; left time: 116.8035s
	iters: 400, epoch: 6 | loss: 0.2691714
	speed: 0.0141s/iter; left time: 115.3095s
	iters: 500, epoch: 6 | loss: 0.1810805
	speed: 0.0141s/iter; left time: 113.6816s
Epoch: 6 cost time: 8.358530282974243
Epoch: 6, Steps: 570 | Train Loss: 0.2260295 Vali Loss: 0.0501509 Test Loss: 0.1582185
Validation loss decreased (0.051919 --> 0.050151).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3239396
	speed: 0.0480s/iter; left time: 378.5184s
	iters: 200, epoch: 7 | loss: 0.1413668
	speed: 0.0160s/iter; left time: 124.5593s
	iters: 300, epoch: 7 | loss: 0.1768094
	speed: 0.0146s/iter; left time: 112.1163s
	iters: 400, epoch: 7 | loss: 0.3414020
	speed: 0.0143s/iter; left time: 108.2872s
	iters: 500, epoch: 7 | loss: 0.2191450
	speed: 0.0143s/iter; left time: 106.8693s
Epoch: 7 cost time: 8.821830749511719
Epoch: 7, Steps: 570 | Train Loss: 0.2243734 Vali Loss: 0.0499334 Test Loss: 0.1556317
Validation loss decreased (0.050151 --> 0.049933).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1709580
	speed: 0.0453s/iter; left time: 331.1416s
	iters: 200, epoch: 8 | loss: 0.2004823
	speed: 0.0142s/iter; left time: 102.7290s
	iters: 300, epoch: 8 | loss: 0.2172453
	speed: 0.0142s/iter; left time: 101.1824s
	iters: 400, epoch: 8 | loss: 0.1888614
	speed: 0.0142s/iter; left time: 99.6524s
	iters: 500, epoch: 8 | loss: 0.1446288
	speed: 0.0142s/iter; left time: 98.2593s
Epoch: 8 cost time: 8.40392780303955
Epoch: 8, Steps: 570 | Train Loss: 0.2232421 Vali Loss: 0.0503342 Test Loss: 0.1561412
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2895650
	speed: 0.0466s/iter; left time: 313.8570s
	iters: 200, epoch: 9 | loss: 0.1684789
	speed: 0.0142s/iter; left time: 94.5205s
	iters: 300, epoch: 9 | loss: 0.1635505
	speed: 0.0143s/iter; left time: 93.3174s
	iters: 400, epoch: 9 | loss: 0.1515073
	speed: 0.0142s/iter; left time: 91.6524s
	iters: 500, epoch: 9 | loss: 0.2116920
	speed: 0.0142s/iter; left time: 90.1513s
Epoch: 9 cost time: 8.41294002532959
Epoch: 9, Steps: 570 | Train Loss: 0.2210441 Vali Loss: 0.0499185 Test Loss: 0.1554581
Validation loss decreased (0.049933 --> 0.049918).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2955706
	speed: 0.0450s/iter; left time: 277.8465s
	iters: 200, epoch: 10 | loss: 0.2255763
	speed: 0.0142s/iter; left time: 85.9282s
	iters: 300, epoch: 10 | loss: 0.1939872
	speed: 0.0142s/iter; left time: 84.6683s
	iters: 400, epoch: 10 | loss: 0.2501310
	speed: 0.0142s/iter; left time: 83.0876s
	iters: 500, epoch: 10 | loss: 0.2223947
	speed: 0.0141s/iter; left time: 81.5770s
Epoch: 10 cost time: 8.3395357131958
Epoch: 10, Steps: 570 | Train Loss: 0.2197289 Vali Loss: 0.0500757 Test Loss: 0.1554331
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2479482
	speed: 0.0447s/iter; left time: 250.4171s
	iters: 200, epoch: 11 | loss: 0.1726053
	speed: 0.0141s/iter; left time: 77.8081s
	iters: 300, epoch: 11 | loss: 0.1634731
	speed: 0.0141s/iter; left time: 76.3743s
	iters: 400, epoch: 11 | loss: 0.2541782
	speed: 0.0142s/iter; left time: 75.0262s
	iters: 500, epoch: 11 | loss: 0.1446469
	speed: 0.0141s/iter; left time: 73.5528s
Epoch: 11 cost time: 8.322649240493774
Epoch: 11, Steps: 570 | Train Loss: 0.2199666 Vali Loss: 0.0500236 Test Loss: 0.1554699
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1390455
	speed: 0.0449s/iter; left time: 225.8550s
	iters: 200, epoch: 12 | loss: 0.1907740
	speed: 0.0141s/iter; left time: 69.7550s
	iters: 300, epoch: 12 | loss: 0.2275511
	speed: 0.0141s/iter; left time: 68.2532s
	iters: 400, epoch: 12 | loss: 0.1400598
	speed: 0.0142s/iter; left time: 66.9738s
	iters: 500, epoch: 12 | loss: 0.2891672
	speed: 0.0142s/iter; left time: 65.8630s
Epoch: 12 cost time: 8.354542016983032
Epoch: 12, Steps: 570 | Train Loss: 0.2222741 Vali Loss: 0.0498362 Test Loss: 0.1554103
Validation loss decreased (0.049918 --> 0.049836).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1693378
	speed: 0.0453s/iter; left time: 202.1412s
	iters: 200, epoch: 13 | loss: 0.1841998
	speed: 0.0142s/iter; left time: 62.0056s
	iters: 300, epoch: 13 | loss: 0.2378055
	speed: 0.0142s/iter; left time: 60.4549s
	iters: 400, epoch: 13 | loss: 0.2329025
	speed: 0.0142s/iter; left time: 59.0315s
	iters: 500, epoch: 13 | loss: 0.2395816
	speed: 0.0142s/iter; left time: 57.6496s
Epoch: 13 cost time: 8.4007089138031
Epoch: 13, Steps: 570 | Train Loss: 0.2195402 Vali Loss: 0.0501228 Test Loss: 0.1554241
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1925913
	speed: 0.0479s/iter; left time: 186.2290s
	iters: 200, epoch: 14 | loss: 0.2345678
	speed: 0.0142s/iter; left time: 53.7091s
	iters: 300, epoch: 14 | loss: 0.1716644
	speed: 0.0142s/iter; left time: 52.2926s
	iters: 400, epoch: 14 | loss: 0.2786288
	speed: 0.0142s/iter; left time: 50.8930s
	iters: 500, epoch: 14 | loss: 0.2081250
	speed: 0.0142s/iter; left time: 49.4987s
Epoch: 14 cost time: 8.38364863395691
Epoch: 14, Steps: 570 | Train Loss: 0.2213041 Vali Loss: 0.0503268 Test Loss: 0.1554163
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2340338
	speed: 0.0493s/iter; left time: 163.7426s
	iters: 200, epoch: 15 | loss: 0.1625172
	speed: 0.0159s/iter; left time: 51.3392s
	iters: 300, epoch: 15 | loss: 0.2733411
	speed: 0.0146s/iter; left time: 45.5025s
	iters: 400, epoch: 15 | loss: 0.2272985
	speed: 0.0141s/iter; left time: 42.6945s
	iters: 500, epoch: 15 | loss: 0.1665039
	speed: 0.0141s/iter; left time: 41.2589s
Epoch: 15 cost time: 8.73994755744934
Epoch: 15, Steps: 570 | Train Loss: 0.2200371 Vali Loss: 0.0499670 Test Loss: 0.1554104
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15562692284584045, mae:0.2503296732902527
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4231477
	speed: 0.0291s/iter; left time: 329.4019s
	iters: 200, epoch: 1 | loss: 0.2990322
	speed: 0.0169s/iter; left time: 189.7172s
	iters: 300, epoch: 1 | loss: 0.4513031
	speed: 0.0169s/iter; left time: 188.0459s
	iters: 400, epoch: 1 | loss: 0.2904619
	speed: 0.0170s/iter; left time: 186.7571s
	iters: 500, epoch: 1 | loss: 0.2761419
	speed: 0.0170s/iter; left time: 184.8584s
Epoch: 1 cost time: 10.931333541870117
Epoch: 1, Steps: 570 | Train Loss: 0.3566688 Vali Loss: 0.0702681 Test Loss: 0.1946494
Validation loss decreased (inf --> 0.070268).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4136405
	speed: 0.0526s/iter; left time: 564.3414s
	iters: 200, epoch: 2 | loss: 0.3237491
	speed: 0.0169s/iter; left time: 180.1460s
	iters: 300, epoch: 2 | loss: 0.3927438
	speed: 0.0170s/iter; left time: 178.5594s
	iters: 400, epoch: 2 | loss: 0.2460304
	speed: 0.0169s/iter; left time: 176.3367s
	iters: 500, epoch: 2 | loss: 0.3138577
	speed: 0.0169s/iter; left time: 174.6559s
Epoch: 2 cost time: 9.981170415878296
Epoch: 2, Steps: 570 | Train Loss: 0.3107000 Vali Loss: 0.0631987 Test Loss: 0.1842450
Validation loss decreased (0.070268 --> 0.063199).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2380202
	speed: 0.0524s/iter; left time: 532.3122s
	iters: 200, epoch: 3 | loss: 0.2695333
	speed: 0.0170s/iter; left time: 171.3926s
	iters: 300, epoch: 3 | loss: 0.4293661
	speed: 0.0170s/iter; left time: 169.1790s
	iters: 400, epoch: 3 | loss: 0.2429115
	speed: 0.0170s/iter; left time: 167.3648s
	iters: 500, epoch: 3 | loss: 0.2631704
	speed: 0.0170s/iter; left time: 165.9104s
Epoch: 3 cost time: 10.025473594665527
Epoch: 3, Steps: 570 | Train Loss: 0.2844806 Vali Loss: 0.0596799 Test Loss: 0.1749096
Validation loss decreased (0.063199 --> 0.059680).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3597705
	speed: 0.0516s/iter; left time: 495.1564s
	iters: 200, epoch: 4 | loss: 0.3170551
	speed: 0.0170s/iter; left time: 161.4512s
	iters: 300, epoch: 4 | loss: 0.2862722
	speed: 0.0170s/iter; left time: 159.9076s
	iters: 400, epoch: 4 | loss: 0.3588545
	speed: 0.0170s/iter; left time: 158.0995s
	iters: 500, epoch: 4 | loss: 0.2317751
	speed: 0.0170s/iter; left time: 156.3508s
Epoch: 4 cost time: 10.040975570678711
Epoch: 4, Steps: 570 | Train Loss: 0.2729959 Vali Loss: 0.0586416 Test Loss: 0.1634108
Validation loss decreased (0.059680 --> 0.058642).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1480240
	speed: 0.0527s/iter; left time: 474.9625s
	iters: 200, epoch: 5 | loss: 0.2854924
	speed: 0.0171s/iter; left time: 152.1080s
	iters: 300, epoch: 5 | loss: 0.2601712
	speed: 0.0171s/iter; left time: 150.5164s
	iters: 400, epoch: 5 | loss: 0.2432022
	speed: 0.0170s/iter; left time: 148.6426s
	iters: 500, epoch: 5 | loss: 0.2031509
	speed: 0.0170s/iter; left time: 146.7921s
Epoch: 5 cost time: 10.021342754364014
Epoch: 5, Steps: 570 | Train Loss: 0.2617277 Vali Loss: 0.0552872 Test Loss: 0.1606847
Validation loss decreased (0.058642 --> 0.055287).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3094109
	speed: 0.0511s/iter; left time: 432.2128s
	iters: 200, epoch: 6 | loss: 0.2309000
	speed: 0.0169s/iter; left time: 141.4348s
	iters: 300, epoch: 6 | loss: 0.2965054
	speed: 0.0169s/iter; left time: 139.8543s
	iters: 400, epoch: 6 | loss: 0.3793553
	speed: 0.0169s/iter; left time: 137.9724s
	iters: 500, epoch: 6 | loss: 0.1989893
	speed: 0.0169s/iter; left time: 136.1369s
Epoch: 6 cost time: 9.971482515335083
Epoch: 6, Steps: 570 | Train Loss: 0.2568656 Vali Loss: 0.0557706 Test Loss: 0.1589244
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1992728
	speed: 0.0504s/iter; left time: 396.8560s
	iters: 200, epoch: 7 | loss: 0.2386451
	speed: 0.0170s/iter; left time: 131.9289s
	iters: 300, epoch: 7 | loss: 0.3433176
	speed: 0.0170s/iter; left time: 130.4022s
	iters: 400, epoch: 7 | loss: 0.1856261
	speed: 0.0170s/iter; left time: 128.6055s
	iters: 500, epoch: 7 | loss: 0.2049061
	speed: 0.0172s/iter; left time: 128.9989s
Epoch: 7 cost time: 10.095287561416626
Epoch: 7, Steps: 570 | Train Loss: 0.2552189 Vali Loss: 0.0553833 Test Loss: 0.1578540
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2772514
	speed: 0.0524s/iter; left time: 382.9626s
	iters: 200, epoch: 8 | loss: 0.1852691
	speed: 0.0181s/iter; left time: 130.5957s
	iters: 300, epoch: 8 | loss: 0.2553893
	speed: 0.0170s/iter; left time: 120.8605s
	iters: 400, epoch: 8 | loss: 0.1523726
	speed: 0.0170s/iter; left time: 119.0187s
	iters: 500, epoch: 8 | loss: 0.1697097
	speed: 0.0169s/iter; left time: 117.0782s
Epoch: 8 cost time: 10.168155908584595
Epoch: 8, Steps: 570 | Train Loss: 0.2544855 Vali Loss: 0.0552160 Test Loss: 0.1583025
Validation loss decreased (0.055287 --> 0.055216).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2468323
	speed: 0.0510s/iter; left time: 343.8934s
	iters: 200, epoch: 9 | loss: 0.1402135
	speed: 0.0169s/iter; left time: 112.1503s
	iters: 300, epoch: 9 | loss: 0.2766612
	speed: 0.0169s/iter; left time: 110.5296s
	iters: 400, epoch: 9 | loss: 0.2861530
	speed: 0.0169s/iter; left time: 108.9696s
	iters: 500, epoch: 9 | loss: 0.3543449
	speed: 0.0169s/iter; left time: 107.4131s
Epoch: 9 cost time: 9.955261945724487
Epoch: 9, Steps: 570 | Train Loss: 0.2515577 Vali Loss: 0.0554824 Test Loss: 0.1580071
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3629105
	speed: 0.0526s/iter; left time: 324.6268s
	iters: 200, epoch: 10 | loss: 0.1137268
	speed: 0.0182s/iter; left time: 110.5788s
	iters: 300, epoch: 10 | loss: 0.3536044
	speed: 0.0181s/iter; left time: 108.3182s
	iters: 400, epoch: 10 | loss: 0.3374973
	speed: 0.0181s/iter; left time: 106.3650s
	iters: 500, epoch: 10 | loss: 0.2181917
	speed: 0.0181s/iter; left time: 104.5283s
Epoch: 10 cost time: 10.669760704040527
Epoch: 10, Steps: 570 | Train Loss: 0.2517068 Vali Loss: 0.0553969 Test Loss: 0.1578377
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1954637
	speed: 0.0548s/iter; left time: 307.1021s
	iters: 200, epoch: 11 | loss: 0.2611381
	speed: 0.0181s/iter; left time: 99.5500s
	iters: 300, epoch: 11 | loss: 0.1358562
	speed: 0.0181s/iter; left time: 97.7329s
	iters: 400, epoch: 11 | loss: 0.2665876
	speed: 0.0181s/iter; left time: 95.9436s
	iters: 500, epoch: 11 | loss: 0.3374287
	speed: 0.0181s/iter; left time: 94.1596s
Epoch: 11 cost time: 10.586496114730835
Epoch: 11, Steps: 570 | Train Loss: 0.2517991 Vali Loss: 0.0553704 Test Loss: 0.1576126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15853843092918396, mae:0.2533927857875824
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2764733
	speed: 0.0300s/iter; left time: 338.7080s
	iters: 200, epoch: 1 | loss: 0.2327543
	speed: 0.0179s/iter; left time: 200.4128s
	iters: 300, epoch: 1 | loss: 0.3357033
	speed: 0.0179s/iter; left time: 198.7022s
	iters: 400, epoch: 1 | loss: 0.3047566
	speed: 0.0179s/iter; left time: 196.9367s
	iters: 500, epoch: 1 | loss: 0.1972861
	speed: 0.0179s/iter; left time: 195.2159s
Epoch: 1 cost time: 11.45805811882019
Epoch: 1, Steps: 570 | Train Loss: 0.3256827 Vali Loss: 0.0674371 Test Loss: 0.1923324
Validation loss decreased (inf --> 0.067437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2472515
	speed: 0.0524s/iter; left time: 561.9929s
	iters: 200, epoch: 2 | loss: 0.1821082
	speed: 0.0180s/iter; left time: 191.2611s
	iters: 300, epoch: 2 | loss: 0.3611526
	speed: 0.0180s/iter; left time: 189.5165s
	iters: 400, epoch: 2 | loss: 0.4608039
	speed: 0.0180s/iter; left time: 187.7903s
	iters: 500, epoch: 2 | loss: 0.3331698
	speed: 0.0180s/iter; left time: 185.8668s
Epoch: 2 cost time: 10.553991556167603
Epoch: 2, Steps: 570 | Train Loss: 0.3138315 Vali Loss: 0.0646692 Test Loss: 0.1826266
Validation loss decreased (0.067437 --> 0.064669).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3125826
	speed: 0.0525s/iter; left time: 533.0140s
	iters: 200, epoch: 3 | loss: 0.3133857
	speed: 0.0180s/iter; left time: 180.6758s
	iters: 300, epoch: 3 | loss: 0.1997578
	speed: 0.0179s/iter; left time: 178.7409s
	iters: 400, epoch: 3 | loss: 0.3287965
	speed: 0.0180s/iter; left time: 177.1378s
	iters: 500, epoch: 3 | loss: 0.1674982
	speed: 0.0179s/iter; left time: 175.1309s
Epoch: 3 cost time: 10.521435976028442
Epoch: 3, Steps: 570 | Train Loss: 0.2841374 Vali Loss: 0.0582497 Test Loss: 0.1715780
Validation loss decreased (0.064669 --> 0.058250).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1959866
	speed: 0.0544s/iter; left time: 522.0438s
	iters: 200, epoch: 4 | loss: 0.6555514
	speed: 0.0180s/iter; left time: 170.7332s
	iters: 300, epoch: 4 | loss: 0.2739381
	speed: 0.0180s/iter; left time: 168.7947s
	iters: 400, epoch: 4 | loss: 0.1755477
	speed: 0.0180s/iter; left time: 166.9206s
	iters: 500, epoch: 4 | loss: 0.3965024
	speed: 0.0180s/iter; left time: 165.1195s
Epoch: 4 cost time: 10.541162967681885
Epoch: 4, Steps: 570 | Train Loss: 0.2689576 Vali Loss: 0.0583956 Test Loss: 0.1655976
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2582152
	speed: 0.0520s/iter; left time: 469.4160s
	iters: 200, epoch: 5 | loss: 0.3659150
	speed: 0.0179s/iter; left time: 159.8561s
	iters: 300, epoch: 5 | loss: 0.2310751
	speed: 0.0179s/iter; left time: 158.1118s
	iters: 400, epoch: 5 | loss: 0.1816646
	speed: 0.0179s/iter; left time: 156.0907s
	iters: 500, epoch: 5 | loss: 0.3596244
	speed: 0.0179s/iter; left time: 154.5502s
Epoch: 5 cost time: 10.525245189666748
Epoch: 5, Steps: 570 | Train Loss: 0.2582919 Vali Loss: 0.0567488 Test Loss: 0.1616790
Validation loss decreased (0.058250 --> 0.056749).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2957802
	speed: 0.0537s/iter; left time: 453.9291s
	iters: 200, epoch: 6 | loss: 0.3656701
	speed: 0.0180s/iter; left time: 150.1993s
	iters: 300, epoch: 6 | loss: 0.5005087
	speed: 0.0180s/iter; left time: 148.4747s
	iters: 400, epoch: 6 | loss: 0.2646871
	speed: 0.0180s/iter; left time: 146.8020s
	iters: 500, epoch: 6 | loss: 0.2224196
	speed: 0.0180s/iter; left time: 144.9934s
Epoch: 6 cost time: 10.555970430374146
Epoch: 6, Steps: 570 | Train Loss: 0.2525463 Vali Loss: 0.0566615 Test Loss: 0.1613017
Validation loss decreased (0.056749 --> 0.056661).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2991766
	speed: 0.0526s/iter; left time: 414.9250s
	iters: 200, epoch: 7 | loss: 0.1717590
	speed: 0.0179s/iter; left time: 139.2728s
	iters: 300, epoch: 7 | loss: 0.2409506
	speed: 0.0179s/iter; left time: 137.5046s
	iters: 400, epoch: 7 | loss: 0.3314831
	speed: 0.0179s/iter; left time: 135.7222s
	iters: 500, epoch: 7 | loss: 0.3442245
	speed: 0.0179s/iter; left time: 133.9444s
Epoch: 7 cost time: 10.513476610183716
Epoch: 7, Steps: 570 | Train Loss: 0.2513187 Vali Loss: 0.0563184 Test Loss: 0.1605487
Validation loss decreased (0.056661 --> 0.056318).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1689795
	speed: 0.0526s/iter; left time: 384.4188s
	iters: 200, epoch: 8 | loss: 0.3971741
	speed: 0.0179s/iter; left time: 129.2206s
	iters: 300, epoch: 8 | loss: 0.3039874
	speed: 0.0179s/iter; left time: 127.3856s
	iters: 400, epoch: 8 | loss: 0.2689097
	speed: 0.0179s/iter; left time: 125.4902s
	iters: 500, epoch: 8 | loss: 0.2332681
	speed: 0.0179s/iter; left time: 123.7218s
Epoch: 8 cost time: 10.527833700180054
Epoch: 8, Steps: 570 | Train Loss: 0.2480591 Vali Loss: 0.0560904 Test Loss: 0.1599616
Validation loss decreased (0.056318 --> 0.056090).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1714244
	speed: 0.0552s/iter; left time: 371.9745s
	iters: 200, epoch: 9 | loss: 0.2399662
	speed: 0.0179s/iter; left time: 118.8583s
	iters: 300, epoch: 9 | loss: 0.1432478
	speed: 0.0179s/iter; left time: 117.1783s
	iters: 400, epoch: 9 | loss: 0.2058955
	speed: 0.0179s/iter; left time: 115.1671s
	iters: 500, epoch: 9 | loss: 0.1150765
	speed: 0.0179s/iter; left time: 113.2646s
Epoch: 9 cost time: 10.511715412139893
Epoch: 9, Steps: 570 | Train Loss: 0.2479948 Vali Loss: 0.0558472 Test Loss: 0.1595002
Validation loss decreased (0.056090 --> 0.055847).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3212492
	speed: 0.0510s/iter; left time: 314.4371s
	iters: 200, epoch: 10 | loss: 0.2343052
	speed: 0.0163s/iter; left time: 98.7893s
	iters: 300, epoch: 10 | loss: 0.1787103
	speed: 0.0163s/iter; left time: 97.1640s
	iters: 400, epoch: 10 | loss: 0.2474824
	speed: 0.0163s/iter; left time: 95.5734s
	iters: 500, epoch: 10 | loss: 0.1732036
	speed: 0.0163s/iter; left time: 93.9896s
Epoch: 10 cost time: 9.607587814331055
Epoch: 10, Steps: 570 | Train Loss: 0.2465933 Vali Loss: 0.0556785 Test Loss: 0.1596540
Validation loss decreased (0.055847 --> 0.055678).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1643394
	speed: 0.0499s/iter; left time: 279.5078s
	iters: 200, epoch: 11 | loss: 0.1678609
	speed: 0.0164s/iter; left time: 90.0541s
	iters: 300, epoch: 11 | loss: 0.2018326
	speed: 0.0164s/iter; left time: 88.4867s
	iters: 400, epoch: 11 | loss: 0.2276821
	speed: 0.0164s/iter; left time: 86.8054s
	iters: 500, epoch: 11 | loss: 0.1991215
	speed: 0.0164s/iter; left time: 85.1634s
Epoch: 11 cost time: 9.657196760177612
Epoch: 11, Steps: 570 | Train Loss: 0.2476586 Vali Loss: 0.0559690 Test Loss: 0.1596856
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1573327
	speed: 0.0491s/iter; left time: 246.7741s
	iters: 200, epoch: 12 | loss: 0.2785705
	speed: 0.0163s/iter; left time: 80.6146s
	iters: 300, epoch: 12 | loss: 0.1592060
	speed: 0.0163s/iter; left time: 78.9764s
	iters: 400, epoch: 12 | loss: 0.2363529
	speed: 0.0163s/iter; left time: 77.3456s
	iters: 500, epoch: 12 | loss: 0.3511350
	speed: 0.0163s/iter; left time: 75.6901s
Epoch: 12 cost time: 9.594619274139404
Epoch: 12, Steps: 570 | Train Loss: 0.2443652 Vali Loss: 0.0558417 Test Loss: 0.1596739
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3338568
	speed: 0.0509s/iter; left time: 227.1500s
	iters: 200, epoch: 13 | loss: 0.2935806
	speed: 0.0164s/iter; left time: 71.4410s
	iters: 300, epoch: 13 | loss: 0.2703342
	speed: 0.0164s/iter; left time: 69.7927s
	iters: 400, epoch: 13 | loss: 0.1846772
	speed: 0.0164s/iter; left time: 68.1469s
	iters: 500, epoch: 13 | loss: 0.2558920
	speed: 0.0164s/iter; left time: 66.5346s
Epoch: 13 cost time: 9.641987323760986
Epoch: 13, Steps: 570 | Train Loss: 0.2451861 Vali Loss: 0.0559950 Test Loss: 0.1596886
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15988914668560028, mae:0.255709171295166
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3528516
	speed: 0.0271s/iter; left time: 306.4168s
	iters: 200, epoch: 1 | loss: 0.3574461
	speed: 0.0154s/iter; left time: 172.5331s
	iters: 300, epoch: 1 | loss: 0.2459876
	speed: 0.0154s/iter; left time: 170.6570s
	iters: 400, epoch: 1 | loss: 0.3437310
	speed: 0.0154s/iter; left time: 169.5908s
	iters: 500, epoch: 1 | loss: 0.5735512
	speed: 0.0154s/iter; left time: 168.2200s
Epoch: 1 cost time: 10.004918813705444
Epoch: 1, Steps: 570 | Train Loss: 0.3299547 Vali Loss: 0.0726970 Test Loss: 0.1894750
Validation loss decreased (inf --> 0.072697).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4155256
	speed: 0.0514s/iter; left time: 551.1155s
	iters: 200, epoch: 2 | loss: 0.1897063
	speed: 0.0154s/iter; left time: 164.1380s
	iters: 300, epoch: 2 | loss: 0.3088529
	speed: 0.0154s/iter; left time: 162.2370s
	iters: 400, epoch: 2 | loss: 0.3127601
	speed: 0.0154s/iter; left time: 160.6653s
	iters: 500, epoch: 2 | loss: 0.4591195
	speed: 0.0154s/iter; left time: 159.0609s
Epoch: 2 cost time: 9.084067106246948
Epoch: 2, Steps: 570 | Train Loss: 0.3048152 Vali Loss: 0.0728215 Test Loss: 0.1978776
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3362475
	speed: 0.0493s/iter; left time: 501.0565s
	iters: 200, epoch: 3 | loss: 0.1796288
	speed: 0.0154s/iter; left time: 154.6287s
	iters: 300, epoch: 3 | loss: 0.3259010
	speed: 0.0154s/iter; left time: 153.3527s
	iters: 400, epoch: 3 | loss: 0.3156268
	speed: 0.0154s/iter; left time: 151.7336s
	iters: 500, epoch: 3 | loss: 0.2664908
	speed: 0.0153s/iter; left time: 149.7955s
Epoch: 3 cost time: 9.12300157546997
Epoch: 3, Steps: 570 | Train Loss: 0.3005098 Vali Loss: 0.0633868 Test Loss: 0.1851613
Validation loss decreased (0.072697 --> 0.063387).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2100977
	speed: 0.0481s/iter; left time: 461.1915s
	iters: 200, epoch: 4 | loss: 0.3616856
	speed: 0.0155s/iter; left time: 146.6556s
	iters: 300, epoch: 4 | loss: 0.4346203
	speed: 0.0155s/iter; left time: 145.1498s
	iters: 400, epoch: 4 | loss: 0.2474310
	speed: 0.0155s/iter; left time: 143.5607s
	iters: 500, epoch: 4 | loss: 0.3295820
	speed: 0.0154s/iter; left time: 141.9613s
Epoch: 4 cost time: 9.0999436378479
Epoch: 4, Steps: 570 | Train Loss: 0.2913144 Vali Loss: 0.0619122 Test Loss: 0.1752462
Validation loss decreased (0.063387 --> 0.061912).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3288084
	speed: 0.0479s/iter; left time: 432.4463s
	iters: 200, epoch: 5 | loss: 0.2195111
	speed: 0.0154s/iter; left time: 137.1683s
	iters: 300, epoch: 5 | loss: 0.2494730
	speed: 0.0154s/iter; left time: 135.6983s
	iters: 400, epoch: 5 | loss: 0.1984664
	speed: 0.0154s/iter; left time: 133.8758s
	iters: 500, epoch: 5 | loss: 0.2411065
	speed: 0.0153s/iter; left time: 132.1371s
Epoch: 5 cost time: 9.065420627593994
Epoch: 5, Steps: 570 | Train Loss: 0.2832449 Vali Loss: 0.0608572 Test Loss: 0.1716351
Validation loss decreased (0.061912 --> 0.060857).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3289462
	speed: 0.0523s/iter; left time: 441.9574s
	iters: 200, epoch: 6 | loss: 0.2251569
	speed: 0.0160s/iter; left time: 133.9290s
	iters: 300, epoch: 6 | loss: 0.1530811
	speed: 0.0154s/iter; left time: 127.1787s
	iters: 400, epoch: 6 | loss: 0.1735361
	speed: 0.0154s/iter; left time: 125.6118s
	iters: 500, epoch: 6 | loss: 0.2480948
	speed: 0.0154s/iter; left time: 123.7782s
Epoch: 6 cost time: 9.313013553619385
Epoch: 6, Steps: 570 | Train Loss: 0.2769288 Vali Loss: 0.0607782 Test Loss: 0.1672092
Validation loss decreased (0.060857 --> 0.060778).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2894515
	speed: 0.0510s/iter; left time: 401.9395s
	iters: 200, epoch: 7 | loss: 0.2232478
	speed: 0.0154s/iter; left time: 119.4420s
	iters: 300, epoch: 7 | loss: 0.2083797
	speed: 0.0154s/iter; left time: 118.0243s
	iters: 400, epoch: 7 | loss: 0.2925494
	speed: 0.0153s/iter; left time: 116.3652s
	iters: 500, epoch: 7 | loss: 0.2986919
	speed: 0.0153s/iter; left time: 114.8158s
Epoch: 7 cost time: 9.051892757415771
Epoch: 7, Steps: 570 | Train Loss: 0.2726304 Vali Loss: 0.0607205 Test Loss: 0.1663236
Validation loss decreased (0.060778 --> 0.060720).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2765966
	speed: 0.0475s/iter; left time: 346.9877s
	iters: 200, epoch: 8 | loss: 0.3518615
	speed: 0.0154s/iter; left time: 111.1124s
	iters: 300, epoch: 8 | loss: 0.1765554
	speed: 0.0154s/iter; left time: 109.5369s
	iters: 400, epoch: 8 | loss: 0.2702326
	speed: 0.0154s/iter; left time: 107.8100s
	iters: 500, epoch: 8 | loss: 0.2131765
	speed: 0.0154s/iter; left time: 106.1331s
Epoch: 8 cost time: 9.078426599502563
Epoch: 8, Steps: 570 | Train Loss: 0.2694661 Vali Loss: 0.0601330 Test Loss: 0.1655186
Validation loss decreased (0.060720 --> 0.060133).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2739267
	speed: 0.0485s/iter; left time: 326.8870s
	iters: 200, epoch: 9 | loss: 0.3057661
	speed: 0.0154s/iter; left time: 102.4231s
	iters: 300, epoch: 9 | loss: 0.2766374
	speed: 0.0154s/iter; left time: 100.8908s
	iters: 400, epoch: 9 | loss: 0.1855141
	speed: 0.0154s/iter; left time: 99.3426s
	iters: 500, epoch: 9 | loss: 0.2378395
	speed: 0.0154s/iter; left time: 97.7886s
Epoch: 9 cost time: 9.108720541000366
Epoch: 9, Steps: 570 | Train Loss: 0.2694652 Vali Loss: 0.0601589 Test Loss: 0.1652751
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2965716
	speed: 0.0512s/iter; left time: 315.7919s
	iters: 200, epoch: 10 | loss: 0.3119071
	speed: 0.0156s/iter; left time: 94.7444s
	iters: 300, epoch: 10 | loss: 0.1638429
	speed: 0.0154s/iter; left time: 91.7190s
	iters: 400, epoch: 10 | loss: 0.3317775
	speed: 0.0154s/iter; left time: 90.3136s
	iters: 500, epoch: 10 | loss: 0.5118732
	speed: 0.0154s/iter; left time: 88.7347s
Epoch: 10 cost time: 9.22945499420166
Epoch: 10, Steps: 570 | Train Loss: 0.2700157 Vali Loss: 0.0602742 Test Loss: 0.1647697
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2693446
	speed: 0.0475s/iter; left time: 266.1417s
	iters: 200, epoch: 11 | loss: 0.1961205
	speed: 0.0153s/iter; left time: 84.3814s
	iters: 300, epoch: 11 | loss: 0.2544862
	speed: 0.0153s/iter; left time: 82.8842s
	iters: 400, epoch: 11 | loss: 0.2897861
	speed: 0.0153s/iter; left time: 81.3048s
	iters: 500, epoch: 11 | loss: 0.3234709
	speed: 0.0153s/iter; left time: 79.8326s
Epoch: 11 cost time: 9.054192781448364
Epoch: 11, Steps: 570 | Train Loss: 0.2692987 Vali Loss: 0.0602649 Test Loss: 0.1648742
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16577757894992828, mae:0.26132142543792725
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2132039
	speed: 0.0315s/iter; left time: 355.5984s
	iters: 200, epoch: 1 | loss: 0.2482248
	speed: 0.0213s/iter; left time: 238.2305s
	iters: 300, epoch: 1 | loss: 0.4155103
	speed: 0.0212s/iter; left time: 235.8371s
	iters: 400, epoch: 1 | loss: 0.2788582
	speed: 0.0212s/iter; left time: 233.5968s
	iters: 500, epoch: 1 | loss: 0.2421324
	speed: 0.0208s/iter; left time: 226.5883s
Epoch: 1 cost time: 13.113003969192505
Epoch: 1, Steps: 570 | Train Loss: 0.2878056 Vali Loss: 0.0654367 Test Loss: 0.1771272
Validation loss decreased (inf --> 0.065437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5202433
	speed: 0.0587s/iter; left time: 629.9636s
	iters: 200, epoch: 2 | loss: 0.2306121
	speed: 0.0187s/iter; left time: 198.9606s
	iters: 300, epoch: 2 | loss: 0.2242718
	speed: 0.0187s/iter; left time: 196.6947s
	iters: 400, epoch: 2 | loss: 0.2614449
	speed: 0.0187s/iter; left time: 194.8847s
	iters: 500, epoch: 2 | loss: 0.2152333
	speed: 0.0187s/iter; left time: 192.7855s
Epoch: 2 cost time: 10.991939306259155
Epoch: 2, Steps: 570 | Train Loss: 0.2904823 Vali Loss: 0.0628499 Test Loss: 0.1861763
Validation loss decreased (0.065437 --> 0.062850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2092441
	speed: 0.0607s/iter; left time: 616.9825s
	iters: 200, epoch: 3 | loss: 0.3344850
	speed: 0.0214s/iter; left time: 215.5411s
	iters: 300, epoch: 3 | loss: 0.2349855
	speed: 0.0214s/iter; left time: 213.6113s
	iters: 400, epoch: 3 | loss: 0.1700952
	speed: 0.0214s/iter; left time: 211.0907s
	iters: 500, epoch: 3 | loss: 0.2035912
	speed: 0.0214s/iter; left time: 208.8304s
Epoch: 3 cost time: 12.514484643936157
Epoch: 3, Steps: 570 | Train Loss: 0.2683181 Vali Loss: 0.0603431 Test Loss: 0.1769986
Validation loss decreased (0.062850 --> 0.060343).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2909709
	speed: 0.0611s/iter; left time: 585.6879s
	iters: 200, epoch: 4 | loss: 0.3411694
	speed: 0.0215s/iter; left time: 203.8932s
	iters: 300, epoch: 4 | loss: 0.3257471
	speed: 0.0215s/iter; left time: 202.0165s
	iters: 400, epoch: 4 | loss: 0.1559393
	speed: 0.0215s/iter; left time: 199.5007s
	iters: 500, epoch: 4 | loss: 0.2574477
	speed: 0.0215s/iter; left time: 197.2979s
Epoch: 4 cost time: 12.547528266906738
Epoch: 4, Steps: 570 | Train Loss: 0.2628267 Vali Loss: 0.0567002 Test Loss: 0.1610373
Validation loss decreased (0.060343 --> 0.056700).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2836421
	speed: 0.0613s/iter; left time: 552.5825s
	iters: 200, epoch: 5 | loss: 0.2339277
	speed: 0.0214s/iter; left time: 190.9505s
	iters: 300, epoch: 5 | loss: 0.2372324
	speed: 0.0214s/iter; left time: 188.6712s
	iters: 400, epoch: 5 | loss: 0.2867775
	speed: 0.0214s/iter; left time: 186.5103s
	iters: 500, epoch: 5 | loss: 0.2466409
	speed: 0.0214s/iter; left time: 184.3611s
Epoch: 5 cost time: 12.501335382461548
Epoch: 5, Steps: 570 | Train Loss: 0.2554568 Vali Loss: 0.0538172 Test Loss: 0.1566114
Validation loss decreased (0.056700 --> 0.053817).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1382849
	speed: 0.0617s/iter; left time: 521.3643s
	iters: 200, epoch: 6 | loss: 0.2312297
	speed: 0.0203s/iter; left time: 169.2861s
	iters: 300, epoch: 6 | loss: 0.2006404
	speed: 0.0215s/iter; left time: 177.2562s
	iters: 400, epoch: 6 | loss: 0.2580297
	speed: 0.0215s/iter; left time: 175.4855s
	iters: 500, epoch: 6 | loss: 0.2003629
	speed: 0.0215s/iter; left time: 173.2800s
Epoch: 6 cost time: 12.455375671386719
Epoch: 6, Steps: 570 | Train Loss: 0.2458913 Vali Loss: 0.0522738 Test Loss: 0.1558172
Validation loss decreased (0.053817 --> 0.052274).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1853729
	speed: 0.0620s/iter; left time: 488.8613s
	iters: 200, epoch: 7 | loss: 0.2679348
	speed: 0.0187s/iter; left time: 145.2204s
	iters: 300, epoch: 7 | loss: 0.1970098
	speed: 0.0187s/iter; left time: 143.6898s
	iters: 400, epoch: 7 | loss: 0.2792156
	speed: 0.0187s/iter; left time: 141.6569s
	iters: 500, epoch: 7 | loss: 0.3566693
	speed: 0.0187s/iter; left time: 139.8331s
Epoch: 7 cost time: 11.318219900131226
Epoch: 7, Steps: 570 | Train Loss: 0.2409843 Vali Loss: 0.0515541 Test Loss: 0.1536989
Validation loss decreased (0.052274 --> 0.051554).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2299775
	speed: 0.0565s/iter; left time: 413.3109s
	iters: 200, epoch: 8 | loss: 0.2109481
	speed: 0.0186s/iter; left time: 134.4034s
	iters: 300, epoch: 8 | loss: 0.1976876
	speed: 0.0186s/iter; left time: 132.3593s
	iters: 400, epoch: 8 | loss: 0.3727143
	speed: 0.0186s/iter; left time: 130.6040s
	iters: 500, epoch: 8 | loss: 0.2535819
	speed: 0.0186s/iter; left time: 128.6455s
Epoch: 8 cost time: 10.908987760543823
Epoch: 8, Steps: 570 | Train Loss: 0.2374367 Vali Loss: 0.0513114 Test Loss: 0.1529048
Validation loss decreased (0.051554 --> 0.051311).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1614419
	speed: 0.0580s/iter; left time: 391.2884s
	iters: 200, epoch: 9 | loss: 0.3201469
	speed: 0.0186s/iter; left time: 123.7978s
	iters: 300, epoch: 9 | loss: 0.1190581
	speed: 0.0186s/iter; left time: 121.9433s
	iters: 400, epoch: 9 | loss: 0.2792606
	speed: 0.0186s/iter; left time: 120.0049s
	iters: 500, epoch: 9 | loss: 0.1153495
	speed: 0.0186s/iter; left time: 117.9354s
Epoch: 9 cost time: 10.950137615203857
Epoch: 9, Steps: 570 | Train Loss: 0.2353253 Vali Loss: 0.0511915 Test Loss: 0.1528212
Validation loss decreased (0.051311 --> 0.051191).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2203282
	speed: 0.0575s/iter; left time: 354.8125s
	iters: 200, epoch: 10 | loss: 0.2659106
	speed: 0.0187s/iter; left time: 113.2582s
	iters: 300, epoch: 10 | loss: 0.1446058
	speed: 0.0187s/iter; left time: 111.4611s
	iters: 400, epoch: 10 | loss: 0.2124428
	speed: 0.0187s/iter; left time: 109.5448s
	iters: 500, epoch: 10 | loss: 0.2000332
	speed: 0.0186s/iter; left time: 107.5315s
Epoch: 10 cost time: 10.925860404968262
Epoch: 10, Steps: 570 | Train Loss: 0.2360373 Vali Loss: 0.0511895 Test Loss: 0.1525097
Validation loss decreased (0.051191 --> 0.051189).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1884583
	speed: 0.0587s/iter; left time: 328.8971s
	iters: 200, epoch: 11 | loss: 0.3364536
	speed: 0.0209s/iter; left time: 115.0192s
	iters: 300, epoch: 11 | loss: 0.2422140
	speed: 0.0209s/iter; left time: 112.6270s
	iters: 400, epoch: 11 | loss: 0.1363387
	speed: 0.0209s/iter; left time: 110.5711s
	iters: 500, epoch: 11 | loss: 0.3151762
	speed: 0.0208s/iter; left time: 108.2375s
Epoch: 11 cost time: 12.183650493621826
Epoch: 11, Steps: 570 | Train Loss: 0.2365175 Vali Loss: 0.0511866 Test Loss: 0.1524168
Validation loss decreased (0.051189 --> 0.051187).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3024474
	speed: 0.0610s/iter; left time: 307.0287s
	iters: 200, epoch: 12 | loss: 0.3122122
	speed: 0.0187s/iter; left time: 92.2111s
	iters: 300, epoch: 12 | loss: 0.1375531
	speed: 0.0187s/iter; left time: 90.3159s
	iters: 400, epoch: 12 | loss: 0.2285809
	speed: 0.0187s/iter; left time: 88.6890s
	iters: 500, epoch: 12 | loss: 0.1865078
	speed: 0.0187s/iter; left time: 86.7205s
Epoch: 12 cost time: 10.990453004837036
Epoch: 12, Steps: 570 | Train Loss: 0.2352742 Vali Loss: 0.0509963 Test Loss: 0.1524491
Validation loss decreased (0.051187 --> 0.050996).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3926801
	speed: 0.0573s/iter; left time: 255.5781s
	iters: 200, epoch: 13 | loss: 0.2231462
	speed: 0.0187s/iter; left time: 81.5991s
	iters: 300, epoch: 13 | loss: 0.2874231
	speed: 0.0187s/iter; left time: 79.7364s
	iters: 400, epoch: 13 | loss: 0.1770340
	speed: 0.0187s/iter; left time: 77.7297s
	iters: 500, epoch: 13 | loss: 0.2780897
	speed: 0.0187s/iter; left time: 75.8323s
Epoch: 13 cost time: 10.971324920654297
Epoch: 13, Steps: 570 | Train Loss: 0.2350211 Vali Loss: 0.0510677 Test Loss: 0.1524323
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.3067077
	speed: 0.0599s/iter; left time: 233.1256s
	iters: 200, epoch: 14 | loss: 0.1708578
	speed: 0.0214s/iter; left time: 81.1304s
	iters: 300, epoch: 14 | loss: 0.1416878
	speed: 0.0214s/iter; left time: 79.0225s
	iters: 400, epoch: 14 | loss: 0.2449211
	speed: 0.0214s/iter; left time: 76.8447s
	iters: 500, epoch: 14 | loss: 0.2723967
	speed: 0.0214s/iter; left time: 74.6990s
Epoch: 14 cost time: 12.435030698776245
Epoch: 14, Steps: 570 | Train Loss: 0.2351534 Vali Loss: 0.0510622 Test Loss: 0.1524382
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1750597
	speed: 0.0631s/iter; left time: 209.4305s
	iters: 200, epoch: 15 | loss: 0.2392311
	speed: 0.0214s/iter; left time: 68.8741s
	iters: 300, epoch: 15 | loss: 0.1884887
	speed: 0.0214s/iter; left time: 66.7507s
	iters: 400, epoch: 15 | loss: 0.2420480
	speed: 0.0214s/iter; left time: 64.6097s
	iters: 500, epoch: 15 | loss: 0.1719001
	speed: 0.0214s/iter; left time: 62.4679s
Epoch: 15 cost time: 12.455493688583374
Epoch: 15, Steps: 570 | Train Loss: 0.2347518 Vali Loss: 0.0510754 Test Loss: 0.1524345
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15269137918949127, mae:0.24526135623455048
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4440405
	speed: 0.0324s/iter; left time: 366.5528s
	iters: 200, epoch: 1 | loss: 0.2563414
	speed: 0.0195s/iter; left time: 218.3404s
	iters: 300, epoch: 1 | loss: 0.2045213
	speed: 0.0184s/iter; left time: 204.2402s
	iters: 400, epoch: 1 | loss: 0.1961407
	speed: 0.0183s/iter; left time: 201.7795s
	iters: 500, epoch: 1 | loss: 0.2555127
	speed: 0.0184s/iter; left time: 200.7655s
Epoch: 1 cost time: 12.050100803375244
Epoch: 1, Steps: 570 | Train Loss: 0.2561358 Vali Loss: 0.0489382 Test Loss: 0.1559181
Validation loss decreased (inf --> 0.048938).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1675851
	speed: 0.0573s/iter; left time: 615.2071s
	iters: 200, epoch: 2 | loss: 0.3353744
	speed: 0.0183s/iter; left time: 194.8223s
	iters: 300, epoch: 2 | loss: 0.5020998
	speed: 0.0183s/iter; left time: 192.8448s
	iters: 400, epoch: 2 | loss: 0.2674504
	speed: 0.0183s/iter; left time: 190.7290s
	iters: 500, epoch: 2 | loss: 0.2010202
	speed: 0.0183s/iter; left time: 189.2499s
Epoch: 2 cost time: 10.750036478042603
Epoch: 2, Steps: 570 | Train Loss: 0.2872678 Vali Loss: 0.0682885 Test Loss: 0.1902094
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2125782
	speed: 0.0583s/iter; left time: 592.3434s
	iters: 200, epoch: 3 | loss: 0.2854894
	speed: 0.0193s/iter; left time: 193.7875s
	iters: 300, epoch: 3 | loss: 0.2461788
	speed: 0.0184s/iter; left time: 183.5088s
	iters: 400, epoch: 3 | loss: 0.2213762
	speed: 0.0184s/iter; left time: 181.3305s
	iters: 500, epoch: 3 | loss: 0.1950367
	speed: 0.0201s/iter; left time: 196.4433s
Epoch: 3 cost time: 11.490993738174438
Epoch: 3, Steps: 570 | Train Loss: 0.2838300 Vali Loss: 0.0612267 Test Loss: 0.1770139
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2848371
	speed: 0.0619s/iter; left time: 593.8959s
	iters: 200, epoch: 4 | loss: 0.1449135
	speed: 0.0213s/iter; left time: 202.2070s
	iters: 300, epoch: 4 | loss: 0.4600289
	speed: 0.0213s/iter; left time: 199.8422s
	iters: 400, epoch: 4 | loss: 0.1936486
	speed: 0.0213s/iter; left time: 197.9495s
	iters: 500, epoch: 4 | loss: 0.1924767
	speed: 0.0213s/iter; left time: 195.5182s
Epoch: 4 cost time: 12.445250511169434
Epoch: 4, Steps: 570 | Train Loss: 0.2692256 Vali Loss: 0.0593378 Test Loss: 0.1638209
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15614116191864014, mae:0.2531272768974304
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3439945
	speed: 0.0299s/iter; left time: 337.8749s
	iters: 200, epoch: 1 | loss: 0.2224072
	speed: 0.0182s/iter; left time: 203.9254s
	iters: 300, epoch: 1 | loss: 0.2982511
	speed: 0.0182s/iter; left time: 202.1269s
	iters: 400, epoch: 1 | loss: 0.3607741
	speed: 0.0182s/iter; left time: 200.2918s
	iters: 500, epoch: 1 | loss: 0.4477174
	speed: 0.0182s/iter; left time: 198.4560s
Epoch: 1 cost time: 11.596385955810547
Epoch: 1, Steps: 570 | Train Loss: 0.2980871 Vali Loss: 0.0661756 Test Loss: 0.1882649
Validation loss decreased (inf --> 0.066176).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3172938
	speed: 0.0587s/iter; left time: 629.5154s
	iters: 200, epoch: 2 | loss: 0.4120645
	speed: 0.0185s/iter; left time: 196.4896s
	iters: 300, epoch: 2 | loss: 0.5728456
	speed: 0.0185s/iter; left time: 194.3268s
	iters: 400, epoch: 2 | loss: 0.2337411
	speed: 0.0185s/iter; left time: 192.6667s
	iters: 500, epoch: 2 | loss: 0.2605494
	speed: 0.0184s/iter; left time: 190.4284s
Epoch: 2 cost time: 10.830545425415039
Epoch: 2, Steps: 570 | Train Loss: 0.3149009 Vali Loss: 0.0684825 Test Loss: 0.1888304
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1760447
	speed: 0.0549s/iter; left time: 557.4392s
	iters: 200, epoch: 3 | loss: 0.3244613
	speed: 0.0183s/iter; left time: 184.5583s
	iters: 300, epoch: 3 | loss: 0.3146085
	speed: 0.0183s/iter; left time: 182.6632s
	iters: 400, epoch: 3 | loss: 0.3546068
	speed: 0.0183s/iter; left time: 180.9396s
	iters: 500, epoch: 3 | loss: 0.3117248
	speed: 0.0184s/iter; left time: 179.1588s
Epoch: 3 cost time: 10.721402168273926
Epoch: 3, Steps: 570 | Train Loss: 0.2925788 Vali Loss: 0.0609396 Test Loss: 0.1662711
Validation loss decreased (0.066176 --> 0.060940).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2310022
	speed: 0.0562s/iter; left time: 538.9507s
	iters: 200, epoch: 4 | loss: 0.2679229
	speed: 0.0184s/iter; left time: 175.1025s
	iters: 300, epoch: 4 | loss: 0.2043655
	speed: 0.0184s/iter; left time: 173.1889s
	iters: 400, epoch: 4 | loss: 0.2407873
	speed: 0.0184s/iter; left time: 171.1840s
	iters: 500, epoch: 4 | loss: 0.1919197
	speed: 0.0184s/iter; left time: 169.2577s
Epoch: 4 cost time: 10.811872005462646
Epoch: 4, Steps: 570 | Train Loss: 0.2716240 Vali Loss: 0.0596362 Test Loss: 0.1630546
Validation loss decreased (0.060940 --> 0.059636).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2280511
	speed: 0.0584s/iter; left time: 526.4815s
	iters: 200, epoch: 5 | loss: 0.2428658
	speed: 0.0206s/iter; left time: 183.5102s
	iters: 300, epoch: 5 | loss: 0.2224826
	speed: 0.0205s/iter; left time: 181.0357s
	iters: 400, epoch: 5 | loss: 0.2465171
	speed: 0.0205s/iter; left time: 179.1803s
	iters: 500, epoch: 5 | loss: 0.1690178
	speed: 0.0205s/iter; left time: 177.0684s
Epoch: 5 cost time: 12.011718988418579
Epoch: 5, Steps: 570 | Train Loss: 0.2609641 Vali Loss: 0.0581607 Test Loss: 0.1598530
Validation loss decreased (0.059636 --> 0.058161).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4152997
	speed: 0.0579s/iter; left time: 489.2717s
	iters: 200, epoch: 6 | loss: 0.1902053
	speed: 0.0185s/iter; left time: 154.2371s
	iters: 300, epoch: 6 | loss: 0.4684936
	speed: 0.0185s/iter; left time: 152.2812s
	iters: 400, epoch: 6 | loss: 0.1891903
	speed: 0.0184s/iter; left time: 150.3648s
	iters: 500, epoch: 6 | loss: 0.2699345
	speed: 0.0184s/iter; left time: 148.4468s
Epoch: 6 cost time: 10.839010238647461
Epoch: 6, Steps: 570 | Train Loss: 0.2563190 Vali Loss: 0.0575713 Test Loss: 0.1564931
Validation loss decreased (0.058161 --> 0.057571).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1933302
	speed: 0.0563s/iter; left time: 443.6975s
	iters: 200, epoch: 7 | loss: 0.2402638
	speed: 0.0194s/iter; left time: 150.5706s
	iters: 300, epoch: 7 | loss: 0.2761043
	speed: 0.0205s/iter; left time: 157.5016s
	iters: 400, epoch: 7 | loss: 0.2309266
	speed: 0.0205s/iter; left time: 155.4945s
	iters: 500, epoch: 7 | loss: 0.1958035
	speed: 0.0205s/iter; left time: 153.3620s
Epoch: 7 cost time: 11.674142599105835
Epoch: 7, Steps: 570 | Train Loss: 0.2547132 Vali Loss: 0.0579028 Test Loss: 0.1565990
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1519305
	speed: 0.0563s/iter; left time: 411.3127s
	iters: 200, epoch: 8 | loss: 0.1581205
	speed: 0.0183s/iter; left time: 131.9191s
	iters: 300, epoch: 8 | loss: 0.2114730
	speed: 0.0183s/iter; left time: 129.9789s
	iters: 400, epoch: 8 | loss: 0.2588448
	speed: 0.0183s/iter; left time: 128.2440s
	iters: 500, epoch: 8 | loss: 0.1707231
	speed: 0.0183s/iter; left time: 126.3865s
Epoch: 8 cost time: 10.69466257095337
Epoch: 8, Steps: 570 | Train Loss: 0.2521554 Vali Loss: 0.0575652 Test Loss: 0.1560879
Validation loss decreased (0.057571 --> 0.057565).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2606703
	speed: 0.0577s/iter; left time: 388.7291s
	iters: 200, epoch: 9 | loss: 0.2921563
	speed: 0.0207s/iter; left time: 137.5776s
	iters: 300, epoch: 9 | loss: 0.2700184
	speed: 0.0206s/iter; left time: 134.9063s
	iters: 400, epoch: 9 | loss: 0.4152758
	speed: 0.0206s/iter; left time: 132.4620s
	iters: 500, epoch: 9 | loss: 0.2096159
	speed: 0.0206s/iter; left time: 130.3902s
Epoch: 9 cost time: 12.037326574325562
Epoch: 9, Steps: 570 | Train Loss: 0.2526055 Vali Loss: 0.0574870 Test Loss: 0.1556351
Validation loss decreased (0.057565 --> 0.057487).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2231581
	speed: 0.0575s/iter; left time: 354.5522s
	iters: 200, epoch: 10 | loss: 0.2138534
	speed: 0.0183s/iter; left time: 111.0832s
	iters: 300, epoch: 10 | loss: 0.3480861
	speed: 0.0183s/iter; left time: 109.3265s
	iters: 400, epoch: 10 | loss: 0.2435866
	speed: 0.0183s/iter; left time: 107.3653s
	iters: 500, epoch: 10 | loss: 0.2342066
	speed: 0.0183s/iter; left time: 105.6292s
Epoch: 10 cost time: 10.741774797439575
Epoch: 10, Steps: 570 | Train Loss: 0.2514910 Vali Loss: 0.0572551 Test Loss: 0.1555971
Validation loss decreased (0.057487 --> 0.057255).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2281349
	speed: 0.0556s/iter; left time: 311.3301s
	iters: 200, epoch: 11 | loss: 0.2650180
	speed: 0.0183s/iter; left time: 100.5706s
	iters: 300, epoch: 11 | loss: 0.2456894
	speed: 0.0182s/iter; left time: 98.3729s
	iters: 400, epoch: 11 | loss: 0.2605615
	speed: 0.0182s/iter; left time: 96.4158s
	iters: 500, epoch: 11 | loss: 0.1960399
	speed: 0.0182s/iter; left time: 94.6521s
Epoch: 11 cost time: 10.693013668060303
Epoch: 11, Steps: 570 | Train Loss: 0.2525947 Vali Loss: 0.0572932 Test Loss: 0.1556307
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1464265
	speed: 0.0591s/iter; left time: 297.2119s
	iters: 200, epoch: 12 | loss: 0.3264920
	speed: 0.0184s/iter; left time: 90.4951s
	iters: 300, epoch: 12 | loss: 0.2778126
	speed: 0.0183s/iter; left time: 88.5766s
	iters: 400, epoch: 12 | loss: 0.1597119
	speed: 0.0183s/iter; left time: 86.5843s
	iters: 500, epoch: 12 | loss: 0.3305517
	speed: 0.0183s/iter; left time: 84.7469s
Epoch: 12 cost time: 10.704734086990356
Epoch: 12, Steps: 570 | Train Loss: 0.2501300 Vali Loss: 0.0573288 Test Loss: 0.1556164
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2810948
	speed: 0.0551s/iter; left time: 245.5792s
	iters: 200, epoch: 13 | loss: 0.1267352
	speed: 0.0183s/iter; left time: 79.9067s
	iters: 300, epoch: 13 | loss: 0.1804745
	speed: 0.0183s/iter; left time: 78.0427s
	iters: 400, epoch: 13 | loss: 0.1703719
	speed: 0.0183s/iter; left time: 76.2186s
	iters: 500, epoch: 13 | loss: 0.1641101
	speed: 0.0183s/iter; left time: 74.3771s
Epoch: 13 cost time: 10.733674049377441
Epoch: 13, Steps: 570 | Train Loss: 0.2510339 Vali Loss: 0.0575678 Test Loss: 0.1556001
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15581247210502625, mae:0.2524816393852234
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2820024
	speed: 0.0340s/iter; left time: 384.2169s
	iters: 200, epoch: 1 | loss: 0.3506850
	speed: 0.0220s/iter; left time: 246.3993s
	iters: 300, epoch: 1 | loss: 0.3158914
	speed: 0.0220s/iter; left time: 244.6439s
	iters: 400, epoch: 1 | loss: 0.4694290
	speed: 0.0220s/iter; left time: 242.3290s
	iters: 500, epoch: 1 | loss: 0.4384179
	speed: 0.0220s/iter; left time: 240.1337s
Epoch: 1 cost time: 13.80353331565857
Epoch: 1, Steps: 570 | Train Loss: 0.3687771 Vali Loss: 0.0628052 Test Loss: 0.1830931
Validation loss decreased (inf --> 0.062805).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3938585
	speed: 0.0674s/iter; left time: 723.0322s
	iters: 200, epoch: 2 | loss: 0.2715237
	speed: 0.0220s/iter; left time: 233.8290s
	iters: 300, epoch: 2 | loss: 0.2369220
	speed: 0.0220s/iter; left time: 231.6491s
	iters: 400, epoch: 2 | loss: 0.2923615
	speed: 0.0220s/iter; left time: 229.4202s
	iters: 500, epoch: 2 | loss: 0.2706907
	speed: 0.0220s/iter; left time: 227.3420s
Epoch: 2 cost time: 12.883723497390747
Epoch: 2, Steps: 570 | Train Loss: 0.3097597 Vali Loss: 0.0641888 Test Loss: 0.1786072
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.6045175
	speed: 0.0619s/iter; left time: 629.3401s
	iters: 200, epoch: 3 | loss: 0.1884619
	speed: 0.0220s/iter; left time: 221.6047s
	iters: 300, epoch: 3 | loss: 0.3644444
	speed: 0.0220s/iter; left time: 219.3781s
	iters: 400, epoch: 3 | loss: 0.2941984
	speed: 0.0220s/iter; left time: 217.1217s
	iters: 500, epoch: 3 | loss: 0.2039631
	speed: 0.0220s/iter; left time: 214.9650s
Epoch: 3 cost time: 12.837319135665894
Epoch: 3, Steps: 570 | Train Loss: 0.2877696 Vali Loss: 0.0594068 Test Loss: 0.1651690
Validation loss decreased (0.062805 --> 0.059407).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2447802
	speed: 0.0638s/iter; left time: 611.8430s
	iters: 200, epoch: 4 | loss: 0.1950940
	speed: 0.0221s/iter; left time: 209.3103s
	iters: 300, epoch: 4 | loss: 0.2962869
	speed: 0.0221s/iter; left time: 207.0851s
	iters: 400, epoch: 4 | loss: 0.2045498
	speed: 0.0221s/iter; left time: 204.8904s
	iters: 500, epoch: 4 | loss: 0.3095154
	speed: 0.0221s/iter; left time: 202.7547s
Epoch: 4 cost time: 12.93319034576416
Epoch: 4, Steps: 570 | Train Loss: 0.2705669 Vali Loss: 0.0570208 Test Loss: 0.1616229
Validation loss decreased (0.059407 --> 0.057021).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2788117
	speed: 0.0640s/iter; left time: 577.4424s
	iters: 200, epoch: 5 | loss: 0.2860644
	speed: 0.0220s/iter; left time: 195.8734s
	iters: 300, epoch: 5 | loss: 0.2103918
	speed: 0.0220s/iter; left time: 193.7592s
	iters: 400, epoch: 5 | loss: 0.2173960
	speed: 0.0220s/iter; left time: 191.5213s
	iters: 500, epoch: 5 | loss: 0.2649921
	speed: 0.0220s/iter; left time: 189.4514s
Epoch: 5 cost time: 12.819153785705566
Epoch: 5, Steps: 570 | Train Loss: 0.2607152 Vali Loss: 0.0576824 Test Loss: 0.1600697
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1931576
	speed: 0.0615s/iter; left time: 519.3526s
	iters: 200, epoch: 6 | loss: 0.3377065
	speed: 0.0220s/iter; left time: 183.9307s
	iters: 300, epoch: 6 | loss: 0.1976932
	speed: 0.0220s/iter; left time: 181.7342s
	iters: 400, epoch: 6 | loss: 0.1933704
	speed: 0.0220s/iter; left time: 179.5331s
	iters: 500, epoch: 6 | loss: 0.3341262
	speed: 0.0221s/iter; left time: 177.5633s
Epoch: 6 cost time: 12.86313247680664
Epoch: 6, Steps: 570 | Train Loss: 0.2561844 Vali Loss: 0.0569983 Test Loss: 0.1571478
Validation loss decreased (0.057021 --> 0.056998).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3503615
	speed: 0.0640s/iter; left time: 504.4689s
	iters: 200, epoch: 7 | loss: 0.2650831
	speed: 0.0220s/iter; left time: 171.1093s
	iters: 300, epoch: 7 | loss: 0.1854428
	speed: 0.0220s/iter; left time: 168.9140s
	iters: 400, epoch: 7 | loss: 0.2032392
	speed: 0.0220s/iter; left time: 166.8174s
	iters: 500, epoch: 7 | loss: 0.2495519
	speed: 0.0220s/iter; left time: 164.5604s
Epoch: 7 cost time: 12.865455627441406
Epoch: 7, Steps: 570 | Train Loss: 0.2529105 Vali Loss: 0.0565248 Test Loss: 0.1552147
Validation loss decreased (0.056998 --> 0.056525).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1709098
	speed: 0.0649s/iter; left time: 474.6575s
	iters: 200, epoch: 8 | loss: 0.5014006
	speed: 0.0239s/iter; left time: 172.5161s
	iters: 300, epoch: 8 | loss: 0.1560250
	speed: 0.0230s/iter; left time: 163.2838s
	iters: 400, epoch: 8 | loss: 0.2622548
	speed: 0.0238s/iter; left time: 166.5255s
	iters: 500, epoch: 8 | loss: 0.2482225
	speed: 0.0239s/iter; left time: 165.3002s
Epoch: 8 cost time: 13.822824716567993
Epoch: 8, Steps: 570 | Train Loss: 0.2526525 Vali Loss: 0.0563946 Test Loss: 0.1553344
Validation loss decreased (0.056525 --> 0.056395).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2847161
	speed: 0.0662s/iter; left time: 446.5015s
	iters: 200, epoch: 9 | loss: 0.2171539
	speed: 0.0219s/iter; left time: 145.7433s
	iters: 300, epoch: 9 | loss: 0.3929270
	speed: 0.0219s/iter; left time: 143.5175s
	iters: 400, epoch: 9 | loss: 0.2341013
	speed: 0.0219s/iter; left time: 141.3646s
	iters: 500, epoch: 9 | loss: 0.1879824
	speed: 0.0220s/iter; left time: 139.2760s
Epoch: 9 cost time: 12.81470274925232
Epoch: 9, Steps: 570 | Train Loss: 0.2493533 Vali Loss: 0.0561724 Test Loss: 0.1555994
Validation loss decreased (0.056395 --> 0.056172).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2559296
	speed: 0.0663s/iter; left time: 409.4279s
	iters: 200, epoch: 10 | loss: 0.2823784
	speed: 0.0240s/iter; left time: 145.4614s
	iters: 300, epoch: 10 | loss: 0.2442188
	speed: 0.0227s/iter; left time: 135.7714s
	iters: 400, epoch: 10 | loss: 0.3683121
	speed: 0.0221s/iter; left time: 129.7534s
	iters: 500, epoch: 10 | loss: 0.2910262
	speed: 0.0221s/iter; left time: 127.6324s
Epoch: 10 cost time: 13.28865933418274
Epoch: 10, Steps: 570 | Train Loss: 0.2496015 Vali Loss: 0.0566815 Test Loss: 0.1553975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1941482
	speed: 0.0636s/iter; left time: 356.4983s
	iters: 200, epoch: 11 | loss: 0.1915396
	speed: 0.0220s/iter; left time: 121.0883s
	iters: 300, epoch: 11 | loss: 0.1241986
	speed: 0.0220s/iter; left time: 118.8040s
	iters: 400, epoch: 11 | loss: 0.1996565
	speed: 0.0220s/iter; left time: 116.6044s
	iters: 500, epoch: 11 | loss: 0.1841637
	speed: 0.0220s/iter; left time: 114.4586s
Epoch: 11 cost time: 12.907510757446289
Epoch: 11, Steps: 570 | Train Loss: 0.2511690 Vali Loss: 0.0564752 Test Loss: 0.1553328
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2536335
	speed: 0.0620s/iter; left time: 311.9815s
	iters: 200, epoch: 12 | loss: 0.2307326
	speed: 0.0221s/iter; left time: 108.7479s
	iters: 300, epoch: 12 | loss: 0.3589673
	speed: 0.0220s/iter; left time: 106.1706s
	iters: 400, epoch: 12 | loss: 0.1117583
	speed: 0.0220s/iter; left time: 103.9367s
	iters: 500, epoch: 12 | loss: 0.2942688
	speed: 0.0220s/iter; left time: 101.7650s
Epoch: 12 cost time: 12.849246740341187
Epoch: 12, Steps: 570 | Train Loss: 0.2487588 Vali Loss: 0.0564325 Test Loss: 0.1553530
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15584561228752136, mae:0.2539593577384949
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3483191
	speed: 0.0352s/iter; left time: 398.1787s
	iters: 200, epoch: 1 | loss: 0.1764646
	speed: 0.0232s/iter; left time: 259.4205s
	iters: 300, epoch: 1 | loss: 0.2731398
	speed: 0.0232s/iter; left time: 257.6884s
	iters: 400, epoch: 1 | loss: 0.3596932
	speed: 0.0232s/iter; left time: 255.1898s
	iters: 500, epoch: 1 | loss: 0.2425520
	speed: 0.0232s/iter; left time: 252.3968s
Epoch: 1 cost time: 14.481833696365356
Epoch: 1, Steps: 570 | Train Loss: 0.3932763 Vali Loss: 0.0687599 Test Loss: 0.1930391
Validation loss decreased (inf --> 0.068760).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3420772
	speed: 0.0664s/iter; left time: 712.2537s
	iters: 200, epoch: 2 | loss: 0.2079389
	speed: 0.0214s/iter; left time: 227.7822s
	iters: 300, epoch: 2 | loss: 0.4470553
	speed: 0.0214s/iter; left time: 225.5341s
	iters: 400, epoch: 2 | loss: 0.2903394
	speed: 0.0214s/iter; left time: 223.4318s
	iters: 500, epoch: 2 | loss: 0.2193912
	speed: 0.0214s/iter; left time: 221.1467s
Epoch: 2 cost time: 12.558496952056885
Epoch: 2, Steps: 570 | Train Loss: 0.3195452 Vali Loss: 0.0677651 Test Loss: 0.1936957
Validation loss decreased (0.068760 --> 0.067765).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2322346
	speed: 0.0651s/iter; left time: 661.1284s
	iters: 200, epoch: 3 | loss: 0.2921307
	speed: 0.0233s/iter; left time: 233.9472s
	iters: 300, epoch: 3 | loss: 0.1781242
	speed: 0.0233s/iter; left time: 231.7892s
	iters: 400, epoch: 3 | loss: 0.1827128
	speed: 0.0232s/iter; left time: 229.1645s
	iters: 500, epoch: 3 | loss: 0.2208113
	speed: 0.0233s/iter; left time: 227.2506s
Epoch: 3 cost time: 13.553138256072998
Epoch: 3, Steps: 570 | Train Loss: 0.2932154 Vali Loss: 0.0649118 Test Loss: 0.1745840
Validation loss decreased (0.067765 --> 0.064912).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2069071
	speed: 0.0638s/iter; left time: 612.1436s
	iters: 200, epoch: 4 | loss: 0.2678215
	speed: 0.0213s/iter; left time: 202.5689s
	iters: 300, epoch: 4 | loss: 0.2591911
	speed: 0.0217s/iter; left time: 203.6122s
	iters: 400, epoch: 4 | loss: 0.3349337
	speed: 0.0234s/iter; left time: 217.6259s
	iters: 500, epoch: 4 | loss: 0.1894222
	speed: 0.0234s/iter; left time: 215.2502s
Epoch: 4 cost time: 13.065051317214966
Epoch: 4, Steps: 570 | Train Loss: 0.2769989 Vali Loss: 0.0618164 Test Loss: 0.1722599
Validation loss decreased (0.064912 --> 0.061816).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4016593
	speed: 0.0659s/iter; left time: 594.4158s
	iters: 200, epoch: 5 | loss: 0.1939733
	speed: 0.0233s/iter; left time: 207.5360s
	iters: 300, epoch: 5 | loss: 0.3224022
	speed: 0.0232s/iter; left time: 205.0129s
	iters: 400, epoch: 5 | loss: 0.2390254
	speed: 0.0232s/iter; left time: 202.5735s
	iters: 500, epoch: 5 | loss: 0.2287242
	speed: 0.0233s/iter; left time: 201.2990s
Epoch: 5 cost time: 13.612292289733887
Epoch: 5, Steps: 570 | Train Loss: 0.2684514 Vali Loss: 0.0615603 Test Loss: 0.1668281
Validation loss decreased (0.061816 --> 0.061560).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2436883
	speed: 0.0656s/iter; left time: 554.3725s
	iters: 200, epoch: 6 | loss: 0.3324875
	speed: 0.0214s/iter; left time: 178.6188s
	iters: 300, epoch: 6 | loss: 0.2827042
	speed: 0.0214s/iter; left time: 176.5276s
	iters: 400, epoch: 6 | loss: 0.1656434
	speed: 0.0214s/iter; left time: 174.3857s
	iters: 500, epoch: 6 | loss: 0.1709646
	speed: 0.0214s/iter; left time: 172.1588s
Epoch: 6 cost time: 12.535096168518066
Epoch: 6, Steps: 570 | Train Loss: 0.2631734 Vali Loss: 0.0609450 Test Loss: 0.1660672
Validation loss decreased (0.061560 --> 0.060945).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2456770
	speed: 0.0622s/iter; left time: 490.0588s
	iters: 200, epoch: 7 | loss: 0.3631036
	speed: 0.0212s/iter; left time: 165.1232s
	iters: 300, epoch: 7 | loss: 0.3073087
	speed: 0.0212s/iter; left time: 162.9806s
	iters: 400, epoch: 7 | loss: 0.1740722
	speed: 0.0212s/iter; left time: 160.7741s
	iters: 500, epoch: 7 | loss: 0.2432873
	speed: 0.0212s/iter; left time: 158.7506s
Epoch: 7 cost time: 12.424107551574707
Epoch: 7, Steps: 570 | Train Loss: 0.2611012 Vali Loss: 0.0604223 Test Loss: 0.1646789
Validation loss decreased (0.060945 --> 0.060422).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2533799
	speed: 0.0628s/iter; left time: 459.1246s
	iters: 200, epoch: 8 | loss: 0.2918572
	speed: 0.0214s/iter; left time: 154.2695s
	iters: 300, epoch: 8 | loss: 0.2444859
	speed: 0.0214s/iter; left time: 152.0478s
	iters: 400, epoch: 8 | loss: 0.2939004
	speed: 0.0214s/iter; left time: 149.8876s
	iters: 500, epoch: 8 | loss: 0.3102149
	speed: 0.0214s/iter; left time: 147.6997s
Epoch: 8 cost time: 12.508057355880737
Epoch: 8, Steps: 570 | Train Loss: 0.2591132 Vali Loss: 0.0587517 Test Loss: 0.1642147
Validation loss decreased (0.060422 --> 0.058752).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2027416
	speed: 0.0626s/iter; left time: 422.1793s
	iters: 200, epoch: 9 | loss: 0.3553377
	speed: 0.0214s/iter; left time: 141.9750s
	iters: 300, epoch: 9 | loss: 0.2911352
	speed: 0.0214s/iter; left time: 139.8032s
	iters: 400, epoch: 9 | loss: 0.2423984
	speed: 0.0214s/iter; left time: 137.6660s
	iters: 500, epoch: 9 | loss: 0.1473337
	speed: 0.0214s/iter; left time: 135.5430s
Epoch: 9 cost time: 12.525371074676514
Epoch: 9, Steps: 570 | Train Loss: 0.2591514 Vali Loss: 0.0583740 Test Loss: 0.1639684
Validation loss decreased (0.058752 --> 0.058374).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1709135
	speed: 0.0660s/iter; left time: 407.1380s
	iters: 200, epoch: 10 | loss: 0.2414147
	speed: 0.0216s/iter; left time: 131.3980s
	iters: 300, epoch: 10 | loss: 0.1864398
	speed: 0.0233s/iter; left time: 139.1370s
	iters: 400, epoch: 10 | loss: 0.2411635
	speed: 0.0233s/iter; left time: 136.7352s
	iters: 500, epoch: 10 | loss: 0.3385921
	speed: 0.0233s/iter; left time: 134.4784s
Epoch: 10 cost time: 13.250301122665405
Epoch: 10, Steps: 570 | Train Loss: 0.2577685 Vali Loss: 0.0582898 Test Loss: 0.1638390
Validation loss decreased (0.058374 --> 0.058290).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.4224576
	speed: 0.0650s/iter; left time: 364.1418s
	iters: 200, epoch: 11 | loss: 0.2363219
	speed: 0.0233s/iter; left time: 128.1570s
	iters: 300, epoch: 11 | loss: 0.2084909
	speed: 0.0233s/iter; left time: 125.8077s
	iters: 400, epoch: 11 | loss: 0.1982952
	speed: 0.0233s/iter; left time: 123.4977s
	iters: 500, epoch: 11 | loss: 0.2825384
	speed: 0.0233s/iter; left time: 121.1819s
Epoch: 11 cost time: 13.607885122299194
Epoch: 11, Steps: 570 | Train Loss: 0.2576231 Vali Loss: 0.0584254 Test Loss: 0.1637842
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3107935
	speed: 0.0646s/iter; left time: 324.9062s
	iters: 200, epoch: 12 | loss: 0.2872938
	speed: 0.0214s/iter; left time: 105.4423s
	iters: 300, epoch: 12 | loss: 0.2831005
	speed: 0.0213s/iter; left time: 103.0202s
	iters: 400, epoch: 12 | loss: 0.4618843
	speed: 0.0213s/iter; left time: 100.8946s
	iters: 500, epoch: 12 | loss: 0.1982855
	speed: 0.0213s/iter; left time: 98.7551s
Epoch: 12 cost time: 12.627089262008667
Epoch: 12, Steps: 570 | Train Loss: 0.2571457 Vali Loss: 0.0585422 Test Loss: 0.1637864
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1983078
	speed: 0.0605s/iter; left time: 269.6843s
	iters: 200, epoch: 13 | loss: 0.3412160
	speed: 0.0213s/iter; left time: 92.9811s
	iters: 300, epoch: 13 | loss: 0.3556422
	speed: 0.0213s/iter; left time: 90.8928s
	iters: 400, epoch: 13 | loss: 0.2023166
	speed: 0.0213s/iter; left time: 88.7214s
	iters: 500, epoch: 13 | loss: 0.2963874
	speed: 0.0213s/iter; left time: 86.6776s
Epoch: 13 cost time: 12.473315238952637
Epoch: 13, Steps: 570 | Train Loss: 0.2576762 Vali Loss: 0.0589034 Test Loss: 0.1637957
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16409872472286224, mae:0.2606174945831299
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3804397
	speed: 0.0318s/iter; left time: 359.2997s
	iters: 200, epoch: 1 | loss: 0.3089974
	speed: 0.0201s/iter; left time: 225.1320s
	iters: 300, epoch: 1 | loss: 0.3638180
	speed: 0.0201s/iter; left time: 222.8779s
	iters: 400, epoch: 1 | loss: 0.4387281
	speed: 0.0219s/iter; left time: 240.8524s
	iters: 500, epoch: 1 | loss: 0.3337742
	speed: 0.0222s/iter; left time: 241.8229s
Epoch: 1 cost time: 13.223371267318726
Epoch: 1, Steps: 570 | Train Loss: 0.3645407 Vali Loss: 0.0670480 Test Loss: 0.1957417
Validation loss decreased (inf --> 0.067048).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2270536
	speed: 0.0618s/iter; left time: 662.8868s
	iters: 200, epoch: 2 | loss: 0.5691278
	speed: 0.0203s/iter; left time: 216.2059s
	iters: 300, epoch: 2 | loss: 0.2426668
	speed: 0.0203s/iter; left time: 213.2584s
	iters: 400, epoch: 2 | loss: 0.2305209
	speed: 0.0203s/iter; left time: 211.4533s
	iters: 500, epoch: 2 | loss: 0.1968035
	speed: 0.0203s/iter; left time: 209.3513s
Epoch: 2 cost time: 11.874313116073608
Epoch: 2, Steps: 570 | Train Loss: 0.3082443 Vali Loss: 0.0630910 Test Loss: 0.1835305
Validation loss decreased (0.067048 --> 0.063091).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1988384
	speed: 0.0598s/iter; left time: 607.2941s
	iters: 200, epoch: 3 | loss: 0.2185974
	speed: 0.0201s/iter; left time: 202.0593s
	iters: 300, epoch: 3 | loss: 0.2903170
	speed: 0.0201s/iter; left time: 199.7893s
	iters: 400, epoch: 3 | loss: 0.3049778
	speed: 0.0201s/iter; left time: 197.8905s
	iters: 500, epoch: 3 | loss: 0.2555400
	speed: 0.0201s/iter; left time: 195.8700s
Epoch: 3 cost time: 11.734462976455688
Epoch: 3, Steps: 570 | Train Loss: 0.2866641 Vali Loss: 0.0612436 Test Loss: 0.1738186
Validation loss decreased (0.063091 --> 0.061244).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1943121
	speed: 0.0599s/iter; left time: 574.0318s
	iters: 200, epoch: 4 | loss: 0.4831101
	speed: 0.0202s/iter; left time: 191.6544s
	iters: 300, epoch: 4 | loss: 0.1913214
	speed: 0.0202s/iter; left time: 189.7743s
	iters: 400, epoch: 4 | loss: 0.2798837
	speed: 0.0202s/iter; left time: 187.5272s
	iters: 500, epoch: 4 | loss: 0.2258324
	speed: 0.0202s/iter; left time: 185.5867s
Epoch: 4 cost time: 11.821897745132446
Epoch: 4, Steps: 570 | Train Loss: 0.2727965 Vali Loss: 0.0597988 Test Loss: 0.1625510
Validation loss decreased (0.061244 --> 0.059799).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2511033
	speed: 0.0605s/iter; left time: 545.6101s
	iters: 200, epoch: 5 | loss: 0.6101279
	speed: 0.0201s/iter; left time: 179.2963s
	iters: 300, epoch: 5 | loss: 0.2532804
	speed: 0.0201s/iter; left time: 177.2732s
	iters: 400, epoch: 5 | loss: 0.2133041
	speed: 0.0201s/iter; left time: 175.1340s
	iters: 500, epoch: 5 | loss: 0.2544225
	speed: 0.0201s/iter; left time: 173.1019s
Epoch: 5 cost time: 11.743638277053833
Epoch: 5, Steps: 570 | Train Loss: 0.2646309 Vali Loss: 0.0560531 Test Loss: 0.1614465
Validation loss decreased (0.059799 --> 0.056053).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2450040
	speed: 0.0598s/iter; left time: 505.0754s
	iters: 200, epoch: 6 | loss: 0.3549562
	speed: 0.0203s/iter; left time: 169.1453s
	iters: 300, epoch: 6 | loss: 0.2124002
	speed: 0.0203s/iter; left time: 167.1340s
	iters: 400, epoch: 6 | loss: 0.1401052
	speed: 0.0202s/iter; left time: 165.0566s
	iters: 500, epoch: 6 | loss: 0.4268948
	speed: 0.0202s/iter; left time: 162.9227s
Epoch: 6 cost time: 11.85304594039917
Epoch: 6, Steps: 570 | Train Loss: 0.2608943 Vali Loss: 0.0560516 Test Loss: 0.1611834
Validation loss decreased (0.056053 --> 0.056052).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2776586
	speed: 0.0632s/iter; left time: 498.3555s
	iters: 200, epoch: 7 | loss: 0.2870423
	speed: 0.0223s/iter; left time: 173.2533s
	iters: 300, epoch: 7 | loss: 0.3501499
	speed: 0.0223s/iter; left time: 171.0628s
	iters: 400, epoch: 7 | loss: 0.4562049
	speed: 0.0223s/iter; left time: 168.6950s
	iters: 500, epoch: 7 | loss: 0.2012505
	speed: 0.0207s/iter; left time: 154.4890s
Epoch: 7 cost time: 12.713634967803955
Epoch: 7, Steps: 570 | Train Loss: 0.2569121 Vali Loss: 0.0560550 Test Loss: 0.1617218
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3294926
	speed: 0.0581s/iter; left time: 424.9295s
	iters: 200, epoch: 8 | loss: 0.4140672
	speed: 0.0202s/iter; left time: 145.4693s
	iters: 300, epoch: 8 | loss: 0.3153934
	speed: 0.0202s/iter; left time: 143.5739s
	iters: 400, epoch: 8 | loss: 0.1939416
	speed: 0.0202s/iter; left time: 141.4371s
	iters: 500, epoch: 8 | loss: 0.2573278
	speed: 0.0202s/iter; left time: 139.2860s
Epoch: 8 cost time: 11.763284921646118
Epoch: 8, Steps: 570 | Train Loss: 0.2557399 Vali Loss: 0.0562486 Test Loss: 0.1602705
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2525150
	speed: 0.0624s/iter; left time: 420.6657s
	iters: 200, epoch: 9 | loss: 0.2477296
	speed: 0.0223s/iter; left time: 148.0132s
	iters: 300, epoch: 9 | loss: 0.3376626
	speed: 0.0222s/iter; left time: 145.4651s
	iters: 400, epoch: 9 | loss: 0.1935522
	speed: 0.0223s/iter; left time: 143.5379s
	iters: 500, epoch: 9 | loss: 0.1374224
	speed: 0.0222s/iter; left time: 141.0254s
Epoch: 9 cost time: 12.967283725738525
Epoch: 9, Steps: 570 | Train Loss: 0.2557171 Vali Loss: 0.0556010 Test Loss: 0.1605741
Validation loss decreased (0.056052 --> 0.055601).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2737424
	speed: 0.0625s/iter; left time: 385.5241s
	iters: 200, epoch: 10 | loss: 0.1813244
	speed: 0.0202s/iter; left time: 122.6427s
	iters: 300, epoch: 10 | loss: 0.4009261
	speed: 0.0202s/iter; left time: 120.5661s
	iters: 400, epoch: 10 | loss: 0.3548692
	speed: 0.0202s/iter; left time: 118.5424s
	iters: 500, epoch: 10 | loss: 0.2752964
	speed: 0.0202s/iter; left time: 116.5716s
Epoch: 10 cost time: 11.817394733428955
Epoch: 10, Steps: 570 | Train Loss: 0.2539065 Vali Loss: 0.0560734 Test Loss: 0.1604954
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2159983
	speed: 0.0625s/iter; left time: 350.1328s
	iters: 200, epoch: 11 | loss: 0.2328295
	speed: 0.0223s/iter; left time: 122.5611s
	iters: 300, epoch: 11 | loss: 0.1948394
	speed: 0.0223s/iter; left time: 120.2153s
	iters: 400, epoch: 11 | loss: 0.2906358
	speed: 0.0222s/iter; left time: 117.8911s
	iters: 500, epoch: 11 | loss: 0.2166879
	speed: 0.0223s/iter; left time: 115.7282s
Epoch: 11 cost time: 12.963262557983398
Epoch: 11, Steps: 570 | Train Loss: 0.2556766 Vali Loss: 0.0561369 Test Loss: 0.1604189
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2205788
	speed: 0.0626s/iter; left time: 315.1270s
	iters: 200, epoch: 12 | loss: 0.2239135
	speed: 0.0202s/iter; left time: 99.6682s
	iters: 300, epoch: 12 | loss: 0.4537135
	speed: 0.0202s/iter; left time: 97.3472s
	iters: 400, epoch: 12 | loss: 0.2867092
	speed: 0.0202s/iter; left time: 95.6214s
	iters: 500, epoch: 12 | loss: 0.3965144
	speed: 0.0202s/iter; left time: 93.6129s
Epoch: 12 cost time: 11.790961265563965
Epoch: 12, Steps: 570 | Train Loss: 0.2542800 Vali Loss: 0.0559142 Test Loss: 0.1604519
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16082032024860382, mae:0.2550908029079437
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1944437
	speed: 0.0231s/iter; left time: 261.4744s
	iters: 200, epoch: 1 | loss: 0.1642704
	speed: 0.0112s/iter; left time: 124.9276s
	iters: 300, epoch: 1 | loss: 0.2080029
	speed: 0.0112s/iter; left time: 124.1263s
	iters: 400, epoch: 1 | loss: 0.1865716
	speed: 0.0111s/iter; left time: 122.5701s
	iters: 500, epoch: 1 | loss: 0.1544829
	speed: 0.0112s/iter; left time: 121.8219s
Epoch: 1 cost time: 7.6107337474823
Epoch: 1, Steps: 570 | Train Loss: 0.1804872 Vali Loss: 0.0488531 Test Loss: 0.1410827
Validation loss decreased (inf --> 0.048853).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1664304
	speed: 0.0366s/iter; left time: 392.2806s
	iters: 200, epoch: 2 | loss: 0.2020042
	speed: 0.0099s/iter; left time: 105.1216s
	iters: 300, epoch: 2 | loss: 0.1241654
	speed: 0.0099s/iter; left time: 103.7411s
	iters: 400, epoch: 2 | loss: 0.1342875
	speed: 0.0099s/iter; left time: 102.8937s
	iters: 500, epoch: 2 | loss: 0.1565352
	speed: 0.0098s/iter; left time: 101.6498s
Epoch: 2 cost time: 5.954463958740234
Epoch: 2, Steps: 570 | Train Loss: 0.1322044 Vali Loss: 0.0428261 Test Loss: 0.1458761
Validation loss decreased (0.048853 --> 0.042826).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0983299
	speed: 0.0366s/iter; left time: 371.4651s
	iters: 200, epoch: 3 | loss: 0.0833045
	speed: 0.0100s/iter; left time: 100.3802s
	iters: 300, epoch: 3 | loss: 0.0775792
	speed: 0.0100s/iter; left time: 99.4109s
	iters: 400, epoch: 3 | loss: 0.1087999
	speed: 0.0099s/iter; left time: 98.1120s
	iters: 500, epoch: 3 | loss: 0.1334865
	speed: 0.0100s/iter; left time: 97.1779s
Epoch: 3 cost time: 5.99560022354126
Epoch: 3, Steps: 570 | Train Loss: 0.0894185 Vali Loss: 0.0405665 Test Loss: 0.1412212
Validation loss decreased (0.042826 --> 0.040567).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0738157
	speed: 0.0372s/iter; left time: 357.1442s
	iters: 200, epoch: 4 | loss: 0.0421157
	speed: 0.0112s/iter; left time: 106.4949s
	iters: 300, epoch: 4 | loss: 0.0593118
	speed: 0.0112s/iter; left time: 104.9668s
	iters: 400, epoch: 4 | loss: 0.0594450
	speed: 0.0112s/iter; left time: 103.7061s
	iters: 500, epoch: 4 | loss: 0.0589572
	speed: 0.0112s/iter; left time: 102.7309s
Epoch: 4 cost time: 6.68479585647583
Epoch: 4, Steps: 570 | Train Loss: 0.0601401 Vali Loss: 0.0413942 Test Loss: 0.1406739
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0557960
	speed: 0.0395s/iter; left time: 356.5184s
	iters: 200, epoch: 5 | loss: 0.0553470
	speed: 0.0112s/iter; left time: 99.5246s
	iters: 300, epoch: 5 | loss: 0.0386101
	speed: 0.0112s/iter; left time: 98.4658s
	iters: 400, epoch: 5 | loss: 0.0521770
	speed: 0.0112s/iter; left time: 97.3562s
	iters: 500, epoch: 5 | loss: 0.0316364
	speed: 0.0111s/iter; left time: 96.0765s
Epoch: 5 cost time: 6.698359489440918
Epoch: 5, Steps: 570 | Train Loss: 0.0463121 Vali Loss: 0.0392300 Test Loss: 0.1354600
Validation loss decreased (0.040567 --> 0.039230).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0314671
	speed: 0.0386s/iter; left time: 326.1754s
	iters: 200, epoch: 6 | loss: 0.0347356
	speed: 0.0113s/iter; left time: 94.7238s
	iters: 300, epoch: 6 | loss: 0.0368734
	speed: 0.0110s/iter; left time: 90.3753s
	iters: 400, epoch: 6 | loss: 0.0429091
	speed: 0.0099s/iter; left time: 80.3310s
	iters: 500, epoch: 6 | loss: 0.0451638
	speed: 0.0098s/iter; left time: 79.1058s
Epoch: 6 cost time: 6.311911344528198
Epoch: 6, Steps: 570 | Train Loss: 0.0389716 Vali Loss: 0.0409728 Test Loss: 0.1399496
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0390323
	speed: 0.0370s/iter; left time: 291.4177s
	iters: 200, epoch: 7 | loss: 0.0337189
	speed: 0.0100s/iter; left time: 77.4670s
	iters: 300, epoch: 7 | loss: 0.0284107
	speed: 0.0100s/iter; left time: 76.4699s
	iters: 400, epoch: 7 | loss: 0.0361575
	speed: 0.0099s/iter; left time: 75.1587s
	iters: 500, epoch: 7 | loss: 0.0334786
	speed: 0.0099s/iter; left time: 74.1968s
Epoch: 7 cost time: 5.994266986846924
Epoch: 7, Steps: 570 | Train Loss: 0.0354632 Vali Loss: 0.0407551 Test Loss: 0.1402271
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0376807
	speed: 0.0366s/iter; left time: 267.8880s
	iters: 200, epoch: 8 | loss: 0.0568481
	speed: 0.0099s/iter; left time: 71.2362s
	iters: 300, epoch: 8 | loss: 0.0314264
	speed: 0.0098s/iter; left time: 69.9176s
	iters: 400, epoch: 8 | loss: 0.0443626
	speed: 0.0098s/iter; left time: 68.9238s
	iters: 500, epoch: 8 | loss: 0.0328621
	speed: 0.0098s/iter; left time: 67.9549s
Epoch: 8 cost time: 5.872874975204468
Epoch: 8, Steps: 570 | Train Loss: 0.0336702 Vali Loss: 0.0409307 Test Loss: 0.1423887
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.135650172829628, mae:0.23488344252109528
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1940793
	speed: 0.0218s/iter; left time: 246.4095s
	iters: 200, epoch: 1 | loss: 0.1388180
	speed: 0.0097s/iter; left time: 109.0732s
	iters: 300, epoch: 1 | loss: 0.2141243
	speed: 0.0098s/iter; left time: 108.3535s
	iters: 400, epoch: 1 | loss: 0.1099621
	speed: 0.0097s/iter; left time: 107.1513s
	iters: 500, epoch: 1 | loss: 0.1165200
	speed: 0.0097s/iter; left time: 106.2216s
Epoch: 1 cost time: 6.806869268417358
Epoch: 1, Steps: 570 | Train Loss: 0.1467942 Vali Loss: 0.0391663 Test Loss: 0.1277200
Validation loss decreased (inf --> 0.039166).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1055574
	speed: 0.0356s/iter; left time: 382.4727s
	iters: 200, epoch: 2 | loss: 0.1487699
	speed: 0.0097s/iter; left time: 103.3956s
	iters: 300, epoch: 2 | loss: 0.0745109
	speed: 0.0097s/iter; left time: 102.3675s
	iters: 400, epoch: 2 | loss: 0.0588041
	speed: 0.0097s/iter; left time: 101.3768s
	iters: 500, epoch: 2 | loss: 0.0908444
	speed: 0.0097s/iter; left time: 100.4077s
Epoch: 2 cost time: 5.8583714962005615
Epoch: 2, Steps: 570 | Train Loss: 0.1147852 Vali Loss: 0.0365444 Test Loss: 0.1178358
Validation loss decreased (0.039166 --> 0.036544).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0494687
	speed: 0.0366s/iter; left time: 371.8677s
	iters: 200, epoch: 3 | loss: 0.0652063
	speed: 0.0097s/iter; left time: 97.4264s
	iters: 300, epoch: 3 | loss: 0.1403556
	speed: 0.0097s/iter; left time: 96.4735s
	iters: 400, epoch: 3 | loss: 0.0767204
	speed: 0.0097s/iter; left time: 95.6301s
	iters: 500, epoch: 3 | loss: 0.0613843
	speed: 0.0097s/iter; left time: 94.5840s
Epoch: 3 cost time: 5.842099666595459
Epoch: 3, Steps: 570 | Train Loss: 0.0810848 Vali Loss: 0.0354074 Test Loss: 0.1190029
Validation loss decreased (0.036544 --> 0.035407).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0427368
	speed: 0.0345s/iter; left time: 330.9102s
	iters: 200, epoch: 4 | loss: 0.0439321
	speed: 0.0097s/iter; left time: 92.0103s
	iters: 300, epoch: 4 | loss: 0.0371526
	speed: 0.0097s/iter; left time: 91.1910s
	iters: 400, epoch: 4 | loss: 0.0446692
	speed: 0.0097s/iter; left time: 90.1351s
	iters: 500, epoch: 4 | loss: 0.0675589
	speed: 0.0097s/iter; left time: 89.1297s
Epoch: 4 cost time: 5.8341965675354
Epoch: 4, Steps: 570 | Train Loss: 0.0567281 Vali Loss: 0.0344380 Test Loss: 0.1204967
Validation loss decreased (0.035407 --> 0.034438).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0475336
	speed: 0.0370s/iter; left time: 333.5159s
	iters: 200, epoch: 5 | loss: 0.0603414
	speed: 0.0109s/iter; left time: 97.0085s
	iters: 300, epoch: 5 | loss: 0.0557232
	speed: 0.0110s/iter; left time: 96.6108s
	iters: 400, epoch: 5 | loss: 0.0629306
	speed: 0.0109s/iter; left time: 94.6372s
	iters: 500, epoch: 5 | loss: 0.0599310
	speed: 0.0104s/iter; left time: 89.6942s
Epoch: 5 cost time: 6.390201807022095
Epoch: 5, Steps: 570 | Train Loss: 0.0443423 Vali Loss: 0.0358920 Test Loss: 0.1261836
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0302408
	speed: 0.0359s/iter; left time: 303.4531s
	iters: 200, epoch: 6 | loss: 0.0627531
	speed: 0.0096s/iter; left time: 80.4266s
	iters: 300, epoch: 6 | loss: 0.0530466
	speed: 0.0096s/iter; left time: 79.3524s
	iters: 400, epoch: 6 | loss: 0.0300475
	speed: 0.0096s/iter; left time: 78.4598s
	iters: 500, epoch: 6 | loss: 0.0230651
	speed: 0.0096s/iter; left time: 77.4058s
Epoch: 6 cost time: 5.783416032791138
Epoch: 6, Steps: 570 | Train Loss: 0.0382273 Vali Loss: 0.0365799 Test Loss: 0.1277658
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0277006
	speed: 0.0374s/iter; left time: 294.8680s
	iters: 200, epoch: 7 | loss: 0.0329772
	speed: 0.0109s/iter; left time: 84.5415s
	iters: 300, epoch: 7 | loss: 0.0540259
	speed: 0.0109s/iter; left time: 83.6131s
	iters: 400, epoch: 7 | loss: 0.0743621
	speed: 0.0109s/iter; left time: 82.5463s
	iters: 500, epoch: 7 | loss: 0.0309425
	speed: 0.0109s/iter; left time: 81.3714s
Epoch: 7 cost time: 6.532441854476929
Epoch: 7, Steps: 570 | Train Loss: 0.0351306 Vali Loss: 0.0364887 Test Loss: 0.1271494
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12067621946334839, mae:0.216682568192482
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1714890
	speed: 0.0228s/iter; left time: 257.9778s
	iters: 200, epoch: 1 | loss: 0.1268095
	speed: 0.0111s/iter; left time: 124.2058s
	iters: 300, epoch: 1 | loss: 0.1375185
	speed: 0.0111s/iter; left time: 123.4492s
	iters: 400, epoch: 1 | loss: 0.0977060
	speed: 0.0111s/iter; left time: 122.1305s
	iters: 500, epoch: 1 | loss: 0.1776273
	speed: 0.0111s/iter; left time: 120.9231s
Epoch: 1 cost time: 7.552199125289917
Epoch: 1, Steps: 570 | Train Loss: 0.1847429 Vali Loss: 0.0443673 Test Loss: 0.1467872
Validation loss decreased (inf --> 0.044367).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1578133
	speed: 0.0382s/iter; left time: 410.2405s
	iters: 200, epoch: 2 | loss: 0.2252475
	speed: 0.0113s/iter; left time: 119.6660s
	iters: 300, epoch: 2 | loss: 0.1275061
	speed: 0.0112s/iter; left time: 118.0402s
	iters: 400, epoch: 2 | loss: 0.1975546
	speed: 0.0112s/iter; left time: 117.1903s
	iters: 500, epoch: 2 | loss: 0.1235378
	speed: 0.0112s/iter; left time: 115.7574s
Epoch: 2 cost time: 6.6874799728393555
Epoch: 2, Steps: 570 | Train Loss: 0.1313124 Vali Loss: 0.0441769 Test Loss: 0.1452591
Validation loss decreased (0.044367 --> 0.044177).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0545728
	speed: 0.0381s/iter; left time: 387.0535s
	iters: 200, epoch: 3 | loss: 0.0621531
	speed: 0.0111s/iter; left time: 111.9750s
	iters: 300, epoch: 3 | loss: 0.0807057
	speed: 0.0112s/iter; left time: 111.1513s
	iters: 400, epoch: 3 | loss: 0.0659295
	speed: 0.0112s/iter; left time: 110.2294s
	iters: 500, epoch: 3 | loss: 0.0607469
	speed: 0.0112s/iter; left time: 109.2692s
Epoch: 3 cost time: 6.6767027378082275
Epoch: 3, Steps: 570 | Train Loss: 0.0804944 Vali Loss: 0.0399675 Test Loss: 0.1428847
Validation loss decreased (0.044177 --> 0.039968).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0398316
	speed: 0.0371s/iter; left time: 356.2886s
	iters: 200, epoch: 4 | loss: 0.0337781
	speed: 0.0109s/iter; left time: 103.5341s
	iters: 300, epoch: 4 | loss: 0.0411565
	speed: 0.0109s/iter; left time: 102.5939s
	iters: 400, epoch: 4 | loss: 0.0658094
	speed: 0.0109s/iter; left time: 101.7112s
	iters: 500, epoch: 4 | loss: 0.0430230
	speed: 0.0109s/iter; left time: 100.6365s
Epoch: 4 cost time: 6.54393196105957
Epoch: 4, Steps: 570 | Train Loss: 0.0502238 Vali Loss: 0.0407962 Test Loss: 0.1488430
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0395215
	speed: 0.0358s/iter; left time: 323.0058s
	iters: 200, epoch: 5 | loss: 0.0381135
	speed: 0.0097s/iter; left time: 86.9522s
	iters: 300, epoch: 5 | loss: 0.0297308
	speed: 0.0097s/iter; left time: 85.8597s
	iters: 400, epoch: 5 | loss: 0.0274207
	speed: 0.0098s/iter; left time: 85.5152s
	iters: 500, epoch: 5 | loss: 0.0346355
	speed: 0.0098s/iter; left time: 84.7656s
Epoch: 5 cost time: 5.883734703063965
Epoch: 5, Steps: 570 | Train Loss: 0.0374292 Vali Loss: 0.0404922 Test Loss: 0.1463897
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0315148
	speed: 0.0350s/iter; left time: 295.4121s
	iters: 200, epoch: 6 | loss: 0.0427770
	speed: 0.0098s/iter; left time: 81.7480s
	iters: 300, epoch: 6 | loss: 0.0287391
	speed: 0.0098s/iter; left time: 80.5147s
	iters: 400, epoch: 6 | loss: 0.0242794
	speed: 0.0097s/iter; left time: 79.4178s
	iters: 500, epoch: 6 | loss: 0.0340353
	speed: 0.0098s/iter; left time: 78.5339s
Epoch: 6 cost time: 5.857626438140869
Epoch: 6, Steps: 570 | Train Loss: 0.0319297 Vali Loss: 0.0407948 Test Loss: 0.1484461
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.143092542886734, mae:0.2408505529165268
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2388572
	speed: 0.0232s/iter; left time: 262.5280s
	iters: 200, epoch: 1 | loss: 0.2025720
	speed: 0.0114s/iter; left time: 127.7553s
	iters: 300, epoch: 1 | loss: 0.1443961
	speed: 0.0114s/iter; left time: 126.4329s
	iters: 400, epoch: 1 | loss: 0.0870342
	speed: 0.0114s/iter; left time: 125.6276s
	iters: 500, epoch: 1 | loss: 0.1572416
	speed: 0.0115s/iter; left time: 124.8798s
Epoch: 1 cost time: 7.7398059368133545
Epoch: 1, Steps: 570 | Train Loss: 0.2009764 Vali Loss: 0.0460886 Test Loss: 0.1417371
Validation loss decreased (inf --> 0.046089).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1435807
	speed: 0.0389s/iter; left time: 417.3806s
	iters: 200, epoch: 2 | loss: 0.1392410
	speed: 0.0115s/iter; left time: 121.8254s
	iters: 300, epoch: 2 | loss: 0.1236219
	speed: 0.0115s/iter; left time: 120.7884s
	iters: 400, epoch: 2 | loss: 0.0819476
	speed: 0.0115s/iter; left time: 119.5999s
	iters: 500, epoch: 2 | loss: 0.1863607
	speed: 0.0115s/iter; left time: 118.5341s
Epoch: 2 cost time: 6.859601736068726
Epoch: 2, Steps: 570 | Train Loss: 0.1794212 Vali Loss: 0.0579344 Test Loss: 0.1662709
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1860282
	speed: 0.0383s/iter; left time: 389.0488s
	iters: 200, epoch: 3 | loss: 0.1703259
	speed: 0.0114s/iter; left time: 114.9935s
	iters: 300, epoch: 3 | loss: 0.1034399
	speed: 0.0115s/iter; left time: 114.0635s
	iters: 400, epoch: 3 | loss: 0.1257529
	speed: 0.0114s/iter; left time: 112.7001s
	iters: 500, epoch: 3 | loss: 0.1156912
	speed: 0.0114s/iter; left time: 111.6939s
Epoch: 3 cost time: 6.817661285400391
Epoch: 3, Steps: 570 | Train Loss: 0.1496666 Vali Loss: 0.0448545 Test Loss: 0.1353032
Validation loss decreased (0.046089 --> 0.044854).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1272880
	speed: 0.0388s/iter; left time: 371.8481s
	iters: 200, epoch: 4 | loss: 0.1286890
	speed: 0.0114s/iter; left time: 108.5797s
	iters: 300, epoch: 4 | loss: 0.0969923
	speed: 0.0114s/iter; left time: 107.2541s
	iters: 400, epoch: 4 | loss: 0.0714660
	speed: 0.0115s/iter; left time: 106.4393s
	iters: 500, epoch: 4 | loss: 0.1516775
	speed: 0.0115s/iter; left time: 105.2831s
Epoch: 4 cost time: 6.816018581390381
Epoch: 4, Steps: 570 | Train Loss: 0.1244113 Vali Loss: 0.0458936 Test Loss: 0.1368112
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0831007
	speed: 0.0374s/iter; left time: 337.2361s
	iters: 200, epoch: 5 | loss: 0.0894234
	speed: 0.0114s/iter; left time: 101.8794s
	iters: 300, epoch: 5 | loss: 0.1539751
	speed: 0.0114s/iter; left time: 100.9407s
	iters: 400, epoch: 5 | loss: 0.0966540
	speed: 0.0114s/iter; left time: 99.7683s
	iters: 500, epoch: 5 | loss: 0.1262841
	speed: 0.0114s/iter; left time: 98.4048s
Epoch: 5 cost time: 6.79752516746521
Epoch: 5, Steps: 570 | Train Loss: 0.1050426 Vali Loss: 0.0450158 Test Loss: 0.1372498
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0814576
	speed: 0.0378s/iter; left time: 319.3679s
	iters: 200, epoch: 6 | loss: 0.0685639
	speed: 0.0114s/iter; left time: 95.5603s
	iters: 300, epoch: 6 | loss: 0.0879787
	speed: 0.0114s/iter; left time: 94.3860s
	iters: 400, epoch: 6 | loss: 0.0606897
	speed: 0.0114s/iter; left time: 93.2486s
	iters: 500, epoch: 6 | loss: 0.0625465
	speed: 0.0114s/iter; left time: 92.1211s
Epoch: 6 cost time: 6.792489767074585
Epoch: 6, Steps: 570 | Train Loss: 0.0924215 Vali Loss: 0.0437972 Test Loss: 0.1383720
Validation loss decreased (0.044854 --> 0.043797).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0925268
	speed: 0.0379s/iter; left time: 299.0015s
	iters: 200, epoch: 7 | loss: 0.0876379
	speed: 0.0114s/iter; left time: 88.6799s
	iters: 300, epoch: 7 | loss: 0.0903184
	speed: 0.0114s/iter; left time: 87.5677s
	iters: 400, epoch: 7 | loss: 0.0643708
	speed: 0.0114s/iter; left time: 86.5562s
	iters: 500, epoch: 7 | loss: 0.1023967
	speed: 0.0114s/iter; left time: 85.2488s
Epoch: 7 cost time: 6.780706882476807
Epoch: 7, Steps: 570 | Train Loss: 0.0852080 Vali Loss: 0.0439345 Test Loss: 0.1393003
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0709743
	speed: 0.0402s/iter; left time: 294.1995s
	iters: 200, epoch: 8 | loss: 0.0723450
	speed: 0.0116s/iter; left time: 83.9817s
	iters: 300, epoch: 8 | loss: 0.0668660
	speed: 0.0115s/iter; left time: 81.5001s
	iters: 400, epoch: 8 | loss: 0.0706788
	speed: 0.0115s/iter; left time: 80.5803s
	iters: 500, epoch: 8 | loss: 0.0804036
	speed: 0.0115s/iter; left time: 79.3393s
Epoch: 8 cost time: 6.982064962387085
Epoch: 8, Steps: 570 | Train Loss: 0.0810429 Vali Loss: 0.0440970 Test Loss: 0.1393788
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0490901
	speed: 0.0402s/iter; left time: 270.9074s
	iters: 200, epoch: 9 | loss: 0.0777733
	speed: 0.0115s/iter; left time: 76.0610s
	iters: 300, epoch: 9 | loss: 0.0971335
	speed: 0.0115s/iter; left time: 75.0123s
	iters: 400, epoch: 9 | loss: 0.0591456
	speed: 0.0115s/iter; left time: 73.8601s
	iters: 500, epoch: 9 | loss: 0.0914075
	speed: 0.0114s/iter; left time: 72.5994s
Epoch: 9 cost time: 6.808941125869751
Epoch: 9, Steps: 570 | Train Loss: 0.0786846 Vali Loss: 0.0439969 Test Loss: 0.1393926
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13855166733264923, mae:0.23596133291721344
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.0974500
	speed: 0.0230s/iter; left time: 260.0262s
	iters: 200, epoch: 1 | loss: 0.2052382
	speed: 0.0110s/iter; left time: 123.6560s
	iters: 300, epoch: 1 | loss: 0.1459617
	speed: 0.0111s/iter; left time: 122.7259s
	iters: 400, epoch: 1 | loss: 0.1657365
	speed: 0.0110s/iter; left time: 121.3802s
	iters: 500, epoch: 1 | loss: 0.1082806
	speed: 0.0111s/iter; left time: 120.4589s
Epoch: 1 cost time: 7.542965888977051
Epoch: 1, Steps: 570 | Train Loss: 0.1601642 Vali Loss: 0.0422012 Test Loss: 0.1301945
Validation loss decreased (inf --> 0.042201).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1238574
	speed: 0.0405s/iter; left time: 435.0839s
	iters: 200, epoch: 2 | loss: 0.0918113
	speed: 0.0111s/iter; left time: 117.6440s
	iters: 300, epoch: 2 | loss: 0.1213746
	speed: 0.0111s/iter; left time: 116.6608s
	iters: 400, epoch: 2 | loss: 0.1729004
	speed: 0.0111s/iter; left time: 115.4325s
	iters: 500, epoch: 2 | loss: 0.1869538
	speed: 0.0110s/iter; left time: 113.9860s
Epoch: 2 cost time: 6.6264612674713135
Epoch: 2, Steps: 570 | Train Loss: 0.1370953 Vali Loss: 0.0412954 Test Loss: 0.1261017
Validation loss decreased (0.042201 --> 0.041295).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1401310
	speed: 0.0391s/iter; left time: 397.1015s
	iters: 200, epoch: 3 | loss: 0.0646986
	speed: 0.0111s/iter; left time: 111.4142s
	iters: 300, epoch: 3 | loss: 0.1279343
	speed: 0.0111s/iter; left time: 110.3114s
	iters: 400, epoch: 3 | loss: 0.1239163
	speed: 0.0111s/iter; left time: 109.0126s
	iters: 500, epoch: 3 | loss: 0.1246570
	speed: 0.0110s/iter; left time: 107.8185s
Epoch: 3 cost time: 6.641491174697876
Epoch: 3, Steps: 570 | Train Loss: 0.1077242 Vali Loss: 0.0355741 Test Loss: 0.1213372
Validation loss decreased (0.041295 --> 0.035574).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0936984
	speed: 0.0394s/iter; left time: 377.5760s
	iters: 200, epoch: 4 | loss: 0.0660693
	speed: 0.0120s/iter; left time: 114.3129s
	iters: 300, epoch: 4 | loss: 0.0422177
	speed: 0.0121s/iter; left time: 113.2244s
	iters: 400, epoch: 4 | loss: 0.1038613
	speed: 0.0119s/iter; left time: 110.8176s
	iters: 500, epoch: 4 | loss: 0.0759548
	speed: 0.0110s/iter; left time: 101.1919s
Epoch: 4 cost time: 6.985462427139282
Epoch: 4, Steps: 570 | Train Loss: 0.0860111 Vali Loss: 0.0350507 Test Loss: 0.1255417
Validation loss decreased (0.035574 --> 0.035051).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0573087
	speed: 0.0384s/iter; left time: 346.4130s
	iters: 200, epoch: 5 | loss: 0.0602667
	speed: 0.0111s/iter; left time: 98.7681s
	iters: 300, epoch: 5 | loss: 0.0824649
	speed: 0.0111s/iter; left time: 97.5708s
	iters: 400, epoch: 5 | loss: 0.0633375
	speed: 0.0111s/iter; left time: 96.4713s
	iters: 500, epoch: 5 | loss: 0.0625824
	speed: 0.0110s/iter; left time: 95.2614s
Epoch: 5 cost time: 6.6474058628082275
Epoch: 5, Steps: 570 | Train Loss: 0.0691570 Vali Loss: 0.0333579 Test Loss: 0.1244702
Validation loss decreased (0.035051 --> 0.033358).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0775955
	speed: 0.0389s/iter; left time: 328.8064s
	iters: 200, epoch: 6 | loss: 0.0551258
	speed: 0.0110s/iter; left time: 92.2023s
	iters: 300, epoch: 6 | loss: 0.0558651
	speed: 0.0111s/iter; left time: 91.1814s
	iters: 400, epoch: 6 | loss: 0.0444722
	speed: 0.0110s/iter; left time: 89.9931s
	iters: 500, epoch: 6 | loss: 0.0528609
	speed: 0.0110s/iter; left time: 88.6404s
Epoch: 6 cost time: 6.61210560798645
Epoch: 6, Steps: 570 | Train Loss: 0.0584916 Vali Loss: 0.0337634 Test Loss: 0.1316425
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0433577
	speed: 0.0386s/iter; left time: 303.9363s
	iters: 200, epoch: 7 | loss: 0.0621938
	speed: 0.0111s/iter; left time: 86.2441s
	iters: 300, epoch: 7 | loss: 0.0465754
	speed: 0.0111s/iter; left time: 84.8773s
	iters: 400, epoch: 7 | loss: 0.0555614
	speed: 0.0110s/iter; left time: 83.7364s
	iters: 500, epoch: 7 | loss: 0.0376010
	speed: 0.0110s/iter; left time: 82.6378s
Epoch: 7 cost time: 6.62431788444519
Epoch: 7, Steps: 570 | Train Loss: 0.0522816 Vali Loss: 0.0336066 Test Loss: 0.1316548
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0479672
	speed: 0.0367s/iter; left time: 268.2666s
	iters: 200, epoch: 8 | loss: 0.0504123
	speed: 0.0110s/iter; left time: 79.4449s
	iters: 300, epoch: 8 | loss: 0.0374279
	speed: 0.0110s/iter; left time: 78.3282s
	iters: 400, epoch: 8 | loss: 0.0494475
	speed: 0.0110s/iter; left time: 77.2228s
	iters: 500, epoch: 8 | loss: 0.0504735
	speed: 0.0110s/iter; left time: 76.1324s
Epoch: 8 cost time: 6.554762363433838
Epoch: 8, Steps: 570 | Train Loss: 0.0490019 Vali Loss: 0.0342471 Test Loss: 0.1331143
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12465690076351166, mae:0.21787424385547638
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2019889
	speed: 0.0235s/iter; left time: 265.5710s
	iters: 200, epoch: 1 | loss: 0.2130914
	speed: 0.0114s/iter; left time: 127.1667s
	iters: 300, epoch: 1 | loss: 0.1833379
	speed: 0.0114s/iter; left time: 126.4591s
	iters: 400, epoch: 1 | loss: 0.1353990
	speed: 0.0114s/iter; left time: 125.0563s
	iters: 500, epoch: 1 | loss: 0.1589779
	speed: 0.0114s/iter; left time: 124.3560s
Epoch: 1 cost time: 7.756711721420288
Epoch: 1, Steps: 570 | Train Loss: 0.1984546 Vali Loss: 0.0496909 Test Loss: 0.1584453
Validation loss decreased (inf --> 0.049691).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1731774
	speed: 0.0376s/iter; left time: 403.9704s
	iters: 200, epoch: 2 | loss: 0.2615232
	speed: 0.0103s/iter; left time: 109.0370s
	iters: 300, epoch: 2 | loss: 0.1243211
	speed: 0.0103s/iter; left time: 108.0183s
	iters: 400, epoch: 2 | loss: 0.1666401
	speed: 0.0103s/iter; left time: 107.1997s
	iters: 500, epoch: 2 | loss: 0.1445317
	speed: 0.0103s/iter; left time: 105.9342s
Epoch: 2 cost time: 6.165400743484497
Epoch: 2, Steps: 570 | Train Loss: 0.2028869 Vali Loss: 0.0559001 Test Loss: 0.1606367
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1585160
	speed: 0.0381s/iter; left time: 387.2574s
	iters: 200, epoch: 3 | loss: 0.1345448
	speed: 0.0103s/iter; left time: 103.6941s
	iters: 300, epoch: 3 | loss: 0.1909739
	speed: 0.0103s/iter; left time: 102.4446s
	iters: 400, epoch: 3 | loss: 0.1253612
	speed: 0.0103s/iter; left time: 101.3781s
	iters: 500, epoch: 3 | loss: 0.1260650
	speed: 0.0102s/iter; left time: 100.0312s
Epoch: 3 cost time: 6.191855430603027
Epoch: 3, Steps: 570 | Train Loss: 0.1610141 Vali Loss: 0.0496181 Test Loss: 0.1464581
Validation loss decreased (0.049691 --> 0.049618).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1535898
	speed: 0.0382s/iter; left time: 366.6446s
	iters: 200, epoch: 4 | loss: 0.1112829
	speed: 0.0114s/iter; left time: 108.2287s
	iters: 300, epoch: 4 | loss: 0.1107739
	speed: 0.0107s/iter; left time: 100.6790s
	iters: 400, epoch: 4 | loss: 0.2499674
	speed: 0.0103s/iter; left time: 95.2904s
	iters: 500, epoch: 4 | loss: 0.0918426
	speed: 0.0103s/iter; left time: 94.3467s
Epoch: 4 cost time: 6.451675891876221
Epoch: 4, Steps: 570 | Train Loss: 0.1255826 Vali Loss: 0.0450062 Test Loss: 0.1426192
Validation loss decreased (0.049618 --> 0.045006).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1097186
	speed: 0.0382s/iter; left time: 344.7734s
	iters: 200, epoch: 5 | loss: 0.1317494
	speed: 0.0114s/iter; left time: 101.5193s
	iters: 300, epoch: 5 | loss: 0.1488588
	speed: 0.0114s/iter; left time: 100.1938s
	iters: 400, epoch: 5 | loss: 0.0857320
	speed: 0.0105s/iter; left time: 91.6386s
	iters: 500, epoch: 5 | loss: 0.1473603
	speed: 0.0102s/iter; left time: 88.1586s
Epoch: 5 cost time: 6.513279438018799
Epoch: 5, Steps: 570 | Train Loss: 0.1054959 Vali Loss: 0.0452785 Test Loss: 0.1415697
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0955923
	speed: 0.0373s/iter; left time: 315.4189s
	iters: 200, epoch: 6 | loss: 0.0796199
	speed: 0.0103s/iter; left time: 86.0383s
	iters: 300, epoch: 6 | loss: 0.0931741
	speed: 0.0103s/iter; left time: 85.0698s
	iters: 400, epoch: 6 | loss: 0.0931934
	speed: 0.0103s/iter; left time: 84.1215s
	iters: 500, epoch: 6 | loss: 0.1077420
	speed: 0.0103s/iter; left time: 83.0959s
Epoch: 6 cost time: 6.2047271728515625
Epoch: 6, Steps: 570 | Train Loss: 0.0928161 Vali Loss: 0.0452328 Test Loss: 0.1478300
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0777740
	speed: 0.0393s/iter; left time: 310.0170s
	iters: 200, epoch: 7 | loss: 0.0906318
	speed: 0.0118s/iter; left time: 91.9422s
	iters: 300, epoch: 7 | loss: 0.0649016
	speed: 0.0113s/iter; left time: 86.7489s
	iters: 400, epoch: 7 | loss: 0.0970137
	speed: 0.0103s/iter; left time: 78.0975s
	iters: 500, epoch: 7 | loss: 0.0612615
	speed: 0.0103s/iter; left time: 77.1852s
Epoch: 7 cost time: 6.5860655307769775
Epoch: 7, Steps: 570 | Train Loss: 0.0846187 Vali Loss: 0.0453729 Test Loss: 0.1449361
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1428108662366867, mae:0.2442036122083664
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1978606
	speed: 0.0253s/iter; left time: 285.7327s
	iters: 200, epoch: 1 | loss: 0.1406488
	speed: 0.0138s/iter; left time: 154.9034s
	iters: 300, epoch: 1 | loss: 0.2377709
	speed: 0.0138s/iter; left time: 153.1342s
	iters: 400, epoch: 1 | loss: 0.1688309
	speed: 0.0138s/iter; left time: 152.0688s
	iters: 500, epoch: 1 | loss: 0.1429378
	speed: 0.0138s/iter; left time: 150.6334s
Epoch: 1 cost time: 9.077648401260376
Epoch: 1, Steps: 570 | Train Loss: 0.1824579 Vali Loss: 0.0461201 Test Loss: 0.1406951
Validation loss decreased (inf --> 0.046120).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1808321
	speed: 0.0451s/iter; left time: 484.2704s
	iters: 200, epoch: 2 | loss: 0.1237853
	speed: 0.0137s/iter; left time: 145.3898s
	iters: 300, epoch: 2 | loss: 0.1161452
	speed: 0.0137s/iter; left time: 143.9057s
	iters: 400, epoch: 2 | loss: 0.0831951
	speed: 0.0137s/iter; left time: 142.7784s
	iters: 500, epoch: 2 | loss: 0.1708268
	speed: 0.0137s/iter; left time: 141.0289s
Epoch: 2 cost time: 8.10493278503418
Epoch: 2, Steps: 570 | Train Loss: 0.1403602 Vali Loss: 0.0479635 Test Loss: 0.1585671
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1754857
	speed: 0.0470s/iter; left time: 477.9896s
	iters: 200, epoch: 3 | loss: 0.0950794
	speed: 0.0138s/iter; left time: 138.7746s
	iters: 300, epoch: 3 | loss: 0.0790503
	speed: 0.0138s/iter; left time: 137.2874s
	iters: 400, epoch: 3 | loss: 0.0907891
	speed: 0.0137s/iter; left time: 135.3569s
	iters: 500, epoch: 3 | loss: 0.0887034
	speed: 0.0137s/iter; left time: 133.9684s
Epoch: 3 cost time: 8.151356220245361
Epoch: 3, Steps: 570 | Train Loss: 0.1063732 Vali Loss: 0.0409150 Test Loss: 0.1384491
Validation loss decreased (0.046120 --> 0.040915).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0839169
	speed: 0.0471s/iter; left time: 452.1925s
	iters: 200, epoch: 4 | loss: 0.0629344
	speed: 0.0138s/iter; left time: 130.5748s
	iters: 300, epoch: 4 | loss: 0.0953755
	speed: 0.0138s/iter; left time: 129.1842s
	iters: 400, epoch: 4 | loss: 0.0753769
	speed: 0.0137s/iter; left time: 127.7102s
	iters: 500, epoch: 4 | loss: 0.0546866
	speed: 0.0137s/iter; left time: 126.2286s
Epoch: 4 cost time: 8.154263496398926
Epoch: 4, Steps: 570 | Train Loss: 0.0716987 Vali Loss: 0.0403713 Test Loss: 0.1423966
Validation loss decreased (0.040915 --> 0.040371).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0682062
	speed: 0.0444s/iter; left time: 400.7152s
	iters: 200, epoch: 5 | loss: 0.0543592
	speed: 0.0136s/iter; left time: 121.4990s
	iters: 300, epoch: 5 | loss: 0.0492750
	speed: 0.0136s/iter; left time: 120.4039s
	iters: 400, epoch: 5 | loss: 0.0439108
	speed: 0.0136s/iter; left time: 119.0160s
	iters: 500, epoch: 5 | loss: 0.0325127
	speed: 0.0136s/iter; left time: 117.6236s
Epoch: 5 cost time: 8.04454231262207
Epoch: 5, Steps: 570 | Train Loss: 0.0540604 Vali Loss: 0.0405654 Test Loss: 0.1445131
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0450938
	speed: 0.0449s/iter; left time: 379.1597s
	iters: 200, epoch: 6 | loss: 0.0751078
	speed: 0.0138s/iter; left time: 115.2269s
	iters: 300, epoch: 6 | loss: 0.0407169
	speed: 0.0138s/iter; left time: 113.8489s
	iters: 400, epoch: 6 | loss: 0.0473953
	speed: 0.0138s/iter; left time: 112.4643s
	iters: 500, epoch: 6 | loss: 0.0438990
	speed: 0.0138s/iter; left time: 111.1997s
Epoch: 6 cost time: 8.113397359848022
Epoch: 6, Steps: 570 | Train Loss: 0.0449369 Vali Loss: 0.0414444 Test Loss: 0.1482243
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0427545
	speed: 0.0439s/iter; left time: 346.1075s
	iters: 200, epoch: 7 | loss: 0.0429754
	speed: 0.0137s/iter; left time: 106.5255s
	iters: 300, epoch: 7 | loss: 0.0315846
	speed: 0.0137s/iter; left time: 105.3638s
	iters: 400, epoch: 7 | loss: 0.0442837
	speed: 0.0138s/iter; left time: 104.2444s
	iters: 500, epoch: 7 | loss: 0.0533348
	speed: 0.0137s/iter; left time: 102.8119s
Epoch: 7 cost time: 8.11225938796997
Epoch: 7, Steps: 570 | Train Loss: 0.0403531 Vali Loss: 0.0424153 Test Loss: 0.1492263
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1425885260105133, mae:0.24156534671783447
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2268765
	speed: 0.0249s/iter; left time: 281.9181s
	iters: 200, epoch: 1 | loss: 0.1184546
	speed: 0.0134s/iter; left time: 150.1864s
	iters: 300, epoch: 1 | loss: 0.1239855
	speed: 0.0134s/iter; left time: 148.5352s
	iters: 400, epoch: 1 | loss: 0.1680717
	speed: 0.0134s/iter; left time: 147.5342s
	iters: 500, epoch: 1 | loss: 0.1292608
	speed: 0.0134s/iter; left time: 146.0721s
Epoch: 1 cost time: 8.840498685836792
Epoch: 1, Steps: 570 | Train Loss: 0.1520934 Vali Loss: 0.0372690 Test Loss: 0.1163540
Validation loss decreased (inf --> 0.037269).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0825776
	speed: 0.0467s/iter; left time: 501.6026s
	iters: 200, epoch: 2 | loss: 0.2555671
	speed: 0.0135s/iter; left time: 143.7085s
	iters: 300, epoch: 2 | loss: 0.1489368
	speed: 0.0135s/iter; left time: 142.5570s
	iters: 400, epoch: 2 | loss: 0.0923580
	speed: 0.0135s/iter; left time: 141.0398s
	iters: 500, epoch: 2 | loss: 0.0957127
	speed: 0.0135s/iter; left time: 139.9604s
Epoch: 2 cost time: 8.00999116897583
Epoch: 2, Steps: 570 | Train Loss: 0.1173969 Vali Loss: 0.0392548 Test Loss: 0.1194504
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1095200
	speed: 0.0449s/iter; left time: 455.8432s
	iters: 200, epoch: 3 | loss: 0.0508968
	speed: 0.0135s/iter; left time: 135.6097s
	iters: 300, epoch: 3 | loss: 0.0897601
	speed: 0.0135s/iter; left time: 134.3686s
	iters: 400, epoch: 3 | loss: 0.0699842
	speed: 0.0135s/iter; left time: 132.8286s
	iters: 500, epoch: 3 | loss: 0.0651250
	speed: 0.0135s/iter; left time: 131.4421s
Epoch: 3 cost time: 7.990720272064209
Epoch: 3, Steps: 570 | Train Loss: 0.0834549 Vali Loss: 0.0350599 Test Loss: 0.1154133
Validation loss decreased (0.037269 --> 0.035060).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0440067
	speed: 0.0445s/iter; left time: 426.9734s
	iters: 200, epoch: 4 | loss: 0.0632474
	speed: 0.0135s/iter; left time: 128.4234s
	iters: 300, epoch: 4 | loss: 0.0656902
	speed: 0.0135s/iter; left time: 127.0102s
	iters: 400, epoch: 4 | loss: 0.0422224
	speed: 0.0135s/iter; left time: 125.1020s
	iters: 500, epoch: 4 | loss: 0.0366644
	speed: 0.0135s/iter; left time: 123.7260s
Epoch: 4 cost time: 7.982506990432739
Epoch: 4, Steps: 570 | Train Loss: 0.0564874 Vali Loss: 0.0340818 Test Loss: 0.1165414
Validation loss decreased (0.035060 --> 0.034082).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0329393
	speed: 0.0442s/iter; left time: 398.2907s
	iters: 200, epoch: 5 | loss: 0.0378728
	speed: 0.0135s/iter; left time: 120.5737s
	iters: 300, epoch: 5 | loss: 0.0312857
	speed: 0.0135s/iter; left time: 119.2375s
	iters: 400, epoch: 5 | loss: 0.0266005
	speed: 0.0135s/iter; left time: 117.8995s
	iters: 500, epoch: 5 | loss: 0.0470453
	speed: 0.0135s/iter; left time: 116.3442s
Epoch: 5 cost time: 7.980235576629639
Epoch: 5, Steps: 570 | Train Loss: 0.0417427 Vali Loss: 0.0357250 Test Loss: 0.1175037
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0335595
	speed: 0.0436s/iter; left time: 368.5394s
	iters: 200, epoch: 6 | loss: 0.0529354
	speed: 0.0135s/iter; left time: 112.5754s
	iters: 300, epoch: 6 | loss: 0.0342036
	speed: 0.0135s/iter; left time: 111.3704s
	iters: 400, epoch: 6 | loss: 0.0658579
	speed: 0.0135s/iter; left time: 110.2865s
	iters: 500, epoch: 6 | loss: 0.0367821
	speed: 0.0135s/iter; left time: 108.8250s
Epoch: 6 cost time: 7.967366695404053
Epoch: 6, Steps: 570 | Train Loss: 0.0348177 Vali Loss: 0.0363659 Test Loss: 0.1205297
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0248893
	speed: 0.0440s/iter; left time: 346.5777s
	iters: 200, epoch: 7 | loss: 0.0280079
	speed: 0.0134s/iter; left time: 104.3460s
	iters: 300, epoch: 7 | loss: 0.0273204
	speed: 0.0134s/iter; left time: 103.1093s
	iters: 400, epoch: 7 | loss: 0.0482202
	speed: 0.0134s/iter; left time: 101.7093s
	iters: 500, epoch: 7 | loss: 0.0353472
	speed: 0.0134s/iter; left time: 100.4292s
Epoch: 7 cost time: 7.914416313171387
Epoch: 7, Steps: 570 | Train Loss: 0.0313630 Vali Loss: 0.0362975 Test Loss: 0.1222203
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11669544130563736, mae:0.2160900980234146
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1069971
	speed: 0.0272s/iter; left time: 307.2920s
	iters: 200, epoch: 1 | loss: 0.2587161
	speed: 0.0152s/iter; left time: 169.8205s
	iters: 300, epoch: 1 | loss: 0.2063680
	speed: 0.0151s/iter; left time: 167.7873s
	iters: 400, epoch: 1 | loss: 0.2087482
	speed: 0.0151s/iter; left time: 166.3578s
	iters: 500, epoch: 1 | loss: 0.2114511
	speed: 0.0136s/iter; left time: 147.8987s
Epoch: 1 cost time: 9.616235733032227
Epoch: 1, Steps: 570 | Train Loss: 0.1899124 Vali Loss: 0.0503171 Test Loss: 0.1435419
Validation loss decreased (inf --> 0.050317).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1118510
	speed: 0.0464s/iter; left time: 498.0457s
	iters: 200, epoch: 2 | loss: 0.1333888
	speed: 0.0148s/iter; left time: 157.3386s
	iters: 300, epoch: 2 | loss: 0.0712786
	speed: 0.0151s/iter; left time: 158.7619s
	iters: 400, epoch: 2 | loss: 0.0988185
	speed: 0.0146s/iter; left time: 152.0484s
	iters: 500, epoch: 2 | loss: 0.1156343
	speed: 0.0134s/iter; left time: 138.6206s
Epoch: 2 cost time: 8.523264169692993
Epoch: 2, Steps: 570 | Train Loss: 0.1346016 Vali Loss: 0.0433708 Test Loss: 0.1410017
Validation loss decreased (0.050317 --> 0.043371).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0975002
	speed: 0.0452s/iter; left time: 459.6507s
	iters: 200, epoch: 3 | loss: 0.1073149
	speed: 0.0135s/iter; left time: 135.6554s
	iters: 300, epoch: 3 | loss: 0.0861029
	speed: 0.0135s/iter; left time: 134.2873s
	iters: 400, epoch: 3 | loss: 0.0734350
	speed: 0.0135s/iter; left time: 133.5314s
	iters: 500, epoch: 3 | loss: 0.0743892
	speed: 0.0135s/iter; left time: 131.3241s
Epoch: 3 cost time: 7.998064756393433
Epoch: 3, Steps: 570 | Train Loss: 0.0793540 Vali Loss: 0.0424974 Test Loss: 0.1376587
Validation loss decreased (0.043371 --> 0.042497).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0444206
	speed: 0.0455s/iter; left time: 436.2949s
	iters: 200, epoch: 4 | loss: 0.0393224
	speed: 0.0134s/iter; left time: 127.3100s
	iters: 300, epoch: 4 | loss: 0.0441419
	speed: 0.0134s/iter; left time: 125.6971s
	iters: 400, epoch: 4 | loss: 0.0433377
	speed: 0.0134s/iter; left time: 124.7684s
	iters: 500, epoch: 4 | loss: 0.0273443
	speed: 0.0134s/iter; left time: 123.1587s
Epoch: 4 cost time: 7.925135612487793
Epoch: 4, Steps: 570 | Train Loss: 0.0454741 Vali Loss: 0.0429966 Test Loss: 0.1436175
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0456207
	speed: 0.0441s/iter; left time: 397.5183s
	iters: 200, epoch: 5 | loss: 0.0484772
	speed: 0.0136s/iter; left time: 121.0091s
	iters: 300, epoch: 5 | loss: 0.0314100
	speed: 0.0136s/iter; left time: 119.6222s
	iters: 400, epoch: 5 | loss: 0.0519954
	speed: 0.0136s/iter; left time: 118.5510s
	iters: 500, epoch: 5 | loss: 0.0293121
	speed: 0.0136s/iter; left time: 116.9425s
Epoch: 5 cost time: 8.026621341705322
Epoch: 5, Steps: 570 | Train Loss: 0.0318291 Vali Loss: 0.0437204 Test Loss: 0.1449698
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0287018
	speed: 0.0447s/iter; left time: 377.8267s
	iters: 200, epoch: 6 | loss: 0.0228253
	speed: 0.0135s/iter; left time: 112.5578s
	iters: 300, epoch: 6 | loss: 0.0222545
	speed: 0.0134s/iter; left time: 110.8749s
	iters: 400, epoch: 6 | loss: 0.0427278
	speed: 0.0134s/iter; left time: 109.5982s
	iters: 500, epoch: 6 | loss: 0.0231968
	speed: 0.0134s/iter; left time: 108.1321s
Epoch: 6 cost time: 7.968699932098389
Epoch: 6, Steps: 570 | Train Loss: 0.0262436 Vali Loss: 0.0438920 Test Loss: 0.1476728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13781242072582245, mae:0.24142491817474365
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1986155
	speed: 0.0298s/iter; left time: 337.2337s
	iters: 200, epoch: 1 | loss: 0.1691805
	speed: 0.0177s/iter; left time: 198.4888s
	iters: 300, epoch: 1 | loss: 0.2655474
	speed: 0.0178s/iter; left time: 197.2031s
	iters: 400, epoch: 1 | loss: 0.1940346
	speed: 0.0177s/iter; left time: 194.9184s
	iters: 500, epoch: 1 | loss: 0.1390540
	speed: 0.0178s/iter; left time: 194.2342s
Epoch: 1 cost time: 11.380595207214355
Epoch: 1, Steps: 570 | Train Loss: 0.1975997 Vali Loss: 0.0505389 Test Loss: 0.1476364
Validation loss decreased (inf --> 0.050539).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2220080
	speed: 0.0535s/iter; left time: 574.2126s
	iters: 200, epoch: 2 | loss: 0.2834747
	speed: 0.0178s/iter; left time: 189.5842s
	iters: 300, epoch: 2 | loss: 0.3231107
	speed: 0.0178s/iter; left time: 187.1038s
	iters: 400, epoch: 2 | loss: 0.2974539
	speed: 0.0178s/iter; left time: 185.3687s
	iters: 500, epoch: 2 | loss: 0.2700153
	speed: 0.0169s/iter; left time: 174.5312s
Epoch: 2 cost time: 10.287063837051392
Epoch: 2, Steps: 570 | Train Loss: 0.2516783 Vali Loss: 0.0667279 Test Loss: 0.1820506
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1836330
	speed: 0.0493s/iter; left time: 501.1702s
	iters: 200, epoch: 3 | loss: 0.2148254
	speed: 0.0163s/iter; left time: 164.2010s
	iters: 300, epoch: 3 | loss: 0.3247426
	speed: 0.0163s/iter; left time: 162.5045s
	iters: 400, epoch: 3 | loss: 0.1836453
	speed: 0.0163s/iter; left time: 160.8882s
	iters: 500, epoch: 3 | loss: 0.1678694
	speed: 0.0163s/iter; left time: 159.1637s
Epoch: 3 cost time: 9.621311902999878
Epoch: 3, Steps: 570 | Train Loss: 0.2291430 Vali Loss: 0.0621862 Test Loss: 0.1663595
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2186916
	speed: 0.0497s/iter; left time: 476.9400s
	iters: 200, epoch: 4 | loss: 0.1787783
	speed: 0.0172s/iter; left time: 163.4362s
	iters: 300, epoch: 4 | loss: 0.1733173
	speed: 0.0172s/iter; left time: 161.6590s
	iters: 400, epoch: 4 | loss: 0.1957897
	speed: 0.0172s/iter; left time: 159.9852s
	iters: 500, epoch: 4 | loss: 0.1448365
	speed: 0.0172s/iter; left time: 158.2155s
Epoch: 4 cost time: 10.082873582839966
Epoch: 4, Steps: 570 | Train Loss: 0.1949281 Vali Loss: 0.0626483 Test Loss: 0.1643371
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14789031445980072, mae:0.24401988089084625
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1967783
	speed: 0.0294s/iter; left time: 331.7051s
	iters: 200, epoch: 1 | loss: 0.0812769
	speed: 0.0172s/iter; left time: 192.7487s
	iters: 300, epoch: 1 | loss: 0.2097766
	speed: 0.0172s/iter; left time: 191.4158s
	iters: 400, epoch: 1 | loss: 0.1258427
	speed: 0.0173s/iter; left time: 189.8722s
	iters: 500, epoch: 1 | loss: 0.0920935
	speed: 0.0172s/iter; left time: 188.0108s
Epoch: 1 cost time: 11.08919358253479
Epoch: 1, Steps: 570 | Train Loss: 0.1694094 Vali Loss: 0.0414194 Test Loss: 0.1318534
Validation loss decreased (inf --> 0.041419).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1300433
	speed: 0.0505s/iter; left time: 541.4993s
	iters: 200, epoch: 2 | loss: 0.1766018
	speed: 0.0158s/iter; left time: 168.4416s
	iters: 300, epoch: 2 | loss: 0.1776148
	speed: 0.0158s/iter; left time: 166.8579s
	iters: 400, epoch: 2 | loss: 0.6121952
	speed: 0.0158s/iter; left time: 165.2048s
	iters: 500, epoch: 2 | loss: 0.2668276
	speed: 0.0158s/iter; left time: 163.7222s
Epoch: 2 cost time: 9.364811897277832
Epoch: 2, Steps: 570 | Train Loss: 0.2193054 Vali Loss: 0.0827282 Test Loss: 0.2201046
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2272870
	speed: 0.0496s/iter; left time: 503.6867s
	iters: 200, epoch: 3 | loss: 0.2946670
	speed: 0.0158s/iter; left time: 159.2937s
	iters: 300, epoch: 3 | loss: 0.1645177
	speed: 0.0159s/iter; left time: 157.9017s
	iters: 400, epoch: 3 | loss: 0.2846656
	speed: 0.0158s/iter; left time: 156.1253s
	iters: 500, epoch: 3 | loss: 0.1483205
	speed: 0.0158s/iter; left time: 154.5222s
Epoch: 3 cost time: 9.359254837036133
Epoch: 3, Steps: 570 | Train Loss: 0.2507399 Vali Loss: 0.0618857 Test Loss: 0.1737114
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1715246
	speed: 0.0485s/iter; left time: 465.4196s
	iters: 200, epoch: 4 | loss: 0.3059893
	speed: 0.0159s/iter; left time: 150.9421s
	iters: 300, epoch: 4 | loss: 0.2712645
	speed: 0.0159s/iter; left time: 149.2174s
	iters: 400, epoch: 4 | loss: 0.1277343
	speed: 0.0159s/iter; left time: 147.7398s
	iters: 500, epoch: 4 | loss: 0.2868744
	speed: 0.0159s/iter; left time: 146.0389s
Epoch: 4 cost time: 9.354865312576294
Epoch: 4, Steps: 570 | Train Loss: 0.2091032 Vali Loss: 0.0661804 Test Loss: 0.1758471
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1320623755455017, mae:0.23152689635753632
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1846964
	speed: 0.0283s/iter; left time: 320.3807s
	iters: 200, epoch: 1 | loss: 0.1534819
	speed: 0.0151s/iter; left time: 169.2495s
	iters: 300, epoch: 1 | loss: 0.1390241
	speed: 0.0147s/iter; left time: 162.9257s
	iters: 400, epoch: 1 | loss: 0.1953725
	speed: 0.0147s/iter; left time: 162.0118s
	iters: 500, epoch: 1 | loss: 0.3213199
	speed: 0.0147s/iter; left time: 160.4910s
Epoch: 1 cost time: 9.843920707702637
Epoch: 1, Steps: 570 | Train Loss: 0.2022955 Vali Loss: 0.0596252 Test Loss: 0.1810754
Validation loss decreased (inf --> 0.059625).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3014162
	speed: 0.0475s/iter; left time: 509.3662s
	iters: 200, epoch: 2 | loss: 0.1825785
	speed: 0.0147s/iter; left time: 156.4320s
	iters: 300, epoch: 2 | loss: 0.2656878
	speed: 0.0147s/iter; left time: 154.7906s
	iters: 400, epoch: 2 | loss: 0.2396755
	speed: 0.0147s/iter; left time: 153.4916s
	iters: 500, epoch: 2 | loss: 0.3102220
	speed: 0.0147s/iter; left time: 151.9770s
Epoch: 2 cost time: 8.708213567733765
Epoch: 2, Steps: 570 | Train Loss: 0.2341447 Vali Loss: 0.0562900 Test Loss: 0.1692586
Validation loss decreased (0.059625 --> 0.056290).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2520309
	speed: 0.0473s/iter; left time: 480.5975s
	iters: 200, epoch: 3 | loss: 0.1126558
	speed: 0.0147s/iter; left time: 147.8968s
	iters: 300, epoch: 3 | loss: 0.2455842
	speed: 0.0147s/iter; left time: 146.5743s
	iters: 400, epoch: 3 | loss: 0.1633121
	speed: 0.0147s/iter; left time: 144.9726s
	iters: 500, epoch: 3 | loss: 0.1875406
	speed: 0.0147s/iter; left time: 143.5934s
Epoch: 3 cost time: 8.705339908599854
Epoch: 3, Steps: 570 | Train Loss: 0.1976280 Vali Loss: 0.0501224 Test Loss: 0.1469226
Validation loss decreased (0.056290 --> 0.050122).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1423798
	speed: 0.0476s/iter; left time: 456.3403s
	iters: 200, epoch: 4 | loss: 0.1833380
	speed: 0.0148s/iter; left time: 140.1485s
	iters: 300, epoch: 4 | loss: 0.1767692
	speed: 0.0168s/iter; left time: 157.9111s
	iters: 400, epoch: 4 | loss: 0.1392000
	speed: 0.0168s/iter; left time: 156.4180s
	iters: 500, epoch: 4 | loss: 0.1467425
	speed: 0.0168s/iter; left time: 154.6078s
Epoch: 4 cost time: 9.466946840286255
Epoch: 4, Steps: 570 | Train Loss: 0.1538924 Vali Loss: 0.0479066 Test Loss: 0.1444010
Validation loss decreased (0.050122 --> 0.047907).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0917977
	speed: 0.0510s/iter; left time: 460.5205s
	iters: 200, epoch: 5 | loss: 0.1277048
	speed: 0.0168s/iter; left time: 149.4561s
	iters: 300, epoch: 5 | loss: 0.1231754
	speed: 0.0167s/iter; left time: 147.7252s
	iters: 400, epoch: 5 | loss: 0.0834559
	speed: 0.0167s/iter; left time: 146.0354s
	iters: 500, epoch: 5 | loss: 0.1487637
	speed: 0.0167s/iter; left time: 144.4001s
Epoch: 5 cost time: 9.830368280410767
Epoch: 5, Steps: 570 | Train Loss: 0.1337128 Vali Loss: 0.0466142 Test Loss: 0.1435483
Validation loss decreased (0.047907 --> 0.046614).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1269798
	speed: 0.0508s/iter; left time: 429.0487s
	iters: 200, epoch: 6 | loss: 0.1186455
	speed: 0.0168s/iter; left time: 140.4555s
	iters: 300, epoch: 6 | loss: 0.0984075
	speed: 0.0168s/iter; left time: 138.7475s
	iters: 400, epoch: 6 | loss: 0.0881625
	speed: 0.0168s/iter; left time: 137.0360s
	iters: 500, epoch: 6 | loss: 0.1166409
	speed: 0.0168s/iter; left time: 135.2798s
Epoch: 6 cost time: 9.90358567237854
Epoch: 6, Steps: 570 | Train Loss: 0.1221631 Vali Loss: 0.0458232 Test Loss: 0.1406332
Validation loss decreased (0.046614 --> 0.045823).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1413343
	speed: 0.0513s/iter; left time: 404.1826s
	iters: 200, epoch: 7 | loss: 0.0839411
	speed: 0.0169s/iter; left time: 131.2013s
	iters: 300, epoch: 7 | loss: 0.1261159
	speed: 0.0169s/iter; left time: 129.4941s
	iters: 400, epoch: 7 | loss: 0.0824899
	speed: 0.0169s/iter; left time: 127.8621s
	iters: 500, epoch: 7 | loss: 0.1464380
	speed: 0.0169s/iter; left time: 126.1481s
Epoch: 7 cost time: 9.931205034255981
Epoch: 7, Steps: 570 | Train Loss: 0.1152028 Vali Loss: 0.0455213 Test Loss: 0.1399625
Validation loss decreased (0.045823 --> 0.045521).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0983356
	speed: 0.0509s/iter; left time: 372.2029s
	iters: 200, epoch: 8 | loss: 0.1660734
	speed: 0.0168s/iter; left time: 121.0700s
	iters: 300, epoch: 8 | loss: 0.0982681
	speed: 0.0168s/iter; left time: 119.5100s
	iters: 400, epoch: 8 | loss: 0.1109750
	speed: 0.0168s/iter; left time: 117.7867s
	iters: 500, epoch: 8 | loss: 0.0811666
	speed: 0.0168s/iter; left time: 116.2020s
Epoch: 8 cost time: 9.916582107543945
Epoch: 8, Steps: 570 | Train Loss: 0.1107535 Vali Loss: 0.0446388 Test Loss: 0.1394486
Validation loss decreased (0.045521 --> 0.044639).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0843178
	speed: 0.0506s/iter; left time: 340.8785s
	iters: 200, epoch: 9 | loss: 0.0957296
	speed: 0.0168s/iter; left time: 111.3935s
	iters: 300, epoch: 9 | loss: 0.0958310
	speed: 0.0168s/iter; left time: 109.6103s
	iters: 400, epoch: 9 | loss: 0.0913657
	speed: 0.0167s/iter; left time: 107.5606s
	iters: 500, epoch: 9 | loss: 0.1282018
	speed: 0.0147s/iter; left time: 93.0923s
Epoch: 9 cost time: 9.51785922050476
Epoch: 9, Steps: 570 | Train Loss: 0.1083913 Vali Loss: 0.0448575 Test Loss: 0.1397041
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1445305
	speed: 0.0475s/iter; left time: 293.2807s
	iters: 200, epoch: 10 | loss: 0.1169368
	speed: 0.0163s/iter; left time: 98.8758s
	iters: 300, epoch: 10 | loss: 0.0864425
	speed: 0.0146s/iter; left time: 87.2130s
	iters: 400, epoch: 10 | loss: 0.1313425
	speed: 0.0146s/iter; left time: 85.7297s
	iters: 500, epoch: 10 | loss: 0.1608877
	speed: 0.0146s/iter; left time: 84.1472s
Epoch: 10 cost time: 8.754920244216919
Epoch: 10, Steps: 570 | Train Loss: 0.1071333 Vali Loss: 0.0449487 Test Loss: 0.1401038
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1228852
	speed: 0.0477s/iter; left time: 267.1378s
	iters: 200, epoch: 11 | loss: 0.0852268
	speed: 0.0162s/iter; left time: 89.2020s
	iters: 300, epoch: 11 | loss: 0.0976405
	speed: 0.0162s/iter; left time: 87.5708s
	iters: 400, epoch: 11 | loss: 0.1279954
	speed: 0.0162s/iter; left time: 85.9068s
	iters: 500, epoch: 11 | loss: 0.1509469
	speed: 0.0162s/iter; left time: 84.2788s
Epoch: 11 cost time: 9.552314281463623
Epoch: 11, Steps: 570 | Train Loss: 0.1064138 Vali Loss: 0.0450237 Test Loss: 0.1398980
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13961860537528992, mae:0.2440221607685089
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1424365
	speed: 0.0289s/iter; left time: 326.5482s
	iters: 200, epoch: 1 | loss: 0.1840478
	speed: 0.0175s/iter; left time: 195.5497s
	iters: 300, epoch: 1 | loss: 0.2390462
	speed: 0.0174s/iter; left time: 193.5633s
	iters: 400, epoch: 1 | loss: 0.1257376
	speed: 0.0175s/iter; left time: 191.9688s
	iters: 500, epoch: 1 | loss: 0.1427562
	speed: 0.0175s/iter; left time: 190.3794s
Epoch: 1 cost time: 11.140733003616333
Epoch: 1, Steps: 570 | Train Loss: 0.1878913 Vali Loss: 0.0468647 Test Loss: 0.1412132
Validation loss decreased (inf --> 0.046865).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2610076
	speed: 0.0546s/iter; left time: 585.6054s
	iters: 200, epoch: 2 | loss: 0.1107580
	speed: 0.0176s/iter; left time: 186.6025s
	iters: 300, epoch: 2 | loss: 0.1036385
	speed: 0.0175s/iter; left time: 184.7845s
	iters: 400, epoch: 2 | loss: 0.1070925
	speed: 0.0176s/iter; left time: 183.2917s
	iters: 500, epoch: 2 | loss: 0.1219436
	speed: 0.0175s/iter; left time: 181.2733s
Epoch: 2 cost time: 10.303776502609253
Epoch: 2, Steps: 570 | Train Loss: 0.1391301 Vali Loss: 0.0438123 Test Loss: 0.1367771
Validation loss decreased (0.046865 --> 0.043812).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0830769
	speed: 0.0544s/iter; left time: 552.5159s
	iters: 200, epoch: 3 | loss: 0.0651449
	speed: 0.0176s/iter; left time: 176.7942s
	iters: 300, epoch: 3 | loss: 0.0848362
	speed: 0.0175s/iter; left time: 174.5447s
	iters: 400, epoch: 3 | loss: 0.0720099
	speed: 0.0175s/iter; left time: 172.8727s
	iters: 500, epoch: 3 | loss: 0.0553302
	speed: 0.0176s/iter; left time: 171.5943s
Epoch: 3 cost time: 10.311809062957764
Epoch: 3, Steps: 570 | Train Loss: 0.0927919 Vali Loss: 0.0406958 Test Loss: 0.1434521
Validation loss decreased (0.043812 --> 0.040696).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0647112
	speed: 0.0549s/iter; left time: 526.1696s
	iters: 200, epoch: 4 | loss: 0.0716239
	speed: 0.0175s/iter; left time: 165.6594s
	iters: 300, epoch: 4 | loss: 0.0661048
	speed: 0.0175s/iter; left time: 163.8924s
	iters: 400, epoch: 4 | loss: 0.0359052
	speed: 0.0174s/iter; left time: 162.0842s
	iters: 500, epoch: 4 | loss: 0.0596870
	speed: 0.0174s/iter; left time: 160.0197s
Epoch: 4 cost time: 10.249898672103882
Epoch: 4, Steps: 570 | Train Loss: 0.0583398 Vali Loss: 0.0424002 Test Loss: 0.1405669
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0493537
	speed: 0.0571s/iter; left time: 515.0347s
	iters: 200, epoch: 5 | loss: 0.0440921
	speed: 0.0197s/iter; left time: 175.6686s
	iters: 300, epoch: 5 | loss: 0.0384487
	speed: 0.0196s/iter; left time: 172.8455s
	iters: 400, epoch: 5 | loss: 0.0319154
	speed: 0.0196s/iter; left time: 170.7646s
	iters: 500, epoch: 5 | loss: 0.0568911
	speed: 0.0182s/iter; left time: 156.7535s
Epoch: 5 cost time: 11.169706344604492
Epoch: 5, Steps: 570 | Train Loss: 0.0422725 Vali Loss: 0.0417912 Test Loss: 0.1395553
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0277847
	speed: 0.0531s/iter; left time: 448.6668s
	iters: 200, epoch: 6 | loss: 0.0349614
	speed: 0.0175s/iter; left time: 145.8119s
	iters: 300, epoch: 6 | loss: 0.0368796
	speed: 0.0175s/iter; left time: 144.1512s
	iters: 400, epoch: 6 | loss: 0.0483236
	speed: 0.0174s/iter; left time: 142.1653s
	iters: 500, epoch: 6 | loss: 0.0325147
	speed: 0.0174s/iter; left time: 140.3215s
Epoch: 6 cost time: 10.206709861755371
Epoch: 6, Steps: 570 | Train Loss: 0.0343979 Vali Loss: 0.0434447 Test Loss: 0.1454348
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14360164105892181, mae:0.24396653473377228
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3013273
	speed: 0.0291s/iter; left time: 328.5063s
	iters: 200, epoch: 1 | loss: 0.1627599
	speed: 0.0172s/iter; left time: 192.2547s
	iters: 300, epoch: 1 | loss: 0.1636733
	speed: 0.0172s/iter; left time: 190.9079s
	iters: 400, epoch: 1 | loss: 0.1275357
	speed: 0.0172s/iter; left time: 189.5296s
	iters: 500, epoch: 1 | loss: 0.1798341
	speed: 0.0172s/iter; left time: 187.5996s
Epoch: 1 cost time: 11.046336889266968
Epoch: 1, Steps: 570 | Train Loss: 0.1556122 Vali Loss: 0.0425841 Test Loss: 0.1366059
Validation loss decreased (inf --> 0.042584).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1080536
	speed: 0.0546s/iter; left time: 586.2126s
	iters: 200, epoch: 2 | loss: 0.1725593
	speed: 0.0172s/iter; left time: 182.3649s
	iters: 300, epoch: 2 | loss: 0.1873654
	speed: 0.0171s/iter; left time: 180.2322s
	iters: 400, epoch: 2 | loss: 0.1795883
	speed: 0.0171s/iter; left time: 178.7338s
	iters: 500, epoch: 2 | loss: 0.1130972
	speed: 0.0171s/iter; left time: 177.1338s
Epoch: 2 cost time: 10.090810060501099
Epoch: 2, Steps: 570 | Train Loss: 0.1257417 Vali Loss: 0.0436001 Test Loss: 0.1318278
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0872726
	speed: 0.0560s/iter; left time: 569.3212s
	iters: 200, epoch: 3 | loss: 0.0909489
	speed: 0.0193s/iter; left time: 193.7334s
	iters: 300, epoch: 3 | loss: 0.1098259
	speed: 0.0192s/iter; left time: 191.1282s
	iters: 400, epoch: 3 | loss: 0.0617533
	speed: 0.0193s/iter; left time: 189.8892s
	iters: 500, epoch: 3 | loss: 0.0701032
	speed: 0.0192s/iter; left time: 187.8730s
Epoch: 3 cost time: 11.23965311050415
Epoch: 3, Steps: 570 | Train Loss: 0.0934521 Vali Loss: 0.0351826 Test Loss: 0.1203531
Validation loss decreased (0.042584 --> 0.035183).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0649448
	speed: 0.0575s/iter; left time: 551.1784s
	iters: 200, epoch: 4 | loss: 0.0549003
	speed: 0.0192s/iter; left time: 182.3173s
	iters: 300, epoch: 4 | loss: 0.0712037
	speed: 0.0193s/iter; left time: 180.9028s
	iters: 400, epoch: 4 | loss: 0.0707857
	speed: 0.0192s/iter; left time: 178.4177s
	iters: 500, epoch: 4 | loss: 0.0471515
	speed: 0.0192s/iter; left time: 176.9246s
Epoch: 4 cost time: 11.285292625427246
Epoch: 4, Steps: 570 | Train Loss: 0.0624750 Vali Loss: 0.0335348 Test Loss: 0.1206524
Validation loss decreased (0.035183 --> 0.033535).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0518756
	speed: 0.0558s/iter; left time: 503.4326s
	iters: 200, epoch: 5 | loss: 0.0462244
	speed: 0.0173s/iter; left time: 154.2958s
	iters: 300, epoch: 5 | loss: 0.0481729
	speed: 0.0173s/iter; left time: 152.3836s
	iters: 400, epoch: 5 | loss: 0.0416372
	speed: 0.0173s/iter; left time: 150.6579s
	iters: 500, epoch: 5 | loss: 0.0582077
	speed: 0.0173s/iter; left time: 149.0286s
Epoch: 5 cost time: 10.178947448730469
Epoch: 5, Steps: 570 | Train Loss: 0.0454446 Vali Loss: 0.0346301 Test Loss: 0.1202264
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0512787
	speed: 0.0546s/iter; left time: 461.8402s
	iters: 200, epoch: 6 | loss: 0.0321706
	speed: 0.0171s/iter; left time: 142.9764s
	iters: 300, epoch: 6 | loss: 0.0402475
	speed: 0.0172s/iter; left time: 141.5435s
	iters: 400, epoch: 6 | loss: 0.0389622
	speed: 0.0171s/iter; left time: 139.7400s
	iters: 500, epoch: 6 | loss: 0.0262756
	speed: 0.0171s/iter; left time: 137.8613s
Epoch: 6 cost time: 10.045132637023926
Epoch: 6, Steps: 570 | Train Loss: 0.0372056 Vali Loss: 0.0347524 Test Loss: 0.1218830
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0415928
	speed: 0.0575s/iter; left time: 453.1981s
	iters: 200, epoch: 7 | loss: 0.0410634
	speed: 0.0172s/iter; left time: 133.7896s
	iters: 300, epoch: 7 | loss: 0.0310007
	speed: 0.0172s/iter; left time: 132.0680s
	iters: 400, epoch: 7 | loss: 0.0346273
	speed: 0.0172s/iter; left time: 130.3357s
	iters: 500, epoch: 7 | loss: 0.0262612
	speed: 0.0172s/iter; left time: 128.5735s
Epoch: 7 cost time: 10.129865646362305
Epoch: 7, Steps: 570 | Train Loss: 0.0329937 Vali Loss: 0.0353262 Test Loss: 0.1226116
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12082037329673767, mae:0.21284867823123932
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2177885
	speed: 0.0290s/iter; left time: 327.6979s
	iters: 200, epoch: 1 | loss: 0.1740898
	speed: 0.0174s/iter; left time: 194.5910s
	iters: 300, epoch: 1 | loss: 0.2318988
	speed: 0.0174s/iter; left time: 192.6594s
	iters: 400, epoch: 1 | loss: 0.1778409
	speed: 0.0174s/iter; left time: 190.9553s
	iters: 500, epoch: 1 | loss: 0.2104654
	speed: 0.0174s/iter; left time: 189.2533s
Epoch: 1 cost time: 11.110748052597046
Epoch: 1, Steps: 570 | Train Loss: 0.1894304 Vali Loss: 0.0450520 Test Loss: 0.1393649
Validation loss decreased (inf --> 0.045052).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2218399
	speed: 0.0543s/iter; left time: 583.1696s
	iters: 200, epoch: 2 | loss: 0.2031770
	speed: 0.0171s/iter; left time: 181.7134s
	iters: 300, epoch: 2 | loss: 0.2917352
	speed: 0.0171s/iter; left time: 180.0839s
	iters: 400, epoch: 2 | loss: 0.1115078
	speed: 0.0171s/iter; left time: 178.4058s
	iters: 500, epoch: 2 | loss: 0.0887230
	speed: 0.0171s/iter; left time: 176.8382s
Epoch: 2 cost time: 10.023196935653687
Epoch: 2, Steps: 570 | Train Loss: 0.1400354 Vali Loss: 0.0453597 Test Loss: 0.1389147
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0976101
	speed: 0.0550s/iter; left time: 559.3455s
	iters: 200, epoch: 3 | loss: 0.0790695
	speed: 0.0174s/iter; left time: 174.9114s
	iters: 300, epoch: 3 | loss: 0.0755557
	speed: 0.0172s/iter; left time: 171.6344s
	iters: 400, epoch: 3 | loss: 0.0531154
	speed: 0.0172s/iter; left time: 169.2931s
	iters: 500, epoch: 3 | loss: 0.0669597
	speed: 0.0172s/iter; left time: 167.7346s
Epoch: 3 cost time: 10.144858837127686
Epoch: 3, Steps: 570 | Train Loss: 0.0817688 Vali Loss: 0.0419895 Test Loss: 0.1375994
Validation loss decreased (0.045052 --> 0.041990).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0431753
	speed: 0.0539s/iter; left time: 517.0085s
	iters: 200, epoch: 4 | loss: 0.0574122
	speed: 0.0173s/iter; left time: 164.1965s
	iters: 300, epoch: 4 | loss: 0.0522037
	speed: 0.0173s/iter; left time: 162.5197s
	iters: 400, epoch: 4 | loss: 0.0496517
	speed: 0.0173s/iter; left time: 160.8846s
	iters: 500, epoch: 4 | loss: 0.0428037
	speed: 0.0173s/iter; left time: 159.0288s
Epoch: 4 cost time: 10.139140367507935
Epoch: 4, Steps: 570 | Train Loss: 0.0467967 Vali Loss: 0.0405782 Test Loss: 0.1369759
Validation loss decreased (0.041990 --> 0.040578).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0329710
	speed: 0.0540s/iter; left time: 486.9106s
	iters: 200, epoch: 5 | loss: 0.0373534
	speed: 0.0172s/iter; left time: 153.6014s
	iters: 300, epoch: 5 | loss: 0.0254652
	speed: 0.0172s/iter; left time: 151.8373s
	iters: 400, epoch: 5 | loss: 0.0320666
	speed: 0.0172s/iter; left time: 149.9077s
	iters: 500, epoch: 5 | loss: 0.0248615
	speed: 0.0172s/iter; left time: 148.4310s
Epoch: 5 cost time: 10.109692811965942
Epoch: 5, Steps: 570 | Train Loss: 0.0323576 Vali Loss: 0.0408936 Test Loss: 0.1396430
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0270176
	speed: 0.0534s/iter; left time: 451.1302s
	iters: 200, epoch: 6 | loss: 0.0235493
	speed: 0.0172s/iter; left time: 143.7567s
	iters: 300, epoch: 6 | loss: 0.0301357
	speed: 0.0172s/iter; left time: 141.7224s
	iters: 400, epoch: 6 | loss: 0.0253702
	speed: 0.0172s/iter; left time: 139.8391s
	iters: 500, epoch: 6 | loss: 0.0251508
	speed: 0.0171s/iter; left time: 138.0633s
Epoch: 6 cost time: 10.041589498519897
Epoch: 6, Steps: 570 | Train Loss: 0.0259659 Vali Loss: 0.0409562 Test Loss: 0.1410119
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0220625
	speed: 0.0545s/iter; left time: 429.1885s
	iters: 200, epoch: 7 | loss: 0.0194717
	speed: 0.0193s/iter; left time: 150.1440s
	iters: 300, epoch: 7 | loss: 0.0231270
	speed: 0.0193s/iter; left time: 148.1972s
	iters: 400, epoch: 7 | loss: 0.0367678
	speed: 0.0193s/iter; left time: 146.1753s
	iters: 500, epoch: 7 | loss: 0.0201000
	speed: 0.0193s/iter; left time: 144.2452s
Epoch: 7 cost time: 11.273231506347656
Epoch: 7, Steps: 570 | Train Loss: 0.0229394 Vali Loss: 0.0413790 Test Loss: 0.1412562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13710694015026093, mae:0.2393602728843689
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1982598
	speed: 0.0333s/iter; left time: 375.8195s
	iters: 200, epoch: 1 | loss: 0.1722663
	speed: 0.0212s/iter; left time: 237.9283s
	iters: 300, epoch: 1 | loss: 0.2368596
	speed: 0.0213s/iter; left time: 236.2168s
	iters: 400, epoch: 1 | loss: 0.2784756
	speed: 0.0213s/iter; left time: 233.8824s
	iters: 500, epoch: 1 | loss: 0.2624359
	speed: 0.0212s/iter; left time: 231.3761s
Epoch: 1 cost time: 13.371165752410889
Epoch: 1, Steps: 570 | Train Loss: 0.2215046 Vali Loss: 0.0689446 Test Loss: 0.2047751
Validation loss decreased (inf --> 0.068945).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3135594
	speed: 0.0617s/iter; left time: 662.4307s
	iters: 200, epoch: 2 | loss: 0.2461600
	speed: 0.0213s/iter; left time: 225.9902s
	iters: 300, epoch: 2 | loss: 0.1640294
	speed: 0.0213s/iter; left time: 224.0331s
	iters: 400, epoch: 2 | loss: 0.2334460
	speed: 0.0213s/iter; left time: 222.0858s
	iters: 500, epoch: 2 | loss: 0.1787507
	speed: 0.0213s/iter; left time: 219.6911s
Epoch: 2 cost time: 12.439074993133545
Epoch: 2, Steps: 570 | Train Loss: 0.2409333 Vali Loss: 0.0579337 Test Loss: 0.1650611
Validation loss decreased (0.068945 --> 0.057934).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3445709
	speed: 0.0618s/iter; left time: 628.2179s
	iters: 200, epoch: 3 | loss: 0.1344387
	speed: 0.0213s/iter; left time: 214.7213s
	iters: 300, epoch: 3 | loss: 0.1870665
	speed: 0.0213s/iter; left time: 212.5403s
	iters: 400, epoch: 3 | loss: 0.1502970
	speed: 0.0213s/iter; left time: 210.5204s
	iters: 500, epoch: 3 | loss: 0.1235990
	speed: 0.0213s/iter; left time: 208.1586s
Epoch: 3 cost time: 12.477965831756592
Epoch: 3, Steps: 570 | Train Loss: 0.1725269 Vali Loss: 0.0474227 Test Loss: 0.1467401
Validation loss decreased (0.057934 --> 0.047423).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1178306
	speed: 0.0622s/iter; left time: 596.3877s
	iters: 200, epoch: 4 | loss: 0.1037992
	speed: 0.0213s/iter; left time: 202.0233s
	iters: 300, epoch: 4 | loss: 0.1877244
	speed: 0.0213s/iter; left time: 199.8193s
	iters: 400, epoch: 4 | loss: 0.1446683
	speed: 0.0213s/iter; left time: 197.8748s
	iters: 500, epoch: 4 | loss: 0.1847490
	speed: 0.0213s/iter; left time: 195.6460s
Epoch: 4 cost time: 12.469421148300171
Epoch: 4, Steps: 570 | Train Loss: 0.1489754 Vali Loss: 0.0459652 Test Loss: 0.1424586
Validation loss decreased (0.047423 --> 0.045965).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1684721
	speed: 0.0630s/iter; left time: 568.3546s
	iters: 200, epoch: 5 | loss: 0.2174387
	speed: 0.0214s/iter; left time: 190.7905s
	iters: 300, epoch: 5 | loss: 0.1022878
	speed: 0.0214s/iter; left time: 188.7972s
	iters: 400, epoch: 5 | loss: 0.1460482
	speed: 0.0214s/iter; left time: 186.3669s
	iters: 500, epoch: 5 | loss: 0.1213383
	speed: 0.0214s/iter; left time: 184.2538s
Epoch: 5 cost time: 12.491177558898926
Epoch: 5, Steps: 570 | Train Loss: 0.1338308 Vali Loss: 0.0453069 Test Loss: 0.1409828
Validation loss decreased (0.045965 --> 0.045307).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1173596
	speed: 0.0638s/iter; left time: 539.1788s
	iters: 200, epoch: 6 | loss: 0.1838098
	speed: 0.0214s/iter; left time: 178.8740s
	iters: 300, epoch: 6 | loss: 0.1131455
	speed: 0.0214s/iter; left time: 176.7189s
	iters: 400, epoch: 6 | loss: 0.0865408
	speed: 0.0214s/iter; left time: 174.7005s
	iters: 500, epoch: 6 | loss: 0.1666597
	speed: 0.0214s/iter; left time: 172.3473s
Epoch: 6 cost time: 12.521835088729858
Epoch: 6, Steps: 570 | Train Loss: 0.1246720 Vali Loss: 0.0451699 Test Loss: 0.1443853
Validation loss decreased (0.045307 --> 0.045170).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1408811
	speed: 0.0615s/iter; left time: 484.6871s
	iters: 200, epoch: 7 | loss: 0.1244936
	speed: 0.0213s/iter; left time: 165.8438s
	iters: 300, epoch: 7 | loss: 0.1025622
	speed: 0.0213s/iter; left time: 163.4796s
	iters: 400, epoch: 7 | loss: 0.1524026
	speed: 0.0213s/iter; left time: 161.3538s
	iters: 500, epoch: 7 | loss: 0.1064116
	speed: 0.0213s/iter; left time: 159.1942s
Epoch: 7 cost time: 12.468711614608765
Epoch: 7, Steps: 570 | Train Loss: 0.1183561 Vali Loss: 0.0456586 Test Loss: 0.1454745
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1128823
	speed: 0.0610s/iter; left time: 445.6537s
	iters: 200, epoch: 8 | loss: 0.1403389
	speed: 0.0213s/iter; left time: 153.3452s
	iters: 300, epoch: 8 | loss: 0.0930431
	speed: 0.0213s/iter; left time: 151.2527s
	iters: 400, epoch: 8 | loss: 0.0984493
	speed: 0.0213s/iter; left time: 149.1102s
	iters: 500, epoch: 8 | loss: 0.0983002
	speed: 0.0212s/iter; left time: 146.8477s
Epoch: 8 cost time: 12.431091547012329
Epoch: 8, Steps: 570 | Train Loss: 0.1149548 Vali Loss: 0.0459172 Test Loss: 0.1456573
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1132303
	speed: 0.0607s/iter; left time: 408.8713s
	iters: 200, epoch: 9 | loss: 0.1282349
	speed: 0.0213s/iter; left time: 141.4783s
	iters: 300, epoch: 9 | loss: 0.1326363
	speed: 0.0213s/iter; left time: 139.4767s
	iters: 400, epoch: 9 | loss: 0.0945258
	speed: 0.0213s/iter; left time: 137.1670s
	iters: 500, epoch: 9 | loss: 0.1243167
	speed: 0.0213s/iter; left time: 135.0652s
Epoch: 9 cost time: 12.424091100692749
Epoch: 9, Steps: 570 | Train Loss: 0.1132426 Vali Loss: 0.0457194 Test Loss: 0.1453414
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14455336332321167, mae:0.23860737681388855
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1611827
	speed: 0.0325s/iter; left time: 367.4625s
	iters: 200, epoch: 1 | loss: 0.0880886
	speed: 0.0207s/iter; left time: 231.5773s
	iters: 300, epoch: 1 | loss: 0.1551008
	speed: 0.0207s/iter; left time: 229.3053s
	iters: 400, epoch: 1 | loss: 0.1174971
	speed: 0.0207s/iter; left time: 227.2855s
	iters: 500, epoch: 1 | loss: 0.1570380
	speed: 0.0207s/iter; left time: 226.1514s
Epoch: 1 cost time: 13.026667833328247
Epoch: 1, Steps: 570 | Train Loss: 0.1819967 Vali Loss: 0.0417195 Test Loss: 0.1302326
Validation loss decreased (inf --> 0.041720).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2005797
	speed: 0.0611s/iter; left time: 655.3795s
	iters: 200, epoch: 2 | loss: 0.1317277
	speed: 0.0208s/iter; left time: 220.7380s
	iters: 300, epoch: 2 | loss: 0.2992740
	speed: 0.0207s/iter; left time: 218.3242s
	iters: 400, epoch: 2 | loss: 0.2557242
	speed: 0.0207s/iter; left time: 216.0288s
	iters: 500, epoch: 2 | loss: 0.1844640
	speed: 0.0207s/iter; left time: 214.1210s
Epoch: 2 cost time: 12.156408309936523
Epoch: 2, Steps: 570 | Train Loss: 0.2159472 Vali Loss: 0.0691888 Test Loss: 0.2015038
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1917845
	speed: 0.0627s/iter; left time: 637.4545s
	iters: 200, epoch: 3 | loss: 0.1939210
	speed: 0.0206s/iter; left time: 207.0162s
	iters: 300, epoch: 3 | loss: 0.1543978
	speed: 0.0206s/iter; left time: 204.8683s
	iters: 400, epoch: 3 | loss: 0.1578405
	speed: 0.0206s/iter; left time: 202.7113s
	iters: 500, epoch: 3 | loss: 0.1485855
	speed: 0.0206s/iter; left time: 200.8089s
Epoch: 3 cost time: 11.988124370574951
Epoch: 3, Steps: 570 | Train Loss: 0.2254620 Vali Loss: 0.0597600 Test Loss: 0.1643411
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1238583
	speed: 0.0605s/iter; left time: 580.5920s
	iters: 200, epoch: 4 | loss: 0.1780287
	speed: 0.0207s/iter; left time: 196.3723s
	iters: 300, epoch: 4 | loss: 0.1466343
	speed: 0.0214s/iter; left time: 200.9289s
	iters: 400, epoch: 4 | loss: 0.2122630
	speed: 0.0224s/iter; left time: 208.1672s
	iters: 500, epoch: 4 | loss: 0.1696354
	speed: 0.0224s/iter; left time: 205.8220s
Epoch: 4 cost time: 12.623074531555176
Epoch: 4, Steps: 570 | Train Loss: 0.1947377 Vali Loss: 0.0546327 Test Loss: 0.1529316
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13044115900993347, mae:0.23281407356262207
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2434345
	speed: 0.0307s/iter; left time: 346.6333s
	iters: 200, epoch: 1 | loss: 0.1531063
	speed: 0.0191s/iter; left time: 214.0166s
	iters: 300, epoch: 1 | loss: 0.2530334
	speed: 0.0191s/iter; left time: 211.9900s
	iters: 400, epoch: 1 | loss: 0.2281839
	speed: 0.0191s/iter; left time: 210.6530s
	iters: 500, epoch: 1 | loss: 0.2358771
	speed: 0.0191s/iter; left time: 208.3127s
Epoch: 1 cost time: 12.103790521621704
Epoch: 1, Steps: 570 | Train Loss: 0.2170983 Vali Loss: 0.0559171 Test Loss: 0.1756478
Validation loss decreased (inf --> 0.055917).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1163736
	speed: 0.0583s/iter; left time: 625.7049s
	iters: 200, epoch: 2 | loss: 0.4850007
	speed: 0.0191s/iter; left time: 202.7783s
	iters: 300, epoch: 2 | loss: 0.2708116
	speed: 0.0191s/iter; left time: 200.8953s
	iters: 400, epoch: 2 | loss: 0.1452087
	speed: 0.0191s/iter; left time: 198.8336s
	iters: 500, epoch: 2 | loss: 0.1954087
	speed: 0.0191s/iter; left time: 196.8897s
Epoch: 2 cost time: 11.180995225906372
Epoch: 2, Steps: 570 | Train Loss: 0.2521133 Vali Loss: 0.0596861 Test Loss: 0.1777243
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1769210
	speed: 0.0575s/iter; left time: 584.1062s
	iters: 200, epoch: 3 | loss: 0.1579297
	speed: 0.0190s/iter; left time: 191.6298s
	iters: 300, epoch: 3 | loss: 0.2444570
	speed: 0.0190s/iter; left time: 189.6373s
	iters: 400, epoch: 3 | loss: 0.1686455
	speed: 0.0190s/iter; left time: 187.7558s
	iters: 500, epoch: 3 | loss: 0.2149357
	speed: 0.0190s/iter; left time: 185.5773s
Epoch: 3 cost time: 11.10656476020813
Epoch: 3, Steps: 570 | Train Loss: 0.2108717 Vali Loss: 0.0600512 Test Loss: 0.1710273
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1616878
	speed: 0.0560s/iter; left time: 536.7146s
	iters: 200, epoch: 4 | loss: 0.2954238
	speed: 0.0191s/iter; left time: 181.7203s
	iters: 300, epoch: 4 | loss: 0.1252136
	speed: 0.0191s/iter; left time: 179.6168s
	iters: 400, epoch: 4 | loss: 0.1872400
	speed: 0.0191s/iter; left time: 177.3646s
	iters: 500, epoch: 4 | loss: 0.1753382
	speed: 0.0191s/iter; left time: 175.9725s
Epoch: 4 cost time: 11.189905166625977
Epoch: 4, Steps: 570 | Train Loss: 0.1836865 Vali Loss: 0.0583106 Test Loss: 0.1626222
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17591072618961334, mae:0.27432191371917725
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1875591
	speed: 0.0221s/iter; left time: 249.9177s
	iters: 200, epoch: 1 | loss: 0.1685902
	speed: 0.0105s/iter; left time: 117.6419s
	iters: 300, epoch: 1 | loss: 0.2426253
	speed: 0.0105s/iter; left time: 116.8394s
	iters: 400, epoch: 1 | loss: 0.2055227
	speed: 0.0105s/iter; left time: 115.5104s
	iters: 500, epoch: 1 | loss: 0.1781254
	speed: 0.0105s/iter; left time: 114.6237s
Epoch: 1 cost time: 7.197439908981323
Epoch: 1, Steps: 570 | Train Loss: 0.2129296 Vali Loss: 0.0461688 Test Loss: 0.1384224
Validation loss decreased (inf --> 0.046169).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2534581
	speed: 0.0376s/iter; left time: 403.4313s
	iters: 200, epoch: 2 | loss: 0.2095187
	speed: 0.0119s/iter; left time: 126.6564s
	iters: 300, epoch: 2 | loss: 0.1648936
	speed: 0.0119s/iter; left time: 124.9280s
	iters: 400, epoch: 2 | loss: 0.1565098
	speed: 0.0112s/iter; left time: 116.5862s
	iters: 500, epoch: 2 | loss: 0.1552203
	speed: 0.0106s/iter; left time: 109.2313s
Epoch: 2 cost time: 6.780377149581909
Epoch: 2, Steps: 570 | Train Loss: 0.1706752 Vali Loss: 0.0441416 Test Loss: 0.1367652
Validation loss decreased (0.046169 --> 0.044142).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1195780
	speed: 0.0369s/iter; left time: 375.0335s
	iters: 200, epoch: 3 | loss: 0.1630878
	speed: 0.0105s/iter; left time: 105.9302s
	iters: 300, epoch: 3 | loss: 0.1316595
	speed: 0.0106s/iter; left time: 105.1866s
	iters: 400, epoch: 3 | loss: 0.1441677
	speed: 0.0106s/iter; left time: 104.3031s
	iters: 500, epoch: 3 | loss: 0.1832184
	speed: 0.0105s/iter; left time: 102.5106s
Epoch: 3 cost time: 6.313525915145874
Epoch: 3, Steps: 570 | Train Loss: 0.1405180 Vali Loss: 0.0383746 Test Loss: 0.1244795
Validation loss decreased (0.044142 --> 0.038375).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1192791
	speed: 0.0363s/iter; left time: 348.5465s
	iters: 200, epoch: 4 | loss: 0.0985092
	speed: 0.0105s/iter; left time: 99.9385s
	iters: 300, epoch: 4 | loss: 0.1505321
	speed: 0.0105s/iter; left time: 99.0608s
	iters: 400, epoch: 4 | loss: 0.1254500
	speed: 0.0105s/iter; left time: 97.5366s
	iters: 500, epoch: 4 | loss: 0.1224056
	speed: 0.0105s/iter; left time: 96.4599s
Epoch: 4 cost time: 6.2951741218566895
Epoch: 4, Steps: 570 | Train Loss: 0.1215223 Vali Loss: 0.0378357 Test Loss: 0.1281882
Validation loss decreased (0.038375 --> 0.037836).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1180496
	speed: 0.0370s/iter; left time: 334.1209s
	iters: 200, epoch: 5 | loss: 0.1264121
	speed: 0.0105s/iter; left time: 94.0389s
	iters: 300, epoch: 5 | loss: 0.0851760
	speed: 0.0105s/iter; left time: 92.6939s
	iters: 400, epoch: 5 | loss: 0.1103657
	speed: 0.0105s/iter; left time: 91.7686s
	iters: 500, epoch: 5 | loss: 0.1040657
	speed: 0.0105s/iter; left time: 90.8803s
Epoch: 5 cost time: 6.315140962600708
Epoch: 5, Steps: 570 | Train Loss: 0.1098918 Vali Loss: 0.0366639 Test Loss: 0.1306551
Validation loss decreased (0.037836 --> 0.036664).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0982700
	speed: 0.0360s/iter; left time: 303.9795s
	iters: 200, epoch: 6 | loss: 0.1011713
	speed: 0.0105s/iter; left time: 87.3942s
	iters: 300, epoch: 6 | loss: 0.1064663
	speed: 0.0105s/iter; left time: 86.5547s
	iters: 400, epoch: 6 | loss: 0.1059360
	speed: 0.0105s/iter; left time: 85.5736s
	iters: 500, epoch: 6 | loss: 0.1032415
	speed: 0.0105s/iter; left time: 84.3984s
Epoch: 6 cost time: 6.278334140777588
Epoch: 6, Steps: 570 | Train Loss: 0.1038395 Vali Loss: 0.0361007 Test Loss: 0.1349440
Validation loss decreased (0.036664 --> 0.036101).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1149267
	speed: 0.0364s/iter; left time: 286.7510s
	iters: 200, epoch: 7 | loss: 0.1476670
	speed: 0.0105s/iter; left time: 81.8972s
	iters: 300, epoch: 7 | loss: 0.0790868
	speed: 0.0105s/iter; left time: 81.0239s
	iters: 400, epoch: 7 | loss: 0.0798678
	speed: 0.0105s/iter; left time: 79.8805s
	iters: 500, epoch: 7 | loss: 0.1045000
	speed: 0.0105s/iter; left time: 78.5853s
Epoch: 7 cost time: 6.285093784332275
Epoch: 7, Steps: 570 | Train Loss: 0.1021100 Vali Loss: 0.0367107 Test Loss: 0.1336253
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0942366
	speed: 0.0368s/iter; left time: 269.1128s
	iters: 200, epoch: 8 | loss: 0.0988189
	speed: 0.0105s/iter; left time: 76.0700s
	iters: 300, epoch: 8 | loss: 0.1260353
	speed: 0.0106s/iter; left time: 75.0479s
	iters: 400, epoch: 8 | loss: 0.1617311
	speed: 0.0106s/iter; left time: 74.0137s
	iters: 500, epoch: 8 | loss: 0.0782998
	speed: 0.0105s/iter; left time: 72.8809s
Epoch: 8 cost time: 6.32673454284668
Epoch: 8, Steps: 570 | Train Loss: 0.0995351 Vali Loss: 0.0362384 Test Loss: 0.1333975
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1689786
	speed: 0.0373s/iter; left time: 251.7276s
	iters: 200, epoch: 9 | loss: 0.0877496
	speed: 0.0105s/iter; left time: 69.8341s
	iters: 300, epoch: 9 | loss: 0.0617598
	speed: 0.0105s/iter; left time: 68.4649s
	iters: 400, epoch: 9 | loss: 0.0963161
	speed: 0.0105s/iter; left time: 67.4641s
	iters: 500, epoch: 9 | loss: 0.0842207
	speed: 0.0105s/iter; left time: 66.6468s
Epoch: 9 cost time: 6.359121322631836
Epoch: 9, Steps: 570 | Train Loss: 0.0986069 Vali Loss: 0.0366251 Test Loss: 0.1347573
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13512693345546722, mae:0.23280654847621918
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2258161
	speed: 0.0220s/iter; left time: 248.3529s
	iters: 200, epoch: 1 | loss: 0.1745539
	speed: 0.0103s/iter; left time: 115.4333s
	iters: 300, epoch: 1 | loss: 0.2272285
	speed: 0.0103s/iter; left time: 114.8108s
	iters: 400, epoch: 1 | loss: 0.1798825
	speed: 0.0103s/iter; left time: 113.3805s
	iters: 500, epoch: 1 | loss: 0.1475461
	speed: 0.0103s/iter; left time: 112.5698s
Epoch: 1 cost time: 7.100583553314209
Epoch: 1, Steps: 570 | Train Loss: 0.1818829 Vali Loss: 0.0384824 Test Loss: 0.1245723
Validation loss decreased (inf --> 0.038482).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1269545
	speed: 0.0360s/iter; left time: 386.5524s
	iters: 200, epoch: 2 | loss: 0.1704410
	speed: 0.0103s/iter; left time: 109.4899s
	iters: 300, epoch: 2 | loss: 0.1202096
	speed: 0.0103s/iter; left time: 108.6442s
	iters: 400, epoch: 2 | loss: 0.1311851
	speed: 0.0103s/iter; left time: 107.2272s
	iters: 500, epoch: 2 | loss: 0.1385412
	speed: 0.0103s/iter; left time: 106.1888s
Epoch: 2 cost time: 6.184586763381958
Epoch: 2, Steps: 570 | Train Loss: 0.1543717 Vali Loss: 0.0365131 Test Loss: 0.1147417
Validation loss decreased (0.038482 --> 0.036513).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0716504
	speed: 0.0367s/iter; left time: 372.6639s
	iters: 200, epoch: 3 | loss: 0.1160610
	speed: 0.0103s/iter; left time: 103.2498s
	iters: 300, epoch: 3 | loss: 0.2342663
	speed: 0.0103s/iter; left time: 102.1293s
	iters: 400, epoch: 3 | loss: 0.1401396
	speed: 0.0102s/iter; left time: 100.9683s
	iters: 500, epoch: 3 | loss: 0.0908380
	speed: 0.0102s/iter; left time: 99.8081s
Epoch: 3 cost time: 6.12970757484436
Epoch: 3, Steps: 570 | Train Loss: 0.1285174 Vali Loss: 0.0326620 Test Loss: 0.1128577
Validation loss decreased (0.036513 --> 0.032662).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1006823
	speed: 0.0351s/iter; left time: 336.6025s
	iters: 200, epoch: 4 | loss: 0.0886865
	speed: 0.0103s/iter; left time: 97.3534s
	iters: 300, epoch: 4 | loss: 0.0701043
	speed: 0.0103s/iter; left time: 96.3149s
	iters: 400, epoch: 4 | loss: 0.0819835
	speed: 0.0102s/iter; left time: 95.1125s
	iters: 500, epoch: 4 | loss: 0.1388223
	speed: 0.0102s/iter; left time: 94.0243s
Epoch: 4 cost time: 6.1052374839782715
Epoch: 4, Steps: 570 | Train Loss: 0.1119747 Vali Loss: 0.0325327 Test Loss: 0.1104302
Validation loss decreased (0.032662 --> 0.032533).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0873269
	speed: 0.0363s/iter; left time: 327.5036s
	iters: 200, epoch: 5 | loss: 0.1224051
	speed: 0.0103s/iter; left time: 91.5876s
	iters: 300, epoch: 5 | loss: 0.0985460
	speed: 0.0103s/iter; left time: 90.4590s
	iters: 400, epoch: 5 | loss: 0.1158594
	speed: 0.0102s/iter; left time: 89.2218s
	iters: 500, epoch: 5 | loss: 0.0986964
	speed: 0.0102s/iter; left time: 88.2755s
Epoch: 5 cost time: 6.128857851028442
Epoch: 5, Steps: 570 | Train Loss: 0.1033130 Vali Loss: 0.0320356 Test Loss: 0.1119445
Validation loss decreased (0.032533 --> 0.032036).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0776036
	speed: 0.0366s/iter; left time: 309.4629s
	iters: 200, epoch: 6 | loss: 0.1331430
	speed: 0.0104s/iter; left time: 86.6411s
	iters: 300, epoch: 6 | loss: 0.1295920
	speed: 0.0112s/iter; left time: 92.8054s
	iters: 400, epoch: 6 | loss: 0.0783443
	speed: 0.0102s/iter; left time: 83.3327s
	iters: 500, epoch: 6 | loss: 0.0676099
	speed: 0.0102s/iter; left time: 82.2825s
Epoch: 6 cost time: 6.211097240447998
Epoch: 6, Steps: 570 | Train Loss: 0.0982573 Vali Loss: 0.0314279 Test Loss: 0.1120153
Validation loss decreased (0.032036 --> 0.031428).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0900342
	speed: 0.0351s/iter; left time: 276.8070s
	iters: 200, epoch: 7 | loss: 0.1217557
	speed: 0.0103s/iter; left time: 80.1405s
	iters: 300, epoch: 7 | loss: 0.1556553
	speed: 0.0103s/iter; left time: 78.9689s
	iters: 400, epoch: 7 | loss: 0.1425365
	speed: 0.0103s/iter; left time: 78.0974s
	iters: 500, epoch: 7 | loss: 0.0993003
	speed: 0.0103s/iter; left time: 76.9627s
Epoch: 7 cost time: 6.151717662811279
Epoch: 7, Steps: 570 | Train Loss: 0.0967970 Vali Loss: 0.0316864 Test Loss: 0.1134103
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0859262
	speed: 0.0356s/iter; left time: 260.1996s
	iters: 200, epoch: 8 | loss: 0.0744396
	speed: 0.0103s/iter; left time: 73.9457s
	iters: 300, epoch: 8 | loss: 0.0877784
	speed: 0.0103s/iter; left time: 72.8882s
	iters: 400, epoch: 8 | loss: 0.0967927
	speed: 0.0103s/iter; left time: 71.9169s
	iters: 500, epoch: 8 | loss: 0.0578659
	speed: 0.0103s/iter; left time: 70.9353s
Epoch: 8 cost time: 6.130937576293945
Epoch: 8, Steps: 570 | Train Loss: 0.0951235 Vali Loss: 0.0315706 Test Loss: 0.1138512
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0745744
	speed: 0.0354s/iter; left time: 238.4671s
	iters: 200, epoch: 9 | loss: 0.1081465
	speed: 0.0102s/iter; left time: 67.7870s
	iters: 300, epoch: 9 | loss: 0.0850372
	speed: 0.0102s/iter; left time: 66.7216s
	iters: 400, epoch: 9 | loss: 0.1032244
	speed: 0.0102s/iter; left time: 65.6682s
	iters: 500, epoch: 9 | loss: 0.0823691
	speed: 0.0102s/iter; left time: 64.6464s
Epoch: 9 cost time: 6.100155830383301
Epoch: 9, Steps: 570 | Train Loss: 0.0938647 Vali Loss: 0.0316149 Test Loss: 0.1139777
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11217200011014938, mae:0.20515543222427368
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2126052
	speed: 0.0223s/iter; left time: 251.6548s
	iters: 200, epoch: 1 | loss: 0.1374715
	speed: 0.0104s/iter; left time: 116.8625s
	iters: 300, epoch: 1 | loss: 0.1647153
	speed: 0.0104s/iter; left time: 115.3999s
	iters: 400, epoch: 1 | loss: 0.1097612
	speed: 0.0104s/iter; left time: 114.4619s
	iters: 500, epoch: 1 | loss: 0.2070301
	speed: 0.0105s/iter; left time: 113.9347s
Epoch: 1 cost time: 7.176550388336182
Epoch: 1, Steps: 570 | Train Loss: 0.2159055 Vali Loss: 0.0433398 Test Loss: 0.1446968
Validation loss decreased (inf --> 0.043340).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1930389
	speed: 0.0364s/iter; left time: 391.0698s
	iters: 200, epoch: 2 | loss: 0.2482810
	speed: 0.0104s/iter; left time: 110.2828s
	iters: 300, epoch: 2 | loss: 0.1856881
	speed: 0.0103s/iter; left time: 108.1565s
	iters: 400, epoch: 2 | loss: 0.2534928
	speed: 0.0103s/iter; left time: 107.7451s
	iters: 500, epoch: 2 | loss: 0.1951734
	speed: 0.0103s/iter; left time: 106.3653s
Epoch: 2 cost time: 6.189270257949829
Epoch: 2, Steps: 570 | Train Loss: 0.1715210 Vali Loss: 0.0442632 Test Loss: 0.1414142
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0967074
	speed: 0.0382s/iter; left time: 388.2735s
	iters: 200, epoch: 3 | loss: 0.1278625
	speed: 0.0104s/iter; left time: 104.2288s
	iters: 300, epoch: 3 | loss: 0.1800192
	speed: 0.0104s/iter; left time: 103.4230s
	iters: 400, epoch: 3 | loss: 0.1153174
	speed: 0.0104s/iter; left time: 102.7234s
	iters: 500, epoch: 3 | loss: 0.0864907
	speed: 0.0104s/iter; left time: 101.3632s
Epoch: 3 cost time: 6.175130605697632
Epoch: 3, Steps: 570 | Train Loss: 0.1365773 Vali Loss: 0.0402464 Test Loss: 0.1316162
Validation loss decreased (0.043340 --> 0.040246).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0689162
	speed: 0.0359s/iter; left time: 344.5712s
	iters: 200, epoch: 4 | loss: 0.0810238
	speed: 0.0104s/iter; left time: 98.3994s
	iters: 300, epoch: 4 | loss: 0.0791520
	speed: 0.0104s/iter; left time: 97.3982s
	iters: 400, epoch: 4 | loss: 0.1398570
	speed: 0.0104s/iter; left time: 96.5331s
	iters: 500, epoch: 4 | loss: 0.0956015
	speed: 0.0104s/iter; left time: 95.6847s
Epoch: 4 cost time: 6.223194122314453
Epoch: 4, Steps: 570 | Train Loss: 0.1136333 Vali Loss: 0.0403347 Test Loss: 0.1356540
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1071966
	speed: 0.0356s/iter; left time: 320.8776s
	iters: 200, epoch: 5 | loss: 0.0704997
	speed: 0.0103s/iter; left time: 91.9499s
	iters: 300, epoch: 5 | loss: 0.0892456
	speed: 0.0103s/iter; left time: 91.0571s
	iters: 400, epoch: 5 | loss: 0.1097680
	speed: 0.0103s/iter; left time: 90.0486s
	iters: 500, epoch: 5 | loss: 0.1410007
	speed: 0.0103s/iter; left time: 88.7351s
Epoch: 5 cost time: 6.139986276626587
Epoch: 5, Steps: 570 | Train Loss: 0.1049160 Vali Loss: 0.0393753 Test Loss: 0.1345298
Validation loss decreased (0.040246 --> 0.039375).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0837624
	speed: 0.0372s/iter; left time: 314.5553s
	iters: 200, epoch: 6 | loss: 0.0961889
	speed: 0.0104s/iter; left time: 87.0009s
	iters: 300, epoch: 6 | loss: 0.1093323
	speed: 0.0104s/iter; left time: 85.8993s
	iters: 400, epoch: 6 | loss: 0.0809935
	speed: 0.0104s/iter; left time: 84.8550s
	iters: 500, epoch: 6 | loss: 0.1131487
	speed: 0.0104s/iter; left time: 83.8092s
Epoch: 6 cost time: 6.2379679679870605
Epoch: 6, Steps: 570 | Train Loss: 0.0989067 Vali Loss: 0.0389056 Test Loss: 0.1327591
Validation loss decreased (0.039375 --> 0.038906).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0908248
	speed: 0.0364s/iter; left time: 287.0306s
	iters: 200, epoch: 7 | loss: 0.0762231
	speed: 0.0103s/iter; left time: 80.0835s
	iters: 300, epoch: 7 | loss: 0.0909373
	speed: 0.0103s/iter; left time: 79.0223s
	iters: 400, epoch: 7 | loss: 0.0681608
	speed: 0.0103s/iter; left time: 78.1128s
	iters: 500, epoch: 7 | loss: 0.0986060
	speed: 0.0103s/iter; left time: 77.0998s
Epoch: 7 cost time: 6.1860833168029785
Epoch: 7, Steps: 570 | Train Loss: 0.0962614 Vali Loss: 0.0390874 Test Loss: 0.1329040
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0775798
	speed: 0.0383s/iter; left time: 279.9255s
	iters: 200, epoch: 8 | loss: 0.1064886
	speed: 0.0117s/iter; left time: 84.0222s
	iters: 300, epoch: 8 | loss: 0.0902569
	speed: 0.0117s/iter; left time: 82.9349s
	iters: 400, epoch: 8 | loss: 0.0937475
	speed: 0.0117s/iter; left time: 81.7754s
	iters: 500, epoch: 8 | loss: 0.0717437
	speed: 0.0117s/iter; left time: 80.5864s
Epoch: 8 cost time: 6.922955751419067
Epoch: 8, Steps: 570 | Train Loss: 0.0940405 Vali Loss: 0.0391326 Test Loss: 0.1337127
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0720170
	speed: 0.0388s/iter; left time: 261.3828s
	iters: 200, epoch: 9 | loss: 0.1180055
	speed: 0.0117s/iter; left time: 77.8109s
	iters: 300, epoch: 9 | loss: 0.0763217
	speed: 0.0117s/iter; left time: 76.7547s
	iters: 400, epoch: 9 | loss: 0.0791094
	speed: 0.0117s/iter; left time: 75.0807s
	iters: 500, epoch: 9 | loss: 0.0849110
	speed: 0.0117s/iter; left time: 73.9299s
Epoch: 9 cost time: 6.989758491516113
Epoch: 9, Steps: 570 | Train Loss: 0.0928958 Vali Loss: 0.0394123 Test Loss: 0.1342105
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13295453786849976, mae:0.23362568020820618
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2748502
	speed: 0.0250s/iter; left time: 282.0247s
	iters: 200, epoch: 1 | loss: 0.2084380
	speed: 0.0129s/iter; left time: 144.8314s
	iters: 300, epoch: 1 | loss: 0.2147193
	speed: 0.0129s/iter; left time: 143.1690s
	iters: 400, epoch: 1 | loss: 0.1102636
	speed: 0.0129s/iter; left time: 142.2694s
	iters: 500, epoch: 1 | loss: 0.2449139
	speed: 0.0129s/iter; left time: 140.5849s
Epoch: 1 cost time: 8.621979236602783
Epoch: 1, Steps: 570 | Train Loss: 0.2353376 Vali Loss: 0.0468720 Test Loss: 0.1393561
Validation loss decreased (inf --> 0.046872).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1956535
	speed: 0.0409s/iter; left time: 438.4906s
	iters: 200, epoch: 2 | loss: 0.1641064
	speed: 0.0128s/iter; left time: 135.8292s
	iters: 300, epoch: 2 | loss: 0.1314635
	speed: 0.0128s/iter; left time: 134.7155s
	iters: 400, epoch: 2 | loss: 0.1056886
	speed: 0.0128s/iter; left time: 133.3553s
	iters: 500, epoch: 2 | loss: 0.1730652
	speed: 0.0128s/iter; left time: 132.1067s
Epoch: 2 cost time: 7.605746507644653
Epoch: 2, Steps: 570 | Train Loss: 0.1995923 Vali Loss: 0.0450163 Test Loss: 0.1359542
Validation loss decreased (0.046872 --> 0.045016).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1934972
	speed: 0.0429s/iter; left time: 436.2680s
	iters: 200, epoch: 3 | loss: 0.2169630
	speed: 0.0128s/iter; left time: 128.3886s
	iters: 300, epoch: 3 | loss: 0.1213193
	speed: 0.0128s/iter; left time: 127.1780s
	iters: 400, epoch: 3 | loss: 0.1498200
	speed: 0.0119s/iter; left time: 117.4192s
	iters: 500, epoch: 3 | loss: 0.1662777
	speed: 0.0119s/iter; left time: 116.0396s
Epoch: 3 cost time: 7.360851764678955
Epoch: 3, Steps: 570 | Train Loss: 0.1741398 Vali Loss: 0.0422012 Test Loss: 0.1378659
Validation loss decreased (0.045016 --> 0.042201).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1304682
	speed: 0.0400s/iter; left time: 383.2883s
	iters: 200, epoch: 4 | loss: 0.1854112
	speed: 0.0118s/iter; left time: 112.1237s
	iters: 300, epoch: 4 | loss: 0.1072130
	speed: 0.0118s/iter; left time: 110.8831s
	iters: 400, epoch: 4 | loss: 0.0934103
	speed: 0.0118s/iter; left time: 109.6963s
	iters: 500, epoch: 4 | loss: 0.1440407
	speed: 0.0118s/iter; left time: 108.6186s
Epoch: 4 cost time: 7.048134803771973
Epoch: 4, Steps: 570 | Train Loss: 0.1554324 Vali Loss: 0.0426190 Test Loss: 0.1270937
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1229717
	speed: 0.0396s/iter; left time: 356.8603s
	iters: 200, epoch: 5 | loss: 0.1247959
	speed: 0.0119s/iter; left time: 105.9764s
	iters: 300, epoch: 5 | loss: 0.1960773
	speed: 0.0119s/iter; left time: 104.7680s
	iters: 400, epoch: 5 | loss: 0.1387040
	speed: 0.0119s/iter; left time: 103.4973s
	iters: 500, epoch: 5 | loss: 0.1279780
	speed: 0.0119s/iter; left time: 102.2995s
Epoch: 5 cost time: 7.094903469085693
Epoch: 5, Steps: 570 | Train Loss: 0.1429132 Vali Loss: 0.0403843 Test Loss: 0.1261380
Validation loss decreased (0.042201 --> 0.040384).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1534443
	speed: 0.0394s/iter; left time: 332.8328s
	iters: 200, epoch: 6 | loss: 0.0734791
	speed: 0.0118s/iter; left time: 98.5572s
	iters: 300, epoch: 6 | loss: 0.1539678
	speed: 0.0118s/iter; left time: 97.4459s
	iters: 400, epoch: 6 | loss: 0.1341914
	speed: 0.0118s/iter; left time: 96.2642s
	iters: 500, epoch: 6 | loss: 0.1050217
	speed: 0.0118s/iter; left time: 95.0709s
Epoch: 6 cost time: 7.05040168762207
Epoch: 6, Steps: 570 | Train Loss: 0.1340782 Vali Loss: 0.0394809 Test Loss: 0.1283349
Validation loss decreased (0.040384 --> 0.039481).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1350735
	speed: 0.0420s/iter; left time: 331.3949s
	iters: 200, epoch: 7 | loss: 0.1328423
	speed: 0.0129s/iter; left time: 100.5190s
	iters: 300, epoch: 7 | loss: 0.1311206
	speed: 0.0130s/iter; left time: 99.6439s
	iters: 400, epoch: 7 | loss: 0.0903304
	speed: 0.0129s/iter; left time: 98.1416s
	iters: 500, epoch: 7 | loss: 0.1177615
	speed: 0.0129s/iter; left time: 96.6849s
Epoch: 7 cost time: 7.73091721534729
Epoch: 7, Steps: 570 | Train Loss: 0.1292391 Vali Loss: 0.0397825 Test Loss: 0.1285097
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0874919
	speed: 0.0389s/iter; left time: 284.3073s
	iters: 200, epoch: 8 | loss: 0.1236357
	speed: 0.0119s/iter; left time: 85.5454s
	iters: 300, epoch: 8 | loss: 0.1306811
	speed: 0.0119s/iter; left time: 84.4534s
	iters: 400, epoch: 8 | loss: 0.1075007
	speed: 0.0118s/iter; left time: 83.0557s
	iters: 500, epoch: 8 | loss: 0.1073734
	speed: 0.0119s/iter; left time: 81.9038s
Epoch: 8 cost time: 7.046395540237427
Epoch: 8, Steps: 570 | Train Loss: 0.1282189 Vali Loss: 0.0393154 Test Loss: 0.1281180
Validation loss decreased (0.039481 --> 0.039315).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1067264
	speed: 0.0401s/iter; left time: 270.3638s
	iters: 200, epoch: 9 | loss: 0.1032476
	speed: 0.0118s/iter; left time: 78.5624s
	iters: 300, epoch: 9 | loss: 0.1405332
	speed: 0.0118s/iter; left time: 77.2721s
	iters: 400, epoch: 9 | loss: 0.0929061
	speed: 0.0118s/iter; left time: 76.2846s
	iters: 500, epoch: 9 | loss: 0.1268479
	speed: 0.0118s/iter; left time: 74.9248s
Epoch: 9 cost time: 7.063356399536133
Epoch: 9, Steps: 570 | Train Loss: 0.1259667 Vali Loss: 0.0393005 Test Loss: 0.1285784
Validation loss decreased (0.039315 --> 0.039301).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1167146
	speed: 0.0403s/iter; left time: 248.9301s
	iters: 200, epoch: 10 | loss: 0.1376054
	speed: 0.0119s/iter; left time: 72.1268s
	iters: 300, epoch: 10 | loss: 0.1336108
	speed: 0.0119s/iter; left time: 70.8325s
	iters: 400, epoch: 10 | loss: 0.1067017
	speed: 0.0118s/iter; left time: 69.4733s
	iters: 500, epoch: 10 | loss: 0.1816334
	speed: 0.0119s/iter; left time: 68.4239s
Epoch: 10 cost time: 7.088929891586304
Epoch: 10, Steps: 570 | Train Loss: 0.1260375 Vali Loss: 0.0393978 Test Loss: 0.1289789
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1116521
	speed: 0.0389s/iter; left time: 218.0111s
	iters: 200, epoch: 11 | loss: 0.1775654
	speed: 0.0118s/iter; left time: 65.0262s
	iters: 300, epoch: 11 | loss: 0.1322004
	speed: 0.0118s/iter; left time: 63.9814s
	iters: 400, epoch: 11 | loss: 0.1197584
	speed: 0.0118s/iter; left time: 62.6531s
	iters: 500, epoch: 11 | loss: 0.1856377
	speed: 0.0118s/iter; left time: 61.4374s
Epoch: 11 cost time: 7.078430414199829
Epoch: 11, Steps: 570 | Train Loss: 0.1244359 Vali Loss: 0.0394877 Test Loss: 0.1293370
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0919617
	speed: 0.0398s/iter; left time: 200.0002s
	iters: 200, epoch: 12 | loss: 0.0905452
	speed: 0.0119s/iter; left time: 58.7055s
	iters: 300, epoch: 12 | loss: 0.1048527
	speed: 0.0119s/iter; left time: 57.4251s
	iters: 400, epoch: 12 | loss: 0.1121643
	speed: 0.0119s/iter; left time: 56.2956s
	iters: 500, epoch: 12 | loss: 0.1147581
	speed: 0.0119s/iter; left time: 55.0511s
Epoch: 12 cost time: 7.108351230621338
Epoch: 12, Steps: 570 | Train Loss: 0.1251730 Vali Loss: 0.0395623 Test Loss: 0.1292676
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12871778011322021, mae:0.22809365391731262
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1300711
	speed: 0.0234s/iter; left time: 263.9984s
	iters: 200, epoch: 1 | loss: 0.3094113
	speed: 0.0115s/iter; left time: 128.4862s
	iters: 300, epoch: 1 | loss: 0.1772321
	speed: 0.0115s/iter; left time: 127.5790s
	iters: 400, epoch: 1 | loss: 0.1927970
	speed: 0.0115s/iter; left time: 126.1777s
	iters: 500, epoch: 1 | loss: 0.1227823
	speed: 0.0115s/iter; left time: 125.0530s
Epoch: 1 cost time: 7.78114914894104
Epoch: 1, Steps: 570 | Train Loss: 0.1955146 Vali Loss: 0.0420059 Test Loss: 0.1293657
Validation loss decreased (inf --> 0.042006).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1480882
	speed: 0.0406s/iter; left time: 435.4715s
	iters: 200, epoch: 2 | loss: 0.1168805
	speed: 0.0115s/iter; left time: 121.7834s
	iters: 300, epoch: 2 | loss: 0.1539083
	speed: 0.0115s/iter; left time: 120.9135s
	iters: 400, epoch: 2 | loss: 0.2182992
	speed: 0.0115s/iter; left time: 119.4797s
	iters: 500, epoch: 2 | loss: 0.6056554
	speed: 0.0115s/iter; left time: 118.4963s
Epoch: 2 cost time: 6.940418243408203
Epoch: 2, Steps: 570 | Train Loss: 0.1892001 Vali Loss: 0.0559730 Test Loss: 0.1621517
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2122157
	speed: 0.0394s/iter; left time: 400.6823s
	iters: 200, epoch: 3 | loss: 0.0970625
	speed: 0.0116s/iter; left time: 116.3204s
	iters: 300, epoch: 3 | loss: 0.1917423
	speed: 0.0116s/iter; left time: 115.0567s
	iters: 400, epoch: 3 | loss: 0.1587247
	speed: 0.0115s/iter; left time: 113.6300s
	iters: 500, epoch: 3 | loss: 0.2420566
	speed: 0.0116s/iter; left time: 112.7672s
Epoch: 3 cost time: 6.915986061096191
Epoch: 3, Steps: 570 | Train Loss: 0.1813456 Vali Loss: 0.0372267 Test Loss: 0.1250522
Validation loss decreased (0.042006 --> 0.037227).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1855680
	speed: 0.0404s/iter; left time: 387.5487s
	iters: 200, epoch: 4 | loss: 0.0917098
	speed: 0.0115s/iter; left time: 108.9737s
	iters: 300, epoch: 4 | loss: 0.0880305
	speed: 0.0115s/iter; left time: 107.8915s
	iters: 400, epoch: 4 | loss: 0.1410631
	speed: 0.0115s/iter; left time: 106.5433s
	iters: 500, epoch: 4 | loss: 0.1505861
	speed: 0.0115s/iter; left time: 105.3892s
Epoch: 4 cost time: 6.873798131942749
Epoch: 4, Steps: 570 | Train Loss: 0.1574655 Vali Loss: 0.0376252 Test Loss: 0.1238940
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1433762
	speed: 0.0389s/iter; left time: 350.7341s
	iters: 200, epoch: 5 | loss: 0.1362560
	speed: 0.0115s/iter; left time: 102.2550s
	iters: 300, epoch: 5 | loss: 0.2190448
	speed: 0.0115s/iter; left time: 101.1944s
	iters: 400, epoch: 5 | loss: 0.1679020
	speed: 0.0115s/iter; left time: 99.9493s
	iters: 500, epoch: 5 | loss: 0.1148061
	speed: 0.0115s/iter; left time: 98.8807s
Epoch: 5 cost time: 6.848667860031128
Epoch: 5, Steps: 570 | Train Loss: 0.1475436 Vali Loss: 0.0346353 Test Loss: 0.1169233
Validation loss decreased (0.037227 --> 0.034635).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1732468
	speed: 0.0389s/iter; left time: 329.0539s
	iters: 200, epoch: 6 | loss: 0.1484320
	speed: 0.0115s/iter; left time: 95.9279s
	iters: 300, epoch: 6 | loss: 0.0845025
	speed: 0.0115s/iter; left time: 95.0278s
	iters: 400, epoch: 6 | loss: 0.0988227
	speed: 0.0115s/iter; left time: 93.8036s
	iters: 500, epoch: 6 | loss: 0.1221070
	speed: 0.0115s/iter; left time: 92.6768s
Epoch: 6 cost time: 6.874903917312622
Epoch: 6, Steps: 570 | Train Loss: 0.1396978 Vali Loss: 0.0338739 Test Loss: 0.1158155
Validation loss decreased (0.034635 --> 0.033874).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1004824
	speed: 0.0392s/iter; left time: 308.5634s
	iters: 200, epoch: 7 | loss: 0.2261177
	speed: 0.0115s/iter; left time: 89.3396s
	iters: 300, epoch: 7 | loss: 0.1112074
	speed: 0.0115s/iter; left time: 88.4728s
	iters: 400, epoch: 7 | loss: 0.1229349
	speed: 0.0115s/iter; left time: 87.2963s
	iters: 500, epoch: 7 | loss: 0.1122292
	speed: 0.0115s/iter; left time: 85.8461s
Epoch: 7 cost time: 6.882357358932495
Epoch: 7, Steps: 570 | Train Loss: 0.1377403 Vali Loss: 0.0337382 Test Loss: 0.1156678
Validation loss decreased (0.033874 --> 0.033738).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1037824
	speed: 0.0398s/iter; left time: 291.2491s
	iters: 200, epoch: 8 | loss: 0.1524660
	speed: 0.0115s/iter; left time: 82.7212s
	iters: 300, epoch: 8 | loss: 0.1183857
	speed: 0.0115s/iter; left time: 81.6051s
	iters: 400, epoch: 8 | loss: 0.1234620
	speed: 0.0115s/iter; left time: 80.3759s
	iters: 500, epoch: 8 | loss: 0.1097233
	speed: 0.0115s/iter; left time: 79.2446s
Epoch: 8 cost time: 6.867618083953857
Epoch: 8, Steps: 570 | Train Loss: 0.1357162 Vali Loss: 0.0336374 Test Loss: 0.1146246
Validation loss decreased (0.033738 --> 0.033637).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1797483
	speed: 0.0393s/iter; left time: 265.1488s
	iters: 200, epoch: 9 | loss: 0.0966282
	speed: 0.0115s/iter; left time: 76.5781s
	iters: 300, epoch: 9 | loss: 0.1592433
	speed: 0.0115s/iter; left time: 75.4252s
	iters: 400, epoch: 9 | loss: 0.1242249
	speed: 0.0115s/iter; left time: 74.2696s
	iters: 500, epoch: 9 | loss: 0.2368679
	speed: 0.0125s/iter; left time: 79.3197s
Epoch: 9 cost time: 7.062002420425415
Epoch: 9, Steps: 570 | Train Loss: 0.1345700 Vali Loss: 0.0333215 Test Loss: 0.1144174
Validation loss decreased (0.033637 --> 0.033322).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1224813
	speed: 0.0399s/iter; left time: 246.4031s
	iters: 200, epoch: 10 | loss: 0.0959411
	speed: 0.0115s/iter; left time: 69.8941s
	iters: 300, epoch: 10 | loss: 0.1260364
	speed: 0.0115s/iter; left time: 68.5740s
	iters: 400, epoch: 10 | loss: 0.1690525
	speed: 0.0115s/iter; left time: 67.4265s
	iters: 500, epoch: 10 | loss: 0.1556181
	speed: 0.0115s/iter; left time: 66.3613s
Epoch: 10 cost time: 6.85985541343689
Epoch: 10, Steps: 570 | Train Loss: 0.1346377 Vali Loss: 0.0333686 Test Loss: 0.1149346
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1144761
	speed: 0.0396s/iter; left time: 221.5317s
	iters: 200, epoch: 11 | loss: 0.1198494
	speed: 0.0115s/iter; left time: 63.1675s
	iters: 300, epoch: 11 | loss: 0.1082775
	speed: 0.0115s/iter; left time: 62.0109s
	iters: 400, epoch: 11 | loss: 0.1738293
	speed: 0.0115s/iter; left time: 60.9828s
	iters: 500, epoch: 11 | loss: 0.1408115
	speed: 0.0115s/iter; left time: 59.8145s
Epoch: 11 cost time: 6.8390891551971436
Epoch: 11, Steps: 570 | Train Loss: 0.1339782 Vali Loss: 0.0333226 Test Loss: 0.1150690
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1342557
	speed: 0.0379s/iter; left time: 190.8716s
	iters: 200, epoch: 12 | loss: 0.1216956
	speed: 0.0115s/iter; left time: 56.8086s
	iters: 300, epoch: 12 | loss: 0.1211447
	speed: 0.0115s/iter; left time: 55.7113s
	iters: 400, epoch: 12 | loss: 0.1809108
	speed: 0.0115s/iter; left time: 54.5715s
	iters: 500, epoch: 12 | loss: 0.1421872
	speed: 0.0115s/iter; left time: 53.4115s
Epoch: 12 cost time: 6.833071231842041
Epoch: 12, Steps: 570 | Train Loss: 0.1330528 Vali Loss: 0.0335861 Test Loss: 0.1150666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11457356065511703, mae:0.2082524299621582
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2563054
	speed: 0.0240s/iter; left time: 271.2517s
	iters: 200, epoch: 1 | loss: 0.3060882
	speed: 0.0120s/iter; left time: 134.8536s
	iters: 300, epoch: 1 | loss: 0.2427146
	speed: 0.0120s/iter; left time: 133.2927s
	iters: 400, epoch: 1 | loss: 0.1704900
	speed: 0.0120s/iter; left time: 132.2514s
	iters: 500, epoch: 1 | loss: 0.1884707
	speed: 0.0121s/iter; left time: 131.8408s
Epoch: 1 cost time: 8.108466386795044
Epoch: 1, Steps: 570 | Train Loss: 0.2254649 Vali Loss: 0.0460251 Test Loss: 0.1410485
Validation loss decreased (inf --> 0.046025).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2278082
	speed: 0.0399s/iter; left time: 428.1738s
	iters: 200, epoch: 2 | loss: 0.2863010
	speed: 0.0108s/iter; left time: 115.1900s
	iters: 300, epoch: 2 | loss: 0.1574631
	speed: 0.0109s/iter; left time: 114.4583s
	iters: 400, epoch: 2 | loss: 0.1781293
	speed: 0.0108s/iter; left time: 113.0331s
	iters: 500, epoch: 2 | loss: 0.3219774
	speed: 0.0109s/iter; left time: 112.2817s
Epoch: 2 cost time: 6.550750732421875
Epoch: 2, Steps: 570 | Train Loss: 0.2344164 Vali Loss: 0.0522266 Test Loss: 0.1590629
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1617962
	speed: 0.0368s/iter; left time: 373.6391s
	iters: 200, epoch: 3 | loss: 0.1521518
	speed: 0.0109s/iter; left time: 109.2225s
	iters: 300, epoch: 3 | loss: 0.2234536
	speed: 0.0109s/iter; left time: 108.1599s
	iters: 400, epoch: 3 | loss: 0.1817826
	speed: 0.0109s/iter; left time: 107.2112s
	iters: 500, epoch: 3 | loss: 0.2091747
	speed: 0.0108s/iter; left time: 105.8488s
Epoch: 3 cost time: 6.480379581451416
Epoch: 3, Steps: 570 | Train Loss: 0.2069548 Vali Loss: 0.0490118 Test Loss: 0.1398464
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2131798
	speed: 0.0382s/iter; left time: 366.3586s
	iters: 200, epoch: 4 | loss: 0.1151125
	speed: 0.0109s/iter; left time: 103.3951s
	iters: 300, epoch: 4 | loss: 0.1875534
	speed: 0.0109s/iter; left time: 102.1971s
	iters: 400, epoch: 4 | loss: 0.2876613
	speed: 0.0109s/iter; left time: 101.1657s
	iters: 500, epoch: 4 | loss: 0.1665280
	speed: 0.0109s/iter; left time: 100.2599s
Epoch: 4 cost time: 6.482029676437378
Epoch: 4, Steps: 570 | Train Loss: 0.1805104 Vali Loss: 0.0436446 Test Loss: 0.1359658
Validation loss decreased (0.046025 --> 0.043645).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1752025
	speed: 0.0381s/iter; left time: 343.6311s
	iters: 200, epoch: 5 | loss: 0.1700835
	speed: 0.0109s/iter; left time: 97.3192s
	iters: 300, epoch: 5 | loss: 0.1537457
	speed: 0.0109s/iter; left time: 96.3739s
	iters: 400, epoch: 5 | loss: 0.1103722
	speed: 0.0109s/iter; left time: 95.1316s
	iters: 500, epoch: 5 | loss: 0.2354374
	speed: 0.0109s/iter; left time: 94.0187s
Epoch: 5 cost time: 6.546094179153442
Epoch: 5, Steps: 570 | Train Loss: 0.1616194 Vali Loss: 0.0424842 Test Loss: 0.1335908
Validation loss decreased (0.043645 --> 0.042484).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1213849
	speed: 0.0414s/iter; left time: 350.0067s
	iters: 200, epoch: 6 | loss: 0.1398307
	speed: 0.0121s/iter; left time: 100.8311s
	iters: 300, epoch: 6 | loss: 0.1669592
	speed: 0.0121s/iter; left time: 99.4822s
	iters: 400, epoch: 6 | loss: 0.1325021
	speed: 0.0118s/iter; left time: 95.9943s
	iters: 500, epoch: 6 | loss: 0.1601461
	speed: 0.0109s/iter; left time: 87.5859s
Epoch: 6 cost time: 6.957869291305542
Epoch: 6, Steps: 570 | Train Loss: 0.1514458 Vali Loss: 0.0423038 Test Loss: 0.1384318
Validation loss decreased (0.042484 --> 0.042304).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1293175
	speed: 0.0383s/iter; left time: 301.8842s
	iters: 200, epoch: 7 | loss: 0.1011876
	speed: 0.0109s/iter; left time: 85.0009s
	iters: 300, epoch: 7 | loss: 0.0974072
	speed: 0.0109s/iter; left time: 83.8142s
	iters: 400, epoch: 7 | loss: 0.1650061
	speed: 0.0109s/iter; left time: 82.6012s
	iters: 500, epoch: 7 | loss: 0.1089765
	speed: 0.0109s/iter; left time: 81.4498s
Epoch: 7 cost time: 6.5218329429626465
Epoch: 7, Steps: 570 | Train Loss: 0.1461564 Vali Loss: 0.0408922 Test Loss: 0.1339641
Validation loss decreased (0.042304 --> 0.040892).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1181434
	speed: 0.0383s/iter; left time: 280.1453s
	iters: 200, epoch: 8 | loss: 0.1858453
	speed: 0.0109s/iter; left time: 78.7396s
	iters: 300, epoch: 8 | loss: 0.1627850
	speed: 0.0109s/iter; left time: 77.4486s
	iters: 400, epoch: 8 | loss: 0.1537389
	speed: 0.0109s/iter; left time: 76.2331s
	iters: 500, epoch: 8 | loss: 0.1267983
	speed: 0.0109s/iter; left time: 75.3266s
Epoch: 8 cost time: 6.5266852378845215
Epoch: 8, Steps: 570 | Train Loss: 0.1429851 Vali Loss: 0.0401977 Test Loss: 0.1338758
Validation loss decreased (0.040892 --> 0.040198).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1155324
	speed: 0.0390s/iter; left time: 263.0395s
	iters: 200, epoch: 9 | loss: 0.1059210
	speed: 0.0109s/iter; left time: 72.5817s
	iters: 300, epoch: 9 | loss: 0.1898012
	speed: 0.0109s/iter; left time: 71.2687s
	iters: 400, epoch: 9 | loss: 0.1801835
	speed: 0.0109s/iter; left time: 70.0957s
	iters: 500, epoch: 9 | loss: 0.0898061
	speed: 0.0109s/iter; left time: 69.0010s
Epoch: 9 cost time: 6.52003812789917
Epoch: 9, Steps: 570 | Train Loss: 0.1410465 Vali Loss: 0.0404282 Test Loss: 0.1336343
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1446062
	speed: 0.0396s/iter; left time: 244.2844s
	iters: 200, epoch: 10 | loss: 0.0783195
	speed: 0.0115s/iter; left time: 69.9240s
	iters: 300, epoch: 10 | loss: 0.1531917
	speed: 0.0110s/iter; left time: 65.4016s
	iters: 400, epoch: 10 | loss: 0.1077531
	speed: 0.0109s/iter; left time: 64.1907s
	iters: 500, epoch: 10 | loss: 0.1898513
	speed: 0.0109s/iter; left time: 63.1706s
Epoch: 10 cost time: 6.706769704818726
Epoch: 10, Steps: 570 | Train Loss: 0.1413932 Vali Loss: 0.0402531 Test Loss: 0.1331305
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0896061
	speed: 0.0369s/iter; left time: 206.7232s
	iters: 200, epoch: 11 | loss: 0.1391569
	speed: 0.0108s/iter; left time: 59.5227s
	iters: 300, epoch: 11 | loss: 0.1467878
	speed: 0.0108s/iter; left time: 58.5297s
	iters: 400, epoch: 11 | loss: 0.1015909
	speed: 0.0108s/iter; left time: 57.4081s
	iters: 500, epoch: 11 | loss: 0.1169378
	speed: 0.0108s/iter; left time: 56.3121s
Epoch: 11 cost time: 6.487159013748169
Epoch: 11, Steps: 570 | Train Loss: 0.1408087 Vali Loss: 0.0402770 Test Loss: 0.1330332
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13402952253818512, mae:0.23121598362922668
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1887528
	speed: 0.0263s/iter; left time: 297.2034s
	iters: 200, epoch: 1 | loss: 0.1745297
	speed: 0.0146s/iter; left time: 163.3285s
	iters: 300, epoch: 1 | loss: 0.2686448
	speed: 0.0146s/iter; left time: 161.6412s
	iters: 400, epoch: 1 | loss: 0.1905873
	speed: 0.0146s/iter; left time: 160.4710s
	iters: 500, epoch: 1 | loss: 0.1562005
	speed: 0.0146s/iter; left time: 159.3693s
Epoch: 1 cost time: 9.539918422698975
Epoch: 1, Steps: 570 | Train Loss: 0.2121014 Vali Loss: 0.0457071 Test Loss: 0.1369302
Validation loss decreased (inf --> 0.045707).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2004817
	speed: 0.0471s/iter; left time: 505.8297s
	iters: 200, epoch: 2 | loss: 0.1453238
	speed: 0.0146s/iter; left time: 155.4346s
	iters: 300, epoch: 2 | loss: 0.1475892
	speed: 0.0146s/iter; left time: 153.9990s
	iters: 400, epoch: 2 | loss: 0.0873680
	speed: 0.0146s/iter; left time: 152.6279s
	iters: 500, epoch: 2 | loss: 0.1953811
	speed: 0.0146s/iter; left time: 150.9691s
Epoch: 2 cost time: 8.656659603118896
Epoch: 2, Steps: 570 | Train Loss: 0.1697742 Vali Loss: 0.0448095 Test Loss: 0.1532207
Validation loss decreased (0.045707 --> 0.044810).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2172320
	speed: 0.0470s/iter; left time: 477.7769s
	iters: 200, epoch: 3 | loss: 0.1722004
	speed: 0.0147s/iter; left time: 147.5230s
	iters: 300, epoch: 3 | loss: 0.0974896
	speed: 0.0147s/iter; left time: 146.1692s
	iters: 400, epoch: 3 | loss: 0.1056065
	speed: 0.0147s/iter; left time: 144.8839s
	iters: 500, epoch: 3 | loss: 0.0902604
	speed: 0.0147s/iter; left time: 143.1429s
Epoch: 3 cost time: 8.687320947647095
Epoch: 3, Steps: 570 | Train Loss: 0.1363809 Vali Loss: 0.0369532 Test Loss: 0.1324762
Validation loss decreased (0.044810 --> 0.036953).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1073803
	speed: 0.0485s/iter; left time: 465.3882s
	iters: 200, epoch: 4 | loss: 0.0982647
	speed: 0.0165s/iter; left time: 156.1273s
	iters: 300, epoch: 4 | loss: 0.1236442
	speed: 0.0156s/iter; left time: 146.8999s
	iters: 400, epoch: 4 | loss: 0.1236129
	speed: 0.0146s/iter; left time: 135.8473s
	iters: 500, epoch: 4 | loss: 0.0928323
	speed: 0.0146s/iter; left time: 134.4445s
Epoch: 4 cost time: 9.113266229629517
Epoch: 4, Steps: 570 | Train Loss: 0.1142296 Vali Loss: 0.0382205 Test Loss: 0.1314452
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1057231
	speed: 0.0459s/iter; left time: 413.7922s
	iters: 200, epoch: 5 | loss: 0.0959686
	speed: 0.0147s/iter; left time: 131.5545s
	iters: 300, epoch: 5 | loss: 0.1053961
	speed: 0.0147s/iter; left time: 129.9197s
	iters: 400, epoch: 5 | loss: 0.0760272
	speed: 0.0148s/iter; left time: 128.7153s
	iters: 500, epoch: 5 | loss: 0.0985045
	speed: 0.0147s/iter; left time: 127.0876s
Epoch: 5 cost time: 8.672228813171387
Epoch: 5, Steps: 570 | Train Loss: 0.1028115 Vali Loss: 0.0374991 Test Loss: 0.1352442
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0769622
	speed: 0.0462s/iter; left time: 390.0554s
	iters: 200, epoch: 6 | loss: 0.1111268
	speed: 0.0147s/iter; left time: 122.5007s
	iters: 300, epoch: 6 | loss: 0.0763125
	speed: 0.0147s/iter; left time: 120.9743s
	iters: 400, epoch: 6 | loss: 0.0836025
	speed: 0.0146s/iter; left time: 119.3091s
	iters: 500, epoch: 6 | loss: 0.0896173
	speed: 0.0146s/iter; left time: 117.8496s
Epoch: 6 cost time: 8.62747836112976
Epoch: 6, Steps: 570 | Train Loss: 0.0954362 Vali Loss: 0.0381863 Test Loss: 0.1341667
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1326751559972763, mae:0.23089633882045746
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2571278
	speed: 0.0281s/iter; left time: 317.5207s
	iters: 200, epoch: 1 | loss: 0.1795674
	speed: 0.0164s/iter; left time: 183.2689s
	iters: 300, epoch: 1 | loss: 0.1446693
	speed: 0.0164s/iter; left time: 181.8129s
	iters: 400, epoch: 1 | loss: 0.2394119
	speed: 0.0164s/iter; left time: 180.0496s
	iters: 500, epoch: 1 | loss: 0.1704829
	speed: 0.0164s/iter; left time: 178.7969s
Epoch: 1 cost time: 10.55946159362793
Epoch: 1, Steps: 570 | Train Loss: 0.1852389 Vali Loss: 0.0390686 Test Loss: 0.1200361
Validation loss decreased (inf --> 0.039069).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1506557
	speed: 0.0507s/iter; left time: 543.6751s
	iters: 200, epoch: 2 | loss: 0.2355483
	speed: 0.0164s/iter; left time: 174.5275s
	iters: 300, epoch: 2 | loss: 0.1674860
	speed: 0.0165s/iter; left time: 173.3000s
	iters: 400, epoch: 2 | loss: 0.1498764
	speed: 0.0164s/iter; left time: 171.5250s
	iters: 500, epoch: 2 | loss: 0.1291158
	speed: 0.0164s/iter; left time: 169.5408s
Epoch: 2 cost time: 9.670292377471924
Epoch: 2, Steps: 570 | Train Loss: 0.1558052 Vali Loss: 0.0364324 Test Loss: 0.1229202
Validation loss decreased (0.039069 --> 0.036432).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1597399
	speed: 0.0506s/iter; left time: 514.5095s
	iters: 200, epoch: 3 | loss: 0.0761815
	speed: 0.0165s/iter; left time: 166.0624s
	iters: 300, epoch: 3 | loss: 0.1524725
	speed: 0.0165s/iter; left time: 164.1581s
	iters: 400, epoch: 3 | loss: 0.1095894
	speed: 0.0164s/iter; left time: 161.9155s
	iters: 500, epoch: 3 | loss: 0.1125388
	speed: 0.0164s/iter; left time: 160.3990s
Epoch: 3 cost time: 9.6886625289917
Epoch: 3, Steps: 570 | Train Loss: 0.1273141 Vali Loss: 0.0354726 Test Loss: 0.1159626
Validation loss decreased (0.036432 --> 0.035473).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1125436
	speed: 0.0519s/iter; left time: 498.1597s
	iters: 200, epoch: 4 | loss: 0.1218719
	speed: 0.0166s/iter; left time: 157.0870s
	iters: 300, epoch: 4 | loss: 0.1170438
	speed: 0.0165s/iter; left time: 155.3044s
	iters: 400, epoch: 4 | loss: 0.0681171
	speed: 0.0165s/iter; left time: 153.5092s
	iters: 500, epoch: 4 | loss: 0.0770603
	speed: 0.0165s/iter; left time: 151.5792s
Epoch: 4 cost time: 9.74596357345581
Epoch: 4, Steps: 570 | Train Loss: 0.1111331 Vali Loss: 0.0332167 Test Loss: 0.1165192
Validation loss decreased (0.035473 --> 0.033217).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0582938
	speed: 0.0487s/iter; left time: 438.9356s
	iters: 200, epoch: 5 | loss: 0.0808735
	speed: 0.0143s/iter; left time: 127.3641s
	iters: 300, epoch: 5 | loss: 0.1255110
	speed: 0.0143s/iter; left time: 126.1013s
	iters: 400, epoch: 5 | loss: 0.0846190
	speed: 0.0143s/iter; left time: 124.6877s
	iters: 500, epoch: 5 | loss: 0.1239723
	speed: 0.0142s/iter; left time: 122.7187s
Epoch: 5 cost time: 8.521896362304688
Epoch: 5, Steps: 570 | Train Loss: 0.0998496 Vali Loss: 0.0335846 Test Loss: 0.1124407
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0829497
	speed: 0.0476s/iter; left time: 402.4453s
	iters: 200, epoch: 6 | loss: 0.1824692
	speed: 0.0143s/iter; left time: 119.5344s
	iters: 300, epoch: 6 | loss: 0.1384225
	speed: 0.0143s/iter; left time: 118.3309s
	iters: 400, epoch: 6 | loss: 0.1213723
	speed: 0.0143s/iter; left time: 116.5914s
	iters: 500, epoch: 6 | loss: 0.1057120
	speed: 0.0143s/iter; left time: 115.1506s
Epoch: 6 cost time: 8.489892482757568
Epoch: 6, Steps: 570 | Train Loss: 0.0947269 Vali Loss: 0.0343582 Test Loss: 0.1162853
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0796793
	speed: 0.0461s/iter; left time: 363.2980s
	iters: 200, epoch: 7 | loss: 0.1019718
	speed: 0.0143s/iter; left time: 111.2174s
	iters: 300, epoch: 7 | loss: 0.1382055
	speed: 0.0162s/iter; left time: 124.3300s
	iters: 400, epoch: 7 | loss: 0.1120844
	speed: 0.0164s/iter; left time: 124.6451s
	iters: 500, epoch: 7 | loss: 0.1253088
	speed: 0.0165s/iter; left time: 123.2756s
Epoch: 7 cost time: 9.208753824234009
Epoch: 7, Steps: 570 | Train Loss: 0.0917960 Vali Loss: 0.0335369 Test Loss: 0.1151851
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11667660623788834, mae:0.2073177695274353
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1167674
	speed: 0.0279s/iter; left time: 314.7835s
	iters: 200, epoch: 1 | loss: 0.2955054
	speed: 0.0161s/iter; left time: 180.4379s
	iters: 300, epoch: 1 | loss: 0.2616664
	speed: 0.0161s/iter; left time: 178.8650s
	iters: 400, epoch: 1 | loss: 0.2577615
	speed: 0.0162s/iter; left time: 177.7492s
	iters: 500, epoch: 1 | loss: 0.2450613
	speed: 0.0161s/iter; left time: 176.0122s
Epoch: 1 cost time: 10.439857006072998
Epoch: 1, Steps: 570 | Train Loss: 0.2198592 Vali Loss: 0.0458057 Test Loss: 0.1364354
Validation loss decreased (inf --> 0.045806).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1457091
	speed: 0.0496s/iter; left time: 532.6805s
	iters: 200, epoch: 2 | loss: 0.1517224
	speed: 0.0165s/iter; left time: 175.6399s
	iters: 300, epoch: 2 | loss: 0.1078367
	speed: 0.0165s/iter; left time: 173.9293s
	iters: 400, epoch: 2 | loss: 0.1300821
	speed: 0.0165s/iter; left time: 172.1770s
	iters: 500, epoch: 2 | loss: 0.1867114
	speed: 0.0165s/iter; left time: 170.4399s
Epoch: 2 cost time: 9.697509527206421
Epoch: 2, Steps: 570 | Train Loss: 0.1734601 Vali Loss: 0.0465346 Test Loss: 0.1419535
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1603560
	speed: 0.0503s/iter; left time: 511.1666s
	iters: 200, epoch: 3 | loss: 0.1496567
	speed: 0.0143s/iter; left time: 143.5708s
	iters: 300, epoch: 3 | loss: 0.1131109
	speed: 0.0142s/iter; left time: 141.8560s
	iters: 400, epoch: 3 | loss: 0.1033980
	speed: 0.0142s/iter; left time: 140.4463s
	iters: 500, epoch: 3 | loss: 0.1396991
	speed: 0.0142s/iter; left time: 139.0420s
Epoch: 3 cost time: 8.481893301010132
Epoch: 3, Steps: 570 | Train Loss: 0.1330556 Vali Loss: 0.0399300 Test Loss: 0.1306822
Validation loss decreased (0.045806 --> 0.039930).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1255874
	speed: 0.0453s/iter; left time: 434.4615s
	iters: 200, epoch: 4 | loss: 0.0922611
	speed: 0.0143s/iter; left time: 135.9469s
	iters: 300, epoch: 4 | loss: 0.1204252
	speed: 0.0143s/iter; left time: 134.3561s
	iters: 400, epoch: 4 | loss: 0.0807351
	speed: 0.0143s/iter; left time: 133.1779s
	iters: 500, epoch: 4 | loss: 0.0890441
	speed: 0.0143s/iter; left time: 131.7439s
Epoch: 4 cost time: 8.457921504974365
Epoch: 4, Steps: 570 | Train Loss: 0.1093582 Vali Loss: 0.0405465 Test Loss: 0.1377843
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1012835
	speed: 0.0464s/iter; left time: 418.8518s
	iters: 200, epoch: 5 | loss: 0.1233751
	speed: 0.0143s/iter; left time: 127.3590s
	iters: 300, epoch: 5 | loss: 0.0911026
	speed: 0.0143s/iter; left time: 125.7420s
	iters: 400, epoch: 5 | loss: 0.1299900
	speed: 0.0144s/iter; left time: 125.7435s
	iters: 500, epoch: 5 | loss: 0.0800860
	speed: 0.0164s/iter; left time: 141.4061s
Epoch: 5 cost time: 8.777215719223022
Epoch: 5, Steps: 570 | Train Loss: 0.0979579 Vali Loss: 0.0395616 Test Loss: 0.1374321
Validation loss decreased (0.039930 --> 0.039562).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1015463
	speed: 0.0497s/iter; left time: 420.0439s
	iters: 200, epoch: 6 | loss: 0.0948733
	speed: 0.0162s/iter; left time: 134.9666s
	iters: 300, epoch: 6 | loss: 0.0730019
	speed: 0.0161s/iter; left time: 133.1401s
	iters: 400, epoch: 6 | loss: 0.1324817
	speed: 0.0161s/iter; left time: 131.6265s
	iters: 500, epoch: 6 | loss: 0.0903305
	speed: 0.0164s/iter; left time: 131.8234s
Epoch: 6 cost time: 9.5691397190094
Epoch: 6, Steps: 570 | Train Loss: 0.0920441 Vali Loss: 0.0392771 Test Loss: 0.1379205
Validation loss decreased (0.039562 --> 0.039277).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1402810
	speed: 0.0509s/iter; left time: 401.2862s
	iters: 200, epoch: 7 | loss: 0.0584416
	speed: 0.0165s/iter; left time: 128.0932s
	iters: 300, epoch: 7 | loss: 0.0678023
	speed: 0.0165s/iter; left time: 126.4261s
	iters: 400, epoch: 7 | loss: 0.1021162
	speed: 0.0165s/iter; left time: 124.7919s
	iters: 500, epoch: 7 | loss: 0.0978183
	speed: 0.0165s/iter; left time: 123.1373s
Epoch: 7 cost time: 9.691774606704712
Epoch: 7, Steps: 570 | Train Loss: 0.0904201 Vali Loss: 0.0401387 Test Loss: 0.1376490
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0721863
	speed: 0.0510s/iter; left time: 373.1123s
	iters: 200, epoch: 8 | loss: 0.0762913
	speed: 0.0165s/iter; left time: 118.8422s
	iters: 300, epoch: 8 | loss: 0.0771560
	speed: 0.0165s/iter; left time: 117.2646s
	iters: 400, epoch: 8 | loss: 0.0905376
	speed: 0.0165s/iter; left time: 115.6008s
	iters: 500, epoch: 8 | loss: 0.0657823
	speed: 0.0165s/iter; left time: 113.7504s
Epoch: 8 cost time: 9.672219276428223
Epoch: 8, Steps: 570 | Train Loss: 0.0885404 Vali Loss: 0.0401814 Test Loss: 0.1384605
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1196062
	speed: 0.0506s/iter; left time: 340.8979s
	iters: 200, epoch: 9 | loss: 0.0744827
	speed: 0.0161s/iter; left time: 107.0134s
	iters: 300, epoch: 9 | loss: 0.0610878
	speed: 0.0161s/iter; left time: 105.4108s
	iters: 400, epoch: 9 | loss: 0.0683761
	speed: 0.0161s/iter; left time: 103.8454s
	iters: 500, epoch: 9 | loss: 0.0821749
	speed: 0.0161s/iter; left time: 102.3545s
Epoch: 9 cost time: 9.46431303024292
Epoch: 9, Steps: 570 | Train Loss: 0.0874677 Vali Loss: 0.0394991 Test Loss: 0.1376500
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1380898505449295, mae:0.2346818745136261
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2557442
	speed: 0.0290s/iter; left time: 327.5302s
	iters: 200, epoch: 1 | loss: 0.2155398
	speed: 0.0169s/iter; left time: 189.4642s
	iters: 300, epoch: 1 | loss: 0.2420019
	speed: 0.0169s/iter; left time: 187.5468s
	iters: 400, epoch: 1 | loss: 0.2215629
	speed: 0.0170s/iter; left time: 186.6285s
	iters: 500, epoch: 1 | loss: 0.1729687
	speed: 0.0169s/iter; left time: 184.5321s
Epoch: 1 cost time: 10.907882690429688
Epoch: 1, Steps: 570 | Train Loss: 0.2311400 Vali Loss: 0.0515341 Test Loss: 0.1655550
Validation loss decreased (inf --> 0.051534).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2657224
	speed: 0.0536s/iter; left time: 574.9421s
	iters: 200, epoch: 2 | loss: 0.2257499
	speed: 0.0169s/iter; left time: 179.6952s
	iters: 300, epoch: 2 | loss: 0.3500930
	speed: 0.0169s/iter; left time: 177.8023s
	iters: 400, epoch: 2 | loss: 0.2537546
	speed: 0.0169s/iter; left time: 176.2156s
	iters: 500, epoch: 2 | loss: 0.2537118
	speed: 0.0169s/iter; left time: 174.3403s
Epoch: 2 cost time: 9.977526426315308
Epoch: 2, Steps: 570 | Train Loss: 0.2654837 Vali Loss: 0.0593745 Test Loss: 0.1681601
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2091331
	speed: 0.0506s/iter; left time: 514.6213s
	iters: 200, epoch: 3 | loss: 0.2144510
	speed: 0.0169s/iter; left time: 170.0023s
	iters: 300, epoch: 3 | loss: 0.3650085
	speed: 0.0169s/iter; left time: 168.2903s
	iters: 400, epoch: 3 | loss: 0.2017132
	speed: 0.0169s/iter; left time: 166.4618s
	iters: 500, epoch: 3 | loss: 0.1605293
	speed: 0.0169s/iter; left time: 164.7076s
Epoch: 3 cost time: 9.947157621383667
Epoch: 3, Steps: 570 | Train Loss: 0.2349367 Vali Loss: 0.0586023 Test Loss: 0.1637388
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1823092
	speed: 0.0510s/iter; left time: 488.7811s
	iters: 200, epoch: 4 | loss: 0.1900171
	speed: 0.0169s/iter; left time: 160.7976s
	iters: 300, epoch: 4 | loss: 0.2166175
	speed: 0.0169s/iter; left time: 159.1708s
	iters: 400, epoch: 4 | loss: 0.2219737
	speed: 0.0169s/iter; left time: 157.2187s
	iters: 500, epoch: 4 | loss: 0.2073140
	speed: 0.0169s/iter; left time: 155.5867s
Epoch: 4 cost time: 10.01744294166565
Epoch: 4, Steps: 570 | Train Loss: 0.2113202 Vali Loss: 0.0572437 Test Loss: 0.1619374
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16583923995494843, mae:0.2654508650302887
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1760582
	speed: 0.0282s/iter; left time: 319.1292s
	iters: 200, epoch: 1 | loss: 0.1070482
	speed: 0.0164s/iter; left time: 183.5074s
	iters: 300, epoch: 1 | loss: 0.2112269
	speed: 0.0164s/iter; left time: 181.6434s
	iters: 400, epoch: 1 | loss: 0.1858908
	speed: 0.0164s/iter; left time: 180.0344s
	iters: 500, epoch: 1 | loss: 0.1099274
	speed: 0.0164s/iter; left time: 178.4558s
Epoch: 1 cost time: 10.563828468322754
Epoch: 1, Steps: 570 | Train Loss: 0.2009359 Vali Loss: 0.0405242 Test Loss: 0.1315651
Validation loss decreased (inf --> 0.040524).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2052581
	speed: 0.0514s/iter; left time: 551.9993s
	iters: 200, epoch: 2 | loss: 0.1780758
	speed: 0.0163s/iter; left time: 173.2695s
	iters: 300, epoch: 2 | loss: 0.3228746
	speed: 0.0163s/iter; left time: 171.4590s
	iters: 400, epoch: 2 | loss: 0.3696241
	speed: 0.0163s/iter; left time: 169.9328s
	iters: 500, epoch: 2 | loss: 0.2204932
	speed: 0.0163s/iter; left time: 168.5390s
Epoch: 2 cost time: 9.633000373840332
Epoch: 2, Steps: 570 | Train Loss: 0.2766150 Vali Loss: 0.0629898 Test Loss: 0.1795397
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2809814
	speed: 0.0507s/iter; left time: 514.6575s
	iters: 200, epoch: 3 | loss: 0.2335446
	speed: 0.0164s/iter; left time: 164.9578s
	iters: 300, epoch: 3 | loss: 0.1699868
	speed: 0.0164s/iter; left time: 163.0030s
	iters: 400, epoch: 3 | loss: 0.2662534
	speed: 0.0163s/iter; left time: 160.9774s
	iters: 500, epoch: 3 | loss: 0.1413514
	speed: 0.0163s/iter; left time: 159.3634s
Epoch: 3 cost time: 9.607754468917847
Epoch: 3, Steps: 570 | Train Loss: 0.2469185 Vali Loss: 0.0556733 Test Loss: 0.1584507
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1767578
	speed: 0.0494s/iter; left time: 474.1015s
	iters: 200, epoch: 4 | loss: 0.4568399
	speed: 0.0163s/iter; left time: 154.8789s
	iters: 300, epoch: 4 | loss: 0.2135920
	speed: 0.0163s/iter; left time: 153.0892s
	iters: 400, epoch: 4 | loss: 0.1967251
	speed: 0.0163s/iter; left time: 151.5247s
	iters: 500, epoch: 4 | loss: 0.3326260
	speed: 0.0163s/iter; left time: 149.8523s
Epoch: 4 cost time: 9.562763214111328
Epoch: 4, Steps: 570 | Train Loss: 0.2256985 Vali Loss: 0.0552150 Test Loss: 0.1522728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13178963959217072, mae:0.22601796686649323
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2132356
	speed: 0.0291s/iter; left time: 328.5212s
	iters: 200, epoch: 1 | loss: 0.2197873
	speed: 0.0170s/iter; left time: 190.0380s
	iters: 300, epoch: 1 | loss: 0.1616414
	speed: 0.0169s/iter; left time: 187.9722s
	iters: 400, epoch: 1 | loss: 0.2144824
	speed: 0.0170s/iter; left time: 186.9730s
	iters: 500, epoch: 1 | loss: 0.3870519
	speed: 0.0170s/iter; left time: 185.1918s
Epoch: 1 cost time: 10.933105707168579
Epoch: 1, Steps: 570 | Train Loss: 0.2323277 Vali Loss: 0.0471214 Test Loss: 0.1549581
Validation loss decreased (inf --> 0.047121).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2906809
	speed: 0.0494s/iter; left time: 530.0561s
	iters: 200, epoch: 2 | loss: 0.1560972
	speed: 0.0154s/iter; left time: 163.5415s
	iters: 300, epoch: 2 | loss: 0.3482560
	speed: 0.0154s/iter; left time: 161.8756s
	iters: 400, epoch: 2 | loss: 0.2620814
	speed: 0.0154s/iter; left time: 160.2618s
	iters: 500, epoch: 2 | loss: 0.3732356
	speed: 0.0154s/iter; left time: 158.7466s
Epoch: 2 cost time: 9.073968172073364
Epoch: 2, Steps: 570 | Train Loss: 0.2595969 Vali Loss: 0.0632168 Test Loss: 0.1850292
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2194456
	speed: 0.0489s/iter; left time: 496.8409s
	iters: 200, epoch: 3 | loss: 0.1570438
	speed: 0.0154s/iter; left time: 154.8359s
	iters: 300, epoch: 3 | loss: 0.4517294
	speed: 0.0154s/iter; left time: 152.9200s
	iters: 400, epoch: 3 | loss: 0.2757720
	speed: 0.0154s/iter; left time: 151.3872s
	iters: 500, epoch: 3 | loss: 0.2946413
	speed: 0.0153s/iter; left time: 149.8064s
Epoch: 3 cost time: 9.043947219848633
Epoch: 3, Steps: 570 | Train Loss: 0.2807978 Vali Loss: 0.0621568 Test Loss: 0.1712141
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2104102
	speed: 0.0471s/iter; left time: 451.4336s
	iters: 200, epoch: 4 | loss: 0.3161986
	speed: 0.0154s/iter; left time: 146.3697s
	iters: 300, epoch: 4 | loss: 0.3023233
	speed: 0.0154s/iter; left time: 144.7628s
	iters: 400, epoch: 4 | loss: 0.1917839
	speed: 0.0154s/iter; left time: 143.2259s
	iters: 500, epoch: 4 | loss: 0.2984703
	speed: 0.0155s/iter; left time: 142.0339s
Epoch: 4 cost time: 9.067560911178589
Epoch: 4, Steps: 570 | Train Loss: 0.2446291 Vali Loss: 0.0604046 Test Loss: 0.1626612
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15516559779644012, mae:0.24410508573055267
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1601215
	speed: 0.0326s/iter; left time: 368.7966s
	iters: 200, epoch: 1 | loss: 0.2679668
	speed: 0.0207s/iter; left time: 232.2152s
	iters: 300, epoch: 1 | loss: 0.3529364
	speed: 0.0208s/iter; left time: 231.3258s
	iters: 400, epoch: 1 | loss: 0.1937822
	speed: 0.0208s/iter; left time: 228.7796s
	iters: 500, epoch: 1 | loss: 0.1617287
	speed: 0.0189s/iter; left time: 206.2345s
Epoch: 1 cost time: 12.748009204864502
Epoch: 1, Steps: 570 | Train Loss: 0.2158539 Vali Loss: 0.0480296 Test Loss: 0.1407557
Validation loss decreased (inf --> 0.048030).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3049391
	speed: 0.0565s/iter; left time: 606.1212s
	iters: 200, epoch: 2 | loss: 0.1487861
	speed: 0.0186s/iter; left time: 197.2501s
	iters: 300, epoch: 2 | loss: 0.1564662
	speed: 0.0185s/iter; left time: 194.7709s
	iters: 400, epoch: 2 | loss: 0.1327024
	speed: 0.0185s/iter; left time: 192.9607s
	iters: 500, epoch: 2 | loss: 0.1627572
	speed: 0.0185s/iter; left time: 190.9105s
Epoch: 2 cost time: 10.878407716751099
Epoch: 2, Steps: 570 | Train Loss: 0.1726822 Vali Loss: 0.0468829 Test Loss: 0.1471639
Validation loss decreased (0.048030 --> 0.046883).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1179763
	speed: 0.0560s/iter; left time: 569.0533s
	iters: 200, epoch: 3 | loss: 0.1013117
	speed: 0.0185s/iter; left time: 186.2095s
	iters: 300, epoch: 3 | loss: 0.1304374
	speed: 0.0185s/iter; left time: 184.2240s
	iters: 400, epoch: 3 | loss: 0.1004486
	speed: 0.0185s/iter; left time: 182.4233s
	iters: 500, epoch: 3 | loss: 0.0968303
	speed: 0.0185s/iter; left time: 180.4950s
Epoch: 3 cost time: 10.858896732330322
Epoch: 3, Steps: 570 | Train Loss: 0.1370727 Vali Loss: 0.0421463 Test Loss: 0.1415687
Validation loss decreased (0.046883 --> 0.042146).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1208971
	speed: 0.0565s/iter; left time: 541.4935s
	iters: 200, epoch: 4 | loss: 0.1769108
	speed: 0.0186s/iter; left time: 176.2411s
	iters: 300, epoch: 4 | loss: 0.1254952
	speed: 0.0186s/iter; left time: 174.3231s
	iters: 400, epoch: 4 | loss: 0.0638355
	speed: 0.0186s/iter; left time: 172.4253s
	iters: 500, epoch: 4 | loss: 0.1190091
	speed: 0.0186s/iter; left time: 170.6103s
Epoch: 4 cost time: 10.921736717224121
Epoch: 4, Steps: 570 | Train Loss: 0.1120965 Vali Loss: 0.0393526 Test Loss: 0.1339446
Validation loss decreased (0.042146 --> 0.039353).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1096135
	speed: 0.0580s/iter; left time: 523.5647s
	iters: 200, epoch: 5 | loss: 0.1083995
	speed: 0.0186s/iter; left time: 165.8449s
	iters: 300, epoch: 5 | loss: 0.1029091
	speed: 0.0186s/iter; left time: 163.9718s
	iters: 400, epoch: 5 | loss: 0.0780801
	speed: 0.0186s/iter; left time: 162.0541s
	iters: 500, epoch: 5 | loss: 0.0935497
	speed: 0.0186s/iter; left time: 160.1094s
Epoch: 5 cost time: 10.891927242279053
Epoch: 5, Steps: 570 | Train Loss: 0.0984703 Vali Loss: 0.0383031 Test Loss: 0.1369257
Validation loss decreased (0.039353 --> 0.038303).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0612615
	speed: 0.0592s/iter; left time: 500.5425s
	iters: 200, epoch: 6 | loss: 0.0969343
	speed: 0.0186s/iter; left time: 155.4497s
	iters: 300, epoch: 6 | loss: 0.0809905
	speed: 0.0186s/iter; left time: 153.3469s
	iters: 400, epoch: 6 | loss: 0.1350560
	speed: 0.0186s/iter; left time: 151.5881s
	iters: 500, epoch: 6 | loss: 0.0834133
	speed: 0.0186s/iter; left time: 149.6903s
Epoch: 6 cost time: 10.91262936592102
Epoch: 6, Steps: 570 | Train Loss: 0.0927784 Vali Loss: 0.0386098 Test Loss: 0.1366741
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0775667
	speed: 0.0574s/iter; left time: 452.0619s
	iters: 200, epoch: 7 | loss: 0.0709670
	speed: 0.0186s/iter; left time: 144.3497s
	iters: 300, epoch: 7 | loss: 0.0941858
	speed: 0.0186s/iter; left time: 142.6106s
	iters: 400, epoch: 7 | loss: 0.0993690
	speed: 0.0185s/iter; left time: 140.6024s
	iters: 500, epoch: 7 | loss: 0.1505994
	speed: 0.0186s/iter; left time: 138.8158s
Epoch: 7 cost time: 10.853829383850098
Epoch: 7, Steps: 570 | Train Loss: 0.0896315 Vali Loss: 0.0384480 Test Loss: 0.1356376
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0899162
	speed: 0.0590s/iter; left time: 431.0294s
	iters: 200, epoch: 8 | loss: 0.0799357
	speed: 0.0186s/iter; left time: 134.2789s
	iters: 300, epoch: 8 | loss: 0.0750812
	speed: 0.0186s/iter; left time: 132.3336s
	iters: 400, epoch: 8 | loss: 0.1160712
	speed: 0.0186s/iter; left time: 130.2671s
	iters: 500, epoch: 8 | loss: 0.0674134
	speed: 0.0186s/iter; left time: 128.5223s
Epoch: 8 cost time: 10.906166315078735
Epoch: 8, Steps: 570 | Train Loss: 0.0882210 Vali Loss: 0.0388550 Test Loss: 0.1363302
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13711073994636536, mae:0.23102308809757233
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3742481
	speed: 0.0300s/iter; left time: 338.4662s
	iters: 200, epoch: 1 | loss: 0.1943786
	speed: 0.0183s/iter; left time: 204.9473s
	iters: 300, epoch: 1 | loss: 0.1684622
	speed: 0.0183s/iter; left time: 203.1267s
	iters: 400, epoch: 1 | loss: 0.1639359
	speed: 0.0183s/iter; left time: 201.5907s
	iters: 500, epoch: 1 | loss: 0.1772284
	speed: 0.0183s/iter; left time: 199.7066s
Epoch: 1 cost time: 11.654429912567139
Epoch: 1, Steps: 570 | Train Loss: 0.1876974 Vali Loss: 0.0407946 Test Loss: 0.1276755
Validation loss decreased (inf --> 0.040795).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1380969
	speed: 0.0576s/iter; left time: 618.3683s
	iters: 200, epoch: 2 | loss: 0.2264183
	speed: 0.0183s/iter; left time: 194.0638s
	iters: 300, epoch: 2 | loss: 0.2026057
	speed: 0.0182s/iter; left time: 191.3649s
	iters: 400, epoch: 2 | loss: 0.2185692
	speed: 0.0182s/iter; left time: 189.4262s
	iters: 500, epoch: 2 | loss: 0.1197596
	speed: 0.0181s/iter; left time: 187.3410s
Epoch: 2 cost time: 10.869986772537231
Epoch: 2, Steps: 570 | Train Loss: 0.1580204 Vali Loss: 0.0412605 Test Loss: 0.1215693
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0871293
	speed: 0.0559s/iter; left time: 568.1813s
	iters: 200, epoch: 3 | loss: 0.1306126
	speed: 0.0182s/iter; left time: 183.4527s
	iters: 300, epoch: 3 | loss: 0.1405563
	speed: 0.0182s/iter; left time: 181.0525s
	iters: 400, epoch: 3 | loss: 0.0955729
	speed: 0.0182s/iter; left time: 179.4952s
	iters: 500, epoch: 3 | loss: 0.1021546
	speed: 0.0183s/iter; left time: 178.2491s
Epoch: 3 cost time: 10.645654201507568
Epoch: 3, Steps: 570 | Train Loss: 0.1316289 Vali Loss: 0.0364323 Test Loss: 0.1165626
Validation loss decreased (0.040795 --> 0.036432).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1236294
	speed: 0.0592s/iter; left time: 568.1350s
	iters: 200, epoch: 4 | loss: 0.0730140
	speed: 0.0183s/iter; left time: 173.3349s
	iters: 300, epoch: 4 | loss: 0.1182805
	speed: 0.0183s/iter; left time: 171.8951s
	iters: 400, epoch: 4 | loss: 0.0956322
	speed: 0.0183s/iter; left time: 169.9181s
	iters: 500, epoch: 4 | loss: 0.0843183
	speed: 0.0183s/iter; left time: 168.0088s
Epoch: 4 cost time: 10.923299789428711
Epoch: 4, Steps: 570 | Train Loss: 0.1119665 Vali Loss: 0.0349799 Test Loss: 0.1142847
Validation loss decreased (0.036432 --> 0.034980).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0831127
	speed: 0.0551s/iter; left time: 497.0798s
	iters: 200, epoch: 5 | loss: 0.0967013
	speed: 0.0182s/iter; left time: 162.0117s
	iters: 300, epoch: 5 | loss: 0.0894479
	speed: 0.0182s/iter; left time: 160.1126s
	iters: 400, epoch: 5 | loss: 0.0886109
	speed: 0.0182s/iter; left time: 158.3169s
	iters: 500, epoch: 5 | loss: 0.0990796
	speed: 0.0182s/iter; left time: 156.5169s
Epoch: 5 cost time: 10.637493133544922
Epoch: 5, Steps: 570 | Train Loss: 0.0984995 Vali Loss: 0.0343408 Test Loss: 0.1158925
Validation loss decreased (0.034980 --> 0.034341).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1077913
	speed: 0.0547s/iter; left time: 462.3854s
	iters: 200, epoch: 6 | loss: 0.0714055
	speed: 0.0182s/iter; left time: 152.3727s
	iters: 300, epoch: 6 | loss: 0.1109908
	speed: 0.0182s/iter; left time: 150.2115s
	iters: 400, epoch: 6 | loss: 0.0810228
	speed: 0.0182s/iter; left time: 148.1323s
	iters: 500, epoch: 6 | loss: 0.0629373
	speed: 0.0182s/iter; left time: 146.6088s
Epoch: 6 cost time: 10.667121410369873
Epoch: 6, Steps: 570 | Train Loss: 0.0925016 Vali Loss: 0.0345410 Test Loss: 0.1169708
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0780927
	speed: 0.0578s/iter; left time: 455.4917s
	iters: 200, epoch: 7 | loss: 0.1124896
	speed: 0.0201s/iter; left time: 156.3754s
	iters: 300, epoch: 7 | loss: 0.0596608
	speed: 0.0201s/iter; left time: 154.3685s
	iters: 400, epoch: 7 | loss: 0.1044410
	speed: 0.0203s/iter; left time: 154.0588s
	iters: 500, epoch: 7 | loss: 0.0788359
	speed: 0.0206s/iter; left time: 154.1953s
Epoch: 7 cost time: 11.935520887374878
Epoch: 7, Steps: 570 | Train Loss: 0.0886925 Vali Loss: 0.0339803 Test Loss: 0.1164838
Validation loss decreased (0.034341 --> 0.033980).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0700560
	speed: 0.0586s/iter; left time: 428.6341s
	iters: 200, epoch: 8 | loss: 0.0891792
	speed: 0.0183s/iter; left time: 132.2131s
	iters: 300, epoch: 8 | loss: 0.0794379
	speed: 0.0183s/iter; left time: 129.8353s
	iters: 400, epoch: 8 | loss: 0.0846472
	speed: 0.0183s/iter; left time: 128.3187s
	iters: 500, epoch: 8 | loss: 0.1003609
	speed: 0.0183s/iter; left time: 126.1492s
Epoch: 8 cost time: 10.77053689956665
Epoch: 8, Steps: 570 | Train Loss: 0.0865921 Vali Loss: 0.0339551 Test Loss: 0.1166554
Validation loss decreased (0.033980 --> 0.033955).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0524424
	speed: 0.0560s/iter; left time: 377.4951s
	iters: 200, epoch: 9 | loss: 0.0777009
	speed: 0.0183s/iter; left time: 121.4497s
	iters: 300, epoch: 9 | loss: 0.0828364
	speed: 0.0182s/iter; left time: 119.2764s
	iters: 400, epoch: 9 | loss: 0.0816082
	speed: 0.0183s/iter; left time: 117.5559s
	iters: 500, epoch: 9 | loss: 0.0778431
	speed: 0.0182s/iter; left time: 115.2711s
Epoch: 9 cost time: 10.75480055809021
Epoch: 9, Steps: 570 | Train Loss: 0.0863239 Vali Loss: 0.0340197 Test Loss: 0.1164078
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0703812
	speed: 0.0561s/iter; left time: 346.1502s
	iters: 200, epoch: 10 | loss: 0.0600727
	speed: 0.0183s/iter; left time: 111.0397s
	iters: 300, epoch: 10 | loss: 0.1222803
	speed: 0.0183s/iter; left time: 109.0325s
	iters: 400, epoch: 10 | loss: 0.0940767
	speed: 0.0183s/iter; left time: 107.1917s
	iters: 500, epoch: 10 | loss: 0.0836515
	speed: 0.0183s/iter; left time: 105.3606s
Epoch: 10 cost time: 10.703775882720947
Epoch: 10, Steps: 570 | Train Loss: 0.0867250 Vali Loss: 0.0338425 Test Loss: 0.1164990
Validation loss decreased (0.033955 --> 0.033843).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0886704
	speed: 0.0548s/iter; left time: 307.0764s
	iters: 200, epoch: 11 | loss: 0.0949598
	speed: 0.0182s/iter; left time: 100.2290s
	iters: 300, epoch: 11 | loss: 0.0609087
	speed: 0.0182s/iter; left time: 98.2393s
	iters: 400, epoch: 11 | loss: 0.1235714
	speed: 0.0181s/iter; left time: 95.9603s
	iters: 500, epoch: 11 | loss: 0.1064821
	speed: 0.0181s/iter; left time: 94.0461s
Epoch: 11 cost time: 10.615653038024902
Epoch: 11, Steps: 570 | Train Loss: 0.0859769 Vali Loss: 0.0337616 Test Loss: 0.1164080
Validation loss decreased (0.033843 --> 0.033762).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1195657
	speed: 0.0554s/iter; left time: 278.8327s
	iters: 200, epoch: 12 | loss: 0.0771970
	speed: 0.0183s/iter; left time: 90.3983s
	iters: 300, epoch: 12 | loss: 0.0692294
	speed: 0.0183s/iter; left time: 88.4228s
	iters: 400, epoch: 12 | loss: 0.0837279
	speed: 0.0183s/iter; left time: 86.6285s
	iters: 500, epoch: 12 | loss: 0.0855555
	speed: 0.0183s/iter; left time: 84.7565s
Epoch: 12 cost time: 10.755096435546875
Epoch: 12, Steps: 570 | Train Loss: 0.0858482 Vali Loss: 0.0338301 Test Loss: 0.1163966
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0759818
	speed: 0.0555s/iter; left time: 247.7515s
	iters: 200, epoch: 13 | loss: 0.0878199
	speed: 0.0182s/iter; left time: 79.4178s
	iters: 300, epoch: 13 | loss: 0.0670783
	speed: 0.0182s/iter; left time: 77.5186s
	iters: 400, epoch: 13 | loss: 0.1085088
	speed: 0.0182s/iter; left time: 75.9087s
	iters: 500, epoch: 13 | loss: 0.1070844
	speed: 0.0183s/iter; left time: 74.3236s
Epoch: 13 cost time: 10.710075855255127
Epoch: 13, Steps: 570 | Train Loss: 0.0867677 Vali Loss: 0.0338175 Test Loss: 0.1164519
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.0902542
	speed: 0.0566s/iter; left time: 220.4247s
	iters: 200, epoch: 14 | loss: 0.0839087
	speed: 0.0182s/iter; left time: 68.8691s
	iters: 300, epoch: 14 | loss: 0.0895629
	speed: 0.0182s/iter; left time: 67.1696s
	iters: 400, epoch: 14 | loss: 0.0804068
	speed: 0.0182s/iter; left time: 65.2275s
	iters: 500, epoch: 14 | loss: 0.0657523
	speed: 0.0182s/iter; left time: 63.5315s
Epoch: 14 cost time: 10.66966700553894
Epoch: 14, Steps: 570 | Train Loss: 0.0862531 Vali Loss: 0.0338502 Test Loss: 0.1164589
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11655744165182114, mae:0.20830540359020233
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2465455
	speed: 0.0326s/iter; left time: 368.4679s
	iters: 200, epoch: 1 | loss: 0.1742174
	speed: 0.0205s/iter; left time: 229.2769s
	iters: 300, epoch: 1 | loss: 0.2763492
	speed: 0.0205s/iter; left time: 227.9470s
	iters: 400, epoch: 1 | loss: 0.2178470
	speed: 0.0205s/iter; left time: 225.4617s
	iters: 500, epoch: 1 | loss: 0.2626901
	speed: 0.0205s/iter; left time: 223.0637s
Epoch: 1 cost time: 12.944639682769775
Epoch: 1, Steps: 570 | Train Loss: 0.2196197 Vali Loss: 0.0462815 Test Loss: 0.1330467
Validation loss decreased (inf --> 0.046282).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2293462
	speed: 0.0575s/iter; left time: 616.5602s
	iters: 200, epoch: 2 | loss: 0.1865129
	speed: 0.0183s/iter; left time: 194.1273s
	iters: 300, epoch: 2 | loss: 0.3665048
	speed: 0.0183s/iter; left time: 192.3267s
	iters: 400, epoch: 2 | loss: 0.1814012
	speed: 0.0182s/iter; left time: 190.2675s
	iters: 500, epoch: 2 | loss: 0.1074840
	speed: 0.0183s/iter; left time: 188.5660s
Epoch: 2 cost time: 10.730437994003296
Epoch: 2, Steps: 570 | Train Loss: 0.1843974 Vali Loss: 0.0468489 Test Loss: 0.1434171
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1040126
	speed: 0.0553s/iter; left time: 561.8836s
	iters: 200, epoch: 3 | loss: 0.1511192
	speed: 0.0183s/iter; left time: 184.1739s
	iters: 300, epoch: 3 | loss: 0.1757332
	speed: 0.0183s/iter; left time: 182.1727s
	iters: 400, epoch: 3 | loss: 0.1398604
	speed: 0.0183s/iter; left time: 180.2853s
	iters: 500, epoch: 3 | loss: 0.1326717
	speed: 0.0183s/iter; left time: 178.4930s
Epoch: 3 cost time: 10.707965850830078
Epoch: 3, Steps: 570 | Train Loss: 0.1427732 Vali Loss: 0.0422266 Test Loss: 0.1323110
Validation loss decreased (0.046282 --> 0.042227).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0990643
	speed: 0.0594s/iter; left time: 569.5374s
	iters: 200, epoch: 4 | loss: 0.1284356
	speed: 0.0210s/iter; left time: 199.7499s
	iters: 300, epoch: 4 | loss: 0.1189185
	speed: 0.0210s/iter; left time: 197.5868s
	iters: 400, epoch: 4 | loss: 0.1148597
	speed: 0.0210s/iter; left time: 195.4381s
	iters: 500, epoch: 4 | loss: 0.0875525
	speed: 0.0210s/iter; left time: 193.4475s
Epoch: 4 cost time: 12.279780387878418
Epoch: 4, Steps: 570 | Train Loss: 0.1152169 Vali Loss: 0.0403422 Test Loss: 0.1315215
Validation loss decreased (0.042227 --> 0.040342).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0930144
	speed: 0.0605s/iter; left time: 545.3261s
	iters: 200, epoch: 5 | loss: 0.1091283
	speed: 0.0211s/iter; left time: 187.8322s
	iters: 300, epoch: 5 | loss: 0.0675936
	speed: 0.0205s/iter; left time: 181.2205s
	iters: 400, epoch: 5 | loss: 0.0938081
	speed: 0.0205s/iter; left time: 178.8645s
	iters: 500, epoch: 5 | loss: 0.0558497
	speed: 0.0205s/iter; left time: 177.0765s
Epoch: 5 cost time: 12.120334386825562
Epoch: 5, Steps: 570 | Train Loss: 0.1007919 Vali Loss: 0.0410147 Test Loss: 0.1349144
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1119724
	speed: 0.0571s/iter; left time: 482.4909s
	iters: 200, epoch: 6 | loss: 0.0632188
	speed: 0.0184s/iter; left time: 153.5081s
	iters: 300, epoch: 6 | loss: 0.1177115
	speed: 0.0183s/iter; left time: 151.3013s
	iters: 400, epoch: 6 | loss: 0.0846691
	speed: 0.0184s/iter; left time: 149.5839s
	iters: 500, epoch: 6 | loss: 0.0950823
	speed: 0.0183s/iter; left time: 147.6371s
Epoch: 6 cost time: 10.737748384475708
Epoch: 6, Steps: 570 | Train Loss: 0.0944268 Vali Loss: 0.0401300 Test Loss: 0.1352709
Validation loss decreased (0.040342 --> 0.040130).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0799287
	speed: 0.0553s/iter; left time: 436.0057s
	iters: 200, epoch: 7 | loss: 0.0747626
	speed: 0.0182s/iter; left time: 141.9756s
	iters: 300, epoch: 7 | loss: 0.1034898
	speed: 0.0183s/iter; left time: 140.2060s
	iters: 400, epoch: 7 | loss: 0.0954349
	speed: 0.0182s/iter; left time: 138.0006s
	iters: 500, epoch: 7 | loss: 0.0578673
	speed: 0.0182s/iter; left time: 136.4238s
Epoch: 7 cost time: 10.665987730026245
Epoch: 7, Steps: 570 | Train Loss: 0.0923948 Vali Loss: 0.0397917 Test Loss: 0.1350439
Validation loss decreased (0.040130 --> 0.039792).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0772300
	speed: 0.0549s/iter; left time: 401.6541s
	iters: 200, epoch: 8 | loss: 0.0666272
	speed: 0.0182s/iter; left time: 131.5598s
	iters: 300, epoch: 8 | loss: 0.0906120
	speed: 0.0182s/iter; left time: 129.6600s
	iters: 400, epoch: 8 | loss: 0.1087127
	speed: 0.0182s/iter; left time: 127.7714s
	iters: 500, epoch: 8 | loss: 0.0791122
	speed: 0.0182s/iter; left time: 125.8702s
Epoch: 8 cost time: 10.6782808303833
Epoch: 8, Steps: 570 | Train Loss: 0.0900067 Vali Loss: 0.0397980 Test Loss: 0.1351777
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0902390
	speed: 0.0553s/iter; left time: 372.9460s
	iters: 200, epoch: 9 | loss: 0.1244761
	speed: 0.0182s/iter; left time: 121.0643s
	iters: 300, epoch: 9 | loss: 0.1000864
	speed: 0.0182s/iter; left time: 119.2494s
	iters: 400, epoch: 9 | loss: 0.1546550
	speed: 0.0182s/iter; left time: 117.4516s
	iters: 500, epoch: 9 | loss: 0.0599694
	speed: 0.0197s/iter; left time: 124.6313s
Epoch: 9 cost time: 10.979910135269165
Epoch: 9, Steps: 570 | Train Loss: 0.0894911 Vali Loss: 0.0397211 Test Loss: 0.1346833
Validation loss decreased (0.039792 --> 0.039721).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0847079
	speed: 0.0574s/iter; left time: 353.9544s
	iters: 200, epoch: 10 | loss: 0.0722764
	speed: 0.0182s/iter; left time: 110.6480s
	iters: 300, epoch: 10 | loss: 0.0958148
	speed: 0.0182s/iter; left time: 108.8058s
	iters: 400, epoch: 10 | loss: 0.0959902
	speed: 0.0182s/iter; left time: 107.0102s
	iters: 500, epoch: 10 | loss: 0.0901856
	speed: 0.0182s/iter; left time: 105.1598s
Epoch: 10 cost time: 10.683642148971558
Epoch: 10, Steps: 570 | Train Loss: 0.0890617 Vali Loss: 0.0394520 Test Loss: 0.1355194
Validation loss decreased (0.039721 --> 0.039452).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0883052
	speed: 0.0557s/iter; left time: 312.0704s
	iters: 200, epoch: 11 | loss: 0.0981652
	speed: 0.0182s/iter; left time: 100.1286s
	iters: 300, epoch: 11 | loss: 0.0668945
	speed: 0.0182s/iter; left time: 98.3439s
	iters: 400, epoch: 11 | loss: 0.1120059
	speed: 0.0182s/iter; left time: 96.5336s
	iters: 500, epoch: 11 | loss: 0.0745076
	speed: 0.0182s/iter; left time: 94.7069s
Epoch: 11 cost time: 10.654800176620483
Epoch: 11, Steps: 570 | Train Loss: 0.0892274 Vali Loss: 0.0395513 Test Loss: 0.1355649
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0855307
	speed: 0.0569s/iter; left time: 286.3790s
	iters: 200, epoch: 12 | loss: 0.1050664
	speed: 0.0183s/iter; left time: 90.1093s
	iters: 300, epoch: 12 | loss: 0.0800592
	speed: 0.0183s/iter; left time: 88.2083s
	iters: 400, epoch: 12 | loss: 0.0910716
	speed: 0.0183s/iter; left time: 86.3553s
	iters: 500, epoch: 12 | loss: 0.0960518
	speed: 0.0182s/iter; left time: 84.4977s
Epoch: 12 cost time: 10.6627357006073
Epoch: 12, Steps: 570 | Train Loss: 0.0887536 Vali Loss: 0.0395426 Test Loss: 0.1356473
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0758656
	speed: 0.0552s/iter; left time: 246.0907s
	iters: 200, epoch: 13 | loss: 0.0575939
	speed: 0.0183s/iter; left time: 79.8694s
	iters: 300, epoch: 13 | loss: 0.0811126
	speed: 0.0183s/iter; left time: 78.0446s
	iters: 400, epoch: 13 | loss: 0.0636982
	speed: 0.0183s/iter; left time: 76.1973s
	iters: 500, epoch: 13 | loss: 0.0718686
	speed: 0.0183s/iter; left time: 74.3373s
Epoch: 13 cost time: 10.700054168701172
Epoch: 13, Steps: 570 | Train Loss: 0.0880837 Vali Loss: 0.0396148 Test Loss: 0.1357707
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1356518715620041, mae:0.23420971632003784
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2044321
	speed: 0.0351s/iter; left time: 396.3600s
	iters: 200, epoch: 1 | loss: 0.1907370
	speed: 0.0235s/iter; left time: 262.7351s
	iters: 300, epoch: 1 | loss: 0.2209329
	speed: 0.0234s/iter; left time: 260.1607s
	iters: 400, epoch: 1 | loss: 0.3088663
	speed: 0.0234s/iter; left time: 257.9625s
	iters: 500, epoch: 1 | loss: 0.3752808
	speed: 0.0235s/iter; left time: 256.1545s
Epoch: 1 cost time: 14.595470428466797
Epoch: 1, Steps: 570 | Train Loss: 0.2527241 Vali Loss: 0.0623574 Test Loss: 0.1859929
Validation loss decreased (inf --> 0.062357).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3072649
	speed: 0.0680s/iter; left time: 729.8418s
	iters: 200, epoch: 2 | loss: 0.2502496
	speed: 0.0241s/iter; left time: 255.7045s
	iters: 300, epoch: 2 | loss: 0.1918114
	speed: 0.0223s/iter; left time: 234.7080s
	iters: 400, epoch: 2 | loss: 0.3376081
	speed: 0.0222s/iter; left time: 231.2941s
	iters: 500, epoch: 2 | loss: 0.2363885
	speed: 0.0221s/iter; left time: 228.7366s
Epoch: 2 cost time: 13.353620529174805
Epoch: 2, Steps: 570 | Train Loss: 0.2683277 Vali Loss: 0.0661320 Test Loss: 0.1890021
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4923572
	speed: 0.0646s/iter; left time: 656.4924s
	iters: 200, epoch: 3 | loss: 0.1829364
	speed: 0.0229s/iter; left time: 230.3467s
	iters: 300, epoch: 3 | loss: 0.2508573
	speed: 0.0222s/iter; left time: 220.8551s
	iters: 400, epoch: 3 | loss: 0.2537628
	speed: 0.0240s/iter; left time: 237.0696s
	iters: 500, epoch: 3 | loss: 0.1679934
	speed: 0.0241s/iter; left time: 234.8501s
Epoch: 3 cost time: 13.700138807296753
Epoch: 3, Steps: 570 | Train Loss: 0.2455218 Vali Loss: 0.0570564 Test Loss: 0.1525956
Validation loss decreased (0.062357 --> 0.057056).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1775687
	speed: 0.0679s/iter; left time: 650.9413s
	iters: 200, epoch: 4 | loss: 0.1459089
	speed: 0.0223s/iter; left time: 211.4759s
	iters: 300, epoch: 4 | loss: 0.2227755
	speed: 0.0222s/iter; left time: 208.6792s
	iters: 400, epoch: 4 | loss: 0.1869705
	speed: 0.0222s/iter; left time: 206.6815s
	iters: 500, epoch: 4 | loss: 0.2770719
	speed: 0.0222s/iter; left time: 204.2582s
Epoch: 4 cost time: 13.015325784683228
Epoch: 4, Steps: 570 | Train Loss: 0.2214344 Vali Loss: 0.0565339 Test Loss: 0.1514897
Validation loss decreased (0.057056 --> 0.056534).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2272343
	speed: 0.0679s/iter; left time: 612.2571s
	iters: 200, epoch: 5 | loss: 0.1697168
	speed: 0.0222s/iter; left time: 197.8636s
	iters: 300, epoch: 5 | loss: 0.1575013
	speed: 0.0221s/iter; left time: 195.3350s
	iters: 400, epoch: 5 | loss: 0.2007736
	speed: 0.0221s/iter; left time: 193.0461s
	iters: 500, epoch: 5 | loss: 0.2119050
	speed: 0.0222s/iter; left time: 191.2140s
Epoch: 5 cost time: 12.948059320449829
Epoch: 5, Steps: 570 | Train Loss: 0.2082672 Vali Loss: 0.0547199 Test Loss: 0.1453940
Validation loss decreased (0.056534 --> 0.054720).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1648124
	speed: 0.0636s/iter; left time: 537.8939s
	iters: 200, epoch: 6 | loss: 0.3070776
	speed: 0.0222s/iter; left time: 185.3955s
	iters: 300, epoch: 6 | loss: 0.1929084
	speed: 0.0222s/iter; left time: 182.9105s
	iters: 400, epoch: 6 | loss: 0.1536869
	speed: 0.0222s/iter; left time: 180.8464s
	iters: 500, epoch: 6 | loss: 0.2804589
	speed: 0.0222s/iter; left time: 178.4071s
Epoch: 6 cost time: 12.973344326019287
Epoch: 6, Steps: 570 | Train Loss: 0.2023327 Vali Loss: 0.0543583 Test Loss: 0.1462831
Validation loss decreased (0.054720 --> 0.054358).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2472715
	speed: 0.0646s/iter; left time: 509.2803s
	iters: 200, epoch: 7 | loss: 0.1912365
	speed: 0.0221s/iter; left time: 171.6663s
	iters: 300, epoch: 7 | loss: 0.1569330
	speed: 0.0220s/iter; left time: 168.9871s
	iters: 400, epoch: 7 | loss: 0.1843344
	speed: 0.0220s/iter; left time: 166.8118s
	iters: 500, epoch: 7 | loss: 0.2040082
	speed: 0.0220s/iter; left time: 164.9129s
Epoch: 7 cost time: 12.888179063796997
Epoch: 7, Steps: 570 | Train Loss: 0.1976341 Vali Loss: 0.0550024 Test Loss: 0.1458890
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1246326
	speed: 0.0637s/iter; left time: 465.5030s
	iters: 200, epoch: 8 | loss: 0.4012249
	speed: 0.0221s/iter; left time: 159.2290s
	iters: 300, epoch: 8 | loss: 0.1279386
	speed: 0.0221s/iter; left time: 157.0776s
	iters: 400, epoch: 8 | loss: 0.1646966
	speed: 0.0221s/iter; left time: 154.7708s
	iters: 500, epoch: 8 | loss: 0.1723369
	speed: 0.0221s/iter; left time: 152.4794s
Epoch: 8 cost time: 12.874224662780762
Epoch: 8, Steps: 570 | Train Loss: 0.1953455 Vali Loss: 0.0543657 Test Loss: 0.1452569
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1745945
	speed: 0.0621s/iter; left time: 418.5233s
	iters: 200, epoch: 9 | loss: 0.1344898
	speed: 0.0223s/iter; left time: 147.9939s
	iters: 300, epoch: 9 | loss: 0.2274153
	speed: 0.0223s/iter; left time: 145.6682s
	iters: 400, epoch: 9 | loss: 0.1888725
	speed: 0.0223s/iter; left time: 143.3633s
	iters: 500, epoch: 9 | loss: 0.1694360
	speed: 0.0223s/iter; left time: 141.1703s
Epoch: 9 cost time: 12.962656736373901
Epoch: 9, Steps: 570 | Train Loss: 0.1939532 Vali Loss: 0.0545372 Test Loss: 0.1449776
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14646118879318237, mae:0.24671439826488495
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2160419
	speed: 0.0334s/iter; left time: 377.2716s
	iters: 200, epoch: 1 | loss: 0.1162213
	speed: 0.0214s/iter; left time: 239.3620s
	iters: 300, epoch: 1 | loss: 0.1844167
	speed: 0.0214s/iter; left time: 237.3244s
	iters: 400, epoch: 1 | loss: 0.1534699
	speed: 0.0214s/iter; left time: 235.3872s
	iters: 500, epoch: 1 | loss: 0.1646366
	speed: 0.0214s/iter; left time: 233.2835s
Epoch: 1 cost time: 13.438807249069214
Epoch: 1, Steps: 570 | Train Loss: 0.2125935 Vali Loss: 0.0405905 Test Loss: 0.1299499
Validation loss decreased (inf --> 0.040591).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2203218
	speed: 0.0635s/iter; left time: 681.2834s
	iters: 200, epoch: 2 | loss: 0.2456415
	speed: 0.0213s/iter; left time: 226.2601s
	iters: 300, epoch: 2 | loss: 0.5099041
	speed: 0.0213s/iter; left time: 224.0897s
	iters: 400, epoch: 2 | loss: 0.2630272
	speed: 0.0213s/iter; left time: 221.9274s
	iters: 500, epoch: 2 | loss: 0.2143973
	speed: 0.0213s/iter; left time: 219.9411s
Epoch: 2 cost time: 12.452905416488647
Epoch: 2, Steps: 570 | Train Loss: 0.2649165 Vali Loss: 0.0637003 Test Loss: 0.1830065
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2386678
	speed: 0.0610s/iter; left time: 619.4159s
	iters: 200, epoch: 3 | loss: 0.2139221
	speed: 0.0213s/iter; left time: 214.0259s
	iters: 300, epoch: 3 | loss: 0.1634926
	speed: 0.0213s/iter; left time: 211.7607s
	iters: 400, epoch: 3 | loss: 0.1910556
	speed: 0.0213s/iter; left time: 209.8187s
	iters: 500, epoch: 3 | loss: 0.2340789
	speed: 0.0213s/iter; left time: 207.5382s
Epoch: 3 cost time: 12.428721189498901
Epoch: 3, Steps: 570 | Train Loss: 0.2446887 Vali Loss: 0.0576729 Test Loss: 0.1636531
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1887436
	speed: 0.0653s/iter; left time: 626.5549s
	iters: 200, epoch: 4 | loss: 0.2005028
	speed: 0.0213s/iter; left time: 201.7892s
	iters: 300, epoch: 4 | loss: 0.2122133
	speed: 0.0213s/iter; left time: 199.5749s
	iters: 400, epoch: 4 | loss: 0.2909198
	speed: 0.0212s/iter; left time: 197.3781s
	iters: 500, epoch: 4 | loss: 0.1725634
	speed: 0.0212s/iter; left time: 195.2769s
Epoch: 4 cost time: 12.389708518981934
Epoch: 4, Steps: 570 | Train Loss: 0.2258179 Vali Loss: 0.0539668 Test Loss: 0.1522814
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13016191124916077, mae:0.22739572823047638
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2422605
	speed: 0.0342s/iter; left time: 386.1397s
	iters: 200, epoch: 1 | loss: 0.1829510
	speed: 0.0221s/iter; left time: 247.4088s
	iters: 300, epoch: 1 | loss: 0.2373776
	speed: 0.0208s/iter; left time: 230.4634s
	iters: 400, epoch: 1 | loss: 0.3229593
	speed: 0.0200s/iter; left time: 220.3603s
	iters: 500, epoch: 1 | loss: 0.4051868
	speed: 0.0201s/iter; left time: 218.7473s
Epoch: 1 cost time: 13.250053882598877
Epoch: 1, Steps: 570 | Train Loss: 0.2792140 Vali Loss: 0.0759798 Test Loss: 0.2162345
Validation loss decreased (inf --> 0.075980).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2276985
	speed: 0.0609s/iter; left time: 653.5203s
	iters: 200, epoch: 2 | loss: 0.4476156
	speed: 0.0201s/iter; left time: 214.0455s
	iters: 300, epoch: 2 | loss: 0.2548041
	speed: 0.0201s/iter; left time: 211.6087s
	iters: 400, epoch: 2 | loss: 0.1816117
	speed: 0.0201s/iter; left time: 209.3931s
	iters: 500, epoch: 2 | loss: 0.1685787
	speed: 0.0201s/iter; left time: 207.2812s
Epoch: 2 cost time: 11.767088651657104
Epoch: 2, Steps: 570 | Train Loss: 0.2823152 Vali Loss: 0.0623125 Test Loss: 0.1725155
Validation loss decreased (0.075980 --> 0.062312).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1956048
	speed: 0.0635s/iter; left time: 645.3933s
	iters: 200, epoch: 3 | loss: 0.1986732
	speed: 0.0222s/iter; left time: 223.3168s
	iters: 300, epoch: 3 | loss: 0.2300066
	speed: 0.0222s/iter; left time: 221.1003s
	iters: 400, epoch: 3 | loss: 0.2127498
	speed: 0.0213s/iter; left time: 209.9440s
	iters: 500, epoch: 3 | loss: 0.2054931
	speed: 0.0230s/iter; left time: 224.0892s
Epoch: 3 cost time: 13.011893272399902
Epoch: 3, Steps: 570 | Train Loss: 0.2416417 Vali Loss: 0.0628371 Test Loss: 0.1696558
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1648703
	speed: 0.0653s/iter; left time: 626.5349s
	iters: 200, epoch: 4 | loss: 0.4601944
	speed: 0.0231s/iter; left time: 219.3850s
	iters: 300, epoch: 4 | loss: 0.1544110
	speed: 0.0231s/iter; left time: 216.8437s
	iters: 400, epoch: 4 | loss: 0.2180265
	speed: 0.0231s/iter; left time: 214.5748s
	iters: 500, epoch: 4 | loss: 0.1886454
	speed: 0.0231s/iter; left time: 212.2176s
Epoch: 4 cost time: 13.492231607437134
Epoch: 4, Steps: 570 | Train Loss: 0.2286725 Vali Loss: 0.0597612 Test Loss: 0.1620128
Validation loss decreased (0.062312 --> 0.059761).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1822467
	speed: 0.0664s/iter; left time: 598.7082s
	iters: 200, epoch: 5 | loss: 0.2959248
	speed: 0.0231s/iter; left time: 206.2911s
	iters: 300, epoch: 5 | loss: 0.1727977
	speed: 0.0231s/iter; left time: 204.0070s
	iters: 400, epoch: 5 | loss: 0.1904349
	speed: 0.0231s/iter; left time: 201.5835s
	iters: 500, epoch: 5 | loss: 0.2039821
	speed: 0.0231s/iter; left time: 199.2021s
Epoch: 5 cost time: 13.505336999893188
Epoch: 5, Steps: 570 | Train Loss: 0.2188623 Vali Loss: 0.0574483 Test Loss: 0.1568991
Validation loss decreased (0.059761 --> 0.057448).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2260060
	speed: 0.0651s/iter; left time: 549.9143s
	iters: 200, epoch: 6 | loss: 0.2270817
	speed: 0.0215s/iter; left time: 179.4801s
	iters: 300, epoch: 6 | loss: 0.2142158
	speed: 0.0200s/iter; left time: 164.8903s
	iters: 400, epoch: 6 | loss: 0.1900075
	speed: 0.0200s/iter; left time: 162.7933s
	iters: 500, epoch: 6 | loss: 0.2526564
	speed: 0.0200s/iter; left time: 160.7901s
Epoch: 6 cost time: 12.16146731376648
Epoch: 6, Steps: 570 | Train Loss: 0.2127382 Vali Loss: 0.0570407 Test Loss: 0.1548477
Validation loss decreased (0.057448 --> 0.057041).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1727831
	speed: 0.0600s/iter; left time: 472.9050s
	iters: 200, epoch: 7 | loss: 0.2374889
	speed: 0.0201s/iter; left time: 156.0978s
	iters: 300, epoch: 7 | loss: 0.2728970
	speed: 0.0201s/iter; left time: 154.0411s
	iters: 400, epoch: 7 | loss: 0.2354636
	speed: 0.0200s/iter; left time: 151.8934s
	iters: 500, epoch: 7 | loss: 0.1577698
	speed: 0.0200s/iter; left time: 149.9351s
Epoch: 7 cost time: 11.75057315826416
Epoch: 7, Steps: 570 | Train Loss: 0.2092387 Vali Loss: 0.0582214 Test Loss: 0.1559023
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2333621
	speed: 0.0586s/iter; left time: 428.7831s
	iters: 200, epoch: 8 | loss: 0.3190812
	speed: 0.0200s/iter; left time: 144.1964s
	iters: 300, epoch: 8 | loss: 0.2758017
	speed: 0.0200s/iter; left time: 142.2776s
	iters: 400, epoch: 8 | loss: 0.1584807
	speed: 0.0200s/iter; left time: 140.2715s
	iters: 500, epoch: 8 | loss: 0.2110446
	speed: 0.0200s/iter; left time: 138.2698s
Epoch: 8 cost time: 11.691559791564941
Epoch: 8, Steps: 570 | Train Loss: 0.2084264 Vali Loss: 0.0572500 Test Loss: 0.1541620
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1923905
	speed: 0.0582s/iter; left time: 392.1285s
	iters: 200, epoch: 9 | loss: 0.1711386
	speed: 0.0200s/iter; left time: 132.7664s
	iters: 300, epoch: 9 | loss: 0.2769994
	speed: 0.0200s/iter; left time: 130.7975s
	iters: 400, epoch: 9 | loss: 0.1681122
	speed: 0.0200s/iter; left time: 128.7135s
	iters: 500, epoch: 9 | loss: 0.1237359
	speed: 0.0200s/iter; left time: 126.7180s
Epoch: 9 cost time: 11.685113191604614
Epoch: 9, Steps: 570 | Train Loss: 0.2062991 Vali Loss: 0.0573906 Test Loss: 0.1547263
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1550510972738266, mae:0.25246042013168335
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1968861
	speed: 0.0220s/iter; left time: 248.6442s
	iters: 200, epoch: 1 | loss: 0.2074055
	speed: 0.0104s/iter; left time: 116.4362s
	iters: 300, epoch: 1 | loss: 0.2668394
	speed: 0.0104s/iter; left time: 115.6557s
	iters: 400, epoch: 1 | loss: 0.2510618
	speed: 0.0104s/iter; left time: 114.3724s
	iters: 500, epoch: 1 | loss: 0.1887305
	speed: 0.0104s/iter; left time: 113.4432s
Epoch: 1 cost time: 7.139196157455444
Epoch: 1, Steps: 570 | Train Loss: 0.2436748 Vali Loss: 0.0457816 Test Loss: 0.1451397
Validation loss decreased (inf --> 0.045782).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3275155
	speed: 0.0367s/iter; left time: 394.3263s
	iters: 200, epoch: 2 | loss: 0.1967727
	speed: 0.0105s/iter; left time: 111.4504s
	iters: 300, epoch: 2 | loss: 0.1991920
	speed: 0.0104s/iter; left time: 109.9714s
	iters: 400, epoch: 2 | loss: 0.1718873
	speed: 0.0105s/iter; left time: 109.3439s
	iters: 500, epoch: 2 | loss: 0.2023968
	speed: 0.0104s/iter; left time: 107.8413s
Epoch: 2 cost time: 6.264881372451782
Epoch: 2, Steps: 570 | Train Loss: 0.2031243 Vali Loss: 0.0430505 Test Loss: 0.1352728
Validation loss decreased (0.045782 --> 0.043050).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1456728
	speed: 0.0373s/iter; left time: 378.5472s
	iters: 200, epoch: 3 | loss: 0.2073755
	speed: 0.0105s/iter; left time: 105.8082s
	iters: 300, epoch: 3 | loss: 0.1619648
	speed: 0.0105s/iter; left time: 104.5371s
	iters: 400, epoch: 3 | loss: 0.1799439
	speed: 0.0105s/iter; left time: 103.3451s
	iters: 500, epoch: 3 | loss: 0.2282066
	speed: 0.0105s/iter; left time: 102.1840s
Epoch: 3 cost time: 6.277078151702881
Epoch: 3, Steps: 570 | Train Loss: 0.1790444 Vali Loss: 0.0378854 Test Loss: 0.1217924
Validation loss decreased (0.043050 --> 0.037885).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1916265
	speed: 0.0364s/iter; left time: 349.0827s
	iters: 200, epoch: 4 | loss: 0.0987980
	speed: 0.0105s/iter; left time: 99.2243s
	iters: 300, epoch: 4 | loss: 0.1622420
	speed: 0.0105s/iter; left time: 98.4214s
	iters: 400, epoch: 4 | loss: 0.1659676
	speed: 0.0105s/iter; left time: 97.2350s
	iters: 500, epoch: 4 | loss: 0.1543243
	speed: 0.0104s/iter; left time: 95.9147s
Epoch: 4 cost time: 6.255189657211304
Epoch: 4, Steps: 570 | Train Loss: 0.1644141 Vali Loss: 0.0373587 Test Loss: 0.1246603
Validation loss decreased (0.037885 --> 0.037359).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1373155
	speed: 0.0367s/iter; left time: 331.0457s
	iters: 200, epoch: 5 | loss: 0.1544386
	speed: 0.0105s/iter; left time: 93.6975s
	iters: 300, epoch: 5 | loss: 0.1008306
	speed: 0.0105s/iter; left time: 92.4322s
	iters: 400, epoch: 5 | loss: 0.1563086
	speed: 0.0105s/iter; left time: 91.8086s
	iters: 500, epoch: 5 | loss: 0.1853543
	speed: 0.0105s/iter; left time: 90.6076s
Epoch: 5 cost time: 6.301286220550537
Epoch: 5, Steps: 570 | Train Loss: 0.1551671 Vali Loss: 0.0357990 Test Loss: 0.1252222
Validation loss decreased (0.037359 --> 0.035799).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1380461
	speed: 0.0366s/iter; left time: 309.5365s
	iters: 200, epoch: 6 | loss: 0.1179587
	speed: 0.0105s/iter; left time: 87.4125s
	iters: 300, epoch: 6 | loss: 0.1492406
	speed: 0.0105s/iter; left time: 86.3636s
	iters: 400, epoch: 6 | loss: 0.1771906
	speed: 0.0104s/iter; left time: 84.9770s
	iters: 500, epoch: 6 | loss: 0.1527208
	speed: 0.0104s/iter; left time: 84.1017s
Epoch: 6 cost time: 6.266862154006958
Epoch: 6, Steps: 570 | Train Loss: 0.1508814 Vali Loss: 0.0361586 Test Loss: 0.1267179
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1690600
	speed: 0.0361s/iter; left time: 284.5939s
	iters: 200, epoch: 7 | loss: 0.2181375
	speed: 0.0104s/iter; left time: 81.1958s
	iters: 300, epoch: 7 | loss: 0.1134887
	speed: 0.0105s/iter; left time: 80.3908s
	iters: 400, epoch: 7 | loss: 0.1205991
	speed: 0.0105s/iter; left time: 79.5613s
	iters: 500, epoch: 7 | loss: 0.1330346
	speed: 0.0105s/iter; left time: 78.3963s
Epoch: 7 cost time: 6.2279441356658936
Epoch: 7, Steps: 570 | Train Loss: 0.1488097 Vali Loss: 0.0360066 Test Loss: 0.1266913
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1359771
	speed: 0.0359s/iter; left time: 262.3075s
	iters: 200, epoch: 8 | loss: 0.1457441
	speed: 0.0104s/iter; left time: 74.8312s
	iters: 300, epoch: 8 | loss: 0.1882059
	speed: 0.0104s/iter; left time: 74.1547s
	iters: 400, epoch: 8 | loss: 0.2122235
	speed: 0.0104s/iter; left time: 73.1073s
	iters: 500, epoch: 8 | loss: 0.0939350
	speed: 0.0104s/iter; left time: 72.2057s
Epoch: 8 cost time: 6.21821928024292
Epoch: 8, Steps: 570 | Train Loss: 0.1469399 Vali Loss: 0.0357397 Test Loss: 0.1275342
Validation loss decreased (0.035799 --> 0.035740).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2393412
	speed: 0.0362s/iter; left time: 243.8935s
	iters: 200, epoch: 9 | loss: 0.1287752
	speed: 0.0105s/iter; left time: 69.8832s
	iters: 300, epoch: 9 | loss: 0.0813232
	speed: 0.0105s/iter; left time: 68.9384s
	iters: 400, epoch: 9 | loss: 0.1237925
	speed: 0.0105s/iter; left time: 67.9483s
	iters: 500, epoch: 9 | loss: 0.1202961
	speed: 0.0105s/iter; left time: 66.7545s
Epoch: 9 cost time: 6.273076772689819
Epoch: 9, Steps: 570 | Train Loss: 0.1460428 Vali Loss: 0.0362367 Test Loss: 0.1276402
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1430824
	speed: 0.0357s/iter; left time: 220.4056s
	iters: 200, epoch: 10 | loss: 0.1595148
	speed: 0.0104s/iter; left time: 63.2166s
	iters: 300, epoch: 10 | loss: 0.1019429
	speed: 0.0104s/iter; left time: 62.3782s
	iters: 400, epoch: 10 | loss: 0.1213916
	speed: 0.0104s/iter; left time: 61.3275s
	iters: 500, epoch: 10 | loss: 0.2282617
	speed: 0.0104s/iter; left time: 60.1035s
Epoch: 10 cost time: 6.216574192047119
Epoch: 10, Steps: 570 | Train Loss: 0.1460244 Vali Loss: 0.0359605 Test Loss: 0.1277746
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1593354
	speed: 0.0359s/iter; left time: 200.9906s
	iters: 200, epoch: 11 | loss: 0.1470495
	speed: 0.0105s/iter; left time: 57.8994s
	iters: 300, epoch: 11 | loss: 0.1202945
	speed: 0.0105s/iter; left time: 56.8529s
	iters: 400, epoch: 11 | loss: 0.2002390
	speed: 0.0105s/iter; left time: 55.8429s
	iters: 500, epoch: 11 | loss: 0.1476796
	speed: 0.0105s/iter; left time: 54.7325s
Epoch: 11 cost time: 6.274201393127441
Epoch: 11, Steps: 570 | Train Loss: 0.1469775 Vali Loss: 0.0358628 Test Loss: 0.1277538
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1277076005935669, mae:0.22084355354309082
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2401721
	speed: 0.0222s/iter; left time: 250.9339s
	iters: 200, epoch: 1 | loss: 0.2424997
	speed: 0.0102s/iter; left time: 114.7494s
	iters: 300, epoch: 1 | loss: 0.3234658
	speed: 0.0102s/iter; left time: 113.5263s
	iters: 400, epoch: 1 | loss: 0.1961393
	speed: 0.0104s/iter; left time: 113.8627s
	iters: 500, epoch: 1 | loss: 0.1873902
	speed: 0.0104s/iter; left time: 112.9115s
Epoch: 1 cost time: 7.111665725708008
Epoch: 1, Steps: 570 | Train Loss: 0.2151568 Vali Loss: 0.0361725 Test Loss: 0.1191960
Validation loss decreased (inf --> 0.036173).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1610263
	speed: 0.0375s/iter; left time: 402.3924s
	iters: 200, epoch: 2 | loss: 0.2114646
	speed: 0.0103s/iter; left time: 109.7171s
	iters: 300, epoch: 2 | loss: 0.1568907
	speed: 0.0103s/iter; left time: 108.8679s
	iters: 400, epoch: 2 | loss: 0.1601709
	speed: 0.0103s/iter; left time: 107.5710s
	iters: 500, epoch: 2 | loss: 0.1835256
	speed: 0.0103s/iter; left time: 106.5332s
Epoch: 2 cost time: 6.191450119018555
Epoch: 2, Steps: 570 | Train Loss: 0.1871854 Vali Loss: 0.0372932 Test Loss: 0.1156548
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0921855
	speed: 0.0376s/iter; left time: 382.5584s
	iters: 200, epoch: 3 | loss: 0.1439721
	speed: 0.0103s/iter; left time: 103.4726s
	iters: 300, epoch: 3 | loss: 0.2918147
	speed: 0.0103s/iter; left time: 102.4046s
	iters: 400, epoch: 3 | loss: 0.1909704
	speed: 0.0102s/iter; left time: 100.9514s
	iters: 500, epoch: 3 | loss: 0.1056564
	speed: 0.0102s/iter; left time: 99.9389s
Epoch: 3 cost time: 6.168665409088135
Epoch: 3, Steps: 570 | Train Loss: 0.1657281 Vali Loss: 0.0321570 Test Loss: 0.1056891
Validation loss decreased (0.036173 --> 0.032157).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1245359
	speed: 0.0369s/iter; left time: 353.6536s
	iters: 200, epoch: 4 | loss: 0.1304310
	speed: 0.0103s/iter; left time: 97.9310s
	iters: 300, epoch: 4 | loss: 0.0928682
	speed: 0.0103s/iter; left time: 96.7324s
	iters: 400, epoch: 4 | loss: 0.1208657
	speed: 0.0103s/iter; left time: 96.1318s
	iters: 500, epoch: 4 | loss: 0.1988564
	speed: 0.0103s/iter; left time: 95.0536s
Epoch: 4 cost time: 6.179898977279663
Epoch: 4, Steps: 570 | Train Loss: 0.1537255 Vali Loss: 0.0323878 Test Loss: 0.1043980
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1135346
	speed: 0.0377s/iter; left time: 340.5209s
	iters: 200, epoch: 5 | loss: 0.1933572
	speed: 0.0102s/iter; left time: 90.7927s
	iters: 300, epoch: 5 | loss: 0.1349498
	speed: 0.0102s/iter; left time: 90.0604s
	iters: 400, epoch: 5 | loss: 0.1440819
	speed: 0.0102s/iter; left time: 89.0702s
	iters: 500, epoch: 5 | loss: 0.1472165
	speed: 0.0102s/iter; left time: 87.8494s
Epoch: 5 cost time: 6.0816144943237305
Epoch: 5, Steps: 570 | Train Loss: 0.1476107 Vali Loss: 0.0316899 Test Loss: 0.1041419
Validation loss decreased (0.032157 --> 0.031690).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1084595
	speed: 0.0377s/iter; left time: 318.6251s
	iters: 200, epoch: 6 | loss: 0.1837830
	speed: 0.0103s/iter; left time: 86.1645s
	iters: 300, epoch: 6 | loss: 0.1503467
	speed: 0.0103s/iter; left time: 84.8464s
	iters: 400, epoch: 6 | loss: 0.1284380
	speed: 0.0103s/iter; left time: 84.0316s
	iters: 500, epoch: 6 | loss: 0.1001743
	speed: 0.0103s/iter; left time: 83.0424s
Epoch: 6 cost time: 6.173323154449463
Epoch: 6, Steps: 570 | Train Loss: 0.1432669 Vali Loss: 0.0317257 Test Loss: 0.1050080
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1394527
	speed: 0.0358s/iter; left time: 282.4948s
	iters: 200, epoch: 7 | loss: 0.1708174
	speed: 0.0103s/iter; left time: 79.9726s
	iters: 300, epoch: 7 | loss: 0.2254554
	speed: 0.0103s/iter; left time: 78.7379s
	iters: 400, epoch: 7 | loss: 0.1847659
	speed: 0.0102s/iter; left time: 77.6779s
	iters: 500, epoch: 7 | loss: 0.1539829
	speed: 0.0103s/iter; left time: 76.7163s
Epoch: 7 cost time: 6.109286785125732
Epoch: 7, Steps: 570 | Train Loss: 0.1421129 Vali Loss: 0.0313872 Test Loss: 0.1043943
Validation loss decreased (0.031690 --> 0.031387).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1260215
	speed: 0.0360s/iter; left time: 262.8820s
	iters: 200, epoch: 8 | loss: 0.0947148
	speed: 0.0102s/iter; left time: 73.6803s
	iters: 300, epoch: 8 | loss: 0.1159244
	speed: 0.0102s/iter; left time: 72.6632s
	iters: 400, epoch: 8 | loss: 0.1393307
	speed: 0.0102s/iter; left time: 71.5623s
	iters: 500, epoch: 8 | loss: 0.0789673
	speed: 0.0102s/iter; left time: 70.5412s
Epoch: 8 cost time: 6.099022388458252
Epoch: 8, Steps: 570 | Train Loss: 0.1416707 Vali Loss: 0.0313756 Test Loss: 0.1045958
Validation loss decreased (0.031387 --> 0.031376).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1174904
	speed: 0.0370s/iter; left time: 249.7343s
	iters: 200, epoch: 9 | loss: 0.1468606
	speed: 0.0103s/iter; left time: 68.3706s
	iters: 300, epoch: 9 | loss: 0.1139230
	speed: 0.0103s/iter; left time: 67.2973s
	iters: 400, epoch: 9 | loss: 0.1485003
	speed: 0.0103s/iter; left time: 66.1347s
	iters: 500, epoch: 9 | loss: 0.1246711
	speed: 0.0103s/iter; left time: 65.1528s
Epoch: 9 cost time: 6.183746576309204
Epoch: 9, Steps: 570 | Train Loss: 0.1395523 Vali Loss: 0.0313584 Test Loss: 0.1043669
Validation loss decreased (0.031376 --> 0.031358).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1400148
	speed: 0.0373s/iter; left time: 230.0236s
	iters: 200, epoch: 10 | loss: 0.1162626
	speed: 0.0103s/iter; left time: 62.3444s
	iters: 300, epoch: 10 | loss: 0.1198061
	speed: 0.0103s/iter; left time: 61.3171s
	iters: 400, epoch: 10 | loss: 0.1005436
	speed: 0.0103s/iter; left time: 60.3748s
	iters: 500, epoch: 10 | loss: 0.1011312
	speed: 0.0103s/iter; left time: 59.3672s
Epoch: 10 cost time: 6.18208646774292
Epoch: 10, Steps: 570 | Train Loss: 0.1411722 Vali Loss: 0.0313830 Test Loss: 0.1042795
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1380363
	speed: 0.0381s/iter; left time: 213.4410s
	iters: 200, epoch: 11 | loss: 0.1670581
	speed: 0.0115s/iter; left time: 63.2654s
	iters: 300, epoch: 11 | loss: 0.1588926
	speed: 0.0115s/iter; left time: 62.1442s
	iters: 400, epoch: 11 | loss: 0.1483600
	speed: 0.0115s/iter; left time: 60.9803s
	iters: 500, epoch: 11 | loss: 0.1227315
	speed: 0.0115s/iter; left time: 59.8063s
Epoch: 11 cost time: 6.826860189437866
Epoch: 11, Steps: 570 | Train Loss: 0.1392189 Vali Loss: 0.0312490 Test Loss: 0.1042706
Validation loss decreased (0.031358 --> 0.031249).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1175639
	speed: 0.0372s/iter; left time: 187.1549s
	iters: 200, epoch: 12 | loss: 0.1478161
	speed: 0.0103s/iter; left time: 50.7960s
	iters: 300, epoch: 12 | loss: 0.1135787
	speed: 0.0103s/iter; left time: 49.7659s
	iters: 400, epoch: 12 | loss: 0.1800499
	speed: 0.0103s/iter; left time: 48.7404s
	iters: 500, epoch: 12 | loss: 0.1252864
	speed: 0.0103s/iter; left time: 47.7032s
Epoch: 12 cost time: 6.177725315093994
Epoch: 12, Steps: 570 | Train Loss: 0.1398091 Vali Loss: 0.0313090 Test Loss: 0.1042849
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2295697
	speed: 0.0386s/iter; left time: 172.3644s
	iters: 200, epoch: 13 | loss: 0.1836542
	speed: 0.0103s/iter; left time: 44.8757s
	iters: 300, epoch: 13 | loss: 0.1145843
	speed: 0.0103s/iter; left time: 43.8102s
	iters: 400, epoch: 13 | loss: 0.1641874
	speed: 0.0103s/iter; left time: 42.7934s
	iters: 500, epoch: 13 | loss: 0.1717600
	speed: 0.0103s/iter; left time: 41.7468s
Epoch: 13 cost time: 6.339035272598267
Epoch: 13, Steps: 570 | Train Loss: 0.1398790 Vali Loss: 0.0312312 Test Loss: 0.1042820
Validation loss decreased (0.031249 --> 0.031231).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1311188
	speed: 0.0373s/iter; left time: 145.2934s
	iters: 200, epoch: 14 | loss: 0.1039703
	speed: 0.0115s/iter; left time: 43.6807s
	iters: 300, epoch: 14 | loss: 0.1311249
	speed: 0.0115s/iter; left time: 42.4972s
	iters: 400, epoch: 14 | loss: 0.1338442
	speed: 0.0115s/iter; left time: 41.3874s
	iters: 500, epoch: 14 | loss: 0.1419042
	speed: 0.0113s/iter; left time: 39.5983s
Epoch: 14 cost time: 6.7413740158081055
Epoch: 14, Steps: 570 | Train Loss: 0.1398163 Vali Loss: 0.0312761 Test Loss: 0.1042791
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.0882273
	speed: 0.0363s/iter; left time: 120.4990s
	iters: 200, epoch: 15 | loss: 0.1478414
	speed: 0.0115s/iter; left time: 37.0665s
	iters: 300, epoch: 15 | loss: 0.1274982
	speed: 0.0115s/iter; left time: 35.8818s
	iters: 400, epoch: 15 | loss: 0.1245105
	speed: 0.0115s/iter; left time: 34.7536s
	iters: 500, epoch: 15 | loss: 0.1308725
	speed: 0.0115s/iter; left time: 33.5911s
Epoch: 15 cost time: 6.722913980484009
Epoch: 15, Steps: 570 | Train Loss: 0.1395391 Vali Loss: 0.0312022 Test Loss: 0.1042811
Validation loss decreased (0.031231 --> 0.031202).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.2173437
	speed: 0.0366s/iter; left time: 100.7277s
	iters: 200, epoch: 16 | loss: 0.1206843
	speed: 0.0103s/iter; left time: 27.2208s
	iters: 300, epoch: 16 | loss: 0.1893770
	speed: 0.0103s/iter; left time: 26.2214s
	iters: 400, epoch: 16 | loss: 0.1291029
	speed: 0.0103s/iter; left time: 25.2024s
	iters: 500, epoch: 16 | loss: 0.2286672
	speed: 0.0103s/iter; left time: 24.1903s
Epoch: 16 cost time: 6.146344900131226
Epoch: 16, Steps: 570 | Train Loss: 0.1400929 Vali Loss: 0.0311803 Test Loss: 0.1042822
Validation loss decreased (0.031202 --> 0.031180).  Saving model ...
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1043478
	speed: 0.0377s/iter; left time: 82.2921s
	iters: 200, epoch: 17 | loss: 0.1241303
	speed: 0.0103s/iter; left time: 21.4295s
	iters: 300, epoch: 17 | loss: 0.1408147
	speed: 0.0103s/iter; left time: 20.3696s
	iters: 400, epoch: 17 | loss: 0.1139410
	speed: 0.0103s/iter; left time: 19.3410s
	iters: 500, epoch: 17 | loss: 0.0959115
	speed: 0.0103s/iter; left time: 18.3677s
Epoch: 17 cost time: 6.185192346572876
Epoch: 17, Steps: 570 | Train Loss: 0.1397438 Vali Loss: 0.0313544 Test Loss: 0.1042828
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1547170
	speed: 0.0372s/iter; left time: 59.9610s
	iters: 200, epoch: 18 | loss: 0.1407096
	speed: 0.0102s/iter; left time: 15.4362s
	iters: 300, epoch: 18 | loss: 0.1202417
	speed: 0.0102s/iter; left time: 14.3901s
	iters: 400, epoch: 18 | loss: 0.2134871
	speed: 0.0102s/iter; left time: 13.4085s
	iters: 500, epoch: 18 | loss: 0.1240891
	speed: 0.0102s/iter; left time: 12.3694s
Epoch: 18 cost time: 6.133153438568115
Epoch: 18, Steps: 570 | Train Loss: 0.1396246 Vali Loss: 0.0312675 Test Loss: 0.1042829
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.814697265625e-09
	iters: 100, epoch: 19 | loss: 0.1086819
	speed: 0.0368s/iter; left time: 38.3038s
	iters: 200, epoch: 19 | loss: 0.1497446
	speed: 0.0103s/iter; left time: 9.6512s
	iters: 300, epoch: 19 | loss: 0.1158870
	speed: 0.0103s/iter; left time: 8.6439s
	iters: 400, epoch: 19 | loss: 0.1645359
	speed: 0.0103s/iter; left time: 7.6160s
	iters: 500, epoch: 19 | loss: 0.1304467
	speed: 0.0103s/iter; left time: 6.5916s
Epoch: 19 cost time: 6.174314498901367
Epoch: 19, Steps: 570 | Train Loss: 0.1395322 Vali Loss: 0.0313423 Test Loss: 0.1042826
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1044272854924202, mae:0.19677524268627167
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2458244
	speed: 0.0234s/iter; left time: 264.5711s
	iters: 200, epoch: 1 | loss: 0.1580599
	speed: 0.0116s/iter; left time: 129.8436s
	iters: 300, epoch: 1 | loss: 0.1607421
	speed: 0.0116s/iter; left time: 128.4187s
	iters: 400, epoch: 1 | loss: 0.1947172
	speed: 0.0116s/iter; left time: 127.3042s
	iters: 500, epoch: 1 | loss: 0.2462651
	speed: 0.0104s/iter; left time: 113.1814s
Epoch: 1 cost time: 7.621551513671875
Epoch: 1, Steps: 570 | Train Loss: 0.2496192 Vali Loss: 0.0448467 Test Loss: 0.1367395
Validation loss decreased (inf --> 0.044847).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2090575
	speed: 0.0369s/iter; left time: 396.5018s
	iters: 200, epoch: 2 | loss: 0.2855562
	speed: 0.0103s/iter; left time: 109.4078s
	iters: 300, epoch: 2 | loss: 0.1796440
	speed: 0.0103s/iter; left time: 108.6123s
	iters: 400, epoch: 2 | loss: 0.3255115
	speed: 0.0103s/iter; left time: 107.5033s
	iters: 500, epoch: 2 | loss: 0.2540377
	speed: 0.0103s/iter; left time: 106.5572s
Epoch: 2 cost time: 6.188753128051758
Epoch: 2, Steps: 570 | Train Loss: 0.2090411 Vali Loss: 0.0425315 Test Loss: 0.1379918
Validation loss decreased (0.044847 --> 0.042531).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1236370
	speed: 0.0360s/iter; left time: 365.7224s
	iters: 200, epoch: 3 | loss: 0.1724854
	speed: 0.0104s/iter; left time: 104.1735s
	iters: 300, epoch: 3 | loss: 0.2191168
	speed: 0.0103s/iter; left time: 102.9300s
	iters: 400, epoch: 3 | loss: 0.1433497
	speed: 0.0103s/iter; left time: 101.8978s
	iters: 500, epoch: 3 | loss: 0.1347058
	speed: 0.0104s/iter; left time: 101.1216s
Epoch: 3 cost time: 6.207587242126465
Epoch: 3, Steps: 570 | Train Loss: 0.1822572 Vali Loss: 0.0381314 Test Loss: 0.1287609
Validation loss decreased (0.042531 --> 0.038131).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0993757
	speed: 0.0376s/iter; left time: 360.9101s
	iters: 200, epoch: 4 | loss: 0.1030221
	speed: 0.0116s/iter; left time: 110.1914s
	iters: 300, epoch: 4 | loss: 0.1255772
	speed: 0.0116s/iter; left time: 109.3039s
	iters: 400, epoch: 4 | loss: 0.1874091
	speed: 0.0110s/iter; left time: 102.1351s
	iters: 500, epoch: 4 | loss: 0.1362787
	speed: 0.0103s/iter; left time: 94.9677s
Epoch: 4 cost time: 6.634077548980713
Epoch: 4, Steps: 570 | Train Loss: 0.1654112 Vali Loss: 0.0390523 Test Loss: 0.1291916
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1629340
	speed: 0.0373s/iter; left time: 336.8116s
	iters: 200, epoch: 5 | loss: 0.1039051
	speed: 0.0103s/iter; left time: 91.5099s
	iters: 300, epoch: 5 | loss: 0.1660782
	speed: 0.0103s/iter; left time: 90.7682s
	iters: 400, epoch: 5 | loss: 0.1498400
	speed: 0.0103s/iter; left time: 89.9875s
	iters: 500, epoch: 5 | loss: 0.2172457
	speed: 0.0103s/iter; left time: 88.8171s
Epoch: 5 cost time: 6.178137302398682
Epoch: 5, Steps: 570 | Train Loss: 0.1577477 Vali Loss: 0.0375868 Test Loss: 0.1292249
Validation loss decreased (0.038131 --> 0.037587).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1206211
	speed: 0.0366s/iter; left time: 309.0165s
	iters: 200, epoch: 6 | loss: 0.1372995
	speed: 0.0103s/iter; left time: 85.9285s
	iters: 300, epoch: 6 | loss: 0.1432529
	speed: 0.0103s/iter; left time: 84.8213s
	iters: 400, epoch: 6 | loss: 0.1195650
	speed: 0.0103s/iter; left time: 83.5553s
	iters: 500, epoch: 6 | loss: 0.1516001
	speed: 0.0102s/iter; left time: 82.4709s
Epoch: 6 cost time: 6.145037651062012
Epoch: 6, Steps: 570 | Train Loss: 0.1522886 Vali Loss: 0.0371695 Test Loss: 0.1265572
Validation loss decreased (0.037587 --> 0.037169).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1134902
	speed: 0.0370s/iter; left time: 291.3178s
	iters: 200, epoch: 7 | loss: 0.1240653
	speed: 0.0103s/iter; left time: 80.2969s
	iters: 300, epoch: 7 | loss: 0.1308912
	speed: 0.0103s/iter; left time: 79.4308s
	iters: 400, epoch: 7 | loss: 0.1020128
	speed: 0.0103s/iter; left time: 78.3971s
	iters: 500, epoch: 7 | loss: 0.1568721
	speed: 0.0103s/iter; left time: 77.3759s
Epoch: 7 cost time: 6.2012505531311035
Epoch: 7, Steps: 570 | Train Loss: 0.1493799 Vali Loss: 0.0368687 Test Loss: 0.1266420
Validation loss decreased (0.037169 --> 0.036869).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1191704
	speed: 0.0368s/iter; left time: 269.3812s
	iters: 200, epoch: 8 | loss: 0.1438675
	speed: 0.0104s/iter; left time: 74.8224s
	iters: 300, epoch: 8 | loss: 0.1819857
	speed: 0.0103s/iter; left time: 73.4478s
	iters: 400, epoch: 8 | loss: 0.1481585
	speed: 0.0103s/iter; left time: 72.3627s
	iters: 500, epoch: 8 | loss: 0.1317616
	speed: 0.0103s/iter; left time: 71.3211s
Epoch: 8 cost time: 6.296011447906494
Epoch: 8, Steps: 570 | Train Loss: 0.1479293 Vali Loss: 0.0369548 Test Loss: 0.1264471
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1167659
	speed: 0.0357s/iter; left time: 240.8677s
	iters: 200, epoch: 9 | loss: 0.1701135
	speed: 0.0102s/iter; left time: 67.8566s
	iters: 300, epoch: 9 | loss: 0.1141123
	speed: 0.0102s/iter; left time: 66.8312s
	iters: 400, epoch: 9 | loss: 0.1052207
	speed: 0.0102s/iter; left time: 65.8699s
	iters: 500, epoch: 9 | loss: 0.1552950
	speed: 0.0102s/iter; left time: 64.8239s
Epoch: 9 cost time: 6.0986902713775635
Epoch: 9, Steps: 570 | Train Loss: 0.1471686 Vali Loss: 0.0371080 Test Loss: 0.1267642
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1323274
	speed: 0.0351s/iter; left time: 216.7596s
	iters: 200, epoch: 10 | loss: 0.2113402
	speed: 0.0102s/iter; left time: 62.1104s
	iters: 300, epoch: 10 | loss: 0.2047139
	speed: 0.0102s/iter; left time: 61.2013s
	iters: 400, epoch: 10 | loss: 0.1622301
	speed: 0.0102s/iter; left time: 60.0442s
	iters: 500, epoch: 10 | loss: 0.1510198
	speed: 0.0102s/iter; left time: 59.1331s
Epoch: 10 cost time: 6.110207557678223
Epoch: 10, Steps: 570 | Train Loss: 0.1486454 Vali Loss: 0.0370910 Test Loss: 0.1269608
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12679612636566162, mae:0.22187824547290802
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3012963
	speed: 0.0237s/iter; left time: 267.4723s
	iters: 200, epoch: 1 | loss: 0.2677741
	speed: 0.0119s/iter; left time: 133.1371s
	iters: 300, epoch: 1 | loss: 0.1750219
	speed: 0.0119s/iter; left time: 132.0829s
	iters: 400, epoch: 1 | loss: 0.1297865
	speed: 0.0119s/iter; left time: 130.8549s
	iters: 500, epoch: 1 | loss: 0.2133226
	speed: 0.0119s/iter; left time: 129.6455s
Epoch: 1 cost time: 8.0092453956604
Epoch: 1, Steps: 570 | Train Loss: 0.2574803 Vali Loss: 0.0458579 Test Loss: 0.1352860
Validation loss decreased (inf --> 0.045858).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1982875
	speed: 0.0406s/iter; left time: 435.6817s
	iters: 200, epoch: 2 | loss: 0.1828269
	speed: 0.0129s/iter; left time: 137.2458s
	iters: 300, epoch: 2 | loss: 0.2175472
	speed: 0.0129s/iter; left time: 136.0538s
	iters: 400, epoch: 2 | loss: 0.1286643
	speed: 0.0130s/iter; left time: 135.4027s
	iters: 500, epoch: 2 | loss: 0.2117110
	speed: 0.0129s/iter; left time: 133.4766s
Epoch: 2 cost time: 7.696255207061768
Epoch: 2, Steps: 570 | Train Loss: 0.2258754 Vali Loss: 0.0447057 Test Loss: 0.1362181
Validation loss decreased (0.045858 --> 0.044706).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2756763
	speed: 0.0405s/iter; left time: 411.5977s
	iters: 200, epoch: 3 | loss: 0.2064056
	speed: 0.0118s/iter; left time: 119.1245s
	iters: 300, epoch: 3 | loss: 0.1095314
	speed: 0.0118s/iter; left time: 117.7830s
	iters: 400, epoch: 3 | loss: 0.2068678
	speed: 0.0118s/iter; left time: 116.8032s
	iters: 500, epoch: 3 | loss: 0.2011012
	speed: 0.0118s/iter; left time: 115.4100s
Epoch: 3 cost time: 7.065578937530518
Epoch: 3, Steps: 570 | Train Loss: 0.2037236 Vali Loss: 0.0462443 Test Loss: 0.1363997
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1503361
	speed: 0.0390s/iter; left time: 374.1239s
	iters: 200, epoch: 4 | loss: 0.2408571
	speed: 0.0118s/iter; left time: 112.4363s
	iters: 300, epoch: 4 | loss: 0.1057899
	speed: 0.0119s/iter; left time: 111.3303s
	iters: 400, epoch: 4 | loss: 0.1237857
	speed: 0.0119s/iter; left time: 110.2046s
	iters: 500, epoch: 4 | loss: 0.1619836
	speed: 0.0119s/iter; left time: 109.0803s
Epoch: 4 cost time: 7.051420450210571
Epoch: 4, Steps: 570 | Train Loss: 0.1848698 Vali Loss: 0.0414682 Test Loss: 0.1244780
Validation loss decreased (0.044706 --> 0.041468).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1547678
	speed: 0.0398s/iter; left time: 358.7752s
	iters: 200, epoch: 5 | loss: 0.1490418
	speed: 0.0118s/iter; left time: 105.3372s
	iters: 300, epoch: 5 | loss: 0.2137638
	speed: 0.0118s/iter; left time: 104.3182s
	iters: 400, epoch: 5 | loss: 0.1746981
	speed: 0.0118s/iter; left time: 103.0409s
	iters: 500, epoch: 5 | loss: 0.1618993
	speed: 0.0118s/iter; left time: 101.8522s
Epoch: 5 cost time: 7.022732734680176
Epoch: 5, Steps: 570 | Train Loss: 0.1739019 Vali Loss: 0.0393822 Test Loss: 0.1224011
Validation loss decreased (0.041468 --> 0.039382).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1413294
	speed: 0.0402s/iter; left time: 339.3079s
	iters: 200, epoch: 6 | loss: 0.0935599
	speed: 0.0119s/iter; left time: 99.0620s
	iters: 300, epoch: 6 | loss: 0.2263413
	speed: 0.0119s/iter; left time: 98.1030s
	iters: 400, epoch: 6 | loss: 0.1823796
	speed: 0.0119s/iter; left time: 96.8652s
	iters: 500, epoch: 6 | loss: 0.1201744
	speed: 0.0119s/iter; left time: 95.4829s
Epoch: 6 cost time: 7.102685451507568
Epoch: 6, Steps: 570 | Train Loss: 0.1673662 Vali Loss: 0.0386579 Test Loss: 0.1205866
Validation loss decreased (0.039382 --> 0.038658).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1570462
	speed: 0.0410s/iter; left time: 323.0567s
	iters: 200, epoch: 7 | loss: 0.1613402
	speed: 0.0118s/iter; left time: 91.8850s
	iters: 300, epoch: 7 | loss: 0.1535271
	speed: 0.0118s/iter; left time: 90.8250s
	iters: 400, epoch: 7 | loss: 0.1166422
	speed: 0.0118s/iter; left time: 89.7576s
	iters: 500, epoch: 7 | loss: 0.1554347
	speed: 0.0118s/iter; left time: 88.3485s
Epoch: 7 cost time: 7.073322772979736
Epoch: 7, Steps: 570 | Train Loss: 0.1631525 Vali Loss: 0.0386661 Test Loss: 0.1209979
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0983596
	speed: 0.0392s/iter; left time: 286.4206s
	iters: 200, epoch: 8 | loss: 0.1509856
	speed: 0.0119s/iter; left time: 85.6167s
	iters: 300, epoch: 8 | loss: 0.1772835
	speed: 0.0119s/iter; left time: 84.3531s
	iters: 400, epoch: 8 | loss: 0.1319452
	speed: 0.0119s/iter; left time: 83.1004s
	iters: 500, epoch: 8 | loss: 0.1221954
	speed: 0.0118s/iter; left time: 81.8383s
Epoch: 8 cost time: 7.090970516204834
Epoch: 8, Steps: 570 | Train Loss: 0.1622830 Vali Loss: 0.0382901 Test Loss: 0.1199921
Validation loss decreased (0.038658 --> 0.038290).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1114881
	speed: 0.0423s/iter; left time: 284.9647s
	iters: 200, epoch: 9 | loss: 0.1543981
	speed: 0.0119s/iter; left time: 78.8466s
	iters: 300, epoch: 9 | loss: 0.1817339
	speed: 0.0118s/iter; left time: 77.4210s
	iters: 400, epoch: 9 | loss: 0.1271408
	speed: 0.0118s/iter; left time: 76.1382s
	iters: 500, epoch: 9 | loss: 0.1836076
	speed: 0.0118s/iter; left time: 75.1362s
Epoch: 9 cost time: 7.080049276351929
Epoch: 9, Steps: 570 | Train Loss: 0.1617940 Vali Loss: 0.0380872 Test Loss: 0.1199515
Validation loss decreased (0.038290 --> 0.038087).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1570071
	speed: 0.0399s/iter; left time: 245.9682s
	iters: 200, epoch: 10 | loss: 0.1784642
	speed: 0.0119s/iter; left time: 72.0660s
	iters: 300, epoch: 10 | loss: 0.1366245
	speed: 0.0119s/iter; left time: 71.1253s
	iters: 400, epoch: 10 | loss: 0.1409702
	speed: 0.0119s/iter; left time: 69.7149s
	iters: 500, epoch: 10 | loss: 0.1993697
	speed: 0.0119s/iter; left time: 68.4102s
Epoch: 10 cost time: 7.097779750823975
Epoch: 10, Steps: 570 | Train Loss: 0.1603146 Vali Loss: 0.0381728 Test Loss: 0.1202390
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1282211
	speed: 0.0387s/iter; left time: 216.9835s
	iters: 200, epoch: 11 | loss: 0.2455364
	speed: 0.0118s/iter; left time: 65.0306s
	iters: 300, epoch: 11 | loss: 0.1538334
	speed: 0.0119s/iter; left time: 64.0049s
	iters: 400, epoch: 11 | loss: 0.1733185
	speed: 0.0118s/iter; left time: 62.6635s
	iters: 500, epoch: 11 | loss: 0.2067696
	speed: 0.0118s/iter; left time: 61.4506s
Epoch: 11 cost time: 7.041460037231445
Epoch: 11, Steps: 570 | Train Loss: 0.1596519 Vali Loss: 0.0382238 Test Loss: 0.1203443
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1390537
	speed: 0.0388s/iter; left time: 195.2956s
	iters: 200, epoch: 12 | loss: 0.1245567
	speed: 0.0118s/iter; left time: 58.2939s
	iters: 300, epoch: 12 | loss: 0.1152004
	speed: 0.0118s/iter; left time: 57.0879s
	iters: 400, epoch: 12 | loss: 0.1446932
	speed: 0.0118s/iter; left time: 55.9214s
	iters: 500, epoch: 12 | loss: 0.1685894
	speed: 0.0118s/iter; left time: 54.7230s
Epoch: 12 cost time: 7.076025485992432
Epoch: 12, Steps: 570 | Train Loss: 0.1602082 Vali Loss: 0.0383167 Test Loss: 0.1203712
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12011267244815826, mae:0.2147633582353592
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1519469
	speed: 0.0232s/iter; left time: 262.7179s
	iters: 200, epoch: 1 | loss: 0.3518038
	speed: 0.0115s/iter; left time: 129.0832s
	iters: 300, epoch: 1 | loss: 0.1749141
	speed: 0.0115s/iter; left time: 128.0576s
	iters: 400, epoch: 1 | loss: 0.2966926
	speed: 0.0115s/iter; left time: 126.7798s
	iters: 500, epoch: 1 | loss: 0.1596343
	speed: 0.0116s/iter; left time: 125.9697s
Epoch: 1 cost time: 7.802969694137573
Epoch: 1, Steps: 570 | Train Loss: 0.2292013 Vali Loss: 0.0412115 Test Loss: 0.1274067
Validation loss decreased (inf --> 0.041211).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1706311
	speed: 0.0409s/iter; left time: 438.5258s
	iters: 200, epoch: 2 | loss: 0.1401508
	speed: 0.0125s/iter; left time: 133.2498s
	iters: 300, epoch: 2 | loss: 0.1847728
	speed: 0.0126s/iter; left time: 132.3281s
	iters: 400, epoch: 2 | loss: 0.2843027
	speed: 0.0126s/iter; left time: 131.0124s
	iters: 500, epoch: 2 | loss: 0.2906266
	speed: 0.0125s/iter; left time: 129.4183s
Epoch: 2 cost time: 7.450432062149048
Epoch: 2, Steps: 570 | Train Loss: 0.2022052 Vali Loss: 0.0417904 Test Loss: 0.1300673
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1933681
	speed: 0.0386s/iter; left time: 392.0206s
	iters: 200, epoch: 3 | loss: 0.0985367
	speed: 0.0115s/iter; left time: 115.5206s
	iters: 300, epoch: 3 | loss: 0.1996156
	speed: 0.0115s/iter; left time: 114.7074s
	iters: 400, epoch: 3 | loss: 0.1665078
	speed: 0.0115s/iter; left time: 113.2855s
	iters: 500, epoch: 3 | loss: 0.2089575
	speed: 0.0115s/iter; left time: 112.1688s
Epoch: 3 cost time: 6.838870048522949
Epoch: 3, Steps: 570 | Train Loss: 0.1803595 Vali Loss: 0.0353008 Test Loss: 0.1156385
Validation loss decreased (0.041211 --> 0.035301).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1596104
	speed: 0.0385s/iter; left time: 369.2806s
	iters: 200, epoch: 4 | loss: 0.1095146
	speed: 0.0115s/iter; left time: 108.9106s
	iters: 300, epoch: 4 | loss: 0.0954783
	speed: 0.0115s/iter; left time: 107.8193s
	iters: 400, epoch: 4 | loss: 0.1333924
	speed: 0.0115s/iter; left time: 106.6323s
	iters: 500, epoch: 4 | loss: 0.1625584
	speed: 0.0115s/iter; left time: 105.5658s
Epoch: 4 cost time: 6.852359294891357
Epoch: 4, Steps: 570 | Train Loss: 0.1650652 Vali Loss: 0.0338985 Test Loss: 0.1111508
Validation loss decreased (0.035301 --> 0.033899).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1666282
	speed: 0.0387s/iter; left time: 349.0557s
	iters: 200, epoch: 5 | loss: 0.1077879
	speed: 0.0115s/iter; left time: 102.2619s
	iters: 300, epoch: 5 | loss: 0.2390414
	speed: 0.0115s/iter; left time: 101.1646s
	iters: 400, epoch: 5 | loss: 0.1366075
	speed: 0.0114s/iter; left time: 99.7815s
	iters: 500, epoch: 5 | loss: 0.1202177
	speed: 0.0115s/iter; left time: 98.8638s
Epoch: 5 cost time: 6.862772464752197
Epoch: 5, Steps: 570 | Train Loss: 0.1558943 Vali Loss: 0.0339489 Test Loss: 0.1121132
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1796040
	speed: 0.0383s/iter; left time: 324.0646s
	iters: 200, epoch: 6 | loss: 0.1611378
	speed: 0.0115s/iter; left time: 95.6558s
	iters: 300, epoch: 6 | loss: 0.1117627
	speed: 0.0115s/iter; left time: 94.4940s
	iters: 400, epoch: 6 | loss: 0.1110432
	speed: 0.0115s/iter; left time: 93.3620s
	iters: 500, epoch: 6 | loss: 0.1269647
	speed: 0.0114s/iter; left time: 92.0792s
Epoch: 6 cost time: 6.835015058517456
Epoch: 6, Steps: 570 | Train Loss: 0.1512940 Vali Loss: 0.0335551 Test Loss: 0.1112797
Validation loss decreased (0.033899 --> 0.033555).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1086403
	speed: 0.0386s/iter; left time: 304.5983s
	iters: 200, epoch: 7 | loss: 0.1870593
	speed: 0.0115s/iter; left time: 89.3011s
	iters: 300, epoch: 7 | loss: 0.0947685
	speed: 0.0115s/iter; left time: 88.0247s
	iters: 400, epoch: 7 | loss: 0.1145303
	speed: 0.0115s/iter; left time: 86.9123s
	iters: 500, epoch: 7 | loss: 0.1414022
	speed: 0.0114s/iter; left time: 85.6565s
Epoch: 7 cost time: 6.820448875427246
Epoch: 7, Steps: 570 | Train Loss: 0.1482953 Vali Loss: 0.0331711 Test Loss: 0.1111351
Validation loss decreased (0.033555 --> 0.033171).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1101499
	speed: 0.0384s/iter; left time: 281.0833s
	iters: 200, epoch: 8 | loss: 0.1743105
	speed: 0.0115s/iter; left time: 82.7960s
	iters: 300, epoch: 8 | loss: 0.1020674
	speed: 0.0115s/iter; left time: 81.4645s
	iters: 400, epoch: 8 | loss: 0.1296077
	speed: 0.0115s/iter; left time: 80.3095s
	iters: 500, epoch: 8 | loss: 0.1146621
	speed: 0.0115s/iter; left time: 79.1481s
Epoch: 8 cost time: 6.863987684249878
Epoch: 8, Steps: 570 | Train Loss: 0.1471755 Vali Loss: 0.0333272 Test Loss: 0.1113495
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2292286
	speed: 0.0409s/iter; left time: 275.9357s
	iters: 200, epoch: 9 | loss: 0.1055641
	speed: 0.0125s/iter; left time: 82.8937s
	iters: 300, epoch: 9 | loss: 0.1617718
	speed: 0.0115s/iter; left time: 75.1375s
	iters: 400, epoch: 9 | loss: 0.1685493
	speed: 0.0115s/iter; left time: 73.9814s
	iters: 500, epoch: 9 | loss: 0.2229301
	speed: 0.0115s/iter; left time: 72.8627s
Epoch: 9 cost time: 7.041830778121948
Epoch: 9, Steps: 570 | Train Loss: 0.1456881 Vali Loss: 0.0330472 Test Loss: 0.1112786
Validation loss decreased (0.033171 --> 0.033047).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1415712
	speed: 0.0382s/iter; left time: 235.8174s
	iters: 200, epoch: 10 | loss: 0.1169592
	speed: 0.0114s/iter; left time: 69.4243s
	iters: 300, epoch: 10 | loss: 0.1292818
	speed: 0.0114s/iter; left time: 68.2733s
	iters: 400, epoch: 10 | loss: 0.1493463
	speed: 0.0114s/iter; left time: 67.1245s
	iters: 500, epoch: 10 | loss: 0.1628127
	speed: 0.0114s/iter; left time: 65.9772s
Epoch: 10 cost time: 6.833430290222168
Epoch: 10, Steps: 570 | Train Loss: 0.1465767 Vali Loss: 0.0331408 Test Loss: 0.1112651
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1133842
	speed: 0.0409s/iter; left time: 228.9959s
	iters: 200, epoch: 11 | loss: 0.1636380
	speed: 0.0125s/iter; left time: 69.0043s
	iters: 300, epoch: 11 | loss: 0.1353102
	speed: 0.0125s/iter; left time: 67.7424s
	iters: 400, epoch: 11 | loss: 0.1801481
	speed: 0.0121s/iter; left time: 64.0825s
	iters: 500, epoch: 11 | loss: 0.2217366
	speed: 0.0115s/iter; left time: 59.7744s
Epoch: 11 cost time: 7.320434808731079
Epoch: 11, Steps: 570 | Train Loss: 0.1468188 Vali Loss: 0.0330274 Test Loss: 0.1112319
Validation loss decreased (0.033047 --> 0.033027).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1327773
	speed: 0.0386s/iter; left time: 194.3912s
	iters: 200, epoch: 12 | loss: 0.1372503
	speed: 0.0115s/iter; left time: 56.9289s
	iters: 300, epoch: 12 | loss: 0.1172687
	speed: 0.0116s/iter; left time: 55.8018s
	iters: 400, epoch: 12 | loss: 0.2106243
	speed: 0.0115s/iter; left time: 54.4962s
	iters: 500, epoch: 12 | loss: 0.1307931
	speed: 0.0115s/iter; left time: 53.4584s
Epoch: 12 cost time: 6.9001405239105225
Epoch: 12, Steps: 570 | Train Loss: 0.1459731 Vali Loss: 0.0332833 Test Loss: 0.1112486
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2057044
	speed: 0.0390s/iter; left time: 173.9394s
	iters: 200, epoch: 13 | loss: 0.1851881
	speed: 0.0114s/iter; left time: 49.8009s
	iters: 300, epoch: 13 | loss: 0.1428877
	speed: 0.0114s/iter; left time: 48.6942s
	iters: 400, epoch: 13 | loss: 0.1263070
	speed: 0.0114s/iter; left time: 47.5724s
	iters: 500, epoch: 13 | loss: 0.1877145
	speed: 0.0114s/iter; left time: 46.4549s
Epoch: 13 cost time: 6.861037492752075
Epoch: 13, Steps: 570 | Train Loss: 0.1447158 Vali Loss: 0.0331614 Test Loss: 0.1112201
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1153721
	speed: 0.0384s/iter; left time: 149.3471s
	iters: 200, epoch: 14 | loss: 0.2060436
	speed: 0.0115s/iter; left time: 43.5317s
	iters: 300, epoch: 14 | loss: 0.1331390
	speed: 0.0115s/iter; left time: 42.3854s
	iters: 400, epoch: 14 | loss: 0.1472175
	speed: 0.0115s/iter; left time: 41.2497s
	iters: 500, epoch: 14 | loss: 0.2155699
	speed: 0.0115s/iter; left time: 40.0517s
Epoch: 14 cost time: 6.807992219924927
Epoch: 14, Steps: 570 | Train Loss: 0.1452995 Vali Loss: 0.0329629 Test Loss: 0.1111845
Validation loss decreased (0.033027 --> 0.032963).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1701639
	speed: 0.0380s/iter; left time: 126.2597s
	iters: 200, epoch: 15 | loss: 0.1698841
	speed: 0.0115s/iter; left time: 36.9983s
	iters: 300, epoch: 15 | loss: 0.1489871
	speed: 0.0115s/iter; left time: 35.8038s
	iters: 400, epoch: 15 | loss: 0.1076717
	speed: 0.0115s/iter; left time: 34.6979s
	iters: 500, epoch: 15 | loss: 0.1245630
	speed: 0.0115s/iter; left time: 33.5554s
Epoch: 15 cost time: 6.866876602172852
Epoch: 15, Steps: 570 | Train Loss: 0.1444354 Vali Loss: 0.0330157 Test Loss: 0.1111896
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1521598
	speed: 0.0395s/iter; left time: 108.7100s
	iters: 200, epoch: 16 | loss: 0.1556416
	speed: 0.0126s/iter; left time: 33.3007s
	iters: 300, epoch: 16 | loss: 0.1187774
	speed: 0.0126s/iter; left time: 32.1358s
	iters: 400, epoch: 16 | loss: 0.0956007
	speed: 0.0125s/iter; left time: 30.7205s
	iters: 500, epoch: 16 | loss: 0.1450910
	speed: 0.0126s/iter; left time: 29.5255s
Epoch: 16 cost time: 7.435526609420776
Epoch: 16, Steps: 570 | Train Loss: 0.1461396 Vali Loss: 0.0330571 Test Loss: 0.1111890
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1512654
	speed: 0.0392s/iter; left time: 85.3996s
	iters: 200, epoch: 17 | loss: 0.0914336
	speed: 0.0115s/iter; left time: 23.9116s
	iters: 300, epoch: 17 | loss: 0.1645135
	speed: 0.0115s/iter; left time: 22.7586s
	iters: 400, epoch: 17 | loss: 0.0635268
	speed: 0.0115s/iter; left time: 21.5647s
	iters: 500, epoch: 17 | loss: 0.1457991
	speed: 0.0115s/iter; left time: 20.4822s
Epoch: 17 cost time: 6.829618453979492
Epoch: 17, Steps: 570 | Train Loss: 0.1452971 Vali Loss: 0.0331200 Test Loss: 0.1111891
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11135132610797882, mae:0.20238979160785675
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3023773
	speed: 0.0239s/iter; left time: 269.7294s
	iters: 200, epoch: 1 | loss: 0.3520382
	speed: 0.0120s/iter; left time: 134.0128s
	iters: 300, epoch: 1 | loss: 0.3291507
	speed: 0.0120s/iter; left time: 133.2174s
	iters: 400, epoch: 1 | loss: 0.2533366
	speed: 0.0120s/iter; left time: 131.7074s
	iters: 500, epoch: 1 | loss: 0.2025783
	speed: 0.0120s/iter; left time: 130.5160s
Epoch: 1 cost time: 8.070539474487305
Epoch: 1, Steps: 570 | Train Loss: 0.2592653 Vali Loss: 0.0470340 Test Loss: 0.1491200
Validation loss decreased (inf --> 0.047034).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2725223
	speed: 0.0401s/iter; left time: 430.1632s
	iters: 200, epoch: 2 | loss: 0.3464039
	speed: 0.0120s/iter; left time: 127.8107s
	iters: 300, epoch: 2 | loss: 0.1615402
	speed: 0.0121s/iter; left time: 126.9154s
	iters: 400, epoch: 2 | loss: 0.1890907
	speed: 0.0120s/iter; left time: 125.3905s
	iters: 500, epoch: 2 | loss: 0.1945120
	speed: 0.0120s/iter; left time: 124.4133s
Epoch: 2 cost time: 7.176655054092407
Epoch: 2, Steps: 570 | Train Loss: 0.2294851 Vali Loss: 0.0506599 Test Loss: 0.1529285
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1668201
	speed: 0.0375s/iter; left time: 381.1757s
	iters: 200, epoch: 3 | loss: 0.1748754
	speed: 0.0109s/iter; left time: 109.3894s
	iters: 300, epoch: 3 | loss: 0.2789643
	speed: 0.0109s/iter; left time: 108.5200s
	iters: 400, epoch: 3 | loss: 0.1677472
	speed: 0.0109s/iter; left time: 107.1105s
	iters: 500, epoch: 3 | loss: 0.2055227
	speed: 0.0109s/iter; left time: 106.0200s
Epoch: 3 cost time: 6.488773584365845
Epoch: 3, Steps: 570 | Train Loss: 0.2052950 Vali Loss: 0.0422072 Test Loss: 0.1373033
Validation loss decreased (0.047034 --> 0.042207).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1818763
	speed: 0.0385s/iter; left time: 369.3323s
	iters: 200, epoch: 4 | loss: 0.1296567
	speed: 0.0108s/iter; left time: 102.7657s
	iters: 300, epoch: 4 | loss: 0.1650539
	speed: 0.0108s/iter; left time: 101.8453s
	iters: 400, epoch: 4 | loss: 0.3428080
	speed: 0.0108s/iter; left time: 100.7331s
	iters: 500, epoch: 4 | loss: 0.1801892
	speed: 0.0108s/iter; left time: 99.5861s
Epoch: 4 cost time: 6.589330434799194
Epoch: 4, Steps: 570 | Train Loss: 0.1827566 Vali Loss: 0.0414400 Test Loss: 0.1408591
Validation loss decreased (0.042207 --> 0.041440).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1668240
	speed: 0.0397s/iter; left time: 358.1591s
	iters: 200, epoch: 5 | loss: 0.1677529
	speed: 0.0121s/iter; left time: 107.6264s
	iters: 300, epoch: 5 | loss: 0.1709006
	speed: 0.0121s/iter; left time: 106.5135s
	iters: 400, epoch: 5 | loss: 0.1128015
	speed: 0.0120s/iter; left time: 104.3695s
	iters: 500, epoch: 5 | loss: 0.2561677
	speed: 0.0109s/iter; left time: 93.6740s
Epoch: 5 cost time: 6.996452808380127
Epoch: 5, Steps: 570 | Train Loss: 0.1705200 Vali Loss: 0.0390431 Test Loss: 0.1338034
Validation loss decreased (0.041440 --> 0.039043).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1403041
	speed: 0.0370s/iter; left time: 312.8802s
	iters: 200, epoch: 6 | loss: 0.1482296
	speed: 0.0109s/iter; left time: 90.6728s
	iters: 300, epoch: 6 | loss: 0.1887355
	speed: 0.0109s/iter; left time: 89.6775s
	iters: 400, epoch: 6 | loss: 0.1394947
	speed: 0.0109s/iter; left time: 88.5978s
	iters: 500, epoch: 6 | loss: 0.1561777
	speed: 0.0109s/iter; left time: 87.5674s
Epoch: 6 cost time: 6.5009605884552
Epoch: 6, Steps: 570 | Train Loss: 0.1623241 Vali Loss: 0.0388792 Test Loss: 0.1365796
Validation loss decreased (0.039043 --> 0.038879).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1332874
	speed: 0.0377s/iter; left time: 297.0912s
	iters: 200, epoch: 7 | loss: 0.1300848
	speed: 0.0108s/iter; left time: 84.3664s
	iters: 300, epoch: 7 | loss: 0.1099305
	speed: 0.0108s/iter; left time: 83.3069s
	iters: 400, epoch: 7 | loss: 0.1499352
	speed: 0.0109s/iter; left time: 82.4273s
	iters: 500, epoch: 7 | loss: 0.1161368
	speed: 0.0109s/iter; left time: 81.2645s
Epoch: 7 cost time: 6.517701625823975
Epoch: 7, Steps: 570 | Train Loss: 0.1599118 Vali Loss: 0.0385099 Test Loss: 0.1332457
Validation loss decreased (0.038879 --> 0.038510).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1220800
	speed: 0.0377s/iter; left time: 275.7029s
	iters: 200, epoch: 8 | loss: 0.1919292
	speed: 0.0109s/iter; left time: 78.4994s
	iters: 300, epoch: 8 | loss: 0.2086399
	speed: 0.0109s/iter; left time: 77.5096s
	iters: 400, epoch: 8 | loss: 0.1443205
	speed: 0.0109s/iter; left time: 76.1924s
	iters: 500, epoch: 8 | loss: 0.0975310
	speed: 0.0109s/iter; left time: 75.2352s
Epoch: 8 cost time: 6.518476247787476
Epoch: 8, Steps: 570 | Train Loss: 0.1577346 Vali Loss: 0.0380855 Test Loss: 0.1331222
Validation loss decreased (0.038510 --> 0.038086).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1655697
	speed: 0.0395s/iter; left time: 266.5882s
	iters: 200, epoch: 9 | loss: 0.1161146
	speed: 0.0108s/iter; left time: 71.8879s
	iters: 300, epoch: 9 | loss: 0.2196243
	speed: 0.0108s/iter; left time: 70.8243s
	iters: 400, epoch: 9 | loss: 0.2073046
	speed: 0.0108s/iter; left time: 69.7758s
	iters: 500, epoch: 9 | loss: 0.1035316
	speed: 0.0108s/iter; left time: 68.7417s
Epoch: 9 cost time: 6.471206426620483
Epoch: 9, Steps: 570 | Train Loss: 0.1557757 Vali Loss: 0.0381641 Test Loss: 0.1334061
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1572970
	speed: 0.0375s/iter; left time: 231.1410s
	iters: 200, epoch: 10 | loss: 0.0930295
	speed: 0.0108s/iter; left time: 65.8239s
	iters: 300, epoch: 10 | loss: 0.1732631
	speed: 0.0108s/iter; left time: 64.7342s
	iters: 400, epoch: 10 | loss: 0.1366965
	speed: 0.0109s/iter; left time: 63.7232s
	iters: 500, epoch: 10 | loss: 0.1793620
	speed: 0.0108s/iter; left time: 62.5391s
Epoch: 10 cost time: 6.481356382369995
Epoch: 10, Steps: 570 | Train Loss: 0.1560762 Vali Loss: 0.0381785 Test Loss: 0.1330903
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1224089
	speed: 0.0363s/iter; left time: 203.2608s
	iters: 200, epoch: 11 | loss: 0.1424767
	speed: 0.0108s/iter; left time: 59.5787s
	iters: 300, epoch: 11 | loss: 0.1435373
	speed: 0.0108s/iter; left time: 58.4753s
	iters: 400, epoch: 11 | loss: 0.1171310
	speed: 0.0108s/iter; left time: 57.3919s
	iters: 500, epoch: 11 | loss: 0.1325386
	speed: 0.0108s/iter; left time: 56.2977s
Epoch: 11 cost time: 6.450270891189575
Epoch: 11, Steps: 570 | Train Loss: 0.1562124 Vali Loss: 0.0382650 Test Loss: 0.1332655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13330425322055817, mae:0.2314433604478836
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2088144
	speed: 0.0283s/iter; left time: 319.4645s
	iters: 200, epoch: 1 | loss: 0.1824291
	speed: 0.0168s/iter; left time: 187.8583s
	iters: 300, epoch: 1 | loss: 0.2788930
	speed: 0.0168s/iter; left time: 186.1548s
	iters: 400, epoch: 1 | loss: 0.2357036
	speed: 0.0168s/iter; left time: 184.7473s
	iters: 500, epoch: 1 | loss: 0.1783668
	speed: 0.0152s/iter; left time: 166.1172s
Epoch: 1 cost time: 10.448149919509888
Epoch: 1, Steps: 570 | Train Loss: 0.2419916 Vali Loss: 0.0462555 Test Loss: 0.1280871
Validation loss decreased (inf --> 0.046256).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3006781
	speed: 0.0473s/iter; left time: 507.6545s
	iters: 200, epoch: 2 | loss: 0.1948502
	speed: 0.0148s/iter; left time: 157.4958s
	iters: 300, epoch: 2 | loss: 0.1645432
	speed: 0.0148s/iter; left time: 155.6360s
	iters: 400, epoch: 2 | loss: 0.1193968
	speed: 0.0148s/iter; left time: 153.9883s
	iters: 500, epoch: 2 | loss: 0.2239374
	speed: 0.0147s/iter; left time: 152.2037s
Epoch: 2 cost time: 8.752765655517578
Epoch: 2, Steps: 570 | Train Loss: 0.2050041 Vali Loss: 0.0459917 Test Loss: 0.1426752
Validation loss decreased (0.046256 --> 0.045992).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3307565
	speed: 0.0477s/iter; left time: 484.5046s
	iters: 200, epoch: 3 | loss: 0.1560543
	speed: 0.0146s/iter; left time: 147.3427s
	iters: 300, epoch: 3 | loss: 0.0987948
	speed: 0.0146s/iter; left time: 145.7704s
	iters: 400, epoch: 3 | loss: 0.1366630
	speed: 0.0146s/iter; left time: 143.8832s
	iters: 500, epoch: 3 | loss: 0.1182564
	speed: 0.0146s/iter; left time: 142.4587s
Epoch: 3 cost time: 8.631799221038818
Epoch: 3, Steps: 570 | Train Loss: 0.1765109 Vali Loss: 0.0391808 Test Loss: 0.1271644
Validation loss decreased (0.045992 --> 0.039181).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1397561
	speed: 0.0485s/iter; left time: 464.9884s
	iters: 200, epoch: 4 | loss: 0.1401083
	speed: 0.0164s/iter; left time: 155.6732s
	iters: 300, epoch: 4 | loss: 0.1984763
	speed: 0.0164s/iter; left time: 154.1655s
	iters: 400, epoch: 4 | loss: 0.1807085
	speed: 0.0164s/iter; left time: 152.2945s
	iters: 500, epoch: 4 | loss: 0.1222808
	speed: 0.0164s/iter; left time: 150.4234s
Epoch: 4 cost time: 9.630901575088501
Epoch: 4, Steps: 570 | Train Loss: 0.1574438 Vali Loss: 0.0374154 Test Loss: 0.1241968
Validation loss decreased (0.039181 --> 0.037415).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1441234
	speed: 0.0486s/iter; left time: 438.4507s
	iters: 200, epoch: 5 | loss: 0.1478885
	speed: 0.0146s/iter; left time: 130.1964s
	iters: 300, epoch: 5 | loss: 0.1427533
	speed: 0.0146s/iter; left time: 128.8453s
	iters: 400, epoch: 5 | loss: 0.1568673
	speed: 0.0146s/iter; left time: 127.1852s
	iters: 500, epoch: 5 | loss: 0.1767756
	speed: 0.0146s/iter; left time: 125.9823s
Epoch: 5 cost time: 8.611501455307007
Epoch: 5, Steps: 570 | Train Loss: 0.1490328 Vali Loss: 0.0381137 Test Loss: 0.1268485
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1252706
	speed: 0.0461s/iter; left time: 389.7548s
	iters: 200, epoch: 6 | loss: 0.1413923
	speed: 0.0147s/iter; left time: 122.7905s
	iters: 300, epoch: 6 | loss: 0.1185930
	speed: 0.0147s/iter; left time: 121.3692s
	iters: 400, epoch: 6 | loss: 0.1176067
	speed: 0.0147s/iter; left time: 119.6733s
	iters: 500, epoch: 6 | loss: 0.1488429
	speed: 0.0147s/iter; left time: 118.2620s
Epoch: 6 cost time: 8.65410828590393
Epoch: 6, Steps: 570 | Train Loss: 0.1430332 Vali Loss: 0.0376692 Test Loss: 0.1223561
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1383386
	speed: 0.0471s/iter; left time: 370.9412s
	iters: 200, epoch: 7 | loss: 0.1056294
	speed: 0.0147s/iter; left time: 114.5564s
	iters: 300, epoch: 7 | loss: 0.1030869
	speed: 0.0147s/iter; left time: 113.0121s
	iters: 400, epoch: 7 | loss: 0.1361030
	speed: 0.0147s/iter; left time: 111.4874s
	iters: 500, epoch: 7 | loss: 0.2070615
	speed: 0.0147s/iter; left time: 110.0587s
Epoch: 7 cost time: 8.693596363067627
Epoch: 7, Steps: 570 | Train Loss: 0.1416667 Vali Loss: 0.0376299 Test Loss: 0.1246513
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12436190247535706, mae:0.21817733347415924
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3041493
	speed: 0.0261s/iter; left time: 295.4402s
	iters: 200, epoch: 1 | loss: 0.2585823
	speed: 0.0143s/iter; left time: 160.7123s
	iters: 300, epoch: 1 | loss: 0.1520086
	speed: 0.0143s/iter; left time: 158.8655s
	iters: 400, epoch: 1 | loss: 0.3295628
	speed: 0.0143s/iter; left time: 157.5945s
	iters: 500, epoch: 1 | loss: 0.1836459
	speed: 0.0143s/iter; left time: 156.2134s
Epoch: 1 cost time: 9.396763563156128
Epoch: 1, Steps: 570 | Train Loss: 0.2175849 Vali Loss: 0.0411615 Test Loss: 0.1243817
Validation loss decreased (inf --> 0.041161).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1491904
	speed: 0.0455s/iter; left time: 487.8898s
	iters: 200, epoch: 2 | loss: 0.2791035
	speed: 0.0142s/iter; left time: 151.4740s
	iters: 300, epoch: 2 | loss: 0.1883979
	speed: 0.0142s/iter; left time: 149.8137s
	iters: 400, epoch: 2 | loss: 0.1699372
	speed: 0.0142s/iter; left time: 148.4570s
	iters: 500, epoch: 2 | loss: 0.1642059
	speed: 0.0142s/iter; left time: 147.0015s
Epoch: 2 cost time: 8.428610801696777
Epoch: 2, Steps: 570 | Train Loss: 0.1894586 Vali Loss: 0.0383928 Test Loss: 0.1226561
Validation loss decreased (0.041161 --> 0.038393).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1771815
	speed: 0.0470s/iter; left time: 477.2518s
	iters: 200, epoch: 3 | loss: 0.0839687
	speed: 0.0143s/iter; left time: 143.7776s
	iters: 300, epoch: 3 | loss: 0.2152462
	speed: 0.0143s/iter; left time: 142.3437s
	iters: 400, epoch: 3 | loss: 0.1249974
	speed: 0.0143s/iter; left time: 141.0179s
	iters: 500, epoch: 3 | loss: 0.1507803
	speed: 0.0143s/iter; left time: 139.6530s
Epoch: 3 cost time: 8.47367000579834
Epoch: 3, Steps: 570 | Train Loss: 0.1661950 Vali Loss: 0.0359099 Test Loss: 0.1177011
Validation loss decreased (0.038393 --> 0.035910).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1583731
	speed: 0.0473s/iter; left time: 453.2171s
	iters: 200, epoch: 4 | loss: 0.1549593
	speed: 0.0143s/iter; left time: 135.5319s
	iters: 300, epoch: 4 | loss: 0.1846991
	speed: 0.0143s/iter; left time: 134.1701s
	iters: 400, epoch: 4 | loss: 0.0967964
	speed: 0.0143s/iter; left time: 132.7119s
	iters: 500, epoch: 4 | loss: 0.1095245
	speed: 0.0143s/iter; left time: 131.0345s
Epoch: 4 cost time: 8.403527021408081
Epoch: 4, Steps: 570 | Train Loss: 0.1546359 Vali Loss: 0.0341666 Test Loss: 0.1127359
Validation loss decreased (0.035910 --> 0.034167).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0815493
	speed: 0.0452s/iter; left time: 408.0879s
	iters: 200, epoch: 5 | loss: 0.1315108
	speed: 0.0143s/iter; left time: 127.5060s
	iters: 300, epoch: 5 | loss: 0.1942120
	speed: 0.0143s/iter; left time: 126.2658s
	iters: 400, epoch: 5 | loss: 0.1044161
	speed: 0.0143s/iter; left time: 124.4282s
	iters: 500, epoch: 5 | loss: 0.1637261
	speed: 0.0142s/iter; left time: 122.6538s
Epoch: 5 cost time: 8.435765027999878
Epoch: 5, Steps: 570 | Train Loss: 0.1448837 Vali Loss: 0.0341896 Test Loss: 0.1115746
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1139430
	speed: 0.0473s/iter; left time: 399.4775s
	iters: 200, epoch: 6 | loss: 0.2346027
	speed: 0.0142s/iter; left time: 118.8620s
	iters: 300, epoch: 6 | loss: 0.2354135
	speed: 0.0142s/iter; left time: 117.5292s
	iters: 400, epoch: 6 | loss: 0.1607544
	speed: 0.0142s/iter; left time: 116.0735s
	iters: 500, epoch: 6 | loss: 0.1464290
	speed: 0.0142s/iter; left time: 114.6019s
Epoch: 6 cost time: 8.41111969947815
Epoch: 6, Steps: 570 | Train Loss: 0.1417928 Vali Loss: 0.0337849 Test Loss: 0.1103700
Validation loss decreased (0.034167 --> 0.033785).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1030021
	speed: 0.0476s/iter; left time: 374.8027s
	iters: 200, epoch: 7 | loss: 0.1366124
	speed: 0.0143s/iter; left time: 111.2241s
	iters: 300, epoch: 7 | loss: 0.2279001
	speed: 0.0142s/iter; left time: 109.4388s
	iters: 400, epoch: 7 | loss: 0.1248613
	speed: 0.0143s/iter; left time: 108.3294s
	iters: 500, epoch: 7 | loss: 0.1861413
	speed: 0.0143s/iter; left time: 106.8846s
Epoch: 7 cost time: 8.456965684890747
Epoch: 7, Steps: 570 | Train Loss: 0.1395018 Vali Loss: 0.0332101 Test Loss: 0.1089533
Validation loss decreased (0.033785 --> 0.033210).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0943482
	speed: 0.0454s/iter; left time: 331.9538s
	iters: 200, epoch: 8 | loss: 0.1349510
	speed: 0.0142s/iter; left time: 102.5177s
	iters: 300, epoch: 8 | loss: 0.2093175
	speed: 0.0142s/iter; left time: 101.1528s
	iters: 400, epoch: 8 | loss: 0.1370911
	speed: 0.0142s/iter; left time: 99.6604s
	iters: 500, epoch: 8 | loss: 0.1521060
	speed: 0.0142s/iter; left time: 98.3548s
Epoch: 8 cost time: 8.404860973358154
Epoch: 8, Steps: 570 | Train Loss: 0.1379513 Vali Loss: 0.0333427 Test Loss: 0.1091910
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0990435
	speed: 0.0464s/iter; left time: 312.7577s
	iters: 200, epoch: 9 | loss: 0.1075702
	speed: 0.0143s/iter; left time: 95.1387s
	iters: 300, epoch: 9 | loss: 0.1758587
	speed: 0.0143s/iter; left time: 93.2660s
	iters: 400, epoch: 9 | loss: 0.1283492
	speed: 0.0143s/iter; left time: 91.9989s
	iters: 500, epoch: 9 | loss: 0.1375320
	speed: 0.0143s/iter; left time: 90.5853s
Epoch: 9 cost time: 8.421502828598022
Epoch: 9, Steps: 570 | Train Loss: 0.1371401 Vali Loss: 0.0331055 Test Loss: 0.1088744
Validation loss decreased (0.033210 --> 0.033106).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1440584
	speed: 0.0476s/iter; left time: 293.7555s
	iters: 200, epoch: 10 | loss: 0.1124659
	speed: 0.0143s/iter; left time: 86.6358s
	iters: 300, epoch: 10 | loss: 0.1372264
	speed: 0.0143s/iter; left time: 85.1483s
	iters: 400, epoch: 10 | loss: 0.1360071
	speed: 0.0143s/iter; left time: 83.6964s
	iters: 500, epoch: 10 | loss: 0.1742094
	speed: 0.0143s/iter; left time: 82.2898s
Epoch: 10 cost time: 8.435937404632568
Epoch: 10, Steps: 570 | Train Loss: 0.1371056 Vali Loss: 0.0330677 Test Loss: 0.1088897
Validation loss decreased (0.033106 --> 0.033068).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2021715
	speed: 0.0482s/iter; left time: 269.8538s
	iters: 200, epoch: 11 | loss: 0.1225517
	speed: 0.0143s/iter; left time: 78.8695s
	iters: 300, epoch: 11 | loss: 0.1704631
	speed: 0.0143s/iter; left time: 77.4690s
	iters: 400, epoch: 11 | loss: 0.0939213
	speed: 0.0143s/iter; left time: 75.8953s
	iters: 500, epoch: 11 | loss: 0.2140114
	speed: 0.0143s/iter; left time: 74.3988s
Epoch: 11 cost time: 8.50165843963623
Epoch: 11, Steps: 570 | Train Loss: 0.1350687 Vali Loss: 0.0329884 Test Loss: 0.1088659
Validation loss decreased (0.033068 --> 0.032988).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1625562
	speed: 0.0461s/iter; left time: 231.7295s
	iters: 200, epoch: 12 | loss: 0.1708721
	speed: 0.0143s/iter; left time: 70.4337s
	iters: 300, epoch: 12 | loss: 0.1148917
	speed: 0.0156s/iter; left time: 75.2812s
	iters: 400, epoch: 12 | loss: 0.1476015
	speed: 0.0160s/iter; left time: 75.8584s
	iters: 500, epoch: 12 | loss: 0.1615509
	speed: 0.0160s/iter; left time: 74.0879s
Epoch: 12 cost time: 9.063811302185059
Epoch: 12, Steps: 570 | Train Loss: 0.1370205 Vali Loss: 0.0331084 Test Loss: 0.1088943
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1212869
	speed: 0.0476s/iter; left time: 212.2523s
	iters: 200, epoch: 13 | loss: 0.0968870
	speed: 0.0143s/iter; left time: 62.5469s
	iters: 300, epoch: 13 | loss: 0.1208057
	speed: 0.0144s/iter; left time: 61.2581s
	iters: 400, epoch: 13 | loss: 0.0852482
	speed: 0.0144s/iter; left time: 59.7450s
	iters: 500, epoch: 13 | loss: 0.1432980
	speed: 0.0144s/iter; left time: 58.3959s
Epoch: 13 cost time: 8.45564579963684
Epoch: 13, Steps: 570 | Train Loss: 0.1366182 Vali Loss: 0.0329717 Test Loss: 0.1089000
Validation loss decreased (0.032988 --> 0.032972).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1207893
	speed: 0.0462s/iter; left time: 179.8247s
	iters: 200, epoch: 14 | loss: 0.2127361
	speed: 0.0143s/iter; left time: 54.0978s
	iters: 300, epoch: 14 | loss: 0.0937397
	speed: 0.0143s/iter; left time: 52.6638s
	iters: 400, epoch: 14 | loss: 0.0882648
	speed: 0.0143s/iter; left time: 51.2175s
	iters: 500, epoch: 14 | loss: 0.0805607
	speed: 0.0142s/iter; left time: 49.7431s
Epoch: 14 cost time: 8.44920039176941
Epoch: 14, Steps: 570 | Train Loss: 0.1345381 Vali Loss: 0.0330430 Test Loss: 0.1089277
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1321850
	speed: 0.0458s/iter; left time: 152.0775s
	iters: 200, epoch: 15 | loss: 0.1116377
	speed: 0.0143s/iter; left time: 45.9723s
	iters: 300, epoch: 15 | loss: 0.1358414
	speed: 0.0143s/iter; left time: 44.5286s
	iters: 400, epoch: 15 | loss: 0.1307736
	speed: 0.0143s/iter; left time: 43.0631s
	iters: 500, epoch: 15 | loss: 0.1802043
	speed: 0.0143s/iter; left time: 41.6505s
Epoch: 15 cost time: 8.447641849517822
Epoch: 15, Steps: 570 | Train Loss: 0.1356780 Vali Loss: 0.0330492 Test Loss: 0.1089440
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1402374
	speed: 0.0465s/iter; left time: 127.7859s
	iters: 200, epoch: 16 | loss: 0.1551928
	speed: 0.0142s/iter; left time: 37.7533s
	iters: 300, epoch: 16 | loss: 0.1137916
	speed: 0.0143s/iter; left time: 36.3626s
	iters: 400, epoch: 16 | loss: 0.1630017
	speed: 0.0143s/iter; left time: 34.9277s
	iters: 500, epoch: 16 | loss: 0.1067045
	speed: 0.0143s/iter; left time: 33.5062s
Epoch: 16 cost time: 8.457226037979126
Epoch: 16, Steps: 570 | Train Loss: 0.1356732 Vali Loss: 0.0331464 Test Loss: 0.1089477
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10903660207986832, mae:0.19916637241840363
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1381665
	speed: 0.0278s/iter; left time: 314.4081s
	iters: 200, epoch: 1 | loss: 0.3449165
	speed: 0.0160s/iter; left time: 179.6421s
	iters: 300, epoch: 1 | loss: 0.2914426
	speed: 0.0160s/iter; left time: 177.9033s
	iters: 400, epoch: 1 | loss: 0.2373642
	speed: 0.0161s/iter; left time: 176.6340s
	iters: 500, epoch: 1 | loss: 0.2826465
	speed: 0.0161s/iter; left time: 175.4556s
Epoch: 1 cost time: 10.376337051391602
Epoch: 1, Steps: 570 | Train Loss: 0.2493833 Vali Loss: 0.0467754 Test Loss: 0.1420881
Validation loss decreased (inf --> 0.046775).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1900936
	speed: 0.0475s/iter; left time: 509.8713s
	iters: 200, epoch: 2 | loss: 0.2193269
	speed: 0.0144s/iter; left time: 153.3413s
	iters: 300, epoch: 2 | loss: 0.1439174
	speed: 0.0144s/iter; left time: 151.7634s
	iters: 400, epoch: 2 | loss: 0.1681918
	speed: 0.0144s/iter; left time: 150.3335s
	iters: 500, epoch: 2 | loss: 0.2402062
	speed: 0.0144s/iter; left time: 149.1038s
Epoch: 2 cost time: 8.545698404312134
Epoch: 2, Steps: 570 | Train Loss: 0.2090211 Vali Loss: 0.0434395 Test Loss: 0.1385605
Validation loss decreased (0.046775 --> 0.043440).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2056979
	speed: 0.0457s/iter; left time: 464.7102s
	iters: 200, epoch: 3 | loss: 0.2125686
	speed: 0.0143s/iter; left time: 144.2126s
	iters: 300, epoch: 3 | loss: 0.1561041
	speed: 0.0143s/iter; left time: 142.3847s
	iters: 400, epoch: 3 | loss: 0.1571902
	speed: 0.0143s/iter; left time: 141.0359s
	iters: 500, epoch: 3 | loss: 0.2057050
	speed: 0.0144s/iter; left time: 140.4524s
Epoch: 3 cost time: 8.46859335899353
Epoch: 3, Steps: 570 | Train Loss: 0.1796085 Vali Loss: 0.0421454 Test Loss: 0.1335378
Validation loss decreased (0.043440 --> 0.042145).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2165372
	speed: 0.0474s/iter; left time: 454.9470s
	iters: 200, epoch: 4 | loss: 0.1942196
	speed: 0.0144s/iter; left time: 136.5413s
	iters: 300, epoch: 4 | loss: 0.1731071
	speed: 0.0144s/iter; left time: 135.2055s
	iters: 400, epoch: 4 | loss: 0.1457002
	speed: 0.0144s/iter; left time: 133.5109s
	iters: 500, epoch: 4 | loss: 0.1088841
	speed: 0.0143s/iter; left time: 131.8516s
Epoch: 4 cost time: 8.465720891952515
Epoch: 4, Steps: 570 | Train Loss: 0.1631498 Vali Loss: 0.0403996 Test Loss: 0.1263688
Validation loss decreased (0.042145 --> 0.040400).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1325023
	speed: 0.0462s/iter; left time: 416.8528s
	iters: 200, epoch: 5 | loss: 0.1555424
	speed: 0.0143s/iter; left time: 127.9026s
	iters: 300, epoch: 5 | loss: 0.1323898
	speed: 0.0143s/iter; left time: 126.2341s
	iters: 400, epoch: 5 | loss: 0.2263586
	speed: 0.0143s/iter; left time: 125.1155s
	iters: 500, epoch: 5 | loss: 0.1418733
	speed: 0.0143s/iter; left time: 123.6100s
Epoch: 5 cost time: 8.454774856567383
Epoch: 5, Steps: 570 | Train Loss: 0.1533076 Vali Loss: 0.0393731 Test Loss: 0.1267292
Validation loss decreased (0.040400 --> 0.039373).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1757096
	speed: 0.0455s/iter; left time: 384.6481s
	iters: 200, epoch: 6 | loss: 0.1593852
	speed: 0.0143s/iter; left time: 119.5281s
	iters: 300, epoch: 6 | loss: 0.1035415
	speed: 0.0143s/iter; left time: 117.9671s
	iters: 400, epoch: 6 | loss: 0.1843241
	speed: 0.0143s/iter; left time: 116.3378s
	iters: 500, epoch: 6 | loss: 0.1459927
	speed: 0.0144s/iter; left time: 115.6713s
Epoch: 6 cost time: 8.468841314315796
Epoch: 6, Steps: 570 | Train Loss: 0.1486886 Vali Loss: 0.0387617 Test Loss: 0.1253418
Validation loss decreased (0.039373 --> 0.038762).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1954851
	speed: 0.0459s/iter; left time: 361.8052s
	iters: 200, epoch: 7 | loss: 0.0975353
	speed: 0.0144s/iter; left time: 112.0767s
	iters: 300, epoch: 7 | loss: 0.0966628
	speed: 0.0144s/iter; left time: 110.4170s
	iters: 400, epoch: 7 | loss: 0.2145246
	speed: 0.0144s/iter; left time: 108.8482s
	iters: 500, epoch: 7 | loss: 0.1329321
	speed: 0.0144s/iter; left time: 107.3684s
Epoch: 7 cost time: 8.479830503463745
Epoch: 7, Steps: 570 | Train Loss: 0.1470587 Vali Loss: 0.0387335 Test Loss: 0.1235380
Validation loss decreased (0.038762 --> 0.038734).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1238119
	speed: 0.0481s/iter; left time: 351.5699s
	iters: 200, epoch: 8 | loss: 0.1432588
	speed: 0.0161s/iter; left time: 115.9629s
	iters: 300, epoch: 8 | loss: 0.1247279
	speed: 0.0161s/iter; left time: 114.4182s
	iters: 400, epoch: 8 | loss: 0.1522371
	speed: 0.0161s/iter; left time: 112.8314s
	iters: 500, epoch: 8 | loss: 0.0975019
	speed: 0.0161s/iter; left time: 111.0902s
Epoch: 8 cost time: 9.46516227722168
Epoch: 8, Steps: 570 | Train Loss: 0.1456697 Vali Loss: 0.0395853 Test Loss: 0.1261854
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2091442
	speed: 0.0488s/iter; left time: 328.7253s
	iters: 200, epoch: 9 | loss: 0.1126706
	speed: 0.0143s/iter; left time: 94.6984s
	iters: 300, epoch: 9 | loss: 0.0992757
	speed: 0.0142s/iter; left time: 92.9942s
	iters: 400, epoch: 9 | loss: 0.1102065
	speed: 0.0143s/iter; left time: 91.8461s
	iters: 500, epoch: 9 | loss: 0.1507562
	speed: 0.0142s/iter; left time: 90.3063s
Epoch: 9 cost time: 8.406576871871948
Epoch: 9, Steps: 570 | Train Loss: 0.1442083 Vali Loss: 0.0391426 Test Loss: 0.1253360
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1900224
	speed: 0.0457s/iter; left time: 282.0995s
	iters: 200, epoch: 10 | loss: 0.1614278
	speed: 0.0143s/iter; left time: 86.9082s
	iters: 300, epoch: 10 | loss: 0.1242339
	speed: 0.0143s/iter; left time: 85.3619s
	iters: 400, epoch: 10 | loss: 0.1666936
	speed: 0.0143s/iter; left time: 83.8430s
	iters: 500, epoch: 10 | loss: 0.1359811
	speed: 0.0143s/iter; left time: 82.3971s
Epoch: 10 cost time: 8.43296504020691
Epoch: 10, Steps: 570 | Train Loss: 0.1436869 Vali Loss: 0.0391266 Test Loss: 0.1257459
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12369126081466675, mae:0.22086134552955627
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2958392
	speed: 0.0285s/iter; left time: 322.2408s
	iters: 200, epoch: 1 | loss: 0.1971780
	speed: 0.0169s/iter; left time: 189.1001s
	iters: 300, epoch: 1 | loss: 0.2727989
	speed: 0.0169s/iter; left time: 187.3281s
	iters: 400, epoch: 1 | loss: 0.2513632
	speed: 0.0169s/iter; left time: 185.5309s
	iters: 500, epoch: 1 | loss: 0.2136229
	speed: 0.0169s/iter; left time: 184.0538s
Epoch: 1 cost time: 10.839314937591553
Epoch: 1, Steps: 570 | Train Loss: 0.2550540 Vali Loss: 0.0474312 Test Loss: 0.1496193
Validation loss decreased (inf --> 0.047431).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2432267
	speed: 0.0536s/iter; left time: 575.5611s
	iters: 200, epoch: 2 | loss: 0.2498724
	speed: 0.0184s/iter; left time: 195.6841s
	iters: 300, epoch: 2 | loss: 0.2779619
	speed: 0.0184s/iter; left time: 193.8712s
	iters: 400, epoch: 2 | loss: 0.1651098
	speed: 0.0184s/iter; left time: 192.3050s
	iters: 500, epoch: 2 | loss: 0.1844755
	speed: 0.0184s/iter; left time: 190.0112s
Epoch: 2 cost time: 10.833738803863525
Epoch: 2, Steps: 570 | Train Loss: 0.2384399 Vali Loss: 0.0586837 Test Loss: 0.1700942
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2058848
	speed: 0.0511s/iter; left time: 519.3342s
	iters: 200, epoch: 3 | loss: 0.1983583
	speed: 0.0169s/iter; left time: 170.0875s
	iters: 300, epoch: 3 | loss: 0.3410145
	speed: 0.0169s/iter; left time: 168.5601s
	iters: 400, epoch: 3 | loss: 0.1681196
	speed: 0.0169s/iter; left time: 166.9948s
	iters: 500, epoch: 3 | loss: 0.1727709
	speed: 0.0169s/iter; left time: 165.0291s
Epoch: 3 cost time: 9.908249139785767
Epoch: 3, Steps: 570 | Train Loss: 0.2248720 Vali Loss: 0.0464250 Test Loss: 0.1407486
Validation loss decreased (0.047431 --> 0.046425).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1574557
	speed: 0.0507s/iter; left time: 485.8731s
	iters: 200, epoch: 4 | loss: 0.2051149
	speed: 0.0170s/iter; left time: 161.7069s
	iters: 300, epoch: 4 | loss: 0.2613001
	speed: 0.0170s/iter; left time: 159.5988s
	iters: 400, epoch: 4 | loss: 0.2122735
	speed: 0.0170s/iter; left time: 157.9913s
	iters: 500, epoch: 4 | loss: 0.2093787
	speed: 0.0170s/iter; left time: 156.0262s
Epoch: 4 cost time: 9.998785734176636
Epoch: 4, Steps: 570 | Train Loss: 0.1972890 Vali Loss: 0.0443675 Test Loss: 0.1331053
Validation loss decreased (0.046425 --> 0.044367).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1237682
	speed: 0.0514s/iter; left time: 463.2443s
	iters: 200, epoch: 5 | loss: 0.2852994
	speed: 0.0169s/iter; left time: 150.6697s
	iters: 300, epoch: 5 | loss: 0.1794762
	speed: 0.0169s/iter; left time: 149.1781s
	iters: 400, epoch: 5 | loss: 0.2154945
	speed: 0.0169s/iter; left time: 147.1516s
	iters: 500, epoch: 5 | loss: 0.1389254
	speed: 0.0169s/iter; left time: 145.4861s
Epoch: 5 cost time: 9.947157382965088
Epoch: 5, Steps: 570 | Train Loss: 0.1862711 Vali Loss: 0.0417370 Test Loss: 0.1288609
Validation loss decreased (0.044367 --> 0.041737).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2081187
	speed: 0.0506s/iter; left time: 427.8846s
	iters: 200, epoch: 6 | loss: 0.1423266
	speed: 0.0170s/iter; left time: 141.5545s
	iters: 300, epoch: 6 | loss: 0.2063590
	speed: 0.0170s/iter; left time: 140.0016s
	iters: 400, epoch: 6 | loss: 0.2357511
	speed: 0.0170s/iter; left time: 138.2698s
	iters: 500, epoch: 6 | loss: 0.1809550
	speed: 0.0170s/iter; left time: 136.5288s
Epoch: 6 cost time: 9.975769281387329
Epoch: 6, Steps: 570 | Train Loss: 0.1806376 Vali Loss: 0.0412314 Test Loss: 0.1279439
Validation loss decreased (0.041737 --> 0.041231).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1608773
	speed: 0.0511s/iter; left time: 403.0290s
	iters: 200, epoch: 7 | loss: 0.2030581
	speed: 0.0169s/iter; left time: 131.2317s
	iters: 300, epoch: 7 | loss: 0.2310962
	speed: 0.0169s/iter; left time: 129.6130s
	iters: 400, epoch: 7 | loss: 0.1222981
	speed: 0.0169s/iter; left time: 127.8520s
	iters: 500, epoch: 7 | loss: 0.1308530
	speed: 0.0169s/iter; left time: 126.1580s
Epoch: 7 cost time: 9.919497966766357
Epoch: 7, Steps: 570 | Train Loss: 0.1756744 Vali Loss: 0.0416139 Test Loss: 0.1276427
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1781857
	speed: 0.0544s/iter; left time: 397.3546s
	iters: 200, epoch: 8 | loss: 0.1287111
	speed: 0.0168s/iter; left time: 121.3585s
	iters: 300, epoch: 8 | loss: 0.1429879
	speed: 0.0169s/iter; left time: 119.8929s
	iters: 400, epoch: 8 | loss: 0.1149336
	speed: 0.0168s/iter; left time: 118.1317s
	iters: 500, epoch: 8 | loss: 0.1402981
	speed: 0.0168s/iter; left time: 116.2740s
Epoch: 8 cost time: 10.037273645401001
Epoch: 8, Steps: 570 | Train Loss: 0.1750025 Vali Loss: 0.0413127 Test Loss: 0.1273950
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1620007
	speed: 0.0513s/iter; left time: 345.9794s
	iters: 200, epoch: 9 | loss: 0.1230296
	speed: 0.0185s/iter; left time: 122.6134s
	iters: 300, epoch: 9 | loss: 0.1626625
	speed: 0.0184s/iter; left time: 120.5394s
	iters: 400, epoch: 9 | loss: 0.2064057
	speed: 0.0184s/iter; left time: 118.6376s
	iters: 500, epoch: 9 | loss: 0.2402835
	speed: 0.0184s/iter; left time: 116.9165s
Epoch: 9 cost time: 10.793215274810791
Epoch: 9, Steps: 570 | Train Loss: 0.1738157 Vali Loss: 0.0414313 Test Loss: 0.1275823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1281076818704605, mae:0.2205001711845398
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2068312
	speed: 0.0281s/iter; left time: 317.8935s
	iters: 200, epoch: 1 | loss: 0.1475040
	speed: 0.0164s/iter; left time: 183.3206s
	iters: 300, epoch: 1 | loss: 0.2655107
	speed: 0.0163s/iter; left time: 181.4744s
	iters: 400, epoch: 1 | loss: 0.1900390
	speed: 0.0163s/iter; left time: 179.8589s
	iters: 500, epoch: 1 | loss: 0.1433915
	speed: 0.0164s/iter; left time: 178.5096s
Epoch: 1 cost time: 10.557101249694824
Epoch: 1, Steps: 570 | Train Loss: 0.2343052 Vali Loss: 0.0426553 Test Loss: 0.1378862
Validation loss decreased (inf --> 0.042655).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1608283
	speed: 0.0507s/iter; left time: 544.1490s
	iters: 200, epoch: 2 | loss: 0.1833935
	speed: 0.0164s/iter; left time: 174.2195s
	iters: 300, epoch: 2 | loss: 0.2451425
	speed: 0.0164s/iter; left time: 172.2778s
	iters: 400, epoch: 2 | loss: 0.3889318
	speed: 0.0164s/iter; left time: 170.7457s
	iters: 500, epoch: 2 | loss: 0.2141431
	speed: 0.0164s/iter; left time: 168.9845s
Epoch: 2 cost time: 9.647379875183105
Epoch: 2, Steps: 570 | Train Loss: 0.2236655 Vali Loss: 0.0419637 Test Loss: 0.1399358
Validation loss decreased (0.042655 --> 0.041964).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2036266
	speed: 0.0500s/iter; left time: 508.3199s
	iters: 200, epoch: 3 | loss: 0.2122304
	speed: 0.0164s/iter; left time: 164.8407s
	iters: 300, epoch: 3 | loss: 0.1900365
	speed: 0.0164s/iter; left time: 162.9499s
	iters: 400, epoch: 3 | loss: 0.2440022
	speed: 0.0164s/iter; left time: 161.5711s
	iters: 500, epoch: 3 | loss: 0.1065650
	speed: 0.0163s/iter; left time: 159.4970s
Epoch: 3 cost time: 9.670368194580078
Epoch: 3, Steps: 570 | Train Loss: 0.1956232 Vali Loss: 0.0376617 Test Loss: 0.1246283
Validation loss decreased (0.041964 --> 0.037662).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1733230
	speed: 0.0516s/iter; left time: 494.4700s
	iters: 200, epoch: 4 | loss: 0.3698699
	speed: 0.0179s/iter; left time: 169.6777s
	iters: 300, epoch: 4 | loss: 0.1629041
	speed: 0.0179s/iter; left time: 167.6495s
	iters: 400, epoch: 4 | loss: 0.1191096
	speed: 0.0179s/iter; left time: 165.8533s
	iters: 500, epoch: 4 | loss: 0.2356152
	speed: 0.0179s/iter; left time: 164.0790s
Epoch: 4 cost time: 10.500868082046509
Epoch: 4, Steps: 570 | Train Loss: 0.1789920 Vali Loss: 0.0367390 Test Loss: 0.1175551
Validation loss decreased (0.037662 --> 0.036739).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1773712
	speed: 0.0523s/iter; left time: 471.4618s
	iters: 200, epoch: 5 | loss: 0.2478509
	speed: 0.0163s/iter; left time: 145.7352s
	iters: 300, epoch: 5 | loss: 0.1592406
	speed: 0.0163s/iter; left time: 144.1095s
	iters: 400, epoch: 5 | loss: 0.1151561
	speed: 0.0163s/iter; left time: 142.4761s
	iters: 500, epoch: 5 | loss: 0.2273076
	speed: 0.0163s/iter; left time: 140.7854s
Epoch: 5 cost time: 9.639588117599487
Epoch: 5, Steps: 570 | Train Loss: 0.1693784 Vali Loss: 0.0352099 Test Loss: 0.1135109
Validation loss decreased (0.036739 --> 0.035210).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1581204
	speed: 0.0506s/iter; left time: 427.6195s
	iters: 200, epoch: 6 | loss: 0.2331288
	speed: 0.0163s/iter; left time: 136.3150s
	iters: 300, epoch: 6 | loss: 0.2776801
	speed: 0.0163s/iter; left time: 134.7062s
	iters: 400, epoch: 6 | loss: 0.1604757
	speed: 0.0163s/iter; left time: 133.0879s
	iters: 500, epoch: 6 | loss: 0.1558830
	speed: 0.0163s/iter; left time: 131.4517s
Epoch: 6 cost time: 9.636428594589233
Epoch: 6, Steps: 570 | Train Loss: 0.1640407 Vali Loss: 0.0348077 Test Loss: 0.1118976
Validation loss decreased (0.035210 --> 0.034808).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2196183
	speed: 0.0531s/iter; left time: 418.5698s
	iters: 200, epoch: 7 | loss: 0.1099205
	speed: 0.0173s/iter; left time: 134.4823s
	iters: 300, epoch: 7 | loss: 0.1736868
	speed: 0.0179s/iter; left time: 137.2705s
	iters: 400, epoch: 7 | loss: 0.2072969
	speed: 0.0179s/iter; left time: 135.4448s
	iters: 500, epoch: 7 | loss: 0.2354021
	speed: 0.0179s/iter; left time: 133.7909s
Epoch: 7 cost time: 10.291216850280762
Epoch: 7, Steps: 570 | Train Loss: 0.1619769 Vali Loss: 0.0341742 Test Loss: 0.1114734
Validation loss decreased (0.034808 --> 0.034174).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0833036
	speed: 0.0526s/iter; left time: 384.8718s
	iters: 200, epoch: 8 | loss: 0.2457558
	speed: 0.0176s/iter; left time: 127.1420s
	iters: 300, epoch: 8 | loss: 0.1971235
	speed: 0.0164s/iter; left time: 116.3334s
	iters: 400, epoch: 8 | loss: 0.1781801
	speed: 0.0163s/iter; left time: 114.5034s
	iters: 500, epoch: 8 | loss: 0.1443961
	speed: 0.0164s/iter; left time: 113.0711s
Epoch: 8 cost time: 9.924705266952515
Epoch: 8, Steps: 570 | Train Loss: 0.1589763 Vali Loss: 0.0339690 Test Loss: 0.1106487
Validation loss decreased (0.034174 --> 0.033969).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0992123
	speed: 0.0530s/iter; left time: 357.5010s
	iters: 200, epoch: 9 | loss: 0.1586944
	speed: 0.0164s/iter; left time: 108.9021s
	iters: 300, epoch: 9 | loss: 0.0967666
	speed: 0.0164s/iter; left time: 107.1550s
	iters: 400, epoch: 9 | loss: 0.1272036
	speed: 0.0164s/iter; left time: 105.4709s
	iters: 500, epoch: 9 | loss: 0.0852321
	speed: 0.0164s/iter; left time: 103.7935s
Epoch: 9 cost time: 9.662972927093506
Epoch: 9, Steps: 570 | Train Loss: 0.1580761 Vali Loss: 0.0339173 Test Loss: 0.1107529
Validation loss decreased (0.033969 --> 0.033917).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1669910
	speed: 0.0499s/iter; left time: 307.7782s
	iters: 200, epoch: 10 | loss: 0.1650951
	speed: 0.0164s/iter; left time: 99.3241s
	iters: 300, epoch: 10 | loss: 0.1311248
	speed: 0.0163s/iter; left time: 97.6031s
	iters: 400, epoch: 10 | loss: 0.1945249
	speed: 0.0163s/iter; left time: 95.8499s
	iters: 500, epoch: 10 | loss: 0.1179071
	speed: 0.0163s/iter; left time: 94.1885s
Epoch: 10 cost time: 9.647021293640137
Epoch: 10, Steps: 570 | Train Loss: 0.1578447 Vali Loss: 0.0338990 Test Loss: 0.1106659
Validation loss decreased (0.033917 --> 0.033899).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1007985
	speed: 0.0507s/iter; left time: 284.1840s
	iters: 200, epoch: 11 | loss: 0.1268860
	speed: 0.0164s/iter; left time: 90.1351s
	iters: 300, epoch: 11 | loss: 0.1053247
	speed: 0.0164s/iter; left time: 88.4082s
	iters: 400, epoch: 11 | loss: 0.1901793
	speed: 0.0164s/iter; left time: 86.7814s
	iters: 500, epoch: 11 | loss: 0.1574086
	speed: 0.0164s/iter; left time: 85.1883s
Epoch: 11 cost time: 9.641788721084595
Epoch: 11, Steps: 570 | Train Loss: 0.1576925 Vali Loss: 0.0340112 Test Loss: 0.1106179
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1106339
	speed: 0.0485s/iter; left time: 244.1176s
	iters: 200, epoch: 12 | loss: 0.1610774
	speed: 0.0163s/iter; left time: 80.3285s
	iters: 300, epoch: 12 | loss: 0.0931303
	speed: 0.0163s/iter; left time: 78.6510s
	iters: 400, epoch: 12 | loss: 0.1648269
	speed: 0.0163s/iter; left time: 76.9417s
	iters: 500, epoch: 12 | loss: 0.2387092
	speed: 0.0163s/iter; left time: 75.3128s
Epoch: 12 cost time: 9.548754215240479
Epoch: 12, Steps: 570 | Train Loss: 0.1574193 Vali Loss: 0.0339695 Test Loss: 0.1105909
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2163615
	speed: 0.0500s/iter; left time: 222.9688s
	iters: 200, epoch: 13 | loss: 0.2399940
	speed: 0.0179s/iter; left time: 77.8466s
	iters: 300, epoch: 13 | loss: 0.2056655
	speed: 0.0166s/iter; left time: 70.7060s
	iters: 400, epoch: 13 | loss: 0.1324357
	speed: 0.0164s/iter; left time: 68.1810s
	iters: 500, epoch: 13 | loss: 0.1442983
	speed: 0.0164s/iter; left time: 66.5420s
Epoch: 13 cost time: 9.939443349838257
Epoch: 13, Steps: 570 | Train Loss: 0.1575063 Vali Loss: 0.0340451 Test Loss: 0.1105785
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11083490401506424, mae:0.20302008092403412
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2738749
	speed: 0.0275s/iter; left time: 310.3619s
	iters: 200, epoch: 1 | loss: 0.2410658
	speed: 0.0155s/iter; left time: 173.6929s
	iters: 300, epoch: 1 | loss: 0.1838185
	speed: 0.0155s/iter; left time: 171.9475s
	iters: 400, epoch: 1 | loss: 0.3203909
	speed: 0.0155s/iter; left time: 170.5481s
	iters: 500, epoch: 1 | loss: 0.3899314
	speed: 0.0155s/iter; left time: 169.4090s
Epoch: 1 cost time: 10.090262413024902
Epoch: 1, Steps: 570 | Train Loss: 0.2626514 Vali Loss: 0.0484837 Test Loss: 0.1565852
Validation loss decreased (inf --> 0.048484).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2507294
	speed: 0.0485s/iter; left time: 520.7494s
	iters: 200, epoch: 2 | loss: 0.1554500
	speed: 0.0155s/iter; left time: 164.8120s
	iters: 300, epoch: 2 | loss: 0.2832112
	speed: 0.0155s/iter; left time: 163.0682s
	iters: 400, epoch: 2 | loss: 0.2342743
	speed: 0.0155s/iter; left time: 161.4259s
	iters: 500, epoch: 2 | loss: 0.3202891
	speed: 0.0155s/iter; left time: 159.6520s
Epoch: 2 cost time: 9.138121604919434
Epoch: 2, Steps: 570 | Train Loss: 0.2514978 Vali Loss: 0.0754417 Test Loss: 0.2028981
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3472426
	speed: 0.0493s/iter; left time: 500.6107s
	iters: 200, epoch: 3 | loss: 0.1513417
	speed: 0.0166s/iter; left time: 167.3722s
	iters: 300, epoch: 3 | loss: 0.3537053
	speed: 0.0155s/iter; left time: 154.5596s
	iters: 400, epoch: 3 | loss: 0.2166460
	speed: 0.0155s/iter; left time: 152.8640s
	iters: 500, epoch: 3 | loss: 0.2753240
	speed: 0.0155s/iter; left time: 151.3949s
Epoch: 3 cost time: 9.391047954559326
Epoch: 3, Steps: 570 | Train Loss: 0.2626431 Vali Loss: 0.0480382 Test Loss: 0.1509399
Validation loss decreased (0.048484 --> 0.048038).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1961316
	speed: 0.0496s/iter; left time: 475.7817s
	iters: 200, epoch: 4 | loss: 0.2935966
	speed: 0.0154s/iter; left time: 146.2607s
	iters: 300, epoch: 4 | loss: 0.3480114
	speed: 0.0154s/iter; left time: 144.7810s
	iters: 400, epoch: 4 | loss: 0.2189986
	speed: 0.0154s/iter; left time: 143.3231s
	iters: 500, epoch: 4 | loss: 0.2833834
	speed: 0.0154s/iter; left time: 141.5829s
Epoch: 4 cost time: 9.212220430374146
Epoch: 4, Steps: 570 | Train Loss: 0.2311800 Vali Loss: 0.0482368 Test Loss: 0.1470153
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1678876
	speed: 0.0485s/iter; left time: 437.4913s
	iters: 200, epoch: 5 | loss: 0.1962808
	speed: 0.0155s/iter; left time: 138.2203s
	iters: 300, epoch: 5 | loss: 0.1936736
	speed: 0.0155s/iter; left time: 136.5428s
	iters: 400, epoch: 5 | loss: 0.1584071
	speed: 0.0155s/iter; left time: 135.3497s
	iters: 500, epoch: 5 | loss: 0.2072518
	speed: 0.0155s/iter; left time: 133.6773s
Epoch: 5 cost time: 9.101691246032715
Epoch: 5, Steps: 570 | Train Loss: 0.2162158 Vali Loss: 0.0466264 Test Loss: 0.1401968
Validation loss decreased (0.048038 --> 0.046626).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1975028
	speed: 0.0494s/iter; left time: 417.1441s
	iters: 200, epoch: 6 | loss: 0.1984609
	speed: 0.0155s/iter; left time: 129.2948s
	iters: 300, epoch: 6 | loss: 0.1290805
	speed: 0.0155s/iter; left time: 127.7308s
	iters: 400, epoch: 6 | loss: 0.1410978
	speed: 0.0155s/iter; left time: 126.2343s
	iters: 500, epoch: 6 | loss: 0.1558844
	speed: 0.0155s/iter; left time: 124.8247s
Epoch: 6 cost time: 9.136810541152954
Epoch: 6, Steps: 570 | Train Loss: 0.2068572 Vali Loss: 0.0456033 Test Loss: 0.1415516
Validation loss decreased (0.046626 --> 0.045603).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2529387
	speed: 0.0498s/iter; left time: 392.5874s
	iters: 200, epoch: 7 | loss: 0.1949639
	speed: 0.0155s/iter; left time: 120.7829s
	iters: 300, epoch: 7 | loss: 0.1584079
	speed: 0.0155s/iter; left time: 119.1620s
	iters: 400, epoch: 7 | loss: 0.2333105
	speed: 0.0155s/iter; left time: 117.4209s
	iters: 500, epoch: 7 | loss: 0.2131604
	speed: 0.0155s/iter; left time: 115.8617s
Epoch: 7 cost time: 9.139897346496582
Epoch: 7, Steps: 570 | Train Loss: 0.2030053 Vali Loss: 0.0455402 Test Loss: 0.1392490
Validation loss decreased (0.045603 --> 0.045540).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1815846
	speed: 0.0483s/iter; left time: 352.8234s
	iters: 200, epoch: 8 | loss: 0.2485581
	speed: 0.0154s/iter; left time: 111.1243s
	iters: 300, epoch: 8 | loss: 0.1278086
	speed: 0.0154s/iter; left time: 109.6528s
	iters: 400, epoch: 8 | loss: 0.1952574
	speed: 0.0154s/iter; left time: 108.0397s
	iters: 500, epoch: 8 | loss: 0.1229836
	speed: 0.0154s/iter; left time: 106.3601s
Epoch: 8 cost time: 9.109086036682129
Epoch: 8, Steps: 570 | Train Loss: 0.2005512 Vali Loss: 0.0445065 Test Loss: 0.1393705
Validation loss decreased (0.045540 --> 0.044507).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1886239
	speed: 0.0482s/iter; left time: 325.0373s
	iters: 200, epoch: 9 | loss: 0.1721874
	speed: 0.0155s/iter; left time: 103.2036s
	iters: 300, epoch: 9 | loss: 0.2327887
	speed: 0.0155s/iter; left time: 101.7076s
	iters: 400, epoch: 9 | loss: 0.1441329
	speed: 0.0155s/iter; left time: 99.9730s
	iters: 500, epoch: 9 | loss: 0.1836031
	speed: 0.0154s/iter; left time: 97.9152s
Epoch: 9 cost time: 9.143268823623657
Epoch: 9, Steps: 570 | Train Loss: 0.1996132 Vali Loss: 0.0446082 Test Loss: 0.1392387
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.2538546
	speed: 0.0484s/iter; left time: 298.8069s
	iters: 200, epoch: 10 | loss: 0.2266675
	speed: 0.0154s/iter; left time: 93.6166s
	iters: 300, epoch: 10 | loss: 0.1425828
	speed: 0.0154s/iter; left time: 92.1785s
	iters: 400, epoch: 10 | loss: 0.2254750
	speed: 0.0154s/iter; left time: 90.4436s
	iters: 500, epoch: 10 | loss: 0.3943844
	speed: 0.0154s/iter; left time: 88.8987s
Epoch: 10 cost time: 9.082751750946045
Epoch: 10, Steps: 570 | Train Loss: 0.2003246 Vali Loss: 0.0444149 Test Loss: 0.1389218
Validation loss decreased (0.044507 --> 0.044415).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2145433
	speed: 0.0501s/iter; left time: 280.7556s
	iters: 200, epoch: 11 | loss: 0.1607526
	speed: 0.0171s/iter; left time: 93.9033s
	iters: 300, epoch: 11 | loss: 0.1815906
	speed: 0.0157s/iter; left time: 84.5967s
	iters: 400, epoch: 11 | loss: 0.2530977
	speed: 0.0167s/iter; left time: 88.6080s
	iters: 500, epoch: 11 | loss: 0.2577681
	speed: 0.0170s/iter; left time: 88.6510s
Epoch: 11 cost time: 9.810497760772705
Epoch: 11, Steps: 570 | Train Loss: 0.1997284 Vali Loss: 0.0445360 Test Loss: 0.1388688
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1345384
	speed: 0.0496s/iter; left time: 249.5023s
	iters: 200, epoch: 12 | loss: 0.3895433
	speed: 0.0155s/iter; left time: 76.5096s
	iters: 300, epoch: 12 | loss: 0.2682382
	speed: 0.0155s/iter; left time: 74.7900s
	iters: 400, epoch: 12 | loss: 0.1882094
	speed: 0.0155s/iter; left time: 73.4105s
	iters: 500, epoch: 12 | loss: 0.1769363
	speed: 0.0155s/iter; left time: 71.8469s
Epoch: 12 cost time: 9.14151406288147
Epoch: 12, Steps: 570 | Train Loss: 0.2000720 Vali Loss: 0.0445321 Test Loss: 0.1389161
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2760415
	speed: 0.0473s/iter; left time: 211.1145s
	iters: 200, epoch: 13 | loss: 0.1822870
	speed: 0.0154s/iter; left time: 67.1599s
	iters: 300, epoch: 13 | loss: 0.1951600
	speed: 0.0154s/iter; left time: 65.5237s
	iters: 400, epoch: 13 | loss: 0.2494859
	speed: 0.0154s/iter; left time: 63.8932s
	iters: 500, epoch: 13 | loss: 0.1471906
	speed: 0.0153s/iter; left time: 62.3355s
Epoch: 13 cost time: 9.048424005508423
Epoch: 13, Steps: 570 | Train Loss: 0.2007352 Vali Loss: 0.0444837 Test Loss: 0.1388606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1390725076198578, mae:0.2316804677248001
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1979800
	speed: 0.0326s/iter; left time: 368.8988s
	iters: 200, epoch: 1 | loss: 0.2329361
	speed: 0.0208s/iter; left time: 233.1651s
	iters: 300, epoch: 1 | loss: 0.3890593
	speed: 0.0208s/iter; left time: 231.2810s
	iters: 400, epoch: 1 | loss: 0.1947859
	speed: 0.0208s/iter; left time: 229.3678s
	iters: 500, epoch: 1 | loss: 0.1655631
	speed: 0.0208s/iter; left time: 227.0225s
Epoch: 1 cost time: 13.11115312576294
Epoch: 1, Steps: 570 | Train Loss: 0.2447270 Vali Loss: 0.0476489 Test Loss: 0.1459083
Validation loss decreased (inf --> 0.047649).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3815386
	speed: 0.0610s/iter; left time: 654.7736s
	iters: 200, epoch: 2 | loss: 0.1765963
	speed: 0.0209s/iter; left time: 222.3061s
	iters: 300, epoch: 2 | loss: 0.1362110
	speed: 0.0210s/iter; left time: 220.9059s
	iters: 400, epoch: 2 | loss: 0.1704368
	speed: 0.0209s/iter; left time: 218.0653s
	iters: 500, epoch: 2 | loss: 0.1821329
	speed: 0.0209s/iter; left time: 216.1040s
Epoch: 2 cost time: 12.284221649169922
Epoch: 2, Steps: 570 | Train Loss: 0.2095919 Vali Loss: 0.0445460 Test Loss: 0.1347510
Validation loss decreased (0.047649 --> 0.044546).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1477922
	speed: 0.0579s/iter; left time: 588.2886s
	iters: 200, epoch: 3 | loss: 0.1658632
	speed: 0.0186s/iter; left time: 187.3165s
	iters: 300, epoch: 3 | loss: 0.2155154
	speed: 0.0186s/iter; left time: 185.3815s
	iters: 400, epoch: 3 | loss: 0.1262809
	speed: 0.0186s/iter; left time: 183.4741s
	iters: 500, epoch: 3 | loss: 0.1303732
	speed: 0.0186s/iter; left time: 181.6676s
Epoch: 3 cost time: 10.898059606552124
Epoch: 3, Steps: 570 | Train Loss: 0.1854190 Vali Loss: 0.0436595 Test Loss: 0.1318966
Validation loss decreased (0.044546 --> 0.043659).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1870910
	speed: 0.0578s/iter; left time: 554.5740s
	iters: 200, epoch: 4 | loss: 0.2351542
	speed: 0.0186s/iter; left time: 176.5074s
	iters: 300, epoch: 4 | loss: 0.1840209
	speed: 0.0186s/iter; left time: 174.6957s
	iters: 400, epoch: 4 | loss: 0.0944235
	speed: 0.0186s/iter; left time: 172.6014s
	iters: 500, epoch: 4 | loss: 0.1628318
	speed: 0.0186s/iter; left time: 170.7546s
Epoch: 4 cost time: 10.881864070892334
Epoch: 4, Steps: 570 | Train Loss: 0.1660591 Vali Loss: 0.0401228 Test Loss: 0.1307222
Validation loss decreased (0.043659 --> 0.040123).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2354830
	speed: 0.0609s/iter; left time: 549.7587s
	iters: 200, epoch: 5 | loss: 0.1616431
	speed: 0.0209s/iter; left time: 186.7907s
	iters: 300, epoch: 5 | loss: 0.1415432
	speed: 0.0209s/iter; left time: 184.3843s
	iters: 400, epoch: 5 | loss: 0.1302704
	speed: 0.0209s/iter; left time: 182.3200s
	iters: 500, epoch: 5 | loss: 0.1366715
	speed: 0.0209s/iter; left time: 180.1316s
Epoch: 5 cost time: 12.297125577926636
Epoch: 5, Steps: 570 | Train Loss: 0.1549483 Vali Loss: 0.0393205 Test Loss: 0.1318874
Validation loss decreased (0.040123 --> 0.039320).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0862106
	speed: 0.0599s/iter; left time: 505.8721s
	iters: 200, epoch: 6 | loss: 0.1426957
	speed: 0.0186s/iter; left time: 155.5936s
	iters: 300, epoch: 6 | loss: 0.1217947
	speed: 0.0187s/iter; left time: 153.9948s
	iters: 400, epoch: 6 | loss: 0.1642987
	speed: 0.0187s/iter; left time: 152.2064s
	iters: 500, epoch: 6 | loss: 0.1378561
	speed: 0.0187s/iter; left time: 150.3653s
Epoch: 6 cost time: 10.968008756637573
Epoch: 6, Steps: 570 | Train Loss: 0.1476896 Vali Loss: 0.0385074 Test Loss: 0.1282430
Validation loss decreased (0.039320 --> 0.038507).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1076406
	speed: 0.0562s/iter; left time: 443.1389s
	iters: 200, epoch: 7 | loss: 0.1230809
	speed: 0.0186s/iter; left time: 144.6945s
	iters: 300, epoch: 7 | loss: 0.1243722
	speed: 0.0186s/iter; left time: 142.8189s
	iters: 400, epoch: 7 | loss: 0.1548696
	speed: 0.0186s/iter; left time: 140.9159s
	iters: 500, epoch: 7 | loss: 0.2566475
	speed: 0.0186s/iter; left time: 139.0841s
Epoch: 7 cost time: 10.904294967651367
Epoch: 7, Steps: 570 | Train Loss: 0.1445968 Vali Loss: 0.0385820 Test Loss: 0.1284373
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1278794
	speed: 0.0566s/iter; left time: 414.0556s
	iters: 200, epoch: 8 | loss: 0.1256059
	speed: 0.0186s/iter; left time: 134.3463s
	iters: 300, epoch: 8 | loss: 0.1016735
	speed: 0.0186s/iter; left time: 132.5265s
	iters: 400, epoch: 8 | loss: 0.1710809
	speed: 0.0186s/iter; left time: 130.6339s
	iters: 500, epoch: 8 | loss: 0.1221571
	speed: 0.0187s/iter; left time: 128.9319s
Epoch: 8 cost time: 10.919054508209229
Epoch: 8, Steps: 570 | Train Loss: 0.1430321 Vali Loss: 0.0382561 Test Loss: 0.1283470
Validation loss decreased (0.038507 --> 0.038256).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0890513
	speed: 0.0595s/iter; left time: 401.0338s
	iters: 200, epoch: 9 | loss: 0.1911742
	speed: 0.0185s/iter; left time: 123.1864s
	iters: 300, epoch: 9 | loss: 0.0837665
	speed: 0.0186s/iter; left time: 121.3380s
	iters: 400, epoch: 9 | loss: 0.1713939
	speed: 0.0185s/iter; left time: 119.3337s
	iters: 500, epoch: 9 | loss: 0.0705790
	speed: 0.0185s/iter; left time: 117.4699s
Epoch: 9 cost time: 10.873522996902466
Epoch: 9, Steps: 570 | Train Loss: 0.1432252 Vali Loss: 0.0386749 Test Loss: 0.1292707
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1382120
	speed: 0.0579s/iter; left time: 357.0262s
	iters: 200, epoch: 10 | loss: 0.1594550
	speed: 0.0186s/iter; left time: 112.9534s
	iters: 300, epoch: 10 | loss: 0.1034489
	speed: 0.0186s/iter; left time: 111.0560s
	iters: 400, epoch: 10 | loss: 0.1186969
	speed: 0.0186s/iter; left time: 109.1687s
	iters: 500, epoch: 10 | loss: 0.1209665
	speed: 0.0186s/iter; left time: 107.3602s
Epoch: 10 cost time: 10.919167518615723
Epoch: 10, Steps: 570 | Train Loss: 0.1419138 Vali Loss: 0.0382800 Test Loss: 0.1293405
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1135975
	speed: 0.0573s/iter; left time: 321.1093s
	iters: 200, epoch: 11 | loss: 0.2162677
	speed: 0.0186s/iter; left time: 102.5436s
	iters: 300, epoch: 11 | loss: 0.1270639
	speed: 0.0186s/iter; left time: 100.6226s
	iters: 400, epoch: 11 | loss: 0.0953551
	speed: 0.0186s/iter; left time: 98.8273s
	iters: 500, epoch: 11 | loss: 0.2087691
	speed: 0.0186s/iter; left time: 96.9139s
Epoch: 11 cost time: 10.94358205795288
Epoch: 11, Steps: 570 | Train Loss: 0.1425096 Vali Loss: 0.0383815 Test Loss: 0.1293128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12851981818675995, mae:0.22300393879413605
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4062195
	speed: 0.0299s/iter; left time: 337.8763s
	iters: 200, epoch: 1 | loss: 0.2367173
	speed: 0.0182s/iter; left time: 203.9359s
	iters: 300, epoch: 1 | loss: 0.1880140
	speed: 0.0182s/iter; left time: 202.0882s
	iters: 400, epoch: 1 | loss: 0.1825474
	speed: 0.0182s/iter; left time: 200.1999s
	iters: 500, epoch: 1 | loss: 0.2249993
	speed: 0.0182s/iter; left time: 198.6001s
Epoch: 1 cost time: 11.601240873336792
Epoch: 1, Steps: 570 | Train Loss: 0.2210236 Vali Loss: 0.0382343 Test Loss: 0.1270257
Validation loss decreased (inf --> 0.038234).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1443575
	speed: 0.0562s/iter; left time: 603.6077s
	iters: 200, epoch: 2 | loss: 0.2346351
	speed: 0.0182s/iter; left time: 193.6052s
	iters: 300, epoch: 2 | loss: 0.3214695
	speed: 0.0182s/iter; left time: 191.6843s
	iters: 400, epoch: 2 | loss: 0.1769039
	speed: 0.0182s/iter; left time: 189.4387s
	iters: 500, epoch: 2 | loss: 0.1559059
	speed: 0.0181s/iter; left time: 187.4731s
Epoch: 2 cost time: 10.68709397315979
Epoch: 2, Steps: 570 | Train Loss: 0.1931597 Vali Loss: 0.0417072 Test Loss: 0.1257905
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1181805
	speed: 0.0573s/iter; left time: 581.9628s
	iters: 200, epoch: 3 | loss: 0.1790282
	speed: 0.0184s/iter; left time: 185.1240s
	iters: 300, epoch: 3 | loss: 0.1843037
	speed: 0.0184s/iter; left time: 183.1656s
	iters: 400, epoch: 3 | loss: 0.1559345
	speed: 0.0184s/iter; left time: 181.6440s
	iters: 500, epoch: 3 | loss: 0.1333293
	speed: 0.0184s/iter; left time: 179.5548s
Epoch: 3 cost time: 10.742154598236084
Epoch: 3, Steps: 570 | Train Loss: 0.1680607 Vali Loss: 0.0361680 Test Loss: 0.1142172
Validation loss decreased (0.038234 --> 0.036168).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1780870
	speed: 0.0560s/iter; left time: 537.0598s
	iters: 200, epoch: 4 | loss: 0.1038720
	speed: 0.0182s/iter; left time: 172.5318s
	iters: 300, epoch: 4 | loss: 0.2237743
	speed: 0.0182s/iter; left time: 170.7578s
	iters: 400, epoch: 4 | loss: 0.1229403
	speed: 0.0182s/iter; left time: 168.8281s
	iters: 500, epoch: 4 | loss: 0.1177608
	speed: 0.0182s/iter; left time: 167.1235s
Epoch: 4 cost time: 10.66884970664978
Epoch: 4, Steps: 570 | Train Loss: 0.1538203 Vali Loss: 0.0342794 Test Loss: 0.1126993
Validation loss decreased (0.036168 --> 0.034279).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1363425
	speed: 0.0560s/iter; left time: 505.2507s
	iters: 200, epoch: 5 | loss: 0.1396369
	speed: 0.0183s/iter; left time: 163.0772s
	iters: 300, epoch: 5 | loss: 0.1429909
	speed: 0.0183s/iter; left time: 161.2278s
	iters: 400, epoch: 5 | loss: 0.1354701
	speed: 0.0182s/iter; left time: 159.1485s
	iters: 500, epoch: 5 | loss: 0.1390233
	speed: 0.0183s/iter; left time: 157.4801s
Epoch: 5 cost time: 10.7041654586792
Epoch: 5, Steps: 570 | Train Loss: 0.1457334 Vali Loss: 0.0337416 Test Loss: 0.1117296
Validation loss decreased (0.034279 --> 0.033742).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2053926
	speed: 0.0560s/iter; left time: 473.2295s
	iters: 200, epoch: 6 | loss: 0.1320635
	speed: 0.0182s/iter; left time: 152.3028s
	iters: 300, epoch: 6 | loss: 0.1648138
	speed: 0.0182s/iter; left time: 150.3460s
	iters: 400, epoch: 6 | loss: 0.1140018
	speed: 0.0183s/iter; left time: 148.9685s
	iters: 500, epoch: 6 | loss: 0.0900856
	speed: 0.0182s/iter; left time: 146.7108s
Epoch: 6 cost time: 10.700132846832275
Epoch: 6, Steps: 570 | Train Loss: 0.1408665 Vali Loss: 0.0336674 Test Loss: 0.1124479
Validation loss decreased (0.033742 --> 0.033667).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1324584
	speed: 0.0564s/iter; left time: 444.6882s
	iters: 200, epoch: 7 | loss: 0.1815987
	speed: 0.0183s/iter; left time: 142.0195s
	iters: 300, epoch: 7 | loss: 0.1007532
	speed: 0.0182s/iter; left time: 140.0296s
	iters: 400, epoch: 7 | loss: 0.1524494
	speed: 0.0182s/iter; left time: 137.8700s
	iters: 500, epoch: 7 | loss: 0.1171991
	speed: 0.0182s/iter; left time: 136.2057s
Epoch: 7 cost time: 10.666775941848755
Epoch: 7, Steps: 570 | Train Loss: 0.1371023 Vali Loss: 0.0332240 Test Loss: 0.1123765
Validation loss decreased (0.033667 --> 0.033224).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1047971
	speed: 0.0572s/iter; left time: 418.0156s
	iters: 200, epoch: 8 | loss: 0.1174079
	speed: 0.0181s/iter; left time: 130.5103s
	iters: 300, epoch: 8 | loss: 0.1243928
	speed: 0.0181s/iter; left time: 128.5077s
	iters: 400, epoch: 8 | loss: 0.1190089
	speed: 0.0181s/iter; left time: 126.7153s
	iters: 500, epoch: 8 | loss: 0.1612852
	speed: 0.0181s/iter; left time: 125.1172s
Epoch: 8 cost time: 10.64265513420105
Epoch: 8, Steps: 570 | Train Loss: 0.1349000 Vali Loss: 0.0330598 Test Loss: 0.1125979
Validation loss decreased (0.033224 --> 0.033060).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0788062
	speed: 0.0557s/iter; left time: 375.1647s
	iters: 200, epoch: 9 | loss: 0.1062236
	speed: 0.0182s/iter; left time: 120.8928s
	iters: 300, epoch: 9 | loss: 0.1499604
	speed: 0.0182s/iter; left time: 119.2844s
	iters: 400, epoch: 9 | loss: 0.1308397
	speed: 0.0182s/iter; left time: 117.5093s
	iters: 500, epoch: 9 | loss: 0.1163688
	speed: 0.0182s/iter; left time: 115.3787s
Epoch: 9 cost time: 10.688637018203735
Epoch: 9, Steps: 570 | Train Loss: 0.1347633 Vali Loss: 0.0328941 Test Loss: 0.1120978
Validation loss decreased (0.033060 --> 0.032894).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1081880
	speed: 0.0557s/iter; left time: 343.8169s
	iters: 200, epoch: 10 | loss: 0.0949696
	speed: 0.0183s/iter; left time: 111.0648s
	iters: 300, epoch: 10 | loss: 0.1786988
	speed: 0.0182s/iter; left time: 108.9389s
	iters: 400, epoch: 10 | loss: 0.1464879
	speed: 0.0183s/iter; left time: 107.2209s
	iters: 500, epoch: 10 | loss: 0.1142340
	speed: 0.0182s/iter; left time: 105.2005s
Epoch: 10 cost time: 10.755906581878662
Epoch: 10, Steps: 570 | Train Loss: 0.1351930 Vali Loss: 0.0327680 Test Loss: 0.1121678
Validation loss decreased (0.032894 --> 0.032768).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1656882
	speed: 0.0552s/iter; left time: 309.3650s
	iters: 200, epoch: 11 | loss: 0.1380123
	speed: 0.0182s/iter; left time: 100.1090s
	iters: 300, epoch: 11 | loss: 0.0956098
	speed: 0.0182s/iter; left time: 98.2830s
	iters: 400, epoch: 11 | loss: 0.1846106
	speed: 0.0182s/iter; left time: 96.5004s
	iters: 500, epoch: 11 | loss: 0.1490075
	speed: 0.0182s/iter; left time: 94.6060s
Epoch: 11 cost time: 10.642504930496216
Epoch: 11, Steps: 570 | Train Loss: 0.1345975 Vali Loss: 0.0328031 Test Loss: 0.1123543
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1867373
	speed: 0.0566s/iter; left time: 284.7299s
	iters: 200, epoch: 12 | loss: 0.1077482
	speed: 0.0182s/iter; left time: 89.9878s
	iters: 300, epoch: 12 | loss: 0.0930673
	speed: 0.0182s/iter; left time: 88.0170s
	iters: 400, epoch: 12 | loss: 0.1318797
	speed: 0.0182s/iter; left time: 86.1607s
	iters: 500, epoch: 12 | loss: 0.1422749
	speed: 0.0182s/iter; left time: 84.4182s
Epoch: 12 cost time: 10.74021053314209
Epoch: 12, Steps: 570 | Train Loss: 0.1345187 Vali Loss: 0.0327841 Test Loss: 0.1122793
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1140422
	speed: 0.0553s/iter; left time: 246.5143s
	iters: 200, epoch: 13 | loss: 0.1710508
	speed: 0.0182s/iter; left time: 79.1951s
	iters: 300, epoch: 13 | loss: 0.1083229
	speed: 0.0182s/iter; left time: 77.3538s
	iters: 400, epoch: 13 | loss: 0.1506232
	speed: 0.0181s/iter; left time: 75.3389s
	iters: 500, epoch: 13 | loss: 0.2035553
	speed: 0.0181s/iter; left time: 73.5155s
Epoch: 13 cost time: 10.615530014038086
Epoch: 13, Steps: 570 | Train Loss: 0.1355682 Vali Loss: 0.0328358 Test Loss: 0.1122939
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1123042106628418, mae:0.20286034047603607
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2797449
	speed: 0.0326s/iter; left time: 368.5282s
	iters: 200, epoch: 1 | loss: 0.1862150
	speed: 0.0205s/iter; left time: 229.3529s
	iters: 300, epoch: 1 | loss: 0.3039144
	speed: 0.0205s/iter; left time: 228.0891s
	iters: 400, epoch: 1 | loss: 0.2908368
	speed: 0.0205s/iter; left time: 225.8859s
	iters: 500, epoch: 1 | loss: 0.3222593
	speed: 0.0199s/iter; left time: 216.9477s
Epoch: 1 cost time: 12.74429702758789
Epoch: 1, Steps: 570 | Train Loss: 0.2490867 Vali Loss: 0.0448612 Test Loss: 0.1411850
Validation loss decreased (inf --> 0.044861).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3115781
	speed: 0.0579s/iter; left time: 621.1804s
	iters: 200, epoch: 2 | loss: 0.3009275
	speed: 0.0184s/iter; left time: 195.7296s
	iters: 300, epoch: 2 | loss: 0.4145051
	speed: 0.0183s/iter; left time: 192.8845s
	iters: 400, epoch: 2 | loss: 0.1729305
	speed: 0.0183s/iter; left time: 190.8061s
	iters: 500, epoch: 2 | loss: 0.1927388
	speed: 0.0183s/iter; left time: 188.8737s
Epoch: 2 cost time: 10.792171955108643
Epoch: 2, Steps: 570 | Train Loss: 0.2132458 Vali Loss: 0.0427954 Test Loss: 0.1374245
Validation loss decreased (0.044861 --> 0.042795).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1280790
	speed: 0.0555s/iter; left time: 563.9455s
	iters: 200, epoch: 3 | loss: 0.2055959
	speed: 0.0182s/iter; left time: 183.3218s
	iters: 300, epoch: 3 | loss: 0.2088492
	speed: 0.0182s/iter; left time: 181.1762s
	iters: 400, epoch: 3 | loss: 0.2187045
	speed: 0.0182s/iter; left time: 179.2245s
	iters: 500, epoch: 3 | loss: 0.1717113
	speed: 0.0182s/iter; left time: 177.5106s
Epoch: 3 cost time: 10.664822101593018
Epoch: 3, Steps: 570 | Train Loss: 0.1804804 Vali Loss: 0.0406638 Test Loss: 0.1281530
Validation loss decreased (0.042795 --> 0.040664).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1274240
	speed: 0.0575s/iter; left time: 551.8230s
	iters: 200, epoch: 4 | loss: 0.1697613
	speed: 0.0184s/iter; left time: 174.3866s
	iters: 300, epoch: 4 | loss: 0.1532433
	speed: 0.0184s/iter; left time: 172.3718s
	iters: 400, epoch: 4 | loss: 0.1963158
	speed: 0.0183s/iter; left time: 170.4148s
	iters: 500, epoch: 4 | loss: 0.1010367
	speed: 0.0183s/iter; left time: 168.5997s
Epoch: 4 cost time: 10.795193910598755
Epoch: 4, Steps: 570 | Train Loss: 0.1598551 Vali Loss: 0.0383151 Test Loss: 0.1256488
Validation loss decreased (0.040664 --> 0.038315).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1172608
	speed: 0.0587s/iter; left time: 529.6851s
	iters: 200, epoch: 5 | loss: 0.1494514
	speed: 0.0206s/iter; left time: 183.5128s
	iters: 300, epoch: 5 | loss: 0.1080816
	speed: 0.0207s/iter; left time: 182.2461s
	iters: 400, epoch: 5 | loss: 0.1401497
	speed: 0.0208s/iter; left time: 181.6674s
	iters: 500, epoch: 5 | loss: 0.0738565
	speed: 0.0212s/iter; left time: 182.8644s
Epoch: 5 cost time: 12.202595710754395
Epoch: 5, Steps: 570 | Train Loss: 0.1475491 Vali Loss: 0.0380924 Test Loss: 0.1269571
Validation loss decreased (0.038315 --> 0.038092).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1919727
	speed: 0.0629s/iter; left time: 531.4757s
	iters: 200, epoch: 6 | loss: 0.0946734
	speed: 0.0206s/iter; left time: 171.9608s
	iters: 300, epoch: 6 | loss: 0.2285027
	speed: 0.0206s/iter; left time: 169.6167s
	iters: 400, epoch: 6 | loss: 0.1166387
	speed: 0.0206s/iter; left time: 167.7097s
	iters: 500, epoch: 6 | loss: 0.1483490
	speed: 0.0206s/iter; left time: 165.5569s
Epoch: 6 cost time: 12.324496984481812
Epoch: 6, Steps: 570 | Train Loss: 0.1427690 Vali Loss: 0.0374106 Test Loss: 0.1276500
Validation loss decreased (0.038092 --> 0.037411).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1298775
	speed: 0.0610s/iter; left time: 480.9496s
	iters: 200, epoch: 7 | loss: 0.1101149
	speed: 0.0183s/iter; left time: 142.6634s
	iters: 300, epoch: 7 | loss: 0.1458274
	speed: 0.0183s/iter; left time: 140.8128s
	iters: 400, epoch: 7 | loss: 0.1348525
	speed: 0.0183s/iter; left time: 138.7714s
	iters: 500, epoch: 7 | loss: 0.1037479
	speed: 0.0183s/iter; left time: 136.8540s
Epoch: 7 cost time: 10.762275218963623
Epoch: 7, Steps: 570 | Train Loss: 0.1406734 Vali Loss: 0.0375035 Test Loss: 0.1276350
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1153444
	speed: 0.0586s/iter; left time: 428.5507s
	iters: 200, epoch: 8 | loss: 0.0958842
	speed: 0.0183s/iter; left time: 132.0319s
	iters: 300, epoch: 8 | loss: 0.1312107
	speed: 0.0183s/iter; left time: 130.0459s
	iters: 400, epoch: 8 | loss: 0.1608980
	speed: 0.0183s/iter; left time: 127.9883s
	iters: 500, epoch: 8 | loss: 0.1197002
	speed: 0.0182s/iter; left time: 125.9911s
Epoch: 8 cost time: 10.742356538772583
Epoch: 8, Steps: 570 | Train Loss: 0.1382457 Vali Loss: 0.0379177 Test Loss: 0.1280280
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1367284
	speed: 0.0566s/iter; left time: 381.4437s
	iters: 200, epoch: 9 | loss: 0.1761189
	speed: 0.0181s/iter; left time: 120.4398s
	iters: 300, epoch: 9 | loss: 0.1626104
	speed: 0.0181s/iter; left time: 118.5878s
	iters: 400, epoch: 9 | loss: 0.2542892
	speed: 0.0202s/iter; left time: 129.9366s
	iters: 500, epoch: 9 | loss: 0.1088795
	speed: 0.0205s/iter; left time: 129.9902s
Epoch: 9 cost time: 11.418935060501099
Epoch: 9, Steps: 570 | Train Loss: 0.1378798 Vali Loss: 0.0379509 Test Loss: 0.1280553
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12781256437301636, mae:0.22418509423732758
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2265389
	speed: 0.0340s/iter; left time: 384.5241s
	iters: 200, epoch: 1 | loss: 0.2037170
	speed: 0.0220s/iter; left time: 246.2110s
	iters: 300, epoch: 1 | loss: 0.2611356
	speed: 0.0220s/iter; left time: 244.6762s
	iters: 400, epoch: 1 | loss: 0.3736100
	speed: 0.0220s/iter; left time: 242.0488s
	iters: 500, epoch: 1 | loss: 0.3269736
	speed: 0.0219s/iter; left time: 238.8339s
Epoch: 1 cost time: 13.780522584915161
Epoch: 1, Steps: 570 | Train Loss: 0.2639419 Vali Loss: 0.0465951 Test Loss: 0.1468236
Validation loss decreased (inf --> 0.046595).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3247042
	speed: 0.0635s/iter; left time: 681.4150s
	iters: 200, epoch: 2 | loss: 0.2474189
	speed: 0.0220s/iter; left time: 234.1854s
	iters: 300, epoch: 2 | loss: 0.2419414
	speed: 0.0220s/iter; left time: 231.7278s
	iters: 400, epoch: 2 | loss: 0.3111796
	speed: 0.0220s/iter; left time: 229.6074s
	iters: 500, epoch: 2 | loss: 0.2558926
	speed: 0.0220s/iter; left time: 227.5018s
Epoch: 2 cost time: 12.888434886932373
Epoch: 2, Steps: 570 | Train Loss: 0.2886750 Vali Loss: 0.0646475 Test Loss: 0.1807764
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4931170
	speed: 0.0678s/iter; left time: 689.1295s
	iters: 200, epoch: 3 | loss: 0.2203465
	speed: 0.0227s/iter; left time: 228.1807s
	iters: 300, epoch: 3 | loss: 0.3041163
	speed: 0.0221s/iter; left time: 219.9952s
	iters: 400, epoch: 3 | loss: 0.2258451
	speed: 0.0221s/iter; left time: 217.9872s
	iters: 500, epoch: 3 | loss: 0.1609135
	speed: 0.0221s/iter; left time: 215.5131s
Epoch: 3 cost time: 13.159153461456299
Epoch: 3, Steps: 570 | Train Loss: 0.2678624 Vali Loss: 0.0592624 Test Loss: 0.1633920
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1885575
	speed: 0.0641s/iter; left time: 615.2616s
	iters: 200, epoch: 4 | loss: 0.2064136
	speed: 0.0220s/iter; left time: 209.1760s
	iters: 300, epoch: 4 | loss: 0.2522214
	speed: 0.0220s/iter; left time: 206.6168s
	iters: 400, epoch: 4 | loss: 0.2098793
	speed: 0.0220s/iter; left time: 204.5435s
	iters: 500, epoch: 4 | loss: 0.3203610
	speed: 0.0220s/iter; left time: 202.3057s
Epoch: 4 cost time: 12.835817098617554
Epoch: 4, Steps: 570 | Train Loss: 0.2464373 Vali Loss: 0.0537332 Test Loss: 0.1535708
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14701522886753082, mae:0.238888680934906
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2473196
	speed: 0.0330s/iter; left time: 373.4403s
	iters: 200, epoch: 1 | loss: 0.1257081
	speed: 0.0212s/iter; left time: 237.9155s
	iters: 300, epoch: 1 | loss: 0.1898378
	speed: 0.0213s/iter; left time: 235.9009s
	iters: 400, epoch: 1 | loss: 0.2509260
	speed: 0.0213s/iter; left time: 233.9049s
	iters: 500, epoch: 1 | loss: 0.2319994
	speed: 0.0212s/iter; left time: 231.4051s
Epoch: 1 cost time: 13.344077587127686
Epoch: 1, Steps: 570 | Train Loss: 0.2497239 Vali Loss: 0.0487074 Test Loss: 0.1458330
Validation loss decreased (inf --> 0.048707).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2340444
	speed: 0.0621s/iter; left time: 666.0970s
	iters: 200, epoch: 2 | loss: 0.1911051
	speed: 0.0213s/iter; left time: 226.2055s
	iters: 300, epoch: 2 | loss: 0.3099531
	speed: 0.0213s/iter; left time: 224.0059s
	iters: 400, epoch: 2 | loss: 0.2114587
	speed: 0.0213s/iter; left time: 221.8096s
	iters: 500, epoch: 2 | loss: 0.2178767
	speed: 0.0213s/iter; left time: 219.5872s
Epoch: 2 cost time: 12.448843240737915
Epoch: 2, Steps: 570 | Train Loss: 0.2483829 Vali Loss: 0.0637570 Test Loss: 0.1865307
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2303837
	speed: 0.0640s/iter; left time: 650.6406s
	iters: 200, epoch: 3 | loss: 0.2040206
	speed: 0.0232s/iter; left time: 233.1907s
	iters: 300, epoch: 3 | loss: 0.2155994
	speed: 0.0232s/iter; left time: 231.1404s
	iters: 400, epoch: 3 | loss: 0.1691144
	speed: 0.0215s/iter; left time: 211.5621s
	iters: 500, epoch: 3 | loss: 0.2280182
	speed: 0.0212s/iter; left time: 206.9027s
Epoch: 3 cost time: 12.998172760009766
Epoch: 3, Steps: 570 | Train Loss: 0.2552357 Vali Loss: 0.0537550 Test Loss: 0.1570746
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1636872
	speed: 0.0604s/iter; left time: 579.6031s
	iters: 200, epoch: 4 | loss: 0.2324255
	speed: 0.0213s/iter; left time: 202.5147s
	iters: 300, epoch: 4 | loss: 0.2311193
	speed: 0.0213s/iter; left time: 200.1086s
	iters: 400, epoch: 4 | loss: 0.2508463
	speed: 0.0213s/iter; left time: 198.1786s
	iters: 500, epoch: 4 | loss: 0.1465907
	speed: 0.0213s/iter; left time: 195.8179s
Epoch: 4 cost time: 12.419177055358887
Epoch: 4, Steps: 570 | Train Loss: 0.2251661 Vali Loss: 0.0478529 Test Loss: 0.1428172
Validation loss decreased (0.048707 --> 0.047853).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3381991
	speed: 0.0618s/iter; left time: 557.6425s
	iters: 200, epoch: 5 | loss: 0.1688681
	speed: 0.0213s/iter; left time: 190.3391s
	iters: 300, epoch: 5 | loss: 0.2440124
	speed: 0.0213s/iter; left time: 187.7860s
	iters: 400, epoch: 5 | loss: 0.2265646
	speed: 0.0213s/iter; left time: 185.7200s
	iters: 500, epoch: 5 | loss: 0.1937955
	speed: 0.0213s/iter; left time: 183.4994s
Epoch: 5 cost time: 12.438358306884766
Epoch: 5, Steps: 570 | Train Loss: 0.2147581 Vali Loss: 0.0463137 Test Loss: 0.1410170
Validation loss decreased (0.047853 --> 0.046314).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1619216
	speed: 0.0629s/iter; left time: 531.9385s
	iters: 200, epoch: 6 | loss: 0.2720591
	speed: 0.0213s/iter; left time: 178.0981s
	iters: 300, epoch: 6 | loss: 0.2588261
	speed: 0.0213s/iter; left time: 175.7096s
	iters: 400, epoch: 6 | loss: 0.1421844
	speed: 0.0212s/iter; left time: 172.6402s
	iters: 500, epoch: 6 | loss: 0.1271585
	speed: 0.0212s/iter; left time: 170.7774s
Epoch: 6 cost time: 12.411394357681274
Epoch: 6, Steps: 570 | Train Loss: 0.2085781 Vali Loss: 0.0456530 Test Loss: 0.1389347
Validation loss decreased (0.046314 --> 0.045653).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1957026
	speed: 0.0624s/iter; left time: 492.0800s
	iters: 200, epoch: 7 | loss: 0.2440834
	speed: 0.0212s/iter; left time: 164.7704s
	iters: 300, epoch: 7 | loss: 0.2426528
	speed: 0.0212s/iter; left time: 163.1175s
	iters: 400, epoch: 7 | loss: 0.1396694
	speed: 0.0212s/iter; left time: 160.7041s
	iters: 500, epoch: 7 | loss: 0.2076509
	speed: 0.0212s/iter; left time: 158.6725s
Epoch: 7 cost time: 12.393557786941528
Epoch: 7, Steps: 570 | Train Loss: 0.2040462 Vali Loss: 0.0450921 Test Loss: 0.1383753
Validation loss decreased (0.045653 --> 0.045092).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1679175
	speed: 0.0628s/iter; left time: 459.2231s
	iters: 200, epoch: 8 | loss: 0.2228707
	speed: 0.0213s/iter; left time: 153.6960s
	iters: 300, epoch: 8 | loss: 0.2266141
	speed: 0.0213s/iter; left time: 151.5136s
	iters: 400, epoch: 8 | loss: 0.1868207
	speed: 0.0213s/iter; left time: 149.3869s
	iters: 500, epoch: 8 | loss: 0.2489204
	speed: 0.0213s/iter; left time: 147.2493s
Epoch: 8 cost time: 12.433119773864746
Epoch: 8, Steps: 570 | Train Loss: 0.2040983 Vali Loss: 0.0444818 Test Loss: 0.1387045
Validation loss decreased (0.045092 --> 0.044482).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1514863
	speed: 0.0615s/iter; left time: 414.7690s
	iters: 200, epoch: 9 | loss: 0.3282959
	speed: 0.0214s/iter; left time: 141.9404s
	iters: 300, epoch: 9 | loss: 0.2165562
	speed: 0.0214s/iter; left time: 139.7263s
	iters: 400, epoch: 9 | loss: 0.1657842
	speed: 0.0214s/iter; left time: 137.6240s
	iters: 500, epoch: 9 | loss: 0.1373940
	speed: 0.0214s/iter; left time: 135.4979s
Epoch: 9 cost time: 12.488882541656494
Epoch: 9, Steps: 570 | Train Loss: 0.2025875 Vali Loss: 0.0441560 Test Loss: 0.1378595
Validation loss decreased (0.044482 --> 0.044156).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1225090
	speed: 0.0657s/iter; left time: 405.7408s
	iters: 200, epoch: 10 | loss: 0.2219221
	speed: 0.0212s/iter; left time: 128.9439s
	iters: 300, epoch: 10 | loss: 0.1584260
	speed: 0.0212s/iter; left time: 126.8476s
	iters: 400, epoch: 10 | loss: 0.1926998
	speed: 0.0212s/iter; left time: 124.7356s
	iters: 500, epoch: 10 | loss: 0.2200271
	speed: 0.0212s/iter; left time: 122.6237s
Epoch: 10 cost time: 12.42766809463501
Epoch: 10, Steps: 570 | Train Loss: 0.2016098 Vali Loss: 0.0441128 Test Loss: 0.1378013
Validation loss decreased (0.044156 --> 0.044113).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.3134599
	speed: 0.0614s/iter; left time: 343.8801s
	iters: 200, epoch: 11 | loss: 0.2411440
	speed: 0.0212s/iter; left time: 116.4036s
	iters: 300, epoch: 11 | loss: 0.1653250
	speed: 0.0212s/iter; left time: 114.2856s
	iters: 400, epoch: 11 | loss: 0.1539716
	speed: 0.0212s/iter; left time: 112.1400s
	iters: 500, epoch: 11 | loss: 0.2373441
	speed: 0.0212s/iter; left time: 110.0470s
Epoch: 11 cost time: 12.394959449768066
Epoch: 11, Steps: 570 | Train Loss: 0.2021595 Vali Loss: 0.0440318 Test Loss: 0.1377459
Validation loss decreased (0.044113 --> 0.044032).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.2353914
	speed: 0.0648s/iter; left time: 325.8739s
	iters: 200, epoch: 12 | loss: 0.3114094
	speed: 0.0213s/iter; left time: 105.0887s
	iters: 300, epoch: 12 | loss: 0.1593771
	speed: 0.0213s/iter; left time: 102.9272s
	iters: 400, epoch: 12 | loss: 0.3602030
	speed: 0.0213s/iter; left time: 100.8142s
	iters: 500, epoch: 12 | loss: 0.1722682
	speed: 0.0213s/iter; left time: 98.6283s
Epoch: 12 cost time: 12.605692863464355
Epoch: 12, Steps: 570 | Train Loss: 0.2014231 Vali Loss: 0.0440433 Test Loss: 0.1377519
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1846561
	speed: 0.0608s/iter; left time: 271.2194s
	iters: 200, epoch: 13 | loss: 0.2406921
	speed: 0.0213s/iter; left time: 92.8893s
	iters: 300, epoch: 13 | loss: 0.2706851
	speed: 0.0213s/iter; left time: 90.7479s
	iters: 400, epoch: 13 | loss: 0.1599784
	speed: 0.0213s/iter; left time: 88.5814s
	iters: 500, epoch: 13 | loss: 0.2028231
	speed: 0.0213s/iter; left time: 86.4278s
Epoch: 13 cost time: 12.471432209014893
Epoch: 13, Steps: 570 | Train Loss: 0.2015567 Vali Loss: 0.0441264 Test Loss: 0.1377645
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1936617
	speed: 0.0611s/iter; left time: 237.6599s
	iters: 200, epoch: 14 | loss: 0.2265234
	speed: 0.0212s/iter; left time: 80.4971s
	iters: 300, epoch: 14 | loss: 0.2004135
	speed: 0.0212s/iter; left time: 78.3596s
	iters: 400, epoch: 14 | loss: 0.1715649
	speed: 0.0212s/iter; left time: 76.2309s
	iters: 500, epoch: 14 | loss: 0.2285334
	speed: 0.0212s/iter; left time: 74.0887s
Epoch: 14 cost time: 12.407430171966553
Epoch: 14, Steps: 570 | Train Loss: 0.2025883 Vali Loss: 0.0440201 Test Loss: 0.1377260
Validation loss decreased (0.044032 --> 0.044020).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1840862
	speed: 0.0614s/iter; left time: 203.7724s
	iters: 200, epoch: 15 | loss: 0.1368307
	speed: 0.0212s/iter; left time: 68.4344s
	iters: 300, epoch: 15 | loss: 0.1548997
	speed: 0.0212s/iter; left time: 66.2904s
	iters: 400, epoch: 15 | loss: 0.1958587
	speed: 0.0212s/iter; left time: 64.1780s
	iters: 500, epoch: 15 | loss: 0.1892700
	speed: 0.0212s/iter; left time: 62.0440s
Epoch: 15 cost time: 12.43505597114563
Epoch: 15, Steps: 570 | Train Loss: 0.2019070 Vali Loss: 0.0439447 Test Loss: 0.1377172
Validation loss decreased (0.044020 --> 0.043945).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1813580
	speed: 0.0622s/iter; left time: 171.0237s
	iters: 200, epoch: 16 | loss: 0.1363460
	speed: 0.0213s/iter; left time: 56.5031s
	iters: 300, epoch: 16 | loss: 0.2831162
	speed: 0.0213s/iter; left time: 54.3708s
	iters: 400, epoch: 16 | loss: 0.2373928
	speed: 0.0213s/iter; left time: 52.2524s
	iters: 500, epoch: 16 | loss: 0.2242551
	speed: 0.0213s/iter; left time: 50.1286s
Epoch: 16 cost time: 12.474010944366455
Epoch: 16, Steps: 570 | Train Loss: 0.2016798 Vali Loss: 0.0439457 Test Loss: 0.1377160
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.2514225
	speed: 0.0624s/iter; left time: 136.1214s
	iters: 200, epoch: 17 | loss: 0.3110075
	speed: 0.0212s/iter; left time: 44.1890s
	iters: 300, epoch: 17 | loss: 0.2045411
	speed: 0.0212s/iter; left time: 42.0567s
	iters: 400, epoch: 17 | loss: 0.2309391
	speed: 0.0212s/iter; left time: 39.9312s
	iters: 500, epoch: 17 | loss: 0.1832193
	speed: 0.0213s/iter; left time: 37.8602s
Epoch: 17 cost time: 12.369378566741943
Epoch: 17, Steps: 570 | Train Loss: 0.2015760 Vali Loss: 0.0441191 Test Loss: 0.1377131
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1943845
	speed: 0.0599s/iter; left time: 96.5484s
	iters: 200, epoch: 18 | loss: 0.3082238
	speed: 0.0213s/iter; left time: 32.1391s
	iters: 300, epoch: 18 | loss: 0.2240575
	speed: 0.0213s/iter; left time: 29.9897s
	iters: 400, epoch: 18 | loss: 0.2067386
	speed: 0.0213s/iter; left time: 27.8605s
	iters: 500, epoch: 18 | loss: 0.2080798
	speed: 0.0213s/iter; left time: 25.7412s
Epoch: 18 cost time: 12.39993405342102
Epoch: 18, Steps: 570 | Train Loss: 0.2016109 Vali Loss: 0.0440172 Test Loss: 0.1377118
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13791650533676147, mae:0.23043178021907806
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3004980
	speed: 0.0319s/iter; left time: 360.8350s
	iters: 200, epoch: 1 | loss: 0.1989134
	speed: 0.0200s/iter; left time: 224.2434s
	iters: 300, epoch: 1 | loss: 0.3044634
	speed: 0.0200s/iter; left time: 222.3918s
	iters: 400, epoch: 1 | loss: 0.2734650
	speed: 0.0200s/iter; left time: 219.7967s
	iters: 500, epoch: 1 | loss: 0.2556673
	speed: 0.0201s/iter; left time: 218.9171s
Epoch: 1 cost time: 12.662327766418457
Epoch: 1, Steps: 570 | Train Loss: 0.2702008 Vali Loss: 0.0588236 Test Loss: 0.1728681
Validation loss decreased (inf --> 0.058824).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1507782
	speed: 0.0613s/iter; left time: 657.5711s
	iters: 200, epoch: 2 | loss: 0.4606629
	speed: 0.0202s/iter; left time: 214.9508s
	iters: 300, epoch: 2 | loss: 0.3003632
	speed: 0.0201s/iter; left time: 212.0100s
	iters: 400, epoch: 2 | loss: 0.2307945
	speed: 0.0214s/iter; left time: 223.4712s
	iters: 500, epoch: 2 | loss: 0.1799846
	speed: 0.0221s/iter; left time: 228.2249s
Epoch: 2 cost time: 12.344701051712036
Epoch: 2, Steps: 570 | Train Loss: 0.2892339 Vali Loss: 0.0639202 Test Loss: 0.1825890
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2069496
	speed: 0.0625s/iter; left time: 634.6483s
	iters: 200, epoch: 3 | loss: 0.2117680
	speed: 0.0212s/iter; left time: 213.1089s
	iters: 300, epoch: 3 | loss: 0.2944541
	speed: 0.0201s/iter; left time: 200.0300s
	iters: 400, epoch: 3 | loss: 0.2844866
	speed: 0.0201s/iter; left time: 197.8222s
	iters: 500, epoch: 3 | loss: 0.2531351
	speed: 0.0201s/iter; left time: 195.8718s
Epoch: 3 cost time: 12.035943269729614
Epoch: 3, Steps: 570 | Train Loss: 0.2709073 Vali Loss: 0.0599584 Test Loss: 0.1668101
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1952371
	speed: 0.0579s/iter; left time: 555.5181s
	iters: 200, epoch: 4 | loss: 0.3761272
	speed: 0.0201s/iter; left time: 190.4014s
	iters: 300, epoch: 4 | loss: 0.1631347
	speed: 0.0201s/iter; left time: 188.3439s
	iters: 400, epoch: 4 | loss: 0.2734665
	speed: 0.0201s/iter; left time: 186.3587s
	iters: 500, epoch: 4 | loss: 0.1820910
	speed: 0.0200s/iter; left time: 184.2448s
Epoch: 4 cost time: 11.694469690322876
Epoch: 4, Steps: 570 | Train Loss: 0.2504997 Vali Loss: 0.0569234 Test Loss: 0.1600959
Validation loss decreased (0.058824 --> 0.056923).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2042698
	speed: 0.0602s/iter; left time: 543.2510s
	iters: 200, epoch: 5 | loss: 0.3836574
	speed: 0.0200s/iter; left time: 178.1731s
	iters: 300, epoch: 5 | loss: 0.2233628
	speed: 0.0199s/iter; left time: 175.9069s
	iters: 400, epoch: 5 | loss: 0.2100992
	speed: 0.0199s/iter; left time: 173.9053s
	iters: 500, epoch: 5 | loss: 0.2138872
	speed: 0.0199s/iter; left time: 171.7816s
Epoch: 5 cost time: 11.681588649749756
Epoch: 5, Steps: 570 | Train Loss: 0.2398774 Vali Loss: 0.0535849 Test Loss: 0.1552137
Validation loss decreased (0.056923 --> 0.053585).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2638490
	speed: 0.0597s/iter; left time: 504.9447s
	iters: 200, epoch: 6 | loss: 0.2066480
	speed: 0.0201s/iter; left time: 167.7511s
	iters: 300, epoch: 6 | loss: 0.2113417
	speed: 0.0201s/iter; left time: 165.6652s
	iters: 400, epoch: 6 | loss: 0.1573086
	speed: 0.0201s/iter; left time: 163.6042s
	iters: 500, epoch: 6 | loss: 0.3463879
	speed: 0.0201s/iter; left time: 161.5444s
Epoch: 6 cost time: 11.728840589523315
Epoch: 6, Steps: 570 | Train Loss: 0.2346667 Vali Loss: 0.0539009 Test Loss: 0.1536500
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2611862
	speed: 0.0575s/iter; left time: 453.4397s
	iters: 200, epoch: 7 | loss: 0.2718537
	speed: 0.0201s/iter; left time: 156.4750s
	iters: 300, epoch: 7 | loss: 0.2823459
	speed: 0.0201s/iter; left time: 154.5195s
	iters: 400, epoch: 7 | loss: 0.3576207
	speed: 0.0201s/iter; left time: 152.4989s
	iters: 500, epoch: 7 | loss: 0.1743409
	speed: 0.0201s/iter; left time: 150.4741s
Epoch: 7 cost time: 11.742376565933228
Epoch: 7, Steps: 570 | Train Loss: 0.2333656 Vali Loss: 0.0536834 Test Loss: 0.1523338
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2495489
	speed: 0.0587s/iter; left time: 428.8077s
	iters: 200, epoch: 8 | loss: 0.4250316
	speed: 0.0201s/iter; left time: 145.1406s
	iters: 300, epoch: 8 | loss: 0.2799234
	speed: 0.0201s/iter; left time: 143.0228s
	iters: 400, epoch: 8 | loss: 0.1764279
	speed: 0.0201s/iter; left time: 140.9903s
	iters: 500, epoch: 8 | loss: 0.2514960
	speed: 0.0201s/iter; left time: 138.9612s
Epoch: 8 cost time: 11.73278284072876
Epoch: 8, Steps: 570 | Train Loss: 0.2304643 Vali Loss: 0.0535885 Test Loss: 0.1519138
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15540441870689392, mae:0.24983768165111542
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1513899
	speed: 0.0214s/iter; left time: 241.7464s
	iters: 200, epoch: 1 | loss: 0.1708261
	speed: 0.0098s/iter; left time: 110.3223s
	iters: 300, epoch: 1 | loss: 0.2072538
	speed: 0.0099s/iter; left time: 109.6272s
	iters: 400, epoch: 1 | loss: 0.1874213
	speed: 0.0098s/iter; left time: 108.2622s
	iters: 500, epoch: 1 | loss: 0.1462569
	speed: 0.0099s/iter; left time: 107.5373s
Epoch: 1 cost time: 6.815077543258667
Epoch: 1, Steps: 570 | Train Loss: 0.1782682 Vali Loss: 0.0488664 Test Loss: 0.1440767
Validation loss decreased (inf --> 0.048866).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1783890
	speed: 0.0356s/iter; left time: 382.0493s
	iters: 200, epoch: 2 | loss: 0.2236717
	speed: 0.0099s/iter; left time: 105.4459s
	iters: 300, epoch: 2 | loss: 0.1199877
	speed: 0.0099s/iter; left time: 104.7411s
	iters: 400, epoch: 2 | loss: 0.1373761
	speed: 0.0099s/iter; left time: 103.3658s
	iters: 500, epoch: 2 | loss: 0.1278298
	speed: 0.0099s/iter; left time: 102.2962s
Epoch: 2 cost time: 5.963961362838745
Epoch: 2, Steps: 570 | Train Loss: 0.1318140 Vali Loss: 0.0394691 Test Loss: 0.1216232
Validation loss decreased (0.048866 --> 0.039469).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0813655
	speed: 0.0358s/iter; left time: 363.5461s
	iters: 200, epoch: 3 | loss: 0.1225430
	speed: 0.0100s/iter; left time: 100.5132s
	iters: 300, epoch: 3 | loss: 0.0964295
	speed: 0.0100s/iter; left time: 99.6828s
	iters: 400, epoch: 3 | loss: 0.1345346
	speed: 0.0100s/iter; left time: 98.3770s
	iters: 500, epoch: 3 | loss: 0.1609011
	speed: 0.0100s/iter; left time: 97.3653s
Epoch: 3 cost time: 5.9879162311553955
Epoch: 3, Steps: 570 | Train Loss: 0.1044723 Vali Loss: 0.0375850 Test Loss: 0.1230151
Validation loss decreased (0.039469 --> 0.037585).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1030105
	speed: 0.0372s/iter; left time: 356.7666s
	iters: 200, epoch: 4 | loss: 0.0546012
	speed: 0.0099s/iter; left time: 94.0465s
	iters: 300, epoch: 4 | loss: 0.0743815
	speed: 0.0104s/iter; left time: 97.8144s
	iters: 400, epoch: 4 | loss: 0.0863305
	speed: 0.0101s/iter; left time: 93.9017s
	iters: 500, epoch: 4 | loss: 0.0859571
	speed: 0.0099s/iter; left time: 90.8848s
Epoch: 4 cost time: 6.15201473236084
Epoch: 4, Steps: 570 | Train Loss: 0.0912220 Vali Loss: 0.0352333 Test Loss: 0.1292616
Validation loss decreased (0.037585 --> 0.035233).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0888323
	speed: 0.0360s/iter; left time: 324.4400s
	iters: 200, epoch: 5 | loss: 0.0870868
	speed: 0.0100s/iter; left time: 88.9712s
	iters: 300, epoch: 5 | loss: 0.0659903
	speed: 0.0100s/iter; left time: 87.9765s
	iters: 400, epoch: 5 | loss: 0.0912737
	speed: 0.0100s/iter; left time: 87.0411s
	iters: 500, epoch: 5 | loss: 0.0844885
	speed: 0.0100s/iter; left time: 85.8585s
Epoch: 5 cost time: 6.003388166427612
Epoch: 5, Steps: 570 | Train Loss: 0.0837980 Vali Loss: 0.0351836 Test Loss: 0.1282767
Validation loss decreased (0.035233 --> 0.035184).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0707374
	speed: 0.0355s/iter; left time: 300.3699s
	iters: 200, epoch: 6 | loss: 0.0545981
	speed: 0.0099s/iter; left time: 83.0443s
	iters: 300, epoch: 6 | loss: 0.0826763
	speed: 0.0099s/iter; left time: 81.7011s
	iters: 400, epoch: 6 | loss: 0.0825454
	speed: 0.0099s/iter; left time: 80.6406s
	iters: 500, epoch: 6 | loss: 0.0937315
	speed: 0.0099s/iter; left time: 79.8521s
Epoch: 6 cost time: 5.954099893569946
Epoch: 6, Steps: 570 | Train Loss: 0.0797587 Vali Loss: 0.0353576 Test Loss: 0.1341149
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0572066
	speed: 0.0387s/iter; left time: 304.7592s
	iters: 200, epoch: 7 | loss: 0.0860813
	speed: 0.0112s/iter; left time: 86.8087s
	iters: 300, epoch: 7 | loss: 0.0820051
	speed: 0.0112s/iter; left time: 85.6822s
	iters: 400, epoch: 7 | loss: 0.0914026
	speed: 0.0100s/iter; left time: 75.4313s
	iters: 500, epoch: 7 | loss: 0.0608955
	speed: 0.0099s/iter; left time: 74.1850s
Epoch: 7 cost time: 6.297482967376709
Epoch: 7, Steps: 570 | Train Loss: 0.0778621 Vali Loss: 0.0352114 Test Loss: 0.1327515
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0954885
	speed: 0.0376s/iter; left time: 274.9680s
	iters: 200, epoch: 8 | loss: 0.0881027
	speed: 0.0102s/iter; left time: 73.7550s
	iters: 300, epoch: 8 | loss: 0.0847088
	speed: 0.0099s/iter; left time: 70.7006s
	iters: 400, epoch: 8 | loss: 0.1198116
	speed: 0.0099s/iter; left time: 69.6327s
	iters: 500, epoch: 8 | loss: 0.0666076
	speed: 0.0099s/iter; left time: 68.4982s
Epoch: 8 cost time: 6.097086668014526
Epoch: 8, Steps: 570 | Train Loss: 0.0767807 Vali Loss: 0.0349456 Test Loss: 0.1335279
Validation loss decreased (0.035184 --> 0.034946).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0757837
	speed: 0.0358s/iter; left time: 241.1797s
	iters: 200, epoch: 9 | loss: 0.0716201
	speed: 0.0100s/iter; left time: 66.7190s
	iters: 300, epoch: 9 | loss: 0.0531166
	speed: 0.0100s/iter; left time: 65.6681s
	iters: 400, epoch: 9 | loss: 0.0605998
	speed: 0.0100s/iter; left time: 64.3003s
	iters: 500, epoch: 9 | loss: 0.0825795
	speed: 0.0100s/iter; left time: 63.4343s
Epoch: 9 cost time: 6.0216310024261475
Epoch: 9, Steps: 570 | Train Loss: 0.0762669 Vali Loss: 0.0351849 Test Loss: 0.1326815
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0987884
	speed: 0.0357s/iter; left time: 220.3130s
	iters: 200, epoch: 10 | loss: 0.0958489
	speed: 0.0099s/iter; left time: 60.3865s
	iters: 300, epoch: 10 | loss: 0.0612050
	speed: 0.0099s/iter; left time: 59.2075s
	iters: 400, epoch: 10 | loss: 0.0695738
	speed: 0.0099s/iter; left time: 58.3898s
	iters: 500, epoch: 10 | loss: 0.0914397
	speed: 0.0100s/iter; left time: 57.4740s
Epoch: 10 cost time: 6.003925085067749
Epoch: 10, Steps: 570 | Train Loss: 0.0759110 Vali Loss: 0.0349752 Test Loss: 0.1329615
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0891797
	speed: 0.0352s/iter; left time: 197.3920s
	iters: 200, epoch: 11 | loss: 0.0654194
	speed: 0.0099s/iter; left time: 54.6608s
	iters: 300, epoch: 11 | loss: 0.0499686
	speed: 0.0100s/iter; left time: 53.9063s
	iters: 400, epoch: 11 | loss: 0.0801086
	speed: 0.0100s/iter; left time: 52.9112s
	iters: 500, epoch: 11 | loss: 0.0725849
	speed: 0.0099s/iter; left time: 51.7395s
Epoch: 11 cost time: 5.9545488357543945
Epoch: 11, Steps: 570 | Train Loss: 0.0758053 Vali Loss: 0.0349229 Test Loss: 0.1328993
Validation loss decreased (0.034946 --> 0.034923).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0766716
	speed: 0.0371s/iter; left time: 186.6595s
	iters: 200, epoch: 12 | loss: 0.1050293
	speed: 0.0099s/iter; left time: 48.7254s
	iters: 300, epoch: 12 | loss: 0.0558165
	speed: 0.0098s/iter; left time: 47.5305s
	iters: 400, epoch: 12 | loss: 0.0781581
	speed: 0.0098s/iter; left time: 46.5388s
	iters: 500, epoch: 12 | loss: 0.1023269
	speed: 0.0098s/iter; left time: 45.5708s
Epoch: 12 cost time: 5.909122467041016
Epoch: 12, Steps: 570 | Train Loss: 0.0757633 Vali Loss: 0.0349610 Test Loss: 0.1328122
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0476927
	speed: 0.0368s/iter; left time: 164.3388s
	iters: 200, epoch: 13 | loss: 0.0836869
	speed: 0.0099s/iter; left time: 43.3242s
	iters: 300, epoch: 13 | loss: 0.0739400
	speed: 0.0099s/iter; left time: 42.3083s
	iters: 400, epoch: 13 | loss: 0.0708614
	speed: 0.0099s/iter; left time: 41.2769s
	iters: 500, epoch: 13 | loss: 0.0761347
	speed: 0.0099s/iter; left time: 40.0374s
Epoch: 13 cost time: 5.952649831771851
Epoch: 13, Steps: 570 | Train Loss: 0.0757305 Vali Loss: 0.0349727 Test Loss: 0.1329227
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0647223
	speed: 0.0373s/iter; left time: 145.1175s
	iters: 200, epoch: 14 | loss: 0.0526018
	speed: 0.0098s/iter; left time: 37.2943s
	iters: 300, epoch: 14 | loss: 0.0859268
	speed: 0.0098s/iter; left time: 36.2837s
	iters: 400, epoch: 14 | loss: 0.0826752
	speed: 0.0098s/iter; left time: 35.1743s
	iters: 500, epoch: 14 | loss: 0.0700437
	speed: 0.0098s/iter; left time: 34.2124s
Epoch: 14 cost time: 5.876570463180542
Epoch: 14, Steps: 570 | Train Loss: 0.0756925 Vali Loss: 0.0349790 Test Loss: 0.1329065
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13309873640537262, mae:0.23310883343219757
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1296794
	speed: 0.0213s/iter; left time: 240.4788s
	iters: 200, epoch: 1 | loss: 0.1537673
	speed: 0.0098s/iter; left time: 109.2857s
	iters: 300, epoch: 1 | loss: 0.1868851
	speed: 0.0098s/iter; left time: 108.5247s
	iters: 400, epoch: 1 | loss: 0.1413876
	speed: 0.0098s/iter; left time: 107.2722s
	iters: 500, epoch: 1 | loss: 0.1430622
	speed: 0.0098s/iter; left time: 106.5423s
Epoch: 1 cost time: 6.764409303665161
Epoch: 1, Steps: 570 | Train Loss: 0.1467088 Vali Loss: 0.0350296 Test Loss: 0.1152290
Validation loss decreased (inf --> 0.035030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1114759
	speed: 0.0372s/iter; left time: 398.7151s
	iters: 200, epoch: 2 | loss: 0.1284230
	speed: 0.0097s/iter; left time: 103.5369s
	iters: 300, epoch: 2 | loss: 0.0688358
	speed: 0.0097s/iter; left time: 102.3752s
	iters: 400, epoch: 2 | loss: 0.1128854
	speed: 0.0097s/iter; left time: 101.4674s
	iters: 500, epoch: 2 | loss: 0.1115896
	speed: 0.0097s/iter; left time: 100.1793s
Epoch: 2 cost time: 5.847932815551758
Epoch: 2, Steps: 570 | Train Loss: 0.1114781 Vali Loss: 0.0329555 Test Loss: 0.1099542
Validation loss decreased (0.035030 --> 0.032956).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0609866
	speed: 0.0366s/iter; left time: 371.5205s
	iters: 200, epoch: 3 | loss: 0.0976384
	speed: 0.0097s/iter; left time: 97.9281s
	iters: 300, epoch: 3 | loss: 0.1724140
	speed: 0.0097s/iter; left time: 96.8879s
	iters: 400, epoch: 3 | loss: 0.0866911
	speed: 0.0097s/iter; left time: 95.7572s
	iters: 500, epoch: 3 | loss: 0.0692270
	speed: 0.0097s/iter; left time: 94.9171s
Epoch: 3 cost time: 5.827683925628662
Epoch: 3, Steps: 570 | Train Loss: 0.0921401 Vali Loss: 0.0308499 Test Loss: 0.1111345
Validation loss decreased (0.032956 --> 0.030850).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0585588
	speed: 0.0367s/iter; left time: 352.2482s
	iters: 200, epoch: 4 | loss: 0.0662341
	speed: 0.0098s/iter; left time: 92.7198s
	iters: 300, epoch: 4 | loss: 0.0571444
	speed: 0.0098s/iter; left time: 91.6553s
	iters: 400, epoch: 4 | loss: 0.0533146
	speed: 0.0097s/iter; left time: 90.3320s
	iters: 500, epoch: 4 | loss: 0.0809954
	speed: 0.0097s/iter; left time: 89.5496s
Epoch: 4 cost time: 5.853921175003052
Epoch: 4, Steps: 570 | Train Loss: 0.0807265 Vali Loss: 0.0310337 Test Loss: 0.1128686
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0621617
	speed: 0.0344s/iter; left time: 310.3356s
	iters: 200, epoch: 5 | loss: 0.1101965
	speed: 0.0097s/iter; left time: 86.5481s
	iters: 300, epoch: 5 | loss: 0.0706058
	speed: 0.0097s/iter; left time: 85.5728s
	iters: 400, epoch: 5 | loss: 0.0821538
	speed: 0.0097s/iter; left time: 84.9707s
	iters: 500, epoch: 5 | loss: 0.0852641
	speed: 0.0097s/iter; left time: 83.7128s
Epoch: 5 cost time: 5.821242570877075
Epoch: 5, Steps: 570 | Train Loss: 0.0744010 Vali Loss: 0.0319490 Test Loss: 0.1164137
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0432204
	speed: 0.0340s/iter; left time: 287.4810s
	iters: 200, epoch: 6 | loss: 0.1052784
	speed: 0.0109s/iter; left time: 91.0897s
	iters: 300, epoch: 6 | loss: 0.1071064
	speed: 0.0109s/iter; left time: 90.0712s
	iters: 400, epoch: 6 | loss: 0.0691435
	speed: 0.0109s/iter; left time: 88.7564s
	iters: 500, epoch: 6 | loss: 0.0560922
	speed: 0.0109s/iter; left time: 87.6583s
Epoch: 6 cost time: 6.38397479057312
Epoch: 6, Steps: 570 | Train Loss: 0.0713012 Vali Loss: 0.0315096 Test Loss: 0.1154929
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11129950731992722, mae:0.20474335551261902
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1780639
	speed: 0.0229s/iter; left time: 258.9588s
	iters: 200, epoch: 1 | loss: 0.1372520
	speed: 0.0109s/iter; left time: 122.1786s
	iters: 300, epoch: 1 | loss: 0.1191107
	speed: 0.0109s/iter; left time: 120.6978s
	iters: 400, epoch: 1 | loss: 0.0929553
	speed: 0.0109s/iter; left time: 119.9427s
	iters: 500, epoch: 1 | loss: 0.1663685
	speed: 0.0109s/iter; left time: 119.0684s
Epoch: 1 cost time: 7.46794319152832
Epoch: 1, Steps: 570 | Train Loss: 0.1820953 Vali Loss: 0.0429141 Test Loss: 0.1349617
Validation loss decreased (inf --> 0.042914).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1548477
	speed: 0.0368s/iter; left time: 395.0436s
	iters: 200, epoch: 2 | loss: 0.2209670
	speed: 0.0097s/iter; left time: 103.4650s
	iters: 300, epoch: 2 | loss: 0.1052781
	speed: 0.0097s/iter; left time: 102.3513s
	iters: 400, epoch: 2 | loss: 0.1976978
	speed: 0.0097s/iter; left time: 101.5779s
	iters: 500, epoch: 2 | loss: 0.1454997
	speed: 0.0097s/iter; left time: 100.4227s
Epoch: 2 cost time: 5.927467584609985
Epoch: 2, Steps: 570 | Train Loss: 0.1344605 Vali Loss: 0.0395189 Test Loss: 0.1307461
Validation loss decreased (0.042914 --> 0.039519).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0897920
	speed: 0.0370s/iter; left time: 375.7287s
	iters: 200, epoch: 3 | loss: 0.0834154
	speed: 0.0098s/iter; left time: 98.5085s
	iters: 300, epoch: 3 | loss: 0.1152317
	speed: 0.0098s/iter; left time: 97.5295s
	iters: 400, epoch: 3 | loss: 0.0778258
	speed: 0.0098s/iter; left time: 96.4942s
	iters: 500, epoch: 3 | loss: 0.0889585
	speed: 0.0098s/iter; left time: 95.5956s
Epoch: 3 cost time: 5.880545377731323
Epoch: 3, Steps: 570 | Train Loss: 0.1071869 Vali Loss: 0.0380230 Test Loss: 0.1316162
Validation loss decreased (0.039519 --> 0.038023).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0710069
	speed: 0.0356s/iter; left time: 341.4007s
	iters: 200, epoch: 4 | loss: 0.0664880
	speed: 0.0097s/iter; left time: 91.8440s
	iters: 300, epoch: 4 | loss: 0.0639720
	speed: 0.0097s/iter; left time: 90.9314s
	iters: 400, epoch: 4 | loss: 0.1217632
	speed: 0.0097s/iter; left time: 89.9861s
	iters: 500, epoch: 4 | loss: 0.0955939
	speed: 0.0097s/iter; left time: 89.4619s
Epoch: 4 cost time: 5.839489936828613
Epoch: 4, Steps: 570 | Train Loss: 0.0925274 Vali Loss: 0.0394200 Test Loss: 0.1415058
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0904921
	speed: 0.0354s/iter; left time: 319.0771s
	iters: 200, epoch: 5 | loss: 0.0606137
	speed: 0.0097s/iter; left time: 86.5958s
	iters: 300, epoch: 5 | loss: 0.0757486
	speed: 0.0097s/iter; left time: 85.5841s
	iters: 400, epoch: 5 | loss: 0.0715954
	speed: 0.0097s/iter; left time: 84.5760s
	iters: 500, epoch: 5 | loss: 0.0930780
	speed: 0.0097s/iter; left time: 83.6377s
Epoch: 5 cost time: 5.852719783782959
Epoch: 5, Steps: 570 | Train Loss: 0.0848515 Vali Loss: 0.0375565 Test Loss: 0.1370987
Validation loss decreased (0.038023 --> 0.037556).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0669339
	speed: 0.0359s/iter; left time: 303.6314s
	iters: 200, epoch: 6 | loss: 0.0817979
	speed: 0.0111s/iter; left time: 93.0961s
	iters: 300, epoch: 6 | loss: 0.0868388
	speed: 0.0111s/iter; left time: 91.9144s
	iters: 400, epoch: 6 | loss: 0.0847087
	speed: 0.0111s/iter; left time: 90.7985s
	iters: 500, epoch: 6 | loss: 0.0854470
	speed: 0.0111s/iter; left time: 89.7021s
Epoch: 6 cost time: 6.504245042800903
Epoch: 6, Steps: 570 | Train Loss: 0.0807174 Vali Loss: 0.0377012 Test Loss: 0.1391779
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0496188
	speed: 0.0369s/iter; left time: 290.8545s
	iters: 200, epoch: 7 | loss: 0.0840604
	speed: 0.0111s/iter; left time: 86.5654s
	iters: 300, epoch: 7 | loss: 0.0612264
	speed: 0.0099s/iter; left time: 75.8290s
	iters: 400, epoch: 7 | loss: 0.0641417
	speed: 0.0111s/iter; left time: 84.2730s
	iters: 500, epoch: 7 | loss: 0.0803898
	speed: 0.0111s/iter; left time: 83.2183s
Epoch: 7 cost time: 6.5381786823272705
Epoch: 7, Steps: 570 | Train Loss: 0.0786098 Vali Loss: 0.0379949 Test Loss: 0.1402828
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0726003
	speed: 0.0380s/iter; left time: 277.8787s
	iters: 200, epoch: 8 | loss: 0.0959347
	speed: 0.0103s/iter; left time: 73.9417s
	iters: 300, epoch: 8 | loss: 0.0586260
	speed: 0.0111s/iter; left time: 79.2777s
	iters: 400, epoch: 8 | loss: 0.0814930
	speed: 0.0112s/iter; left time: 78.2018s
	iters: 500, epoch: 8 | loss: 0.0738687
	speed: 0.0112s/iter; left time: 77.3146s
Epoch: 8 cost time: 6.547569513320923
Epoch: 8, Steps: 570 | Train Loss: 0.0774923 Vali Loss: 0.0378750 Test Loss: 0.1392616
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13732154667377472, mae:0.2374982088804245
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2075656
	speed: 0.0242s/iter; left time: 273.7404s
	iters: 200, epoch: 1 | loss: 0.1891302
	speed: 0.0124s/iter; left time: 139.4448s
	iters: 300, epoch: 1 | loss: 0.1438425
	speed: 0.0124s/iter; left time: 137.8342s
	iters: 400, epoch: 1 | loss: 0.0960854
	speed: 0.0123s/iter; left time: 134.8660s
	iters: 500, epoch: 1 | loss: 0.1460082
	speed: 0.0114s/iter; left time: 124.7929s
Epoch: 1 cost time: 8.127431631088257
Epoch: 1, Steps: 570 | Train Loss: 0.1726389 Vali Loss: 0.0416023 Test Loss: 0.1333482
Validation loss decreased (inf --> 0.041602).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1125999
	speed: 0.0388s/iter; left time: 416.2951s
	iters: 200, epoch: 2 | loss: 0.1601015
	speed: 0.0114s/iter; left time: 121.3882s
	iters: 300, epoch: 2 | loss: 0.0863702
	speed: 0.0114s/iter; left time: 120.3847s
	iters: 400, epoch: 2 | loss: 0.0722242
	speed: 0.0114s/iter; left time: 119.0907s
	iters: 500, epoch: 2 | loss: 0.1252543
	speed: 0.0114s/iter; left time: 118.1074s
Epoch: 2 cost time: 6.843969821929932
Epoch: 2, Steps: 570 | Train Loss: 0.1206118 Vali Loss: 0.0371007 Test Loss: 0.1300596
Validation loss decreased (0.041602 --> 0.037101).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1112814
	speed: 0.0402s/iter; left time: 408.6979s
	iters: 200, epoch: 3 | loss: 0.1019169
	speed: 0.0115s/iter; left time: 115.2773s
	iters: 300, epoch: 3 | loss: 0.0533755
	speed: 0.0114s/iter; left time: 113.9814s
	iters: 400, epoch: 3 | loss: 0.0745492
	speed: 0.0114s/iter; left time: 112.6414s
	iters: 500, epoch: 3 | loss: 0.0664679
	speed: 0.0114s/iter; left time: 111.5658s
Epoch: 3 cost time: 6.844347953796387
Epoch: 3, Steps: 570 | Train Loss: 0.0850507 Vali Loss: 0.0382536 Test Loss: 0.1343134
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0650218
	speed: 0.0414s/iter; left time: 396.9250s
	iters: 200, epoch: 4 | loss: 0.0675176
	speed: 0.0125s/iter; left time: 118.4367s
	iters: 300, epoch: 4 | loss: 0.0475311
	speed: 0.0125s/iter; left time: 117.4095s
	iters: 400, epoch: 4 | loss: 0.0494996
	speed: 0.0125s/iter; left time: 116.4612s
	iters: 500, epoch: 4 | loss: 0.0569383
	speed: 0.0125s/iter; left time: 114.7312s
Epoch: 4 cost time: 7.437259912490845
Epoch: 4, Steps: 570 | Train Loss: 0.0661452 Vali Loss: 0.0368891 Test Loss: 0.1419170
Validation loss decreased (0.037101 --> 0.036889).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0638862
	speed: 0.0394s/iter; left time: 355.1909s
	iters: 200, epoch: 5 | loss: 0.0473970
	speed: 0.0115s/iter; left time: 102.2047s
	iters: 300, epoch: 5 | loss: 0.0737297
	speed: 0.0115s/iter; left time: 101.2360s
	iters: 400, epoch: 5 | loss: 0.0438493
	speed: 0.0115s/iter; left time: 100.0078s
	iters: 500, epoch: 5 | loss: 0.0572657
	speed: 0.0115s/iter; left time: 98.7392s
Epoch: 5 cost time: 6.843087673187256
Epoch: 5, Steps: 570 | Train Loss: 0.0570209 Vali Loss: 0.0372287 Test Loss: 0.1375001
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0528088
	speed: 0.0384s/iter; left time: 324.3291s
	iters: 200, epoch: 6 | loss: 0.0441225
	speed: 0.0115s/iter; left time: 95.6209s
	iters: 300, epoch: 6 | loss: 0.0589389
	speed: 0.0115s/iter; left time: 94.5231s
	iters: 400, epoch: 6 | loss: 0.0440373
	speed: 0.0115s/iter; left time: 93.3821s
	iters: 500, epoch: 6 | loss: 0.0396450
	speed: 0.0115s/iter; left time: 92.2295s
Epoch: 6 cost time: 6.833966255187988
Epoch: 6, Steps: 570 | Train Loss: 0.0524589 Vali Loss: 0.0373383 Test Loss: 0.1398008
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0418494
	speed: 0.0383s/iter; left time: 301.7096s
	iters: 200, epoch: 7 | loss: 0.0407792
	speed: 0.0114s/iter; left time: 88.9962s
	iters: 300, epoch: 7 | loss: 0.0543232
	speed: 0.0114s/iter; left time: 87.8452s
	iters: 400, epoch: 7 | loss: 0.0451226
	speed: 0.0114s/iter; left time: 86.7136s
	iters: 500, epoch: 7 | loss: 0.0532091
	speed: 0.0114s/iter; left time: 85.5655s
Epoch: 7 cost time: 6.818583011627197
Epoch: 7, Steps: 570 | Train Loss: 0.0501880 Vali Loss: 0.0371221 Test Loss: 0.1395622
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1421547830104828, mae:0.2445380836725235
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.0821424
	speed: 0.0239s/iter; left time: 270.5470s
	iters: 200, epoch: 1 | loss: 0.2055272
	speed: 0.0121s/iter; left time: 135.2596s
	iters: 300, epoch: 1 | loss: 0.1187363
	speed: 0.0121s/iter; left time: 134.1861s
	iters: 400, epoch: 1 | loss: 0.1494484
	speed: 0.0121s/iter; left time: 132.7615s
	iters: 500, epoch: 1 | loss: 0.1010472
	speed: 0.0121s/iter; left time: 131.6243s
Epoch: 1 cost time: 8.115211248397827
Epoch: 1, Steps: 570 | Train Loss: 0.1439106 Vali Loss: 0.0382256 Test Loss: 0.1186200
Validation loss decreased (inf --> 0.038226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1050378
	speed: 0.0406s/iter; left time: 435.3888s
	iters: 200, epoch: 2 | loss: 0.0721160
	speed: 0.0111s/iter; left time: 117.6235s
	iters: 300, epoch: 2 | loss: 0.1025319
	speed: 0.0110s/iter; left time: 116.3181s
	iters: 400, epoch: 2 | loss: 0.1451430
	speed: 0.0111s/iter; left time: 115.3589s
	iters: 500, epoch: 2 | loss: 0.1316334
	speed: 0.0110s/iter; left time: 114.1129s
Epoch: 2 cost time: 6.665112733840942
Epoch: 2, Steps: 570 | Train Loss: 0.1032850 Vali Loss: 0.0366824 Test Loss: 0.1188014
Validation loss decreased (0.038226 --> 0.036682).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0892414
	speed: 0.0388s/iter; left time: 394.7126s
	iters: 200, epoch: 3 | loss: 0.0581202
	speed: 0.0111s/iter; left time: 111.1955s
	iters: 300, epoch: 3 | loss: 0.0749623
	speed: 0.0110s/iter; left time: 109.8804s
	iters: 400, epoch: 3 | loss: 0.0981017
	speed: 0.0110s/iter; left time: 108.8076s
	iters: 500, epoch: 3 | loss: 0.0787319
	speed: 0.0110s/iter; left time: 107.8197s
Epoch: 3 cost time: 6.617070436477661
Epoch: 3, Steps: 570 | Train Loss: 0.0738748 Vali Loss: 0.0344610 Test Loss: 0.1209547
Validation loss decreased (0.036682 --> 0.034461).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0760859
	speed: 0.0378s/iter; left time: 362.4301s
	iters: 200, epoch: 4 | loss: 0.0513707
	speed: 0.0111s/iter; left time: 105.0792s
	iters: 300, epoch: 4 | loss: 0.0340439
	speed: 0.0111s/iter; left time: 104.0293s
	iters: 400, epoch: 4 | loss: 0.0534885
	speed: 0.0111s/iter; left time: 103.1325s
	iters: 500, epoch: 4 | loss: 0.0699914
	speed: 0.0111s/iter; left time: 102.1838s
Epoch: 4 cost time: 6.64502215385437
Epoch: 4, Steps: 570 | Train Loss: 0.0581782 Vali Loss: 0.0338879 Test Loss: 0.1185862
Validation loss decreased (0.034461 --> 0.033888).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0432031
	speed: 0.0401s/iter; left time: 361.6829s
	iters: 200, epoch: 5 | loss: 0.0489614
	speed: 0.0111s/iter; left time: 99.0721s
	iters: 300, epoch: 5 | loss: 0.0570353
	speed: 0.0111s/iter; left time: 98.1132s
	iters: 400, epoch: 5 | loss: 0.0587425
	speed: 0.0111s/iter; left time: 96.9736s
	iters: 500, epoch: 5 | loss: 0.0486464
	speed: 0.0111s/iter; left time: 95.8519s
Epoch: 5 cost time: 6.647135972976685
Epoch: 5, Steps: 570 | Train Loss: 0.0501565 Vali Loss: 0.0345894 Test Loss: 0.1200429
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0685314
	speed: 0.0388s/iter; left time: 328.2875s
	iters: 200, epoch: 6 | loss: 0.0445221
	speed: 0.0122s/iter; left time: 101.6589s
	iters: 300, epoch: 6 | loss: 0.0449592
	speed: 0.0121s/iter; left time: 100.0590s
	iters: 400, epoch: 6 | loss: 0.0366026
	speed: 0.0121s/iter; left time: 98.7977s
	iters: 500, epoch: 6 | loss: 0.0413571
	speed: 0.0121s/iter; left time: 97.6111s
Epoch: 6 cost time: 7.207422733306885
Epoch: 6, Steps: 570 | Train Loss: 0.0462577 Vali Loss: 0.0350961 Test Loss: 0.1203088
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0393076
	speed: 0.0395s/iter; left time: 311.2288s
	iters: 200, epoch: 7 | loss: 0.0463046
	speed: 0.0121s/iter; left time: 94.2976s
	iters: 300, epoch: 7 | loss: 0.0442514
	speed: 0.0122s/iter; left time: 93.6283s
	iters: 400, epoch: 7 | loss: 0.0389046
	speed: 0.0121s/iter; left time: 91.8751s
	iters: 500, epoch: 7 | loss: 0.0392465
	speed: 0.0121s/iter; left time: 90.7587s
Epoch: 7 cost time: 7.21053671836853
Epoch: 7, Steps: 570 | Train Loss: 0.0443031 Vali Loss: 0.0349080 Test Loss: 0.1201539
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11877221614122391, mae:0.21709507703781128
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1887072
	speed: 0.0235s/iter; left time: 265.5318s
	iters: 200, epoch: 1 | loss: 0.1759307
	speed: 0.0113s/iter; left time: 126.8827s
	iters: 300, epoch: 1 | loss: 0.2258705
	speed: 0.0113s/iter; left time: 125.4351s
	iters: 400, epoch: 1 | loss: 0.1309080
	speed: 0.0113s/iter; left time: 124.4595s
	iters: 500, epoch: 1 | loss: 0.1294963
	speed: 0.0113s/iter; left time: 123.7174s
Epoch: 1 cost time: 7.720759630203247
Epoch: 1, Steps: 570 | Train Loss: 0.1765686 Vali Loss: 0.0423134 Test Loss: 0.1332751
Validation loss decreased (inf --> 0.042313).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1715980
	speed: 0.0385s/iter; left time: 412.6575s
	iters: 200, epoch: 2 | loss: 0.1917507
	speed: 0.0102s/iter; left time: 108.8288s
	iters: 300, epoch: 2 | loss: 0.0993218
	speed: 0.0103s/iter; left time: 107.9865s
	iters: 400, epoch: 2 | loss: 0.0857142
	speed: 0.0102s/iter; left time: 106.7690s
	iters: 500, epoch: 2 | loss: 0.1163648
	speed: 0.0102s/iter; left time: 105.8188s
Epoch: 2 cost time: 6.165524959564209
Epoch: 2, Steps: 570 | Train Loss: 0.1256958 Vali Loss: 0.0456945 Test Loss: 0.1378805
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1145572
	speed: 0.0363s/iter; left time: 368.7864s
	iters: 200, epoch: 3 | loss: 0.0797853
	speed: 0.0103s/iter; left time: 103.6650s
	iters: 300, epoch: 3 | loss: 0.0870536
	speed: 0.0103s/iter; left time: 102.5899s
	iters: 400, epoch: 3 | loss: 0.0757016
	speed: 0.0103s/iter; left time: 101.3541s
	iters: 500, epoch: 3 | loss: 0.1084943
	speed: 0.0102s/iter; left time: 100.0305s
Epoch: 3 cost time: 6.167678356170654
Epoch: 3, Steps: 570 | Train Loss: 0.0880999 Vali Loss: 0.0434391 Test Loss: 0.1412951
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0574450
	speed: 0.0363s/iter; left time: 348.6281s
	iters: 200, epoch: 4 | loss: 0.0721468
	speed: 0.0102s/iter; left time: 97.1638s
	iters: 300, epoch: 4 | loss: 0.0654138
	speed: 0.0103s/iter; left time: 96.2996s
	iters: 400, epoch: 4 | loss: 0.0990636
	speed: 0.0103s/iter; left time: 95.4524s
	iters: 500, epoch: 4 | loss: 0.0713094
	speed: 0.0102s/iter; left time: 94.1315s
Epoch: 4 cost time: 6.1442790031433105
Epoch: 4, Steps: 570 | Train Loss: 0.0684439 Vali Loss: 0.0446042 Test Loss: 0.1375321
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1334594041109085, mae:0.23299375176429749
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1846062
	speed: 0.0253s/iter; left time: 285.6287s
	iters: 200, epoch: 1 | loss: 0.1460764
	speed: 0.0137s/iter; left time: 153.0818s
	iters: 300, epoch: 1 | loss: 0.2441318
	speed: 0.0136s/iter; left time: 151.2038s
	iters: 400, epoch: 1 | loss: 0.1463033
	speed: 0.0136s/iter; left time: 149.9602s
	iters: 500, epoch: 1 | loss: 0.1389970
	speed: 0.0137s/iter; left time: 148.9832s
Epoch: 1 cost time: 8.989021301269531
Epoch: 1, Steps: 570 | Train Loss: 0.1763569 Vali Loss: 0.0408216 Test Loss: 0.1298443
Validation loss decreased (inf --> 0.040822).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1671756
	speed: 0.0449s/iter; left time: 482.1804s
	iters: 200, epoch: 2 | loss: 0.1170338
	speed: 0.0136s/iter; left time: 144.0642s
	iters: 300, epoch: 2 | loss: 0.1050745
	speed: 0.0135s/iter; left time: 142.3382s
	iters: 400, epoch: 2 | loss: 0.1136662
	speed: 0.0135s/iter; left time: 141.0914s
	iters: 500, epoch: 2 | loss: 0.1486110
	speed: 0.0135s/iter; left time: 139.5268s
Epoch: 2 cost time: 8.002887487411499
Epoch: 2, Steps: 570 | Train Loss: 0.1301342 Vali Loss: 0.0375515 Test Loss: 0.1284046
Validation loss decreased (0.040822 --> 0.037552).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1702181
	speed: 0.0451s/iter; left time: 458.6202s
	iters: 200, epoch: 3 | loss: 0.0794896
	speed: 0.0137s/iter; left time: 137.7625s
	iters: 300, epoch: 3 | loss: 0.0642059
	speed: 0.0137s/iter; left time: 136.3141s
	iters: 400, epoch: 3 | loss: 0.0825356
	speed: 0.0137s/iter; left time: 134.9923s
	iters: 500, epoch: 3 | loss: 0.0720266
	speed: 0.0137s/iter; left time: 133.3584s
Epoch: 3 cost time: 8.100081443786621
Epoch: 3, Steps: 570 | Train Loss: 0.0985180 Vali Loss: 0.0344121 Test Loss: 0.1251863
Validation loss decreased (0.037552 --> 0.034412).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0837777
	speed: 0.0464s/iter; left time: 444.5881s
	iters: 200, epoch: 4 | loss: 0.0715140
	speed: 0.0136s/iter; left time: 129.1184s
	iters: 300, epoch: 4 | loss: 0.1077494
	speed: 0.0136s/iter; left time: 127.9726s
	iters: 400, epoch: 4 | loss: 0.0905709
	speed: 0.0136s/iter; left time: 126.3546s
	iters: 500, epoch: 4 | loss: 0.0786342
	speed: 0.0136s/iter; left time: 125.0781s
Epoch: 4 cost time: 8.100306749343872
Epoch: 4, Steps: 570 | Train Loss: 0.0826425 Vali Loss: 0.0340419 Test Loss: 0.1338193
Validation loss decreased (0.034412 --> 0.034042).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0822442
	speed: 0.0454s/iter; left time: 409.6006s
	iters: 200, epoch: 5 | loss: 0.0708540
	speed: 0.0136s/iter; left time: 121.1705s
	iters: 300, epoch: 5 | loss: 0.0620825
	speed: 0.0136s/iter; left time: 119.8905s
	iters: 400, epoch: 5 | loss: 0.0708510
	speed: 0.0136s/iter; left time: 118.5397s
	iters: 500, epoch: 5 | loss: 0.0573040
	speed: 0.0136s/iter; left time: 117.1170s
Epoch: 5 cost time: 8.067023754119873
Epoch: 5, Steps: 570 | Train Loss: 0.0745537 Vali Loss: 0.0338613 Test Loss: 0.1355065
Validation loss decreased (0.034042 --> 0.033861).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0625130
	speed: 0.0460s/iter; left time: 388.6232s
	iters: 200, epoch: 6 | loss: 0.1003545
	speed: 0.0136s/iter; left time: 113.4476s
	iters: 300, epoch: 6 | loss: 0.0615088
	speed: 0.0136s/iter; left time: 112.0945s
	iters: 400, epoch: 6 | loss: 0.0667660
	speed: 0.0136s/iter; left time: 110.7447s
	iters: 500, epoch: 6 | loss: 0.0611838
	speed: 0.0136s/iter; left time: 109.3652s
Epoch: 6 cost time: 8.055323839187622
Epoch: 6, Steps: 570 | Train Loss: 0.0702705 Vali Loss: 0.0333649 Test Loss: 0.1425450
Validation loss decreased (0.033861 --> 0.033365).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0654657
	speed: 0.0456s/iter; left time: 359.7506s
	iters: 200, epoch: 7 | loss: 0.0705935
	speed: 0.0136s/iter; left time: 106.1311s
	iters: 300, epoch: 7 | loss: 0.0509100
	speed: 0.0136s/iter; left time: 104.6014s
	iters: 400, epoch: 7 | loss: 0.0633409
	speed: 0.0136s/iter; left time: 103.2258s
	iters: 500, epoch: 7 | loss: 0.0975587
	speed: 0.0136s/iter; left time: 101.8052s
Epoch: 7 cost time: 8.082286357879639
Epoch: 7, Steps: 570 | Train Loss: 0.0681824 Vali Loss: 0.0336655 Test Loss: 0.1403572
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0956806
	speed: 0.0452s/iter; left time: 330.8063s
	iters: 200, epoch: 8 | loss: 0.0627450
	speed: 0.0137s/iter; left time: 98.7426s
	iters: 300, epoch: 8 | loss: 0.0663303
	speed: 0.0137s/iter; left time: 97.3525s
	iters: 400, epoch: 8 | loss: 0.0545766
	speed: 0.0137s/iter; left time: 95.9847s
	iters: 500, epoch: 8 | loss: 0.0640488
	speed: 0.0137s/iter; left time: 94.6241s
Epoch: 8 cost time: 8.129994869232178
Epoch: 8, Steps: 570 | Train Loss: 0.0669320 Vali Loss: 0.0336026 Test Loss: 0.1410938
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0882823
	speed: 0.0455s/iter; left time: 306.5015s
	iters: 200, epoch: 9 | loss: 0.0625098
	speed: 0.0151s/iter; left time: 100.4885s
	iters: 300, epoch: 9 | loss: 0.0696202
	speed: 0.0167s/iter; left time: 108.9736s
	iters: 400, epoch: 9 | loss: 0.0970610
	speed: 0.0163s/iter; left time: 104.7046s
	iters: 500, epoch: 9 | loss: 0.0535186
	speed: 0.0158s/iter; left time: 100.0336s
Epoch: 9 cost time: 9.235925912857056
Epoch: 9, Steps: 570 | Train Loss: 0.0663572 Vali Loss: 0.0335445 Test Loss: 0.1410328
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14278028905391693, mae:0.2392059564590454
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2086009
	speed: 0.0250s/iter; left time: 282.0467s
	iters: 200, epoch: 1 | loss: 0.1268833
	speed: 0.0135s/iter; left time: 151.0621s
	iters: 300, epoch: 1 | loss: 0.0825019
	speed: 0.0135s/iter; left time: 149.4465s
	iters: 400, epoch: 1 | loss: 0.1786777
	speed: 0.0135s/iter; left time: 148.6024s
	iters: 500, epoch: 1 | loss: 0.1494922
	speed: 0.0135s/iter; left time: 147.1702s
Epoch: 1 cost time: 8.882765769958496
Epoch: 1, Steps: 570 | Train Loss: 0.1467718 Vali Loss: 0.0342594 Test Loss: 0.1109782
Validation loss decreased (inf --> 0.034259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0795360
	speed: 0.0473s/iter; left time: 507.9208s
	iters: 200, epoch: 2 | loss: 0.1822288
	speed: 0.0134s/iter; left time: 142.6120s
	iters: 300, epoch: 2 | loss: 0.1266771
	speed: 0.0135s/iter; left time: 141.7247s
	iters: 400, epoch: 2 | loss: 0.0741273
	speed: 0.0134s/iter; left time: 139.8737s
	iters: 500, epoch: 2 | loss: 0.0941638
	speed: 0.0134s/iter; left time: 138.5346s
Epoch: 2 cost time: 7.987172365188599
Epoch: 2, Steps: 570 | Train Loss: 0.1086508 Vali Loss: 0.0347206 Test Loss: 0.1152831
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1089271
	speed: 0.0474s/iter; left time: 481.2440s
	iters: 200, epoch: 3 | loss: 0.0491227
	speed: 0.0134s/iter; left time: 134.7198s
	iters: 300, epoch: 3 | loss: 0.0805668
	speed: 0.0134s/iter; left time: 133.5506s
	iters: 400, epoch: 3 | loss: 0.0633435
	speed: 0.0134s/iter; left time: 132.3824s
	iters: 500, epoch: 3 | loss: 0.0806450
	speed: 0.0134s/iter; left time: 131.0201s
Epoch: 3 cost time: 8.009812593460083
Epoch: 3, Steps: 570 | Train Loss: 0.0849287 Vali Loss: 0.0339566 Test Loss: 0.1128228
Validation loss decreased (0.034259 --> 0.033957).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0430873
	speed: 0.0456s/iter; left time: 437.6705s
	iters: 200, epoch: 4 | loss: 0.0846040
	speed: 0.0136s/iter; left time: 128.6509s
	iters: 300, epoch: 4 | loss: 0.0854110
	speed: 0.0135s/iter; left time: 127.0536s
	iters: 400, epoch: 4 | loss: 0.0510526
	speed: 0.0135s/iter; left time: 125.7608s
	iters: 500, epoch: 4 | loss: 0.0482591
	speed: 0.0135s/iter; left time: 124.0822s
Epoch: 4 cost time: 8.046814918518066
Epoch: 4, Steps: 570 | Train Loss: 0.0707148 Vali Loss: 0.0325064 Test Loss: 0.1138103
Validation loss decreased (0.033957 --> 0.032506).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0418888
	speed: 0.0450s/iter; left time: 405.5050s
	iters: 200, epoch: 5 | loss: 0.0535754
	speed: 0.0134s/iter; left time: 119.6209s
	iters: 300, epoch: 5 | loss: 0.0558173
	speed: 0.0134s/iter; left time: 118.4091s
	iters: 400, epoch: 5 | loss: 0.0423305
	speed: 0.0134s/iter; left time: 116.9570s
	iters: 500, epoch: 5 | loss: 0.0710006
	speed: 0.0134s/iter; left time: 115.6490s
Epoch: 5 cost time: 7.96323823928833
Epoch: 5, Steps: 570 | Train Loss: 0.0630975 Vali Loss: 0.0331896 Test Loss: 0.1157545
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0559983
	speed: 0.0460s/iter; left time: 388.6570s
	iters: 200, epoch: 6 | loss: 0.0775681
	speed: 0.0134s/iter; left time: 112.0778s
	iters: 300, epoch: 6 | loss: 0.0614349
	speed: 0.0134s/iter; left time: 110.8677s
	iters: 400, epoch: 6 | loss: 0.0877111
	speed: 0.0134s/iter; left time: 109.6073s
	iters: 500, epoch: 6 | loss: 0.0537601
	speed: 0.0134s/iter; left time: 108.2539s
Epoch: 6 cost time: 7.990378141403198
Epoch: 6, Steps: 570 | Train Loss: 0.0592694 Vali Loss: 0.0337582 Test Loss: 0.1174152
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0422037
	speed: 0.0460s/iter; left time: 362.2612s
	iters: 200, epoch: 7 | loss: 0.0650079
	speed: 0.0135s/iter; left time: 105.3910s
	iters: 300, epoch: 7 | loss: 0.0573400
	speed: 0.0135s/iter; left time: 103.7487s
	iters: 400, epoch: 7 | loss: 0.0773056
	speed: 0.0135s/iter; left time: 102.3324s
	iters: 500, epoch: 7 | loss: 0.0634231
	speed: 0.0135s/iter; left time: 100.8746s
Epoch: 7 cost time: 8.008410215377808
Epoch: 7, Steps: 570 | Train Loss: 0.0573789 Vali Loss: 0.0333042 Test Loss: 0.1173780
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1139611005783081, mae:0.2082395851612091
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1144149
	speed: 0.0252s/iter; left time: 284.7158s
	iters: 200, epoch: 1 | loss: 0.2406504
	speed: 0.0134s/iter; left time: 150.2339s
	iters: 300, epoch: 1 | loss: 0.2033081
	speed: 0.0134s/iter; left time: 148.6007s
	iters: 400, epoch: 1 | loss: 0.1833813
	speed: 0.0134s/iter; left time: 147.3582s
	iters: 500, epoch: 1 | loss: 0.2188929
	speed: 0.0134s/iter; left time: 146.4056s
Epoch: 1 cost time: 8.872413635253906
Epoch: 1, Steps: 570 | Train Loss: 0.1830724 Vali Loss: 0.0439534 Test Loss: 0.1360427
Validation loss decreased (inf --> 0.043953).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1161361
	speed: 0.0443s/iter; left time: 475.3628s
	iters: 200, epoch: 2 | loss: 0.1070751
	speed: 0.0133s/iter; left time: 141.8372s
	iters: 300, epoch: 2 | loss: 0.0788092
	speed: 0.0134s/iter; left time: 140.6175s
	iters: 400, epoch: 2 | loss: 0.1083257
	speed: 0.0133s/iter; left time: 139.1059s
	iters: 500, epoch: 2 | loss: 0.1613746
	speed: 0.0134s/iter; left time: 137.9462s
Epoch: 2 cost time: 7.9257652759552
Epoch: 2, Steps: 570 | Train Loss: 0.1330781 Vali Loss: 0.0425666 Test Loss: 0.1355622
Validation loss decreased (0.043953 --> 0.042567).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1262835
	speed: 0.0449s/iter; left time: 456.4993s
	iters: 200, epoch: 3 | loss: 0.1231543
	speed: 0.0134s/iter; left time: 134.7937s
	iters: 300, epoch: 3 | loss: 0.1130273
	speed: 0.0134s/iter; left time: 133.5371s
	iters: 400, epoch: 3 | loss: 0.0933835
	speed: 0.0134s/iter; left time: 131.9778s
	iters: 500, epoch: 3 | loss: 0.0828833
	speed: 0.0134s/iter; left time: 130.8776s
Epoch: 3 cost time: 7.959874629974365
Epoch: 3, Steps: 570 | Train Loss: 0.1018775 Vali Loss: 0.0402669 Test Loss: 0.1315529
Validation loss decreased (0.042567 --> 0.040267).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0914271
	speed: 0.0442s/iter; left time: 424.0340s
	iters: 200, epoch: 4 | loss: 0.0881497
	speed: 0.0134s/iter; left time: 126.9179s
	iters: 300, epoch: 4 | loss: 0.1122045
	speed: 0.0134s/iter; left time: 125.6801s
	iters: 400, epoch: 4 | loss: 0.0924591
	speed: 0.0134s/iter; left time: 124.1910s
	iters: 500, epoch: 4 | loss: 0.0600994
	speed: 0.0134s/iter; left time: 123.1078s
Epoch: 4 cost time: 7.933874130249023
Epoch: 4, Steps: 570 | Train Loss: 0.0849475 Vali Loss: 0.0398159 Test Loss: 0.1358591
Validation loss decreased (0.040267 --> 0.039816).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0953159
	speed: 0.0452s/iter; left time: 407.3871s
	iters: 200, epoch: 5 | loss: 0.0844836
	speed: 0.0135s/iter; left time: 120.4714s
	iters: 300, epoch: 5 | loss: 0.0806522
	speed: 0.0135s/iter; left time: 119.0989s
	iters: 400, epoch: 5 | loss: 0.1095421
	speed: 0.0135s/iter; left time: 117.5686s
	iters: 500, epoch: 5 | loss: 0.0639920
	speed: 0.0135s/iter; left time: 116.3398s
Epoch: 5 cost time: 7.9931418895721436
Epoch: 5, Steps: 570 | Train Loss: 0.0758155 Vali Loss: 0.0397634 Test Loss: 0.1374840
Validation loss decreased (0.039816 --> 0.039763).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0751844
	speed: 0.0493s/iter; left time: 416.8253s
	iters: 200, epoch: 6 | loss: 0.0710672
	speed: 0.0151s/iter; left time: 126.0852s
	iters: 300, epoch: 6 | loss: 0.0579034
	speed: 0.0151s/iter; left time: 124.6281s
	iters: 400, epoch: 6 | loss: 0.1137909
	speed: 0.0151s/iter; left time: 122.7402s
	iters: 500, epoch: 6 | loss: 0.0788763
	speed: 0.0140s/iter; left time: 112.9238s
Epoch: 6 cost time: 8.698703050613403
Epoch: 6, Steps: 570 | Train Loss: 0.0710732 Vali Loss: 0.0392962 Test Loss: 0.1376793
Validation loss decreased (0.039763 --> 0.039296).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0663552
	speed: 0.0447s/iter; left time: 352.0698s
	iters: 200, epoch: 7 | loss: 0.0596826
	speed: 0.0135s/iter; left time: 105.2372s
	iters: 300, epoch: 7 | loss: 0.0695392
	speed: 0.0135s/iter; left time: 103.9101s
	iters: 400, epoch: 7 | loss: 0.0918856
	speed: 0.0135s/iter; left time: 102.6412s
	iters: 500, epoch: 7 | loss: 0.0480557
	speed: 0.0135s/iter; left time: 101.0962s
Epoch: 7 cost time: 8.069202661514282
Epoch: 7, Steps: 570 | Train Loss: 0.0685185 Vali Loss: 0.0394485 Test Loss: 0.1380076
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0535319
	speed: 0.0437s/iter; left time: 319.1831s
	iters: 200, epoch: 8 | loss: 0.0492976
	speed: 0.0133s/iter; left time: 96.1874s
	iters: 300, epoch: 8 | loss: 0.0699289
	speed: 0.0133s/iter; left time: 94.9063s
	iters: 400, epoch: 8 | loss: 0.0725985
	speed: 0.0134s/iter; left time: 93.7366s
	iters: 500, epoch: 8 | loss: 0.0543380
	speed: 0.0133s/iter; left time: 92.2325s
Epoch: 8 cost time: 7.866165399551392
Epoch: 8, Steps: 570 | Train Loss: 0.0673541 Vali Loss: 0.0400491 Test Loss: 0.1392234
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0756388
	speed: 0.0453s/iter; left time: 305.1627s
	iters: 200, epoch: 9 | loss: 0.0615586
	speed: 0.0135s/iter; left time: 89.6676s
	iters: 300, epoch: 9 | loss: 0.0448848
	speed: 0.0135s/iter; left time: 88.4749s
	iters: 400, epoch: 9 | loss: 0.0649287
	speed: 0.0135s/iter; left time: 87.0241s
	iters: 500, epoch: 9 | loss: 0.0648801
	speed: 0.0135s/iter; left time: 85.7405s
Epoch: 9 cost time: 8.144781112670898
Epoch: 9, Steps: 570 | Train Loss: 0.0667382 Vali Loss: 0.0394727 Test Loss: 0.1387659
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13790731132030487, mae:0.24107909202575684
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2078299
	speed: 0.0299s/iter; left time: 338.2921s
	iters: 200, epoch: 1 | loss: 0.1424055
	speed: 0.0177s/iter; left time: 198.6591s
	iters: 300, epoch: 1 | loss: 0.1897625
	speed: 0.0178s/iter; left time: 197.2951s
	iters: 400, epoch: 1 | loss: 0.1409163
	speed: 0.0178s/iter; left time: 195.6991s
	iters: 500, epoch: 1 | loss: 0.1303341
	speed: 0.0178s/iter; left time: 193.8146s
Epoch: 1 cost time: 11.394493103027344
Epoch: 1, Steps: 570 | Train Loss: 0.1713149 Vali Loss: 0.0450306 Test Loss: 0.1379519
Validation loss decreased (inf --> 0.045031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1361812
	speed: 0.0527s/iter; left time: 566.0586s
	iters: 200, epoch: 2 | loss: 0.1315437
	speed: 0.0178s/iter; left time: 189.3635s
	iters: 300, epoch: 2 | loss: 0.1162446
	speed: 0.0178s/iter; left time: 187.3443s
	iters: 400, epoch: 2 | loss: 0.0781730
	speed: 0.0178s/iter; left time: 185.4151s
	iters: 500, epoch: 2 | loss: 0.0761840
	speed: 0.0178s/iter; left time: 183.5739s
Epoch: 2 cost time: 10.440245389938354
Epoch: 2, Steps: 570 | Train Loss: 0.1173301 Vali Loss: 0.0351438 Test Loss: 0.1238170
Validation loss decreased (0.045031 --> 0.035144).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0778482
	speed: 0.0512s/iter; left time: 519.9251s
	iters: 200, epoch: 3 | loss: 0.0825490
	speed: 0.0163s/iter; left time: 164.3218s
	iters: 300, epoch: 3 | loss: 0.1426406
	speed: 0.0163s/iter; left time: 162.6235s
	iters: 400, epoch: 3 | loss: 0.0660927
	speed: 0.0163s/iter; left time: 160.9285s
	iters: 500, epoch: 3 | loss: 0.0541380
	speed: 0.0163s/iter; left time: 159.4271s
Epoch: 3 cost time: 9.612198114395142
Epoch: 3, Steps: 570 | Train Loss: 0.0766610 Vali Loss: 0.0350214 Test Loss: 0.1284641
Validation loss decreased (0.035144 --> 0.035021).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0515998
	speed: 0.0498s/iter; left time: 477.8186s
	iters: 200, epoch: 4 | loss: 0.0599067
	speed: 0.0163s/iter; left time: 155.0982s
	iters: 300, epoch: 4 | loss: 0.0413344
	speed: 0.0164s/iter; left time: 154.1632s
	iters: 400, epoch: 4 | loss: 0.0718858
	speed: 0.0164s/iter; left time: 152.5855s
	iters: 500, epoch: 4 | loss: 0.0584151
	speed: 0.0164s/iter; left time: 150.7370s
Epoch: 4 cost time: 9.6574866771698
Epoch: 4, Steps: 570 | Train Loss: 0.0558121 Vali Loss: 0.0368052 Test Loss: 0.1358294
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0419310
	speed: 0.0504s/iter; left time: 454.4853s
	iters: 200, epoch: 5 | loss: 0.0496591
	speed: 0.0163s/iter; left time: 145.8533s
	iters: 300, epoch: 5 | loss: 0.0489003
	speed: 0.0163s/iter; left time: 144.1862s
	iters: 400, epoch: 5 | loss: 0.0590560
	speed: 0.0163s/iter; left time: 142.4145s
	iters: 500, epoch: 5 | loss: 0.0397884
	speed: 0.0163s/iter; left time: 140.9090s
Epoch: 5 cost time: 9.635277271270752
Epoch: 5, Steps: 570 | Train Loss: 0.0466488 Vali Loss: 0.0354055 Test Loss: 0.1407815
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0395191
	speed: 0.0515s/iter; left time: 435.4149s
	iters: 200, epoch: 6 | loss: 0.0326661
	speed: 0.0163s/iter; left time: 136.4583s
	iters: 300, epoch: 6 | loss: 0.0438034
	speed: 0.0163s/iter; left time: 134.8899s
	iters: 400, epoch: 6 | loss: 0.0483762
	speed: 0.0163s/iter; left time: 133.0532s
	iters: 500, epoch: 6 | loss: 0.0372350
	speed: 0.0163s/iter; left time: 131.3526s
Epoch: 6 cost time: 9.602179288864136
Epoch: 6, Steps: 570 | Train Loss: 0.0420321 Vali Loss: 0.0355620 Test Loss: 0.1407559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12866666913032532, mae:0.23136582970619202
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1477773
	speed: 0.0274s/iter; left time: 309.9178s
	iters: 200, epoch: 1 | loss: 0.0753202
	speed: 0.0158s/iter; left time: 177.1375s
	iters: 300, epoch: 1 | loss: 0.1597915
	speed: 0.0158s/iter; left time: 175.3575s
	iters: 400, epoch: 1 | loss: 0.1282118
	speed: 0.0158s/iter; left time: 173.8594s
	iters: 500, epoch: 1 | loss: 0.0819353
	speed: 0.0158s/iter; left time: 172.3019s
Epoch: 1 cost time: 10.227953910827637
Epoch: 1, Steps: 570 | Train Loss: 0.1416919 Vali Loss: 0.0340319 Test Loss: 0.1118738
Validation loss decreased (inf --> 0.034032).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1035396
	speed: 0.0495s/iter; left time: 531.4050s
	iters: 200, epoch: 2 | loss: 0.0897047
	speed: 0.0159s/iter; left time: 169.4592s
	iters: 300, epoch: 2 | loss: 0.1571794
	speed: 0.0159s/iter; left time: 167.7646s
	iters: 400, epoch: 2 | loss: 0.0875617
	speed: 0.0159s/iter; left time: 166.0461s
	iters: 500, epoch: 2 | loss: 0.0733796
	speed: 0.0159s/iter; left time: 164.6765s
Epoch: 2 cost time: 9.393481254577637
Epoch: 2, Steps: 570 | Train Loss: 0.0999425 Vali Loss: 0.0362646 Test Loss: 0.1160469
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0676384
	speed: 0.0489s/iter; left time: 496.9477s
	iters: 200, epoch: 3 | loss: 0.0603915
	speed: 0.0158s/iter; left time: 159.4311s
	iters: 300, epoch: 3 | loss: 0.0641372
	speed: 0.0159s/iter; left time: 158.0344s
	iters: 400, epoch: 3 | loss: 0.0787638
	speed: 0.0159s/iter; left time: 156.3682s
	iters: 500, epoch: 3 | loss: 0.0494916
	speed: 0.0159s/iter; left time: 154.7947s
Epoch: 3 cost time: 9.346500158309937
Epoch: 3, Steps: 570 | Train Loss: 0.0663488 Vali Loss: 0.0348005 Test Loss: 0.1191276
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0568060
	speed: 0.0495s/iter; left time: 474.7051s
	iters: 200, epoch: 4 | loss: 0.0655669
	speed: 0.0158s/iter; left time: 149.9872s
	iters: 300, epoch: 4 | loss: 0.0402272
	speed: 0.0158s/iter; left time: 148.3447s
	iters: 400, epoch: 4 | loss: 0.0446116
	speed: 0.0158s/iter; left time: 146.6136s
	iters: 500, epoch: 4 | loss: 0.0549300
	speed: 0.0158s/iter; left time: 144.9008s
Epoch: 4 cost time: 9.324583768844604
Epoch: 4, Steps: 570 | Train Loss: 0.0491865 Vali Loss: 0.0349448 Test Loss: 0.1214562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11205563694238663, mae:0.20530520379543304
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1708764
	speed: 0.0280s/iter; left time: 316.3273s
	iters: 200, epoch: 1 | loss: 0.1193258
	speed: 0.0161s/iter; left time: 180.3134s
	iters: 300, epoch: 1 | loss: 0.1656508
	speed: 0.0161s/iter; left time: 178.8348s
	iters: 400, epoch: 1 | loss: 0.1511722
	speed: 0.0161s/iter; left time: 176.9747s
	iters: 500, epoch: 1 | loss: 0.2388563
	speed: 0.0161s/iter; left time: 175.6477s
Epoch: 1 cost time: 10.427111864089966
Epoch: 1, Steps: 570 | Train Loss: 0.1793625 Vali Loss: 0.0441069 Test Loss: 0.1392629
Validation loss decreased (inf --> 0.044107).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1864589
	speed: 0.0483s/iter; left time: 518.1492s
	iters: 200, epoch: 2 | loss: 0.0733957
	speed: 0.0147s/iter; left time: 155.7823s
	iters: 300, epoch: 2 | loss: 0.1169123
	speed: 0.0146s/iter; left time: 154.1904s
	iters: 400, epoch: 2 | loss: 0.1325214
	speed: 0.0146s/iter; left time: 152.6366s
	iters: 500, epoch: 2 | loss: 0.1146732
	speed: 0.0146s/iter; left time: 151.1193s
Epoch: 2 cost time: 8.655827283859253
Epoch: 2, Steps: 570 | Train Loss: 0.1177451 Vali Loss: 0.0400731 Test Loss: 0.1421569
Validation loss decreased (0.044107 --> 0.040073).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0823320
	speed: 0.0478s/iter; left time: 485.2151s
	iters: 200, epoch: 3 | loss: 0.0564177
	speed: 0.0146s/iter; left time: 147.0375s
	iters: 300, epoch: 3 | loss: 0.0987329
	speed: 0.0146s/iter; left time: 145.5171s
	iters: 400, epoch: 3 | loss: 0.0602564
	speed: 0.0146s/iter; left time: 143.9746s
	iters: 500, epoch: 3 | loss: 0.0829141
	speed: 0.0146s/iter; left time: 142.5362s
Epoch: 3 cost time: 8.640058755874634
Epoch: 3, Steps: 570 | Train Loss: 0.0726184 Vali Loss: 0.0375189 Test Loss: 0.1363660
Validation loss decreased (0.040073 --> 0.037519).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0425757
	speed: 0.0478s/iter; left time: 458.8941s
	iters: 200, epoch: 4 | loss: 0.0856920
	speed: 0.0146s/iter; left time: 138.8573s
	iters: 300, epoch: 4 | loss: 0.0566378
	speed: 0.0146s/iter; left time: 137.3810s
	iters: 400, epoch: 4 | loss: 0.0437738
	speed: 0.0146s/iter; left time: 135.9012s
	iters: 500, epoch: 4 | loss: 0.0620285
	speed: 0.0147s/iter; left time: 134.6843s
Epoch: 4 cost time: 8.67498230934143
Epoch: 4, Steps: 570 | Train Loss: 0.0526851 Vali Loss: 0.0370105 Test Loss: 0.1403879
Validation loss decreased (0.037519 --> 0.037011).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0406114
	speed: 0.0484s/iter; left time: 436.4284s
	iters: 200, epoch: 5 | loss: 0.0422068
	speed: 0.0161s/iter; left time: 143.3088s
	iters: 300, epoch: 5 | loss: 0.0453009
	speed: 0.0162s/iter; left time: 142.5762s
	iters: 400, epoch: 5 | loss: 0.0435832
	speed: 0.0162s/iter; left time: 140.8981s
	iters: 500, epoch: 5 | loss: 0.0368674
	speed: 0.0162s/iter; left time: 139.4807s
Epoch: 5 cost time: 9.462120056152344
Epoch: 5, Steps: 570 | Train Loss: 0.0436435 Vali Loss: 0.0378411 Test Loss: 0.1423287
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0305940
	speed: 0.0506s/iter; left time: 427.4910s
	iters: 200, epoch: 6 | loss: 0.0309110
	speed: 0.0158s/iter; left time: 131.8192s
	iters: 300, epoch: 6 | loss: 0.0290665
	speed: 0.0157s/iter; left time: 129.6337s
	iters: 400, epoch: 6 | loss: 0.0337679
	speed: 0.0162s/iter; left time: 132.3789s
	iters: 500, epoch: 6 | loss: 0.0298539
	speed: 0.0162s/iter; left time: 130.0741s
Epoch: 6 cost time: 9.39762568473816
Epoch: 6, Steps: 570 | Train Loss: 0.0393141 Vali Loss: 0.0380284 Test Loss: 0.1433180
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0388735
	speed: 0.0487s/iter; left time: 384.0113s
	iters: 200, epoch: 7 | loss: 0.0317292
	speed: 0.0159s/iter; left time: 123.5484s
	iters: 300, epoch: 7 | loss: 0.0503877
	speed: 0.0162s/iter; left time: 124.2605s
	iters: 400, epoch: 7 | loss: 0.0319478
	speed: 0.0161s/iter; left time: 122.3642s
	iters: 500, epoch: 7 | loss: 0.0518978
	speed: 0.0161s/iter; left time: 120.7877s
Epoch: 7 cost time: 9.407744884490967
Epoch: 7, Steps: 570 | Train Loss: 0.0371862 Vali Loss: 0.0383767 Test Loss: 0.1444984
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14058546721935272, mae:0.2441914826631546
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1207708
	speed: 0.0291s/iter; left time: 329.3618s
	iters: 200, epoch: 1 | loss: 0.1658366
	speed: 0.0176s/iter; left time: 196.8576s
	iters: 300, epoch: 1 | loss: 0.2600677
	speed: 0.0175s/iter; left time: 194.7626s
	iters: 400, epoch: 1 | loss: 0.1324711
	speed: 0.0176s/iter; left time: 193.1656s
	iters: 500, epoch: 1 | loss: 0.1258223
	speed: 0.0176s/iter; left time: 191.3945s
Epoch: 1 cost time: 11.227256774902344
Epoch: 1, Steps: 570 | Train Loss: 0.1767459 Vali Loss: 0.0456234 Test Loss: 0.1338982
Validation loss decreased (inf --> 0.045623).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1645802
	speed: 0.0569s/iter; left time: 610.2725s
	iters: 200, epoch: 2 | loss: 0.1161484
	speed: 0.0197s/iter; left time: 209.7566s
	iters: 300, epoch: 2 | loss: 0.1286412
	speed: 0.0196s/iter; left time: 206.4297s
	iters: 400, epoch: 2 | loss: 0.1164942
	speed: 0.0196s/iter; left time: 204.6089s
	iters: 500, epoch: 2 | loss: 0.1442048
	speed: 0.0196s/iter; left time: 202.4468s
Epoch: 2 cost time: 11.496079444885254
Epoch: 2, Steps: 570 | Train Loss: 0.1249090 Vali Loss: 0.0433283 Test Loss: 0.1317271
Validation loss decreased (0.045623 --> 0.043328).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0977896
	speed: 0.0558s/iter; left time: 567.2931s
	iters: 200, epoch: 3 | loss: 0.0681730
	speed: 0.0175s/iter; left time: 176.3985s
	iters: 300, epoch: 3 | loss: 0.0849765
	speed: 0.0175s/iter; left time: 174.4720s
	iters: 400, epoch: 3 | loss: 0.0804550
	speed: 0.0175s/iter; left time: 172.8585s
	iters: 500, epoch: 3 | loss: 0.0725421
	speed: 0.0175s/iter; left time: 171.1685s
Epoch: 3 cost time: 10.26699686050415
Epoch: 3, Steps: 570 | Train Loss: 0.0941606 Vali Loss: 0.0353566 Test Loss: 0.1254870
Validation loss decreased (0.043328 --> 0.035357).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0793846
	speed: 0.0535s/iter; left time: 513.0299s
	iters: 200, epoch: 4 | loss: 0.0919872
	speed: 0.0175s/iter; left time: 166.0062s
	iters: 300, epoch: 4 | loss: 0.0671227
	speed: 0.0175s/iter; left time: 164.1991s
	iters: 400, epoch: 4 | loss: 0.0602730
	speed: 0.0175s/iter; left time: 162.4086s
	iters: 500, epoch: 4 | loss: 0.0878569
	speed: 0.0175s/iter; left time: 160.6217s
Epoch: 4 cost time: 10.257752656936646
Epoch: 4, Steps: 570 | Train Loss: 0.0772238 Vali Loss: 0.0342536 Test Loss: 0.1399447
Validation loss decreased (0.035357 --> 0.034254).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0656800
	speed: 0.0559s/iter; left time: 504.1452s
	iters: 200, epoch: 5 | loss: 0.0561583
	speed: 0.0176s/iter; left time: 156.7911s
	iters: 300, epoch: 5 | loss: 0.0804801
	speed: 0.0176s/iter; left time: 154.9833s
	iters: 400, epoch: 5 | loss: 0.0545313
	speed: 0.0175s/iter; left time: 152.9262s
	iters: 500, epoch: 5 | loss: 0.0810072
	speed: 0.0175s/iter; left time: 150.9893s
Epoch: 5 cost time: 10.275804996490479
Epoch: 5, Steps: 570 | Train Loss: 0.0680126 Vali Loss: 0.0335107 Test Loss: 0.1322938
Validation loss decreased (0.034254 --> 0.033511).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0404243
	speed: 0.0544s/iter; left time: 459.8221s
	iters: 200, epoch: 6 | loss: 0.0678751
	speed: 0.0176s/iter; left time: 146.5929s
	iters: 300, epoch: 6 | loss: 0.0676996
	speed: 0.0176s/iter; left time: 144.8052s
	iters: 400, epoch: 6 | loss: 0.0885342
	speed: 0.0175s/iter; left time: 142.9604s
	iters: 500, epoch: 6 | loss: 0.0566523
	speed: 0.0175s/iter; left time: 141.0203s
Epoch: 6 cost time: 10.307605504989624
Epoch: 6, Steps: 570 | Train Loss: 0.0635844 Vali Loss: 0.0332794 Test Loss: 0.1336828
Validation loss decreased (0.033511 --> 0.033279).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0589511
	speed: 0.0537s/iter; left time: 423.0915s
	iters: 200, epoch: 7 | loss: 0.0571943
	speed: 0.0175s/iter; left time: 136.5262s
	iters: 300, epoch: 7 | loss: 0.0717927
	speed: 0.0175s/iter; left time: 134.7085s
	iters: 400, epoch: 7 | loss: 0.0719622
	speed: 0.0175s/iter; left time: 132.8706s
	iters: 500, epoch: 7 | loss: 0.0520488
	speed: 0.0176s/iter; left time: 131.3774s
Epoch: 7 cost time: 10.265719890594482
Epoch: 7, Steps: 570 | Train Loss: 0.0611406 Vali Loss: 0.0330539 Test Loss: 0.1343281
Validation loss decreased (0.033279 --> 0.033054).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0647300
	speed: 0.0535s/iter; left time: 391.5036s
	iters: 200, epoch: 8 | loss: 0.0595467
	speed: 0.0179s/iter; left time: 128.8483s
	iters: 300, epoch: 8 | loss: 0.0460011
	speed: 0.0196s/iter; left time: 139.6272s
	iters: 400, epoch: 8 | loss: 0.0597768
	speed: 0.0196s/iter; left time: 137.5903s
	iters: 500, epoch: 8 | loss: 0.0478682
	speed: 0.0196s/iter; left time: 135.6579s
Epoch: 8 cost time: 11.074920177459717
Epoch: 8, Steps: 570 | Train Loss: 0.0599008 Vali Loss: 0.0333627 Test Loss: 0.1343927
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0450619
	speed: 0.0549s/iter; left time: 370.0631s
	iters: 200, epoch: 9 | loss: 0.0991942
	speed: 0.0176s/iter; left time: 116.7296s
	iters: 300, epoch: 9 | loss: 0.0457475
	speed: 0.0176s/iter; left time: 114.9674s
	iters: 400, epoch: 9 | loss: 0.0412745
	speed: 0.0176s/iter; left time: 113.1698s
	iters: 500, epoch: 9 | loss: 0.0411304
	speed: 0.0176s/iter; left time: 111.6112s
Epoch: 9 cost time: 10.29896068572998
Epoch: 9, Steps: 570 | Train Loss: 0.0593183 Vali Loss: 0.0332272 Test Loss: 0.1348051
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0575047
	speed: 0.0589s/iter; left time: 363.6527s
	iters: 200, epoch: 10 | loss: 0.0695797
	speed: 0.0188s/iter; left time: 114.3574s
	iters: 300, epoch: 10 | loss: 0.0439022
	speed: 0.0175s/iter; left time: 104.6999s
	iters: 400, epoch: 10 | loss: 0.0652481
	speed: 0.0175s/iter; left time: 102.8767s
	iters: 500, epoch: 10 | loss: 0.0322872
	speed: 0.0175s/iter; left time: 101.1163s
Epoch: 10 cost time: 10.744315147399902
Epoch: 10, Steps: 570 | Train Loss: 0.0589843 Vali Loss: 0.0331905 Test Loss: 0.1361058
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13452480733394623, mae:0.23368285596370697
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3226862
	speed: 0.0312s/iter; left time: 352.6082s
	iters: 200, epoch: 1 | loss: 0.1668440
	speed: 0.0193s/iter; left time: 215.9531s
	iters: 300, epoch: 1 | loss: 0.1776613
	speed: 0.0193s/iter; left time: 214.3866s
	iters: 400, epoch: 1 | loss: 0.1115717
	speed: 0.0194s/iter; left time: 212.8951s
	iters: 500, epoch: 1 | loss: 0.1671815
	speed: 0.0193s/iter; left time: 210.6275s
Epoch: 1 cost time: 12.25816011428833
Epoch: 1, Steps: 570 | Train Loss: 0.1464359 Vali Loss: 0.0346369 Test Loss: 0.1122974
Validation loss decreased (inf --> 0.034637).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0989168
	speed: 0.0557s/iter; left time: 597.5979s
	iters: 200, epoch: 2 | loss: 0.1485835
	speed: 0.0173s/iter; left time: 183.8817s
	iters: 300, epoch: 2 | loss: 0.1692001
	speed: 0.0188s/iter; left time: 197.9012s
	iters: 400, epoch: 2 | loss: 0.0990008
	speed: 0.0198s/iter; left time: 206.2864s
	iters: 500, epoch: 2 | loss: 0.0971779
	speed: 0.0198s/iter; left time: 204.4747s
Epoch: 2 cost time: 10.980872392654419
Epoch: 2, Steps: 570 | Train Loss: 0.1085422 Vali Loss: 0.0356164 Test Loss: 0.1155539
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0768530
	speed: 0.0602s/iter; left time: 611.5406s
	iters: 200, epoch: 3 | loss: 0.0811924
	speed: 0.0198s/iter; left time: 198.7993s
	iters: 300, epoch: 3 | loss: 0.0978360
	speed: 0.0198s/iter; left time: 197.4649s
	iters: 400, epoch: 3 | loss: 0.0615743
	speed: 0.0198s/iter; left time: 194.8161s
	iters: 500, epoch: 3 | loss: 0.0687462
	speed: 0.0198s/iter; left time: 193.0090s
Epoch: 3 cost time: 11.614497900009155
Epoch: 3, Steps: 570 | Train Loss: 0.0823146 Vali Loss: 0.0338312 Test Loss: 0.1130264
Validation loss decreased (0.034637 --> 0.033831).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0664183
	speed: 0.0596s/iter; left time: 571.1978s
	iters: 200, epoch: 4 | loss: 0.0526979
	speed: 0.0197s/iter; left time: 187.2910s
	iters: 300, epoch: 4 | loss: 0.0824772
	speed: 0.0197s/iter; left time: 185.4263s
	iters: 400, epoch: 4 | loss: 0.0836798
	speed: 0.0197s/iter; left time: 183.3815s
	iters: 500, epoch: 4 | loss: 0.0645510
	speed: 0.0198s/iter; left time: 181.6098s
Epoch: 4 cost time: 11.381749868392944
Epoch: 4, Steps: 570 | Train Loss: 0.0654951 Vali Loss: 0.0329143 Test Loss: 0.1138199
Validation loss decreased (0.033831 --> 0.032914).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0522060
	speed: 0.0553s/iter; left time: 498.7700s
	iters: 200, epoch: 5 | loss: 0.0592664
	speed: 0.0173s/iter; left time: 154.5379s
	iters: 300, epoch: 5 | loss: 0.0512895
	speed: 0.0173s/iter; left time: 152.3429s
	iters: 400, epoch: 5 | loss: 0.0640452
	speed: 0.0173s/iter; left time: 150.6813s
	iters: 500, epoch: 5 | loss: 0.0600721
	speed: 0.0173s/iter; left time: 148.8054s
Epoch: 5 cost time: 10.145564794540405
Epoch: 5, Steps: 570 | Train Loss: 0.0567611 Vali Loss: 0.0334743 Test Loss: 0.1158179
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0593614
	speed: 0.0559s/iter; left time: 472.3175s
	iters: 200, epoch: 6 | loss: 0.0394505
	speed: 0.0193s/iter; left time: 160.8311s
	iters: 300, epoch: 6 | loss: 0.0592579
	speed: 0.0192s/iter; left time: 158.7277s
	iters: 400, epoch: 6 | loss: 0.0466528
	speed: 0.0192s/iter; left time: 156.8316s
	iters: 500, epoch: 6 | loss: 0.0352588
	speed: 0.0192s/iter; left time: 154.9051s
Epoch: 6 cost time: 11.301153898239136
Epoch: 6, Steps: 570 | Train Loss: 0.0526633 Vali Loss: 0.0331158 Test Loss: 0.1148413
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0470458
	speed: 0.0554s/iter; left time: 436.5758s
	iters: 200, epoch: 7 | loss: 0.0658160
	speed: 0.0172s/iter; left time: 133.6483s
	iters: 300, epoch: 7 | loss: 0.0436879
	speed: 0.0172s/iter; left time: 131.7486s
	iters: 400, epoch: 7 | loss: 0.0596417
	speed: 0.0172s/iter; left time: 130.2541s
	iters: 500, epoch: 7 | loss: 0.0392330
	speed: 0.0172s/iter; left time: 128.4162s
Epoch: 7 cost time: 10.039403915405273
Epoch: 7, Steps: 570 | Train Loss: 0.0504884 Vali Loss: 0.0333423 Test Loss: 0.1157486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11395978182554245, mae:0.20874567329883575
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2526689
	speed: 0.0287s/iter; left time: 324.2911s
	iters: 200, epoch: 1 | loss: 0.1506011
	speed: 0.0171s/iter; left time: 192.0688s
	iters: 300, epoch: 1 | loss: 0.1895043
	speed: 0.0171s/iter; left time: 190.3639s
	iters: 400, epoch: 1 | loss: 0.1955848
	speed: 0.0172s/iter; left time: 188.7121s
	iters: 500, epoch: 1 | loss: 0.2660136
	speed: 0.0172s/iter; left time: 187.1760s
Epoch: 1 cost time: 10.991947412490845
Epoch: 1, Steps: 570 | Train Loss: 0.1832555 Vali Loss: 0.0414752 Test Loss: 0.1353214
Validation loss decreased (inf --> 0.041475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1894857
	speed: 0.0582s/iter; left time: 624.7995s
	iters: 200, epoch: 2 | loss: 0.2140321
	speed: 0.0194s/iter; left time: 206.5487s
	iters: 300, epoch: 2 | loss: 0.2231693
	speed: 0.0194s/iter; left time: 203.9767s
	iters: 400, epoch: 2 | loss: 0.1023709
	speed: 0.0193s/iter; left time: 201.5676s
	iters: 500, epoch: 2 | loss: 0.0706140
	speed: 0.0193s/iter; left time: 199.2758s
Epoch: 2 cost time: 11.339491605758667
Epoch: 2, Steps: 570 | Train Loss: 0.1284721 Vali Loss: 0.0430929 Test Loss: 0.1399398
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1038830
	speed: 0.0573s/iter; left time: 582.2424s
	iters: 200, epoch: 3 | loss: 0.1072234
	speed: 0.0173s/iter; left time: 174.4965s
	iters: 300, epoch: 3 | loss: 0.0985372
	speed: 0.0173s/iter; left time: 171.9896s
	iters: 400, epoch: 3 | loss: 0.0693403
	speed: 0.0173s/iter; left time: 170.6013s
	iters: 500, epoch: 3 | loss: 0.0678159
	speed: 0.0173s/iter; left time: 168.4032s
Epoch: 3 cost time: 10.170094966888428
Epoch: 3, Steps: 570 | Train Loss: 0.0921640 Vali Loss: 0.0411940 Test Loss: 0.1413373
Validation loss decreased (0.041475 --> 0.041194).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0639332
	speed: 0.0536s/iter; left time: 514.5439s
	iters: 200, epoch: 4 | loss: 0.0903152
	speed: 0.0172s/iter; left time: 163.1889s
	iters: 300, epoch: 4 | loss: 0.0720685
	speed: 0.0172s/iter; left time: 161.0896s
	iters: 400, epoch: 4 | loss: 0.0802401
	speed: 0.0171s/iter; left time: 159.3260s
	iters: 500, epoch: 4 | loss: 0.0611074
	speed: 0.0172s/iter; left time: 157.6467s
Epoch: 4 cost time: 10.049198150634766
Epoch: 4, Steps: 570 | Train Loss: 0.0717763 Vali Loss: 0.0385932 Test Loss: 0.1380353
Validation loss decreased (0.041194 --> 0.038593).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0552789
	speed: 0.0543s/iter; left time: 489.7856s
	iters: 200, epoch: 5 | loss: 0.0573784
	speed: 0.0171s/iter; left time: 152.1922s
	iters: 300, epoch: 5 | loss: 0.0559159
	speed: 0.0170s/iter; left time: 150.3799s
	iters: 400, epoch: 5 | loss: 0.0563369
	speed: 0.0170s/iter; left time: 148.5962s
	iters: 500, epoch: 5 | loss: 0.0454566
	speed: 0.0170s/iter; left time: 146.9207s
Epoch: 5 cost time: 9.991517066955566
Epoch: 5, Steps: 570 | Train Loss: 0.0615526 Vali Loss: 0.0402327 Test Loss: 0.1463692
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0563857
	speed: 0.0525s/iter; left time: 443.7516s
	iters: 200, epoch: 6 | loss: 0.0544896
	speed: 0.0171s/iter; left time: 142.6596s
	iters: 300, epoch: 6 | loss: 0.0795186
	speed: 0.0171s/iter; left time: 140.9883s
	iters: 400, epoch: 6 | loss: 0.0644698
	speed: 0.0171s/iter; left time: 139.2646s
	iters: 500, epoch: 6 | loss: 0.0572942
	speed: 0.0171s/iter; left time: 137.5242s
Epoch: 6 cost time: 10.029054641723633
Epoch: 6, Steps: 570 | Train Loss: 0.0564596 Vali Loss: 0.0390845 Test Loss: 0.1458327
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0485623
	speed: 0.0548s/iter; left time: 431.7514s
	iters: 200, epoch: 7 | loss: 0.0468063
	speed: 0.0172s/iter; left time: 133.6767s
	iters: 300, epoch: 7 | loss: 0.0684707
	speed: 0.0172s/iter; left time: 131.8773s
	iters: 400, epoch: 7 | loss: 0.0643950
	speed: 0.0172s/iter; left time: 130.1603s
	iters: 500, epoch: 7 | loss: 0.0415587
	speed: 0.0172s/iter; left time: 128.4303s
Epoch: 7 cost time: 10.065946340560913
Epoch: 7, Steps: 570 | Train Loss: 0.0539953 Vali Loss: 0.0394990 Test Loss: 0.1465579
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13822001218795776, mae:0.23914697766304016
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1888228
	speed: 0.0352s/iter; left time: 397.2396s
	iters: 200, epoch: 1 | loss: 0.1582943
	speed: 0.0232s/iter; left time: 259.4727s
	iters: 300, epoch: 1 | loss: 0.1563228
	speed: 0.0232s/iter; left time: 257.2971s
	iters: 400, epoch: 1 | loss: 0.2523674
	speed: 0.0231s/iter; left time: 254.3235s
	iters: 500, epoch: 1 | loss: 0.2365478
	speed: 0.0231s/iter; left time: 252.0371s
Epoch: 1 cost time: 14.446568250656128
Epoch: 1, Steps: 570 | Train Loss: 0.1755242 Vali Loss: 0.0442618 Test Loss: 0.1377467
Validation loss decreased (inf --> 0.044262).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1871693
	speed: 0.0658s/iter; left time: 706.1471s
	iters: 200, epoch: 2 | loss: 0.0924348
	speed: 0.0214s/iter; left time: 227.1194s
	iters: 300, epoch: 2 | loss: 0.1252180
	speed: 0.0221s/iter; left time: 233.0483s
	iters: 400, epoch: 2 | loss: 0.1210898
	speed: 0.0223s/iter; left time: 232.5018s
	iters: 500, epoch: 2 | loss: 0.0729622
	speed: 0.0223s/iter; left time: 230.2079s
Epoch: 2 cost time: 12.826947689056396
Epoch: 2, Steps: 570 | Train Loss: 0.1170748 Vali Loss: 0.0391907 Test Loss: 0.1344381
Validation loss decreased (0.044262 --> 0.039191).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0959562
	speed: 0.0677s/iter; left time: 688.1851s
	iters: 200, epoch: 3 | loss: 0.0675417
	speed: 0.0216s/iter; left time: 217.7877s
	iters: 300, epoch: 3 | loss: 0.0984169
	speed: 0.0214s/iter; left time: 213.2232s
	iters: 400, epoch: 3 | loss: 0.0519896
	speed: 0.0214s/iter; left time: 211.0112s
	iters: 500, epoch: 3 | loss: 0.0565442
	speed: 0.0214s/iter; left time: 208.8638s
Epoch: 3 cost time: 12.723251819610596
Epoch: 3, Steps: 570 | Train Loss: 0.0725646 Vali Loss: 0.0358213 Test Loss: 0.1385621
Validation loss decreased (0.039191 --> 0.035821).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0500028
	speed: 0.0655s/iter; left time: 628.3863s
	iters: 200, epoch: 4 | loss: 0.0390338
	speed: 0.0215s/iter; left time: 203.9752s
	iters: 300, epoch: 4 | loss: 0.0459121
	speed: 0.0215s/iter; left time: 201.5770s
	iters: 400, epoch: 4 | loss: 0.0498361
	speed: 0.0214s/iter; left time: 198.7949s
	iters: 500, epoch: 4 | loss: 0.0820427
	speed: 0.0214s/iter; left time: 196.7982s
Epoch: 4 cost time: 12.711302042007446
Epoch: 4, Steps: 570 | Train Loss: 0.0506902 Vali Loss: 0.0382494 Test Loss: 0.1395986
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0575483
	speed: 0.0648s/iter; left time: 584.7742s
	iters: 200, epoch: 5 | loss: 0.0359831
	speed: 0.0224s/iter; left time: 199.7875s
	iters: 300, epoch: 5 | loss: 0.0293592
	speed: 0.0224s/iter; left time: 197.2629s
	iters: 400, epoch: 5 | loss: 0.0327550
	speed: 0.0224s/iter; left time: 195.2832s
	iters: 500, epoch: 5 | loss: 0.0358799
	speed: 0.0224s/iter; left time: 193.0790s
Epoch: 5 cost time: 13.050045013427734
Epoch: 5, Steps: 570 | Train Loss: 0.0410975 Vali Loss: 0.0380475 Test Loss: 0.1372982
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0283897
	speed: 0.0641s/iter; left time: 541.9514s
	iters: 200, epoch: 6 | loss: 0.0320395
	speed: 0.0232s/iter; left time: 193.4781s
	iters: 300, epoch: 6 | loss: 0.0325276
	speed: 0.0231s/iter; left time: 190.9426s
	iters: 400, epoch: 6 | loss: 0.0307756
	speed: 0.0231s/iter; left time: 188.6622s
	iters: 500, epoch: 6 | loss: 0.0497869
	speed: 0.0231s/iter; left time: 186.3337s
Epoch: 6 cost time: 13.499301195144653
Epoch: 6, Steps: 570 | Train Loss: 0.0364597 Vali Loss: 0.0385614 Test Loss: 0.1396468
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13873861730098724, mae:0.24120382964611053
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1323162
	speed: 0.0345s/iter; left time: 390.1510s
	iters: 200, epoch: 1 | loss: 0.0824137
	speed: 0.0224s/iter; left time: 251.3283s
	iters: 300, epoch: 1 | loss: 0.1541070
	speed: 0.0225s/iter; left time: 249.4896s
	iters: 400, epoch: 1 | loss: 0.1056086
	speed: 0.0225s/iter; left time: 247.2837s
	iters: 500, epoch: 1 | loss: 0.1541315
	speed: 0.0224s/iter; left time: 244.6248s
Epoch: 1 cost time: 14.064595937728882
Epoch: 1, Steps: 570 | Train Loss: 0.1440308 Vali Loss: 0.0353116 Test Loss: 0.1119556
Validation loss decreased (inf --> 0.035312).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1237014
	speed: 0.0623s/iter; left time: 668.6089s
	iters: 200, epoch: 2 | loss: 0.0813918
	speed: 0.0206s/iter; left time: 219.1649s
	iters: 300, epoch: 2 | loss: 0.1027531
	speed: 0.0206s/iter; left time: 216.8261s
	iters: 400, epoch: 2 | loss: 0.0933123
	speed: 0.0206s/iter; left time: 215.0736s
	iters: 500, epoch: 2 | loss: 0.0625068
	speed: 0.0207s/iter; left time: 213.7842s
Epoch: 2 cost time: 12.110306739807129
Epoch: 2, Steps: 570 | Train Loss: 0.0988597 Vali Loss: 0.0343631 Test Loss: 0.1173671
Validation loss decreased (0.035312 --> 0.034363).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0641420
	speed: 0.0606s/iter; left time: 616.0512s
	iters: 200, epoch: 3 | loss: 0.0536526
	speed: 0.0207s/iter; left time: 207.9695s
	iters: 300, epoch: 3 | loss: 0.0694883
	speed: 0.0207s/iter; left time: 205.7418s
	iters: 400, epoch: 3 | loss: 0.0559392
	speed: 0.0207s/iter; left time: 203.7613s
	iters: 500, epoch: 3 | loss: 0.0553465
	speed: 0.0206s/iter; left time: 201.4946s
Epoch: 3 cost time: 12.081169843673706
Epoch: 3, Steps: 570 | Train Loss: 0.0621782 Vali Loss: 0.0342525 Test Loss: 0.1219186
Validation loss decreased (0.034363 --> 0.034253).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0366462
	speed: 0.0623s/iter; left time: 597.1284s
	iters: 200, epoch: 4 | loss: 0.0427919
	speed: 0.0205s/iter; left time: 194.8806s
	iters: 300, epoch: 4 | loss: 0.0457355
	speed: 0.0205s/iter; left time: 192.7960s
	iters: 400, epoch: 4 | loss: 0.0432367
	speed: 0.0205s/iter; left time: 190.7941s
	iters: 500, epoch: 4 | loss: 0.0349271
	speed: 0.0205s/iter; left time: 188.6823s
Epoch: 4 cost time: 12.015088081359863
Epoch: 4, Steps: 570 | Train Loss: 0.0436198 Vali Loss: 0.0343519 Test Loss: 0.1205175
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0357755
	speed: 0.0598s/iter; left time: 539.5460s
	iters: 200, epoch: 5 | loss: 0.0355270
	speed: 0.0207s/iter; left time: 184.4979s
	iters: 300, epoch: 5 | loss: 0.0306037
	speed: 0.0207s/iter; left time: 182.4268s
	iters: 400, epoch: 5 | loss: 0.0420264
	speed: 0.0207s/iter; left time: 180.3363s
	iters: 500, epoch: 5 | loss: 0.0385151
	speed: 0.0207s/iter; left time: 178.2707s
Epoch: 5 cost time: 12.05589771270752
Epoch: 5, Steps: 570 | Train Loss: 0.0357689 Vali Loss: 0.0346102 Test Loss: 0.1223844
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0234594
	speed: 0.0614s/iter; left time: 518.9624s
	iters: 200, epoch: 6 | loss: 0.0269406
	speed: 0.0206s/iter; left time: 172.3710s
	iters: 300, epoch: 6 | loss: 0.0281651
	speed: 0.0206s/iter; left time: 170.3451s
	iters: 400, epoch: 6 | loss: 0.0390316
	speed: 0.0206s/iter; left time: 168.2727s
	iters: 500, epoch: 6 | loss: 0.0268994
	speed: 0.0206s/iter; left time: 166.2037s
Epoch: 6 cost time: 12.043020248413086
Epoch: 6, Steps: 570 | Train Loss: 0.0320021 Vali Loss: 0.0347968 Test Loss: 0.1230432
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12209206074476242, mae:0.2197163850069046
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1993479
	speed: 0.0329s/iter; left time: 372.3471s
	iters: 200, epoch: 1 | loss: 0.1782197
	speed: 0.0210s/iter; left time: 234.9644s
	iters: 300, epoch: 1 | loss: 0.1975592
	speed: 0.0210s/iter; left time: 233.1408s
	iters: 400, epoch: 1 | loss: 0.2005119
	speed: 0.0210s/iter; left time: 231.2028s
	iters: 500, epoch: 1 | loss: 0.1762355
	speed: 0.0209s/iter; left time: 228.3444s
Epoch: 1 cost time: 13.2682785987854
Epoch: 1, Steps: 570 | Train Loss: 0.1741566 Vali Loss: 0.0434220 Test Loss: 0.1350538
Validation loss decreased (inf --> 0.043422).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0638883
	speed: 0.0623s/iter; left time: 668.9219s
	iters: 200, epoch: 2 | loss: 0.1771397
	speed: 0.0218s/iter; left time: 231.6555s
	iters: 300, epoch: 2 | loss: 0.0777541
	speed: 0.0217s/iter; left time: 228.7621s
	iters: 400, epoch: 2 | loss: 0.0867392
	speed: 0.0217s/iter; left time: 225.9781s
	iters: 500, epoch: 2 | loss: 0.0822950
	speed: 0.0217s/iter; left time: 223.7740s
Epoch: 2 cost time: 12.685627937316895
Epoch: 2, Steps: 570 | Train Loss: 0.1135138 Vali Loss: 0.0410773 Test Loss: 0.1439481
Validation loss decreased (0.043422 --> 0.041077).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0571769
	speed: 0.0625s/iter; left time: 634.5798s
	iters: 200, epoch: 3 | loss: 0.0578771
	speed: 0.0191s/iter; left time: 191.8252s
	iters: 300, epoch: 3 | loss: 0.0776076
	speed: 0.0191s/iter; left time: 189.8743s
	iters: 400, epoch: 3 | loss: 0.0569135
	speed: 0.0190s/iter; left time: 187.8449s
	iters: 500, epoch: 3 | loss: 0.0758753
	speed: 0.0190s/iter; left time: 185.5777s
Epoch: 3 cost time: 11.344019412994385
Epoch: 3, Steps: 570 | Train Loss: 0.0699668 Vali Loss: 0.0388080 Test Loss: 0.1375320
Validation loss decreased (0.041077 --> 0.038808).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0319529
	speed: 0.0592s/iter; left time: 568.0137s
	iters: 200, epoch: 4 | loss: 0.0382339
	speed: 0.0191s/iter; left time: 181.2300s
	iters: 300, epoch: 4 | loss: 0.0422708
	speed: 0.0195s/iter; left time: 183.1233s
	iters: 400, epoch: 4 | loss: 0.0494687
	speed: 0.0219s/iter; left time: 203.4562s
	iters: 500, epoch: 4 | loss: 0.0360663
	speed: 0.0219s/iter; left time: 201.2498s
Epoch: 4 cost time: 11.98630428314209
Epoch: 4, Steps: 570 | Train Loss: 0.0483091 Vali Loss: 0.0379723 Test Loss: 0.1417125
Validation loss decreased (0.038808 --> 0.037972).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0414709
	speed: 0.0627s/iter; left time: 565.6404s
	iters: 200, epoch: 5 | loss: 0.0288012
	speed: 0.0218s/iter; left time: 194.5883s
	iters: 300, epoch: 5 | loss: 0.0336405
	speed: 0.0218s/iter; left time: 192.4145s
	iters: 400, epoch: 5 | loss: 0.0298387
	speed: 0.0218s/iter; left time: 190.2065s
	iters: 500, epoch: 5 | loss: 0.0345208
	speed: 0.0218s/iter; left time: 188.0566s
Epoch: 5 cost time: 12.738741159439087
Epoch: 5, Steps: 570 | Train Loss: 0.0384476 Vali Loss: 0.0387255 Test Loss: 0.1445214
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0388057
	speed: 0.0641s/iter; left time: 541.4455s
	iters: 200, epoch: 6 | loss: 0.0374171
	speed: 0.0218s/iter; left time: 182.4624s
	iters: 300, epoch: 6 | loss: 0.0292357
	speed: 0.0218s/iter; left time: 180.2320s
	iters: 400, epoch: 6 | loss: 0.0309061
	speed: 0.0218s/iter; left time: 177.3227s
	iters: 500, epoch: 6 | loss: 0.0376697
	speed: 0.0217s/iter; left time: 175.0721s
Epoch: 6 cost time: 12.747246980667114
Epoch: 6, Steps: 570 | Train Loss: 0.0338836 Vali Loss: 0.0390634 Test Loss: 0.1482659
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0233778
	speed: 0.0635s/iter; left time: 500.3741s
	iters: 200, epoch: 7 | loss: 0.0288248
	speed: 0.0234s/iter; left time: 182.0683s
	iters: 300, epoch: 7 | loss: 0.0329367
	speed: 0.0234s/iter; left time: 179.5224s
	iters: 400, epoch: 7 | loss: 0.0305000
	speed: 0.0234s/iter; left time: 177.2657s
	iters: 500, epoch: 7 | loss: 0.0248829
	speed: 0.0214s/iter; left time: 160.4197s
Epoch: 7 cost time: 13.261168956756592
Epoch: 7, Steps: 570 | Train Loss: 0.0316444 Vali Loss: 0.0388381 Test Loss: 0.1495141
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14190757274627686, mae:0.24510309100151062
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1661820
	speed: 0.0222s/iter; left time: 250.5343s
	iters: 200, epoch: 1 | loss: 0.1882960
	speed: 0.0105s/iter; left time: 117.7247s
	iters: 300, epoch: 1 | loss: 0.2432883
	speed: 0.0105s/iter; left time: 116.8787s
	iters: 400, epoch: 1 | loss: 0.2106672
	speed: 0.0105s/iter; left time: 115.6001s
	iters: 500, epoch: 1 | loss: 0.1615628
	speed: 0.0105s/iter; left time: 114.7469s
Epoch: 1 cost time: 7.208001136779785
Epoch: 1, Steps: 570 | Train Loss: 0.2132680 Vali Loss: 0.0489154 Test Loss: 0.1486931
Validation loss decreased (inf --> 0.048915).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2554823
	speed: 0.0375s/iter; left time: 402.4319s
	iters: 200, epoch: 2 | loss: 0.2682980
	speed: 0.0104s/iter; left time: 110.9440s
	iters: 300, epoch: 2 | loss: 0.1647600
	speed: 0.0105s/iter; left time: 110.1984s
	iters: 400, epoch: 2 | loss: 0.1572925
	speed: 0.0104s/iter; left time: 108.6291s
	iters: 500, epoch: 2 | loss: 0.1673287
	speed: 0.0104s/iter; left time: 107.7169s
Epoch: 2 cost time: 6.253747224807739
Epoch: 2, Steps: 570 | Train Loss: 0.1726924 Vali Loss: 0.0418939 Test Loss: 0.1265778
Validation loss decreased (0.048915 --> 0.041894).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1181338
	speed: 0.0380s/iter; left time: 386.3301s
	iters: 200, epoch: 3 | loss: 0.2001222
	speed: 0.0106s/iter; left time: 106.9446s
	iters: 300, epoch: 3 | loss: 0.1377586
	speed: 0.0106s/iter; left time: 105.4844s
	iters: 400, epoch: 3 | loss: 0.1699878
	speed: 0.0106s/iter; left time: 104.4411s
	iters: 500, epoch: 3 | loss: 0.2055827
	speed: 0.0105s/iter; left time: 102.8840s
Epoch: 3 cost time: 6.408422231674194
Epoch: 3, Steps: 570 | Train Loss: 0.1537922 Vali Loss: 0.0383821 Test Loss: 0.1203843
Validation loss decreased (0.041894 --> 0.038382).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1481126
	speed: 0.0373s/iter; left time: 357.4696s
	iters: 200, epoch: 4 | loss: 0.0932456
	speed: 0.0105s/iter; left time: 99.9391s
	iters: 300, epoch: 4 | loss: 0.1380324
	speed: 0.0106s/iter; left time: 99.2184s
	iters: 400, epoch: 4 | loss: 0.1560184
	speed: 0.0106s/iter; left time: 98.0826s
	iters: 500, epoch: 4 | loss: 0.1368372
	speed: 0.0105s/iter; left time: 96.8999s
Epoch: 4 cost time: 6.333551645278931
Epoch: 4, Steps: 570 | Train Loss: 0.1447483 Vali Loss: 0.0380562 Test Loss: 0.1202246
Validation loss decreased (0.038382 --> 0.038056).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1547439
	speed: 0.0361s/iter; left time: 325.9894s
	iters: 200, epoch: 5 | loss: 0.1538793
	speed: 0.0105s/iter; left time: 93.3850s
	iters: 300, epoch: 5 | loss: 0.1062656
	speed: 0.0105s/iter; left time: 92.3735s
	iters: 400, epoch: 5 | loss: 0.1278121
	speed: 0.0105s/iter; left time: 91.1731s
	iters: 500, epoch: 5 | loss: 0.1534337
	speed: 0.0104s/iter; left time: 89.9021s
Epoch: 5 cost time: 6.292460680007935
Epoch: 5, Steps: 570 | Train Loss: 0.1410183 Vali Loss: 0.0372186 Test Loss: 0.1193272
Validation loss decreased (0.038056 --> 0.037219).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1385755
	speed: 0.0373s/iter; left time: 314.9893s
	iters: 200, epoch: 6 | loss: 0.0998583
	speed: 0.0105s/iter; left time: 87.9593s
	iters: 300, epoch: 6 | loss: 0.1453860
	speed: 0.0106s/iter; left time: 87.2800s
	iters: 400, epoch: 6 | loss: 0.1546631
	speed: 0.0106s/iter; left time: 86.3644s
	iters: 500, epoch: 6 | loss: 0.1294211
	speed: 0.0106s/iter; left time: 84.9852s
Epoch: 6 cost time: 6.276424169540405
Epoch: 6, Steps: 570 | Train Loss: 0.1377903 Vali Loss: 0.0368099 Test Loss: 0.1188920
Validation loss decreased (0.037219 --> 0.036810).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1413189
	speed: 0.0378s/iter; left time: 297.5613s
	iters: 200, epoch: 7 | loss: 0.2008557
	speed: 0.0104s/iter; left time: 81.2336s
	iters: 300, epoch: 7 | loss: 0.1179606
	speed: 0.0105s/iter; left time: 80.3890s
	iters: 400, epoch: 7 | loss: 0.1264820
	speed: 0.0105s/iter; left time: 79.7143s
	iters: 500, epoch: 7 | loss: 0.1174680
	speed: 0.0105s/iter; left time: 78.3173s
Epoch: 7 cost time: 6.332913875579834
Epoch: 7, Steps: 570 | Train Loss: 0.1374366 Vali Loss: 0.0371287 Test Loss: 0.1191760
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1442029
	speed: 0.0374s/iter; left time: 273.4814s
	iters: 200, epoch: 8 | loss: 0.1226638
	speed: 0.0106s/iter; left time: 76.1778s
	iters: 300, epoch: 8 | loss: 0.1857536
	speed: 0.0105s/iter; left time: 74.7902s
	iters: 400, epoch: 8 | loss: 0.1947010
	speed: 0.0121s/iter; left time: 84.5276s
	iters: 500, epoch: 8 | loss: 0.1027075
	speed: 0.0120s/iter; left time: 83.1993s
Epoch: 8 cost time: 6.700424671173096
Epoch: 8, Steps: 570 | Train Loss: 0.1363312 Vali Loss: 0.0368068 Test Loss: 0.1189497
Validation loss decreased (0.036810 --> 0.036807).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1744780
	speed: 0.0384s/iter; left time: 259.0737s
	iters: 200, epoch: 9 | loss: 0.1239212
	speed: 0.0117s/iter; left time: 77.9696s
	iters: 300, epoch: 9 | loss: 0.0659825
	speed: 0.0117s/iter; left time: 76.7691s
	iters: 400, epoch: 9 | loss: 0.1558087
	speed: 0.0117s/iter; left time: 75.6209s
	iters: 500, epoch: 9 | loss: 0.1267672
	speed: 0.0118s/iter; left time: 74.6009s
Epoch: 9 cost time: 6.9901556968688965
Epoch: 9, Steps: 570 | Train Loss: 0.1359967 Vali Loss: 0.0371288 Test Loss: 0.1191462
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1579017
	speed: 0.0372s/iter; left time: 229.5839s
	iters: 200, epoch: 10 | loss: 0.1459462
	speed: 0.0105s/iter; left time: 63.7480s
	iters: 300, epoch: 10 | loss: 0.1129273
	speed: 0.0105s/iter; left time: 62.6696s
	iters: 400, epoch: 10 | loss: 0.1299830
	speed: 0.0105s/iter; left time: 61.6381s
	iters: 500, epoch: 10 | loss: 0.1774755
	speed: 0.0105s/iter; left time: 60.5790s
Epoch: 10 cost time: 6.240526914596558
Epoch: 10, Steps: 570 | Train Loss: 0.1356069 Vali Loss: 0.0369601 Test Loss: 0.1190087
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1467692
	speed: 0.0373s/iter; left time: 208.8255s
	iters: 200, epoch: 11 | loss: 0.1327035
	speed: 0.0107s/iter; left time: 59.1006s
	iters: 300, epoch: 11 | loss: 0.1024538
	speed: 0.0104s/iter; left time: 56.3033s
	iters: 400, epoch: 11 | loss: 0.1856325
	speed: 0.0104s/iter; left time: 55.2510s
	iters: 500, epoch: 11 | loss: 0.1188164
	speed: 0.0104s/iter; left time: 54.2002s
Epoch: 11 cost time: 6.388766765594482
Epoch: 11, Steps: 570 | Train Loss: 0.1367319 Vali Loss: 0.0368543 Test Loss: 0.1190960
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1191156804561615, mae:0.21371115744113922
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1632898
	speed: 0.0237s/iter; left time: 267.3663s
	iters: 200, epoch: 1 | loss: 0.1962866
	speed: 0.0116s/iter; left time: 130.2413s
	iters: 300, epoch: 1 | loss: 0.2366278
	speed: 0.0116s/iter; left time: 128.5154s
	iters: 400, epoch: 1 | loss: 0.1839257
	speed: 0.0116s/iter; left time: 127.4407s
	iters: 500, epoch: 1 | loss: 0.1764508
	speed: 0.0116s/iter; left time: 126.7231s
Epoch: 1 cost time: 7.869370937347412
Epoch: 1, Steps: 570 | Train Loss: 0.1842088 Vali Loss: 0.0355790 Test Loss: 0.1113996
Validation loss decreased (inf --> 0.035579).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1228776
	speed: 0.0371s/iter; left time: 398.2102s
	iters: 200, epoch: 2 | loss: 0.1663849
	speed: 0.0104s/iter; left time: 110.3444s
	iters: 300, epoch: 2 | loss: 0.1062605
	speed: 0.0104s/iter; left time: 109.0489s
	iters: 400, epoch: 2 | loss: 0.1292071
	speed: 0.0103s/iter; left time: 107.7233s
	iters: 500, epoch: 2 | loss: 0.1493803
	speed: 0.0104s/iter; left time: 107.1318s
Epoch: 2 cost time: 6.19862699508667
Epoch: 2, Steps: 570 | Train Loss: 0.1527847 Vali Loss: 0.0330815 Test Loss: 0.1088629
Validation loss decreased (0.035579 --> 0.033082).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0841182
	speed: 0.0367s/iter; left time: 373.1085s
	iters: 200, epoch: 3 | loss: 0.1208962
	speed: 0.0116s/iter; left time: 116.5664s
	iters: 300, epoch: 3 | loss: 0.2659534
	speed: 0.0116s/iter; left time: 115.8029s
	iters: 400, epoch: 3 | loss: 0.1304747
	speed: 0.0116s/iter; left time: 114.5739s
	iters: 500, epoch: 3 | loss: 0.1050824
	speed: 0.0116s/iter; left time: 113.1316s
Epoch: 3 cost time: 6.913269519805908
Epoch: 3, Steps: 570 | Train Loss: 0.1381241 Vali Loss: 0.0310028 Test Loss: 0.1073266
Validation loss decreased (0.033082 --> 0.031003).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1128397
	speed: 0.0378s/iter; left time: 362.3650s
	iters: 200, epoch: 4 | loss: 0.0994237
	speed: 0.0103s/iter; left time: 97.6135s
	iters: 300, epoch: 4 | loss: 0.1038814
	speed: 0.0103s/iter; left time: 96.3808s
	iters: 400, epoch: 4 | loss: 0.0991919
	speed: 0.0103s/iter; left time: 95.4212s
	iters: 500, epoch: 4 | loss: 0.1753294
	speed: 0.0103s/iter; left time: 94.6595s
Epoch: 4 cost time: 6.16164755821228
Epoch: 4, Steps: 570 | Train Loss: 0.1310582 Vali Loss: 0.0308950 Test Loss: 0.1073900
Validation loss decreased (0.031003 --> 0.030895).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0961585
	speed: 0.0361s/iter; left time: 326.0591s
	iters: 200, epoch: 5 | loss: 0.1698866
	speed: 0.0103s/iter; left time: 91.7829s
	iters: 300, epoch: 5 | loss: 0.1103002
	speed: 0.0103s/iter; left time: 90.6214s
	iters: 400, epoch: 5 | loss: 0.1169631
	speed: 0.0103s/iter; left time: 89.5298s
	iters: 500, epoch: 5 | loss: 0.1244035
	speed: 0.0103s/iter; left time: 88.7473s
Epoch: 5 cost time: 6.169874668121338
Epoch: 5, Steps: 570 | Train Loss: 0.1278323 Vali Loss: 0.0307792 Test Loss: 0.1089362
Validation loss decreased (0.030895 --> 0.030779).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0868208
	speed: 0.0380s/iter; left time: 321.4548s
	iters: 200, epoch: 6 | loss: 0.1824658
	speed: 0.0115s/iter; left time: 95.7844s
	iters: 300, epoch: 6 | loss: 0.1520076
	speed: 0.0103s/iter; left time: 84.9660s
	iters: 400, epoch: 6 | loss: 0.1010766
	speed: 0.0103s/iter; left time: 84.1178s
	iters: 500, epoch: 6 | loss: 0.0868167
	speed: 0.0103s/iter; left time: 82.7574s
Epoch: 6 cost time: 6.409346103668213
Epoch: 6, Steps: 570 | Train Loss: 0.1265988 Vali Loss: 0.0305154 Test Loss: 0.1082917
Validation loss decreased (0.030779 --> 0.030515).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1266780
	speed: 0.0372s/iter; left time: 293.3849s
	iters: 200, epoch: 7 | loss: 0.1439131
	speed: 0.0102s/iter; left time: 79.4561s
	iters: 300, epoch: 7 | loss: 0.2094483
	speed: 0.0102s/iter; left time: 78.6409s
	iters: 400, epoch: 7 | loss: 0.1722923
	speed: 0.0102s/iter; left time: 77.5148s
	iters: 500, epoch: 7 | loss: 0.1462710
	speed: 0.0102s/iter; left time: 76.3445s
Epoch: 7 cost time: 6.116265296936035
Epoch: 7, Steps: 570 | Train Loss: 0.1256750 Vali Loss: 0.0302904 Test Loss: 0.1083232
Validation loss decreased (0.030515 --> 0.030290).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1091781
	speed: 0.0363s/iter; left time: 265.1469s
	iters: 200, epoch: 8 | loss: 0.0930290
	speed: 0.0102s/iter; left time: 73.6124s
	iters: 300, epoch: 8 | loss: 0.1188539
	speed: 0.0102s/iter; left time: 72.7208s
	iters: 400, epoch: 8 | loss: 0.1192022
	speed: 0.0102s/iter; left time: 71.6108s
	iters: 500, epoch: 8 | loss: 0.0936297
	speed: 0.0102s/iter; left time: 70.4356s
Epoch: 8 cost time: 6.121912717819214
Epoch: 8, Steps: 570 | Train Loss: 0.1259217 Vali Loss: 0.0301730 Test Loss: 0.1081155
Validation loss decreased (0.030290 --> 0.030173).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1100343
	speed: 0.0363s/iter; left time: 244.7299s
	iters: 200, epoch: 9 | loss: 0.1464002
	speed: 0.0102s/iter; left time: 68.0085s
	iters: 300, epoch: 9 | loss: 0.1102298
	speed: 0.0102s/iter; left time: 66.9552s
	iters: 400, epoch: 9 | loss: 0.1361244
	speed: 0.0102s/iter; left time: 65.8991s
	iters: 500, epoch: 9 | loss: 0.1263459
	speed: 0.0102s/iter; left time: 64.9015s
Epoch: 9 cost time: 6.1091883182525635
Epoch: 9, Steps: 570 | Train Loss: 0.1245330 Vali Loss: 0.0302652 Test Loss: 0.1083011
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1255611
	speed: 0.0359s/iter; left time: 221.7361s
	iters: 200, epoch: 10 | loss: 0.1017917
	speed: 0.0103s/iter; left time: 62.3151s
	iters: 300, epoch: 10 | loss: 0.1145379
	speed: 0.0103s/iter; left time: 61.2688s
	iters: 400, epoch: 10 | loss: 0.0913101
	speed: 0.0103s/iter; left time: 60.2210s
	iters: 500, epoch: 10 | loss: 0.0766238
	speed: 0.0103s/iter; left time: 59.2169s
Epoch: 10 cost time: 6.153545141220093
Epoch: 10, Steps: 570 | Train Loss: 0.1257018 Vali Loss: 0.0302718 Test Loss: 0.1083023
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1139698
	speed: 0.0355s/iter; left time: 198.8509s
	iters: 200, epoch: 11 | loss: 0.1388310
	speed: 0.0102s/iter; left time: 55.9751s
	iters: 300, epoch: 11 | loss: 0.1469189
	speed: 0.0102s/iter; left time: 54.9612s
	iters: 400, epoch: 11 | loss: 0.1414951
	speed: 0.0102s/iter; left time: 54.1433s
	iters: 500, epoch: 11 | loss: 0.1077557
	speed: 0.0103s/iter; left time: 53.6893s
Epoch: 11 cost time: 6.108328104019165
Epoch: 11, Steps: 570 | Train Loss: 0.1238729 Vali Loss: 0.0301528 Test Loss: 0.1083141
Validation loss decreased (0.030173 --> 0.030153).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1152398
	speed: 0.0362s/iter; left time: 182.0764s
	iters: 200, epoch: 12 | loss: 0.1277250
	speed: 0.0103s/iter; left time: 50.8075s
	iters: 300, epoch: 12 | loss: 0.1104521
	speed: 0.0103s/iter; left time: 49.7488s
	iters: 400, epoch: 12 | loss: 0.1891102
	speed: 0.0103s/iter; left time: 48.6234s
	iters: 500, epoch: 12 | loss: 0.1129850
	speed: 0.0103s/iter; left time: 47.6546s
Epoch: 12 cost time: 6.158369064331055
Epoch: 12, Steps: 570 | Train Loss: 0.1244618 Vali Loss: 0.0302571 Test Loss: 0.1083152
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1319189
	speed: 0.0358s/iter; left time: 159.6063s
	iters: 200, epoch: 13 | loss: 0.1576452
	speed: 0.0102s/iter; left time: 44.5675s
	iters: 300, epoch: 13 | loss: 0.0837472
	speed: 0.0102s/iter; left time: 43.4670s
	iters: 400, epoch: 13 | loss: 0.1625548
	speed: 0.0102s/iter; left time: 42.4604s
	iters: 500, epoch: 13 | loss: 0.1285427
	speed: 0.0102s/iter; left time: 41.3606s
Epoch: 13 cost time: 6.073928594589233
Epoch: 13, Steps: 570 | Train Loss: 0.1248096 Vali Loss: 0.0301347 Test Loss: 0.1083239
Validation loss decreased (0.030153 --> 0.030135).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1196261
	speed: 0.0366s/iter; left time: 142.3014s
	iters: 200, epoch: 14 | loss: 0.0963889
	speed: 0.0103s/iter; left time: 39.0954s
	iters: 300, epoch: 14 | loss: 0.1159598
	speed: 0.0103s/iter; left time: 37.9580s
	iters: 400, epoch: 14 | loss: 0.1377869
	speed: 0.0103s/iter; left time: 36.9006s
	iters: 500, epoch: 14 | loss: 0.1410586
	speed: 0.0103s/iter; left time: 35.8943s
Epoch: 14 cost time: 6.183748483657837
Epoch: 14, Steps: 570 | Train Loss: 0.1254393 Vali Loss: 0.0301758 Test Loss: 0.1083240
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.0806293
	speed: 0.0371s/iter; left time: 123.3593s
	iters: 200, epoch: 15 | loss: 0.1490056
	speed: 0.0103s/iter; left time: 33.0714s
	iters: 300, epoch: 15 | loss: 0.1265745
	speed: 0.0103s/iter; left time: 32.0125s
	iters: 400, epoch: 15 | loss: 0.1200736
	speed: 0.0103s/iter; left time: 31.0989s
	iters: 500, epoch: 15 | loss: 0.0979574
	speed: 0.0103s/iter; left time: 29.9696s
Epoch: 15 cost time: 6.126640796661377
Epoch: 15, Steps: 570 | Train Loss: 0.1243336 Vali Loss: 0.0301346 Test Loss: 0.1083250
Validation loss decreased (0.030135 --> 0.030135).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1814100
	speed: 0.0360s/iter; left time: 99.0077s
	iters: 200, epoch: 16 | loss: 0.1212711
	speed: 0.0102s/iter; left time: 27.1071s
	iters: 300, epoch: 16 | loss: 0.1605145
	speed: 0.0102s/iter; left time: 26.1193s
	iters: 400, epoch: 16 | loss: 0.1443062
	speed: 0.0103s/iter; left time: 25.1426s
	iters: 500, epoch: 16 | loss: 0.2023915
	speed: 0.0103s/iter; left time: 24.1744s
Epoch: 16 cost time: 6.172207355499268
Epoch: 16, Steps: 570 | Train Loss: 0.1248819 Vali Loss: 0.0301262 Test Loss: 0.1083253
Validation loss decreased (0.030135 --> 0.030126).  Saving model ...
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.0958868
	speed: 0.0367s/iter; left time: 79.9544s
	iters: 200, epoch: 17 | loss: 0.1025478
	speed: 0.0113s/iter; left time: 23.4627s
	iters: 300, epoch: 17 | loss: 0.1280416
	speed: 0.0103s/iter; left time: 20.3776s
	iters: 400, epoch: 17 | loss: 0.1144716
	speed: 0.0102s/iter; left time: 19.2558s
	iters: 500, epoch: 17 | loss: 0.0766145
	speed: 0.0102s/iter; left time: 18.2323s
Epoch: 17 cost time: 6.365556716918945
Epoch: 17, Steps: 570 | Train Loss: 0.1247482 Vali Loss: 0.0302355 Test Loss: 0.1083252
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1366455
	speed: 0.0353s/iter; left time: 56.8831s
	iters: 200, epoch: 18 | loss: 0.1215379
	speed: 0.0102s/iter; left time: 15.4112s
	iters: 300, epoch: 18 | loss: 0.0830668
	speed: 0.0102s/iter; left time: 14.3901s
	iters: 400, epoch: 18 | loss: 0.2063132
	speed: 0.0102s/iter; left time: 13.4156s
	iters: 500, epoch: 18 | loss: 0.1021243
	speed: 0.0102s/iter; left time: 12.3598s
Epoch: 18 cost time: 6.065615892410278
Epoch: 18, Steps: 570 | Train Loss: 0.1247364 Vali Loss: 0.0302222 Test Loss: 0.1083251
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1282438
	speed: 0.0369s/iter; left time: 38.4137s
	iters: 200, epoch: 19 | loss: 0.1352768
	speed: 0.0103s/iter; left time: 9.6758s
	iters: 300, epoch: 19 | loss: 0.1141587
	speed: 0.0103s/iter; left time: 8.6235s
	iters: 400, epoch: 19 | loss: 0.1481847
	speed: 0.0103s/iter; left time: 7.5959s
	iters: 500, epoch: 19 | loss: 0.1201239
	speed: 0.0103s/iter; left time: 6.5710s
Epoch: 19 cost time: 6.247210741043091
Epoch: 19, Steps: 570 | Train Loss: 0.1244544 Vali Loss: 0.0302172 Test Loss: 0.1083252
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10847773402929306, mae:0.19956164062023163
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2209077
	speed: 0.0235s/iter; left time: 265.5957s
	iters: 200, epoch: 1 | loss: 0.1631805
	speed: 0.0116s/iter; left time: 129.7721s
	iters: 300, epoch: 1 | loss: 0.1428613
	speed: 0.0116s/iter; left time: 128.2919s
	iters: 400, epoch: 1 | loss: 0.1150904
	speed: 0.0116s/iter; left time: 127.1577s
	iters: 500, epoch: 1 | loss: 0.2018290
	speed: 0.0116s/iter; left time: 126.5637s
Epoch: 1 cost time: 7.841349124908447
Epoch: 1, Steps: 570 | Train Loss: 0.2200478 Vali Loss: 0.0456244 Test Loss: 0.1333508
Validation loss decreased (inf --> 0.045624).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1866460
	speed: 0.0382s/iter; left time: 410.3139s
	iters: 200, epoch: 2 | loss: 0.2389505
	speed: 0.0103s/iter; left time: 109.4272s
	iters: 300, epoch: 2 | loss: 0.1493279
	speed: 0.0103s/iter; left time: 108.3167s
	iters: 400, epoch: 2 | loss: 0.2726944
	speed: 0.0103s/iter; left time: 107.4735s
	iters: 500, epoch: 2 | loss: 0.2013200
	speed: 0.0103s/iter; left time: 106.2248s
Epoch: 2 cost time: 6.2765953540802
Epoch: 2, Steps: 570 | Train Loss: 0.1774382 Vali Loss: 0.0395741 Test Loss: 0.1253181
Validation loss decreased (0.045624 --> 0.039574).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1207781
	speed: 0.0371s/iter; left time: 377.2339s
	iters: 200, epoch: 3 | loss: 0.1570719
	speed: 0.0103s/iter; left time: 103.3707s
	iters: 300, epoch: 3 | loss: 0.1950693
	speed: 0.0103s/iter; left time: 102.1385s
	iters: 400, epoch: 3 | loss: 0.1283651
	speed: 0.0102s/iter; left time: 100.9523s
	iters: 500, epoch: 3 | loss: 0.1199954
	speed: 0.0102s/iter; left time: 99.8487s
Epoch: 3 cost time: 6.127661228179932
Epoch: 3, Steps: 570 | Train Loss: 0.1601210 Vali Loss: 0.0392600 Test Loss: 0.1258912
Validation loss decreased (0.039574 --> 0.039260).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0857576
	speed: 0.0376s/iter; left time: 360.2417s
	iters: 200, epoch: 4 | loss: 0.1435241
	speed: 0.0116s/iter; left time: 109.8028s
	iters: 300, epoch: 4 | loss: 0.1204739
	speed: 0.0116s/iter; left time: 108.8739s
	iters: 400, epoch: 4 | loss: 0.1990416
	speed: 0.0116s/iter; left time: 108.0054s
	iters: 500, epoch: 4 | loss: 0.1360075
	speed: 0.0103s/iter; left time: 94.4807s
Epoch: 4 cost time: 6.654064416885376
Epoch: 4, Steps: 570 | Train Loss: 0.1509492 Vali Loss: 0.0388266 Test Loss: 0.1260145
Validation loss decreased (0.039260 --> 0.038827).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1325593
	speed: 0.0370s/iter; left time: 333.4112s
	iters: 200, epoch: 5 | loss: 0.1007131
	speed: 0.0116s/iter; left time: 103.3162s
	iters: 300, epoch: 5 | loss: 0.1569553
	speed: 0.0116s/iter; left time: 101.9664s
	iters: 400, epoch: 5 | loss: 0.1501538
	speed: 0.0116s/iter; left time: 101.0960s
	iters: 500, epoch: 5 | loss: 0.1873112
	speed: 0.0116s/iter; left time: 99.6747s
Epoch: 5 cost time: 6.878689765930176
Epoch: 5, Steps: 570 | Train Loss: 0.1477954 Vali Loss: 0.0387457 Test Loss: 0.1248546
Validation loss decreased (0.038827 --> 0.038746).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1031383
	speed: 0.0364s/iter; left time: 307.6909s
	iters: 200, epoch: 6 | loss: 0.1437926
	speed: 0.0102s/iter; left time: 85.5695s
	iters: 300, epoch: 6 | loss: 0.1388285
	speed: 0.0102s/iter; left time: 84.3835s
	iters: 400, epoch: 6 | loss: 0.1307970
	speed: 0.0102s/iter; left time: 83.3025s
	iters: 500, epoch: 6 | loss: 0.1496309
	speed: 0.0102s/iter; left time: 82.2481s
Epoch: 6 cost time: 6.12692666053772
Epoch: 6, Steps: 570 | Train Loss: 0.1451480 Vali Loss: 0.0380487 Test Loss: 0.1235802
Validation loss decreased (0.038746 --> 0.038049).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1069827
	speed: 0.0367s/iter; left time: 289.0270s
	iters: 200, epoch: 7 | loss: 0.1461647
	speed: 0.0103s/iter; left time: 80.0886s
	iters: 300, epoch: 7 | loss: 0.1125339
	speed: 0.0103s/iter; left time: 79.3070s
	iters: 400, epoch: 7 | loss: 0.0938165
	speed: 0.0103s/iter; left time: 78.0901s
	iters: 500, epoch: 7 | loss: 0.1562604
	speed: 0.0103s/iter; left time: 76.7676s
Epoch: 7 cost time: 6.1953113079071045
Epoch: 7, Steps: 570 | Train Loss: 0.1428303 Vali Loss: 0.0379655 Test Loss: 0.1234711
Validation loss decreased (0.038049 --> 0.037965).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1077710
	speed: 0.0366s/iter; left time: 267.7613s
	iters: 200, epoch: 8 | loss: 0.1454666
	speed: 0.0103s/iter; left time: 73.9128s
	iters: 300, epoch: 8 | loss: 0.1180467
	speed: 0.0103s/iter; left time: 72.9523s
	iters: 400, epoch: 8 | loss: 0.1400131
	speed: 0.0103s/iter; left time: 71.9738s
	iters: 500, epoch: 8 | loss: 0.1238756
	speed: 0.0103s/iter; left time: 70.9122s
Epoch: 8 cost time: 6.1830153465271
Epoch: 8, Steps: 570 | Train Loss: 0.1415453 Vali Loss: 0.0379648 Test Loss: 0.1236288
Validation loss decreased (0.037965 --> 0.037965).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1197457
	speed: 0.0385s/iter; left time: 259.7859s
	iters: 200, epoch: 9 | loss: 0.1663950
	speed: 0.0103s/iter; left time: 68.1398s
	iters: 300, epoch: 9 | loss: 0.1219669
	speed: 0.0103s/iter; left time: 67.2912s
	iters: 400, epoch: 9 | loss: 0.1165582
	speed: 0.0103s/iter; left time: 66.1291s
	iters: 500, epoch: 9 | loss: 0.1473963
	speed: 0.0103s/iter; left time: 65.2429s
Epoch: 9 cost time: 6.157060384750366
Epoch: 9, Steps: 570 | Train Loss: 0.1408470 Vali Loss: 0.0381282 Test Loss: 0.1237652
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1218221
	speed: 0.0360s/iter; left time: 221.9904s
	iters: 200, epoch: 10 | loss: 0.1730519
	speed: 0.0103s/iter; left time: 62.3285s
	iters: 300, epoch: 10 | loss: 0.1865845
	speed: 0.0103s/iter; left time: 61.3602s
	iters: 400, epoch: 10 | loss: 0.1654164
	speed: 0.0103s/iter; left time: 60.3178s
	iters: 500, epoch: 10 | loss: 0.1427130
	speed: 0.0103s/iter; left time: 59.3151s
Epoch: 10 cost time: 6.1498496532440186
Epoch: 10, Steps: 570 | Train Loss: 0.1427504 Vali Loss: 0.0381587 Test Loss: 0.1238057
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1540829
	speed: 0.0356s/iter; left time: 199.3808s
	iters: 200, epoch: 11 | loss: 0.1129410
	speed: 0.0103s/iter; left time: 56.6798s
	iters: 300, epoch: 11 | loss: 0.1937230
	speed: 0.0103s/iter; left time: 55.6345s
	iters: 400, epoch: 11 | loss: 0.1644548
	speed: 0.0103s/iter; left time: 54.6029s
	iters: 500, epoch: 11 | loss: 0.1550523
	speed: 0.0103s/iter; left time: 53.5809s
Epoch: 11 cost time: 6.150158405303955
Epoch: 11, Steps: 570 | Train Loss: 0.1425434 Vali Loss: 0.0379050 Test Loss: 0.1238274
Validation loss decreased (0.037965 --> 0.037905).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1438372
	speed: 0.0363s/iter; left time: 182.8017s
	iters: 200, epoch: 12 | loss: 0.1561584
	speed: 0.0102s/iter; left time: 50.4662s
	iters: 300, epoch: 12 | loss: 0.1043206
	speed: 0.0102s/iter; left time: 49.4456s
	iters: 400, epoch: 12 | loss: 0.1268635
	speed: 0.0102s/iter; left time: 48.4109s
	iters: 500, epoch: 12 | loss: 0.0814305
	speed: 0.0102s/iter; left time: 47.3846s
Epoch: 12 cost time: 6.131193161010742
Epoch: 12, Steps: 570 | Train Loss: 0.1417405 Vali Loss: 0.0379074 Test Loss: 0.1238480
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1408719
	speed: 0.0355s/iter; left time: 158.3655s
	iters: 200, epoch: 13 | loss: 0.1521952
	speed: 0.0103s/iter; left time: 44.7221s
	iters: 300, epoch: 13 | loss: 0.1613741
	speed: 0.0103s/iter; left time: 43.7016s
	iters: 400, epoch: 13 | loss: 0.1620815
	speed: 0.0103s/iter; left time: 42.6737s
	iters: 500, epoch: 13 | loss: 0.1417292
	speed: 0.0103s/iter; left time: 41.6374s
Epoch: 13 cost time: 6.131879568099976
Epoch: 13, Steps: 570 | Train Loss: 0.1424282 Vali Loss: 0.0379697 Test Loss: 0.1238488
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1171110
	speed: 0.0357s/iter; left time: 138.9802s
	iters: 200, epoch: 14 | loss: 0.1668206
	speed: 0.0102s/iter; left time: 38.7040s
	iters: 300, epoch: 14 | loss: 0.1107595
	speed: 0.0102s/iter; left time: 37.7094s
	iters: 400, epoch: 14 | loss: 0.0863452
	speed: 0.0102s/iter; left time: 36.6842s
	iters: 500, epoch: 14 | loss: 0.1830739
	speed: 0.0102s/iter; left time: 35.6677s
Epoch: 14 cost time: 6.100139617919922
Epoch: 14, Steps: 570 | Train Loss: 0.1414670 Vali Loss: 0.0378636 Test Loss: 0.1238594
Validation loss decreased (0.037905 --> 0.037864).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1206651
	speed: 0.0364s/iter; left time: 120.7250s
	iters: 200, epoch: 15 | loss: 0.1962299
	speed: 0.0103s/iter; left time: 33.2092s
	iters: 300, epoch: 15 | loss: 0.0880813
	speed: 0.0103s/iter; left time: 32.1462s
	iters: 400, epoch: 15 | loss: 0.0686535
	speed: 0.0103s/iter; left time: 31.1094s
	iters: 500, epoch: 15 | loss: 0.2198229
	speed: 0.0103s/iter; left time: 30.0689s
Epoch: 15 cost time: 6.170158624649048
Epoch: 15, Steps: 570 | Train Loss: 0.1417189 Vali Loss: 0.0379597 Test Loss: 0.1238618
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1515440
	speed: 0.0352s/iter; left time: 96.8353s
	iters: 200, epoch: 16 | loss: 0.1062499
	speed: 0.0103s/iter; left time: 27.1836s
	iters: 300, epoch: 16 | loss: 0.1378633
	speed: 0.0102s/iter; left time: 26.1217s
	iters: 400, epoch: 16 | loss: 0.1257110
	speed: 0.0102s/iter; left time: 25.1012s
	iters: 500, epoch: 16 | loss: 0.1545956
	speed: 0.0102s/iter; left time: 24.0931s
Epoch: 16 cost time: 6.1100122928619385
Epoch: 16, Steps: 570 | Train Loss: 0.1420061 Vali Loss: 0.0381102 Test Loss: 0.1238612
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1119800
	speed: 0.0367s/iter; left time: 80.0318s
	iters: 200, epoch: 17 | loss: 0.0862425
	speed: 0.0103s/iter; left time: 21.3474s
	iters: 300, epoch: 17 | loss: 0.0969094
	speed: 0.0103s/iter; left time: 20.3183s
	iters: 400, epoch: 17 | loss: 0.1524913
	speed: 0.0103s/iter; left time: 19.2937s
	iters: 500, epoch: 17 | loss: 0.0960862
	speed: 0.0103s/iter; left time: 18.2647s
Epoch: 17 cost time: 6.125229597091675
Epoch: 17, Steps: 570 | Train Loss: 0.1422323 Vali Loss: 0.0381015 Test Loss: 0.1238618
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1240406259894371, mae:0.2200387865304947
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2494522
	speed: 0.0251s/iter; left time: 283.4774s
	iters: 200, epoch: 1 | loss: 0.2129330
	speed: 0.0129s/iter; left time: 145.0078s
	iters: 300, epoch: 1 | loss: 0.1523527
	speed: 0.0129s/iter; left time: 143.3534s
	iters: 400, epoch: 1 | loss: 0.1196123
	speed: 0.0129s/iter; left time: 142.2852s
	iters: 500, epoch: 1 | loss: 0.1970649
	speed: 0.0129s/iter; left time: 141.0794s
Epoch: 1 cost time: 8.638608694076538
Epoch: 1, Steps: 570 | Train Loss: 0.2074562 Vali Loss: 0.0426341 Test Loss: 0.1295917
Validation loss decreased (inf --> 0.042634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1755087
	speed: 0.0418s/iter; left time: 449.0341s
	iters: 200, epoch: 2 | loss: 0.1553559
	speed: 0.0119s/iter; left time: 126.2638s
	iters: 300, epoch: 2 | loss: 0.1324689
	speed: 0.0119s/iter; left time: 125.1277s
	iters: 400, epoch: 2 | loss: 0.0915983
	speed: 0.0119s/iter; left time: 123.8174s
	iters: 500, epoch: 2 | loss: 0.1688437
	speed: 0.0119s/iter; left time: 122.9617s
Epoch: 2 cost time: 7.117243528366089
Epoch: 2, Steps: 570 | Train Loss: 0.1654598 Vali Loss: 0.0396928 Test Loss: 0.1245952
Validation loss decreased (0.042634 --> 0.039693).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1581594
	speed: 0.0412s/iter; left time: 418.6888s
	iters: 200, epoch: 3 | loss: 0.1721560
	speed: 0.0127s/iter; left time: 128.2711s
	iters: 300, epoch: 3 | loss: 0.1140315
	speed: 0.0127s/iter; left time: 126.9280s
	iters: 400, epoch: 3 | loss: 0.1244937
	speed: 0.0128s/iter; left time: 125.7967s
	iters: 500, epoch: 3 | loss: 0.1060665
	speed: 0.0127s/iter; left time: 124.2067s
Epoch: 3 cost time: 7.587965250015259
Epoch: 3, Steps: 570 | Train Loss: 0.1411879 Vali Loss: 0.0367619 Test Loss: 0.1210644
Validation loss decreased (0.039693 --> 0.036762).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1151561
	speed: 0.0420s/iter; left time: 402.9067s
	iters: 200, epoch: 4 | loss: 0.1654308
	speed: 0.0127s/iter; left time: 120.9562s
	iters: 300, epoch: 4 | loss: 0.0820960
	speed: 0.0119s/iter; left time: 111.4393s
	iters: 400, epoch: 4 | loss: 0.0956668
	speed: 0.0119s/iter; left time: 110.3678s
	iters: 500, epoch: 4 | loss: 0.1009726
	speed: 0.0119s/iter; left time: 109.1275s
Epoch: 4 cost time: 7.246025562286377
Epoch: 4, Steps: 570 | Train Loss: 0.1289499 Vali Loss: 0.0352489 Test Loss: 0.1231693
Validation loss decreased (0.036762 --> 0.035249).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1123193
	speed: 0.0394s/iter; left time: 355.0309s
	iters: 200, epoch: 5 | loss: 0.1100611
	speed: 0.0118s/iter; left time: 105.6235s
	iters: 300, epoch: 5 | loss: 0.1749112
	speed: 0.0118s/iter; left time: 104.3966s
	iters: 400, epoch: 5 | loss: 0.1129525
	speed: 0.0118s/iter; left time: 103.2208s
	iters: 500, epoch: 5 | loss: 0.1089170
	speed: 0.0118s/iter; left time: 102.0491s
Epoch: 5 cost time: 7.0756988525390625
Epoch: 5, Steps: 570 | Train Loss: 0.1233984 Vali Loss: 0.0358403 Test Loss: 0.1185238
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1055258
	speed: 0.0386s/iter; left time: 326.1343s
	iters: 200, epoch: 6 | loss: 0.0744367
	speed: 0.0119s/iter; left time: 99.1327s
	iters: 300, epoch: 6 | loss: 0.1253520
	speed: 0.0119s/iter; left time: 97.9431s
	iters: 400, epoch: 6 | loss: 0.1410496
	speed: 0.0119s/iter; left time: 96.7485s
	iters: 500, epoch: 6 | loss: 0.0853137
	speed: 0.0119s/iter; left time: 95.5843s
Epoch: 6 cost time: 7.107334852218628
Epoch: 6, Steps: 570 | Train Loss: 0.1182106 Vali Loss: 0.0345302 Test Loss: 0.1180393
Validation loss decreased (0.035249 --> 0.034530).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1296884
	speed: 0.0398s/iter; left time: 313.3094s
	iters: 200, epoch: 7 | loss: 0.1308485
	speed: 0.0127s/iter; left time: 98.9300s
	iters: 300, epoch: 7 | loss: 0.1279680
	speed: 0.0127s/iter; left time: 97.1684s
	iters: 400, epoch: 7 | loss: 0.1000333
	speed: 0.0119s/iter; left time: 90.0434s
	iters: 500, epoch: 7 | loss: 0.1005313
	speed: 0.0119s/iter; left time: 88.8640s
Epoch: 7 cost time: 7.310508489608765
Epoch: 7, Steps: 570 | Train Loss: 0.1169174 Vali Loss: 0.0343042 Test Loss: 0.1196582
Validation loss decreased (0.034530 --> 0.034304).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0725371
	speed: 0.0422s/iter; left time: 308.6909s
	iters: 200, epoch: 8 | loss: 0.1225613
	speed: 0.0130s/iter; left time: 93.7183s
	iters: 300, epoch: 8 | loss: 0.0996163
	speed: 0.0129s/iter; left time: 91.9585s
	iters: 400, epoch: 8 | loss: 0.0855558
	speed: 0.0129s/iter; left time: 90.7407s
	iters: 500, epoch: 8 | loss: 0.0986222
	speed: 0.0129s/iter; left time: 89.4310s
Epoch: 8 cost time: 7.713958263397217
Epoch: 8, Steps: 570 | Train Loss: 0.1168448 Vali Loss: 0.0341010 Test Loss: 0.1192758
Validation loss decreased (0.034304 --> 0.034101).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0960807
	speed: 0.0419s/iter; left time: 282.7568s
	iters: 200, epoch: 9 | loss: 0.1103233
	speed: 0.0118s/iter; left time: 78.6182s
	iters: 300, epoch: 9 | loss: 0.1214779
	speed: 0.0118s/iter; left time: 77.3058s
	iters: 400, epoch: 9 | loss: 0.0919171
	speed: 0.0118s/iter; left time: 76.0580s
	iters: 500, epoch: 9 | loss: 0.1461041
	speed: 0.0118s/iter; left time: 74.8309s
Epoch: 9 cost time: 7.076043605804443
Epoch: 9, Steps: 570 | Train Loss: 0.1163970 Vali Loss: 0.0340609 Test Loss: 0.1190358
Validation loss decreased (0.034101 --> 0.034061).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1156739
	speed: 0.0397s/iter; left time: 244.8792s
	iters: 200, epoch: 10 | loss: 0.1168119
	speed: 0.0118s/iter; left time: 71.6317s
	iters: 300, epoch: 10 | loss: 0.0976095
	speed: 0.0118s/iter; left time: 70.4634s
	iters: 400, epoch: 10 | loss: 0.0884077
	speed: 0.0118s/iter; left time: 69.2752s
	iters: 500, epoch: 10 | loss: 0.1521445
	speed: 0.0118s/iter; left time: 68.0986s
Epoch: 10 cost time: 7.102535963058472
Epoch: 10, Steps: 570 | Train Loss: 0.1171683 Vali Loss: 0.0342109 Test Loss: 0.1189131
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0946117
	speed: 0.0393s/iter; left time: 220.3769s
	iters: 200, epoch: 11 | loss: 0.1715285
	speed: 0.0118s/iter; left time: 64.9770s
	iters: 300, epoch: 11 | loss: 0.1023363
	speed: 0.0118s/iter; left time: 63.8202s
	iters: 400, epoch: 11 | loss: 0.1114139
	speed: 0.0118s/iter; left time: 62.5949s
	iters: 500, epoch: 11 | loss: 0.1463158
	speed: 0.0118s/iter; left time: 61.4312s
Epoch: 11 cost time: 7.009037256240845
Epoch: 11, Steps: 570 | Train Loss: 0.1154145 Vali Loss: 0.0342090 Test Loss: 0.1189196
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1003364
	speed: 0.0390s/iter; left time: 196.2166s
	iters: 200, epoch: 12 | loss: 0.0884850
	speed: 0.0129s/iter; left time: 63.7594s
	iters: 300, epoch: 12 | loss: 0.0798764
	speed: 0.0129s/iter; left time: 62.4789s
	iters: 400, epoch: 12 | loss: 0.0917849
	speed: 0.0129s/iter; left time: 61.1908s
	iters: 500, epoch: 12 | loss: 0.1094390
	speed: 0.0129s/iter; left time: 59.9552s
Epoch: 12 cost time: 7.649098873138428
Epoch: 12, Steps: 570 | Train Loss: 0.1151760 Vali Loss: 0.0342856 Test Loss: 0.1188759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11919538676738739, mae:0.2178240269422531
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1061446
	speed: 0.0231s/iter; left time: 260.8877s
	iters: 200, epoch: 1 | loss: 0.2938389
	speed: 0.0114s/iter; left time: 127.5657s
	iters: 300, epoch: 1 | loss: 0.1393132
	speed: 0.0114s/iter; left time: 126.2150s
	iters: 400, epoch: 1 | loss: 0.1742748
	speed: 0.0114s/iter; left time: 125.2043s
	iters: 500, epoch: 1 | loss: 0.1219428
	speed: 0.0114s/iter; left time: 124.0937s
Epoch: 1 cost time: 7.709277153015137
Epoch: 1, Steps: 570 | Train Loss: 0.1809858 Vali Loss: 0.0358772 Test Loss: 0.1120169
Validation loss decreased (inf --> 0.035877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1285634
	speed: 0.0389s/iter; left time: 417.7519s
	iters: 200, epoch: 2 | loss: 0.1006706
	speed: 0.0115s/iter; left time: 122.3823s
	iters: 300, epoch: 2 | loss: 0.1497626
	speed: 0.0115s/iter; left time: 120.9259s
	iters: 400, epoch: 2 | loss: 0.2290181
	speed: 0.0115s/iter; left time: 119.9077s
	iters: 500, epoch: 2 | loss: 0.2421417
	speed: 0.0115s/iter; left time: 118.5764s
Epoch: 2 cost time: 6.86345362663269
Epoch: 2, Steps: 570 | Train Loss: 0.1469245 Vali Loss: 0.0362476 Test Loss: 0.1125096
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1461935
	speed: 0.0408s/iter; left time: 414.7938s
	iters: 200, epoch: 3 | loss: 0.0874312
	speed: 0.0114s/iter; left time: 114.9302s
	iters: 300, epoch: 3 | loss: 0.1629128
	speed: 0.0114s/iter; left time: 113.6591s
	iters: 400, epoch: 3 | loss: 0.1303105
	speed: 0.0114s/iter; left time: 112.6394s
	iters: 500, epoch: 3 | loss: 0.1554490
	speed: 0.0114s/iter; left time: 111.6555s
Epoch: 3 cost time: 6.804374694824219
Epoch: 3, Steps: 570 | Train Loss: 0.1299274 Vali Loss: 0.0332274 Test Loss: 0.1086616
Validation loss decreased (0.035877 --> 0.033227).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1100514
	speed: 0.0380s/iter; left time: 364.1145s
	iters: 200, epoch: 4 | loss: 0.0898602
	speed: 0.0115s/iter; left time: 108.8907s
	iters: 300, epoch: 4 | loss: 0.0719668
	speed: 0.0115s/iter; left time: 107.7354s
	iters: 400, epoch: 4 | loss: 0.1100080
	speed: 0.0115s/iter; left time: 106.6724s
	iters: 500, epoch: 4 | loss: 0.1275932
	speed: 0.0115s/iter; left time: 105.4187s
Epoch: 4 cost time: 6.862810850143433
Epoch: 4, Steps: 570 | Train Loss: 0.1192766 Vali Loss: 0.0334128 Test Loss: 0.1083727
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0998100
	speed: 0.0393s/iter; left time: 354.4202s
	iters: 200, epoch: 5 | loss: 0.0951665
	speed: 0.0115s/iter; left time: 102.2202s
	iters: 300, epoch: 5 | loss: 0.1616226
	speed: 0.0114s/iter; left time: 100.8026s
	iters: 400, epoch: 5 | loss: 0.0922074
	speed: 0.0114s/iter; left time: 99.7286s
	iters: 500, epoch: 5 | loss: 0.1030626
	speed: 0.0114s/iter; left time: 98.5524s
Epoch: 5 cost time: 6.81291127204895
Epoch: 5, Steps: 570 | Train Loss: 0.1137036 Vali Loss: 0.0332378 Test Loss: 0.1093978
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1444074
	speed: 0.0388s/iter; left time: 327.7421s
	iters: 200, epoch: 6 | loss: 0.1259873
	speed: 0.0114s/iter; left time: 95.4108s
	iters: 300, epoch: 6 | loss: 0.0823032
	speed: 0.0114s/iter; left time: 94.2778s
	iters: 400, epoch: 6 | loss: 0.0880875
	speed: 0.0114s/iter; left time: 93.1121s
	iters: 500, epoch: 6 | loss: 0.0839217
	speed: 0.0114s/iter; left time: 91.8189s
Epoch: 6 cost time: 6.820871353149414
Epoch: 6, Steps: 570 | Train Loss: 0.1108379 Vali Loss: 0.0329414 Test Loss: 0.1084211
Validation loss decreased (0.033227 --> 0.032941).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0801231
	speed: 0.0377s/iter; left time: 296.7297s
	iters: 200, epoch: 7 | loss: 0.1289176
	speed: 0.0114s/iter; left time: 89.0453s
	iters: 300, epoch: 7 | loss: 0.0806299
	speed: 0.0114s/iter; left time: 87.7427s
	iters: 400, epoch: 7 | loss: 0.0882797
	speed: 0.0114s/iter; left time: 86.5623s
	iters: 500, epoch: 7 | loss: 0.0941452
	speed: 0.0114s/iter; left time: 85.4240s
Epoch: 7 cost time: 6.812136888504028
Epoch: 7, Steps: 570 | Train Loss: 0.1095375 Vali Loss: 0.0327797 Test Loss: 0.1082623
Validation loss decreased (0.032941 --> 0.032780).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0955910
	speed: 0.0388s/iter; left time: 283.3729s
	iters: 200, epoch: 8 | loss: 0.1279755
	speed: 0.0114s/iter; left time: 82.4946s
	iters: 300, epoch: 8 | loss: 0.0893521
	speed: 0.0114s/iter; left time: 81.2943s
	iters: 400, epoch: 8 | loss: 0.1013135
	speed: 0.0114s/iter; left time: 80.1954s
	iters: 500, epoch: 8 | loss: 0.1093070
	speed: 0.0114s/iter; left time: 79.0467s
Epoch: 8 cost time: 6.83205771446228
Epoch: 8, Steps: 570 | Train Loss: 0.1093392 Vali Loss: 0.0331353 Test Loss: 0.1088808
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1575224
	speed: 0.0371s/iter; left time: 249.8831s
	iters: 200, epoch: 9 | loss: 0.0802651
	speed: 0.0114s/iter; left time: 76.0085s
	iters: 300, epoch: 9 | loss: 0.1117401
	speed: 0.0115s/iter; left time: 74.9695s
	iters: 400, epoch: 9 | loss: 0.1396321
	speed: 0.0115s/iter; left time: 73.8239s
	iters: 500, epoch: 9 | loss: 0.1535444
	speed: 0.0115s/iter; left time: 72.6532s
Epoch: 9 cost time: 6.818120002746582
Epoch: 9, Steps: 570 | Train Loss: 0.1096551 Vali Loss: 0.0328618 Test Loss: 0.1087080
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1076999
	speed: 0.0372s/iter; left time: 229.8381s
	iters: 200, epoch: 10 | loss: 0.0950411
	speed: 0.0115s/iter; left time: 69.5969s
	iters: 300, epoch: 10 | loss: 0.0886016
	speed: 0.0115s/iter; left time: 68.4630s
	iters: 400, epoch: 10 | loss: 0.1124933
	speed: 0.0115s/iter; left time: 67.2698s
	iters: 500, epoch: 10 | loss: 0.1248781
	speed: 0.0115s/iter; left time: 66.1077s
Epoch: 10 cost time: 6.834472417831421
Epoch: 10, Steps: 570 | Train Loss: 0.1088378 Vali Loss: 0.0329134 Test Loss: 0.1087530
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10842026770114899, mae:0.19971726834774017
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2666608
	speed: 0.0236s/iter; left time: 266.2809s
	iters: 200, epoch: 1 | loss: 0.2344479
	speed: 0.0109s/iter; left time: 121.9217s
	iters: 300, epoch: 1 | loss: 0.2681766
	speed: 0.0108s/iter; left time: 120.4185s
	iters: 400, epoch: 1 | loss: 0.1758684
	speed: 0.0108s/iter; left time: 119.3052s
	iters: 500, epoch: 1 | loss: 0.1921344
	speed: 0.0109s/iter; left time: 118.4869s
Epoch: 1 cost time: 7.511661767959595
Epoch: 1, Steps: 570 | Train Loss: 0.2114521 Vali Loss: 0.0422289 Test Loss: 0.1334401
Validation loss decreased (inf --> 0.042229).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2222213
	speed: 0.0384s/iter; left time: 411.9950s
	iters: 200, epoch: 2 | loss: 0.2736513
	speed: 0.0109s/iter; left time: 115.8333s
	iters: 300, epoch: 2 | loss: 0.1277289
	speed: 0.0109s/iter; left time: 114.6102s
	iters: 400, epoch: 2 | loss: 0.1396603
	speed: 0.0109s/iter; left time: 114.0300s
	iters: 500, epoch: 2 | loss: 0.1350700
	speed: 0.0110s/iter; left time: 113.2392s
Epoch: 2 cost time: 6.53412938117981
Epoch: 2, Steps: 570 | Train Loss: 0.1713502 Vali Loss: 0.0425691 Test Loss: 0.1256566
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1520723
	speed: 0.0380s/iter; left time: 385.9178s
	iters: 200, epoch: 3 | loss: 0.1291768
	speed: 0.0109s/iter; left time: 109.4658s
	iters: 300, epoch: 3 | loss: 0.1434106
	speed: 0.0109s/iter; left time: 108.5722s
	iters: 400, epoch: 3 | loss: 0.1218131
	speed: 0.0109s/iter; left time: 107.5853s
	iters: 500, epoch: 3 | loss: 0.1572614
	speed: 0.0109s/iter; left time: 106.2815s
Epoch: 3 cost time: 6.464886665344238
Epoch: 3, Steps: 570 | Train Loss: 0.1472495 Vali Loss: 0.0413527 Test Loss: 0.1271744
Validation loss decreased (0.042229 --> 0.041353).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1284194
	speed: 0.0372s/iter; left time: 356.4136s
	iters: 200, epoch: 4 | loss: 0.1104371
	speed: 0.0109s/iter; left time: 103.8586s
	iters: 300, epoch: 4 | loss: 0.1248381
	speed: 0.0109s/iter; left time: 102.6541s
	iters: 400, epoch: 4 | loss: 0.2190025
	speed: 0.0109s/iter; left time: 101.5415s
	iters: 500, epoch: 4 | loss: 0.1397098
	speed: 0.0109s/iter; left time: 100.2684s
Epoch: 4 cost time: 6.520285367965698
Epoch: 4, Steps: 570 | Train Loss: 0.1364210 Vali Loss: 0.0399190 Test Loss: 0.1251965
Validation loss decreased (0.041353 --> 0.039919).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1347206
	speed: 0.0372s/iter; left time: 335.5799s
	iters: 200, epoch: 5 | loss: 0.1331736
	speed: 0.0109s/iter; left time: 97.2130s
	iters: 300, epoch: 5 | loss: 0.1527700
	speed: 0.0110s/iter; left time: 96.5999s
	iters: 400, epoch: 5 | loss: 0.1086815
	speed: 0.0109s/iter; left time: 95.1575s
	iters: 500, epoch: 5 | loss: 0.2206286
	speed: 0.0109s/iter; left time: 94.0552s
Epoch: 5 cost time: 6.496492624282837
Epoch: 5, Steps: 570 | Train Loss: 0.1303347 Vali Loss: 0.0386281 Test Loss: 0.1224689
Validation loss decreased (0.039919 --> 0.038628).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1115298
	speed: 0.0366s/iter; left time: 309.6832s
	iters: 200, epoch: 6 | loss: 0.1223001
	speed: 0.0109s/iter; left time: 90.8880s
	iters: 300, epoch: 6 | loss: 0.1253359
	speed: 0.0109s/iter; left time: 89.7875s
	iters: 400, epoch: 6 | loss: 0.1120289
	speed: 0.0109s/iter; left time: 88.7512s
	iters: 500, epoch: 6 | loss: 0.1296152
	speed: 0.0109s/iter; left time: 87.5903s
Epoch: 6 cost time: 6.478749513626099
Epoch: 6, Steps: 570 | Train Loss: 0.1268731 Vali Loss: 0.0391719 Test Loss: 0.1254759
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1168155
	speed: 0.0360s/iter; left time: 283.8929s
	iters: 200, epoch: 7 | loss: 0.1033156
	speed: 0.0109s/iter; left time: 85.0183s
	iters: 300, epoch: 7 | loss: 0.0881221
	speed: 0.0109s/iter; left time: 83.7956s
	iters: 400, epoch: 7 | loss: 0.1157171
	speed: 0.0109s/iter; left time: 82.7540s
	iters: 500, epoch: 7 | loss: 0.0893376
	speed: 0.0109s/iter; left time: 81.7387s
Epoch: 7 cost time: 6.493412017822266
Epoch: 7, Steps: 570 | Train Loss: 0.1247528 Vali Loss: 0.0385924 Test Loss: 0.1243976
Validation loss decreased (0.038628 --> 0.038592).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0976155
	speed: 0.0386s/iter; left time: 282.0587s
	iters: 200, epoch: 8 | loss: 0.1807430
	speed: 0.0121s/iter; left time: 87.4223s
	iters: 300, epoch: 8 | loss: 0.1563657
	speed: 0.0121s/iter; left time: 85.9442s
	iters: 400, epoch: 8 | loss: 0.1276036
	speed: 0.0121s/iter; left time: 84.5397s
	iters: 500, epoch: 8 | loss: 0.0864860
	speed: 0.0121s/iter; left time: 83.6081s
Epoch: 8 cost time: 7.21411657333374
Epoch: 8, Steps: 570 | Train Loss: 0.1243899 Vali Loss: 0.0384668 Test Loss: 0.1241978
Validation loss decreased (0.038592 --> 0.038467).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1099533
	speed: 0.0390s/iter; left time: 262.6372s
	iters: 200, epoch: 9 | loss: 0.0833538
	speed: 0.0109s/iter; left time: 72.6393s
	iters: 300, epoch: 9 | loss: 0.1339110
	speed: 0.0109s/iter; left time: 71.5047s
	iters: 400, epoch: 9 | loss: 0.1569254
	speed: 0.0109s/iter; left time: 70.3754s
	iters: 500, epoch: 9 | loss: 0.0781038
	speed: 0.0109s/iter; left time: 69.2540s
Epoch: 9 cost time: 6.544881820678711
Epoch: 9, Steps: 570 | Train Loss: 0.1230334 Vali Loss: 0.0385081 Test Loss: 0.1237361
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1158035
	speed: 0.0366s/iter; left time: 225.6543s
	iters: 200, epoch: 10 | loss: 0.0832513
	speed: 0.0109s/iter; left time: 66.1736s
	iters: 300, epoch: 10 | loss: 0.1323909
	speed: 0.0109s/iter; left time: 64.8529s
	iters: 400, epoch: 10 | loss: 0.0938356
	speed: 0.0108s/iter; left time: 63.5338s
	iters: 500, epoch: 10 | loss: 0.1200961
	speed: 0.0109s/iter; left time: 62.6710s
Epoch: 10 cost time: 6.487130880355835
Epoch: 10, Steps: 570 | Train Loss: 0.1232119 Vali Loss: 0.0384464 Test Loss: 0.1238844
Validation loss decreased (0.038467 --> 0.038446).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0880294
	speed: 0.0398s/iter; left time: 222.8606s
	iters: 200, epoch: 11 | loss: 0.1333495
	speed: 0.0109s/iter; left time: 59.8149s
	iters: 300, epoch: 11 | loss: 0.1132784
	speed: 0.0109s/iter; left time: 58.6916s
	iters: 400, epoch: 11 | loss: 0.0909003
	speed: 0.0109s/iter; left time: 57.6113s
	iters: 500, epoch: 11 | loss: 0.0962447
	speed: 0.0109s/iter; left time: 56.4939s
Epoch: 11 cost time: 6.495711803436279
Epoch: 11, Steps: 570 | Train Loss: 0.1235934 Vali Loss: 0.0384384 Test Loss: 0.1238350
Validation loss decreased (0.038446 --> 0.038438).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1400836
	speed: 0.0379s/iter; left time: 190.7318s
	iters: 200, epoch: 12 | loss: 0.1498244
	speed: 0.0109s/iter; left time: 53.5342s
	iters: 300, epoch: 12 | loss: 0.1078468
	speed: 0.0108s/iter; left time: 52.2638s
	iters: 400, epoch: 12 | loss: 0.1485666
	speed: 0.0108s/iter; left time: 51.2245s
	iters: 500, epoch: 12 | loss: 0.1239595
	speed: 0.0108s/iter; left time: 50.2232s
Epoch: 12 cost time: 6.483982563018799
Epoch: 12, Steps: 570 | Train Loss: 0.1226309 Vali Loss: 0.0384481 Test Loss: 0.1238305
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0807109
	speed: 0.0390s/iter; left time: 174.1732s
	iters: 200, epoch: 13 | loss: 0.1681882
	speed: 0.0109s/iter; left time: 47.6644s
	iters: 300, epoch: 13 | loss: 0.0886898
	speed: 0.0109s/iter; left time: 46.4852s
	iters: 400, epoch: 13 | loss: 0.0915739
	speed: 0.0109s/iter; left time: 45.3911s
	iters: 500, epoch: 13 | loss: 0.1158995
	speed: 0.0109s/iter; left time: 44.2437s
Epoch: 13 cost time: 6.542429208755493
Epoch: 13, Steps: 570 | Train Loss: 0.1236351 Vali Loss: 0.0384767 Test Loss: 0.1238470
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1881920
	speed: 0.0380s/iter; left time: 147.8622s
	iters: 200, epoch: 14 | loss: 0.1902320
	speed: 0.0109s/iter; left time: 41.1333s
	iters: 300, epoch: 14 | loss: 0.1145264
	speed: 0.0108s/iter; left time: 40.0392s
	iters: 400, epoch: 14 | loss: 0.1251795
	speed: 0.0108s/iter; left time: 38.9265s
	iters: 500, epoch: 14 | loss: 0.1174224
	speed: 0.0108s/iter; left time: 37.8431s
Epoch: 14 cost time: 6.457972288131714
Epoch: 14, Steps: 570 | Train Loss: 0.1234293 Vali Loss: 0.0384395 Test Loss: 0.1238526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1240076944231987, mae:0.22189994156360626
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2047569
	speed: 0.0264s/iter; left time: 297.9763s
	iters: 200, epoch: 1 | loss: 0.1721311
	speed: 0.0145s/iter; left time: 162.3853s
	iters: 300, epoch: 1 | loss: 0.2918872
	speed: 0.0145s/iter; left time: 160.7487s
	iters: 400, epoch: 1 | loss: 0.1840911
	speed: 0.0145s/iter; left time: 159.6042s
	iters: 500, epoch: 1 | loss: 0.1514521
	speed: 0.0145s/iter; left time: 158.4163s
Epoch: 1 cost time: 9.50637698173523
Epoch: 1, Steps: 570 | Train Loss: 0.2111790 Vali Loss: 0.0435493 Test Loss: 0.1358985
Validation loss decreased (inf --> 0.043549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2041141
	speed: 0.0473s/iter; left time: 507.9645s
	iters: 200, epoch: 2 | loss: 0.1462274
	speed: 0.0146s/iter; left time: 155.2287s
	iters: 300, epoch: 2 | loss: 0.1372207
	speed: 0.0146s/iter; left time: 153.4718s
	iters: 400, epoch: 2 | loss: 0.1192545
	speed: 0.0146s/iter; left time: 152.1580s
	iters: 500, epoch: 2 | loss: 0.1763059
	speed: 0.0146s/iter; left time: 150.3726s
Epoch: 2 cost time: 8.608175039291382
Epoch: 2, Steps: 570 | Train Loss: 0.1698193 Vali Loss: 0.0397341 Test Loss: 0.1301434
Validation loss decreased (0.043549 --> 0.039734).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2607693
	speed: 0.0472s/iter; left time: 479.2085s
	iters: 200, epoch: 3 | loss: 0.1628471
	speed: 0.0144s/iter; left time: 144.5917s
	iters: 300, epoch: 3 | loss: 0.1069581
	speed: 0.0144s/iter; left time: 143.5057s
	iters: 400, epoch: 3 | loss: 0.1171424
	speed: 0.0144s/iter; left time: 142.4686s
	iters: 500, epoch: 3 | loss: 0.1060702
	speed: 0.0144s/iter; left time: 140.9300s
Epoch: 3 cost time: 8.492679834365845
Epoch: 3, Steps: 570 | Train Loss: 0.1490578 Vali Loss: 0.0359175 Test Loss: 0.1201296
Validation loss decreased (0.039734 --> 0.035917).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1515058
	speed: 0.0465s/iter; left time: 445.9076s
	iters: 200, epoch: 4 | loss: 0.1164116
	speed: 0.0144s/iter; left time: 136.5197s
	iters: 300, epoch: 4 | loss: 0.1514658
	speed: 0.0144s/iter; left time: 135.0818s
	iters: 400, epoch: 4 | loss: 0.1478230
	speed: 0.0144s/iter; left time: 133.6885s
	iters: 500, epoch: 4 | loss: 0.1313840
	speed: 0.0144s/iter; left time: 132.1854s
Epoch: 4 cost time: 8.490906238555908
Epoch: 4, Steps: 570 | Train Loss: 0.1398823 Vali Loss: 0.0353378 Test Loss: 0.1230004
Validation loss decreased (0.035917 --> 0.035338).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1263737
	speed: 0.0474s/iter; left time: 428.0292s
	iters: 200, epoch: 5 | loss: 0.1141983
	speed: 0.0144s/iter; left time: 128.6208s
	iters: 300, epoch: 5 | loss: 0.1274197
	speed: 0.0144s/iter; left time: 127.3378s
	iters: 400, epoch: 5 | loss: 0.1358247
	speed: 0.0144s/iter; left time: 125.7287s
	iters: 500, epoch: 5 | loss: 0.1271198
	speed: 0.0144s/iter; left time: 124.3361s
Epoch: 5 cost time: 8.499338865280151
Epoch: 5, Steps: 570 | Train Loss: 0.1352223 Vali Loss: 0.0348664 Test Loss: 0.1199729
Validation loss decreased (0.035338 --> 0.034866).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0976155
	speed: 0.0457s/iter; left time: 386.1819s
	iters: 200, epoch: 6 | loss: 0.1496920
	speed: 0.0145s/iter; left time: 120.8954s
	iters: 300, epoch: 6 | loss: 0.1000441
	speed: 0.0145s/iter; left time: 119.4416s
	iters: 400, epoch: 6 | loss: 0.0984927
	speed: 0.0144s/iter; left time: 117.3288s
	iters: 500, epoch: 6 | loss: 0.1439775
	speed: 0.0144s/iter; left time: 115.5399s
Epoch: 6 cost time: 8.520895957946777
Epoch: 6, Steps: 570 | Train Loss: 0.1312461 Vali Loss: 0.0346095 Test Loss: 0.1215637
Validation loss decreased (0.034866 --> 0.034610).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1307121
	speed: 0.0466s/iter; left time: 367.5101s
	iters: 200, epoch: 7 | loss: 0.1020568
	speed: 0.0144s/iter; left time: 112.2583s
	iters: 300, epoch: 7 | loss: 0.1043422
	speed: 0.0144s/iter; left time: 110.9189s
	iters: 400, epoch: 7 | loss: 0.1314693
	speed: 0.0144s/iter; left time: 109.2964s
	iters: 500, epoch: 7 | loss: 0.2119968
	speed: 0.0145s/iter; left time: 108.1697s
Epoch: 7 cost time: 8.493776559829712
Epoch: 7, Steps: 570 | Train Loss: 0.1305236 Vali Loss: 0.0346760 Test Loss: 0.1211119
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1867866
	speed: 0.0452s/iter; left time: 330.4904s
	iters: 200, epoch: 8 | loss: 0.1295784
	speed: 0.0145s/iter; left time: 104.7619s
	iters: 300, epoch: 8 | loss: 0.1420640
	speed: 0.0145s/iter; left time: 103.1691s
	iters: 400, epoch: 8 | loss: 0.0948894
	speed: 0.0145s/iter; left time: 101.6321s
	iters: 500, epoch: 8 | loss: 0.1524995
	speed: 0.0145s/iter; left time: 100.1891s
Epoch: 8 cost time: 8.522740840911865
Epoch: 8, Steps: 570 | Train Loss: 0.1304179 Vali Loss: 0.0348385 Test Loss: 0.1214825
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1644307
	speed: 0.0473s/iter; left time: 318.7408s
	iters: 200, epoch: 9 | loss: 0.1492928
	speed: 0.0162s/iter; left time: 107.7666s
	iters: 300, epoch: 9 | loss: 0.1900343
	speed: 0.0163s/iter; left time: 106.3266s
	iters: 400, epoch: 9 | loss: 0.1507646
	speed: 0.0162s/iter; left time: 104.5254s
	iters: 500, epoch: 9 | loss: 0.1052462
	speed: 0.0162s/iter; left time: 103.0355s
Epoch: 9 cost time: 9.512165069580078
Epoch: 9, Steps: 570 | Train Loss: 0.1295061 Vali Loss: 0.0347421 Test Loss: 0.1210433
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12174582481384277, mae:0.21724450588226318
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2714466
	speed: 0.0277s/iter; left time: 312.4901s
	iters: 200, epoch: 1 | loss: 0.1833450
	speed: 0.0162s/iter; left time: 181.8854s
	iters: 300, epoch: 1 | loss: 0.1116743
	speed: 0.0162s/iter; left time: 180.1014s
	iters: 400, epoch: 1 | loss: 0.2457210
	speed: 0.0163s/iter; left time: 178.7760s
	iters: 500, epoch: 1 | loss: 0.1758959
	speed: 0.0162s/iter; left time: 177.0983s
Epoch: 1 cost time: 10.447898626327515
Epoch: 1, Steps: 570 | Train Loss: 0.1832130 Vali Loss: 0.0354777 Test Loss: 0.1102525
Validation loss decreased (inf --> 0.035478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1255521
	speed: 0.0486s/iter; left time: 521.4476s
	iters: 200, epoch: 2 | loss: 0.2327390
	speed: 0.0160s/iter; left time: 169.5655s
	iters: 300, epoch: 2 | loss: 0.1772514
	speed: 0.0153s/iter; left time: 161.0476s
	iters: 400, epoch: 2 | loss: 0.1205304
	speed: 0.0142s/iter; left time: 147.8592s
	iters: 500, epoch: 2 | loss: 0.1233689
	speed: 0.0142s/iter; left time: 146.4762s
Epoch: 2 cost time: 8.848949193954468
Epoch: 2, Steps: 570 | Train Loss: 0.1506715 Vali Loss: 0.0339201 Test Loss: 0.1126614
Validation loss decreased (0.035478 --> 0.033920).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1473355
	speed: 0.0470s/iter; left time: 477.2603s
	iters: 200, epoch: 3 | loss: 0.0864547
	speed: 0.0142s/iter; left time: 142.6469s
	iters: 300, epoch: 3 | loss: 0.1745018
	speed: 0.0142s/iter; left time: 141.4723s
	iters: 400, epoch: 3 | loss: 0.1090745
	speed: 0.0142s/iter; left time: 139.8246s
	iters: 500, epoch: 3 | loss: 0.1212042
	speed: 0.0142s/iter; left time: 138.6447s
Epoch: 3 cost time: 8.357187747955322
Epoch: 3, Steps: 570 | Train Loss: 0.1344462 Vali Loss: 0.0329960 Test Loss: 0.1109708
Validation loss decreased (0.033920 --> 0.032996).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1262608
	speed: 0.0470s/iter; left time: 450.6967s
	iters: 200, epoch: 4 | loss: 0.1213391
	speed: 0.0141s/iter; left time: 134.0097s
	iters: 300, epoch: 4 | loss: 0.1373242
	speed: 0.0141s/iter; left time: 132.4513s
	iters: 400, epoch: 4 | loss: 0.0776137
	speed: 0.0141s/iter; left time: 131.0822s
	iters: 500, epoch: 4 | loss: 0.0916152
	speed: 0.0141s/iter; left time: 129.8459s
Epoch: 4 cost time: 8.360148191452026
Epoch: 4, Steps: 570 | Train Loss: 0.1285917 Vali Loss: 0.0319500 Test Loss: 0.1105838
Validation loss decreased (0.032996 --> 0.031950).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0646266
	speed: 0.0450s/iter; left time: 406.1411s
	iters: 200, epoch: 5 | loss: 0.1230586
	speed: 0.0141s/iter; left time: 126.0475s
	iters: 300, epoch: 5 | loss: 0.1696747
	speed: 0.0141s/iter; left time: 124.6139s
	iters: 400, epoch: 5 | loss: 0.1049808
	speed: 0.0141s/iter; left time: 123.1180s
	iters: 500, epoch: 5 | loss: 0.1418797
	speed: 0.0141s/iter; left time: 121.8379s
Epoch: 5 cost time: 8.327671527862549
Epoch: 5, Steps: 570 | Train Loss: 0.1240557 Vali Loss: 0.0317498 Test Loss: 0.1098400
Validation loss decreased (0.031950 --> 0.031750).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1115341
	speed: 0.0447s/iter; left time: 377.3970s
	iters: 200, epoch: 6 | loss: 0.2230012
	speed: 0.0142s/iter; left time: 118.5680s
	iters: 300, epoch: 6 | loss: 0.1876464
	speed: 0.0142s/iter; left time: 117.1932s
	iters: 400, epoch: 6 | loss: 0.1356148
	speed: 0.0142s/iter; left time: 115.7307s
	iters: 500, epoch: 6 | loss: 0.1370379
	speed: 0.0142s/iter; left time: 114.3048s
Epoch: 6 cost time: 8.386096715927124
Epoch: 6, Steps: 570 | Train Loss: 0.1222151 Vali Loss: 0.0315075 Test Loss: 0.1099989
Validation loss decreased (0.031750 --> 0.031507).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0917359
	speed: 0.0465s/iter; left time: 366.6627s
	iters: 200, epoch: 7 | loss: 0.1327952
	speed: 0.0142s/iter; left time: 110.3167s
	iters: 300, epoch: 7 | loss: 0.1693450
	speed: 0.0142s/iter; left time: 108.7969s
	iters: 400, epoch: 7 | loss: 0.1225072
	speed: 0.0142s/iter; left time: 107.3446s
	iters: 500, epoch: 7 | loss: 0.1464634
	speed: 0.0142s/iter; left time: 105.9093s
Epoch: 7 cost time: 8.349441528320312
Epoch: 7, Steps: 570 | Train Loss: 0.1204937 Vali Loss: 0.0312481 Test Loss: 0.1096683
Validation loss decreased (0.031507 --> 0.031248).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0855149
	speed: 0.0446s/iter; left time: 325.7354s
	iters: 200, epoch: 8 | loss: 0.1063012
	speed: 0.0141s/iter; left time: 101.3760s
	iters: 300, epoch: 8 | loss: 0.1573913
	speed: 0.0141s/iter; left time: 99.9763s
	iters: 400, epoch: 8 | loss: 0.1176097
	speed: 0.0141s/iter; left time: 98.5935s
	iters: 500, epoch: 8 | loss: 0.1097314
	speed: 0.0141s/iter; left time: 97.4194s
Epoch: 8 cost time: 8.293718338012695
Epoch: 8, Steps: 570 | Train Loss: 0.1196738 Vali Loss: 0.0313694 Test Loss: 0.1097663
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0974496
	speed: 0.0479s/iter; left time: 322.7501s
	iters: 200, epoch: 9 | loss: 0.1121854
	speed: 0.0141s/iter; left time: 93.5899s
	iters: 300, epoch: 9 | loss: 0.1125480
	speed: 0.0141s/iter; left time: 92.2949s
	iters: 400, epoch: 9 | loss: 0.0968294
	speed: 0.0142s/iter; left time: 91.5283s
	iters: 500, epoch: 9 | loss: 0.1291035
	speed: 0.0142s/iter; left time: 89.9178s
Epoch: 9 cost time: 8.334866046905518
Epoch: 9, Steps: 570 | Train Loss: 0.1191862 Vali Loss: 0.0312849 Test Loss: 0.1098480
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1136008
	speed: 0.0472s/iter; left time: 291.0735s
	iters: 200, epoch: 10 | loss: 0.1118148
	speed: 0.0140s/iter; left time: 85.1259s
	iters: 300, epoch: 10 | loss: 0.1124306
	speed: 0.0140s/iter; left time: 83.8144s
	iters: 400, epoch: 10 | loss: 0.1297452
	speed: 0.0140s/iter; left time: 82.3110s
	iters: 500, epoch: 10 | loss: 0.1475537
	speed: 0.0140s/iter; left time: 80.9695s
Epoch: 10 cost time: 8.295629739761353
Epoch: 10, Steps: 570 | Train Loss: 0.1196228 Vali Loss: 0.0313251 Test Loss: 0.1098910
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10982311517000198, mae:0.20000316202640533
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1340132
	speed: 0.0262s/iter; left time: 296.2761s
	iters: 200, epoch: 1 | loss: 0.2731330
	speed: 0.0142s/iter; left time: 158.7000s
	iters: 300, epoch: 1 | loss: 0.2700988
	speed: 0.0141s/iter; left time: 156.9354s
	iters: 400, epoch: 1 | loss: 0.2357663
	speed: 0.0142s/iter; left time: 156.1861s
	iters: 500, epoch: 1 | loss: 0.2441259
	speed: 0.0142s/iter; left time: 154.7633s
Epoch: 1 cost time: 9.335127830505371
Epoch: 1, Steps: 570 | Train Loss: 0.2175356 Vali Loss: 0.0434821 Test Loss: 0.1324463
Validation loss decreased (inf --> 0.043482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1540688
	speed: 0.0465s/iter; left time: 498.5301s
	iters: 200, epoch: 2 | loss: 0.1154824
	speed: 0.0144s/iter; left time: 153.0561s
	iters: 300, epoch: 2 | loss: 0.1036720
	speed: 0.0143s/iter; left time: 151.1037s
	iters: 400, epoch: 2 | loss: 0.1394471
	speed: 0.0144s/iter; left time: 149.9447s
	iters: 500, epoch: 2 | loss: 0.2109354
	speed: 0.0143s/iter; left time: 148.0245s
Epoch: 2 cost time: 8.505199432373047
Epoch: 2, Steps: 570 | Train Loss: 0.1765220 Vali Loss: 0.0419425 Test Loss: 0.1278307
Validation loss decreased (0.043482 --> 0.041942).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1866744
	speed: 0.0497s/iter; left time: 505.0127s
	iters: 200, epoch: 3 | loss: 0.1807503
	speed: 0.0143s/iter; left time: 143.5908s
	iters: 300, epoch: 3 | loss: 0.1508223
	speed: 0.0143s/iter; left time: 142.2383s
	iters: 400, epoch: 3 | loss: 0.1283116
	speed: 0.0143s/iter; left time: 140.9466s
	iters: 500, epoch: 3 | loss: 0.1517522
	speed: 0.0143s/iter; left time: 139.1195s
Epoch: 3 cost time: 8.423991203308105
Epoch: 3, Steps: 570 | Train Loss: 0.1552826 Vali Loss: 0.0393618 Test Loss: 0.1237901
Validation loss decreased (0.041942 --> 0.039362).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1693730
	speed: 0.0483s/iter; left time: 463.5939s
	iters: 200, epoch: 4 | loss: 0.1441906
	speed: 0.0161s/iter; left time: 152.3662s
	iters: 300, epoch: 4 | loss: 0.1830863
	speed: 0.0161s/iter; left time: 151.0512s
	iters: 400, epoch: 4 | loss: 0.1477285
	speed: 0.0162s/iter; left time: 150.8341s
	iters: 500, epoch: 4 | loss: 0.1046303
	speed: 0.0161s/iter; left time: 148.0098s
Epoch: 4 cost time: 9.47012448310852
Epoch: 4, Steps: 570 | Train Loss: 0.1463910 Vali Loss: 0.0377049 Test Loss: 0.1226720
Validation loss decreased (0.039362 --> 0.037705).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1406279
	speed: 0.0476s/iter; left time: 429.5291s
	iters: 200, epoch: 5 | loss: 0.1610852
	speed: 0.0143s/iter; left time: 127.3588s
	iters: 300, epoch: 5 | loss: 0.1367887
	speed: 0.0143s/iter; left time: 126.0372s
	iters: 400, epoch: 5 | loss: 0.1876882
	speed: 0.0143s/iter; left time: 124.6150s
	iters: 500, epoch: 5 | loss: 0.1052222
	speed: 0.0143s/iter; left time: 123.1503s
Epoch: 5 cost time: 8.463184118270874
Epoch: 5, Steps: 570 | Train Loss: 0.1414276 Vali Loss: 0.0380426 Test Loss: 0.1222891
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2116309
	speed: 0.0478s/iter; left time: 403.6054s
	iters: 200, epoch: 6 | loss: 0.1298434
	speed: 0.0142s/iter; left time: 118.1812s
	iters: 300, epoch: 6 | loss: 0.0935109
	speed: 0.0142s/iter; left time: 116.7539s
	iters: 400, epoch: 6 | loss: 0.1730927
	speed: 0.0142s/iter; left time: 115.3914s
	iters: 500, epoch: 6 | loss: 0.1374914
	speed: 0.0141s/iter; left time: 113.8082s
Epoch: 6 cost time: 8.358580589294434
Epoch: 6, Steps: 570 | Train Loss: 0.1391261 Vali Loss: 0.0377288 Test Loss: 0.1226217
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1686033
	speed: 0.0451s/iter; left time: 355.5178s
	iters: 200, epoch: 7 | loss: 0.0903399
	speed: 0.0142s/iter; left time: 110.4844s
	iters: 300, epoch: 7 | loss: 0.1061012
	speed: 0.0142s/iter; left time: 109.1887s
	iters: 400, epoch: 7 | loss: 0.1717959
	speed: 0.0142s/iter; left time: 107.6472s
	iters: 500, epoch: 7 | loss: 0.1215039
	speed: 0.0142s/iter; left time: 106.2326s
Epoch: 7 cost time: 8.388734817504883
Epoch: 7, Steps: 570 | Train Loss: 0.1389024 Vali Loss: 0.0375392 Test Loss: 0.1220629
Validation loss decreased (0.037705 --> 0.037539).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1050478
	speed: 0.0470s/iter; left time: 343.4505s
	iters: 200, epoch: 8 | loss: 0.1073643
	speed: 0.0143s/iter; left time: 102.9595s
	iters: 300, epoch: 8 | loss: 0.1274797
	speed: 0.0143s/iter; left time: 101.3580s
	iters: 400, epoch: 8 | loss: 0.1463042
	speed: 0.0142s/iter; left time: 99.8670s
	iters: 500, epoch: 8 | loss: 0.1025157
	speed: 0.0143s/iter; left time: 98.4887s
Epoch: 8 cost time: 8.438206672668457
Epoch: 8, Steps: 570 | Train Loss: 0.1376869 Vali Loss: 0.0380538 Test Loss: 0.1229385
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1774512
	speed: 0.0471s/iter; left time: 317.3949s
	iters: 200, epoch: 9 | loss: 0.1372954
	speed: 0.0143s/iter; left time: 94.8770s
	iters: 300, epoch: 9 | loss: 0.0735341
	speed: 0.0143s/iter; left time: 93.4591s
	iters: 400, epoch: 9 | loss: 0.1188553
	speed: 0.0143s/iter; left time: 92.0070s
	iters: 500, epoch: 9 | loss: 0.1156157
	speed: 0.0143s/iter; left time: 90.5375s
Epoch: 9 cost time: 8.428909063339233
Epoch: 9, Steps: 570 | Train Loss: 0.1363195 Vali Loss: 0.0376753 Test Loss: 0.1227020
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1548845
	speed: 0.0466s/iter; left time: 287.4612s
	iters: 200, epoch: 10 | loss: 0.1635989
	speed: 0.0142s/iter; left time: 86.4282s
	iters: 300, epoch: 10 | loss: 0.1354944
	speed: 0.0142s/iter; left time: 84.9886s
	iters: 400, epoch: 10 | loss: 0.1608072
	speed: 0.0142s/iter; left time: 83.5375s
	iters: 500, epoch: 10 | loss: 0.1307496
	speed: 0.0142s/iter; left time: 82.1204s
Epoch: 10 cost time: 8.50164794921875
Epoch: 10, Steps: 570 | Train Loss: 0.1368901 Vali Loss: 0.0376425 Test Loss: 0.1224218
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12225611507892609, mae:0.21893946826457977
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2642496
	speed: 0.0287s/iter; left time: 323.8656s
	iters: 200, epoch: 1 | loss: 0.1672373
	speed: 0.0170s/iter; left time: 190.3563s
	iters: 300, epoch: 1 | loss: 0.2110314
	speed: 0.0170s/iter; left time: 188.6129s
	iters: 400, epoch: 1 | loss: 0.1752806
	speed: 0.0170s/iter; left time: 186.7932s
	iters: 500, epoch: 1 | loss: 0.1534884
	speed: 0.0170s/iter; left time: 185.2254s
Epoch: 1 cost time: 10.901410579681396
Epoch: 1, Steps: 570 | Train Loss: 0.2048573 Vali Loss: 0.0442407 Test Loss: 0.1334456
Validation loss decreased (inf --> 0.044241).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1922308
	speed: 0.0517s/iter; left time: 554.8256s
	iters: 200, epoch: 2 | loss: 0.1989005
	speed: 0.0170s/iter; left time: 180.3888s
	iters: 300, epoch: 2 | loss: 0.1904143
	speed: 0.0170s/iter; left time: 178.6941s
	iters: 400, epoch: 2 | loss: 0.1112681
	speed: 0.0170s/iter; left time: 176.8145s
	iters: 500, epoch: 2 | loss: 0.1280198
	speed: 0.0169s/iter; left time: 175.0545s
Epoch: 2 cost time: 10.01930570602417
Epoch: 2, Steps: 570 | Train Loss: 0.1616140 Vali Loss: 0.0378118 Test Loss: 0.1226735
Validation loss decreased (0.044241 --> 0.037812).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1237671
	speed: 0.0512s/iter; left time: 520.2287s
	iters: 200, epoch: 3 | loss: 0.1354339
	speed: 0.0170s/iter; left time: 170.6324s
	iters: 300, epoch: 3 | loss: 0.2374647
	speed: 0.0170s/iter; left time: 169.1357s
	iters: 400, epoch: 3 | loss: 0.1247521
	speed: 0.0170s/iter; left time: 167.4133s
	iters: 500, epoch: 3 | loss: 0.0987477
	speed: 0.0170s/iter; left time: 165.8069s
Epoch: 3 cost time: 9.988650798797607
Epoch: 3, Steps: 570 | Train Loss: 0.1346405 Vali Loss: 0.0368421 Test Loss: 0.1211564
Validation loss decreased (0.037812 --> 0.036842).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0937603
	speed: 0.0536s/iter; left time: 514.0853s
	iters: 200, epoch: 4 | loss: 0.1194085
	speed: 0.0169s/iter; left time: 159.9309s
	iters: 300, epoch: 4 | loss: 0.1261603
	speed: 0.0169s/iter; left time: 158.3203s
	iters: 400, epoch: 4 | loss: 0.1470387
	speed: 0.0168s/iter; left time: 156.3342s
	iters: 500, epoch: 4 | loss: 0.1260980
	speed: 0.0168s/iter; left time: 154.5190s
Epoch: 4 cost time: 9.885355949401855
Epoch: 4, Steps: 570 | Train Loss: 0.1197446 Vali Loss: 0.0364672 Test Loss: 0.1205641
Validation loss decreased (0.036842 --> 0.036467).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0868400
	speed: 0.0521s/iter; left time: 470.0196s
	iters: 200, epoch: 5 | loss: 0.1205349
	speed: 0.0169s/iter; left time: 150.4195s
	iters: 300, epoch: 5 | loss: 0.1141921
	speed: 0.0169s/iter; left time: 148.8620s
	iters: 400, epoch: 5 | loss: 0.1284914
	speed: 0.0169s/iter; left time: 146.9789s
	iters: 500, epoch: 5 | loss: 0.0882356
	speed: 0.0169s/iter; left time: 145.4862s
Epoch: 5 cost time: 9.91375470161438
Epoch: 5, Steps: 570 | Train Loss: 0.1131571 Vali Loss: 0.0348938 Test Loss: 0.1195340
Validation loss decreased (0.036467 --> 0.034894).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1147439
	speed: 0.0539s/iter; left time: 455.1141s
	iters: 200, epoch: 6 | loss: 0.0958291
	speed: 0.0169s/iter; left time: 140.7462s
	iters: 300, epoch: 6 | loss: 0.1061931
	speed: 0.0169s/iter; left time: 139.1633s
	iters: 400, epoch: 6 | loss: 0.1339055
	speed: 0.0169s/iter; left time: 137.4283s
	iters: 500, epoch: 6 | loss: 0.1064150
	speed: 0.0169s/iter; left time: 135.7335s
Epoch: 6 cost time: 9.913726329803467
Epoch: 6, Steps: 570 | Train Loss: 0.1091125 Vali Loss: 0.0349584 Test Loss: 0.1170439
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1292955
	speed: 0.0521s/iter; left time: 410.3388s
	iters: 200, epoch: 7 | loss: 0.1387319
	speed: 0.0169s/iter; left time: 131.6385s
	iters: 300, epoch: 7 | loss: 0.1260076
	speed: 0.0169s/iter; left time: 130.0636s
	iters: 400, epoch: 7 | loss: 0.0798721
	speed: 0.0169s/iter; left time: 128.2056s
	iters: 500, epoch: 7 | loss: 0.0855768
	speed: 0.0169s/iter; left time: 126.4639s
Epoch: 7 cost time: 9.908849477767944
Epoch: 7, Steps: 570 | Train Loss: 0.1072664 Vali Loss: 0.0340650 Test Loss: 0.1183059
Validation loss decreased (0.034894 --> 0.034065).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0993857
	speed: 0.0538s/iter; left time: 393.6178s
	iters: 200, epoch: 8 | loss: 0.0821224
	speed: 0.0184s/iter; left time: 132.9264s
	iters: 300, epoch: 8 | loss: 0.1028370
	speed: 0.0184s/iter; left time: 130.9933s
	iters: 400, epoch: 8 | loss: 0.0694930
	speed: 0.0184s/iter; left time: 129.0314s
	iters: 500, epoch: 8 | loss: 0.0738068
	speed: 0.0184s/iter; left time: 127.1717s
Epoch: 8 cost time: 10.813576221466064
Epoch: 8, Steps: 570 | Train Loss: 0.1070141 Vali Loss: 0.0343289 Test Loss: 0.1180926
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0767808
	speed: 0.0569s/iter; left time: 383.2542s
	iters: 200, epoch: 9 | loss: 0.0842962
	speed: 0.0184s/iter; left time: 122.2378s
	iters: 300, epoch: 9 | loss: 0.0946802
	speed: 0.0184s/iter; left time: 120.5539s
	iters: 400, epoch: 9 | loss: 0.0880783
	speed: 0.0184s/iter; left time: 118.6769s
	iters: 500, epoch: 9 | loss: 0.1501595
	speed: 0.0184s/iter; left time: 116.6712s
Epoch: 9 cost time: 10.717708110809326
Epoch: 9, Steps: 570 | Train Loss: 0.1058018 Vali Loss: 0.0342370 Test Loss: 0.1178512
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1148590
	speed: 0.0507s/iter; left time: 312.7898s
	iters: 200, epoch: 10 | loss: 0.0611055
	speed: 0.0169s/iter; left time: 102.4960s
	iters: 300, epoch: 10 | loss: 0.1586422
	speed: 0.0169s/iter; left time: 100.8191s
	iters: 400, epoch: 10 | loss: 0.0999018
	speed: 0.0169s/iter; left time: 99.0809s
	iters: 500, epoch: 10 | loss: 0.0855434
	speed: 0.0169s/iter; left time: 97.3955s
Epoch: 10 cost time: 9.942793369293213
Epoch: 10, Steps: 570 | Train Loss: 0.1060700 Vali Loss: 0.0345414 Test Loss: 0.1175926
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1184559091925621, mae:0.21707218885421753
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1555285
	speed: 0.0301s/iter; left time: 340.3317s
	iters: 200, epoch: 1 | loss: 0.1058938
	speed: 0.0178s/iter; left time: 199.5219s
	iters: 300, epoch: 1 | loss: 0.1976846
	speed: 0.0178s/iter; left time: 197.7498s
	iters: 400, epoch: 1 | loss: 0.1717134
	speed: 0.0179s/iter; left time: 196.6362s
	iters: 500, epoch: 1 | loss: 0.1015578
	speed: 0.0178s/iter; left time: 194.2650s
Epoch: 1 cost time: 11.442708015441895
Epoch: 1, Steps: 570 | Train Loss: 0.1783853 Vali Loss: 0.0342684 Test Loss: 0.1115713
Validation loss decreased (inf --> 0.034268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1322298
	speed: 0.0534s/iter; left time: 573.0550s
	iters: 200, epoch: 2 | loss: 0.1116886
	speed: 0.0164s/iter; left time: 174.5407s
	iters: 300, epoch: 2 | loss: 0.2077729
	speed: 0.0164s/iter; left time: 172.7728s
	iters: 400, epoch: 2 | loss: 0.1784001
	speed: 0.0164s/iter; left time: 170.8714s
	iters: 500, epoch: 2 | loss: 0.1166745
	speed: 0.0164s/iter; left time: 169.1540s
Epoch: 2 cost time: 9.69466257095337
Epoch: 2, Steps: 570 | Train Loss: 0.1438919 Vali Loss: 0.0351572 Test Loss: 0.1138219
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1210392
	speed: 0.0489s/iter; left time: 497.1605s
	iters: 200, epoch: 3 | loss: 0.1237201
	speed: 0.0163s/iter; left time: 164.1580s
	iters: 300, epoch: 3 | loss: 0.1078374
	speed: 0.0163s/iter; left time: 162.7010s
	iters: 400, epoch: 3 | loss: 0.1568393
	speed: 0.0163s/iter; left time: 160.9920s
	iters: 500, epoch: 3 | loss: 0.0859967
	speed: 0.0163s/iter; left time: 159.1964s
Epoch: 3 cost time: 9.593924045562744
Epoch: 3, Steps: 570 | Train Loss: 0.1227649 Vali Loss: 0.0325438 Test Loss: 0.1098657
Validation loss decreased (0.034268 --> 0.032544).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1230057
	speed: 0.0538s/iter; left time: 516.0879s
	iters: 200, epoch: 4 | loss: 0.1713229
	speed: 0.0163s/iter; left time: 154.7821s
	iters: 300, epoch: 4 | loss: 0.0925769
	speed: 0.0163s/iter; left time: 153.3437s
	iters: 400, epoch: 4 | loss: 0.0831985
	speed: 0.0163s/iter; left time: 151.3935s
	iters: 500, epoch: 4 | loss: 0.1476100
	speed: 0.0163s/iter; left time: 149.9752s
Epoch: 4 cost time: 9.610456943511963
Epoch: 4, Steps: 570 | Train Loss: 0.1103549 Vali Loss: 0.0322846 Test Loss: 0.1100513
Validation loss decreased (0.032544 --> 0.032285).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1093887
	speed: 0.0501s/iter; left time: 451.7870s
	iters: 200, epoch: 5 | loss: 0.1200557
	speed: 0.0164s/iter; left time: 146.2521s
	iters: 300, epoch: 5 | loss: 0.1096876
	speed: 0.0164s/iter; left time: 144.5394s
	iters: 400, epoch: 5 | loss: 0.0723158
	speed: 0.0164s/iter; left time: 142.9048s
	iters: 500, epoch: 5 | loss: 0.1374758
	speed: 0.0164s/iter; left time: 141.0225s
Epoch: 5 cost time: 9.67451000213623
Epoch: 5, Steps: 570 | Train Loss: 0.1053676 Vali Loss: 0.0319508 Test Loss: 0.1103467
Validation loss decreased (0.032285 --> 0.031951).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0999631
	speed: 0.0505s/iter; left time: 426.3947s
	iters: 200, epoch: 6 | loss: 0.1338409
	speed: 0.0164s/iter; left time: 136.8307s
	iters: 300, epoch: 6 | loss: 0.1689444
	speed: 0.0164s/iter; left time: 135.0754s
	iters: 400, epoch: 6 | loss: 0.1071086
	speed: 0.0164s/iter; left time: 133.5143s
	iters: 500, epoch: 6 | loss: 0.1048287
	speed: 0.0164s/iter; left time: 131.9675s
Epoch: 6 cost time: 9.667218685150146
Epoch: 6, Steps: 570 | Train Loss: 0.1028331 Vali Loss: 0.0320684 Test Loss: 0.1101003
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1261138
	speed: 0.0510s/iter; left time: 402.1552s
	iters: 200, epoch: 7 | loss: 0.0776426
	speed: 0.0163s/iter; left time: 126.7873s
	iters: 300, epoch: 7 | loss: 0.0916797
	speed: 0.0163s/iter; left time: 125.2982s
	iters: 400, epoch: 7 | loss: 0.1496750
	speed: 0.0163s/iter; left time: 123.4780s
	iters: 500, epoch: 7 | loss: 0.0992560
	speed: 0.0163s/iter; left time: 121.9269s
Epoch: 7 cost time: 9.588154554367065
Epoch: 7, Steps: 570 | Train Loss: 0.1012986 Vali Loss: 0.0322577 Test Loss: 0.1099045
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0672307
	speed: 0.0490s/iter; left time: 358.0729s
	iters: 200, epoch: 8 | loss: 0.1146743
	speed: 0.0163s/iter; left time: 117.3839s
	iters: 300, epoch: 8 | loss: 0.1142103
	speed: 0.0163s/iter; left time: 115.7145s
	iters: 400, epoch: 8 | loss: 0.1174164
	speed: 0.0163s/iter; left time: 114.2377s
	iters: 500, epoch: 8 | loss: 0.0964760
	speed: 0.0163s/iter; left time: 112.7636s
Epoch: 8 cost time: 9.572313785552979
Epoch: 8, Steps: 570 | Train Loss: 0.0999613 Vali Loss: 0.0321173 Test Loss: 0.1101281
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11049826443195343, mae:0.2042028158903122
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2063830
	speed: 0.0269s/iter; left time: 304.2459s
	iters: 200, epoch: 1 | loss: 0.1870340
	speed: 0.0153s/iter; left time: 171.4860s
	iters: 300, epoch: 1 | loss: 0.1797046
	speed: 0.0153s/iter; left time: 169.6033s
	iters: 400, epoch: 1 | loss: 0.1959289
	speed: 0.0153s/iter; left time: 168.1316s
	iters: 500, epoch: 1 | loss: 0.3154422
	speed: 0.0153s/iter; left time: 166.7182s
Epoch: 1 cost time: 9.924736499786377
Epoch: 1, Steps: 570 | Train Loss: 0.2134551 Vali Loss: 0.0435308 Test Loss: 0.1349582
Validation loss decreased (inf --> 0.043531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2284414
	speed: 0.0486s/iter; left time: 521.1461s
	iters: 200, epoch: 2 | loss: 0.1208357
	speed: 0.0154s/iter; left time: 163.5693s
	iters: 300, epoch: 2 | loss: 0.1812132
	speed: 0.0154s/iter; left time: 161.7981s
	iters: 400, epoch: 2 | loss: 0.1583438
	speed: 0.0154s/iter; left time: 160.5297s
	iters: 500, epoch: 2 | loss: 0.2020065
	speed: 0.0154s/iter; left time: 159.0624s
Epoch: 2 cost time: 9.085787773132324
Epoch: 2, Steps: 570 | Train Loss: 0.1656884 Vali Loss: 0.0411948 Test Loss: 0.1304179
Validation loss decreased (0.043531 --> 0.041195).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1608097
	speed: 0.0484s/iter; left time: 491.3647s
	iters: 200, epoch: 3 | loss: 0.0874227
	speed: 0.0153s/iter; left time: 154.4113s
	iters: 300, epoch: 3 | loss: 0.1694377
	speed: 0.0153s/iter; left time: 152.6281s
	iters: 400, epoch: 3 | loss: 0.1177407
	speed: 0.0153s/iter; left time: 151.0804s
	iters: 500, epoch: 3 | loss: 0.1368724
	speed: 0.0153s/iter; left time: 149.5720s
Epoch: 3 cost time: 9.055989265441895
Epoch: 3, Steps: 570 | Train Loss: 0.1359576 Vali Loss: 0.0376442 Test Loss: 0.1299606
Validation loss decreased (0.041195 --> 0.037644).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0844448
	speed: 0.0476s/iter; left time: 456.6962s
	iters: 200, epoch: 4 | loss: 0.1618553
	speed: 0.0153s/iter; left time: 145.0323s
	iters: 300, epoch: 4 | loss: 0.1517792
	speed: 0.0153s/iter; left time: 143.5383s
	iters: 400, epoch: 4 | loss: 0.1055960
	speed: 0.0153s/iter; left time: 141.9326s
	iters: 500, epoch: 4 | loss: 0.1550536
	speed: 0.0153s/iter; left time: 140.4308s
Epoch: 4 cost time: 8.985569953918457
Epoch: 4, Steps: 570 | Train Loss: 0.1223496 Vali Loss: 0.0364399 Test Loss: 0.1311539
Validation loss decreased (0.037644 --> 0.036440).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1185952
	speed: 0.0491s/iter; left time: 442.8820s
	iters: 200, epoch: 5 | loss: 0.0921470
	speed: 0.0170s/iter; left time: 151.5387s
	iters: 300, epoch: 5 | loss: 0.0994880
	speed: 0.0166s/iter; left time: 146.8342s
	iters: 400, epoch: 5 | loss: 0.0897295
	speed: 0.0154s/iter; left time: 134.2504s
	iters: 500, epoch: 5 | loss: 0.0979272
	speed: 0.0154s/iter; left time: 132.7726s
Epoch: 5 cost time: 9.532302856445312
Epoch: 5, Steps: 570 | Train Loss: 0.1141438 Vali Loss: 0.0361733 Test Loss: 0.1294257
Validation loss decreased (0.036440 --> 0.036173).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0919634
	speed: 0.0500s/iter; left time: 422.2434s
	iters: 200, epoch: 6 | loss: 0.0713519
	speed: 0.0154s/iter; left time: 128.1896s
	iters: 300, epoch: 6 | loss: 0.0640771
	speed: 0.0154s/iter; left time: 126.8629s
	iters: 400, epoch: 6 | loss: 0.0877847
	speed: 0.0153s/iter; left time: 125.0300s
	iters: 500, epoch: 6 | loss: 0.0983191
	speed: 0.0154s/iter; left time: 123.7464s
Epoch: 6 cost time: 9.050387620925903
Epoch: 6, Steps: 570 | Train Loss: 0.1107003 Vali Loss: 0.0353952 Test Loss: 0.1319505
Validation loss decreased (0.036173 --> 0.035395).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1243195
	speed: 0.0482s/iter; left time: 379.9651s
	iters: 200, epoch: 7 | loss: 0.0919826
	speed: 0.0154s/iter; left time: 119.9540s
	iters: 300, epoch: 7 | loss: 0.1036018
	speed: 0.0154s/iter; left time: 118.3080s
	iters: 400, epoch: 7 | loss: 0.1400468
	speed: 0.0154s/iter; left time: 116.7731s
	iters: 500, epoch: 7 | loss: 0.1277194
	speed: 0.0154s/iter; left time: 115.2007s
Epoch: 7 cost time: 9.046965837478638
Epoch: 7, Steps: 570 | Train Loss: 0.1090898 Vali Loss: 0.0352193 Test Loss: 0.1302587
Validation loss decreased (0.035395 --> 0.035219).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0812892
	speed: 0.0503s/iter; left time: 367.6735s
	iters: 200, epoch: 8 | loss: 0.1107979
	speed: 0.0170s/iter; left time: 122.4991s
	iters: 300, epoch: 8 | loss: 0.0703831
	speed: 0.0170s/iter; left time: 120.7892s
	iters: 400, epoch: 8 | loss: 0.1055723
	speed: 0.0170s/iter; left time: 119.0831s
	iters: 500, epoch: 8 | loss: 0.0826987
	speed: 0.0170s/iter; left time: 117.4227s
Epoch: 8 cost time: 9.985109329223633
Epoch: 8, Steps: 570 | Train Loss: 0.1076544 Vali Loss: 0.0354851 Test Loss: 0.1311845
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0923762
	speed: 0.0494s/iter; left time: 333.1899s
	iters: 200, epoch: 9 | loss: 0.0993528
	speed: 0.0170s/iter; left time: 112.8904s
	iters: 300, epoch: 9 | loss: 0.1253577
	speed: 0.0170s/iter; left time: 111.0782s
	iters: 400, epoch: 9 | loss: 0.0924837
	speed: 0.0170s/iter; left time: 109.4876s
	iters: 500, epoch: 9 | loss: 0.1125001
	speed: 0.0170s/iter; left time: 107.6664s
Epoch: 9 cost time: 9.9627103805542
Epoch: 9, Steps: 570 | Train Loss: 0.1072153 Vali Loss: 0.0354216 Test Loss: 0.1312207
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1162508
	speed: 0.0491s/iter; left time: 302.8614s
	iters: 200, epoch: 10 | loss: 0.1318796
	speed: 0.0153s/iter; left time: 92.8572s
	iters: 300, epoch: 10 | loss: 0.0907145
	speed: 0.0153s/iter; left time: 91.3280s
	iters: 400, epoch: 10 | loss: 0.1265460
	speed: 0.0153s/iter; left time: 89.8652s
	iters: 500, epoch: 10 | loss: 0.1289427
	speed: 0.0153s/iter; left time: 88.3539s
Epoch: 10 cost time: 9.008822441101074
Epoch: 10, Steps: 570 | Train Loss: 0.1082149 Vali Loss: 0.0353202 Test Loss: 0.1312223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13045193254947662, mae:0.23218737542629242
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1391820
	speed: 0.0303s/iter; left time: 342.2291s
	iters: 200, epoch: 1 | loss: 0.2029080
	speed: 0.0187s/iter; left time: 209.3768s
	iters: 300, epoch: 1 | loss: 0.3258815
	speed: 0.0187s/iter; left time: 207.2815s
	iters: 400, epoch: 1 | loss: 0.1845980
	speed: 0.0187s/iter; left time: 205.4004s
	iters: 500, epoch: 1 | loss: 0.1627738
	speed: 0.0187s/iter; left time: 203.7960s
Epoch: 1 cost time: 11.862347602844238
Epoch: 1, Steps: 570 | Train Loss: 0.2102097 Vali Loss: 0.0448969 Test Loss: 0.1337774
Validation loss decreased (inf --> 0.044897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2993554
	speed: 0.0574s/iter; left time: 615.6492s
	iters: 200, epoch: 2 | loss: 0.1644480
	speed: 0.0187s/iter; left time: 198.4521s
	iters: 300, epoch: 2 | loss: 0.1396863
	speed: 0.0187s/iter; left time: 197.2293s
	iters: 400, epoch: 2 | loss: 0.1331915
	speed: 0.0187s/iter; left time: 195.2727s
	iters: 500, epoch: 2 | loss: 0.1542030
	speed: 0.0187s/iter; left time: 193.2091s
Epoch: 2 cost time: 10.953672409057617
Epoch: 2, Steps: 570 | Train Loss: 0.1688071 Vali Loss: 0.0415520 Test Loss: 0.1278588
Validation loss decreased (0.044897 --> 0.041552).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1257951
	speed: 0.0566s/iter; left time: 575.2830s
	iters: 200, epoch: 3 | loss: 0.1143206
	speed: 0.0186s/iter; left time: 186.6600s
	iters: 300, epoch: 3 | loss: 0.1279311
	speed: 0.0186s/iter; left time: 184.8944s
	iters: 400, epoch: 3 | loss: 0.1258806
	speed: 0.0186s/iter; left time: 183.0877s
	iters: 500, epoch: 3 | loss: 0.0975429
	speed: 0.0186s/iter; left time: 181.1537s
Epoch: 3 cost time: 10.89474630355835
Epoch: 3, Steps: 570 | Train Loss: 0.1449889 Vali Loss: 0.0376083 Test Loss: 0.1195712
Validation loss decreased (0.041552 --> 0.037608).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1677614
	speed: 0.0563s/iter; left time: 539.7606s
	iters: 200, epoch: 4 | loss: 0.1814447
	speed: 0.0186s/iter; left time: 176.9077s
	iters: 300, epoch: 4 | loss: 0.1515219
	speed: 0.0186s/iter; left time: 174.7588s
	iters: 400, epoch: 4 | loss: 0.1079124
	speed: 0.0186s/iter; left time: 172.6327s
	iters: 500, epoch: 4 | loss: 0.1271523
	speed: 0.0186s/iter; left time: 170.9346s
Epoch: 4 cost time: 10.903175592422485
Epoch: 4, Steps: 570 | Train Loss: 0.1339066 Vali Loss: 0.0367072 Test Loss: 0.1212885
Validation loss decreased (0.037608 --> 0.036707).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1465802
	speed: 0.0579s/iter; left time: 522.1551s
	iters: 200, epoch: 5 | loss: 0.1292708
	speed: 0.0201s/iter; left time: 179.6273s
	iters: 300, epoch: 5 | loss: 0.1207413
	speed: 0.0188s/iter; left time: 165.6437s
	iters: 400, epoch: 5 | loss: 0.1002995
	speed: 0.0188s/iter; left time: 164.1074s
	iters: 500, epoch: 5 | loss: 0.1350384
	speed: 0.0188s/iter; left time: 161.7380s
Epoch: 5 cost time: 11.348000049591064
Epoch: 5, Steps: 570 | Train Loss: 0.1279273 Vali Loss: 0.0351292 Test Loss: 0.1215083
Validation loss decreased (0.036707 --> 0.035129).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0720300
	speed: 0.0568s/iter; left time: 479.9640s
	iters: 200, epoch: 6 | loss: 0.1259978
	speed: 0.0186s/iter; left time: 155.4399s
	iters: 300, epoch: 6 | loss: 0.0900185
	speed: 0.0186s/iter; left time: 153.2885s
	iters: 400, epoch: 6 | loss: 0.1716787
	speed: 0.0186s/iter; left time: 151.4791s
	iters: 500, epoch: 6 | loss: 0.1148341
	speed: 0.0186s/iter; left time: 149.6488s
Epoch: 6 cost time: 10.875641107559204
Epoch: 6, Steps: 570 | Train Loss: 0.1261035 Vali Loss: 0.0348515 Test Loss: 0.1216410
Validation loss decreased (0.035129 --> 0.034851).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0961893
	speed: 0.0600s/iter; left time: 472.9703s
	iters: 200, epoch: 7 | loss: 0.1358449
	speed: 0.0186s/iter; left time: 144.5508s
	iters: 300, epoch: 7 | loss: 0.1310754
	speed: 0.0185s/iter; left time: 142.2689s
	iters: 400, epoch: 7 | loss: 0.1342554
	speed: 0.0186s/iter; left time: 140.6454s
	iters: 500, epoch: 7 | loss: 0.1742030
	speed: 0.0186s/iter; left time: 138.7958s
Epoch: 7 cost time: 10.856202125549316
Epoch: 7, Steps: 570 | Train Loss: 0.1236303 Vali Loss: 0.0349391 Test Loss: 0.1203975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1173634
	speed: 0.0549s/iter; left time: 401.3803s
	iters: 200, epoch: 8 | loss: 0.0968303
	speed: 0.0187s/iter; left time: 135.0491s
	iters: 300, epoch: 8 | loss: 0.0950346
	speed: 0.0187s/iter; left time: 132.9497s
	iters: 400, epoch: 8 | loss: 0.1503787
	speed: 0.0187s/iter; left time: 131.0872s
	iters: 500, epoch: 8 | loss: 0.0932398
	speed: 0.0186s/iter; left time: 128.8500s
Epoch: 8 cost time: 10.922219276428223
Epoch: 8, Steps: 570 | Train Loss: 0.1230835 Vali Loss: 0.0348350 Test Loss: 0.1202207
Validation loss decreased (0.034851 --> 0.034835).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0810930
	speed: 0.0558s/iter; left time: 376.3928s
	iters: 200, epoch: 9 | loss: 0.1697227
	speed: 0.0185s/iter; left time: 123.0317s
	iters: 300, epoch: 9 | loss: 0.0800193
	speed: 0.0185s/iter; left time: 121.0212s
	iters: 400, epoch: 9 | loss: 0.1001454
	speed: 0.0186s/iter; left time: 120.0662s
	iters: 500, epoch: 9 | loss: 0.0645827
	speed: 0.0186s/iter; left time: 118.1089s
Epoch: 9 cost time: 10.854018449783325
Epoch: 9, Steps: 570 | Train Loss: 0.1228311 Vali Loss: 0.0350171 Test Loss: 0.1199624
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1279257
	speed: 0.0558s/iter; left time: 344.3900s
	iters: 200, epoch: 10 | loss: 0.1399926
	speed: 0.0187s/iter; left time: 113.7350s
	iters: 300, epoch: 10 | loss: 0.0904599
	speed: 0.0187s/iter; left time: 111.5358s
	iters: 400, epoch: 10 | loss: 0.1062682
	speed: 0.0187s/iter; left time: 109.6424s
	iters: 500, epoch: 10 | loss: 0.1082861
	speed: 0.0187s/iter; left time: 107.9367s
Epoch: 10 cost time: 10.951215028762817
Epoch: 10, Steps: 570 | Train Loss: 0.1224287 Vali Loss: 0.0346467 Test Loss: 0.1207519
Validation loss decreased (0.034835 --> 0.034647).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1097813
	speed: 0.0565s/iter; left time: 316.6498s
	iters: 200, epoch: 11 | loss: 0.1797248
	speed: 0.0186s/iter; left time: 102.0699s
	iters: 300, epoch: 11 | loss: 0.1089150
	speed: 0.0186s/iter; left time: 100.3037s
	iters: 400, epoch: 11 | loss: 0.0766252
	speed: 0.0186s/iter; left time: 98.4168s
	iters: 500, epoch: 11 | loss: 0.1812996
	speed: 0.0185s/iter; left time: 96.4273s
Epoch: 11 cost time: 10.860699892044067
Epoch: 11, Steps: 570 | Train Loss: 0.1225361 Vali Loss: 0.0347175 Test Loss: 0.1206732
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1092781
	speed: 0.0581s/iter; left time: 292.3518s
	iters: 200, epoch: 12 | loss: 0.1323999
	speed: 0.0187s/iter; left time: 92.1682s
	iters: 300, epoch: 12 | loss: 0.0689266
	speed: 0.0187s/iter; left time: 90.2303s
	iters: 400, epoch: 12 | loss: 0.1341790
	speed: 0.0187s/iter; left time: 88.3085s
	iters: 500, epoch: 12 | loss: 0.1126035
	speed: 0.0187s/iter; left time: 86.4607s
Epoch: 12 cost time: 10.906403303146362
Epoch: 12, Steps: 570 | Train Loss: 0.1226761 Vali Loss: 0.0345742 Test Loss: 0.1206448
Validation loss decreased (0.034647 --> 0.034574).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1307561
	speed: 0.0573s/iter; left time: 255.6728s
	iters: 200, epoch: 13 | loss: 0.1051752
	speed: 0.0187s/iter; left time: 81.7069s
	iters: 300, epoch: 13 | loss: 0.1009801
	speed: 0.0186s/iter; left time: 79.4130s
	iters: 400, epoch: 13 | loss: 0.0950372
	speed: 0.0187s/iter; left time: 77.7518s
	iters: 500, epoch: 13 | loss: 0.1825068
	speed: 0.0187s/iter; left time: 75.8951s
Epoch: 13 cost time: 10.927869081497192
Epoch: 13, Steps: 570 | Train Loss: 0.1217264 Vali Loss: 0.0346610 Test Loss: 0.1205635
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0927252
	speed: 0.0564s/iter; left time: 219.5535s
	iters: 200, epoch: 14 | loss: 0.0829122
	speed: 0.0186s/iter; left time: 70.6327s
	iters: 300, epoch: 14 | loss: 0.1211418
	speed: 0.0185s/iter; left time: 68.1881s
	iters: 400, epoch: 14 | loss: 0.1085075
	speed: 0.0185s/iter; left time: 66.5552s
	iters: 500, epoch: 14 | loss: 0.1663618
	speed: 0.0185s/iter; left time: 64.5847s
Epoch: 14 cost time: 10.912145614624023
Epoch: 14, Steps: 570 | Train Loss: 0.1223126 Vali Loss: 0.0347010 Test Loss: 0.1205924
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.0744673
	speed: 0.0582s/iter; left time: 193.2680s
	iters: 200, epoch: 15 | loss: 0.1225159
	speed: 0.0187s/iter; left time: 60.1529s
	iters: 300, epoch: 15 | loss: 0.0960377
	speed: 0.0186s/iter; left time: 58.0989s
	iters: 400, epoch: 15 | loss: 0.1466675
	speed: 0.0187s/iter; left time: 56.4494s
	iters: 500, epoch: 15 | loss: 0.1094004
	speed: 0.0186s/iter; left time: 54.3426s
Epoch: 15 cost time: 10.913602352142334
Epoch: 15, Steps: 570 | Train Loss: 0.1223412 Vali Loss: 0.0346324 Test Loss: 0.1206264
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1208055168390274, mae:0.21598626673221588
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3847196
	speed: 0.0297s/iter; left time: 335.7955s
	iters: 200, epoch: 1 | loss: 0.1989159
	speed: 0.0182s/iter; left time: 203.8501s
	iters: 300, epoch: 1 | loss: 0.1971601
	speed: 0.0182s/iter; left time: 201.8805s
	iters: 400, epoch: 1 | loss: 0.1440938
	speed: 0.0182s/iter; left time: 200.0072s
	iters: 500, epoch: 1 | loss: 0.2128971
	speed: 0.0182s/iter; left time: 198.3655s
Epoch: 1 cost time: 11.58071517944336
Epoch: 1, Steps: 570 | Train Loss: 0.1825047 Vali Loss: 0.0356258 Test Loss: 0.1134578
Validation loss decreased (inf --> 0.035626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1396966
	speed: 0.0582s/iter; left time: 624.2412s
	iters: 200, epoch: 2 | loss: 0.2030740
	speed: 0.0182s/iter; left time: 193.9053s
	iters: 300, epoch: 2 | loss: 0.1893833
	speed: 0.0182s/iter; left time: 191.3504s
	iters: 400, epoch: 2 | loss: 0.1223289
	speed: 0.0181s/iter; left time: 188.8583s
	iters: 500, epoch: 2 | loss: 0.1044574
	speed: 0.0181s/iter; left time: 187.0559s
Epoch: 2 cost time: 10.66267466545105
Epoch: 2, Steps: 570 | Train Loss: 0.1498083 Vali Loss: 0.0350216 Test Loss: 0.1101953
Validation loss decreased (0.035626 --> 0.035022).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0859063
	speed: 0.0574s/iter; left time: 582.9142s
	iters: 200, epoch: 3 | loss: 0.1234981
	speed: 0.0182s/iter; left time: 183.3296s
	iters: 300, epoch: 3 | loss: 0.1394759
	speed: 0.0182s/iter; left time: 181.6225s
	iters: 400, epoch: 3 | loss: 0.1237412
	speed: 0.0182s/iter; left time: 179.4881s
	iters: 500, epoch: 3 | loss: 0.1110266
	speed: 0.0182s/iter; left time: 177.6329s
Epoch: 3 cost time: 10.648946762084961
Epoch: 3, Steps: 570 | Train Loss: 0.1336981 Vali Loss: 0.0334302 Test Loss: 0.1088812
Validation loss decreased (0.035022 --> 0.033430).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1316584
	speed: 0.0594s/iter; left time: 569.4281s
	iters: 200, epoch: 4 | loss: 0.0832696
	speed: 0.0187s/iter; left time: 177.3288s
	iters: 300, epoch: 4 | loss: 0.1686378
	speed: 0.0182s/iter; left time: 171.2950s
	iters: 400, epoch: 4 | loss: 0.1234927
	speed: 0.0182s/iter; left time: 169.1957s
	iters: 500, epoch: 4 | loss: 0.1014236
	speed: 0.0182s/iter; left time: 167.2627s
Epoch: 4 cost time: 10.91895341873169
Epoch: 4, Steps: 570 | Train Loss: 0.1239407 Vali Loss: 0.0317841 Test Loss: 0.1084288
Validation loss decreased (0.033430 --> 0.031784).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0984245
	speed: 0.0550s/iter; left time: 495.8276s
	iters: 200, epoch: 5 | loss: 0.1071849
	speed: 0.0182s/iter; left time: 162.2432s
	iters: 300, epoch: 5 | loss: 0.1203405
	speed: 0.0182s/iter; left time: 160.6381s
	iters: 400, epoch: 5 | loss: 0.1267540
	speed: 0.0182s/iter; left time: 158.9731s
	iters: 500, epoch: 5 | loss: 0.1044165
	speed: 0.0182s/iter; left time: 157.1797s
Epoch: 5 cost time: 10.683056354522705
Epoch: 5, Steps: 570 | Train Loss: 0.1184903 Vali Loss: 0.0319481 Test Loss: 0.1089144
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1653547
	speed: 0.0576s/iter; left time: 486.7017s
	iters: 200, epoch: 6 | loss: 0.0927161
	speed: 0.0183s/iter; left time: 152.5890s
	iters: 300, epoch: 6 | loss: 0.1343766
	speed: 0.0183s/iter; left time: 150.8955s
	iters: 400, epoch: 6 | loss: 0.0845097
	speed: 0.0182s/iter; left time: 148.6313s
	iters: 500, epoch: 6 | loss: 0.0728186
	speed: 0.0182s/iter; left time: 146.7543s
Epoch: 6 cost time: 10.731748342514038
Epoch: 6, Steps: 570 | Train Loss: 0.1161634 Vali Loss: 0.0314554 Test Loss: 0.1089152
Validation loss decreased (0.031784 --> 0.031455).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1205332
	speed: 0.0577s/iter; left time: 454.6186s
	iters: 200, epoch: 7 | loss: 0.1601523
	speed: 0.0183s/iter; left time: 142.4152s
	iters: 300, epoch: 7 | loss: 0.0827276
	speed: 0.0183s/iter; left time: 140.4818s
	iters: 400, epoch: 7 | loss: 0.1225206
	speed: 0.0182s/iter; left time: 138.3121s
	iters: 500, epoch: 7 | loss: 0.0939513
	speed: 0.0183s/iter; left time: 136.6426s
Epoch: 7 cost time: 10.714097499847412
Epoch: 7, Steps: 570 | Train Loss: 0.1140560 Vali Loss: 0.0314774 Test Loss: 0.1093833
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0813401
	speed: 0.0561s/iter; left time: 410.2226s
	iters: 200, epoch: 8 | loss: 0.0968648
	speed: 0.0182s/iter; left time: 130.9620s
	iters: 300, epoch: 8 | loss: 0.1148806
	speed: 0.0182s/iter; left time: 129.1771s
	iters: 400, epoch: 8 | loss: 0.1035178
	speed: 0.0181s/iter; left time: 126.9936s
	iters: 500, epoch: 8 | loss: 0.1377087
	speed: 0.0181s/iter; left time: 125.0032s
Epoch: 8 cost time: 10.579122543334961
Epoch: 8, Steps: 570 | Train Loss: 0.1131360 Vali Loss: 0.0315018 Test Loss: 0.1090401
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0662846
	speed: 0.0587s/iter; left time: 395.3889s
	iters: 200, epoch: 9 | loss: 0.0926176
	speed: 0.0205s/iter; left time: 135.8190s
	iters: 300, epoch: 9 | loss: 0.1140424
	speed: 0.0205s/iter; left time: 134.0146s
	iters: 400, epoch: 9 | loss: 0.1118420
	speed: 0.0204s/iter; left time: 131.4248s
	iters: 500, epoch: 9 | loss: 0.0876799
	speed: 0.0205s/iter; left time: 129.7779s
Epoch: 9 cost time: 11.931885957717896
Epoch: 9, Steps: 570 | Train Loss: 0.1132773 Vali Loss: 0.0314580 Test Loss: 0.1089168
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10906100273132324, mae:0.20073860883712769
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2622037
	speed: 0.0326s/iter; left time: 368.0577s
	iters: 200, epoch: 1 | loss: 0.1800064
	speed: 0.0207s/iter; left time: 231.3811s
	iters: 300, epoch: 1 | loss: 0.2144991
	speed: 0.0206s/iter; left time: 229.2005s
	iters: 400, epoch: 1 | loss: 0.2300204
	speed: 0.0196s/iter; left time: 215.4945s
	iters: 500, epoch: 1 | loss: 0.3149802
	speed: 0.0185s/iter; left time: 201.6557s
Epoch: 1 cost time: 12.53683066368103
Epoch: 1, Steps: 570 | Train Loss: 0.2178458 Vali Loss: 0.0412033 Test Loss: 0.1345358
Validation loss decreased (inf --> 0.041203).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2365496
	speed: 0.0597s/iter; left time: 640.3960s
	iters: 200, epoch: 2 | loss: 0.2591004
	speed: 0.0213s/iter; left time: 226.6610s
	iters: 300, epoch: 2 | loss: 0.3177629
	speed: 0.0212s/iter; left time: 223.4036s
	iters: 400, epoch: 2 | loss: 0.1723979
	speed: 0.0212s/iter; left time: 221.5476s
	iters: 500, epoch: 2 | loss: 0.0800868
	speed: 0.0212s/iter; left time: 218.9512s
Epoch: 2 cost time: 12.421179056167603
Epoch: 2, Steps: 570 | Train Loss: 0.1743670 Vali Loss: 0.0447428 Test Loss: 0.1367654
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1199422
	speed: 0.0613s/iter; left time: 623.1216s
	iters: 200, epoch: 3 | loss: 0.1599562
	speed: 0.0182s/iter; left time: 182.8351s
	iters: 300, epoch: 3 | loss: 0.1599515
	speed: 0.0182s/iter; left time: 181.3097s
	iters: 400, epoch: 3 | loss: 0.1801567
	speed: 0.0182s/iter; left time: 179.6543s
	iters: 500, epoch: 3 | loss: 0.1400699
	speed: 0.0182s/iter; left time: 177.9144s
Epoch: 3 cost time: 10.67023777961731
Epoch: 3, Steps: 570 | Train Loss: 0.1508053 Vali Loss: 0.0413297 Test Loss: 0.1289753
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1095312
	speed: 0.0570s/iter; left time: 546.7607s
	iters: 200, epoch: 4 | loss: 0.1352073
	speed: 0.0182s/iter; left time: 173.1652s
	iters: 300, epoch: 4 | loss: 0.1411973
	speed: 0.0182s/iter; left time: 171.1044s
	iters: 400, epoch: 4 | loss: 0.1697282
	speed: 0.0182s/iter; left time: 169.5168s
	iters: 500, epoch: 4 | loss: 0.0927050
	speed: 0.0182s/iter; left time: 167.4862s
Epoch: 4 cost time: 10.662667036056519
Epoch: 4, Steps: 570 | Train Loss: 0.1389273 Vali Loss: 0.0384533 Test Loss: 0.1248211
Validation loss decreased (0.041203 --> 0.038453).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1008001
	speed: 0.0560s/iter; left time: 505.1199s
	iters: 200, epoch: 5 | loss: 0.1308750
	speed: 0.0183s/iter; left time: 163.2790s
	iters: 300, epoch: 5 | loss: 0.1068856
	speed: 0.0183s/iter; left time: 161.4229s
	iters: 400, epoch: 5 | loss: 0.1131738
	speed: 0.0183s/iter; left time: 159.7989s
	iters: 500, epoch: 5 | loss: 0.0717618
	speed: 0.0183s/iter; left time: 157.8891s
Epoch: 5 cost time: 10.738748788833618
Epoch: 5, Steps: 570 | Train Loss: 0.1323583 Vali Loss: 0.0376206 Test Loss: 0.1269149
Validation loss decreased (0.038453 --> 0.037621).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1632042
	speed: 0.0575s/iter; left time: 485.7453s
	iters: 200, epoch: 6 | loss: 0.1068073
	speed: 0.0183s/iter; left time: 153.0845s
	iters: 300, epoch: 6 | loss: 0.2113397
	speed: 0.0183s/iter; left time: 151.1871s
	iters: 400, epoch: 6 | loss: 0.1107387
	speed: 0.0183s/iter; left time: 149.4178s
	iters: 500, epoch: 6 | loss: 0.1167599
	speed: 0.0183s/iter; left time: 147.5590s
Epoch: 6 cost time: 10.758628368377686
Epoch: 6, Steps: 570 | Train Loss: 0.1287186 Vali Loss: 0.0375797 Test Loss: 0.1266044
Validation loss decreased (0.037621 --> 0.037580).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1238780
	speed: 0.0617s/iter; left time: 486.2009s
	iters: 200, epoch: 7 | loss: 0.1068896
	speed: 0.0198s/iter; left time: 154.0622s
	iters: 300, epoch: 7 | loss: 0.1458076
	speed: 0.0183s/iter; left time: 140.7225s
	iters: 400, epoch: 7 | loss: 0.1221422
	speed: 0.0184s/iter; left time: 139.8128s
	iters: 500, epoch: 7 | loss: 0.0889262
	speed: 0.0184s/iter; left time: 137.5455s
Epoch: 7 cost time: 11.16085171699524
Epoch: 7, Steps: 570 | Train Loss: 0.1286428 Vali Loss: 0.0375248 Test Loss: 0.1260683
Validation loss decreased (0.037580 --> 0.037525).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1094912
	speed: 0.0565s/iter; left time: 412.8795s
	iters: 200, epoch: 8 | loss: 0.0991819
	speed: 0.0184s/iter; left time: 132.3943s
	iters: 300, epoch: 8 | loss: 0.1341850
	speed: 0.0184s/iter; left time: 130.6105s
	iters: 400, epoch: 8 | loss: 0.1574862
	speed: 0.0183s/iter; left time: 128.5812s
	iters: 500, epoch: 8 | loss: 0.1078135
	speed: 0.0183s/iter; left time: 126.7123s
Epoch: 8 cost time: 10.758219718933105
Epoch: 8, Steps: 570 | Train Loss: 0.1276205 Vali Loss: 0.0374951 Test Loss: 0.1265586
Validation loss decreased (0.037525 --> 0.037495).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1345530
	speed: 0.0555s/iter; left time: 374.1753s
	iters: 200, epoch: 9 | loss: 0.1701355
	speed: 0.0183s/iter; left time: 121.6919s
	iters: 300, epoch: 9 | loss: 0.1660757
	speed: 0.0183s/iter; left time: 119.7592s
	iters: 400, epoch: 9 | loss: 0.2267914
	speed: 0.0183s/iter; left time: 117.8966s
	iters: 500, epoch: 9 | loss: 0.0914125
	speed: 0.0183s/iter; left time: 116.1973s
Epoch: 9 cost time: 10.741132497787476
Epoch: 9, Steps: 570 | Train Loss: 0.1275924 Vali Loss: 0.0375651 Test Loss: 0.1264918
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1320315
	speed: 0.0567s/iter; left time: 349.8703s
	iters: 200, epoch: 10 | loss: 0.1074320
	speed: 0.0184s/iter; left time: 111.5362s
	iters: 300, epoch: 10 | loss: 0.1262881
	speed: 0.0184s/iter; left time: 109.7384s
	iters: 400, epoch: 10 | loss: 0.1170432
	speed: 0.0184s/iter; left time: 107.8640s
	iters: 500, epoch: 10 | loss: 0.1459234
	speed: 0.0183s/iter; left time: 105.8577s
Epoch: 10 cost time: 10.737431049346924
Epoch: 10, Steps: 570 | Train Loss: 0.1270538 Vali Loss: 0.0372558 Test Loss: 0.1263026
Validation loss decreased (0.037495 --> 0.037256).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1405462
	speed: 0.0559s/iter; left time: 313.0922s
	iters: 200, epoch: 11 | loss: 0.1231383
	speed: 0.0183s/iter; left time: 100.7084s
	iters: 300, epoch: 11 | loss: 0.1248415
	speed: 0.0183s/iter; left time: 98.8910s
	iters: 400, epoch: 11 | loss: 0.1385459
	speed: 0.0184s/iter; left time: 97.3379s
	iters: 500, epoch: 11 | loss: 0.1068804
	speed: 0.0184s/iter; left time: 95.4418s
Epoch: 11 cost time: 10.755859136581421
Epoch: 11, Steps: 570 | Train Loss: 0.1275050 Vali Loss: 0.0372520 Test Loss: 0.1262792
Validation loss decreased (0.037256 --> 0.037252).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1180813
	speed: 0.0605s/iter; left time: 304.3307s
	iters: 200, epoch: 12 | loss: 0.1363812
	speed: 0.0212s/iter; left time: 104.3885s
	iters: 300, epoch: 12 | loss: 0.1083949
	speed: 0.0211s/iter; left time: 102.1393s
	iters: 400, epoch: 12 | loss: 0.0979449
	speed: 0.0211s/iter; left time: 99.9010s
	iters: 500, epoch: 12 | loss: 0.1293892
	speed: 0.0212s/iter; left time: 98.3552s
Epoch: 12 cost time: 12.382421493530273
Epoch: 12, Steps: 570 | Train Loss: 0.1270305 Vali Loss: 0.0372749 Test Loss: 0.1262751
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1076863
	speed: 0.0604s/iter; left time: 269.2761s
	iters: 200, epoch: 13 | loss: 0.0892995
	speed: 0.0211s/iter; left time: 92.0183s
	iters: 300, epoch: 13 | loss: 0.1081605
	speed: 0.0211s/iter; left time: 89.8865s
	iters: 400, epoch: 13 | loss: 0.0759180
	speed: 0.0211s/iter; left time: 87.9048s
	iters: 500, epoch: 13 | loss: 0.1010875
	speed: 0.0211s/iter; left time: 85.6117s
Epoch: 13 cost time: 12.362730741500854
Epoch: 13, Steps: 570 | Train Loss: 0.1264350 Vali Loss: 0.0374249 Test Loss: 0.1263012
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0805550
	speed: 0.0627s/iter; left time: 244.0920s
	iters: 200, epoch: 14 | loss: 0.0965289
	speed: 0.0212s/iter; left time: 80.2055s
	iters: 300, epoch: 14 | loss: 0.1239678
	speed: 0.0212s/iter; left time: 78.0799s
	iters: 400, epoch: 14 | loss: 0.1377636
	speed: 0.0211s/iter; left time: 75.9428s
	iters: 500, epoch: 14 | loss: 0.1081927
	speed: 0.0211s/iter; left time: 73.8334s
Epoch: 14 cost time: 12.3464834690094
Epoch: 14, Steps: 570 | Train Loss: 0.1268316 Vali Loss: 0.0373815 Test Loss: 0.1263072
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1264682114124298, mae:0.22387194633483887
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2027539
	speed: 0.0341s/iter; left time: 385.5615s
	iters: 200, epoch: 1 | loss: 0.1669776
	speed: 0.0220s/iter; left time: 246.5837s
	iters: 300, epoch: 1 | loss: 0.1981617
	speed: 0.0220s/iter; left time: 244.5813s
	iters: 400, epoch: 1 | loss: 0.2945663
	speed: 0.0220s/iter; left time: 241.9595s
	iters: 500, epoch: 1 | loss: 0.2654594
	speed: 0.0221s/iter; left time: 240.8377s
Epoch: 1 cost time: 13.819376707077026
Epoch: 1, Steps: 570 | Train Loss: 0.2067640 Vali Loss: 0.0437287 Test Loss: 0.1357310
Validation loss decreased (inf --> 0.043729).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2346632
	speed: 0.0635s/iter; left time: 681.6570s
	iters: 200, epoch: 2 | loss: 0.1298181
	speed: 0.0221s/iter; left time: 234.7835s
	iters: 300, epoch: 2 | loss: 0.1294292
	speed: 0.0221s/iter; left time: 232.5997s
	iters: 400, epoch: 2 | loss: 0.1555942
	speed: 0.0221s/iter; left time: 230.2525s
	iters: 500, epoch: 2 | loss: 0.1474744
	speed: 0.0221s/iter; left time: 228.2132s
Epoch: 2 cost time: 12.929855108261108
Epoch: 2, Steps: 570 | Train Loss: 0.1592953 Vali Loss: 0.0386249 Test Loss: 0.1238144
Validation loss decreased (0.043729 --> 0.038625).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2576421
	speed: 0.0641s/iter; left time: 650.8554s
	iters: 200, epoch: 3 | loss: 0.1106855
	speed: 0.0221s/iter; left time: 222.1966s
	iters: 300, epoch: 3 | loss: 0.1619062
	speed: 0.0221s/iter; left time: 219.9812s
	iters: 400, epoch: 3 | loss: 0.1001397
	speed: 0.0221s/iter; left time: 217.6827s
	iters: 500, epoch: 3 | loss: 0.0994980
	speed: 0.0221s/iter; left time: 215.7020s
Epoch: 3 cost time: 12.896713733673096
Epoch: 3, Steps: 570 | Train Loss: 0.1308025 Vali Loss: 0.0353702 Test Loss: 0.1231166
Validation loss decreased (0.038625 --> 0.035370).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1022077
	speed: 0.0661s/iter; left time: 634.1011s
	iters: 200, epoch: 4 | loss: 0.0759279
	speed: 0.0222s/iter; left time: 210.5675s
	iters: 300, epoch: 4 | loss: 0.1092489
	speed: 0.0222s/iter; left time: 208.5418s
	iters: 400, epoch: 4 | loss: 0.0982543
	speed: 0.0222s/iter; left time: 206.2838s
	iters: 500, epoch: 4 | loss: 0.1520389
	speed: 0.0222s/iter; left time: 204.0266s
Epoch: 4 cost time: 13.118576526641846
Epoch: 4, Steps: 570 | Train Loss: 0.1136707 Vali Loss: 0.0346266 Test Loss: 0.1269748
Validation loss decreased (0.035370 --> 0.034627).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1267427
	speed: 0.0638s/iter; left time: 575.6996s
	iters: 200, epoch: 5 | loss: 0.1023141
	speed: 0.0220s/iter; left time: 196.5982s
	iters: 300, epoch: 5 | loss: 0.0798481
	speed: 0.0220s/iter; left time: 194.3547s
	iters: 400, epoch: 5 | loss: 0.0946030
	speed: 0.0220s/iter; left time: 191.9657s
	iters: 500, epoch: 5 | loss: 0.0963447
	speed: 0.0220s/iter; left time: 189.7018s
Epoch: 5 cost time: 12.883232593536377
Epoch: 5, Steps: 570 | Train Loss: 0.1071186 Vali Loss: 0.0336836 Test Loss: 0.1273362
Validation loss decreased (0.034627 --> 0.033684).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0972172
	speed: 0.0665s/iter; left time: 562.0284s
	iters: 200, epoch: 6 | loss: 0.1180001
	speed: 0.0220s/iter; left time: 183.4606s
	iters: 300, epoch: 6 | loss: 0.0808669
	speed: 0.0220s/iter; left time: 181.3414s
	iters: 400, epoch: 6 | loss: 0.0732322
	speed: 0.0220s/iter; left time: 179.0073s
	iters: 500, epoch: 6 | loss: 0.1540477
	speed: 0.0220s/iter; left time: 176.8477s
Epoch: 6 cost time: 12.840306758880615
Epoch: 6, Steps: 570 | Train Loss: 0.1037475 Vali Loss: 0.0350687 Test Loss: 0.1272723
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1238752
	speed: 0.0644s/iter; left time: 507.7554s
	iters: 200, epoch: 7 | loss: 0.1158283
	speed: 0.0229s/iter; left time: 177.8985s
	iters: 300, epoch: 7 | loss: 0.0841666
	speed: 0.0223s/iter; left time: 171.6560s
	iters: 400, epoch: 7 | loss: 0.0927563
	speed: 0.0221s/iter; left time: 167.7603s
	iters: 500, epoch: 7 | loss: 0.1020523
	speed: 0.0221s/iter; left time: 165.5209s
Epoch: 7 cost time: 13.180501461029053
Epoch: 7, Steps: 570 | Train Loss: 0.1008883 Vali Loss: 0.0350252 Test Loss: 0.1266070
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1005726
	speed: 0.0642s/iter; left time: 469.0356s
	iters: 200, epoch: 8 | loss: 0.2125474
	speed: 0.0240s/iter; left time: 173.1768s
	iters: 300, epoch: 8 | loss: 0.0797290
	speed: 0.0240s/iter; left time: 170.6309s
	iters: 400, epoch: 8 | loss: 0.0906385
	speed: 0.0240s/iter; left time: 168.2739s
	iters: 500, epoch: 8 | loss: 0.0828229
	speed: 0.0230s/iter; left time: 158.7859s
Epoch: 8 cost time: 13.750190019607544
Epoch: 8, Steps: 570 | Train Loss: 0.1002590 Vali Loss: 0.0339656 Test Loss: 0.1274215
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12748165428638458, mae:0.22400608658790588
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1785491
	speed: 0.0331s/iter; left time: 373.8398s
	iters: 200, epoch: 1 | loss: 0.1034653
	speed: 0.0213s/iter; left time: 238.1668s
	iters: 300, epoch: 1 | loss: 0.1610785
	speed: 0.0213s/iter; left time: 235.9638s
	iters: 400, epoch: 1 | loss: 0.1331869
	speed: 0.0213s/iter; left time: 234.1018s
	iters: 500, epoch: 1 | loss: 0.1715312
	speed: 0.0213s/iter; left time: 232.0509s
Epoch: 1 cost time: 13.361382007598877
Epoch: 1, Steps: 570 | Train Loss: 0.1773544 Vali Loss: 0.0365672 Test Loss: 0.1138351
Validation loss decreased (inf --> 0.036567).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1486347
	speed: 0.0620s/iter; left time: 665.7714s
	iters: 200, epoch: 2 | loss: 0.1087361
	speed: 0.0213s/iter; left time: 226.5467s
	iters: 300, epoch: 2 | loss: 0.1416785
	speed: 0.0213s/iter; left time: 224.3477s
	iters: 400, epoch: 2 | loss: 0.1260082
	speed: 0.0213s/iter; left time: 222.2356s
	iters: 500, epoch: 2 | loss: 0.0900498
	speed: 0.0213s/iter; left time: 220.2472s
Epoch: 2 cost time: 12.46543836593628
Epoch: 2, Steps: 570 | Train Loss: 0.1427053 Vali Loss: 0.0326686 Test Loss: 0.1104448
Validation loss decreased (0.036567 --> 0.032669).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1181588
	speed: 0.0628s/iter; left time: 638.0728s
	iters: 200, epoch: 3 | loss: 0.1013483
	speed: 0.0214s/iter; left time: 215.1717s
	iters: 300, epoch: 3 | loss: 0.1209200
	speed: 0.0214s/iter; left time: 213.1776s
	iters: 400, epoch: 3 | loss: 0.0976466
	speed: 0.0214s/iter; left time: 210.9697s
	iters: 500, epoch: 3 | loss: 0.1044774
	speed: 0.0214s/iter; left time: 208.8784s
Epoch: 3 cost time: 12.50110149383545
Epoch: 3, Steps: 570 | Train Loss: 0.1186728 Vali Loss: 0.0319777 Test Loss: 0.1122661
Validation loss decreased (0.032669 --> 0.031978).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0921805
	speed: 0.0616s/iter; left time: 590.6133s
	iters: 200, epoch: 4 | loss: 0.1141695
	speed: 0.0214s/iter; left time: 203.3073s
	iters: 300, epoch: 4 | loss: 0.1044969
	speed: 0.0214s/iter; left time: 201.0543s
	iters: 400, epoch: 4 | loss: 0.1281468
	speed: 0.0214s/iter; left time: 198.6277s
	iters: 500, epoch: 4 | loss: 0.0988808
	speed: 0.0214s/iter; left time: 196.5577s
Epoch: 4 cost time: 12.500771045684814
Epoch: 4, Steps: 570 | Train Loss: 0.1057914 Vali Loss: 0.0311259 Test Loss: 0.1089387
Validation loss decreased (0.031978 --> 0.031126).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1255900
	speed: 0.0619s/iter; left time: 558.7027s
	iters: 200, epoch: 5 | loss: 0.0753093
	speed: 0.0214s/iter; left time: 190.9318s
	iters: 300, epoch: 5 | loss: 0.0820977
	speed: 0.0214s/iter; left time: 188.7971s
	iters: 400, epoch: 5 | loss: 0.1364666
	speed: 0.0214s/iter; left time: 186.6594s
	iters: 500, epoch: 5 | loss: 0.0913140
	speed: 0.0214s/iter; left time: 184.2951s
Epoch: 5 cost time: 12.529300689697266
Epoch: 5, Steps: 570 | Train Loss: 0.0997650 Vali Loss: 0.0314607 Test Loss: 0.1088687
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0785641
	speed: 0.0609s/iter; left time: 514.3819s
	iters: 200, epoch: 6 | loss: 0.1225024
	speed: 0.0213s/iter; left time: 178.1248s
	iters: 300, epoch: 6 | loss: 0.1325319
	speed: 0.0213s/iter; left time: 176.0816s
	iters: 400, epoch: 6 | loss: 0.0782834
	speed: 0.0213s/iter; left time: 173.9651s
	iters: 500, epoch: 6 | loss: 0.0707568
	speed: 0.0213s/iter; left time: 171.6843s
Epoch: 6 cost time: 12.468377113342285
Epoch: 6, Steps: 570 | Train Loss: 0.0953235 Vali Loss: 0.0311220 Test Loss: 0.1090435
Validation loss decreased (0.031126 --> 0.031122).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0702489
	speed: 0.0614s/iter; left time: 483.8419s
	iters: 200, epoch: 7 | loss: 0.1165190
	speed: 0.0214s/iter; left time: 166.1771s
	iters: 300, epoch: 7 | loss: 0.1115409
	speed: 0.0213s/iter; left time: 163.7164s
	iters: 400, epoch: 7 | loss: 0.0763219
	speed: 0.0214s/iter; left time: 161.8868s
	iters: 500, epoch: 7 | loss: 0.1219211
	speed: 0.0213s/iter; left time: 159.4680s
Epoch: 7 cost time: 12.47177505493164
Epoch: 7, Steps: 570 | Train Loss: 0.0939907 Vali Loss: 0.0313113 Test Loss: 0.1090514
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0761810
	speed: 0.0622s/iter; left time: 454.6373s
	iters: 200, epoch: 8 | loss: 0.0958735
	speed: 0.0214s/iter; left time: 154.1427s
	iters: 300, epoch: 8 | loss: 0.0982624
	speed: 0.0214s/iter; left time: 152.0230s
	iters: 400, epoch: 8 | loss: 0.0802097
	speed: 0.0214s/iter; left time: 149.9926s
	iters: 500, epoch: 8 | loss: 0.1419071
	speed: 0.0214s/iter; left time: 147.6354s
Epoch: 8 cost time: 12.501315832138062
Epoch: 8, Steps: 570 | Train Loss: 0.0933016 Vali Loss: 0.0310123 Test Loss: 0.1087838
Validation loss decreased (0.031122 --> 0.031012).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0783801
	speed: 0.0620s/iter; left time: 418.0212s
	iters: 200, epoch: 9 | loss: 0.1293915
	speed: 0.0213s/iter; left time: 141.3672s
	iters: 300, epoch: 9 | loss: 0.1090923
	speed: 0.0213s/iter; left time: 139.1032s
	iters: 400, epoch: 9 | loss: 0.0697182
	speed: 0.0213s/iter; left time: 137.0775s
	iters: 500, epoch: 9 | loss: 0.0602542
	speed: 0.0213s/iter; left time: 135.0803s
Epoch: 9 cost time: 12.459821224212646
Epoch: 9, Steps: 570 | Train Loss: 0.0938148 Vali Loss: 0.0310205 Test Loss: 0.1087866
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0679607
	speed: 0.0610s/iter; left time: 376.3541s
	iters: 200, epoch: 10 | loss: 0.0885144
	speed: 0.0213s/iter; left time: 129.2535s
	iters: 300, epoch: 10 | loss: 0.0781095
	speed: 0.0213s/iter; left time: 127.0385s
	iters: 400, epoch: 10 | loss: 0.0953951
	speed: 0.0213s/iter; left time: 124.9052s
	iters: 500, epoch: 10 | loss: 0.1224032
	speed: 0.0213s/iter; left time: 122.7091s
Epoch: 10 cost time: 12.414680480957031
Epoch: 10, Steps: 570 | Train Loss: 0.0919785 Vali Loss: 0.0310270 Test Loss: 0.1089423
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0876282
	speed: 0.0608s/iter; left time: 340.2920s
	iters: 200, epoch: 11 | loss: 0.0823253
	speed: 0.0214s/iter; left time: 117.5756s
	iters: 300, epoch: 11 | loss: 0.0980454
	speed: 0.0214s/iter; left time: 115.4640s
	iters: 400, epoch: 11 | loss: 0.0720253
	speed: 0.0214s/iter; left time: 113.3886s
	iters: 500, epoch: 11 | loss: 0.1342674
	speed: 0.0214s/iter; left time: 111.1949s
Epoch: 11 cost time: 12.49315595626831
Epoch: 11, Steps: 570 | Train Loss: 0.0928769 Vali Loss: 0.0309564 Test Loss: 0.1089035
Validation loss decreased (0.031012 --> 0.030956).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0873149
	speed: 0.0636s/iter; left time: 320.1410s
	iters: 200, epoch: 12 | loss: 0.0897143
	speed: 0.0233s/iter; left time: 114.7311s
	iters: 300, epoch: 12 | loss: 0.0802560
	speed: 0.0233s/iter; left time: 112.3522s
	iters: 400, epoch: 12 | loss: 0.1330236
	speed: 0.0232s/iter; left time: 109.9764s
	iters: 500, epoch: 12 | loss: 0.1009890
	speed: 0.0232s/iter; left time: 107.6539s
Epoch: 12 cost time: 13.572937250137329
Epoch: 12, Steps: 570 | Train Loss: 0.0916396 Vali Loss: 0.0309637 Test Loss: 0.1088975
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0757189
	speed: 0.0641s/iter; left time: 285.9039s
	iters: 200, epoch: 13 | loss: 0.1029050
	speed: 0.0214s/iter; left time: 93.1421s
	iters: 300, epoch: 13 | loss: 0.1308431
	speed: 0.0214s/iter; left time: 90.9784s
	iters: 400, epoch: 13 | loss: 0.0862136
	speed: 0.0213s/iter; left time: 88.7805s
	iters: 500, epoch: 13 | loss: 0.0903103
	speed: 0.0212s/iter; left time: 86.1885s
Epoch: 13 cost time: 12.438134908676147
Epoch: 13, Steps: 570 | Train Loss: 0.0925450 Vali Loss: 0.0310434 Test Loss: 0.1089011
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0980130
	speed: 0.0599s/iter; left time: 232.9698s
	iters: 200, epoch: 14 | loss: 0.0712179
	speed: 0.0213s/iter; left time: 80.9185s
	iters: 300, epoch: 14 | loss: 0.0745564
	speed: 0.0213s/iter; left time: 78.7702s
	iters: 400, epoch: 14 | loss: 0.0895295
	speed: 0.0213s/iter; left time: 76.6383s
	iters: 500, epoch: 14 | loss: 0.1133360
	speed: 0.0213s/iter; left time: 74.4832s
Epoch: 14 cost time: 12.46585464477539
Epoch: 14, Steps: 570 | Train Loss: 0.0920662 Vali Loss: 0.0309956 Test Loss: 0.1088896
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1090446412563324, mae:0.20337125658988953
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2186458
	speed: 0.0344s/iter; left time: 388.5830s
	iters: 200, epoch: 1 | loss: 0.2041420
	speed: 0.0221s/iter; left time: 247.4437s
	iters: 300, epoch: 1 | loss: 0.1998271
	speed: 0.0221s/iter; left time: 245.3798s
	iters: 400, epoch: 1 | loss: 0.2263469
	speed: 0.0222s/iter; left time: 243.7532s
	iters: 500, epoch: 1 | loss: 0.2081954
	speed: 0.0207s/iter; left time: 225.9471s
Epoch: 1 cost time: 13.596477508544922
Epoch: 1, Steps: 570 | Train Loss: 0.2079525 Vali Loss: 0.0443054 Test Loss: 0.1338999
Validation loss decreased (inf --> 0.044305).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0878384
	speed: 0.0619s/iter; left time: 664.7139s
	iters: 200, epoch: 2 | loss: 0.2626744
	speed: 0.0222s/iter; left time: 235.8705s
	iters: 300, epoch: 2 | loss: 0.1360231
	speed: 0.0221s/iter; left time: 233.1601s
	iters: 400, epoch: 2 | loss: 0.1155632
	speed: 0.0222s/iter; left time: 231.1270s
	iters: 500, epoch: 2 | loss: 0.1218925
	speed: 0.0221s/iter; left time: 228.5851s
Epoch: 2 cost time: 12.948352813720703
Epoch: 2, Steps: 570 | Train Loss: 0.1629091 Vali Loss: 0.0399663 Test Loss: 0.1289942
Validation loss decreased (0.044305 --> 0.039966).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0891363
	speed: 0.0611s/iter; left time: 620.5207s
	iters: 200, epoch: 3 | loss: 0.1080725
	speed: 0.0202s/iter; left time: 202.9316s
	iters: 300, epoch: 3 | loss: 0.1031212
	speed: 0.0202s/iter; left time: 200.7370s
	iters: 400, epoch: 3 | loss: 0.1273677
	speed: 0.0201s/iter; left time: 198.4379s
	iters: 500, epoch: 3 | loss: 0.1084824
	speed: 0.0201s/iter; left time: 196.6093s
Epoch: 3 cost time: 11.797197341918945
Epoch: 3, Steps: 570 | Train Loss: 0.1317193 Vali Loss: 0.0394654 Test Loss: 0.1277618
Validation loss decreased (0.039966 --> 0.039465).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0673430
	speed: 0.0593s/iter; left time: 568.9870s
	iters: 200, epoch: 4 | loss: 0.1248085
	speed: 0.0200s/iter; left time: 189.8777s
	iters: 300, epoch: 4 | loss: 0.0912658
	speed: 0.0199s/iter; left time: 187.1494s
	iters: 400, epoch: 4 | loss: 0.1342447
	speed: 0.0199s/iter; left time: 185.1886s
	iters: 500, epoch: 4 | loss: 0.0975383
	speed: 0.0200s/iter; left time: 183.4233s
Epoch: 4 cost time: 11.685548067092896
Epoch: 4, Steps: 570 | Train Loss: 0.1173056 Vali Loss: 0.0376338 Test Loss: 0.1263050
Validation loss decreased (0.039465 --> 0.037634).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1109312
	speed: 0.0595s/iter; left time: 537.0247s
	iters: 200, epoch: 5 | loss: 0.1237783
	speed: 0.0200s/iter; left time: 178.3113s
	iters: 300, epoch: 5 | loss: 0.1165981
	speed: 0.0200s/iter; left time: 176.4705s
	iters: 400, epoch: 5 | loss: 0.0904403
	speed: 0.0200s/iter; left time: 174.5137s
	iters: 500, epoch: 5 | loss: 0.1135031
	speed: 0.0200s/iter; left time: 172.3141s
Epoch: 5 cost time: 11.701964378356934
Epoch: 5, Steps: 570 | Train Loss: 0.1088367 Vali Loss: 0.0365250 Test Loss: 0.1262030
Validation loss decreased (0.037634 --> 0.036525).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1269113
	speed: 0.0628s/iter; left time: 530.4114s
	iters: 200, epoch: 6 | loss: 0.1076501
	speed: 0.0201s/iter; left time: 167.9921s
	iters: 300, epoch: 6 | loss: 0.1019956
	speed: 0.0201s/iter; left time: 165.9485s
	iters: 400, epoch: 6 | loss: 0.0877422
	speed: 0.0201s/iter; left time: 163.7794s
	iters: 500, epoch: 6 | loss: 0.1660132
	speed: 0.0201s/iter; left time: 161.9634s
Epoch: 6 cost time: 11.798437118530273
Epoch: 6, Steps: 570 | Train Loss: 0.1055819 Vali Loss: 0.0368312 Test Loss: 0.1275319
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1239618
	speed: 0.0625s/iter; left time: 492.8356s
	iters: 200, epoch: 7 | loss: 0.1024051
	speed: 0.0201s/iter; left time: 156.0298s
	iters: 300, epoch: 7 | loss: 0.1231804
	speed: 0.0200s/iter; left time: 153.9803s
	iters: 400, epoch: 7 | loss: 0.0943301
	speed: 0.0200s/iter; left time: 151.8990s
	iters: 500, epoch: 7 | loss: 0.0661685
	speed: 0.0200s/iter; left time: 149.8228s
Epoch: 7 cost time: 11.688949346542358
Epoch: 7, Steps: 570 | Train Loss: 0.1039574 Vali Loss: 0.0366394 Test Loss: 0.1269912
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1205875
	speed: 0.0618s/iter; left time: 452.1735s
	iters: 200, epoch: 8 | loss: 0.1459271
	speed: 0.0222s/iter; left time: 160.2718s
	iters: 300, epoch: 8 | loss: 0.1205403
	speed: 0.0221s/iter; left time: 157.3392s
	iters: 400, epoch: 8 | loss: 0.0813425
	speed: 0.0221s/iter; left time: 155.2078s
	iters: 500, epoch: 8 | loss: 0.1189137
	speed: 0.0221s/iter; left time: 152.8789s
Epoch: 8 cost time: 12.918823003768921
Epoch: 8, Steps: 570 | Train Loss: 0.1026915 Vali Loss: 0.0364686 Test Loss: 0.1263820
Validation loss decreased (0.036525 --> 0.036469).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1197486
	speed: 0.0640s/iter; left time: 431.3513s
	iters: 200, epoch: 9 | loss: 0.0918249
	speed: 0.0201s/iter; left time: 133.5486s
	iters: 300, epoch: 9 | loss: 0.1258810
	speed: 0.0201s/iter; left time: 131.2370s
	iters: 400, epoch: 9 | loss: 0.0980082
	speed: 0.0201s/iter; left time: 129.3801s
	iters: 500, epoch: 9 | loss: 0.0667927
	speed: 0.0201s/iter; left time: 127.1785s
Epoch: 9 cost time: 11.766298532485962
Epoch: 9, Steps: 570 | Train Loss: 0.1020714 Vali Loss: 0.0364871 Test Loss: 0.1269563
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1081315
	speed: 0.0592s/iter; left time: 365.3864s
	iters: 200, epoch: 10 | loss: 0.0703289
	speed: 0.0200s/iter; left time: 121.2370s
	iters: 300, epoch: 10 | loss: 0.1466069
	speed: 0.0199s/iter; left time: 119.1067s
	iters: 400, epoch: 10 | loss: 0.1373107
	speed: 0.0200s/iter; left time: 117.1758s
	iters: 500, epoch: 10 | loss: 0.1043450
	speed: 0.0199s/iter; left time: 115.0932s
Epoch: 10 cost time: 11.693408012390137
Epoch: 10, Steps: 570 | Train Loss: 0.1018137 Vali Loss: 0.0365492 Test Loss: 0.1266269
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0926427
	speed: 0.0614s/iter; left time: 343.8704s
	iters: 200, epoch: 11 | loss: 0.0865288
	speed: 0.0230s/iter; left time: 126.7153s
	iters: 300, epoch: 11 | loss: 0.0943823
	speed: 0.0221s/iter; left time: 119.5037s
	iters: 400, epoch: 11 | loss: 0.1200916
	speed: 0.0199s/iter; left time: 105.6824s
	iters: 500, epoch: 11 | loss: 0.0841507
	speed: 0.0199s/iter; left time: 103.7302s
Epoch: 11 cost time: 12.488039493560791
Epoch: 11, Steps: 570 | Train Loss: 0.1023736 Vali Loss: 0.0365195 Test Loss: 0.1265664
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12653130292892456, mae:0.22853916883468628
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1838763
	speed: 0.0222s/iter; left time: 250.4996s
	iters: 200, epoch: 1 | loss: 0.2262921
	speed: 0.0106s/iter; left time: 118.6945s
	iters: 300, epoch: 1 | loss: 0.2421962
	speed: 0.0106s/iter; left time: 117.8111s
	iters: 400, epoch: 1 | loss: 0.2350823
	speed: 0.0106s/iter; left time: 116.4880s
	iters: 500, epoch: 1 | loss: 0.1849077
	speed: 0.0106s/iter; left time: 115.5713s
Epoch: 1 cost time: 7.2485411167144775
Epoch: 1, Steps: 570 | Train Loss: 0.2469439 Vali Loss: 0.0468240 Test Loss: 0.1477441
Validation loss decreased (inf --> 0.046824).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3650033
	speed: 0.0367s/iter; left time: 393.3535s
	iters: 200, epoch: 2 | loss: 0.3034966
	speed: 0.0106s/iter; left time: 113.0625s
	iters: 300, epoch: 2 | loss: 0.2237196
	speed: 0.0106s/iter; left time: 111.9491s
	iters: 400, epoch: 2 | loss: 0.1715376
	speed: 0.0106s/iter; left time: 111.0286s
	iters: 500, epoch: 2 | loss: 0.2009435
	speed: 0.0106s/iter; left time: 109.4956s
Epoch: 2 cost time: 6.380062103271484
Epoch: 2, Steps: 570 | Train Loss: 0.2086817 Vali Loss: 0.0431858 Test Loss: 0.1302046
Validation loss decreased (0.046824 --> 0.043186).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1407596
	speed: 0.0386s/iter; left time: 391.8592s
	iters: 200, epoch: 3 | loss: 0.2522303
	speed: 0.0118s/iter; left time: 119.0943s
	iters: 300, epoch: 3 | loss: 0.1577499
	speed: 0.0118s/iter; left time: 117.9305s
	iters: 400, epoch: 3 | loss: 0.1961393
	speed: 0.0119s/iter; left time: 116.9755s
	iters: 500, epoch: 3 | loss: 0.2381822
	speed: 0.0118s/iter; left time: 115.3959s
Epoch: 3 cost time: 7.074812889099121
Epoch: 3, Steps: 570 | Train Loss: 0.1940981 Vali Loss: 0.0392426 Test Loss: 0.1196013
Validation loss decreased (0.043186 --> 0.039243).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1993661
	speed: 0.0391s/iter; left time: 374.6525s
	iters: 200, epoch: 4 | loss: 0.1229510
	speed: 0.0106s/iter; left time: 100.8878s
	iters: 300, epoch: 4 | loss: 0.1835459
	speed: 0.0107s/iter; left time: 100.2252s
	iters: 400, epoch: 4 | loss: 0.1944800
	speed: 0.0106s/iter; left time: 98.3593s
	iters: 500, epoch: 4 | loss: 0.1841007
	speed: 0.0106s/iter; left time: 97.0314s
Epoch: 4 cost time: 6.459578275680542
Epoch: 4, Steps: 570 | Train Loss: 0.1866241 Vali Loss: 0.0382622 Test Loss: 0.1176750
Validation loss decreased (0.039243 --> 0.038262).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1781220
	speed: 0.0363s/iter; left time: 327.8166s
	iters: 200, epoch: 5 | loss: 0.1857679
	speed: 0.0105s/iter; left time: 93.4360s
	iters: 300, epoch: 5 | loss: 0.1451971
	speed: 0.0105s/iter; left time: 92.1939s
	iters: 400, epoch: 5 | loss: 0.1592865
	speed: 0.0104s/iter; left time: 91.0742s
	iters: 500, epoch: 5 | loss: 0.2001340
	speed: 0.0105s/iter; left time: 90.2665s
Epoch: 5 cost time: 6.260727643966675
Epoch: 5, Steps: 570 | Train Loss: 0.1833853 Vali Loss: 0.0377534 Test Loss: 0.1163326
Validation loss decreased (0.038262 --> 0.037753).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1641723
	speed: 0.0381s/iter; left time: 321.7358s
	iters: 200, epoch: 6 | loss: 0.1214992
	speed: 0.0106s/iter; left time: 88.1058s
	iters: 300, epoch: 6 | loss: 0.1937904
	speed: 0.0105s/iter; left time: 86.9854s
	iters: 400, epoch: 6 | loss: 0.2075890
	speed: 0.0106s/iter; left time: 86.2214s
	iters: 500, epoch: 6 | loss: 0.1625378
	speed: 0.0106s/iter; left time: 85.1962s
Epoch: 6 cost time: 6.295174837112427
Epoch: 6, Steps: 570 | Train Loss: 0.1814093 Vali Loss: 0.0374731 Test Loss: 0.1154826
Validation loss decreased (0.037753 --> 0.037473).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2088200
	speed: 0.0373s/iter; left time: 294.0798s
	iters: 200, epoch: 7 | loss: 0.2539992
	speed: 0.0106s/iter; left time: 82.3514s
	iters: 300, epoch: 7 | loss: 0.1518456
	speed: 0.0105s/iter; left time: 80.6905s
	iters: 400, epoch: 7 | loss: 0.1531211
	speed: 0.0105s/iter; left time: 79.6147s
	iters: 500, epoch: 7 | loss: 0.1590254
	speed: 0.0105s/iter; left time: 78.7829s
Epoch: 7 cost time: 6.292436599731445
Epoch: 7, Steps: 570 | Train Loss: 0.1806771 Vali Loss: 0.0374486 Test Loss: 0.1151799
Validation loss decreased (0.037473 --> 0.037449).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1841307
	speed: 0.0375s/iter; left time: 274.0773s
	iters: 200, epoch: 8 | loss: 0.1829584
	speed: 0.0105s/iter; left time: 76.0000s
	iters: 300, epoch: 8 | loss: 0.2311469
	speed: 0.0105s/iter; left time: 74.8968s
	iters: 400, epoch: 8 | loss: 0.2344930
	speed: 0.0105s/iter; left time: 73.8518s
	iters: 500, epoch: 8 | loss: 0.1260647
	speed: 0.0105s/iter; left time: 72.6312s
Epoch: 8 cost time: 6.350559234619141
Epoch: 8, Steps: 570 | Train Loss: 0.1801370 Vali Loss: 0.0372930 Test Loss: 0.1151874
Validation loss decreased (0.037449 --> 0.037293).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2357312
	speed: 0.0369s/iter; left time: 248.6211s
	iters: 200, epoch: 9 | loss: 0.1606665
	speed: 0.0106s/iter; left time: 70.4337s
	iters: 300, epoch: 9 | loss: 0.0794805
	speed: 0.0106s/iter; left time: 69.5638s
	iters: 400, epoch: 9 | loss: 0.1917628
	speed: 0.0106s/iter; left time: 68.5037s
	iters: 500, epoch: 9 | loss: 0.1591353
	speed: 0.0106s/iter; left time: 67.2944s
Epoch: 9 cost time: 6.3471996784210205
Epoch: 9, Steps: 570 | Train Loss: 0.1792545 Vali Loss: 0.0375814 Test Loss: 0.1152591
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2054558
	speed: 0.0372s/iter; left time: 229.2767s
	iters: 200, epoch: 10 | loss: 0.1715946
	speed: 0.0106s/iter; left time: 64.5890s
	iters: 300, epoch: 10 | loss: 0.1450879
	speed: 0.0106s/iter; left time: 63.3431s
	iters: 400, epoch: 10 | loss: 0.1791696
	speed: 0.0106s/iter; left time: 62.4282s
	iters: 500, epoch: 10 | loss: 0.2627719
	speed: 0.0106s/iter; left time: 61.3526s
Epoch: 10 cost time: 6.446164131164551
Epoch: 10, Steps: 570 | Train Loss: 0.1789110 Vali Loss: 0.0374061 Test Loss: 0.1154338
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2018587
	speed: 0.0360s/iter; left time: 201.8990s
	iters: 200, epoch: 11 | loss: 0.1902418
	speed: 0.0105s/iter; left time: 58.0135s
	iters: 300, epoch: 11 | loss: 0.1466813
	speed: 0.0105s/iter; left time: 56.8456s
	iters: 400, epoch: 11 | loss: 0.2677454
	speed: 0.0105s/iter; left time: 55.8593s
	iters: 500, epoch: 11 | loss: 0.1518935
	speed: 0.0105s/iter; left time: 54.7653s
Epoch: 11 cost time: 6.289125442504883
Epoch: 11, Steps: 570 | Train Loss: 0.1808354 Vali Loss: 0.0372992 Test Loss: 0.1152959
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1153513640165329, mae:0.206453338265419
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1828886
	speed: 0.0233s/iter; left time: 263.2814s
	iters: 200, epoch: 1 | loss: 0.2457823
	speed: 0.0116s/iter; left time: 129.5680s
	iters: 300, epoch: 1 | loss: 0.3082028
	speed: 0.0115s/iter; left time: 127.9223s
	iters: 400, epoch: 1 | loss: 0.2259460
	speed: 0.0115s/iter; left time: 126.9674s
	iters: 500, epoch: 1 | loss: 0.2219390
	speed: 0.0116s/iter; left time: 126.2234s
Epoch: 1 cost time: 7.804235219955444
Epoch: 1, Steps: 570 | Train Loss: 0.2199660 Vali Loss: 0.0366850 Test Loss: 0.1126287
Validation loss decreased (inf --> 0.036685).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1593059
	speed: 0.0370s/iter; left time: 397.0967s
	iters: 200, epoch: 2 | loss: 0.2054645
	speed: 0.0103s/iter; left time: 109.4674s
	iters: 300, epoch: 2 | loss: 0.1543722
	speed: 0.0103s/iter; left time: 108.3013s
	iters: 400, epoch: 2 | loss: 0.1701510
	speed: 0.0103s/iter; left time: 107.4670s
	iters: 500, epoch: 2 | loss: 0.2060413
	speed: 0.0103s/iter; left time: 106.1873s
Epoch: 2 cost time: 6.178025484085083
Epoch: 2, Steps: 570 | Train Loss: 0.1892942 Vali Loss: 0.0348876 Test Loss: 0.1103104
Validation loss decreased (0.036685 --> 0.034888).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1005346
	speed: 0.0373s/iter; left time: 379.0005s
	iters: 200, epoch: 3 | loss: 0.1503472
	speed: 0.0104s/iter; left time: 104.1321s
	iters: 300, epoch: 3 | loss: 0.3203785
	speed: 0.0103s/iter; left time: 102.9715s
	iters: 400, epoch: 3 | loss: 0.1883775
	speed: 0.0103s/iter; left time: 101.8913s
	iters: 500, epoch: 3 | loss: 0.1290856
	speed: 0.0103s/iter; left time: 100.4712s
Epoch: 3 cost time: 6.207367181777954
Epoch: 3, Steps: 570 | Train Loss: 0.1770942 Vali Loss: 0.0338217 Test Loss: 0.1093030
Validation loss decreased (0.034888 --> 0.033822).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1441337
	speed: 0.0372s/iter; left time: 356.9251s
	iters: 200, epoch: 4 | loss: 0.1593233
	speed: 0.0103s/iter; left time: 98.1835s
	iters: 300, epoch: 4 | loss: 0.1120121
	speed: 0.0103s/iter; left time: 97.0027s
	iters: 400, epoch: 4 | loss: 0.1324253
	speed: 0.0103s/iter; left time: 96.0166s
	iters: 500, epoch: 4 | loss: 0.2130708
	speed: 0.0103s/iter; left time: 94.5907s
Epoch: 4 cost time: 6.218059778213501
Epoch: 4, Steps: 570 | Train Loss: 0.1718756 Vali Loss: 0.0328530 Test Loss: 0.1078141
Validation loss decreased (0.033822 --> 0.032853).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1337461
	speed: 0.0372s/iter; left time: 335.9640s
	iters: 200, epoch: 5 | loss: 0.2215776
	speed: 0.0110s/iter; left time: 98.2454s
	iters: 300, epoch: 5 | loss: 0.1527465
	speed: 0.0103s/iter; left time: 91.2822s
	iters: 400, epoch: 5 | loss: 0.1537911
	speed: 0.0104s/iter; left time: 90.3574s
	iters: 500, epoch: 5 | loss: 0.1676764
	speed: 0.0103s/iter; left time: 89.1868s
Epoch: 5 cost time: 6.4047791957855225
Epoch: 5, Steps: 570 | Train Loss: 0.1691386 Vali Loss: 0.0326039 Test Loss: 0.1077918
Validation loss decreased (0.032853 --> 0.032604).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1157265
	speed: 0.0376s/iter; left time: 317.9457s
	iters: 200, epoch: 6 | loss: 0.2231238
	speed: 0.0103s/iter; left time: 86.2264s
	iters: 300, epoch: 6 | loss: 0.1714498
	speed: 0.0103s/iter; left time: 85.2704s
	iters: 400, epoch: 6 | loss: 0.1467870
	speed: 0.0103s/iter; left time: 84.2614s
	iters: 500, epoch: 6 | loss: 0.1083220
	speed: 0.0103s/iter; left time: 83.2712s
Epoch: 6 cost time: 6.191277027130127
Epoch: 6, Steps: 570 | Train Loss: 0.1677612 Vali Loss: 0.0324452 Test Loss: 0.1069785
Validation loss decreased (0.032604 --> 0.032445).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1656626
	speed: 0.0366s/iter; left time: 288.1499s
	iters: 200, epoch: 7 | loss: 0.1971352
	speed: 0.0103s/iter; left time: 79.8674s
	iters: 300, epoch: 7 | loss: 0.2850979
	speed: 0.0103s/iter; left time: 79.0563s
	iters: 400, epoch: 7 | loss: 0.2115485
	speed: 0.0103s/iter; left time: 77.8262s
	iters: 500, epoch: 7 | loss: 0.1697742
	speed: 0.0103s/iter; left time: 76.7433s
Epoch: 7 cost time: 6.166748046875
Epoch: 7, Steps: 570 | Train Loss: 0.1670734 Vali Loss: 0.0323769 Test Loss: 0.1075213
Validation loss decreased (0.032445 --> 0.032377).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1333192
	speed: 0.0374s/iter; left time: 273.0782s
	iters: 200, epoch: 8 | loss: 0.1212558
	speed: 0.0104s/iter; left time: 74.8812s
	iters: 300, epoch: 8 | loss: 0.1591988
	speed: 0.0104s/iter; left time: 73.6088s
	iters: 400, epoch: 8 | loss: 0.1547630
	speed: 0.0104s/iter; left time: 72.6936s
	iters: 500, epoch: 8 | loss: 0.1005236
	speed: 0.0104s/iter; left time: 71.6409s
Epoch: 8 cost time: 6.208264350891113
Epoch: 8, Steps: 570 | Train Loss: 0.1678574 Vali Loss: 0.0322266 Test Loss: 0.1071254
Validation loss decreased (0.032377 --> 0.032227).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1429574
	speed: 0.0371s/iter; left time: 250.1331s
	iters: 200, epoch: 9 | loss: 0.1759467
	speed: 0.0104s/iter; left time: 68.7700s
	iters: 300, epoch: 9 | loss: 0.1407218
	speed: 0.0104s/iter; left time: 67.7576s
	iters: 400, epoch: 9 | loss: 0.2024473
	speed: 0.0103s/iter; left time: 66.5546s
	iters: 500, epoch: 9 | loss: 0.1664674
	speed: 0.0103s/iter; left time: 65.6058s
Epoch: 9 cost time: 6.219608545303345
Epoch: 9, Steps: 570 | Train Loss: 0.1662162 Vali Loss: 0.0323011 Test Loss: 0.1072334
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1816216
	speed: 0.0360s/iter; left time: 222.1664s
	iters: 200, epoch: 10 | loss: 0.1361496
	speed: 0.0104s/iter; left time: 63.0954s
	iters: 300, epoch: 10 | loss: 0.1309139
	speed: 0.0104s/iter; left time: 61.8348s
	iters: 400, epoch: 10 | loss: 0.1110898
	speed: 0.0104s/iter; left time: 60.9238s
	iters: 500, epoch: 10 | loss: 0.1107252
	speed: 0.0104s/iter; left time: 59.9082s
Epoch: 10 cost time: 6.213876962661743
Epoch: 10, Steps: 570 | Train Loss: 0.1679023 Vali Loss: 0.0323042 Test Loss: 0.1072503
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1647340
	speed: 0.0356s/iter; left time: 199.6754s
	iters: 200, epoch: 11 | loss: 0.1793726
	speed: 0.0103s/iter; left time: 56.7992s
	iters: 300, epoch: 11 | loss: 0.1983196
	speed: 0.0103s/iter; left time: 55.8906s
	iters: 400, epoch: 11 | loss: 0.1548596
	speed: 0.0103s/iter; left time: 54.7482s
	iters: 500, epoch: 11 | loss: 0.1399179
	speed: 0.0103s/iter; left time: 53.5098s
Epoch: 11 cost time: 6.145546913146973
Epoch: 11, Steps: 570 | Train Loss: 0.1657922 Vali Loss: 0.0321813 Test Loss: 0.1072216
Validation loss decreased (0.032227 --> 0.032181).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1445267
	speed: 0.0362s/iter; left time: 182.1525s
	iters: 200, epoch: 12 | loss: 0.1725959
	speed: 0.0103s/iter; left time: 50.9845s
	iters: 300, epoch: 12 | loss: 0.1363489
	speed: 0.0103s/iter; left time: 49.6942s
	iters: 400, epoch: 12 | loss: 0.2557544
	speed: 0.0103s/iter; left time: 48.6767s
	iters: 500, epoch: 12 | loss: 0.1478703
	speed: 0.0103s/iter; left time: 47.7447s
Epoch: 12 cost time: 6.214647054672241
Epoch: 12, Steps: 570 | Train Loss: 0.1666862 Vali Loss: 0.0322796 Test Loss: 0.1072213
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2649360
	speed: 0.0354s/iter; left time: 158.0790s
	iters: 200, epoch: 13 | loss: 0.2243658
	speed: 0.0102s/iter; left time: 44.6372s
	iters: 300, epoch: 13 | loss: 0.1305198
	speed: 0.0102s/iter; left time: 43.5969s
	iters: 400, epoch: 13 | loss: 0.1820780
	speed: 0.0102s/iter; left time: 42.5733s
	iters: 500, epoch: 13 | loss: 0.1925435
	speed: 0.0102s/iter; left time: 41.5580s
Epoch: 13 cost time: 6.112804889678955
Epoch: 13, Steps: 570 | Train Loss: 0.1665053 Vali Loss: 0.0321626 Test Loss: 0.1072109
Validation loss decreased (0.032181 --> 0.032163).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1634994
	speed: 0.0360s/iter; left time: 140.0623s
	iters: 200, epoch: 14 | loss: 0.1243813
	speed: 0.0102s/iter; left time: 38.7174s
	iters: 300, epoch: 14 | loss: 0.1844851
	speed: 0.0102s/iter; left time: 37.7263s
	iters: 400, epoch: 14 | loss: 0.1706056
	speed: 0.0102s/iter; left time: 36.7342s
	iters: 500, epoch: 14 | loss: 0.1824636
	speed: 0.0102s/iter; left time: 35.6889s
Epoch: 14 cost time: 6.122521638870239
Epoch: 14, Steps: 570 | Train Loss: 0.1669251 Vali Loss: 0.0322283 Test Loss: 0.1072074
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1038841
	speed: 0.0376s/iter; left time: 124.7426s
	iters: 200, epoch: 15 | loss: 0.1738171
	speed: 0.0103s/iter; left time: 33.3287s
	iters: 300, epoch: 15 | loss: 0.1616683
	speed: 0.0103s/iter; left time: 32.2772s
	iters: 400, epoch: 15 | loss: 0.1510081
	speed: 0.0103s/iter; left time: 31.1481s
	iters: 500, epoch: 15 | loss: 0.1392745
	speed: 0.0103s/iter; left time: 30.1695s
Epoch: 15 cost time: 6.190774440765381
Epoch: 15, Steps: 570 | Train Loss: 0.1655932 Vali Loss: 0.0321591 Test Loss: 0.1072100
Validation loss decreased (0.032163 --> 0.032159).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2543693
	speed: 0.0372s/iter; left time: 102.3199s
	iters: 200, epoch: 16 | loss: 0.1520774
	speed: 0.0103s/iter; left time: 27.3810s
	iters: 300, epoch: 16 | loss: 0.2085544
	speed: 0.0103s/iter; left time: 26.2609s
	iters: 400, epoch: 16 | loss: 0.1595235
	speed: 0.0103s/iter; left time: 25.2975s
	iters: 500, epoch: 16 | loss: 0.2832646
	speed: 0.0103s/iter; left time: 24.2661s
Epoch: 16 cost time: 6.1795878410339355
Epoch: 16, Steps: 570 | Train Loss: 0.1666242 Vali Loss: 0.0321436 Test Loss: 0.1072102
Validation loss decreased (0.032159 --> 0.032144).  Saving model ...
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1185087
	speed: 0.0368s/iter; left time: 80.2188s
	iters: 200, epoch: 17 | loss: 0.1497921
	speed: 0.0104s/iter; left time: 21.5941s
	iters: 300, epoch: 17 | loss: 0.1590874
	speed: 0.0104s/iter; left time: 20.5105s
	iters: 400, epoch: 17 | loss: 0.1416201
	speed: 0.0104s/iter; left time: 19.4950s
	iters: 500, epoch: 17 | loss: 0.1077986
	speed: 0.0104s/iter; left time: 18.4916s
Epoch: 17 cost time: 6.239096403121948
Epoch: 17, Steps: 570 | Train Loss: 0.1670342 Vali Loss: 0.0322758 Test Loss: 0.1072100
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.2016373
	speed: 0.0356s/iter; left time: 57.3499s
	iters: 200, epoch: 18 | loss: 0.1689910
	speed: 0.0103s/iter; left time: 15.6018s
	iters: 300, epoch: 18 | loss: 0.1362761
	speed: 0.0103s/iter; left time: 14.5280s
	iters: 400, epoch: 18 | loss: 0.2473616
	speed: 0.0103s/iter; left time: 13.5283s
	iters: 500, epoch: 18 | loss: 0.1303532
	speed: 0.0103s/iter; left time: 12.4929s
Epoch: 18 cost time: 6.161825656890869
Epoch: 18, Steps: 570 | Train Loss: 0.1664147 Vali Loss: 0.0322466 Test Loss: 0.1072100
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1495986
	speed: 0.0358s/iter; left time: 37.2607s
	iters: 200, epoch: 19 | loss: 0.1992128
	speed: 0.0104s/iter; left time: 9.7462s
	iters: 300, epoch: 19 | loss: 0.1432451
	speed: 0.0104s/iter; left time: 8.7084s
	iters: 400, epoch: 19 | loss: 0.1850358
	speed: 0.0103s/iter; left time: 7.6608s
	iters: 500, epoch: 19 | loss: 0.1601970
	speed: 0.0104s/iter; left time: 6.6377s
Epoch: 19 cost time: 6.194748163223267
Epoch: 19, Steps: 570 | Train Loss: 0.1664159 Vali Loss: 0.0322582 Test Loss: 0.1072100
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1073606014251709, mae:0.19618366658687592
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2698248
	speed: 0.0235s/iter; left time: 265.9032s
	iters: 200, epoch: 1 | loss: 0.1963461
	speed: 0.0117s/iter; left time: 130.4981s
	iters: 300, epoch: 1 | loss: 0.1730838
	speed: 0.0116s/iter; left time: 128.8122s
	iters: 400, epoch: 1 | loss: 0.1825804
	speed: 0.0116s/iter; left time: 127.5995s
	iters: 500, epoch: 1 | loss: 0.2201471
	speed: 0.0116s/iter; left time: 126.6893s
Epoch: 1 cost time: 7.867076396942139
Epoch: 1, Steps: 570 | Train Loss: 0.2553634 Vali Loss: 0.0487838 Test Loss: 0.1375273
Validation loss decreased (inf --> 0.048784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2197944
	speed: 0.0373s/iter; left time: 400.0725s
	iters: 200, epoch: 2 | loss: 0.2865478
	speed: 0.0103s/iter; left time: 109.8099s
	iters: 300, epoch: 2 | loss: 0.2022398
	speed: 0.0103s/iter; left time: 108.7823s
	iters: 400, epoch: 2 | loss: 0.2947821
	speed: 0.0104s/iter; left time: 108.0542s
	iters: 500, epoch: 2 | loss: 0.2457532
	speed: 0.0103s/iter; left time: 106.8363s
Epoch: 2 cost time: 6.185974836349487
Epoch: 2, Steps: 570 | Train Loss: 0.2137631 Vali Loss: 0.0405234 Test Loss: 0.1260065
Validation loss decreased (0.048784 --> 0.040523).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1453066
	speed: 0.0362s/iter; left time: 367.4504s
	iters: 200, epoch: 3 | loss: 0.1868069
	speed: 0.0103s/iter; left time: 103.7717s
	iters: 300, epoch: 3 | loss: 0.2248434
	speed: 0.0103s/iter; left time: 102.6675s
	iters: 400, epoch: 3 | loss: 0.1697673
	speed: 0.0103s/iter; left time: 101.4865s
	iters: 500, epoch: 3 | loss: 0.1538604
	speed: 0.0103s/iter; left time: 100.4576s
Epoch: 3 cost time: 6.176154375076294
Epoch: 3, Steps: 570 | Train Loss: 0.2001636 Vali Loss: 0.0395559 Test Loss: 0.1234830
Validation loss decreased (0.040523 --> 0.039556).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1186689
	speed: 0.0360s/iter; left time: 345.3126s
	iters: 200, epoch: 4 | loss: 0.1220308
	speed: 0.0103s/iter; left time: 97.7848s
	iters: 300, epoch: 4 | loss: 0.1631663
	speed: 0.0103s/iter; left time: 96.7646s
	iters: 400, epoch: 4 | loss: 0.2533978
	speed: 0.0103s/iter; left time: 95.7789s
	iters: 500, epoch: 4 | loss: 0.1756260
	speed: 0.0103s/iter; left time: 94.7160s
Epoch: 4 cost time: 6.166089773178101
Epoch: 4, Steps: 570 | Train Loss: 0.1933635 Vali Loss: 0.0392864 Test Loss: 0.1252249
Validation loss decreased (0.039556 --> 0.039286).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1849314
	speed: 0.0377s/iter; left time: 340.0861s
	iters: 200, epoch: 5 | loss: 0.1326260
	speed: 0.0103s/iter; left time: 91.8090s
	iters: 300, epoch: 5 | loss: 0.2090940
	speed: 0.0103s/iter; left time: 90.8862s
	iters: 400, epoch: 5 | loss: 0.1819342
	speed: 0.0103s/iter; left time: 89.8603s
	iters: 500, epoch: 5 | loss: 0.2528400
	speed: 0.0103s/iter; left time: 88.7903s
Epoch: 5 cost time: 6.191557168960571
Epoch: 5, Steps: 570 | Train Loss: 0.1899995 Vali Loss: 0.0387793 Test Loss: 0.1243352
Validation loss decreased (0.039286 --> 0.038779).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1329355
	speed: 0.0366s/iter; left time: 309.5955s
	iters: 200, epoch: 6 | loss: 0.1990060
	speed: 0.0103s/iter; left time: 86.2847s
	iters: 300, epoch: 6 | loss: 0.1675856
	speed: 0.0103s/iter; left time: 85.2305s
	iters: 400, epoch: 6 | loss: 0.1494978
	speed: 0.0103s/iter; left time: 84.1955s
	iters: 500, epoch: 6 | loss: 0.1950927
	speed: 0.0103s/iter; left time: 83.2082s
Epoch: 6 cost time: 6.195836782455444
Epoch: 6, Steps: 570 | Train Loss: 0.1885858 Vali Loss: 0.0383679 Test Loss: 0.1227845
Validation loss decreased (0.038779 --> 0.038368).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1334369
	speed: 0.0383s/iter; left time: 301.8590s
	iters: 200, epoch: 7 | loss: 0.1708986
	speed: 0.0104s/iter; left time: 80.8702s
	iters: 300, epoch: 7 | loss: 0.1579319
	speed: 0.0104s/iter; left time: 79.6527s
	iters: 400, epoch: 7 | loss: 0.1086935
	speed: 0.0104s/iter; left time: 78.4813s
	iters: 500, epoch: 7 | loss: 0.2146642
	speed: 0.0104s/iter; left time: 77.4886s
Epoch: 7 cost time: 6.218514442443848
Epoch: 7, Steps: 570 | Train Loss: 0.1858311 Vali Loss: 0.0383617 Test Loss: 0.1226782
Validation loss decreased (0.038368 --> 0.038362).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1608976
	speed: 0.0377s/iter; left time: 275.6333s
	iters: 200, epoch: 8 | loss: 0.1631071
	speed: 0.0117s/iter; left time: 84.1102s
	iters: 300, epoch: 8 | loss: 0.2231359
	speed: 0.0116s/iter; left time: 82.4029s
	iters: 400, epoch: 8 | loss: 0.2170218
	speed: 0.0113s/iter; left time: 79.2691s
	iters: 500, epoch: 8 | loss: 0.1870292
	speed: 0.0103s/iter; left time: 70.9133s
Epoch: 8 cost time: 6.6744866371154785
Epoch: 8, Steps: 570 | Train Loss: 0.1859616 Vali Loss: 0.0384163 Test Loss: 0.1231131
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1614467
	speed: 0.0378s/iter; left time: 254.6681s
	iters: 200, epoch: 9 | loss: 0.2182490
	speed: 0.0103s/iter; left time: 68.2997s
	iters: 300, epoch: 9 | loss: 0.1493307
	speed: 0.0103s/iter; left time: 67.3449s
	iters: 400, epoch: 9 | loss: 0.1383214
	speed: 0.0103s/iter; left time: 66.3577s
	iters: 500, epoch: 9 | loss: 0.1916260
	speed: 0.0103s/iter; left time: 65.3322s
Epoch: 9 cost time: 6.186264276504517
Epoch: 9, Steps: 570 | Train Loss: 0.1843808 Vali Loss: 0.0384711 Test Loss: 0.1228933
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1567998
	speed: 0.0360s/iter; left time: 222.1473s
	iters: 200, epoch: 10 | loss: 0.2485952
	speed: 0.0103s/iter; left time: 62.4432s
	iters: 300, epoch: 10 | loss: 0.2517125
	speed: 0.0103s/iter; left time: 61.2843s
	iters: 400, epoch: 10 | loss: 0.2100986
	speed: 0.0103s/iter; left time: 60.3639s
	iters: 500, epoch: 10 | loss: 0.2018932
	speed: 0.0103s/iter; left time: 59.2533s
Epoch: 10 cost time: 6.180964946746826
Epoch: 10, Steps: 570 | Train Loss: 0.1854664 Vali Loss: 0.0385537 Test Loss: 0.1228057
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12285853922367096, mae:0.21647882461547852
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2728188
	speed: 0.0235s/iter; left time: 265.8643s
	iters: 200, epoch: 1 | loss: 0.2574952
	speed: 0.0121s/iter; left time: 135.0741s
	iters: 300, epoch: 1 | loss: 0.1812697
	speed: 0.0129s/iter; left time: 143.0089s
	iters: 400, epoch: 1 | loss: 0.1532026
	speed: 0.0129s/iter; left time: 141.8252s
	iters: 500, epoch: 1 | loss: 0.2401675
	speed: 0.0129s/iter; left time: 141.0127s
Epoch: 1 cost time: 8.387934684753418
Epoch: 1, Steps: 570 | Train Loss: 0.2418825 Vali Loss: 0.0426715 Test Loss: 0.1281548
Validation loss decreased (inf --> 0.042671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2165265
	speed: 0.0419s/iter; left time: 449.7705s
	iters: 200, epoch: 2 | loss: 0.1754232
	speed: 0.0118s/iter; left time: 125.6789s
	iters: 300, epoch: 2 | loss: 0.1547919
	speed: 0.0118s/iter; left time: 124.2874s
	iters: 400, epoch: 2 | loss: 0.1172236
	speed: 0.0118s/iter; left time: 123.2965s
	iters: 500, epoch: 2 | loss: 0.2130183
	speed: 0.0118s/iter; left time: 122.0062s
Epoch: 2 cost time: 7.033994913101196
Epoch: 2, Steps: 570 | Train Loss: 0.2053043 Vali Loss: 0.0398624 Test Loss: 0.1240785
Validation loss decreased (0.042671 --> 0.039862).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2351242
	speed: 0.0394s/iter; left time: 400.6150s
	iters: 200, epoch: 3 | loss: 0.2170653
	speed: 0.0119s/iter; left time: 119.8015s
	iters: 300, epoch: 3 | loss: 0.1421339
	speed: 0.0119s/iter; left time: 118.6679s
	iters: 400, epoch: 3 | loss: 0.1911538
	speed: 0.0119s/iter; left time: 117.5824s
	iters: 500, epoch: 3 | loss: 0.1371060
	speed: 0.0119s/iter; left time: 116.1668s
Epoch: 3 cost time: 7.10011100769043
Epoch: 3, Steps: 570 | Train Loss: 0.1833844 Vali Loss: 0.0381102 Test Loss: 0.1208010
Validation loss decreased (0.039862 --> 0.038110).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1335539
	speed: 0.0390s/iter; left time: 373.6727s
	iters: 200, epoch: 4 | loss: 0.2521101
	speed: 0.0119s/iter; left time: 112.7409s
	iters: 300, epoch: 4 | loss: 0.1180318
	speed: 0.0119s/iter; left time: 111.2884s
	iters: 400, epoch: 4 | loss: 0.1190270
	speed: 0.0119s/iter; left time: 110.1127s
	iters: 500, epoch: 4 | loss: 0.1296462
	speed: 0.0119s/iter; left time: 108.9469s
Epoch: 4 cost time: 7.074910640716553
Epoch: 4, Steps: 570 | Train Loss: 0.1727422 Vali Loss: 0.0359602 Test Loss: 0.1186741
Validation loss decreased (0.038110 --> 0.035960).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1812001
	speed: 0.0389s/iter; left time: 350.6290s
	iters: 200, epoch: 5 | loss: 0.1499797
	speed: 0.0119s/iter; left time: 105.8755s
	iters: 300, epoch: 5 | loss: 0.2162277
	speed: 0.0119s/iter; left time: 104.8781s
	iters: 400, epoch: 5 | loss: 0.1553775
	speed: 0.0119s/iter; left time: 103.5422s
	iters: 500, epoch: 5 | loss: 0.1368521
	speed: 0.0119s/iter; left time: 102.3341s
Epoch: 5 cost time: 7.094435691833496
Epoch: 5, Steps: 570 | Train Loss: 0.1688252 Vali Loss: 0.0367247 Test Loss: 0.1190778
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1485026
	speed: 0.0393s/iter; left time: 332.0156s
	iters: 200, epoch: 6 | loss: 0.0967241
	speed: 0.0119s/iter; left time: 99.4085s
	iters: 300, epoch: 6 | loss: 0.2068383
	speed: 0.0119s/iter; left time: 98.0356s
	iters: 400, epoch: 6 | loss: 0.2037544
	speed: 0.0119s/iter; left time: 96.6778s
	iters: 500, epoch: 6 | loss: 0.1254910
	speed: 0.0119s/iter; left time: 95.6761s
Epoch: 6 cost time: 7.0502238273620605
Epoch: 6, Steps: 570 | Train Loss: 0.1657459 Vali Loss: 0.0353277 Test Loss: 0.1163611
Validation loss decreased (0.035960 --> 0.035328).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1641413
	speed: 0.0399s/iter; left time: 314.7786s
	iters: 200, epoch: 7 | loss: 0.1582499
	speed: 0.0119s/iter; left time: 92.2538s
	iters: 300, epoch: 7 | loss: 0.1567524
	speed: 0.0119s/iter; left time: 91.3198s
	iters: 400, epoch: 7 | loss: 0.1162649
	speed: 0.0119s/iter; left time: 90.0086s
	iters: 500, epoch: 7 | loss: 0.1505215
	speed: 0.0119s/iter; left time: 88.6570s
Epoch: 7 cost time: 7.076368808746338
Epoch: 7, Steps: 570 | Train Loss: 0.1633433 Vali Loss: 0.0350584 Test Loss: 0.1166410
Validation loss decreased (0.035328 --> 0.035058).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1034093
	speed: 0.0413s/iter; left time: 302.1956s
	iters: 200, epoch: 8 | loss: 0.1616497
	speed: 0.0130s/iter; left time: 93.3826s
	iters: 300, epoch: 8 | loss: 0.1574582
	speed: 0.0130s/iter; left time: 92.3965s
	iters: 400, epoch: 8 | loss: 0.1227569
	speed: 0.0129s/iter; left time: 90.5872s
	iters: 500, epoch: 8 | loss: 0.1155061
	speed: 0.0129s/iter; left time: 89.4104s
Epoch: 8 cost time: 7.688216924667358
Epoch: 8, Steps: 570 | Train Loss: 0.1651215 Vali Loss: 0.0351653 Test Loss: 0.1164627
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1255578
	speed: 0.0394s/iter; left time: 265.5216s
	iters: 200, epoch: 9 | loss: 0.1620957
	speed: 0.0119s/iter; left time: 78.7473s
	iters: 300, epoch: 9 | loss: 0.1645151
	speed: 0.0119s/iter; left time: 77.5623s
	iters: 400, epoch: 9 | loss: 0.1184326
	speed: 0.0119s/iter; left time: 76.3395s
	iters: 500, epoch: 9 | loss: 0.2043733
	speed: 0.0119s/iter; left time: 75.1463s
Epoch: 9 cost time: 7.0228376388549805
Epoch: 9, Steps: 570 | Train Loss: 0.1640864 Vali Loss: 0.0350849 Test Loss: 0.1165322
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1445729
	speed: 0.0395s/iter; left time: 243.8942s
	iters: 200, epoch: 10 | loss: 0.1848298
	speed: 0.0119s/iter; left time: 72.2299s
	iters: 300, epoch: 10 | loss: 0.1493964
	speed: 0.0119s/iter; left time: 70.9479s
	iters: 400, epoch: 10 | loss: 0.1604544
	speed: 0.0119s/iter; left time: 69.7554s
	iters: 500, epoch: 10 | loss: 0.1954258
	speed: 0.0119s/iter; left time: 68.5214s
Epoch: 10 cost time: 7.033463954925537
Epoch: 10, Steps: 570 | Train Loss: 0.1638730 Vali Loss: 0.0352154 Test Loss: 0.1164913
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11679396778345108, mae:0.21177786588668823
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1363186
	speed: 0.0248s/iter; left time: 280.1847s
	iters: 200, epoch: 1 | loss: 0.3413582
	speed: 0.0126s/iter; left time: 140.5833s
	iters: 300, epoch: 1 | loss: 0.1783569
	speed: 0.0125s/iter; left time: 138.9512s
	iters: 400, epoch: 1 | loss: 0.2139740
	speed: 0.0125s/iter; left time: 137.9136s
	iters: 500, epoch: 1 | loss: 0.1596255
	speed: 0.0126s/iter; left time: 137.3551s
Epoch: 1 cost time: 8.430464506149292
Epoch: 1, Steps: 570 | Train Loss: 0.2173056 Vali Loss: 0.0368995 Test Loss: 0.1138321
Validation loss decreased (inf --> 0.036899).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1699772
	speed: 0.0408s/iter; left time: 438.1796s
	iters: 200, epoch: 2 | loss: 0.1333708
	speed: 0.0115s/iter; left time: 121.9103s
	iters: 300, epoch: 2 | loss: 0.1933986
	speed: 0.0115s/iter; left time: 120.8703s
	iters: 400, epoch: 2 | loss: 0.2743535
	speed: 0.0115s/iter; left time: 119.8692s
	iters: 500, epoch: 2 | loss: 0.2752552
	speed: 0.0115s/iter; left time: 118.5199s
Epoch: 2 cost time: 6.876612901687622
Epoch: 2, Steps: 570 | Train Loss: 0.1849333 Vali Loss: 0.0353342 Test Loss: 0.1119078
Validation loss decreased (0.036899 --> 0.035334).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2045713
	speed: 0.0408s/iter; left time: 414.6648s
	iters: 200, epoch: 3 | loss: 0.1044277
	speed: 0.0115s/iter; left time: 115.6846s
	iters: 300, epoch: 3 | loss: 0.1900565
	speed: 0.0115s/iter; left time: 114.2630s
	iters: 400, epoch: 3 | loss: 0.1648793
	speed: 0.0114s/iter; left time: 112.8879s
	iters: 500, epoch: 3 | loss: 0.2183758
	speed: 0.0114s/iter; left time: 111.7607s
Epoch: 3 cost time: 6.912928581237793
Epoch: 3, Steps: 570 | Train Loss: 0.1719539 Vali Loss: 0.0331079 Test Loss: 0.1087243
Validation loss decreased (0.035334 --> 0.033108).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1481705
	speed: 0.0386s/iter; left time: 369.9515s
	iters: 200, epoch: 4 | loss: 0.1115734
	speed: 0.0115s/iter; left time: 109.0901s
	iters: 300, epoch: 4 | loss: 0.0927960
	speed: 0.0115s/iter; left time: 107.8642s
	iters: 400, epoch: 4 | loss: 0.1426336
	speed: 0.0115s/iter; left time: 106.8366s
	iters: 500, epoch: 4 | loss: 0.1575047
	speed: 0.0115s/iter; left time: 105.6598s
Epoch: 4 cost time: 6.875374794006348
Epoch: 4, Steps: 570 | Train Loss: 0.1625956 Vali Loss: 0.0322053 Test Loss: 0.1091411
Validation loss decreased (0.033108 --> 0.032205).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1714803
	speed: 0.0395s/iter; left time: 356.7159s
	iters: 200, epoch: 5 | loss: 0.1156754
	speed: 0.0115s/iter; left time: 102.4437s
	iters: 300, epoch: 5 | loss: 0.2285974
	speed: 0.0115s/iter; left time: 101.1725s
	iters: 400, epoch: 5 | loss: 0.1490882
	speed: 0.0115s/iter; left time: 99.9374s
	iters: 500, epoch: 5 | loss: 0.1352341
	speed: 0.0115s/iter; left time: 98.8161s
Epoch: 5 cost time: 6.856023073196411
Epoch: 5, Steps: 570 | Train Loss: 0.1591634 Vali Loss: 0.0319482 Test Loss: 0.1095468
Validation loss decreased (0.032205 --> 0.031948).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2010585
	speed: 0.0386s/iter; left time: 326.3037s
	iters: 200, epoch: 6 | loss: 0.1728979
	speed: 0.0114s/iter; left time: 95.4584s
	iters: 300, epoch: 6 | loss: 0.1127171
	speed: 0.0114s/iter; left time: 94.3862s
	iters: 400, epoch: 6 | loss: 0.1233015
	speed: 0.0114s/iter; left time: 93.1818s
	iters: 500, epoch: 6 | loss: 0.1220856
	speed: 0.0114s/iter; left time: 91.9578s
Epoch: 6 cost time: 6.83613395690918
Epoch: 6, Steps: 570 | Train Loss: 0.1572244 Vali Loss: 0.0312679 Test Loss: 0.1084600
Validation loss decreased (0.031948 --> 0.031268).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1036759
	speed: 0.0382s/iter; left time: 301.1584s
	iters: 200, epoch: 7 | loss: 0.1983109
	speed: 0.0115s/iter; left time: 89.3234s
	iters: 300, epoch: 7 | loss: 0.1038504
	speed: 0.0115s/iter; left time: 88.0879s
	iters: 400, epoch: 7 | loss: 0.1253054
	speed: 0.0115s/iter; left time: 86.9304s
	iters: 500, epoch: 7 | loss: 0.1448579
	speed: 0.0115s/iter; left time: 85.6584s
Epoch: 7 cost time: 6.857322692871094
Epoch: 7, Steps: 570 | Train Loss: 0.1564264 Vali Loss: 0.0313811 Test Loss: 0.1085556
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1076777
	speed: 0.0389s/iter; left time: 284.0689s
	iters: 200, epoch: 8 | loss: 0.1857146
	speed: 0.0114s/iter; left time: 82.3839s
	iters: 300, epoch: 8 | loss: 0.1267212
	speed: 0.0114s/iter; left time: 81.1951s
	iters: 400, epoch: 8 | loss: 0.1391076
	speed: 0.0114s/iter; left time: 80.1334s
	iters: 500, epoch: 8 | loss: 0.1148637
	speed: 0.0114s/iter; left time: 78.9707s
Epoch: 8 cost time: 6.79107141494751
Epoch: 8, Steps: 570 | Train Loss: 0.1560815 Vali Loss: 0.0314133 Test Loss: 0.1088604
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2353387
	speed: 0.0389s/iter; left time: 262.0769s
	iters: 200, epoch: 9 | loss: 0.1030874
	speed: 0.0114s/iter; left time: 75.9976s
	iters: 300, epoch: 9 | loss: 0.1714372
	speed: 0.0114s/iter; left time: 74.8217s
	iters: 400, epoch: 9 | loss: 0.1623469
	speed: 0.0114s/iter; left time: 73.6649s
	iters: 500, epoch: 9 | loss: 0.2412311
	speed: 0.0114s/iter; left time: 72.5506s
Epoch: 9 cost time: 6.815186500549316
Epoch: 9, Steps: 570 | Train Loss: 0.1555682 Vali Loss: 0.0312154 Test Loss: 0.1087304
Validation loss decreased (0.031268 --> 0.031215).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1525932
	speed: 0.0398s/iter; left time: 245.4679s
	iters: 200, epoch: 10 | loss: 0.1397904
	speed: 0.0115s/iter; left time: 69.5891s
	iters: 300, epoch: 10 | loss: 0.1151299
	speed: 0.0114s/iter; left time: 68.3488s
	iters: 400, epoch: 10 | loss: 0.1559325
	speed: 0.0115s/iter; left time: 67.3305s
	iters: 500, epoch: 10 | loss: 0.1672229
	speed: 0.0115s/iter; left time: 66.1249s
Epoch: 10 cost time: 6.832020282745361
Epoch: 10, Steps: 570 | Train Loss: 0.1566576 Vali Loss: 0.0312890 Test Loss: 0.1087427
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0999604
	speed: 0.0377s/iter; left time: 211.0216s
	iters: 200, epoch: 11 | loss: 0.1711862
	speed: 0.0114s/iter; left time: 62.8356s
	iters: 300, epoch: 11 | loss: 0.1427087
	speed: 0.0114s/iter; left time: 61.6016s
	iters: 400, epoch: 11 | loss: 0.1879228
	speed: 0.0115s/iter; left time: 60.7664s
	iters: 500, epoch: 11 | loss: 0.2188693
	speed: 0.0115s/iter; left time: 59.8659s
Epoch: 11 cost time: 6.840463161468506
Epoch: 11, Steps: 570 | Train Loss: 0.1565516 Vali Loss: 0.0312251 Test Loss: 0.1087238
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1394170
	speed: 0.0388s/iter; left time: 195.1785s
	iters: 200, epoch: 12 | loss: 0.1381668
	speed: 0.0124s/iter; left time: 61.0061s
	iters: 300, epoch: 12 | loss: 0.1242190
	speed: 0.0115s/iter; left time: 55.6905s
	iters: 400, epoch: 12 | loss: 0.2307628
	speed: 0.0115s/iter; left time: 54.4305s
	iters: 500, epoch: 12 | loss: 0.1490344
	speed: 0.0115s/iter; left time: 53.3822s
Epoch: 12 cost time: 7.027728080749512
Epoch: 12, Steps: 570 | Train Loss: 0.1558459 Vali Loss: 0.0314087 Test Loss: 0.1087496
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10887391120195389, mae:0.198089137673378
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3059065
	speed: 0.0240s/iter; left time: 270.7626s
	iters: 200, epoch: 1 | loss: 0.2737502
	speed: 0.0121s/iter; left time: 135.3325s
	iters: 300, epoch: 1 | loss: 0.3231884
	speed: 0.0120s/iter; left time: 133.6449s
	iters: 400, epoch: 1 | loss: 0.2475859
	speed: 0.0120s/iter; left time: 132.5518s
	iters: 500, epoch: 1 | loss: 0.2284089
	speed: 0.0121s/iter; left time: 131.4501s
Epoch: 1 cost time: 8.120875358581543
Epoch: 1, Steps: 570 | Train Loss: 0.2450399 Vali Loss: 0.0431757 Test Loss: 0.1317969
Validation loss decreased (inf --> 0.043176).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2676797
	speed: 0.0399s/iter; left time: 427.8134s
	iters: 200, epoch: 2 | loss: 0.2882361
	speed: 0.0121s/iter; left time: 128.5443s
	iters: 300, epoch: 2 | loss: 0.1485207
	speed: 0.0121s/iter; left time: 127.1323s
	iters: 400, epoch: 2 | loss: 0.1523848
	speed: 0.0120s/iter; left time: 125.2999s
	iters: 500, epoch: 2 | loss: 0.1721504
	speed: 0.0108s/iter; left time: 112.0127s
Epoch: 2 cost time: 6.976976156234741
Epoch: 2, Steps: 570 | Train Loss: 0.2084066 Vali Loss: 0.0420639 Test Loss: 0.1244295
Validation loss decreased (0.043176 --> 0.042064).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1705528
	speed: 0.0374s/iter; left time: 379.9855s
	iters: 200, epoch: 3 | loss: 0.1598030
	speed: 0.0109s/iter; left time: 109.4104s
	iters: 300, epoch: 3 | loss: 0.2289789
	speed: 0.0109s/iter; left time: 108.3635s
	iters: 400, epoch: 3 | loss: 0.1601818
	speed: 0.0109s/iter; left time: 107.4204s
	iters: 500, epoch: 3 | loss: 0.1804475
	speed: 0.0109s/iter; left time: 106.2611s
Epoch: 3 cost time: 6.505877256393433
Epoch: 3, Steps: 570 | Train Loss: 0.1902824 Vali Loss: 0.0413035 Test Loss: 0.1218363
Validation loss decreased (0.042064 --> 0.041304).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1751935
	speed: 0.0377s/iter; left time: 361.1652s
	iters: 200, epoch: 4 | loss: 0.1332253
	speed: 0.0109s/iter; left time: 103.8486s
	iters: 300, epoch: 4 | loss: 0.1604505
	speed: 0.0110s/iter; left time: 102.9555s
	iters: 400, epoch: 4 | loss: 0.2998212
	speed: 0.0109s/iter; left time: 101.4034s
	iters: 500, epoch: 4 | loss: 0.1957961
	speed: 0.0109s/iter; left time: 100.5824s
Epoch: 4 cost time: 6.561441421508789
Epoch: 4, Steps: 570 | Train Loss: 0.1811429 Vali Loss: 0.0391628 Test Loss: 0.1194913
Validation loss decreased (0.041304 --> 0.039163).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1672255
	speed: 0.0385s/iter; left time: 347.4179s
	iters: 200, epoch: 5 | loss: 0.1672589
	speed: 0.0109s/iter; left time: 96.9606s
	iters: 300, epoch: 5 | loss: 0.2072868
	speed: 0.0109s/iter; left time: 96.0347s
	iters: 400, epoch: 5 | loss: 0.1369065
	speed: 0.0109s/iter; left time: 94.8146s
	iters: 500, epoch: 5 | loss: 0.2729971
	speed: 0.0109s/iter; left time: 93.9972s
Epoch: 5 cost time: 6.486450433731079
Epoch: 5, Steps: 570 | Train Loss: 0.1767657 Vali Loss: 0.0388981 Test Loss: 0.1188247
Validation loss decreased (0.039163 --> 0.038898).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1614633
	speed: 0.0373s/iter; left time: 315.3352s
	iters: 200, epoch: 6 | loss: 0.1716885
	speed: 0.0108s/iter; left time: 90.5097s
	iters: 300, epoch: 6 | loss: 0.1799382
	speed: 0.0108s/iter; left time: 89.4641s
	iters: 400, epoch: 6 | loss: 0.1472095
	speed: 0.0108s/iter; left time: 88.3888s
	iters: 500, epoch: 6 | loss: 0.1638059
	speed: 0.0108s/iter; left time: 87.2997s
Epoch: 6 cost time: 6.5075364112854
Epoch: 6, Steps: 570 | Train Loss: 0.1739943 Vali Loss: 0.0392144 Test Loss: 0.1204562
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1445032
	speed: 0.0387s/iter; left time: 304.8591s
	iters: 200, epoch: 7 | loss: 0.1458511
	speed: 0.0109s/iter; left time: 84.9106s
	iters: 300, epoch: 7 | loss: 0.1075231
	speed: 0.0109s/iter; left time: 83.7758s
	iters: 400, epoch: 7 | loss: 0.1690814
	speed: 0.0109s/iter; left time: 82.7612s
	iters: 500, epoch: 7 | loss: 0.1312335
	speed: 0.0109s/iter; left time: 81.6405s
Epoch: 7 cost time: 6.521836042404175
Epoch: 7, Steps: 570 | Train Loss: 0.1724856 Vali Loss: 0.0389544 Test Loss: 0.1188632
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1433409
	speed: 0.0369s/iter; left time: 269.4769s
	iters: 200, epoch: 8 | loss: 0.2169636
	speed: 0.0109s/iter; left time: 78.3633s
	iters: 300, epoch: 8 | loss: 0.2177719
	speed: 0.0109s/iter; left time: 77.3332s
	iters: 400, epoch: 8 | loss: 0.1571627
	speed: 0.0109s/iter; left time: 76.0941s
	iters: 500, epoch: 8 | loss: 0.1202934
	speed: 0.0109s/iter; left time: 75.1974s
Epoch: 8 cost time: 6.474441051483154
Epoch: 8, Steps: 570 | Train Loss: 0.1722129 Vali Loss: 0.0385712 Test Loss: 0.1187824
Validation loss decreased (0.038898 --> 0.038571).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1691125
	speed: 0.0388s/iter; left time: 261.5789s
	iters: 200, epoch: 9 | loss: 0.1330729
	speed: 0.0121s/iter; left time: 80.1124s
	iters: 300, epoch: 9 | loss: 0.1934624
	speed: 0.0121s/iter; left time: 78.9661s
	iters: 400, epoch: 9 | loss: 0.2186877
	speed: 0.0119s/iter; left time: 76.9068s
	iters: 500, epoch: 9 | loss: 0.1144264
	speed: 0.0108s/iter; left time: 68.7142s
Epoch: 9 cost time: 6.9772162437438965
Epoch: 9, Steps: 570 | Train Loss: 0.1712640 Vali Loss: 0.0386326 Test Loss: 0.1186360
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1872510
	speed: 0.0363s/iter; left time: 223.8906s
	iters: 200, epoch: 10 | loss: 0.1101950
	speed: 0.0108s/iter; left time: 65.7720s
	iters: 300, epoch: 10 | loss: 0.1981407
	speed: 0.0108s/iter; left time: 64.7277s
	iters: 400, epoch: 10 | loss: 0.1394067
	speed: 0.0108s/iter; left time: 63.6745s
	iters: 500, epoch: 10 | loss: 0.2065775
	speed: 0.0108s/iter; left time: 62.4906s
Epoch: 10 cost time: 6.459103107452393
Epoch: 10, Steps: 570 | Train Loss: 0.1707153 Vali Loss: 0.0387613 Test Loss: 0.1187380
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1338069
	speed: 0.0374s/iter; left time: 209.3431s
	iters: 200, epoch: 11 | loss: 0.1755780
	speed: 0.0121s/iter; left time: 66.2994s
	iters: 300, epoch: 11 | loss: 0.1517908
	speed: 0.0121s/iter; left time: 65.2348s
	iters: 400, epoch: 11 | loss: 0.1131015
	speed: 0.0118s/iter; left time: 62.5603s
	iters: 500, epoch: 11 | loss: 0.1341830
	speed: 0.0109s/iter; left time: 56.7165s
Epoch: 11 cost time: 6.933863162994385
Epoch: 11, Steps: 570 | Train Loss: 0.1710720 Vali Loss: 0.0387002 Test Loss: 0.1187326
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11894439905881882, mae:0.2141129970550537
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2167726
	speed: 0.0283s/iter; left time: 319.8734s
	iters: 200, epoch: 1 | loss: 0.1834397
	speed: 0.0159s/iter; left time: 178.3737s
	iters: 300, epoch: 1 | loss: 0.3097599
	speed: 0.0145s/iter; left time: 161.4795s
	iters: 400, epoch: 1 | loss: 0.2252580
	speed: 0.0146s/iter; left time: 160.2860s
	iters: 500, epoch: 1 | loss: 0.1791959
	speed: 0.0146s/iter; left time: 159.0785s
Epoch: 1 cost time: 9.870149850845337
Epoch: 1, Steps: 570 | Train Loss: 0.2450417 Vali Loss: 0.0441765 Test Loss: 0.1331939
Validation loss decreased (inf --> 0.044177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2415560
	speed: 0.0511s/iter; left time: 548.7174s
	iters: 200, epoch: 2 | loss: 0.1884318
	speed: 0.0168s/iter; left time: 178.8155s
	iters: 300, epoch: 2 | loss: 0.1717824
	speed: 0.0167s/iter; left time: 176.3399s
	iters: 400, epoch: 2 | loss: 0.1287038
	speed: 0.0168s/iter; left time: 175.5854s
	iters: 500, epoch: 2 | loss: 0.2091839
	speed: 0.0168s/iter; left time: 173.2230s
Epoch: 2 cost time: 9.860525131225586
Epoch: 2, Steps: 570 | Train Loss: 0.2067083 Vali Loss: 0.0420786 Test Loss: 0.1339201
Validation loss decreased (0.044177 --> 0.042079).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3394342
	speed: 0.0492s/iter; left time: 499.9028s
	iters: 200, epoch: 3 | loss: 0.2081882
	speed: 0.0152s/iter; left time: 152.8488s
	iters: 300, epoch: 3 | loss: 0.1111782
	speed: 0.0145s/iter; left time: 144.4224s
	iters: 400, epoch: 3 | loss: 0.1616367
	speed: 0.0145s/iter; left time: 143.1332s
	iters: 500, epoch: 3 | loss: 0.1385147
	speed: 0.0145s/iter; left time: 141.3561s
Epoch: 3 cost time: 8.810574769973755
Epoch: 3, Steps: 570 | Train Loss: 0.1899784 Vali Loss: 0.0385048 Test Loss: 0.1220661
Validation loss decreased (0.042079 --> 0.038505).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1740040
	speed: 0.0472s/iter; left time: 453.1233s
	iters: 200, epoch: 4 | loss: 0.1524063
	speed: 0.0145s/iter; left time: 137.8705s
	iters: 300, epoch: 4 | loss: 0.1879634
	speed: 0.0145s/iter; left time: 136.5785s
	iters: 400, epoch: 4 | loss: 0.1962401
	speed: 0.0145s/iter; left time: 134.8697s
	iters: 500, epoch: 4 | loss: 0.1578258
	speed: 0.0145s/iter; left time: 133.5183s
Epoch: 4 cost time: 8.57285213470459
Epoch: 4, Steps: 570 | Train Loss: 0.1817282 Vali Loss: 0.0374422 Test Loss: 0.1222099
Validation loss decreased (0.038505 --> 0.037442).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1531262
	speed: 0.0467s/iter; left time: 421.2899s
	iters: 200, epoch: 5 | loss: 0.1575074
	speed: 0.0145s/iter; left time: 129.5178s
	iters: 300, epoch: 5 | loss: 0.1539699
	speed: 0.0145s/iter; left time: 128.2318s
	iters: 400, epoch: 5 | loss: 0.2075742
	speed: 0.0145s/iter; left time: 126.3961s
	iters: 500, epoch: 5 | loss: 0.2027942
	speed: 0.0145s/iter; left time: 125.2037s
Epoch: 5 cost time: 8.587470769882202
Epoch: 5, Steps: 570 | Train Loss: 0.1787642 Vali Loss: 0.0370470 Test Loss: 0.1194206
Validation loss decreased (0.037442 --> 0.037047).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1353499
	speed: 0.0458s/iter; left time: 387.2726s
	iters: 200, epoch: 6 | loss: 0.1671976
	speed: 0.0146s/iter; left time: 121.7180s
	iters: 300, epoch: 6 | loss: 0.1244141
	speed: 0.0146s/iter; left time: 120.4045s
	iters: 400, epoch: 6 | loss: 0.1210807
	speed: 0.0146s/iter; left time: 118.7803s
	iters: 500, epoch: 6 | loss: 0.1896802
	speed: 0.0146s/iter; left time: 117.3584s
Epoch: 6 cost time: 8.608338117599487
Epoch: 6, Steps: 570 | Train Loss: 0.1749954 Vali Loss: 0.0370123 Test Loss: 0.1199432
Validation loss decreased (0.037047 --> 0.037012).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1805391
	speed: 0.0491s/iter; left time: 386.7613s
	iters: 200, epoch: 7 | loss: 0.1321836
	speed: 0.0147s/iter; left time: 114.6823s
	iters: 300, epoch: 7 | loss: 0.1360212
	speed: 0.0147s/iter; left time: 112.9716s
	iters: 400, epoch: 7 | loss: 0.1530548
	speed: 0.0147s/iter; left time: 111.1774s
	iters: 500, epoch: 7 | loss: 0.2867018
	speed: 0.0147s/iter; left time: 109.9165s
Epoch: 7 cost time: 8.696028470993042
Epoch: 7, Steps: 570 | Train Loss: 0.1749006 Vali Loss: 0.0368639 Test Loss: 0.1194540
Validation loss decreased (0.037012 --> 0.036864).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2613420
	speed: 0.0457s/iter; left time: 333.9591s
	iters: 200, epoch: 8 | loss: 0.2187726
	speed: 0.0145s/iter; left time: 104.9099s
	iters: 300, epoch: 8 | loss: 0.2201245
	speed: 0.0146s/iter; left time: 103.4960s
	iters: 400, epoch: 8 | loss: 0.1328292
	speed: 0.0145s/iter; left time: 101.7845s
	iters: 500, epoch: 8 | loss: 0.1874684
	speed: 0.0145s/iter; left time: 100.3716s
Epoch: 8 cost time: 8.55875015258789
Epoch: 8, Steps: 570 | Train Loss: 0.1744350 Vali Loss: 0.0369365 Test Loss: 0.1196728
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2474883
	speed: 0.0472s/iter; left time: 318.1204s
	iters: 200, epoch: 9 | loss: 0.2378532
	speed: 0.0145s/iter; left time: 96.3916s
	iters: 300, epoch: 9 | loss: 0.2754472
	speed: 0.0145s/iter; left time: 94.9865s
	iters: 400, epoch: 9 | loss: 0.1970205
	speed: 0.0145s/iter; left time: 93.6815s
	iters: 500, epoch: 9 | loss: 0.1458042
	speed: 0.0145s/iter; left time: 91.9050s
Epoch: 9 cost time: 8.51830005645752
Epoch: 9, Steps: 570 | Train Loss: 0.1737375 Vali Loss: 0.0369257 Test Loss: 0.1192469
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1998157
	speed: 0.0453s/iter; left time: 279.4586s
	iters: 200, epoch: 10 | loss: 0.1477786
	speed: 0.0146s/iter; left time: 88.3686s
	iters: 300, epoch: 10 | loss: 0.1360759
	speed: 0.0145s/iter; left time: 86.8517s
	iters: 400, epoch: 10 | loss: 0.1441279
	speed: 0.0145s/iter; left time: 85.0904s
	iters: 500, epoch: 10 | loss: 0.2008854
	speed: 0.0146s/iter; left time: 83.9743s
Epoch: 10 cost time: 8.557718276977539
Epoch: 10, Steps: 570 | Train Loss: 0.1744781 Vali Loss: 0.0366690 Test Loss: 0.1191785
Validation loss decreased (0.036864 --> 0.036669).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1552098
	speed: 0.0463s/iter; left time: 259.5450s
	iters: 200, epoch: 11 | loss: 0.1430847
	speed: 0.0144s/iter; left time: 79.3599s
	iters: 300, epoch: 11 | loss: 0.1563972
	speed: 0.0144s/iter; left time: 77.9159s
	iters: 400, epoch: 11 | loss: 0.1357811
	speed: 0.0145s/iter; left time: 76.9779s
	iters: 500, epoch: 11 | loss: 0.1447430
	speed: 0.0146s/iter; left time: 75.7060s
Epoch: 11 cost time: 8.55006718635559
Epoch: 11, Steps: 570 | Train Loss: 0.1743035 Vali Loss: 0.0367894 Test Loss: 0.1191359
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1334599
	speed: 0.0481s/iter; left time: 241.9582s
	iters: 200, epoch: 12 | loss: 0.1164096
	speed: 0.0147s/iter; left time: 72.2696s
	iters: 300, epoch: 12 | loss: 0.2074345
	speed: 0.0147s/iter; left time: 70.8111s
	iters: 400, epoch: 12 | loss: 0.1870444
	speed: 0.0146s/iter; left time: 69.2633s
	iters: 500, epoch: 12 | loss: 0.1454222
	speed: 0.0146s/iter; left time: 67.5228s
Epoch: 12 cost time: 8.636688232421875
Epoch: 12, Steps: 570 | Train Loss: 0.1735718 Vali Loss: 0.0368066 Test Loss: 0.1192624
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1866234
	speed: 0.0485s/iter; left time: 216.3967s
	iters: 200, epoch: 13 | loss: 0.2737667
	speed: 0.0163s/iter; left time: 71.2683s
	iters: 300, epoch: 13 | loss: 0.2283096
	speed: 0.0163s/iter; left time: 69.5812s
	iters: 400, epoch: 13 | loss: 0.1208643
	speed: 0.0163s/iter; left time: 67.7476s
	iters: 500, epoch: 13 | loss: 0.1841916
	speed: 0.0163s/iter; left time: 66.0849s
Epoch: 13 cost time: 9.614113569259644
Epoch: 13, Steps: 570 | Train Loss: 0.1736273 Vali Loss: 0.0367905 Test Loss: 0.1192441
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11934473365545273, mae:0.2106429487466812
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3230739
	speed: 0.0268s/iter; left time: 302.4545s
	iters: 200, epoch: 1 | loss: 0.2487925
	speed: 0.0144s/iter; left time: 161.1509s
	iters: 300, epoch: 1 | loss: 0.1291303
	speed: 0.0143s/iter; left time: 159.2251s
	iters: 400, epoch: 1 | loss: 0.3135703
	speed: 0.0144s/iter; left time: 158.1962s
	iters: 500, epoch: 1 | loss: 0.1859436
	speed: 0.0144s/iter; left time: 156.8208s
Epoch: 1 cost time: 9.483754634857178
Epoch: 1, Steps: 570 | Train Loss: 0.2187694 Vali Loss: 0.0367812 Test Loss: 0.1119486
Validation loss decreased (inf --> 0.036781).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1615953
	speed: 0.0460s/iter; left time: 493.9548s
	iters: 200, epoch: 2 | loss: 0.2700863
	speed: 0.0165s/iter; left time: 175.1453s
	iters: 300, epoch: 2 | loss: 0.1883779
	speed: 0.0165s/iter; left time: 173.5154s
	iters: 400, epoch: 2 | loss: 0.1708111
	speed: 0.0165s/iter; left time: 171.8406s
	iters: 500, epoch: 2 | loss: 0.1733276
	speed: 0.0165s/iter; left time: 170.1287s
Epoch: 2 cost time: 9.493303775787354
Epoch: 2, Steps: 570 | Train Loss: 0.1877026 Vali Loss: 0.0355086 Test Loss: 0.1129241
Validation loss decreased (0.036781 --> 0.035509).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1765935
	speed: 0.0490s/iter; left time: 497.6342s
	iters: 200, epoch: 3 | loss: 0.0953627
	speed: 0.0164s/iter; left time: 165.1556s
	iters: 300, epoch: 3 | loss: 0.2513504
	speed: 0.0164s/iter; left time: 163.4051s
	iters: 400, epoch: 3 | loss: 0.1355092
	speed: 0.0164s/iter; left time: 161.7642s
	iters: 500, epoch: 3 | loss: 0.1496388
	speed: 0.0164s/iter; left time: 159.9796s
Epoch: 3 cost time: 9.321431159973145
Epoch: 3, Steps: 570 | Train Loss: 0.1742259 Vali Loss: 0.0344777 Test Loss: 0.1114840
Validation loss decreased (0.035509 --> 0.034478).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1729999
	speed: 0.0501s/iter; left time: 480.6183s
	iters: 200, epoch: 4 | loss: 0.1659377
	speed: 0.0164s/iter; left time: 155.4486s
	iters: 300, epoch: 4 | loss: 0.2141808
	speed: 0.0164s/iter; left time: 153.7234s
	iters: 400, epoch: 4 | loss: 0.1064999
	speed: 0.0163s/iter; left time: 151.3961s
	iters: 500, epoch: 4 | loss: 0.1109399
	speed: 0.0163s/iter; left time: 150.0431s
Epoch: 4 cost time: 9.585179805755615
Epoch: 4, Steps: 570 | Train Loss: 0.1698102 Vali Loss: 0.0334893 Test Loss: 0.1089157
Validation loss decreased (0.034478 --> 0.033489).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0924286
	speed: 0.0493s/iter; left time: 445.0573s
	iters: 200, epoch: 5 | loss: 0.1825116
	speed: 0.0164s/iter; left time: 146.3284s
	iters: 300, epoch: 5 | loss: 0.2019356
	speed: 0.0164s/iter; left time: 144.3953s
	iters: 400, epoch: 5 | loss: 0.1343013
	speed: 0.0164s/iter; left time: 143.2492s
	iters: 500, epoch: 5 | loss: 0.1753863
	speed: 0.0165s/iter; left time: 142.2478s
Epoch: 5 cost time: 9.661692380905151
Epoch: 5, Steps: 570 | Train Loss: 0.1663471 Vali Loss: 0.0334223 Test Loss: 0.1087708
Validation loss decreased (0.033489 --> 0.033422).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1363288
	speed: 0.0495s/iter; left time: 418.4244s
	iters: 200, epoch: 6 | loss: 0.3008175
	speed: 0.0160s/iter; left time: 133.6828s
	iters: 300, epoch: 6 | loss: 0.2603256
	speed: 0.0161s/iter; left time: 132.6049s
	iters: 400, epoch: 6 | loss: 0.1751878
	speed: 0.0160s/iter; left time: 130.6256s
	iters: 500, epoch: 6 | loss: 0.1767675
	speed: 0.0160s/iter; left time: 129.1416s
Epoch: 6 cost time: 9.459484815597534
Epoch: 6, Steps: 570 | Train Loss: 0.1655399 Vali Loss: 0.0328816 Test Loss: 0.1075305
Validation loss decreased (0.033422 --> 0.032882).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1137792
	speed: 0.0471s/iter; left time: 371.1622s
	iters: 200, epoch: 7 | loss: 0.1645022
	speed: 0.0143s/iter; left time: 111.1763s
	iters: 300, epoch: 7 | loss: 0.2490925
	speed: 0.0143s/iter; left time: 109.6960s
	iters: 400, epoch: 7 | loss: 0.1427208
	speed: 0.0143s/iter; left time: 108.0402s
	iters: 500, epoch: 7 | loss: 0.2128087
	speed: 0.0143s/iter; left time: 106.7018s
Epoch: 7 cost time: 8.433992147445679
Epoch: 7, Steps: 570 | Train Loss: 0.1638563 Vali Loss: 0.0328501 Test Loss: 0.1075453
Validation loss decreased (0.032882 --> 0.032850).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1055184
	speed: 0.0460s/iter; left time: 336.2463s
	iters: 200, epoch: 8 | loss: 0.1524740
	speed: 0.0142s/iter; left time: 102.5927s
	iters: 300, epoch: 8 | loss: 0.2451741
	speed: 0.0142s/iter; left time: 101.1899s
	iters: 400, epoch: 8 | loss: 0.1768970
	speed: 0.0142s/iter; left time: 99.4525s
	iters: 500, epoch: 8 | loss: 0.1730819
	speed: 0.0143s/iter; left time: 98.7556s
Epoch: 8 cost time: 8.386746168136597
Epoch: 8, Steps: 570 | Train Loss: 0.1632265 Vali Loss: 0.0329301 Test Loss: 0.1077431
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1219473
	speed: 0.0479s/iter; left time: 322.7229s
	iters: 200, epoch: 9 | loss: 0.1291988
	speed: 0.0142s/iter; left time: 94.6083s
	iters: 300, epoch: 9 | loss: 0.1806177
	speed: 0.0142s/iter; left time: 93.1927s
	iters: 400, epoch: 9 | loss: 0.1606346
	speed: 0.0142s/iter; left time: 91.7371s
	iters: 500, epoch: 9 | loss: 0.1853399
	speed: 0.0142s/iter; left time: 90.1899s
Epoch: 9 cost time: 8.416950941085815
Epoch: 9, Steps: 570 | Train Loss: 0.1631130 Vali Loss: 0.0327687 Test Loss: 0.1077360
Validation loss decreased (0.032850 --> 0.032769).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1848225
	speed: 0.0481s/iter; left time: 296.7070s
	iters: 200, epoch: 10 | loss: 0.1568534
	speed: 0.0143s/iter; left time: 86.5389s
	iters: 300, epoch: 10 | loss: 0.1562719
	speed: 0.0142s/iter; left time: 85.0617s
	iters: 400, epoch: 10 | loss: 0.1687929
	speed: 0.0142s/iter; left time: 83.6076s
	iters: 500, epoch: 10 | loss: 0.2149202
	speed: 0.0143s/iter; left time: 82.3483s
Epoch: 10 cost time: 8.439673662185669
Epoch: 10, Steps: 570 | Train Loss: 0.1628169 Vali Loss: 0.0327760 Test Loss: 0.1076413
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2316905
	speed: 0.0468s/iter; left time: 261.9121s
	iters: 200, epoch: 11 | loss: 0.1681755
	speed: 0.0141s/iter; left time: 77.8225s
	iters: 300, epoch: 11 | loss: 0.1939025
	speed: 0.0142s/iter; left time: 76.4648s
	iters: 400, epoch: 11 | loss: 0.1152691
	speed: 0.0142s/iter; left time: 75.0431s
	iters: 500, epoch: 11 | loss: 0.2666770
	speed: 0.0142s/iter; left time: 73.6009s
Epoch: 11 cost time: 8.339339017868042
Epoch: 11, Steps: 570 | Train Loss: 0.1618295 Vali Loss: 0.0327559 Test Loss: 0.1076812
Validation loss decreased (0.032769 --> 0.032756).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2332382
	speed: 0.0459s/iter; left time: 231.0152s
	iters: 200, epoch: 12 | loss: 0.1990643
	speed: 0.0143s/iter; left time: 70.4871s
	iters: 300, epoch: 12 | loss: 0.1215841
	speed: 0.0143s/iter; left time: 68.9968s
	iters: 400, epoch: 12 | loss: 0.1708272
	speed: 0.0143s/iter; left time: 67.5711s
	iters: 500, epoch: 12 | loss: 0.1868755
	speed: 0.0143s/iter; left time: 66.1807s
Epoch: 12 cost time: 8.447917461395264
Epoch: 12, Steps: 570 | Train Loss: 0.1638072 Vali Loss: 0.0328175 Test Loss: 0.1076672
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1394779
	speed: 0.0458s/iter; left time: 204.1421s
	iters: 200, epoch: 13 | loss: 0.1236927
	speed: 0.0142s/iter; left time: 61.8675s
	iters: 300, epoch: 13 | loss: 0.1323943
	speed: 0.0142s/iter; left time: 60.3749s
	iters: 400, epoch: 13 | loss: 0.0949029
	speed: 0.0141s/iter; left time: 58.7910s
	iters: 500, epoch: 13 | loss: 0.1751146
	speed: 0.0141s/iter; left time: 57.3542s
Epoch: 13 cost time: 8.324563264846802
Epoch: 13, Steps: 570 | Train Loss: 0.1628508 Vali Loss: 0.0326996 Test Loss: 0.1076649
Validation loss decreased (0.032756 --> 0.032700).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1346692
	speed: 0.0456s/iter; left time: 177.4224s
	iters: 200, epoch: 14 | loss: 0.2459736
	speed: 0.0142s/iter; left time: 53.8837s
	iters: 300, epoch: 14 | loss: 0.1126859
	speed: 0.0142s/iter; left time: 52.4176s
	iters: 400, epoch: 14 | loss: 0.1289571
	speed: 0.0142s/iter; left time: 50.9620s
	iters: 500, epoch: 14 | loss: 0.1478224
	speed: 0.0142s/iter; left time: 49.7121s
Epoch: 14 cost time: 8.409562826156616
Epoch: 14, Steps: 570 | Train Loss: 0.1616575 Vali Loss: 0.0327439 Test Loss: 0.1076713
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1395341
	speed: 0.0465s/iter; left time: 154.5477s
	iters: 200, epoch: 15 | loss: 0.1093530
	speed: 0.0143s/iter; left time: 46.0819s
	iters: 300, epoch: 15 | loss: 0.1623834
	speed: 0.0143s/iter; left time: 44.5513s
	iters: 400, epoch: 15 | loss: 0.1505805
	speed: 0.0143s/iter; left time: 43.2208s
	iters: 500, epoch: 15 | loss: 0.2240412
	speed: 0.0143s/iter; left time: 41.7750s
Epoch: 15 cost time: 8.42960810661316
Epoch: 15, Steps: 570 | Train Loss: 0.1623262 Vali Loss: 0.0327374 Test Loss: 0.1076703
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1810603
	speed: 0.0461s/iter; left time: 126.7784s
	iters: 200, epoch: 16 | loss: 0.1773026
	speed: 0.0143s/iter; left time: 37.8312s
	iters: 300, epoch: 16 | loss: 0.1407213
	speed: 0.0143s/iter; left time: 36.3939s
	iters: 400, epoch: 16 | loss: 0.1876066
	speed: 0.0143s/iter; left time: 34.9389s
	iters: 500, epoch: 16 | loss: 0.1328565
	speed: 0.0143s/iter; left time: 33.5363s
Epoch: 16 cost time: 8.433439016342163
Epoch: 16, Steps: 570 | Train Loss: 0.1619266 Vali Loss: 0.0328557 Test Loss: 0.1076714
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1078135147690773, mae:0.1963559091091156
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1469629
	speed: 0.0264s/iter; left time: 298.1687s
	iters: 200, epoch: 1 | loss: 0.3179166
	speed: 0.0145s/iter; left time: 162.4787s
	iters: 300, epoch: 1 | loss: 0.3197975
	speed: 0.0145s/iter; left time: 160.6179s
	iters: 400, epoch: 1 | loss: 0.2389847
	speed: 0.0145s/iter; left time: 159.9809s
	iters: 500, epoch: 1 | loss: 0.2648219
	speed: 0.0145s/iter; left time: 158.3036s
Epoch: 1 cost time: 9.517126560211182
Epoch: 1, Steps: 570 | Train Loss: 0.2509745 Vali Loss: 0.0440646 Test Loss: 0.1338914
Validation loss decreased (inf --> 0.044065).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1855400
	speed: 0.0479s/iter; left time: 513.5786s
	iters: 200, epoch: 2 | loss: 0.1298666
	speed: 0.0144s/iter; left time: 153.3624s
	iters: 300, epoch: 2 | loss: 0.1377157
	speed: 0.0144s/iter; left time: 151.9331s
	iters: 400, epoch: 2 | loss: 0.1488576
	speed: 0.0144s/iter; left time: 150.3182s
	iters: 500, epoch: 2 | loss: 0.2571372
	speed: 0.0144s/iter; left time: 148.8761s
Epoch: 2 cost time: 8.566364049911499
Epoch: 2, Steps: 570 | Train Loss: 0.2121049 Vali Loss: 0.0422762 Test Loss: 0.1261149
Validation loss decreased (0.044065 --> 0.042276).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2350141
	speed: 0.0488s/iter; left time: 495.5341s
	iters: 200, epoch: 3 | loss: 0.2209245
	speed: 0.0143s/iter; left time: 143.7416s
	iters: 300, epoch: 3 | loss: 0.1703092
	speed: 0.0143s/iter; left time: 142.4378s
	iters: 400, epoch: 3 | loss: 0.1649446
	speed: 0.0143s/iter; left time: 140.7350s
	iters: 500, epoch: 3 | loss: 0.2347749
	speed: 0.0143s/iter; left time: 139.5791s
Epoch: 3 cost time: 8.501073598861694
Epoch: 3, Steps: 570 | Train Loss: 0.1959081 Vali Loss: 0.0407369 Test Loss: 0.1245840
Validation loss decreased (0.042276 --> 0.040737).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2508076
	speed: 0.0496s/iter; left time: 476.0394s
	iters: 200, epoch: 4 | loss: 0.1658720
	speed: 0.0162s/iter; left time: 153.3938s
	iters: 300, epoch: 4 | loss: 0.2019032
	speed: 0.0160s/iter; left time: 149.8702s
	iters: 400, epoch: 4 | loss: 0.1830573
	speed: 0.0150s/iter; left time: 139.3838s
	iters: 500, epoch: 4 | loss: 0.1332845
	speed: 0.0162s/iter; left time: 148.5317s
Epoch: 4 cost time: 9.441164016723633
Epoch: 4, Steps: 570 | Train Loss: 0.1896349 Vali Loss: 0.0393675 Test Loss: 0.1208681
Validation loss decreased (0.040737 --> 0.039367).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1568950
	speed: 0.0486s/iter; left time: 438.2920s
	iters: 200, epoch: 5 | loss: 0.1988941
	speed: 0.0143s/iter; left time: 127.4450s
	iters: 300, epoch: 5 | loss: 0.1730237
	speed: 0.0143s/iter; left time: 126.0138s
	iters: 400, epoch: 5 | loss: 0.2516692
	speed: 0.0143s/iter; left time: 124.5407s
	iters: 500, epoch: 5 | loss: 0.1377376
	speed: 0.0143s/iter; left time: 123.1296s
Epoch: 5 cost time: 8.469141006469727
Epoch: 5, Steps: 570 | Train Loss: 0.1855682 Vali Loss: 0.0391606 Test Loss: 0.1201594
Validation loss decreased (0.039367 --> 0.039161).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2225715
	speed: 0.0474s/iter; left time: 400.4604s
	iters: 200, epoch: 6 | loss: 0.1699176
	speed: 0.0143s/iter; left time: 119.1986s
	iters: 300, epoch: 6 | loss: 0.1154262
	speed: 0.0143s/iter; left time: 117.7507s
	iters: 400, epoch: 6 | loss: 0.1992546
	speed: 0.0143s/iter; left time: 116.3268s
	iters: 500, epoch: 6 | loss: 0.1731847
	speed: 0.0143s/iter; left time: 114.8606s
Epoch: 6 cost time: 8.4952712059021
Epoch: 6, Steps: 570 | Train Loss: 0.1828942 Vali Loss: 0.0389261 Test Loss: 0.1218258
Validation loss decreased (0.039161 --> 0.038926).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2352667
	speed: 0.0488s/iter; left time: 384.3643s
	iters: 200, epoch: 7 | loss: 0.1074341
	speed: 0.0161s/iter; left time: 125.5220s
	iters: 300, epoch: 7 | loss: 0.1429074
	speed: 0.0161s/iter; left time: 123.7020s
	iters: 400, epoch: 7 | loss: 0.2743106
	speed: 0.0161s/iter; left time: 121.9266s
	iters: 500, epoch: 7 | loss: 0.1668637
	speed: 0.0153s/iter; left time: 114.4301s
Epoch: 7 cost time: 9.293813705444336
Epoch: 7, Steps: 570 | Train Loss: 0.1840404 Vali Loss: 0.0387647 Test Loss: 0.1200844
Validation loss decreased (0.038926 --> 0.038765).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1498211
	speed: 0.0479s/iter; left time: 350.0392s
	iters: 200, epoch: 8 | loss: 0.1567590
	speed: 0.0143s/iter; left time: 103.1245s
	iters: 300, epoch: 8 | loss: 0.1566342
	speed: 0.0144s/iter; left time: 102.2557s
	iters: 400, epoch: 8 | loss: 0.1933138
	speed: 0.0143s/iter; left time: 100.3813s
	iters: 500, epoch: 8 | loss: 0.1202289
	speed: 0.0144s/iter; left time: 99.1789s
Epoch: 8 cost time: 8.61384630203247
Epoch: 8, Steps: 570 | Train Loss: 0.1832267 Vali Loss: 0.0390567 Test Loss: 0.1209443
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2395315
	speed: 0.0492s/iter; left time: 331.6256s
	iters: 200, epoch: 9 | loss: 0.1514681
	speed: 0.0144s/iter; left time: 95.7583s
	iters: 300, epoch: 9 | loss: 0.1267509
	speed: 0.0144s/iter; left time: 94.1088s
	iters: 400, epoch: 9 | loss: 0.1650192
	speed: 0.0143s/iter; left time: 92.3014s
	iters: 500, epoch: 9 | loss: 0.1709631
	speed: 0.0144s/iter; left time: 91.0858s
Epoch: 9 cost time: 8.537040948867798
Epoch: 9, Steps: 570 | Train Loss: 0.1813043 Vali Loss: 0.0388237 Test Loss: 0.1210111
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2333269
	speed: 0.0469s/iter; left time: 289.7228s
	iters: 200, epoch: 10 | loss: 0.2065901
	speed: 0.0144s/iter; left time: 87.7156s
	iters: 300, epoch: 10 | loss: 0.1792526
	speed: 0.0144s/iter; left time: 85.7174s
	iters: 400, epoch: 10 | loss: 0.2072501
	speed: 0.0144s/iter; left time: 84.3475s
	iters: 500, epoch: 10 | loss: 0.1652863
	speed: 0.0144s/iter; left time: 82.8374s
Epoch: 10 cost time: 8.4965980052948
Epoch: 10, Steps: 570 | Train Loss: 0.1810540 Vali Loss: 0.0388431 Test Loss: 0.1207669
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12025460600852966, mae:0.21314102411270142
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2807164
	speed: 0.0288s/iter; left time: 325.3063s
	iters: 200, epoch: 1 | loss: 0.1994449
	speed: 0.0170s/iter; left time: 190.0256s
	iters: 300, epoch: 1 | loss: 0.2542409
	speed: 0.0169s/iter; left time: 188.1471s
	iters: 400, epoch: 1 | loss: 0.2241962
	speed: 0.0170s/iter; left time: 186.7053s
	iters: 500, epoch: 1 | loss: 0.1999758
	speed: 0.0170s/iter; left time: 185.0748s
Epoch: 1 cost time: 10.910790920257568
Epoch: 1, Steps: 570 | Train Loss: 0.2381237 Vali Loss: 0.0437958 Test Loss: 0.1303702
Validation loss decreased (inf --> 0.043796).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2267788
	speed: 0.0528s/iter; left time: 566.5389s
	iters: 200, epoch: 2 | loss: 0.2498884
	speed: 0.0169s/iter; left time: 179.6097s
	iters: 300, epoch: 2 | loss: 0.2195622
	speed: 0.0169s/iter; left time: 177.8815s
	iters: 400, epoch: 2 | loss: 0.1399293
	speed: 0.0169s/iter; left time: 176.2882s
	iters: 500, epoch: 2 | loss: 0.1576113
	speed: 0.0169s/iter; left time: 174.6298s
Epoch: 2 cost time: 9.95423436164856
Epoch: 2, Steps: 570 | Train Loss: 0.1979245 Vali Loss: 0.0395067 Test Loss: 0.1271103
Validation loss decreased (0.043796 --> 0.039507).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1486230
	speed: 0.0520s/iter; left time: 528.0409s
	iters: 200, epoch: 3 | loss: 0.1651161
	speed: 0.0169s/iter; left time: 170.5032s
	iters: 300, epoch: 3 | loss: 0.2907280
	speed: 0.0170s/iter; left time: 168.8497s
	iters: 400, epoch: 3 | loss: 0.1437851
	speed: 0.0169s/iter; left time: 166.7123s
	iters: 500, epoch: 3 | loss: 0.1431609
	speed: 0.0169s/iter; left time: 164.9023s
Epoch: 3 cost time: 9.929981231689453
Epoch: 3, Steps: 570 | Train Loss: 0.1768802 Vali Loss: 0.0373004 Test Loss: 0.1236406
Validation loss decreased (0.039507 --> 0.037300).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1289243
	speed: 0.0530s/iter; left time: 508.7331s
	iters: 200, epoch: 4 | loss: 0.1872966
	speed: 0.0170s/iter; left time: 160.9338s
	iters: 300, epoch: 4 | loss: 0.1971416
	speed: 0.0169s/iter; left time: 159.1409s
	iters: 400, epoch: 4 | loss: 0.2076066
	speed: 0.0170s/iter; left time: 157.5485s
	iters: 500, epoch: 4 | loss: 0.1533278
	speed: 0.0170s/iter; left time: 155.8126s
Epoch: 4 cost time: 9.97232460975647
Epoch: 4, Steps: 570 | Train Loss: 0.1660419 Vali Loss: 0.0349997 Test Loss: 0.1204328
Validation loss decreased (0.037300 --> 0.035000).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1321922
	speed: 0.0510s/iter; left time: 460.2842s
	iters: 200, epoch: 5 | loss: 0.2033115
	speed: 0.0170s/iter; left time: 151.2562s
	iters: 300, epoch: 5 | loss: 0.1826844
	speed: 0.0169s/iter; left time: 149.2893s
	iters: 400, epoch: 5 | loss: 0.1735277
	speed: 0.0169s/iter; left time: 147.6575s
	iters: 500, epoch: 5 | loss: 0.1227321
	speed: 0.0169s/iter; left time: 145.9401s
Epoch: 5 cost time: 9.965690851211548
Epoch: 5, Steps: 570 | Train Loss: 0.1602384 Vali Loss: 0.0347689 Test Loss: 0.1204603
Validation loss decreased (0.035000 --> 0.034769).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1950388
	speed: 0.0540s/iter; left time: 456.7097s
	iters: 200, epoch: 6 | loss: 0.1227389
	speed: 0.0169s/iter; left time: 141.0803s
	iters: 300, epoch: 6 | loss: 0.1735075
	speed: 0.0169s/iter; left time: 139.3627s
	iters: 400, epoch: 6 | loss: 0.2130548
	speed: 0.0169s/iter; left time: 137.6771s
	iters: 500, epoch: 6 | loss: 0.1318509
	speed: 0.0169s/iter; left time: 135.9820s
Epoch: 6 cost time: 10.116937637329102
Epoch: 6, Steps: 570 | Train Loss: 0.1573654 Vali Loss: 0.0346455 Test Loss: 0.1200864
Validation loss decreased (0.034769 --> 0.034646).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1442911
	speed: 0.0521s/iter; left time: 410.2196s
	iters: 200, epoch: 7 | loss: 0.1986550
	speed: 0.0170s/iter; left time: 132.0262s
	iters: 300, epoch: 7 | loss: 0.1928933
	speed: 0.0170s/iter; left time: 130.3276s
	iters: 400, epoch: 7 | loss: 0.1173649
	speed: 0.0170s/iter; left time: 128.6015s
	iters: 500, epoch: 7 | loss: 0.1246245
	speed: 0.0183s/iter; left time: 136.6695s
Epoch: 7 cost time: 10.265721082687378
Epoch: 7, Steps: 570 | Train Loss: 0.1556588 Vali Loss: 0.0342328 Test Loss: 0.1201242
Validation loss decreased (0.034646 --> 0.034233).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1714974
	speed: 0.0535s/iter; left time: 390.9720s
	iters: 200, epoch: 8 | loss: 0.1074537
	speed: 0.0169s/iter; left time: 121.8017s
	iters: 300, epoch: 8 | loss: 0.1497885
	speed: 0.0169s/iter; left time: 120.1036s
	iters: 400, epoch: 8 | loss: 0.0966494
	speed: 0.0169s/iter; left time: 118.5242s
	iters: 500, epoch: 8 | loss: 0.1098924
	speed: 0.0169s/iter; left time: 116.8423s
Epoch: 8 cost time: 9.961990594863892
Epoch: 8, Steps: 570 | Train Loss: 0.1553105 Vali Loss: 0.0344104 Test Loss: 0.1205098
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1266415
	speed: 0.0508s/iter; left time: 342.1345s
	iters: 200, epoch: 9 | loss: 0.0931378
	speed: 0.0169s/iter; left time: 112.4913s
	iters: 300, epoch: 9 | loss: 0.1561387
	speed: 0.0169s/iter; left time: 110.8588s
	iters: 400, epoch: 9 | loss: 0.1585056
	speed: 0.0169s/iter; left time: 109.0994s
	iters: 500, epoch: 9 | loss: 0.2204621
	speed: 0.0169s/iter; left time: 107.4323s
Epoch: 9 cost time: 9.992456436157227
Epoch: 9, Steps: 570 | Train Loss: 0.1537810 Vali Loss: 0.0342483 Test Loss: 0.1203181
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2070161
	speed: 0.0502s/iter; left time: 310.0184s
	iters: 200, epoch: 10 | loss: 0.0768331
	speed: 0.0169s/iter; left time: 102.6042s
	iters: 300, epoch: 10 | loss: 0.2067846
	speed: 0.0169s/iter; left time: 100.9767s
	iters: 400, epoch: 10 | loss: 0.1695709
	speed: 0.0169s/iter; left time: 99.2124s
	iters: 500, epoch: 10 | loss: 0.1195202
	speed: 0.0169s/iter; left time: 97.5734s
Epoch: 10 cost time: 9.928817749023438
Epoch: 10, Steps: 570 | Train Loss: 0.1544903 Vali Loss: 0.0344964 Test Loss: 0.1203680
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12027682363986969, mae:0.21584366261959076
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1919311
	speed: 0.0301s/iter; left time: 339.6413s
	iters: 200, epoch: 1 | loss: 0.1355707
	speed: 0.0179s/iter; left time: 200.0537s
	iters: 300, epoch: 1 | loss: 0.2324904
	speed: 0.0178s/iter; left time: 198.0977s
	iters: 400, epoch: 1 | loss: 0.2188273
	speed: 0.0179s/iter; left time: 196.8822s
	iters: 500, epoch: 1 | loss: 0.1164604
	speed: 0.0179s/iter; left time: 195.0143s
Epoch: 1 cost time: 11.414002418518066
Epoch: 1, Steps: 570 | Train Loss: 0.2136093 Vali Loss: 0.0361288 Test Loss: 0.1138234
Validation loss decreased (inf --> 0.036129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1510792
	speed: 0.0533s/iter; left time: 572.1839s
	iters: 200, epoch: 2 | loss: 0.1406453
	speed: 0.0179s/iter; left time: 190.6888s
	iters: 300, epoch: 2 | loss: 0.2300675
	speed: 0.0179s/iter; left time: 188.5501s
	iters: 400, epoch: 2 | loss: 0.2397196
	speed: 0.0179s/iter; left time: 186.3122s
	iters: 500, epoch: 2 | loss: 0.1692325
	speed: 0.0179s/iter; left time: 184.9823s
Epoch: 2 cost time: 10.522971630096436
Epoch: 2, Steps: 570 | Train Loss: 0.1819060 Vali Loss: 0.0354373 Test Loss: 0.1129405
Validation loss decreased (0.036129 --> 0.035437).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1561161
	speed: 0.0536s/iter; left time: 544.9832s
	iters: 200, epoch: 3 | loss: 0.1524493
	speed: 0.0178s/iter; left time: 179.5554s
	iters: 300, epoch: 3 | loss: 0.1533091
	speed: 0.0176s/iter; left time: 175.3029s
	iters: 400, epoch: 3 | loss: 0.2105260
	speed: 0.0164s/iter; left time: 161.3254s
	iters: 500, epoch: 3 | loss: 0.1116992
	speed: 0.0164s/iter; left time: 159.7108s
Epoch: 3 cost time: 10.05886721611023
Epoch: 3, Steps: 570 | Train Loss: 0.1655874 Vali Loss: 0.0329602 Test Loss: 0.1078570
Validation loss decreased (0.035437 --> 0.032960).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1438631
	speed: 0.0524s/iter; left time: 502.4034s
	iters: 200, epoch: 4 | loss: 0.2944773
	speed: 0.0179s/iter; left time: 169.7283s
	iters: 300, epoch: 4 | loss: 0.1522587
	speed: 0.0179s/iter; left time: 167.8379s
	iters: 400, epoch: 4 | loss: 0.1090287
	speed: 0.0179s/iter; left time: 166.3079s
	iters: 500, epoch: 4 | loss: 0.1948645
	speed: 0.0179s/iter; left time: 164.2635s
Epoch: 4 cost time: 10.495243787765503
Epoch: 4, Steps: 570 | Train Loss: 0.1562246 Vali Loss: 0.0324491 Test Loss: 0.1078768
Validation loss decreased (0.032960 --> 0.032449).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1842611
	speed: 0.0516s/iter; left time: 465.5602s
	iters: 200, epoch: 5 | loss: 0.1855548
	speed: 0.0163s/iter; left time: 145.8201s
	iters: 300, epoch: 5 | loss: 0.1641506
	speed: 0.0163s/iter; left time: 144.2058s
	iters: 400, epoch: 5 | loss: 0.1029566
	speed: 0.0163s/iter; left time: 142.4226s
	iters: 500, epoch: 5 | loss: 0.2050424
	speed: 0.0164s/iter; left time: 140.9929s
Epoch: 5 cost time: 9.624077320098877
Epoch: 5, Steps: 570 | Train Loss: 0.1526626 Vali Loss: 0.0320908 Test Loss: 0.1077455
Validation loss decreased (0.032449 --> 0.032091).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1627000
	speed: 0.0502s/iter; left time: 424.3409s
	iters: 200, epoch: 6 | loss: 0.1896338
	speed: 0.0163s/iter; left time: 136.4839s
	iters: 300, epoch: 6 | loss: 0.2693917
	speed: 0.0163s/iter; left time: 134.7372s
	iters: 400, epoch: 6 | loss: 0.1517547
	speed: 0.0163s/iter; left time: 133.0457s
	iters: 500, epoch: 6 | loss: 0.1533870
	speed: 0.0163s/iter; left time: 131.3931s
Epoch: 6 cost time: 9.62017273902893
Epoch: 6, Steps: 570 | Train Loss: 0.1504282 Vali Loss: 0.0319907 Test Loss: 0.1079596
Validation loss decreased (0.032091 --> 0.031991).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2064373
	speed: 0.0498s/iter; left time: 392.2732s
	iters: 200, epoch: 7 | loss: 0.0981622
	speed: 0.0163s/iter; left time: 127.2129s
	iters: 300, epoch: 7 | loss: 0.1423584
	speed: 0.0163s/iter; left time: 125.5667s
	iters: 400, epoch: 7 | loss: 0.2041747
	speed: 0.0163s/iter; left time: 123.9185s
	iters: 500, epoch: 7 | loss: 0.2211102
	speed: 0.0163s/iter; left time: 122.2910s
Epoch: 7 cost time: 9.635476112365723
Epoch: 7, Steps: 570 | Train Loss: 0.1502212 Vali Loss: 0.0320323 Test Loss: 0.1082623
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0899850
	speed: 0.0503s/iter; left time: 367.9645s
	iters: 200, epoch: 8 | loss: 0.2159691
	speed: 0.0177s/iter; left time: 127.5912s
	iters: 300, epoch: 8 | loss: 0.1730623
	speed: 0.0164s/iter; left time: 116.2789s
	iters: 400, epoch: 8 | loss: 0.1780045
	speed: 0.0163s/iter; left time: 114.6275s
	iters: 500, epoch: 8 | loss: 0.1362632
	speed: 0.0164s/iter; left time: 112.9955s
Epoch: 8 cost time: 9.895041465759277
Epoch: 8, Steps: 570 | Train Loss: 0.1481123 Vali Loss: 0.0319850 Test Loss: 0.1078942
Validation loss decreased (0.031991 --> 0.031985).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0998281
	speed: 0.0506s/iter; left time: 341.0699s
	iters: 200, epoch: 9 | loss: 0.1439245
	speed: 0.0164s/iter; left time: 108.6062s
	iters: 300, epoch: 9 | loss: 0.0975575
	speed: 0.0163s/iter; left time: 106.8479s
	iters: 400, epoch: 9 | loss: 0.1241299
	speed: 0.0171s/iter; left time: 110.2855s
	iters: 500, epoch: 9 | loss: 0.0834725
	speed: 0.0178s/iter; left time: 112.8096s
Epoch: 9 cost time: 10.002873420715332
Epoch: 9, Steps: 570 | Train Loss: 0.1485585 Vali Loss: 0.0319350 Test Loss: 0.1079367
Validation loss decreased (0.031985 --> 0.031935).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1683648
	speed: 0.0539s/iter; left time: 332.8455s
	iters: 200, epoch: 10 | loss: 0.1398911
	speed: 0.0178s/iter; left time: 108.2462s
	iters: 300, epoch: 10 | loss: 0.1231320
	speed: 0.0178s/iter; left time: 106.5095s
	iters: 400, epoch: 10 | loss: 0.1850924
	speed: 0.0178s/iter; left time: 104.6480s
	iters: 500, epoch: 10 | loss: 0.1255039
	speed: 0.0179s/iter; left time: 103.1369s
Epoch: 10 cost time: 10.477241039276123
Epoch: 10, Steps: 570 | Train Loss: 0.1485522 Vali Loss: 0.0318961 Test Loss: 0.1078511
Validation loss decreased (0.031935 --> 0.031896).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0992068
	speed: 0.0527s/iter; left time: 294.9624s
	iters: 200, epoch: 11 | loss: 0.1115770
	speed: 0.0179s/iter; left time: 98.2264s
	iters: 300, epoch: 11 | loss: 0.0927474
	speed: 0.0179s/iter; left time: 96.4192s
	iters: 400, epoch: 11 | loss: 0.1755264
	speed: 0.0178s/iter; left time: 94.6187s
	iters: 500, epoch: 11 | loss: 0.1436180
	speed: 0.0179s/iter; left time: 92.9226s
Epoch: 11 cost time: 10.512802600860596
Epoch: 11, Steps: 570 | Train Loss: 0.1481259 Vali Loss: 0.0320139 Test Loss: 0.1077969
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0950868
	speed: 0.0510s/iter; left time: 256.6987s
	iters: 200, epoch: 12 | loss: 0.1472794
	speed: 0.0163s/iter; left time: 80.5165s
	iters: 300, epoch: 12 | loss: 0.0909319
	speed: 0.0163s/iter; left time: 78.9336s
	iters: 400, epoch: 12 | loss: 0.1409163
	speed: 0.0163s/iter; left time: 77.2005s
	iters: 500, epoch: 12 | loss: 0.2169520
	speed: 0.0163s/iter; left time: 75.6086s
Epoch: 12 cost time: 9.611430406570435
Epoch: 12, Steps: 570 | Train Loss: 0.1475296 Vali Loss: 0.0319398 Test Loss: 0.1078073
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2090934
	speed: 0.0509s/iter; left time: 227.2496s
	iters: 200, epoch: 13 | loss: 0.2313940
	speed: 0.0164s/iter; left time: 71.3290s
	iters: 300, epoch: 13 | loss: 0.1662891
	speed: 0.0164s/iter; left time: 69.6843s
	iters: 400, epoch: 13 | loss: 0.1259979
	speed: 0.0163s/iter; left time: 67.9890s
	iters: 500, epoch: 13 | loss: 0.1475657
	speed: 0.0164s/iter; left time: 66.4284s
Epoch: 13 cost time: 9.595389127731323
Epoch: 13, Steps: 570 | Train Loss: 0.1476226 Vali Loss: 0.0320234 Test Loss: 0.1078198
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1079949215054512, mae:0.19775967299938202
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2413167
	speed: 0.0293s/iter; left time: 331.0887s
	iters: 200, epoch: 1 | loss: 0.2447659
	speed: 0.0172s/iter; left time: 192.3798s
	iters: 300, epoch: 1 | loss: 0.1951623
	speed: 0.0172s/iter; left time: 190.4222s
	iters: 400, epoch: 1 | loss: 0.2647790
	speed: 0.0172s/iter; left time: 189.3569s
	iters: 500, epoch: 1 | loss: 0.4042602
	speed: 0.0172s/iter; left time: 187.5016s
Epoch: 1 cost time: 11.060932636260986
Epoch: 1, Steps: 570 | Train Loss: 0.2468356 Vali Loss: 0.0431872 Test Loss: 0.1299762
Validation loss decreased (inf --> 0.043187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2797507
	speed: 0.0520s/iter; left time: 558.2171s
	iters: 200, epoch: 2 | loss: 0.1393885
	speed: 0.0167s/iter; left time: 177.9228s
	iters: 300, epoch: 2 | loss: 0.2722968
	speed: 0.0156s/iter; left time: 164.4728s
	iters: 400, epoch: 2 | loss: 0.1652651
	speed: 0.0161s/iter; left time: 167.4754s
	iters: 500, epoch: 2 | loss: 0.2828748
	speed: 0.0172s/iter; left time: 177.2619s
Epoch: 2 cost time: 9.781877040863037
Epoch: 2, Steps: 570 | Train Loss: 0.2045503 Vali Loss: 0.0416179 Test Loss: 0.1277904
Validation loss decreased (0.043187 --> 0.041618).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2099430
	speed: 0.0497s/iter; left time: 504.5190s
	iters: 200, epoch: 3 | loss: 0.1105419
	speed: 0.0178s/iter; left time: 178.9055s
	iters: 300, epoch: 3 | loss: 0.1900432
	speed: 0.0178s/iter; left time: 177.0201s
	iters: 400, epoch: 3 | loss: 0.1622627
	speed: 0.0178s/iter; left time: 175.3483s
	iters: 500, epoch: 3 | loss: 0.1956563
	speed: 0.0178s/iter; left time: 173.6739s
Epoch: 3 cost time: 10.173734903335571
Epoch: 3, Steps: 570 | Train Loss: 0.1829635 Vali Loss: 0.0392807 Test Loss: 0.1231934
Validation loss decreased (0.041618 --> 0.039281).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1368286
	speed: 0.0491s/iter; left time: 470.9119s
	iters: 200, epoch: 4 | loss: 0.2423485
	speed: 0.0156s/iter; left time: 147.8103s
	iters: 300, epoch: 4 | loss: 0.1873889
	speed: 0.0156s/iter; left time: 146.2722s
	iters: 400, epoch: 4 | loss: 0.1467016
	speed: 0.0155s/iter; left time: 144.4240s
	iters: 500, epoch: 4 | loss: 0.2073897
	speed: 0.0156s/iter; left time: 143.2898s
Epoch: 4 cost time: 9.18679165840149
Epoch: 4, Steps: 570 | Train Loss: 0.1739222 Vali Loss: 0.0375154 Test Loss: 0.1216830
Validation loss decreased (0.039281 --> 0.037515).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1482170
	speed: 0.0493s/iter; left time: 444.8909s
	iters: 200, epoch: 5 | loss: 0.1361156
	speed: 0.0154s/iter; left time: 137.7712s
	iters: 300, epoch: 5 | loss: 0.1386197
	speed: 0.0155s/iter; left time: 136.4560s
	iters: 400, epoch: 5 | loss: 0.1360067
	speed: 0.0154s/iter; left time: 134.7255s
	iters: 500, epoch: 5 | loss: 0.1387597
	speed: 0.0155s/iter; left time: 133.3229s
Epoch: 5 cost time: 9.134907484054565
Epoch: 5, Steps: 570 | Train Loss: 0.1657920 Vali Loss: 0.0373320 Test Loss: 0.1218878
Validation loss decreased (0.037515 --> 0.037332).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1826727
	speed: 0.0505s/iter; left time: 426.7671s
	iters: 200, epoch: 6 | loss: 0.1267354
	speed: 0.0172s/iter; left time: 143.4061s
	iters: 300, epoch: 6 | loss: 0.0930751
	speed: 0.0169s/iter; left time: 139.3659s
	iters: 400, epoch: 6 | loss: 0.1173369
	speed: 0.0156s/iter; left time: 126.7661s
	iters: 500, epoch: 6 | loss: 0.1261780
	speed: 0.0156s/iter; left time: 125.2633s
Epoch: 6 cost time: 9.617348670959473
Epoch: 6, Steps: 570 | Train Loss: 0.1635939 Vali Loss: 0.0366563 Test Loss: 0.1212485
Validation loss decreased (0.037332 --> 0.036656).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1912948
	speed: 0.0481s/iter; left time: 379.2485s
	iters: 200, epoch: 7 | loss: 0.1365837
	speed: 0.0155s/iter; left time: 120.7377s
	iters: 300, epoch: 7 | loss: 0.1388618
	speed: 0.0155s/iter; left time: 119.2989s
	iters: 400, epoch: 7 | loss: 0.1891867
	speed: 0.0155s/iter; left time: 117.5702s
	iters: 500, epoch: 7 | loss: 0.1679867
	speed: 0.0155s/iter; left time: 116.0261s
Epoch: 7 cost time: 9.156214714050293
Epoch: 7, Steps: 570 | Train Loss: 0.1611788 Vali Loss: 0.0365083 Test Loss: 0.1210062
Validation loss decreased (0.036656 --> 0.036508).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1519459
	speed: 0.0488s/iter; left time: 356.5490s
	iters: 200, epoch: 8 | loss: 0.1881487
	speed: 0.0154s/iter; left time: 111.2559s
	iters: 300, epoch: 8 | loss: 0.1068528
	speed: 0.0154s/iter; left time: 109.6970s
	iters: 400, epoch: 8 | loss: 0.1606441
	speed: 0.0154s/iter; left time: 108.1538s
	iters: 500, epoch: 8 | loss: 0.1078089
	speed: 0.0154s/iter; left time: 106.5966s
Epoch: 8 cost time: 9.117467641830444
Epoch: 8, Steps: 570 | Train Loss: 0.1593887 Vali Loss: 0.0366137 Test Loss: 0.1212772
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1538752
	speed: 0.0493s/iter; left time: 332.2466s
	iters: 200, epoch: 9 | loss: 0.1486090
	speed: 0.0171s/iter; left time: 113.8541s
	iters: 300, epoch: 9 | loss: 0.1573620
	speed: 0.0171s/iter; left time: 112.0975s
	iters: 400, epoch: 9 | loss: 0.1237305
	speed: 0.0171s/iter; left time: 110.4213s
	iters: 500, epoch: 9 | loss: 0.1568079
	speed: 0.0172s/iter; left time: 108.8352s
Epoch: 9 cost time: 10.060559034347534
Epoch: 9, Steps: 570 | Train Loss: 0.1593239 Vali Loss: 0.0365885 Test Loss: 0.1213836
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1925525
	speed: 0.0496s/iter; left time: 306.2649s
	iters: 200, epoch: 10 | loss: 0.1895633
	speed: 0.0155s/iter; left time: 94.1317s
	iters: 300, epoch: 10 | loss: 0.1333423
	speed: 0.0155s/iter; left time: 92.7845s
	iters: 400, epoch: 10 | loss: 0.1853685
	speed: 0.0155s/iter; left time: 91.2803s
	iters: 500, epoch: 10 | loss: 0.2689129
	speed: 0.0156s/iter; left time: 89.7984s
Epoch: 10 cost time: 9.23764967918396
Epoch: 10, Steps: 570 | Train Loss: 0.1621295 Vali Loss: 0.0365173 Test Loss: 0.1213550
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1211564838886261, mae:0.2156672477722168
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1701213
	speed: 0.0301s/iter; left time: 340.4649s
	iters: 200, epoch: 1 | loss: 0.2276553
	speed: 0.0186s/iter; left time: 208.2304s
	iters: 300, epoch: 1 | loss: 0.3742180
	speed: 0.0186s/iter; left time: 206.3400s
	iters: 400, epoch: 1 | loss: 0.2055091
	speed: 0.0186s/iter; left time: 204.8428s
	iters: 500, epoch: 1 | loss: 0.1715035
	speed: 0.0186s/iter; left time: 203.1586s
Epoch: 1 cost time: 11.813156604766846
Epoch: 1, Steps: 570 | Train Loss: 0.2427779 Vali Loss: 0.0438735 Test Loss: 0.1348092
Validation loss decreased (inf --> 0.043874).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3773701
	speed: 0.0588s/iter; left time: 630.5824s
	iters: 200, epoch: 2 | loss: 0.1882428
	speed: 0.0185s/iter; left time: 196.7245s
	iters: 300, epoch: 2 | loss: 0.1453577
	speed: 0.0185s/iter; left time: 194.6598s
	iters: 400, epoch: 2 | loss: 0.1704081
	speed: 0.0185s/iter; left time: 192.8801s
	iters: 500, epoch: 2 | loss: 0.1764275
	speed: 0.0185s/iter; left time: 190.9878s
Epoch: 2 cost time: 10.838157415390015
Epoch: 2, Steps: 570 | Train Loss: 0.2056473 Vali Loss: 0.0413137 Test Loss: 0.1240067
Validation loss decreased (0.043874 --> 0.041314).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1649174
	speed: 0.0556s/iter; left time: 565.2800s
	iters: 200, epoch: 3 | loss: 0.1766003
	speed: 0.0186s/iter; left time: 186.8933s
	iters: 300, epoch: 3 | loss: 0.1858291
	speed: 0.0186s/iter; left time: 185.3019s
	iters: 400, epoch: 3 | loss: 0.1261468
	speed: 0.0186s/iter; left time: 183.5429s
	iters: 500, epoch: 3 | loss: 0.1542312
	speed: 0.0186s/iter; left time: 181.4823s
Epoch: 3 cost time: 10.89339566230774
Epoch: 3, Steps: 570 | Train Loss: 0.1867160 Vali Loss: 0.0395584 Test Loss: 0.1199562
Validation loss decreased (0.041314 --> 0.039558).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2248079
	speed: 0.0598s/iter; left time: 573.9904s
	iters: 200, epoch: 4 | loss: 0.2410038
	speed: 0.0186s/iter; left time: 176.0732s
	iters: 300, epoch: 4 | loss: 0.2181978
	speed: 0.0186s/iter; left time: 174.6877s
	iters: 400, epoch: 4 | loss: 0.1244966
	speed: 0.0184s/iter; left time: 171.3728s
	iters: 500, epoch: 4 | loss: 0.1746538
	speed: 0.0184s/iter; left time: 168.9589s
Epoch: 4 cost time: 10.85622501373291
Epoch: 4, Steps: 570 | Train Loss: 0.1779401 Vali Loss: 0.0380415 Test Loss: 0.1196130
Validation loss decreased (0.039558 --> 0.038041).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1850338
	speed: 0.0603s/iter; left time: 544.1521s
	iters: 200, epoch: 5 | loss: 0.1880086
	speed: 0.0200s/iter; left time: 178.8183s
	iters: 300, epoch: 5 | loss: 0.1586958
	speed: 0.0187s/iter; left time: 164.6201s
	iters: 400, epoch: 5 | loss: 0.1390885
	speed: 0.0187s/iter; left time: 162.7366s
	iters: 500, epoch: 5 | loss: 0.1527496
	speed: 0.0187s/iter; left time: 160.8822s
Epoch: 5 cost time: 11.293629884719849
Epoch: 5, Steps: 570 | Train Loss: 0.1739779 Vali Loss: 0.0368697 Test Loss: 0.1180260
Validation loss decreased (0.038041 --> 0.036870).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0908256
	speed: 0.0579s/iter; left time: 489.2901s
	iters: 200, epoch: 6 | loss: 0.1706789
	speed: 0.0185s/iter; left time: 154.8766s
	iters: 300, epoch: 6 | loss: 0.1332409
	speed: 0.0185s/iter; left time: 152.9559s
	iters: 400, epoch: 6 | loss: 0.1949337
	speed: 0.0185s/iter; left time: 151.0792s
	iters: 500, epoch: 6 | loss: 0.1837593
	speed: 0.0186s/iter; left time: 149.4221s
Epoch: 6 cost time: 10.896344661712646
Epoch: 6, Steps: 570 | Train Loss: 0.1713157 Vali Loss: 0.0367580 Test Loss: 0.1180002
Validation loss decreased (0.036870 --> 0.036758).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1275187
	speed: 0.0571s/iter; left time: 450.2435s
	iters: 200, epoch: 7 | loss: 0.1628376
	speed: 0.0185s/iter; left time: 144.0787s
	iters: 300, epoch: 7 | loss: 0.1614579
	speed: 0.0185s/iter; left time: 142.1528s
	iters: 400, epoch: 7 | loss: 0.1849743
	speed: 0.0185s/iter; left time: 140.2877s
	iters: 500, epoch: 7 | loss: 0.2650965
	speed: 0.0185s/iter; left time: 138.3964s
Epoch: 7 cost time: 10.866853952407837
Epoch: 7, Steps: 570 | Train Loss: 0.1693896 Vali Loss: 0.0368110 Test Loss: 0.1179816
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1658965
	speed: 0.0560s/iter; left time: 409.6529s
	iters: 200, epoch: 8 | loss: 0.1343313
	speed: 0.0186s/iter; left time: 133.9893s
	iters: 300, epoch: 8 | loss: 0.1295584
	speed: 0.0186s/iter; left time: 132.1996s
	iters: 400, epoch: 8 | loss: 0.2085418
	speed: 0.0186s/iter; left time: 130.2382s
	iters: 500, epoch: 8 | loss: 0.1509864
	speed: 0.0186s/iter; left time: 128.3357s
Epoch: 8 cost time: 10.851993560791016
Epoch: 8, Steps: 570 | Train Loss: 0.1687659 Vali Loss: 0.0365846 Test Loss: 0.1179681
Validation loss decreased (0.036758 --> 0.036585).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0972329
	speed: 0.0586s/iter; left time: 395.0272s
	iters: 200, epoch: 9 | loss: 0.2183301
	speed: 0.0184s/iter; left time: 122.4898s
	iters: 300, epoch: 9 | loss: 0.0979860
	speed: 0.0184s/iter; left time: 120.6687s
	iters: 400, epoch: 9 | loss: 0.1908693
	speed: 0.0184s/iter; left time: 118.7823s
	iters: 500, epoch: 9 | loss: 0.0836755
	speed: 0.0184s/iter; left time: 116.8667s
Epoch: 9 cost time: 10.819642305374146
Epoch: 9, Steps: 570 | Train Loss: 0.1694459 Vali Loss: 0.0367797 Test Loss: 0.1178907
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1670914
	speed: 0.0583s/iter; left time: 359.5532s
	iters: 200, epoch: 10 | loss: 0.2010027
	speed: 0.0186s/iter; left time: 112.8550s
	iters: 300, epoch: 10 | loss: 0.1051348
	speed: 0.0185s/iter; left time: 110.4709s
	iters: 400, epoch: 10 | loss: 0.1393016
	speed: 0.0184s/iter; left time: 108.0709s
	iters: 500, epoch: 10 | loss: 0.1491832
	speed: 0.0184s/iter; left time: 106.3504s
Epoch: 10 cost time: 10.801588535308838
Epoch: 10, Steps: 570 | Train Loss: 0.1686444 Vali Loss: 0.0364459 Test Loss: 0.1173587
Validation loss decreased (0.036585 --> 0.036446).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1405297
	speed: 0.0594s/iter; left time: 332.7217s
	iters: 200, epoch: 11 | loss: 0.2319062
	speed: 0.0199s/iter; left time: 109.6291s
	iters: 300, epoch: 11 | loss: 0.1606440
	speed: 0.0187s/iter; left time: 100.8728s
	iters: 400, epoch: 11 | loss: 0.1128259
	speed: 0.0187s/iter; left time: 98.9822s
	iters: 500, epoch: 11 | loss: 0.2395503
	speed: 0.0187s/iter; left time: 97.0600s
Epoch: 11 cost time: 11.279836654663086
Epoch: 11, Steps: 570 | Train Loss: 0.1688100 Vali Loss: 0.0364996 Test Loss: 0.1175109
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1831477
	speed: 0.0562s/iter; left time: 282.7731s
	iters: 200, epoch: 12 | loss: 0.2048599
	speed: 0.0187s/iter; left time: 92.0266s
	iters: 300, epoch: 12 | loss: 0.0970611
	speed: 0.0186s/iter; left time: 89.8085s
	iters: 400, epoch: 12 | loss: 0.1759743
	speed: 0.0186s/iter; left time: 87.9130s
	iters: 500, epoch: 12 | loss: 0.1466150
	speed: 0.0186s/iter; left time: 86.0830s
Epoch: 12 cost time: 10.907198190689087
Epoch: 12, Steps: 570 | Train Loss: 0.1692958 Vali Loss: 0.0363186 Test Loss: 0.1174844
Validation loss decreased (0.036446 --> 0.036319).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1935764
	speed: 0.0577s/iter; left time: 257.3975s
	iters: 200, epoch: 13 | loss: 0.1432235
	speed: 0.0185s/iter; left time: 80.4647s
	iters: 300, epoch: 13 | loss: 0.1678448
	speed: 0.0184s/iter; left time: 78.5767s
	iters: 400, epoch: 13 | loss: 0.1233341
	speed: 0.0184s/iter; left time: 76.7274s
	iters: 500, epoch: 13 | loss: 0.2573188
	speed: 0.0184s/iter; left time: 74.8615s
Epoch: 13 cost time: 10.814025402069092
Epoch: 13, Steps: 570 | Train Loss: 0.1691465 Vali Loss: 0.0364455 Test Loss: 0.1174650
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1777302
	speed: 0.0588s/iter; left time: 228.7296s
	iters: 200, epoch: 14 | loss: 0.1110812
	speed: 0.0186s/iter; left time: 70.4957s
	iters: 300, epoch: 14 | loss: 0.1335861
	speed: 0.0186s/iter; left time: 68.6335s
	iters: 400, epoch: 14 | loss: 0.1736268
	speed: 0.0186s/iter; left time: 66.7892s
	iters: 500, epoch: 14 | loss: 0.2093794
	speed: 0.0186s/iter; left time: 64.9429s
Epoch: 14 cost time: 10.895894289016724
Epoch: 14, Steps: 570 | Train Loss: 0.1693446 Vali Loss: 0.0364211 Test Loss: 0.1174515
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1223397
	speed: 0.0560s/iter; left time: 186.1326s
	iters: 200, epoch: 15 | loss: 0.1927694
	speed: 0.0186s/iter; left time: 59.7678s
	iters: 300, epoch: 15 | loss: 0.1334334
	speed: 0.0186s/iter; left time: 57.9306s
	iters: 400, epoch: 15 | loss: 0.2074654
	speed: 0.0186s/iter; left time: 56.0416s
	iters: 500, epoch: 15 | loss: 0.1467664
	speed: 0.0185s/iter; left time: 54.1423s
Epoch: 15 cost time: 10.868999719619751
Epoch: 15, Steps: 570 | Train Loss: 0.1696263 Vali Loss: 0.0364447 Test Loss: 0.1174427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11763672530651093, mae:0.2096700668334961
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4402836
	speed: 0.0299s/iter; left time: 338.0881s
	iters: 200, epoch: 1 | loss: 0.2280317
	speed: 0.0183s/iter; left time: 204.7724s
	iters: 300, epoch: 1 | loss: 0.2163184
	speed: 0.0183s/iter; left time: 202.9987s
	iters: 400, epoch: 1 | loss: 0.1716065
	speed: 0.0183s/iter; left time: 201.6183s
	iters: 500, epoch: 1 | loss: 0.2263470
	speed: 0.0183s/iter; left time: 199.7056s
Epoch: 1 cost time: 11.646839380264282
Epoch: 1, Steps: 570 | Train Loss: 0.2177778 Vali Loss: 0.0359990 Test Loss: 0.1144829
Validation loss decreased (inf --> 0.035999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1530267
	speed: 0.0573s/iter; left time: 614.7974s
	iters: 200, epoch: 2 | loss: 0.2354390
	speed: 0.0183s/iter; left time: 194.6309s
	iters: 300, epoch: 2 | loss: 0.2974493
	speed: 0.0183s/iter; left time: 192.3844s
	iters: 400, epoch: 2 | loss: 0.1610678
	speed: 0.0184s/iter; left time: 191.4642s
	iters: 500, epoch: 2 | loss: 0.1318150
	speed: 0.0184s/iter; left time: 189.7632s
Epoch: 2 cost time: 10.765905141830444
Epoch: 2, Steps: 570 | Train Loss: 0.1872759 Vali Loss: 0.0355785 Test Loss: 0.1103872
Validation loss decreased (0.035999 --> 0.035578).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1258722
	speed: 0.0560s/iter; left time: 569.4283s
	iters: 200, epoch: 3 | loss: 0.1638420
	speed: 0.0184s/iter; left time: 184.7245s
	iters: 300, epoch: 3 | loss: 0.1729170
	speed: 0.0183s/iter; left time: 182.6766s
	iters: 400, epoch: 3 | loss: 0.1569908
	speed: 0.0183s/iter; left time: 180.6873s
	iters: 500, epoch: 3 | loss: 0.1315092
	speed: 0.0183s/iter; left time: 178.9412s
Epoch: 3 cost time: 10.763192653656006
Epoch: 3, Steps: 570 | Train Loss: 0.1725716 Vali Loss: 0.0344700 Test Loss: 0.1102411
Validation loss decreased (0.035578 --> 0.034470).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1933473
	speed: 0.0554s/iter; left time: 531.2877s
	iters: 200, epoch: 4 | loss: 0.1183194
	speed: 0.0183s/iter; left time: 173.5738s
	iters: 300, epoch: 4 | loss: 0.3026279
	speed: 0.0183s/iter; left time: 171.7115s
	iters: 400, epoch: 4 | loss: 0.1547152
	speed: 0.0183s/iter; left time: 169.7462s
	iters: 500, epoch: 4 | loss: 0.1303916
	speed: 0.0183s/iter; left time: 167.9024s
Epoch: 4 cost time: 10.70569658279419
Epoch: 4, Steps: 570 | Train Loss: 0.1665681 Vali Loss: 0.0332996 Test Loss: 0.1072504
Validation loss decreased (0.034470 --> 0.033300).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1343402
	speed: 0.0557s/iter; left time: 502.5663s
	iters: 200, epoch: 5 | loss: 0.1484613
	speed: 0.0183s/iter; left time: 163.4106s
	iters: 300, epoch: 5 | loss: 0.1597691
	speed: 0.0183s/iter; left time: 161.6312s
	iters: 400, epoch: 5 | loss: 0.1628501
	speed: 0.0183s/iter; left time: 159.7070s
	iters: 500, epoch: 5 | loss: 0.1543639
	speed: 0.0183s/iter; left time: 157.9101s
Epoch: 5 cost time: 10.750510692596436
Epoch: 5, Steps: 570 | Train Loss: 0.1636487 Vali Loss: 0.0330104 Test Loss: 0.1068674
Validation loss decreased (0.033300 --> 0.033010).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2362644
	speed: 0.0574s/iter; left time: 485.1516s
	iters: 200, epoch: 6 | loss: 0.1262991
	speed: 0.0184s/iter; left time: 153.5183s
	iters: 300, epoch: 6 | loss: 0.1783826
	speed: 0.0184s/iter; left time: 151.4388s
	iters: 400, epoch: 6 | loss: 0.1358697
	speed: 0.0184s/iter; left time: 149.6255s
	iters: 500, epoch: 6 | loss: 0.0978378
	speed: 0.0184s/iter; left time: 147.9861s
Epoch: 6 cost time: 10.745052576065063
Epoch: 6, Steps: 570 | Train Loss: 0.1615609 Vali Loss: 0.0325446 Test Loss: 0.1063081
Validation loss decreased (0.033010 --> 0.032545).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1607695
	speed: 0.0562s/iter; left time: 442.6905s
	iters: 200, epoch: 7 | loss: 0.2219531
	speed: 0.0184s/iter; left time: 143.0789s
	iters: 300, epoch: 7 | loss: 0.1253432
	speed: 0.0184s/iter; left time: 141.2029s
	iters: 400, epoch: 7 | loss: 0.1608795
	speed: 0.0184s/iter; left time: 139.1591s
	iters: 500, epoch: 7 | loss: 0.1382012
	speed: 0.0184s/iter; left time: 137.4268s
Epoch: 7 cost time: 10.771886110305786
Epoch: 7, Steps: 570 | Train Loss: 0.1585845 Vali Loss: 0.0325666 Test Loss: 0.1066777
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1129051
	speed: 0.0552s/iter; left time: 403.9246s
	iters: 200, epoch: 8 | loss: 0.1330525
	speed: 0.0183s/iter; left time: 131.6300s
	iters: 300, epoch: 8 | loss: 0.1465790
	speed: 0.0182s/iter; left time: 129.5306s
	iters: 400, epoch: 8 | loss: 0.1551302
	speed: 0.0182s/iter; left time: 127.7641s
	iters: 500, epoch: 8 | loss: 0.2000866
	speed: 0.0182s/iter; left time: 125.8231s
Epoch: 8 cost time: 10.683382511138916
Epoch: 8, Steps: 570 | Train Loss: 0.1580343 Vali Loss: 0.0326724 Test Loss: 0.1066297
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0877338
	speed: 0.0564s/iter; left time: 380.5114s
	iters: 200, epoch: 9 | loss: 0.1193765
	speed: 0.0184s/iter; left time: 122.0577s
	iters: 300, epoch: 9 | loss: 0.1743827
	speed: 0.0184s/iter; left time: 120.1061s
	iters: 400, epoch: 9 | loss: 0.1482083
	speed: 0.0184s/iter; left time: 118.2930s
	iters: 500, epoch: 9 | loss: 0.1290707
	speed: 0.0184s/iter; left time: 116.3956s
Epoch: 9 cost time: 10.76368761062622
Epoch: 9, Steps: 570 | Train Loss: 0.1584717 Vali Loss: 0.0326634 Test Loss: 0.1063355
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10645223408937454, mae:0.19559837877750397
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2651801
	speed: 0.0326s/iter; left time: 367.9997s
	iters: 200, epoch: 1 | loss: 0.2061377
	speed: 0.0204s/iter; left time: 228.9651s
	iters: 300, epoch: 1 | loss: 0.2616118
	speed: 0.0205s/iter; left time: 227.4625s
	iters: 400, epoch: 1 | loss: 0.2890184
	speed: 0.0205s/iter; left time: 225.8515s
	iters: 500, epoch: 1 | loss: 0.3381493
	speed: 0.0204s/iter; left time: 222.8007s
Epoch: 1 cost time: 12.934062004089355
Epoch: 1, Steps: 570 | Train Loss: 0.2511811 Vali Loss: 0.0428458 Test Loss: 0.1402139
Validation loss decreased (inf --> 0.042846).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2722202
	speed: 0.0599s/iter; left time: 643.2503s
	iters: 200, epoch: 2 | loss: 0.3023338
	speed: 0.0205s/iter; left time: 217.8314s
	iters: 300, epoch: 2 | loss: 0.4220283
	speed: 0.0205s/iter; left time: 215.5290s
	iters: 400, epoch: 2 | loss: 0.1778596
	speed: 0.0206s/iter; left time: 214.4352s
	iters: 500, epoch: 2 | loss: 0.1238796
	speed: 0.0205s/iter; left time: 211.4107s
Epoch: 2 cost time: 12.004593133926392
Epoch: 2, Steps: 570 | Train Loss: 0.2115823 Vali Loss: 0.0441549 Test Loss: 0.1311648
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1402862
	speed: 0.0565s/iter; left time: 574.1456s
	iters: 200, epoch: 3 | loss: 0.1880560
	speed: 0.0182s/iter; left time: 183.2780s
	iters: 300, epoch: 3 | loss: 0.2121368
	speed: 0.0182s/iter; left time: 181.3041s
	iters: 400, epoch: 3 | loss: 0.2370778
	speed: 0.0182s/iter; left time: 179.4372s
	iters: 500, epoch: 3 | loss: 0.1820183
	speed: 0.0182s/iter; left time: 177.5720s
Epoch: 3 cost time: 10.6332368850708
Epoch: 3, Steps: 570 | Train Loss: 0.1936986 Vali Loss: 0.0395063 Test Loss: 0.1265240
Validation loss decreased (0.042846 --> 0.039506).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1352281
	speed: 0.0599s/iter; left time: 574.5997s
	iters: 200, epoch: 4 | loss: 0.1846642
	speed: 0.0205s/iter; left time: 194.4604s
	iters: 300, epoch: 4 | loss: 0.1713757
	speed: 0.0205s/iter; left time: 192.3996s
	iters: 400, epoch: 4 | loss: 0.2349405
	speed: 0.0205s/iter; left time: 190.3966s
	iters: 500, epoch: 4 | loss: 0.1164267
	speed: 0.0205s/iter; left time: 188.2475s
Epoch: 4 cost time: 11.988919496536255
Epoch: 4, Steps: 570 | Train Loss: 0.1848535 Vali Loss: 0.0393417 Test Loss: 0.1241873
Validation loss decreased (0.039506 --> 0.039342).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1429969
	speed: 0.0594s/iter; left time: 535.6586s
	iters: 200, epoch: 5 | loss: 0.1879042
	speed: 0.0205s/iter; left time: 182.6063s
	iters: 300, epoch: 5 | loss: 0.1457430
	speed: 0.0205s/iter; left time: 180.4921s
	iters: 400, epoch: 5 | loss: 0.1728651
	speed: 0.0205s/iter; left time: 178.4266s
	iters: 500, epoch: 5 | loss: 0.0938167
	speed: 0.0205s/iter; left time: 176.6964s
Epoch: 5 cost time: 11.960446119308472
Epoch: 5, Steps: 570 | Train Loss: 0.1798460 Vali Loss: 0.0385588 Test Loss: 0.1223332
Validation loss decreased (0.039342 --> 0.038559).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2298993
	speed: 0.0583s/iter; left time: 492.8683s
	iters: 200, epoch: 6 | loss: 0.1317866
	speed: 0.0183s/iter; left time: 153.0079s
	iters: 300, epoch: 6 | loss: 0.3391422
	speed: 0.0183s/iter; left time: 151.1662s
	iters: 400, epoch: 6 | loss: 0.1500954
	speed: 0.0183s/iter; left time: 149.0775s
	iters: 500, epoch: 6 | loss: 0.1802107
	speed: 0.0183s/iter; left time: 147.1616s
Epoch: 6 cost time: 10.745839595794678
Epoch: 6, Steps: 570 | Train Loss: 0.1778498 Vali Loss: 0.0386358 Test Loss: 0.1219048
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1515136
	speed: 0.0562s/iter; left time: 442.8441s
	iters: 200, epoch: 7 | loss: 0.1496806
	speed: 0.0182s/iter; left time: 141.8847s
	iters: 300, epoch: 7 | loss: 0.1845922
	speed: 0.0182s/iter; left time: 139.9789s
	iters: 400, epoch: 7 | loss: 0.1701262
	speed: 0.0182s/iter; left time: 138.1601s
	iters: 500, epoch: 7 | loss: 0.1152266
	speed: 0.0182s/iter; left time: 136.3441s
Epoch: 7 cost time: 10.707399368286133
Epoch: 7, Steps: 570 | Train Loss: 0.1774723 Vali Loss: 0.0386863 Test Loss: 0.1224025
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1423626
	speed: 0.0555s/iter; left time: 406.0390s
	iters: 200, epoch: 8 | loss: 0.1177387
	speed: 0.0183s/iter; left time: 132.1528s
	iters: 300, epoch: 8 | loss: 0.1614120
	speed: 0.0183s/iter; left time: 130.3085s
	iters: 400, epoch: 8 | loss: 0.2179567
	speed: 0.0183s/iter; left time: 128.4633s
	iters: 500, epoch: 8 | loss: 0.1504788
	speed: 0.0183s/iter; left time: 126.7031s
Epoch: 8 cost time: 10.732959270477295
Epoch: 8, Steps: 570 | Train Loss: 0.1768888 Vali Loss: 0.0385472 Test Loss: 0.1227081
Validation loss decreased (0.038559 --> 0.038547).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1685435
	speed: 0.0578s/iter; left time: 389.4792s
	iters: 200, epoch: 9 | loss: 0.2040238
	speed: 0.0205s/iter; left time: 135.9405s
	iters: 300, epoch: 9 | loss: 0.2436899
	speed: 0.0205s/iter; left time: 133.8646s
	iters: 400, epoch: 9 | loss: 0.3090192
	speed: 0.0205s/iter; left time: 131.8185s
	iters: 500, epoch: 9 | loss: 0.1248585
	speed: 0.0205s/iter; left time: 129.7333s
Epoch: 9 cost time: 11.9623441696167
Epoch: 9, Steps: 570 | Train Loss: 0.1764126 Vali Loss: 0.0386066 Test Loss: 0.1222442
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1617981
	speed: 0.0580s/iter; left time: 358.1148s
	iters: 200, epoch: 10 | loss: 0.1409273
	speed: 0.0182s/iter; left time: 110.7477s
	iters: 300, epoch: 10 | loss: 0.1977402
	speed: 0.0182s/iter; left time: 108.9508s
	iters: 400, epoch: 10 | loss: 0.1650602
	speed: 0.0182s/iter; left time: 106.9719s
	iters: 500, epoch: 10 | loss: 0.1825350
	speed: 0.0182s/iter; left time: 105.1330s
Epoch: 10 cost time: 10.688281774520874
Epoch: 10, Steps: 570 | Train Loss: 0.1764346 Vali Loss: 0.0383638 Test Loss: 0.1220553
Validation loss decreased (0.038547 --> 0.038364).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1726952
	speed: 0.0561s/iter; left time: 313.9756s
	iters: 200, epoch: 11 | loss: 0.1705813
	speed: 0.0183s/iter; left time: 100.5829s
	iters: 300, epoch: 11 | loss: 0.1822181
	speed: 0.0183s/iter; left time: 98.6064s
	iters: 400, epoch: 11 | loss: 0.1932990
	speed: 0.0184s/iter; left time: 97.6707s
	iters: 500, epoch: 11 | loss: 0.1583101
	speed: 0.0183s/iter; left time: 95.0362s
Epoch: 11 cost time: 10.706536531448364
Epoch: 11, Steps: 570 | Train Loss: 0.1773822 Vali Loss: 0.0383823 Test Loss: 0.1220864
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1290665
	speed: 0.0568s/iter; left time: 285.6260s
	iters: 200, epoch: 12 | loss: 0.2061146
	speed: 0.0184s/iter; left time: 90.4989s
	iters: 300, epoch: 12 | loss: 0.1524406
	speed: 0.0183s/iter; left time: 88.5019s
	iters: 400, epoch: 12 | loss: 0.1417967
	speed: 0.0183s/iter; left time: 86.6533s
	iters: 500, epoch: 12 | loss: 0.2068213
	speed: 0.0184s/iter; left time: 84.9833s
Epoch: 12 cost time: 10.755274772644043
Epoch: 12, Steps: 570 | Train Loss: 0.1763787 Vali Loss: 0.0384361 Test Loss: 0.1220857
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1596949
	speed: 0.0561s/iter; left time: 250.4742s
	iters: 200, epoch: 13 | loss: 0.1017286
	speed: 0.0182s/iter; left time: 79.5848s
	iters: 300, epoch: 13 | loss: 0.1444184
	speed: 0.0183s/iter; left time: 77.7806s
	iters: 400, epoch: 13 | loss: 0.1134202
	speed: 0.0183s/iter; left time: 75.9491s
	iters: 500, epoch: 13 | loss: 0.1189065
	speed: 0.0183s/iter; left time: 74.1617s
Epoch: 13 cost time: 10.688488483428955
Epoch: 13, Steps: 570 | Train Loss: 0.1760794 Vali Loss: 0.0385588 Test Loss: 0.1220563
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12221644818782806, mae:0.21517717838287354
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2293160
	speed: 0.0339s/iter; left time: 382.6815s
	iters: 200, epoch: 1 | loss: 0.2001203
	speed: 0.0221s/iter; left time: 247.5792s
	iters: 300, epoch: 1 | loss: 0.2317519
	speed: 0.0221s/iter; left time: 244.9824s
	iters: 400, epoch: 1 | loss: 0.3238974
	speed: 0.0221s/iter; left time: 242.5891s
	iters: 500, epoch: 1 | loss: 0.2662609
	speed: 0.0221s/iter; left time: 240.4858s
Epoch: 1 cost time: 13.812785148620605
Epoch: 1, Steps: 570 | Train Loss: 0.2369264 Vali Loss: 0.0448870 Test Loss: 0.1381774
Validation loss decreased (inf --> 0.044887).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2949812
	speed: 0.0650s/iter; left time: 697.2384s
	iters: 200, epoch: 2 | loss: 0.1773820
	speed: 0.0220s/iter; left time: 234.2295s
	iters: 300, epoch: 2 | loss: 0.1580946
	speed: 0.0220s/iter; left time: 231.2782s
	iters: 400, epoch: 2 | loss: 0.1641154
	speed: 0.0220s/iter; left time: 229.7652s
	iters: 500, epoch: 2 | loss: 0.1876259
	speed: 0.0220s/iter; left time: 227.4769s
Epoch: 2 cost time: 12.834163665771484
Epoch: 2, Steps: 570 | Train Loss: 0.1964609 Vali Loss: 0.0406355 Test Loss: 0.1257435
Validation loss decreased (0.044887 --> 0.040636).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3679785
	speed: 0.0626s/iter; left time: 635.6897s
	iters: 200, epoch: 3 | loss: 0.1269350
	speed: 0.0220s/iter; left time: 221.7177s
	iters: 300, epoch: 3 | loss: 0.2260499
	speed: 0.0220s/iter; left time: 218.9736s
	iters: 400, epoch: 3 | loss: 0.1312096
	speed: 0.0220s/iter; left time: 216.8935s
	iters: 500, epoch: 3 | loss: 0.1155650
	speed: 0.0220s/iter; left time: 214.7667s
Epoch: 3 cost time: 12.838762521743774
Epoch: 3, Steps: 570 | Train Loss: 0.1737390 Vali Loss: 0.0379185 Test Loss: 0.1199889
Validation loss decreased (0.040636 --> 0.037919).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1278060
	speed: 0.0656s/iter; left time: 629.0245s
	iters: 200, epoch: 4 | loss: 0.1287254
	speed: 0.0222s/iter; left time: 210.7320s
	iters: 300, epoch: 4 | loss: 0.1430790
	speed: 0.0222s/iter; left time: 208.3661s
	iters: 400, epoch: 4 | loss: 0.1266261
	speed: 0.0222s/iter; left time: 205.9158s
	iters: 500, epoch: 4 | loss: 0.1892242
	speed: 0.0220s/iter; left time: 202.6529s
Epoch: 4 cost time: 12.958061218261719
Epoch: 4, Steps: 570 | Train Loss: 0.1611997 Vali Loss: 0.0359299 Test Loss: 0.1203324
Validation loss decreased (0.037919 --> 0.035930).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1713608
	speed: 0.0647s/iter; left time: 583.2723s
	iters: 200, epoch: 5 | loss: 0.1498552
	speed: 0.0221s/iter; left time: 197.4818s
	iters: 300, epoch: 5 | loss: 0.1025852
	speed: 0.0222s/iter; left time: 195.5518s
	iters: 400, epoch: 5 | loss: 0.1424865
	speed: 0.0221s/iter; left time: 192.7884s
	iters: 500, epoch: 5 | loss: 0.1350143
	speed: 0.0221s/iter; left time: 190.7290s
Epoch: 5 cost time: 12.903506755828857
Epoch: 5, Steps: 570 | Train Loss: 0.1554374 Vali Loss: 0.0349023 Test Loss: 0.1193037
Validation loss decreased (0.035930 --> 0.034902).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1344327
	speed: 0.0649s/iter; left time: 548.1738s
	iters: 200, epoch: 6 | loss: 0.1777411
	speed: 0.0222s/iter; left time: 185.4393s
	iters: 300, epoch: 6 | loss: 0.1242370
	speed: 0.0222s/iter; left time: 182.8892s
	iters: 400, epoch: 6 | loss: 0.1273502
	speed: 0.0221s/iter; left time: 180.3197s
	iters: 500, epoch: 6 | loss: 0.2024987
	speed: 0.0221s/iter; left time: 178.3256s
Epoch: 6 cost time: 12.968868970870972
Epoch: 6, Steps: 570 | Train Loss: 0.1519231 Vali Loss: 0.0356104 Test Loss: 0.1197865
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1739931
	speed: 0.0634s/iter; left time: 499.2696s
	iters: 200, epoch: 7 | loss: 0.1780449
	speed: 0.0221s/iter; left time: 171.5851s
	iters: 300, epoch: 7 | loss: 0.1181497
	speed: 0.0221s/iter; left time: 169.4671s
	iters: 400, epoch: 7 | loss: 0.1467361
	speed: 0.0221s/iter; left time: 167.4043s
	iters: 500, epoch: 7 | loss: 0.1584349
	speed: 0.0221s/iter; left time: 165.1126s
Epoch: 7 cost time: 12.876832246780396
Epoch: 7, Steps: 570 | Train Loss: 0.1489323 Vali Loss: 0.0355754 Test Loss: 0.1189778
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1233920
	speed: 0.0630s/iter; left time: 460.6843s
	iters: 200, epoch: 8 | loss: 0.3557206
	speed: 0.0220s/iter; left time: 158.6489s
	iters: 300, epoch: 8 | loss: 0.1108116
	speed: 0.0220s/iter; left time: 156.3286s
	iters: 400, epoch: 8 | loss: 0.1410093
	speed: 0.0220s/iter; left time: 154.2158s
	iters: 500, epoch: 8 | loss: 0.1274756
	speed: 0.0220s/iter; left time: 152.2821s
Epoch: 8 cost time: 12.837616443634033
Epoch: 8, Steps: 570 | Train Loss: 0.1493372 Vali Loss: 0.0346900 Test Loss: 0.1187895
Validation loss decreased (0.034902 --> 0.034690).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1598254
	speed: 0.0649s/iter; left time: 437.5378s
	iters: 200, epoch: 9 | loss: 0.1528068
	speed: 0.0221s/iter; left time: 146.7674s
	iters: 300, epoch: 9 | loss: 0.1569958
	speed: 0.0221s/iter; left time: 144.4968s
	iters: 400, epoch: 9 | loss: 0.1132833
	speed: 0.0221s/iter; left time: 142.3231s
	iters: 500, epoch: 9 | loss: 0.1267483
	speed: 0.0221s/iter; left time: 140.0813s
Epoch: 9 cost time: 12.903800964355469
Epoch: 9, Steps: 570 | Train Loss: 0.1495864 Vali Loss: 0.0347729 Test Loss: 0.1186510
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1693633
	speed: 0.0629s/iter; left time: 387.9503s
	iters: 200, epoch: 10 | loss: 0.1689127
	speed: 0.0222s/iter; left time: 134.5608s
	iters: 300, epoch: 10 | loss: 0.1406300
	speed: 0.0222s/iter; left time: 132.3967s
	iters: 400, epoch: 10 | loss: 0.2072676
	speed: 0.0222s/iter; left time: 130.3322s
	iters: 500, epoch: 10 | loss: 0.1296462
	speed: 0.0222s/iter; left time: 128.0927s
Epoch: 10 cost time: 12.957226753234863
Epoch: 10, Steps: 570 | Train Loss: 0.1483664 Vali Loss: 0.0349972 Test Loss: 0.1186653
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1339197
	speed: 0.0632s/iter; left time: 354.1658s
	iters: 200, epoch: 11 | loss: 0.1176230
	speed: 0.0221s/iter; left time: 121.5845s
	iters: 300, epoch: 11 | loss: 0.0925952
	speed: 0.0221s/iter; left time: 119.3717s
	iters: 400, epoch: 11 | loss: 0.1302447
	speed: 0.0221s/iter; left time: 116.9320s
	iters: 500, epoch: 11 | loss: 0.1341548
	speed: 0.0221s/iter; left time: 114.9034s
Epoch: 11 cost time: 12.886634588241577
Epoch: 11, Steps: 570 | Train Loss: 0.1501437 Vali Loss: 0.0350755 Test Loss: 0.1187449
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11892738938331604, mae:0.21354109048843384
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2284682
	speed: 0.0333s/iter; left time: 376.0734s
	iters: 200, epoch: 1 | loss: 0.1140975
	speed: 0.0214s/iter; left time: 239.3476s
	iters: 300, epoch: 1 | loss: 0.1872586
	speed: 0.0214s/iter; left time: 237.1982s
	iters: 400, epoch: 1 | loss: 0.1804277
	speed: 0.0214s/iter; left time: 235.0842s
	iters: 500, epoch: 1 | loss: 0.1918750
	speed: 0.0214s/iter; left time: 233.0636s
Epoch: 1 cost time: 13.431069135665894
Epoch: 1, Steps: 570 | Train Loss: 0.2124422 Vali Loss: 0.0370007 Test Loss: 0.1144546
Validation loss decreased (inf --> 0.037001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1790348
	speed: 0.0651s/iter; left time: 699.0435s
	iters: 200, epoch: 2 | loss: 0.1375379
	speed: 0.0214s/iter; left time: 227.1964s
	iters: 300, epoch: 2 | loss: 0.2338322
	speed: 0.0214s/iter; left time: 225.1415s
	iters: 400, epoch: 2 | loss: 0.1661720
	speed: 0.0214s/iter; left time: 223.1238s
	iters: 500, epoch: 2 | loss: 0.1245318
	speed: 0.0214s/iter; left time: 221.2083s
Epoch: 2 cost time: 12.517714500427246
Epoch: 2, Steps: 570 | Train Loss: 0.1824991 Vali Loss: 0.0336115 Test Loss: 0.1110842
Validation loss decreased (0.037001 --> 0.033611).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1640447
	speed: 0.0618s/iter; left time: 628.2373s
	iters: 200, epoch: 3 | loss: 0.1281942
	speed: 0.0214s/iter; left time: 215.4208s
	iters: 300, epoch: 3 | loss: 0.1569435
	speed: 0.0214s/iter; left time: 213.2377s
	iters: 400, epoch: 3 | loss: 0.1140294
	speed: 0.0214s/iter; left time: 211.2747s
	iters: 500, epoch: 3 | loss: 0.1418954
	speed: 0.0214s/iter; left time: 208.8870s
Epoch: 3 cost time: 12.497617959976196
Epoch: 3, Steps: 570 | Train Loss: 0.1628980 Vali Loss: 0.0330244 Test Loss: 0.1112351
Validation loss decreased (0.033611 --> 0.033024).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1311267
	speed: 0.0608s/iter; left time: 582.6913s
	iters: 200, epoch: 4 | loss: 0.1572121
	speed: 0.0213s/iter; left time: 202.2775s
	iters: 300, epoch: 4 | loss: 0.1599234
	speed: 0.0213s/iter; left time: 200.0617s
	iters: 400, epoch: 4 | loss: 0.1857014
	speed: 0.0213s/iter; left time: 197.9664s
	iters: 500, epoch: 4 | loss: 0.1329582
	speed: 0.0213s/iter; left time: 195.8449s
Epoch: 4 cost time: 12.45613980293274
Epoch: 4, Steps: 570 | Train Loss: 0.1534347 Vali Loss: 0.0313272 Test Loss: 0.1073021
Validation loss decreased (0.033024 --> 0.031327).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1965039
	speed: 0.0614s/iter; left time: 553.8475s
	iters: 200, epoch: 5 | loss: 0.1252093
	speed: 0.0213s/iter; left time: 190.2806s
	iters: 300, epoch: 5 | loss: 0.1540219
	speed: 0.0213s/iter; left time: 188.2721s
	iters: 400, epoch: 5 | loss: 0.1737693
	speed: 0.0214s/iter; left time: 186.2445s
	iters: 500, epoch: 5 | loss: 0.1343280
	speed: 0.0214s/iter; left time: 184.0884s
Epoch: 5 cost time: 12.472914218902588
Epoch: 5, Steps: 570 | Train Loss: 0.1480673 Vali Loss: 0.0314623 Test Loss: 0.1069397
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1305945
	speed: 0.0612s/iter; left time: 516.9196s
	iters: 200, epoch: 6 | loss: 0.1698483
	speed: 0.0214s/iter; left time: 178.8318s
	iters: 300, epoch: 6 | loss: 0.2030552
	speed: 0.0214s/iter; left time: 176.6051s
	iters: 400, epoch: 6 | loss: 0.1135494
	speed: 0.0214s/iter; left time: 174.5068s
	iters: 500, epoch: 6 | loss: 0.0988165
	speed: 0.0214s/iter; left time: 172.5971s
Epoch: 6 cost time: 12.503016948699951
Epoch: 6, Steps: 570 | Train Loss: 0.1447756 Vali Loss: 0.0306504 Test Loss: 0.1057928
Validation loss decreased (0.031327 --> 0.030650).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1269063
	speed: 0.0623s/iter; left time: 491.2659s
	iters: 200, epoch: 7 | loss: 0.1763606
	speed: 0.0214s/iter; left time: 166.4906s
	iters: 300, epoch: 7 | loss: 0.1897619
	speed: 0.0214s/iter; left time: 164.3624s
	iters: 400, epoch: 7 | loss: 0.1130605
	speed: 0.0214s/iter; left time: 162.2003s
	iters: 500, epoch: 7 | loss: 0.1624167
	speed: 0.0214s/iter; left time: 160.0491s
Epoch: 7 cost time: 12.51346755027771
Epoch: 7, Steps: 570 | Train Loss: 0.1435283 Vali Loss: 0.0310711 Test Loss: 0.1057043
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1158329
	speed: 0.0603s/iter; left time: 441.1756s
	iters: 200, epoch: 8 | loss: 0.1492592
	speed: 0.0213s/iter; left time: 153.9061s
	iters: 300, epoch: 8 | loss: 0.1385576
	speed: 0.0214s/iter; left time: 151.9016s
	iters: 400, epoch: 8 | loss: 0.1291806
	speed: 0.0213s/iter; left time: 149.6708s
	iters: 500, epoch: 8 | loss: 0.2251658
	speed: 0.0214s/iter; left time: 147.6340s
Epoch: 8 cost time: 12.441862106323242
Epoch: 8, Steps: 570 | Train Loss: 0.1441585 Vali Loss: 0.0307371 Test Loss: 0.1055154
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1272317
	speed: 0.0652s/iter; left time: 439.3553s
	iters: 200, epoch: 9 | loss: 0.1994877
	speed: 0.0233s/iter; left time: 154.4846s
	iters: 300, epoch: 9 | loss: 0.1821720
	speed: 0.0233s/iter; left time: 152.1146s
	iters: 400, epoch: 9 | loss: 0.1311061
	speed: 0.0233s/iter; left time: 149.9678s
	iters: 500, epoch: 9 | loss: 0.0953144
	speed: 0.0232s/iter; left time: 146.9556s
Epoch: 9 cost time: 13.498720407485962
Epoch: 9, Steps: 570 | Train Loss: 0.1427759 Vali Loss: 0.0307497 Test Loss: 0.1055081
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10591603815555573, mae:0.1953425258398056
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2562765
	speed: 0.0321s/iter; left time: 362.2165s
	iters: 200, epoch: 1 | loss: 0.2157764
	speed: 0.0203s/iter; left time: 226.9246s
	iters: 300, epoch: 1 | loss: 0.2481079
	speed: 0.0202s/iter; left time: 223.7747s
	iters: 400, epoch: 1 | loss: 0.2475539
	speed: 0.0202s/iter; left time: 222.1250s
	iters: 500, epoch: 1 | loss: 0.2619237
	speed: 0.0219s/iter; left time: 239.1631s
Epoch: 1 cost time: 13.065285444259644
Epoch: 1, Steps: 570 | Train Loss: 0.2410248 Vali Loss: 0.0453150 Test Loss: 0.1347040
Validation loss decreased (inf --> 0.045315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1065180
	speed: 0.0639s/iter; left time: 685.8050s
	iters: 200, epoch: 2 | loss: 0.3174434
	speed: 0.0202s/iter; left time: 214.5798s
	iters: 300, epoch: 2 | loss: 0.1810112
	speed: 0.0202s/iter; left time: 212.8601s
	iters: 400, epoch: 2 | loss: 0.1442247
	speed: 0.0202s/iter; left time: 210.3418s
	iters: 500, epoch: 2 | loss: 0.1641787
	speed: 0.0202s/iter; left time: 208.3410s
Epoch: 2 cost time: 11.827003002166748
Epoch: 2, Steps: 570 | Train Loss: 0.2043236 Vali Loss: 0.0404540 Test Loss: 0.1295821
Validation loss decreased (0.045315 --> 0.040454).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1248439
	speed: 0.0594s/iter; left time: 603.6768s
	iters: 200, epoch: 3 | loss: 0.1446200
	speed: 0.0201s/iter; left time: 202.2818s
	iters: 300, epoch: 3 | loss: 0.1604957
	speed: 0.0201s/iter; left time: 199.9701s
	iters: 400, epoch: 3 | loss: 0.1915502
	speed: 0.0201s/iter; left time: 198.1422s
	iters: 500, epoch: 3 | loss: 0.1480977
	speed: 0.0201s/iter; left time: 195.9640s
Epoch: 3 cost time: 11.748139381408691
Epoch: 3, Steps: 570 | Train Loss: 0.1780425 Vali Loss: 0.0381560 Test Loss: 0.1222825
Validation loss decreased (0.040454 --> 0.038156).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1330593
	speed: 0.0599s/iter; left time: 574.5599s
	iters: 200, epoch: 4 | loss: 0.2623751
	speed: 0.0202s/iter; left time: 191.8159s
	iters: 300, epoch: 4 | loss: 0.1235647
	speed: 0.0202s/iter; left time: 189.6706s
	iters: 400, epoch: 4 | loss: 0.1763392
	speed: 0.0202s/iter; left time: 187.4778s
	iters: 500, epoch: 4 | loss: 0.1472546
	speed: 0.0202s/iter; left time: 185.5195s
Epoch: 4 cost time: 11.80426836013794
Epoch: 4, Steps: 570 | Train Loss: 0.1684250 Vali Loss: 0.0369960 Test Loss: 0.1230981
Validation loss decreased (0.038156 --> 0.036996).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1510783
	speed: 0.0605s/iter; left time: 545.4131s
	iters: 200, epoch: 5 | loss: 0.2297237
	speed: 0.0201s/iter; left time: 179.5251s
	iters: 300, epoch: 5 | loss: 0.1699297
	speed: 0.0201s/iter; left time: 177.6847s
	iters: 400, epoch: 5 | loss: 0.1289299
	speed: 0.0201s/iter; left time: 175.2476s
	iters: 500, epoch: 5 | loss: 0.1482836
	speed: 0.0201s/iter; left time: 173.2976s
Epoch: 5 cost time: 11.748889446258545
Epoch: 5, Steps: 570 | Train Loss: 0.1612471 Vali Loss: 0.0358364 Test Loss: 0.1210869
Validation loss decreased (0.036996 --> 0.035836).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1806330
	speed: 0.0603s/iter; left time: 509.4864s
	iters: 200, epoch: 6 | loss: 0.1296096
	speed: 0.0202s/iter; left time: 168.3258s
	iters: 300, epoch: 6 | loss: 0.1711587
	speed: 0.0202s/iter; left time: 166.3499s
	iters: 400, epoch: 6 | loss: 0.1098421
	speed: 0.0202s/iter; left time: 164.2502s
	iters: 500, epoch: 6 | loss: 0.2536576
	speed: 0.0202s/iter; left time: 162.2799s
Epoch: 6 cost time: 11.78755784034729
Epoch: 6, Steps: 570 | Train Loss: 0.1581290 Vali Loss: 0.0355851 Test Loss: 0.1205030
Validation loss decreased (0.035836 --> 0.035585).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1820057
	speed: 0.0612s/iter; left time: 482.6886s
	iters: 200, epoch: 7 | loss: 0.1551099
	speed: 0.0222s/iter; left time: 172.7862s
	iters: 300, epoch: 7 | loss: 0.1663122
	speed: 0.0218s/iter; left time: 167.4448s
	iters: 400, epoch: 7 | loss: 0.1852769
	speed: 0.0202s/iter; left time: 153.2577s
	iters: 500, epoch: 7 | loss: 0.1291391
	speed: 0.0202s/iter; left time: 150.9397s
Epoch: 7 cost time: 12.379070520401001
Epoch: 7, Steps: 570 | Train Loss: 0.1576374 Vali Loss: 0.0353794 Test Loss: 0.1205120
Validation loss decreased (0.035585 --> 0.035379).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2096474
	speed: 0.0610s/iter; left time: 445.9116s
	iters: 200, epoch: 8 | loss: 0.2134181
	speed: 0.0202s/iter; left time: 145.6592s
	iters: 300, epoch: 8 | loss: 0.1830942
	speed: 0.0202s/iter; left time: 143.6053s
	iters: 400, epoch: 8 | loss: 0.1176649
	speed: 0.0202s/iter; left time: 141.4985s
	iters: 500, epoch: 8 | loss: 0.1991496
	speed: 0.0202s/iter; left time: 139.5702s
Epoch: 8 cost time: 11.812223196029663
Epoch: 8, Steps: 570 | Train Loss: 0.1570029 Vali Loss: 0.0353128 Test Loss: 0.1201875
Validation loss decreased (0.035379 --> 0.035313).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1775825
	speed: 0.0601s/iter; left time: 405.1292s
	iters: 200, epoch: 9 | loss: 0.1360510
	speed: 0.0202s/iter; left time: 133.8809s
	iters: 300, epoch: 9 | loss: 0.2114218
	speed: 0.0201s/iter; left time: 131.7804s
	iters: 400, epoch: 9 | loss: 0.1251161
	speed: 0.0201s/iter; left time: 129.7640s
	iters: 500, epoch: 9 | loss: 0.0949787
	speed: 0.0202s/iter; left time: 128.1710s
Epoch: 9 cost time: 11.772069454193115
Epoch: 9, Steps: 570 | Train Loss: 0.1550673 Vali Loss: 0.0352326 Test Loss: 0.1203308
Validation loss decreased (0.035313 --> 0.035233).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1661598
	speed: 0.0594s/iter; left time: 366.5107s
	iters: 200, epoch: 10 | loss: 0.1141818
	speed: 0.0201s/iter; left time: 122.0412s
	iters: 300, epoch: 10 | loss: 0.2880810
	speed: 0.0201s/iter; left time: 119.8168s
	iters: 400, epoch: 10 | loss: 0.1969699
	speed: 0.0201s/iter; left time: 117.9208s
	iters: 500, epoch: 10 | loss: 0.1559758
	speed: 0.0201s/iter; left time: 115.7311s
Epoch: 10 cost time: 11.731609344482422
Epoch: 10, Steps: 570 | Train Loss: 0.1543263 Vali Loss: 0.0353549 Test Loss: 0.1202883
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1343611
	speed: 0.0585s/iter; left time: 327.6299s
	iters: 200, epoch: 11 | loss: 0.1319569
	speed: 0.0202s/iter; left time: 110.9076s
	iters: 300, epoch: 11 | loss: 0.1341392
	speed: 0.0202s/iter; left time: 108.8608s
	iters: 400, epoch: 11 | loss: 0.2018586
	speed: 0.0202s/iter; left time: 106.8393s
	iters: 500, epoch: 11 | loss: 0.1080743
	speed: 0.0202s/iter; left time: 104.8047s
Epoch: 11 cost time: 11.767860174179077
Epoch: 11, Steps: 570 | Train Loss: 0.1560429 Vali Loss: 0.0352690 Test Loss: 0.1202708
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1515093
	speed: 0.0598s/iter; left time: 301.0899s
	iters: 200, epoch: 12 | loss: 0.1632299
	speed: 0.0222s/iter; left time: 109.3757s
	iters: 300, epoch: 12 | loss: 0.2150737
	speed: 0.0222s/iter; left time: 107.1041s
	iters: 400, epoch: 12 | loss: 0.1359158
	speed: 0.0222s/iter; left time: 104.9406s
	iters: 500, epoch: 12 | loss: 0.2216803
	speed: 0.0222s/iter; left time: 102.6924s
Epoch: 12 cost time: 12.934865474700928
Epoch: 12, Steps: 570 | Train Loss: 0.1539562 Vali Loss: 0.0352557 Test Loss: 0.1203630
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12048591673374176, mae:0.21578265726566315
