===== SWEEP for S =====
>>> S LR=1e-3 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1721396
	speed: 0.0214s/iter; left time: 241.8318s
	iters: 200, epoch: 1 | loss: 0.1743055
	speed: 0.0100s/iter; left time: 111.7887s
	iters: 300, epoch: 1 | loss: 0.1529239
	speed: 0.0100s/iter; left time: 111.0514s
	iters: 400, epoch: 1 | loss: 0.1836529
	speed: 0.0100s/iter; left time: 109.7187s
	iters: 500, epoch: 1 | loss: 0.1317780
	speed: 0.0100s/iter; left time: 108.8041s
Epoch: 1 cost time: 6.869465589523315
Epoch: 1, Steps: 570 | Train Loss: 0.1969663 Vali Loss: 0.0487490 Test Loss: 0.1719004
Validation loss decreased (inf --> 0.048749).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2532245
	speed: 0.0329s/iter; left time: 353.0312s
	iters: 200, epoch: 2 | loss: 0.2623999
	speed: 0.0100s/iter; left time: 106.2161s
	iters: 300, epoch: 2 | loss: 0.1249305
	speed: 0.0100s/iter; left time: 105.3679s
	iters: 400, epoch: 2 | loss: 0.1107381
	speed: 0.0100s/iter; left time: 104.0005s
	iters: 500, epoch: 2 | loss: 0.1674705
	speed: 0.0100s/iter; left time: 103.2774s
Epoch: 2 cost time: 5.889185905456543
Epoch: 2, Steps: 570 | Train Loss: 0.1697621 Vali Loss: 0.0455556 Test Loss: 0.1481040
Validation loss decreased (0.048749 --> 0.045556).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1189781
	speed: 0.0328s/iter; left time: 332.9132s
	iters: 200, epoch: 3 | loss: 0.1399388
	speed: 0.0099s/iter; left time: 99.6654s
	iters: 300, epoch: 3 | loss: 0.1530227
	speed: 0.0099s/iter; left time: 98.3766s
	iters: 400, epoch: 3 | loss: 0.1395892
	speed: 0.0099s/iter; left time: 97.7276s
	iters: 500, epoch: 3 | loss: 0.2039895
	speed: 0.0099s/iter; left time: 96.3457s
Epoch: 3 cost time: 5.841707706451416
Epoch: 3, Steps: 570 | Train Loss: 0.1439266 Vali Loss: 0.0427880 Test Loss: 0.1339518
Validation loss decreased (0.045556 --> 0.042788).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1516630
	speed: 0.0354s/iter; left time: 339.4565s
	iters: 200, epoch: 4 | loss: 0.0853270
	speed: 0.0111s/iter; left time: 105.7136s
	iters: 300, epoch: 4 | loss: 0.1266268
	speed: 0.0111s/iter; left time: 104.6559s
	iters: 400, epoch: 4 | loss: 0.1232957
	speed: 0.0111s/iter; left time: 103.5689s
	iters: 500, epoch: 4 | loss: 0.1117028
	speed: 0.0111s/iter; left time: 102.4264s
Epoch: 4 cost time: 6.556789875030518
Epoch: 4, Steps: 570 | Train Loss: 0.1237296 Vali Loss: 0.0420029 Test Loss: 0.1467816
Validation loss decreased (0.042788 --> 0.042003).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1116637
	speed: 0.0348s/iter; left time: 314.1371s
	iters: 200, epoch: 5 | loss: 0.0885433
	speed: 0.0100s/iter; left time: 88.8776s
	iters: 300, epoch: 5 | loss: 0.0929886
	speed: 0.0100s/iter; left time: 87.9310s
	iters: 400, epoch: 5 | loss: 0.1198286
	speed: 0.0100s/iter; left time: 86.8873s
	iters: 500, epoch: 5 | loss: 0.1105087
	speed: 0.0099s/iter; left time: 85.4787s
Epoch: 5 cost time: 5.889599800109863
Epoch: 5, Steps: 570 | Train Loss: 0.1086225 Vali Loss: 0.0437147 Test Loss: 0.1593006
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0729676
	speed: 0.0326s/iter; left time: 275.6520s
	iters: 200, epoch: 6 | loss: 0.0781414
	speed: 0.0099s/iter; left time: 82.8407s
	iters: 300, epoch: 6 | loss: 0.0860753
	speed: 0.0099s/iter; left time: 81.7775s
	iters: 400, epoch: 6 | loss: 0.1030072
	speed: 0.0099s/iter; left time: 80.5770s
	iters: 500, epoch: 6 | loss: 0.1314985
	speed: 0.0099s/iter; left time: 79.6056s
Epoch: 6 cost time: 5.84524941444397
Epoch: 6, Steps: 570 | Train Loss: 0.0970301 Vali Loss: 0.0443890 Test Loss: 0.1758516
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0691601
	speed: 0.0344s/iter; left time: 270.9459s
	iters: 200, epoch: 7 | loss: 0.0755094
	speed: 0.0099s/iter; left time: 76.7795s
	iters: 300, epoch: 7 | loss: 0.1105895
	speed: 0.0099s/iter; left time: 75.7234s
	iters: 400, epoch: 7 | loss: 0.0819347
	speed: 0.0099s/iter; left time: 74.9248s
	iters: 500, epoch: 7 | loss: 0.0709763
	speed: 0.0099s/iter; left time: 73.9862s
Epoch: 7 cost time: 5.828452110290527
Epoch: 7, Steps: 570 | Train Loss: 0.0897918 Vali Loss: 0.0447635 Test Loss: 0.1671375
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14695154130458832, mae:0.23869603872299194
>>> S LR=1e-3 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1520236
	speed: 0.0212s/iter; left time: 239.5410s
	iters: 200, epoch: 1 | loss: 0.1548833
	speed: 0.0097s/iter; left time: 108.5948s
	iters: 300, epoch: 1 | loss: 0.2273367
	speed: 0.0097s/iter; left time: 107.7352s
	iters: 400, epoch: 1 | loss: 0.1600210
	speed: 0.0097s/iter; left time: 106.6119s
	iters: 500, epoch: 1 | loss: 0.1187159
	speed: 0.0097s/iter; left time: 105.7142s
Epoch: 1 cost time: 6.717529058456421
Epoch: 1, Steps: 570 | Train Loss: 0.1564833 Vali Loss: 0.0359156 Test Loss: 0.1361597
Validation loss decreased (inf --> 0.035916).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1301072
	speed: 0.0333s/iter; left time: 357.2203s
	iters: 200, epoch: 2 | loss: 0.1636493
	speed: 0.0097s/iter; left time: 103.3233s
	iters: 300, epoch: 2 | loss: 0.0818086
	speed: 0.0097s/iter; left time: 102.1360s
	iters: 400, epoch: 2 | loss: 0.0922860
	speed: 0.0097s/iter; left time: 101.5206s
	iters: 500, epoch: 2 | loss: 0.1375351
	speed: 0.0097s/iter; left time: 100.4217s
Epoch: 2 cost time: 5.745901107788086
Epoch: 2, Steps: 570 | Train Loss: 0.1320662 Vali Loss: 0.0341317 Test Loss: 0.1265445
Validation loss decreased (0.035916 --> 0.034132).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0666047
	speed: 0.0325s/iter; left time: 330.5041s
	iters: 200, epoch: 3 | loss: 0.1220048
	speed: 0.0096s/iter; left time: 97.0177s
	iters: 300, epoch: 3 | loss: 0.2379576
	speed: 0.0096s/iter; left time: 95.8852s
	iters: 400, epoch: 3 | loss: 0.0842706
	speed: 0.0096s/iter; left time: 94.6593s
	iters: 500, epoch: 3 | loss: 0.1083356
	speed: 0.0096s/iter; left time: 93.8077s
Epoch: 3 cost time: 5.690905809402466
Epoch: 3, Steps: 570 | Train Loss: 0.1100980 Vali Loss: 0.0336505 Test Loss: 0.1192551
Validation loss decreased (0.034132 --> 0.033651).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0549970
	speed: 0.0325s/iter; left time: 312.1682s
	iters: 200, epoch: 4 | loss: 0.0732935
	speed: 0.0097s/iter; left time: 91.6528s
	iters: 300, epoch: 4 | loss: 0.0679300
	speed: 0.0096s/iter; left time: 90.5770s
	iters: 400, epoch: 4 | loss: 0.0597613
	speed: 0.0096s/iter; left time: 89.5978s
	iters: 500, epoch: 4 | loss: 0.0913851
	speed: 0.0097s/iter; left time: 88.7716s
Epoch: 4 cost time: 5.7065589427948
Epoch: 4, Steps: 570 | Train Loss: 0.0884700 Vali Loss: 0.0320455 Test Loss: 0.1141491
Validation loss decreased (0.033651 --> 0.032045).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0925790
	speed: 0.0343s/iter; left time: 309.8678s
	iters: 200, epoch: 5 | loss: 0.1078071
	speed: 0.0097s/iter; left time: 86.2048s
	iters: 300, epoch: 5 | loss: 0.0739578
	speed: 0.0096s/iter; left time: 84.7700s
	iters: 400, epoch: 5 | loss: 0.0925858
	speed: 0.0096s/iter; left time: 83.7011s
	iters: 500, epoch: 5 | loss: 0.0755817
	speed: 0.0096s/iter; left time: 82.8975s
Epoch: 5 cost time: 5.697272777557373
Epoch: 5, Steps: 570 | Train Loss: 0.0719178 Vali Loss: 0.0340264 Test Loss: 0.1210886
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0458987
	speed: 0.0331s/iter; left time: 279.8376s
	iters: 200, epoch: 6 | loss: 0.0881008
	speed: 0.0097s/iter; left time: 81.3328s
	iters: 300, epoch: 6 | loss: 0.0822319
	speed: 0.0097s/iter; left time: 80.1850s
	iters: 400, epoch: 6 | loss: 0.0473277
	speed: 0.0097s/iter; left time: 79.0971s
	iters: 500, epoch: 6 | loss: 0.0464111
	speed: 0.0097s/iter; left time: 78.0451s
Epoch: 6 cost time: 5.848376274108887
Epoch: 6, Steps: 570 | Train Loss: 0.0601371 Vali Loss: 0.0354510 Test Loss: 0.1255366
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0432866
	speed: 0.0319s/iter; left time: 251.4641s
	iters: 200, epoch: 7 | loss: 0.0522508
	speed: 0.0097s/iter; left time: 75.4149s
	iters: 300, epoch: 7 | loss: 0.0912942
	speed: 0.0097s/iter; left time: 74.6093s
	iters: 400, epoch: 7 | loss: 0.1045592
	speed: 0.0097s/iter; left time: 73.6875s
	iters: 500, epoch: 7 | loss: 0.0638355
	speed: 0.0097s/iter; left time: 72.6984s
Epoch: 7 cost time: 5.731947422027588
Epoch: 7, Steps: 570 | Train Loss: 0.0534178 Vali Loss: 0.0350934 Test Loss: 0.1249684
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11430096626281738, mae:0.20448043942451477
>>> S LR=1e-3 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2450588
	speed: 0.0210s/iter; left time: 237.7340s
	iters: 200, epoch: 1 | loss: 0.1258855
	speed: 0.0096s/iter; left time: 107.7440s
	iters: 300, epoch: 1 | loss: 0.1318603
	speed: 0.0096s/iter; left time: 106.9190s
	iters: 400, epoch: 1 | loss: 0.1272114
	speed: 0.0096s/iter; left time: 105.7151s
	iters: 500, epoch: 1 | loss: 0.1865833
	speed: 0.0096s/iter; left time: 104.7014s
Epoch: 1 cost time: 6.665918827056885
Epoch: 1, Steps: 570 | Train Loss: 0.2113291 Vali Loss: 0.0496622 Test Loss: 0.1791562
Validation loss decreased (inf --> 0.049662).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2445194
	speed: 0.0343s/iter; left time: 367.7285s
	iters: 200, epoch: 2 | loss: 0.1959876
	speed: 0.0096s/iter; left time: 102.4555s
	iters: 300, epoch: 2 | loss: 0.1562959
	speed: 0.0096s/iter; left time: 101.4166s
	iters: 400, epoch: 2 | loss: 0.2393743
	speed: 0.0097s/iter; left time: 100.8120s
	iters: 500, epoch: 2 | loss: 0.2312521
	speed: 0.0097s/iter; left time: 99.8739s
Epoch: 2 cost time: 5.726545810699463
Epoch: 2, Steps: 570 | Train Loss: 0.1857371 Vali Loss: 0.0420767 Test Loss: 0.1421405
Validation loss decreased (0.049662 --> 0.042077).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1009054
	speed: 0.0329s/iter; left time: 334.5852s
	iters: 200, epoch: 3 | loss: 0.1014432
	speed: 0.0097s/iter; left time: 97.9874s
	iters: 300, epoch: 3 | loss: 0.2065157
	speed: 0.0098s/iter; left time: 97.1268s
	iters: 400, epoch: 3 | loss: 0.0984457
	speed: 0.0097s/iter; left time: 95.7738s
	iters: 500, epoch: 3 | loss: 0.1264146
	speed: 0.0097s/iter; left time: 94.8206s
Epoch: 3 cost time: 5.77565336227417
Epoch: 3, Steps: 570 | Train Loss: 0.1416940 Vali Loss: 0.0436200 Test Loss: 0.1493366
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0805363
	speed: 0.0324s/iter; left time: 310.7482s
	iters: 200, epoch: 4 | loss: 0.0627835
	speed: 0.0095s/iter; left time: 90.5107s
	iters: 300, epoch: 4 | loss: 0.0832791
	speed: 0.0096s/iter; left time: 89.7444s
	iters: 400, epoch: 4 | loss: 0.1460097
	speed: 0.0095s/iter; left time: 88.6438s
	iters: 500, epoch: 4 | loss: 0.1055210
	speed: 0.0095s/iter; left time: 87.7351s
Epoch: 4 cost time: 5.648228168487549
Epoch: 4, Steps: 570 | Train Loss: 0.1139599 Vali Loss: 0.0424952 Test Loss: 0.1632724
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0930653
	speed: 0.0324s/iter; left time: 292.2233s
	iters: 200, epoch: 5 | loss: 0.0632448
	speed: 0.0096s/iter; left time: 85.6870s
	iters: 300, epoch: 5 | loss: 0.1003881
	speed: 0.0096s/iter; left time: 85.0746s
	iters: 400, epoch: 5 | loss: 0.0668614
	speed: 0.0096s/iter; left time: 83.9402s
	iters: 500, epoch: 5 | loss: 0.1132799
	speed: 0.0096s/iter; left time: 82.9179s
Epoch: 5 cost time: 5.702533960342407
Epoch: 5, Steps: 570 | Train Loss: 0.0903340 Vali Loss: 0.0428839 Test Loss: 0.1620083
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14226773381233215, mae:0.2383708357810974
>>> S LR=1e-3 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2572040
	speed: 0.0237s/iter; left time: 268.3101s
	iters: 200, epoch: 1 | loss: 0.1953682
	speed: 0.0113s/iter; left time: 126.7125s
	iters: 300, epoch: 1 | loss: 0.1508882
	speed: 0.0113s/iter; left time: 125.1887s
	iters: 400, epoch: 1 | loss: 0.1268045
	speed: 0.0113s/iter; left time: 124.1871s
	iters: 500, epoch: 1 | loss: 0.2270190
	speed: 0.0113s/iter; left time: 122.9775s
Epoch: 1 cost time: 7.7211527824401855
Epoch: 1, Steps: 570 | Train Loss: 0.2323010 Vali Loss: 0.0590042 Test Loss: 0.1704337
Validation loss decreased (inf --> 0.059004).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1703894
	speed: 0.0363s/iter; left time: 389.3109s
	iters: 200, epoch: 2 | loss: 0.1941893
	speed: 0.0120s/iter; left time: 127.4603s
	iters: 300, epoch: 2 | loss: 0.1552584
	speed: 0.0120s/iter; left time: 126.5032s
	iters: 400, epoch: 2 | loss: 0.1029969
	speed: 0.0120s/iter; left time: 125.2418s
	iters: 500, epoch: 2 | loss: 0.2293043
	speed: 0.0120s/iter; left time: 123.9812s
Epoch: 2 cost time: 7.0529913902282715
Epoch: 2, Steps: 570 | Train Loss: 0.2214241 Vali Loss: 0.0571945 Test Loss: 0.1698194
Validation loss decreased (0.059004 --> 0.057195).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2838650
	speed: 0.0367s/iter; left time: 373.0175s
	iters: 200, epoch: 3 | loss: 0.2614959
	speed: 0.0120s/iter; left time: 120.5707s
	iters: 300, epoch: 3 | loss: 0.0939838
	speed: 0.0120s/iter; left time: 119.0853s
	iters: 400, epoch: 3 | loss: 0.1816925
	speed: 0.0120s/iter; left time: 117.9960s
	iters: 500, epoch: 3 | loss: 0.1090607
	speed: 0.0120s/iter; left time: 116.8792s
Epoch: 3 cost time: 7.03783917427063
Epoch: 3, Steps: 570 | Train Loss: 0.1980092 Vali Loss: 0.0473346 Test Loss: 0.1466781
Validation loss decreased (0.057195 --> 0.047335).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1639273
	speed: 0.0365s/iter; left time: 349.6272s
	iters: 200, epoch: 4 | loss: 0.1350841
	speed: 0.0119s/iter; left time: 113.3270s
	iters: 300, epoch: 4 | loss: 0.1252728
	speed: 0.0120s/iter; left time: 112.5100s
	iters: 400, epoch: 4 | loss: 0.1025639
	speed: 0.0122s/iter; left time: 113.2894s
	iters: 500, epoch: 4 | loss: 0.1634524
	speed: 0.0123s/iter; left time: 113.0568s
Epoch: 4 cost time: 7.0896079540252686
Epoch: 4, Steps: 570 | Train Loss: 0.1718290 Vali Loss: 0.0476405 Test Loss: 0.1438199
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1387303
	speed: 0.0352s/iter; left time: 317.7477s
	iters: 200, epoch: 5 | loss: 0.1254653
	speed: 0.0113s/iter; left time: 100.6083s
	iters: 300, epoch: 5 | loss: 0.2274234
	speed: 0.0113s/iter; left time: 99.6256s
	iters: 400, epoch: 5 | loss: 0.1238542
	speed: 0.0113s/iter; left time: 98.4608s
	iters: 500, epoch: 5 | loss: 0.1600179
	speed: 0.0113s/iter; left time: 97.1458s
Epoch: 5 cost time: 6.632220983505249
Epoch: 5, Steps: 570 | Train Loss: 0.1613781 Vali Loss: 0.0451766 Test Loss: 0.1435014
Validation loss decreased (0.047335 --> 0.045177).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1167383
	speed: 0.0371s/iter; left time: 313.7028s
	iters: 200, epoch: 6 | loss: 0.0728463
	speed: 0.0115s/iter; left time: 95.9793s
	iters: 300, epoch: 6 | loss: 0.1423409
	speed: 0.0113s/iter; left time: 93.1884s
	iters: 400, epoch: 6 | loss: 0.1356555
	speed: 0.0113s/iter; left time: 91.9147s
	iters: 500, epoch: 6 | loss: 0.1330585
	speed: 0.0113s/iter; left time: 90.7721s
Epoch: 6 cost time: 6.7366414070129395
Epoch: 6, Steps: 570 | Train Loss: 0.1547440 Vali Loss: 0.0450785 Test Loss: 0.1421365
Validation loss decreased (0.045177 --> 0.045079).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1904535
	speed: 0.0392s/iter; left time: 308.8322s
	iters: 200, epoch: 7 | loss: 0.1463002
	speed: 0.0123s/iter; left time: 95.7369s
	iters: 300, epoch: 7 | loss: 0.1728229
	speed: 0.0118s/iter; left time: 90.9483s
	iters: 400, epoch: 7 | loss: 0.1384615
	speed: 0.0113s/iter; left time: 85.7464s
	iters: 500, epoch: 7 | loss: 0.1508588
	speed: 0.0113s/iter; left time: 84.5589s
Epoch: 7 cost time: 6.929150104522705
Epoch: 7, Steps: 570 | Train Loss: 0.1507789 Vali Loss: 0.0447692 Test Loss: 0.1405867
Validation loss decreased (0.045079 --> 0.044769).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1453899
	speed: 0.0377s/iter; left time: 275.2885s
	iters: 200, epoch: 8 | loss: 0.1514038
	speed: 0.0113s/iter; left time: 81.2657s
	iters: 300, epoch: 8 | loss: 0.1267038
	speed: 0.0113s/iter; left time: 80.0702s
	iters: 400, epoch: 8 | loss: 0.1642972
	speed: 0.0112s/iter; left time: 78.7884s
	iters: 500, epoch: 8 | loss: 0.1092012
	speed: 0.0112s/iter; left time: 77.6592s
Epoch: 8 cost time: 6.6481616497039795
Epoch: 8, Steps: 570 | Train Loss: 0.1479009 Vali Loss: 0.0443526 Test Loss: 0.1388660
Validation loss decreased (0.044769 --> 0.044353).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0908265
	speed: 0.0356s/iter; left time: 240.0267s
	iters: 200, epoch: 9 | loss: 0.1688333
	speed: 0.0113s/iter; left time: 74.7978s
	iters: 300, epoch: 9 | loss: 0.1570371
	speed: 0.0113s/iter; left time: 73.6645s
	iters: 400, epoch: 9 | loss: 0.0876904
	speed: 0.0113s/iter; left time: 72.5430s
	iters: 500, epoch: 9 | loss: 0.1800092
	speed: 0.0113s/iter; left time: 71.3469s
Epoch: 9 cost time: 6.624252080917358
Epoch: 9, Steps: 570 | Train Loss: 0.1467131 Vali Loss: 0.0444741 Test Loss: 0.1415819
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1270594
	speed: 0.0348s/iter; left time: 214.6011s
	iters: 200, epoch: 10 | loss: 0.1218600
	speed: 0.0113s/iter; left time: 68.3486s
	iters: 300, epoch: 10 | loss: 0.1491598
	speed: 0.0113s/iter; left time: 67.2762s
	iters: 400, epoch: 10 | loss: 0.1248058
	speed: 0.0113s/iter; left time: 66.1535s
	iters: 500, epoch: 10 | loss: 0.1817333
	speed: 0.0113s/iter; left time: 65.0313s
Epoch: 10 cost time: 6.630694150924683
Epoch: 10, Steps: 570 | Train Loss: 0.1454581 Vali Loss: 0.0444899 Test Loss: 0.1406379
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1283742
	speed: 0.0359s/iter; left time: 200.9155s
	iters: 200, epoch: 11 | loss: 0.2564875
	speed: 0.0123s/iter; left time: 67.7152s
	iters: 300, epoch: 11 | loss: 0.2034933
	speed: 0.0123s/iter; left time: 66.4956s
	iters: 400, epoch: 11 | loss: 0.1527369
	speed: 0.0123s/iter; left time: 65.3313s
	iters: 500, epoch: 11 | loss: 0.2317607
	speed: 0.0123s/iter; left time: 64.0401s
Epoch: 11 cost time: 7.21756911277771
Epoch: 11, Steps: 570 | Train Loss: 0.1447502 Vali Loss: 0.0446405 Test Loss: 0.1402011
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1390838474035263, mae:0.23783762753009796
>>> S LR=1e-3 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1246275
	speed: 0.0226s/iter; left time: 254.9317s
	iters: 200, epoch: 1 | loss: 0.2484318
	speed: 0.0110s/iter; left time: 122.6776s
	iters: 300, epoch: 1 | loss: 0.1210506
	speed: 0.0110s/iter; left time: 121.6112s
	iters: 400, epoch: 1 | loss: 0.2063160
	speed: 0.0109s/iter; left time: 120.3686s
	iters: 500, epoch: 1 | loss: 0.1164073
	speed: 0.0110s/iter; left time: 119.4622s
Epoch: 1 cost time: 7.446568250656128
Epoch: 1, Steps: 570 | Train Loss: 0.1895863 Vali Loss: 0.0462911 Test Loss: 0.1417792
Validation loss decreased (inf --> 0.046291).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2860627
	speed: 0.0360s/iter; left time: 386.3559s
	iters: 200, epoch: 2 | loss: 0.1505658
	speed: 0.0120s/iter; left time: 127.3915s
	iters: 300, epoch: 2 | loss: 0.2089427
	speed: 0.0120s/iter; left time: 125.8500s
	iters: 400, epoch: 2 | loss: 0.2419371
	speed: 0.0120s/iter; left time: 124.6928s
	iters: 500, epoch: 2 | loss: 0.1978825
	speed: 0.0119s/iter; left time: 123.3928s
Epoch: 2 cost time: 7.037397146224976
Epoch: 2, Steps: 570 | Train Loss: 0.2090949 Vali Loss: 0.0439042 Test Loss: 0.1417149
Validation loss decreased (0.046291 --> 0.043904).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1499871
	speed: 0.0369s/iter; left time: 375.2742s
	iters: 200, epoch: 3 | loss: 0.0782890
	speed: 0.0116s/iter; left time: 117.0963s
	iters: 300, epoch: 3 | loss: 0.1713011
	speed: 0.0119s/iter; left time: 118.9797s
	iters: 400, epoch: 3 | loss: 0.1360616
	speed: 0.0119s/iter; left time: 117.7236s
	iters: 500, epoch: 3 | loss: 0.1512985
	speed: 0.0117s/iter; left time: 113.7541s
Epoch: 3 cost time: 6.893694877624512
Epoch: 3, Steps: 570 | Train Loss: 0.1402874 Vali Loss: 0.0387770 Test Loss: 0.1263197
Validation loss decreased (0.043904 --> 0.038777).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1643391
	speed: 0.0368s/iter; left time: 352.6461s
	iters: 200, epoch: 4 | loss: 0.0897324
	speed: 0.0109s/iter; left time: 103.5927s
	iters: 300, epoch: 4 | loss: 0.0568546
	speed: 0.0109s/iter; left time: 102.6188s
	iters: 400, epoch: 4 | loss: 0.1214112
	speed: 0.0109s/iter; left time: 101.2839s
	iters: 500, epoch: 4 | loss: 0.0848337
	speed: 0.0109s/iter; left time: 100.1384s
Epoch: 4 cost time: 6.4282073974609375
Epoch: 4, Steps: 570 | Train Loss: 0.1264058 Vali Loss: 0.0378217 Test Loss: 0.1288624
Validation loss decreased (0.038777 --> 0.037822).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1116144
	speed: 0.0347s/iter; left time: 312.7716s
	iters: 200, epoch: 5 | loss: 0.0955019
	speed: 0.0110s/iter; left time: 97.7548s
	iters: 300, epoch: 5 | loss: 0.1475484
	speed: 0.0110s/iter; left time: 96.6637s
	iters: 400, epoch: 5 | loss: 0.1415641
	speed: 0.0109s/iter; left time: 95.4844s
	iters: 500, epoch: 5 | loss: 0.1034857
	speed: 0.0110s/iter; left time: 94.4491s
Epoch: 5 cost time: 6.45874285697937
Epoch: 5, Steps: 570 | Train Loss: 0.1192702 Vali Loss: 0.0362127 Test Loss: 0.1244363
Validation loss decreased (0.037822 --> 0.036213).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1666738
	speed: 0.0350s/iter; left time: 295.5346s
	iters: 200, epoch: 6 | loss: 0.1350009
	speed: 0.0109s/iter; left time: 90.9720s
	iters: 300, epoch: 6 | loss: 0.0786304
	speed: 0.0109s/iter; left time: 89.8979s
	iters: 400, epoch: 6 | loss: 0.0666121
	speed: 0.0109s/iter; left time: 88.8234s
	iters: 500, epoch: 6 | loss: 0.0892112
	speed: 0.0109s/iter; left time: 87.7539s
Epoch: 6 cost time: 6.416590213775635
Epoch: 6, Steps: 570 | Train Loss: 0.1149148 Vali Loss: 0.0353102 Test Loss: 0.1246400
Validation loss decreased (0.036213 --> 0.035310).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0652907
	speed: 0.0355s/iter; left time: 279.9959s
	iters: 200, epoch: 7 | loss: 0.1860870
	speed: 0.0120s/iter; left time: 93.0080s
	iters: 300, epoch: 7 | loss: 0.0987562
	speed: 0.0120s/iter; left time: 91.7970s
	iters: 400, epoch: 7 | loss: 0.0836124
	speed: 0.0120s/iter; left time: 90.6127s
	iters: 500, epoch: 7 | loss: 0.0873857
	speed: 0.0120s/iter; left time: 89.4304s
Epoch: 7 cost time: 6.980947732925415
Epoch: 7, Steps: 570 | Train Loss: 0.1125343 Vali Loss: 0.0351483 Test Loss: 0.1233604
Validation loss decreased (0.035310 --> 0.035148).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0760339
	speed: 0.0362s/iter; left time: 264.7352s
	iters: 200, epoch: 8 | loss: 0.1272700
	speed: 0.0109s/iter; left time: 78.6954s
	iters: 300, epoch: 8 | loss: 0.0681503
	speed: 0.0109s/iter; left time: 77.7045s
	iters: 400, epoch: 8 | loss: 0.1035880
	speed: 0.0109s/iter; left time: 76.4776s
	iters: 500, epoch: 8 | loss: 0.0899124
	speed: 0.0109s/iter; left time: 75.4853s
Epoch: 8 cost time: 6.4481329917907715
Epoch: 8, Steps: 570 | Train Loss: 0.1110738 Vali Loss: 0.0350152 Test Loss: 0.1226411
Validation loss decreased (0.035148 --> 0.035015).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1340721
	speed: 0.0347s/iter; left time: 234.1937s
	iters: 200, epoch: 9 | loss: 0.0752111
	speed: 0.0110s/iter; left time: 72.9678s
	iters: 300, epoch: 9 | loss: 0.1149082
	speed: 0.0110s/iter; left time: 71.7919s
	iters: 400, epoch: 9 | loss: 0.1191423
	speed: 0.0110s/iter; left time: 70.6953s
	iters: 500, epoch: 9 | loss: 0.1615342
	speed: 0.0110s/iter; left time: 69.6540s
Epoch: 9 cost time: 6.474408149719238
Epoch: 9, Steps: 570 | Train Loss: 0.1101689 Vali Loss: 0.0346550 Test Loss: 0.1227055
Validation loss decreased (0.035015 --> 0.034655).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1116781
	speed: 0.0356s/iter; left time: 219.6014s
	iters: 200, epoch: 10 | loss: 0.0893531
	speed: 0.0109s/iter; left time: 66.4228s
	iters: 300, epoch: 10 | loss: 0.1079540
	speed: 0.0110s/iter; left time: 65.4178s
	iters: 400, epoch: 10 | loss: 0.1085018
	speed: 0.0110s/iter; left time: 64.3787s
	iters: 500, epoch: 10 | loss: 0.1312777
	speed: 0.0110s/iter; left time: 63.2642s
Epoch: 10 cost time: 6.457386493682861
Epoch: 10, Steps: 570 | Train Loss: 0.1096201 Vali Loss: 0.0347983 Test Loss: 0.1230550
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0749212
	speed: 0.0353s/iter; left time: 197.5207s
	iters: 200, epoch: 11 | loss: 0.0860223
	speed: 0.0119s/iter; left time: 65.7309s
	iters: 300, epoch: 11 | loss: 0.0999416
	speed: 0.0116s/iter; left time: 62.6718s
	iters: 400, epoch: 11 | loss: 0.1265251
	speed: 0.0109s/iter; left time: 57.8674s
	iters: 500, epoch: 11 | loss: 0.1408807
	speed: 0.0109s/iter; left time: 56.8296s
Epoch: 11 cost time: 6.700962781906128
Epoch: 11, Steps: 570 | Train Loss: 0.1094348 Vali Loss: 0.0347655 Test Loss: 0.1230162
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1293238
	speed: 0.0360s/iter; left time: 181.3458s
	iters: 200, epoch: 12 | loss: 0.0782716
	speed: 0.0120s/iter; left time: 59.0108s
	iters: 300, epoch: 12 | loss: 0.0826810
	speed: 0.0115s/iter; left time: 55.7102s
	iters: 400, epoch: 12 | loss: 0.1520903
	speed: 0.0110s/iter; left time: 51.8307s
	iters: 500, epoch: 12 | loss: 0.1054148
	speed: 0.0110s/iter; left time: 50.7153s
Epoch: 12 cost time: 6.714941024780273
Epoch: 12, Steps: 570 | Train Loss: 0.1090878 Vali Loss: 0.0350489 Test Loss: 0.1230714
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12291748821735382, mae:0.21738767623901367
>>> S LR=1e-3 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2143231
	speed: 0.0229s/iter; left time: 259.1313s
	iters: 200, epoch: 1 | loss: 0.2841179
	speed: 0.0113s/iter; left time: 126.6924s
	iters: 300, epoch: 1 | loss: 0.4891925
	speed: 0.0103s/iter; left time: 113.8055s
	iters: 400, epoch: 1 | loss: 0.4400016
	speed: 0.0105s/iter; left time: 115.4010s
	iters: 500, epoch: 1 | loss: 0.3420311
	speed: 0.0113s/iter; left time: 122.9136s
Epoch: 1 cost time: 7.45502495765686
Epoch: 1, Steps: 570 | Train Loss: 0.2877012 Vali Loss: 0.0673670 Test Loss: 0.2021270
Validation loss decreased (inf --> 0.067367).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2574643
	speed: 0.0350s/iter; left time: 375.2142s
	iters: 200, epoch: 2 | loss: 0.3128095
	speed: 0.0102s/iter; left time: 108.3082s
	iters: 300, epoch: 2 | loss: 0.1654329
	speed: 0.0102s/iter; left time: 106.8901s
	iters: 400, epoch: 2 | loss: 0.1753480
	speed: 0.0102s/iter; left time: 106.0714s
	iters: 500, epoch: 2 | loss: 0.1706125
	speed: 0.0101s/iter; left time: 104.8397s
Epoch: 2 cost time: 6.023951530456543
Epoch: 2, Steps: 570 | Train Loss: 0.2513560 Vali Loss: 0.0601238 Test Loss: 0.1793393
Validation loss decreased (0.067367 --> 0.060124).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1632130
	speed: 0.0361s/iter; left time: 366.8081s
	iters: 200, epoch: 3 | loss: 0.1631067
	speed: 0.0102s/iter; left time: 102.9943s
	iters: 300, epoch: 3 | loss: 0.3549317
	speed: 0.0102s/iter; left time: 101.9079s
	iters: 400, epoch: 3 | loss: 0.2567049
	speed: 0.0102s/iter; left time: 100.6528s
	iters: 500, epoch: 3 | loss: 0.2172944
	speed: 0.0102s/iter; left time: 99.5874s
Epoch: 3 cost time: 6.053816080093384
Epoch: 3, Steps: 570 | Train Loss: 0.2491569 Vali Loss: 0.0616465 Test Loss: 0.1942679
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2704040
	speed: 0.0335s/iter; left time: 321.1888s
	iters: 200, epoch: 4 | loss: 0.1344265
	speed: 0.0101s/iter; left time: 96.1336s
	iters: 300, epoch: 4 | loss: 0.2287398
	speed: 0.0101s/iter; left time: 95.1980s
	iters: 400, epoch: 4 | loss: 0.3719090
	speed: 0.0101s/iter; left time: 94.1909s
	iters: 500, epoch: 4 | loss: 0.2563326
	speed: 0.0101s/iter; left time: 92.9942s
Epoch: 4 cost time: 6.008955478668213
Epoch: 4, Steps: 570 | Train Loss: 0.2436895 Vali Loss: 0.0614853 Test Loss: 0.1919617
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1896272
	speed: 0.0344s/iter; left time: 310.4236s
	iters: 200, epoch: 5 | loss: 0.2497554
	speed: 0.0113s/iter; left time: 100.5113s
	iters: 300, epoch: 5 | loss: 0.2447182
	speed: 0.0113s/iter; left time: 99.3121s
	iters: 400, epoch: 5 | loss: 0.1558715
	speed: 0.0113s/iter; left time: 98.2400s
	iters: 500, epoch: 5 | loss: 0.3110523
	speed: 0.0113s/iter; left time: 97.1067s
Epoch: 5 cost time: 6.571542501449585
Epoch: 5, Steps: 570 | Train Loss: 0.2315064 Vali Loss: 0.0590330 Test Loss: 0.1702444
Validation loss decreased (0.060124 --> 0.059033).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1501534
	speed: 0.0338s/iter; left time: 286.0160s
	iters: 200, epoch: 6 | loss: 0.1710319
	speed: 0.0102s/iter; left time: 85.1859s
	iters: 300, epoch: 6 | loss: 0.2226061
	speed: 0.0102s/iter; left time: 84.1727s
	iters: 400, epoch: 6 | loss: 0.1877835
	speed: 0.0102s/iter; left time: 83.1510s
	iters: 500, epoch: 6 | loss: 0.3001440
	speed: 0.0102s/iter; left time: 82.1595s
Epoch: 6 cost time: 6.0409698486328125
Epoch: 6, Steps: 570 | Train Loss: 0.2097769 Vali Loss: 0.0578463 Test Loss: 0.1639889
Validation loss decreased (0.059033 --> 0.057846).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1624193
	speed: 0.0351s/iter; left time: 276.5759s
	iters: 200, epoch: 7 | loss: 0.1363807
	speed: 0.0102s/iter; left time: 79.3283s
	iters: 300, epoch: 7 | loss: 0.1647005
	speed: 0.0102s/iter; left time: 78.0521s
	iters: 400, epoch: 7 | loss: 0.2257558
	speed: 0.0102s/iter; left time: 76.9767s
	iters: 500, epoch: 7 | loss: 0.1665973
	speed: 0.0102s/iter; left time: 75.9880s
Epoch: 7 cost time: 6.023094654083252
Epoch: 7, Steps: 570 | Train Loss: 0.1998910 Vali Loss: 0.0590637 Test Loss: 0.1676817
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1627484
	speed: 0.0334s/iter; left time: 244.1235s
	iters: 200, epoch: 8 | loss: 0.2597503
	speed: 0.0103s/iter; left time: 74.0345s
	iters: 300, epoch: 8 | loss: 0.2264202
	speed: 0.0103s/iter; left time: 72.9994s
	iters: 400, epoch: 8 | loss: 0.1750311
	speed: 0.0103s/iter; left time: 71.9534s
	iters: 500, epoch: 8 | loss: 0.1939555
	speed: 0.0103s/iter; left time: 70.9516s
Epoch: 8 cost time: 6.081551790237427
Epoch: 8, Steps: 570 | Train Loss: 0.1979857 Vali Loss: 0.0598963 Test Loss: 0.1663765
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1594965
	speed: 0.0353s/iter; left time: 237.9654s
	iters: 200, epoch: 9 | loss: 0.1526515
	speed: 0.0102s/iter; left time: 67.8305s
	iters: 300, epoch: 9 | loss: 0.2882518
	speed: 0.0102s/iter; left time: 66.9107s
	iters: 400, epoch: 9 | loss: 0.3226961
	speed: 0.0103s/iter; left time: 66.0475s
	iters: 500, epoch: 9 | loss: 0.0915845
	speed: 0.0102s/iter; left time: 64.7887s
Epoch: 9 cost time: 6.062237501144409
Epoch: 9, Steps: 570 | Train Loss: 0.1964499 Vali Loss: 0.0599241 Test Loss: 0.1666413
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16417551040649414, mae:0.259478360414505
>>> S LR=1e-3 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2523641
	speed: 0.0268s/iter; left time: 302.5336s
	iters: 200, epoch: 1 | loss: 0.1583809
	speed: 0.0150s/iter; left time: 168.3297s
	iters: 300, epoch: 1 | loss: 0.2953556
	speed: 0.0136s/iter; left time: 150.9857s
	iters: 400, epoch: 1 | loss: 0.1820042
	speed: 0.0136s/iter; left time: 149.7766s
	iters: 500, epoch: 1 | loss: 0.1666412
	speed: 0.0136s/iter; left time: 148.3506s
Epoch: 1 cost time: 9.257805585861206
Epoch: 1, Steps: 570 | Train Loss: 0.2071860 Vali Loss: 0.0480460 Test Loss: 0.1504136
Validation loss decreased (inf --> 0.048046).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2213697
	speed: 0.0422s/iter; left time: 453.2759s
	iters: 200, epoch: 2 | loss: 0.1961918
	speed: 0.0136s/iter; left time: 144.8560s
	iters: 300, epoch: 2 | loss: 0.1672370
	speed: 0.0153s/iter; left time: 161.4769s
	iters: 400, epoch: 2 | loss: 0.0916403
	speed: 0.0146s/iter; left time: 151.8011s
	iters: 500, epoch: 2 | loss: 0.2039088
	speed: 0.0136s/iter; left time: 140.6436s
Epoch: 2 cost time: 8.254867315292358
Epoch: 2, Steps: 570 | Train Loss: 0.1911529 Vali Loss: 0.0545340 Test Loss: 0.1557744
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2712979
	speed: 0.0429s/iter; left time: 436.1257s
	iters: 200, epoch: 3 | loss: 0.1555659
	speed: 0.0135s/iter; left time: 136.2945s
	iters: 300, epoch: 3 | loss: 0.0895889
	speed: 0.0135s/iter; left time: 134.7701s
	iters: 400, epoch: 3 | loss: 0.1068092
	speed: 0.0135s/iter; left time: 133.2256s
	iters: 500, epoch: 3 | loss: 0.1109139
	speed: 0.0135s/iter; left time: 131.8127s
Epoch: 3 cost time: 7.9142351150512695
Epoch: 3, Steps: 570 | Train Loss: 0.1628922 Vali Loss: 0.0448363 Test Loss: 0.1425964
Validation loss decreased (0.048046 --> 0.044836).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1033292
	speed: 0.0424s/iter; left time: 406.8813s
	iters: 200, epoch: 4 | loss: 0.1121991
	speed: 0.0136s/iter; left time: 128.9118s
	iters: 300, epoch: 4 | loss: 0.1826171
	speed: 0.0136s/iter; left time: 127.7321s
	iters: 400, epoch: 4 | loss: 0.1203747
	speed: 0.0136s/iter; left time: 126.6102s
	iters: 500, epoch: 4 | loss: 0.1689338
	speed: 0.0136s/iter; left time: 125.3767s
Epoch: 4 cost time: 7.983912944793701
Epoch: 4, Steps: 570 | Train Loss: 0.1474519 Vali Loss: 0.0440599 Test Loss: 0.1392455
Validation loss decreased (0.044836 --> 0.044060).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1192950
	speed: 0.0443s/iter; left time: 399.8205s
	iters: 200, epoch: 5 | loss: 0.1411447
	speed: 0.0151s/iter; left time: 135.0315s
	iters: 300, epoch: 5 | loss: 0.1052113
	speed: 0.0153s/iter; left time: 135.0051s
	iters: 400, epoch: 5 | loss: 0.1342147
	speed: 0.0153s/iter; left time: 133.1099s
	iters: 500, epoch: 5 | loss: 0.1436563
	speed: 0.0141s/iter; left time: 121.2064s
Epoch: 5 cost time: 8.490957975387573
Epoch: 5, Steps: 570 | Train Loss: 0.1359471 Vali Loss: 0.0416481 Test Loss: 0.1344388
Validation loss decreased (0.044060 --> 0.041648).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0995742
	speed: 0.0422s/iter; left time: 356.3145s
	iters: 200, epoch: 6 | loss: 0.1617704
	speed: 0.0136s/iter; left time: 113.8258s
	iters: 300, epoch: 6 | loss: 0.0831885
	speed: 0.0136s/iter; left time: 111.8581s
	iters: 400, epoch: 6 | loss: 0.1083531
	speed: 0.0135s/iter; left time: 110.3397s
	iters: 500, epoch: 6 | loss: 0.1020557
	speed: 0.0135s/iter; left time: 108.9378s
Epoch: 6 cost time: 7.945034503936768
Epoch: 6, Steps: 570 | Train Loss: 0.1277108 Vali Loss: 0.0448628 Test Loss: 0.1405622
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0927397
	speed: 0.0433s/iter; left time: 340.9330s
	iters: 200, epoch: 7 | loss: 0.1387088
	speed: 0.0152s/iter; left time: 118.3008s
	iters: 300, epoch: 7 | loss: 0.1518810
	speed: 0.0152s/iter; left time: 116.7810s
	iters: 400, epoch: 7 | loss: 0.0938337
	speed: 0.0152s/iter; left time: 115.2382s
	iters: 500, epoch: 7 | loss: 0.1713326
	speed: 0.0152s/iter; left time: 113.7075s
Epoch: 7 cost time: 8.901589155197144
Epoch: 7, Steps: 570 | Train Loss: 0.1227318 Vali Loss: 0.0440206 Test Loss: 0.1435305
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1625098
	speed: 0.0454s/iter; left time: 332.1170s
	iters: 200, epoch: 8 | loss: 0.1033299
	speed: 0.0152s/iter; left time: 109.6920s
	iters: 300, epoch: 8 | loss: 0.1131396
	speed: 0.0152s/iter; left time: 108.2826s
	iters: 400, epoch: 8 | loss: 0.0769855
	speed: 0.0152s/iter; left time: 106.7345s
	iters: 500, epoch: 8 | loss: 0.1111031
	speed: 0.0152s/iter; left time: 105.3116s
Epoch: 8 cost time: 8.890735864639282
Epoch: 8, Steps: 570 | Train Loss: 0.1193661 Vali Loss: 0.0436790 Test Loss: 0.1453948
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13460688292980194, mae:0.23341071605682373
>>> S LR=1e-3 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2683532
	speed: 0.0249s/iter; left time: 280.8328s
	iters: 200, epoch: 1 | loss: 0.1442800
	speed: 0.0133s/iter; left time: 149.4599s
	iters: 300, epoch: 1 | loss: 0.1567633
	speed: 0.0133s/iter; left time: 147.9598s
	iters: 400, epoch: 1 | loss: 0.2036206
	speed: 0.0134s/iter; left time: 147.0808s
	iters: 500, epoch: 1 | loss: 0.4689684
	speed: 0.0134s/iter; left time: 145.8956s
Epoch: 1 cost time: 8.810644388198853
Epoch: 1, Steps: 570 | Train Loss: 0.2069708 Vali Loss: 0.0824770 Test Loss: 0.2256030
Validation loss decreased (inf --> 0.082477).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2667367
	speed: 0.0431s/iter; left time: 462.8145s
	iters: 200, epoch: 2 | loss: 0.3793343
	speed: 0.0134s/iter; left time: 142.8170s
	iters: 300, epoch: 2 | loss: 0.3567933
	speed: 0.0134s/iter; left time: 140.9988s
	iters: 400, epoch: 2 | loss: 0.3469080
	speed: 0.0134s/iter; left time: 139.9165s
	iters: 500, epoch: 2 | loss: 0.3632975
	speed: 0.0134s/iter; left time: 138.3732s
Epoch: 2 cost time: 7.894071578979492
Epoch: 2, Steps: 570 | Train Loss: 0.3263459 Vali Loss: 0.0781753 Test Loss: 0.2194022
Validation loss decreased (0.082477 --> 0.078175).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3698874
	speed: 0.0439s/iter; left time: 446.2447s
	iters: 200, epoch: 3 | loss: 0.1772671
	speed: 0.0150s/iter; left time: 151.1296s
	iters: 300, epoch: 3 | loss: 0.3164888
	speed: 0.0150s/iter; left time: 149.0405s
	iters: 400, epoch: 3 | loss: 0.2724884
	speed: 0.0140s/iter; left time: 138.2252s
	iters: 500, epoch: 3 | loss: 0.2585830
	speed: 0.0134s/iter; left time: 130.9600s
Epoch: 3 cost time: 8.40806794166565
Epoch: 3, Steps: 570 | Train Loss: 0.3091812 Vali Loss: 0.0767989 Test Loss: 0.2147661
Validation loss decreased (0.078175 --> 0.076799).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2589813
	speed: 0.0422s/iter; left time: 404.5260s
	iters: 200, epoch: 4 | loss: 0.3009300
	speed: 0.0133s/iter; left time: 126.3478s
	iters: 300, epoch: 4 | loss: 0.3549426
	speed: 0.0133s/iter; left time: 124.6586s
	iters: 400, epoch: 4 | loss: 0.1817451
	speed: 0.0133s/iter; left time: 123.6538s
	iters: 500, epoch: 4 | loss: 0.1831258
	speed: 0.0133s/iter; left time: 122.0591s
Epoch: 4 cost time: 7.810022354125977
Epoch: 4, Steps: 570 | Train Loss: 0.2919308 Vali Loss: 0.0713382 Test Loss: 0.2076231
Validation loss decreased (0.076799 --> 0.071338).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1305674
	speed: 0.0435s/iter; left time: 392.2228s
	iters: 200, epoch: 5 | loss: 0.3903626
	speed: 0.0150s/iter; left time: 133.6877s
	iters: 300, epoch: 5 | loss: 0.3004937
	speed: 0.0150s/iter; left time: 132.1547s
	iters: 400, epoch: 5 | loss: 0.1899964
	speed: 0.0150s/iter; left time: 130.7087s
	iters: 500, epoch: 5 | loss: 0.3489600
	speed: 0.0150s/iter; left time: 129.2098s
Epoch: 5 cost time: 8.774847507476807
Epoch: 5, Steps: 570 | Train Loss: 0.2704802 Vali Loss: 0.0711290 Test Loss: 0.2075334
Validation loss decreased (0.071338 --> 0.071129).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2304661
	speed: 0.0435s/iter; left time: 367.3258s
	iters: 200, epoch: 6 | loss: 0.3408132
	speed: 0.0134s/iter; left time: 112.1553s
	iters: 300, epoch: 6 | loss: 0.3729770
	speed: 0.0134s/iter; left time: 110.4212s
	iters: 400, epoch: 6 | loss: 0.2047470
	speed: 0.0134s/iter; left time: 108.9961s
	iters: 500, epoch: 6 | loss: 0.1731823
	speed: 0.0134s/iter; left time: 107.8082s
Epoch: 6 cost time: 7.850551605224609
Epoch: 6, Steps: 570 | Train Loss: 0.2639934 Vali Loss: 0.0713063 Test Loss: 0.2106020
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2039587
	speed: 0.0417s/iter; left time: 328.3591s
	iters: 200, epoch: 7 | loss: 0.2755359
	speed: 0.0133s/iter; left time: 103.6067s
	iters: 300, epoch: 7 | loss: 0.4101198
	speed: 0.0133s/iter; left time: 102.4056s
	iters: 400, epoch: 7 | loss: 0.1961586
	speed: 0.0133s/iter; left time: 100.8356s
	iters: 500, epoch: 7 | loss: 0.3004972
	speed: 0.0133s/iter; left time: 99.5323s
Epoch: 7 cost time: 7.807756423950195
Epoch: 7, Steps: 570 | Train Loss: 0.2592600 Vali Loss: 0.0701945 Test Loss: 0.2068496
Validation loss decreased (0.071129 --> 0.070195).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1924961
	speed: 0.0430s/iter; left time: 314.1616s
	iters: 200, epoch: 8 | loss: 0.1985020
	speed: 0.0132s/iter; left time: 95.4447s
	iters: 300, epoch: 8 | loss: 0.3781864
	speed: 0.0132s/iter; left time: 94.1655s
	iters: 400, epoch: 8 | loss: 0.2337238
	speed: 0.0132s/iter; left time: 92.8797s
	iters: 500, epoch: 8 | loss: 0.2990265
	speed: 0.0132s/iter; left time: 91.5233s
Epoch: 8 cost time: 7.76348352432251
Epoch: 8, Steps: 570 | Train Loss: 0.2582830 Vali Loss: 0.0703088 Test Loss: 0.2080639
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2374284
	speed: 0.0412s/iter; left time: 277.5027s
	iters: 200, epoch: 9 | loss: 0.1772900
	speed: 0.0133s/iter; left time: 88.2433s
	iters: 300, epoch: 9 | loss: 0.2314385
	speed: 0.0133s/iter; left time: 86.8538s
	iters: 400, epoch: 9 | loss: 0.3094025
	speed: 0.0133s/iter; left time: 85.5388s
	iters: 500, epoch: 9 | loss: 0.2313839
	speed: 0.0133s/iter; left time: 84.4968s
Epoch: 9 cost time: 7.795444011688232
Epoch: 9, Steps: 570 | Train Loss: 0.2577996 Vali Loss: 0.0703303 Test Loss: 0.2079527
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3571045
	speed: 0.0441s/iter; left time: 272.2478s
	iters: 200, epoch: 10 | loss: 0.2638376
	speed: 0.0149s/iter; left time: 90.7316s
	iters: 300, epoch: 10 | loss: 0.3145684
	speed: 0.0150s/iter; left time: 89.3005s
	iters: 400, epoch: 10 | loss: 0.2455438
	speed: 0.0149s/iter; left time: 87.6688s
	iters: 500, epoch: 10 | loss: 0.3492953
	speed: 0.0149s/iter; left time: 86.1441s
Epoch: 10 cost time: 8.747584819793701
Epoch: 10, Steps: 570 | Train Loss: 0.2572948 Vali Loss: 0.0702520 Test Loss: 0.2083599
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.20717908442020416, mae:0.29748833179473877
>>> S LR=1e-3 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.0986703
	speed: 0.0254s/iter; left time: 286.7822s
	iters: 200, epoch: 1 | loss: 0.3315462
	speed: 0.0137s/iter; left time: 153.2864s
	iters: 300, epoch: 1 | loss: 0.3406813
	speed: 0.0137s/iter; left time: 151.8211s
	iters: 400, epoch: 1 | loss: 0.1955975
	speed: 0.0136s/iter; left time: 149.8482s
	iters: 500, epoch: 1 | loss: 0.2480521
	speed: 0.0137s/iter; left time: 149.0468s
Epoch: 1 cost time: 9.009811401367188
Epoch: 1, Steps: 570 | Train Loss: 0.2338926 Vali Loss: 0.0497513 Test Loss: 0.1663081
Validation loss decreased (inf --> 0.049751).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1825690
	speed: 0.0442s/iter; left time: 473.8860s
	iters: 200, epoch: 2 | loss: 0.2419299
	speed: 0.0137s/iter; left time: 145.3092s
	iters: 300, epoch: 2 | loss: 0.2253932
	speed: 0.0136s/iter; left time: 143.2858s
	iters: 400, epoch: 2 | loss: 0.2317881
	speed: 0.0136s/iter; left time: 141.9554s
	iters: 500, epoch: 2 | loss: 0.3631962
	speed: 0.0135s/iter; left time: 139.4646s
Epoch: 2 cost time: 8.022152423858643
Epoch: 2, Steps: 570 | Train Loss: 0.2791950 Vali Loss: 0.0741955 Test Loss: 0.2112954
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3098997
	speed: 0.0434s/iter; left time: 441.0355s
	iters: 200, epoch: 3 | loss: 0.3226156
	speed: 0.0135s/iter; left time: 135.7041s
	iters: 300, epoch: 3 | loss: 0.2191178
	speed: 0.0134s/iter; left time: 133.7232s
	iters: 400, epoch: 3 | loss: 0.2244402
	speed: 0.0134s/iter; left time: 132.5514s
	iters: 500, epoch: 3 | loss: 0.2214588
	speed: 0.0135s/iter; left time: 131.3856s
Epoch: 3 cost time: 7.937978744506836
Epoch: 3, Steps: 570 | Train Loss: 0.2798210 Vali Loss: 0.0616015 Test Loss: 0.1864460
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2430785
	speed: 0.0442s/iter; left time: 423.5118s
	iters: 200, epoch: 4 | loss: 0.1801431
	speed: 0.0136s/iter; left time: 128.8593s
	iters: 300, epoch: 4 | loss: 0.2719677
	speed: 0.0136s/iter; left time: 127.5552s
	iters: 400, epoch: 4 | loss: 0.1932263
	speed: 0.0135s/iter; left time: 125.8826s
	iters: 500, epoch: 4 | loss: 0.2098549
	speed: 0.0135s/iter; left time: 124.5343s
Epoch: 4 cost time: 8.050507545471191
Epoch: 4, Steps: 570 | Train Loss: 0.2401520 Vali Loss: 0.0572385 Test Loss: 0.1775475
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.166440948843956, mae:0.2601923942565918
>>> S LR=1e-3 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2798241
	speed: 0.0279s/iter; left time: 315.7028s
	iters: 200, epoch: 1 | loss: 0.2506367
	speed: 0.0161s/iter; left time: 180.8866s
	iters: 300, epoch: 1 | loss: 0.3331231
	speed: 0.0161s/iter; left time: 179.2495s
	iters: 400, epoch: 1 | loss: 0.2612338
	speed: 0.0162s/iter; left time: 177.7426s
	iters: 500, epoch: 1 | loss: 0.2524435
	speed: 0.0162s/iter; left time: 176.1744s
Epoch: 1 cost time: 10.439159393310547
Epoch: 1, Steps: 570 | Train Loss: 0.3219899 Vali Loss: 0.0634427 Test Loss: 0.2016514
Validation loss decreased (inf --> 0.063443).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3381602
	speed: 0.0484s/iter; left time: 519.8201s
	iters: 200, epoch: 2 | loss: 0.2476643
	speed: 0.0161s/iter; left time: 171.5956s
	iters: 300, epoch: 2 | loss: 0.2804091
	speed: 0.0161s/iter; left time: 169.9491s
	iters: 400, epoch: 2 | loss: 0.2043161
	speed: 0.0161s/iter; left time: 168.2661s
	iters: 500, epoch: 2 | loss: 0.1943311
	speed: 0.0161s/iter; left time: 166.6795s
Epoch: 2 cost time: 9.430699348449707
Epoch: 2, Steps: 570 | Train Loss: 0.2655296 Vali Loss: 0.0584210 Test Loss: 0.1940667
Validation loss decreased (0.063443 --> 0.058421).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1912294
	speed: 0.0477s/iter; left time: 484.8490s
	iters: 200, epoch: 3 | loss: 0.2411741
	speed: 0.0162s/iter; left time: 163.0883s
	iters: 300, epoch: 3 | loss: 0.3445681
	speed: 0.0162s/iter; left time: 161.1468s
	iters: 400, epoch: 3 | loss: 0.2201385
	speed: 0.0162s/iter; left time: 159.7717s
	iters: 500, epoch: 3 | loss: 0.2438365
	speed: 0.0162s/iter; left time: 158.0161s
Epoch: 3 cost time: 9.495477199554443
Epoch: 3, Steps: 570 | Train Loss: 0.2444707 Vali Loss: 0.0560378 Test Loss: 0.1789278
Validation loss decreased (0.058421 --> 0.056038).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2951446
	speed: 0.0512s/iter; left time: 491.0910s
	iters: 200, epoch: 4 | loss: 0.2693366
	speed: 0.0177s/iter; left time: 167.8259s
	iters: 300, epoch: 4 | loss: 0.1630186
	speed: 0.0176s/iter; left time: 165.2873s
	iters: 400, epoch: 4 | loss: 0.2084543
	speed: 0.0176s/iter; left time: 163.4789s
	iters: 500, epoch: 4 | loss: 0.2079423
	speed: 0.0176s/iter; left time: 161.7605s
Epoch: 4 cost time: 10.271082639694214
Epoch: 4, Steps: 570 | Train Loss: 0.2349238 Vali Loss: 0.0587189 Test Loss: 0.1872298
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1895944
	speed: 0.0474s/iter; left time: 427.3322s
	iters: 200, epoch: 5 | loss: 0.2937400
	speed: 0.0161s/iter; left time: 143.7322s
	iters: 300, epoch: 5 | loss: 0.3001266
	speed: 0.0161s/iter; left time: 142.2705s
	iters: 400, epoch: 5 | loss: 0.2201750
	speed: 0.0162s/iter; left time: 141.1241s
	iters: 500, epoch: 5 | loss: 0.1651196
	speed: 0.0161s/iter; left time: 138.9079s
Epoch: 5 cost time: 9.423638105392456
Epoch: 5, Steps: 570 | Train Loss: 0.2286787 Vali Loss: 0.0555330 Test Loss: 0.1735575
Validation loss decreased (0.056038 --> 0.055533).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2152973
	speed: 0.0475s/iter; left time: 401.5117s
	iters: 200, epoch: 6 | loss: 0.1990988
	speed: 0.0162s/iter; left time: 134.9414s
	iters: 300, epoch: 6 | loss: 0.3311787
	speed: 0.0161s/iter; left time: 133.1776s
	iters: 400, epoch: 6 | loss: 0.2976804
	speed: 0.0161s/iter; left time: 131.5784s
	iters: 500, epoch: 6 | loss: 0.1914357
	speed: 0.0162s/iter; left time: 130.0954s
Epoch: 6 cost time: 9.430855989456177
Epoch: 6, Steps: 570 | Train Loss: 0.2217213 Vali Loss: 0.0561889 Test Loss: 0.1725932
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2036816
	speed: 0.0496s/iter; left time: 390.5859s
	iters: 200, epoch: 7 | loss: 0.1987658
	speed: 0.0162s/iter; left time: 125.8889s
	iters: 300, epoch: 7 | loss: 0.2805438
	speed: 0.0162s/iter; left time: 124.2288s
	iters: 400, epoch: 7 | loss: 0.1547880
	speed: 0.0162s/iter; left time: 122.6053s
	iters: 500, epoch: 7 | loss: 0.1692277
	speed: 0.0162s/iter; left time: 120.9701s
Epoch: 7 cost time: 9.457520246505737
Epoch: 7, Steps: 570 | Train Loss: 0.2178026 Vali Loss: 0.0556621 Test Loss: 0.1719415
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1933712
	speed: 0.0469s/iter; left time: 342.7350s
	iters: 200, epoch: 8 | loss: 0.1394309
	speed: 0.0162s/iter; left time: 116.9798s
	iters: 300, epoch: 8 | loss: 0.1935186
	speed: 0.0162s/iter; left time: 115.3106s
	iters: 400, epoch: 8 | loss: 0.1302925
	speed: 0.0162s/iter; left time: 113.6996s
	iters: 500, epoch: 8 | loss: 0.1152468
	speed: 0.0162s/iter; left time: 112.0390s
Epoch: 8 cost time: 9.4608793258667
Epoch: 8, Steps: 570 | Train Loss: 0.2151845 Vali Loss: 0.0560506 Test Loss: 0.1727428
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1737855076789856, mae:0.2672940492630005
>>> S LR=1e-3 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2765375
	speed: 0.0290s/iter; left time: 328.2604s
	iters: 200, epoch: 1 | loss: 0.1597097
	speed: 0.0169s/iter; left time: 189.7654s
	iters: 300, epoch: 1 | loss: 0.1993252
	speed: 0.0170s/iter; left time: 188.2241s
	iters: 400, epoch: 1 | loss: 0.2626363
	speed: 0.0170s/iter; left time: 186.9281s
	iters: 500, epoch: 1 | loss: 0.1779009
	speed: 0.0171s/iter; left time: 186.1867s
Epoch: 1 cost time: 10.94956922531128
Epoch: 1, Steps: 570 | Train Loss: 0.2672131 Vali Loss: 0.0640245 Test Loss: 0.1874606
Validation loss decreased (inf --> 0.064025).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2195213
	speed: 0.0506s/iter; left time: 543.2202s
	iters: 200, epoch: 2 | loss: 0.2437646
	speed: 0.0158s/iter; left time: 167.5166s
	iters: 300, epoch: 2 | loss: 0.2850635
	speed: 0.0158s/iter; left time: 165.9464s
	iters: 400, epoch: 2 | loss: 0.3949916
	speed: 0.0157s/iter; left time: 164.1926s
	iters: 500, epoch: 2 | loss: 0.2762596
	speed: 0.0158s/iter; left time: 162.7293s
Epoch: 2 cost time: 9.2510404586792
Epoch: 2, Steps: 570 | Train Loss: 0.2642409 Vali Loss: 0.0637878 Test Loss: 0.1955225
Validation loss decreased (0.064025 --> 0.063788).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2164011
	speed: 0.0501s/iter; left time: 509.3996s
	iters: 200, epoch: 3 | loss: 0.2994745
	speed: 0.0171s/iter; left time: 172.4184s
	iters: 300, epoch: 3 | loss: 0.1847580
	speed: 0.0171s/iter; left time: 170.6651s
	iters: 400, epoch: 3 | loss: 0.1717036
	speed: 0.0171s/iter; left time: 168.7297s
	iters: 500, epoch: 3 | loss: 0.1364935
	speed: 0.0171s/iter; left time: 167.3299s
Epoch: 3 cost time: 10.048550844192505
Epoch: 3, Steps: 570 | Train Loss: 0.2375564 Vali Loss: 0.0567480 Test Loss: 0.1797707
Validation loss decreased (0.063788 --> 0.056748).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1420415
	speed: 0.0504s/iter; left time: 483.2885s
	iters: 200, epoch: 4 | loss: 0.3389712
	speed: 0.0158s/iter; left time: 149.8112s
	iters: 300, epoch: 4 | loss: 0.2901123
	speed: 0.0157s/iter; left time: 147.8952s
	iters: 400, epoch: 4 | loss: 0.1413819
	speed: 0.0158s/iter; left time: 146.3687s
	iters: 500, epoch: 4 | loss: 0.3280377
	speed: 0.0158s/iter; left time: 144.8133s
Epoch: 4 cost time: 9.273993968963623
Epoch: 4, Steps: 570 | Train Loss: 0.2202891 Vali Loss: 0.0632013 Test Loss: 0.1939590
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1896462
	speed: 0.0489s/iter; left time: 441.2294s
	iters: 200, epoch: 5 | loss: 0.2496657
	speed: 0.0158s/iter; left time: 140.5171s
	iters: 300, epoch: 5 | loss: 0.1519922
	speed: 0.0158s/iter; left time: 138.9512s
	iters: 400, epoch: 5 | loss: 0.1268422
	speed: 0.0157s/iter; left time: 137.3273s
	iters: 500, epoch: 5 | loss: 0.2635339
	speed: 0.0158s/iter; left time: 135.8403s
Epoch: 5 cost time: 9.275742530822754
Epoch: 5, Steps: 570 | Train Loss: 0.2088036 Vali Loss: 0.0552758 Test Loss: 0.1777496
Validation loss decreased (0.056748 --> 0.055276).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2770490
	speed: 0.0486s/iter; left time: 411.0151s
	iters: 200, epoch: 6 | loss: 0.3061370
	speed: 0.0157s/iter; left time: 131.0321s
	iters: 300, epoch: 6 | loss: 0.2960353
	speed: 0.0157s/iter; left time: 129.4458s
	iters: 400, epoch: 6 | loss: 0.2038673
	speed: 0.0157s/iter; left time: 127.7890s
	iters: 500, epoch: 6 | loss: 0.1741196
	speed: 0.0157s/iter; left time: 126.1461s
Epoch: 6 cost time: 9.234108209609985
Epoch: 6, Steps: 570 | Train Loss: 0.2005465 Vali Loss: 0.0553225 Test Loss: 0.1757313
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3962488
	speed: 0.0483s/iter; left time: 380.7899s
	iters: 200, epoch: 7 | loss: 0.0990363
	speed: 0.0158s/iter; left time: 122.6958s
	iters: 300, epoch: 7 | loss: 0.2553741
	speed: 0.0158s/iter; left time: 121.0093s
	iters: 400, epoch: 7 | loss: 0.3269990
	speed: 0.0157s/iter; left time: 119.2791s
	iters: 500, epoch: 7 | loss: 0.2898639
	speed: 0.0157s/iter; left time: 117.6675s
Epoch: 7 cost time: 9.262630462646484
Epoch: 7, Steps: 570 | Train Loss: 0.1950182 Vali Loss: 0.0558319 Test Loss: 0.1765647
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1780372
	speed: 0.0472s/iter; left time: 345.2618s
	iters: 200, epoch: 8 | loss: 0.3513171
	speed: 0.0158s/iter; left time: 113.6056s
	iters: 300, epoch: 8 | loss: 0.2351395
	speed: 0.0157s/iter; left time: 111.3952s
	iters: 400, epoch: 8 | loss: 0.2572345
	speed: 0.0156s/iter; left time: 109.6939s
	iters: 500, epoch: 8 | loss: 0.1212561
	speed: 0.0156s/iter; left time: 108.0884s
Epoch: 8 cost time: 9.204288959503174
Epoch: 8, Steps: 570 | Train Loss: 0.1913091 Vali Loss: 0.0557262 Test Loss: 0.1779064
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17802345752716064, mae:0.2793439030647278
>>> S LR=1e-3 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3197010
	speed: 0.0278s/iter; left time: 314.3548s
	iters: 200, epoch: 1 | loss: 0.2888510
	speed: 0.0162s/iter; left time: 180.9464s
	iters: 300, epoch: 1 | loss: 0.3465559
	speed: 0.0161s/iter; left time: 178.8981s
	iters: 400, epoch: 1 | loss: 0.2626291
	speed: 0.0161s/iter; left time: 177.4063s
	iters: 500, epoch: 1 | loss: 0.4458068
	speed: 0.0147s/iter; left time: 159.8897s
Epoch: 1 cost time: 10.159544229507446
Epoch: 1, Steps: 570 | Train Loss: 0.2962241 Vali Loss: 0.0619144 Test Loss: 0.1987483
Validation loss decreased (inf --> 0.061914).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3535101
	speed: 0.0461s/iter; left time: 494.9272s
	iters: 200, epoch: 2 | loss: 0.1942431
	speed: 0.0148s/iter; left time: 156.9417s
	iters: 300, epoch: 2 | loss: 0.3150498
	speed: 0.0147s/iter; left time: 155.1540s
	iters: 400, epoch: 2 | loss: 0.2071104
	speed: 0.0147s/iter; left time: 153.7935s
	iters: 500, epoch: 2 | loss: 0.3021327
	speed: 0.0148s/iter; left time: 152.6456s
Epoch: 2 cost time: 8.651601552963257
Epoch: 2, Steps: 570 | Train Loss: 0.2640784 Vali Loss: 0.0549378 Test Loss: 0.1859448
Validation loss decreased (0.061914 --> 0.054938).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2694764
	speed: 0.0453s/iter; left time: 460.1608s
	iters: 200, epoch: 3 | loss: 0.1631545
	speed: 0.0148s/iter; left time: 148.9311s
	iters: 300, epoch: 3 | loss: 0.2415325
	speed: 0.0148s/iter; left time: 147.6604s
	iters: 400, epoch: 3 | loss: 0.2166170
	speed: 0.0148s/iter; left time: 146.2192s
	iters: 500, epoch: 3 | loss: 0.2204309
	speed: 0.0148s/iter; left time: 144.6057s
Epoch: 3 cost time: 8.678527593612671
Epoch: 3, Steps: 570 | Train Loss: 0.2414398 Vali Loss: 0.0587804 Test Loss: 0.1762697
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2012524
	speed: 0.0456s/iter; left time: 437.3045s
	iters: 200, epoch: 4 | loss: 0.2939195
	speed: 0.0162s/iter; left time: 153.6971s
	iters: 300, epoch: 4 | loss: 0.2772353
	speed: 0.0148s/iter; left time: 139.1388s
	iters: 400, epoch: 4 | loss: 0.2472637
	speed: 0.0148s/iter; left time: 137.3662s
	iters: 500, epoch: 4 | loss: 0.2155983
	speed: 0.0148s/iter; left time: 135.8524s
Epoch: 4 cost time: 8.930143356323242
Epoch: 4, Steps: 570 | Train Loss: 0.2238855 Vali Loss: 0.0599637 Test Loss: 0.1766210
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1458621
	speed: 0.0453s/iter; left time: 408.3136s
	iters: 200, epoch: 5 | loss: 0.1714016
	speed: 0.0147s/iter; left time: 131.1881s
	iters: 300, epoch: 5 | loss: 0.1703098
	speed: 0.0147s/iter; left time: 129.6875s
	iters: 400, epoch: 5 | loss: 0.1521310
	speed: 0.0147s/iter; left time: 128.2391s
	iters: 500, epoch: 5 | loss: 0.1939463
	speed: 0.0147s/iter; left time: 126.7968s
Epoch: 5 cost time: 8.604743957519531
Epoch: 5, Steps: 570 | Train Loss: 0.1977326 Vali Loss: 0.0534405 Test Loss: 0.1662861
Validation loss decreased (0.054938 --> 0.053440).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2853236
	speed: 0.0473s/iter; left time: 399.5175s
	iters: 200, epoch: 6 | loss: 0.1128348
	speed: 0.0147s/iter; left time: 122.6983s
	iters: 300, epoch: 6 | loss: 0.1229603
	speed: 0.0147s/iter; left time: 121.1973s
	iters: 400, epoch: 6 | loss: 0.1085691
	speed: 0.0147s/iter; left time: 119.8518s
	iters: 500, epoch: 6 | loss: 0.1568163
	speed: 0.0147s/iter; left time: 118.1102s
Epoch: 6 cost time: 8.61506700515747
Epoch: 6, Steps: 570 | Train Loss: 0.1840624 Vali Loss: 0.0546433 Test Loss: 0.1656247
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1751337
	speed: 0.0469s/iter; left time: 369.9952s
	iters: 200, epoch: 7 | loss: 0.1974593
	speed: 0.0148s/iter; left time: 114.8607s
	iters: 300, epoch: 7 | loss: 0.1443065
	speed: 0.0147s/iter; left time: 113.2363s
	iters: 400, epoch: 7 | loss: 0.1523907
	speed: 0.0148s/iter; left time: 111.8840s
	iters: 500, epoch: 7 | loss: 0.1721605
	speed: 0.0148s/iter; left time: 110.3507s
Epoch: 7 cost time: 8.662007570266724
Epoch: 7, Steps: 570 | Train Loss: 0.1772710 Vali Loss: 0.0508570 Test Loss: 0.1608129
Validation loss decreased (0.053440 --> 0.050857).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1486135
	speed: 0.0474s/iter; left time: 346.6560s
	iters: 200, epoch: 8 | loss: 0.2243285
	speed: 0.0148s/iter; left time: 106.7922s
	iters: 300, epoch: 8 | loss: 0.1131408
	speed: 0.0148s/iter; left time: 105.2731s
	iters: 400, epoch: 8 | loss: 0.2343990
	speed: 0.0148s/iter; left time: 103.6794s
	iters: 500, epoch: 8 | loss: 0.1165916
	speed: 0.0148s/iter; left time: 102.1648s
Epoch: 8 cost time: 8.665420055389404
Epoch: 8, Steps: 570 | Train Loss: 0.1724373 Vali Loss: 0.0520786 Test Loss: 0.1617621
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2010035
	speed: 0.0440s/iter; left time: 296.6439s
	iters: 200, epoch: 9 | loss: 0.1606593
	speed: 0.0147s/iter; left time: 97.6788s
	iters: 300, epoch: 9 | loss: 0.2716824
	speed: 0.0147s/iter; left time: 96.2875s
	iters: 400, epoch: 9 | loss: 0.1712029
	speed: 0.0147s/iter; left time: 94.7211s
	iters: 500, epoch: 9 | loss: 0.2535189
	speed: 0.0147s/iter; left time: 93.3625s
Epoch: 9 cost time: 8.622722864151001
Epoch: 9, Steps: 570 | Train Loss: 0.1701056 Vali Loss: 0.0511046 Test Loss: 0.1613232
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2003465
	speed: 0.0445s/iter; left time: 274.7308s
	iters: 200, epoch: 10 | loss: 0.2106599
	speed: 0.0150s/iter; left time: 90.8199s
	iters: 300, epoch: 10 | loss: 0.1548920
	speed: 0.0156s/iter; left time: 93.3026s
	iters: 400, epoch: 10 | loss: 0.1906806
	speed: 0.0148s/iter; left time: 86.7015s
	iters: 500, epoch: 10 | loss: 0.3091659
	speed: 0.0148s/iter; left time: 85.2579s
Epoch: 10 cost time: 8.731921195983887
Epoch: 10, Steps: 570 | Train Loss: 0.1682143 Vali Loss: 0.0509580 Test Loss: 0.1618582
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16106173396110535, mae:0.26875928044319153
>>> S LR=1e-3 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2223386
	speed: 0.0287s/iter; left time: 324.5803s
	iters: 200, epoch: 1 | loss: 0.2448232
	speed: 0.0174s/iter; left time: 194.8452s
	iters: 300, epoch: 1 | loss: 0.3934541
	speed: 0.0173s/iter; left time: 192.4968s
	iters: 400, epoch: 1 | loss: 0.2058355
	speed: 0.0174s/iter; left time: 191.2420s
	iters: 500, epoch: 1 | loss: 0.1564814
	speed: 0.0175s/iter; left time: 190.3441s
Epoch: 1 cost time: 11.104063272476196
Epoch: 1, Steps: 570 | Train Loss: 0.2293180 Vali Loss: 0.0514191 Test Loss: 0.1526857
Validation loss decreased (inf --> 0.051419).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3272489
	speed: 0.0543s/iter; left time: 582.3104s
	iters: 200, epoch: 2 | loss: 0.2264422
	speed: 0.0177s/iter; left time: 188.1412s
	iters: 300, epoch: 2 | loss: 0.2306444
	speed: 0.0177s/iter; left time: 185.9899s
	iters: 400, epoch: 2 | loss: 0.2818699
	speed: 0.0177s/iter; left time: 184.6570s
	iters: 500, epoch: 2 | loss: 0.2704155
	speed: 0.0177s/iter; left time: 182.5474s
Epoch: 2 cost time: 10.306190729141235
Epoch: 2, Steps: 570 | Train Loss: 0.2790165 Vali Loss: 0.0666087 Test Loss: 0.1930230
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1510031
	speed: 0.0519s/iter; left time: 526.9267s
	iters: 200, epoch: 3 | loss: 0.1902496
	speed: 0.0175s/iter; left time: 175.6983s
	iters: 300, epoch: 3 | loss: 0.1988350
	speed: 0.0175s/iter; left time: 173.9643s
	iters: 400, epoch: 3 | loss: 0.2093918
	speed: 0.0174s/iter; left time: 171.8526s
	iters: 500, epoch: 3 | loss: 0.1807641
	speed: 0.0175s/iter; left time: 170.6803s
Epoch: 3 cost time: 10.16489863395691
Epoch: 3, Steps: 570 | Train Loss: 0.2522888 Vali Loss: 0.0614282 Test Loss: 0.1985800
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2924142
	speed: 0.0535s/iter; left time: 512.9546s
	iters: 200, epoch: 4 | loss: 0.2664168
	speed: 0.0196s/iter; left time: 186.0340s
	iters: 300, epoch: 4 | loss: 0.3686956
	speed: 0.0196s/iter; left time: 184.4600s
	iters: 400, epoch: 4 | loss: 0.1420840
	speed: 0.0196s/iter; left time: 182.1454s
	iters: 500, epoch: 4 | loss: 0.2552347
	speed: 0.0196s/iter; left time: 179.9711s
Epoch: 4 cost time: 11.373024463653564
Epoch: 4, Steps: 570 | Train Loss: 0.2369637 Vali Loss: 0.0556777 Test Loss: 0.1804907
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15286368131637573, mae:0.24732348322868347
>>> S LR=1e-3 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3247057
	speed: 0.0312s/iter; left time: 352.9374s
	iters: 200, epoch: 1 | loss: 0.1816824
	speed: 0.0193s/iter; left time: 216.5415s
	iters: 300, epoch: 1 | loss: 0.1552184
	speed: 0.0193s/iter; left time: 214.1356s
	iters: 400, epoch: 1 | loss: 0.1278616
	speed: 0.0194s/iter; left time: 212.9509s
	iters: 500, epoch: 1 | loss: 0.2216636
	speed: 0.0194s/iter; left time: 210.9752s
Epoch: 1 cost time: 12.261943817138672
Epoch: 1, Steps: 570 | Train Loss: 0.1792144 Vali Loss: 0.0468984 Test Loss: 0.1535033
Validation loss decreased (inf --> 0.046898).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1261756
	speed: 0.0589s/iter; left time: 632.0941s
	iters: 200, epoch: 2 | loss: 0.3348196
	speed: 0.0173s/iter; left time: 184.0708s
	iters: 300, epoch: 2 | loss: 0.5276511
	speed: 0.0173s/iter; left time: 182.1238s
	iters: 400, epoch: 2 | loss: 0.2662973
	speed: 0.0173s/iter; left time: 180.1507s
	iters: 500, epoch: 2 | loss: 0.2513466
	speed: 0.0173s/iter; left time: 178.4919s
Epoch: 2 cost time: 10.31127119064331
Epoch: 2, Steps: 570 | Train Loss: 0.2739849 Vali Loss: 0.0576708 Test Loss: 0.1827639
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1939401
	speed: 0.0528s/iter; left time: 536.1026s
	iters: 200, epoch: 3 | loss: 0.2521726
	speed: 0.0174s/iter; left time: 174.7768s
	iters: 300, epoch: 3 | loss: 0.2201906
	speed: 0.0173s/iter; left time: 172.3408s
	iters: 400, epoch: 3 | loss: 0.2156551
	speed: 0.0173s/iter; left time: 170.2874s
	iters: 500, epoch: 3 | loss: 0.1937736
	speed: 0.0173s/iter; left time: 169.0770s
Epoch: 3 cost time: 10.13830304145813
Epoch: 3, Steps: 570 | Train Loss: 0.2477870 Vali Loss: 0.0583056 Test Loss: 0.1804461
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3152800
	speed: 0.0570s/iter; left time: 546.5692s
	iters: 200, epoch: 4 | loss: 0.1056746
	speed: 0.0173s/iter; left time: 164.0266s
	iters: 300, epoch: 4 | loss: 0.1859471
	speed: 0.0173s/iter; left time: 162.6072s
	iters: 400, epoch: 4 | loss: 0.2181658
	speed: 0.0173s/iter; left time: 160.7620s
	iters: 500, epoch: 4 | loss: 0.1302862
	speed: 0.0173s/iter; left time: 158.9557s
Epoch: 4 cost time: 10.140872240066528
Epoch: 4, Steps: 570 | Train Loss: 0.2260020 Vali Loss: 0.0599542 Test Loss: 0.1894386
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15373563766479492, mae:0.25618118047714233
>>> S LR=1e-3 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2375513
	speed: 0.0284s/iter; left time: 321.4880s
	iters: 200, epoch: 1 | loss: 0.2058187
	speed: 0.0173s/iter; left time: 193.3374s
	iters: 300, epoch: 1 | loss: 0.3054080
	speed: 0.0172s/iter; left time: 191.2349s
	iters: 400, epoch: 1 | loss: 0.2074176
	speed: 0.0173s/iter; left time: 189.8116s
	iters: 500, epoch: 1 | loss: 0.3697376
	speed: 0.0172s/iter; left time: 188.0216s
Epoch: 1 cost time: 10.999901056289673
Epoch: 1, Steps: 570 | Train Loss: 0.2419328 Vali Loss: 0.0574146 Test Loss: 0.1914034
Validation loss decreased (inf --> 0.057415).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3853567
	speed: 0.0555s/iter; left time: 595.1582s
	iters: 200, epoch: 2 | loss: 0.2768392
	speed: 0.0173s/iter; left time: 183.5814s
	iters: 300, epoch: 2 | loss: 0.6330671
	speed: 0.0175s/iter; left time: 184.1483s
	iters: 400, epoch: 2 | loss: 0.2312599
	speed: 0.0193s/iter; left time: 200.9408s
	iters: 500, epoch: 2 | loss: 0.1601168
	speed: 0.0192s/iter; left time: 198.8147s
Epoch: 2 cost time: 10.715024709701538
Epoch: 2, Steps: 570 | Train Loss: 0.2541324 Vali Loss: 0.0612654 Test Loss: 0.1953631
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1523501
	speed: 0.0548s/iter; left time: 557.0873s
	iters: 200, epoch: 3 | loss: 0.1992908
	speed: 0.0171s/iter; left time: 172.2357s
	iters: 300, epoch: 3 | loss: 0.1754349
	speed: 0.0171s/iter; left time: 170.5538s
	iters: 400, epoch: 3 | loss: 0.3337750
	speed: 0.0171s/iter; left time: 168.9360s
	iters: 500, epoch: 3 | loss: 0.2233379
	speed: 0.0171s/iter; left time: 166.9885s
Epoch: 3 cost time: 9.981860399246216
Epoch: 3, Steps: 570 | Train Loss: 0.2156407 Vali Loss: 0.0550114 Test Loss: 0.1889475
Validation loss decreased (0.057415 --> 0.055011).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2353683
	speed: 0.0517s/iter; left time: 496.2622s
	iters: 200, epoch: 4 | loss: 0.2325901
	speed: 0.0173s/iter; left time: 163.8246s
	iters: 300, epoch: 4 | loss: 0.1795088
	speed: 0.0172s/iter; left time: 161.9263s
	iters: 400, epoch: 4 | loss: 0.1945364
	speed: 0.0172s/iter; left time: 160.0933s
	iters: 500, epoch: 4 | loss: 0.1355591
	speed: 0.0172s/iter; left time: 158.2671s
Epoch: 4 cost time: 10.052384376525879
Epoch: 4, Steps: 570 | Train Loss: 0.1942146 Vali Loss: 0.0539871 Test Loss: 0.1744000
Validation loss decreased (0.055011 --> 0.053987).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1675209
	speed: 0.0526s/iter; left time: 474.7377s
	iters: 200, epoch: 5 | loss: 0.1298061
	speed: 0.0172s/iter; left time: 153.7346s
	iters: 300, epoch: 5 | loss: 0.1555471
	speed: 0.0173s/iter; left time: 152.2652s
	iters: 400, epoch: 5 | loss: 0.2267800
	speed: 0.0172s/iter; left time: 150.2881s
	iters: 500, epoch: 5 | loss: 0.1277134
	speed: 0.0172s/iter; left time: 148.4110s
Epoch: 5 cost time: 10.042154788970947
Epoch: 5, Steps: 570 | Train Loss: 0.1839277 Vali Loss: 0.0553828 Test Loss: 0.1660925
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1675998
	speed: 0.0519s/iter; left time: 438.5252s
	iters: 200, epoch: 6 | loss: 0.1006011
	speed: 0.0173s/iter; left time: 144.6836s
	iters: 300, epoch: 6 | loss: 0.2936696
	speed: 0.0173s/iter; left time: 143.0327s
	iters: 400, epoch: 6 | loss: 0.1439611
	speed: 0.0173s/iter; left time: 141.2946s
	iters: 500, epoch: 6 | loss: 0.1860279
	speed: 0.0173s/iter; left time: 139.5388s
Epoch: 6 cost time: 10.08993411064148
Epoch: 6, Steps: 570 | Train Loss: 0.1825945 Vali Loss: 0.0567198 Test Loss: 0.1725268
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1343975
	speed: 0.0513s/iter; left time: 404.3210s
	iters: 200, epoch: 7 | loss: 0.2461110
	speed: 0.0172s/iter; left time: 133.6347s
	iters: 300, epoch: 7 | loss: 0.2396335
	speed: 0.0172s/iter; left time: 131.8541s
	iters: 400, epoch: 7 | loss: 0.1680886
	speed: 0.0172s/iter; left time: 130.2035s
	iters: 500, epoch: 7 | loss: 0.1206494
	speed: 0.0172s/iter; left time: 128.4852s
Epoch: 7 cost time: 10.023880004882812
Epoch: 7, Steps: 570 | Train Loss: 0.1768501 Vali Loss: 0.0564946 Test Loss: 0.1735741
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17459851503372192, mae:0.2720768451690674
>>> S LR=1e-3 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2795554
	speed: 0.0333s/iter; left time: 375.8003s
	iters: 200, epoch: 1 | loss: 0.3394006
	speed: 0.0228s/iter; left time: 255.4351s
	iters: 300, epoch: 1 | loss: 0.3579606
	speed: 0.0230s/iter; left time: 254.8880s
	iters: 400, epoch: 1 | loss: 0.4042315
	speed: 0.0229s/iter; left time: 251.9598s
	iters: 500, epoch: 1 | loss: 0.3330602
	speed: 0.0229s/iter; left time: 249.7952s
Epoch: 1 cost time: 14.141839742660522
Epoch: 1, Steps: 570 | Train Loss: 0.3744171 Vali Loss: 0.0591090 Test Loss: 0.1989145
Validation loss decreased (inf --> 0.059109).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2850131
	speed: 0.0632s/iter; left time: 678.2939s
	iters: 200, epoch: 2 | loss: 0.2710151
	speed: 0.0211s/iter; left time: 224.5995s
	iters: 300, epoch: 2 | loss: 0.2615319
	speed: 0.0212s/iter; left time: 223.4437s
	iters: 400, epoch: 2 | loss: 0.3077683
	speed: 0.0213s/iter; left time: 222.1688s
	iters: 500, epoch: 2 | loss: 0.2289451
	speed: 0.0213s/iter; left time: 219.6579s
Epoch: 2 cost time: 12.357957363128662
Epoch: 2, Steps: 570 | Train Loss: 0.2722242 Vali Loss: 0.0571905 Test Loss: 0.1828603
Validation loss decreased (0.059109 --> 0.057191).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4497688
	speed: 0.0596s/iter; left time: 605.4721s
	iters: 200, epoch: 3 | loss: 0.1995514
	speed: 0.0213s/iter; left time: 214.0443s
	iters: 300, epoch: 3 | loss: 0.2683879
	speed: 0.0213s/iter; left time: 211.7491s
	iters: 400, epoch: 3 | loss: 0.2114711
	speed: 0.0213s/iter; left time: 209.6669s
	iters: 500, epoch: 3 | loss: 0.1710466
	speed: 0.0211s/iter; left time: 206.3985s
Epoch: 3 cost time: 12.356115818023682
Epoch: 3, Steps: 570 | Train Loss: 0.2439966 Vali Loss: 0.0562116 Test Loss: 0.1815348
Validation loss decreased (0.057191 --> 0.056212).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2083697
	speed: 0.0596s/iter; left time: 571.8829s
	iters: 200, epoch: 4 | loss: 0.1465774
	speed: 0.0212s/iter; left time: 201.5817s
	iters: 300, epoch: 4 | loss: 0.1914612
	speed: 0.0212s/iter; left time: 199.1291s
	iters: 400, epoch: 4 | loss: 0.1639467
	speed: 0.0212s/iter; left time: 197.1299s
	iters: 500, epoch: 4 | loss: 0.3357882
	speed: 0.0212s/iter; left time: 194.9038s
Epoch: 4 cost time: 12.340622663497925
Epoch: 4, Steps: 570 | Train Loss: 0.2288094 Vali Loss: 0.0584537 Test Loss: 0.1792429
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2451518
	speed: 0.0587s/iter; left time: 529.5328s
	iters: 200, epoch: 5 | loss: 0.2260534
	speed: 0.0212s/iter; left time: 189.3494s
	iters: 300, epoch: 5 | loss: 0.1617769
	speed: 0.0212s/iter; left time: 187.1916s
	iters: 400, epoch: 5 | loss: 0.1843680
	speed: 0.0212s/iter; left time: 184.8885s
	iters: 500, epoch: 5 | loss: 0.1795840
	speed: 0.0212s/iter; left time: 182.9680s
Epoch: 5 cost time: 12.327710390090942
Epoch: 5, Steps: 570 | Train Loss: 0.2187170 Vali Loss: 0.0571665 Test Loss: 0.1789337
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1505759
	speed: 0.0591s/iter; left time: 499.8454s
	iters: 200, epoch: 6 | loss: 0.4135664
	speed: 0.0212s/iter; left time: 176.7693s
	iters: 300, epoch: 6 | loss: 0.1913500
	speed: 0.0212s/iter; left time: 174.6250s
	iters: 400, epoch: 6 | loss: 0.2070564
	speed: 0.0212s/iter; left time: 172.6037s
	iters: 500, epoch: 6 | loss: 0.4124746
	speed: 0.0212s/iter; left time: 170.3349s
Epoch: 6 cost time: 12.361971616744995
Epoch: 6, Steps: 570 | Train Loss: 0.2132697 Vali Loss: 0.0585244 Test Loss: 0.1791780
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.18178147077560425, mae:0.27363139390945435
>>> S LR=1e-3 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2834274
	speed: 0.0321s/iter; left time: 362.4435s
	iters: 200, epoch: 1 | loss: 0.1486271
	speed: 0.0205s/iter; left time: 229.0966s
	iters: 300, epoch: 1 | loss: 0.2631696
	speed: 0.0204s/iter; left time: 226.9885s
	iters: 400, epoch: 1 | loss: 0.2900358
	speed: 0.0220s/iter; left time: 241.8704s
	iters: 500, epoch: 1 | loss: 0.2004194
	speed: 0.0222s/iter; left time: 241.4808s
Epoch: 1 cost time: 13.310698986053467
Epoch: 1, Steps: 570 | Train Loss: 0.3237751 Vali Loss: 0.0620274 Test Loss: 0.1868695
Validation loss decreased (inf --> 0.062027).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2753342
	speed: 0.0608s/iter; left time: 652.4587s
	iters: 200, epoch: 2 | loss: 0.1853819
	speed: 0.0204s/iter; left time: 216.7136s
	iters: 300, epoch: 2 | loss: 0.2894070
	speed: 0.0204s/iter; left time: 214.3474s
	iters: 400, epoch: 2 | loss: 0.2929097
	speed: 0.0204s/iter; left time: 212.3049s
	iters: 500, epoch: 2 | loss: 0.2147005
	speed: 0.0204s/iter; left time: 210.3730s
Epoch: 2 cost time: 11.859901189804077
Epoch: 2, Steps: 570 | Train Loss: 0.2623580 Vali Loss: 0.0611410 Test Loss: 0.1926263
Validation loss decreased (0.062027 --> 0.061141).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2436798
	speed: 0.0606s/iter; left time: 616.0473s
	iters: 200, epoch: 3 | loss: 0.2197129
	speed: 0.0204s/iter; left time: 205.6180s
	iters: 300, epoch: 3 | loss: 0.1898612
	speed: 0.0204s/iter; left time: 203.2326s
	iters: 400, epoch: 3 | loss: 0.1999397
	speed: 0.0204s/iter; left time: 201.2671s
	iters: 500, epoch: 3 | loss: 0.1343211
	speed: 0.0204s/iter; left time: 198.9755s
Epoch: 3 cost time: 11.89374589920044
Epoch: 3, Steps: 570 | Train Loss: 0.2451177 Vali Loss: 0.0542257 Test Loss: 0.1782511
Validation loss decreased (0.061141 --> 0.054226).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1276681
	speed: 0.0582s/iter; left time: 557.7240s
	iters: 200, epoch: 4 | loss: 0.2847340
	speed: 0.0204s/iter; left time: 193.8395s
	iters: 300, epoch: 4 | loss: 0.2911039
	speed: 0.0205s/iter; left time: 192.0645s
	iters: 400, epoch: 4 | loss: 0.3136411
	speed: 0.0204s/iter; left time: 189.7901s
	iters: 500, epoch: 4 | loss: 0.1578941
	speed: 0.0204s/iter; left time: 187.6987s
Epoch: 4 cost time: 11.907224655151367
Epoch: 4, Steps: 570 | Train Loss: 0.2330121 Vali Loss: 0.0540228 Test Loss: 0.1738733
Validation loss decreased (0.054226 --> 0.054023).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1654606
	speed: 0.0581s/iter; left time: 524.3222s
	iters: 200, epoch: 5 | loss: 0.2221660
	speed: 0.0204s/iter; left time: 182.0002s
	iters: 300, epoch: 5 | loss: 0.2766585
	speed: 0.0204s/iter; left time: 179.6017s
	iters: 400, epoch: 5 | loss: 0.2941072
	speed: 0.0204s/iter; left time: 177.6813s
	iters: 500, epoch: 5 | loss: 0.1265970
	speed: 0.0204s/iter; left time: 175.6742s
Epoch: 5 cost time: 11.845332860946655
Epoch: 5, Steps: 570 | Train Loss: 0.2236597 Vali Loss: 0.0538986 Test Loss: 0.1702067
Validation loss decreased (0.054023 --> 0.053899).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2163961
	speed: 0.0580s/iter; left time: 490.3407s
	iters: 200, epoch: 6 | loss: 0.4230365
	speed: 0.0204s/iter; left time: 170.1198s
	iters: 300, epoch: 6 | loss: 0.2843031
	speed: 0.0204s/iter; left time: 168.0903s
	iters: 400, epoch: 6 | loss: 0.1535228
	speed: 0.0204s/iter; left time: 166.1062s
	iters: 500, epoch: 6 | loss: 0.1642638
	speed: 0.0204s/iter; left time: 164.3299s
Epoch: 6 cost time: 11.859774827957153
Epoch: 6, Steps: 570 | Train Loss: 0.2171328 Vali Loss: 0.0543770 Test Loss: 0.1715215
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2227159
	speed: 0.0573s/iter; left time: 451.8194s
	iters: 200, epoch: 7 | loss: 0.2711760
	speed: 0.0204s/iter; left time: 158.7933s
	iters: 300, epoch: 7 | loss: 0.2388474
	speed: 0.0204s/iter; left time: 156.7415s
	iters: 400, epoch: 7 | loss: 0.1152222
	speed: 0.0204s/iter; left time: 154.7620s
	iters: 500, epoch: 7 | loss: 0.1465963
	speed: 0.0204s/iter; left time: 152.8323s
Epoch: 7 cost time: 11.906493663787842
Epoch: 7, Steps: 570 | Train Loss: 0.2121907 Vali Loss: 0.0545333 Test Loss: 0.1720954
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1768530
	speed: 0.0574s/iter; left time: 419.6567s
	iters: 200, epoch: 8 | loss: 0.2414961
	speed: 0.0206s/iter; left time: 148.2613s
	iters: 300, epoch: 8 | loss: 0.1458824
	speed: 0.0205s/iter; left time: 146.1081s
	iters: 400, epoch: 8 | loss: 0.2839950
	speed: 0.0205s/iter; left time: 144.0681s
	iters: 500, epoch: 8 | loss: 0.2875114
	speed: 0.0205s/iter; left time: 141.8038s
Epoch: 8 cost time: 11.935665369033813
Epoch: 8, Steps: 570 | Train Loss: 0.2096533 Vali Loss: 0.0537429 Test Loss: 0.1701701
Validation loss decreased (0.053899 --> 0.053743).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2234051
	speed: 0.0582s/iter; left time: 392.1721s
	iters: 200, epoch: 9 | loss: 0.2084987
	speed: 0.0204s/iter; left time: 135.3154s
	iters: 300, epoch: 9 | loss: 0.2617692
	speed: 0.0204s/iter; left time: 133.4863s
	iters: 400, epoch: 9 | loss: 0.1606939
	speed: 0.0204s/iter; left time: 131.1512s
	iters: 500, epoch: 9 | loss: 0.1505585
	speed: 0.0204s/iter; left time: 129.3193s
Epoch: 9 cost time: 11.878509521484375
Epoch: 9, Steps: 570 | Train Loss: 0.2077255 Vali Loss: 0.0541032 Test Loss: 0.1696196
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1056063
	speed: 0.0568s/iter; left time: 350.5589s
	iters: 200, epoch: 10 | loss: 0.2488715
	speed: 0.0204s/iter; left time: 123.7708s
	iters: 300, epoch: 10 | loss: 0.1473960
	speed: 0.0204s/iter; left time: 121.5881s
	iters: 400, epoch: 10 | loss: 0.1611580
	speed: 0.0204s/iter; left time: 119.5162s
	iters: 500, epoch: 10 | loss: 0.2429670
	speed: 0.0204s/iter; left time: 117.7800s
Epoch: 10 cost time: 11.843855142593384
Epoch: 10, Steps: 570 | Train Loss: 0.2069560 Vali Loss: 0.0541270 Test Loss: 0.1696975
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1986403
	speed: 0.0585s/iter; left time: 327.9299s
	iters: 200, epoch: 11 | loss: 0.2713787
	speed: 0.0204s/iter; left time: 112.1267s
	iters: 300, epoch: 11 | loss: 0.1853479
	speed: 0.0204s/iter; left time: 110.1475s
	iters: 400, epoch: 11 | loss: 0.1481769
	speed: 0.0204s/iter; left time: 108.0387s
	iters: 500, epoch: 11 | loss: 0.2811814
	speed: 0.0204s/iter; left time: 106.0670s
Epoch: 11 cost time: 11.87303638458252
Epoch: 11, Steps: 570 | Train Loss: 0.2065469 Vali Loss: 0.0540717 Test Loss: 0.1698562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17045451700687408, mae:0.2704945504665375
>>> S LR=1e-3 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3066961
	speed: 0.0306s/iter; left time: 346.2015s
	iters: 200, epoch: 1 | loss: 0.2081624
	speed: 0.0189s/iter; left time: 211.4808s
	iters: 300, epoch: 1 | loss: 0.3180306
	speed: 0.0188s/iter; left time: 208.4722s
	iters: 400, epoch: 1 | loss: 0.4734767
	speed: 0.0188s/iter; left time: 206.4785s
	iters: 500, epoch: 1 | loss: 0.2853777
	speed: 0.0188s/iter; left time: 204.6698s
Epoch: 1 cost time: 11.94655704498291
Epoch: 1, Steps: 570 | Train Loss: 0.3046968 Vali Loss: 0.0656821 Test Loss: 0.2036460
Validation loss decreased (inf --> 0.065682).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1695652
	speed: 0.0556s/iter; left time: 596.2031s
	iters: 200, epoch: 2 | loss: 0.5300843
	speed: 0.0188s/iter; left time: 199.5747s
	iters: 300, epoch: 2 | loss: 0.2677068
	speed: 0.0188s/iter; left time: 197.7974s
	iters: 400, epoch: 2 | loss: 0.2050801
	speed: 0.0188s/iter; left time: 195.8536s
	iters: 500, epoch: 2 | loss: 0.2001158
	speed: 0.0188s/iter; left time: 194.5542s
Epoch: 2 cost time: 10.952986478805542
Epoch: 2, Steps: 570 | Train Loss: 0.2996948 Vali Loss: 0.0631246 Test Loss: 0.1956850
Validation loss decreased (0.065682 --> 0.063125).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2141378
	speed: 0.0584s/iter; left time: 593.8657s
	iters: 200, epoch: 3 | loss: 0.1431283
	speed: 0.0209s/iter; left time: 209.9857s
	iters: 300, epoch: 3 | loss: 0.2339164
	speed: 0.0208s/iter; left time: 207.1668s
	iters: 400, epoch: 3 | loss: 0.2431600
	speed: 0.0208s/iter; left time: 205.0510s
	iters: 500, epoch: 3 | loss: 0.2218947
	speed: 0.0208s/iter; left time: 203.1997s
Epoch: 3 cost time: 12.102433443069458
Epoch: 3, Steps: 570 | Train Loss: 0.2622643 Vali Loss: 0.0596968 Test Loss: 0.1864044
Validation loss decreased (0.063125 --> 0.059697).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1648257
	speed: 0.0600s/iter; left time: 575.8883s
	iters: 200, epoch: 4 | loss: 0.2904582
	speed: 0.0208s/iter; left time: 197.4269s
	iters: 300, epoch: 4 | loss: 0.1380531
	speed: 0.0208s/iter; left time: 195.3764s
	iters: 400, epoch: 4 | loss: 0.2742840
	speed: 0.0208s/iter; left time: 192.9634s
	iters: 500, epoch: 4 | loss: 0.2086525
	speed: 0.0208s/iter; left time: 190.9545s
Epoch: 4 cost time: 12.108237504959106
Epoch: 4, Steps: 570 | Train Loss: 0.2477664 Vali Loss: 0.0589746 Test Loss: 0.1893517
Validation loss decreased (0.059697 --> 0.058975).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1887919
	speed: 0.0603s/iter; left time: 543.6007s
	iters: 200, epoch: 5 | loss: 0.4705458
	speed: 0.0208s/iter; left time: 185.9023s
	iters: 300, epoch: 5 | loss: 0.2411557
	speed: 0.0209s/iter; left time: 183.9456s
	iters: 400, epoch: 5 | loss: 0.2358418
	speed: 0.0208s/iter; left time: 181.7960s
	iters: 500, epoch: 5 | loss: 0.2032230
	speed: 0.0208s/iter; left time: 179.6959s
Epoch: 5 cost time: 12.145954847335815
Epoch: 5, Steps: 570 | Train Loss: 0.2445450 Vali Loss: 0.0568923 Test Loss: 0.1867072
Validation loss decreased (0.058975 --> 0.056892).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2931902
	speed: 0.0573s/iter; left time: 484.3996s
	iters: 200, epoch: 6 | loss: 0.3051399
	speed: 0.0190s/iter; left time: 158.3259s
	iters: 300, epoch: 6 | loss: 0.2178776
	speed: 0.0190s/iter; left time: 156.4764s
	iters: 400, epoch: 6 | loss: 0.1244210
	speed: 0.0190s/iter; left time: 154.4857s
	iters: 500, epoch: 6 | loss: 0.3743046
	speed: 0.0190s/iter; left time: 152.7297s
Epoch: 6 cost time: 11.080660343170166
Epoch: 6, Steps: 570 | Train Loss: 0.2385945 Vali Loss: 0.0588517 Test Loss: 0.1882826
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1863084
	speed: 0.0575s/iter; left time: 453.3056s
	iters: 200, epoch: 7 | loss: 0.2555344
	speed: 0.0189s/iter; left time: 147.2764s
	iters: 300, epoch: 7 | loss: 0.3176159
	speed: 0.0189s/iter; left time: 145.3120s
	iters: 400, epoch: 7 | loss: 0.4372933
	speed: 0.0189s/iter; left time: 143.6368s
	iters: 500, epoch: 7 | loss: 0.1744926
	speed: 0.0189s/iter; left time: 141.5269s
Epoch: 7 cost time: 11.039464950561523
Epoch: 7, Steps: 570 | Train Loss: 0.2356521 Vali Loss: 0.0589089 Test Loss: 0.1873725
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3170379
	speed: 0.0571s/iter; left time: 417.3180s
	iters: 200, epoch: 8 | loss: 0.3600717
	speed: 0.0189s/iter; left time: 136.2054s
	iters: 300, epoch: 8 | loss: 0.3535769
	speed: 0.0189s/iter; left time: 134.1852s
	iters: 400, epoch: 8 | loss: 0.2026100
	speed: 0.0188s/iter; left time: 132.1270s
	iters: 500, epoch: 8 | loss: 0.1858336
	speed: 0.0189s/iter; left time: 130.7097s
Epoch: 8 cost time: 11.015708923339844
Epoch: 8, Steps: 570 | Train Loss: 0.2335530 Vali Loss: 0.0580549 Test Loss: 0.1858206
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.18688488006591797, mae:0.26962044835090637
>>> S LR=1e-3 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1789345
	speed: 0.0237s/iter; left time: 267.3249s
	iters: 200, epoch: 1 | loss: 0.1829412
	speed: 0.0118s/iter; left time: 131.8432s
	iters: 300, epoch: 1 | loss: 0.1721244
	speed: 0.0118s/iter; left time: 131.1248s
	iters: 400, epoch: 1 | loss: 0.1988341
	speed: 0.0118s/iter; left time: 129.4002s
	iters: 500, epoch: 1 | loss: 0.1529250
	speed: 0.0118s/iter; left time: 128.7687s
Epoch: 1 cost time: 7.949620485305786
Epoch: 1, Steps: 570 | Train Loss: 0.2255531 Vali Loss: 0.0515388 Test Loss: 0.1708577
Validation loss decreased (inf --> 0.051539).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3030121
	speed: 0.0367s/iter; left time: 393.4727s
	iters: 200, epoch: 2 | loss: 0.3056083
	speed: 0.0106s/iter; left time: 112.4769s
	iters: 300, epoch: 2 | loss: 0.1757076
	speed: 0.0105s/iter; left time: 110.6667s
	iters: 400, epoch: 2 | loss: 0.1433892
	speed: 0.0105s/iter; left time: 109.2555s
	iters: 500, epoch: 2 | loss: 0.1982222
	speed: 0.0105s/iter; left time: 108.7180s
Epoch: 2 cost time: 6.244857311248779
Epoch: 2, Steps: 570 | Train Loss: 0.2002752 Vali Loss: 0.0463109 Test Loss: 0.1466770
Validation loss decreased (0.051539 --> 0.046311).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1703929
	speed: 0.0364s/iter; left time: 369.5958s
	iters: 200, epoch: 3 | loss: 0.1771090
	speed: 0.0104s/iter; left time: 104.6839s
	iters: 300, epoch: 3 | loss: 0.1623911
	speed: 0.0104s/iter; left time: 103.9363s
	iters: 400, epoch: 3 | loss: 0.1782544
	speed: 0.0105s/iter; left time: 103.1422s
	iters: 500, epoch: 3 | loss: 0.2829328
	speed: 0.0105s/iter; left time: 102.5345s
Epoch: 3 cost time: 6.204098224639893
Epoch: 3, Steps: 570 | Train Loss: 0.1797173 Vali Loss: 0.0409002 Test Loss: 0.1291422
Validation loss decreased (0.046311 --> 0.040900).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1738501
	speed: 0.0368s/iter; left time: 353.4170s
	iters: 200, epoch: 4 | loss: 0.1045754
	speed: 0.0115s/iter; left time: 108.9331s
	iters: 300, epoch: 4 | loss: 0.2008552
	speed: 0.0106s/iter; left time: 99.0999s
	iters: 400, epoch: 4 | loss: 0.1735389
	speed: 0.0106s/iter; left time: 98.0332s
	iters: 500, epoch: 4 | loss: 0.1546873
	speed: 0.0109s/iter; left time: 100.4606s
Epoch: 4 cost time: 6.605585813522339
Epoch: 4, Steps: 570 | Train Loss: 0.1619632 Vali Loss: 0.0393098 Test Loss: 0.1316102
Validation loss decreased (0.040900 --> 0.039310).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1344817
	speed: 0.0366s/iter; left time: 329.7329s
	iters: 200, epoch: 5 | loss: 0.1358211
	speed: 0.0105s/iter; left time: 94.0107s
	iters: 300, epoch: 5 | loss: 0.1143544
	speed: 0.0105s/iter; left time: 92.8074s
	iters: 400, epoch: 5 | loss: 0.1539046
	speed: 0.0105s/iter; left time: 91.7116s
	iters: 500, epoch: 5 | loss: 0.1581740
	speed: 0.0105s/iter; left time: 90.6465s
Epoch: 5 cost time: 6.2582056522369385
Epoch: 5, Steps: 570 | Train Loss: 0.1512636 Vali Loss: 0.0398373 Test Loss: 0.1315530
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1246300
	speed: 0.0366s/iter; left time: 308.9760s
	iters: 200, epoch: 6 | loss: 0.1116811
	speed: 0.0118s/iter; left time: 98.1494s
	iters: 300, epoch: 6 | loss: 0.1526448
	speed: 0.0109s/iter; left time: 89.5721s
	iters: 400, epoch: 6 | loss: 0.1399919
	speed: 0.0105s/iter; left time: 85.8478s
	iters: 500, epoch: 6 | loss: 0.1512475
	speed: 0.0105s/iter; left time: 84.6606s
Epoch: 6 cost time: 6.531718730926514
Epoch: 6, Steps: 570 | Train Loss: 0.1426153 Vali Loss: 0.0409280 Test Loss: 0.1484245
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1364930
	speed: 0.0344s/iter; left time: 271.3669s
	iters: 200, epoch: 7 | loss: 0.1850935
	speed: 0.0105s/iter; left time: 81.4961s
	iters: 300, epoch: 7 | loss: 0.1245473
	speed: 0.0105s/iter; left time: 80.4103s
	iters: 400, epoch: 7 | loss: 0.1047685
	speed: 0.0105s/iter; left time: 79.3475s
	iters: 500, epoch: 7 | loss: 0.1248142
	speed: 0.0105s/iter; left time: 78.3099s
Epoch: 7 cost time: 6.205577611923218
Epoch: 7, Steps: 570 | Train Loss: 0.1384374 Vali Loss: 0.0408596 Test Loss: 0.1407226
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13171637058258057, mae:0.22598131000995636
>>> S LR=1e-3 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1801990
	speed: 0.0217s/iter; left time: 245.1779s
	iters: 200, epoch: 1 | loss: 0.1835770
	speed: 0.0101s/iter; left time: 113.1153s
	iters: 300, epoch: 1 | loss: 0.2133478
	speed: 0.0101s/iter; left time: 112.3431s
	iters: 400, epoch: 1 | loss: 0.1877528
	speed: 0.0101s/iter; left time: 111.1143s
	iters: 500, epoch: 1 | loss: 0.1568131
	speed: 0.0101s/iter; left time: 110.2443s
Epoch: 1 cost time: 6.967451333999634
Epoch: 1, Steps: 570 | Train Loss: 0.1912316 Vali Loss: 0.0364028 Test Loss: 0.1244669
Validation loss decreased (inf --> 0.036403).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1419393
	speed: 0.0368s/iter; left time: 394.6822s
	iters: 200, epoch: 2 | loss: 0.2105305
	speed: 0.0102s/iter; left time: 108.9510s
	iters: 300, epoch: 2 | loss: 0.1134911
	speed: 0.0102s/iter; left time: 107.4975s
	iters: 400, epoch: 2 | loss: 0.1535689
	speed: 0.0102s/iter; left time: 106.7647s
	iters: 500, epoch: 2 | loss: 0.1622989
	speed: 0.0102s/iter; left time: 105.4781s
Epoch: 2 cost time: 6.084351062774658
Epoch: 2, Steps: 570 | Train Loss: 0.1667211 Vali Loss: 0.0363971 Test Loss: 0.1242022
Validation loss decreased (0.036403 --> 0.036397).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0681376
	speed: 0.0357s/iter; left time: 363.1197s
	iters: 200, epoch: 3 | loss: 0.1641158
	speed: 0.0102s/iter; left time: 102.5457s
	iters: 300, epoch: 3 | loss: 0.2969074
	speed: 0.0102s/iter; left time: 101.4656s
	iters: 400, epoch: 3 | loss: 0.1485850
	speed: 0.0102s/iter; left time: 100.2167s
	iters: 500, epoch: 3 | loss: 0.0880816
	speed: 0.0102s/iter; left time: 99.2595s
Epoch: 3 cost time: 6.064072847366333
Epoch: 3, Steps: 570 | Train Loss: 0.1444167 Vali Loss: 0.0324626 Test Loss: 0.1147376
Validation loss decreased (0.036397 --> 0.032463).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1009814
	speed: 0.0348s/iter; left time: 333.9174s
	iters: 200, epoch: 4 | loss: 0.1009810
	speed: 0.0101s/iter; left time: 95.8168s
	iters: 300, epoch: 4 | loss: 0.0920737
	speed: 0.0101s/iter; left time: 94.9325s
	iters: 400, epoch: 4 | loss: 0.0878820
	speed: 0.0101s/iter; left time: 94.0473s
	iters: 500, epoch: 4 | loss: 0.1705200
	speed: 0.0101s/iter; left time: 93.0005s
Epoch: 4 cost time: 6.000587701797485
Epoch: 4, Steps: 570 | Train Loss: 0.1300119 Vali Loss: 0.0306371 Test Loss: 0.1065656
Validation loss decreased (0.032463 --> 0.030637).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1080031
	speed: 0.0337s/iter; left time: 304.3180s
	iters: 200, epoch: 5 | loss: 0.1449548
	speed: 0.0102s/iter; left time: 91.1317s
	iters: 300, epoch: 5 | loss: 0.1258237
	speed: 0.0102s/iter; left time: 89.9573s
	iters: 400, epoch: 5 | loss: 0.1284140
	speed: 0.0102s/iter; left time: 88.9533s
	iters: 500, epoch: 5 | loss: 0.1259471
	speed: 0.0102s/iter; left time: 87.8795s
Epoch: 5 cost time: 6.0602545738220215
Epoch: 5, Steps: 570 | Train Loss: 0.1212267 Vali Loss: 0.0318877 Test Loss: 0.1104948
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0876025
	speed: 0.0343s/iter; left time: 289.5302s
	iters: 200, epoch: 6 | loss: 0.1582052
	speed: 0.0102s/iter; left time: 85.1735s
	iters: 300, epoch: 6 | loss: 0.1379957
	speed: 0.0102s/iter; left time: 84.3736s
	iters: 400, epoch: 6 | loss: 0.0852914
	speed: 0.0102s/iter; left time: 83.3004s
	iters: 500, epoch: 6 | loss: 0.0753613
	speed: 0.0102s/iter; left time: 82.2721s
Epoch: 6 cost time: 6.061531066894531
Epoch: 6, Steps: 570 | Train Loss: 0.1145899 Vali Loss: 0.0313741 Test Loss: 0.1103459
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1009684
	speed: 0.0337s/iter; left time: 265.7543s
	iters: 200, epoch: 7 | loss: 0.1347052
	speed: 0.0101s/iter; left time: 78.7788s
	iters: 300, epoch: 7 | loss: 0.2158102
	speed: 0.0101s/iter; left time: 77.8694s
	iters: 400, epoch: 7 | loss: 0.1690391
	speed: 0.0101s/iter; left time: 76.6001s
	iters: 500, epoch: 7 | loss: 0.1176794
	speed: 0.0101s/iter; left time: 75.5394s
Epoch: 7 cost time: 5.995320558547974
Epoch: 7, Steps: 570 | Train Loss: 0.1120918 Vali Loss: 0.0311675 Test Loss: 0.1097811
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1066819503903389, mae:0.19755838811397552
>>> S LR=1e-3 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2391605
	speed: 0.0231s/iter; left time: 261.0997s
	iters: 200, epoch: 1 | loss: 0.1686294
	speed: 0.0116s/iter; left time: 130.4578s
	iters: 300, epoch: 1 | loss: 0.1652864
	speed: 0.0117s/iter; left time: 130.0925s
	iters: 400, epoch: 1 | loss: 0.1613399
	speed: 0.0117s/iter; left time: 128.9437s
	iters: 500, epoch: 1 | loss: 0.2119519
	speed: 0.0118s/iter; left time: 128.2525s
Epoch: 1 cost time: 7.863918304443359
Epoch: 1, Steps: 570 | Train Loss: 0.2339454 Vali Loss: 0.0467895 Test Loss: 0.1591850
Validation loss decreased (inf --> 0.046789).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2107881
	speed: 0.0372s/iter; left time: 399.5532s
	iters: 200, epoch: 2 | loss: 0.2665988
	speed: 0.0116s/iter; left time: 123.7960s
	iters: 300, epoch: 2 | loss: 0.2387175
	speed: 0.0102s/iter; left time: 106.9553s
	iters: 400, epoch: 2 | loss: 0.3042257
	speed: 0.0101s/iter; left time: 105.8053s
	iters: 500, epoch: 2 | loss: 0.2514877
	speed: 0.0102s/iter; left time: 105.1597s
Epoch: 2 cost time: 6.335774898529053
Epoch: 2, Steps: 570 | Train Loss: 0.2078746 Vali Loss: 0.0424160 Test Loss: 0.1482401
Validation loss decreased (0.046789 --> 0.042416).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1298210
	speed: 0.0360s/iter; left time: 365.8191s
	iters: 200, epoch: 3 | loss: 0.1540661
	speed: 0.0115s/iter; left time: 115.6496s
	iters: 300, epoch: 3 | loss: 0.2741481
	speed: 0.0107s/iter; left time: 106.2784s
	iters: 400, epoch: 3 | loss: 0.1674635
	speed: 0.0101s/iter; left time: 99.3936s
	iters: 500, epoch: 3 | loss: 0.0954691
	speed: 0.0101s/iter; left time: 98.5692s
Epoch: 3 cost time: 6.310961961746216
Epoch: 3, Steps: 570 | Train Loss: 0.1846491 Vali Loss: 0.0394177 Test Loss: 0.1365444
Validation loss decreased (0.042416 --> 0.039418).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1048613
	speed: 0.0358s/iter; left time: 343.1814s
	iters: 200, epoch: 4 | loss: 0.1075889
	speed: 0.0102s/iter; left time: 97.2480s
	iters: 300, epoch: 4 | loss: 0.1222391
	speed: 0.0102s/iter; left time: 95.4371s
	iters: 400, epoch: 4 | loss: 0.2022745
	speed: 0.0101s/iter; left time: 94.0460s
	iters: 500, epoch: 4 | loss: 0.1362634
	speed: 0.0101s/iter; left time: 93.0253s
Epoch: 4 cost time: 6.159825801849365
Epoch: 4, Steps: 570 | Train Loss: 0.1679191 Vali Loss: 0.0417237 Test Loss: 0.1364607
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1203456
	speed: 0.0335s/iter; left time: 302.2667s
	iters: 200, epoch: 5 | loss: 0.0912959
	speed: 0.0102s/iter; left time: 90.7787s
	iters: 300, epoch: 5 | loss: 0.1688327
	speed: 0.0102s/iter; left time: 90.0177s
	iters: 400, epoch: 5 | loss: 0.1401600
	speed: 0.0102s/iter; left time: 89.1569s
	iters: 500, epoch: 5 | loss: 0.2130631
	speed: 0.0102s/iter; left time: 87.8455s
Epoch: 5 cost time: 6.032003164291382
Epoch: 5, Steps: 570 | Train Loss: 0.1554466 Vali Loss: 0.0398672 Test Loss: 0.1321187
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1247466
	speed: 0.0333s/iter; left time: 281.0394s
	iters: 200, epoch: 6 | loss: 0.1611689
	speed: 0.0102s/iter; left time: 84.8877s
	iters: 300, epoch: 6 | loss: 0.1157655
	speed: 0.0102s/iter; left time: 84.0606s
	iters: 400, epoch: 6 | loss: 0.1084754
	speed: 0.0102s/iter; left time: 83.0552s
	iters: 500, epoch: 6 | loss: 0.1753021
	speed: 0.0102s/iter; left time: 81.8812s
Epoch: 6 cost time: 6.020847320556641
Epoch: 6, Steps: 570 | Train Loss: 0.1466434 Vali Loss: 0.0397338 Test Loss: 0.1305559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1366516798734665, mae:0.23421905934810638
>>> S LR=1e-3 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2979760
	speed: 0.0247s/iter; left time: 279.3152s
	iters: 200, epoch: 1 | loss: 0.2248257
	speed: 0.0128s/iter; left time: 143.4501s
	iters: 300, epoch: 1 | loss: 0.1723878
	speed: 0.0128s/iter; left time: 141.6292s
	iters: 400, epoch: 1 | loss: 0.1239038
	speed: 0.0128s/iter; left time: 140.6613s
	iters: 500, epoch: 1 | loss: 0.2277895
	speed: 0.0128s/iter; left time: 139.3862s
Epoch: 1 cost time: 8.468481540679932
Epoch: 1, Steps: 570 | Train Loss: 0.2623003 Vali Loss: 0.0619377 Test Loss: 0.1813058
Validation loss decreased (inf --> 0.061938).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2394724
	speed: 0.0395s/iter; left time: 423.9525s
	iters: 200, epoch: 2 | loss: 0.2712077
	speed: 0.0118s/iter; left time: 125.3134s
	iters: 300, epoch: 2 | loss: 0.1692064
	speed: 0.0118s/iter; left time: 123.9882s
	iters: 400, epoch: 2 | loss: 0.1549141
	speed: 0.0118s/iter; left time: 123.0138s
	iters: 500, epoch: 2 | loss: 0.3642367
	speed: 0.0118s/iter; left time: 121.6459s
Epoch: 2 cost time: 7.047236204147339
Epoch: 2, Steps: 570 | Train Loss: 0.3023386 Vali Loss: 0.0755920 Test Loss: 0.2199673
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4062632
	speed: 0.0386s/iter; left time: 392.3697s
	iters: 200, epoch: 3 | loss: 0.3867623
	speed: 0.0117s/iter; left time: 118.2132s
	iters: 300, epoch: 3 | loss: 0.1888821
	speed: 0.0118s/iter; left time: 117.2779s
	iters: 400, epoch: 3 | loss: 0.2261929
	speed: 0.0118s/iter; left time: 116.0454s
	iters: 500, epoch: 3 | loss: 0.1658137
	speed: 0.0118s/iter; left time: 114.8159s
Epoch: 3 cost time: 6.997298240661621
Epoch: 3, Steps: 570 | Train Loss: 0.2921077 Vali Loss: 0.0620211 Test Loss: 0.1738050
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1864879
	speed: 0.0378s/iter; left time: 362.9955s
	iters: 200, epoch: 4 | loss: 0.2400720
	speed: 0.0117s/iter; left time: 111.3490s
	iters: 300, epoch: 4 | loss: 0.1652821
	speed: 0.0117s/iter; left time: 110.1363s
	iters: 400, epoch: 4 | loss: 0.1748187
	speed: 0.0117s/iter; left time: 108.9682s
	iters: 500, epoch: 4 | loss: 0.2310355
	speed: 0.0117s/iter; left time: 107.8493s
Epoch: 4 cost time: 6.981796979904175
Epoch: 4, Steps: 570 | Train Loss: 0.2568792 Vali Loss: 0.0609583 Test Loss: 0.1774691
Validation loss decreased (0.061938 --> 0.060958).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2727185
	speed: 0.0408s/iter; left time: 367.7878s
	iters: 200, epoch: 5 | loss: 0.2152636
	speed: 0.0129s/iter; left time: 114.6632s
	iters: 300, epoch: 5 | loss: 0.3582432
	speed: 0.0129s/iter; left time: 113.7978s
	iters: 400, epoch: 5 | loss: 0.2281324
	speed: 0.0128s/iter; left time: 111.7560s
	iters: 500, epoch: 5 | loss: 0.2438295
	speed: 0.0128s/iter; left time: 110.6458s
Epoch: 5 cost time: 7.627390384674072
Epoch: 5, Steps: 570 | Train Loss: 0.2530898 Vali Loss: 0.0599711 Test Loss: 0.1734617
Validation loss decreased (0.060958 --> 0.059971).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2435000
	speed: 0.0419s/iter; left time: 354.2383s
	iters: 200, epoch: 6 | loss: 0.1414031
	speed: 0.0118s/iter; left time: 98.1653s
	iters: 300, epoch: 6 | loss: 0.2334123
	speed: 0.0118s/iter; left time: 97.1167s
	iters: 400, epoch: 6 | loss: 0.2825013
	speed: 0.0117s/iter; left time: 95.7465s
	iters: 500, epoch: 6 | loss: 0.1999349
	speed: 0.0118s/iter; left time: 94.6129s
Epoch: 6 cost time: 7.031743049621582
Epoch: 6, Steps: 570 | Train Loss: 0.2488718 Vali Loss: 0.0581481 Test Loss: 0.1717313
Validation loss decreased (0.059971 --> 0.058148).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3034988
	speed: 0.0387s/iter; left time: 305.0861s
	iters: 200, epoch: 7 | loss: 0.2295878
	speed: 0.0118s/iter; left time: 91.5033s
	iters: 300, epoch: 7 | loss: 0.2410078
	speed: 0.0117s/iter; left time: 90.2270s
	iters: 400, epoch: 7 | loss: 0.2037811
	speed: 0.0117s/iter; left time: 89.0675s
	iters: 500, epoch: 7 | loss: 0.2447358
	speed: 0.0117s/iter; left time: 87.8683s
Epoch: 7 cost time: 7.0207884311676025
Epoch: 7, Steps: 570 | Train Loss: 0.2423932 Vali Loss: 0.0566767 Test Loss: 0.1675162
Validation loss decreased (0.058148 --> 0.056677).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1257177
	speed: 0.0390s/iter; left time: 284.8676s
	iters: 200, epoch: 8 | loss: 0.2148945
	speed: 0.0118s/iter; left time: 84.7947s
	iters: 300, epoch: 8 | loss: 0.1932307
	speed: 0.0118s/iter; left time: 83.6462s
	iters: 400, epoch: 8 | loss: 0.2091947
	speed: 0.0118s/iter; left time: 82.4065s
	iters: 500, epoch: 8 | loss: 0.1680998
	speed: 0.0117s/iter; left time: 80.8827s
Epoch: 8 cost time: 7.000945329666138
Epoch: 8, Steps: 570 | Train Loss: 0.2392774 Vali Loss: 0.0559262 Test Loss: 0.1651468
Validation loss decreased (0.056677 --> 0.055926).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1742978
	speed: 0.0388s/iter; left time: 261.4693s
	iters: 200, epoch: 9 | loss: 0.2761431
	speed: 0.0117s/iter; left time: 77.9385s
	iters: 300, epoch: 9 | loss: 0.2305500
	speed: 0.0117s/iter; left time: 76.7573s
	iters: 400, epoch: 9 | loss: 0.1462311
	speed: 0.0117s/iter; left time: 75.5627s
	iters: 500, epoch: 9 | loss: 0.2321138
	speed: 0.0117s/iter; left time: 74.3365s
Epoch: 9 cost time: 6.997314691543579
Epoch: 9, Steps: 570 | Train Loss: 0.2401099 Vali Loss: 0.0554410 Test Loss: 0.1647593
Validation loss decreased (0.055926 --> 0.055441).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1666282
	speed: 0.0391s/iter; left time: 241.2302s
	iters: 200, epoch: 10 | loss: 0.2373590
	speed: 0.0118s/iter; left time: 71.3515s
	iters: 300, epoch: 10 | loss: 0.1779989
	speed: 0.0117s/iter; left time: 70.1420s
	iters: 400, epoch: 10 | loss: 0.2001892
	speed: 0.0117s/iter; left time: 68.9761s
	iters: 500, epoch: 10 | loss: 0.3393314
	speed: 0.0117s/iter; left time: 67.7882s
Epoch: 10 cost time: 7.017106056213379
Epoch: 10, Steps: 570 | Train Loss: 0.2386539 Vali Loss: 0.0553954 Test Loss: 0.1645778
Validation loss decreased (0.055441 --> 0.055395).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1705192
	speed: 0.0402s/iter; left time: 225.2966s
	iters: 200, epoch: 11 | loss: 0.4439237
	speed: 0.0128s/iter; left time: 70.4190s
	iters: 300, epoch: 11 | loss: 0.2155422
	speed: 0.0128s/iter; left time: 69.2832s
	iters: 400, epoch: 11 | loss: 0.2817476
	speed: 0.0128s/iter; left time: 67.9905s
	iters: 500, epoch: 11 | loss: 0.3755674
	speed: 0.0128s/iter; left time: 66.7752s
Epoch: 11 cost time: 7.62894082069397
Epoch: 11, Steps: 570 | Train Loss: 0.2377867 Vali Loss: 0.0555186 Test Loss: 0.1644031
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1755217
	speed: 0.0405s/iter; left time: 203.8220s
	iters: 200, epoch: 12 | loss: 0.1408762
	speed: 0.0121s/iter; left time: 59.5834s
	iters: 300, epoch: 12 | loss: 0.1900665
	speed: 0.0128s/iter; left time: 61.9846s
	iters: 400, epoch: 12 | loss: 0.1839978
	speed: 0.0128s/iter; left time: 60.5426s
	iters: 500, epoch: 12 | loss: 0.2061299
	speed: 0.0128s/iter; left time: 59.2658s
Epoch: 12 cost time: 7.406231880187988
Epoch: 12, Steps: 570 | Train Loss: 0.2380471 Vali Loss: 0.0556410 Test Loss: 0.1644503
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1146839
	speed: 0.0389s/iter; left time: 173.7440s
	iters: 200, epoch: 13 | loss: 0.2198500
	speed: 0.0118s/iter; left time: 51.2899s
	iters: 300, epoch: 13 | loss: 0.1608524
	speed: 0.0122s/iter; left time: 51.9635s
	iters: 400, epoch: 13 | loss: 0.3940409
	speed: 0.0119s/iter; left time: 49.4797s
	iters: 500, epoch: 13 | loss: 0.2359939
	speed: 0.0117s/iter; left time: 47.5230s
Epoch: 13 cost time: 7.068951368331909
Epoch: 13, Steps: 570 | Train Loss: 0.2370535 Vali Loss: 0.0553435 Test Loss: 0.1643856
Validation loss decreased (0.055395 --> 0.055344).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2248516
	speed: 0.0394s/iter; left time: 153.2363s
	iters: 200, epoch: 14 | loss: 0.1896049
	speed: 0.0118s/iter; left time: 44.5569s
	iters: 300, epoch: 14 | loss: 0.3838609
	speed: 0.0117s/iter; left time: 43.2291s
	iters: 400, epoch: 14 | loss: 0.2171346
	speed: 0.0117s/iter; left time: 42.0535s
	iters: 500, epoch: 14 | loss: 0.2761802
	speed: 0.0117s/iter; left time: 40.8938s
Epoch: 14 cost time: 7.002543210983276
Epoch: 14, Steps: 570 | Train Loss: 0.2374328 Vali Loss: 0.0555442 Test Loss: 0.1643793
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1607843
	speed: 0.0388s/iter; left time: 128.7187s
	iters: 200, epoch: 15 | loss: 0.2548109
	speed: 0.0117s/iter; left time: 37.8385s
	iters: 300, epoch: 15 | loss: 0.1880171
	speed: 0.0118s/iter; left time: 36.8015s
	iters: 400, epoch: 15 | loss: 0.2241378
	speed: 0.0118s/iter; left time: 35.6223s
	iters: 500, epoch: 15 | loss: 0.4169929
	speed: 0.0118s/iter; left time: 34.4601s
Epoch: 15 cost time: 7.048743963241577
Epoch: 15, Steps: 570 | Train Loss: 0.2368228 Vali Loss: 0.0552646 Test Loss: 0.1643569
Validation loss decreased (0.055344 --> 0.055265).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.2563311
	speed: 0.0401s/iter; left time: 110.2282s
	iters: 200, epoch: 16 | loss: 0.2529845
	speed: 0.0118s/iter; left time: 31.2022s
	iters: 300, epoch: 16 | loss: 0.2948661
	speed: 0.0118s/iter; left time: 30.0300s
	iters: 400, epoch: 16 | loss: 0.2166422
	speed: 0.0118s/iter; left time: 28.8583s
	iters: 500, epoch: 16 | loss: 0.2158064
	speed: 0.0118s/iter; left time: 27.7140s
Epoch: 16 cost time: 7.02118182182312
Epoch: 16, Steps: 570 | Train Loss: 0.2382213 Vali Loss: 0.0555220 Test Loss: 0.1643553
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.2224896
	speed: 0.0392s/iter; left time: 85.4536s
	iters: 200, epoch: 17 | loss: 0.1142971
	speed: 0.0122s/iter; left time: 25.4577s
	iters: 300, epoch: 17 | loss: 0.3260757
	speed: 0.0123s/iter; left time: 24.2941s
	iters: 400, epoch: 17 | loss: 0.1445869
	speed: 0.0123s/iter; left time: 23.1401s
	iters: 500, epoch: 17 | loss: 0.4399706
	speed: 0.0118s/iter; left time: 20.9380s
Epoch: 17 cost time: 7.236019611358643
Epoch: 17, Steps: 570 | Train Loss: 0.2386640 Vali Loss: 0.0554241 Test Loss: 0.1643528
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 18 | loss: 0.2328188
	speed: 0.0397s/iter; left time: 63.9958s
	iters: 200, epoch: 18 | loss: 0.1479022
	speed: 0.0128s/iter; left time: 19.3370s
	iters: 300, epoch: 18 | loss: 0.2863738
	speed: 0.0128s/iter; left time: 18.0837s
	iters: 400, epoch: 18 | loss: 0.1487982
	speed: 0.0128s/iter; left time: 16.7678s
	iters: 500, epoch: 18 | loss: 0.2656417
	speed: 0.0128s/iter; left time: 15.4659s
Epoch: 18 cost time: 7.561811923980713
Epoch: 18, Steps: 570 | Train Loss: 0.2377033 Vali Loss: 0.0554282 Test Loss: 0.1643500
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16448692977428436, mae:0.2569515109062195
>>> S LR=1e-3 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1387880
	speed: 0.0242s/iter; left time: 273.6578s
	iters: 200, epoch: 1 | loss: 0.3459653
	speed: 0.0116s/iter; left time: 129.5347s
	iters: 300, epoch: 1 | loss: 0.1541434
	speed: 0.0113s/iter; left time: 125.3731s
	iters: 400, epoch: 1 | loss: 0.3310351
	speed: 0.0113s/iter; left time: 124.1872s
	iters: 500, epoch: 1 | loss: 0.2724151
	speed: 0.0113s/iter; left time: 122.8629s
Epoch: 1 cost time: 7.793256759643555
Epoch: 1, Steps: 570 | Train Loss: 0.2529079 Vali Loss: 0.0666107 Test Loss: 0.1986103
Validation loss decreased (inf --> 0.066611).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2930695
	speed: 0.0373s/iter; left time: 400.8007s
	iters: 200, epoch: 2 | loss: 0.2265130
	speed: 0.0113s/iter; left time: 119.9314s
	iters: 300, epoch: 2 | loss: 0.2650344
	speed: 0.0113s/iter; left time: 118.8991s
	iters: 400, epoch: 2 | loss: 0.4525834
	speed: 0.0113s/iter; left time: 117.6771s
	iters: 500, epoch: 2 | loss: 0.5612268
	speed: 0.0113s/iter; left time: 116.8106s
Epoch: 2 cost time: 6.705088138580322
Epoch: 2, Steps: 570 | Train Loss: 0.3305776 Vali Loss: 0.0671145 Test Loss: 0.1920362
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3237951
	speed: 0.0372s/iter; left time: 377.5355s
	iters: 200, epoch: 3 | loss: 0.1599816
	speed: 0.0124s/iter; left time: 125.0594s
	iters: 300, epoch: 3 | loss: 0.2512301
	speed: 0.0124s/iter; left time: 123.6988s
	iters: 400, epoch: 3 | loss: 0.2932363
	speed: 0.0124s/iter; left time: 122.0408s
	iters: 500, epoch: 3 | loss: 0.2368133
	speed: 0.0124s/iter; left time: 121.2044s
Epoch: 3 cost time: 7.322336673736572
Epoch: 3, Steps: 570 | Train Loss: 0.2454041 Vali Loss: 0.0493142 Test Loss: 0.1618432
Validation loss decreased (0.066611 --> 0.049314).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2261187
	speed: 0.0373s/iter; left time: 358.1931s
	iters: 200, epoch: 4 | loss: 0.1311094
	speed: 0.0113s/iter; left time: 107.4763s
	iters: 300, epoch: 4 | loss: 0.1273887
	speed: 0.0113s/iter; left time: 106.1215s
	iters: 400, epoch: 4 | loss: 0.1799105
	speed: 0.0113s/iter; left time: 105.0608s
	iters: 500, epoch: 4 | loss: 0.1557978
	speed: 0.0113s/iter; left time: 103.9949s
Epoch: 4 cost time: 6.701376438140869
Epoch: 4, Steps: 570 | Train Loss: 0.2171511 Vali Loss: 0.0489667 Test Loss: 0.1544499
Validation loss decreased (0.049314 --> 0.048967).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2256483
	speed: 0.0373s/iter; left time: 336.8042s
	iters: 200, epoch: 5 | loss: 0.1455051
	speed: 0.0115s/iter; left time: 102.8890s
	iters: 300, epoch: 5 | loss: 0.3075737
	speed: 0.0118s/iter; left time: 103.8824s
	iters: 400, epoch: 5 | loss: 0.1942126
	speed: 0.0124s/iter; left time: 108.1621s
	iters: 500, epoch: 5 | loss: 0.1576850
	speed: 0.0124s/iter; left time: 106.7635s
Epoch: 5 cost time: 7.156884431838989
Epoch: 5, Steps: 570 | Train Loss: 0.2049837 Vali Loss: 0.0483978 Test Loss: 0.1512052
Validation loss decreased (0.048967 --> 0.048398).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2733868
	speed: 0.0379s/iter; left time: 320.1344s
	iters: 200, epoch: 6 | loss: 0.2971811
	speed: 0.0116s/iter; left time: 97.1253s
	iters: 300, epoch: 6 | loss: 0.1378199
	speed: 0.0113s/iter; left time: 93.4458s
	iters: 400, epoch: 6 | loss: 0.1136286
	speed: 0.0113s/iter; left time: 92.1499s
	iters: 500, epoch: 6 | loss: 0.1536348
	speed: 0.0113s/iter; left time: 91.0845s
Epoch: 6 cost time: 6.8394105434417725
Epoch: 6, Steps: 570 | Train Loss: 0.1985339 Vali Loss: 0.0461673 Test Loss: 0.1466110
Validation loss decreased (0.048398 --> 0.046167).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1291957
	speed: 0.0383s/iter; left time: 301.5065s
	iters: 200, epoch: 7 | loss: 0.2457616
	speed: 0.0113s/iter; left time: 87.9031s
	iters: 300, epoch: 7 | loss: 0.1991896
	speed: 0.0113s/iter; left time: 86.6556s
	iters: 400, epoch: 7 | loss: 0.1452094
	speed: 0.0113s/iter; left time: 85.3082s
	iters: 500, epoch: 7 | loss: 0.1767988
	speed: 0.0113s/iter; left time: 84.2510s
Epoch: 7 cost time: 6.687136650085449
Epoch: 7, Steps: 570 | Train Loss: 0.1942499 Vali Loss: 0.0455762 Test Loss: 0.1444843
Validation loss decreased (0.046167 --> 0.045576).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1239009
	speed: 0.0363s/iter; left time: 265.5491s
	iters: 200, epoch: 8 | loss: 0.1825348
	speed: 0.0113s/iter; left time: 81.3231s
	iters: 300, epoch: 8 | loss: 0.1459073
	speed: 0.0113s/iter; left time: 80.1024s
	iters: 400, epoch: 8 | loss: 0.1552650
	speed: 0.0113s/iter; left time: 79.0197s
	iters: 500, epoch: 8 | loss: 0.1335859
	speed: 0.0113s/iter; left time: 77.9229s
Epoch: 8 cost time: 6.675810813903809
Epoch: 8, Steps: 570 | Train Loss: 0.1927222 Vali Loss: 0.0457886 Test Loss: 0.1443936
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2361130
	speed: 0.0377s/iter; left time: 254.0995s
	iters: 200, epoch: 9 | loss: 0.1268361
	speed: 0.0124s/iter; left time: 82.0602s
	iters: 300, epoch: 9 | loss: 0.2475938
	speed: 0.0124s/iter; left time: 80.8478s
	iters: 400, epoch: 9 | loss: 0.1809192
	speed: 0.0124s/iter; left time: 79.5824s
	iters: 500, epoch: 9 | loss: 0.2466536
	speed: 0.0124s/iter; left time: 78.3889s
Epoch: 9 cost time: 7.274812698364258
Epoch: 9, Steps: 570 | Train Loss: 0.1904971 Vali Loss: 0.0451716 Test Loss: 0.1436065
Validation loss decreased (0.045576 --> 0.045172).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1861265
	speed: 0.0393s/iter; left time: 242.2659s
	iters: 200, epoch: 10 | loss: 0.1555588
	speed: 0.0125s/iter; left time: 76.1390s
	iters: 300, epoch: 10 | loss: 0.1744258
	speed: 0.0125s/iter; left time: 74.7856s
	iters: 400, epoch: 10 | loss: 0.2107476
	speed: 0.0125s/iter; left time: 73.6117s
	iters: 500, epoch: 10 | loss: 0.2218728
	speed: 0.0125s/iter; left time: 72.3036s
Epoch: 10 cost time: 7.385207414627075
Epoch: 10, Steps: 570 | Train Loss: 0.1911428 Vali Loss: 0.0452524 Test Loss: 0.1433212
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1221181
	speed: 0.0386s/iter; left time: 216.1126s
	iters: 200, epoch: 11 | loss: 0.1250596
	speed: 0.0125s/iter; left time: 69.0250s
	iters: 300, epoch: 11 | loss: 0.1973179
	speed: 0.0126s/iter; left time: 67.9029s
	iters: 400, epoch: 11 | loss: 0.2099950
	speed: 0.0126s/iter; left time: 66.6969s
	iters: 500, epoch: 11 | loss: 0.1918150
	speed: 0.0126s/iter; left time: 65.3121s
Epoch: 11 cost time: 7.3941261768341064
Epoch: 11, Steps: 570 | Train Loss: 0.1901676 Vali Loss: 0.0452899 Test Loss: 0.1431478
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1930180
	speed: 0.0380s/iter; left time: 191.0470s
	iters: 200, epoch: 12 | loss: 0.1281896
	speed: 0.0117s/iter; left time: 57.7933s
	iters: 300, epoch: 12 | loss: 0.1326708
	speed: 0.0113s/iter; left time: 54.5614s
	iters: 400, epoch: 12 | loss: 0.2863416
	speed: 0.0113s/iter; left time: 53.5268s
	iters: 500, epoch: 12 | loss: 0.2096449
	speed: 0.0113s/iter; left time: 52.3392s
Epoch: 12 cost time: 6.847423791885376
Epoch: 12, Steps: 570 | Train Loss: 0.1893072 Vali Loss: 0.0455790 Test Loss: 0.1430546
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14377155900001526, mae:0.2429380714893341
>>> S LR=1e-3 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2422851
	speed: 0.0225s/iter; left time: 254.0058s
	iters: 200, epoch: 1 | loss: 0.2968122
	speed: 0.0109s/iter; left time: 121.8332s
	iters: 300, epoch: 1 | loss: 0.3140334
	speed: 0.0109s/iter; left time: 120.8281s
	iters: 400, epoch: 1 | loss: 0.2576246
	speed: 0.0108s/iter; left time: 118.8016s
	iters: 500, epoch: 1 | loss: 0.4046296
	speed: 0.0108s/iter; left time: 117.6133s
Epoch: 1 cost time: 7.386091232299805
Epoch: 1, Steps: 570 | Train Loss: 0.2840184 Vali Loss: 0.0862899 Test Loss: 0.2455926
Validation loss decreased (inf --> 0.086290).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3227472
	speed: 0.0365s/iter; left time: 391.2247s
	iters: 200, epoch: 2 | loss: 0.4018033
	speed: 0.0110s/iter; left time: 117.4497s
	iters: 300, epoch: 2 | loss: 0.2631148
	speed: 0.0108s/iter; left time: 114.2419s
	iters: 400, epoch: 2 | loss: 0.2079811
	speed: 0.0108s/iter; left time: 112.7009s
	iters: 500, epoch: 2 | loss: 0.2756263
	speed: 0.0108s/iter; left time: 111.9302s
Epoch: 2 cost time: 6.556061744689941
Epoch: 2, Steps: 570 | Train Loss: 0.3421658 Vali Loss: 0.0687507 Test Loss: 0.2057911
Validation loss decreased (0.086290 --> 0.068751).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2241715
	speed: 0.0367s/iter; left time: 372.9599s
	iters: 200, epoch: 3 | loss: 0.2058650
	speed: 0.0109s/iter; left time: 109.3216s
	iters: 300, epoch: 3 | loss: 0.4019876
	speed: 0.0109s/iter; left time: 108.2773s
	iters: 400, epoch: 3 | loss: 0.3025645
	speed: 0.0109s/iter; left time: 107.1173s
	iters: 500, epoch: 3 | loss: 0.2577345
	speed: 0.0108s/iter; left time: 105.8966s
Epoch: 3 cost time: 6.433192253112793
Epoch: 3, Steps: 570 | Train Loss: 0.2919640 Vali Loss: 0.0633804 Test Loss: 0.1961958
Validation loss decreased (0.068751 --> 0.063380).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3024902
	speed: 0.0357s/iter; left time: 342.0060s
	iters: 200, epoch: 4 | loss: 0.1271940
	speed: 0.0108s/iter; left time: 102.2071s
	iters: 300, epoch: 4 | loss: 0.2096163
	speed: 0.0108s/iter; left time: 100.9811s
	iters: 400, epoch: 4 | loss: 0.4717258
	speed: 0.0108s/iter; left time: 100.1494s
	iters: 500, epoch: 4 | loss: 0.2702963
	speed: 0.0108s/iter; left time: 99.2794s
Epoch: 4 cost time: 6.391250848770142
Epoch: 4, Steps: 570 | Train Loss: 0.2734018 Vali Loss: 0.0632638 Test Loss: 0.1965014
Validation loss decreased (0.063380 --> 0.063264).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1938823
	speed: 0.0384s/iter; left time: 346.2710s
	iters: 200, epoch: 5 | loss: 0.2754893
	speed: 0.0120s/iter; left time: 106.8798s
	iters: 300, epoch: 5 | loss: 0.2516489
	speed: 0.0120s/iter; left time: 105.9749s
	iters: 400, epoch: 5 | loss: 0.2306947
	speed: 0.0117s/iter; left time: 102.1355s
	iters: 500, epoch: 5 | loss: 0.4153525
	speed: 0.0108s/iter; left time: 93.3655s
Epoch: 5 cost time: 6.952610492706299
Epoch: 5, Steps: 570 | Train Loss: 0.2745698 Vali Loss: 0.0708740 Test Loss: 0.2071487
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1962245
	speed: 0.0377s/iter; left time: 318.9684s
	iters: 200, epoch: 6 | loss: 0.2555909
	speed: 0.0109s/iter; left time: 91.2737s
	iters: 300, epoch: 6 | loss: 0.2644410
	speed: 0.0109s/iter; left time: 89.9464s
	iters: 400, epoch: 6 | loss: 0.1925472
	speed: 0.0109s/iter; left time: 88.7430s
	iters: 500, epoch: 6 | loss: 0.3381661
	speed: 0.0109s/iter; left time: 87.7241s
Epoch: 6 cost time: 6.470342636108398
Epoch: 6, Steps: 570 | Train Loss: 0.2838772 Vali Loss: 0.0637251 Test Loss: 0.1905438
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2390455
	speed: 0.0361s/iter; left time: 284.3501s
	iters: 200, epoch: 7 | loss: 0.1894155
	speed: 0.0109s/iter; left time: 84.4674s
	iters: 300, epoch: 7 | loss: 0.1920463
	speed: 0.0108s/iter; left time: 83.0600s
	iters: 400, epoch: 7 | loss: 0.2980852
	speed: 0.0108s/iter; left time: 82.1565s
	iters: 500, epoch: 7 | loss: 0.1990348
	speed: 0.0108s/iter; left time: 81.1629s
Epoch: 7 cost time: 6.432040452957153
Epoch: 7, Steps: 570 | Train Loss: 0.2727930 Vali Loss: 0.0614159 Test Loss: 0.1868814
Validation loss decreased (0.063264 --> 0.061416).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2490672
	speed: 0.0355s/iter; left time: 259.5177s
	iters: 200, epoch: 8 | loss: 0.3135999
	speed: 0.0108s/iter; left time: 77.8595s
	iters: 300, epoch: 8 | loss: 0.3493742
	speed: 0.0108s/iter; left time: 76.9320s
	iters: 400, epoch: 8 | loss: 0.2283147
	speed: 0.0108s/iter; left time: 75.9784s
	iters: 500, epoch: 8 | loss: 0.1992843
	speed: 0.0108s/iter; left time: 74.5500s
Epoch: 8 cost time: 6.391974449157715
Epoch: 8, Steps: 570 | Train Loss: 0.2673862 Vali Loss: 0.0617314 Test Loss: 0.1873668
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3409054
	speed: 0.0352s/iter; left time: 237.1187s
	iters: 200, epoch: 9 | loss: 0.2158351
	speed: 0.0108s/iter; left time: 71.7706s
	iters: 300, epoch: 9 | loss: 0.3550263
	speed: 0.0108s/iter; left time: 70.7625s
	iters: 400, epoch: 9 | loss: 0.3842919
	speed: 0.0108s/iter; left time: 69.5834s
	iters: 500, epoch: 9 | loss: 0.1484134
	speed: 0.0108s/iter; left time: 68.3479s
Epoch: 9 cost time: 6.390344142913818
Epoch: 9, Steps: 570 | Train Loss: 0.2669457 Vali Loss: 0.0611133 Test Loss: 0.1861958
Validation loss decreased (0.061416 --> 0.061113).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2583443
	speed: 0.0364s/iter; left time: 224.8342s
	iters: 200, epoch: 10 | loss: 0.1605917
	speed: 0.0109s/iter; left time: 66.1210s
	iters: 300, epoch: 10 | loss: 0.3194250
	speed: 0.0109s/iter; left time: 64.9144s
	iters: 400, epoch: 10 | loss: 0.1867250
	speed: 0.0109s/iter; left time: 63.7327s
	iters: 500, epoch: 10 | loss: 0.2915122
	speed: 0.0109s/iter; left time: 62.6587s
Epoch: 10 cost time: 6.445600986480713
Epoch: 10, Steps: 570 | Train Loss: 0.2664564 Vali Loss: 0.0609891 Test Loss: 0.1856712
Validation loss decreased (0.061113 --> 0.060989).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2204175
	speed: 0.0364s/iter; left time: 203.9723s
	iters: 200, epoch: 11 | loss: 0.2770616
	speed: 0.0108s/iter; left time: 59.3381s
	iters: 300, epoch: 11 | loss: 0.1720527
	speed: 0.0108s/iter; left time: 58.4564s
	iters: 400, epoch: 11 | loss: 0.2101289
	speed: 0.0108s/iter; left time: 57.4526s
	iters: 500, epoch: 11 | loss: 0.1680323
	speed: 0.0108s/iter; left time: 56.3540s
Epoch: 11 cost time: 6.5103394985198975
Epoch: 11, Steps: 570 | Train Loss: 0.2669653 Vali Loss: 0.0610260 Test Loss: 0.1856040
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2492002
	speed: 0.0350s/iter; left time: 176.1119s
	iters: 200, epoch: 12 | loss: 0.2970790
	speed: 0.0109s/iter; left time: 53.6160s
	iters: 300, epoch: 12 | loss: 0.3697780
	speed: 0.0109s/iter; left time: 52.4962s
	iters: 400, epoch: 12 | loss: 0.3239014
	speed: 0.0109s/iter; left time: 51.3913s
	iters: 500, epoch: 12 | loss: 0.2401433
	speed: 0.0109s/iter; left time: 50.3721s
Epoch: 12 cost time: 6.436351299285889
Epoch: 12, Steps: 570 | Train Loss: 0.2656373 Vali Loss: 0.0611283 Test Loss: 0.1855446
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2379879
	speed: 0.0363s/iter; left time: 161.7294s
	iters: 200, epoch: 13 | loss: 0.3551981
	speed: 0.0109s/iter; left time: 47.3264s
	iters: 300, epoch: 13 | loss: 0.1663735
	speed: 0.0108s/iter; left time: 46.0916s
	iters: 400, epoch: 13 | loss: 0.1951584
	speed: 0.0108s/iter; left time: 44.8233s
	iters: 500, epoch: 13 | loss: 0.2492775
	speed: 0.0108s/iter; left time: 43.8736s
Epoch: 13 cost time: 6.506491422653198
Epoch: 13, Steps: 570 | Train Loss: 0.2662374 Vali Loss: 0.0611100 Test Loss: 0.1855644
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1858711540699005, mae:0.27295517921447754
>>> S LR=1e-3 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2600437
	speed: 0.0260s/iter; left time: 293.5552s
	iters: 200, epoch: 1 | loss: 0.1889168
	speed: 0.0145s/iter; left time: 162.3073s
	iters: 300, epoch: 1 | loss: 0.3460051
	speed: 0.0144s/iter; left time: 160.0198s
	iters: 400, epoch: 1 | loss: 0.2227122
	speed: 0.0144s/iter; left time: 158.6788s
	iters: 500, epoch: 1 | loss: 0.1502047
	speed: 0.0144s/iter; left time: 157.4744s
Epoch: 1 cost time: 9.43699049949646
Epoch: 1, Steps: 570 | Train Loss: 0.2348203 Vali Loss: 0.0476519 Test Loss: 0.1494748
Validation loss decreased (inf --> 0.047652).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3503634
	speed: 0.0445s/iter; left time: 477.9815s
	iters: 200, epoch: 2 | loss: 0.2080290
	speed: 0.0144s/iter; left time: 152.6067s
	iters: 300, epoch: 2 | loss: 0.1471113
	speed: 0.0143s/iter; left time: 151.0897s
	iters: 400, epoch: 2 | loss: 0.0942095
	speed: 0.0144s/iter; left time: 149.8968s
	iters: 500, epoch: 2 | loss: 0.2551358
	speed: 0.0144s/iter; left time: 148.3446s
Epoch: 2 cost time: 8.458012342453003
Epoch: 2, Steps: 570 | Train Loss: 0.2238421 Vali Loss: 0.0581664 Test Loss: 0.1826173
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4404429
	speed: 0.0442s/iter; left time: 449.3981s
	iters: 200, epoch: 3 | loss: 0.2331895
	speed: 0.0144s/iter; left time: 145.2098s
	iters: 300, epoch: 3 | loss: 0.1393425
	speed: 0.0144s/iter; left time: 143.4570s
	iters: 400, epoch: 3 | loss: 0.1550633
	speed: 0.0144s/iter; left time: 142.0890s
	iters: 500, epoch: 3 | loss: 0.1700065
	speed: 0.0144s/iter; left time: 140.5023s
Epoch: 3 cost time: 8.430486917495728
Epoch: 3, Steps: 570 | Train Loss: 0.2170412 Vali Loss: 0.0448434 Test Loss: 0.1430831
Validation loss decreased (0.047652 --> 0.044843).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1479868
	speed: 0.0474s/iter; left time: 454.6194s
	iters: 200, epoch: 4 | loss: 0.1436393
	speed: 0.0162s/iter; left time: 153.8484s
	iters: 300, epoch: 4 | loss: 0.1839700
	speed: 0.0151s/iter; left time: 142.2714s
	iters: 400, epoch: 4 | loss: 0.1754084
	speed: 0.0144s/iter; left time: 133.6505s
	iters: 500, epoch: 4 | loss: 0.1897244
	speed: 0.0144s/iter; left time: 132.3242s
Epoch: 4 cost time: 8.873189210891724
Epoch: 4, Steps: 570 | Train Loss: 0.1872884 Vali Loss: 0.0417166 Test Loss: 0.1358365
Validation loss decreased (0.044843 --> 0.041717).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1471884
	speed: 0.0472s/iter; left time: 425.9763s
	iters: 200, epoch: 5 | loss: 0.1999150
	speed: 0.0163s/iter; left time: 145.1392s
	iters: 300, epoch: 5 | loss: 0.1415605
	speed: 0.0163s/iter; left time: 143.8085s
	iters: 400, epoch: 5 | loss: 0.1928452
	speed: 0.0147s/iter; left time: 128.4614s
	iters: 500, epoch: 5 | loss: 0.2266180
	speed: 0.0145s/iter; left time: 125.0208s
Epoch: 5 cost time: 9.074339866638184
Epoch: 5, Steps: 570 | Train Loss: 0.1729772 Vali Loss: 0.0402095 Test Loss: 0.1281741
Validation loss decreased (0.041717 --> 0.040209).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1318283
	speed: 0.0460s/iter; left time: 388.5660s
	iters: 200, epoch: 6 | loss: 0.1678757
	speed: 0.0145s/iter; left time: 121.1545s
	iters: 300, epoch: 6 | loss: 0.1167571
	speed: 0.0145s/iter; left time: 119.6585s
	iters: 400, epoch: 6 | loss: 0.1220825
	speed: 0.0145s/iter; left time: 117.9453s
	iters: 500, epoch: 6 | loss: 0.1540490
	speed: 0.0145s/iter; left time: 116.8173s
Epoch: 6 cost time: 8.513547658920288
Epoch: 6, Steps: 570 | Train Loss: 0.1665999 Vali Loss: 0.0417605 Test Loss: 0.1310985
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1344559
	speed: 0.0442s/iter; left time: 348.2841s
	iters: 200, epoch: 7 | loss: 0.1467724
	speed: 0.0145s/iter; left time: 112.8477s
	iters: 300, epoch: 7 | loss: 0.1503184
	speed: 0.0145s/iter; left time: 111.5927s
	iters: 400, epoch: 7 | loss: 0.1400649
	speed: 0.0145s/iter; left time: 110.0215s
	iters: 500, epoch: 7 | loss: 0.1954549
	speed: 0.0145s/iter; left time: 108.5122s
Epoch: 7 cost time: 8.514508962631226
Epoch: 7, Steps: 570 | Train Loss: 0.1632326 Vali Loss: 0.0408647 Test Loss: 0.1317420
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2118539
	speed: 0.0461s/iter; left time: 336.9544s
	iters: 200, epoch: 8 | loss: 0.1555269
	speed: 0.0163s/iter; left time: 117.3197s
	iters: 300, epoch: 8 | loss: 0.1952627
	speed: 0.0162s/iter; left time: 115.4759s
	iters: 400, epoch: 8 | loss: 0.1296690
	speed: 0.0163s/iter; left time: 114.0737s
	iters: 500, epoch: 8 | loss: 0.1698039
	speed: 0.0160s/iter; left time: 110.2601s
Epoch: 8 cost time: 9.35248851776123
Epoch: 8, Steps: 570 | Train Loss: 0.1605005 Vali Loss: 0.0410186 Test Loss: 0.1319645
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12828761339187622, mae:0.22446809709072113
>>> S LR=1e-3 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3068050
	speed: 0.0256s/iter; left time: 289.6531s
	iters: 200, epoch: 1 | loss: 0.1951237
	speed: 0.0143s/iter; left time: 159.7924s
	iters: 300, epoch: 1 | loss: 0.1472199
	speed: 0.0143s/iter; left time: 158.2342s
	iters: 400, epoch: 1 | loss: 0.2725501
	speed: 0.0143s/iter; left time: 157.1782s
	iters: 500, epoch: 1 | loss: 0.1723448
	speed: 0.0143s/iter; left time: 155.6455s
Epoch: 1 cost time: 9.313718557357788
Epoch: 1, Steps: 570 | Train Loss: 0.2019775 Vali Loss: 0.0446887 Test Loss: 0.1436434
Validation loss decreased (inf --> 0.044689).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1572847
	speed: 0.0464s/iter; left time: 498.4093s
	iters: 200, epoch: 2 | loss: 0.2435740
	speed: 0.0143s/iter; left time: 152.1072s
	iters: 300, epoch: 2 | loss: 0.1807290
	speed: 0.0143s/iter; left time: 150.7549s
	iters: 400, epoch: 2 | loss: 0.1811246
	speed: 0.0143s/iter; left time: 149.3298s
	iters: 500, epoch: 2 | loss: 0.2014322
	speed: 0.0143s/iter; left time: 147.7821s
Epoch: 2 cost time: 8.419363021850586
Epoch: 2, Steps: 570 | Train Loss: 0.1865788 Vali Loss: 0.0447646 Test Loss: 0.1406312
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1644064
	speed: 0.0442s/iter; left time: 449.5612s
	iters: 200, epoch: 3 | loss: 0.0854855
	speed: 0.0142s/iter; left time: 143.0509s
	iters: 300, epoch: 3 | loss: 0.2101447
	speed: 0.0142s/iter; left time: 141.3436s
	iters: 400, epoch: 3 | loss: 0.0981364
	speed: 0.0142s/iter; left time: 140.1013s
	iters: 500, epoch: 3 | loss: 0.1396362
	speed: 0.0142s/iter; left time: 138.5579s
Epoch: 3 cost time: 8.357454061508179
Epoch: 3, Steps: 570 | Train Loss: 0.1597719 Vali Loss: 0.0344749 Test Loss: 0.1243633
Validation loss decreased (0.044689 --> 0.034475).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1460186
	speed: 0.0440s/iter; left time: 421.9990s
	iters: 200, epoch: 4 | loss: 0.1230906
	speed: 0.0141s/iter; left time: 133.8040s
	iters: 300, epoch: 4 | loss: 0.1718392
	speed: 0.0141s/iter; left time: 132.5301s
	iters: 400, epoch: 4 | loss: 0.0871759
	speed: 0.0141s/iter; left time: 131.0486s
	iters: 500, epoch: 4 | loss: 0.1016097
	speed: 0.0141s/iter; left time: 129.5892s
Epoch: 4 cost time: 8.283600807189941
Epoch: 4, Steps: 570 | Train Loss: 0.1447360 Vali Loss: 0.0331388 Test Loss: 0.1198253
Validation loss decreased (0.034475 --> 0.033139).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0876054
	speed: 0.0438s/iter; left time: 394.9826s
	iters: 200, epoch: 5 | loss: 0.1562342
	speed: 0.0141s/iter; left time: 125.4243s
	iters: 300, epoch: 5 | loss: 0.1479956
	speed: 0.0141s/iter; left time: 124.0086s
	iters: 400, epoch: 5 | loss: 0.1226716
	speed: 0.0147s/iter; left time: 127.8438s
	iters: 500, epoch: 5 | loss: 0.1426303
	speed: 0.0162s/iter; left time: 139.6901s
Epoch: 5 cost time: 8.678559064865112
Epoch: 5, Steps: 570 | Train Loss: 0.1373535 Vali Loss: 0.0322550 Test Loss: 0.1171531
Validation loss decreased (0.033139 --> 0.032255).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1056307
	speed: 0.0473s/iter; left time: 400.0803s
	iters: 200, epoch: 6 | loss: 0.2323403
	speed: 0.0165s/iter; left time: 137.3802s
	iters: 300, epoch: 6 | loss: 0.1871098
	speed: 0.0164s/iter; left time: 135.6137s
	iters: 400, epoch: 6 | loss: 0.1475418
	speed: 0.0164s/iter; left time: 133.8672s
	iters: 500, epoch: 6 | loss: 0.1740830
	speed: 0.0164s/iter; left time: 132.1928s
Epoch: 6 cost time: 9.61376428604126
Epoch: 6, Steps: 570 | Train Loss: 0.1320044 Vali Loss: 0.0322384 Test Loss: 0.1211402
Validation loss decreased (0.032255 --> 0.032238).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1131038
	speed: 0.0474s/iter; left time: 373.9197s
	iters: 200, epoch: 7 | loss: 0.1482759
	speed: 0.0165s/iter; left time: 128.0240s
	iters: 300, epoch: 7 | loss: 0.1960526
	speed: 0.0164s/iter; left time: 125.8789s
	iters: 400, epoch: 7 | loss: 0.1173934
	speed: 0.0164s/iter; left time: 124.1370s
	iters: 500, epoch: 7 | loss: 0.1534488
	speed: 0.0164s/iter; left time: 122.5495s
Epoch: 7 cost time: 9.582915306091309
Epoch: 7, Steps: 570 | Train Loss: 0.1290236 Vali Loss: 0.0319002 Test Loss: 0.1167486
Validation loss decreased (0.032238 --> 0.031900).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0997689
	speed: 0.0501s/iter; left time: 366.6442s
	iters: 200, epoch: 8 | loss: 0.1219959
	speed: 0.0163s/iter; left time: 117.8854s
	iters: 300, epoch: 8 | loss: 0.1622185
	speed: 0.0163s/iter; left time: 116.2244s
	iters: 400, epoch: 8 | loss: 0.1229393
	speed: 0.0163s/iter; left time: 114.5353s
	iters: 500, epoch: 8 | loss: 0.1143358
	speed: 0.0159s/iter; left time: 109.5828s
Epoch: 8 cost time: 9.364574193954468
Epoch: 8, Steps: 570 | Train Loss: 0.1269052 Vali Loss: 0.0320710 Test Loss: 0.1170377
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0910712
	speed: 0.0435s/iter; left time: 293.0063s
	iters: 200, epoch: 9 | loss: 0.1019624
	speed: 0.0141s/iter; left time: 93.7465s
	iters: 300, epoch: 9 | loss: 0.1391111
	speed: 0.0141s/iter; left time: 92.3501s
	iters: 400, epoch: 9 | loss: 0.1734957
	speed: 0.0141s/iter; left time: 90.9588s
	iters: 500, epoch: 9 | loss: 0.1504850
	speed: 0.0141s/iter; left time: 89.5021s
Epoch: 9 cost time: 8.264127254486084
Epoch: 9, Steps: 570 | Train Loss: 0.1257633 Vali Loss: 0.0320730 Test Loss: 0.1168750
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1162077
	speed: 0.0435s/iter; left time: 268.2469s
	iters: 200, epoch: 10 | loss: 0.1132426
	speed: 0.0142s/iter; left time: 86.1636s
	iters: 300, epoch: 10 | loss: 0.1198543
	speed: 0.0142s/iter; left time: 84.7187s
	iters: 400, epoch: 10 | loss: 0.1213741
	speed: 0.0142s/iter; left time: 83.3330s
	iters: 500, epoch: 10 | loss: 0.1510349
	speed: 0.0142s/iter; left time: 81.7683s
Epoch: 10 cost time: 8.313953876495361
Epoch: 10, Steps: 570 | Train Loss: 0.1256021 Vali Loss: 0.0320395 Test Loss: 0.1169627
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11692093312740326, mae:0.20835144817829132
>>> S LR=1e-3 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1291262
	speed: 0.0277s/iter; left time: 312.6110s
	iters: 200, epoch: 1 | loss: 0.3492985
	speed: 0.0163s/iter; left time: 182.3549s
	iters: 300, epoch: 1 | loss: 0.3572492
	speed: 0.0162s/iter; left time: 180.3877s
	iters: 400, epoch: 1 | loss: 0.2339262
	speed: 0.0163s/iter; left time: 178.9432s
	iters: 500, epoch: 1 | loss: 0.2655392
	speed: 0.0163s/iter; left time: 177.1463s
Epoch: 1 cost time: 10.461771011352539
Epoch: 1, Steps: 570 | Train Loss: 0.2579657 Vali Loss: 0.0534651 Test Loss: 0.1654235
Validation loss decreased (inf --> 0.053465).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1878943
	speed: 0.0478s/iter; left time: 512.5254s
	iters: 200, epoch: 2 | loss: 0.2201836
	speed: 0.0163s/iter; left time: 173.7517s
	iters: 300, epoch: 2 | loss: 0.1567349
	speed: 0.0163s/iter; left time: 171.8672s
	iters: 400, epoch: 2 | loss: 0.1946181
	speed: 0.0163s/iter; left time: 170.1900s
	iters: 500, epoch: 2 | loss: 0.2413404
	speed: 0.0163s/iter; left time: 168.8839s
Epoch: 2 cost time: 9.545875310897827
Epoch: 2, Steps: 570 | Train Loss: 0.2461788 Vali Loss: 0.0780762 Test Loss: 0.2199618
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3338891
	speed: 0.0477s/iter; left time: 484.4531s
	iters: 200, epoch: 3 | loss: 0.3394788
	speed: 0.0164s/iter; left time: 165.0729s
	iters: 300, epoch: 3 | loss: 0.2226036
	speed: 0.0164s/iter; left time: 163.8149s
	iters: 400, epoch: 3 | loss: 0.2862254
	speed: 0.0155s/iter; left time: 152.6497s
	iters: 500, epoch: 3 | loss: 0.2707006
	speed: 0.0142s/iter; left time: 138.6968s
Epoch: 3 cost time: 9.111063003540039
Epoch: 3, Steps: 570 | Train Loss: 0.3158076 Vali Loss: 0.0686490 Test Loss: 0.2065042
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2680234
	speed: 0.0446s/iter; left time: 428.2137s
	iters: 200, epoch: 4 | loss: 0.2309288
	speed: 0.0141s/iter; left time: 133.5444s
	iters: 300, epoch: 4 | loss: 0.3266727
	speed: 0.0141s/iter; left time: 132.5103s
	iters: 400, epoch: 4 | loss: 0.2134605
	speed: 0.0141s/iter; left time: 130.8814s
	iters: 500, epoch: 4 | loss: 0.2543183
	speed: 0.0141s/iter; left time: 129.5675s
Epoch: 4 cost time: 8.247144222259521
Epoch: 4, Steps: 570 | Train Loss: 0.2837017 Vali Loss: 0.0693436 Test Loss: 0.2027831
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1655215620994568, mae:0.2579321563243866
>>> S LR=1e-3 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3293427
	speed: 0.0297s/iter; left time: 335.6304s
	iters: 200, epoch: 1 | loss: 0.2319245
	speed: 0.0167s/iter; left time: 187.2759s
	iters: 300, epoch: 1 | loss: 0.3924432
	speed: 0.0167s/iter; left time: 185.5495s
	iters: 400, epoch: 1 | loss: 0.2931539
	speed: 0.0167s/iter; left time: 184.1643s
	iters: 500, epoch: 1 | loss: 0.2589789
	speed: 0.0167s/iter; left time: 182.5624s
Epoch: 1 cost time: 10.884995937347412
Epoch: 1, Steps: 570 | Train Loss: 0.3102806 Vali Loss: 0.0620778 Test Loss: 0.1913111
Validation loss decreased (inf --> 0.062078).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4376607
	speed: 0.0508s/iter; left time: 545.3906s
	iters: 200, epoch: 2 | loss: 0.2827756
	speed: 0.0174s/iter; left time: 184.6931s
	iters: 300, epoch: 2 | loss: 0.2753888
	speed: 0.0168s/iter; left time: 177.1277s
	iters: 400, epoch: 2 | loss: 0.2173561
	speed: 0.0168s/iter; left time: 175.0580s
	iters: 500, epoch: 2 | loss: 0.2613159
	speed: 0.0168s/iter; left time: 173.2268s
Epoch: 2 cost time: 10.053038358688354
Epoch: 2, Steps: 570 | Train Loss: 0.2771123 Vali Loss: 0.0611597 Test Loss: 0.1941920
Validation loss decreased (0.062078 --> 0.061160).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2588904
	speed: 0.0495s/iter; left time: 502.7330s
	iters: 200, epoch: 3 | loss: 0.2374041
	speed: 0.0168s/iter; left time: 169.0088s
	iters: 300, epoch: 3 | loss: 0.4130287
	speed: 0.0168s/iter; left time: 166.9573s
	iters: 400, epoch: 3 | loss: 0.2382127
	speed: 0.0168s/iter; left time: 165.4490s
	iters: 500, epoch: 3 | loss: 0.2662362
	speed: 0.0168s/iter; left time: 163.5912s
Epoch: 3 cost time: 9.816522598266602
Epoch: 3, Steps: 570 | Train Loss: 0.2717311 Vali Loss: 0.0586280 Test Loss: 0.1847203
Validation loss decreased (0.061160 --> 0.058628).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2832155
	speed: 0.0490s/iter; left time: 469.9345s
	iters: 200, epoch: 4 | loss: 0.3128527
	speed: 0.0167s/iter; left time: 158.7317s
	iters: 300, epoch: 4 | loss: 0.2142726
	speed: 0.0167s/iter; left time: 157.0404s
	iters: 400, epoch: 4 | loss: 0.3293295
	speed: 0.0167s/iter; left time: 155.2596s
	iters: 500, epoch: 4 | loss: 0.2281118
	speed: 0.0167s/iter; left time: 153.6026s
Epoch: 4 cost time: 9.803485631942749
Epoch: 4, Steps: 570 | Train Loss: 0.2623206 Vali Loss: 0.0590661 Test Loss: 0.1799408
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2083713
	speed: 0.0496s/iter; left time: 447.8017s
	iters: 200, epoch: 5 | loss: 0.3398678
	speed: 0.0168s/iter; left time: 149.4640s
	iters: 300, epoch: 5 | loss: 0.3313701
	speed: 0.0172s/iter; left time: 151.7040s
	iters: 400, epoch: 5 | loss: 0.2449181
	speed: 0.0167s/iter; left time: 145.9462s
	iters: 500, epoch: 5 | loss: 0.1863959
	speed: 0.0168s/iter; left time: 144.7598s
Epoch: 5 cost time: 9.849156141281128
Epoch: 5, Steps: 570 | Train Loss: 0.2566977 Vali Loss: 0.0550312 Test Loss: 0.1742973
Validation loss decreased (0.058628 --> 0.055031).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2415621
	speed: 0.0510s/iter; left time: 431.3736s
	iters: 200, epoch: 6 | loss: 0.2171841
	speed: 0.0168s/iter; left time: 140.4386s
	iters: 300, epoch: 6 | loss: 0.3483663
	speed: 0.0168s/iter; left time: 138.6416s
	iters: 400, epoch: 6 | loss: 0.3933354
	speed: 0.0168s/iter; left time: 136.7895s
	iters: 500, epoch: 6 | loss: 0.2185478
	speed: 0.0168s/iter; left time: 135.3249s
Epoch: 6 cost time: 9.826871156692505
Epoch: 6, Steps: 570 | Train Loss: 0.2508370 Vali Loss: 0.0554519 Test Loss: 0.1708179
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2388406
	speed: 0.0483s/iter; left time: 380.6380s
	iters: 200, epoch: 7 | loss: 0.2114612
	speed: 0.0167s/iter; left time: 129.8342s
	iters: 300, epoch: 7 | loss: 0.3249102
	speed: 0.0167s/iter; left time: 128.3265s
	iters: 400, epoch: 7 | loss: 0.1647767
	speed: 0.0167s/iter; left time: 126.5962s
	iters: 500, epoch: 7 | loss: 0.1844049
	speed: 0.0167s/iter; left time: 124.8924s
Epoch: 7 cost time: 9.7669095993042
Epoch: 7, Steps: 570 | Train Loss: 0.2493709 Vali Loss: 0.0549669 Test Loss: 0.1696117
Validation loss decreased (0.055031 --> 0.054967).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2152778
	speed: 0.0498s/iter; left time: 363.8380s
	iters: 200, epoch: 8 | loss: 0.1496111
	speed: 0.0168s/iter; left time: 120.8029s
	iters: 300, epoch: 8 | loss: 0.2425752
	speed: 0.0167s/iter; left time: 118.5466s
	iters: 400, epoch: 8 | loss: 0.1380951
	speed: 0.0167s/iter; left time: 116.8666s
	iters: 500, epoch: 8 | loss: 0.1409200
	speed: 0.0167s/iter; left time: 115.3211s
Epoch: 8 cost time: 9.77222204208374
Epoch: 8, Steps: 570 | Train Loss: 0.2471398 Vali Loss: 0.0548654 Test Loss: 0.1696795
Validation loss decreased (0.054967 --> 0.054865).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2359132
	speed: 0.0524s/iter; left time: 353.2215s
	iters: 200, epoch: 9 | loss: 0.1588035
	speed: 0.0173s/iter; left time: 114.9703s
	iters: 300, epoch: 9 | loss: 0.2504303
	speed: 0.0167s/iter; left time: 109.4848s
	iters: 400, epoch: 9 | loss: 0.2253941
	speed: 0.0167s/iter; left time: 107.7709s
	iters: 500, epoch: 9 | loss: 0.3396904
	speed: 0.0167s/iter; left time: 106.0300s
Epoch: 9 cost time: 10.011227130889893
Epoch: 9, Steps: 570 | Train Loss: 0.2458976 Vali Loss: 0.0549806 Test Loss: 0.1694514
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3564941
	speed: 0.0487s/iter; left time: 300.3765s
	iters: 200, epoch: 10 | loss: 0.1273263
	speed: 0.0168s/iter; left time: 101.6904s
	iters: 300, epoch: 10 | loss: 0.2987633
	speed: 0.0168s/iter; left time: 100.0897s
	iters: 400, epoch: 10 | loss: 0.2764752
	speed: 0.0168s/iter; left time: 98.8222s
	iters: 500, epoch: 10 | loss: 0.2824177
	speed: 0.0168s/iter; left time: 97.2129s
Epoch: 10 cost time: 9.820736169815063
Epoch: 10, Steps: 570 | Train Loss: 0.2455807 Vali Loss: 0.0549933 Test Loss: 0.1694539
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2053146
	speed: 0.0496s/iter; left time: 277.8386s
	iters: 200, epoch: 11 | loss: 0.2457035
	speed: 0.0168s/iter; left time: 92.3679s
	iters: 300, epoch: 11 | loss: 0.1347246
	speed: 0.0168s/iter; left time: 90.7318s
	iters: 400, epoch: 11 | loss: 0.2400900
	speed: 0.0168s/iter; left time: 88.9526s
	iters: 500, epoch: 11 | loss: 0.3387894
	speed: 0.0168s/iter; left time: 87.2113s
Epoch: 11 cost time: 9.830815076828003
Epoch: 11, Steps: 570 | Train Loss: 0.2455306 Vali Loss: 0.0551548 Test Loss: 0.1694368
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.169907808303833, mae:0.25969475507736206
>>> S LR=1e-3 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2293171
	speed: 0.0278s/iter; left time: 314.7205s
	iters: 200, epoch: 1 | loss: 0.2221429
	speed: 0.0162s/iter; left time: 180.9253s
	iters: 300, epoch: 1 | loss: 0.3782628
	speed: 0.0161s/iter; left time: 179.1922s
	iters: 400, epoch: 1 | loss: 0.3344931
	speed: 0.0161s/iter; left time: 177.6382s
	iters: 500, epoch: 1 | loss: 0.1581115
	speed: 0.0161s/iter; left time: 175.9737s
Epoch: 1 cost time: 10.421431541442871
Epoch: 1, Steps: 570 | Train Loss: 0.3109109 Vali Loss: 0.0635480 Test Loss: 0.1958758
Validation loss decreased (inf --> 0.063548).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2838735
	speed: 0.0478s/iter; left time: 512.6756s
	iters: 200, epoch: 2 | loss: 0.2190179
	speed: 0.0162s/iter; left time: 171.7915s
	iters: 300, epoch: 2 | loss: 0.3235185
	speed: 0.0162s/iter; left time: 170.3320s
	iters: 400, epoch: 2 | loss: 0.4069735
	speed: 0.0162s/iter; left time: 168.7012s
	iters: 500, epoch: 2 | loss: 0.3518340
	speed: 0.0162s/iter; left time: 166.9868s
Epoch: 2 cost time: 9.481084823608398
Epoch: 2, Steps: 570 | Train Loss: 0.2928231 Vali Loss: 0.0618575 Test Loss: 0.1871748
Validation loss decreased (0.063548 --> 0.061857).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2550696
	speed: 0.0511s/iter; left time: 519.3897s
	iters: 200, epoch: 3 | loss: 0.2837231
	speed: 0.0162s/iter; left time: 163.2597s
	iters: 300, epoch: 3 | loss: 0.1701630
	speed: 0.0161s/iter; left time: 160.5769s
	iters: 400, epoch: 3 | loss: 0.2015226
	speed: 0.0162s/iter; left time: 159.3821s
	iters: 500, epoch: 3 | loss: 0.1560849
	speed: 0.0161s/iter; left time: 157.6281s
Epoch: 3 cost time: 9.487624406814575
Epoch: 3, Steps: 570 | Train Loss: 0.2662786 Vali Loss: 0.0564230 Test Loss: 0.1764182
Validation loss decreased (0.061857 --> 0.056423).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1695924
	speed: 0.0496s/iter; left time: 475.8115s
	iters: 200, epoch: 4 | loss: 0.3991742
	speed: 0.0177s/iter; left time: 167.8274s
	iters: 300, epoch: 4 | loss: 0.3053614
	speed: 0.0177s/iter; left time: 165.8010s
	iters: 400, epoch: 4 | loss: 0.1745912
	speed: 0.0177s/iter; left time: 164.1451s
	iters: 500, epoch: 4 | loss: 0.3680992
	speed: 0.0177s/iter; left time: 162.3555s
Epoch: 4 cost time: 10.342548131942749
Epoch: 4, Steps: 570 | Train Loss: 0.2544089 Vali Loss: 0.0595895 Test Loss: 0.1804326
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2458531
	speed: 0.0486s/iter; left time: 438.7465s
	iters: 200, epoch: 5 | loss: 0.3610655
	speed: 0.0162s/iter; left time: 144.1378s
	iters: 300, epoch: 5 | loss: 0.2092015
	speed: 0.0162s/iter; left time: 142.6093s
	iters: 400, epoch: 5 | loss: 0.1465028
	speed: 0.0162s/iter; left time: 141.0754s
	iters: 500, epoch: 5 | loss: 0.3059390
	speed: 0.0162s/iter; left time: 139.2311s
Epoch: 5 cost time: 9.475267887115479
Epoch: 5, Steps: 570 | Train Loss: 0.2470132 Vali Loss: 0.0555597 Test Loss: 0.1726445
Validation loss decreased (0.056423 --> 0.055560).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2852009
	speed: 0.0483s/iter; left time: 408.3458s
	iters: 200, epoch: 6 | loss: 0.4398074
	speed: 0.0162s/iter; left time: 135.6811s
	iters: 300, epoch: 6 | loss: 0.4886156
	speed: 0.0162s/iter; left time: 133.9149s
	iters: 400, epoch: 6 | loss: 0.2608978
	speed: 0.0162s/iter; left time: 132.1198s
	iters: 500, epoch: 6 | loss: 0.1920310
	speed: 0.0162s/iter; left time: 130.1356s
Epoch: 6 cost time: 9.497490406036377
Epoch: 6, Steps: 570 | Train Loss: 0.2425352 Vali Loss: 0.0561537 Test Loss: 0.1733806
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3716104
	speed: 0.0470s/iter; left time: 370.5439s
	iters: 200, epoch: 7 | loss: 0.1084172
	speed: 0.0161s/iter; left time: 125.4442s
	iters: 300, epoch: 7 | loss: 0.2676291
	speed: 0.0161s/iter; left time: 123.9270s
	iters: 400, epoch: 7 | loss: 0.3799583
	speed: 0.0162s/iter; left time: 122.4848s
	iters: 500, epoch: 7 | loss: 0.3514342
	speed: 0.0161s/iter; left time: 120.7487s
Epoch: 7 cost time: 9.44806957244873
Epoch: 7, Steps: 570 | Train Loss: 0.2374925 Vali Loss: 0.0555297 Test Loss: 0.1737078
Validation loss decreased (0.055560 --> 0.055530).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1811744
	speed: 0.0494s/iter; left time: 361.0695s
	iters: 200, epoch: 8 | loss: 0.4277781
	speed: 0.0162s/iter; left time: 116.6527s
	iters: 300, epoch: 8 | loss: 0.3207220
	speed: 0.0162s/iter; left time: 114.9557s
	iters: 400, epoch: 8 | loss: 0.2784902
	speed: 0.0162s/iter; left time: 113.4939s
	iters: 500, epoch: 8 | loss: 0.1907267
	speed: 0.0162s/iter; left time: 111.8464s
Epoch: 8 cost time: 9.503403425216675
Epoch: 8, Steps: 570 | Train Loss: 0.2362386 Vali Loss: 0.0551948 Test Loss: 0.1728950
Validation loss decreased (0.055530 --> 0.055195).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1514007
	speed: 0.0497s/iter; left time: 335.2678s
	iters: 200, epoch: 9 | loss: 0.1861001
	speed: 0.0161s/iter; left time: 106.9342s
	iters: 300, epoch: 9 | loss: 0.1103294
	speed: 0.0161s/iter; left time: 105.3054s
	iters: 400, epoch: 9 | loss: 0.1874902
	speed: 0.0161s/iter; left time: 103.7226s
	iters: 500, epoch: 9 | loss: 0.0915671
	speed: 0.0162s/iter; left time: 102.6671s
Epoch: 9 cost time: 9.471502542495728
Epoch: 9, Steps: 570 | Train Loss: 0.2351006 Vali Loss: 0.0552419 Test Loss: 0.1731200
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4167939
	speed: 0.0479s/iter; left time: 295.4622s
	iters: 200, epoch: 10 | loss: 0.2163075
	speed: 0.0162s/iter; left time: 98.2589s
	iters: 300, epoch: 10 | loss: 0.1421368
	speed: 0.0162s/iter; left time: 96.7968s
	iters: 400, epoch: 10 | loss: 0.2832419
	speed: 0.0162s/iter; left time: 95.0853s
	iters: 500, epoch: 10 | loss: 0.1772492
	speed: 0.0162s/iter; left time: 93.4999s
Epoch: 10 cost time: 9.495105981826782
Epoch: 10, Steps: 570 | Train Loss: 0.2356566 Vali Loss: 0.0553633 Test Loss: 0.1734662
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1942767
	speed: 0.0477s/iter; left time: 267.4140s
	iters: 200, epoch: 11 | loss: 0.1593520
	speed: 0.0162s/iter; left time: 89.2680s
	iters: 300, epoch: 11 | loss: 0.1727885
	speed: 0.0162s/iter; left time: 87.7112s
	iters: 400, epoch: 11 | loss: 0.2362924
	speed: 0.0162s/iter; left time: 86.0715s
	iters: 500, epoch: 11 | loss: 0.2029568
	speed: 0.0162s/iter; left time: 84.4315s
Epoch: 11 cost time: 9.528363466262817
Epoch: 11, Steps: 570 | Train Loss: 0.2333216 Vali Loss: 0.0554933 Test Loss: 0.1734349
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17312568426132202, mae:0.2631438672542572
>>> S LR=1e-3 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2643026
	speed: 0.0288s/iter; left time: 325.1455s
	iters: 200, epoch: 1 | loss: 0.2990104
	speed: 0.0170s/iter; left time: 190.4120s
	iters: 300, epoch: 1 | loss: 0.2248402
	speed: 0.0159s/iter; left time: 176.2134s
	iters: 400, epoch: 1 | loss: 0.2972031
	speed: 0.0161s/iter; left time: 176.7113s
	iters: 500, epoch: 1 | loss: 0.5710847
	speed: 0.0154s/iter; left time: 167.6926s
Epoch: 1 cost time: 10.441312313079834
Epoch: 1, Steps: 570 | Train Loss: 0.3090940 Vali Loss: 0.0654387 Test Loss: 0.1990737
Validation loss decreased (inf --> 0.065439).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4295477
	speed: 0.0481s/iter; left time: 516.0267s
	iters: 200, epoch: 2 | loss: 0.2376178
	speed: 0.0155s/iter; left time: 164.2770s
	iters: 300, epoch: 2 | loss: 0.3244932
	speed: 0.0154s/iter; left time: 162.5719s
	iters: 400, epoch: 2 | loss: 0.2297903
	speed: 0.0154s/iter; left time: 161.0994s
	iters: 500, epoch: 2 | loss: 0.3446530
	speed: 0.0154s/iter; left time: 159.3028s
Epoch: 2 cost time: 9.059497594833374
Epoch: 2, Steps: 570 | Train Loss: 0.3008366 Vali Loss: 0.0606710 Test Loss: 0.1887134
Validation loss decreased (0.065439 --> 0.060671).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3028468
	speed: 0.0469s/iter; left time: 476.2774s
	iters: 200, epoch: 3 | loss: 0.1922287
	speed: 0.0155s/iter; left time: 156.3448s
	iters: 300, epoch: 3 | loss: 0.3604575
	speed: 0.0155s/iter; left time: 154.6422s
	iters: 400, epoch: 3 | loss: 0.3062401
	speed: 0.0155s/iter; left time: 153.1599s
	iters: 500, epoch: 3 | loss: 0.2578292
	speed: 0.0155s/iter; left time: 151.5090s
Epoch: 3 cost time: 9.11834192276001
Epoch: 3, Steps: 570 | Train Loss: 0.3047245 Vali Loss: 0.0651482 Test Loss: 0.1914448
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2147140
	speed: 0.0464s/iter; left time: 445.4895s
	iters: 200, epoch: 4 | loss: 0.3145339
	speed: 0.0154s/iter; left time: 146.3694s
	iters: 300, epoch: 4 | loss: 0.3653293
	speed: 0.0154s/iter; left time: 144.5579s
	iters: 400, epoch: 4 | loss: 0.2512313
	speed: 0.0154s/iter; left time: 143.1725s
	iters: 500, epoch: 4 | loss: 0.3154992
	speed: 0.0154s/iter; left time: 141.7415s
Epoch: 4 cost time: 9.00965142250061
Epoch: 4, Steps: 570 | Train Loss: 0.2725343 Vali Loss: 0.0608814 Test Loss: 0.1863929
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2602790
	speed: 0.0464s/iter; left time: 418.5257s
	iters: 200, epoch: 5 | loss: 0.2457943
	speed: 0.0155s/iter; left time: 138.2666s
	iters: 300, epoch: 5 | loss: 0.2448507
	speed: 0.0155s/iter; left time: 136.8869s
	iters: 400, epoch: 5 | loss: 0.2372243
	speed: 0.0155s/iter; left time: 135.0375s
	iters: 500, epoch: 5 | loss: 0.2196842
	speed: 0.0155s/iter; left time: 133.3631s
Epoch: 5 cost time: 9.064048290252686
Epoch: 5, Steps: 570 | Train Loss: 0.2623257 Vali Loss: 0.0593756 Test Loss: 0.1794601
Validation loss decreased (0.060671 --> 0.059376).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3612843
	speed: 0.0470s/iter; left time: 397.2210s
	iters: 200, epoch: 6 | loss: 0.2383307
	speed: 0.0155s/iter; left time: 129.0392s
	iters: 300, epoch: 6 | loss: 0.1647074
	speed: 0.0154s/iter; left time: 127.4321s
	iters: 400, epoch: 6 | loss: 0.1632800
	speed: 0.0154s/iter; left time: 125.7662s
	iters: 500, epoch: 6 | loss: 0.1981810
	speed: 0.0155s/iter; left time: 124.4008s
Epoch: 6 cost time: 9.04405403137207
Epoch: 6, Steps: 570 | Train Loss: 0.2564953 Vali Loss: 0.0585220 Test Loss: 0.1800512
Validation loss decreased (0.059376 --> 0.058522).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2755647
	speed: 0.0466s/iter; left time: 367.3999s
	iters: 200, epoch: 7 | loss: 0.1901327
	speed: 0.0154s/iter; left time: 119.4570s
	iters: 300, epoch: 7 | loss: 0.1842347
	speed: 0.0153s/iter; left time: 117.8073s
	iters: 400, epoch: 7 | loss: 0.2896799
	speed: 0.0153s/iter; left time: 116.2454s
	iters: 500, epoch: 7 | loss: 0.2300017
	speed: 0.0153s/iter; left time: 114.7007s
Epoch: 7 cost time: 9.013785600662231
Epoch: 7, Steps: 570 | Train Loss: 0.2521025 Vali Loss: 0.0580237 Test Loss: 0.1767516
Validation loss decreased (0.058522 --> 0.058024).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2716348
	speed: 0.0511s/iter; left time: 373.7918s
	iters: 200, epoch: 8 | loss: 0.3078548
	speed: 0.0160s/iter; left time: 115.2651s
	iters: 300, epoch: 8 | loss: 0.1644247
	speed: 0.0155s/iter; left time: 109.8686s
	iters: 400, epoch: 8 | loss: 0.2661025
	speed: 0.0154s/iter; left time: 108.3166s
	iters: 500, epoch: 8 | loss: 0.1908354
	speed: 0.0154s/iter; left time: 106.6340s
Epoch: 8 cost time: 9.277655601501465
Epoch: 8, Steps: 570 | Train Loss: 0.2508343 Vali Loss: 0.0582452 Test Loss: 0.1768524
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3486834
	speed: 0.0471s/iter; left time: 317.4237s
	iters: 200, epoch: 9 | loss: 0.2781538
	speed: 0.0154s/iter; left time: 102.3009s
	iters: 300, epoch: 9 | loss: 0.3352239
	speed: 0.0154s/iter; left time: 100.7995s
	iters: 400, epoch: 9 | loss: 0.2257777
	speed: 0.0154s/iter; left time: 99.3590s
	iters: 500, epoch: 9 | loss: 0.2914813
	speed: 0.0154s/iter; left time: 97.3996s
Epoch: 9 cost time: 9.031363725662231
Epoch: 9, Steps: 570 | Train Loss: 0.2491144 Vali Loss: 0.0583085 Test Loss: 0.1771800
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2495812
	speed: 0.0476s/iter; left time: 293.5919s
	iters: 200, epoch: 10 | loss: 0.2964370
	speed: 0.0154s/iter; left time: 93.3537s
	iters: 300, epoch: 10 | loss: 0.2677589
	speed: 0.0154s/iter; left time: 91.7924s
	iters: 400, epoch: 10 | loss: 0.2695118
	speed: 0.0154s/iter; left time: 90.2018s
	iters: 500, epoch: 10 | loss: 0.3655477
	speed: 0.0167s/iter; left time: 96.1024s
Epoch: 10 cost time: 9.31053113937378
Epoch: 10, Steps: 570 | Train Loss: 0.2505946 Vali Loss: 0.0581796 Test Loss: 0.1764213
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17698323726654053, mae:0.2705579400062561
>>> S LR=1e-3 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2238317
	speed: 0.0313s/iter; left time: 353.9280s
	iters: 200, epoch: 1 | loss: 0.2698286
	speed: 0.0188s/iter; left time: 210.3135s
	iters: 300, epoch: 1 | loss: 0.3586685
	speed: 0.0187s/iter; left time: 208.1118s
	iters: 400, epoch: 1 | loss: 0.2816634
	speed: 0.0188s/iter; left time: 206.4041s
	iters: 500, epoch: 1 | loss: 0.2087778
	speed: 0.0188s/iter; left time: 204.5222s
Epoch: 1 cost time: 12.005321025848389
Epoch: 1, Steps: 570 | Train Loss: 0.2649369 Vali Loss: 0.0675939 Test Loss: 0.1919482
Validation loss decreased (inf --> 0.067594).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4805877
	speed: 0.0598s/iter; left time: 641.5632s
	iters: 200, epoch: 2 | loss: 0.2647481
	speed: 0.0210s/iter; left time: 223.4007s
	iters: 300, epoch: 2 | loss: 0.2046765
	speed: 0.0210s/iter; left time: 220.6457s
	iters: 400, epoch: 2 | loss: 0.2915249
	speed: 0.0210s/iter; left time: 218.6652s
	iters: 500, epoch: 2 | loss: 0.2413132
	speed: 0.0209s/iter; left time: 216.4197s
Epoch: 2 cost time: 12.192178964614868
Epoch: 2, Steps: 570 | Train Loss: 0.2876405 Vali Loss: 0.0642842 Test Loss: 0.1857004
Validation loss decreased (0.067594 --> 0.064284).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1972618
	speed: 0.0577s/iter; left time: 586.3004s
	iters: 200, epoch: 3 | loss: 0.2446756
	speed: 0.0187s/iter; left time: 187.8054s
	iters: 300, epoch: 3 | loss: 0.2047470
	speed: 0.0187s/iter; left time: 185.9684s
	iters: 400, epoch: 3 | loss: 0.2538577
	speed: 0.0187s/iter; left time: 184.0831s
	iters: 500, epoch: 3 | loss: 0.1660955
	speed: 0.0186s/iter; left time: 182.0239s
Epoch: 3 cost time: 10.873915433883667
Epoch: 3, Steps: 570 | Train Loss: 0.2676641 Vali Loss: 0.0733806 Test Loss: 0.2067842
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3239729
	speed: 0.0564s/iter; left time: 540.6743s
	iters: 200, epoch: 4 | loss: 0.3166793
	speed: 0.0211s/iter; left time: 199.8714s
	iters: 300, epoch: 4 | loss: 0.3635079
	speed: 0.0210s/iter; left time: 196.7597s
	iters: 400, epoch: 4 | loss: 0.1382364
	speed: 0.0210s/iter; left time: 194.8281s
	iters: 500, epoch: 4 | loss: 0.2327298
	speed: 0.0209s/iter; left time: 192.4875s
Epoch: 4 cost time: 12.184760332107544
Epoch: 4, Steps: 570 | Train Loss: 0.2600820 Vali Loss: 0.0573455 Test Loss: 0.1706160
Validation loss decreased (0.064284 --> 0.057346).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2413447
	speed: 0.0597s/iter; left time: 538.4548s
	iters: 200, epoch: 5 | loss: 0.2931508
	speed: 0.0186s/iter; left time: 165.8699s
	iters: 300, epoch: 5 | loss: 0.2222618
	speed: 0.0186s/iter; left time: 163.9724s
	iters: 400, epoch: 5 | loss: 0.2548339
	speed: 0.0186s/iter; left time: 162.0429s
	iters: 500, epoch: 5 | loss: 0.1990982
	speed: 0.0186s/iter; left time: 160.0950s
Epoch: 5 cost time: 10.939326524734497
Epoch: 5, Steps: 570 | Train Loss: 0.2354022 Vali Loss: 0.0558995 Test Loss: 0.1711209
Validation loss decreased (0.057346 --> 0.055900).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1385425
	speed: 0.0552s/iter; left time: 466.2013s
	iters: 200, epoch: 6 | loss: 0.2739680
	speed: 0.0187s/iter; left time: 156.3124s
	iters: 300, epoch: 6 | loss: 0.1663285
	speed: 0.0187s/iter; left time: 153.9465s
	iters: 400, epoch: 6 | loss: 0.2832742
	speed: 0.0187s/iter; left time: 152.6350s
	iters: 500, epoch: 6 | loss: 0.2111683
	speed: 0.0187s/iter; left time: 150.5478s
Epoch: 6 cost time: 10.925806045532227
Epoch: 6, Steps: 570 | Train Loss: 0.2292961 Vali Loss: 0.0561666 Test Loss: 0.1705903
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1429701
	speed: 0.0556s/iter; left time: 438.0638s
	iters: 200, epoch: 7 | loss: 0.2470228
	speed: 0.0188s/iter; left time: 146.1906s
	iters: 300, epoch: 7 | loss: 0.1804196
	speed: 0.0188s/iter; left time: 144.2703s
	iters: 400, epoch: 7 | loss: 0.2261237
	speed: 0.0188s/iter; left time: 142.4261s
	iters: 500, epoch: 7 | loss: 0.2975135
	speed: 0.0188s/iter; left time: 140.4918s
Epoch: 7 cost time: 11.051461935043335
Epoch: 7, Steps: 570 | Train Loss: 0.2264862 Vali Loss: 0.0556670 Test Loss: 0.1678081
Validation loss decreased (0.055900 --> 0.055667).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2081223
	speed: 0.0544s/iter; left time: 397.7702s
	iters: 200, epoch: 8 | loss: 0.1352141
	speed: 0.0187s/iter; left time: 134.8965s
	iters: 300, epoch: 8 | loss: 0.2026723
	speed: 0.0187s/iter; left time: 132.8663s
	iters: 400, epoch: 8 | loss: 0.3645794
	speed: 0.0187s/iter; left time: 130.9982s
	iters: 500, epoch: 8 | loss: 0.1895265
	speed: 0.0187s/iter; left time: 129.1848s
Epoch: 8 cost time: 10.90022325515747
Epoch: 8, Steps: 570 | Train Loss: 0.2240633 Vali Loss: 0.0551407 Test Loss: 0.1680601
Validation loss decreased (0.055667 --> 0.055141).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1632122
	speed: 0.0574s/iter; left time: 386.9950s
	iters: 200, epoch: 9 | loss: 0.3212542
	speed: 0.0186s/iter; left time: 123.6520s
	iters: 300, epoch: 9 | loss: 0.1147163
	speed: 0.0186s/iter; left time: 121.8009s
	iters: 400, epoch: 9 | loss: 0.1857430
	speed: 0.0186s/iter; left time: 119.9692s
	iters: 500, epoch: 9 | loss: 0.1342443
	speed: 0.0186s/iter; left time: 118.1207s
Epoch: 9 cost time: 10.872867822647095
Epoch: 9, Steps: 570 | Train Loss: 0.2244618 Vali Loss: 0.0552279 Test Loss: 0.1678740
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2337696
	speed: 0.0557s/iter; left time: 343.4712s
	iters: 200, epoch: 10 | loss: 0.2190818
	speed: 0.0188s/iter; left time: 113.8659s
	iters: 300, epoch: 10 | loss: 0.1728772
	speed: 0.0187s/iter; left time: 111.7874s
	iters: 400, epoch: 10 | loss: 0.1830789
	speed: 0.0187s/iter; left time: 109.9938s
	iters: 500, epoch: 10 | loss: 0.1883903
	speed: 0.0186s/iter; left time: 107.5238s
Epoch: 10 cost time: 10.88692045211792
Epoch: 10, Steps: 570 | Train Loss: 0.2230894 Vali Loss: 0.0549367 Test Loss: 0.1673129
Validation loss decreased (0.055141 --> 0.054937).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1937602
	speed: 0.0550s/iter; left time: 308.2375s
	iters: 200, epoch: 11 | loss: 0.2922740
	speed: 0.0187s/iter; left time: 102.6121s
	iters: 300, epoch: 11 | loss: 0.2029705
	speed: 0.0187s/iter; left time: 101.2508s
	iters: 400, epoch: 11 | loss: 0.1625442
	speed: 0.0187s/iter; left time: 99.3077s
	iters: 500, epoch: 11 | loss: 0.2920045
	speed: 0.0187s/iter; left time: 97.4861s
Epoch: 11 cost time: 10.942532062530518
Epoch: 11, Steps: 570 | Train Loss: 0.2247193 Vali Loss: 0.0550498 Test Loss: 0.1673461
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2599918
	speed: 0.0543s/iter; left time: 273.3787s
	iters: 200, epoch: 12 | loss: 0.2694879
	speed: 0.0187s/iter; left time: 92.2338s
	iters: 300, epoch: 12 | loss: 0.1480796
	speed: 0.0187s/iter; left time: 90.3531s
	iters: 400, epoch: 12 | loss: 0.2125182
	speed: 0.0187s/iter; left time: 88.4319s
	iters: 500, epoch: 12 | loss: 0.1676516
	speed: 0.0187s/iter; left time: 86.6187s
Epoch: 12 cost time: 10.897351503372192
Epoch: 12, Steps: 570 | Train Loss: 0.2224556 Vali Loss: 0.0549755 Test Loss: 0.1674142
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3004307
	speed: 0.0549s/iter; left time: 244.9527s
	iters: 200, epoch: 13 | loss: 0.1996170
	speed: 0.0187s/iter; left time: 81.6757s
	iters: 300, epoch: 13 | loss: 0.1950548
	speed: 0.0187s/iter; left time: 79.7782s
	iters: 400, epoch: 13 | loss: 0.1522615
	speed: 0.0188s/iter; left time: 78.1480s
	iters: 500, epoch: 13 | loss: 0.2825274
	speed: 0.0187s/iter; left time: 76.1377s
Epoch: 13 cost time: 10.917819738388062
Epoch: 13, Steps: 570 | Train Loss: 0.2229355 Vali Loss: 0.0549561 Test Loss: 0.1674103
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16747799515724182, mae:0.26583442091941833
>>> S LR=1e-3 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.4038373
	speed: 0.0320s/iter; left time: 362.1744s
	iters: 200, epoch: 1 | loss: 0.2149537
	speed: 0.0203s/iter; left time: 227.0631s
	iters: 300, epoch: 1 | loss: 0.1749545
	speed: 0.0184s/iter; left time: 203.8746s
	iters: 400, epoch: 1 | loss: 0.2018982
	speed: 0.0198s/iter; left time: 218.1592s
	iters: 500, epoch: 1 | loss: 0.2210307
	speed: 0.0198s/iter; left time: 215.3912s
Epoch: 1 cost time: 12.34181523323059
Epoch: 1, Steps: 570 | Train Loss: 0.2135312 Vali Loss: 0.0390017 Test Loss: 0.1399947
Validation loss decreased (inf --> 0.039002).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1512074
	speed: 0.0556s/iter; left time: 596.6794s
	iters: 200, epoch: 2 | loss: 0.2569232
	speed: 0.0181s/iter; left time: 192.8610s
	iters: 300, epoch: 2 | loss: 0.3797328
	speed: 0.0181s/iter; left time: 190.6349s
	iters: 400, epoch: 2 | loss: 0.2939426
	speed: 0.0181s/iter; left time: 188.7566s
	iters: 500, epoch: 2 | loss: 0.2541273
	speed: 0.0181s/iter; left time: 186.9817s
Epoch: 2 cost time: 10.565052032470703
Epoch: 2, Steps: 570 | Train Loss: 0.2521012 Vali Loss: 0.0601518 Test Loss: 0.1938580
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1669683
	speed: 0.0545s/iter; left time: 553.7309s
	iters: 200, epoch: 3 | loss: 0.2905317
	speed: 0.0181s/iter; left time: 181.9879s
	iters: 300, epoch: 3 | loss: 0.2206803
	speed: 0.0181s/iter; left time: 180.3043s
	iters: 400, epoch: 3 | loss: 0.2584334
	speed: 0.0181s/iter; left time: 178.5693s
	iters: 500, epoch: 3 | loss: 0.1948338
	speed: 0.0186s/iter; left time: 181.1969s
Epoch: 3 cost time: 10.706237554550171
Epoch: 3, Steps: 570 | Train Loss: 0.2300126 Vali Loss: 0.0515205 Test Loss: 0.1599659
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2585097
	speed: 0.0567s/iter; left time: 543.9978s
	iters: 200, epoch: 4 | loss: 0.1095293
	speed: 0.0205s/iter; left time: 194.4231s
	iters: 300, epoch: 4 | loss: 0.2094155
	speed: 0.0204s/iter; left time: 191.4444s
	iters: 400, epoch: 4 | loss: 0.1644769
	speed: 0.0204s/iter; left time: 189.2646s
	iters: 500, epoch: 4 | loss: 0.1358658
	speed: 0.0195s/iter; left time: 179.5459s
Epoch: 4 cost time: 11.629380464553833
Epoch: 4, Steps: 570 | Train Loss: 0.2204618 Vali Loss: 0.0516448 Test Loss: 0.1625028
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14015713334083557, mae:0.23242375254631042
>>> S LR=1e-3 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2178166
	speed: 0.0323s/iter; left time: 364.8203s
	iters: 200, epoch: 1 | loss: 0.1785001
	speed: 0.0203s/iter; left time: 227.8541s
	iters: 300, epoch: 1 | loss: 0.3775045
	speed: 0.0204s/iter; left time: 226.2929s
	iters: 400, epoch: 1 | loss: 0.2607561
	speed: 0.0204s/iter; left time: 223.9729s
	iters: 500, epoch: 1 | loss: 0.3895876
	speed: 0.0203s/iter; left time: 220.9647s
Epoch: 1 cost time: 12.840489149093628
Epoch: 1, Steps: 570 | Train Loss: 0.2663743 Vali Loss: 0.0599083 Test Loss: 0.1981840
Validation loss decreased (inf --> 0.059908).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3829543
	speed: 0.0577s/iter; left time: 619.4224s
	iters: 200, epoch: 2 | loss: 0.4019244
	speed: 0.0182s/iter; left time: 193.2713s
	iters: 300, epoch: 2 | loss: 0.6067965
	speed: 0.0181s/iter; left time: 191.0334s
	iters: 400, epoch: 2 | loss: 0.2322583
	speed: 0.0181s/iter; left time: 189.1983s
	iters: 500, epoch: 2 | loss: 0.2488586
	speed: 0.0181s/iter; left time: 187.2539s
Epoch: 2 cost time: 10.617034435272217
Epoch: 2, Steps: 570 | Train Loss: 0.3008548 Vali Loss: 0.0618070 Test Loss: 0.1939063
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1426626
	speed: 0.0546s/iter; left time: 555.2752s
	iters: 200, epoch: 3 | loss: 0.2775646
	speed: 0.0183s/iter; left time: 183.6952s
	iters: 300, epoch: 3 | loss: 0.2289219
	speed: 0.0182s/iter; left time: 181.3265s
	iters: 400, epoch: 3 | loss: 0.3760214
	speed: 0.0182s/iter; left time: 179.9376s
	iters: 500, epoch: 3 | loss: 0.2758648
	speed: 0.0182s/iter; left time: 178.0570s
Epoch: 3 cost time: 10.700000047683716
Epoch: 3, Steps: 570 | Train Loss: 0.2669007 Vali Loss: 0.0586425 Test Loss: 0.1861053
Validation loss decreased (0.059908 --> 0.058643).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2443573
	speed: 0.0570s/iter; left time: 546.5426s
	iters: 200, epoch: 4 | loss: 0.2549764
	speed: 0.0182s/iter; left time: 172.9175s
	iters: 300, epoch: 4 | loss: 0.1673928
	speed: 0.0181s/iter; left time: 170.4460s
	iters: 400, epoch: 4 | loss: 0.2318860
	speed: 0.0181s/iter; left time: 168.5143s
	iters: 500, epoch: 4 | loss: 0.1814266
	speed: 0.0182s/iter; left time: 167.0396s
Epoch: 4 cost time: 10.652483224868774
Epoch: 4, Steps: 570 | Train Loss: 0.2527904 Vali Loss: 0.0581723 Test Loss: 0.1706471
Validation loss decreased (0.058643 --> 0.058172).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2048277
	speed: 0.0571s/iter; left time: 514.6834s
	iters: 200, epoch: 5 | loss: 0.2077672
	speed: 0.0181s/iter; left time: 161.7267s
	iters: 300, epoch: 5 | loss: 0.1564028
	speed: 0.0182s/iter; left time: 160.1868s
	iters: 400, epoch: 5 | loss: 0.2327346
	speed: 0.0181s/iter; left time: 157.4657s
	iters: 500, epoch: 5 | loss: 0.1617346
	speed: 0.0180s/iter; left time: 155.5006s
Epoch: 5 cost time: 10.567083358764648
Epoch: 5, Steps: 570 | Train Loss: 0.2429009 Vali Loss: 0.0585843 Test Loss: 0.1666778
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2587885
	speed: 0.0587s/iter; left time: 496.3716s
	iters: 200, epoch: 6 | loss: 0.1125516
	speed: 0.0202s/iter; left time: 168.7711s
	iters: 300, epoch: 6 | loss: 0.3646969
	speed: 0.0182s/iter; left time: 150.4337s
	iters: 400, epoch: 6 | loss: 0.1559892
	speed: 0.0182s/iter; left time: 148.5768s
	iters: 500, epoch: 6 | loss: 0.2133872
	speed: 0.0182s/iter; left time: 146.6209s
Epoch: 6 cost time: 11.07026720046997
Epoch: 6, Steps: 570 | Train Loss: 0.2372280 Vali Loss: 0.0585540 Test Loss: 0.1639883
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1828808
	speed: 0.0535s/iter; left time: 421.4863s
	iters: 200, epoch: 7 | loss: 0.2653658
	speed: 0.0181s/iter; left time: 141.0868s
	iters: 300, epoch: 7 | loss: 0.2600070
	speed: 0.0181s/iter; left time: 139.2128s
	iters: 400, epoch: 7 | loss: 0.2250185
	speed: 0.0181s/iter; left time: 136.9134s
	iters: 500, epoch: 7 | loss: 0.1562455
	speed: 0.0181s/iter; left time: 135.1931s
Epoch: 7 cost time: 10.54821491241455
Epoch: 7, Steps: 570 | Train Loss: 0.2305392 Vali Loss: 0.0585216 Test Loss: 0.1643761
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17084954679012299, mae:0.2622448205947876
>>> S LR=1e-3 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2901407
	speed: 0.0336s/iter; left time: 379.5255s
	iters: 200, epoch: 1 | loss: 0.3223125
	speed: 0.0218s/iter; left time: 243.7692s
	iters: 300, epoch: 1 | loss: 0.3156058
	speed: 0.0218s/iter; left time: 241.6081s
	iters: 400, epoch: 1 | loss: 0.4336771
	speed: 0.0218s/iter; left time: 239.3660s
	iters: 500, epoch: 1 | loss: 0.3418376
	speed: 0.0218s/iter; left time: 237.2736s
Epoch: 1 cost time: 13.63474154472351
Epoch: 1, Steps: 570 | Train Loss: 0.3533497 Vali Loss: 0.0598199 Test Loss: 0.1940860
Validation loss decreased (inf --> 0.059820).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3054365
	speed: 0.0610s/iter; left time: 655.0093s
	iters: 200, epoch: 2 | loss: 0.2820303
	speed: 0.0219s/iter; left time: 233.0429s
	iters: 300, epoch: 2 | loss: 0.2769562
	speed: 0.0218s/iter; left time: 229.7692s
	iters: 400, epoch: 2 | loss: 0.2596841
	speed: 0.0218s/iter; left time: 227.4626s
	iters: 500, epoch: 2 | loss: 0.2871289
	speed: 0.0218s/iter; left time: 225.2450s
Epoch: 2 cost time: 12.70365571975708
Epoch: 2, Steps: 570 | Train Loss: 0.2907034 Vali Loss: 0.0557771 Test Loss: 0.1819695
Validation loss decreased (0.059820 --> 0.055777).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5303357
	speed: 0.0613s/iter; left time: 622.3795s
	iters: 200, epoch: 3 | loss: 0.1899624
	speed: 0.0219s/iter; left time: 219.9825s
	iters: 300, epoch: 3 | loss: 0.3176257
	speed: 0.0218s/iter; left time: 217.4238s
	iters: 400, epoch: 3 | loss: 0.2252271
	speed: 0.0218s/iter; left time: 215.2675s
	iters: 500, epoch: 3 | loss: 0.2074521
	speed: 0.0219s/iter; left time: 213.3995s
Epoch: 3 cost time: 12.711100578308105
Epoch: 3, Steps: 570 | Train Loss: 0.2656156 Vali Loss: 0.0546631 Test Loss: 0.1735478
Validation loss decreased (0.055777 --> 0.054663).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2230203
	speed: 0.0633s/iter; left time: 607.4300s
	iters: 200, epoch: 4 | loss: 0.1951309
	speed: 0.0220s/iter; left time: 208.3822s
	iters: 300, epoch: 4 | loss: 0.2376977
	speed: 0.0219s/iter; left time: 205.8167s
	iters: 400, epoch: 4 | loss: 0.2127408
	speed: 0.0219s/iter; left time: 203.5494s
	iters: 500, epoch: 4 | loss: 0.3083913
	speed: 0.0219s/iter; left time: 201.1659s
Epoch: 4 cost time: 12.726431608200073
Epoch: 4, Steps: 570 | Train Loss: 0.2546973 Vali Loss: 0.0558474 Test Loss: 0.1752710
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3095035
	speed: 0.0597s/iter; left time: 538.9545s
	iters: 200, epoch: 5 | loss: 0.2368895
	speed: 0.0218s/iter; left time: 194.7988s
	iters: 300, epoch: 5 | loss: 0.1974181
	speed: 0.0218s/iter; left time: 192.7085s
	iters: 400, epoch: 5 | loss: 0.2406529
	speed: 0.0218s/iter; left time: 190.0893s
	iters: 500, epoch: 5 | loss: 0.2092551
	speed: 0.0218s/iter; left time: 187.9112s
Epoch: 5 cost time: 12.711121082305908
Epoch: 5, Steps: 570 | Train Loss: 0.2482564 Vali Loss: 0.0554724 Test Loss: 0.1703900
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1824554
	speed: 0.0602s/iter; left time: 508.9387s
	iters: 200, epoch: 6 | loss: 0.4973575
	speed: 0.0219s/iter; left time: 182.6649s
	iters: 300, epoch: 6 | loss: 0.2116023
	speed: 0.0219s/iter; left time: 180.7050s
	iters: 400, epoch: 6 | loss: 0.2280262
	speed: 0.0219s/iter; left time: 178.2104s
	iters: 500, epoch: 6 | loss: 0.4544094
	speed: 0.0219s/iter; left time: 176.0344s
Epoch: 6 cost time: 12.708662748336792
Epoch: 6, Steps: 570 | Train Loss: 0.2447541 Vali Loss: 0.0559437 Test Loss: 0.1706955
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17371834814548492, mae:0.26150697469711304
>>> S LR=1e-3 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3147491
	speed: 0.0330s/iter; left time: 372.8472s
	iters: 200, epoch: 1 | loss: 0.1668948
	speed: 0.0212s/iter; left time: 237.5497s
	iters: 300, epoch: 1 | loss: 0.2691323
	speed: 0.0212s/iter; left time: 235.5263s
	iters: 400, epoch: 1 | loss: 0.3237875
	speed: 0.0212s/iter; left time: 233.2507s
	iters: 500, epoch: 1 | loss: 0.1972568
	speed: 0.0212s/iter; left time: 231.1988s
Epoch: 1 cost time: 13.318469047546387
Epoch: 1, Steps: 570 | Train Loss: 0.3431659 Vali Loss: 0.0649645 Test Loss: 0.1943520
Validation loss decreased (inf --> 0.064964).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3271239
	speed: 0.0613s/iter; left time: 658.0845s
	iters: 200, epoch: 2 | loss: 0.2149207
	speed: 0.0211s/iter; left time: 224.3187s
	iters: 300, epoch: 2 | loss: 0.3078901
	speed: 0.0211s/iter; left time: 222.0240s
	iters: 400, epoch: 2 | loss: 0.3237430
	speed: 0.0211s/iter; left time: 219.8420s
	iters: 500, epoch: 2 | loss: 0.2164897
	speed: 0.0211s/iter; left time: 217.6627s
Epoch: 2 cost time: 12.287941694259644
Epoch: 2, Steps: 570 | Train Loss: 0.2917440 Vali Loss: 0.0638046 Test Loss: 0.2081665
Validation loss decreased (0.064964 --> 0.063805).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2508031
	speed: 0.0610s/iter; left time: 619.8027s
	iters: 200, epoch: 3 | loss: 0.2499804
	speed: 0.0211s/iter; left time: 212.3016s
	iters: 300, epoch: 3 | loss: 0.2341557
	speed: 0.0211s/iter; left time: 210.2039s
	iters: 400, epoch: 3 | loss: 0.2247384
	speed: 0.0211s/iter; left time: 208.1758s
	iters: 500, epoch: 3 | loss: 0.1850172
	speed: 0.0211s/iter; left time: 205.5849s
Epoch: 3 cost time: 12.282518148422241
Epoch: 3, Steps: 570 | Train Loss: 0.2752620 Vali Loss: 0.0559127 Test Loss: 0.1862776
Validation loss decreased (0.063805 --> 0.055913).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1461612
	speed: 0.0610s/iter; left time: 584.7283s
	iters: 200, epoch: 4 | loss: 0.2724155
	speed: 0.0212s/iter; left time: 201.5342s
	iters: 300, epoch: 4 | loss: 0.3090990
	speed: 0.0212s/iter; left time: 199.4502s
	iters: 400, epoch: 4 | loss: 0.3352582
	speed: 0.0212s/iter; left time: 197.2818s
	iters: 500, epoch: 4 | loss: 0.1988772
	speed: 0.0212s/iter; left time: 195.1135s
Epoch: 4 cost time: 12.35873818397522
Epoch: 4, Steps: 570 | Train Loss: 0.2658304 Vali Loss: 0.0567820 Test Loss: 0.1874888
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2400859
	speed: 0.0588s/iter; left time: 530.2589s
	iters: 200, epoch: 5 | loss: 0.2244683
	speed: 0.0211s/iter; left time: 187.9761s
	iters: 300, epoch: 5 | loss: 0.3163457
	speed: 0.0211s/iter; left time: 186.1527s
	iters: 400, epoch: 5 | loss: 0.2760444
	speed: 0.0211s/iter; left time: 184.0187s
	iters: 500, epoch: 5 | loss: 0.1740052
	speed: 0.0211s/iter; left time: 181.6220s
Epoch: 5 cost time: 12.272268533706665
Epoch: 5, Steps: 570 | Train Loss: 0.2599851 Vali Loss: 0.0558551 Test Loss: 0.1859648
Validation loss decreased (0.055913 --> 0.055855).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2664434
	speed: 0.0595s/iter; left time: 502.5744s
	iters: 200, epoch: 6 | loss: 0.4401548
	speed: 0.0212s/iter; left time: 176.9341s
	iters: 300, epoch: 6 | loss: 0.2932772
	speed: 0.0212s/iter; left time: 174.7371s
	iters: 400, epoch: 6 | loss: 0.1933084
	speed: 0.0212s/iter; left time: 172.4592s
	iters: 500, epoch: 6 | loss: 0.1720800
	speed: 0.0212s/iter; left time: 170.4914s
Epoch: 6 cost time: 12.315714359283447
Epoch: 6, Steps: 570 | Train Loss: 0.2570228 Vali Loss: 0.0550916 Test Loss: 0.1837416
Validation loss decreased (0.055855 --> 0.055092).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2548693
	speed: 0.0596s/iter; left time: 470.0484s
	iters: 200, epoch: 7 | loss: 0.3850001
	speed: 0.0212s/iter; left time: 164.6253s
	iters: 300, epoch: 7 | loss: 0.2992522
	speed: 0.0211s/iter; left time: 162.0461s
	iters: 400, epoch: 7 | loss: 0.1445847
	speed: 0.0211s/iter; left time: 159.9437s
	iters: 500, epoch: 7 | loss: 0.2194321
	speed: 0.0211s/iter; left time: 157.8130s
Epoch: 7 cost time: 12.322165250778198
Epoch: 7, Steps: 570 | Train Loss: 0.2545920 Vali Loss: 0.0550363 Test Loss: 0.1817461
Validation loss decreased (0.055092 --> 0.055036).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2461602
	speed: 0.0596s/iter; left time: 436.0396s
	iters: 200, epoch: 8 | loss: 0.2760112
	speed: 0.0211s/iter; left time: 152.3025s
	iters: 300, epoch: 8 | loss: 0.1844089
	speed: 0.0211s/iter; left time: 150.2218s
	iters: 400, epoch: 8 | loss: 0.3478241
	speed: 0.0211s/iter; left time: 148.1458s
	iters: 500, epoch: 8 | loss: 0.3295722
	speed: 0.0211s/iter; left time: 146.0303s
Epoch: 8 cost time: 12.30713176727295
Epoch: 8, Steps: 570 | Train Loss: 0.2535716 Vali Loss: 0.0543608 Test Loss: 0.1815582
Validation loss decreased (0.055036 --> 0.054361).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2599518
	speed: 0.0600s/iter; left time: 404.5111s
	iters: 200, epoch: 9 | loss: 0.3291045
	speed: 0.0211s/iter; left time: 139.9548s
	iters: 300, epoch: 9 | loss: 0.3476177
	speed: 0.0211s/iter; left time: 137.8264s
	iters: 400, epoch: 9 | loss: 0.2224555
	speed: 0.0211s/iter; left time: 135.8674s
	iters: 500, epoch: 9 | loss: 0.1615589
	speed: 0.0212s/iter; left time: 134.1781s
Epoch: 9 cost time: 12.355894565582275
Epoch: 9, Steps: 570 | Train Loss: 0.2533636 Vali Loss: 0.0545561 Test Loss: 0.1815834
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1492820
	speed: 0.0620s/iter; left time: 382.5154s
	iters: 200, epoch: 10 | loss: 0.2661336
	speed: 0.0231s/iter; left time: 140.5405s
	iters: 300, epoch: 10 | loss: 0.1792795
	speed: 0.0231s/iter; left time: 137.9593s
	iters: 400, epoch: 10 | loss: 0.2375860
	speed: 0.0231s/iter; left time: 135.6111s
	iters: 500, epoch: 10 | loss: 0.3114426
	speed: 0.0225s/iter; left time: 129.7047s
Epoch: 10 cost time: 13.254440307617188
Epoch: 10, Steps: 570 | Train Loss: 0.2523545 Vali Loss: 0.0544661 Test Loss: 0.1815178
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2910109
	speed: 0.0586s/iter; left time: 327.9396s
	iters: 200, epoch: 11 | loss: 0.3048660
	speed: 0.0211s/iter; left time: 116.0366s
	iters: 300, epoch: 11 | loss: 0.2141486
	speed: 0.0211s/iter; left time: 113.8350s
	iters: 400, epoch: 11 | loss: 0.1956348
	speed: 0.0211s/iter; left time: 111.7634s
	iters: 500, epoch: 11 | loss: 0.3883725
	speed: 0.0211s/iter; left time: 109.5731s
Epoch: 11 cost time: 12.264809370040894
Epoch: 11, Steps: 570 | Train Loss: 0.2519601 Vali Loss: 0.0543805 Test Loss: 0.1814551
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.18174885213375092, mae:0.26841670274734497
>>> S LR=1e-3 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3737866
	speed: 0.0340s/iter; left time: 384.3699s
	iters: 200, epoch: 1 | loss: 0.2197884
	speed: 0.0222s/iter; left time: 248.6014s
	iters: 300, epoch: 1 | loss: 0.3726439
	speed: 0.0222s/iter; left time: 246.3237s
	iters: 400, epoch: 1 | loss: 0.4501721
	speed: 0.0221s/iter; left time: 243.5029s
	iters: 500, epoch: 1 | loss: 0.2720687
	speed: 0.0222s/iter; left time: 241.8411s
Epoch: 1 cost time: 13.754045963287354
Epoch: 1, Steps: 570 | Train Loss: 0.3259644 Vali Loss: 0.0638488 Test Loss: 0.1996595
Validation loss decreased (inf --> 0.063849).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1739513
	speed: 0.0594s/iter; left time: 637.4503s
	iters: 200, epoch: 2 | loss: 0.4282705
	speed: 0.0201s/iter; left time: 213.9410s
	iters: 300, epoch: 2 | loss: 0.2473390
	speed: 0.0201s/iter; left time: 211.7227s
	iters: 400, epoch: 2 | loss: 0.1900548
	speed: 0.0201s/iter; left time: 209.6847s
	iters: 500, epoch: 2 | loss: 0.2029632
	speed: 0.0201s/iter; left time: 207.8075s
Epoch: 2 cost time: 11.722906112670898
Epoch: 2, Steps: 570 | Train Loss: 0.2879152 Vali Loss: 0.0607700 Test Loss: 0.1886180
Validation loss decreased (0.063849 --> 0.060770).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1992048
	speed: 0.0582s/iter; left time: 591.8291s
	iters: 200, epoch: 3 | loss: 0.1767929
	speed: 0.0200s/iter; left time: 200.9434s
	iters: 300, epoch: 3 | loss: 0.2192582
	speed: 0.0200s/iter; left time: 199.2563s
	iters: 400, epoch: 3 | loss: 0.2791971
	speed: 0.0200s/iter; left time: 197.4557s
	iters: 500, epoch: 3 | loss: 0.2332118
	speed: 0.0200s/iter; left time: 194.9811s
Epoch: 3 cost time: 11.640673160552979
Epoch: 3, Steps: 570 | Train Loss: 0.2697949 Vali Loss: 0.0584853 Test Loss: 0.1815295
Validation loss decreased (0.060770 --> 0.058485).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1652442
	speed: 0.0596s/iter; left time: 571.6025s
	iters: 200, epoch: 4 | loss: 0.3456099
	speed: 0.0200s/iter; left time: 189.7079s
	iters: 300, epoch: 4 | loss: 0.1553995
	speed: 0.0200s/iter; left time: 187.8048s
	iters: 400, epoch: 4 | loss: 0.2787691
	speed: 0.0200s/iter; left time: 185.4833s
	iters: 500, epoch: 4 | loss: 0.2274074
	speed: 0.0200s/iter; left time: 183.8687s
Epoch: 4 cost time: 11.651564836502075
Epoch: 4, Steps: 570 | Train Loss: 0.2589724 Vali Loss: 0.0554112 Test Loss: 0.1795056
Validation loss decreased (0.058485 --> 0.055411).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1849998
	speed: 0.0590s/iter; left time: 531.9947s
	iters: 200, epoch: 5 | loss: 0.3009446
	speed: 0.0201s/iter; left time: 179.1384s
	iters: 300, epoch: 5 | loss: 0.2608223
	speed: 0.0200s/iter; left time: 176.8542s
	iters: 400, epoch: 5 | loss: 0.2409237
	speed: 0.0200s/iter; left time: 174.5717s
	iters: 500, epoch: 5 | loss: 0.2147707
	speed: 0.0200s/iter; left time: 172.0459s
Epoch: 5 cost time: 11.665339946746826
Epoch: 5, Steps: 570 | Train Loss: 0.2512484 Vali Loss: 0.0539125 Test Loss: 0.1729761
Validation loss decreased (0.055411 --> 0.053913).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3005862
	speed: 0.0601s/iter; left time: 507.7129s
	iters: 200, epoch: 6 | loss: 0.3269979
	speed: 0.0201s/iter; left time: 168.0172s
	iters: 300, epoch: 6 | loss: 0.2369170
	speed: 0.0201s/iter; left time: 165.9959s
	iters: 400, epoch: 6 | loss: 0.1462175
	speed: 0.0201s/iter; left time: 163.9870s
	iters: 500, epoch: 6 | loss: 0.4035866
	speed: 0.0201s/iter; left time: 161.8892s
Epoch: 6 cost time: 11.723269939422607
Epoch: 6, Steps: 570 | Train Loss: 0.2464073 Vali Loss: 0.0556610 Test Loss: 0.1731257
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2115248
	speed: 0.0567s/iter; left time: 446.5768s
	iters: 200, epoch: 7 | loss: 0.3273707
	speed: 0.0200s/iter; left time: 155.5889s
	iters: 300, epoch: 7 | loss: 0.3126281
	speed: 0.0200s/iter; left time: 153.4172s
	iters: 400, epoch: 7 | loss: 0.4610308
	speed: 0.0200s/iter; left time: 151.4405s
	iters: 500, epoch: 7 | loss: 0.1815297
	speed: 0.0200s/iter; left time: 149.5562s
Epoch: 7 cost time: 11.62691593170166
Epoch: 7, Steps: 570 | Train Loss: 0.2437776 Vali Loss: 0.0554284 Test Loss: 0.1713108
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3402585
	speed: 0.0566s/iter; left time: 413.4938s
	iters: 200, epoch: 8 | loss: 0.3900384
	speed: 0.0201s/iter; left time: 144.9008s
	iters: 300, epoch: 8 | loss: 0.3811193
	speed: 0.0201s/iter; left time: 142.9068s
	iters: 400, epoch: 8 | loss: 0.1879843
	speed: 0.0201s/iter; left time: 140.8839s
	iters: 500, epoch: 8 | loss: 0.2334775
	speed: 0.0201s/iter; left time: 138.7178s
Epoch: 8 cost time: 11.695987224578857
Epoch: 8, Steps: 570 | Train Loss: 0.2406441 Vali Loss: 0.0551068 Test Loss: 0.1698717
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17318123579025269, mae:0.261086642742157
>>> S LR=1e-3 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2226731
	speed: 0.0236s/iter; left time: 266.7575s
	iters: 200, epoch: 1 | loss: 0.1906027
	speed: 0.0119s/iter; left time: 133.0231s
	iters: 300, epoch: 1 | loss: 0.2094894
	speed: 0.0108s/iter; left time: 119.7707s
	iters: 400, epoch: 1 | loss: 0.2150686
	speed: 0.0105s/iter; left time: 115.7214s
	iters: 500, epoch: 1 | loss: 0.1762017
	speed: 0.0105s/iter; left time: 114.8742s
Epoch: 1 cost time: 7.520275115966797
Epoch: 1, Steps: 570 | Train Loss: 0.2516048 Vali Loss: 0.0480187 Test Loss: 0.1557052
Validation loss decreased (inf --> 0.048019).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3756790
	speed: 0.0351s/iter; left time: 376.2116s
	iters: 200, epoch: 2 | loss: 0.2826259
	speed: 0.0105s/iter; left time: 111.7288s
	iters: 300, epoch: 2 | loss: 0.1982867
	speed: 0.0105s/iter; left time: 110.8102s
	iters: 400, epoch: 2 | loss: 0.1610164
	speed: 0.0105s/iter; left time: 109.5719s
	iters: 500, epoch: 2 | loss: 0.2021079
	speed: 0.0105s/iter; left time: 108.6825s
Epoch: 2 cost time: 6.253027439117432
Epoch: 2, Steps: 570 | Train Loss: 0.2253780 Vali Loss: 0.0494280 Test Loss: 0.1615536
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2118310
	speed: 0.0351s/iter; left time: 356.3594s
	iters: 200, epoch: 3 | loss: 0.2382188
	speed: 0.0105s/iter; left time: 105.4716s
	iters: 300, epoch: 3 | loss: 0.2007435
	speed: 0.0105s/iter; left time: 104.4000s
	iters: 400, epoch: 3 | loss: 0.2144563
	speed: 0.0105s/iter; left time: 103.6523s
	iters: 500, epoch: 3 | loss: 0.2408959
	speed: 0.0105s/iter; left time: 102.5248s
Epoch: 3 cost time: 6.254520416259766
Epoch: 3, Steps: 570 | Train Loss: 0.2046902 Vali Loss: 0.0402581 Test Loss: 0.1243518
Validation loss decreased (0.048019 --> 0.040258).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1922467
	speed: 0.0358s/iter; left time: 343.2227s
	iters: 200, epoch: 4 | loss: 0.1191364
	speed: 0.0104s/iter; left time: 99.0901s
	iters: 300, epoch: 4 | loss: 0.2143496
	speed: 0.0104s/iter; left time: 97.8694s
	iters: 400, epoch: 4 | loss: 0.2084273
	speed: 0.0104s/iter; left time: 96.7854s
	iters: 500, epoch: 4 | loss: 0.1844602
	speed: 0.0104s/iter; left time: 95.8846s
Epoch: 4 cost time: 6.196257829666138
Epoch: 4, Steps: 570 | Train Loss: 0.1930620 Vali Loss: 0.0399663 Test Loss: 0.1236363
Validation loss decreased (0.040258 --> 0.039966).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1783594
	speed: 0.0369s/iter; left time: 332.7508s
	iters: 200, epoch: 5 | loss: 0.1658951
	speed: 0.0107s/iter; left time: 95.0861s
	iters: 300, epoch: 5 | loss: 0.1365688
	speed: 0.0104s/iter; left time: 92.0197s
	iters: 400, epoch: 5 | loss: 0.1792171
	speed: 0.0104s/iter; left time: 90.9553s
	iters: 500, epoch: 5 | loss: 0.2105411
	speed: 0.0104s/iter; left time: 89.8893s
Epoch: 5 cost time: 6.330773830413818
Epoch: 5, Steps: 570 | Train Loss: 0.1843457 Vali Loss: 0.0396635 Test Loss: 0.1279428
Validation loss decreased (0.039966 --> 0.039663).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1519439
	speed: 0.0342s/iter; left time: 289.1622s
	iters: 200, epoch: 6 | loss: 0.1394107
	speed: 0.0104s/iter; left time: 87.1301s
	iters: 300, epoch: 6 | loss: 0.1921068
	speed: 0.0105s/iter; left time: 86.2956s
	iters: 400, epoch: 6 | loss: 0.1939897
	speed: 0.0105s/iter; left time: 85.3001s
	iters: 500, epoch: 6 | loss: 0.2029983
	speed: 0.0105s/iter; left time: 84.2043s
Epoch: 6 cost time: 6.19648814201355
Epoch: 6, Steps: 570 | Train Loss: 0.1791430 Vali Loss: 0.0394506 Test Loss: 0.1321029
Validation loss decreased (0.039663 --> 0.039451).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2139206
	speed: 0.0345s/iter; left time: 271.8690s
	iters: 200, epoch: 7 | loss: 0.2414051
	speed: 0.0105s/iter; left time: 81.4930s
	iters: 300, epoch: 7 | loss: 0.1530128
	speed: 0.0105s/iter; left time: 80.6410s
	iters: 400, epoch: 7 | loss: 0.1470145
	speed: 0.0105s/iter; left time: 79.4372s
	iters: 500, epoch: 7 | loss: 0.1581501
	speed: 0.0105s/iter; left time: 78.3199s
Epoch: 7 cost time: 6.2082836627960205
Epoch: 7, Steps: 570 | Train Loss: 0.1771262 Vali Loss: 0.0392875 Test Loss: 0.1304671
Validation loss decreased (0.039451 --> 0.039287).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2088446
	speed: 0.0353s/iter; left time: 258.2733s
	iters: 200, epoch: 8 | loss: 0.1899141
	speed: 0.0105s/iter; left time: 76.0036s
	iters: 300, epoch: 8 | loss: 0.2030831
	speed: 0.0105s/iter; left time: 74.8334s
	iters: 400, epoch: 8 | loss: 0.2282670
	speed: 0.0105s/iter; left time: 73.9490s
	iters: 500, epoch: 8 | loss: 0.1191735
	speed: 0.0105s/iter; left time: 72.8821s
Epoch: 8 cost time: 6.24579644203186
Epoch: 8, Steps: 570 | Train Loss: 0.1745081 Vali Loss: 0.0391633 Test Loss: 0.1277980
Validation loss decreased (0.039287 --> 0.039163).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2296453
	speed: 0.0349s/iter; left time: 235.2443s
	iters: 200, epoch: 9 | loss: 0.1960998
	speed: 0.0105s/iter; left time: 69.8207s
	iters: 300, epoch: 9 | loss: 0.0810415
	speed: 0.0105s/iter; left time: 68.9297s
	iters: 400, epoch: 9 | loss: 0.1633809
	speed: 0.0105s/iter; left time: 67.7480s
	iters: 500, epoch: 9 | loss: 0.1560430
	speed: 0.0105s/iter; left time: 66.5483s
Epoch: 9 cost time: 6.240513563156128
Epoch: 9, Steps: 570 | Train Loss: 0.1731820 Vali Loss: 0.0395674 Test Loss: 0.1278223
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1452659
	speed: 0.0356s/iter; left time: 219.6454s
	iters: 200, epoch: 10 | loss: 0.1640691
	speed: 0.0107s/iter; left time: 64.8817s
	iters: 300, epoch: 10 | loss: 0.1161029
	speed: 0.0105s/iter; left time: 62.9391s
	iters: 400, epoch: 10 | loss: 0.1314586
	speed: 0.0106s/iter; left time: 61.9472s
	iters: 500, epoch: 10 | loss: 0.2536583
	speed: 0.0106s/iter; left time: 61.0099s
Epoch: 10 cost time: 6.411479711532593
Epoch: 10, Steps: 570 | Train Loss: 0.1721134 Vali Loss: 0.0395073 Test Loss: 0.1292840
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1920632
	speed: 0.0357s/iter; left time: 199.7673s
	iters: 200, epoch: 11 | loss: 0.1514978
	speed: 0.0105s/iter; left time: 57.9208s
	iters: 300, epoch: 11 | loss: 0.1427976
	speed: 0.0105s/iter; left time: 56.9547s
	iters: 400, epoch: 11 | loss: 0.2539229
	speed: 0.0105s/iter; left time: 55.6836s
	iters: 500, epoch: 11 | loss: 0.1585963
	speed: 0.0105s/iter; left time: 54.6228s
Epoch: 11 cost time: 6.214465856552124
Epoch: 11, Steps: 570 | Train Loss: 0.1731384 Vali Loss: 0.0393060 Test Loss: 0.1296940
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12789979577064514, mae:0.2199322134256363
>>> S LR=1e-3 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2446198
	speed: 0.0216s/iter; left time: 243.8723s
	iters: 200, epoch: 1 | loss: 0.2435044
	speed: 0.0101s/iter; left time: 113.6557s
	iters: 300, epoch: 1 | loss: 0.2951260
	speed: 0.0102s/iter; left time: 112.8063s
	iters: 400, epoch: 1 | loss: 0.2155223
	speed: 0.0101s/iter; left time: 111.5472s
	iters: 500, epoch: 1 | loss: 0.2083226
	speed: 0.0102s/iter; left time: 110.7909s
Epoch: 1 cost time: 6.980377674102783
Epoch: 1, Steps: 570 | Train Loss: 0.2213250 Vali Loss: 0.0367456 Test Loss: 0.1329502
Validation loss decreased (inf --> 0.036746).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1687016
	speed: 0.0375s/iter; left time: 401.9597s
	iters: 200, epoch: 2 | loss: 0.2289487
	speed: 0.0115s/iter; left time: 122.0713s
	iters: 300, epoch: 2 | loss: 0.1604917
	speed: 0.0115s/iter; left time: 121.2462s
	iters: 400, epoch: 2 | loss: 0.1573581
	speed: 0.0115s/iter; left time: 119.8672s
	iters: 500, epoch: 2 | loss: 0.1971907
	speed: 0.0109s/iter; left time: 112.6385s
Epoch: 2 cost time: 6.656487941741943
Epoch: 2, Steps: 570 | Train Loss: 0.1975856 Vali Loss: 0.0366869 Test Loss: 0.1247131
Validation loss decreased (0.036746 --> 0.036687).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1005009
	speed: 0.0353s/iter; left time: 359.0729s
	iters: 200, epoch: 3 | loss: 0.1776252
	speed: 0.0102s/iter; left time: 102.8288s
	iters: 300, epoch: 3 | loss: 0.3371784
	speed: 0.0102s/iter; left time: 102.0698s
	iters: 400, epoch: 3 | loss: 0.1966618
	speed: 0.0102s/iter; left time: 100.6985s
	iters: 500, epoch: 3 | loss: 0.1286503
	speed: 0.0102s/iter; left time: 99.6777s
Epoch: 3 cost time: 6.062711238861084
Epoch: 3, Steps: 570 | Train Loss: 0.1787428 Vali Loss: 0.0328711 Test Loss: 0.1163147
Validation loss decreased (0.036687 --> 0.032871).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1271588
	speed: 0.0338s/iter; left time: 324.2262s
	iters: 200, epoch: 4 | loss: 0.1635066
	speed: 0.0102s/iter; left time: 97.0396s
	iters: 300, epoch: 4 | loss: 0.1054928
	speed: 0.0102s/iter; left time: 95.8442s
	iters: 400, epoch: 4 | loss: 0.1163836
	speed: 0.0102s/iter; left time: 95.2310s
	iters: 500, epoch: 4 | loss: 0.2095912
	speed: 0.0103s/iter; left time: 94.3957s
Epoch: 4 cost time: 6.050769329071045
Epoch: 4, Steps: 570 | Train Loss: 0.1661979 Vali Loss: 0.0316742 Test Loss: 0.1080597
Validation loss decreased (0.032871 --> 0.031674).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1384676
	speed: 0.0335s/iter; left time: 302.5278s
	iters: 200, epoch: 5 | loss: 0.2003116
	speed: 0.0102s/iter; left time: 91.0236s
	iters: 300, epoch: 5 | loss: 0.1622313
	speed: 0.0102s/iter; left time: 90.1673s
	iters: 400, epoch: 5 | loss: 0.1464418
	speed: 0.0102s/iter; left time: 88.9826s
	iters: 500, epoch: 5 | loss: 0.1528816
	speed: 0.0102s/iter; left time: 87.9000s
Epoch: 5 cost time: 6.057619094848633
Epoch: 5, Steps: 570 | Train Loss: 0.1598288 Vali Loss: 0.0321274 Test Loss: 0.1083443
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1223544
	speed: 0.0342s/iter; left time: 288.9385s
	iters: 200, epoch: 6 | loss: 0.1968184
	speed: 0.0101s/iter; left time: 84.3514s
	iters: 300, epoch: 6 | loss: 0.1461973
	speed: 0.0101s/iter; left time: 83.6885s
	iters: 400, epoch: 6 | loss: 0.1315832
	speed: 0.0101s/iter; left time: 82.6449s
	iters: 500, epoch: 6 | loss: 0.0882104
	speed: 0.0101s/iter; left time: 81.3715s
Epoch: 6 cost time: 5.980365514755249
Epoch: 6, Steps: 570 | Train Loss: 0.1553285 Vali Loss: 0.0319298 Test Loss: 0.1083484
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1495831
	speed: 0.0336s/iter; left time: 264.8145s
	iters: 200, epoch: 7 | loss: 0.1849293
	speed: 0.0102s/iter; left time: 79.7230s
	iters: 300, epoch: 7 | loss: 0.2784343
	speed: 0.0102s/iter; left time: 78.6869s
	iters: 400, epoch: 7 | loss: 0.2060453
	speed: 0.0102s/iter; left time: 77.6297s
	iters: 500, epoch: 7 | loss: 0.1626484
	speed: 0.0102s/iter; left time: 76.3667s
Epoch: 7 cost time: 6.0673298835754395
Epoch: 7, Steps: 570 | Train Loss: 0.1533558 Vali Loss: 0.0313677 Test Loss: 0.1079436
Validation loss decreased (0.031674 --> 0.031368).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1351490
	speed: 0.0357s/iter; left time: 260.8542s
	iters: 200, epoch: 8 | loss: 0.1404694
	speed: 0.0115s/iter; left time: 82.7436s
	iters: 300, epoch: 8 | loss: 0.1317925
	speed: 0.0115s/iter; left time: 81.7325s
	iters: 400, epoch: 8 | loss: 0.1512038
	speed: 0.0115s/iter; left time: 80.8422s
	iters: 500, epoch: 8 | loss: 0.0976539
	speed: 0.0115s/iter; left time: 79.4192s
Epoch: 8 cost time: 6.816596508026123
Epoch: 8, Steps: 570 | Train Loss: 0.1530255 Vali Loss: 0.0312755 Test Loss: 0.1081254
Validation loss decreased (0.031368 --> 0.031276).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1442166
	speed: 0.0352s/iter; left time: 237.0402s
	iters: 200, epoch: 9 | loss: 0.1581034
	speed: 0.0102s/iter; left time: 67.8610s
	iters: 300, epoch: 9 | loss: 0.1280670
	speed: 0.0102s/iter; left time: 66.8629s
	iters: 400, epoch: 9 | loss: 0.1797208
	speed: 0.0102s/iter; left time: 65.7925s
	iters: 500, epoch: 9 | loss: 0.1195776
	speed: 0.0102s/iter; left time: 64.6788s
Epoch: 9 cost time: 6.063703298568726
Epoch: 9, Steps: 570 | Train Loss: 0.1511403 Vali Loss: 0.0312588 Test Loss: 0.1080324
Validation loss decreased (0.031276 --> 0.031259).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1806561
	speed: 0.0342s/iter; left time: 210.9520s
	iters: 200, epoch: 10 | loss: 0.1271012
	speed: 0.0102s/iter; left time: 62.0548s
	iters: 300, epoch: 10 | loss: 0.1260981
	speed: 0.0102s/iter; left time: 60.9581s
	iters: 400, epoch: 10 | loss: 0.0994405
	speed: 0.0102s/iter; left time: 59.8821s
	iters: 500, epoch: 10 | loss: 0.1134966
	speed: 0.0102s/iter; left time: 58.8277s
Epoch: 10 cost time: 6.049844264984131
Epoch: 10, Steps: 570 | Train Loss: 0.1525344 Vali Loss: 0.0311893 Test Loss: 0.1079623
Validation loss decreased (0.031259 --> 0.031189).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1492839
	speed: 0.0354s/iter; left time: 198.4789s
	iters: 200, epoch: 11 | loss: 0.1452804
	speed: 0.0103s/iter; left time: 56.5319s
	iters: 300, epoch: 11 | loss: 0.1831701
	speed: 0.0103s/iter; left time: 55.3982s
	iters: 400, epoch: 11 | loss: 0.1511809
	speed: 0.0102s/iter; left time: 54.3062s
	iters: 500, epoch: 11 | loss: 0.1479897
	speed: 0.0102s/iter; left time: 53.2964s
Epoch: 11 cost time: 6.095242738723755
Epoch: 11, Steps: 570 | Train Loss: 0.1504843 Vali Loss: 0.0310894 Test Loss: 0.1079636
Validation loss decreased (0.031189 --> 0.031089).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1235462
	speed: 0.0353s/iter; left time: 177.4028s
	iters: 200, epoch: 12 | loss: 0.1437029
	speed: 0.0101s/iter; left time: 49.6353s
	iters: 300, epoch: 12 | loss: 0.1221061
	speed: 0.0101s/iter; left time: 48.6065s
	iters: 400, epoch: 12 | loss: 0.2206008
	speed: 0.0101s/iter; left time: 47.6054s
	iters: 500, epoch: 12 | loss: 0.1337788
	speed: 0.0101s/iter; left time: 46.5941s
Epoch: 12 cost time: 5.964561462402344
Epoch: 12, Steps: 570 | Train Loss: 0.1513719 Vali Loss: 0.0311250 Test Loss: 0.1079416
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2512099
	speed: 0.0328s/iter; left time: 146.2804s
	iters: 200, epoch: 13 | loss: 0.2116281
	speed: 0.0101s/iter; left time: 44.0464s
	iters: 300, epoch: 13 | loss: 0.1250720
	speed: 0.0101s/iter; left time: 43.0281s
	iters: 400, epoch: 13 | loss: 0.1529608
	speed: 0.0101s/iter; left time: 42.0221s
	iters: 500, epoch: 13 | loss: 0.1867017
	speed: 0.0101s/iter; left time: 41.0102s
Epoch: 13 cost time: 5.968718767166138
Epoch: 13, Steps: 570 | Train Loss: 0.1515452 Vali Loss: 0.0310981 Test Loss: 0.1079342
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1447711
	speed: 0.0336s/iter; left time: 130.8431s
	iters: 200, epoch: 14 | loss: 0.1128707
	speed: 0.0101s/iter; left time: 38.1950s
	iters: 300, epoch: 14 | loss: 0.1512444
	speed: 0.0101s/iter; left time: 37.1588s
	iters: 400, epoch: 14 | loss: 0.1479908
	speed: 0.0101s/iter; left time: 36.1836s
	iters: 500, epoch: 14 | loss: 0.1572576
	speed: 0.0101s/iter; left time: 35.1618s
Epoch: 14 cost time: 5.969862699508667
Epoch: 14, Steps: 570 | Train Loss: 0.1515455 Vali Loss: 0.0311727 Test Loss: 0.1079317
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10810966789722443, mae:0.19766174256801605
>>> S LR=1e-3 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2660682
	speed: 0.0218s/iter; left time: 246.7489s
	iters: 200, epoch: 1 | loss: 0.1693269
	speed: 0.0108s/iter; left time: 121.5160s
	iters: 300, epoch: 1 | loss: 0.1906741
	speed: 0.0117s/iter; left time: 130.3345s
	iters: 400, epoch: 1 | loss: 0.1905196
	speed: 0.0117s/iter; left time: 128.4567s
	iters: 500, epoch: 1 | loss: 0.2344653
	speed: 0.0117s/iter; left time: 127.0609s
Epoch: 1 cost time: 7.641290903091431
Epoch: 1, Steps: 570 | Train Loss: 0.2626196 Vali Loss: 0.0475199 Test Loss: 0.1494095
Validation loss decreased (inf --> 0.047520).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2437057
	speed: 0.0367s/iter; left time: 393.5223s
	iters: 200, epoch: 2 | loss: 0.3027178
	speed: 0.0117s/iter; left time: 124.4404s
	iters: 300, epoch: 2 | loss: 0.2372929
	speed: 0.0117s/iter; left time: 123.4111s
	iters: 400, epoch: 2 | loss: 0.3774273
	speed: 0.0117s/iter; left time: 122.0473s
	iters: 500, epoch: 2 | loss: 0.2704546
	speed: 0.0117s/iter; left time: 120.8935s
Epoch: 2 cost time: 6.923299789428711
Epoch: 2, Steps: 570 | Train Loss: 0.2401020 Vali Loss: 0.0465378 Test Loss: 0.1525921
Validation loss decreased (0.047520 --> 0.046538).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1575443
	speed: 0.0373s/iter; left time: 379.0449s
	iters: 200, epoch: 3 | loss: 0.1864511
	speed: 0.0116s/iter; left time: 116.9279s
	iters: 300, epoch: 3 | loss: 0.3216494
	speed: 0.0117s/iter; left time: 116.2807s
	iters: 400, epoch: 3 | loss: 0.1967442
	speed: 0.0117s/iter; left time: 115.0915s
	iters: 500, epoch: 3 | loss: 0.1536129
	speed: 0.0116s/iter; left time: 113.5689s
Epoch: 3 cost time: 6.890770435333252
Epoch: 3, Steps: 570 | Train Loss: 0.2225716 Vali Loss: 0.0419425 Test Loss: 0.1460935
Validation loss decreased (0.046538 --> 0.041943).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1312607
	speed: 0.0382s/iter; left time: 366.0896s
	iters: 200, epoch: 4 | loss: 0.1265954
	speed: 0.0117s/iter; left time: 111.1853s
	iters: 300, epoch: 4 | loss: 0.1559231
	speed: 0.0117s/iter; left time: 110.0301s
	iters: 400, epoch: 4 | loss: 0.2755484
	speed: 0.0117s/iter; left time: 108.9843s
	iters: 500, epoch: 4 | loss: 0.1681161
	speed: 0.0117s/iter; left time: 107.7179s
Epoch: 4 cost time: 6.9298176765441895
Epoch: 4, Steps: 570 | Train Loss: 0.2078774 Vali Loss: 0.0411023 Test Loss: 0.1391546
Validation loss decreased (0.041943 --> 0.041102).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1718396
	speed: 0.0368s/iter; left time: 332.0753s
	iters: 200, epoch: 5 | loss: 0.1291070
	speed: 0.0115s/iter; left time: 102.2394s
	iters: 300, epoch: 5 | loss: 0.2391541
	speed: 0.0115s/iter; left time: 101.1031s
	iters: 400, epoch: 5 | loss: 0.1824306
	speed: 0.0113s/iter; left time: 98.4978s
	iters: 500, epoch: 5 | loss: 0.2909686
	speed: 0.0102s/iter; left time: 87.7329s
Epoch: 5 cost time: 6.556062698364258
Epoch: 5, Steps: 570 | Train Loss: 0.2001440 Vali Loss: 0.0389841 Test Loss: 0.1337018
Validation loss decreased (0.041102 --> 0.038984).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1470512
	speed: 0.0352s/iter; left time: 297.7154s
	iters: 200, epoch: 6 | loss: 0.2180433
	speed: 0.0103s/iter; left time: 85.7241s
	iters: 300, epoch: 6 | loss: 0.1530368
	speed: 0.0103s/iter; left time: 84.8135s
	iters: 400, epoch: 6 | loss: 0.1454392
	speed: 0.0103s/iter; left time: 83.7470s
	iters: 500, epoch: 6 | loss: 0.2070185
	speed: 0.0103s/iter; left time: 82.7144s
Epoch: 6 cost time: 6.066167116165161
Epoch: 6, Steps: 570 | Train Loss: 0.1942823 Vali Loss: 0.0384393 Test Loss: 0.1319318
Validation loss decreased (0.038984 --> 0.038439).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1411200
	speed: 0.0338s/iter; left time: 266.4178s
	iters: 200, epoch: 7 | loss: 0.1709549
	speed: 0.0101s/iter; left time: 78.6331s
	iters: 300, epoch: 7 | loss: 0.1712643
	speed: 0.0101s/iter; left time: 77.5112s
	iters: 400, epoch: 7 | loss: 0.1105167
	speed: 0.0101s/iter; left time: 76.4723s
	iters: 500, epoch: 7 | loss: 0.2218263
	speed: 0.0101s/iter; left time: 75.5199s
Epoch: 7 cost time: 5.995499610900879
Epoch: 7, Steps: 570 | Train Loss: 0.1910035 Vali Loss: 0.0382844 Test Loss: 0.1311952
Validation loss decreased (0.038439 --> 0.038284).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1506788
	speed: 0.0358s/iter; left time: 261.9443s
	iters: 200, epoch: 8 | loss: 0.1625210
	speed: 0.0115s/iter; left time: 82.9370s
	iters: 300, epoch: 8 | loss: 0.1985765
	speed: 0.0115s/iter; left time: 81.6968s
	iters: 400, epoch: 8 | loss: 0.2155637
	speed: 0.0115s/iter; left time: 80.3553s
	iters: 500, epoch: 8 | loss: 0.2030311
	speed: 0.0110s/iter; left time: 75.9301s
Epoch: 8 cost time: 6.675723314285278
Epoch: 8, Steps: 570 | Train Loss: 0.1900730 Vali Loss: 0.0380970 Test Loss: 0.1320468
Validation loss decreased (0.038284 --> 0.038097).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1591954
	speed: 0.0343s/iter; left time: 230.9113s
	iters: 200, epoch: 9 | loss: 0.2318405
	speed: 0.0102s/iter; left time: 67.6717s
	iters: 300, epoch: 9 | loss: 0.1695872
	speed: 0.0102s/iter; left time: 66.4762s
	iters: 400, epoch: 9 | loss: 0.1415832
	speed: 0.0102s/iter; left time: 65.4427s
	iters: 500, epoch: 9 | loss: 0.2085023
	speed: 0.0101s/iter; left time: 64.3590s
Epoch: 9 cost time: 6.059864282608032
Epoch: 9, Steps: 570 | Train Loss: 0.1888903 Vali Loss: 0.0381836 Test Loss: 0.1325110
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1698002
	speed: 0.0343s/iter; left time: 211.5479s
	iters: 200, epoch: 10 | loss: 0.2320400
	speed: 0.0102s/iter; left time: 61.7711s
	iters: 300, epoch: 10 | loss: 0.2630419
	speed: 0.0101s/iter; left time: 60.6035s
	iters: 400, epoch: 10 | loss: 0.2423816
	speed: 0.0102s/iter; left time: 59.5929s
	iters: 500, epoch: 10 | loss: 0.2010077
	speed: 0.0102s/iter; left time: 58.6255s
Epoch: 10 cost time: 6.025569438934326
Epoch: 10, Steps: 570 | Train Loss: 0.1889351 Vali Loss: 0.0381615 Test Loss: 0.1320835
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2161814
	speed: 0.0343s/iter; left time: 192.0762s
	iters: 200, epoch: 11 | loss: 0.1313674
	speed: 0.0102s/iter; left time: 56.3520s
	iters: 300, epoch: 11 | loss: 0.2768868
	speed: 0.0102s/iter; left time: 55.3149s
	iters: 400, epoch: 11 | loss: 0.2275088
	speed: 0.0102s/iter; left time: 54.3248s
	iters: 500, epoch: 11 | loss: 0.2479208
	speed: 0.0102s/iter; left time: 53.2764s
Epoch: 11 cost time: 6.049422264099121
Epoch: 11, Steps: 570 | Train Loss: 0.1900182 Vali Loss: 0.0380152 Test Loss: 0.1320720
Validation loss decreased (0.038097 --> 0.038015).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1862836
	speed: 0.0349s/iter; left time: 175.4954s
	iters: 200, epoch: 12 | loss: 0.1430129
	speed: 0.0102s/iter; left time: 50.2757s
	iters: 300, epoch: 12 | loss: 0.1365152
	speed: 0.0102s/iter; left time: 49.1560s
	iters: 400, epoch: 12 | loss: 0.2028909
	speed: 0.0101s/iter; left time: 47.9192s
	iters: 500, epoch: 12 | loss: 0.1238194
	speed: 0.0101s/iter; left time: 46.9907s
Epoch: 12 cost time: 6.042683362960815
Epoch: 12, Steps: 570 | Train Loss: 0.1895570 Vali Loss: 0.0380038 Test Loss: 0.1321554
Validation loss decreased (0.038015 --> 0.038004).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1520563
	speed: 0.0339s/iter; left time: 151.4145s
	iters: 200, epoch: 13 | loss: 0.1639698
	speed: 0.0101s/iter; left time: 44.1621s
	iters: 300, epoch: 13 | loss: 0.1921784
	speed: 0.0101s/iter; left time: 43.2193s
	iters: 400, epoch: 13 | loss: 0.2116618
	speed: 0.0102s/iter; left time: 42.2915s
	iters: 500, epoch: 13 | loss: 0.1965096
	speed: 0.0102s/iter; left time: 41.3268s
Epoch: 13 cost time: 6.036797523498535
Epoch: 13, Steps: 570 | Train Loss: 0.1892123 Vali Loss: 0.0380508 Test Loss: 0.1321350
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1925024
	speed: 0.0352s/iter; left time: 137.1061s
	iters: 200, epoch: 14 | loss: 0.2553267
	speed: 0.0115s/iter; left time: 43.4669s
	iters: 300, epoch: 14 | loss: 0.1602431
	speed: 0.0115s/iter; left time: 42.3125s
	iters: 400, epoch: 14 | loss: 0.1317311
	speed: 0.0115s/iter; left time: 41.3188s
	iters: 500, epoch: 14 | loss: 0.2303694
	speed: 0.0115s/iter; left time: 40.1609s
Epoch: 14 cost time: 6.78335428237915
Epoch: 14, Steps: 570 | Train Loss: 0.1894054 Vali Loss: 0.0380278 Test Loss: 0.1321359
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1362313
	speed: 0.0359s/iter; left time: 119.0686s
	iters: 200, epoch: 15 | loss: 0.2785715
	speed: 0.0115s/iter; left time: 36.8967s
	iters: 300, epoch: 15 | loss: 0.1011886
	speed: 0.0115s/iter; left time: 35.8896s
	iters: 400, epoch: 15 | loss: 0.0986375
	speed: 0.0115s/iter; left time: 34.6557s
	iters: 500, epoch: 15 | loss: 0.2559967
	speed: 0.0115s/iter; left time: 33.4782s
Epoch: 15 cost time: 6.767422676086426
Epoch: 15, Steps: 570 | Train Loss: 0.1881664 Vali Loss: 0.0380415 Test Loss: 0.1321340
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13223038613796234, mae:0.23122331500053406
>>> S LR=1e-3 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2941110
	speed: 0.0235s/iter; left time: 265.0678s
	iters: 200, epoch: 1 | loss: 0.2762068
	speed: 0.0118s/iter; left time: 131.7540s
	iters: 300, epoch: 1 | loss: 0.1627241
	speed: 0.0118s/iter; left time: 130.7462s
	iters: 400, epoch: 1 | loss: 0.1528050
	speed: 0.0118s/iter; left time: 129.4559s
	iters: 500, epoch: 1 | loss: 0.2623441
	speed: 0.0118s/iter; left time: 128.3349s
Epoch: 1 cost time: 7.91428279876709
Epoch: 1, Steps: 570 | Train Loss: 0.2945618 Vali Loss: 0.0650868 Test Loss: 0.1933295
Validation loss decreased (inf --> 0.065087).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2426928
	speed: 0.0380s/iter; left time: 407.2809s
	iters: 200, epoch: 2 | loss: 0.2537145
	speed: 0.0118s/iter; left time: 125.2128s
	iters: 300, epoch: 2 | loss: 0.2426092
	speed: 0.0118s/iter; left time: 123.8635s
	iters: 400, epoch: 2 | loss: 0.1762898
	speed: 0.0118s/iter; left time: 122.7430s
	iters: 500, epoch: 2 | loss: 0.2969534
	speed: 0.0118s/iter; left time: 121.5007s
Epoch: 2 cost time: 6.976510286331177
Epoch: 2, Steps: 570 | Train Loss: 0.2883669 Vali Loss: 0.0549281 Test Loss: 0.1709318
Validation loss decreased (0.065087 --> 0.054928).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3567999
	speed: 0.0376s/iter; left time: 381.8681s
	iters: 200, epoch: 3 | loss: 0.2997599
	speed: 0.0117s/iter; left time: 117.8186s
	iters: 300, epoch: 3 | loss: 0.1744779
	speed: 0.0118s/iter; left time: 117.2100s
	iters: 400, epoch: 3 | loss: 0.2015664
	speed: 0.0117s/iter; left time: 115.8414s
	iters: 500, epoch: 3 | loss: 0.1609301
	speed: 0.0117s/iter; left time: 114.6897s
Epoch: 3 cost time: 6.960862636566162
Epoch: 3, Steps: 570 | Train Loss: 0.2545930 Vali Loss: 0.0499927 Test Loss: 0.1558147
Validation loss decreased (0.054928 --> 0.049993).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1783927
	speed: 0.0374s/iter; left time: 358.7035s
	iters: 200, epoch: 4 | loss: 0.2805371
	speed: 0.0118s/iter; left time: 111.7431s
	iters: 300, epoch: 4 | loss: 0.1468607
	speed: 0.0118s/iter; left time: 111.0194s
	iters: 400, epoch: 4 | loss: 0.2078333
	speed: 0.0118s/iter; left time: 109.4639s
	iters: 500, epoch: 4 | loss: 0.2118690
	speed: 0.0118s/iter; left time: 108.0052s
Epoch: 4 cost time: 6.968640565872192
Epoch: 4, Steps: 570 | Train Loss: 0.2351641 Vali Loss: 0.0449926 Test Loss: 0.1439097
Validation loss decreased (0.049993 --> 0.044993).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1984972
	speed: 0.0378s/iter; left time: 340.8051s
	iters: 200, epoch: 5 | loss: 0.1982099
	speed: 0.0117s/iter; left time: 104.5333s
	iters: 300, epoch: 5 | loss: 0.2537217
	speed: 0.0117s/iter; left time: 103.5424s
	iters: 400, epoch: 5 | loss: 0.1882723
	speed: 0.0117s/iter; left time: 102.0765s
	iters: 500, epoch: 5 | loss: 0.1903287
	speed: 0.0117s/iter; left time: 101.0327s
Epoch: 5 cost time: 6.918283462524414
Epoch: 5, Steps: 570 | Train Loss: 0.2216430 Vali Loss: 0.0434285 Test Loss: 0.1416130
Validation loss decreased (0.044993 --> 0.043429).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1999889
	speed: 0.0383s/iter; left time: 323.5457s
	iters: 200, epoch: 6 | loss: 0.1031051
	speed: 0.0117s/iter; left time: 98.0348s
	iters: 300, epoch: 6 | loss: 0.2117543
	speed: 0.0118s/iter; left time: 97.1296s
	iters: 400, epoch: 6 | loss: 0.2319951
	speed: 0.0117s/iter; left time: 95.3797s
	iters: 500, epoch: 6 | loss: 0.1732791
	speed: 0.0117s/iter; left time: 94.1490s
Epoch: 6 cost time: 6.940977096557617
Epoch: 6, Steps: 570 | Train Loss: 0.2147590 Vali Loss: 0.0429791 Test Loss: 0.1371619
Validation loss decreased (0.043429 --> 0.042979).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2302068
	speed: 0.0375s/iter; left time: 295.3935s
	iters: 200, epoch: 7 | loss: 0.1997940
	speed: 0.0118s/iter; left time: 91.5488s
	iters: 300, epoch: 7 | loss: 0.2353676
	speed: 0.0118s/iter; left time: 90.2761s
	iters: 400, epoch: 7 | loss: 0.1706432
	speed: 0.0118s/iter; left time: 89.1594s
	iters: 500, epoch: 7 | loss: 0.1837231
	speed: 0.0128s/iter; left time: 95.6991s
Epoch: 7 cost time: 7.132363796234131
Epoch: 7, Steps: 570 | Train Loss: 0.2099241 Vali Loss: 0.0419378 Test Loss: 0.1354003
Validation loss decreased (0.042979 --> 0.041938).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1387734
	speed: 0.0389s/iter; left time: 284.2108s
	iters: 200, epoch: 8 | loss: 0.1838024
	speed: 0.0118s/iter; left time: 84.9884s
	iters: 300, epoch: 8 | loss: 0.1860376
	speed: 0.0118s/iter; left time: 83.6997s
	iters: 400, epoch: 8 | loss: 0.1944399
	speed: 0.0118s/iter; left time: 82.4744s
	iters: 500, epoch: 8 | loss: 0.1401376
	speed: 0.0118s/iter; left time: 81.3135s
Epoch: 8 cost time: 6.946107387542725
Epoch: 8, Steps: 570 | Train Loss: 0.2086033 Vali Loss: 0.0415194 Test Loss: 0.1330457
Validation loss decreased (0.041938 --> 0.041519).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1444346
	speed: 0.0368s/iter; left time: 248.0313s
	iters: 200, epoch: 9 | loss: 0.2209027
	speed: 0.0117s/iter; left time: 77.9020s
	iters: 300, epoch: 9 | loss: 0.1893307
	speed: 0.0117s/iter; left time: 76.6212s
	iters: 400, epoch: 9 | loss: 0.1535414
	speed: 0.0117s/iter; left time: 75.4400s
	iters: 500, epoch: 9 | loss: 0.2381549
	speed: 0.0117s/iter; left time: 74.3085s
Epoch: 9 cost time: 6.940724849700928
Epoch: 9, Steps: 570 | Train Loss: 0.2080162 Vali Loss: 0.0411754 Test Loss: 0.1326317
Validation loss decreased (0.041519 --> 0.041175).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1568812
	speed: 0.0384s/iter; left time: 236.8659s
	iters: 200, epoch: 10 | loss: 0.2687233
	speed: 0.0118s/iter; left time: 71.4629s
	iters: 300, epoch: 10 | loss: 0.1729193
	speed: 0.0118s/iter; left time: 70.4336s
	iters: 400, epoch: 10 | loss: 0.2040195
	speed: 0.0118s/iter; left time: 69.1880s
	iters: 500, epoch: 10 | loss: 0.2599980
	speed: 0.0118s/iter; left time: 67.9875s
Epoch: 10 cost time: 6.974149227142334
Epoch: 10, Steps: 570 | Train Loss: 0.2061770 Vali Loss: 0.0411199 Test Loss: 0.1322309
Validation loss decreased (0.041175 --> 0.041120).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1670686
	speed: 0.0373s/iter; left time: 209.1355s
	iters: 200, epoch: 11 | loss: 0.3671489
	speed: 0.0118s/iter; left time: 64.8240s
	iters: 300, epoch: 11 | loss: 0.2232967
	speed: 0.0118s/iter; left time: 63.6627s
	iters: 400, epoch: 11 | loss: 0.2476510
	speed: 0.0118s/iter; left time: 62.5098s
	iters: 500, epoch: 11 | loss: 0.3026420
	speed: 0.0118s/iter; left time: 61.2904s
Epoch: 11 cost time: 6.962463617324829
Epoch: 11, Steps: 570 | Train Loss: 0.2053456 Vali Loss: 0.0411792 Test Loss: 0.1320079
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1729663
	speed: 0.0364s/iter; left time: 183.2897s
	iters: 200, epoch: 12 | loss: 0.1441255
	speed: 0.0117s/iter; left time: 57.8776s
	iters: 300, epoch: 12 | loss: 0.1298021
	speed: 0.0118s/iter; left time: 56.7731s
	iters: 400, epoch: 12 | loss: 0.1666378
	speed: 0.0117s/iter; left time: 55.5643s
	iters: 500, epoch: 12 | loss: 0.1689671
	speed: 0.0118s/iter; left time: 54.4299s
Epoch: 12 cost time: 6.934591293334961
Epoch: 12, Steps: 570 | Train Loss: 0.2061334 Vali Loss: 0.0412523 Test Loss: 0.1318617
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1053528
	speed: 0.0375s/iter; left time: 167.4314s
	iters: 200, epoch: 13 | loss: 0.1769981
	speed: 0.0118s/iter; left time: 51.3078s
	iters: 300, epoch: 13 | loss: 0.1754224
	speed: 0.0118s/iter; left time: 50.1042s
	iters: 400, epoch: 13 | loss: 0.4062275
	speed: 0.0118s/iter; left time: 49.0010s
	iters: 500, epoch: 13 | loss: 0.2351643
	speed: 0.0118s/iter; left time: 47.7480s
Epoch: 13 cost time: 6.984443426132202
Epoch: 13, Steps: 570 | Train Loss: 0.2061400 Vali Loss: 0.0409681 Test Loss: 0.1318313
Validation loss decreased (0.041120 --> 0.040968).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1759298
	speed: 0.0380s/iter; left time: 147.9033s
	iters: 200, epoch: 14 | loss: 0.1767174
	speed: 0.0118s/iter; left time: 44.5670s
	iters: 300, epoch: 14 | loss: 0.3342454
	speed: 0.0117s/iter; left time: 43.3640s
	iters: 400, epoch: 14 | loss: 0.1945470
	speed: 0.0118s/iter; left time: 42.1947s
	iters: 500, epoch: 14 | loss: 0.2060119
	speed: 0.0117s/iter; left time: 41.0042s
Epoch: 14 cost time: 6.954830169677734
Epoch: 14, Steps: 570 | Train Loss: 0.2067198 Vali Loss: 0.0412175 Test Loss: 0.1318233
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1887496
	speed: 0.0383s/iter; left time: 127.0751s
	iters: 200, epoch: 15 | loss: 0.2127199
	speed: 0.0128s/iter; left time: 41.2219s
	iters: 300, epoch: 15 | loss: 0.1762915
	speed: 0.0128s/iter; left time: 40.0094s
	iters: 400, epoch: 15 | loss: 0.1907828
	speed: 0.0128s/iter; left time: 38.6776s
	iters: 500, epoch: 15 | loss: 0.3504187
	speed: 0.0128s/iter; left time: 37.3782s
Epoch: 15 cost time: 7.525797128677368
Epoch: 15, Steps: 570 | Train Loss: 0.2049661 Vali Loss: 0.0409670 Test Loss: 0.1318038
Validation loss decreased (0.040968 --> 0.040967).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.1886222
	speed: 0.0383s/iter; left time: 105.2741s
	iters: 200, epoch: 16 | loss: 0.2637184
	speed: 0.0117s/iter; left time: 31.1257s
	iters: 300, epoch: 16 | loss: 0.2261856
	speed: 0.0117s/iter; left time: 29.9081s
	iters: 400, epoch: 16 | loss: 0.2021352
	speed: 0.0117s/iter; left time: 28.7665s
	iters: 500, epoch: 16 | loss: 0.1703114
	speed: 0.0117s/iter; left time: 27.5794s
Epoch: 16 cost time: 6.954392910003662
Epoch: 16, Steps: 570 | Train Loss: 0.2063869 Vali Loss: 0.0411130 Test Loss: 0.1318063
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.2072212
	speed: 0.0378s/iter; left time: 82.4889s
	iters: 200, epoch: 17 | loss: 0.0921674
	speed: 0.0117s/iter; left time: 24.4419s
	iters: 300, epoch: 17 | loss: 0.3575130
	speed: 0.0118s/iter; left time: 23.2840s
	iters: 400, epoch: 17 | loss: 0.1378245
	speed: 0.0118s/iter; left time: 22.1317s
	iters: 500, epoch: 17 | loss: 0.3198546
	speed: 0.0118s/iter; left time: 20.9496s
Epoch: 17 cost time: 7.060693264007568
Epoch: 17, Steps: 570 | Train Loss: 0.2062321 Vali Loss: 0.0410685 Test Loss: 0.1318044
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 18 | loss: 0.2079534
	speed: 0.0385s/iter; left time: 62.0080s
	iters: 200, epoch: 18 | loss: 0.1390960
	speed: 0.0117s/iter; left time: 17.7274s
	iters: 300, epoch: 18 | loss: 0.2307912
	speed: 0.0117s/iter; left time: 16.5775s
	iters: 400, epoch: 18 | loss: 0.1487812
	speed: 0.0118s/iter; left time: 15.4178s
	iters: 500, epoch: 18 | loss: 0.2052011
	speed: 0.0117s/iter; left time: 14.2239s
Epoch: 18 cost time: 6.9506895542144775
Epoch: 18, Steps: 570 | Train Loss: 0.2058221 Vali Loss: 0.0410283 Test Loss: 0.1318036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13191059231758118, mae:0.22723624110221863
>>> S LR=1e-3 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1447055
	speed: 0.0232s/iter; left time: 262.3842s
	iters: 200, epoch: 1 | loss: 0.2961079
	speed: 0.0114s/iter; left time: 127.3976s
	iters: 300, epoch: 1 | loss: 0.1893419
	speed: 0.0113s/iter; left time: 125.9598s
	iters: 400, epoch: 1 | loss: 0.2780046
	speed: 0.0114s/iter; left time: 124.9552s
	iters: 500, epoch: 1 | loss: 0.1810923
	speed: 0.0114s/iter; left time: 123.9510s
Epoch: 1 cost time: 7.708784103393555
Epoch: 1, Steps: 570 | Train Loss: 0.2508985 Vali Loss: 0.0491201 Test Loss: 0.1533047
Validation loss decreased (inf --> 0.049120).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2616653
	speed: 0.0378s/iter; left time: 405.7036s
	iters: 200, epoch: 2 | loss: 0.1359558
	speed: 0.0113s/iter; left time: 119.9399s
	iters: 300, epoch: 2 | loss: 0.2778808
	speed: 0.0113s/iter; left time: 118.9352s
	iters: 400, epoch: 2 | loss: 0.4096114
	speed: 0.0113s/iter; left time: 117.6443s
	iters: 500, epoch: 2 | loss: 0.4596154
	speed: 0.0113s/iter; left time: 116.6620s
Epoch: 2 cost time: 6.706862449645996
Epoch: 2, Steps: 570 | Train Loss: 0.2683916 Vali Loss: 0.0568070 Test Loss: 0.1693986
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2641538
	speed: 0.0386s/iter; left time: 391.8449s
	iters: 200, epoch: 3 | loss: 0.1357105
	speed: 0.0114s/iter; left time: 115.0116s
	iters: 300, epoch: 3 | loss: 0.2815247
	speed: 0.0114s/iter; left time: 113.5379s
	iters: 400, epoch: 3 | loss: 0.2269677
	speed: 0.0114s/iter; left time: 112.3676s
	iters: 500, epoch: 3 | loss: 0.2735847
	speed: 0.0114s/iter; left time: 111.4437s
Epoch: 3 cost time: 6.7592384815216064
Epoch: 3, Steps: 570 | Train Loss: 0.2499906 Vali Loss: 0.0468208 Test Loss: 0.1535824
Validation loss decreased (0.049120 --> 0.046821).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2691122
	speed: 0.0378s/iter; left time: 362.9609s
	iters: 200, epoch: 4 | loss: 0.1608676
	speed: 0.0113s/iter; left time: 107.5250s
	iters: 300, epoch: 4 | loss: 0.1205572
	speed: 0.0113s/iter; left time: 106.4830s
	iters: 400, epoch: 4 | loss: 0.2025702
	speed: 0.0113s/iter; left time: 105.1607s
	iters: 500, epoch: 4 | loss: 0.1963360
	speed: 0.0113s/iter; left time: 104.1016s
Epoch: 4 cost time: 6.738242149353027
Epoch: 4, Steps: 570 | Train Loss: 0.2304935 Vali Loss: 0.0475475 Test Loss: 0.1484694
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2429303
	speed: 0.0365s/iter; left time: 329.1011s
	iters: 200, epoch: 5 | loss: 0.1844657
	speed: 0.0114s/iter; left time: 101.3024s
	iters: 300, epoch: 5 | loss: 0.2910570
	speed: 0.0113s/iter; left time: 99.8466s
	iters: 400, epoch: 5 | loss: 0.2194630
	speed: 0.0113s/iter; left time: 98.7160s
	iters: 500, epoch: 5 | loss: 0.1671939
	speed: 0.0113s/iter; left time: 97.3947s
Epoch: 5 cost time: 6.72307276725769
Epoch: 5, Steps: 570 | Train Loss: 0.2223704 Vali Loss: 0.0441673 Test Loss: 0.1464653
Validation loss decreased (0.046821 --> 0.044167).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3073729
	speed: 0.0387s/iter; left time: 327.3594s
	iters: 200, epoch: 6 | loss: 0.2926605
	speed: 0.0124s/iter; left time: 103.7626s
	iters: 300, epoch: 6 | loss: 0.1405767
	speed: 0.0117s/iter; left time: 96.6103s
	iters: 400, epoch: 6 | loss: 0.1233382
	speed: 0.0113s/iter; left time: 92.4738s
	iters: 500, epoch: 6 | loss: 0.1767406
	speed: 0.0114s/iter; left time: 91.4900s
Epoch: 6 cost time: 6.998295307159424
Epoch: 6, Steps: 570 | Train Loss: 0.2162204 Vali Loss: 0.0431651 Test Loss: 0.1478135
Validation loss decreased (0.044167 --> 0.043165).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1386601
	speed: 0.0384s/iter; left time: 302.3966s
	iters: 200, epoch: 7 | loss: 0.2912360
	speed: 0.0124s/iter; left time: 96.7300s
	iters: 300, epoch: 7 | loss: 0.1830111
	speed: 0.0120s/iter; left time: 92.4877s
	iters: 400, epoch: 7 | loss: 0.1639341
	speed: 0.0114s/iter; left time: 86.0512s
	iters: 500, epoch: 7 | loss: 0.1992377
	speed: 0.0114s/iter; left time: 84.9553s
Epoch: 7 cost time: 7.014390707015991
Epoch: 7, Steps: 570 | Train Loss: 0.2127523 Vali Loss: 0.0417739 Test Loss: 0.1414271
Validation loss decreased (0.043165 --> 0.041774).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1206722
	speed: 0.0381s/iter; left time: 278.5130s
	iters: 200, epoch: 8 | loss: 0.2181166
	speed: 0.0114s/iter; left time: 82.1003s
	iters: 300, epoch: 8 | loss: 0.1913849
	speed: 0.0114s/iter; left time: 80.7737s
	iters: 400, epoch: 8 | loss: 0.1661357
	speed: 0.0114s/iter; left time: 79.6099s
	iters: 500, epoch: 8 | loss: 0.1314954
	speed: 0.0114s/iter; left time: 78.4632s
Epoch: 8 cost time: 6.7469401359558105
Epoch: 8, Steps: 570 | Train Loss: 0.2098883 Vali Loss: 0.0414694 Test Loss: 0.1415751
Validation loss decreased (0.041774 --> 0.041469).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3158201
	speed: 0.0370s/iter; left time: 249.4910s
	iters: 200, epoch: 9 | loss: 0.1052012
	speed: 0.0124s/iter; left time: 82.3598s
	iters: 300, epoch: 9 | loss: 0.2852646
	speed: 0.0124s/iter; left time: 81.0678s
	iters: 400, epoch: 9 | loss: 0.2092115
	speed: 0.0120s/iter; left time: 77.4442s
	iters: 500, epoch: 9 | loss: 0.2829599
	speed: 0.0113s/iter; left time: 71.7418s
Epoch: 9 cost time: 7.048764705657959
Epoch: 9, Steps: 570 | Train Loss: 0.2095108 Vali Loss: 0.0412449 Test Loss: 0.1411821
Validation loss decreased (0.041469 --> 0.041245).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1931023
	speed: 0.0370s/iter; left time: 228.5698s
	iters: 200, epoch: 10 | loss: 0.1595373
	speed: 0.0113s/iter; left time: 68.7395s
	iters: 300, epoch: 10 | loss: 0.1703929
	speed: 0.0113s/iter; left time: 67.5870s
	iters: 400, epoch: 10 | loss: 0.2098839
	speed: 0.0113s/iter; left time: 66.4344s
	iters: 500, epoch: 10 | loss: 0.2591951
	speed: 0.0113s/iter; left time: 65.2705s
Epoch: 10 cost time: 6.698321342468262
Epoch: 10, Steps: 570 | Train Loss: 0.2113572 Vali Loss: 0.0412847 Test Loss: 0.1410069
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1327662
	speed: 0.0357s/iter; left time: 199.9595s
	iters: 200, epoch: 11 | loss: 0.1814442
	speed: 0.0114s/iter; left time: 62.5239s
	iters: 300, epoch: 11 | loss: 0.2100997
	speed: 0.0114s/iter; left time: 61.3850s
	iters: 400, epoch: 11 | loss: 0.2677504
	speed: 0.0113s/iter; left time: 60.1466s
	iters: 500, epoch: 11 | loss: 0.2643196
	speed: 0.0113s/iter; left time: 58.9652s
Epoch: 11 cost time: 6.701202869415283
Epoch: 11, Steps: 570 | Train Loss: 0.2102036 Vali Loss: 0.0412929 Test Loss: 0.1408989
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2140771
	speed: 0.0373s/iter; left time: 187.8505s
	iters: 200, epoch: 12 | loss: 0.1759742
	speed: 0.0117s/iter; left time: 57.6202s
	iters: 300, epoch: 12 | loss: 0.1479520
	speed: 0.0113s/iter; left time: 54.5066s
	iters: 400, epoch: 12 | loss: 0.3495104
	speed: 0.0113s/iter; left time: 53.3609s
	iters: 500, epoch: 12 | loss: 0.1920967
	speed: 0.0113s/iter; left time: 52.2299s
Epoch: 12 cost time: 6.847734689712524
Epoch: 12, Steps: 570 | Train Loss: 0.2092184 Vali Loss: 0.0414248 Test Loss: 0.1408063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14132334291934967, mae:0.23462435603141785
>>> S LR=1e-3 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3104388
	speed: 0.0226s/iter; left time: 254.9165s
	iters: 200, epoch: 1 | loss: 0.3210589
	speed: 0.0107s/iter; left time: 120.1559s
	iters: 300, epoch: 1 | loss: 0.3725156
	speed: 0.0107s/iter; left time: 118.6444s
	iters: 400, epoch: 1 | loss: 0.3196966
	speed: 0.0107s/iter; left time: 117.6303s
	iters: 500, epoch: 1 | loss: 0.2287859
	speed: 0.0115s/iter; left time: 125.4153s
Epoch: 1 cost time: 7.418734073638916
Epoch: 1, Steps: 570 | Train Loss: 0.2978050 Vali Loss: 0.0603572 Test Loss: 0.1824343
Validation loss decreased (inf --> 0.060357).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2751749
	speed: 0.0354s/iter; left time: 380.2189s
	iters: 200, epoch: 2 | loss: 0.3863845
	speed: 0.0107s/iter; left time: 114.1053s
	iters: 300, epoch: 2 | loss: 0.2288099
	speed: 0.0108s/iter; left time: 113.4031s
	iters: 400, epoch: 2 | loss: 0.2306806
	speed: 0.0107s/iter; left time: 111.7152s
	iters: 500, epoch: 2 | loss: 0.3238127
	speed: 0.0107s/iter; left time: 110.6594s
Epoch: 2 cost time: 6.367618083953857
Epoch: 2, Steps: 570 | Train Loss: 0.3236803 Vali Loss: 0.0743836 Test Loss: 0.2139168
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2528563
	speed: 0.0347s/iter; left time: 352.2729s
	iters: 200, epoch: 3 | loss: 0.2348547
	speed: 0.0107s/iter; left time: 107.6644s
	iters: 300, epoch: 3 | loss: 0.3950285
	speed: 0.0107s/iter; left time: 106.4435s
	iters: 400, epoch: 3 | loss: 0.3248223
	speed: 0.0107s/iter; left time: 105.1918s
	iters: 500, epoch: 3 | loss: 0.3293297
	speed: 0.0107s/iter; left time: 104.2592s
Epoch: 3 cost time: 6.332388639450073
Epoch: 3, Steps: 570 | Train Loss: 0.3301652 Vali Loss: 0.0721752 Test Loss: 0.2108324
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3384554
	speed: 0.0349s/iter; left time: 334.9616s
	iters: 200, epoch: 4 | loss: 0.1564276
	speed: 0.0107s/iter; left time: 102.0023s
	iters: 300, epoch: 4 | loss: 0.2411686
	speed: 0.0107s/iter; left time: 100.8627s
	iters: 400, epoch: 4 | loss: 0.5205405
	speed: 0.0107s/iter; left time: 99.7835s
	iters: 500, epoch: 4 | loss: 0.3566589
	speed: 0.0107s/iter; left time: 98.7319s
Epoch: 4 cost time: 6.3763108253479
Epoch: 4, Steps: 570 | Train Loss: 0.3077693 Vali Loss: 0.0695746 Test Loss: 0.1982687
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1826217621564865, mae:0.2749800384044647
>>> S LR=1e-3 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2901531
	speed: 0.0261s/iter; left time: 295.1017s
	iters: 200, epoch: 1 | loss: 0.1883033
	speed: 0.0146s/iter; left time: 163.5062s
	iters: 300, epoch: 1 | loss: 0.3619721
	speed: 0.0146s/iter; left time: 161.7461s
	iters: 400, epoch: 1 | loss: 0.2479444
	speed: 0.0146s/iter; left time: 160.5694s
	iters: 500, epoch: 1 | loss: 0.2011832
	speed: 0.0146s/iter; left time: 159.0426s
Epoch: 1 cost time: 9.515641212463379
Epoch: 1, Steps: 570 | Train Loss: 0.2606389 Vali Loss: 0.0499524 Test Loss: 0.1538841
Validation loss decreased (inf --> 0.049952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4477793
	speed: 0.0457s/iter; left time: 490.4621s
	iters: 200, epoch: 2 | loss: 0.2372424
	speed: 0.0146s/iter; left time: 155.1732s
	iters: 300, epoch: 2 | loss: 0.1869262
	speed: 0.0146s/iter; left time: 153.4209s
	iters: 400, epoch: 2 | loss: 0.1292870
	speed: 0.0146s/iter; left time: 151.9708s
	iters: 500, epoch: 2 | loss: 0.2744299
	speed: 0.0146s/iter; left time: 150.5121s
Epoch: 2 cost time: 8.561320543289185
Epoch: 2, Steps: 570 | Train Loss: 0.2598878 Vali Loss: 0.0537541 Test Loss: 0.1758623
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4102204
	speed: 0.0465s/iter; left time: 472.9798s
	iters: 200, epoch: 3 | loss: 0.2491012
	speed: 0.0146s/iter; left time: 146.9485s
	iters: 300, epoch: 3 | loss: 0.1352380
	speed: 0.0146s/iter; left time: 145.2223s
	iters: 400, epoch: 3 | loss: 0.2066573
	speed: 0.0146s/iter; left time: 143.9913s
	iters: 500, epoch: 3 | loss: 0.1871329
	speed: 0.0146s/iter; left time: 142.4101s
Epoch: 3 cost time: 8.595795631408691
Epoch: 3, Steps: 570 | Train Loss: 0.2391377 Vali Loss: 0.0476485 Test Loss: 0.1515838
Validation loss decreased (0.049952 --> 0.047649).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2057128
	speed: 0.0478s/iter; left time: 458.3590s
	iters: 200, epoch: 4 | loss: 0.1717457
	speed: 0.0146s/iter; left time: 138.5615s
	iters: 300, epoch: 4 | loss: 0.2025416
	speed: 0.0146s/iter; left time: 137.1393s
	iters: 400, epoch: 4 | loss: 0.2086594
	speed: 0.0146s/iter; left time: 135.5684s
	iters: 500, epoch: 4 | loss: 0.2434906
	speed: 0.0146s/iter; left time: 134.3265s
Epoch: 4 cost time: 8.584609270095825
Epoch: 4, Steps: 570 | Train Loss: 0.2209242 Vali Loss: 0.0426495 Test Loss: 0.1377545
Validation loss decreased (0.047649 --> 0.042649).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1753248
	speed: 0.0475s/iter; left time: 428.9225s
	iters: 200, epoch: 5 | loss: 0.2192986
	speed: 0.0147s/iter; left time: 131.4875s
	iters: 300, epoch: 5 | loss: 0.2047776
	speed: 0.0148s/iter; left time: 130.5816s
	iters: 400, epoch: 5 | loss: 0.2456553
	speed: 0.0146s/iter; left time: 127.5240s
	iters: 500, epoch: 5 | loss: 0.2801948
	speed: 0.0147s/iter; left time: 126.5187s
Epoch: 5 cost time: 8.647815227508545
Epoch: 5, Steps: 570 | Train Loss: 0.2098154 Vali Loss: 0.0407020 Test Loss: 0.1366220
Validation loss decreased (0.042649 --> 0.040702).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1614825
	speed: 0.0449s/iter; left time: 379.3334s
	iters: 200, epoch: 6 | loss: 0.1877154
	speed: 0.0146s/iter; left time: 121.5091s
	iters: 300, epoch: 6 | loss: 0.1275630
	speed: 0.0150s/iter; left time: 123.7817s
	iters: 400, epoch: 6 | loss: 0.1538254
	speed: 0.0148s/iter; left time: 121.0380s
	iters: 500, epoch: 6 | loss: 0.2072047
	speed: 0.0145s/iter; left time: 117.0488s
Epoch: 6 cost time: 8.613306522369385
Epoch: 6, Steps: 570 | Train Loss: 0.2032497 Vali Loss: 0.0400796 Test Loss: 0.1337505
Validation loss decreased (0.040702 --> 0.040080).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1740784
	speed: 0.0450s/iter; left time: 354.6170s
	iters: 200, epoch: 7 | loss: 0.1613561
	speed: 0.0145s/iter; left time: 113.2073s
	iters: 300, epoch: 7 | loss: 0.1914904
	speed: 0.0147s/iter; left time: 112.6111s
	iters: 400, epoch: 7 | loss: 0.1701341
	speed: 0.0146s/iter; left time: 110.9844s
	iters: 500, epoch: 7 | loss: 0.3022971
	speed: 0.0147s/iter; left time: 109.6682s
Epoch: 7 cost time: 8.568280696868896
Epoch: 7, Steps: 570 | Train Loss: 0.2010624 Vali Loss: 0.0406207 Test Loss: 0.1330446
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2994252
	speed: 0.0447s/iter; left time: 326.8639s
	iters: 200, epoch: 8 | loss: 0.2063155
	speed: 0.0145s/iter; left time: 104.6493s
	iters: 300, epoch: 8 | loss: 0.2260559
	speed: 0.0145s/iter; left time: 103.3336s
	iters: 400, epoch: 8 | loss: 0.1367102
	speed: 0.0145s/iter; left time: 101.6640s
	iters: 500, epoch: 8 | loss: 0.2117993
	speed: 0.0145s/iter; left time: 100.3475s
Epoch: 8 cost time: 8.520178079605103
Epoch: 8, Steps: 570 | Train Loss: 0.1997335 Vali Loss: 0.0403160 Test Loss: 0.1317465
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2589373
	speed: 0.0448s/iter; left time: 302.0045s
	iters: 200, epoch: 9 | loss: 0.2745977
	speed: 0.0146s/iter; left time: 97.0550s
	iters: 300, epoch: 9 | loss: 0.2797707
	speed: 0.0146s/iter; left time: 95.5667s
	iters: 400, epoch: 9 | loss: 0.2015130
	speed: 0.0146s/iter; left time: 93.9943s
	iters: 500, epoch: 9 | loss: 0.1496501
	speed: 0.0146s/iter; left time: 92.4241s
Epoch: 9 cost time: 8.577301263809204
Epoch: 9, Steps: 570 | Train Loss: 0.1977522 Vali Loss: 0.0401482 Test Loss: 0.1310205
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13387300074100494, mae:0.22867728769779205
>>> S LR=1e-3 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3084746
	speed: 0.0256s/iter; left time: 288.8123s
	iters: 200, epoch: 1 | loss: 0.2550040
	speed: 0.0158s/iter; left time: 177.0000s
	iters: 300, epoch: 1 | loss: 0.1327214
	speed: 0.0159s/iter; left time: 176.4313s
	iters: 400, epoch: 1 | loss: 0.3536454
	speed: 0.0159s/iter; left time: 175.0456s
	iters: 500, epoch: 1 | loss: 0.2305687
	speed: 0.0156s/iter; left time: 170.4315s
Epoch: 1 cost time: 9.92966365814209
Epoch: 1, Steps: 570 | Train Loss: 0.2329306 Vali Loss: 0.0447564 Test Loss: 0.1438518
Validation loss decreased (inf --> 0.044756).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1776892
	speed: 0.0443s/iter; left time: 474.9259s
	iters: 200, epoch: 2 | loss: 0.2561381
	speed: 0.0143s/iter; left time: 151.4946s
	iters: 300, epoch: 2 | loss: 0.1860724
	speed: 0.0143s/iter; left time: 150.4953s
	iters: 400, epoch: 2 | loss: 0.1734309
	speed: 0.0142s/iter; left time: 148.6276s
	iters: 500, epoch: 2 | loss: 0.2344947
	speed: 0.0143s/iter; left time: 147.4226s
Epoch: 2 cost time: 8.387210369110107
Epoch: 2, Steps: 570 | Train Loss: 0.2164328 Vali Loss: 0.0437706 Test Loss: 0.1501142
Validation loss decreased (0.044756 --> 0.043771).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2104650
	speed: 0.0453s/iter; left time: 460.0707s
	iters: 200, epoch: 3 | loss: 0.0838750
	speed: 0.0143s/iter; left time: 143.9082s
	iters: 300, epoch: 3 | loss: 0.2769555
	speed: 0.0143s/iter; left time: 142.0053s
	iters: 400, epoch: 3 | loss: 0.1165872
	speed: 0.0142s/iter; left time: 140.1489s
	iters: 500, epoch: 3 | loss: 0.1788474
	speed: 0.0142s/iter; left time: 138.9697s
Epoch: 3 cost time: 8.371718883514404
Epoch: 3, Steps: 570 | Train Loss: 0.1951624 Vali Loss: 0.0359532 Test Loss: 0.1286581
Validation loss decreased (0.043771 --> 0.035953).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1941924
	speed: 0.0438s/iter; left time: 420.1843s
	iters: 200, epoch: 4 | loss: 0.1714288
	speed: 0.0142s/iter; left time: 135.0588s
	iters: 300, epoch: 4 | loss: 0.2483571
	speed: 0.0142s/iter; left time: 133.5310s
	iters: 400, epoch: 4 | loss: 0.1231948
	speed: 0.0142s/iter; left time: 132.1989s
	iters: 500, epoch: 4 | loss: 0.1273265
	speed: 0.0142s/iter; left time: 130.5398s
Epoch: 4 cost time: 8.340564012527466
Epoch: 4, Steps: 570 | Train Loss: 0.1816515 Vali Loss: 0.0347244 Test Loss: 0.1208541
Validation loss decreased (0.035953 --> 0.034724).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0944789
	speed: 0.0446s/iter; left time: 402.1341s
	iters: 200, epoch: 5 | loss: 0.2132597
	speed: 0.0142s/iter; left time: 126.5337s
	iters: 300, epoch: 5 | loss: 0.2100917
	speed: 0.0142s/iter; left time: 125.4469s
	iters: 400, epoch: 5 | loss: 0.1454971
	speed: 0.0142s/iter; left time: 123.9951s
	iters: 500, epoch: 5 | loss: 0.1748132
	speed: 0.0142s/iter; left time: 122.7155s
Epoch: 5 cost time: 8.351986169815063
Epoch: 5, Steps: 570 | Train Loss: 0.1747576 Vali Loss: 0.0334048 Test Loss: 0.1180639
Validation loss decreased (0.034724 --> 0.033405).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1385110
	speed: 0.0440s/iter; left time: 371.9947s
	iters: 200, epoch: 6 | loss: 0.2718690
	speed: 0.0142s/iter; left time: 118.4698s
	iters: 300, epoch: 6 | loss: 0.2810014
	speed: 0.0142s/iter; left time: 117.2713s
	iters: 400, epoch: 6 | loss: 0.1939351
	speed: 0.0142s/iter; left time: 115.9736s
	iters: 500, epoch: 6 | loss: 0.2088618
	speed: 0.0142s/iter; left time: 114.5197s
Epoch: 6 cost time: 8.345008611679077
Epoch: 6, Steps: 570 | Train Loss: 0.1717429 Vali Loss: 0.0329208 Test Loss: 0.1166345
Validation loss decreased (0.033405 --> 0.032921).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1350399
	speed: 0.0437s/iter; left time: 344.4145s
	iters: 200, epoch: 7 | loss: 0.1754049
	speed: 0.0143s/iter; left time: 111.3272s
	iters: 300, epoch: 7 | loss: 0.2610881
	speed: 0.0143s/iter; left time: 109.8419s
	iters: 400, epoch: 7 | loss: 0.1512150
	speed: 0.0143s/iter; left time: 108.4982s
	iters: 500, epoch: 7 | loss: 0.1951725
	speed: 0.0143s/iter; left time: 107.0059s
Epoch: 7 cost time: 8.39022183418274
Epoch: 7, Steps: 570 | Train Loss: 0.1689568 Vali Loss: 0.0332284 Test Loss: 0.1163286
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1290045
	speed: 0.0440s/iter; left time: 321.9545s
	iters: 200, epoch: 8 | loss: 0.1600660
	speed: 0.0142s/iter; left time: 102.2493s
	iters: 300, epoch: 8 | loss: 0.2639849
	speed: 0.0142s/iter; left time: 100.8231s
	iters: 400, epoch: 8 | loss: 0.1641771
	speed: 0.0142s/iter; left time: 99.3618s
	iters: 500, epoch: 8 | loss: 0.1891548
	speed: 0.0142s/iter; left time: 97.9127s
Epoch: 8 cost time: 8.294276714324951
Epoch: 8, Steps: 570 | Train Loss: 0.1669230 Vali Loss: 0.0328185 Test Loss: 0.1155922
Validation loss decreased (0.032921 --> 0.032818).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1251881
	speed: 0.0434s/iter; left time: 292.6605s
	iters: 200, epoch: 9 | loss: 0.1268924
	speed: 0.0142s/iter; left time: 94.4296s
	iters: 300, epoch: 9 | loss: 0.2147710
	speed: 0.0143s/iter; left time: 93.2297s
	iters: 400, epoch: 9 | loss: 0.1914799
	speed: 0.0143s/iter; left time: 91.8341s
	iters: 500, epoch: 9 | loss: 0.1817049
	speed: 0.0142s/iter; left time: 90.1441s
Epoch: 9 cost time: 8.339910984039307
Epoch: 9, Steps: 570 | Train Loss: 0.1669561 Vali Loss: 0.0327571 Test Loss: 0.1153487
Validation loss decreased (0.032818 --> 0.032757).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1839164
	speed: 0.0452s/iter; left time: 279.0822s
	iters: 200, epoch: 10 | loss: 0.1615123
	speed: 0.0161s/iter; left time: 97.7972s
	iters: 300, epoch: 10 | loss: 0.1611362
	speed: 0.0146s/iter; left time: 87.4210s
	iters: 400, epoch: 10 | loss: 0.1590085
	speed: 0.0149s/iter; left time: 87.2545s
	iters: 500, epoch: 10 | loss: 0.1962947
	speed: 0.0147s/iter; left time: 84.8513s
Epoch: 10 cost time: 8.933403968811035
Epoch: 10, Steps: 570 | Train Loss: 0.1659172 Vali Loss: 0.0327419 Test Loss: 0.1153668
Validation loss decreased (0.032757 --> 0.032742).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2329937
	speed: 0.0453s/iter; left time: 253.8020s
	iters: 200, epoch: 11 | loss: 0.2446429
	speed: 0.0143s/iter; left time: 78.7863s
	iters: 300, epoch: 11 | loss: 0.2030546
	speed: 0.0143s/iter; left time: 77.4648s
	iters: 400, epoch: 11 | loss: 0.1237855
	speed: 0.0143s/iter; left time: 75.8609s
	iters: 500, epoch: 11 | loss: 0.3126868
	speed: 0.0143s/iter; left time: 74.2987s
Epoch: 11 cost time: 8.411355018615723
Epoch: 11, Steps: 570 | Train Loss: 0.1652488 Vali Loss: 0.0327681 Test Loss: 0.1152989
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2329209
	speed: 0.0437s/iter; left time: 219.6525s
	iters: 200, epoch: 12 | loss: 0.1874586
	speed: 0.0144s/iter; left time: 71.1547s
	iters: 300, epoch: 12 | loss: 0.1224551
	speed: 0.0144s/iter; left time: 69.5057s
	iters: 400, epoch: 12 | loss: 0.1906906
	speed: 0.0144s/iter; left time: 67.9752s
	iters: 500, epoch: 12 | loss: 0.2158106
	speed: 0.0144s/iter; left time: 66.6955s
Epoch: 12 cost time: 8.440863370895386
Epoch: 12, Steps: 570 | Train Loss: 0.1668680 Vali Loss: 0.0328780 Test Loss: 0.1153197
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1344462
	speed: 0.0439s/iter; left time: 195.6784s
	iters: 200, epoch: 13 | loss: 0.1201801
	speed: 0.0142s/iter; left time: 61.7969s
	iters: 300, epoch: 13 | loss: 0.1307292
	speed: 0.0142s/iter; left time: 60.4984s
	iters: 400, epoch: 13 | loss: 0.1014290
	speed: 0.0142s/iter; left time: 59.2375s
	iters: 500, epoch: 13 | loss: 0.1687220
	speed: 0.0142s/iter; left time: 57.7690s
Epoch: 13 cost time: 8.361017227172852
Epoch: 13, Steps: 570 | Train Loss: 0.1665019 Vali Loss: 0.0327233 Test Loss: 0.1153092
Validation loss decreased (0.032742 --> 0.032723).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1251093
	speed: 0.0473s/iter; left time: 184.2184s
	iters: 200, epoch: 14 | loss: 0.2565040
	speed: 0.0143s/iter; left time: 54.1411s
	iters: 300, epoch: 14 | loss: 0.1014011
	speed: 0.0143s/iter; left time: 52.6940s
	iters: 400, epoch: 14 | loss: 0.1218605
	speed: 0.0143s/iter; left time: 51.3061s
	iters: 500, epoch: 14 | loss: 0.1068813
	speed: 0.0143s/iter; left time: 49.8888s
Epoch: 14 cost time: 8.381315231323242
Epoch: 14, Steps: 570 | Train Loss: 0.1645430 Vali Loss: 0.0327086 Test Loss: 0.1153039
Validation loss decreased (0.032723 --> 0.032709).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1517110
	speed: 0.0472s/iter; left time: 156.6188s
	iters: 200, epoch: 15 | loss: 0.1301357
	speed: 0.0161s/iter; left time: 51.8977s
	iters: 300, epoch: 15 | loss: 0.1772976
	speed: 0.0161s/iter; left time: 50.0979s
	iters: 400, epoch: 15 | loss: 0.1529449
	speed: 0.0160s/iter; left time: 48.4388s
	iters: 500, epoch: 15 | loss: 0.2104711
	speed: 0.0160s/iter; left time: 46.8349s
Epoch: 15 cost time: 9.3957040309906
Epoch: 15, Steps: 570 | Train Loss: 0.1659867 Vali Loss: 0.0327048 Test Loss: 0.1153049
Validation loss decreased (0.032709 --> 0.032705).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.1975846
	speed: 0.0449s/iter; left time: 123.4827s
	iters: 200, epoch: 16 | loss: 0.1730324
	speed: 0.0142s/iter; left time: 37.7463s
	iters: 300, epoch: 16 | loss: 0.1586137
	speed: 0.0142s/iter; left time: 36.3254s
	iters: 400, epoch: 16 | loss: 0.2131567
	speed: 0.0142s/iter; left time: 34.8912s
	iters: 500, epoch: 16 | loss: 0.1230774
	speed: 0.0143s/iter; left time: 33.5775s
Epoch: 16 cost time: 8.376068592071533
Epoch: 16, Steps: 570 | Train Loss: 0.1650538 Vali Loss: 0.0328190 Test Loss: 0.1153055
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1100217
	speed: 0.0436s/iter; left time: 94.9870s
	iters: 200, epoch: 17 | loss: 0.1591543
	speed: 0.0143s/iter; left time: 29.7608s
	iters: 300, epoch: 17 | loss: 0.1674053
	speed: 0.0143s/iter; left time: 28.2492s
	iters: 400, epoch: 17 | loss: 0.1726483
	speed: 0.0142s/iter; left time: 26.7506s
	iters: 500, epoch: 17 | loss: 0.1655031
	speed: 0.0143s/iter; left time: 25.4436s
Epoch: 17 cost time: 8.367826223373413
Epoch: 17, Steps: 570 | Train Loss: 0.1658624 Vali Loss: 0.0329792 Test Loss: 0.1153060
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 18 | loss: 0.1654389
	speed: 0.0436s/iter; left time: 70.2237s
	iters: 200, epoch: 18 | loss: 0.1652882
	speed: 0.0143s/iter; left time: 21.6106s
	iters: 300, epoch: 18 | loss: 0.2071002
	speed: 0.0143s/iter; left time: 20.1393s
	iters: 400, epoch: 18 | loss: 0.1309267
	speed: 0.0142s/iter; left time: 18.6272s
	iters: 500, epoch: 18 | loss: 0.1280117
	speed: 0.0142s/iter; left time: 17.2068s
Epoch: 18 cost time: 8.35796570777893
Epoch: 18, Steps: 570 | Train Loss: 0.1645054 Vali Loss: 0.0327643 Test Loss: 0.1153062
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11549211293458939, mae:0.2051859200000763
>>> S LR=1e-3 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1316123
	speed: 0.0260s/iter; left time: 293.3373s
	iters: 200, epoch: 1 | loss: 0.3461553
	speed: 0.0149s/iter; left time: 166.7303s
	iters: 300, epoch: 1 | loss: 0.4130452
	speed: 0.0161s/iter; left time: 178.4725s
	iters: 400, epoch: 1 | loss: 0.2332309
	speed: 0.0163s/iter; left time: 179.4481s
	iters: 500, epoch: 1 | loss: 0.2833620
	speed: 0.0164s/iter; left time: 179.1501s
Epoch: 1 cost time: 10.16368556022644
Epoch: 1, Steps: 570 | Train Loss: 0.2761974 Vali Loss: 0.0511299 Test Loss: 0.1673986
Validation loss decreased (inf --> 0.051130).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2361010
	speed: 0.0480s/iter; left time: 515.0306s
	iters: 200, epoch: 2 | loss: 0.2185470
	speed: 0.0160s/iter; left time: 170.2549s
	iters: 300, epoch: 2 | loss: 0.1979470
	speed: 0.0160s/iter; left time: 168.1162s
	iters: 400, epoch: 2 | loss: 0.2146993
	speed: 0.0160s/iter; left time: 166.4996s
	iters: 500, epoch: 2 | loss: 0.2976230
	speed: 0.0160s/iter; left time: 165.1595s
Epoch: 2 cost time: 9.358951807022095
Epoch: 2, Steps: 570 | Train Loss: 0.2554696 Vali Loss: 0.0592289 Test Loss: 0.1781183
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2476826
	speed: 0.0454s/iter; left time: 461.4712s
	iters: 200, epoch: 3 | loss: 0.2789110
	speed: 0.0141s/iter; left time: 142.3150s
	iters: 300, epoch: 3 | loss: 0.1705784
	speed: 0.0141s/iter; left time: 140.4540s
	iters: 400, epoch: 3 | loss: 0.2227036
	speed: 0.0142s/iter; left time: 139.5603s
	iters: 500, epoch: 3 | loss: 0.2629712
	speed: 0.0141s/iter; left time: 138.0042s
Epoch: 3 cost time: 8.293141603469849
Epoch: 3, Steps: 570 | Train Loss: 0.2370002 Vali Loss: 0.0468128 Test Loss: 0.1546873
Validation loss decreased (0.051130 --> 0.046813).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2681151
	speed: 0.0464s/iter; left time: 444.6267s
	iters: 200, epoch: 4 | loss: 0.1883708
	speed: 0.0143s/iter; left time: 135.4738s
	iters: 300, epoch: 4 | loss: 0.2110769
	speed: 0.0142s/iter; left time: 133.6718s
	iters: 400, epoch: 4 | loss: 0.1656150
	speed: 0.0142s/iter; left time: 132.0365s
	iters: 500, epoch: 4 | loss: 0.1550932
	speed: 0.0142s/iter; left time: 130.0823s
Epoch: 4 cost time: 8.355245590209961
Epoch: 4, Steps: 570 | Train Loss: 0.2192467 Vali Loss: 0.0429196 Test Loss: 0.1453979
Validation loss decreased (0.046813 --> 0.042920).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1931136
	speed: 0.0455s/iter; left time: 410.7346s
	iters: 200, epoch: 5 | loss: 0.2275722
	speed: 0.0143s/iter; left time: 127.3720s
	iters: 300, epoch: 5 | loss: 0.2137195
	speed: 0.0143s/iter; left time: 125.9507s
	iters: 400, epoch: 5 | loss: 0.2598560
	speed: 0.0143s/iter; left time: 124.4976s
	iters: 500, epoch: 5 | loss: 0.1601946
	speed: 0.0143s/iter; left time: 122.8987s
Epoch: 5 cost time: 8.391361474990845
Epoch: 5, Steps: 570 | Train Loss: 0.2094090 Vali Loss: 0.0420159 Test Loss: 0.1423960
Validation loss decreased (0.042920 --> 0.042016).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2410785
	speed: 0.0452s/iter; left time: 382.3388s
	iters: 200, epoch: 6 | loss: 0.2178310
	speed: 0.0160s/iter; left time: 133.4329s
	iters: 300, epoch: 6 | loss: 0.1049408
	speed: 0.0154s/iter; left time: 127.0906s
	iters: 400, epoch: 6 | loss: 0.2274498
	speed: 0.0142s/iter; left time: 115.9319s
	iters: 500, epoch: 6 | loss: 0.2109631
	speed: 0.0143s/iter; left time: 114.8581s
Epoch: 6 cost time: 8.719154357910156
Epoch: 6, Steps: 570 | Train Loss: 0.2036341 Vali Loss: 0.0414520 Test Loss: 0.1393536
Validation loss decreased (0.042016 --> 0.041452).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2490918
	speed: 0.0452s/iter; left time: 356.5849s
	iters: 200, epoch: 7 | loss: 0.1215446
	speed: 0.0141s/iter; left time: 109.8967s
	iters: 300, epoch: 7 | loss: 0.1957163
	speed: 0.0141s/iter; left time: 108.5541s
	iters: 400, epoch: 7 | loss: 0.2891813
	speed: 0.0141s/iter; left time: 107.1655s
	iters: 500, epoch: 7 | loss: 0.1729584
	speed: 0.0141s/iter; left time: 105.6609s
Epoch: 7 cost time: 8.311556339263916
Epoch: 7, Steps: 570 | Train Loss: 0.2024023 Vali Loss: 0.0411419 Test Loss: 0.1382149
Validation loss decreased (0.041452 --> 0.041142).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1602860
	speed: 0.0449s/iter; left time: 328.5505s
	iters: 200, epoch: 8 | loss: 0.1961557
	speed: 0.0142s/iter; left time: 102.4363s
	iters: 300, epoch: 8 | loss: 0.1809500
	speed: 0.0142s/iter; left time: 101.0182s
	iters: 400, epoch: 8 | loss: 0.1854437
	speed: 0.0142s/iter; left time: 99.2911s
	iters: 500, epoch: 8 | loss: 0.1208159
	speed: 0.0142s/iter; left time: 97.8505s
Epoch: 8 cost time: 8.35243821144104
Epoch: 8, Steps: 570 | Train Loss: 0.2007688 Vali Loss: 0.0411694 Test Loss: 0.1403133
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2701076
	speed: 0.0448s/iter; left time: 302.0404s
	iters: 200, epoch: 9 | loss: 0.1768876
	speed: 0.0142s/iter; left time: 94.4056s
	iters: 300, epoch: 9 | loss: 0.1591306
	speed: 0.0142s/iter; left time: 92.9312s
	iters: 400, epoch: 9 | loss: 0.1457348
	speed: 0.0142s/iter; left time: 91.4073s
	iters: 500, epoch: 9 | loss: 0.1661776
	speed: 0.0142s/iter; left time: 90.2866s
Epoch: 9 cost time: 8.343913078308105
Epoch: 9, Steps: 570 | Train Loss: 0.1999719 Vali Loss: 0.0410798 Test Loss: 0.1394608
Validation loss decreased (0.041142 --> 0.041080).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3961173
	speed: 0.0463s/iter; left time: 285.4944s
	iters: 200, epoch: 10 | loss: 0.2390351
	speed: 0.0141s/iter; left time: 85.7008s
	iters: 300, epoch: 10 | loss: 0.2069360
	speed: 0.0141s/iter; left time: 84.1731s
	iters: 400, epoch: 10 | loss: 0.2284684
	speed: 0.0141s/iter; left time: 82.7528s
	iters: 500, epoch: 10 | loss: 0.1837202
	speed: 0.0141s/iter; left time: 81.4149s
Epoch: 10 cost time: 8.295379400253296
Epoch: 10, Steps: 570 | Train Loss: 0.1986978 Vali Loss: 0.0411332 Test Loss: 0.1390541
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2142820
	speed: 0.0462s/iter; left time: 258.8546s
	iters: 200, epoch: 11 | loss: 0.1976099
	speed: 0.0143s/iter; left time: 78.4516s
	iters: 300, epoch: 11 | loss: 0.1442292
	speed: 0.0143s/iter; left time: 77.1398s
	iters: 400, epoch: 11 | loss: 0.2134976
	speed: 0.0143s/iter; left time: 75.7635s
	iters: 500, epoch: 11 | loss: 0.1500740
	speed: 0.0143s/iter; left time: 74.3168s
Epoch: 11 cost time: 8.377163410186768
Epoch: 11, Steps: 570 | Train Loss: 0.1987566 Vali Loss: 0.0411272 Test Loss: 0.1390966
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1590316
	speed: 0.0453s/iter; left time: 227.6686s
	iters: 200, epoch: 12 | loss: 0.1537899
	speed: 0.0143s/iter; left time: 70.4896s
	iters: 300, epoch: 12 | loss: 0.2226592
	speed: 0.0143s/iter; left time: 69.1812s
	iters: 400, epoch: 12 | loss: 0.1110685
	speed: 0.0143s/iter; left time: 67.7639s
	iters: 500, epoch: 12 | loss: 0.2937638
	speed: 0.0143s/iter; left time: 66.2919s
Epoch: 12 cost time: 8.499422550201416
Epoch: 12, Steps: 570 | Train Loss: 0.1993374 Vali Loss: 0.0410009 Test Loss: 0.1391507
Validation loss decreased (0.041080 --> 0.041001).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1323964
	speed: 0.0460s/iter; left time: 205.1841s
	iters: 200, epoch: 13 | loss: 0.1792969
	speed: 0.0142s/iter; left time: 61.7481s
	iters: 300, epoch: 13 | loss: 0.1961953
	speed: 0.0142s/iter; left time: 60.3240s
	iters: 400, epoch: 13 | loss: 0.1906523
	speed: 0.0142s/iter; left time: 58.8822s
	iters: 500, epoch: 13 | loss: 0.2324843
	speed: 0.0141s/iter; left time: 57.4306s
Epoch: 13 cost time: 8.325749635696411
Epoch: 13, Steps: 570 | Train Loss: 0.1994459 Vali Loss: 0.0412280 Test Loss: 0.1391151
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1624870
	speed: 0.0438s/iter; left time: 170.4650s
	iters: 200, epoch: 14 | loss: 0.2388406
	speed: 0.0142s/iter; left time: 53.9083s
	iters: 300, epoch: 14 | loss: 0.1677906
	speed: 0.0142s/iter; left time: 52.4994s
	iters: 400, epoch: 14 | loss: 0.2028914
	speed: 0.0142s/iter; left time: 50.9694s
	iters: 500, epoch: 14 | loss: 0.1469208
	speed: 0.0142s/iter; left time: 49.6313s
Epoch: 14 cost time: 8.350974559783936
Epoch: 14, Steps: 570 | Train Loss: 0.1983815 Vali Loss: 0.0413391 Test Loss: 0.1390968
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2246569
	speed: 0.0437s/iter; left time: 145.0468s
	iters: 200, epoch: 15 | loss: 0.1541380
	speed: 0.0143s/iter; left time: 45.9469s
	iters: 300, epoch: 15 | loss: 0.2638260
	speed: 0.0143s/iter; left time: 44.5029s
	iters: 400, epoch: 15 | loss: 0.2361422
	speed: 0.0143s/iter; left time: 43.0934s
	iters: 500, epoch: 15 | loss: 0.1322493
	speed: 0.0143s/iter; left time: 41.7020s
Epoch: 15 cost time: 8.367838144302368
Epoch: 15, Steps: 570 | Train Loss: 0.1980919 Vali Loss: 0.0410909 Test Loss: 0.1391043
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13924598693847656, mae:0.23306456208229065
>>> S LR=1e-3 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3890513
	speed: 0.0301s/iter; left time: 340.2724s
	iters: 200, epoch: 1 | loss: 0.3186882
	speed: 0.0183s/iter; left time: 205.0940s
	iters: 300, epoch: 1 | loss: 0.4095492
	speed: 0.0183s/iter; left time: 203.5778s
	iters: 400, epoch: 1 | loss: 0.3157131
	speed: 0.0183s/iter; left time: 201.8398s
	iters: 500, epoch: 1 | loss: 0.2661114
	speed: 0.0183s/iter; left time: 199.4824s
Epoch: 1 cost time: 11.677420616149902
Epoch: 1, Steps: 570 | Train Loss: 0.3308876 Vali Loss: 0.0637920 Test Loss: 0.1945750
Validation loss decreased (inf --> 0.063792).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3806554
	speed: 0.0540s/iter; left time: 579.2997s
	iters: 200, epoch: 2 | loss: 0.3094521
	speed: 0.0169s/iter; left time: 179.8900s
	iters: 300, epoch: 2 | loss: 0.3649977
	speed: 0.0179s/iter; left time: 188.6430s
	iters: 400, epoch: 2 | loss: 0.2086248
	speed: 0.0184s/iter; left time: 191.8339s
	iters: 500, epoch: 2 | loss: 0.2202788
	speed: 0.0184s/iter; left time: 189.8066s
Epoch: 2 cost time: 10.48650598526001
Epoch: 2, Steps: 570 | Train Loss: 0.3090674 Vali Loss: 0.0638702 Test Loss: 0.1902357
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2251541
	speed: 0.0536s/iter; left time: 544.8189s
	iters: 200, epoch: 3 | loss: 0.2656277
	speed: 0.0183s/iter; left time: 184.1113s
	iters: 300, epoch: 3 | loss: 0.4360645
	speed: 0.0183s/iter; left time: 182.5609s
	iters: 400, epoch: 3 | loss: 0.2634760
	speed: 0.0178s/iter; left time: 175.8602s
	iters: 500, epoch: 3 | loss: 0.2908687
	speed: 0.0169s/iter; left time: 165.0787s
Epoch: 3 cost time: 10.442067384719849
Epoch: 3, Steps: 570 | Train Loss: 0.2795258 Vali Loss: 0.0592183 Test Loss: 0.1780447
Validation loss decreased (0.063792 --> 0.059218).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3385183
	speed: 0.0523s/iter; left time: 502.0512s
	iters: 200, epoch: 4 | loss: 0.2534389
	speed: 0.0167s/iter; left time: 158.5071s
	iters: 300, epoch: 4 | loss: 0.2632434
	speed: 0.0167s/iter; left time: 156.8443s
	iters: 400, epoch: 4 | loss: 0.3124985
	speed: 0.0167s/iter; left time: 155.5088s
	iters: 500, epoch: 4 | loss: 0.2704175
	speed: 0.0167s/iter; left time: 153.7339s
Epoch: 4 cost time: 9.89404559135437
Epoch: 4, Steps: 570 | Train Loss: 0.2660169 Vali Loss: 0.0589008 Test Loss: 0.1767676
Validation loss decreased (0.059218 --> 0.058901).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1944233
	speed: 0.0525s/iter; left time: 473.9100s
	iters: 200, epoch: 5 | loss: 0.3675603
	speed: 0.0183s/iter; left time: 163.1504s
	iters: 300, epoch: 5 | loss: 0.2527090
	speed: 0.0183s/iter; left time: 161.3850s
	iters: 400, epoch: 5 | loss: 0.2577175
	speed: 0.0183s/iter; left time: 159.6911s
	iters: 500, epoch: 5 | loss: 0.1913799
	speed: 0.0183s/iter; left time: 157.4829s
Epoch: 5 cost time: 10.760682106018066
Epoch: 5, Steps: 570 | Train Loss: 0.2612860 Vali Loss: 0.0575617 Test Loss: 0.1769891
Validation loss decreased (0.058901 --> 0.057562).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3171236
	speed: 0.0533s/iter; left time: 450.6324s
	iters: 200, epoch: 6 | loss: 0.2321954
	speed: 0.0182s/iter; left time: 152.1442s
	iters: 300, epoch: 6 | loss: 0.3575722
	speed: 0.0183s/iter; left time: 150.7598s
	iters: 400, epoch: 6 | loss: 0.4393860
	speed: 0.0183s/iter; left time: 149.2197s
	iters: 500, epoch: 6 | loss: 0.2440566
	speed: 0.0183s/iter; left time: 146.9417s
Epoch: 6 cost time: 10.6107017993927
Epoch: 6, Steps: 570 | Train Loss: 0.2561369 Vali Loss: 0.0566042 Test Loss: 0.1741538
Validation loss decreased (0.057562 --> 0.056604).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2434737
	speed: 0.0552s/iter; left time: 435.1289s
	iters: 200, epoch: 7 | loss: 0.2784412
	speed: 0.0183s/iter; left time: 142.1707s
	iters: 300, epoch: 7 | loss: 0.3411343
	speed: 0.0183s/iter; left time: 140.3264s
	iters: 400, epoch: 7 | loss: 0.1781601
	speed: 0.0183s/iter; left time: 138.8971s
	iters: 500, epoch: 7 | loss: 0.2002386
	speed: 0.0183s/iter; left time: 136.6171s
Epoch: 7 cost time: 10.770712614059448
Epoch: 7, Steps: 570 | Train Loss: 0.2539371 Vali Loss: 0.0564889 Test Loss: 0.1736454
Validation loss decreased (0.056604 --> 0.056489).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2140343
	speed: 0.0554s/iter; left time: 404.9597s
	iters: 200, epoch: 8 | loss: 0.1976038
	speed: 0.0168s/iter; left time: 120.8201s
	iters: 300, epoch: 8 | loss: 0.2348206
	speed: 0.0167s/iter; left time: 118.9758s
	iters: 400, epoch: 8 | loss: 0.1612010
	speed: 0.0180s/iter; left time: 125.9886s
	iters: 500, epoch: 8 | loss: 0.1823289
	speed: 0.0182s/iter; left time: 125.9134s
Epoch: 8 cost time: 10.213112354278564
Epoch: 8, Steps: 570 | Train Loss: 0.2548433 Vali Loss: 0.0562387 Test Loss: 0.1724389
Validation loss decreased (0.056489 --> 0.056239).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2684328
	speed: 0.0545s/iter; left time: 367.4562s
	iters: 200, epoch: 9 | loss: 0.1571295
	speed: 0.0168s/iter; left time: 111.6298s
	iters: 300, epoch: 9 | loss: 0.2758294
	speed: 0.0168s/iter; left time: 109.9631s
	iters: 400, epoch: 9 | loss: 0.2591538
	speed: 0.0168s/iter; left time: 108.3572s
	iters: 500, epoch: 9 | loss: 0.3150725
	speed: 0.0171s/iter; left time: 108.2533s
Epoch: 9 cost time: 10.091838121414185
Epoch: 9, Steps: 570 | Train Loss: 0.2518210 Vali Loss: 0.0564130 Test Loss: 0.1729358
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3707533
	speed: 0.0525s/iter; left time: 324.1070s
	iters: 200, epoch: 10 | loss: 0.1396235
	speed: 0.0182s/iter; left time: 110.4756s
	iters: 300, epoch: 10 | loss: 0.3036274
	speed: 0.0182s/iter; left time: 108.6425s
	iters: 400, epoch: 10 | loss: 0.2926841
	speed: 0.0182s/iter; left time: 106.8288s
	iters: 500, epoch: 10 | loss: 0.2511991
	speed: 0.0182s/iter; left time: 105.1351s
Epoch: 10 cost time: 10.666693925857544
Epoch: 10, Steps: 570 | Train Loss: 0.2521156 Vali Loss: 0.0563537 Test Loss: 0.1727997
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1918997
	speed: 0.0559s/iter; left time: 313.3597s
	iters: 200, epoch: 11 | loss: 0.2313498
	speed: 0.0175s/iter; left time: 96.3132s
	iters: 300, epoch: 11 | loss: 0.1462294
	speed: 0.0167s/iter; left time: 90.2942s
	iters: 400, epoch: 11 | loss: 0.2919318
	speed: 0.0167s/iter; left time: 88.6483s
	iters: 500, epoch: 11 | loss: 0.3669772
	speed: 0.0167s/iter; left time: 86.9110s
Epoch: 11 cost time: 10.07761001586914
Epoch: 11, Steps: 570 | Train Loss: 0.2533058 Vali Loss: 0.0563842 Test Loss: 0.1728437
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17256033420562744, mae:0.27082493901252747
>>> S LR=1e-3 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2406884
	speed: 0.0278s/iter; left time: 314.4814s
	iters: 200, epoch: 1 | loss: 0.1940219
	speed: 0.0162s/iter; left time: 180.9638s
	iters: 300, epoch: 1 | loss: 0.2967552
	speed: 0.0161s/iter; left time: 179.1500s
	iters: 400, epoch: 1 | loss: 0.3334038
	speed: 0.0161s/iter; left time: 177.6099s
	iters: 500, epoch: 1 | loss: 0.1871599
	speed: 0.0162s/iter; left time: 176.3515s
Epoch: 1 cost time: 10.43240761756897
Epoch: 1, Steps: 570 | Train Loss: 0.3103210 Vali Loss: 0.0777616 Test Loss: 0.2126016
Validation loss decreased (inf --> 0.077762).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3047117
	speed: 0.0486s/iter; left time: 521.0455s
	iters: 200, epoch: 2 | loss: 0.2423811
	speed: 0.0161s/iter; left time: 171.2240s
	iters: 300, epoch: 2 | loss: 0.3429040
	speed: 0.0161s/iter; left time: 169.8597s
	iters: 400, epoch: 2 | loss: 0.5687867
	speed: 0.0161s/iter; left time: 168.3691s
	iters: 500, epoch: 2 | loss: 0.3786788
	speed: 0.0161s/iter; left time: 166.4938s
Epoch: 2 cost time: 9.47032117843628
Epoch: 2, Steps: 570 | Train Loss: 0.3367387 Vali Loss: 0.0714880 Test Loss: 0.2078707
Validation loss decreased (0.077762 --> 0.071488).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2861425
	speed: 0.0481s/iter; left time: 488.2954s
	iters: 200, epoch: 3 | loss: 0.3481644
	speed: 0.0161s/iter; left time: 162.4228s
	iters: 300, epoch: 3 | loss: 0.2041555
	speed: 0.0161s/iter; left time: 160.6982s
	iters: 400, epoch: 3 | loss: 0.3209046
	speed: 0.0161s/iter; left time: 159.0838s
	iters: 500, epoch: 3 | loss: 0.2115982
	speed: 0.0161s/iter; left time: 157.5988s
Epoch: 3 cost time: 9.477972745895386
Epoch: 3, Steps: 570 | Train Loss: 0.3079379 Vali Loss: 0.0679362 Test Loss: 0.1979239
Validation loss decreased (0.071488 --> 0.067936).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2311646
	speed: 0.0500s/iter; left time: 479.3549s
	iters: 200, epoch: 4 | loss: 0.4914715
	speed: 0.0177s/iter; left time: 167.9897s
	iters: 300, epoch: 4 | loss: 0.3339030
	speed: 0.0177s/iter; left time: 165.9109s
	iters: 400, epoch: 4 | loss: 0.2083451
	speed: 0.0175s/iter; left time: 162.6881s
	iters: 500, epoch: 4 | loss: 0.4257355
	speed: 0.0162s/iter; left time: 149.0853s
Epoch: 4 cost time: 10.083451986312866
Epoch: 4, Steps: 570 | Train Loss: 0.2921843 Vali Loss: 0.0663875 Test Loss: 0.1962212
Validation loss decreased (0.067936 --> 0.066387).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2979660
	speed: 0.0492s/iter; left time: 444.1744s
	iters: 200, epoch: 5 | loss: 0.4051293
	speed: 0.0177s/iter; left time: 157.5680s
	iters: 300, epoch: 5 | loss: 0.2341682
	speed: 0.0173s/iter; left time: 152.2297s
	iters: 400, epoch: 5 | loss: 0.1926463
	speed: 0.0162s/iter; left time: 141.6725s
	iters: 500, epoch: 5 | loss: 0.3550374
	speed: 0.0162s/iter; left time: 139.9478s
Epoch: 5 cost time: 9.91634225845337
Epoch: 5, Steps: 570 | Train Loss: 0.2837166 Vali Loss: 0.0637390 Test Loss: 0.1857666
Validation loss decreased (0.066387 --> 0.063739).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3426880
	speed: 0.0516s/iter; left time: 436.4131s
	iters: 200, epoch: 6 | loss: 0.4109918
	speed: 0.0162s/iter; left time: 135.1635s
	iters: 300, epoch: 6 | loss: 0.4743838
	speed: 0.0162s/iter; left time: 133.6091s
	iters: 400, epoch: 6 | loss: 0.3070961
	speed: 0.0162s/iter; left time: 132.3915s
	iters: 500, epoch: 6 | loss: 0.2625853
	speed: 0.0162s/iter; left time: 130.7366s
Epoch: 6 cost time: 9.64978814125061
Epoch: 6, Steps: 570 | Train Loss: 0.2782111 Vali Loss: 0.0626721 Test Loss: 0.1838673
Validation loss decreased (0.063739 --> 0.062672).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4214368
	speed: 0.0489s/iter; left time: 385.5715s
	iters: 200, epoch: 7 | loss: 0.1480037
	speed: 0.0163s/iter; left time: 126.7769s
	iters: 300, epoch: 7 | loss: 0.2890241
	speed: 0.0163s/iter; left time: 125.0967s
	iters: 400, epoch: 7 | loss: 0.3937345
	speed: 0.0163s/iter; left time: 123.5014s
	iters: 500, epoch: 7 | loss: 0.4388640
	speed: 0.0163s/iter; left time: 121.7162s
Epoch: 7 cost time: 9.544068813323975
Epoch: 7, Steps: 570 | Train Loss: 0.2746677 Vali Loss: 0.0610458 Test Loss: 0.1773046
Validation loss decreased (0.062672 --> 0.061046).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1988126
	speed: 0.0482s/iter; left time: 352.4476s
	iters: 200, epoch: 8 | loss: 0.3968470
	speed: 0.0162s/iter; left time: 116.7085s
	iters: 300, epoch: 8 | loss: 0.3252017
	speed: 0.0162s/iter; left time: 115.3702s
	iters: 400, epoch: 8 | loss: 0.3142185
	speed: 0.0162s/iter; left time: 113.7388s
	iters: 500, epoch: 8 | loss: 0.2407169
	speed: 0.0162s/iter; left time: 111.7106s
Epoch: 8 cost time: 9.484599113464355
Epoch: 8, Steps: 570 | Train Loss: 0.2668836 Vali Loss: 0.0609552 Test Loss: 0.1742189
Validation loss decreased (0.061046 --> 0.060955).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1811160
	speed: 0.0477s/iter; left time: 321.2583s
	iters: 200, epoch: 9 | loss: 0.2663695
	speed: 0.0161s/iter; left time: 107.0222s
	iters: 300, epoch: 9 | loss: 0.1400258
	speed: 0.0161s/iter; left time: 105.4103s
	iters: 400, epoch: 9 | loss: 0.2306989
	speed: 0.0161s/iter; left time: 103.9267s
	iters: 500, epoch: 9 | loss: 0.1189207
	speed: 0.0161s/iter; left time: 102.3896s
Epoch: 9 cost time: 9.460248231887817
Epoch: 9, Steps: 570 | Train Loss: 0.2663399 Vali Loss: 0.0609162 Test Loss: 0.1735668
Validation loss decreased (0.060955 --> 0.060916).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4012889
	speed: 0.0482s/iter; left time: 297.2787s
	iters: 200, epoch: 10 | loss: 0.2494421
	speed: 0.0162s/iter; left time: 98.4046s
	iters: 300, epoch: 10 | loss: 0.1988528
	speed: 0.0168s/iter; left time: 100.2382s
	iters: 400, epoch: 10 | loss: 0.3260871
	speed: 0.0179s/iter; left time: 105.0339s
	iters: 500, epoch: 10 | loss: 0.1748869
	speed: 0.0179s/iter; left time: 103.1837s
Epoch: 10 cost time: 10.026366472244263
Epoch: 10, Steps: 570 | Train Loss: 0.2665854 Vali Loss: 0.0607470 Test Loss: 0.1733127
Validation loss decreased (0.060916 --> 0.060747).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1749090
	speed: 0.0511s/iter; left time: 286.1697s
	iters: 200, epoch: 11 | loss: 0.1575360
	speed: 0.0178s/iter; left time: 98.1009s
	iters: 300, epoch: 11 | loss: 0.1699417
	speed: 0.0178s/iter; left time: 96.2943s
	iters: 400, epoch: 11 | loss: 0.2284144
	speed: 0.0178s/iter; left time: 94.4329s
	iters: 500, epoch: 11 | loss: 0.2664083
	speed: 0.0178s/iter; left time: 92.5960s
Epoch: 11 cost time: 10.40425968170166
Epoch: 11, Steps: 570 | Train Loss: 0.2640933 Vali Loss: 0.0609260 Test Loss: 0.1729593
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2144740
	speed: 0.0498s/iter; left time: 250.4614s
	iters: 200, epoch: 12 | loss: 0.2361232
	speed: 0.0178s/iter; left time: 87.9828s
	iters: 300, epoch: 12 | loss: 0.2366745
	speed: 0.0179s/iter; left time: 86.3939s
	iters: 400, epoch: 12 | loss: 0.2784631
	speed: 0.0178s/iter; left time: 84.3303s
	iters: 500, epoch: 12 | loss: 0.4295751
	speed: 0.0178s/iter; left time: 82.4661s
Epoch: 12 cost time: 10.407409906387329
Epoch: 12, Steps: 570 | Train Loss: 0.2637699 Vali Loss: 0.0605705 Test Loss: 0.1728006
Validation loss decreased (0.060747 --> 0.060571).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3556096
	speed: 0.0508s/iter; left time: 226.4549s
	iters: 200, epoch: 13 | loss: 0.3506812
	speed: 0.0179s/iter; left time: 77.9596s
	iters: 300, epoch: 13 | loss: 0.3353691
	speed: 0.0179s/iter; left time: 76.2816s
	iters: 400, epoch: 13 | loss: 0.2158278
	speed: 0.0179s/iter; left time: 74.4772s
	iters: 500, epoch: 13 | loss: 0.3155624
	speed: 0.0179s/iter; left time: 72.7406s
Epoch: 13 cost time: 10.428617000579834
Epoch: 13, Steps: 570 | Train Loss: 0.2640357 Vali Loss: 0.0610479 Test Loss: 0.1727922
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2495307
	speed: 0.0494s/iter; left time: 192.1813s
	iters: 200, epoch: 14 | loss: 0.1840356
	speed: 0.0161s/iter; left time: 61.1207s
	iters: 300, epoch: 14 | loss: 0.3480815
	speed: 0.0169s/iter; left time: 62.2035s
	iters: 400, epoch: 14 | loss: 0.3557510
	speed: 0.0162s/iter; left time: 58.0981s
	iters: 500, epoch: 14 | loss: 0.2446396
	speed: 0.0161s/iter; left time: 56.2406s
Epoch: 14 cost time: 9.58906078338623
Epoch: 14, Steps: 570 | Train Loss: 0.2644048 Vali Loss: 0.0607761 Test Loss: 0.1728033
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1812196
	speed: 0.0485s/iter; left time: 161.1900s
	iters: 200, epoch: 15 | loss: 0.3312914
	speed: 0.0162s/iter; left time: 52.0959s
	iters: 300, epoch: 15 | loss: 0.1387159
	speed: 0.0162s/iter; left time: 50.4161s
	iters: 400, epoch: 15 | loss: 0.2647561
	speed: 0.0179s/iter; left time: 54.0151s
	iters: 500, epoch: 15 | loss: 0.3916419
	speed: 0.0179s/iter; left time: 52.2918s
Epoch: 15 cost time: 9.908635139465332
Epoch: 15, Steps: 570 | Train Loss: 0.2638506 Vali Loss: 0.0606346 Test Loss: 0.1727795
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17299500107765198, mae:0.27096083760261536
>>> S LR=1e-3 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3046339
	speed: 0.0269s/iter; left time: 303.9778s
	iters: 200, epoch: 1 | loss: 0.3035192
	speed: 0.0154s/iter; left time: 172.0954s
	iters: 300, epoch: 1 | loss: 0.2389672
	speed: 0.0153s/iter; left time: 170.3200s
	iters: 400, epoch: 1 | loss: 0.3058250
	speed: 0.0154s/iter; left time: 168.9088s
	iters: 500, epoch: 1 | loss: 0.6390110
	speed: 0.0154s/iter; left time: 167.3498s
Epoch: 1 cost time: 9.95622181892395
Epoch: 1, Steps: 570 | Train Loss: 0.3273430 Vali Loss: 0.0650958 Test Loss: 0.1882360
Validation loss decreased (inf --> 0.065096).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4337246
	speed: 0.0482s/iter; left time: 517.0011s
	iters: 200, epoch: 2 | loss: 0.2168605
	speed: 0.0153s/iter; left time: 162.9022s
	iters: 300, epoch: 2 | loss: 0.3098894
	speed: 0.0153s/iter; left time: 161.3024s
	iters: 400, epoch: 2 | loss: 0.2305595
	speed: 0.0153s/iter; left time: 159.6636s
	iters: 500, epoch: 2 | loss: 0.3167050
	speed: 0.0153s/iter; left time: 158.4338s
Epoch: 2 cost time: 8.979338884353638
Epoch: 2, Steps: 570 | Train Loss: 0.3123938 Vali Loss: 0.0614273 Test Loss: 0.1860334
Validation loss decreased (0.065096 --> 0.061427).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3486614
	speed: 0.0476s/iter; left time: 483.5631s
	iters: 200, epoch: 3 | loss: 0.1701313
	speed: 0.0154s/iter; left time: 154.5041s
	iters: 300, epoch: 3 | loss: 0.3297893
	speed: 0.0154s/iter; left time: 152.9903s
	iters: 400, epoch: 3 | loss: 0.3221486
	speed: 0.0154s/iter; left time: 151.4645s
	iters: 500, epoch: 3 | loss: 0.2826868
	speed: 0.0153s/iter; left time: 149.4868s
Epoch: 3 cost time: 9.001756191253662
Epoch: 3, Steps: 570 | Train Loss: 0.2889606 Vali Loss: 0.0604373 Test Loss: 0.1822145
Validation loss decreased (0.061427 --> 0.060437).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2560123
	speed: 0.0465s/iter; left time: 445.6367s
	iters: 200, epoch: 4 | loss: 0.3173294
	speed: 0.0152s/iter; left time: 144.5543s
	iters: 300, epoch: 4 | loss: 0.3313426
	speed: 0.0153s/iter; left time: 143.2148s
	iters: 400, epoch: 4 | loss: 0.2320122
	speed: 0.0152s/iter; left time: 141.6697s
	iters: 500, epoch: 4 | loss: 0.3287741
	speed: 0.0153s/iter; left time: 140.2912s
Epoch: 4 cost time: 8.951324462890625
Epoch: 4, Steps: 570 | Train Loss: 0.2790360 Vali Loss: 0.0574005 Test Loss: 0.1774685
Validation loss decreased (0.060437 --> 0.057401).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3194954
	speed: 0.0474s/iter; left time: 427.2153s
	iters: 200, epoch: 5 | loss: 0.2428303
	speed: 0.0154s/iter; left time: 137.1811s
	iters: 300, epoch: 5 | loss: 0.2163110
	speed: 0.0154s/iter; left time: 135.6711s
	iters: 400, epoch: 5 | loss: 0.2210118
	speed: 0.0154s/iter; left time: 133.9932s
	iters: 500, epoch: 5 | loss: 0.2458686
	speed: 0.0154s/iter; left time: 132.7657s
Epoch: 5 cost time: 9.00725269317627
Epoch: 5, Steps: 570 | Train Loss: 0.2729970 Vali Loss: 0.0581531 Test Loss: 0.1721717
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3341305
	speed: 0.0454s/iter; left time: 383.2805s
	iters: 200, epoch: 6 | loss: 0.2273455
	speed: 0.0153s/iter; left time: 127.6708s
	iters: 300, epoch: 6 | loss: 0.1614109
	speed: 0.0153s/iter; left time: 126.2938s
	iters: 400, epoch: 6 | loss: 0.1719779
	speed: 0.0153s/iter; left time: 124.4440s
	iters: 500, epoch: 6 | loss: 0.2264585
	speed: 0.0153s/iter; left time: 122.8285s
Epoch: 6 cost time: 8.94704008102417
Epoch: 6, Steps: 570 | Train Loss: 0.2666871 Vali Loss: 0.0566471 Test Loss: 0.1672495
Validation loss decreased (0.057401 --> 0.056647).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2716541
	speed: 0.0475s/iter; left time: 374.0033s
	iters: 200, epoch: 7 | loss: 0.1950987
	speed: 0.0152s/iter; left time: 118.6590s
	iters: 300, epoch: 7 | loss: 0.1851300
	speed: 0.0152s/iter; left time: 117.1196s
	iters: 400, epoch: 7 | loss: 0.3160364
	speed: 0.0152s/iter; left time: 115.6094s
	iters: 500, epoch: 7 | loss: 0.2456127
	speed: 0.0152s/iter; left time: 114.0589s
Epoch: 7 cost time: 8.957545042037964
Epoch: 7, Steps: 570 | Train Loss: 0.2627483 Vali Loss: 0.0565868 Test Loss: 0.1640487
Validation loss decreased (0.056647 --> 0.056587).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2354561
	speed: 0.0464s/iter; left time: 338.9226s
	iters: 200, epoch: 8 | loss: 0.3412941
	speed: 0.0153s/iter; left time: 110.3424s
	iters: 300, epoch: 8 | loss: 0.1493979
	speed: 0.0153s/iter; left time: 108.7585s
	iters: 400, epoch: 8 | loss: 0.2583025
	speed: 0.0153s/iter; left time: 107.2408s
	iters: 500, epoch: 8 | loss: 0.2330345
	speed: 0.0153s/iter; left time: 105.7129s
Epoch: 8 cost time: 8.975878953933716
Epoch: 8, Steps: 570 | Train Loss: 0.2606889 Vali Loss: 0.0566679 Test Loss: 0.1636584
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3230222
	speed: 0.0470s/iter; left time: 316.8304s
	iters: 200, epoch: 9 | loss: 0.2622942
	speed: 0.0153s/iter; left time: 101.6824s
	iters: 300, epoch: 9 | loss: 0.3588934
	speed: 0.0153s/iter; left time: 100.0315s
	iters: 400, epoch: 9 | loss: 0.2348541
	speed: 0.0153s/iter; left time: 98.5744s
	iters: 500, epoch: 9 | loss: 0.3287265
	speed: 0.0153s/iter; left time: 97.0581s
Epoch: 9 cost time: 8.958397150039673
Epoch: 9, Steps: 570 | Train Loss: 0.2592219 Vali Loss: 0.0564813 Test Loss: 0.1628649
Validation loss decreased (0.056587 --> 0.056481).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2801792
	speed: 0.0458s/iter; left time: 282.7558s
	iters: 200, epoch: 10 | loss: 0.3446593
	speed: 0.0153s/iter; left time: 93.0298s
	iters: 300, epoch: 10 | loss: 0.2052823
	speed: 0.0153s/iter; left time: 91.2468s
	iters: 400, epoch: 10 | loss: 0.2875676
	speed: 0.0153s/iter; left time: 89.7248s
	iters: 500, epoch: 10 | loss: 0.4475950
	speed: 0.0153s/iter; left time: 88.1818s
Epoch: 10 cost time: 8.975138664245605
Epoch: 10, Steps: 570 | Train Loss: 0.2604920 Vali Loss: 0.0563621 Test Loss: 0.1624354
Validation loss decreased (0.056481 --> 0.056362).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2520208
	speed: 0.0471s/iter; left time: 263.8387s
	iters: 200, epoch: 11 | loss: 0.2052274
	speed: 0.0153s/iter; left time: 83.9957s
	iters: 300, epoch: 11 | loss: 0.2138254
	speed: 0.0153s/iter; left time: 82.4377s
	iters: 400, epoch: 11 | loss: 0.2596624
	speed: 0.0153s/iter; left time: 80.9336s
	iters: 500, epoch: 11 | loss: 0.3240266
	speed: 0.0153s/iter; left time: 79.4025s
Epoch: 11 cost time: 8.951398372650146
Epoch: 11, Steps: 570 | Train Loss: 0.2593884 Vali Loss: 0.0563717 Test Loss: 0.1621854
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2498059
	speed: 0.0488s/iter; left time: 245.4431s
	iters: 200, epoch: 12 | loss: 0.3900754
	speed: 0.0153s/iter; left time: 75.5078s
	iters: 300, epoch: 12 | loss: 0.3028131
	speed: 0.0153s/iter; left time: 74.0307s
	iters: 400, epoch: 12 | loss: 0.2750551
	speed: 0.0153s/iter; left time: 72.5241s
	iters: 500, epoch: 12 | loss: 0.2259816
	speed: 0.0153s/iter; left time: 70.8650s
Epoch: 12 cost time: 8.990098714828491
Epoch: 12, Steps: 570 | Train Loss: 0.2594150 Vali Loss: 0.0565165 Test Loss: 0.1623333
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.5196393
	speed: 0.0460s/iter; left time: 205.3817s
	iters: 200, epoch: 13 | loss: 0.2720689
	speed: 0.0154s/iter; left time: 66.9841s
	iters: 300, epoch: 13 | loss: 0.2321772
	speed: 0.0154s/iter; left time: 65.4747s
	iters: 400, epoch: 13 | loss: 0.3198066
	speed: 0.0153s/iter; left time: 63.8384s
	iters: 500, epoch: 13 | loss: 0.1453905
	speed: 0.0153s/iter; left time: 62.2529s
Epoch: 13 cost time: 9.002420425415039
Epoch: 13, Steps: 570 | Train Loss: 0.2591971 Vali Loss: 0.0564385 Test Loss: 0.1623598
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1626368910074234, mae:0.2564554512500763
>>> S LR=1e-3 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2303164
	speed: 0.0297s/iter; left time: 335.7536s
	iters: 200, epoch: 1 | loss: 0.2703812
	speed: 0.0185s/iter; left time: 206.9646s
	iters: 300, epoch: 1 | loss: 0.4211965
	speed: 0.0185s/iter; left time: 204.9209s
	iters: 400, epoch: 1 | loss: 0.2901670
	speed: 0.0184s/iter; left time: 202.9419s
	iters: 500, epoch: 1 | loss: 0.2004433
	speed: 0.0185s/iter; left time: 201.2503s
Epoch: 1 cost time: 11.695270299911499
Epoch: 1, Steps: 570 | Train Loss: 0.2686817 Vali Loss: 0.0524953 Test Loss: 0.1612639
Validation loss decreased (inf --> 0.052495).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6538122
	speed: 0.0571s/iter; left time: 612.5722s
	iters: 200, epoch: 2 | loss: 0.2513050
	speed: 0.0207s/iter; left time: 220.3445s
	iters: 300, epoch: 2 | loss: 0.2029983
	speed: 0.0206s/iter; left time: 217.4169s
	iters: 400, epoch: 2 | loss: 0.3689172
	speed: 0.0207s/iter; left time: 215.5838s
	iters: 500, epoch: 2 | loss: 0.3364391
	speed: 0.0193s/iter; left time: 199.8191s
Epoch: 2 cost time: 11.925134181976318
Epoch: 2, Steps: 570 | Train Loss: 0.3016375 Vali Loss: 0.0778688 Test Loss: 0.2142043
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2088630
	speed: 0.0588s/iter; left time: 597.8668s
	iters: 200, epoch: 3 | loss: 0.3086602
	speed: 0.0197s/iter; left time: 198.4983s
	iters: 300, epoch: 3 | loss: 0.2709972
	speed: 0.0185s/iter; left time: 184.0265s
	iters: 400, epoch: 3 | loss: 0.2891320
	speed: 0.0184s/iter; left time: 181.8898s
	iters: 500, epoch: 3 | loss: 0.2337216
	speed: 0.0185s/iter; left time: 180.3011s
Epoch: 3 cost time: 11.14601182937622
Epoch: 3, Steps: 570 | Train Loss: 0.3271432 Vali Loss: 0.0738923 Test Loss: 0.2103456
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3295324
	speed: 0.0560s/iter; left time: 537.4708s
	iters: 200, epoch: 4 | loss: 0.4003273
	speed: 0.0184s/iter; left time: 174.3301s
	iters: 300, epoch: 4 | loss: 0.4991114
	speed: 0.0184s/iter; left time: 172.8467s
	iters: 400, epoch: 4 | loss: 0.1751256
	speed: 0.0185s/iter; left time: 171.7387s
	iters: 500, epoch: 4 | loss: 0.3292918
	speed: 0.0184s/iter; left time: 169.5456s
Epoch: 4 cost time: 10.73539400100708
Epoch: 4, Steps: 570 | Train Loss: 0.3148172 Vali Loss: 0.0705834 Test Loss: 0.1998041
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16139204800128937, mae:0.2549571990966797
>>> S LR=1e-3 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.4141943
	speed: 0.0324s/iter; left time: 366.2223s
	iters: 200, epoch: 1 | loss: 0.2361339
	speed: 0.0205s/iter; left time: 229.2924s
	iters: 300, epoch: 1 | loss: 0.2104984
	speed: 0.0205s/iter; left time: 227.6040s
	iters: 400, epoch: 1 | loss: 0.1743278
	speed: 0.0205s/iter; left time: 225.3256s
	iters: 500, epoch: 1 | loss: 0.2551670
	speed: 0.0204s/iter; left time: 222.5446s
Epoch: 1 cost time: 12.908085346221924
Epoch: 1, Steps: 570 | Train Loss: 0.2441023 Vali Loss: 0.0421308 Test Loss: 0.1436595
Validation loss decreased (inf --> 0.042131).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1450141
	speed: 0.0593s/iter; left time: 636.1576s
	iters: 200, epoch: 2 | loss: 0.3435896
	speed: 0.0183s/iter; left time: 194.7215s
	iters: 300, epoch: 2 | loss: 0.4356465
	speed: 0.0183s/iter; left time: 192.8555s
	iters: 400, epoch: 2 | loss: 0.2239107
	speed: 0.0181s/iter; left time: 188.4116s
	iters: 500, epoch: 2 | loss: 0.1907110
	speed: 0.0180s/iter; left time: 186.3908s
Epoch: 2 cost time: 10.649583101272583
Epoch: 2, Steps: 570 | Train Loss: 0.2490509 Vali Loss: 0.0596556 Test Loss: 0.1844265
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2058199
	speed: 0.0552s/iter; left time: 560.7827s
	iters: 200, epoch: 3 | loss: 0.2543373
	speed: 0.0183s/iter; left time: 183.7841s
	iters: 300, epoch: 3 | loss: 0.1861298
	speed: 0.0182s/iter; left time: 181.7673s
	iters: 400, epoch: 3 | loss: 0.2139988
	speed: 0.0183s/iter; left time: 180.3277s
	iters: 500, epoch: 3 | loss: 0.1783023
	speed: 0.0183s/iter; left time: 178.5198s
Epoch: 3 cost time: 10.678658723831177
Epoch: 3, Steps: 570 | Train Loss: 0.2465002 Vali Loss: 0.0490240 Test Loss: 0.1579937
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2895143
	speed: 0.0543s/iter; left time: 520.6394s
	iters: 200, epoch: 4 | loss: 0.1376792
	speed: 0.0183s/iter; left time: 173.9367s
	iters: 300, epoch: 4 | loss: 0.2954125
	speed: 0.0183s/iter; left time: 171.6458s
	iters: 400, epoch: 4 | loss: 0.1827860
	speed: 0.0182s/iter; left time: 169.2400s
	iters: 500, epoch: 4 | loss: 0.1626004
	speed: 0.0183s/iter; left time: 168.3170s
Epoch: 4 cost time: 10.72083044052124
Epoch: 4, Steps: 570 | Train Loss: 0.2260578 Vali Loss: 0.0443951 Test Loss: 0.1454508
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14383147656917572, mae:0.2326839417219162
>>> S LR=1e-3 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2370525
	speed: 0.0320s/iter; left time: 362.1363s
	iters: 200, epoch: 1 | loss: 0.2041364
	speed: 0.0207s/iter; left time: 231.4404s
	iters: 300, epoch: 1 | loss: 0.3464631
	speed: 0.0211s/iter; left time: 233.7410s
	iters: 400, epoch: 1 | loss: 0.3045648
	speed: 0.0208s/iter; left time: 229.0382s
	iters: 500, epoch: 1 | loss: 0.3593931
	speed: 0.0207s/iter; left time: 225.8767s
Epoch: 1 cost time: 13.05640459060669
Epoch: 1, Steps: 570 | Train Loss: 0.2839039 Vali Loss: 0.0562244 Test Loss: 0.1733838
Validation loss decreased (inf --> 0.056224).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3498034
	speed: 0.0626s/iter; left time: 671.5682s
	iters: 200, epoch: 2 | loss: 0.3313021
	speed: 0.0209s/iter; left time: 222.7077s
	iters: 300, epoch: 2 | loss: 0.6352367
	speed: 0.0209s/iter; left time: 220.5641s
	iters: 400, epoch: 2 | loss: 0.2606264
	speed: 0.0209s/iter; left time: 218.1428s
	iters: 500, epoch: 2 | loss: 0.2395810
	speed: 0.0209s/iter; left time: 216.0306s
Epoch: 2 cost time: 12.192822456359863
Epoch: 2, Steps: 570 | Train Loss: 0.2982002 Vali Loss: 0.0706428 Test Loss: 0.2043635
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1624050
	speed: 0.0630s/iter; left time: 640.3326s
	iters: 200, epoch: 3 | loss: 0.3494688
	speed: 0.0213s/iter; left time: 214.1666s
	iters: 300, epoch: 3 | loss: 0.2695572
	speed: 0.0212s/iter; left time: 211.5590s
	iters: 400, epoch: 3 | loss: 0.4007290
	speed: 0.0212s/iter; left time: 209.2642s
	iters: 500, epoch: 3 | loss: 0.2838719
	speed: 0.0212s/iter; left time: 207.1810s
Epoch: 3 cost time: 12.37751841545105
Epoch: 3, Steps: 570 | Train Loss: 0.2903787 Vali Loss: 0.0599745 Test Loss: 0.1904903
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2442121
	speed: 0.0593s/iter; left time: 568.9598s
	iters: 200, epoch: 4 | loss: 0.2722238
	speed: 0.0210s/iter; left time: 199.5823s
	iters: 300, epoch: 4 | loss: 0.1841208
	speed: 0.0210s/iter; left time: 197.5764s
	iters: 400, epoch: 4 | loss: 0.2534694
	speed: 0.0210s/iter; left time: 195.1647s
	iters: 500, epoch: 4 | loss: 0.1745114
	speed: 0.0211s/iter; left time: 193.5756s
Epoch: 4 cost time: 12.206413745880127
Epoch: 4, Steps: 570 | Train Loss: 0.2731539 Vali Loss: 0.0590794 Test Loss: 0.1810155
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17353634536266327, mae:0.26852262020111084
>>> S LR=1e-3 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3357078
	speed: 0.0356s/iter; left time: 401.7869s
	iters: 200, epoch: 1 | loss: 0.3232810
	speed: 0.0237s/iter; left time: 265.7480s
	iters: 300, epoch: 1 | loss: 0.2790099
	speed: 0.0235s/iter; left time: 260.7562s
	iters: 400, epoch: 1 | loss: 0.4633960
	speed: 0.0227s/iter; left time: 250.1351s
	iters: 500, epoch: 1 | loss: 0.4788648
	speed: 0.0218s/iter; left time: 238.0984s
Epoch: 1 cost time: 14.31652283668518
Epoch: 1, Steps: 570 | Train Loss: 0.3760478 Vali Loss: 0.0612344 Test Loss: 0.1926809
Validation loss decreased (inf --> 0.061234).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3528732
	speed: 0.0615s/iter; left time: 659.4393s
	iters: 200, epoch: 2 | loss: 0.2948375
	speed: 0.0219s/iter; left time: 232.7049s
	iters: 300, epoch: 2 | loss: 0.2670749
	speed: 0.0219s/iter; left time: 230.5052s
	iters: 400, epoch: 2 | loss: 0.2658051
	speed: 0.0219s/iter; left time: 228.4818s
	iters: 500, epoch: 2 | loss: 0.2826476
	speed: 0.0219s/iter; left time: 226.0263s
Epoch: 2 cost time: 12.727370500564575
Epoch: 2, Steps: 570 | Train Loss: 0.3142285 Vali Loss: 0.0598789 Test Loss: 0.1896463
Validation loss decreased (0.061234 --> 0.059879).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.6278269
	speed: 0.0610s/iter; left time: 620.0037s
	iters: 200, epoch: 3 | loss: 0.2107268
	speed: 0.0219s/iter; left time: 220.5084s
	iters: 300, epoch: 3 | loss: 0.3693087
	speed: 0.0219s/iter; left time: 218.1264s
	iters: 400, epoch: 3 | loss: 0.2427281
	speed: 0.0219s/iter; left time: 215.6774s
	iters: 500, epoch: 3 | loss: 0.1993775
	speed: 0.0219s/iter; left time: 213.6422s
Epoch: 3 cost time: 12.758378028869629
Epoch: 3, Steps: 570 | Train Loss: 0.2906213 Vali Loss: 0.0555120 Test Loss: 0.1799276
Validation loss decreased (0.059879 --> 0.055512).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2485414
	speed: 0.0641s/iter; left time: 614.4056s
	iters: 200, epoch: 4 | loss: 0.1890860
	speed: 0.0234s/iter; left time: 221.7220s
	iters: 300, epoch: 4 | loss: 0.2124640
	speed: 0.0221s/iter; left time: 207.4122s
	iters: 400, epoch: 4 | loss: 0.3092373
	speed: 0.0219s/iter; left time: 203.4621s
	iters: 500, epoch: 4 | loss: 0.3383768
	speed: 0.0219s/iter; left time: 201.1841s
Epoch: 4 cost time: 12.925563097000122
Epoch: 4, Steps: 570 | Train Loss: 0.2802388 Vali Loss: 0.0554119 Test Loss: 0.1802954
Validation loss decreased (0.055512 --> 0.055412).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3333919
	speed: 0.0629s/iter; left time: 567.7081s
	iters: 200, epoch: 5 | loss: 0.2122702
	speed: 0.0236s/iter; left time: 210.4562s
	iters: 300, epoch: 5 | loss: 0.1897524
	speed: 0.0236s/iter; left time: 207.8074s
	iters: 400, epoch: 5 | loss: 0.2816471
	speed: 0.0235s/iter; left time: 204.5721s
	iters: 500, epoch: 5 | loss: 0.2524493
	speed: 0.0235s/iter; left time: 202.6349s
Epoch: 5 cost time: 13.667600870132446
Epoch: 5, Steps: 570 | Train Loss: 0.2740148 Vali Loss: 0.0547502 Test Loss: 0.1714851
Validation loss decreased (0.055412 --> 0.054750).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2085050
	speed: 0.0636s/iter; left time: 537.1908s
	iters: 200, epoch: 6 | loss: 0.4491705
	speed: 0.0236s/iter; left time: 197.2325s
	iters: 300, epoch: 6 | loss: 0.2299934
	speed: 0.0237s/iter; left time: 195.6467s
	iters: 400, epoch: 6 | loss: 0.2571055
	speed: 0.0236s/iter; left time: 192.7087s
	iters: 500, epoch: 6 | loss: 0.4333530
	speed: 0.0236s/iter; left time: 190.2424s
Epoch: 6 cost time: 13.706652402877808
Epoch: 6, Steps: 570 | Train Loss: 0.2704728 Vali Loss: 0.0552181 Test Loss: 0.1724657
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3174843
	speed: 0.0641s/iter; left time: 505.1835s
	iters: 200, epoch: 7 | loss: 0.2868468
	speed: 0.0231s/iter; left time: 179.8456s
	iters: 300, epoch: 7 | loss: 0.1735781
	speed: 0.0219s/iter; left time: 168.2914s
	iters: 400, epoch: 7 | loss: 0.2942406
	speed: 0.0219s/iter; left time: 166.1885s
	iters: 500, epoch: 7 | loss: 0.3289734
	speed: 0.0219s/iter; left time: 164.0198s
Epoch: 7 cost time: 13.012369394302368
Epoch: 7, Steps: 570 | Train Loss: 0.2674609 Vali Loss: 0.0548355 Test Loss: 0.1716683
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1956707
	speed: 0.0608s/iter; left time: 444.3723s
	iters: 200, epoch: 8 | loss: 0.5673860
	speed: 0.0219s/iter; left time: 157.7376s
	iters: 300, epoch: 8 | loss: 0.2408130
	speed: 0.0219s/iter; left time: 155.5235s
	iters: 400, epoch: 8 | loss: 0.2325095
	speed: 0.0219s/iter; left time: 153.4955s
	iters: 500, epoch: 8 | loss: 0.2161838
	speed: 0.0219s/iter; left time: 151.2903s
Epoch: 8 cost time: 12.716512203216553
Epoch: 8, Steps: 570 | Train Loss: 0.2681654 Vali Loss: 0.0546036 Test Loss: 0.1709865
Validation loss decreased (0.054750 --> 0.054604).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2325904
	speed: 0.0608s/iter; left time: 409.9173s
	iters: 200, epoch: 9 | loss: 0.2198419
	speed: 0.0219s/iter; left time: 145.2610s
	iters: 300, epoch: 9 | loss: 0.3718182
	speed: 0.0219s/iter; left time: 143.2170s
	iters: 400, epoch: 9 | loss: 0.2492831
	speed: 0.0219s/iter; left time: 141.0126s
	iters: 500, epoch: 9 | loss: 0.2248737
	speed: 0.0219s/iter; left time: 138.7526s
Epoch: 9 cost time: 12.733928203582764
Epoch: 9, Steps: 570 | Train Loss: 0.2664010 Vali Loss: 0.0547511 Test Loss: 0.1708740
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2557875
	speed: 0.0629s/iter; left time: 388.0522s
	iters: 200, epoch: 10 | loss: 0.3824787
	speed: 0.0218s/iter; left time: 132.4877s
	iters: 300, epoch: 10 | loss: 0.2522996
	speed: 0.0218s/iter; left time: 130.3203s
	iters: 400, epoch: 10 | loss: 0.3038099
	speed: 0.0218s/iter; left time: 128.1056s
	iters: 500, epoch: 10 | loss: 0.2589300
	speed: 0.0218s/iter; left time: 125.9526s
Epoch: 10 cost time: 12.821136474609375
Epoch: 10, Steps: 570 | Train Loss: 0.2663705 Vali Loss: 0.0547463 Test Loss: 0.1707907
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2008462
	speed: 0.0598s/iter; left time: 334.9271s
	iters: 200, epoch: 11 | loss: 0.2224976
	speed: 0.0218s/iter; left time: 120.1016s
	iters: 300, epoch: 11 | loss: 0.1787722
	speed: 0.0218s/iter; left time: 117.9861s
	iters: 400, epoch: 11 | loss: 0.2695906
	speed: 0.0218s/iter; left time: 115.7734s
	iters: 500, epoch: 11 | loss: 0.1925554
	speed: 0.0219s/iter; left time: 113.6464s
Epoch: 11 cost time: 12.68182110786438
Epoch: 11, Steps: 570 | Train Loss: 0.2662750 Vali Loss: 0.0547240 Test Loss: 0.1707442
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17120154201984406, mae:0.26019588112831116
>>> S LR=1e-3 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3416480
	speed: 0.0329s/iter; left time: 372.1276s
	iters: 200, epoch: 1 | loss: 0.1973964
	speed: 0.0212s/iter; left time: 237.2741s
	iters: 300, epoch: 1 | loss: 0.2815754
	speed: 0.0212s/iter; left time: 235.1090s
	iters: 400, epoch: 1 | loss: 0.3640162
	speed: 0.0212s/iter; left time: 232.9929s
	iters: 500, epoch: 1 | loss: 0.2584557
	speed: 0.0212s/iter; left time: 230.8020s
Epoch: 1 cost time: 13.301225662231445
Epoch: 1, Steps: 570 | Train Loss: 0.3760269 Vali Loss: 0.0732828 Test Loss: 0.2123782
Validation loss decreased (inf --> 0.073283).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3119790
	speed: 0.0623s/iter; left time: 668.6190s
	iters: 200, epoch: 2 | loss: 0.2352309
	speed: 0.0213s/iter; left time: 226.0570s
	iters: 300, epoch: 2 | loss: 0.3672503
	speed: 0.0212s/iter; left time: 223.2465s
	iters: 400, epoch: 2 | loss: 0.3353815
	speed: 0.0212s/iter; left time: 221.1052s
	iters: 500, epoch: 2 | loss: 0.2405341
	speed: 0.0212s/iter; left time: 218.9995s
Epoch: 2 cost time: 12.38839054107666
Epoch: 2, Steps: 570 | Train Loss: 0.3113079 Vali Loss: 0.0617883 Test Loss: 0.1953397
Validation loss decreased (0.073283 --> 0.061788).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2716011
	speed: 0.0624s/iter; left time: 634.1570s
	iters: 200, epoch: 3 | loss: 0.2525069
	speed: 0.0230s/iter; left time: 231.8897s
	iters: 300, epoch: 3 | loss: 0.2606134
	speed: 0.0230s/iter; left time: 229.5165s
	iters: 400, epoch: 3 | loss: 0.2176966
	speed: 0.0231s/iter; left time: 227.2981s
	iters: 500, epoch: 3 | loss: 0.2230963
	speed: 0.0231s/iter; left time: 224.9977s
Epoch: 3 cost time: 13.431923627853394
Epoch: 3, Steps: 570 | Train Loss: 0.2872523 Vali Loss: 0.0575355 Test Loss: 0.1807574
Validation loss decreased (0.061788 --> 0.057535).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1606359
	speed: 0.0618s/iter; left time: 592.8385s
	iters: 200, epoch: 4 | loss: 0.3124730
	speed: 0.0213s/iter; left time: 201.7972s
	iters: 300, epoch: 4 | loss: 0.3461954
	speed: 0.0212s/iter; left time: 199.1727s
	iters: 400, epoch: 4 | loss: 0.3300992
	speed: 0.0212s/iter; left time: 197.2272s
	iters: 500, epoch: 4 | loss: 0.2004585
	speed: 0.0212s/iter; left time: 194.9157s
Epoch: 4 cost time: 12.379832983016968
Epoch: 4, Steps: 570 | Train Loss: 0.2794159 Vali Loss: 0.0583095 Test Loss: 0.1802909
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3324771
	speed: 0.0609s/iter; left time: 549.6858s
	iters: 200, epoch: 5 | loss: 0.2240530
	speed: 0.0212s/iter; left time: 189.1269s
	iters: 300, epoch: 5 | loss: 0.3195217
	speed: 0.0211s/iter; left time: 186.5520s
	iters: 400, epoch: 5 | loss: 0.2919210
	speed: 0.0212s/iter; left time: 184.4653s
	iters: 500, epoch: 5 | loss: 0.1752034
	speed: 0.0212s/iter; left time: 182.5705s
Epoch: 5 cost time: 12.307460069656372
Epoch: 5, Steps: 570 | Train Loss: 0.2734322 Vali Loss: 0.0562525 Test Loss: 0.1736600
Validation loss decreased (0.057535 --> 0.056252).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2619415
	speed: 0.0610s/iter; left time: 515.4699s
	iters: 200, epoch: 6 | loss: 0.4388378
	speed: 0.0234s/iter; left time: 195.6493s
	iters: 300, epoch: 6 | loss: 0.3006369
	speed: 0.0235s/iter; left time: 193.5799s
	iters: 400, epoch: 6 | loss: 0.2029654
	speed: 0.0235s/iter; left time: 191.4888s
	iters: 500, epoch: 6 | loss: 0.1715040
	speed: 0.0235s/iter; left time: 188.8484s
Epoch: 6 cost time: 13.5054771900177
Epoch: 6, Steps: 570 | Train Loss: 0.2700392 Vali Loss: 0.0560628 Test Loss: 0.1731664
Validation loss decreased (0.056252 --> 0.056063).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2649796
	speed: 0.0654s/iter; left time: 515.4881s
	iters: 200, epoch: 7 | loss: 0.3472963
	speed: 0.0235s/iter; left time: 182.5922s
	iters: 300, epoch: 7 | loss: 0.3086013
	speed: 0.0235s/iter; left time: 180.4951s
	iters: 400, epoch: 7 | loss: 0.1711857
	speed: 0.0235s/iter; left time: 178.1135s
	iters: 500, epoch: 7 | loss: 0.2331371
	speed: 0.0235s/iter; left time: 175.9148s
Epoch: 7 cost time: 13.65224313735962
Epoch: 7, Steps: 570 | Train Loss: 0.2675696 Vali Loss: 0.0563506 Test Loss: 0.1720475
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2298519
	speed: 0.0634s/iter; left time: 463.3435s
	iters: 200, epoch: 8 | loss: 0.2794636
	speed: 0.0234s/iter; left time: 168.7507s
	iters: 300, epoch: 8 | loss: 0.2200696
	speed: 0.0234s/iter; left time: 166.3750s
	iters: 400, epoch: 8 | loss: 0.3333406
	speed: 0.0234s/iter; left time: 164.0708s
	iters: 500, epoch: 8 | loss: 0.3218113
	speed: 0.0234s/iter; left time: 161.3947s
Epoch: 8 cost time: 13.582056045532227
Epoch: 8, Steps: 570 | Train Loss: 0.2676260 Vali Loss: 0.0555906 Test Loss: 0.1706139
Validation loss decreased (0.056063 --> 0.055591).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2628065
	speed: 0.0663s/iter; left time: 447.1251s
	iters: 200, epoch: 9 | loss: 0.3144667
	speed: 0.0234s/iter; left time: 155.5839s
	iters: 300, epoch: 9 | loss: 0.3899912
	speed: 0.0234s/iter; left time: 153.1196s
	iters: 400, epoch: 9 | loss: 0.2255440
	speed: 0.0234s/iter; left time: 150.9420s
	iters: 500, epoch: 9 | loss: 0.1585914
	speed: 0.0234s/iter; left time: 148.6920s
Epoch: 9 cost time: 13.615684032440186
Epoch: 9, Steps: 570 | Train Loss: 0.2659888 Vali Loss: 0.0555391 Test Loss: 0.1704498
Validation loss decreased (0.055591 --> 0.055539).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1496351
	speed: 0.0655s/iter; left time: 404.3875s
	iters: 200, epoch: 10 | loss: 0.2644410
	speed: 0.0234s/iter; left time: 141.8612s
	iters: 300, epoch: 10 | loss: 0.2073875
	speed: 0.0234s/iter; left time: 139.4647s
	iters: 400, epoch: 10 | loss: 0.2180316
	speed: 0.0234s/iter; left time: 137.1486s
	iters: 500, epoch: 10 | loss: 0.3390951
	speed: 0.0233s/iter; left time: 134.7408s
Epoch: 10 cost time: 13.57881236076355
Epoch: 10, Steps: 570 | Train Loss: 0.2644920 Vali Loss: 0.0556299 Test Loss: 0.1706103
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.3356326
	speed: 0.0662s/iter; left time: 370.6851s
	iters: 200, epoch: 11 | loss: 0.2988672
	speed: 0.0213s/iter; left time: 117.2648s
	iters: 300, epoch: 11 | loss: 0.2503993
	speed: 0.0211s/iter; left time: 113.8984s
	iters: 400, epoch: 11 | loss: 0.1620351
	speed: 0.0211s/iter; left time: 111.6764s
	iters: 500, epoch: 11 | loss: 0.3627439
	speed: 0.0211s/iter; left time: 109.5614s
Epoch: 11 cost time: 12.485344648361206
Epoch: 11, Steps: 570 | Train Loss: 0.2656815 Vali Loss: 0.0556130 Test Loss: 0.1706159
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3117390
	speed: 0.0594s/iter; left time: 299.0723s
	iters: 200, epoch: 12 | loss: 0.3029944
	speed: 0.0211s/iter; left time: 104.0824s
	iters: 300, epoch: 12 | loss: 0.3222730
	speed: 0.0211s/iter; left time: 101.9748s
	iters: 400, epoch: 12 | loss: 0.4640152
	speed: 0.0211s/iter; left time: 99.8035s
	iters: 500, epoch: 12 | loss: 0.1896034
	speed: 0.0211s/iter; left time: 97.7305s
Epoch: 12 cost time: 12.291551113128662
Epoch: 12, Steps: 570 | Train Loss: 0.2645840 Vali Loss: 0.0556176 Test Loss: 0.1705711
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17064757645130157, mae:0.25961893796920776
>>> S LR=1e-3 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3464455
	speed: 0.0340s/iter; left time: 383.9913s
	iters: 200, epoch: 1 | loss: 0.2410178
	speed: 0.0221s/iter; left time: 247.8709s
	iters: 300, epoch: 1 | loss: 0.3843057
	speed: 0.0229s/iter; left time: 254.5550s
	iters: 400, epoch: 1 | loss: 0.4844975
	speed: 0.0229s/iter; left time: 252.1746s
	iters: 500, epoch: 1 | loss: 0.3094140
	speed: 0.0225s/iter; left time: 244.9196s
Epoch: 1 cost time: 14.040008068084717
Epoch: 1, Steps: 570 | Train Loss: 0.3505537 Vali Loss: 0.0695686 Test Loss: 0.2084722
Validation loss decreased (inf --> 0.069569).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2066959
	speed: 0.0642s/iter; left time: 688.6291s
	iters: 200, epoch: 2 | loss: 0.4795871
	speed: 0.0230s/iter; left time: 244.0469s
	iters: 300, epoch: 2 | loss: 0.2518666
	speed: 0.0230s/iter; left time: 241.8116s
	iters: 400, epoch: 2 | loss: 0.2235818
	speed: 0.0230s/iter; left time: 239.4620s
	iters: 500, epoch: 2 | loss: 0.2022753
	speed: 0.0229s/iter; left time: 236.9670s
Epoch: 2 cost time: 13.359609365463257
Epoch: 2, Steps: 570 | Train Loss: 0.3103994 Vali Loss: 0.0593195 Test Loss: 0.1887732
Validation loss decreased (0.069569 --> 0.059320).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2179180
	speed: 0.0631s/iter; left time: 641.6035s
	iters: 200, epoch: 3 | loss: 0.1919740
	speed: 0.0229s/iter; left time: 230.2524s
	iters: 300, epoch: 3 | loss: 0.2403831
	speed: 0.0201s/iter; left time: 200.5310s
	iters: 400, epoch: 3 | loss: 0.3108187
	speed: 0.0199s/iter; left time: 196.5836s
	iters: 500, epoch: 3 | loss: 0.2263505
	speed: 0.0199s/iter; left time: 194.1935s
Epoch: 3 cost time: 12.250823974609375
Epoch: 3, Steps: 570 | Train Loss: 0.2863737 Vali Loss: 0.0574125 Test Loss: 0.1785491
Validation loss decreased (0.059320 --> 0.057412).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1871123
	speed: 0.0610s/iter; left time: 584.6445s
	iters: 200, epoch: 4 | loss: 0.4362315
	speed: 0.0231s/iter; left time: 219.7141s
	iters: 300, epoch: 4 | loss: 0.1889185
	speed: 0.0230s/iter; left time: 216.3790s
	iters: 400, epoch: 4 | loss: 0.3111944
	speed: 0.0230s/iter; left time: 213.7822s
	iters: 500, epoch: 4 | loss: 0.2549295
	speed: 0.0230s/iter; left time: 211.5311s
Epoch: 4 cost time: 13.408647060394287
Epoch: 4, Steps: 570 | Train Loss: 0.2795380 Vali Loss: 0.0561090 Test Loss: 0.1779663
Validation loss decreased (0.057412 --> 0.056109).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2125192
	speed: 0.0629s/iter; left time: 567.4766s
	iters: 200, epoch: 5 | loss: 0.4154832
	speed: 0.0199s/iter; left time: 177.2117s
	iters: 300, epoch: 5 | loss: 0.2792998
	speed: 0.0204s/iter; left time: 179.7619s
	iters: 400, epoch: 5 | loss: 0.2566292
	speed: 0.0202s/iter; left time: 176.5462s
	iters: 500, epoch: 5 | loss: 0.2601840
	speed: 0.0200s/iter; left time: 172.0535s
Epoch: 5 cost time: 11.902328729629517
Epoch: 5, Steps: 570 | Train Loss: 0.2737351 Vali Loss: 0.0549476 Test Loss: 0.1725564
Validation loss decreased (0.056109 --> 0.054948).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2915027
	speed: 0.0596s/iter; left time: 503.7014s
	iters: 200, epoch: 6 | loss: 0.3348244
	speed: 0.0200s/iter; left time: 167.3303s
	iters: 300, epoch: 6 | loss: 0.2264638
	speed: 0.0228s/iter; left time: 187.9847s
	iters: 400, epoch: 6 | loss: 0.1717149
	speed: 0.0231s/iter; left time: 188.1321s
	iters: 500, epoch: 6 | loss: 0.4397480
	speed: 0.0231s/iter; left time: 185.9946s
Epoch: 6 cost time: 12.789848327636719
Epoch: 6, Steps: 570 | Train Loss: 0.2703186 Vali Loss: 0.0569620 Test Loss: 0.1734173
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2637268
	speed: 0.0656s/iter; left time: 517.2531s
	iters: 200, epoch: 7 | loss: 0.3531766
	speed: 0.0231s/iter; left time: 179.4752s
	iters: 300, epoch: 7 | loss: 0.3463317
	speed: 0.0230s/iter; left time: 176.7654s
	iters: 400, epoch: 7 | loss: 0.4386382
	speed: 0.0230s/iter; left time: 174.4375s
	iters: 500, epoch: 7 | loss: 0.2172431
	speed: 0.0230s/iter; left time: 172.1071s
Epoch: 7 cost time: 13.40550708770752
Epoch: 7, Steps: 570 | Train Loss: 0.2691676 Vali Loss: 0.0567912 Test Loss: 0.1732228
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3699332
	speed: 0.0635s/iter; left time: 464.0234s
	iters: 200, epoch: 8 | loss: 0.4399229
	speed: 0.0230s/iter; left time: 165.9900s
	iters: 300, epoch: 8 | loss: 0.3686683
	speed: 0.0229s/iter; left time: 163.1498s
	iters: 400, epoch: 8 | loss: 0.1899306
	speed: 0.0230s/iter; left time: 161.4155s
	iters: 500, epoch: 8 | loss: 0.2714485
	speed: 0.0230s/iter; left time: 159.1882s
Epoch: 8 cost time: 13.35611891746521
Epoch: 8, Steps: 570 | Train Loss: 0.2673023 Vali Loss: 0.0567289 Test Loss: 0.1723476
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17274320125579834, mae:0.26128432154655457
>>> S LR=5e-4 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1718818
	speed: 0.0212s/iter; left time: 239.1816s
	iters: 200, epoch: 1 | loss: 0.1595209
	speed: 0.0099s/iter; left time: 110.7362s
	iters: 300, epoch: 1 | loss: 0.1596591
	speed: 0.0099s/iter; left time: 110.2401s
	iters: 400, epoch: 1 | loss: 0.1815952
	speed: 0.0099s/iter; left time: 108.9520s
	iters: 500, epoch: 1 | loss: 0.1253047
	speed: 0.0099s/iter; left time: 108.0800s
Epoch: 1 cost time: 6.824685573577881
Epoch: 1, Steps: 570 | Train Loss: 0.1796653 Vali Loss: 0.0442205 Test Loss: 0.1464651
Validation loss decreased (inf --> 0.044220).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2127716
	speed: 0.0352s/iter; left time: 377.8216s
	iters: 200, epoch: 2 | loss: 0.1784219
	speed: 0.0098s/iter; left time: 104.6825s
	iters: 300, epoch: 2 | loss: 0.1212488
	speed: 0.0098s/iter; left time: 103.4121s
	iters: 400, epoch: 2 | loss: 0.1186540
	speed: 0.0098s/iter; left time: 102.5982s
	iters: 500, epoch: 2 | loss: 0.1481479
	speed: 0.0098s/iter; left time: 101.5042s
Epoch: 2 cost time: 5.867929697036743
Epoch: 2, Steps: 570 | Train Loss: 0.1501268 Vali Loss: 0.0457278 Test Loss: 0.1474276
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0967351
	speed: 0.0353s/iter; left time: 358.4641s
	iters: 200, epoch: 3 | loss: 0.1052054
	speed: 0.0099s/iter; left time: 99.3500s
	iters: 300, epoch: 3 | loss: 0.1262204
	speed: 0.0099s/iter; left time: 98.5381s
	iters: 400, epoch: 3 | loss: 0.1031451
	speed: 0.0099s/iter; left time: 97.4346s
	iters: 500, epoch: 3 | loss: 0.1378912
	speed: 0.0099s/iter; left time: 96.3452s
Epoch: 3 cost time: 5.887269020080566
Epoch: 3, Steps: 570 | Train Loss: 0.1147015 Vali Loss: 0.0407662 Test Loss: 0.1396664
Validation loss decreased (0.044220 --> 0.040766).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1042625
	speed: 0.0338s/iter; left time: 323.8853s
	iters: 200, epoch: 4 | loss: 0.0748538
	speed: 0.0100s/iter; left time: 94.7023s
	iters: 300, epoch: 4 | loss: 0.0804718
	speed: 0.0099s/iter; left time: 93.3482s
	iters: 400, epoch: 4 | loss: 0.0842432
	speed: 0.0099s/iter; left time: 92.1629s
	iters: 500, epoch: 4 | loss: 0.0689169
	speed: 0.0099s/iter; left time: 91.0048s
Epoch: 4 cost time: 5.926207780838013
Epoch: 4, Steps: 570 | Train Loss: 0.0824008 Vali Loss: 0.0428669 Test Loss: 0.1435827
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0863056
	speed: 0.0367s/iter; left time: 331.1134s
	iters: 200, epoch: 5 | loss: 0.0573702
	speed: 0.0111s/iter; left time: 99.1006s
	iters: 300, epoch: 5 | loss: 0.0469354
	speed: 0.0111s/iter; left time: 97.6795s
	iters: 400, epoch: 5 | loss: 0.0495048
	speed: 0.0106s/iter; left time: 92.7042s
	iters: 500, epoch: 5 | loss: 0.0619961
	speed: 0.0098s/iter; left time: 84.8661s
Epoch: 5 cost time: 6.367866277694702
Epoch: 5, Steps: 570 | Train Loss: 0.0640097 Vali Loss: 0.0425108 Test Loss: 0.1465514
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0465391
	speed: 0.0341s/iter; left time: 288.5708s
	iters: 200, epoch: 6 | loss: 0.0417024
	speed: 0.0098s/iter; left time: 82.0007s
	iters: 300, epoch: 6 | loss: 0.0501468
	speed: 0.0098s/iter; left time: 81.1332s
	iters: 400, epoch: 6 | loss: 0.0615013
	speed: 0.0099s/iter; left time: 80.5709s
	iters: 500, epoch: 6 | loss: 0.0592014
	speed: 0.0099s/iter; left time: 79.5278s
Epoch: 6 cost time: 5.835393190383911
Epoch: 6, Steps: 570 | Train Loss: 0.0542754 Vali Loss: 0.0434482 Test Loss: 0.1465269
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13985727727413177, mae:0.2399178147315979
>>> S LR=5e-4 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1946842
	speed: 0.0227s/iter; left time: 256.5297s
	iters: 200, epoch: 1 | loss: 0.1284400
	speed: 0.0109s/iter; left time: 121.9704s
	iters: 300, epoch: 1 | loss: 0.1731768
	speed: 0.0108s/iter; left time: 120.0071s
	iters: 400, epoch: 1 | loss: 0.1338004
	speed: 0.0100s/iter; left time: 109.8015s
	iters: 500, epoch: 1 | loss: 0.1225797
	speed: 0.0098s/iter; left time: 106.3020s
Epoch: 1 cost time: 7.210299491882324
Epoch: 1, Steps: 570 | Train Loss: 0.1422112 Vali Loss: 0.0359583 Test Loss: 0.1207414
Validation loss decreased (inf --> 0.035958).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1222781
	speed: 0.0356s/iter; left time: 382.3028s
	iters: 200, epoch: 2 | loss: 0.1406978
	speed: 0.0097s/iter; left time: 103.2759s
	iters: 300, epoch: 2 | loss: 0.0676287
	speed: 0.0097s/iter; left time: 102.0484s
	iters: 400, epoch: 2 | loss: 0.0741975
	speed: 0.0097s/iter; left time: 101.5399s
	iters: 500, epoch: 2 | loss: 0.1048957
	speed: 0.0097s/iter; left time: 100.1227s
Epoch: 2 cost time: 5.796389579772949
Epoch: 2, Steps: 570 | Train Loss: 0.1152710 Vali Loss: 0.0345513 Test Loss: 0.1262106
Validation loss decreased (0.035958 --> 0.034551).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0529554
	speed: 0.0346s/iter; left time: 351.7882s
	iters: 200, epoch: 3 | loss: 0.1007998
	speed: 0.0097s/iter; left time: 97.8519s
	iters: 300, epoch: 3 | loss: 0.1983634
	speed: 0.0098s/iter; left time: 97.1355s
	iters: 400, epoch: 3 | loss: 0.0803276
	speed: 0.0096s/iter; left time: 94.3722s
	iters: 500, epoch: 3 | loss: 0.0707404
	speed: 0.0096s/iter; left time: 93.4391s
Epoch: 3 cost time: 5.793292760848999
Epoch: 3, Steps: 570 | Train Loss: 0.0894767 Vali Loss: 0.0326783 Test Loss: 0.1224590
Validation loss decreased (0.034551 --> 0.032678).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0473548
	speed: 0.0345s/iter; left time: 331.0471s
	iters: 200, epoch: 4 | loss: 0.0536950
	speed: 0.0097s/iter; left time: 91.7759s
	iters: 300, epoch: 4 | loss: 0.0560383
	speed: 0.0097s/iter; left time: 90.8805s
	iters: 400, epoch: 4 | loss: 0.0666288
	speed: 0.0097s/iter; left time: 89.6906s
	iters: 500, epoch: 4 | loss: 0.0803938
	speed: 0.0096s/iter; left time: 88.6501s
Epoch: 4 cost time: 5.778690814971924
Epoch: 4, Steps: 570 | Train Loss: 0.0674367 Vali Loss: 0.0318656 Test Loss: 0.1224221
Validation loss decreased (0.032678 --> 0.031866).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0591036
	speed: 0.0348s/iter; left time: 314.0373s
	iters: 200, epoch: 5 | loss: 0.0809502
	speed: 0.0098s/iter; left time: 87.2316s
	iters: 300, epoch: 5 | loss: 0.0628631
	speed: 0.0097s/iter; left time: 85.4558s
	iters: 400, epoch: 5 | loss: 0.0695087
	speed: 0.0096s/iter; left time: 83.9777s
	iters: 500, epoch: 5 | loss: 0.0692823
	speed: 0.0097s/iter; left time: 83.2383s
Epoch: 5 cost time: 5.884444236755371
Epoch: 5, Steps: 570 | Train Loss: 0.0528121 Vali Loss: 0.0331567 Test Loss: 0.1287394
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0373111
	speed: 0.0348s/iter; left time: 294.2292s
	iters: 200, epoch: 6 | loss: 0.0798442
	speed: 0.0102s/iter; left time: 84.9393s
	iters: 300, epoch: 6 | loss: 0.0534675
	speed: 0.0096s/iter; left time: 79.3291s
	iters: 400, epoch: 6 | loss: 0.0376032
	speed: 0.0097s/iter; left time: 78.7523s
	iters: 500, epoch: 6 | loss: 0.0355263
	speed: 0.0108s/iter; left time: 86.6350s
Epoch: 6 cost time: 6.1300530433654785
Epoch: 6, Steps: 570 | Train Loss: 0.0450295 Vali Loss: 0.0341421 Test Loss: 0.1323058
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0388438
	speed: 0.0379s/iter; left time: 298.8784s
	iters: 200, epoch: 7 | loss: 0.0389921
	speed: 0.0109s/iter; left time: 84.5620s
	iters: 300, epoch: 7 | loss: 0.0649892
	speed: 0.0109s/iter; left time: 83.6164s
	iters: 400, epoch: 7 | loss: 0.0903117
	speed: 0.0109s/iter; left time: 82.3212s
	iters: 500, epoch: 7 | loss: 0.0509430
	speed: 0.0105s/iter; left time: 78.4408s
Epoch: 7 cost time: 6.3177878856658936
Epoch: 7, Steps: 570 | Train Loss: 0.0411991 Vali Loss: 0.0341995 Test Loss: 0.1327949
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.122578464448452, mae:0.21027712523937225
>>> S LR=5e-4 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1629260
	speed: 0.0212s/iter; left time: 239.2737s
	iters: 200, epoch: 1 | loss: 0.1374123
	speed: 0.0096s/iter; left time: 108.0521s
	iters: 300, epoch: 1 | loss: 0.1414216
	speed: 0.0097s/iter; left time: 107.3911s
	iters: 400, epoch: 1 | loss: 0.0967721
	speed: 0.0096s/iter; left time: 106.1441s
	iters: 500, epoch: 1 | loss: 0.1652331
	speed: 0.0097s/iter; left time: 105.3394s
Epoch: 1 cost time: 6.701557159423828
Epoch: 1, Steps: 570 | Train Loss: 0.1871506 Vali Loss: 0.0400078 Test Loss: 0.1431024
Validation loss decreased (inf --> 0.040008).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1495398
	speed: 0.0338s/iter; left time: 362.7146s
	iters: 200, epoch: 2 | loss: 0.1861261
	speed: 0.0097s/iter; left time: 102.7301s
	iters: 300, epoch: 2 | loss: 0.1638849
	speed: 0.0096s/iter; left time: 101.6022s
	iters: 400, epoch: 2 | loss: 0.1628654
	speed: 0.0097s/iter; left time: 100.6763s
	iters: 500, epoch: 2 | loss: 0.1856931
	speed: 0.0097s/iter; left time: 99.7506s
Epoch: 2 cost time: 5.766857862472534
Epoch: 2, Steps: 570 | Train Loss: 0.1447234 Vali Loss: 0.0468338 Test Loss: 0.1513646
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0980992
	speed: 0.0341s/iter; left time: 346.0206s
	iters: 200, epoch: 3 | loss: 0.0689266
	speed: 0.0097s/iter; left time: 97.1915s
	iters: 300, epoch: 3 | loss: 0.1178586
	speed: 0.0096s/iter; left time: 95.9122s
	iters: 400, epoch: 3 | loss: 0.0835281
	speed: 0.0097s/iter; left time: 95.4930s
	iters: 500, epoch: 3 | loss: 0.0571251
	speed: 0.0111s/iter; left time: 108.3737s
Epoch: 3 cost time: 6.002748966217041
Epoch: 3, Steps: 570 | Train Loss: 0.0989020 Vali Loss: 0.0450056 Test Loss: 0.1656332
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0521493
	speed: 0.0360s/iter; left time: 344.8553s
	iters: 200, epoch: 4 | loss: 0.0427834
	speed: 0.0111s/iter; left time: 104.9220s
	iters: 300, epoch: 4 | loss: 0.0577061
	speed: 0.0111s/iter; left time: 104.1523s
	iters: 400, epoch: 4 | loss: 0.0709343
	speed: 0.0111s/iter; left time: 102.9266s
	iters: 500, epoch: 4 | loss: 0.0511694
	speed: 0.0111s/iter; left time: 101.8539s
Epoch: 4 cost time: 6.546318769454956
Epoch: 4, Steps: 570 | Train Loss: 0.0633471 Vali Loss: 0.0469269 Test Loss: 0.1632538
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14315493404865265, mae:0.24366213381290436
>>> S LR=5e-4 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1933035
	speed: 0.0243s/iter; left time: 274.8030s
	iters: 200, epoch: 1 | loss: 0.2078391
	speed: 0.0113s/iter; left time: 126.4378s
	iters: 300, epoch: 1 | loss: 0.1277916
	speed: 0.0113s/iter; left time: 125.1241s
	iters: 400, epoch: 1 | loss: 0.1161121
	speed: 0.0113s/iter; left time: 124.3042s
	iters: 500, epoch: 1 | loss: 0.1869148
	speed: 0.0113s/iter; left time: 123.3329s
Epoch: 1 cost time: 7.791023015975952
Epoch: 1, Steps: 570 | Train Loss: 0.1956599 Vali Loss: 0.0426578 Test Loss: 0.1286530
Validation loss decreased (inf --> 0.042658).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1558401
	speed: 0.0387s/iter; left time: 415.3334s
	iters: 200, epoch: 2 | loss: 0.1862107
	speed: 0.0117s/iter; left time: 123.9485s
	iters: 300, epoch: 2 | loss: 0.0876824
	speed: 0.0113s/iter; left time: 118.8946s
	iters: 400, epoch: 2 | loss: 0.0736698
	speed: 0.0113s/iter; left time: 117.6658s
	iters: 500, epoch: 2 | loss: 0.1542210
	speed: 0.0113s/iter; left time: 116.7849s
Epoch: 2 cost time: 6.857756614685059
Epoch: 2, Steps: 570 | Train Loss: 0.1622182 Vali Loss: 0.0441821 Test Loss: 0.1393162
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1893715
	speed: 0.0401s/iter; left time: 407.7225s
	iters: 200, epoch: 3 | loss: 0.1537885
	speed: 0.0123s/iter; left time: 124.0210s
	iters: 300, epoch: 3 | loss: 0.0883062
	speed: 0.0115s/iter; left time: 114.4896s
	iters: 400, epoch: 3 | loss: 0.1231996
	speed: 0.0113s/iter; left time: 111.4587s
	iters: 500, epoch: 3 | loss: 0.0870374
	speed: 0.0113s/iter; left time: 110.7587s
Epoch: 3 cost time: 6.953029632568359
Epoch: 3, Steps: 570 | Train Loss: 0.1405309 Vali Loss: 0.0429599 Test Loss: 0.1390001
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1332887
	speed: 0.0386s/iter; left time: 370.3582s
	iters: 200, epoch: 4 | loss: 0.0959157
	speed: 0.0113s/iter; left time: 107.5521s
	iters: 300, epoch: 4 | loss: 0.0701366
	speed: 0.0113s/iter; left time: 106.3797s
	iters: 400, epoch: 4 | loss: 0.0786077
	speed: 0.0113s/iter; left time: 105.0222s
	iters: 500, epoch: 4 | loss: 0.1192468
	speed: 0.0113s/iter; left time: 104.2031s
Epoch: 4 cost time: 6.766961336135864
Epoch: 4, Steps: 570 | Train Loss: 0.1195012 Vali Loss: 0.0403171 Test Loss: 0.1450133
Validation loss decreased (0.042658 --> 0.040317).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0958360
	speed: 0.0369s/iter; left time: 332.7443s
	iters: 200, epoch: 5 | loss: 0.0965206
	speed: 0.0113s/iter; left time: 100.8095s
	iters: 300, epoch: 5 | loss: 0.1500335
	speed: 0.0113s/iter; left time: 99.6389s
	iters: 400, epoch: 5 | loss: 0.0898062
	speed: 0.0113s/iter; left time: 98.5749s
	iters: 500, epoch: 5 | loss: 0.1160884
	speed: 0.0113s/iter; left time: 97.2680s
Epoch: 5 cost time: 6.696016311645508
Epoch: 5, Steps: 570 | Train Loss: 0.1004565 Vali Loss: 0.0405266 Test Loss: 0.1693660
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0760101
	speed: 0.0381s/iter; left time: 322.2153s
	iters: 200, epoch: 6 | loss: 0.0509363
	speed: 0.0113s/iter; left time: 94.3260s
	iters: 300, epoch: 6 | loss: 0.0823817
	speed: 0.0113s/iter; left time: 93.5739s
	iters: 400, epoch: 6 | loss: 0.0676192
	speed: 0.0113s/iter; left time: 92.4267s
	iters: 500, epoch: 6 | loss: 0.0716028
	speed: 0.0113s/iter; left time: 91.0196s
Epoch: 6 cost time: 6.729692220687866
Epoch: 6, Steps: 570 | Train Loss: 0.0863336 Vali Loss: 0.0416049 Test Loss: 0.1712117
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0642638
	speed: 0.0371s/iter; left time: 292.2880s
	iters: 200, epoch: 7 | loss: 0.0814649
	speed: 0.0113s/iter; left time: 88.2628s
	iters: 300, epoch: 7 | loss: 0.0982016
	speed: 0.0114s/iter; left time: 87.3162s
	iters: 400, epoch: 7 | loss: 0.0583106
	speed: 0.0113s/iter; left time: 85.9733s
	iters: 500, epoch: 7 | loss: 0.0756520
	speed: 0.0114s/iter; left time: 84.9419s
Epoch: 7 cost time: 6.738990783691406
Epoch: 7, Steps: 570 | Train Loss: 0.0778783 Vali Loss: 0.0423194 Test Loss: 0.1747668
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14523299038410187, mae:0.24154354631900787
>>> S LR=5e-4 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1345699
	speed: 0.0223s/iter; left time: 252.1030s
	iters: 200, epoch: 1 | loss: 0.2013828
	speed: 0.0108s/iter; left time: 121.4629s
	iters: 300, epoch: 1 | loss: 0.1191196
	speed: 0.0109s/iter; left time: 120.4763s
	iters: 400, epoch: 1 | loss: 0.1587137
	speed: 0.0108s/iter; left time: 119.2746s
	iters: 500, epoch: 1 | loss: 0.0880587
	speed: 0.0108s/iter; left time: 118.2110s
Epoch: 1 cost time: 7.378371000289917
Epoch: 1, Steps: 570 | Train Loss: 0.1530826 Vali Loss: 0.0395673 Test Loss: 0.1278623
Validation loss decreased (inf --> 0.039567).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1201055
	speed: 0.0379s/iter; left time: 407.2108s
	iters: 200, epoch: 2 | loss: 0.0678575
	speed: 0.0119s/iter; left time: 126.6352s
	iters: 300, epoch: 2 | loss: 0.1191465
	speed: 0.0119s/iter; left time: 125.7048s
	iters: 400, epoch: 2 | loss: 0.1723215
	speed: 0.0119s/iter; left time: 124.3270s
	iters: 500, epoch: 2 | loss: 0.1336715
	speed: 0.0119s/iter; left time: 123.3568s
Epoch: 2 cost time: 7.082749366760254
Epoch: 2, Steps: 570 | Train Loss: 0.1279393 Vali Loss: 0.0435935 Test Loss: 0.1454291
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1387403
	speed: 0.0370s/iter; left time: 375.8185s
	iters: 200, epoch: 3 | loss: 0.0665396
	speed: 0.0109s/iter; left time: 109.6701s
	iters: 300, epoch: 3 | loss: 0.1319540
	speed: 0.0109s/iter; left time: 108.5806s
	iters: 400, epoch: 3 | loss: 0.1061264
	speed: 0.0109s/iter; left time: 107.6852s
	iters: 500, epoch: 3 | loss: 0.1143754
	speed: 0.0109s/iter; left time: 106.7598s
Epoch: 3 cost time: 6.506247520446777
Epoch: 3, Steps: 570 | Train Loss: 0.1166825 Vali Loss: 0.0318869 Test Loss: 0.1143509
Validation loss decreased (0.039567 --> 0.031887).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1211946
	speed: 0.0367s/iter; left time: 352.4653s
	iters: 200, epoch: 4 | loss: 0.0612716
	speed: 0.0109s/iter; left time: 103.4262s
	iters: 300, epoch: 4 | loss: 0.0438931
	speed: 0.0109s/iter; left time: 102.2911s
	iters: 400, epoch: 4 | loss: 0.1198011
	speed: 0.0109s/iter; left time: 101.3681s
	iters: 500, epoch: 4 | loss: 0.0757641
	speed: 0.0109s/iter; left time: 100.2595s
Epoch: 4 cost time: 6.4856648445129395
Epoch: 4, Steps: 570 | Train Loss: 0.0952717 Vali Loss: 0.0322774 Test Loss: 0.1182455
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0794661
	speed: 0.0352s/iter; left time: 317.4394s
	iters: 200, epoch: 5 | loss: 0.0708052
	speed: 0.0109s/iter; left time: 96.9785s
	iters: 300, epoch: 5 | loss: 0.0926405
	speed: 0.0109s/iter; left time: 95.8099s
	iters: 400, epoch: 5 | loss: 0.0958459
	speed: 0.0109s/iter; left time: 94.8909s
	iters: 500, epoch: 5 | loss: 0.0721609
	speed: 0.0108s/iter; left time: 93.4653s
Epoch: 5 cost time: 6.442713260650635
Epoch: 5, Steps: 570 | Train Loss: 0.0806790 Vali Loss: 0.0323997 Test Loss: 0.1211706
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1058825
	speed: 0.0350s/iter; left time: 295.6421s
	iters: 200, epoch: 6 | loss: 0.0597177
	speed: 0.0109s/iter; left time: 90.7392s
	iters: 300, epoch: 6 | loss: 0.0632827
	speed: 0.0116s/iter; left time: 95.8875s
	iters: 400, epoch: 6 | loss: 0.0549950
	speed: 0.0119s/iter; left time: 97.2120s
	iters: 500, epoch: 6 | loss: 0.0706024
	speed: 0.0119s/iter; left time: 95.8280s
Epoch: 6 cost time: 6.774564981460571
Epoch: 6, Steps: 570 | Train Loss: 0.0712253 Vali Loss: 0.0321014 Test Loss: 0.1266290
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11452759802341461, mae:0.20647169649600983
>>> S LR=5e-4 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1770618
	speed: 0.0222s/iter; left time: 250.5944s
	iters: 200, epoch: 1 | loss: 0.2039944
	speed: 0.0103s/iter; left time: 115.2181s
	iters: 300, epoch: 1 | loss: 0.2188654
	speed: 0.0103s/iter; left time: 113.8699s
	iters: 400, epoch: 1 | loss: 0.1317433
	speed: 0.0105s/iter; left time: 115.0906s
	iters: 500, epoch: 1 | loss: 0.1226112
	speed: 0.0113s/iter; left time: 122.8438s
Epoch: 1 cost time: 7.279428958892822
Epoch: 1, Steps: 570 | Train Loss: 0.1975391 Vali Loss: 0.0490726 Test Loss: 0.1550048
Validation loss decreased (inf --> 0.049073).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1419985
	speed: 0.0363s/iter; left time: 389.5765s
	iters: 200, epoch: 2 | loss: 0.2844192
	speed: 0.0102s/iter; left time: 108.8432s
	iters: 300, epoch: 2 | loss: 0.1432899
	speed: 0.0102s/iter; left time: 107.5387s
	iters: 400, epoch: 2 | loss: 0.1278157
	speed: 0.0102s/iter; left time: 106.5626s
	iters: 500, epoch: 2 | loss: 0.1416680
	speed: 0.0102s/iter; left time: 105.3974s
Epoch: 2 cost time: 6.105123043060303
Epoch: 2, Steps: 570 | Train Loss: 0.1648325 Vali Loss: 0.0638713 Test Loss: 0.1900457
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1438260
	speed: 0.0349s/iter; left time: 354.4704s
	iters: 200, epoch: 3 | loss: 0.1163523
	speed: 0.0103s/iter; left time: 103.1607s
	iters: 300, epoch: 3 | loss: 0.2467229
	speed: 0.0102s/iter; left time: 101.9866s
	iters: 400, epoch: 3 | loss: 0.1003563
	speed: 0.0102s/iter; left time: 100.6945s
	iters: 500, epoch: 3 | loss: 0.1639535
	speed: 0.0102s/iter; left time: 99.8707s
Epoch: 3 cost time: 6.073726654052734
Epoch: 3, Steps: 570 | Train Loss: 0.1442985 Vali Loss: 0.0411207 Test Loss: 0.1525982
Validation loss decreased (0.049073 --> 0.041121).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1482446
	speed: 0.0360s/iter; left time: 345.3840s
	iters: 200, epoch: 4 | loss: 0.0937371
	speed: 0.0102s/iter; left time: 96.5342s
	iters: 300, epoch: 4 | loss: 0.0946253
	speed: 0.0102s/iter; left time: 95.8387s
	iters: 400, epoch: 4 | loss: 0.1538177
	speed: 0.0102s/iter; left time: 94.7242s
	iters: 500, epoch: 4 | loss: 0.1057592
	speed: 0.0102s/iter; left time: 93.6351s
Epoch: 4 cost time: 6.076680898666382
Epoch: 4, Steps: 570 | Train Loss: 0.1046789 Vali Loss: 0.0426414 Test Loss: 0.1682603
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0732455
	speed: 0.0348s/iter; left time: 314.0287s
	iters: 200, epoch: 5 | loss: 0.0839683
	speed: 0.0102s/iter; left time: 91.1349s
	iters: 300, epoch: 5 | loss: 0.1047761
	speed: 0.0102s/iter; left time: 90.2637s
	iters: 400, epoch: 5 | loss: 0.0424865
	speed: 0.0102s/iter; left time: 89.2630s
	iters: 500, epoch: 5 | loss: 0.1162970
	speed: 0.0102s/iter; left time: 88.1587s
Epoch: 5 cost time: 6.094550848007202
Epoch: 5, Steps: 570 | Train Loss: 0.0800934 Vali Loss: 0.0409278 Test Loss: 0.1564184
Validation loss decreased (0.041121 --> 0.040928).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0626791
	speed: 0.0355s/iter; left time: 300.1867s
	iters: 200, epoch: 6 | loss: 0.0660317
	speed: 0.0113s/iter; left time: 94.3098s
	iters: 300, epoch: 6 | loss: 0.0776940
	speed: 0.0114s/iter; left time: 93.7300s
	iters: 400, epoch: 6 | loss: 0.0662020
	speed: 0.0113s/iter; left time: 92.0482s
	iters: 500, epoch: 6 | loss: 0.0607864
	speed: 0.0113s/iter; left time: 90.9088s
Epoch: 6 cost time: 6.687594413757324
Epoch: 6, Steps: 570 | Train Loss: 0.0641329 Vali Loss: 0.0415917 Test Loss: 0.1618884
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0351635
	speed: 0.0344s/iter; left time: 271.2540s
	iters: 200, epoch: 7 | loss: 0.0627677
	speed: 0.0102s/iter; left time: 79.6416s
	iters: 300, epoch: 7 | loss: 0.0378260
	speed: 0.0102s/iter; left time: 78.5625s
	iters: 400, epoch: 7 | loss: 0.0653122
	speed: 0.0102s/iter; left time: 77.6611s
	iters: 500, epoch: 7 | loss: 0.0428902
	speed: 0.0102s/iter; left time: 76.5327s
Epoch: 7 cost time: 6.084474086761475
Epoch: 7, Steps: 570 | Train Loss: 0.0555785 Vali Loss: 0.0419646 Test Loss: 0.1688446
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0454386
	speed: 0.0343s/iter; left time: 250.5421s
	iters: 200, epoch: 8 | loss: 0.0774186
	speed: 0.0102s/iter; left time: 73.3586s
	iters: 300, epoch: 8 | loss: 0.0428058
	speed: 0.0102s/iter; left time: 72.2493s
	iters: 400, epoch: 8 | loss: 0.0731118
	speed: 0.0102s/iter; left time: 71.3756s
	iters: 500, epoch: 8 | loss: 0.0427106
	speed: 0.0102s/iter; left time: 70.3673s
Epoch: 8 cost time: 6.046316862106323
Epoch: 8, Steps: 570 | Train Loss: 0.0512238 Vali Loss: 0.0420652 Test Loss: 0.1680260
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15655644237995148, mae:0.2555285692214966
>>> S LR=5e-4 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2163997
	speed: 0.0270s/iter; left time: 304.7250s
	iters: 200, epoch: 1 | loss: 0.1392673
	speed: 0.0147s/iter; left time: 164.9057s
	iters: 300, epoch: 1 | loss: 0.2268258
	speed: 0.0152s/iter; left time: 168.9199s
	iters: 400, epoch: 1 | loss: 0.1352587
	speed: 0.0152s/iter; left time: 167.5163s
	iters: 500, epoch: 1 | loss: 0.1345660
	speed: 0.0153s/iter; left time: 166.2825s
Epoch: 1 cost time: 9.862399339675903
Epoch: 1, Steps: 570 | Train Loss: 0.1841749 Vali Loss: 0.0458134 Test Loss: 0.1571105
Validation loss decreased (inf --> 0.045813).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2034574
	speed: 0.0448s/iter; left time: 480.7105s
	iters: 200, epoch: 2 | loss: 0.1654037
	speed: 0.0136s/iter; left time: 144.9350s
	iters: 300, epoch: 2 | loss: 0.1072069
	speed: 0.0136s/iter; left time: 143.3055s
	iters: 400, epoch: 2 | loss: 0.0754857
	speed: 0.0136s/iter; left time: 141.9854s
	iters: 500, epoch: 2 | loss: 0.1628841
	speed: 0.0136s/iter; left time: 140.5414s
Epoch: 2 cost time: 8.032966136932373
Epoch: 2, Steps: 570 | Train Loss: 0.1494540 Vali Loss: 0.0435583 Test Loss: 0.1534010
Validation loss decreased (0.045813 --> 0.043558).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2412927
	speed: 0.0430s/iter; left time: 437.2597s
	iters: 200, epoch: 3 | loss: 0.1395777
	speed: 0.0136s/iter; left time: 136.8503s
	iters: 300, epoch: 3 | loss: 0.0796215
	speed: 0.0136s/iter; left time: 135.7534s
	iters: 400, epoch: 3 | loss: 0.0820442
	speed: 0.0136s/iter; left time: 134.3064s
	iters: 500, epoch: 3 | loss: 0.0816671
	speed: 0.0136s/iter; left time: 132.8628s
Epoch: 3 cost time: 8.012795686721802
Epoch: 3, Steps: 570 | Train Loss: 0.1112254 Vali Loss: 0.0440843 Test Loss: 0.1581463
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0789885
	speed: 0.0438s/iter; left time: 419.7609s
	iters: 200, epoch: 4 | loss: 0.0655723
	speed: 0.0135s/iter; left time: 128.5325s
	iters: 300, epoch: 4 | loss: 0.0809770
	speed: 0.0135s/iter; left time: 127.0187s
	iters: 400, epoch: 4 | loss: 0.0835842
	speed: 0.0136s/iter; left time: 126.0913s
	iters: 500, epoch: 4 | loss: 0.0521429
	speed: 0.0135s/iter; left time: 124.3285s
Epoch: 4 cost time: 7.982851028442383
Epoch: 4, Steps: 570 | Train Loss: 0.0771908 Vali Loss: 0.0451783 Test Loss: 0.1457593
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0677031
	speed: 0.0431s/iter; left time: 389.0098s
	iters: 200, epoch: 5 | loss: 0.0494241
	speed: 0.0136s/iter; left time: 121.1341s
	iters: 300, epoch: 5 | loss: 0.0598884
	speed: 0.0136s/iter; left time: 119.7198s
	iters: 400, epoch: 5 | loss: 0.0545777
	speed: 0.0136s/iter; left time: 118.3554s
	iters: 500, epoch: 5 | loss: 0.0396014
	speed: 0.0136s/iter; left time: 116.8716s
Epoch: 5 cost time: 7.98996639251709
Epoch: 5, Steps: 570 | Train Loss: 0.0557546 Vali Loss: 0.0459573 Test Loss: 0.1512091
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15343472361564636, mae:0.23886887729167938
>>> S LR=5e-4 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2117953
	speed: 0.0252s/iter; left time: 285.1822s
	iters: 200, epoch: 1 | loss: 0.0973799
	speed: 0.0136s/iter; left time: 151.7855s
	iters: 300, epoch: 1 | loss: 0.1169118
	speed: 0.0135s/iter; left time: 149.6545s
	iters: 400, epoch: 1 | loss: 0.1767411
	speed: 0.0135s/iter; left time: 148.0626s
	iters: 500, epoch: 1 | loss: 0.1450280
	speed: 0.0135s/iter; left time: 147.6941s
Epoch: 1 cost time: 8.916553735733032
Epoch: 1, Steps: 570 | Train Loss: 0.1473592 Vali Loss: 0.0380400 Test Loss: 0.1253536
Validation loss decreased (inf --> 0.038040).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0982962
	speed: 0.0445s/iter; left time: 477.1333s
	iters: 200, epoch: 2 | loss: 0.1894981
	speed: 0.0135s/iter; left time: 143.7725s
	iters: 300, epoch: 2 | loss: 0.1248161
	speed: 0.0135s/iter; left time: 142.3574s
	iters: 400, epoch: 2 | loss: 0.1246464
	speed: 0.0134s/iter; left time: 139.7059s
	iters: 500, epoch: 2 | loss: 0.1076607
	speed: 0.0134s/iter; left time: 138.3019s
Epoch: 2 cost time: 7.9486939907073975
Epoch: 2, Steps: 570 | Train Loss: 0.1192751 Vali Loss: 0.0364229 Test Loss: 0.1237145
Validation loss decreased (0.038040 --> 0.036423).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1109911
	speed: 0.0436s/iter; left time: 442.9851s
	iters: 200, epoch: 3 | loss: 0.0494676
	speed: 0.0134s/iter; left time: 134.9245s
	iters: 300, epoch: 3 | loss: 0.1000286
	speed: 0.0134s/iter; left time: 133.5318s
	iters: 400, epoch: 3 | loss: 0.0646404
	speed: 0.0134s/iter; left time: 132.2687s
	iters: 500, epoch: 3 | loss: 0.0750461
	speed: 0.0134s/iter; left time: 130.5114s
Epoch: 3 cost time: 7.904469966888428
Epoch: 3, Steps: 570 | Train Loss: 0.0902822 Vali Loss: 0.0326060 Test Loss: 0.1160181
Validation loss decreased (0.036423 --> 0.032606).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0451907
	speed: 0.0453s/iter; left time: 434.2111s
	iters: 200, epoch: 4 | loss: 0.0658821
	speed: 0.0135s/iter; left time: 127.8576s
	iters: 300, epoch: 4 | loss: 0.0740142
	speed: 0.0135s/iter; left time: 126.3879s
	iters: 400, epoch: 4 | loss: 0.0553128
	speed: 0.0134s/iter; left time: 124.2880s
	iters: 500, epoch: 4 | loss: 0.0474787
	speed: 0.0134s/iter; left time: 123.1452s
Epoch: 4 cost time: 7.9289870262146
Epoch: 4, Steps: 570 | Train Loss: 0.0648548 Vali Loss: 0.0331448 Test Loss: 0.1212759
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0437976
	speed: 0.0444s/iter; left time: 400.1464s
	iters: 200, epoch: 5 | loss: 0.0400115
	speed: 0.0149s/iter; left time: 132.4863s
	iters: 300, epoch: 5 | loss: 0.0415143
	speed: 0.0139s/iter; left time: 122.3625s
	iters: 400, epoch: 5 | loss: 0.0340943
	speed: 0.0135s/iter; left time: 117.2994s
	iters: 500, epoch: 5 | loss: 0.0530394
	speed: 0.0134s/iter; left time: 115.6232s
Epoch: 5 cost time: 8.191228866577148
Epoch: 5, Steps: 570 | Train Loss: 0.0479350 Vali Loss: 0.0343330 Test Loss: 0.1245768
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0413680
	speed: 0.0438s/iter; left time: 370.4595s
	iters: 200, epoch: 6 | loss: 0.0566576
	speed: 0.0134s/iter; left time: 111.5487s
	iters: 300, epoch: 6 | loss: 0.0461372
	speed: 0.0134s/iter; left time: 110.3482s
	iters: 400, epoch: 6 | loss: 0.0628861
	speed: 0.0134s/iter; left time: 109.1697s
	iters: 500, epoch: 6 | loss: 0.0384020
	speed: 0.0134s/iter; left time: 108.1039s
Epoch: 6 cost time: 7.914224624633789
Epoch: 6, Steps: 570 | Train Loss: 0.0395349 Vali Loss: 0.0348278 Test Loss: 0.1219911
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11618558317422867, mae:0.20731154084205627
>>> S LR=5e-4 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.0995449
	speed: 0.0250s/iter; left time: 282.4877s
	iters: 200, epoch: 1 | loss: 0.2756792
	speed: 0.0134s/iter; left time: 150.4652s
	iters: 300, epoch: 1 | loss: 0.2960153
	speed: 0.0134s/iter; left time: 148.4277s
	iters: 400, epoch: 1 | loss: 0.1409389
	speed: 0.0134s/iter; left time: 147.1546s
	iters: 500, epoch: 1 | loss: 0.2040110
	speed: 0.0134s/iter; left time: 145.6658s
Epoch: 1 cost time: 8.839177131652832
Epoch: 1, Steps: 570 | Train Loss: 0.1918498 Vali Loss: 0.0461666 Test Loss: 0.1406551
Validation loss decreased (inf --> 0.046167).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1307454
	speed: 0.0437s/iter; left time: 468.4312s
	iters: 200, epoch: 2 | loss: 0.1203825
	speed: 0.0134s/iter; left time: 142.5810s
	iters: 300, epoch: 2 | loss: 0.0980335
	speed: 0.0134s/iter; left time: 141.4291s
	iters: 400, epoch: 2 | loss: 0.1032104
	speed: 0.0134s/iter; left time: 139.9033s
	iters: 500, epoch: 2 | loss: 0.1361401
	speed: 0.0134s/iter; left time: 138.8922s
Epoch: 2 cost time: 7.9426429271698
Epoch: 2, Steps: 570 | Train Loss: 0.1477434 Vali Loss: 0.0437605 Test Loss: 0.1500171
Validation loss decreased (0.046167 --> 0.043761).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1168405
	speed: 0.0435s/iter; left time: 441.9631s
	iters: 200, epoch: 3 | loss: 0.1325367
	speed: 0.0133s/iter; left time: 133.7617s
	iters: 300, epoch: 3 | loss: 0.0773962
	speed: 0.0133s/iter; left time: 132.8796s
	iters: 400, epoch: 3 | loss: 0.0800680
	speed: 0.0133s/iter; left time: 131.1684s
	iters: 500, epoch: 3 | loss: 0.1099601
	speed: 0.0133s/iter; left time: 129.5626s
Epoch: 3 cost time: 7.841682434082031
Epoch: 3, Steps: 570 | Train Loss: 0.1021728 Vali Loss: 0.0412560 Test Loss: 0.1708539
Validation loss decreased (0.043761 --> 0.041256).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0711046
	speed: 0.0455s/iter; left time: 436.3641s
	iters: 200, epoch: 4 | loss: 0.0569876
	speed: 0.0133s/iter; left time: 126.0254s
	iters: 300, epoch: 4 | loss: 0.0625518
	speed: 0.0133s/iter; left time: 124.7137s
	iters: 400, epoch: 4 | loss: 0.0541464
	speed: 0.0133s/iter; left time: 123.3143s
	iters: 500, epoch: 4 | loss: 0.0443482
	speed: 0.0133s/iter; left time: 121.9433s
Epoch: 4 cost time: 7.835681200027466
Epoch: 4, Steps: 570 | Train Loss: 0.0612333 Vali Loss: 0.0444778 Test Loss: 0.1624627
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0554216
	speed: 0.0426s/iter; left time: 384.4450s
	iters: 200, epoch: 5 | loss: 0.0522535
	speed: 0.0134s/iter; left time: 119.3142s
	iters: 300, epoch: 5 | loss: 0.0422896
	speed: 0.0134s/iter; left time: 117.8490s
	iters: 400, epoch: 5 | loss: 0.0716739
	speed: 0.0133s/iter; left time: 116.2634s
	iters: 500, epoch: 5 | loss: 0.0325516
	speed: 0.0133s/iter; left time: 114.8639s
Epoch: 5 cost time: 7.857933282852173
Epoch: 5, Steps: 570 | Train Loss: 0.0421752 Vali Loss: 0.0453984 Test Loss: 0.1590505
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0379111
	speed: 0.0427s/iter; left time: 360.4854s
	iters: 200, epoch: 6 | loss: 0.0395429
	speed: 0.0134s/iter; left time: 111.5807s
	iters: 300, epoch: 6 | loss: 0.0271840
	speed: 0.0134s/iter; left time: 110.1942s
	iters: 400, epoch: 6 | loss: 0.0525017
	speed: 0.0134s/iter; left time: 108.8968s
	iters: 500, epoch: 6 | loss: 0.0376882
	speed: 0.0134s/iter; left time: 107.5719s
Epoch: 6 cost time: 7.864906311035156
Epoch: 6, Steps: 570 | Train Loss: 0.0341151 Vali Loss: 0.0451136 Test Loss: 0.1600890
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.171049565076828, mae:0.2566578686237335
>>> S LR=5e-4 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2204235
	speed: 0.0275s/iter; left time: 311.3412s
	iters: 200, epoch: 1 | loss: 0.1627512
	speed: 0.0161s/iter; left time: 180.4093s
	iters: 300, epoch: 1 | loss: 0.2837867
	speed: 0.0161s/iter; left time: 178.8051s
	iters: 400, epoch: 1 | loss: 0.2176900
	speed: 0.0161s/iter; left time: 177.0468s
	iters: 500, epoch: 1 | loss: 0.1714303
	speed: 0.0161s/iter; left time: 175.6395s
Epoch: 1 cost time: 10.36951470375061
Epoch: 1, Steps: 570 | Train Loss: 0.1966453 Vali Loss: 0.0455215 Test Loss: 0.1446405
Validation loss decreased (inf --> 0.045522).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1744219
	speed: 0.0495s/iter; left time: 531.4209s
	iters: 200, epoch: 2 | loss: 0.2485345
	speed: 0.0162s/iter; left time: 172.5833s
	iters: 300, epoch: 2 | loss: 0.2050722
	speed: 0.0162s/iter; left time: 170.9170s
	iters: 400, epoch: 2 | loss: 0.2200931
	speed: 0.0162s/iter; left time: 169.0634s
	iters: 500, epoch: 2 | loss: 0.1671803
	speed: 0.0176s/iter; left time: 182.0187s
Epoch: 2 cost time: 9.83364748954773
Epoch: 2, Steps: 570 | Train Loss: 0.2387777 Vali Loss: 0.0724641 Test Loss: 0.2269938
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2093263
	speed: 0.0514s/iter; left time: 522.3267s
	iters: 200, epoch: 3 | loss: 0.2292163
	speed: 0.0162s/iter; left time: 163.0038s
	iters: 300, epoch: 3 | loss: 0.3594328
	speed: 0.0162s/iter; left time: 161.0573s
	iters: 400, epoch: 3 | loss: 0.2295883
	speed: 0.0161s/iter; left time: 159.1177s
	iters: 500, epoch: 3 | loss: 0.2332770
	speed: 0.0161s/iter; left time: 157.5039s
Epoch: 3 cost time: 9.48043179512024
Epoch: 3, Steps: 570 | Train Loss: 0.2597164 Vali Loss: 0.0580607 Test Loss: 0.1833775
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2358697
	speed: 0.0474s/iter; left time: 454.3582s
	iters: 200, epoch: 4 | loss: 0.2456642
	speed: 0.0162s/iter; left time: 153.8525s
	iters: 300, epoch: 4 | loss: 0.1224494
	speed: 0.0162s/iter; left time: 152.1836s
	iters: 400, epoch: 4 | loss: 0.2620393
	speed: 0.0162s/iter; left time: 150.1878s
	iters: 500, epoch: 4 | loss: 0.2078067
	speed: 0.0162s/iter; left time: 148.8547s
Epoch: 4 cost time: 9.491958618164062
Epoch: 4, Steps: 570 | Train Loss: 0.2106034 Vali Loss: 0.0493432 Test Loss: 0.1631286
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1447712779045105, mae:0.24288207292556763
>>> S LR=5e-4 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1518100
	speed: 0.0274s/iter; left time: 309.0877s
	iters: 200, epoch: 1 | loss: 0.0885948
	speed: 0.0157s/iter; left time: 175.8078s
	iters: 300, epoch: 1 | loss: 0.1764279
	speed: 0.0157s/iter; left time: 174.2222s
	iters: 400, epoch: 1 | loss: 0.1378040
	speed: 0.0157s/iter; left time: 173.1424s
	iters: 500, epoch: 1 | loss: 0.1010308
	speed: 0.0158s/iter; left time: 171.7120s
Epoch: 1 cost time: 10.171986103057861
Epoch: 1, Steps: 570 | Train Loss: 0.1575192 Vali Loss: 0.0343152 Test Loss: 0.1169277
Validation loss decreased (inf --> 0.034315).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1168115
	speed: 0.0486s/iter; left time: 521.7681s
	iters: 200, epoch: 2 | loss: 0.1211248
	speed: 0.0157s/iter; left time: 166.8302s
	iters: 300, epoch: 2 | loss: 0.1552241
	speed: 0.0157s/iter; left time: 165.1153s
	iters: 400, epoch: 2 | loss: 0.2278085
	speed: 0.0157s/iter; left time: 163.7457s
	iters: 500, epoch: 2 | loss: 0.1426215
	speed: 0.0157s/iter; left time: 162.3755s
Epoch: 2 cost time: 9.239994525909424
Epoch: 2, Steps: 570 | Train Loss: 0.1384653 Vali Loss: 0.0382399 Test Loss: 0.1337350
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0909029
	speed: 0.0493s/iter; left time: 500.6401s
	iters: 200, epoch: 3 | loss: 0.1456843
	speed: 0.0157s/iter; left time: 157.9861s
	iters: 300, epoch: 3 | loss: 0.1075988
	speed: 0.0157s/iter; left time: 156.4206s
	iters: 400, epoch: 3 | loss: 0.1383489
	speed: 0.0157s/iter; left time: 154.7171s
	iters: 500, epoch: 3 | loss: 0.0724757
	speed: 0.0157s/iter; left time: 153.2051s
Epoch: 3 cost time: 9.204360485076904
Epoch: 3, Steps: 570 | Train Loss: 0.1097121 Vali Loss: 0.0362580 Test Loss: 0.1232770
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1271275
	speed: 0.0468s/iter; left time: 448.6828s
	iters: 200, epoch: 4 | loss: 0.1059714
	speed: 0.0157s/iter; left time: 148.8179s
	iters: 300, epoch: 4 | loss: 0.0642587
	speed: 0.0158s/iter; left time: 148.0365s
	iters: 400, epoch: 4 | loss: 0.0635291
	speed: 0.0158s/iter; left time: 146.5000s
	iters: 500, epoch: 4 | loss: 0.1241791
	speed: 0.0158s/iter; left time: 144.8186s
Epoch: 4 cost time: 9.220606803894043
Epoch: 4, Steps: 570 | Train Loss: 0.0908066 Vali Loss: 0.0314821 Test Loss: 0.1118031
Validation loss decreased (0.034315 --> 0.031482).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0571254
	speed: 0.0473s/iter; left time: 427.0609s
	iters: 200, epoch: 5 | loss: 0.0829692
	speed: 0.0157s/iter; left time: 140.2456s
	iters: 300, epoch: 5 | loss: 0.0587836
	speed: 0.0157s/iter; left time: 138.7173s
	iters: 400, epoch: 5 | loss: 0.0597829
	speed: 0.0157s/iter; left time: 137.1962s
	iters: 500, epoch: 5 | loss: 0.0808457
	speed: 0.0157s/iter; left time: 135.5322s
Epoch: 5 cost time: 9.220591068267822
Epoch: 5, Steps: 570 | Train Loss: 0.0748981 Vali Loss: 0.0321975 Test Loss: 0.1125114
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0697567
	speed: 0.0478s/iter; left time: 404.1489s
	iters: 200, epoch: 6 | loss: 0.0877197
	speed: 0.0157s/iter; left time: 131.0631s
	iters: 300, epoch: 6 | loss: 0.0874307
	speed: 0.0157s/iter; left time: 129.5109s
	iters: 400, epoch: 6 | loss: 0.0540980
	speed: 0.0157s/iter; left time: 128.1800s
	iters: 500, epoch: 6 | loss: 0.0710929
	speed: 0.0157s/iter; left time: 126.1919s
Epoch: 6 cost time: 9.181167840957642
Epoch: 6, Steps: 570 | Train Loss: 0.0626576 Vali Loss: 0.0329355 Test Loss: 0.1157970
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0541084
	speed: 0.0463s/iter; left time: 364.6228s
	iters: 200, epoch: 7 | loss: 0.0509660
	speed: 0.0157s/iter; left time: 122.4449s
	iters: 300, epoch: 7 | loss: 0.0576914
	speed: 0.0157s/iter; left time: 120.7908s
	iters: 400, epoch: 7 | loss: 0.0718597
	speed: 0.0157s/iter; left time: 119.0305s
	iters: 500, epoch: 7 | loss: 0.0499348
	speed: 0.0157s/iter; left time: 117.5081s
Epoch: 7 cost time: 9.20553183555603
Epoch: 7, Steps: 570 | Train Loss: 0.0549616 Vali Loss: 0.0341138 Test Loss: 0.1189962
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11196490377187729, mae:0.20591986179351807
>>> S LR=5e-4 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2232897
	speed: 0.0262s/iter; left time: 295.9400s
	iters: 200, epoch: 1 | loss: 0.1836253
	speed: 0.0145s/iter; left time: 161.9545s
	iters: 300, epoch: 1 | loss: 0.1768268
	speed: 0.0145s/iter; left time: 160.9632s
	iters: 400, epoch: 1 | loss: 0.1695775
	speed: 0.0146s/iter; left time: 160.3708s
	iters: 500, epoch: 1 | loss: 0.2902836
	speed: 0.0146s/iter; left time: 159.1539s
Epoch: 1 cost time: 9.504035711288452
Epoch: 1, Steps: 570 | Train Loss: 0.2045461 Vali Loss: 0.0481820 Test Loss: 0.1528515
Validation loss decreased (inf --> 0.048182).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3075456
	speed: 0.0471s/iter; left time: 505.8063s
	iters: 200, epoch: 2 | loss: 0.1097029
	speed: 0.0147s/iter; left time: 156.3576s
	iters: 300, epoch: 2 | loss: 0.2375612
	speed: 0.0147s/iter; left time: 154.6394s
	iters: 400, epoch: 2 | loss: 0.1790827
	speed: 0.0147s/iter; left time: 153.4959s
	iters: 500, epoch: 2 | loss: 0.2600739
	speed: 0.0147s/iter; left time: 151.7299s
Epoch: 2 cost time: 8.65869688987732
Epoch: 2, Steps: 570 | Train Loss: 0.1849241 Vali Loss: 0.0557000 Test Loss: 0.1658732
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1873502
	speed: 0.0474s/iter; left time: 481.9048s
	iters: 200, epoch: 3 | loss: 0.1090009
	speed: 0.0147s/iter; left time: 147.7104s
	iters: 300, epoch: 3 | loss: 0.1599762
	speed: 0.0147s/iter; left time: 146.2078s
	iters: 400, epoch: 3 | loss: 0.1528132
	speed: 0.0147s/iter; left time: 144.5743s
	iters: 500, epoch: 3 | loss: 0.1255837
	speed: 0.0147s/iter; left time: 143.0845s
Epoch: 3 cost time: 8.654886960983276
Epoch: 3, Steps: 570 | Train Loss: 0.1634817 Vali Loss: 0.0423862 Test Loss: 0.1315447
Validation loss decreased (0.048182 --> 0.042386).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0878218
	speed: 0.0458s/iter; left time: 439.3528s
	iters: 200, epoch: 4 | loss: 0.1487328
	speed: 0.0146s/iter; left time: 138.6704s
	iters: 300, epoch: 4 | loss: 0.1746850
	speed: 0.0146s/iter; left time: 137.1336s
	iters: 400, epoch: 4 | loss: 0.1061616
	speed: 0.0146s/iter; left time: 136.0233s
	iters: 500, epoch: 4 | loss: 0.1302258
	speed: 0.0145s/iter; left time: 133.6759s
Epoch: 4 cost time: 8.601370096206665
Epoch: 4, Steps: 570 | Train Loss: 0.1306292 Vali Loss: 0.0427554 Test Loss: 0.1308364
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0896873
	speed: 0.0449s/iter; left time: 405.3240s
	iters: 200, epoch: 5 | loss: 0.0766313
	speed: 0.0146s/iter; left time: 130.1259s
	iters: 300, epoch: 5 | loss: 0.0989989
	speed: 0.0146s/iter; left time: 128.4684s
	iters: 400, epoch: 5 | loss: 0.1002841
	speed: 0.0145s/iter; left time: 126.8150s
	iters: 500, epoch: 5 | loss: 0.1301138
	speed: 0.0145s/iter; left time: 125.3711s
Epoch: 5 cost time: 8.54539680480957
Epoch: 5, Steps: 570 | Train Loss: 0.1099468 Vali Loss: 0.0418346 Test Loss: 0.1358209
Validation loss decreased (0.042386 --> 0.041835).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0660359
	speed: 0.0468s/iter; left time: 395.5344s
	iters: 200, epoch: 6 | loss: 0.0736481
	speed: 0.0145s/iter; left time: 121.3680s
	iters: 300, epoch: 6 | loss: 0.0676605
	speed: 0.0145s/iter; left time: 119.8199s
	iters: 400, epoch: 6 | loss: 0.0979376
	speed: 0.0145s/iter; left time: 118.1719s
	iters: 500, epoch: 6 | loss: 0.0572958
	speed: 0.0145s/iter; left time: 116.6859s
Epoch: 6 cost time: 8.554646730422974
Epoch: 6, Steps: 570 | Train Loss: 0.0943523 Vali Loss: 0.0410837 Test Loss: 0.1452319
Validation loss decreased (0.041835 --> 0.041084).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0965043
	speed: 0.0459s/iter; left time: 361.4007s
	iters: 200, epoch: 7 | loss: 0.0862744
	speed: 0.0146s/iter; left time: 113.4345s
	iters: 300, epoch: 7 | loss: 0.0879857
	speed: 0.0146s/iter; left time: 111.8442s
	iters: 400, epoch: 7 | loss: 0.0808596
	speed: 0.0146s/iter; left time: 110.4461s
	iters: 500, epoch: 7 | loss: 0.1033271
	speed: 0.0146s/iter; left time: 108.9309s
Epoch: 7 cost time: 8.563912630081177
Epoch: 7, Steps: 570 | Train Loss: 0.0852386 Vali Loss: 0.0407194 Test Loss: 0.1441583
Validation loss decreased (0.041084 --> 0.040719).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0671137
	speed: 0.0460s/iter; left time: 335.9524s
	iters: 200, epoch: 8 | loss: 0.1248153
	speed: 0.0145s/iter; left time: 104.7182s
	iters: 300, epoch: 8 | loss: 0.0740773
	speed: 0.0145s/iter; left time: 103.1292s
	iters: 400, epoch: 8 | loss: 0.1147975
	speed: 0.0145s/iter; left time: 101.8029s
	iters: 500, epoch: 8 | loss: 0.0698204
	speed: 0.0145s/iter; left time: 100.4832s
Epoch: 8 cost time: 8.514759063720703
Epoch: 8, Steps: 570 | Train Loss: 0.0794417 Vali Loss: 0.0407959 Test Loss: 0.1466638
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0690009
	speed: 0.0440s/iter; left time: 296.7148s
	iters: 200, epoch: 9 | loss: 0.0643296
	speed: 0.0145s/iter; left time: 96.1692s
	iters: 300, epoch: 9 | loss: 0.0739539
	speed: 0.0145s/iter; left time: 94.7183s
	iters: 400, epoch: 9 | loss: 0.0655313
	speed: 0.0145s/iter; left time: 93.4488s
	iters: 500, epoch: 9 | loss: 0.0703938
	speed: 0.0145s/iter; left time: 92.0422s
Epoch: 9 cost time: 8.504667282104492
Epoch: 9, Steps: 570 | Train Loss: 0.0761558 Vali Loss: 0.0405742 Test Loss: 0.1460173
Validation loss decreased (0.040719 --> 0.040574).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0956789
	speed: 0.0452s/iter; left time: 278.6479s
	iters: 200, epoch: 10 | loss: 0.0850752
	speed: 0.0146s/iter; left time: 88.4724s
	iters: 300, epoch: 10 | loss: 0.0793056
	speed: 0.0145s/iter; left time: 86.5110s
	iters: 400, epoch: 10 | loss: 0.1185714
	speed: 0.0146s/iter; left time: 85.4723s
	iters: 500, epoch: 10 | loss: 0.0961522
	speed: 0.0146s/iter; left time: 84.0574s
Epoch: 10 cost time: 8.547142267227173
Epoch: 10, Steps: 570 | Train Loss: 0.0743762 Vali Loss: 0.0409551 Test Loss: 0.1485922
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0764948
	speed: 0.0464s/iter; left time: 259.9610s
	iters: 200, epoch: 11 | loss: 0.0597391
	speed: 0.0145s/iter; left time: 79.8654s
	iters: 300, epoch: 11 | loss: 0.0709219
	speed: 0.0145s/iter; left time: 78.5067s
	iters: 400, epoch: 11 | loss: 0.0726151
	speed: 0.0145s/iter; left time: 76.9805s
	iters: 500, epoch: 11 | loss: 0.1093925
	speed: 0.0145s/iter; left time: 75.5392s
Epoch: 11 cost time: 8.563446998596191
Epoch: 11, Steps: 570 | Train Loss: 0.0734735 Vali Loss: 0.0408660 Test Loss: 0.1482535
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0723207
	speed: 0.0472s/iter; left time: 237.6325s
	iters: 200, epoch: 12 | loss: 0.1037108
	speed: 0.0145s/iter; left time: 71.3826s
	iters: 300, epoch: 12 | loss: 0.0659586
	speed: 0.0145s/iter; left time: 69.9005s
	iters: 400, epoch: 12 | loss: 0.0948307
	speed: 0.0145s/iter; left time: 68.4336s
	iters: 500, epoch: 12 | loss: 0.0688094
	speed: 0.0145s/iter; left time: 66.9683s
Epoch: 12 cost time: 8.613873958587646
Epoch: 12, Steps: 570 | Train Loss: 0.0729699 Vali Loss: 0.0410485 Test Loss: 0.1481966
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1462034285068512, mae:0.24736611545085907
>>> S LR=5e-4 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1530058
	speed: 0.0289s/iter; left time: 326.9479s
	iters: 200, epoch: 1 | loss: 0.2306014
	speed: 0.0175s/iter; left time: 195.5163s
	iters: 300, epoch: 1 | loss: 0.2691499
	speed: 0.0174s/iter; left time: 192.9978s
	iters: 400, epoch: 1 | loss: 0.1884923
	speed: 0.0174s/iter; left time: 191.6707s
	iters: 500, epoch: 1 | loss: 0.1612623
	speed: 0.0174s/iter; left time: 189.8330s
Epoch: 1 cost time: 11.134819984436035
Epoch: 1, Steps: 570 | Train Loss: 0.1871118 Vali Loss: 0.0448819 Test Loss: 0.1344293
Validation loss decreased (inf --> 0.044882).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2752213
	speed: 0.0558s/iter; left time: 598.8828s
	iters: 200, epoch: 2 | loss: 0.1358914
	speed: 0.0175s/iter; left time: 185.8559s
	iters: 300, epoch: 2 | loss: 0.1125258
	speed: 0.0175s/iter; left time: 183.9627s
	iters: 400, epoch: 2 | loss: 0.1550446
	speed: 0.0175s/iter; left time: 182.1225s
	iters: 500, epoch: 2 | loss: 0.1376556
	speed: 0.0174s/iter; left time: 179.8929s
Epoch: 2 cost time: 10.22317624092102
Epoch: 2, Steps: 570 | Train Loss: 0.1522613 Vali Loss: 0.0419874 Test Loss: 0.1319666
Validation loss decreased (0.044882 --> 0.041987).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1276860
	speed: 0.0529s/iter; left time: 537.6090s
	iters: 200, epoch: 3 | loss: 0.0901515
	speed: 0.0175s/iter; left time: 176.5438s
	iters: 300, epoch: 3 | loss: 0.1113133
	speed: 0.0175s/iter; left time: 174.2304s
	iters: 400, epoch: 3 | loss: 0.0861347
	speed: 0.0174s/iter; left time: 171.3892s
	iters: 500, epoch: 3 | loss: 0.0806925
	speed: 0.0174s/iter; left time: 170.0057s
Epoch: 3 cost time: 10.219381093978882
Epoch: 3, Steps: 570 | Train Loss: 0.1139676 Vali Loss: 0.0426821 Test Loss: 0.1439831
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0927338
	speed: 0.0556s/iter; left time: 533.6091s
	iters: 200, epoch: 4 | loss: 0.0873033
	speed: 0.0206s/iter; left time: 195.7416s
	iters: 300, epoch: 4 | loss: 0.0909633
	speed: 0.0195s/iter; left time: 183.5707s
	iters: 400, epoch: 4 | loss: 0.0478188
	speed: 0.0195s/iter; left time: 181.4509s
	iters: 500, epoch: 4 | loss: 0.0913691
	speed: 0.0184s/iter; left time: 168.8675s
Epoch: 4 cost time: 11.270674228668213
Epoch: 4, Steps: 570 | Train Loss: 0.0769538 Vali Loss: 0.0436301 Test Loss: 0.1484062
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0661277
	speed: 0.0537s/iter; left time: 484.4902s
	iters: 200, epoch: 5 | loss: 0.0544444
	speed: 0.0176s/iter; left time: 156.6885s
	iters: 300, epoch: 5 | loss: 0.0423336
	speed: 0.0176s/iter; left time: 154.9294s
	iters: 400, epoch: 5 | loss: 0.0440496
	speed: 0.0175s/iter; left time: 152.6822s
	iters: 500, epoch: 5 | loss: 0.0659973
	speed: 0.0176s/iter; left time: 151.4353s
Epoch: 5 cost time: 10.322943925857544
Epoch: 5, Steps: 570 | Train Loss: 0.0529689 Vali Loss: 0.0430636 Test Loss: 0.1454144
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.132088303565979, mae:0.23079738020896912
>>> S LR=5e-4 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2758727
	speed: 0.0313s/iter; left time: 353.8750s
	iters: 200, epoch: 1 | loss: 0.1626020
	speed: 0.0193s/iter; left time: 216.5082s
	iters: 300, epoch: 1 | loss: 0.1630659
	speed: 0.0193s/iter; left time: 214.2099s
	iters: 400, epoch: 1 | loss: 0.1268950
	speed: 0.0184s/iter; left time: 202.4342s
	iters: 500, epoch: 1 | loss: 0.1869920
	speed: 0.0172s/iter; left time: 187.8907s
Epoch: 1 cost time: 11.81288456916809
Epoch: 1, Steps: 570 | Train Loss: 0.1520346 Vali Loss: 0.0385585 Test Loss: 0.1432959
Validation loss decreased (inf --> 0.038558).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0801886
	speed: 0.0534s/iter; left time: 572.9214s
	iters: 200, epoch: 2 | loss: 0.1708144
	speed: 0.0173s/iter; left time: 184.2312s
	iters: 300, epoch: 2 | loss: 0.2000482
	speed: 0.0173s/iter; left time: 182.5211s
	iters: 400, epoch: 2 | loss: 0.1451576
	speed: 0.0174s/iter; left time: 180.9921s
	iters: 500, epoch: 2 | loss: 0.1107571
	speed: 0.0173s/iter; left time: 179.1457s
Epoch: 2 cost time: 10.164945363998413
Epoch: 2, Steps: 570 | Train Loss: 0.1222305 Vali Loss: 0.0370494 Test Loss: 0.1304458
Validation loss decreased (0.038558 --> 0.037049).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0680759
	speed: 0.0549s/iter; left time: 557.6606s
	iters: 200, epoch: 3 | loss: 0.0949705
	speed: 0.0173s/iter; left time: 174.0856s
	iters: 300, epoch: 3 | loss: 0.0931837
	speed: 0.0172s/iter; left time: 171.5499s
	iters: 400, epoch: 3 | loss: 0.0684431
	speed: 0.0173s/iter; left time: 170.2248s
	iters: 500, epoch: 3 | loss: 0.0747504
	speed: 0.0172s/iter; left time: 167.7956s
Epoch: 3 cost time: 10.124803066253662
Epoch: 3, Steps: 570 | Train Loss: 0.0908974 Vali Loss: 0.0328620 Test Loss: 0.1224243
Validation loss decreased (0.037049 --> 0.032862).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0741675
	speed: 0.0598s/iter; left time: 573.8264s
	iters: 200, epoch: 4 | loss: 0.0464784
	speed: 0.0194s/iter; left time: 184.3707s
	iters: 300, epoch: 4 | loss: 0.0683870
	speed: 0.0194s/iter; left time: 182.5069s
	iters: 400, epoch: 4 | loss: 0.0745664
	speed: 0.0185s/iter; left time: 172.1862s
	iters: 500, epoch: 4 | loss: 0.0454833
	speed: 0.0174s/iter; left time: 159.7589s
Epoch: 4 cost time: 10.929602861404419
Epoch: 4, Steps: 570 | Train Loss: 0.0621723 Vali Loss: 0.0318438 Test Loss: 0.1193166
Validation loss decreased (0.032862 --> 0.031844).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0468926
	speed: 0.0551s/iter; left time: 496.7894s
	iters: 200, epoch: 5 | loss: 0.0528687
	speed: 0.0175s/iter; left time: 156.1111s
	iters: 300, epoch: 5 | loss: 0.0404239
	speed: 0.0174s/iter; left time: 153.6388s
	iters: 400, epoch: 5 | loss: 0.0343534
	speed: 0.0174s/iter; left time: 151.8886s
	iters: 500, epoch: 5 | loss: 0.0520954
	speed: 0.0174s/iter; left time: 150.0410s
Epoch: 5 cost time: 10.289583683013916
Epoch: 5, Steps: 570 | Train Loss: 0.0435532 Vali Loss: 0.0338994 Test Loss: 0.1241074
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0385038
	speed: 0.0535s/iter; left time: 452.0669s
	iters: 200, epoch: 6 | loss: 0.0305156
	speed: 0.0173s/iter; left time: 144.5725s
	iters: 300, epoch: 6 | loss: 0.0366936
	speed: 0.0173s/iter; left time: 142.6052s
	iters: 400, epoch: 6 | loss: 0.0406262
	speed: 0.0173s/iter; left time: 140.8617s
	iters: 500, epoch: 6 | loss: 0.0270467
	speed: 0.0173s/iter; left time: 139.1765s
Epoch: 6 cost time: 10.116979598999023
Epoch: 6, Steps: 570 | Train Loss: 0.0345643 Vali Loss: 0.0340458 Test Loss: 0.1260459
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0309207
	speed: 0.0543s/iter; left time: 427.7612s
	iters: 200, epoch: 7 | loss: 0.0411747
	speed: 0.0173s/iter; left time: 134.9980s
	iters: 300, epoch: 7 | loss: 0.0281035
	speed: 0.0173s/iter; left time: 133.1501s
	iters: 400, epoch: 7 | loss: 0.0304169
	speed: 0.0174s/iter; left time: 131.7293s
	iters: 500, epoch: 7 | loss: 0.0235909
	speed: 0.0174s/iter; left time: 129.8819s
Epoch: 7 cost time: 10.18623423576355
Epoch: 7, Steps: 570 | Train Loss: 0.0303484 Vali Loss: 0.0345370 Test Loss: 0.1268227
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11949233710765839, mae:0.2117108553647995
>>> S LR=5e-4 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1689088
	speed: 0.0311s/iter; left time: 351.3461s
	iters: 200, epoch: 1 | loss: 0.1837047
	speed: 0.0193s/iter; left time: 216.1153s
	iters: 300, epoch: 1 | loss: 0.2386428
	speed: 0.0193s/iter; left time: 213.9945s
	iters: 400, epoch: 1 | loss: 0.1720916
	speed: 0.0193s/iter; left time: 211.7694s
	iters: 500, epoch: 1 | loss: 0.2483873
	speed: 0.0193s/iter; left time: 210.1244s
Epoch: 1 cost time: 12.218522071838379
Epoch: 1, Steps: 570 | Train Loss: 0.1903432 Vali Loss: 0.0441832 Test Loss: 0.1484213
Validation loss decreased (inf --> 0.044183).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2211244
	speed: 0.0553s/iter; left time: 593.9408s
	iters: 200, epoch: 2 | loss: 0.1927238
	speed: 0.0172s/iter; left time: 183.1543s
	iters: 300, epoch: 2 | loss: 0.3309921
	speed: 0.0183s/iter; left time: 192.3985s
	iters: 400, epoch: 2 | loss: 0.1406781
	speed: 0.0199s/iter; left time: 207.4571s
	iters: 500, epoch: 2 | loss: 0.0908309
	speed: 0.0199s/iter; left time: 205.2646s
Epoch: 2 cost time: 10.903442621231079
Epoch: 2, Steps: 570 | Train Loss: 0.1581959 Vali Loss: 0.0466634 Test Loss: 0.1596382
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1093015
	speed: 0.0565s/iter; left time: 573.6338s
	iters: 200, epoch: 3 | loss: 0.0945238
	speed: 0.0198s/iter; left time: 198.8949s
	iters: 300, epoch: 3 | loss: 0.1097629
	speed: 0.0198s/iter; left time: 197.0145s
	iters: 400, epoch: 3 | loss: 0.0769051
	speed: 0.0198s/iter; left time: 195.2968s
	iters: 500, epoch: 3 | loss: 0.1075453
	speed: 0.0191s/iter; left time: 186.0206s
Epoch: 3 cost time: 11.291588068008423
Epoch: 3, Steps: 570 | Train Loss: 0.1092050 Vali Loss: 0.0448148 Test Loss: 0.1394709
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0517638
	speed: 0.0541s/iter; left time: 519.2428s
	iters: 200, epoch: 4 | loss: 0.0840608
	speed: 0.0180s/iter; left time: 171.2292s
	iters: 300, epoch: 4 | loss: 0.0609765
	speed: 0.0172s/iter; left time: 161.9620s
	iters: 400, epoch: 4 | loss: 0.0593266
	speed: 0.0173s/iter; left time: 160.6750s
	iters: 500, epoch: 4 | loss: 0.0486040
	speed: 0.0172s/iter; left time: 158.5313s
Epoch: 4 cost time: 10.221607446670532
Epoch: 4, Steps: 570 | Train Loss: 0.0639969 Vali Loss: 0.0458013 Test Loss: 0.1485071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14855292439460754, mae:0.2411053329706192
>>> S LR=5e-4 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1948623
	speed: 0.0327s/iter; left time: 369.4260s
	iters: 200, epoch: 1 | loss: 0.1621963
	speed: 0.0212s/iter; left time: 237.0125s
	iters: 300, epoch: 1 | loss: 0.1794354
	speed: 0.0212s/iter; left time: 234.9576s
	iters: 400, epoch: 1 | loss: 0.2493329
	speed: 0.0212s/iter; left time: 233.1034s
	iters: 500, epoch: 1 | loss: 0.1211675
	speed: 0.0212s/iter; left time: 230.6470s
Epoch: 1 cost time: 13.272563219070435
Epoch: 1, Steps: 570 | Train Loss: 0.2038815 Vali Loss: 0.0445978 Test Loss: 0.1509657
Validation loss decreased (inf --> 0.044598).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2949215
	speed: 0.0617s/iter; left time: 661.8642s
	iters: 200, epoch: 2 | loss: 0.2512950
	speed: 0.0212s/iter; left time: 225.5671s
	iters: 300, epoch: 2 | loss: 0.2521242
	speed: 0.0212s/iter; left time: 223.5632s
	iters: 400, epoch: 2 | loss: 0.3959275
	speed: 0.0212s/iter; left time: 221.3225s
	iters: 500, epoch: 2 | loss: 0.2859483
	speed: 0.0212s/iter; left time: 219.1358s
Epoch: 2 cost time: 12.354676961898804
Epoch: 2, Steps: 570 | Train Loss: 0.2604407 Vali Loss: 0.0711581 Test Loss: 0.2041969
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4634787
	speed: 0.0623s/iter; left time: 633.5173s
	iters: 200, epoch: 3 | loss: 0.1904088
	speed: 0.0230s/iter; left time: 231.0646s
	iters: 300, epoch: 3 | loss: 0.3544937
	speed: 0.0230s/iter; left time: 228.6842s
	iters: 400, epoch: 3 | loss: 0.1729822
	speed: 0.0229s/iter; left time: 226.1347s
	iters: 500, epoch: 3 | loss: 0.1790698
	speed: 0.0222s/iter; left time: 216.2957s
Epoch: 3 cost time: 13.13749885559082
Epoch: 3, Steps: 570 | Train Loss: 0.2671373 Vali Loss: 0.0576863 Test Loss: 0.1770610
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1868694
	speed: 0.0597s/iter; left time: 572.6600s
	iters: 200, epoch: 4 | loss: 0.1434228
	speed: 0.0212s/iter; left time: 201.5056s
	iters: 300, epoch: 4 | loss: 0.2054816
	speed: 0.0212s/iter; left time: 199.2307s
	iters: 400, epoch: 4 | loss: 0.1892259
	speed: 0.0212s/iter; left time: 197.0370s
	iters: 500, epoch: 4 | loss: 0.3189949
	speed: 0.0212s/iter; left time: 194.8163s
Epoch: 4 cost time: 12.361350536346436
Epoch: 4, Steps: 570 | Train Loss: 0.2265316 Vali Loss: 0.0569756 Test Loss: 0.1725901
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15110312402248383, mae:0.24321649968624115
>>> S LR=5e-4 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1566502
	speed: 0.0335s/iter; left time: 378.0225s
	iters: 200, epoch: 1 | loss: 0.0779593
	speed: 0.0220s/iter; left time: 245.9147s
	iters: 300, epoch: 1 | loss: 0.1590574
	speed: 0.0219s/iter; left time: 242.8189s
	iters: 400, epoch: 1 | loss: 0.1011642
	speed: 0.0219s/iter; left time: 241.3533s
	iters: 500, epoch: 1 | loss: 0.1525146
	speed: 0.0218s/iter; left time: 238.0724s
Epoch: 1 cost time: 13.693528890609741
Epoch: 1, Steps: 570 | Train Loss: 0.1705894 Vali Loss: 0.0423542 Test Loss: 0.1530648
Validation loss decreased (inf --> 0.042354).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2707944
	speed: 0.0622s/iter; left time: 667.9532s
	iters: 200, epoch: 2 | loss: 0.1359799
	speed: 0.0220s/iter; left time: 234.2101s
	iters: 300, epoch: 2 | loss: 0.2757415
	speed: 0.0221s/iter; left time: 232.3164s
	iters: 400, epoch: 2 | loss: 0.2848637
	speed: 0.0219s/iter; left time: 228.7080s
	iters: 500, epoch: 2 | loss: 0.2162174
	speed: 0.0223s/iter; left time: 229.9075s
Epoch: 2 cost time: 12.821919918060303
Epoch: 2, Steps: 570 | Train Loss: 0.2684580 Vali Loss: 0.0619629 Test Loss: 0.1894107
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2179947
	speed: 0.0622s/iter; left time: 631.8794s
	iters: 200, epoch: 3 | loss: 0.1982182
	speed: 0.0204s/iter; left time: 205.4376s
	iters: 300, epoch: 3 | loss: 0.2200735
	speed: 0.0204s/iter; left time: 202.7932s
	iters: 400, epoch: 3 | loss: 0.1963798
	speed: 0.0204s/iter; left time: 200.8335s
	iters: 500, epoch: 3 | loss: 0.1385210
	speed: 0.0204s/iter; left time: 198.8234s
Epoch: 3 cost time: 11.916346073150635
Epoch: 3, Steps: 570 | Train Loss: 0.2387945 Vali Loss: 0.0568086 Test Loss: 0.1765569
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1145822
	speed: 0.0606s/iter; left time: 581.6413s
	iters: 200, epoch: 4 | loss: 0.2970628
	speed: 0.0204s/iter; left time: 193.5901s
	iters: 300, epoch: 4 | loss: 0.2360389
	speed: 0.0204s/iter; left time: 191.5447s
	iters: 400, epoch: 4 | loss: 0.2203054
	speed: 0.0204s/iter; left time: 189.6364s
	iters: 500, epoch: 4 | loss: 0.1665015
	speed: 0.0204s/iter; left time: 187.2355s
Epoch: 4 cost time: 11.915805101394653
Epoch: 4, Steps: 570 | Train Loss: 0.2174995 Vali Loss: 0.0582626 Test Loss: 0.1831686
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15332862734794617, mae:0.24946530163288116
>>> S LR=5e-4 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2392590
	speed: 0.0329s/iter; left time: 371.2492s
	iters: 200, epoch: 1 | loss: 0.1669407
	speed: 0.0210s/iter; left time: 234.8847s
	iters: 300, epoch: 1 | loss: 0.1968097
	speed: 0.0210s/iter; left time: 233.4556s
	iters: 400, epoch: 1 | loss: 0.3082136
	speed: 0.0212s/iter; left time: 233.2736s
	iters: 500, epoch: 1 | loss: 0.2617947
	speed: 0.0217s/iter; left time: 236.6864s
Epoch: 1 cost time: 13.189356565475464
Epoch: 1, Steps: 570 | Train Loss: 0.2161311 Vali Loss: 0.0536187 Test Loss: 0.1756847
Validation loss decreased (inf --> 0.053619).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1330360
	speed: 0.0570s/iter; left time: 612.0553s
	iters: 200, epoch: 2 | loss: 0.2510106
	speed: 0.0190s/iter; left time: 202.2624s
	iters: 300, epoch: 2 | loss: 0.1726367
	speed: 0.0190s/iter; left time: 200.5245s
	iters: 400, epoch: 2 | loss: 0.2278309
	speed: 0.0191s/iter; left time: 199.0354s
	iters: 500, epoch: 2 | loss: 0.1882658
	speed: 0.0190s/iter; left time: 196.7862s
Epoch: 2 cost time: 11.148614168167114
Epoch: 2, Steps: 570 | Train Loss: 0.2295338 Vali Loss: 0.0593622 Test Loss: 0.1837987
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2028666
	speed: 0.0553s/iter; left time: 561.9142s
	iters: 200, epoch: 3 | loss: 0.1594563
	speed: 0.0191s/iter; left time: 192.1292s
	iters: 300, epoch: 3 | loss: 0.1939337
	speed: 0.0191s/iter; left time: 189.8279s
	iters: 400, epoch: 3 | loss: 0.2748252
	speed: 0.0191s/iter; left time: 188.1853s
	iters: 500, epoch: 3 | loss: 0.1719334
	speed: 0.0191s/iter; left time: 186.2556s
Epoch: 3 cost time: 11.131575107574463
Epoch: 3, Steps: 570 | Train Loss: 0.2384712 Vali Loss: 0.0551550 Test Loss: 0.1713011
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1497985
	speed: 0.0557s/iter; left time: 534.4966s
	iters: 200, epoch: 4 | loss: 0.2221448
	speed: 0.0191s/iter; left time: 180.9042s
	iters: 300, epoch: 4 | loss: 0.1569196
	speed: 0.0191s/iter; left time: 179.0652s
	iters: 400, epoch: 4 | loss: 0.2446541
	speed: 0.0191s/iter; left time: 177.4937s
	iters: 500, epoch: 4 | loss: 0.2026558
	speed: 0.0191s/iter; left time: 175.3925s
Epoch: 4 cost time: 11.148222208023071
Epoch: 4, Steps: 570 | Train Loss: 0.2143598 Vali Loss: 0.0543370 Test Loss: 0.1867305
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17588523030281067, mae:0.278737872838974
>>> S LR=5e-4 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1685890
	speed: 0.0219s/iter; left time: 248.0358s
	iters: 200, epoch: 1 | loss: 0.1639676
	speed: 0.0104s/iter; left time: 116.9615s
	iters: 300, epoch: 1 | loss: 0.1847123
	speed: 0.0105s/iter; left time: 116.1267s
	iters: 400, epoch: 1 | loss: 0.2082517
	speed: 0.0104s/iter; left time: 114.7999s
	iters: 500, epoch: 1 | loss: 0.1375032
	speed: 0.0105s/iter; left time: 113.9461s
Epoch: 1 cost time: 7.149779796600342
Epoch: 1, Steps: 570 | Train Loss: 0.2106583 Vali Loss: 0.0484982 Test Loss: 0.1650844
Validation loss decreased (inf --> 0.048498).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2509083
	speed: 0.0375s/iter; left time: 402.6677s
	iters: 200, epoch: 2 | loss: 0.2568097
	speed: 0.0106s/iter; left time: 112.1894s
	iters: 300, epoch: 2 | loss: 0.1433454
	speed: 0.0105s/iter; left time: 110.6927s
	iters: 400, epoch: 2 | loss: 0.1300318
	speed: 0.0105s/iter; left time: 109.7744s
	iters: 500, epoch: 2 | loss: 0.1464631
	speed: 0.0105s/iter; left time: 108.2644s
Epoch: 2 cost time: 6.300267457962036
Epoch: 2, Steps: 570 | Train Loss: 0.1809960 Vali Loss: 0.0444576 Test Loss: 0.1423675
Validation loss decreased (0.048498 --> 0.044458).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1477868
	speed: 0.0368s/iter; left time: 373.8841s
	iters: 200, epoch: 3 | loss: 0.1898748
	speed: 0.0106s/iter; left time: 106.6313s
	iters: 300, epoch: 3 | loss: 0.1642903
	speed: 0.0106s/iter; left time: 105.3490s
	iters: 400, epoch: 3 | loss: 0.1655365
	speed: 0.0106s/iter; left time: 104.1527s
	iters: 500, epoch: 3 | loss: 0.2111731
	speed: 0.0105s/iter; left time: 102.7370s
Epoch: 3 cost time: 6.291303634643555
Epoch: 3, Steps: 570 | Train Loss: 0.1559872 Vali Loss: 0.0403412 Test Loss: 0.1353822
Validation loss decreased (0.044458 --> 0.040341).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1345188
	speed: 0.0357s/iter; left time: 342.6053s
	iters: 200, epoch: 4 | loss: 0.0938005
	speed: 0.0105s/iter; left time: 99.6191s
	iters: 300, epoch: 4 | loss: 0.1556092
	speed: 0.0105s/iter; left time: 98.6469s
	iters: 400, epoch: 4 | loss: 0.1517384
	speed: 0.0105s/iter; left time: 97.7967s
	iters: 500, epoch: 4 | loss: 0.1461323
	speed: 0.0105s/iter; left time: 96.4630s
Epoch: 4 cost time: 6.264348983764648
Epoch: 4, Steps: 570 | Train Loss: 0.1372103 Vali Loss: 0.0401224 Test Loss: 0.1499583
Validation loss decreased (0.040341 --> 0.040122).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1242045
	speed: 0.0368s/iter; left time: 331.7434s
	iters: 200, epoch: 5 | loss: 0.1426142
	speed: 0.0106s/iter; left time: 94.1913s
	iters: 300, epoch: 5 | loss: 0.0769655
	speed: 0.0106s/iter; left time: 93.1638s
	iters: 400, epoch: 5 | loss: 0.1124043
	speed: 0.0105s/iter; left time: 91.8335s
	iters: 500, epoch: 5 | loss: 0.1403052
	speed: 0.0105s/iter; left time: 90.3881s
Epoch: 5 cost time: 6.277361631393433
Epoch: 5, Steps: 570 | Train Loss: 0.1259047 Vali Loss: 0.0404093 Test Loss: 0.1465250
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1149600
	speed: 0.0370s/iter; left time: 312.6725s
	iters: 200, epoch: 6 | loss: 0.0930245
	speed: 0.0106s/iter; left time: 88.3057s
	iters: 300, epoch: 6 | loss: 0.1281097
	speed: 0.0106s/iter; left time: 87.2165s
	iters: 400, epoch: 6 | loss: 0.1203659
	speed: 0.0106s/iter; left time: 86.1768s
	iters: 500, epoch: 6 | loss: 0.1212528
	speed: 0.0106s/iter; left time: 84.9990s
Epoch: 6 cost time: 6.255199193954468
Epoch: 6, Steps: 570 | Train Loss: 0.1187992 Vali Loss: 0.0400408 Test Loss: 0.1407123
Validation loss decreased (0.040122 --> 0.040041).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1330616
	speed: 0.0364s/iter; left time: 286.8143s
	iters: 200, epoch: 7 | loss: 0.1593571
	speed: 0.0105s/iter; left time: 81.8916s
	iters: 300, epoch: 7 | loss: 0.0970914
	speed: 0.0105s/iter; left time: 80.7305s
	iters: 400, epoch: 7 | loss: 0.0815146
	speed: 0.0105s/iter; left time: 79.5706s
	iters: 500, epoch: 7 | loss: 0.1067921
	speed: 0.0105s/iter; left time: 78.6548s
Epoch: 7 cost time: 6.249097585678101
Epoch: 7, Steps: 570 | Train Loss: 0.1166399 Vali Loss: 0.0403429 Test Loss: 0.1483810
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1165645
	speed: 0.0354s/iter; left time: 258.9199s
	iters: 200, epoch: 8 | loss: 0.1179184
	speed: 0.0104s/iter; left time: 75.3527s
	iters: 300, epoch: 8 | loss: 0.1431606
	speed: 0.0104s/iter; left time: 74.0929s
	iters: 400, epoch: 8 | loss: 0.1563954
	speed: 0.0105s/iter; left time: 73.4427s
	iters: 500, epoch: 8 | loss: 0.0865660
	speed: 0.0105s/iter; left time: 72.6207s
Epoch: 8 cost time: 6.226748466491699
Epoch: 8, Steps: 570 | Train Loss: 0.1132356 Vali Loss: 0.0404306 Test Loss: 0.1449910
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1625350
	speed: 0.0363s/iter; left time: 245.0291s
	iters: 200, epoch: 9 | loss: 0.1512942
	speed: 0.0118s/iter; left time: 78.4453s
	iters: 300, epoch: 9 | loss: 0.0641552
	speed: 0.0118s/iter; left time: 77.3648s
	iters: 400, epoch: 9 | loss: 0.1255514
	speed: 0.0118s/iter; left time: 75.9761s
	iters: 500, epoch: 9 | loss: 0.0957178
	speed: 0.0111s/iter; left time: 70.3026s
Epoch: 9 cost time: 6.84415078163147
Epoch: 9, Steps: 570 | Train Loss: 0.1131055 Vali Loss: 0.0407089 Test Loss: 0.1442521
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14078405499458313, mae:0.23423361778259277
>>> S LR=5e-4 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2096198
	speed: 0.0222s/iter; left time: 251.1108s
	iters: 200, epoch: 1 | loss: 0.1702474
	speed: 0.0103s/iter; left time: 115.3248s
	iters: 300, epoch: 1 | loss: 0.1990155
	speed: 0.0103s/iter; left time: 114.4986s
	iters: 400, epoch: 1 | loss: 0.1753219
	speed: 0.0103s/iter; left time: 113.1083s
	iters: 500, epoch: 1 | loss: 0.1499629
	speed: 0.0102s/iter; left time: 111.7247s
Epoch: 1 cost time: 7.097154140472412
Epoch: 1, Steps: 570 | Train Loss: 0.1758491 Vali Loss: 0.0363709 Test Loss: 0.1203348
Validation loss decreased (inf --> 0.036371).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1300464
	speed: 0.0355s/iter; left time: 381.0664s
	iters: 200, epoch: 2 | loss: 0.1761739
	speed: 0.0102s/iter; left time: 108.7233s
	iters: 300, epoch: 2 | loss: 0.1012000
	speed: 0.0102s/iter; left time: 107.5617s
	iters: 400, epoch: 2 | loss: 0.1013454
	speed: 0.0103s/iter; left time: 107.0374s
	iters: 500, epoch: 2 | loss: 0.1256214
	speed: 0.0102s/iter; left time: 105.8078s
Epoch: 2 cost time: 6.1117331981658936
Epoch: 2, Steps: 570 | Train Loss: 0.1515349 Vali Loss: 0.0341824 Test Loss: 0.1208848
Validation loss decreased (0.036371 --> 0.034182).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0664638
	speed: 0.0366s/iter; left time: 371.4072s
	iters: 200, epoch: 3 | loss: 0.1314070
	speed: 0.0101s/iter; left time: 102.0711s
	iters: 300, epoch: 3 | loss: 0.2873763
	speed: 0.0102s/iter; left time: 101.4208s
	iters: 400, epoch: 3 | loss: 0.1495932
	speed: 0.0101s/iter; left time: 99.9448s
	iters: 500, epoch: 3 | loss: 0.0893398
	speed: 0.0102s/iter; left time: 99.4219s
Epoch: 3 cost time: 6.086881399154663
Epoch: 3, Steps: 570 | Train Loss: 0.1315758 Vali Loss: 0.0311783 Test Loss: 0.1159879
Validation loss decreased (0.034182 --> 0.031178).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0940889
	speed: 0.0354s/iter; left time: 339.1006s
	iters: 200, epoch: 4 | loss: 0.0935936
	speed: 0.0103s/iter; left time: 97.8033s
	iters: 300, epoch: 4 | loss: 0.0770627
	speed: 0.0103s/iter; left time: 96.7103s
	iters: 400, epoch: 4 | loss: 0.0761510
	speed: 0.0103s/iter; left time: 96.0638s
	iters: 500, epoch: 4 | loss: 0.1663834
	speed: 0.0103s/iter; left time: 94.7861s
Epoch: 4 cost time: 6.1604955196380615
Epoch: 4, Steps: 570 | Train Loss: 0.1169428 Vali Loss: 0.0306536 Test Loss: 0.1111224
Validation loss decreased (0.031178 --> 0.030654).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0868378
	speed: 0.0354s/iter; left time: 319.1665s
	iters: 200, epoch: 5 | loss: 0.1370592
	speed: 0.0102s/iter; left time: 90.7870s
	iters: 300, epoch: 5 | loss: 0.1109418
	speed: 0.0102s/iter; left time: 89.7883s
	iters: 400, epoch: 5 | loss: 0.1227761
	speed: 0.0102s/iter; left time: 88.8313s
	iters: 500, epoch: 5 | loss: 0.1109007
	speed: 0.0102s/iter; left time: 87.8697s
Epoch: 5 cost time: 6.118129014968872
Epoch: 5, Steps: 570 | Train Loss: 0.1094740 Vali Loss: 0.0307873 Test Loss: 0.1134636
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0822682
	speed: 0.0338s/iter; left time: 285.4353s
	iters: 200, epoch: 6 | loss: 0.1401309
	speed: 0.0103s/iter; left time: 85.6571s
	iters: 300, epoch: 6 | loss: 0.1305081
	speed: 0.0103s/iter; left time: 84.9665s
	iters: 400, epoch: 6 | loss: 0.0821018
	speed: 0.0103s/iter; left time: 83.7856s
	iters: 500, epoch: 6 | loss: 0.0685635
	speed: 0.0102s/iter; left time: 82.2577s
Epoch: 6 cost time: 6.1014404296875
Epoch: 6, Steps: 570 | Train Loss: 0.1041284 Vali Loss: 0.0310842 Test Loss: 0.1125120
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0928750
	speed: 0.0347s/iter; left time: 273.3415s
	iters: 200, epoch: 7 | loss: 0.1058178
	speed: 0.0102s/iter; left time: 79.5198s
	iters: 300, epoch: 7 | loss: 0.1685626
	speed: 0.0102s/iter; left time: 78.2206s
	iters: 400, epoch: 7 | loss: 0.1629274
	speed: 0.0102s/iter; left time: 77.0949s
	iters: 500, epoch: 7 | loss: 0.1034740
	speed: 0.0102s/iter; left time: 76.1502s
Epoch: 7 cost time: 6.075540065765381
Epoch: 7, Steps: 570 | Train Loss: 0.1024151 Vali Loss: 0.0307174 Test Loss: 0.1120139
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11125919967889786, mae:0.19924654066562653
>>> S LR=5e-4 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1857806
	speed: 0.0215s/iter; left time: 243.1662s
	iters: 200, epoch: 1 | loss: 0.1567486
	speed: 0.0102s/iter; left time: 114.1234s
	iters: 300, epoch: 1 | loss: 0.1538970
	speed: 0.0102s/iter; left time: 112.8843s
	iters: 400, epoch: 1 | loss: 0.1135502
	speed: 0.0101s/iter; left time: 111.6391s
	iters: 500, epoch: 1 | loss: 0.2190539
	speed: 0.0102s/iter; left time: 110.7559s
Epoch: 1 cost time: 6.979669094085693
Epoch: 1, Steps: 570 | Train Loss: 0.2190506 Vali Loss: 0.0419112 Test Loss: 0.1395092
Validation loss decreased (inf --> 0.041911).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1856040
	speed: 0.0372s/iter; left time: 399.4211s
	iters: 200, epoch: 2 | loss: 0.2475386
	speed: 0.0102s/iter; left time: 108.7399s
	iters: 300, epoch: 2 | loss: 0.1844406
	speed: 0.0102s/iter; left time: 107.4035s
	iters: 400, epoch: 2 | loss: 0.2506157
	speed: 0.0102s/iter; left time: 106.6109s
	iters: 500, epoch: 2 | loss: 0.2262858
	speed: 0.0102s/iter; left time: 105.2477s
Epoch: 2 cost time: 6.111568927764893
Epoch: 2, Steps: 570 | Train Loss: 0.1862861 Vali Loss: 0.0412450 Test Loss: 0.1355372
Validation loss decreased (0.041911 --> 0.041245).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1103425
	speed: 0.0368s/iter; left time: 374.0489s
	iters: 200, epoch: 3 | loss: 0.1278064
	speed: 0.0108s/iter; left time: 108.2732s
	iters: 300, epoch: 3 | loss: 0.2096750
	speed: 0.0105s/iter; left time: 104.6110s
	iters: 400, epoch: 3 | loss: 0.1280262
	speed: 0.0105s/iter; left time: 103.1313s
	iters: 500, epoch: 3 | loss: 0.0930744
	speed: 0.0118s/iter; left time: 114.7904s
Epoch: 3 cost time: 6.616772413253784
Epoch: 3, Steps: 570 | Train Loss: 0.1555764 Vali Loss: 0.0411492 Test Loss: 0.1394459
Validation loss decreased (0.041245 --> 0.041149).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0935799
	speed: 0.0366s/iter; left time: 351.4082s
	iters: 200, epoch: 4 | loss: 0.1050615
	speed: 0.0114s/iter; left time: 108.5789s
	iters: 300, epoch: 4 | loss: 0.0995685
	speed: 0.0112s/iter; left time: 105.1809s
	iters: 400, epoch: 4 | loss: 0.1545035
	speed: 0.0103s/iter; left time: 95.7052s
	iters: 500, epoch: 4 | loss: 0.1132595
	speed: 0.0115s/iter; left time: 105.2987s
Epoch: 4 cost time: 6.585046768188477
Epoch: 4, Steps: 570 | Train Loss: 0.1355179 Vali Loss: 0.0400260 Test Loss: 0.1442927
Validation loss decreased (0.041149 --> 0.040026).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1116857
	speed: 0.0355s/iter; left time: 320.6959s
	iters: 200, epoch: 5 | loss: 0.0762459
	speed: 0.0103s/iter; left time: 91.7626s
	iters: 300, epoch: 5 | loss: 0.1245399
	speed: 0.0102s/iter; left time: 90.2947s
	iters: 400, epoch: 5 | loss: 0.1170072
	speed: 0.0102s/iter; left time: 89.3476s
	iters: 500, epoch: 5 | loss: 0.1514953
	speed: 0.0102s/iter; left time: 88.2812s
Epoch: 5 cost time: 6.101457357406616
Epoch: 5, Steps: 570 | Train Loss: 0.1243294 Vali Loss: 0.0407661 Test Loss: 0.1438800
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1013474
	speed: 0.0349s/iter; left time: 295.1176s
	iters: 200, epoch: 6 | loss: 0.1128900
	speed: 0.0102s/iter; left time: 85.2856s
	iters: 300, epoch: 6 | loss: 0.1002158
	speed: 0.0102s/iter; left time: 84.4418s
	iters: 400, epoch: 6 | loss: 0.0723819
	speed: 0.0102s/iter; left time: 83.3053s
	iters: 500, epoch: 6 | loss: 0.1292250
	speed: 0.0102s/iter; left time: 82.3848s
Epoch: 6 cost time: 6.076109170913696
Epoch: 6, Steps: 570 | Train Loss: 0.1170026 Vali Loss: 0.0399181 Test Loss: 0.1452878
Validation loss decreased (0.040026 --> 0.039918).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0972765
	speed: 0.0349s/iter; left time: 274.8266s
	iters: 200, epoch: 7 | loss: 0.1139345
	speed: 0.0102s/iter; left time: 79.4697s
	iters: 300, epoch: 7 | loss: 0.1008037
	speed: 0.0102s/iter; left time: 78.3239s
	iters: 400, epoch: 7 | loss: 0.0764597
	speed: 0.0102s/iter; left time: 77.3754s
	iters: 500, epoch: 7 | loss: 0.1112954
	speed: 0.0102s/iter; left time: 76.3603s
Epoch: 7 cost time: 6.075904130935669
Epoch: 7, Steps: 570 | Train Loss: 0.1124550 Vali Loss: 0.0399454 Test Loss: 0.1457825
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0840741
	speed: 0.0345s/iter; left time: 251.9545s
	iters: 200, epoch: 8 | loss: 0.1107856
	speed: 0.0102s/iter; left time: 73.6387s
	iters: 300, epoch: 8 | loss: 0.1005829
	speed: 0.0103s/iter; left time: 72.9227s
	iters: 400, epoch: 8 | loss: 0.1132950
	speed: 0.0102s/iter; left time: 71.8317s
	iters: 500, epoch: 8 | loss: 0.0738301
	speed: 0.0102s/iter; left time: 70.7605s
Epoch: 8 cost time: 6.073227167129517
Epoch: 8, Steps: 570 | Train Loss: 0.1105905 Vali Loss: 0.0399257 Test Loss: 0.1461286
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0988649
	speed: 0.0344s/iter; left time: 231.7163s
	iters: 200, epoch: 9 | loss: 0.1461957
	speed: 0.0103s/iter; left time: 68.6272s
	iters: 300, epoch: 9 | loss: 0.1020971
	speed: 0.0103s/iter; left time: 67.3832s
	iters: 400, epoch: 9 | loss: 0.0750781
	speed: 0.0103s/iter; left time: 66.3891s
	iters: 500, epoch: 9 | loss: 0.0905970
	speed: 0.0103s/iter; left time: 65.4072s
Epoch: 9 cost time: 6.125336170196533
Epoch: 9, Steps: 570 | Train Loss: 0.1096762 Vali Loss: 0.0403767 Test Loss: 0.1470456
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14551760256290436, mae:0.23950867354869843
>>> S LR=5e-4 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2352391
	speed: 0.0234s/iter; left time: 264.8272s
	iters: 200, epoch: 1 | loss: 0.2156324
	speed: 0.0117s/iter; left time: 130.6116s
	iters: 300, epoch: 1 | loss: 0.1553657
	speed: 0.0117s/iter; left time: 129.5359s
	iters: 400, epoch: 1 | loss: 0.1190087
	speed: 0.0117s/iter; left time: 128.2114s
	iters: 500, epoch: 1 | loss: 0.1870726
	speed: 0.0117s/iter; left time: 127.0754s
Epoch: 1 cost time: 7.873430252075195
Epoch: 1, Steps: 570 | Train Loss: 0.2268478 Vali Loss: 0.0430500 Test Loss: 0.1365055
Validation loss decreased (inf --> 0.043050).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1977229
	speed: 0.0397s/iter; left time: 426.0881s
	iters: 200, epoch: 2 | loss: 0.1801315
	speed: 0.0118s/iter; left time: 125.1697s
	iters: 300, epoch: 2 | loss: 0.1634038
	speed: 0.0117s/iter; left time: 123.2839s
	iters: 400, epoch: 2 | loss: 0.1054350
	speed: 0.0117s/iter; left time: 121.9172s
	iters: 500, epoch: 2 | loss: 0.1834328
	speed: 0.0117s/iter; left time: 120.9450s
Epoch: 2 cost time: 7.000026702880859
Epoch: 2, Steps: 570 | Train Loss: 0.1948167 Vali Loss: 0.0425337 Test Loss: 0.1320349
Validation loss decreased (0.043050 --> 0.042534).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2159747
	speed: 0.0395s/iter; left time: 400.9470s
	iters: 200, epoch: 3 | loss: 0.2105037
	speed: 0.0117s/iter; left time: 118.1627s
	iters: 300, epoch: 3 | loss: 0.1080261
	speed: 0.0119s/iter; left time: 118.3388s
	iters: 400, epoch: 3 | loss: 0.1469608
	speed: 0.0128s/iter; left time: 126.5844s
	iters: 500, epoch: 3 | loss: 0.1123326
	speed: 0.0128s/iter; left time: 124.9931s
Epoch: 3 cost time: 7.351804256439209
Epoch: 3, Steps: 570 | Train Loss: 0.1724509 Vali Loss: 0.0403962 Test Loss: 0.1351186
Validation loss decreased (0.042534 --> 0.040396).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1453612
	speed: 0.0408s/iter; left time: 391.0339s
	iters: 200, epoch: 4 | loss: 0.1732512
	speed: 0.0117s/iter; left time: 111.3968s
	iters: 300, epoch: 4 | loss: 0.1042788
	speed: 0.0117s/iter; left time: 110.1718s
	iters: 400, epoch: 4 | loss: 0.1228147
	speed: 0.0117s/iter; left time: 108.6897s
	iters: 500, epoch: 4 | loss: 0.1244189
	speed: 0.0117s/iter; left time: 107.5932s
Epoch: 4 cost time: 6.997567892074585
Epoch: 4, Steps: 570 | Train Loss: 0.1550196 Vali Loss: 0.0408922 Test Loss: 0.1272206
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1301489
	speed: 0.0373s/iter; left time: 336.4236s
	iters: 200, epoch: 5 | loss: 0.1468263
	speed: 0.0117s/iter; left time: 104.7537s
	iters: 300, epoch: 5 | loss: 0.1953197
	speed: 0.0118s/iter; left time: 103.8256s
	iters: 400, epoch: 5 | loss: 0.1264408
	speed: 0.0118s/iter; left time: 102.5850s
	iters: 500, epoch: 5 | loss: 0.1655729
	speed: 0.0117s/iter; left time: 101.1936s
Epoch: 5 cost time: 6.94179105758667
Epoch: 5, Steps: 570 | Train Loss: 0.1415610 Vali Loss: 0.0391050 Test Loss: 0.1350502
Validation loss decreased (0.040396 --> 0.039105).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1079682
	speed: 0.0389s/iter; left time: 328.4022s
	iters: 200, epoch: 6 | loss: 0.0753686
	speed: 0.0118s/iter; left time: 98.3587s
	iters: 300, epoch: 6 | loss: 0.1315178
	speed: 0.0117s/iter; left time: 96.7529s
	iters: 400, epoch: 6 | loss: 0.1358324
	speed: 0.0117s/iter; left time: 95.3249s
	iters: 500, epoch: 6 | loss: 0.1078218
	speed: 0.0117s/iter; left time: 94.4654s
Epoch: 6 cost time: 6.986562967300415
Epoch: 6, Steps: 570 | Train Loss: 0.1328587 Vali Loss: 0.0397965 Test Loss: 0.1372565
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1376452
	speed: 0.0373s/iter; left time: 293.6582s
	iters: 200, epoch: 7 | loss: 0.1437879
	speed: 0.0117s/iter; left time: 91.0816s
	iters: 300, epoch: 7 | loss: 0.1545468
	speed: 0.0117s/iter; left time: 90.1578s
	iters: 400, epoch: 7 | loss: 0.1029997
	speed: 0.0117s/iter; left time: 88.9731s
	iters: 500, epoch: 7 | loss: 0.1058082
	speed: 0.0117s/iter; left time: 87.5507s
Epoch: 7 cost time: 6.945260286331177
Epoch: 7, Steps: 570 | Train Loss: 0.1279728 Vali Loss: 0.0398127 Test Loss: 0.1358817
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0872581
	speed: 0.0384s/iter; left time: 281.0367s
	iters: 200, epoch: 8 | loss: 0.1406387
	speed: 0.0118s/iter; left time: 84.7293s
	iters: 300, epoch: 8 | loss: 0.1232611
	speed: 0.0118s/iter; left time: 83.9208s
	iters: 400, epoch: 8 | loss: 0.1287247
	speed: 0.0118s/iter; left time: 82.6534s
	iters: 500, epoch: 8 | loss: 0.0884825
	speed: 0.0118s/iter; left time: 81.5331s
Epoch: 8 cost time: 6.992527008056641
Epoch: 8, Steps: 570 | Train Loss: 0.1256740 Vali Loss: 0.0399080 Test Loss: 0.1350701
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13516460359096527, mae:0.23155950009822845
>>> S LR=5e-4 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1166797
	speed: 0.0230s/iter; left time: 259.3679s
	iters: 200, epoch: 1 | loss: 0.2645642
	speed: 0.0113s/iter; left time: 126.8185s
	iters: 300, epoch: 1 | loss: 0.1384459
	speed: 0.0113s/iter; left time: 125.4464s
	iters: 400, epoch: 1 | loss: 0.2020817
	speed: 0.0113s/iter; left time: 124.3664s
	iters: 500, epoch: 1 | loss: 0.1040736
	speed: 0.0113s/iter; left time: 123.3591s
Epoch: 1 cost time: 7.660045623779297
Epoch: 1, Steps: 570 | Train Loss: 0.1889960 Vali Loss: 0.0399435 Test Loss: 0.1244110
Validation loss decreased (inf --> 0.039943).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1384673
	speed: 0.0381s/iter; left time: 408.6368s
	iters: 200, epoch: 2 | loss: 0.0948874
	speed: 0.0113s/iter; left time: 120.6364s
	iters: 300, epoch: 2 | loss: 0.1690979
	speed: 0.0113s/iter; left time: 119.2923s
	iters: 400, epoch: 2 | loss: 0.2209235
	speed: 0.0113s/iter; left time: 118.0159s
	iters: 500, epoch: 2 | loss: 0.2237184
	speed: 0.0113s/iter; left time: 116.9462s
Epoch: 2 cost time: 6.745270252227783
Epoch: 2, Steps: 570 | Train Loss: 0.1593986 Vali Loss: 0.0362923 Test Loss: 0.1228700
Validation loss decreased (0.039943 --> 0.036292).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1448911
	speed: 0.0380s/iter; left time: 386.4143s
	iters: 200, epoch: 3 | loss: 0.0798275
	speed: 0.0113s/iter; left time: 114.1071s
	iters: 300, epoch: 3 | loss: 0.1542160
	speed: 0.0113s/iter; left time: 112.9913s
	iters: 400, epoch: 3 | loss: 0.1345584
	speed: 0.0114s/iter; left time: 112.0045s
	iters: 500, epoch: 3 | loss: 0.1619175
	speed: 0.0113s/iter; left time: 110.6733s
Epoch: 3 cost time: 6.837172746658325
Epoch: 3, Steps: 570 | Train Loss: 0.1381305 Vali Loss: 0.0330361 Test Loss: 0.1147988
Validation loss decreased (0.036292 --> 0.033036).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1145052
	speed: 0.0383s/iter; left time: 367.0344s
	iters: 200, epoch: 4 | loss: 0.0648925
	speed: 0.0113s/iter; left time: 107.5871s
	iters: 300, epoch: 4 | loss: 0.0731303
	speed: 0.0113s/iter; left time: 106.1495s
	iters: 400, epoch: 4 | loss: 0.1430500
	speed: 0.0113s/iter; left time: 105.2898s
	iters: 500, epoch: 4 | loss: 0.1182347
	speed: 0.0113s/iter; left time: 104.2948s
Epoch: 4 cost time: 6.7374725341796875
Epoch: 4, Steps: 570 | Train Loss: 0.1225972 Vali Loss: 0.0317828 Test Loss: 0.1117852
Validation loss decreased (0.033036 --> 0.031783).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1006379
	speed: 0.0372s/iter; left time: 335.9808s
	iters: 200, epoch: 5 | loss: 0.0818202
	speed: 0.0113s/iter; left time: 101.0136s
	iters: 300, epoch: 5 | loss: 0.1598379
	speed: 0.0113s/iter; left time: 99.5505s
	iters: 400, epoch: 5 | loss: 0.1182280
	speed: 0.0113s/iter; left time: 98.3701s
	iters: 500, epoch: 5 | loss: 0.0912543
	speed: 0.0113s/iter; left time: 97.3157s
Epoch: 5 cost time: 6.6974756717681885
Epoch: 5, Steps: 570 | Train Loss: 0.1106033 Vali Loss: 0.0314187 Test Loss: 0.1158202
Validation loss decreased (0.031783 --> 0.031419).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1269238
	speed: 0.0370s/iter; left time: 312.3347s
	iters: 200, epoch: 6 | loss: 0.1069170
	speed: 0.0113s/iter; left time: 94.0818s
	iters: 300, epoch: 6 | loss: 0.0720263
	speed: 0.0113s/iter; left time: 93.0870s
	iters: 400, epoch: 6 | loss: 0.0796905
	speed: 0.0113s/iter; left time: 91.8592s
	iters: 500, epoch: 6 | loss: 0.0848349
	speed: 0.0113s/iter; left time: 90.8322s
Epoch: 6 cost time: 6.725327014923096
Epoch: 6, Steps: 570 | Train Loss: 0.1034685 Vali Loss: 0.0311299 Test Loss: 0.1165161
Validation loss decreased (0.031419 --> 0.031130).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0777363
	speed: 0.0374s/iter; left time: 294.4023s
	iters: 200, epoch: 7 | loss: 0.1205813
	speed: 0.0113s/iter; left time: 88.0452s
	iters: 300, epoch: 7 | loss: 0.0701363
	speed: 0.0113s/iter; left time: 86.8803s
	iters: 400, epoch: 7 | loss: 0.0782385
	speed: 0.0113s/iter; left time: 85.7759s
	iters: 500, epoch: 7 | loss: 0.1069227
	speed: 0.0113s/iter; left time: 84.6158s
Epoch: 7 cost time: 6.748492240905762
Epoch: 7, Steps: 570 | Train Loss: 0.0996308 Vali Loss: 0.0313462 Test Loss: 0.1196261
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0820758
	speed: 0.0369s/iter; left time: 269.5039s
	iters: 200, epoch: 8 | loss: 0.1232129
	speed: 0.0114s/iter; left time: 81.8599s
	iters: 300, epoch: 8 | loss: 0.0698414
	speed: 0.0114s/iter; left time: 80.7257s
	iters: 400, epoch: 8 | loss: 0.0845081
	speed: 0.0113s/iter; left time: 79.5542s
	iters: 500, epoch: 8 | loss: 0.0817426
	speed: 0.0113s/iter; left time: 78.3954s
Epoch: 8 cost time: 6.743968486785889
Epoch: 8, Steps: 570 | Train Loss: 0.0978244 Vali Loss: 0.0313812 Test Loss: 0.1189040
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1520836
	speed: 0.0377s/iter; left time: 254.1868s
	iters: 200, epoch: 9 | loss: 0.0704654
	speed: 0.0113s/iter; left time: 75.0785s
	iters: 300, epoch: 9 | loss: 0.1120772
	speed: 0.0113s/iter; left time: 73.9157s
	iters: 400, epoch: 9 | loss: 0.0987159
	speed: 0.0113s/iter; left time: 72.8219s
	iters: 500, epoch: 9 | loss: 0.1548379
	speed: 0.0113s/iter; left time: 71.6431s
Epoch: 9 cost time: 6.740302562713623
Epoch: 9, Steps: 570 | Train Loss: 0.0971447 Vali Loss: 0.0311952 Test Loss: 0.1196207
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11664172261953354, mae:0.20357994735240936
>>> S LR=5e-4 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2339505
	speed: 0.0240s/iter; left time: 271.6787s
	iters: 200, epoch: 1 | loss: 0.2804482
	speed: 0.0120s/iter; left time: 134.3260s
	iters: 300, epoch: 1 | loss: 0.2543612
	speed: 0.0120s/iter; left time: 132.8211s
	iters: 400, epoch: 1 | loss: 0.1768470
	speed: 0.0120s/iter; left time: 131.7338s
	iters: 500, epoch: 1 | loss: 0.1613545
	speed: 0.0120s/iter; left time: 130.5392s
Epoch: 1 cost time: 8.07848072052002
Epoch: 1, Steps: 570 | Train Loss: 0.2307686 Vali Loss: 0.0462898 Test Loss: 0.1512581
Validation loss decreased (inf --> 0.046290).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1796775
	speed: 0.0389s/iter; left time: 417.3764s
	iters: 200, epoch: 2 | loss: 0.2914657
	speed: 0.0108s/iter; left time: 115.0797s
	iters: 300, epoch: 2 | loss: 0.1353850
	speed: 0.0108s/iter; left time: 114.2134s
	iters: 400, epoch: 2 | loss: 0.1530507
	speed: 0.0109s/iter; left time: 113.2311s
	iters: 500, epoch: 2 | loss: 0.1551496
	speed: 0.0108s/iter; left time: 111.8100s
Epoch: 2 cost time: 6.481341361999512
Epoch: 2, Steps: 570 | Train Loss: 0.2013085 Vali Loss: 0.0430781 Test Loss: 0.1480166
Validation loss decreased (0.046290 --> 0.043078).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1773811
	speed: 0.0369s/iter; left time: 375.2983s
	iters: 200, epoch: 3 | loss: 0.1274584
	speed: 0.0108s/iter; left time: 108.4647s
	iters: 300, epoch: 3 | loss: 0.3105730
	speed: 0.0108s/iter; left time: 107.4429s
	iters: 400, epoch: 3 | loss: 0.1356761
	speed: 0.0108s/iter; left time: 106.1554s
	iters: 500, epoch: 3 | loss: 0.1926161
	speed: 0.0108s/iter; left time: 105.0608s
Epoch: 3 cost time: 6.415215015411377
Epoch: 3, Steps: 570 | Train Loss: 0.1731498 Vali Loss: 0.0423497 Test Loss: 0.1452866
Validation loss decreased (0.043078 --> 0.042350).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2011382
	speed: 0.0370s/iter; left time: 355.2294s
	iters: 200, epoch: 4 | loss: 0.1050990
	speed: 0.0109s/iter; left time: 103.1475s
	iters: 300, epoch: 4 | loss: 0.1383519
	speed: 0.0108s/iter; left time: 101.5518s
	iters: 400, epoch: 4 | loss: 0.2392203
	speed: 0.0108s/iter; left time: 100.2739s
	iters: 500, epoch: 4 | loss: 0.1495783
	speed: 0.0108s/iter; left time: 99.1811s
Epoch: 4 cost time: 6.45667576789856
Epoch: 4, Steps: 570 | Train Loss: 0.1512561 Vali Loss: 0.0424765 Test Loss: 0.1424830
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1169474
	speed: 0.0369s/iter; left time: 332.4433s
	iters: 200, epoch: 5 | loss: 0.1403864
	speed: 0.0108s/iter; left time: 96.1438s
	iters: 300, epoch: 5 | loss: 0.1244666
	speed: 0.0108s/iter; left time: 95.2928s
	iters: 400, epoch: 5 | loss: 0.0971000
	speed: 0.0108s/iter; left time: 94.2715s
	iters: 500, epoch: 5 | loss: 0.1975292
	speed: 0.0108s/iter; left time: 93.1233s
Epoch: 5 cost time: 6.419692516326904
Epoch: 5, Steps: 570 | Train Loss: 0.1332809 Vali Loss: 0.0409175 Test Loss: 0.1376887
Validation loss decreased (0.042350 --> 0.040917).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1077899
	speed: 0.0374s/iter; left time: 315.7718s
	iters: 200, epoch: 6 | loss: 0.1010462
	speed: 0.0120s/iter; left time: 100.2597s
	iters: 300, epoch: 6 | loss: 0.1274330
	speed: 0.0120s/iter; left time: 98.7305s
	iters: 400, epoch: 6 | loss: 0.0996179
	speed: 0.0110s/iter; left time: 89.6526s
	iters: 500, epoch: 6 | loss: 0.1137542
	speed: 0.0108s/iter; left time: 87.2990s
Epoch: 6 cost time: 6.835561990737915
Epoch: 6, Steps: 570 | Train Loss: 0.1217777 Vali Loss: 0.0417545 Test Loss: 0.1385071
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1124462
	speed: 0.0379s/iter; left time: 298.8513s
	iters: 200, epoch: 7 | loss: 0.0956604
	speed: 0.0108s/iter; left time: 84.3844s
	iters: 300, epoch: 7 | loss: 0.0857236
	speed: 0.0108s/iter; left time: 83.2407s
	iters: 400, epoch: 7 | loss: 0.1295266
	speed: 0.0108s/iter; left time: 82.1306s
	iters: 500, epoch: 7 | loss: 0.0840503
	speed: 0.0108s/iter; left time: 80.9155s
Epoch: 7 cost time: 6.468072175979614
Epoch: 7, Steps: 570 | Train Loss: 0.1160263 Vali Loss: 0.0411179 Test Loss: 0.1425528
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0894859
	speed: 0.0371s/iter; left time: 271.4346s
	iters: 200, epoch: 8 | loss: 0.1640084
	speed: 0.0108s/iter; left time: 77.9975s
	iters: 300, epoch: 8 | loss: 0.1402889
	speed: 0.0109s/iter; left time: 77.2678s
	iters: 400, epoch: 8 | loss: 0.1151496
	speed: 0.0109s/iter; left time: 76.1193s
	iters: 500, epoch: 8 | loss: 0.0804572
	speed: 0.0109s/iter; left time: 75.1125s
Epoch: 8 cost time: 6.436040163040161
Epoch: 8, Steps: 570 | Train Loss: 0.1131594 Vali Loss: 0.0407172 Test Loss: 0.1387922
Validation loss decreased (0.040917 --> 0.040717).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1026296
	speed: 0.0372s/iter; left time: 250.5259s
	iters: 200, epoch: 9 | loss: 0.0900444
	speed: 0.0108s/iter; left time: 71.8009s
	iters: 300, epoch: 9 | loss: 0.1147151
	speed: 0.0108s/iter; left time: 70.6388s
	iters: 400, epoch: 9 | loss: 0.1298729
	speed: 0.0108s/iter; left time: 69.7120s
	iters: 500, epoch: 9 | loss: 0.0642720
	speed: 0.0108s/iter; left time: 68.5771s
Epoch: 9 cost time: 6.465718984603882
Epoch: 9, Steps: 570 | Train Loss: 0.1112410 Vali Loss: 0.0409026 Test Loss: 0.1392649
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1261833
	speed: 0.0358s/iter; left time: 221.0286s
	iters: 200, epoch: 10 | loss: 0.0863844
	speed: 0.0108s/iter; left time: 65.4735s
	iters: 300, epoch: 10 | loss: 0.1083198
	speed: 0.0108s/iter; left time: 64.3604s
	iters: 400, epoch: 10 | loss: 0.0942268
	speed: 0.0108s/iter; left time: 63.2351s
	iters: 500, epoch: 10 | loss: 0.1543658
	speed: 0.0108s/iter; left time: 62.2046s
Epoch: 10 cost time: 6.415434122085571
Epoch: 10, Steps: 570 | Train Loss: 0.1115691 Vali Loss: 0.0409834 Test Loss: 0.1394692
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0825314
	speed: 0.0387s/iter; left time: 216.5095s
	iters: 200, epoch: 11 | loss: 0.0956717
	speed: 0.0108s/iter; left time: 59.5593s
	iters: 300, epoch: 11 | loss: 0.1135558
	speed: 0.0108s/iter; left time: 58.3877s
	iters: 400, epoch: 11 | loss: 0.0798715
	speed: 0.0108s/iter; left time: 57.1643s
	iters: 500, epoch: 11 | loss: 0.0903720
	speed: 0.0108s/iter; left time: 56.0487s
Epoch: 11 cost time: 6.408807039260864
Epoch: 11, Steps: 570 | Train Loss: 0.1108482 Vali Loss: 0.0409624 Test Loss: 0.1394883
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13892436027526855, mae:0.23908212780952454
>>> S LR=5e-4 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2073179
	speed: 0.0279s/iter; left time: 315.3237s
	iters: 200, epoch: 1 | loss: 0.1724497
	speed: 0.0162s/iter; left time: 181.3754s
	iters: 300, epoch: 1 | loss: 0.2628459
	speed: 0.0162s/iter; left time: 179.5416s
	iters: 400, epoch: 1 | loss: 0.1721801
	speed: 0.0162s/iter; left time: 177.9495s
	iters: 500, epoch: 1 | loss: 0.1615929
	speed: 0.0163s/iter; left time: 177.4872s
Epoch: 1 cost time: 10.470357894897461
Epoch: 1, Steps: 570 | Train Loss: 0.2114805 Vali Loss: 0.0430904 Test Loss: 0.1349138
Validation loss decreased (inf --> 0.043090).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2776829
	speed: 0.0469s/iter; left time: 502.9774s
	iters: 200, epoch: 2 | loss: 0.2004034
	speed: 0.0148s/iter; left time: 157.1604s
	iters: 300, epoch: 2 | loss: 0.1333555
	speed: 0.0164s/iter; left time: 172.3475s
	iters: 400, epoch: 2 | loss: 0.0835505
	speed: 0.0145s/iter; left time: 151.5657s
	iters: 500, epoch: 2 | loss: 0.1869204
	speed: 0.0145s/iter; left time: 149.8838s
Epoch: 2 cost time: 8.775601863861084
Epoch: 2, Steps: 570 | Train Loss: 0.1822491 Vali Loss: 0.0434768 Test Loss: 0.1495963
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2611439
	speed: 0.0487s/iter; left time: 494.4224s
	iters: 200, epoch: 3 | loss: 0.1977251
	speed: 0.0146s/iter; left time: 146.5862s
	iters: 300, epoch: 3 | loss: 0.1073136
	speed: 0.0146s/iter; left time: 145.2565s
	iters: 400, epoch: 3 | loss: 0.1427068
	speed: 0.0146s/iter; left time: 144.0436s
	iters: 500, epoch: 3 | loss: 0.1152935
	speed: 0.0146s/iter; left time: 142.4158s
Epoch: 3 cost time: 8.799861431121826
Epoch: 3, Steps: 570 | Train Loss: 0.1537463 Vali Loss: 0.0392279 Test Loss: 0.1378878
Validation loss decreased (0.043090 --> 0.039228).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1186068
	speed: 0.0474s/iter; left time: 454.3109s
	iters: 200, epoch: 4 | loss: 0.0991348
	speed: 0.0145s/iter; left time: 137.2916s
	iters: 300, epoch: 4 | loss: 0.1417857
	speed: 0.0145s/iter; left time: 136.0585s
	iters: 400, epoch: 4 | loss: 0.1399137
	speed: 0.0145s/iter; left time: 134.5189s
	iters: 500, epoch: 4 | loss: 0.1223311
	speed: 0.0144s/iter; left time: 132.5641s
Epoch: 4 cost time: 8.642152547836304
Epoch: 4, Steps: 570 | Train Loss: 0.1334688 Vali Loss: 0.0389725 Test Loss: 0.1488070
Validation loss decreased (0.039228 --> 0.038973).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1055724
	speed: 0.0456s/iter; left time: 411.1131s
	iters: 200, epoch: 5 | loss: 0.1162470
	speed: 0.0167s/iter; left time: 148.9114s
	iters: 300, epoch: 5 | loss: 0.1191836
	speed: 0.0167s/iter; left time: 147.1851s
	iters: 400, epoch: 5 | loss: 0.1150782
	speed: 0.0167s/iter; left time: 145.7833s
	iters: 500, epoch: 5 | loss: 0.0966017
	speed: 0.0167s/iter; left time: 143.9848s
Epoch: 5 cost time: 9.605655431747437
Epoch: 5, Steps: 570 | Train Loss: 0.1210818 Vali Loss: 0.0385271 Test Loss: 0.1434408
Validation loss decreased (0.038973 --> 0.038527).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0916521
	speed: 0.0495s/iter; left time: 418.1857s
	iters: 200, epoch: 6 | loss: 0.1350471
	speed: 0.0167s/iter; left time: 139.5951s
	iters: 300, epoch: 6 | loss: 0.0933428
	speed: 0.0167s/iter; left time: 137.8557s
	iters: 400, epoch: 6 | loss: 0.0853092
	speed: 0.0168s/iter; left time: 136.5391s
	iters: 500, epoch: 6 | loss: 0.1028471
	speed: 0.0164s/iter; left time: 132.2485s
Epoch: 6 cost time: 9.626161813735962
Epoch: 6, Steps: 570 | Train Loss: 0.1129811 Vali Loss: 0.0390878 Test Loss: 0.1517361
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1170462
	speed: 0.0462s/iter; left time: 364.2340s
	iters: 200, epoch: 7 | loss: 0.1064533
	speed: 0.0144s/iter; left time: 112.3585s
	iters: 300, epoch: 7 | loss: 0.0945800
	speed: 0.0145s/iter; left time: 111.3879s
	iters: 400, epoch: 7 | loss: 0.1047316
	speed: 0.0145s/iter; left time: 109.7628s
	iters: 500, epoch: 7 | loss: 0.1267208
	speed: 0.0145s/iter; left time: 108.2278s
Epoch: 7 cost time: 8.512087345123291
Epoch: 7, Steps: 570 | Train Loss: 0.1103752 Vali Loss: 0.0391223 Test Loss: 0.1552943
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1633033
	speed: 0.0474s/iter; left time: 346.6236s
	iters: 200, epoch: 8 | loss: 0.1108323
	speed: 0.0168s/iter; left time: 120.9677s
	iters: 300, epoch: 8 | loss: 0.1109498
	speed: 0.0167s/iter; left time: 118.5365s
	iters: 400, epoch: 8 | loss: 0.0775762
	speed: 0.0166s/iter; left time: 116.6131s
	iters: 500, epoch: 8 | loss: 0.1103523
	speed: 0.0167s/iter; left time: 115.1218s
Epoch: 8 cost time: 9.767154455184937
Epoch: 8, Steps: 570 | Train Loss: 0.1078969 Vali Loss: 0.0395592 Test Loss: 0.1546312
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14346101880073547, mae:0.23655220866203308
>>> S LR=5e-4 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2374364
	speed: 0.0260s/iter; left time: 293.9860s
	iters: 200, epoch: 1 | loss: 0.1468252
	speed: 0.0143s/iter; left time: 159.7770s
	iters: 300, epoch: 1 | loss: 0.1269834
	speed: 0.0142s/iter; left time: 157.9743s
	iters: 400, epoch: 1 | loss: 0.2398689
	speed: 0.0143s/iter; left time: 157.1300s
	iters: 500, epoch: 1 | loss: 0.1648366
	speed: 0.0143s/iter; left time: 155.6291s
Epoch: 1 cost time: 9.357492446899414
Epoch: 1, Steps: 570 | Train Loss: 0.1794538 Vali Loss: 0.0360547 Test Loss: 0.1210899
Validation loss decreased (inf --> 0.036055).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1264700
	speed: 0.0450s/iter; left time: 482.7854s
	iters: 200, epoch: 2 | loss: 0.2272067
	speed: 0.0143s/iter; left time: 151.6387s
	iters: 300, epoch: 2 | loss: 0.1637380
	speed: 0.0142s/iter; left time: 150.0151s
	iters: 400, epoch: 2 | loss: 0.1870182
	speed: 0.0143s/iter; left time: 148.9639s
	iters: 500, epoch: 2 | loss: 0.1304158
	speed: 0.0143s/iter; left time: 147.2945s
Epoch: 2 cost time: 8.391688346862793
Epoch: 2, Steps: 570 | Train Loss: 0.1534799 Vali Loss: 0.0349395 Test Loss: 0.1172763
Validation loss decreased (0.036055 --> 0.034940).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1552715
	speed: 0.0466s/iter; left time: 473.9911s
	iters: 200, epoch: 3 | loss: 0.0728637
	speed: 0.0142s/iter; left time: 142.9882s
	iters: 300, epoch: 3 | loss: 0.1801138
	speed: 0.0142s/iter; left time: 141.4310s
	iters: 400, epoch: 3 | loss: 0.0927953
	speed: 0.0142s/iter; left time: 140.2861s
	iters: 500, epoch: 3 | loss: 0.1245721
	speed: 0.0142s/iter; left time: 138.6858s
Epoch: 3 cost time: 8.339242458343506
Epoch: 3, Steps: 570 | Train Loss: 0.1316003 Vali Loss: 0.0317873 Test Loss: 0.1140710
Validation loss decreased (0.034940 --> 0.031787).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1158740
	speed: 0.0440s/iter; left time: 421.7228s
	iters: 200, epoch: 4 | loss: 0.1110276
	speed: 0.0143s/iter; left time: 135.5893s
	iters: 300, epoch: 4 | loss: 0.1331118
	speed: 0.0143s/iter; left time: 134.2141s
	iters: 400, epoch: 4 | loss: 0.0714231
	speed: 0.0143s/iter; left time: 132.6791s
	iters: 500, epoch: 4 | loss: 0.0838022
	speed: 0.0143s/iter; left time: 131.0348s
Epoch: 4 cost time: 8.395303010940552
Epoch: 4, Steps: 570 | Train Loss: 0.1172963 Vali Loss: 0.0310119 Test Loss: 0.1130895
Validation loss decreased (0.031787 --> 0.031012).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0711030
	speed: 0.0446s/iter; left time: 402.3624s
	iters: 200, epoch: 5 | loss: 0.0919524
	speed: 0.0142s/iter; left time: 126.9481s
	iters: 300, epoch: 5 | loss: 0.1349658
	speed: 0.0142s/iter; left time: 125.3732s
	iters: 400, epoch: 5 | loss: 0.0852608
	speed: 0.0142s/iter; left time: 124.2535s
	iters: 500, epoch: 5 | loss: 0.1245124
	speed: 0.0142s/iter; left time: 122.7643s
Epoch: 5 cost time: 8.354637384414673
Epoch: 5, Steps: 570 | Train Loss: 0.1068427 Vali Loss: 0.0311211 Test Loss: 0.1122840
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0813633
	speed: 0.0436s/iter; left time: 368.3920s
	iters: 200, epoch: 6 | loss: 0.1922761
	speed: 0.0143s/iter; left time: 119.5768s
	iters: 300, epoch: 6 | loss: 0.1413756
	speed: 0.0143s/iter; left time: 118.2149s
	iters: 400, epoch: 6 | loss: 0.1145679
	speed: 0.0143s/iter; left time: 116.6546s
	iters: 500, epoch: 6 | loss: 0.1151332
	speed: 0.0143s/iter; left time: 115.2253s
Epoch: 6 cost time: 8.407727479934692
Epoch: 6, Steps: 570 | Train Loss: 0.1007352 Vali Loss: 0.0311329 Test Loss: 0.1176411
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0892259
	speed: 0.0437s/iter; left time: 344.7884s
	iters: 200, epoch: 7 | loss: 0.1122293
	speed: 0.0141s/iter; left time: 109.8078s
	iters: 300, epoch: 7 | loss: 0.1441622
	speed: 0.0141s/iter; left time: 108.4956s
	iters: 400, epoch: 7 | loss: 0.1093433
	speed: 0.0141s/iter; left time: 107.0693s
	iters: 500, epoch: 7 | loss: 0.1316777
	speed: 0.0142s/iter; left time: 106.0043s
Epoch: 7 cost time: 8.320691585540771
Epoch: 7, Steps: 570 | Train Loss: 0.0977571 Vali Loss: 0.0314179 Test Loss: 0.1166594
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11322146654129028, mae:0.20098266005516052
>>> S LR=5e-4 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1169593
	speed: 0.0280s/iter; left time: 315.9094s
	iters: 200, epoch: 1 | loss: 0.2928999
	speed: 0.0160s/iter; left time: 179.1070s
	iters: 300, epoch: 1 | loss: 0.3225565
	speed: 0.0160s/iter; left time: 177.2159s
	iters: 400, epoch: 1 | loss: 0.1784459
	speed: 0.0160s/iter; left time: 176.3912s
	iters: 500, epoch: 1 | loss: 0.2449971
	speed: 0.0160s/iter; left time: 174.6817s
Epoch: 1 cost time: 10.355861186981201
Epoch: 1, Steps: 570 | Train Loss: 0.2213583 Vali Loss: 0.0455986 Test Loss: 0.1417276
Validation loss decreased (inf --> 0.045599).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1712906
	speed: 0.0455s/iter; left time: 488.4913s
	iters: 200, epoch: 2 | loss: 0.1516035
	speed: 0.0142s/iter; left time: 151.1223s
	iters: 300, epoch: 2 | loss: 0.1319928
	speed: 0.0142s/iter; left time: 149.9522s
	iters: 400, epoch: 2 | loss: 0.1427805
	speed: 0.0142s/iter; left time: 148.1966s
	iters: 500, epoch: 2 | loss: 0.1778232
	speed: 0.0142s/iter; left time: 147.0081s
Epoch: 2 cost time: 8.361896514892578
Epoch: 2, Steps: 570 | Train Loss: 0.1865538 Vali Loss: 0.0442056 Test Loss: 0.1538060
Validation loss decreased (0.045599 --> 0.044206).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1771600
	speed: 0.0484s/iter; left time: 491.4582s
	iters: 200, epoch: 3 | loss: 0.1827958
	speed: 0.0142s/iter; left time: 142.7995s
	iters: 300, epoch: 3 | loss: 0.1203309
	speed: 0.0142s/iter; left time: 141.2762s
	iters: 400, epoch: 3 | loss: 0.0963388
	speed: 0.0142s/iter; left time: 139.7668s
	iters: 500, epoch: 3 | loss: 0.1551706
	speed: 0.0142s/iter; left time: 138.4304s
Epoch: 3 cost time: 8.333117485046387
Epoch: 3, Steps: 570 | Train Loss: 0.1538651 Vali Loss: 0.0405586 Test Loss: 0.1442673
Validation loss decreased (0.044206 --> 0.040559).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1521019
	speed: 0.0456s/iter; left time: 437.6780s
	iters: 200, epoch: 4 | loss: 0.1714316
	speed: 0.0142s/iter; left time: 134.5815s
	iters: 300, epoch: 4 | loss: 0.1494647
	speed: 0.0142s/iter; left time: 133.0146s
	iters: 400, epoch: 4 | loss: 0.1030435
	speed: 0.0142s/iter; left time: 131.9383s
	iters: 500, epoch: 4 | loss: 0.1000078
	speed: 0.0142s/iter; left time: 130.1785s
Epoch: 4 cost time: 8.320516586303711
Epoch: 4, Steps: 570 | Train Loss: 0.1302874 Vali Loss: 0.0426035 Test Loss: 0.1586380
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1113127
	speed: 0.0457s/iter; left time: 412.7016s
	iters: 200, epoch: 5 | loss: 0.1367304
	speed: 0.0156s/iter; left time: 139.0267s
	iters: 300, epoch: 5 | loss: 0.1044179
	speed: 0.0142s/iter; left time: 125.2056s
	iters: 400, epoch: 5 | loss: 0.1440425
	speed: 0.0142s/iter; left time: 123.5881s
	iters: 500, epoch: 5 | loss: 0.0871783
	speed: 0.0142s/iter; left time: 122.0537s
Epoch: 5 cost time: 8.640426874160767
Epoch: 5, Steps: 570 | Train Loss: 0.1151008 Vali Loss: 0.0407550 Test Loss: 0.1479764
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1056251
	speed: 0.0444s/iter; left time: 375.2743s
	iters: 200, epoch: 6 | loss: 0.0927904
	speed: 0.0141s/iter; left time: 117.7871s
	iters: 300, epoch: 6 | loss: 0.0760986
	speed: 0.0141s/iter; left time: 116.4786s
	iters: 400, epoch: 6 | loss: 0.1452284
	speed: 0.0141s/iter; left time: 115.3320s
	iters: 500, epoch: 6 | loss: 0.1120927
	speed: 0.0141s/iter; left time: 113.7933s
Epoch: 6 cost time: 8.304442405700684
Epoch: 6, Steps: 570 | Train Loss: 0.1077457 Vali Loss: 0.0412101 Test Loss: 0.1525954
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14430485665798187, mae:0.24109578132629395
>>> S LR=5e-4 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2596392
	speed: 0.0306s/iter; left time: 346.1465s
	iters: 200, epoch: 1 | loss: 0.2024460
	speed: 0.0183s/iter; left time: 204.5849s
	iters: 300, epoch: 1 | loss: 0.3191519
	speed: 0.0182s/iter; left time: 202.1046s
	iters: 400, epoch: 1 | loss: 0.2433892
	speed: 0.0181s/iter; left time: 199.4409s
	iters: 500, epoch: 1 | loss: 0.1942536
	speed: 0.0181s/iter; left time: 197.1116s
Epoch: 1 cost time: 11.64665150642395
Epoch: 1, Steps: 570 | Train Loss: 0.2274121 Vali Loss: 0.0479783 Test Loss: 0.1522838
Validation loss decreased (inf --> 0.047978).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2078144
	speed: 0.0527s/iter; left time: 565.2507s
	iters: 200, epoch: 2 | loss: 0.2688078
	speed: 0.0181s/iter; left time: 192.5138s
	iters: 300, epoch: 2 | loss: 0.2033230
	speed: 0.0181s/iter; left time: 191.0240s
	iters: 400, epoch: 2 | loss: 0.1444284
	speed: 0.0181s/iter; left time: 189.2656s
	iters: 500, epoch: 2 | loss: 0.1516723
	speed: 0.0181s/iter; left time: 187.2699s
Epoch: 2 cost time: 10.557076692581177
Epoch: 2, Steps: 570 | Train Loss: 0.2097460 Vali Loss: 0.0477238 Test Loss: 0.1471035
Validation loss decreased (0.047978 --> 0.047724).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1615966
	speed: 0.0505s/iter; left time: 513.6103s
	iters: 200, epoch: 3 | loss: 0.2014754
	speed: 0.0181s/iter; left time: 182.3837s
	iters: 300, epoch: 3 | loss: 0.2758367
	speed: 0.0181s/iter; left time: 180.3647s
	iters: 400, epoch: 3 | loss: 0.1606646
	speed: 0.0181s/iter; left time: 178.6472s
	iters: 500, epoch: 3 | loss: 0.1829529
	speed: 0.0182s/iter; left time: 177.2873s
Epoch: 3 cost time: 10.50282621383667
Epoch: 3, Steps: 570 | Train Loss: 0.1883531 Vali Loss: 0.0407007 Test Loss: 0.1323941
Validation loss decreased (0.047724 --> 0.040701).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1519488
	speed: 0.0533s/iter; left time: 510.8332s
	iters: 200, epoch: 4 | loss: 0.1552097
	speed: 0.0167s/iter; left time: 158.5914s
	iters: 300, epoch: 4 | loss: 0.1577486
	speed: 0.0167s/iter; left time: 156.7782s
	iters: 400, epoch: 4 | loss: 0.1857843
	speed: 0.0167s/iter; left time: 155.2682s
	iters: 500, epoch: 4 | loss: 0.1966726
	speed: 0.0167s/iter; left time: 153.4734s
Epoch: 4 cost time: 9.796873807907104
Epoch: 4, Steps: 570 | Train Loss: 0.1660346 Vali Loss: 0.0403756 Test Loss: 0.1435604
Validation loss decreased (0.040701 --> 0.040376).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1342857
	speed: 0.0508s/iter; left time: 458.4852s
	iters: 200, epoch: 5 | loss: 0.2082463
	speed: 0.0167s/iter; left time: 148.9136s
	iters: 300, epoch: 5 | loss: 0.1587847
	speed: 0.0167s/iter; left time: 146.9559s
	iters: 400, epoch: 5 | loss: 0.1968675
	speed: 0.0167s/iter; left time: 145.4924s
	iters: 500, epoch: 5 | loss: 0.1436912
	speed: 0.0167s/iter; left time: 143.5896s
Epoch: 5 cost time: 9.791324853897095
Epoch: 5, Steps: 570 | Train Loss: 0.1547256 Vali Loss: 0.0392075 Test Loss: 0.1435275
Validation loss decreased (0.040376 --> 0.039208).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1715870
	speed: 0.0494s/iter; left time: 417.4807s
	iters: 200, epoch: 6 | loss: 0.1234830
	speed: 0.0168s/iter; left time: 139.9954s
	iters: 300, epoch: 6 | loss: 0.1387598
	speed: 0.0167s/iter; left time: 138.1798s
	iters: 400, epoch: 6 | loss: 0.1646836
	speed: 0.0167s/iter; left time: 136.4333s
	iters: 500, epoch: 6 | loss: 0.1660619
	speed: 0.0167s/iter; left time: 134.7581s
Epoch: 6 cost time: 9.848996639251709
Epoch: 6, Steps: 570 | Train Loss: 0.1480419 Vali Loss: 0.0383959 Test Loss: 0.1410808
Validation loss decreased (0.039208 --> 0.038396).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1564510
	speed: 0.0515s/iter; left time: 405.9718s
	iters: 200, epoch: 7 | loss: 0.1736232
	speed: 0.0173s/iter; left time: 134.4271s
	iters: 300, epoch: 7 | loss: 0.1876498
	speed: 0.0177s/iter; left time: 136.1000s
	iters: 400, epoch: 7 | loss: 0.1072704
	speed: 0.0167s/iter; left time: 126.7896s
	iters: 500, epoch: 7 | loss: 0.1067216
	speed: 0.0167s/iter; left time: 125.1159s
Epoch: 7 cost time: 9.99192214012146
Epoch: 7, Steps: 570 | Train Loss: 0.1428101 Vali Loss: 0.0385657 Test Loss: 0.1399853
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1261003
	speed: 0.0507s/iter; left time: 370.5303s
	iters: 200, epoch: 8 | loss: 0.1026171
	speed: 0.0182s/iter; left time: 131.1620s
	iters: 300, epoch: 8 | loss: 0.1397813
	speed: 0.0168s/iter; left time: 119.2702s
	iters: 400, epoch: 8 | loss: 0.1022508
	speed: 0.0168s/iter; left time: 117.8149s
	iters: 500, epoch: 8 | loss: 0.0927920
	speed: 0.0168s/iter; left time: 115.9964s
Epoch: 8 cost time: 10.133249998092651
Epoch: 8, Steps: 570 | Train Loss: 0.1410414 Vali Loss: 0.0379722 Test Loss: 0.1394845
Validation loss decreased (0.038396 --> 0.037972).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1427124
	speed: 0.0499s/iter; left time: 336.6863s
	iters: 200, epoch: 9 | loss: 0.1118197
	speed: 0.0167s/iter; left time: 110.8678s
	iters: 300, epoch: 9 | loss: 0.1075780
	speed: 0.0167s/iter; left time: 108.9521s
	iters: 400, epoch: 9 | loss: 0.1497556
	speed: 0.0166s/iter; left time: 107.1753s
	iters: 500, epoch: 9 | loss: 0.2089871
	speed: 0.0166s/iter; left time: 105.5656s
Epoch: 9 cost time: 9.79021143913269
Epoch: 9, Steps: 570 | Train Loss: 0.1390163 Vali Loss: 0.0381714 Test Loss: 0.1416813
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1363053
	speed: 0.0497s/iter; left time: 306.5590s
	iters: 200, epoch: 10 | loss: 0.0763886
	speed: 0.0167s/iter; left time: 101.5743s
	iters: 300, epoch: 10 | loss: 0.2109411
	speed: 0.0167s/iter; left time: 99.8172s
	iters: 400, epoch: 10 | loss: 0.1466294
	speed: 0.0167s/iter; left time: 98.1307s
	iters: 500, epoch: 10 | loss: 0.1212482
	speed: 0.0167s/iter; left time: 96.5182s
Epoch: 10 cost time: 9.797454118728638
Epoch: 10, Steps: 570 | Train Loss: 0.1378452 Vali Loss: 0.0383311 Test Loss: 0.1415264
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1128773
	speed: 0.0492s/iter; left time: 275.5581s
	iters: 200, epoch: 11 | loss: 0.1646030
	speed: 0.0168s/iter; left time: 92.1605s
	iters: 300, epoch: 11 | loss: 0.0761585
	speed: 0.0168s/iter; left time: 90.5657s
	iters: 400, epoch: 11 | loss: 0.1548335
	speed: 0.0168s/iter; left time: 88.8678s
	iters: 500, epoch: 11 | loss: 0.2280731
	speed: 0.0168s/iter; left time: 87.1547s
Epoch: 11 cost time: 9.856343984603882
Epoch: 11, Steps: 570 | Train Loss: 0.1393339 Vali Loss: 0.0382096 Test Loss: 0.1414101
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13962675631046295, mae:0.23504523932933807
>>> S LR=5e-4 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1689001
	speed: 0.0298s/iter; left time: 337.3181s
	iters: 200, epoch: 1 | loss: 0.1267278
	speed: 0.0177s/iter; left time: 198.8099s
	iters: 300, epoch: 1 | loss: 0.2172504
	speed: 0.0177s/iter; left time: 196.6617s
	iters: 400, epoch: 1 | loss: 0.1895749
	speed: 0.0177s/iter; left time: 195.1743s
	iters: 500, epoch: 1 | loss: 0.1068336
	speed: 0.0177s/iter; left time: 193.2830s
Epoch: 1 cost time: 11.375037431716919
Epoch: 1, Steps: 570 | Train Loss: 0.1930541 Vali Loss: 0.0382678 Test Loss: 0.1282156
Validation loss decreased (inf --> 0.038268).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1399422
	speed: 0.0524s/iter; left time: 562.0047s
	iters: 200, epoch: 2 | loss: 0.1189816
	speed: 0.0179s/iter; left time: 190.5180s
	iters: 300, epoch: 2 | loss: 0.2079436
	speed: 0.0179s/iter; left time: 188.5797s
	iters: 400, epoch: 2 | loss: 0.2579935
	speed: 0.0179s/iter; left time: 186.8505s
	iters: 500, epoch: 2 | loss: 0.1298793
	speed: 0.0179s/iter; left time: 185.3111s
Epoch: 2 cost time: 10.52425479888916
Epoch: 2, Steps: 570 | Train Loss: 0.1672585 Vali Loss: 0.0392850 Test Loss: 0.1302155
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1388787
	speed: 0.0517s/iter; left time: 525.5625s
	iters: 200, epoch: 3 | loss: 0.1580405
	speed: 0.0178s/iter; left time: 179.2718s
	iters: 300, epoch: 3 | loss: 0.1409271
	speed: 0.0178s/iter; left time: 177.3099s
	iters: 400, epoch: 3 | loss: 0.1703152
	speed: 0.0178s/iter; left time: 175.3947s
	iters: 500, epoch: 3 | loss: 0.0911815
	speed: 0.0178s/iter; left time: 173.5558s
Epoch: 3 cost time: 10.409844160079956
Epoch: 3, Steps: 570 | Train Loss: 0.1415995 Vali Loss: 0.0335223 Test Loss: 0.1143506
Validation loss decreased (0.038268 --> 0.033522).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1346305
	speed: 0.0552s/iter; left time: 529.7003s
	iters: 200, epoch: 4 | loss: 0.1851058
	speed: 0.0179s/iter; left time: 170.2935s
	iters: 300, epoch: 4 | loss: 0.0873606
	speed: 0.0179s/iter; left time: 168.4643s
	iters: 400, epoch: 4 | loss: 0.0898247
	speed: 0.0180s/iter; left time: 167.2047s
	iters: 500, epoch: 4 | loss: 0.1475482
	speed: 0.0179s/iter; left time: 164.9473s
Epoch: 4 cost time: 10.519389867782593
Epoch: 4, Steps: 570 | Train Loss: 0.1251858 Vali Loss: 0.0322880 Test Loss: 0.1119008
Validation loss decreased (0.033522 --> 0.032288).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1112558
	speed: 0.0520s/iter; left time: 469.0638s
	iters: 200, epoch: 5 | loss: 0.1319817
	speed: 0.0179s/iter; left time: 159.6303s
	iters: 300, epoch: 5 | loss: 0.1048391
	speed: 0.0179s/iter; left time: 157.7945s
	iters: 400, epoch: 5 | loss: 0.0790505
	speed: 0.0179s/iter; left time: 156.1319s
	iters: 500, epoch: 5 | loss: 0.1830941
	speed: 0.0179s/iter; left time: 154.2080s
Epoch: 5 cost time: 10.494425296783447
Epoch: 5, Steps: 570 | Train Loss: 0.1130894 Vali Loss: 0.0310882 Test Loss: 0.1083391
Validation loss decreased (0.032288 --> 0.031088).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0844975
	speed: 0.0543s/iter; left time: 459.2909s
	iters: 200, epoch: 6 | loss: 0.1541230
	speed: 0.0178s/iter; left time: 148.9605s
	iters: 300, epoch: 6 | loss: 0.1809257
	speed: 0.0178s/iter; left time: 147.1821s
	iters: 400, epoch: 6 | loss: 0.1056630
	speed: 0.0178s/iter; left time: 145.3150s
	iters: 500, epoch: 6 | loss: 0.1120832
	speed: 0.0178s/iter; left time: 143.5391s
Epoch: 6 cost time: 10.466629028320312
Epoch: 6, Steps: 570 | Train Loss: 0.1054794 Vali Loss: 0.0316300 Test Loss: 0.1110024
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1297472
	speed: 0.0534s/iter; left time: 421.1841s
	iters: 200, epoch: 7 | loss: 0.0729506
	speed: 0.0178s/iter; left time: 138.6615s
	iters: 300, epoch: 7 | loss: 0.0859126
	speed: 0.0178s/iter; left time: 136.8938s
	iters: 400, epoch: 7 | loss: 0.1450983
	speed: 0.0178s/iter; left time: 135.0182s
	iters: 500, epoch: 7 | loss: 0.1048043
	speed: 0.0178s/iter; left time: 133.3204s
Epoch: 7 cost time: 10.524810314178467
Epoch: 7, Steps: 570 | Train Loss: 0.1007759 Vali Loss: 0.0312986 Test Loss: 0.1129059
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0661183
	speed: 0.0527s/iter; left time: 385.4470s
	iters: 200, epoch: 8 | loss: 0.1208306
	speed: 0.0177s/iter; left time: 127.7458s
	iters: 300, epoch: 8 | loss: 0.1295111
	speed: 0.0177s/iter; left time: 125.8714s
	iters: 400, epoch: 8 | loss: 0.1218325
	speed: 0.0177s/iter; left time: 124.1078s
	iters: 500, epoch: 8 | loss: 0.0938844
	speed: 0.0177s/iter; left time: 122.3615s
Epoch: 8 cost time: 10.410391807556152
Epoch: 8, Steps: 570 | Train Loss: 0.0988091 Vali Loss: 0.0304688 Test Loss: 0.1100706
Validation loss decreased (0.031088 --> 0.030469).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0770727
	speed: 0.0504s/iter; left time: 339.9985s
	iters: 200, epoch: 9 | loss: 0.1030489
	speed: 0.0162s/iter; left time: 107.4397s
	iters: 300, epoch: 9 | loss: 0.0669518
	speed: 0.0162s/iter; left time: 105.8146s
	iters: 400, epoch: 9 | loss: 0.0792024
	speed: 0.0162s/iter; left time: 104.1998s
	iters: 500, epoch: 9 | loss: 0.0523388
	speed: 0.0162s/iter; left time: 102.5572s
Epoch: 9 cost time: 9.517682790756226
Epoch: 9, Steps: 570 | Train Loss: 0.0974749 Vali Loss: 0.0309495 Test Loss: 0.1120338
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0932671
	speed: 0.0478s/iter; left time: 295.2692s
	iters: 200, epoch: 10 | loss: 0.1076645
	speed: 0.0162s/iter; left time: 98.4304s
	iters: 300, epoch: 10 | loss: 0.0739734
	speed: 0.0162s/iter; left time: 96.7172s
	iters: 400, epoch: 10 | loss: 0.1254484
	speed: 0.0162s/iter; left time: 95.0359s
	iters: 500, epoch: 10 | loss: 0.0739136
	speed: 0.0162s/iter; left time: 93.4609s
Epoch: 10 cost time: 9.517913818359375
Epoch: 10, Steps: 570 | Train Loss: 0.0967480 Vali Loss: 0.0307852 Test Loss: 0.1117369
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0700477
	speed: 0.0510s/iter; left time: 285.6457s
	iters: 200, epoch: 11 | loss: 0.0871683
	speed: 0.0162s/iter; left time: 89.0864s
	iters: 300, epoch: 11 | loss: 0.0579898
	speed: 0.0162s/iter; left time: 87.3248s
	iters: 400, epoch: 11 | loss: 0.1018323
	speed: 0.0162s/iter; left time: 85.6623s
	iters: 500, epoch: 11 | loss: 0.0862832
	speed: 0.0162s/iter; left time: 84.2797s
Epoch: 11 cost time: 9.543020963668823
Epoch: 11, Steps: 570 | Train Loss: 0.0967048 Vali Loss: 0.0309875 Test Loss: 0.1118358
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1101846769452095, mae:0.198857843875885
>>> S LR=5e-4 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2483433
	speed: 0.0269s/iter; left time: 304.5469s
	iters: 200, epoch: 1 | loss: 0.2648780
	speed: 0.0153s/iter; left time: 171.4888s
	iters: 300, epoch: 1 | loss: 0.1771782
	speed: 0.0153s/iter; left time: 169.6144s
	iters: 400, epoch: 1 | loss: 0.2291293
	speed: 0.0158s/iter; left time: 173.7331s
	iters: 500, epoch: 1 | loss: 0.3629789
	speed: 0.0169s/iter; left time: 184.5304s
Epoch: 1 cost time: 10.16287612915039
Epoch: 1, Steps: 570 | Train Loss: 0.2355905 Vali Loss: 0.0478064 Test Loss: 0.1604989
Validation loss decreased (inf --> 0.047806).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3348750
	speed: 0.0485s/iter; left time: 520.3453s
	iters: 200, epoch: 2 | loss: 0.1311348
	speed: 0.0153s/iter; left time: 162.9823s
	iters: 300, epoch: 2 | loss: 0.2290981
	speed: 0.0154s/iter; left time: 161.9133s
	iters: 400, epoch: 2 | loss: 0.1898337
	speed: 0.0154s/iter; left time: 160.2007s
	iters: 500, epoch: 2 | loss: 0.2987490
	speed: 0.0153s/iter; left time: 158.5343s
Epoch: 2 cost time: 9.040455102920532
Epoch: 2, Steps: 570 | Train Loss: 0.2074687 Vali Loss: 0.0471092 Test Loss: 0.1691509
Validation loss decreased (0.047806 --> 0.047109).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2229756
	speed: 0.0493s/iter; left time: 500.5706s
	iters: 200, epoch: 3 | loss: 0.1254925
	speed: 0.0153s/iter; left time: 154.1155s
	iters: 300, epoch: 3 | loss: 0.1976906
	speed: 0.0154s/iter; left time: 153.0306s
	iters: 400, epoch: 3 | loss: 0.1677979
	speed: 0.0153s/iter; left time: 151.1529s
	iters: 500, epoch: 3 | loss: 0.1631311
	speed: 0.0153s/iter; left time: 149.6941s
Epoch: 3 cost time: 9.012163162231445
Epoch: 3, Steps: 570 | Train Loss: 0.1777133 Vali Loss: 0.0385367 Test Loss: 0.1366742
Validation loss decreased (0.047109 --> 0.038537).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1122107
	speed: 0.0473s/iter; left time: 453.9567s
	iters: 200, epoch: 4 | loss: 0.1657184
	speed: 0.0154s/iter; left time: 146.6029s
	iters: 300, epoch: 4 | loss: 0.1673519
	speed: 0.0155s/iter; left time: 145.1893s
	iters: 400, epoch: 4 | loss: 0.1483444
	speed: 0.0155s/iter; left time: 143.6263s
	iters: 500, epoch: 4 | loss: 0.1827132
	speed: 0.0154s/iter; left time: 141.8465s
Epoch: 4 cost time: 9.076525211334229
Epoch: 4, Steps: 570 | Train Loss: 0.1572371 Vali Loss: 0.0404997 Test Loss: 0.1324938
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1409792
	speed: 0.0463s/iter; left time: 417.2829s
	iters: 200, epoch: 5 | loss: 0.1015729
	speed: 0.0153s/iter; left time: 136.5473s
	iters: 300, epoch: 5 | loss: 0.1218456
	speed: 0.0153s/iter; left time: 135.1001s
	iters: 400, epoch: 5 | loss: 0.1069800
	speed: 0.0153s/iter; left time: 133.3283s
	iters: 500, epoch: 5 | loss: 0.1370048
	speed: 0.0153s/iter; left time: 131.9090s
Epoch: 5 cost time: 8.985633611679077
Epoch: 5, Steps: 570 | Train Loss: 0.1393712 Vali Loss: 0.0405756 Test Loss: 0.1375911
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1024099
	speed: 0.0482s/iter; left time: 407.5383s
	iters: 200, epoch: 6 | loss: 0.0863356
	speed: 0.0154s/iter; left time: 128.3295s
	iters: 300, epoch: 6 | loss: 0.0676037
	speed: 0.0154s/iter; left time: 126.7220s
	iters: 400, epoch: 6 | loss: 0.0898383
	speed: 0.0153s/iter; left time: 125.0576s
	iters: 500, epoch: 6 | loss: 0.0797176
	speed: 0.0153s/iter; left time: 123.5405s
Epoch: 6 cost time: 9.041666507720947
Epoch: 6, Steps: 570 | Train Loss: 0.1263908 Vali Loss: 0.0410626 Test Loss: 0.1405951
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13680148124694824, mae:0.2306452989578247
>>> S LR=5e-4 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1675209
	speed: 0.0303s/iter; left time: 342.0285s
	iters: 200, epoch: 1 | loss: 0.2620047
	speed: 0.0190s/iter; left time: 213.2897s
	iters: 300, epoch: 1 | loss: 0.3315094
	speed: 0.0215s/iter; left time: 238.2949s
	iters: 400, epoch: 1 | loss: 0.2227643
	speed: 0.0215s/iter; left time: 236.3974s
	iters: 500, epoch: 1 | loss: 0.1786556
	speed: 0.0215s/iter; left time: 233.9281s
Epoch: 1 cost time: 12.929308891296387
Epoch: 1, Steps: 570 | Train Loss: 0.2152988 Vali Loss: 0.0430830 Test Loss: 0.1306666
Validation loss decreased (inf --> 0.043083).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3509399
	speed: 0.0593s/iter; left time: 636.7472s
	iters: 200, epoch: 2 | loss: 0.1578238
	speed: 0.0187s/iter; left time: 199.3020s
	iters: 300, epoch: 2 | loss: 0.1870328
	speed: 0.0187s/iter; left time: 196.4564s
	iters: 400, epoch: 2 | loss: 0.1821813
	speed: 0.0186s/iter; left time: 194.3391s
	iters: 500, epoch: 2 | loss: 0.1409564
	speed: 0.0203s/iter; left time: 209.6831s
Epoch: 2 cost time: 11.374444007873535
Epoch: 2, Steps: 570 | Train Loss: 0.1853795 Vali Loss: 0.0473167 Test Loss: 0.1485672
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1514470
	speed: 0.0581s/iter; left time: 590.1980s
	iters: 200, epoch: 3 | loss: 0.1493786
	speed: 0.0187s/iter; left time: 188.5267s
	iters: 300, epoch: 3 | loss: 0.1454844
	speed: 0.0187s/iter; left time: 186.6477s
	iters: 400, epoch: 3 | loss: 0.1098265
	speed: 0.0188s/iter; left time: 185.5192s
	iters: 500, epoch: 3 | loss: 0.1106420
	speed: 0.0188s/iter; left time: 183.5108s
Epoch: 3 cost time: 10.968734741210938
Epoch: 3, Steps: 570 | Train Loss: 0.1588139 Vali Loss: 0.0401578 Test Loss: 0.1393292
Validation loss decreased (0.043083 --> 0.040158).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1721628
	speed: 0.0602s/iter; left time: 577.6773s
	iters: 200, epoch: 4 | loss: 0.1806513
	speed: 0.0215s/iter; left time: 203.6840s
	iters: 300, epoch: 4 | loss: 0.1429353
	speed: 0.0215s/iter; left time: 201.5384s
	iters: 400, epoch: 4 | loss: 0.0779158
	speed: 0.0215s/iter; left time: 199.3563s
	iters: 500, epoch: 4 | loss: 0.1386444
	speed: 0.0214s/iter; left time: 196.7579s
Epoch: 4 cost time: 12.457093715667725
Epoch: 4, Steps: 570 | Train Loss: 0.1347456 Vali Loss: 0.0426129 Test Loss: 0.1442299
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1202521
	speed: 0.0608s/iter; left time: 548.2409s
	iters: 200, epoch: 5 | loss: 0.1335126
	speed: 0.0214s/iter; left time: 191.0674s
	iters: 300, epoch: 5 | loss: 0.1137618
	speed: 0.0214s/iter; left time: 189.1728s
	iters: 400, epoch: 5 | loss: 0.1122454
	speed: 0.0215s/iter; left time: 187.3457s
	iters: 500, epoch: 5 | loss: 0.0950618
	speed: 0.0215s/iter; left time: 185.3855s
Epoch: 5 cost time: 12.50871753692627
Epoch: 5, Steps: 570 | Train Loss: 0.1201330 Vali Loss: 0.0396943 Test Loss: 0.1378305
Validation loss decreased (0.040158 --> 0.039694).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0749266
	speed: 0.0606s/iter; left time: 511.8669s
	iters: 200, epoch: 6 | loss: 0.1103422
	speed: 0.0188s/iter; left time: 156.9380s
	iters: 300, epoch: 6 | loss: 0.0821784
	speed: 0.0187s/iter; left time: 154.2917s
	iters: 400, epoch: 6 | loss: 0.1579541
	speed: 0.0187s/iter; left time: 152.3489s
	iters: 500, epoch: 6 | loss: 0.1103910
	speed: 0.0187s/iter; left time: 150.4046s
Epoch: 6 cost time: 11.039141654968262
Epoch: 6, Steps: 570 | Train Loss: 0.1122440 Vali Loss: 0.0408143 Test Loss: 0.1370138
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0820196
	speed: 0.0612s/iter; left time: 481.9904s
	iters: 200, epoch: 7 | loss: 0.0956975
	speed: 0.0209s/iter; left time: 162.7678s
	iters: 300, epoch: 7 | loss: 0.1084881
	speed: 0.0209s/iter; left time: 160.5682s
	iters: 400, epoch: 7 | loss: 0.1058067
	speed: 0.0209s/iter; left time: 158.3961s
	iters: 500, epoch: 7 | loss: 0.1582561
	speed: 0.0209s/iter; left time: 156.1310s
Epoch: 7 cost time: 12.171567440032959
Epoch: 7, Steps: 570 | Train Loss: 0.1074220 Vali Loss: 0.0400079 Test Loss: 0.1359702
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0917773
	speed: 0.0572s/iter; left time: 418.3602s
	iters: 200, epoch: 8 | loss: 0.0828132
	speed: 0.0187s/iter; left time: 135.0102s
	iters: 300, epoch: 8 | loss: 0.0864208
	speed: 0.0187s/iter; left time: 133.0850s
	iters: 400, epoch: 8 | loss: 0.1191086
	speed: 0.0187s/iter; left time: 131.2976s
	iters: 500, epoch: 8 | loss: 0.0843644
	speed: 0.0187s/iter; left time: 129.4572s
Epoch: 8 cost time: 10.93548321723938
Epoch: 8, Steps: 570 | Train Loss: 0.1056123 Vali Loss: 0.0413067 Test Loss: 0.1386227
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13793238997459412, mae:0.2311420738697052
>>> S LR=5e-4 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3462482
	speed: 0.0320s/iter; left time: 361.3969s
	iters: 200, epoch: 1 | loss: 0.1912570
	speed: 0.0203s/iter; left time: 227.6129s
	iters: 300, epoch: 1 | loss: 0.1756127
	speed: 0.0203s/iter; left time: 225.4575s
	iters: 400, epoch: 1 | loss: 0.1579767
	speed: 0.0191s/iter; left time: 209.8263s
	iters: 500, epoch: 1 | loss: 0.2038754
	speed: 0.0182s/iter; left time: 197.9789s
Epoch: 1 cost time: 12.311935901641846
Epoch: 1, Steps: 570 | Train Loss: 0.1840653 Vali Loss: 0.0389877 Test Loss: 0.1377790
Validation loss decreased (inf --> 0.038988).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1118012
	speed: 0.0555s/iter; left time: 596.1013s
	iters: 200, epoch: 2 | loss: 0.2143731
	speed: 0.0183s/iter; left time: 194.2119s
	iters: 300, epoch: 2 | loss: 0.2169071
	speed: 0.0183s/iter; left time: 192.4399s
	iters: 400, epoch: 2 | loss: 0.1767559
	speed: 0.0182s/iter; left time: 190.1263s
	iters: 500, epoch: 2 | loss: 0.1403488
	speed: 0.0182s/iter; left time: 188.2874s
Epoch: 2 cost time: 10.667886972427368
Epoch: 2, Steps: 570 | Train Loss: 0.1600284 Vali Loss: 0.0356500 Test Loss: 0.1160748
Validation loss decreased (0.038988 --> 0.035650).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0901039
	speed: 0.0574s/iter; left time: 583.2724s
	iters: 200, epoch: 3 | loss: 0.1355653
	speed: 0.0182s/iter; left time: 182.6940s
	iters: 300, epoch: 3 | loss: 0.1251538
	speed: 0.0181s/iter; left time: 180.4160s
	iters: 400, epoch: 3 | loss: 0.0916891
	speed: 0.0181s/iter; left time: 178.2244s
	iters: 500, epoch: 3 | loss: 0.1169344
	speed: 0.0181s/iter; left time: 176.8657s
Epoch: 3 cost time: 10.625777959823608
Epoch: 3, Steps: 570 | Train Loss: 0.1341106 Vali Loss: 0.0336226 Test Loss: 0.1137346
Validation loss decreased (0.035650 --> 0.033623).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1292176
	speed: 0.0575s/iter; left time: 551.1262s
	iters: 200, epoch: 4 | loss: 0.0712454
	speed: 0.0181s/iter; left time: 171.4409s
	iters: 300, epoch: 4 | loss: 0.1598749
	speed: 0.0181s/iter; left time: 169.5663s
	iters: 400, epoch: 4 | loss: 0.1232243
	speed: 0.0180s/iter; left time: 167.5131s
	iters: 500, epoch: 4 | loss: 0.0820035
	speed: 0.0180s/iter; left time: 165.8499s
Epoch: 4 cost time: 10.576001644134521
Epoch: 4, Steps: 570 | Train Loss: 0.1181220 Vali Loss: 0.0312336 Test Loss: 0.1162637
Validation loss decreased (0.033623 --> 0.031234).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1056690
	speed: 0.0552s/iter; left time: 497.7600s
	iters: 200, epoch: 5 | loss: 0.0937028
	speed: 0.0201s/iter; left time: 179.2527s
	iters: 300, epoch: 5 | loss: 0.1213046
	speed: 0.0181s/iter; left time: 159.6320s
	iters: 400, epoch: 5 | loss: 0.1096511
	speed: 0.0181s/iter; left time: 157.9272s
	iters: 500, epoch: 5 | loss: 0.0995260
	speed: 0.0181s/iter; left time: 155.7502s
Epoch: 5 cost time: 10.792063474655151
Epoch: 5, Steps: 570 | Train Loss: 0.1059548 Vali Loss: 0.0318150 Test Loss: 0.1128606
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1321034
	speed: 0.0535s/iter; left time: 452.2073s
	iters: 200, epoch: 6 | loss: 0.0765181
	speed: 0.0182s/iter; left time: 152.1363s
	iters: 300, epoch: 6 | loss: 0.1142906
	speed: 0.0182s/iter; left time: 150.0737s
	iters: 400, epoch: 6 | loss: 0.0872029
	speed: 0.0182s/iter; left time: 148.1278s
	iters: 500, epoch: 6 | loss: 0.0705543
	speed: 0.0182s/iter; left time: 146.4243s
Epoch: 6 cost time: 10.620312213897705
Epoch: 6, Steps: 570 | Train Loss: 0.0992650 Vali Loss: 0.0318303 Test Loss: 0.1167320
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0783959
	speed: 0.0569s/iter; left time: 448.5581s
	iters: 200, epoch: 7 | loss: 0.1261974
	speed: 0.0204s/iter; left time: 158.9158s
	iters: 300, epoch: 7 | loss: 0.0734378
	speed: 0.0204s/iter; left time: 157.0535s
	iters: 400, epoch: 7 | loss: 0.1032670
	speed: 0.0192s/iter; left time: 145.8977s
	iters: 500, epoch: 7 | loss: 0.0861842
	speed: 0.0181s/iter; left time: 135.3092s
Epoch: 7 cost time: 11.455136775970459
Epoch: 7, Steps: 570 | Train Loss: 0.0955693 Vali Loss: 0.0320018 Test Loss: 0.1151609
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11640167236328125, mae:0.20588696002960205
>>> S LR=5e-4 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2069419
	speed: 0.0297s/iter; left time: 335.5346s
	iters: 200, epoch: 1 | loss: 0.1942106
	speed: 0.0182s/iter; left time: 203.9620s
	iters: 300, epoch: 1 | loss: 0.2684709
	speed: 0.0182s/iter; left time: 202.0206s
	iters: 400, epoch: 1 | loss: 0.2155261
	speed: 0.0182s/iter; left time: 200.6736s
	iters: 500, epoch: 1 | loss: 0.2690478
	speed: 0.0183s/iter; left time: 198.9906s
Epoch: 1 cost time: 11.586199760437012
Epoch: 1, Steps: 570 | Train Loss: 0.2220366 Vali Loss: 0.0438233 Test Loss: 0.1435323
Validation loss decreased (inf --> 0.043823).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2744497
	speed: 0.0585s/iter; left time: 627.2363s
	iters: 200, epoch: 2 | loss: 0.2146311
	speed: 0.0182s/iter; left time: 193.9023s
	iters: 300, epoch: 2 | loss: 0.4148842
	speed: 0.0182s/iter; left time: 191.9357s
	iters: 400, epoch: 2 | loss: 0.1860997
	speed: 0.0182s/iter; left time: 189.9591s
	iters: 500, epoch: 2 | loss: 0.1035785
	speed: 0.0182s/iter; left time: 188.1579s
Epoch: 2 cost time: 10.676488161087036
Epoch: 2, Steps: 570 | Train Loss: 0.1937647 Vali Loss: 0.0465461 Test Loss: 0.1481945
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1296600
	speed: 0.0553s/iter; left time: 561.8831s
	iters: 200, epoch: 3 | loss: 0.1800809
	speed: 0.0181s/iter; left time: 182.4041s
	iters: 300, epoch: 3 | loss: 0.1562673
	speed: 0.0181s/iter; left time: 180.5383s
	iters: 400, epoch: 3 | loss: 0.1607830
	speed: 0.0181s/iter; left time: 178.7474s
	iters: 500, epoch: 3 | loss: 0.1555310
	speed: 0.0182s/iter; left time: 177.8213s
Epoch: 3 cost time: 10.58635425567627
Epoch: 3, Steps: 570 | Train Loss: 0.1560771 Vali Loss: 0.0431563 Test Loss: 0.1474796
Validation loss decreased (0.043823 --> 0.043156).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1283108
	speed: 0.0546s/iter; left time: 523.3099s
	iters: 200, epoch: 4 | loss: 0.1499434
	speed: 0.0182s/iter; left time: 172.7645s
	iters: 300, epoch: 4 | loss: 0.1223451
	speed: 0.0182s/iter; left time: 170.9379s
	iters: 400, epoch: 4 | loss: 0.1409424
	speed: 0.0182s/iter; left time: 169.0616s
	iters: 500, epoch: 4 | loss: 0.1096294
	speed: 0.0182s/iter; left time: 167.3599s
Epoch: 4 cost time: 10.638170957565308
Epoch: 4, Steps: 570 | Train Loss: 0.1313714 Vali Loss: 0.0414571 Test Loss: 0.1545822
Validation loss decreased (0.043156 --> 0.041457).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1246149
	speed: 0.0567s/iter; left time: 511.6273s
	iters: 200, epoch: 5 | loss: 0.1341970
	speed: 0.0183s/iter; left time: 162.9485s
	iters: 300, epoch: 5 | loss: 0.0881418
	speed: 0.0183s/iter; left time: 161.5393s
	iters: 400, epoch: 5 | loss: 0.0922191
	speed: 0.0183s/iter; left time: 159.9685s
	iters: 500, epoch: 5 | loss: 0.0708048
	speed: 0.0183s/iter; left time: 157.7310s
Epoch: 5 cost time: 10.69264030456543
Epoch: 5, Steps: 570 | Train Loss: 0.1113781 Vali Loss: 0.0410068 Test Loss: 0.1471444
Validation loss decreased (0.041457 --> 0.041007).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1342434
	speed: 0.0579s/iter; left time: 488.9729s
	iters: 200, epoch: 6 | loss: 0.0733894
	speed: 0.0182s/iter; left time: 151.6702s
	iters: 300, epoch: 6 | loss: 0.1285511
	speed: 0.0181s/iter; left time: 149.5800s
	iters: 400, epoch: 6 | loss: 0.0783738
	speed: 0.0181s/iter; left time: 147.6336s
	iters: 500, epoch: 6 | loss: 0.1057454
	speed: 0.0181s/iter; left time: 145.7067s
Epoch: 6 cost time: 10.599088907241821
Epoch: 6, Steps: 570 | Train Loss: 0.1033557 Vali Loss: 0.0412113 Test Loss: 0.1571573
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0912182
	speed: 0.0542s/iter; left time: 426.7854s
	iters: 200, epoch: 7 | loss: 0.1015646
	speed: 0.0184s/iter; left time: 142.8536s
	iters: 300, epoch: 7 | loss: 0.1110162
	speed: 0.0183s/iter; left time: 140.5681s
	iters: 400, epoch: 7 | loss: 0.1120684
	speed: 0.0183s/iter; left time: 139.0203s
	iters: 500, epoch: 7 | loss: 0.0596836
	speed: 0.0183s/iter; left time: 137.0946s
Epoch: 7 cost time: 10.682490825653076
Epoch: 7, Steps: 570 | Train Loss: 0.1001939 Vali Loss: 0.0414535 Test Loss: 0.1537903
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0783855
	speed: 0.0540s/iter; left time: 394.6823s
	iters: 200, epoch: 8 | loss: 0.0799933
	speed: 0.0182s/iter; left time: 130.9216s
	iters: 300, epoch: 8 | loss: 0.1225767
	speed: 0.0182s/iter; left time: 129.0742s
	iters: 400, epoch: 8 | loss: 0.1292043
	speed: 0.0182s/iter; left time: 127.2731s
	iters: 500, epoch: 8 | loss: 0.0884138
	speed: 0.0181s/iter; left time: 125.4197s
Epoch: 8 cost time: 10.584512710571289
Epoch: 8, Steps: 570 | Train Loss: 0.0969493 Vali Loss: 0.0415353 Test Loss: 0.1527486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14728374779224396, mae:0.24090616405010223
>>> S LR=5e-4 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2131819
	speed: 0.0338s/iter; left time: 381.6857s
	iters: 200, epoch: 1 | loss: 0.1877267
	speed: 0.0219s/iter; left time: 245.4426s
	iters: 300, epoch: 1 | loss: 0.1946100
	speed: 0.0219s/iter; left time: 243.1599s
	iters: 400, epoch: 1 | loss: 0.2827897
	speed: 0.0218s/iter; left time: 240.1544s
	iters: 500, epoch: 1 | loss: 0.1645516
	speed: 0.0218s/iter; left time: 237.4882s
Epoch: 1 cost time: 13.698104858398438
Epoch: 1, Steps: 570 | Train Loss: 0.2366947 Vali Loss: 0.0458160 Test Loss: 0.1507226
Validation loss decreased (inf --> 0.045816).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3330984
	speed: 0.0629s/iter; left time: 674.4554s
	iters: 200, epoch: 2 | loss: 0.2924358
	speed: 0.0218s/iter; left time: 231.8669s
	iters: 300, epoch: 2 | loss: 0.2401949
	speed: 0.0218s/iter; left time: 229.6599s
	iters: 400, epoch: 2 | loss: 0.3423917
	speed: 0.0218s/iter; left time: 227.3192s
	iters: 500, epoch: 2 | loss: 0.2399209
	speed: 0.0218s/iter; left time: 225.0689s
Epoch: 2 cost time: 12.705487966537476
Epoch: 2, Steps: 570 | Train Loss: 0.2869645 Vali Loss: 0.0622536 Test Loss: 0.1915965
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.5152041
	speed: 0.0606s/iter; left time: 615.8476s
	iters: 200, epoch: 3 | loss: 0.1965823
	speed: 0.0219s/iter; left time: 219.9790s
	iters: 300, epoch: 3 | loss: 0.3522572
	speed: 0.0219s/iter; left time: 218.1997s
	iters: 400, epoch: 3 | loss: 0.2208698
	speed: 0.0219s/iter; left time: 216.1478s
	iters: 500, epoch: 3 | loss: 0.1962783
	speed: 0.0219s/iter; left time: 213.8417s
Epoch: 3 cost time: 12.753589868545532
Epoch: 3, Steps: 570 | Train Loss: 0.2724726 Vali Loss: 0.0573214 Test Loss: 0.1808589
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2181799
	speed: 0.0623s/iter; left time: 597.7701s
	iters: 200, epoch: 4 | loss: 0.1772114
	speed: 0.0219s/iter; left time: 208.0379s
	iters: 300, epoch: 4 | loss: 0.2247282
	speed: 0.0219s/iter; left time: 205.8476s
	iters: 400, epoch: 4 | loss: 0.1803130
	speed: 0.0219s/iter; left time: 203.6804s
	iters: 500, epoch: 4 | loss: 0.3372403
	speed: 0.0219s/iter; left time: 201.2198s
Epoch: 4 cost time: 12.738224506378174
Epoch: 4, Steps: 570 | Train Loss: 0.2544376 Vali Loss: 0.0554671 Test Loss: 0.1763256
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1508142352104187, mae:0.2442696988582611
>>> S LR=5e-4 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2078916
	speed: 0.0333s/iter; left time: 375.9212s
	iters: 200, epoch: 1 | loss: 0.1116027
	speed: 0.0211s/iter; left time: 236.8877s
	iters: 300, epoch: 1 | loss: 0.1859276
	speed: 0.0212s/iter; left time: 234.9805s
	iters: 400, epoch: 1 | loss: 0.1692373
	speed: 0.0212s/iter; left time: 233.0013s
	iters: 500, epoch: 1 | loss: 0.1749654
	speed: 0.0211s/iter; left time: 230.4168s
Epoch: 1 cost time: 13.329948902130127
Epoch: 1, Steps: 570 | Train Loss: 0.2046522 Vali Loss: 0.0401534 Test Loss: 0.1363922
Validation loss decreased (inf --> 0.040153).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2628138
	speed: 0.0615s/iter; left time: 659.5445s
	iters: 200, epoch: 2 | loss: 0.1330242
	speed: 0.0210s/iter; left time: 223.5735s
	iters: 300, epoch: 2 | loss: 0.1529420
	speed: 0.0210s/iter; left time: 221.1459s
	iters: 400, epoch: 2 | loss: 0.1489504
	speed: 0.0210s/iter; left time: 218.7620s
	iters: 500, epoch: 2 | loss: 0.1226668
	speed: 0.0210s/iter; left time: 216.6872s
Epoch: 2 cost time: 12.260373830795288
Epoch: 2, Steps: 570 | Train Loss: 0.1859408 Vali Loss: 0.0502453 Test Loss: 0.1578278
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1992106
	speed: 0.0596s/iter; left time: 605.8497s
	iters: 200, epoch: 3 | loss: 0.1448457
	speed: 0.0211s/iter; left time: 212.3933s
	iters: 300, epoch: 3 | loss: 0.1921851
	speed: 0.0211s/iter; left time: 210.1958s
	iters: 400, epoch: 3 | loss: 0.1147967
	speed: 0.0211s/iter; left time: 208.0989s
	iters: 500, epoch: 3 | loss: 0.1393606
	speed: 0.0211s/iter; left time: 205.9378s
Epoch: 3 cost time: 12.292604684829712
Epoch: 3, Steps: 570 | Train Loss: 0.1839353 Vali Loss: 0.0360028 Test Loss: 0.1288210
Validation loss decreased (0.040153 --> 0.036003).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1352662
	speed: 0.0622s/iter; left time: 596.0822s
	iters: 200, epoch: 4 | loss: 0.1787923
	speed: 0.0212s/iter; left time: 201.0972s
	iters: 300, epoch: 4 | loss: 0.1744749
	speed: 0.0211s/iter; left time: 198.1385s
	iters: 400, epoch: 4 | loss: 0.1862392
	speed: 0.0211s/iter; left time: 195.9015s
	iters: 500, epoch: 4 | loss: 0.1531296
	speed: 0.0211s/iter; left time: 193.9611s
Epoch: 4 cost time: 12.34802794456482
Epoch: 4, Steps: 570 | Train Loss: 0.1513177 Vali Loss: 0.0354071 Test Loss: 0.1232372
Validation loss decreased (0.036003 --> 0.035407).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1816287
	speed: 0.0613s/iter; left time: 553.3655s
	iters: 200, epoch: 5 | loss: 0.1078957
	speed: 0.0211s/iter; left time: 188.2634s
	iters: 300, epoch: 5 | loss: 0.1515890
	speed: 0.0211s/iter; left time: 186.2795s
	iters: 400, epoch: 5 | loss: 0.1621780
	speed: 0.0211s/iter; left time: 183.9242s
	iters: 500, epoch: 5 | loss: 0.1335089
	speed: 0.0211s/iter; left time: 182.1251s
Epoch: 5 cost time: 12.377700328826904
Epoch: 5, Steps: 570 | Train Loss: 0.1427868 Vali Loss: 0.0332421 Test Loss: 0.1159570
Validation loss decreased (0.035407 --> 0.033242).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1042319
	speed: 0.0614s/iter; left time: 518.9107s
	iters: 200, epoch: 6 | loss: 0.2109661
	speed: 0.0211s/iter; left time: 176.4371s
	iters: 300, epoch: 6 | loss: 0.1786157
	speed: 0.0211s/iter; left time: 174.3926s
	iters: 400, epoch: 6 | loss: 0.1040667
	speed: 0.0211s/iter; left time: 172.1931s
	iters: 500, epoch: 6 | loss: 0.1025457
	speed: 0.0211s/iter; left time: 170.0366s
Epoch: 6 cost time: 12.344638586044312
Epoch: 6, Steps: 570 | Train Loss: 0.1356015 Vali Loss: 0.0315856 Test Loss: 0.1144083
Validation loss decreased (0.033242 --> 0.031586).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1236040
	speed: 0.0603s/iter; left time: 475.4508s
	iters: 200, epoch: 7 | loss: 0.1685223
	speed: 0.0211s/iter; left time: 164.5382s
	iters: 300, epoch: 7 | loss: 0.1647037
	speed: 0.0212s/iter; left time: 162.5555s
	iters: 400, epoch: 7 | loss: 0.0988793
	speed: 0.0211s/iter; left time: 160.2750s
	iters: 500, epoch: 7 | loss: 0.1524376
	speed: 0.0212s/iter; left time: 158.2793s
Epoch: 7 cost time: 12.325986862182617
Epoch: 7, Steps: 570 | Train Loss: 0.1315626 Vali Loss: 0.0322119 Test Loss: 0.1142033
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1256425
	speed: 0.0594s/iter; left time: 434.0781s
	iters: 200, epoch: 8 | loss: 0.1156756
	speed: 0.0210s/iter; left time: 151.7731s
	iters: 300, epoch: 8 | loss: 0.1353110
	speed: 0.0210s/iter; left time: 149.4890s
	iters: 400, epoch: 8 | loss: 0.1259485
	speed: 0.0210s/iter; left time: 147.4890s
	iters: 500, epoch: 8 | loss: 0.1984643
	speed: 0.0210s/iter; left time: 145.2781s
Epoch: 8 cost time: 12.251175165176392
Epoch: 8, Steps: 570 | Train Loss: 0.1301054 Vali Loss: 0.0317520 Test Loss: 0.1130416
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1112278
	speed: 0.0595s/iter; left time: 400.9279s
	iters: 200, epoch: 9 | loss: 0.1914093
	speed: 0.0210s/iter; left time: 139.6902s
	iters: 300, epoch: 9 | loss: 0.1351411
	speed: 0.0210s/iter; left time: 137.6776s
	iters: 400, epoch: 9 | loss: 0.1064687
	speed: 0.0210s/iter; left time: 135.4797s
	iters: 500, epoch: 9 | loss: 0.0810487
	speed: 0.0210s/iter; left time: 133.2647s
Epoch: 9 cost time: 12.29023265838623
Epoch: 9, Steps: 570 | Train Loss: 0.1290353 Vali Loss: 0.0320044 Test Loss: 0.1138515
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11458788067102432, mae:0.2046235054731369
>>> S LR=5e-4 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2312493
	speed: 0.0321s/iter; left time: 362.9848s
	iters: 200, epoch: 1 | loss: 0.1708547
	speed: 0.0200s/iter; left time: 224.3786s
	iters: 300, epoch: 1 | loss: 0.2188020
	speed: 0.0200s/iter; left time: 222.4170s
	iters: 400, epoch: 1 | loss: 0.3461750
	speed: 0.0200s/iter; left time: 219.5671s
	iters: 500, epoch: 1 | loss: 0.2413774
	speed: 0.0199s/iter; left time: 216.7423s
Epoch: 1 cost time: 12.653549432754517
Epoch: 1, Steps: 570 | Train Loss: 0.2468436 Vali Loss: 0.0529678 Test Loss: 0.1658178
Validation loss decreased (inf --> 0.052968).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1426750
	speed: 0.0582s/iter; left time: 625.0286s
	iters: 200, epoch: 2 | loss: 0.3241898
	speed: 0.0199s/iter; left time: 212.0672s
	iters: 300, epoch: 2 | loss: 0.1883716
	speed: 0.0199s/iter; left time: 209.9855s
	iters: 400, epoch: 2 | loss: 0.1653078
	speed: 0.0199s/iter; left time: 207.8790s
	iters: 500, epoch: 2 | loss: 0.1865911
	speed: 0.0199s/iter; left time: 205.6910s
Epoch: 2 cost time: 11.659647226333618
Epoch: 2, Steps: 570 | Train Loss: 0.2342542 Vali Loss: 0.0597555 Test Loss: 0.1810013
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2071732
	speed: 0.0574s/iter; left time: 583.6807s
	iters: 200, epoch: 3 | loss: 0.1952509
	speed: 0.0200s/iter; left time: 201.1200s
	iters: 300, epoch: 3 | loss: 0.1872707
	speed: 0.0200s/iter; left time: 199.2925s
	iters: 400, epoch: 3 | loss: 0.2174788
	speed: 0.0200s/iter; left time: 197.3889s
	iters: 500, epoch: 3 | loss: 0.2017261
	speed: 0.0200s/iter; left time: 195.1053s
Epoch: 3 cost time: 11.686301469802856
Epoch: 3, Steps: 570 | Train Loss: 0.2450289 Vali Loss: 0.0532329 Test Loss: 0.1593853
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1344842
	speed: 0.0576s/iter; left time: 551.9661s
	iters: 200, epoch: 4 | loss: 0.1985136
	speed: 0.0200s/iter; left time: 189.7035s
	iters: 300, epoch: 4 | loss: 0.1522246
	speed: 0.0200s/iter; left time: 187.3674s
	iters: 400, epoch: 4 | loss: 0.2614835
	speed: 0.0199s/iter; left time: 185.2805s
	iters: 500, epoch: 4 | loss: 0.1736103
	speed: 0.0200s/iter; left time: 183.5364s
Epoch: 4 cost time: 11.612409114837646
Epoch: 4, Steps: 570 | Train Loss: 0.2153545 Vali Loss: 0.0487885 Test Loss: 0.1564090
Validation loss decreased (0.052968 --> 0.048789).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1757647
	speed: 0.0587s/iter; left time: 529.6628s
	iters: 200, epoch: 5 | loss: 0.2389876
	speed: 0.0201s/iter; left time: 179.2394s
	iters: 300, epoch: 5 | loss: 0.2093835
	speed: 0.0201s/iter; left time: 177.0674s
	iters: 400, epoch: 5 | loss: 0.1374424
	speed: 0.0201s/iter; left time: 175.0371s
	iters: 500, epoch: 5 | loss: 0.1688385
	speed: 0.0201s/iter; left time: 173.0789s
Epoch: 5 cost time: 11.72413182258606
Epoch: 5, Steps: 570 | Train Loss: 0.1986221 Vali Loss: 0.0473878 Test Loss: 0.1469954
Validation loss decreased (0.048789 --> 0.047388).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2244631
	speed: 0.0594s/iter; left time: 502.1134s
	iters: 200, epoch: 6 | loss: 0.2257745
	speed: 0.0200s/iter; left time: 166.7435s
	iters: 300, epoch: 6 | loss: 0.2073902
	speed: 0.0199s/iter; left time: 164.5658s
	iters: 400, epoch: 6 | loss: 0.1068889
	speed: 0.0199s/iter; left time: 162.1633s
	iters: 500, epoch: 6 | loss: 0.1897529
	speed: 0.0199s/iter; left time: 160.3213s
Epoch: 6 cost time: 11.648924350738525
Epoch: 6, Steps: 570 | Train Loss: 0.1894594 Vali Loss: 0.0481741 Test Loss: 0.1456921
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1832719
	speed: 0.0570s/iter; left time: 449.0573s
	iters: 200, epoch: 7 | loss: 0.2287389
	speed: 0.0200s/iter; left time: 155.5918s
	iters: 300, epoch: 7 | loss: 0.2215491
	speed: 0.0200s/iter; left time: 153.5393s
	iters: 400, epoch: 7 | loss: 0.2649237
	speed: 0.0200s/iter; left time: 151.5627s
	iters: 500, epoch: 7 | loss: 0.1559925
	speed: 0.0200s/iter; left time: 149.3872s
Epoch: 7 cost time: 11.662186622619629
Epoch: 7, Steps: 570 | Train Loss: 0.1861882 Vali Loss: 0.0481565 Test Loss: 0.1450867
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2446449
	speed: 0.0594s/iter; left time: 434.3500s
	iters: 200, epoch: 8 | loss: 0.2410441
	speed: 0.0210s/iter; left time: 151.6708s
	iters: 300, epoch: 8 | loss: 0.3137449
	speed: 0.0204s/iter; left time: 145.0428s
	iters: 400, epoch: 8 | loss: 0.1432238
	speed: 0.0211s/iter; left time: 148.1262s
	iters: 500, epoch: 8 | loss: 0.2058919
	speed: 0.0198s/iter; left time: 137.1496s
Epoch: 8 cost time: 12.093634843826294
Epoch: 8, Steps: 570 | Train Loss: 0.1822717 Vali Loss: 0.0474780 Test Loss: 0.1434798
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14716941118240356, mae:0.2499505877494812
>>> S LR=5e-4 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2017607
	speed: 0.0219s/iter; left time: 247.3518s
	iters: 200, epoch: 1 | loss: 0.1836180
	speed: 0.0104s/iter; left time: 116.3424s
	iters: 300, epoch: 1 | loss: 0.2026112
	speed: 0.0104s/iter; left time: 115.4538s
	iters: 400, epoch: 1 | loss: 0.2103522
	speed: 0.0104s/iter; left time: 114.2425s
	iters: 500, epoch: 1 | loss: 0.1649679
	speed: 0.0104s/iter; left time: 113.4621s
Epoch: 1 cost time: 7.118579149246216
Epoch: 1, Steps: 570 | Train Loss: 0.2412008 Vali Loss: 0.0449294 Test Loss: 0.1467137
Validation loss decreased (inf --> 0.044929).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3465974
	speed: 0.0355s/iter; left time: 381.0507s
	iters: 200, epoch: 2 | loss: 0.3055125
	speed: 0.0104s/iter; left time: 110.3149s
	iters: 300, epoch: 2 | loss: 0.1761436
	speed: 0.0104s/iter; left time: 109.5512s
	iters: 400, epoch: 2 | loss: 0.1458654
	speed: 0.0104s/iter; left time: 108.3694s
	iters: 500, epoch: 2 | loss: 0.1874896
	speed: 0.0104s/iter; left time: 107.6023s
Epoch: 2 cost time: 6.194591283798218
Epoch: 2, Steps: 570 | Train Loss: 0.2096805 Vali Loss: 0.0456245 Test Loss: 0.1414953
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1542157
	speed: 0.0371s/iter; left time: 377.1005s
	iters: 200, epoch: 3 | loss: 0.2354691
	speed: 0.0105s/iter; left time: 105.8798s
	iters: 300, epoch: 3 | loss: 0.1873395
	speed: 0.0106s/iter; left time: 105.4149s
	iters: 400, epoch: 3 | loss: 0.1841981
	speed: 0.0106s/iter; left time: 104.2656s
	iters: 500, epoch: 3 | loss: 0.2278730
	speed: 0.0106s/iter; left time: 103.0557s
Epoch: 3 cost time: 6.307206392288208
Epoch: 3, Steps: 570 | Train Loss: 0.1884666 Vali Loss: 0.0391197 Test Loss: 0.1390422
Validation loss decreased (0.044929 --> 0.039120).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1646300
	speed: 0.0371s/iter; left time: 355.4725s
	iters: 200, epoch: 4 | loss: 0.1194004
	speed: 0.0104s/iter; left time: 98.8042s
	iters: 300, epoch: 4 | loss: 0.1887076
	speed: 0.0104s/iter; left time: 97.9420s
	iters: 400, epoch: 4 | loss: 0.1955070
	speed: 0.0104s/iter; left time: 97.0703s
	iters: 500, epoch: 4 | loss: 0.1722423
	speed: 0.0104s/iter; left time: 95.6945s
Epoch: 4 cost time: 6.228312015533447
Epoch: 4, Steps: 570 | Train Loss: 0.1750482 Vali Loss: 0.0394475 Test Loss: 0.1386475
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1551412
	speed: 0.0365s/iter; left time: 328.8164s
	iters: 200, epoch: 5 | loss: 0.1604659
	speed: 0.0104s/iter; left time: 93.0216s
	iters: 300, epoch: 5 | loss: 0.1154813
	speed: 0.0105s/iter; left time: 92.1862s
	iters: 400, epoch: 5 | loss: 0.1399542
	speed: 0.0105s/iter; left time: 91.2944s
	iters: 500, epoch: 5 | loss: 0.1888895
	speed: 0.0105s/iter; left time: 90.1905s
Epoch: 5 cost time: 6.226767539978027
Epoch: 5, Steps: 570 | Train Loss: 0.1666286 Vali Loss: 0.0390404 Test Loss: 0.1457672
Validation loss decreased (0.039120 --> 0.039040).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1503581
	speed: 0.0362s/iter; left time: 305.7013s
	iters: 200, epoch: 6 | loss: 0.1181819
	speed: 0.0105s/iter; left time: 87.5132s
	iters: 300, epoch: 6 | loss: 0.1615634
	speed: 0.0105s/iter; left time: 86.5444s
	iters: 400, epoch: 6 | loss: 0.1749418
	speed: 0.0105s/iter; left time: 85.4594s
	iters: 500, epoch: 6 | loss: 0.1813075
	speed: 0.0105s/iter; left time: 84.5024s
Epoch: 6 cost time: 6.229734182357788
Epoch: 6, Steps: 570 | Train Loss: 0.1628865 Vali Loss: 0.0389545 Test Loss: 0.1464530
Validation loss decreased (0.039040 --> 0.038955).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1821861
	speed: 0.0349s/iter; left time: 274.9258s
	iters: 200, epoch: 7 | loss: 0.2353860
	speed: 0.0104s/iter; left time: 81.1748s
	iters: 300, epoch: 7 | loss: 0.1366009
	speed: 0.0104s/iter; left time: 79.9510s
	iters: 400, epoch: 7 | loss: 0.1369173
	speed: 0.0104s/iter; left time: 78.9097s
	iters: 500, epoch: 7 | loss: 0.1472462
	speed: 0.0104s/iter; left time: 77.8501s
Epoch: 7 cost time: 6.2020652294158936
Epoch: 7, Steps: 570 | Train Loss: 0.1611779 Vali Loss: 0.0390882 Test Loss: 0.1470888
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1860169
	speed: 0.0350s/iter; left time: 255.5573s
	iters: 200, epoch: 8 | loss: 0.1690687
	speed: 0.0105s/iter; left time: 75.5095s
	iters: 300, epoch: 8 | loss: 0.2084040
	speed: 0.0105s/iter; left time: 74.4293s
	iters: 400, epoch: 8 | loss: 0.2021878
	speed: 0.0105s/iter; left time: 73.3515s
	iters: 500, epoch: 8 | loss: 0.1161740
	speed: 0.0105s/iter; left time: 72.2752s
Epoch: 8 cost time: 6.2288267612457275
Epoch: 8, Steps: 570 | Train Loss: 0.1592303 Vali Loss: 0.0388687 Test Loss: 0.1418352
Validation loss decreased (0.038955 --> 0.038869).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2161995
	speed: 0.0362s/iter; left time: 244.1548s
	iters: 200, epoch: 9 | loss: 0.1691079
	speed: 0.0105s/iter; left time: 69.4252s
	iters: 300, epoch: 9 | loss: 0.0848167
	speed: 0.0105s/iter; left time: 68.3554s
	iters: 400, epoch: 9 | loss: 0.1494927
	speed: 0.0105s/iter; left time: 67.5557s
	iters: 500, epoch: 9 | loss: 0.1218381
	speed: 0.0105s/iter; left time: 66.3847s
Epoch: 9 cost time: 6.243939638137817
Epoch: 9, Steps: 570 | Train Loss: 0.1580699 Vali Loss: 0.0393985 Test Loss: 0.1401667
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1363532
	speed: 0.0352s/iter; left time: 217.3389s
	iters: 200, epoch: 10 | loss: 0.1481394
	speed: 0.0105s/iter; left time: 63.5644s
	iters: 300, epoch: 10 | loss: 0.1228802
	speed: 0.0104s/iter; left time: 62.1614s
	iters: 400, epoch: 10 | loss: 0.1322080
	speed: 0.0104s/iter; left time: 61.0030s
	iters: 500, epoch: 10 | loss: 0.2329613
	speed: 0.0104s/iter; left time: 60.0127s
Epoch: 10 cost time: 6.210039854049683
Epoch: 10, Steps: 570 | Train Loss: 0.1575640 Vali Loss: 0.0391772 Test Loss: 0.1423211
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1739578
	speed: 0.0350s/iter; left time: 195.8601s
	iters: 200, epoch: 11 | loss: 0.1385161
	speed: 0.0105s/iter; left time: 57.6741s
	iters: 300, epoch: 11 | loss: 0.1291213
	speed: 0.0105s/iter; left time: 56.7771s
	iters: 400, epoch: 11 | loss: 0.2275553
	speed: 0.0105s/iter; left time: 55.5101s
	iters: 500, epoch: 11 | loss: 0.1492632
	speed: 0.0105s/iter; left time: 54.5138s
Epoch: 11 cost time: 6.236325025558472
Epoch: 11, Steps: 570 | Train Loss: 0.1587779 Vali Loss: 0.0390351 Test Loss: 0.1420720
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14191822707653046, mae:0.2305784672498703
>>> S LR=5e-4 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2251183
	speed: 0.0231s/iter; left time: 261.2844s
	iters: 200, epoch: 1 | loss: 0.2252881
	speed: 0.0115s/iter; left time: 129.1106s
	iters: 300, epoch: 1 | loss: 0.2761937
	speed: 0.0116s/iter; left time: 129.2650s
	iters: 400, epoch: 1 | loss: 0.2024731
	speed: 0.0117s/iter; left time: 128.2984s
	iters: 500, epoch: 1 | loss: 0.1910808
	speed: 0.0117s/iter; left time: 127.2642s
Epoch: 1 cost time: 7.83579683303833
Epoch: 1, Steps: 570 | Train Loss: 0.2093643 Vali Loss: 0.0360309 Test Loss: 0.1204502
Validation loss decreased (inf --> 0.036031).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1661853
	speed: 0.0386s/iter; left time: 414.3830s
	iters: 200, epoch: 2 | loss: 0.2080358
	speed: 0.0105s/iter; left time: 111.6176s
	iters: 300, epoch: 2 | loss: 0.1527767
	speed: 0.0102s/iter; left time: 107.6686s
	iters: 400, epoch: 2 | loss: 0.1267089
	speed: 0.0102s/iter; left time: 106.8485s
	iters: 500, epoch: 2 | loss: 0.1784163
	speed: 0.0102s/iter; left time: 105.4265s
Epoch: 2 cost time: 6.384881973266602
Epoch: 2, Steps: 570 | Train Loss: 0.1846108 Vali Loss: 0.0348373 Test Loss: 0.1177200
Validation loss decreased (0.036031 --> 0.034837).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0890839
	speed: 0.0391s/iter; left time: 397.0720s
	iters: 200, epoch: 3 | loss: 0.1671831
	speed: 0.0103s/iter; left time: 103.1865s
	iters: 300, epoch: 3 | loss: 0.3066702
	speed: 0.0102s/iter; left time: 101.9245s
	iters: 400, epoch: 3 | loss: 0.2084946
	speed: 0.0102s/iter; left time: 100.6943s
	iters: 500, epoch: 3 | loss: 0.1237975
	speed: 0.0102s/iter; left time: 99.7948s
Epoch: 3 cost time: 6.263800144195557
Epoch: 3, Steps: 570 | Train Loss: 0.1673853 Vali Loss: 0.0320045 Test Loss: 0.1109305
Validation loss decreased (0.034837 --> 0.032005).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1202886
	speed: 0.0361s/iter; left time: 346.5303s
	iters: 200, epoch: 4 | loss: 0.1543994
	speed: 0.0102s/iter; left time: 97.2668s
	iters: 300, epoch: 4 | loss: 0.0955356
	speed: 0.0102s/iter; left time: 96.1965s
	iters: 400, epoch: 4 | loss: 0.1119668
	speed: 0.0102s/iter; left time: 94.7528s
	iters: 500, epoch: 4 | loss: 0.2167229
	speed: 0.0102s/iter; left time: 93.7465s
Epoch: 4 cost time: 6.100320100784302
Epoch: 4, Steps: 570 | Train Loss: 0.1575167 Vali Loss: 0.0317574 Test Loss: 0.1059350
Validation loss decreased (0.032005 --> 0.031757).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1641047
	speed: 0.0347s/iter; left time: 313.0937s
	iters: 200, epoch: 5 | loss: 0.1918411
	speed: 0.0101s/iter; left time: 90.3343s
	iters: 300, epoch: 5 | loss: 0.1482340
	speed: 0.0102s/iter; left time: 89.5725s
	iters: 400, epoch: 5 | loss: 0.1500348
	speed: 0.0102s/iter; left time: 88.8203s
	iters: 500, epoch: 5 | loss: 0.1510441
	speed: 0.0102s/iter; left time: 87.8411s
Epoch: 5 cost time: 6.042309761047363
Epoch: 5, Steps: 570 | Train Loss: 0.1528376 Vali Loss: 0.0321547 Test Loss: 0.1077377
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1119171
	speed: 0.0370s/iter; left time: 312.5077s
	iters: 200, epoch: 6 | loss: 0.1902255
	speed: 0.0103s/iter; left time: 86.3259s
	iters: 300, epoch: 6 | loss: 0.1540938
	speed: 0.0103s/iter; left time: 85.0525s
	iters: 400, epoch: 6 | loss: 0.1220758
	speed: 0.0103s/iter; left time: 83.9209s
	iters: 500, epoch: 6 | loss: 0.0965443
	speed: 0.0103s/iter; left time: 82.6390s
Epoch: 6 cost time: 6.3003246784210205
Epoch: 6, Steps: 570 | Train Loss: 0.1484212 Vali Loss: 0.0316466 Test Loss: 0.1057402
Validation loss decreased (0.031757 --> 0.031647).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1459091
	speed: 0.0368s/iter; left time: 289.8552s
	iters: 200, epoch: 7 | loss: 0.1713879
	speed: 0.0115s/iter; left time: 89.6519s
	iters: 300, epoch: 7 | loss: 0.2535047
	speed: 0.0115s/iter; left time: 88.2250s
	iters: 400, epoch: 7 | loss: 0.2022103
	speed: 0.0115s/iter; left time: 87.2785s
	iters: 500, epoch: 7 | loss: 0.1468933
	speed: 0.0115s/iter; left time: 85.7937s
Epoch: 7 cost time: 6.824631214141846
Epoch: 7, Steps: 570 | Train Loss: 0.1468901 Vali Loss: 0.0313756 Test Loss: 0.1056469
Validation loss decreased (0.031647 --> 0.031376).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1308902
	speed: 0.0383s/iter; left time: 279.8294s
	iters: 200, epoch: 8 | loss: 0.1267086
	speed: 0.0104s/iter; left time: 75.2737s
	iters: 300, epoch: 8 | loss: 0.1263479
	speed: 0.0103s/iter; left time: 73.0432s
	iters: 400, epoch: 8 | loss: 0.1356686
	speed: 0.0103s/iter; left time: 71.9556s
	iters: 500, epoch: 8 | loss: 0.0820460
	speed: 0.0103s/iter; left time: 70.9458s
Epoch: 8 cost time: 6.26861047744751
Epoch: 8, Steps: 570 | Train Loss: 0.1470851 Vali Loss: 0.0312937 Test Loss: 0.1060188
Validation loss decreased (0.031376 --> 0.031294).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1496302
	speed: 0.0344s/iter; left time: 231.9757s
	iters: 200, epoch: 9 | loss: 0.1536835
	speed: 0.0102s/iter; left time: 68.0195s
	iters: 300, epoch: 9 | loss: 0.1174659
	speed: 0.0102s/iter; left time: 66.9413s
	iters: 400, epoch: 9 | loss: 0.1865128
	speed: 0.0102s/iter; left time: 65.8880s
	iters: 500, epoch: 9 | loss: 0.1094044
	speed: 0.0102s/iter; left time: 64.8578s
Epoch: 9 cost time: 6.105635166168213
Epoch: 9, Steps: 570 | Train Loss: 0.1450351 Vali Loss: 0.0313921 Test Loss: 0.1059049
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1460610
	speed: 0.0356s/iter; left time: 219.9628s
	iters: 200, epoch: 10 | loss: 0.1042981
	speed: 0.0114s/iter; left time: 69.3613s
	iters: 300, epoch: 10 | loss: 0.1136210
	speed: 0.0108s/iter; left time: 64.3821s
	iters: 400, epoch: 10 | loss: 0.0998406
	speed: 0.0102s/iter; left time: 59.9320s
	iters: 500, epoch: 10 | loss: 0.1121350
	speed: 0.0102s/iter; left time: 58.9996s
Epoch: 10 cost time: 6.389482736587524
Epoch: 10, Steps: 570 | Train Loss: 0.1465536 Vali Loss: 0.0314579 Test Loss: 0.1057650
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1479176
	speed: 0.0352s/iter; left time: 197.3296s
	iters: 200, epoch: 11 | loss: 0.1514144
	speed: 0.0102s/iter; left time: 56.0780s
	iters: 300, epoch: 11 | loss: 0.1680801
	speed: 0.0102s/iter; left time: 54.9950s
	iters: 400, epoch: 11 | loss: 0.1565368
	speed: 0.0102s/iter; left time: 54.0551s
	iters: 500, epoch: 11 | loss: 0.1387788
	speed: 0.0102s/iter; left time: 52.9461s
Epoch: 11 cost time: 6.076903581619263
Epoch: 11, Steps: 570 | Train Loss: 0.1442946 Vali Loss: 0.0313211 Test Loss: 0.1057624
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10613004863262177, mae:0.1945204883813858
>>> S LR=5e-4 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2391938
	speed: 0.0235s/iter; left time: 265.2376s
	iters: 200, epoch: 1 | loss: 0.1575836
	speed: 0.0103s/iter; left time: 115.6117s
	iters: 300, epoch: 1 | loss: 0.1661947
	speed: 0.0109s/iter; left time: 120.5082s
	iters: 400, epoch: 1 | loss: 0.1866198
	speed: 0.0115s/iter; left time: 127.0500s
	iters: 500, epoch: 1 | loss: 0.2237581
	speed: 0.0116s/iter; left time: 126.1127s
Epoch: 1 cost time: 7.58861780166626
Epoch: 1, Steps: 570 | Train Loss: 0.2508069 Vali Loss: 0.0434419 Test Loss: 0.1382136
Validation loss decreased (inf --> 0.043442).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2128879
	speed: 0.0372s/iter; left time: 398.8997s
	iters: 200, epoch: 2 | loss: 0.2735491
	speed: 0.0102s/iter; left time: 108.6891s
	iters: 300, epoch: 2 | loss: 0.2225031
	speed: 0.0107s/iter; left time: 112.8587s
	iters: 400, epoch: 2 | loss: 0.3384840
	speed: 0.0102s/iter; left time: 106.5789s
	iters: 500, epoch: 2 | loss: 0.2763521
	speed: 0.0102s/iter; left time: 105.5994s
Epoch: 2 cost time: 6.181401014328003
Epoch: 2, Steps: 570 | Train Loss: 0.2166520 Vali Loss: 0.0414841 Test Loss: 0.1379848
Validation loss decreased (0.043442 --> 0.041484).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1330500
	speed: 0.0367s/iter; left time: 372.4164s
	iters: 200, epoch: 3 | loss: 0.1681359
	speed: 0.0103s/iter; left time: 103.1275s
	iters: 300, epoch: 3 | loss: 0.2436775
	speed: 0.0103s/iter; left time: 102.3000s
	iters: 400, epoch: 3 | loss: 0.1589659
	speed: 0.0102s/iter; left time: 100.9158s
	iters: 500, epoch: 3 | loss: 0.1238692
	speed: 0.0103s/iter; left time: 100.1002s
Epoch: 3 cost time: 6.166154861450195
Epoch: 3, Steps: 570 | Train Loss: 0.1955851 Vali Loss: 0.0401703 Test Loss: 0.1296557
Validation loss decreased (0.041484 --> 0.040170).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1258205
	speed: 0.0367s/iter; left time: 352.0714s
	iters: 200, epoch: 4 | loss: 0.1051267
	speed: 0.0102s/iter; left time: 96.7333s
	iters: 300, epoch: 4 | loss: 0.1339981
	speed: 0.0102s/iter; left time: 95.6559s
	iters: 400, epoch: 4 | loss: 0.2025648
	speed: 0.0102s/iter; left time: 95.0111s
	iters: 500, epoch: 4 | loss: 0.1517917
	speed: 0.0102s/iter; left time: 93.7432s
Epoch: 4 cost time: 6.085421085357666
Epoch: 4, Steps: 570 | Train Loss: 0.1815616 Vali Loss: 0.0394100 Test Loss: 0.1285518
Validation loss decreased (0.040170 --> 0.039410).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1674688
	speed: 0.0353s/iter; left time: 318.7137s
	iters: 200, epoch: 5 | loss: 0.1168595
	speed: 0.0103s/iter; left time: 91.8359s
	iters: 300, epoch: 5 | loss: 0.1904916
	speed: 0.0103s/iter; left time: 90.8796s
	iters: 400, epoch: 5 | loss: 0.1532636
	speed: 0.0103s/iter; left time: 89.9071s
	iters: 500, epoch: 5 | loss: 0.2363793
	speed: 0.0103s/iter; left time: 89.0313s
Epoch: 5 cost time: 6.163581371307373
Epoch: 5, Steps: 570 | Train Loss: 0.1740412 Vali Loss: 0.0388315 Test Loss: 0.1306750
Validation loss decreased (0.039410 --> 0.038831).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1438218
	speed: 0.0357s/iter; left time: 301.8207s
	iters: 200, epoch: 6 | loss: 0.1552616
	speed: 0.0103s/iter; left time: 86.1188s
	iters: 300, epoch: 6 | loss: 0.1510170
	speed: 0.0103s/iter; left time: 84.9259s
	iters: 400, epoch: 6 | loss: 0.1246028
	speed: 0.0103s/iter; left time: 83.8259s
	iters: 500, epoch: 6 | loss: 0.1846285
	speed: 0.0103s/iter; left time: 82.6970s
Epoch: 6 cost time: 6.155926942825317
Epoch: 6, Steps: 570 | Train Loss: 0.1676077 Vali Loss: 0.0381421 Test Loss: 0.1318217
Validation loss decreased (0.038831 --> 0.038142).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1115388
	speed: 0.0355s/iter; left time: 280.0877s
	iters: 200, epoch: 7 | loss: 0.1594934
	speed: 0.0103s/iter; left time: 79.9684s
	iters: 300, epoch: 7 | loss: 0.1561509
	speed: 0.0103s/iter; left time: 79.0376s
	iters: 400, epoch: 7 | loss: 0.1042508
	speed: 0.0103s/iter; left time: 77.9032s
	iters: 500, epoch: 7 | loss: 0.1948956
	speed: 0.0103s/iter; left time: 77.0559s
Epoch: 7 cost time: 6.170681715011597
Epoch: 7, Steps: 570 | Train Loss: 0.1645429 Vali Loss: 0.0385442 Test Loss: 0.1336143
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1292051
	speed: 0.0372s/iter; left time: 272.3209s
	iters: 200, epoch: 8 | loss: 0.1484030
	speed: 0.0102s/iter; left time: 73.5845s
	iters: 300, epoch: 8 | loss: 0.1937122
	speed: 0.0102s/iter; left time: 72.5979s
	iters: 400, epoch: 8 | loss: 0.1754776
	speed: 0.0102s/iter; left time: 71.6354s
	iters: 500, epoch: 8 | loss: 0.1377973
	speed: 0.0102s/iter; left time: 70.5473s
Epoch: 8 cost time: 6.069729566574097
Epoch: 8, Steps: 570 | Train Loss: 0.1636067 Vali Loss: 0.0384249 Test Loss: 0.1343274
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1343515
	speed: 0.0347s/iter; left time: 233.6266s
	iters: 200, epoch: 9 | loss: 0.1888816
	speed: 0.0103s/iter; left time: 68.1301s
	iters: 300, epoch: 9 | loss: 0.1373001
	speed: 0.0103s/iter; left time: 67.0548s
	iters: 400, epoch: 9 | loss: 0.1131243
	speed: 0.0103s/iter; left time: 66.0602s
	iters: 500, epoch: 9 | loss: 0.1646669
	speed: 0.0103s/iter; left time: 65.0441s
Epoch: 9 cost time: 6.117422103881836
Epoch: 9, Steps: 570 | Train Loss: 0.1623023 Vali Loss: 0.0384196 Test Loss: 0.1359329
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13199037313461304, mae:0.22997726500034332
>>> S LR=5e-4 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2649361
	speed: 0.0235s/iter; left time: 265.7652s
	iters: 200, epoch: 1 | loss: 0.2890199
	speed: 0.0117s/iter; left time: 130.8392s
	iters: 300, epoch: 1 | loss: 0.1531035
	speed: 0.0117s/iter; left time: 129.7992s
	iters: 400, epoch: 1 | loss: 0.1421656
	speed: 0.0117s/iter; left time: 128.5326s
	iters: 500, epoch: 1 | loss: 0.2504087
	speed: 0.0117s/iter; left time: 127.3174s
Epoch: 1 cost time: 7.890249490737915
Epoch: 1, Steps: 570 | Train Loss: 0.2559641 Vali Loss: 0.0453223 Test Loss: 0.1342090
Validation loss decreased (inf --> 0.045322).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2260128
	speed: 0.0396s/iter; left time: 425.2481s
	iters: 200, epoch: 2 | loss: 0.1923281
	speed: 0.0117s/iter; left time: 124.1109s
	iters: 300, epoch: 2 | loss: 0.1900562
	speed: 0.0117s/iter; left time: 123.0385s
	iters: 400, epoch: 2 | loss: 0.1338699
	speed: 0.0117s/iter; left time: 121.6921s
	iters: 500, epoch: 2 | loss: 0.2144652
	speed: 0.0117s/iter; left time: 120.8072s
Epoch: 2 cost time: 6.97653865814209
Epoch: 2, Steps: 570 | Train Loss: 0.2220154 Vali Loss: 0.0432848 Test Loss: 0.1329749
Validation loss decreased (0.045322 --> 0.043285).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2673127
	speed: 0.0406s/iter; left time: 412.8038s
	iters: 200, epoch: 3 | loss: 0.2692472
	speed: 0.0117s/iter; left time: 117.9167s
	iters: 300, epoch: 3 | loss: 0.1409676
	speed: 0.0117s/iter; left time: 116.9749s
	iters: 400, epoch: 3 | loss: 0.1973898
	speed: 0.0117s/iter; left time: 115.7939s
	iters: 500, epoch: 3 | loss: 0.1177761
	speed: 0.0117s/iter; left time: 114.1983s
Epoch: 3 cost time: 7.006147623062134
Epoch: 3, Steps: 570 | Train Loss: 0.2029799 Vali Loss: 0.0405349 Test Loss: 0.1319287
Validation loss decreased (0.043285 --> 0.040535).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1456724
	speed: 0.0403s/iter; left time: 386.3420s
	iters: 200, epoch: 4 | loss: 0.2270114
	speed: 0.0129s/iter; left time: 122.0002s
	iters: 300, epoch: 4 | loss: 0.1186478
	speed: 0.0128s/iter; left time: 120.2675s
	iters: 400, epoch: 4 | loss: 0.1352429
	speed: 0.0128s/iter; left time: 118.8330s
	iters: 500, epoch: 4 | loss: 0.1575855
	speed: 0.0128s/iter; left time: 117.5721s
Epoch: 4 cost time: 7.575222492218018
Epoch: 4, Steps: 570 | Train Loss: 0.1879536 Vali Loss: 0.0405752 Test Loss: 0.1322526
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1663468
	speed: 0.0375s/iter; left time: 338.6954s
	iters: 200, epoch: 5 | loss: 0.1656854
	speed: 0.0117s/iter; left time: 104.3415s
	iters: 300, epoch: 5 | loss: 0.2112736
	speed: 0.0117s/iter; left time: 102.8543s
	iters: 400, epoch: 5 | loss: 0.1732451
	speed: 0.0117s/iter; left time: 101.6126s
	iters: 500, epoch: 5 | loss: 0.1434459
	speed: 0.0116s/iter; left time: 100.3365s
Epoch: 5 cost time: 6.924751043319702
Epoch: 5, Steps: 570 | Train Loss: 0.1782721 Vali Loss: 0.0399368 Test Loss: 0.1451020
Validation loss decreased (0.040535 --> 0.039937).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1531216
	speed: 0.0398s/iter; left time: 336.6108s
	iters: 200, epoch: 6 | loss: 0.0938150
	speed: 0.0117s/iter; left time: 97.3628s
	iters: 300, epoch: 6 | loss: 0.1942136
	speed: 0.0117s/iter; left time: 96.1766s
	iters: 400, epoch: 6 | loss: 0.1868304
	speed: 0.0117s/iter; left time: 95.0648s
	iters: 500, epoch: 6 | loss: 0.1199521
	speed: 0.0117s/iter; left time: 93.8790s
Epoch: 6 cost time: 6.939236879348755
Epoch: 6, Steps: 570 | Train Loss: 0.1718603 Vali Loss: 0.0398892 Test Loss: 0.1409502
Validation loss decreased (0.039937 --> 0.039889).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1661205
	speed: 0.0388s/iter; left time: 305.4485s
	iters: 200, epoch: 7 | loss: 0.1733651
	speed: 0.0117s/iter; left time: 91.2171s
	iters: 300, epoch: 7 | loss: 0.1736974
	speed: 0.0117s/iter; left time: 90.0094s
	iters: 400, epoch: 7 | loss: 0.1246497
	speed: 0.0117s/iter; left time: 88.8109s
	iters: 500, epoch: 7 | loss: 0.1441853
	speed: 0.0117s/iter; left time: 87.6343s
Epoch: 7 cost time: 6.988981485366821
Epoch: 7, Steps: 570 | Train Loss: 0.1676361 Vali Loss: 0.0397037 Test Loss: 0.1435364
Validation loss decreased (0.039889 --> 0.039704).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1031570
	speed: 0.0391s/iter; left time: 285.6168s
	iters: 200, epoch: 8 | loss: 0.1530489
	speed: 0.0117s/iter; left time: 84.6171s
	iters: 300, epoch: 8 | loss: 0.1946381
	speed: 0.0117s/iter; left time: 83.3726s
	iters: 400, epoch: 8 | loss: 0.1447762
	speed: 0.0117s/iter; left time: 82.1883s
	iters: 500, epoch: 8 | loss: 0.1065255
	speed: 0.0117s/iter; left time: 81.0006s
Epoch: 8 cost time: 6.966038465499878
Epoch: 8, Steps: 570 | Train Loss: 0.1665865 Vali Loss: 0.0394184 Test Loss: 0.1394314
Validation loss decreased (0.039704 --> 0.039418).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1327423
	speed: 0.0396s/iter; left time: 267.1337s
	iters: 200, epoch: 9 | loss: 0.1635349
	speed: 0.0117s/iter; left time: 77.8206s
	iters: 300, epoch: 9 | loss: 0.1691509
	speed: 0.0117s/iter; left time: 76.6126s
	iters: 400, epoch: 9 | loss: 0.1200302
	speed: 0.0117s/iter; left time: 75.5662s
	iters: 500, epoch: 9 | loss: 0.1718774
	speed: 0.0117s/iter; left time: 74.3214s
Epoch: 9 cost time: 6.987612962722778
Epoch: 9, Steps: 570 | Train Loss: 0.1663436 Vali Loss: 0.0393405 Test Loss: 0.1398577
Validation loss decreased (0.039418 --> 0.039341).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1405860
	speed: 0.0387s/iter; left time: 239.1019s
	iters: 200, epoch: 10 | loss: 0.1909764
	speed: 0.0117s/iter; left time: 71.3215s
	iters: 300, epoch: 10 | loss: 0.1365251
	speed: 0.0118s/iter; left time: 70.2480s
	iters: 400, epoch: 10 | loss: 0.1344769
	speed: 0.0118s/iter; left time: 68.9983s
	iters: 500, epoch: 10 | loss: 0.1840182
	speed: 0.0117s/iter; left time: 67.6310s
Epoch: 10 cost time: 7.024059534072876
Epoch: 10, Steps: 570 | Train Loss: 0.1650735 Vali Loss: 0.0394076 Test Loss: 0.1398314
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1508713
	speed: 0.0385s/iter; left time: 215.3985s
	iters: 200, epoch: 11 | loss: 0.2822595
	speed: 0.0117s/iter; left time: 64.1159s
	iters: 300, epoch: 11 | loss: 0.1822936
	speed: 0.0117s/iter; left time: 63.0335s
	iters: 400, epoch: 11 | loss: 0.1968868
	speed: 0.0117s/iter; left time: 61.7591s
	iters: 500, epoch: 11 | loss: 0.2354988
	speed: 0.0117s/iter; left time: 60.6092s
Epoch: 11 cost time: 6.951582670211792
Epoch: 11, Steps: 570 | Train Loss: 0.1649945 Vali Loss: 0.0395102 Test Loss: 0.1389368
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1421232
	speed: 0.0385s/iter; left time: 193.4677s
	iters: 200, epoch: 12 | loss: 0.1184719
	speed: 0.0119s/iter; left time: 58.4821s
	iters: 300, epoch: 12 | loss: 0.1159620
	speed: 0.0117s/iter; left time: 56.6111s
	iters: 400, epoch: 12 | loss: 0.1372336
	speed: 0.0117s/iter; left time: 55.5266s
	iters: 500, epoch: 12 | loss: 0.1515193
	speed: 0.0117s/iter; left time: 54.3659s
Epoch: 12 cost time: 7.093783855438232
Epoch: 12, Steps: 570 | Train Loss: 0.1646609 Vali Loss: 0.0396051 Test Loss: 0.1393047
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13999342918395996, mae:0.2288934737443924
>>> S LR=5e-4 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1446858
	speed: 0.0235s/iter; left time: 265.2197s
	iters: 200, epoch: 1 | loss: 0.3191909
	speed: 0.0114s/iter; left time: 127.1684s
	iters: 300, epoch: 1 | loss: 0.1725589
	speed: 0.0113s/iter; left time: 125.6764s
	iters: 400, epoch: 1 | loss: 0.2714340
	speed: 0.0113s/iter; left time: 124.7186s
	iters: 500, epoch: 1 | loss: 0.1438768
	speed: 0.0113s/iter; left time: 123.6563s
Epoch: 1 cost time: 7.721266269683838
Epoch: 1, Steps: 570 | Train Loss: 0.2225454 Vali Loss: 0.0421592 Test Loss: 0.1278584
Validation loss decreased (inf --> 0.042159).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1598448
	speed: 0.0385s/iter; left time: 412.6440s
	iters: 200, epoch: 2 | loss: 0.1242161
	speed: 0.0114s/iter; left time: 120.7687s
	iters: 300, epoch: 2 | loss: 0.1888376
	speed: 0.0114s/iter; left time: 119.8262s
	iters: 400, epoch: 2 | loss: 0.2373174
	speed: 0.0114s/iter; left time: 118.8102s
	iters: 500, epoch: 2 | loss: 0.2428662
	speed: 0.0114s/iter; left time: 117.5370s
Epoch: 2 cost time: 6.7964372634887695
Epoch: 2, Steps: 570 | Train Loss: 0.1912757 Vali Loss: 0.0372667 Test Loss: 0.1207675
Validation loss decreased (0.042159 --> 0.037267).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1988143
	speed: 0.0376s/iter; left time: 382.3290s
	iters: 200, epoch: 3 | loss: 0.0930645
	speed: 0.0113s/iter; left time: 114.0160s
	iters: 300, epoch: 3 | loss: 0.1917846
	speed: 0.0113s/iter; left time: 112.8443s
	iters: 400, epoch: 3 | loss: 0.1646877
	speed: 0.0113s/iter; left time: 111.3881s
	iters: 500, epoch: 3 | loss: 0.1907933
	speed: 0.0113s/iter; left time: 110.5234s
Epoch: 3 cost time: 6.742539882659912
Epoch: 3, Steps: 570 | Train Loss: 0.1722749 Vali Loss: 0.0322293 Test Loss: 0.1111561
Validation loss decreased (0.037267 --> 0.032229).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1583238
	speed: 0.0399s/iter; left time: 382.2063s
	iters: 200, epoch: 4 | loss: 0.1011695
	speed: 0.0124s/iter; left time: 117.5079s
	iters: 300, epoch: 4 | loss: 0.0910573
	speed: 0.0124s/iter; left time: 116.0927s
	iters: 400, epoch: 4 | loss: 0.1524212
	speed: 0.0124s/iter; left time: 114.8935s
	iters: 500, epoch: 4 | loss: 0.1523997
	speed: 0.0124s/iter; left time: 113.7141s
Epoch: 4 cost time: 7.372398614883423
Epoch: 4, Steps: 570 | Train Loss: 0.1600677 Vali Loss: 0.0315184 Test Loss: 0.1079838
Validation loss decreased (0.032229 --> 0.031518).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1670170
	speed: 0.0407s/iter; left time: 367.4338s
	iters: 200, epoch: 5 | loss: 0.1068052
	speed: 0.0113s/iter; left time: 100.7791s
	iters: 300, epoch: 5 | loss: 0.2230545
	speed: 0.0113s/iter; left time: 99.6340s
	iters: 400, epoch: 5 | loss: 0.1528290
	speed: 0.0113s/iter; left time: 98.5154s
	iters: 500, epoch: 5 | loss: 0.1376181
	speed: 0.0113s/iter; left time: 97.3600s
Epoch: 5 cost time: 6.7547218799591064
Epoch: 5, Steps: 570 | Train Loss: 0.1524709 Vali Loss: 0.0320367 Test Loss: 0.1079767
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1827997
	speed: 0.0372s/iter; left time: 314.2819s
	iters: 200, epoch: 6 | loss: 0.1703041
	speed: 0.0114s/iter; left time: 95.2822s
	iters: 300, epoch: 6 | loss: 0.1024003
	speed: 0.0114s/iter; left time: 93.8130s
	iters: 400, epoch: 6 | loss: 0.1130601
	speed: 0.0114s/iter; left time: 92.7411s
	iters: 500, epoch: 6 | loss: 0.1236067
	speed: 0.0114s/iter; left time: 91.5679s
Epoch: 6 cost time: 6.802003622055054
Epoch: 6, Steps: 570 | Train Loss: 0.1479304 Vali Loss: 0.0315388 Test Loss: 0.1083799
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1005459
	speed: 0.0378s/iter; left time: 298.1816s
	iters: 200, epoch: 7 | loss: 0.1757216
	speed: 0.0113s/iter; left time: 87.8231s
	iters: 300, epoch: 7 | loss: 0.0926131
	speed: 0.0113s/iter; left time: 86.7241s
	iters: 400, epoch: 7 | loss: 0.1129227
	speed: 0.0113s/iter; left time: 85.5359s
	iters: 500, epoch: 7 | loss: 0.1445362
	speed: 0.0113s/iter; left time: 84.5598s
Epoch: 7 cost time: 6.71791672706604
Epoch: 7, Steps: 570 | Train Loss: 0.1446372 Vali Loss: 0.0312821 Test Loss: 0.1098775
Validation loss decreased (0.031518 --> 0.031282).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0910030
	speed: 0.0386s/iter; left time: 281.9954s
	iters: 200, epoch: 8 | loss: 0.1724409
	speed: 0.0124s/iter; left time: 89.2827s
	iters: 300, epoch: 8 | loss: 0.1076314
	speed: 0.0124s/iter; left time: 88.2341s
	iters: 400, epoch: 8 | loss: 0.1211267
	speed: 0.0124s/iter; left time: 86.7489s
	iters: 500, epoch: 8 | loss: 0.0972228
	speed: 0.0124s/iter; left time: 85.4467s
Epoch: 8 cost time: 7.360790491104126
Epoch: 8, Steps: 570 | Train Loss: 0.1431740 Vali Loss: 0.0317248 Test Loss: 0.1087162
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2182051
	speed: 0.0380s/iter; left time: 256.3341s
	iters: 200, epoch: 9 | loss: 0.0913742
	speed: 0.0113s/iter; left time: 75.1390s
	iters: 300, epoch: 9 | loss: 0.1600398
	speed: 0.0113s/iter; left time: 74.1209s
	iters: 400, epoch: 9 | loss: 0.1431230
	speed: 0.0113s/iter; left time: 72.8675s
	iters: 500, epoch: 9 | loss: 0.2235110
	speed: 0.0113s/iter; left time: 71.6787s
Epoch: 9 cost time: 6.7261621952056885
Epoch: 9, Steps: 570 | Train Loss: 0.1425570 Vali Loss: 0.0313437 Test Loss: 0.1093507
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1491167
	speed: 0.0391s/iter; left time: 241.2740s
	iters: 200, epoch: 10 | loss: 0.1241558
	speed: 0.0119s/iter; left time: 72.4412s
	iters: 300, epoch: 10 | loss: 0.1363642
	speed: 0.0113s/iter; left time: 67.6100s
	iters: 400, epoch: 10 | loss: 0.1465521
	speed: 0.0113s/iter; left time: 66.5191s
	iters: 500, epoch: 10 | loss: 0.1566798
	speed: 0.0113s/iter; left time: 65.1639s
Epoch: 10 cost time: 6.910388946533203
Epoch: 10, Steps: 570 | Train Loss: 0.1432159 Vali Loss: 0.0313971 Test Loss: 0.1089479
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10999706387519836, mae:0.19875533878803253
>>> S LR=5e-4 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2707986
	speed: 0.0227s/iter; left time: 257.0823s
	iters: 200, epoch: 1 | loss: 0.3188101
	speed: 0.0107s/iter; left time: 120.3587s
	iters: 300, epoch: 1 | loss: 0.3083089
	speed: 0.0108s/iter; left time: 119.5828s
	iters: 400, epoch: 1 | loss: 0.2420132
	speed: 0.0107s/iter; left time: 118.2124s
	iters: 500, epoch: 1 | loss: 0.2016191
	speed: 0.0108s/iter; left time: 117.4943s
Epoch: 1 cost time: 7.383201837539673
Epoch: 1, Steps: 570 | Train Loss: 0.2611549 Vali Loss: 0.0464109 Test Loss: 0.1546950
Validation loss decreased (inf --> 0.046411).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2153592
	speed: 0.0362s/iter; left time: 388.2951s
	iters: 200, epoch: 2 | loss: 0.2720231
	speed: 0.0107s/iter; left time: 114.0568s
	iters: 300, epoch: 2 | loss: 0.1533889
	speed: 0.0107s/iter; left time: 113.1298s
	iters: 400, epoch: 2 | loss: 0.1556764
	speed: 0.0108s/iter; left time: 112.2413s
	iters: 500, epoch: 2 | loss: 0.1564838
	speed: 0.0107s/iter; left time: 111.0421s
Epoch: 2 cost time: 6.4119627475738525
Epoch: 2, Steps: 570 | Train Loss: 0.2282016 Vali Loss: 0.0448465 Test Loss: 0.1504970
Validation loss decreased (0.046411 --> 0.044846).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1956703
	speed: 0.0362s/iter; left time: 367.3554s
	iters: 200, epoch: 3 | loss: 0.1538086
	speed: 0.0107s/iter; left time: 107.5356s
	iters: 300, epoch: 3 | loss: 0.3316008
	speed: 0.0107s/iter; left time: 106.3176s
	iters: 400, epoch: 3 | loss: 0.1740302
	speed: 0.0107s/iter; left time: 105.5890s
	iters: 500, epoch: 3 | loss: 0.1879747
	speed: 0.0107s/iter; left time: 104.2760s
Epoch: 3 cost time: 6.369426727294922
Epoch: 3, Steps: 570 | Train Loss: 0.2008025 Vali Loss: 0.0427424 Test Loss: 0.1351239
Validation loss decreased (0.044846 --> 0.042742).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2102666
	speed: 0.0369s/iter; left time: 354.1536s
	iters: 200, epoch: 4 | loss: 0.1148810
	speed: 0.0107s/iter; left time: 101.7798s
	iters: 300, epoch: 4 | loss: 0.1736853
	speed: 0.0107s/iter; left time: 100.7073s
	iters: 400, epoch: 4 | loss: 0.3380876
	speed: 0.0107s/iter; left time: 99.3652s
	iters: 500, epoch: 4 | loss: 0.1959306
	speed: 0.0107s/iter; left time: 98.3480s
Epoch: 4 cost time: 6.388482093811035
Epoch: 4, Steps: 570 | Train Loss: 0.1861306 Vali Loss: 0.0419054 Test Loss: 0.1325101
Validation loss decreased (0.042742 --> 0.041905).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1453055
	speed: 0.0367s/iter; left time: 331.4390s
	iters: 200, epoch: 5 | loss: 0.1561320
	speed: 0.0108s/iter; left time: 96.0427s
	iters: 300, epoch: 5 | loss: 0.1680063
	speed: 0.0108s/iter; left time: 95.0344s
	iters: 400, epoch: 5 | loss: 0.1189690
	speed: 0.0108s/iter; left time: 93.8987s
	iters: 500, epoch: 5 | loss: 0.2862215
	speed: 0.0107s/iter; left time: 92.5951s
Epoch: 5 cost time: 6.418763875961304
Epoch: 5, Steps: 570 | Train Loss: 0.1727152 Vali Loss: 0.0395011 Test Loss: 0.1327594
Validation loss decreased (0.041905 --> 0.039501).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1598936
	speed: 0.0359s/iter; left time: 303.7897s
	iters: 200, epoch: 6 | loss: 0.1572537
	speed: 0.0107s/iter; left time: 89.6256s
	iters: 300, epoch: 6 | loss: 0.1783562
	speed: 0.0107s/iter; left time: 88.4191s
	iters: 400, epoch: 6 | loss: 0.1477789
	speed: 0.0107s/iter; left time: 87.5264s
	iters: 500, epoch: 6 | loss: 0.1457600
	speed: 0.0107s/iter; left time: 86.4609s
Epoch: 6 cost time: 6.399568319320679
Epoch: 6, Steps: 570 | Train Loss: 0.1649231 Vali Loss: 0.0388536 Test Loss: 0.1303977
Validation loss decreased (0.039501 --> 0.038854).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1382039
	speed: 0.0358s/iter; left time: 282.0717s
	iters: 200, epoch: 7 | loss: 0.1339930
	speed: 0.0107s/iter; left time: 83.1252s
	iters: 300, epoch: 7 | loss: 0.0977404
	speed: 0.0107s/iter; left time: 82.1788s
	iters: 400, epoch: 7 | loss: 0.1693780
	speed: 0.0107s/iter; left time: 81.0944s
	iters: 500, epoch: 7 | loss: 0.1040639
	speed: 0.0107s/iter; left time: 79.9551s
Epoch: 7 cost time: 6.3819334506988525
Epoch: 7, Steps: 570 | Train Loss: 0.1616517 Vali Loss: 0.0389932 Test Loss: 0.1311180
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1026821
	speed: 0.0353s/iter; left time: 257.8269s
	iters: 200, epoch: 8 | loss: 0.2142593
	speed: 0.0108s/iter; left time: 77.6060s
	iters: 300, epoch: 8 | loss: 0.2266597
	speed: 0.0108s/iter; left time: 76.5328s
	iters: 400, epoch: 8 | loss: 0.1560557
	speed: 0.0108s/iter; left time: 75.4576s
	iters: 500, epoch: 8 | loss: 0.1070118
	speed: 0.0108s/iter; left time: 74.4449s
Epoch: 8 cost time: 6.372745990753174
Epoch: 8, Steps: 570 | Train Loss: 0.1593961 Vali Loss: 0.0386909 Test Loss: 0.1296788
Validation loss decreased (0.038854 --> 0.038691).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1716817
	speed: 0.0355s/iter; left time: 239.2367s
	iters: 200, epoch: 9 | loss: 0.1374362
	speed: 0.0107s/iter; left time: 71.2465s
	iters: 300, epoch: 9 | loss: 0.1630899
	speed: 0.0107s/iter; left time: 70.1456s
	iters: 400, epoch: 9 | loss: 0.2075777
	speed: 0.0107s/iter; left time: 69.1270s
	iters: 500, epoch: 9 | loss: 0.0934981
	speed: 0.0107s/iter; left time: 68.0802s
Epoch: 9 cost time: 6.3683693408966064
Epoch: 9, Steps: 570 | Train Loss: 0.1586453 Vali Loss: 0.0389143 Test Loss: 0.1298995
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1668194
	speed: 0.0350s/iter; left time: 216.0713s
	iters: 200, epoch: 10 | loss: 0.1141708
	speed: 0.0107s/iter; left time: 64.8511s
	iters: 300, epoch: 10 | loss: 0.1849189
	speed: 0.0107s/iter; left time: 63.7553s
	iters: 400, epoch: 10 | loss: 0.1247839
	speed: 0.0107s/iter; left time: 62.6839s
	iters: 500, epoch: 10 | loss: 0.1683243
	speed: 0.0107s/iter; left time: 61.6063s
Epoch: 10 cost time: 6.360765218734741
Epoch: 10, Steps: 570 | Train Loss: 0.1581699 Vali Loss: 0.0389272 Test Loss: 0.1302847
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1223451
	speed: 0.0372s/iter; left time: 208.3662s
	iters: 200, epoch: 11 | loss: 0.1713908
	speed: 0.0106s/iter; left time: 58.5599s
	iters: 300, epoch: 11 | loss: 0.1477994
	speed: 0.0106s/iter; left time: 57.4598s
	iters: 400, epoch: 11 | loss: 0.1190596
	speed: 0.0106s/iter; left time: 56.4224s
	iters: 500, epoch: 11 | loss: 0.1350036
	speed: 0.0106s/iter; left time: 55.3446s
Epoch: 11 cost time: 6.3346874713897705
Epoch: 11, Steps: 570 | Train Loss: 0.1584306 Vali Loss: 0.0389159 Test Loss: 0.1300213
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.129765123128891, mae:0.23118218779563904
>>> S LR=5e-4 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2305115
	speed: 0.0273s/iter; left time: 308.0224s
	iters: 200, epoch: 1 | loss: 0.1754368
	speed: 0.0146s/iter; left time: 163.1843s
	iters: 300, epoch: 1 | loss: 0.3112781
	speed: 0.0145s/iter; left time: 161.0716s
	iters: 400, epoch: 1 | loss: 0.2085173
	speed: 0.0145s/iter; left time: 159.9438s
	iters: 500, epoch: 1 | loss: 0.1716185
	speed: 0.0146s/iter; left time: 158.9831s
Epoch: 1 cost time: 9.618531227111816
Epoch: 1, Steps: 570 | Train Loss: 0.2409989 Vali Loss: 0.0430689 Test Loss: 0.1337826
Validation loss decreased (inf --> 0.043069).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3082272
	speed: 0.0465s/iter; left time: 499.0044s
	iters: 200, epoch: 2 | loss: 0.2349511
	speed: 0.0155s/iter; left time: 164.9827s
	iters: 300, epoch: 2 | loss: 0.1530567
	speed: 0.0167s/iter; left time: 175.8563s
	iters: 400, epoch: 2 | loss: 0.0918573
	speed: 0.0167s/iter; left time: 174.5285s
	iters: 500, epoch: 2 | loss: 0.2183732
	speed: 0.0167s/iter; left time: 172.5303s
Epoch: 2 cost time: 9.492602109909058
Epoch: 2, Steps: 570 | Train Loss: 0.2116485 Vali Loss: 0.0469540 Test Loss: 0.1597917
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3619287
	speed: 0.0498s/iter; left time: 505.8013s
	iters: 200, epoch: 3 | loss: 0.2092346
	speed: 0.0167s/iter; left time: 168.2575s
	iters: 300, epoch: 3 | loss: 0.1010005
	speed: 0.0167s/iter; left time: 166.4202s
	iters: 400, epoch: 3 | loss: 0.1464930
	speed: 0.0167s/iter; left time: 164.7436s
	iters: 500, epoch: 3 | loss: 0.1205209
	speed: 0.0167s/iter; left time: 163.2392s
Epoch: 3 cost time: 9.842255115509033
Epoch: 3, Steps: 570 | Train Loss: 0.1872679 Vali Loss: 0.0405219 Test Loss: 0.1401727
Validation loss decreased (0.043069 --> 0.040522).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1458734
	speed: 0.0498s/iter; left time: 477.8582s
	iters: 200, epoch: 4 | loss: 0.1336254
	speed: 0.0167s/iter; left time: 158.9109s
	iters: 300, epoch: 4 | loss: 0.1689508
	speed: 0.0167s/iter; left time: 157.2295s
	iters: 400, epoch: 4 | loss: 0.1984878
	speed: 0.0168s/iter; left time: 155.7208s
	iters: 500, epoch: 4 | loss: 0.1508223
	speed: 0.0167s/iter; left time: 153.8943s
Epoch: 4 cost time: 9.84005093574524
Epoch: 4, Steps: 570 | Train Loss: 0.1715846 Vali Loss: 0.0406856 Test Loss: 0.1522608
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1474065
	speed: 0.0505s/iter; left time: 455.4060s
	iters: 200, epoch: 5 | loss: 0.1593364
	speed: 0.0164s/iter; left time: 145.9961s
	iters: 300, epoch: 5 | loss: 0.1481050
	speed: 0.0162s/iter; left time: 143.3161s
	iters: 400, epoch: 5 | loss: 0.1856340
	speed: 0.0162s/iter; left time: 141.6023s
	iters: 500, epoch: 5 | loss: 0.1834962
	speed: 0.0163s/iter; left time: 140.2837s
Epoch: 5 cost time: 9.542803287506104
Epoch: 5, Steps: 570 | Train Loss: 0.1621149 Vali Loss: 0.0404637 Test Loss: 0.1399866
Validation loss decreased (0.040522 --> 0.040464).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1454875
	speed: 0.0470s/iter; left time: 397.3419s
	iters: 200, epoch: 6 | loss: 0.1576890
	speed: 0.0145s/iter; left time: 121.2023s
	iters: 300, epoch: 6 | loss: 0.1161878
	speed: 0.0145s/iter; left time: 119.6499s
	iters: 400, epoch: 6 | loss: 0.1235364
	speed: 0.0145s/iter; left time: 118.3665s
	iters: 500, epoch: 6 | loss: 0.1410356
	speed: 0.0145s/iter; left time: 116.7359s
Epoch: 6 cost time: 8.54795503616333
Epoch: 6, Steps: 570 | Train Loss: 0.1555423 Vali Loss: 0.0414821 Test Loss: 0.1431545
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1615664
	speed: 0.0450s/iter; left time: 354.8374s
	iters: 200, epoch: 7 | loss: 0.1325902
	speed: 0.0146s/iter; left time: 113.3906s
	iters: 300, epoch: 7 | loss: 0.1182693
	speed: 0.0146s/iter; left time: 111.9448s
	iters: 400, epoch: 7 | loss: 0.1441244
	speed: 0.0146s/iter; left time: 110.4541s
	iters: 500, epoch: 7 | loss: 0.2101303
	speed: 0.0146s/iter; left time: 109.0074s
Epoch: 7 cost time: 8.580012083053589
Epoch: 7, Steps: 570 | Train Loss: 0.1536467 Vali Loss: 0.0408218 Test Loss: 0.1410532
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2242930
	speed: 0.0457s/iter; left time: 333.9532s
	iters: 200, epoch: 8 | loss: 0.1769862
	speed: 0.0145s/iter; left time: 104.7912s
	iters: 300, epoch: 8 | loss: 0.1877203
	speed: 0.0145s/iter; left time: 103.4599s
	iters: 400, epoch: 8 | loss: 0.1117410
	speed: 0.0145s/iter; left time: 101.9475s
	iters: 500, epoch: 8 | loss: 0.1538847
	speed: 0.0144s/iter; left time: 99.7363s
Epoch: 8 cost time: 8.553685903549194
Epoch: 8, Steps: 570 | Train Loss: 0.1527080 Vali Loss: 0.0406306 Test Loss: 0.1414905
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.140082448720932, mae:0.22996880114078522
>>> S LR=5e-4 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2686291
	speed: 0.0258s/iter; left time: 291.3869s
	iters: 200, epoch: 1 | loss: 0.2423106
	speed: 0.0142s/iter; left time: 158.5049s
	iters: 300, epoch: 1 | loss: 0.1377989
	speed: 0.0141s/iter; left time: 156.7511s
	iters: 400, epoch: 1 | loss: 0.3098439
	speed: 0.0141s/iter; left time: 155.4208s
	iters: 500, epoch: 1 | loss: 0.1747230
	speed: 0.0141s/iter; left time: 153.9316s
Epoch: 1 cost time: 9.269479990005493
Epoch: 1, Steps: 570 | Train Loss: 0.2120226 Vali Loss: 0.0392536 Test Loss: 0.1264390
Validation loss decreased (inf --> 0.039254).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1463942
	speed: 0.0449s/iter; left time: 482.2618s
	iters: 200, epoch: 2 | loss: 0.2616929
	speed: 0.0142s/iter; left time: 150.6552s
	iters: 300, epoch: 2 | loss: 0.1804210
	speed: 0.0142s/iter; left time: 149.3678s
	iters: 400, epoch: 2 | loss: 0.1751010
	speed: 0.0142s/iter; left time: 147.9606s
	iters: 500, epoch: 2 | loss: 0.1624471
	speed: 0.0142s/iter; left time: 146.7556s
Epoch: 2 cost time: 8.334474086761475
Epoch: 2, Steps: 570 | Train Loss: 0.1858272 Vali Loss: 0.0358082 Test Loss: 0.1160069
Validation loss decreased (0.039254 --> 0.035808).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1836871
	speed: 0.0459s/iter; left time: 466.7045s
	iters: 200, epoch: 3 | loss: 0.0767667
	speed: 0.0142s/iter; left time: 142.4282s
	iters: 300, epoch: 3 | loss: 0.2380144
	speed: 0.0141s/iter; left time: 140.4790s
	iters: 400, epoch: 3 | loss: 0.1109090
	speed: 0.0140s/iter; left time: 138.5155s
	iters: 500, epoch: 3 | loss: 0.1596237
	speed: 0.0141s/iter; left time: 137.6701s
Epoch: 3 cost time: 8.301681518554688
Epoch: 3, Steps: 570 | Train Loss: 0.1660687 Vali Loss: 0.0328592 Test Loss: 0.1105265
Validation loss decreased (0.035808 --> 0.032859).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1712067
	speed: 0.0453s/iter; left time: 434.3391s
	iters: 200, epoch: 4 | loss: 0.1604692
	speed: 0.0142s/iter; left time: 134.7259s
	iters: 300, epoch: 4 | loss: 0.2146745
	speed: 0.0142s/iter; left time: 133.1242s
	iters: 400, epoch: 4 | loss: 0.0958576
	speed: 0.0141s/iter; left time: 131.4496s
	iters: 500, epoch: 4 | loss: 0.1071143
	speed: 0.0142s/iter; left time: 130.1395s
Epoch: 4 cost time: 8.313504934310913
Epoch: 4, Steps: 570 | Train Loss: 0.1584901 Vali Loss: 0.0321909 Test Loss: 0.1082069
Validation loss decreased (0.032859 --> 0.032191).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0908307
	speed: 0.0454s/iter; left time: 409.3077s
	iters: 200, epoch: 5 | loss: 0.1479297
	speed: 0.0143s/iter; left time: 127.2544s
	iters: 300, epoch: 5 | loss: 0.1864331
	speed: 0.0143s/iter; left time: 125.8423s
	iters: 400, epoch: 5 | loss: 0.1287645
	speed: 0.0143s/iter; left time: 124.4261s
	iters: 500, epoch: 5 | loss: 0.1573215
	speed: 0.0143s/iter; left time: 123.0056s
Epoch: 5 cost time: 8.423393249511719
Epoch: 5, Steps: 570 | Train Loss: 0.1505003 Vali Loss: 0.0321707 Test Loss: 0.1097076
Validation loss decreased (0.032191 --> 0.032171).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1172246
	speed: 0.0493s/iter; left time: 416.4082s
	iters: 200, epoch: 6 | loss: 0.2368199
	speed: 0.0160s/iter; left time: 133.5374s
	iters: 300, epoch: 6 | loss: 0.2298615
	speed: 0.0160s/iter; left time: 132.1087s
	iters: 400, epoch: 6 | loss: 0.1668865
	speed: 0.0160s/iter; left time: 130.5180s
	iters: 500, epoch: 6 | loss: 0.1729182
	speed: 0.0160s/iter; left time: 129.1497s
Epoch: 6 cost time: 9.404081583023071
Epoch: 6, Steps: 570 | Train Loss: 0.1475297 Vali Loss: 0.0314315 Test Loss: 0.1096316
Validation loss decreased (0.032171 --> 0.031431).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1092218
	speed: 0.0459s/iter; left time: 361.7760s
	iters: 200, epoch: 7 | loss: 0.1523382
	speed: 0.0142s/iter; left time: 110.3121s
	iters: 300, epoch: 7 | loss: 0.2295792
	speed: 0.0141s/iter; left time: 108.5525s
	iters: 400, epoch: 7 | loss: 0.1335267
	speed: 0.0141s/iter; left time: 106.9586s
	iters: 500, epoch: 7 | loss: 0.1901284
	speed: 0.0141s/iter; left time: 105.5243s
Epoch: 7 cost time: 8.327499628067017
Epoch: 7, Steps: 570 | Train Loss: 0.1454430 Vali Loss: 0.0317377 Test Loss: 0.1088085
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1041808
	speed: 0.0447s/iter; left time: 326.5611s
	iters: 200, epoch: 8 | loss: 0.1363732
	speed: 0.0143s/iter; left time: 103.1279s
	iters: 300, epoch: 8 | loss: 0.2209180
	speed: 0.0143s/iter; left time: 101.7878s
	iters: 400, epoch: 8 | loss: 0.1371801
	speed: 0.0142s/iter; left time: 99.5616s
	iters: 500, epoch: 8 | loss: 0.1672030
	speed: 0.0142s/iter; left time: 98.2483s
Epoch: 8 cost time: 8.370753049850464
Epoch: 8, Steps: 570 | Train Loss: 0.1438140 Vali Loss: 0.0316340 Test Loss: 0.1087788
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1095794
	speed: 0.0459s/iter; left time: 309.1363s
	iters: 200, epoch: 9 | loss: 0.0998772
	speed: 0.0142s/iter; left time: 94.4862s
	iters: 300, epoch: 9 | loss: 0.1908844
	speed: 0.0143s/iter; left time: 93.4057s
	iters: 400, epoch: 9 | loss: 0.1558298
	speed: 0.0143s/iter; left time: 91.8316s
	iters: 500, epoch: 9 | loss: 0.1328551
	speed: 0.0142s/iter; left time: 90.1814s
Epoch: 9 cost time: 8.401070356369019
Epoch: 9, Steps: 570 | Train Loss: 0.1434020 Vali Loss: 0.0315975 Test Loss: 0.1082910
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1097792237997055, mae:0.1973973512649536
>>> S LR=5e-4 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1345032
	speed: 0.0279s/iter; left time: 315.7297s
	iters: 200, epoch: 1 | loss: 0.3182409
	speed: 0.0158s/iter; left time: 177.2216s
	iters: 300, epoch: 1 | loss: 0.3248357
	speed: 0.0158s/iter; left time: 175.4705s
	iters: 400, epoch: 1 | loss: 0.2103566
	speed: 0.0158s/iter; left time: 174.0025s
	iters: 500, epoch: 1 | loss: 0.2565312
	speed: 0.0159s/iter; left time: 172.9286s
Epoch: 1 cost time: 10.282087326049805
Epoch: 1, Steps: 570 | Train Loss: 0.2499987 Vali Loss: 0.0459088 Test Loss: 0.1442762
Validation loss decreased (inf --> 0.045909).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2021670
	speed: 0.0465s/iter; left time: 499.3718s
	iters: 200, epoch: 2 | loss: 0.1711283
	speed: 0.0141s/iter; left time: 150.1430s
	iters: 300, epoch: 2 | loss: 0.1653000
	speed: 0.0141s/iter; left time: 149.0077s
	iters: 400, epoch: 2 | loss: 0.1830539
	speed: 0.0142s/iter; left time: 147.7184s
	iters: 500, epoch: 2 | loss: 0.2699445
	speed: 0.0142s/iter; left time: 146.3535s
Epoch: 2 cost time: 8.356048822402954
Epoch: 2, Steps: 570 | Train Loss: 0.2164922 Vali Loss: 0.0428111 Test Loss: 0.1474519
Validation loss decreased (0.045909 --> 0.042811).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2223665
	speed: 0.0469s/iter; left time: 476.3711s
	iters: 200, epoch: 3 | loss: 0.2260284
	speed: 0.0160s/iter; left time: 160.8666s
	iters: 300, epoch: 3 | loss: 0.1481419
	speed: 0.0160s/iter; left time: 158.9009s
	iters: 400, epoch: 3 | loss: 0.1470818
	speed: 0.0160s/iter; left time: 157.5007s
	iters: 500, epoch: 3 | loss: 0.2395079
	speed: 0.0159s/iter; left time: 155.5583s
Epoch: 3 cost time: 9.384910821914673
Epoch: 3, Steps: 570 | Train Loss: 0.1939882 Vali Loss: 0.0433048 Test Loss: 0.1392457
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2247727
	speed: 0.0490s/iter; left time: 470.1461s
	iters: 200, epoch: 4 | loss: 0.1880400
	speed: 0.0141s/iter; left time: 133.5162s
	iters: 300, epoch: 4 | loss: 0.1782062
	speed: 0.0141s/iter; left time: 131.9540s
	iters: 400, epoch: 4 | loss: 0.1434135
	speed: 0.0141s/iter; left time: 130.6646s
	iters: 500, epoch: 4 | loss: 0.1264801
	speed: 0.0140s/iter; left time: 129.0379s
Epoch: 4 cost time: 8.267935037612915
Epoch: 4, Steps: 570 | Train Loss: 0.1783899 Vali Loss: 0.0436289 Test Loss: 0.1367874
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1446916
	speed: 0.0472s/iter; left time: 425.5644s
	iters: 200, epoch: 5 | loss: 0.1906991
	speed: 0.0158s/iter; left time: 141.3532s
	iters: 300, epoch: 5 | loss: 0.1544091
	speed: 0.0158s/iter; left time: 139.7630s
	iters: 400, epoch: 5 | loss: 0.2261887
	speed: 0.0158s/iter; left time: 138.1808s
	iters: 500, epoch: 5 | loss: 0.1418849
	speed: 0.0158s/iter; left time: 136.5270s
Epoch: 5 cost time: 9.292262554168701
Epoch: 5, Steps: 570 | Train Loss: 0.1695622 Vali Loss: 0.0414971 Test Loss: 0.1357713
Validation loss decreased (0.042811 --> 0.041497).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2220378
	speed: 0.0459s/iter; left time: 387.6883s
	iters: 200, epoch: 6 | loss: 0.1820006
	speed: 0.0162s/iter; left time: 135.4453s
	iters: 300, epoch: 6 | loss: 0.0924761
	speed: 0.0162s/iter; left time: 134.0180s
	iters: 400, epoch: 6 | loss: 0.1994095
	speed: 0.0162s/iter; left time: 132.1990s
	iters: 500, epoch: 6 | loss: 0.1712136
	speed: 0.0162s/iter; left time: 130.6402s
Epoch: 6 cost time: 9.34775424003601
Epoch: 6, Steps: 570 | Train Loss: 0.1635235 Vali Loss: 0.0421646 Test Loss: 0.1355995
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2099072
	speed: 0.0494s/iter; left time: 389.4454s
	iters: 200, epoch: 7 | loss: 0.1408413
	speed: 0.0163s/iter; left time: 127.0076s
	iters: 300, epoch: 7 | loss: 0.1124148
	speed: 0.0163s/iter; left time: 125.3784s
	iters: 400, epoch: 7 | loss: 0.1972492
	speed: 0.0163s/iter; left time: 123.7226s
	iters: 500, epoch: 7 | loss: 0.1451701
	speed: 0.0163s/iter; left time: 122.0168s
Epoch: 7 cost time: 9.60646677017212
Epoch: 7, Steps: 570 | Train Loss: 0.1625477 Vali Loss: 0.0431942 Test Loss: 0.1370760
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1493040
	speed: 0.0503s/iter; left time: 367.6539s
	iters: 200, epoch: 8 | loss: 0.1729245
	speed: 0.0157s/iter; left time: 113.1195s
	iters: 300, epoch: 8 | loss: 0.1395556
	speed: 0.0141s/iter; left time: 99.9358s
	iters: 400, epoch: 8 | loss: 0.1677076
	speed: 0.0141s/iter; left time: 98.7240s
	iters: 500, epoch: 8 | loss: 0.0953009
	speed: 0.0140s/iter; left time: 97.0680s
Epoch: 8 cost time: 8.750230550765991
Epoch: 8, Steps: 570 | Train Loss: 0.1611997 Vali Loss: 0.0425246 Test Loss: 0.1366375
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1358204483985901, mae:0.2322252094745636
>>> S LR=5e-4 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2975569
	speed: 0.0288s/iter; left time: 325.0592s
	iters: 200, epoch: 1 | loss: 0.2045329
	speed: 0.0168s/iter; left time: 188.2173s
	iters: 300, epoch: 1 | loss: 0.3200550
	speed: 0.0168s/iter; left time: 186.4486s
	iters: 400, epoch: 1 | loss: 0.2792531
	speed: 0.0172s/iter; left time: 189.0380s
	iters: 500, epoch: 1 | loss: 0.2076530
	speed: 0.0174s/iter; left time: 189.2344s
Epoch: 1 cost time: 10.916850090026855
Epoch: 1, Steps: 570 | Train Loss: 0.2546428 Vali Loss: 0.0471888 Test Loss: 0.1499854
Validation loss decreased (inf --> 0.047189).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2222489
	speed: 0.0506s/iter; left time: 543.3666s
	iters: 200, epoch: 2 | loss: 0.2403682
	speed: 0.0167s/iter; left time: 178.0411s
	iters: 300, epoch: 2 | loss: 0.2396270
	speed: 0.0167s/iter; left time: 176.3461s
	iters: 400, epoch: 2 | loss: 0.1868219
	speed: 0.0167s/iter; left time: 174.5057s
	iters: 500, epoch: 2 | loss: 0.1654269
	speed: 0.0167s/iter; left time: 172.8194s
Epoch: 2 cost time: 9.854737997055054
Epoch: 2, Steps: 570 | Train Loss: 0.2342326 Vali Loss: 0.0484584 Test Loss: 0.1559654
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1955144
	speed: 0.0498s/iter; left time: 505.7597s
	iters: 200, epoch: 3 | loss: 0.2167151
	speed: 0.0167s/iter; left time: 168.1920s
	iters: 300, epoch: 3 | loss: 0.3436633
	speed: 0.0167s/iter; left time: 166.4387s
	iters: 400, epoch: 3 | loss: 0.2140498
	speed: 0.0167s/iter; left time: 164.5756s
	iters: 500, epoch: 3 | loss: 0.2214277
	speed: 0.0167s/iter; left time: 163.1149s
Epoch: 3 cost time: 9.82721495628357
Epoch: 3, Steps: 570 | Train Loss: 0.2138609 Vali Loss: 0.0415837 Test Loss: 0.1314421
Validation loss decreased (0.047189 --> 0.041584).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1755016
	speed: 0.0539s/iter; left time: 516.9520s
	iters: 200, epoch: 4 | loss: 0.1944732
	speed: 0.0167s/iter; left time: 158.9122s
	iters: 300, epoch: 4 | loss: 0.2005627
	speed: 0.0167s/iter; left time: 157.1509s
	iters: 400, epoch: 4 | loss: 0.2295250
	speed: 0.0168s/iter; left time: 155.7101s
	iters: 500, epoch: 4 | loss: 0.2153317
	speed: 0.0167s/iter; left time: 153.8890s
Epoch: 4 cost time: 9.85707426071167
Epoch: 4, Steps: 570 | Train Loss: 0.1945263 Vali Loss: 0.0405320 Test Loss: 0.1319126
Validation loss decreased (0.041584 --> 0.040532).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1391212
	speed: 0.0501s/iter; left time: 451.9944s
	iters: 200, epoch: 5 | loss: 0.2569993
	speed: 0.0169s/iter; left time: 150.4503s
	iters: 300, epoch: 5 | loss: 0.2200051
	speed: 0.0169s/iter; left time: 148.7081s
	iters: 400, epoch: 5 | loss: 0.2054952
	speed: 0.0168s/iter; left time: 146.1028s
	iters: 500, epoch: 5 | loss: 0.1428946
	speed: 0.0167s/iter; left time: 143.9818s
Epoch: 5 cost time: 9.856682538986206
Epoch: 5, Steps: 570 | Train Loss: 0.1837868 Vali Loss: 0.0394842 Test Loss: 0.1476445
Validation loss decreased (0.040532 --> 0.039484).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2082210
	speed: 0.0537s/iter; left time: 453.7438s
	iters: 200, epoch: 6 | loss: 0.1374034
	speed: 0.0168s/iter; left time: 140.4957s
	iters: 300, epoch: 6 | loss: 0.2018257
	speed: 0.0168s/iter; left time: 138.4557s
	iters: 400, epoch: 6 | loss: 0.2374195
	speed: 0.0168s/iter; left time: 136.8783s
	iters: 500, epoch: 6 | loss: 0.1885499
	speed: 0.0167s/iter; left time: 134.6210s
Epoch: 6 cost time: 9.88423204421997
Epoch: 6, Steps: 570 | Train Loss: 0.1771571 Vali Loss: 0.0398886 Test Loss: 0.1400082
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1646788
	speed: 0.0522s/iter; left time: 411.5966s
	iters: 200, epoch: 7 | loss: 0.2059811
	speed: 0.0167s/iter; left time: 130.2536s
	iters: 300, epoch: 7 | loss: 0.2099278
	speed: 0.0168s/iter; left time: 128.7122s
	iters: 400, epoch: 7 | loss: 0.1268687
	speed: 0.0168s/iter; left time: 126.9966s
	iters: 500, epoch: 7 | loss: 0.1293709
	speed: 0.0168s/iter; left time: 125.4450s
Epoch: 7 cost time: 9.836335897445679
Epoch: 7, Steps: 570 | Train Loss: 0.1735248 Vali Loss: 0.0392539 Test Loss: 0.1522296
Validation loss decreased (0.039484 --> 0.039254).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1694907
	speed: 0.0500s/iter; left time: 365.3271s
	iters: 200, epoch: 8 | loss: 0.1047228
	speed: 0.0167s/iter; left time: 120.5281s
	iters: 300, epoch: 8 | loss: 0.1722129
	speed: 0.0167s/iter; left time: 118.7572s
	iters: 400, epoch: 8 | loss: 0.1165475
	speed: 0.0167s/iter; left time: 117.0401s
	iters: 500, epoch: 8 | loss: 0.1279690
	speed: 0.0167s/iter; left time: 115.2590s
Epoch: 8 cost time: 9.825685262680054
Epoch: 8, Steps: 570 | Train Loss: 0.1726281 Vali Loss: 0.0392627 Test Loss: 0.1412820
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1550661
	speed: 0.0508s/iter; left time: 342.4787s
	iters: 200, epoch: 9 | loss: 0.1082831
	speed: 0.0168s/iter; left time: 111.3383s
	iters: 300, epoch: 9 | loss: 0.1565968
	speed: 0.0168s/iter; left time: 109.8696s
	iters: 400, epoch: 9 | loss: 0.1911620
	speed: 0.0168s/iter; left time: 108.1024s
	iters: 500, epoch: 9 | loss: 0.2669717
	speed: 0.0168s/iter; left time: 106.4968s
Epoch: 9 cost time: 9.849980354309082
Epoch: 9, Steps: 570 | Train Loss: 0.1705188 Vali Loss: 0.0393256 Test Loss: 0.1456893
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.2033871
	speed: 0.0497s/iter; left time: 306.7239s
	iters: 200, epoch: 10 | loss: 0.1047692
	speed: 0.0167s/iter; left time: 101.2839s
	iters: 300, epoch: 10 | loss: 0.2375500
	speed: 0.0167s/iter; left time: 99.5516s
	iters: 400, epoch: 10 | loss: 0.1913156
	speed: 0.0167s/iter; left time: 97.9602s
	iters: 500, epoch: 10 | loss: 0.1562863
	speed: 0.0167s/iter; left time: 96.3339s
Epoch: 10 cost time: 9.783563375473022
Epoch: 10, Steps: 570 | Train Loss: 0.1699710 Vali Loss: 0.0393751 Test Loss: 0.1475728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15240120887756348, mae:0.23720549046993256
>>> S LR=5e-4 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2092890
	speed: 0.0296s/iter; left time: 334.1613s
	iters: 200, epoch: 1 | loss: 0.1676821
	speed: 0.0177s/iter; left time: 198.5476s
	iters: 300, epoch: 1 | loss: 0.2486667
	speed: 0.0177s/iter; left time: 196.6628s
	iters: 400, epoch: 1 | loss: 0.2255491
	speed: 0.0177s/iter; left time: 194.8531s
	iters: 500, epoch: 1 | loss: 0.1325087
	speed: 0.0177s/iter; left time: 193.3029s
Epoch: 1 cost time: 11.283093452453613
Epoch: 1, Steps: 570 | Train Loss: 0.2241390 Vali Loss: 0.0368186 Test Loss: 0.1290045
Validation loss decreased (inf --> 0.036819).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1604848
	speed: 0.0505s/iter; left time: 542.3142s
	iters: 200, epoch: 2 | loss: 0.1420002
	speed: 0.0162s/iter; left time: 171.7118s
	iters: 300, epoch: 2 | loss: 0.2185133
	speed: 0.0162s/iter; left time: 170.1913s
	iters: 400, epoch: 2 | loss: 0.2800250
	speed: 0.0161s/iter; left time: 168.4333s
	iters: 500, epoch: 2 | loss: 0.1723266
	speed: 0.0161s/iter; left time: 166.7462s
Epoch: 2 cost time: 9.503987550735474
Epoch: 2, Steps: 570 | Train Loss: 0.1995278 Vali Loss: 0.0382937 Test Loss: 0.1271621
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1558685
	speed: 0.0483s/iter; left time: 490.7100s
	iters: 200, epoch: 3 | loss: 0.1898578
	speed: 0.0162s/iter; left time: 162.6392s
	iters: 300, epoch: 3 | loss: 0.1546156
	speed: 0.0161s/iter; left time: 160.8607s
	iters: 400, epoch: 3 | loss: 0.2497656
	speed: 0.0161s/iter; left time: 159.2302s
	iters: 500, epoch: 3 | loss: 0.1049855
	speed: 0.0161s/iter; left time: 157.5403s
Epoch: 3 cost time: 9.49071717262268
Epoch: 3, Steps: 570 | Train Loss: 0.1772031 Vali Loss: 0.0343415 Test Loss: 0.1146258
Validation loss decreased (0.036819 --> 0.034341).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1796145
	speed: 0.0491s/iter; left time: 471.3866s
	iters: 200, epoch: 4 | loss: 0.2930580
	speed: 0.0162s/iter; left time: 153.6106s
	iters: 300, epoch: 4 | loss: 0.1502192
	speed: 0.0162s/iter; left time: 151.8941s
	iters: 400, epoch: 4 | loss: 0.1113272
	speed: 0.0162s/iter; left time: 150.3019s
	iters: 500, epoch: 4 | loss: 0.2130369
	speed: 0.0162s/iter; left time: 148.7474s
Epoch: 4 cost time: 9.525097370147705
Epoch: 4, Steps: 570 | Train Loss: 0.1639308 Vali Loss: 0.0322787 Test Loss: 0.1097208
Validation loss decreased (0.034341 --> 0.032279).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1693392
	speed: 0.0517s/iter; left time: 466.1969s
	iters: 200, epoch: 5 | loss: 0.2047877
	speed: 0.0177s/iter; left time: 157.9707s
	iters: 300, epoch: 5 | loss: 0.1416125
	speed: 0.0165s/iter; left time: 145.1989s
	iters: 400, epoch: 5 | loss: 0.1076405
	speed: 0.0161s/iter; left time: 140.7594s
	iters: 500, epoch: 5 | loss: 0.2042957
	speed: 0.0162s/iter; left time: 139.2388s
Epoch: 5 cost time: 9.861052751541138
Epoch: 5, Steps: 570 | Train Loss: 0.1566499 Vali Loss: 0.0310274 Test Loss: 0.1063763
Validation loss decreased (0.032279 --> 0.031027).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1464798
	speed: 0.0487s/iter; left time: 411.1843s
	iters: 200, epoch: 6 | loss: 0.2260197
	speed: 0.0162s/iter; left time: 134.9294s
	iters: 300, epoch: 6 | loss: 0.2938641
	speed: 0.0162s/iter; left time: 133.3143s
	iters: 400, epoch: 6 | loss: 0.1441347
	speed: 0.0161s/iter; left time: 131.6055s
	iters: 500, epoch: 6 | loss: 0.1524247
	speed: 0.0161s/iter; left time: 129.9815s
Epoch: 6 cost time: 9.516609907150269
Epoch: 6, Steps: 570 | Train Loss: 0.1526540 Vali Loss: 0.0313925 Test Loss: 0.1069597
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2114255
	speed: 0.0486s/iter; left time: 383.0928s
	iters: 200, epoch: 7 | loss: 0.1013870
	speed: 0.0161s/iter; left time: 125.4930s
	iters: 300, epoch: 7 | loss: 0.1350718
	speed: 0.0162s/iter; left time: 124.5025s
	iters: 400, epoch: 7 | loss: 0.1884421
	speed: 0.0162s/iter; left time: 122.8992s
	iters: 500, epoch: 7 | loss: 0.2237155
	speed: 0.0162s/iter; left time: 121.1269s
Epoch: 7 cost time: 9.52777647972107
Epoch: 7, Steps: 570 | Train Loss: 0.1497044 Vali Loss: 0.0313035 Test Loss: 0.1072201
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0963509
	speed: 0.0488s/iter; left time: 356.6881s
	iters: 200, epoch: 8 | loss: 0.2315681
	speed: 0.0161s/iter; left time: 116.4038s
	iters: 300, epoch: 8 | loss: 0.1928273
	speed: 0.0161s/iter; left time: 114.7715s
	iters: 400, epoch: 8 | loss: 0.1760650
	speed: 0.0161s/iter; left time: 113.1796s
	iters: 500, epoch: 8 | loss: 0.1280460
	speed: 0.0162s/iter; left time: 111.7397s
Epoch: 8 cost time: 9.520495414733887
Epoch: 8, Steps: 570 | Train Loss: 0.1476267 Vali Loss: 0.0312286 Test Loss: 0.1060292
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10652048140764236, mae:0.19622614979743958
>>> S LR=5e-4 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2739676
	speed: 0.0289s/iter; left time: 326.7295s
	iters: 200, epoch: 1 | loss: 0.3063227
	speed: 0.0171s/iter; left time: 191.0454s
	iters: 300, epoch: 1 | loss: 0.2055719
	speed: 0.0170s/iter; left time: 189.1545s
	iters: 400, epoch: 1 | loss: 0.2690653
	speed: 0.0171s/iter; left time: 188.1036s
	iters: 500, epoch: 1 | loss: 0.4074871
	speed: 0.0167s/iter; left time: 181.9222s
Epoch: 1 cost time: 10.814071416854858
Epoch: 1, Steps: 570 | Train Loss: 0.2641420 Vali Loss: 0.0485417 Test Loss: 0.1658663
Validation loss decreased (inf --> 0.048542).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3191870
	speed: 0.0495s/iter; left time: 530.9233s
	iters: 200, epoch: 2 | loss: 0.1631933
	speed: 0.0154s/iter; left time: 163.9095s
	iters: 300, epoch: 2 | loss: 0.2680112
	speed: 0.0154s/iter; left time: 162.4343s
	iters: 400, epoch: 2 | loss: 0.2091358
	speed: 0.0154s/iter; left time: 160.7255s
	iters: 500, epoch: 2 | loss: 0.3144803
	speed: 0.0173s/iter; left time: 178.2932s
Epoch: 2 cost time: 9.602525234222412
Epoch: 2, Steps: 570 | Train Loss: 0.2334724 Vali Loss: 0.0489072 Test Loss: 0.1645352
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2297482
	speed: 0.0520s/iter; left time: 528.8139s
	iters: 200, epoch: 3 | loss: 0.1291884
	speed: 0.0176s/iter; left time: 177.4682s
	iters: 300, epoch: 3 | loss: 0.2356470
	speed: 0.0177s/iter; left time: 175.9719s
	iters: 400, epoch: 3 | loss: 0.1898178
	speed: 0.0176s/iter; left time: 173.8963s
	iters: 500, epoch: 3 | loss: 0.2041757
	speed: 0.0176s/iter; left time: 172.2809s
Epoch: 3 cost time: 10.343953132629395
Epoch: 3, Steps: 570 | Train Loss: 0.2087221 Vali Loss: 0.0455413 Test Loss: 0.1381888
Validation loss decreased (0.048542 --> 0.045541).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1541439
	speed: 0.0512s/iter; left time: 491.3439s
	iters: 200, epoch: 4 | loss: 0.2076728
	speed: 0.0160s/iter; left time: 151.8864s
	iters: 300, epoch: 4 | loss: 0.1987677
	speed: 0.0155s/iter; left time: 145.6427s
	iters: 400, epoch: 4 | loss: 0.2001588
	speed: 0.0155s/iter; left time: 144.2747s
	iters: 500, epoch: 4 | loss: 0.2197437
	speed: 0.0155s/iter; left time: 142.5322s
Epoch: 4 cost time: 9.365071773529053
Epoch: 4, Steps: 570 | Train Loss: 0.1937126 Vali Loss: 0.0412763 Test Loss: 0.1314277
Validation loss decreased (0.045541 --> 0.041276).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1630851
	speed: 0.0480s/iter; left time: 432.8812s
	iters: 200, epoch: 5 | loss: 0.1365274
	speed: 0.0155s/iter; left time: 138.2574s
	iters: 300, epoch: 5 | loss: 0.1738703
	speed: 0.0155s/iter; left time: 136.4500s
	iters: 400, epoch: 5 | loss: 0.1511723
	speed: 0.0155s/iter; left time: 135.0132s
	iters: 500, epoch: 5 | loss: 0.1864457
	speed: 0.0155s/iter; left time: 133.3923s
Epoch: 5 cost time: 9.109543800354004
Epoch: 5, Steps: 570 | Train Loss: 0.1797801 Vali Loss: 0.0407296 Test Loss: 0.1290599
Validation loss decreased (0.041276 --> 0.040730).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1663800
	speed: 0.0481s/iter; left time: 406.1169s
	iters: 200, epoch: 6 | loss: 0.1270262
	speed: 0.0172s/iter; left time: 143.9672s
	iters: 300, epoch: 6 | loss: 0.1072658
	speed: 0.0178s/iter; left time: 147.2530s
	iters: 400, epoch: 6 | loss: 0.1361344
	speed: 0.0178s/iter; left time: 145.0147s
	iters: 500, epoch: 6 | loss: 0.1116047
	speed: 0.0178s/iter; left time: 143.5452s
Epoch: 6 cost time: 10.19473147392273
Epoch: 6, Steps: 570 | Train Loss: 0.1707082 Vali Loss: 0.0409630 Test Loss: 0.1315536
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1926289
	speed: 0.0511s/iter; left time: 402.5639s
	iters: 200, epoch: 7 | loss: 0.1433896
	speed: 0.0176s/iter; left time: 137.1859s
	iters: 300, epoch: 7 | loss: 0.1329954
	speed: 0.0176s/iter; left time: 135.3856s
	iters: 400, epoch: 7 | loss: 0.2086292
	speed: 0.0176s/iter; left time: 133.5123s
	iters: 500, epoch: 7 | loss: 0.1726099
	speed: 0.0176s/iter; left time: 131.6661s
Epoch: 7 cost time: 10.31032395362854
Epoch: 7, Steps: 570 | Train Loss: 0.1662872 Vali Loss: 0.0404303 Test Loss: 0.1313102
Validation loss decreased (0.040730 --> 0.040430).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1523789
	speed: 0.0513s/iter; left time: 374.7082s
	iters: 200, epoch: 8 | loss: 0.2256082
	speed: 0.0171s/iter; left time: 122.9855s
	iters: 300, epoch: 8 | loss: 0.1166135
	speed: 0.0171s/iter; left time: 121.2584s
	iters: 400, epoch: 8 | loss: 0.1806378
	speed: 0.0161s/iter; left time: 112.9474s
	iters: 500, epoch: 8 | loss: 0.1112760
	speed: 0.0154s/iter; left time: 106.7436s
Epoch: 8 cost time: 9.655187606811523
Epoch: 8, Steps: 570 | Train Loss: 0.1639099 Vali Loss: 0.0402220 Test Loss: 0.1302344
Validation loss decreased (0.040430 --> 0.040222).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1591483
	speed: 0.0476s/iter; left time: 320.6710s
	iters: 200, epoch: 9 | loss: 0.1493990
	speed: 0.0154s/iter; left time: 102.2174s
	iters: 300, epoch: 9 | loss: 0.1702725
	speed: 0.0154s/iter; left time: 100.8102s
	iters: 400, epoch: 9 | loss: 0.1280943
	speed: 0.0154s/iter; left time: 99.1722s
	iters: 500, epoch: 9 | loss: 0.1683282
	speed: 0.0154s/iter; left time: 97.6585s
Epoch: 9 cost time: 9.065908193588257
Epoch: 9, Steps: 570 | Train Loss: 0.1623834 Vali Loss: 0.0400551 Test Loss: 0.1327840
Validation loss decreased (0.040222 --> 0.040055).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1922558
	speed: 0.0483s/iter; left time: 298.3359s
	iters: 200, epoch: 10 | loss: 0.2275279
	speed: 0.0154s/iter; left time: 93.3929s
	iters: 300, epoch: 10 | loss: 0.1328366
	speed: 0.0154s/iter; left time: 91.9300s
	iters: 400, epoch: 10 | loss: 0.1868840
	speed: 0.0154s/iter; left time: 90.3394s
	iters: 500, epoch: 10 | loss: 0.2628637
	speed: 0.0154s/iter; left time: 88.7845s
Epoch: 10 cost time: 9.085973501205444
Epoch: 10, Steps: 570 | Train Loss: 0.1645458 Vali Loss: 0.0400770 Test Loss: 0.1318450
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1433733
	speed: 0.0483s/iter; left time: 270.3675s
	iters: 200, epoch: 11 | loss: 0.1173958
	speed: 0.0154s/iter; left time: 84.6644s
	iters: 300, epoch: 11 | loss: 0.1773904
	speed: 0.0154s/iter; left time: 83.1255s
	iters: 400, epoch: 11 | loss: 0.1988570
	speed: 0.0154s/iter; left time: 81.5140s
	iters: 500, epoch: 11 | loss: 0.2272014
	speed: 0.0154s/iter; left time: 80.0302s
Epoch: 11 cost time: 9.048795700073242
Epoch: 11, Steps: 570 | Train Loss: 0.1630513 Vali Loss: 0.0401721 Test Loss: 0.1315503
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1260641
	speed: 0.0479s/iter; left time: 241.0935s
	iters: 200, epoch: 12 | loss: 0.2334963
	speed: 0.0155s/iter; left time: 76.2211s
	iters: 300, epoch: 12 | loss: 0.1960970
	speed: 0.0154s/iter; left time: 74.5645s
	iters: 400, epoch: 12 | loss: 0.1753154
	speed: 0.0154s/iter; left time: 72.8636s
	iters: 500, epoch: 12 | loss: 0.1279716
	speed: 0.0154s/iter; left time: 71.2486s
Epoch: 12 cost time: 9.049269437789917
Epoch: 12, Steps: 570 | Train Loss: 0.1624849 Vali Loss: 0.0401810 Test Loss: 0.1316936
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13287314772605896, mae:0.23452182114124298
>>> S LR=5e-4 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1840748
	speed: 0.0331s/iter; left time: 373.6020s
	iters: 200, epoch: 1 | loss: 0.2673988
	speed: 0.0196s/iter; left time: 219.3217s
	iters: 300, epoch: 1 | loss: 0.4001641
	speed: 0.0189s/iter; left time: 209.6020s
	iters: 400, epoch: 1 | loss: 0.2686790
	speed: 0.0188s/iter; left time: 207.0179s
	iters: 500, epoch: 1 | loss: 0.1742043
	speed: 0.0189s/iter; left time: 205.9532s
Epoch: 1 cost time: 12.317042350769043
Epoch: 1, Steps: 570 | Train Loss: 0.2432029 Vali Loss: 0.0450031 Test Loss: 0.1336807
Validation loss decreased (inf --> 0.045003).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4755623
	speed: 0.0565s/iter; left time: 606.1103s
	iters: 200, epoch: 2 | loss: 0.1716707
	speed: 0.0187s/iter; left time: 199.0653s
	iters: 300, epoch: 2 | loss: 0.1664795
	speed: 0.0187s/iter; left time: 197.1036s
	iters: 400, epoch: 2 | loss: 0.2026680
	speed: 0.0187s/iter; left time: 195.3510s
	iters: 500, epoch: 2 | loss: 0.1981969
	speed: 0.0188s/iter; left time: 194.5616s
Epoch: 2 cost time: 10.972127437591553
Epoch: 2, Steps: 570 | Train Loss: 0.2119179 Vali Loss: 0.0439860 Test Loss: 0.1445076
Validation loss decreased (0.045003 --> 0.043986).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1567872
	speed: 0.0562s/iter; left time: 571.3572s
	iters: 200, epoch: 3 | loss: 0.2073421
	speed: 0.0188s/iter; left time: 188.7694s
	iters: 300, epoch: 3 | loss: 0.1917296
	speed: 0.0187s/iter; left time: 186.3319s
	iters: 400, epoch: 3 | loss: 0.1340886
	speed: 0.0188s/iter; left time: 184.9477s
	iters: 500, epoch: 3 | loss: 0.1487595
	speed: 0.0188s/iter; left time: 183.2481s
Epoch: 3 cost time: 10.974050521850586
Epoch: 3, Steps: 570 | Train Loss: 0.1897932 Vali Loss: 0.0396662 Test Loss: 0.1302912
Validation loss decreased (0.043986 --> 0.039666).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1889390
	speed: 0.0566s/iter; left time: 542.4466s
	iters: 200, epoch: 4 | loss: 0.2454105
	speed: 0.0187s/iter; left time: 177.8169s
	iters: 300, epoch: 4 | loss: 0.1877481
	speed: 0.0187s/iter; left time: 175.9089s
	iters: 400, epoch: 4 | loss: 0.1039923
	speed: 0.0187s/iter; left time: 173.9377s
	iters: 500, epoch: 4 | loss: 0.1825156
	speed: 0.0187s/iter; left time: 172.1138s
Epoch: 4 cost time: 10.971794128417969
Epoch: 4, Steps: 570 | Train Loss: 0.1732416 Vali Loss: 0.0402125 Test Loss: 0.1447810
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1975827
	speed: 0.0579s/iter; left time: 521.9530s
	iters: 200, epoch: 5 | loss: 0.1876168
	speed: 0.0187s/iter; left time: 166.6247s
	iters: 300, epoch: 5 | loss: 0.1479228
	speed: 0.0187s/iter; left time: 164.6753s
	iters: 400, epoch: 5 | loss: 0.1378087
	speed: 0.0187s/iter; left time: 162.8482s
	iters: 500, epoch: 5 | loss: 0.1403411
	speed: 0.0187s/iter; left time: 161.2610s
Epoch: 5 cost time: 10.942152261734009
Epoch: 5, Steps: 570 | Train Loss: 0.1627376 Vali Loss: 0.0395081 Test Loss: 0.1358941
Validation loss decreased (0.039666 --> 0.039508).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0957287
	speed: 0.0560s/iter; left time: 473.4719s
	iters: 200, epoch: 6 | loss: 0.1385390
	speed: 0.0187s/iter; left time: 156.1965s
	iters: 300, epoch: 6 | loss: 0.1149722
	speed: 0.0187s/iter; left time: 153.9546s
	iters: 400, epoch: 6 | loss: 0.1971650
	speed: 0.0187s/iter; left time: 152.4799s
	iters: 500, epoch: 6 | loss: 0.1539074
	speed: 0.0187s/iter; left time: 150.6874s
Epoch: 6 cost time: 10.967068195343018
Epoch: 6, Steps: 570 | Train Loss: 0.1562270 Vali Loss: 0.0399431 Test Loss: 0.1359007
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1176571
	speed: 0.0559s/iter; left time: 440.2172s
	iters: 200, epoch: 7 | loss: 0.1500475
	speed: 0.0188s/iter; left time: 146.1873s
	iters: 300, epoch: 7 | loss: 0.1503041
	speed: 0.0188s/iter; left time: 144.3536s
	iters: 400, epoch: 7 | loss: 0.1484688
	speed: 0.0187s/iter; left time: 142.0487s
	iters: 500, epoch: 7 | loss: 0.2314175
	speed: 0.0187s/iter; left time: 139.7760s
Epoch: 7 cost time: 10.92390751838684
Epoch: 7, Steps: 570 | Train Loss: 0.1524136 Vali Loss: 0.0399512 Test Loss: 0.1341627
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1367240
	speed: 0.0551s/iter; left time: 402.5848s
	iters: 200, epoch: 8 | loss: 0.1297671
	speed: 0.0186s/iter; left time: 133.9767s
	iters: 300, epoch: 8 | loss: 0.1206861
	speed: 0.0186s/iter; left time: 132.4503s
	iters: 400, epoch: 8 | loss: 0.1734136
	speed: 0.0186s/iter; left time: 130.3182s
	iters: 500, epoch: 8 | loss: 0.1216306
	speed: 0.0186s/iter; left time: 128.6301s
Epoch: 8 cost time: 10.859141111373901
Epoch: 8, Steps: 570 | Train Loss: 0.1509243 Vali Loss: 0.0401905 Test Loss: 0.1371886
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13602124154567719, mae:0.2256537228822708
>>> S LR=5e-4 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3933212
	speed: 0.0321s/iter; left time: 362.3087s
	iters: 200, epoch: 1 | loss: 0.2177985
	speed: 0.0203s/iter; left time: 227.6407s
	iters: 300, epoch: 1 | loss: 0.1822587
	speed: 0.0203s/iter; left time: 225.7857s
	iters: 400, epoch: 1 | loss: 0.1750154
	speed: 0.0203s/iter; left time: 223.2904s
	iters: 500, epoch: 1 | loss: 0.2171502
	speed: 0.0204s/iter; left time: 221.8953s
Epoch: 1 cost time: 12.818364143371582
Epoch: 1, Steps: 570 | Train Loss: 0.2155127 Vali Loss: 0.0367279 Test Loss: 0.1324459
Validation loss decreased (inf --> 0.036728).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1363275
	speed: 0.0603s/iter; left time: 647.2385s
	iters: 200, epoch: 2 | loss: 0.2267256
	speed: 0.0183s/iter; left time: 194.2178s
	iters: 300, epoch: 2 | loss: 0.3425578
	speed: 0.0182s/iter; left time: 191.5026s
	iters: 400, epoch: 2 | loss: 0.1925477
	speed: 0.0182s/iter; left time: 189.3621s
	iters: 500, epoch: 2 | loss: 0.1656980
	speed: 0.0181s/iter; left time: 186.5769s
Epoch: 2 cost time: 10.797917366027832
Epoch: 2, Steps: 570 | Train Loss: 0.1897344 Vali Loss: 0.0366256 Test Loss: 0.1184023
Validation loss decreased (0.036728 --> 0.036626).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1099362
	speed: 0.0546s/iter; left time: 554.6035s
	iters: 200, epoch: 3 | loss: 0.1700453
	speed: 0.0181s/iter; left time: 182.3494s
	iters: 300, epoch: 3 | loss: 0.1435077
	speed: 0.0181s/iter; left time: 180.4922s
	iters: 400, epoch: 3 | loss: 0.1356182
	speed: 0.0181s/iter; left time: 178.3925s
	iters: 500, epoch: 3 | loss: 0.1257355
	speed: 0.0181s/iter; left time: 176.8645s
Epoch: 3 cost time: 10.602068185806274
Epoch: 3, Steps: 570 | Train Loss: 0.1684236 Vali Loss: 0.0340377 Test Loss: 0.1115920
Validation loss decreased (0.036626 --> 0.034038).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1753136
	speed: 0.0571s/iter; left time: 547.2538s
	iters: 200, epoch: 4 | loss: 0.1032672
	speed: 0.0203s/iter; left time: 192.7650s
	iters: 300, epoch: 4 | loss: 0.2368226
	speed: 0.0201s/iter; left time: 188.9214s
	iters: 400, epoch: 4 | loss: 0.1379943
	speed: 0.0180s/iter; left time: 166.8662s
	iters: 500, epoch: 4 | loss: 0.1172749
	speed: 0.0190s/iter; left time: 174.6859s
Epoch: 4 cost time: 11.471958875656128
Epoch: 4, Steps: 570 | Train Loss: 0.1590956 Vali Loss: 0.0322353 Test Loss: 0.1105612
Validation loss decreased (0.034038 --> 0.032235).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1266101
	speed: 0.0586s/iter; left time: 528.3870s
	iters: 200, epoch: 5 | loss: 0.1428510
	speed: 0.0205s/iter; left time: 182.8184s
	iters: 300, epoch: 5 | loss: 0.1804475
	speed: 0.0204s/iter; left time: 179.9441s
	iters: 400, epoch: 5 | loss: 0.1410977
	speed: 0.0204s/iter; left time: 177.6571s
	iters: 500, epoch: 5 | loss: 0.1476441
	speed: 0.0204s/iter; left time: 175.7992s
Epoch: 5 cost time: 11.941790342330933
Epoch: 5, Steps: 570 | Train Loss: 0.1519798 Vali Loss: 0.0327701 Test Loss: 0.1097331
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2106169
	speed: 0.0556s/iter; left time: 470.1607s
	iters: 200, epoch: 6 | loss: 0.1226475
	speed: 0.0183s/iter; left time: 152.5162s
	iters: 300, epoch: 6 | loss: 0.1722339
	speed: 0.0182s/iter; left time: 150.5395s
	iters: 400, epoch: 6 | loss: 0.1330820
	speed: 0.0182s/iter; left time: 148.3569s
	iters: 500, epoch: 6 | loss: 0.0982189
	speed: 0.0182s/iter; left time: 146.6006s
Epoch: 6 cost time: 10.635638236999512
Epoch: 6, Steps: 570 | Train Loss: 0.1475008 Vali Loss: 0.0319321 Test Loss: 0.1091011
Validation loss decreased (0.032235 --> 0.031932).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1416803
	speed: 0.0547s/iter; left time: 431.0347s
	iters: 200, epoch: 7 | loss: 0.1813657
	speed: 0.0181s/iter; left time: 140.6488s
	iters: 300, epoch: 7 | loss: 0.1042648
	speed: 0.0180s/iter; left time: 138.5950s
	iters: 400, epoch: 7 | loss: 0.1460868
	speed: 0.0180s/iter; left time: 136.7352s
	iters: 500, epoch: 7 | loss: 0.1407715
	speed: 0.0180s/iter; left time: 134.7920s
Epoch: 7 cost time: 10.565755844116211
Epoch: 7, Steps: 570 | Train Loss: 0.1438068 Vali Loss: 0.0319455 Test Loss: 0.1091852
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1237641
	speed: 0.0552s/iter; left time: 403.4648s
	iters: 200, epoch: 8 | loss: 0.1222578
	speed: 0.0181s/iter; left time: 130.5606s
	iters: 300, epoch: 8 | loss: 0.1281912
	speed: 0.0181s/iter; left time: 128.7995s
	iters: 400, epoch: 8 | loss: 0.1349403
	speed: 0.0181s/iter; left time: 127.2107s
	iters: 500, epoch: 8 | loss: 0.1794796
	speed: 0.0181s/iter; left time: 125.2442s
Epoch: 8 cost time: 10.588181972503662
Epoch: 8, Steps: 570 | Train Loss: 0.1420501 Vali Loss: 0.0315765 Test Loss: 0.1089927
Validation loss decreased (0.031932 --> 0.031576).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0789143
	speed: 0.0551s/iter; left time: 371.5091s
	iters: 200, epoch: 9 | loss: 0.1179489
	speed: 0.0181s/iter; left time: 119.8802s
	iters: 300, epoch: 9 | loss: 0.1515138
	speed: 0.0181s/iter; left time: 118.1170s
	iters: 400, epoch: 9 | loss: 0.1509912
	speed: 0.0181s/iter; left time: 116.4626s
	iters: 500, epoch: 9 | loss: 0.1260812
	speed: 0.0181s/iter; left time: 114.6832s
Epoch: 9 cost time: 10.600794553756714
Epoch: 9, Steps: 570 | Train Loss: 0.1420732 Vali Loss: 0.0316710 Test Loss: 0.1085660
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1029547
	speed: 0.0543s/iter; left time: 335.1191s
	iters: 200, epoch: 10 | loss: 0.1075236
	speed: 0.0182s/iter; left time: 110.4198s
	iters: 300, epoch: 10 | loss: 0.1916108
	speed: 0.0181s/iter; left time: 108.3503s
	iters: 400, epoch: 10 | loss: 0.1504085
	speed: 0.0181s/iter; left time: 106.5508s
	iters: 500, epoch: 10 | loss: 0.1176456
	speed: 0.0181s/iter; left time: 104.7100s
Epoch: 10 cost time: 10.622351169586182
Epoch: 10, Steps: 570 | Train Loss: 0.1418211 Vali Loss: 0.0314773 Test Loss: 0.1086092
Validation loss decreased (0.031576 --> 0.031477).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1667314
	speed: 0.0549s/iter; left time: 307.6505s
	iters: 200, epoch: 11 | loss: 0.1504445
	speed: 0.0180s/iter; left time: 99.0150s
	iters: 300, epoch: 11 | loss: 0.0979148
	speed: 0.0180s/iter; left time: 97.1055s
	iters: 400, epoch: 11 | loss: 0.1896027
	speed: 0.0180s/iter; left time: 95.4231s
	iters: 500, epoch: 11 | loss: 0.1528782
	speed: 0.0180s/iter; left time: 93.4788s
Epoch: 11 cost time: 10.549809455871582
Epoch: 11, Steps: 570 | Train Loss: 0.1422501 Vali Loss: 0.0314800 Test Loss: 0.1087285
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.2022423
	speed: 0.0536s/iter; left time: 269.6273s
	iters: 200, epoch: 12 | loss: 0.1185478
	speed: 0.0182s/iter; left time: 89.5249s
	iters: 300, epoch: 12 | loss: 0.1091764
	speed: 0.0182s/iter; left time: 87.7708s
	iters: 400, epoch: 12 | loss: 0.1353031
	speed: 0.0181s/iter; left time: 85.8485s
	iters: 500, epoch: 12 | loss: 0.1228820
	speed: 0.0181s/iter; left time: 84.0007s
Epoch: 12 cost time: 10.594048261642456
Epoch: 12, Steps: 570 | Train Loss: 0.1413633 Vali Loss: 0.0314925 Test Loss: 0.1086841
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1029874
	speed: 0.0550s/iter; left time: 245.2889s
	iters: 200, epoch: 13 | loss: 0.1877407
	speed: 0.0181s/iter; left time: 79.0683s
	iters: 300, epoch: 13 | loss: 0.1127381
	speed: 0.0181s/iter; left time: 77.2608s
	iters: 400, epoch: 13 | loss: 0.1529693
	speed: 0.0181s/iter; left time: 75.3792s
	iters: 500, epoch: 13 | loss: 0.2063544
	speed: 0.0181s/iter; left time: 73.4564s
Epoch: 13 cost time: 10.583086490631104
Epoch: 13, Steps: 570 | Train Loss: 0.1428386 Vali Loss: 0.0315302 Test Loss: 0.1087153
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10876242071390152, mae:0.1961938887834549
>>> S LR=5e-4 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2281536
	speed: 0.0295s/iter; left time: 333.7524s
	iters: 200, epoch: 1 | loss: 0.2097761
	speed: 0.0180s/iter; left time: 201.7314s
	iters: 300, epoch: 1 | loss: 0.2845032
	speed: 0.0180s/iter; left time: 199.8085s
	iters: 400, epoch: 1 | loss: 0.2774512
	speed: 0.0180s/iter; left time: 198.3798s
	iters: 500, epoch: 1 | loss: 0.3421100
	speed: 0.0180s/iter; left time: 196.5856s
Epoch: 1 cost time: 11.471513748168945
Epoch: 1, Steps: 570 | Train Loss: 0.2504597 Vali Loss: 0.0418187 Test Loss: 0.1395519
Validation loss decreased (inf --> 0.041819).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2986240
	speed: 0.0584s/iter; left time: 627.2161s
	iters: 200, epoch: 2 | loss: 0.2984904
	speed: 0.0181s/iter; left time: 192.6607s
	iters: 300, epoch: 2 | loss: 0.4825895
	speed: 0.0181s/iter; left time: 190.3610s
	iters: 400, epoch: 2 | loss: 0.2185910
	speed: 0.0181s/iter; left time: 188.2841s
	iters: 500, epoch: 2 | loss: 0.1420698
	speed: 0.0182s/iter; left time: 188.2638s
Epoch: 2 cost time: 10.77426791191101
Epoch: 2, Steps: 570 | Train Loss: 0.2216637 Vali Loss: 0.0526360 Test Loss: 0.1497900
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1348850
	speed: 0.0542s/iter; left time: 550.5450s
	iters: 200, epoch: 3 | loss: 0.1964391
	speed: 0.0183s/iter; left time: 183.9745s
	iters: 300, epoch: 3 | loss: 0.1917905
	speed: 0.0183s/iter; left time: 181.9828s
	iters: 400, epoch: 3 | loss: 0.2360724
	speed: 0.0182s/iter; left time: 179.9463s
	iters: 500, epoch: 3 | loss: 0.1890624
	speed: 0.0182s/iter; left time: 177.6947s
Epoch: 3 cost time: 10.653560638427734
Epoch: 3, Steps: 570 | Train Loss: 0.1956609 Vali Loss: 0.0449945 Test Loss: 0.1468559
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1296717
	speed: 0.0536s/iter; left time: 514.1784s
	iters: 200, epoch: 4 | loss: 0.1851075
	speed: 0.0183s/iter; left time: 173.2529s
	iters: 300, epoch: 4 | loss: 0.1538681
	speed: 0.0183s/iter; left time: 171.6241s
	iters: 400, epoch: 4 | loss: 0.2101029
	speed: 0.0183s/iter; left time: 169.6949s
	iters: 500, epoch: 4 | loss: 0.1307343
	speed: 0.0182s/iter; left time: 167.7267s
Epoch: 4 cost time: 10.637224435806274
Epoch: 4, Steps: 570 | Train Loss: 0.1784007 Vali Loss: 0.0422781 Test Loss: 0.1463525
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13968288898468018, mae:0.23371447622776031
>>> S LR=5e-4 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2226228
	speed: 0.0359s/iter; left time: 405.1922s
	iters: 200, epoch: 1 | loss: 0.2125477
	speed: 0.0238s/iter; left time: 266.7787s
	iters: 300, epoch: 1 | loss: 0.2480480
	speed: 0.0239s/iter; left time: 265.0475s
	iters: 400, epoch: 1 | loss: 0.3143064
	speed: 0.0238s/iter; left time: 262.1300s
	iters: 500, epoch: 1 | loss: 0.1841216
	speed: 0.0238s/iter; left time: 259.8775s
Epoch: 1 cost time: 14.842729091644287
Epoch: 1, Steps: 570 | Train Loss: 0.2600948 Vali Loss: 0.0480289 Test Loss: 0.1574094
Validation loss decreased (inf --> 0.048029).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3123896
	speed: 0.0638s/iter; left time: 684.7918s
	iters: 200, epoch: 2 | loss: 0.2126114
	speed: 0.0218s/iter; left time: 231.7956s
	iters: 300, epoch: 2 | loss: 0.2114945
	speed: 0.0218s/iter; left time: 229.6522s
	iters: 400, epoch: 2 | loss: 0.2496100
	speed: 0.0218s/iter; left time: 227.1509s
	iters: 500, epoch: 2 | loss: 0.3074192
	speed: 0.0218s/iter; left time: 224.9963s
Epoch: 2 cost time: 12.694525480270386
Epoch: 2, Steps: 570 | Train Loss: 0.2639152 Vali Loss: 0.0619291 Test Loss: 0.1833043
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.5163190
	speed: 0.0601s/iter; left time: 611.1557s
	iters: 200, epoch: 3 | loss: 0.2050310
	speed: 0.0219s/iter; left time: 220.4248s
	iters: 300, epoch: 3 | loss: 0.3206907
	speed: 0.0219s/iter; left time: 218.2116s
	iters: 400, epoch: 3 | loss: 0.2219967
	speed: 0.0219s/iter; left time: 216.0218s
	iters: 500, epoch: 3 | loss: 0.1994741
	speed: 0.0219s/iter; left time: 213.7948s
Epoch: 3 cost time: 12.75937557220459
Epoch: 3, Steps: 570 | Train Loss: 0.2729782 Vali Loss: 0.0568226 Test Loss: 0.1666890
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2320173
	speed: 0.0616s/iter; left time: 590.5069s
	iters: 200, epoch: 4 | loss: 0.1633427
	speed: 0.0235s/iter; left time: 222.9681s
	iters: 300, epoch: 4 | loss: 0.2455606
	speed: 0.0238s/iter; left time: 223.4750s
	iters: 400, epoch: 4 | loss: 0.1879332
	speed: 0.0238s/iter; left time: 221.1700s
	iters: 500, epoch: 4 | loss: 0.3540880
	speed: 0.0238s/iter; left time: 218.7477s
Epoch: 4 cost time: 13.69115161895752
Epoch: 4, Steps: 570 | Train Loss: 0.2587001 Vali Loss: 0.0559057 Test Loss: 0.1652683
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15755456686019897, mae:0.24693366885185242
>>> S LR=5e-4 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2566539
	speed: 0.0327s/iter; left time: 369.4198s
	iters: 200, epoch: 1 | loss: 0.1245922
	speed: 0.0210s/iter; left time: 235.2519s
	iters: 300, epoch: 1 | loss: 0.2062434
	speed: 0.0210s/iter; left time: 233.0713s
	iters: 400, epoch: 1 | loss: 0.2022801
	speed: 0.0210s/iter; left time: 231.1700s
	iters: 500, epoch: 1 | loss: 0.2216583
	speed: 0.0211s/iter; left time: 230.0203s
Epoch: 1 cost time: 13.2077054977417
Epoch: 1, Steps: 570 | Train Loss: 0.2364131 Vali Loss: 0.0432634 Test Loss: 0.1390508
Validation loss decreased (inf --> 0.043263).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2225831
	speed: 0.0605s/iter; left time: 648.7413s
	iters: 200, epoch: 2 | loss: 0.1957682
	speed: 0.0210s/iter; left time: 223.6949s
	iters: 300, epoch: 2 | loss: 0.3233497
	speed: 0.0210s/iter; left time: 221.5454s
	iters: 400, epoch: 2 | loss: 0.2180419
	speed: 0.0211s/iter; left time: 219.6091s
	iters: 500, epoch: 2 | loss: 0.1574889
	speed: 0.0211s/iter; left time: 217.5758s
Epoch: 2 cost time: 12.29115629196167
Epoch: 2, Steps: 570 | Train Loss: 0.2254267 Vali Loss: 0.0455311 Test Loss: 0.1445376
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1756698
	speed: 0.0589s/iter; left time: 598.2076s
	iters: 200, epoch: 3 | loss: 0.1599749
	speed: 0.0210s/iter; left time: 211.4564s
	iters: 300, epoch: 3 | loss: 0.2273452
	speed: 0.0210s/iter; left time: 209.4432s
	iters: 400, epoch: 3 | loss: 0.1277257
	speed: 0.0210s/iter; left time: 207.4122s
	iters: 500, epoch: 3 | loss: 0.1510155
	speed: 0.0210s/iter; left time: 205.1195s
Epoch: 3 cost time: 12.229548931121826
Epoch: 3, Steps: 570 | Train Loss: 0.1985709 Vali Loss: 0.0376006 Test Loss: 0.1262942
Validation loss decreased (0.043263 --> 0.037601).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1475028
	speed: 0.0603s/iter; left time: 578.4037s
	iters: 200, epoch: 4 | loss: 0.1928827
	speed: 0.0211s/iter; left time: 200.0836s
	iters: 300, epoch: 4 | loss: 0.1944539
	speed: 0.0211s/iter; left time: 197.9124s
	iters: 400, epoch: 4 | loss: 0.2182504
	speed: 0.0211s/iter; left time: 195.7881s
	iters: 500, epoch: 4 | loss: 0.1719266
	speed: 0.0211s/iter; left time: 193.6236s
Epoch: 4 cost time: 12.305853843688965
Epoch: 4, Steps: 570 | Train Loss: 0.1794186 Vali Loss: 0.0347199 Test Loss: 0.1200083
Validation loss decreased (0.037601 --> 0.034720).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2271110
	speed: 0.0624s/iter; left time: 563.3184s
	iters: 200, epoch: 5 | loss: 0.1257797
	speed: 0.0211s/iter; left time: 188.0722s
	iters: 300, epoch: 5 | loss: 0.2184319
	speed: 0.0211s/iter; left time: 185.7279s
	iters: 400, epoch: 5 | loss: 0.1829631
	speed: 0.0211s/iter; left time: 183.6254s
	iters: 500, epoch: 5 | loss: 0.1313426
	speed: 0.0211s/iter; left time: 181.7585s
Epoch: 5 cost time: 12.486249446868896
Epoch: 5, Steps: 570 | Train Loss: 0.1707579 Vali Loss: 0.0337250 Test Loss: 0.1164066
Validation loss decreased (0.034720 --> 0.033725).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1193808
	speed: 0.0621s/iter; left time: 524.4333s
	iters: 200, epoch: 6 | loss: 0.2332686
	speed: 0.0211s/iter; left time: 176.1672s
	iters: 300, epoch: 6 | loss: 0.1977576
	speed: 0.0211s/iter; left time: 174.1026s
	iters: 400, epoch: 6 | loss: 0.1245079
	speed: 0.0211s/iter; left time: 171.8550s
	iters: 500, epoch: 6 | loss: 0.1093338
	speed: 0.0211s/iter; left time: 169.9152s
Epoch: 6 cost time: 12.316285371780396
Epoch: 6, Steps: 570 | Train Loss: 0.1653718 Vali Loss: 0.0334391 Test Loss: 0.1147422
Validation loss decreased (0.033725 --> 0.033439).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1652948
	speed: 0.0608s/iter; left time: 478.8462s
	iters: 200, epoch: 7 | loss: 0.2140453
	speed: 0.0212s/iter; left time: 165.0335s
	iters: 300, epoch: 7 | loss: 0.2226426
	speed: 0.0212s/iter; left time: 162.6621s
	iters: 400, epoch: 7 | loss: 0.1157509
	speed: 0.0212s/iter; left time: 160.4866s
	iters: 500, epoch: 7 | loss: 0.1834091
	speed: 0.0229s/iter; left time: 171.0925s
Epoch: 7 cost time: 12.662419319152832
Epoch: 7, Steps: 570 | Train Loss: 0.1624544 Vali Loss: 0.0338500 Test Loss: 0.1138355
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1451087
	speed: 0.0609s/iter; left time: 445.6000s
	iters: 200, epoch: 8 | loss: 0.1436715
	speed: 0.0211s/iter; left time: 152.2738s
	iters: 300, epoch: 8 | loss: 0.1701593
	speed: 0.0211s/iter; left time: 150.0593s
	iters: 400, epoch: 8 | loss: 0.1513788
	speed: 0.0211s/iter; left time: 147.9418s
	iters: 500, epoch: 8 | loss: 0.2326320
	speed: 0.0211s/iter; left time: 145.7473s
Epoch: 8 cost time: 12.315754890441895
Epoch: 8, Steps: 570 | Train Loss: 0.1622898 Vali Loss: 0.0333302 Test Loss: 0.1134950
Validation loss decreased (0.033439 --> 0.033330).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1559870
	speed: 0.0605s/iter; left time: 407.5762s
	iters: 200, epoch: 9 | loss: 0.2256525
	speed: 0.0212s/iter; left time: 140.5706s
	iters: 300, epoch: 9 | loss: 0.1865801
	speed: 0.0211s/iter; left time: 138.1242s
	iters: 400, epoch: 9 | loss: 0.1403333
	speed: 0.0211s/iter; left time: 136.2041s
	iters: 500, epoch: 9 | loss: 0.1043014
	speed: 0.0211s/iter; left time: 133.9008s
Epoch: 9 cost time: 12.354827404022217
Epoch: 9, Steps: 570 | Train Loss: 0.1610142 Vali Loss: 0.0334366 Test Loss: 0.1138718
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1159376
	speed: 0.0599s/iter; left time: 369.7625s
	iters: 200, epoch: 10 | loss: 0.1629857
	speed: 0.0212s/iter; left time: 128.6023s
	iters: 300, epoch: 10 | loss: 0.1306373
	speed: 0.0212s/iter; left time: 126.4401s
	iters: 400, epoch: 10 | loss: 0.1565727
	speed: 0.0212s/iter; left time: 124.1869s
	iters: 500, epoch: 10 | loss: 0.1943619
	speed: 0.0212s/iter; left time: 122.1800s
Epoch: 10 cost time: 12.39794111251831
Epoch: 10, Steps: 570 | Train Loss: 0.1603001 Vali Loss: 0.0332855 Test Loss: 0.1136561
Validation loss decreased (0.033330 --> 0.033285).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1981763
	speed: 0.0609s/iter; left time: 341.2691s
	iters: 200, epoch: 11 | loss: 0.1392832
	speed: 0.0212s/iter; left time: 116.7662s
	iters: 300, epoch: 11 | loss: 0.1343999
	speed: 0.0212s/iter; left time: 114.5477s
	iters: 400, epoch: 11 | loss: 0.1137061
	speed: 0.0212s/iter; left time: 112.3661s
	iters: 500, epoch: 11 | loss: 0.1990767
	speed: 0.0212s/iter; left time: 110.0074s
Epoch: 11 cost time: 12.371909141540527
Epoch: 11, Steps: 570 | Train Loss: 0.1605636 Vali Loss: 0.0332199 Test Loss: 0.1136053
Validation loss decreased (0.033285 --> 0.033220).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1778486
	speed: 0.0611s/iter; left time: 307.2348s
	iters: 200, epoch: 12 | loss: 0.2259501
	speed: 0.0211s/iter; left time: 104.1118s
	iters: 300, epoch: 12 | loss: 0.1476602
	speed: 0.0211s/iter; left time: 101.9478s
	iters: 400, epoch: 12 | loss: 0.3084998
	speed: 0.0211s/iter; left time: 99.8414s
	iters: 500, epoch: 12 | loss: 0.1406449
	speed: 0.0211s/iter; left time: 97.7314s
Epoch: 12 cost time: 12.317495346069336
Epoch: 12, Steps: 570 | Train Loss: 0.1602300 Vali Loss: 0.0332581 Test Loss: 0.1135907
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1486788
	speed: 0.0602s/iter; left time: 268.5175s
	iters: 200, epoch: 13 | loss: 0.1690015
	speed: 0.0213s/iter; left time: 92.8599s
	iters: 300, epoch: 13 | loss: 0.2306039
	speed: 0.0213s/iter; left time: 90.6219s
	iters: 400, epoch: 13 | loss: 0.1481993
	speed: 0.0213s/iter; left time: 88.4939s
	iters: 500, epoch: 13 | loss: 0.1682790
	speed: 0.0213s/iter; left time: 86.4796s
Epoch: 13 cost time: 12.403874397277832
Epoch: 13, Steps: 570 | Train Loss: 0.1597520 Vali Loss: 0.0332894 Test Loss: 0.1135692
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1548859
	speed: 0.0609s/iter; left time: 237.0389s
	iters: 200, epoch: 14 | loss: 0.1525561
	speed: 0.0212s/iter; left time: 80.3309s
	iters: 300, epoch: 14 | loss: 0.1412465
	speed: 0.0212s/iter; left time: 78.1670s
	iters: 400, epoch: 14 | loss: 0.1412208
	speed: 0.0212s/iter; left time: 76.0940s
	iters: 500, epoch: 14 | loss: 0.1831586
	speed: 0.0212s/iter; left time: 73.8966s
Epoch: 14 cost time: 12.347657680511475
Epoch: 14, Steps: 570 | Train Loss: 0.1607713 Vali Loss: 0.0332368 Test Loss: 0.1135693
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11379200220108032, mae:0.20355165004730225
>>> S LR=5e-4 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2785723
	speed: 0.0342s/iter; left time: 386.4722s
	iters: 200, epoch: 1 | loss: 0.1921399
	speed: 0.0219s/iter; left time: 245.5943s
	iters: 300, epoch: 1 | loss: 0.2597032
	speed: 0.0223s/iter; left time: 247.0580s
	iters: 400, epoch: 1 | loss: 0.3486011
	speed: 0.0223s/iter; left time: 244.9078s
	iters: 500, epoch: 1 | loss: 0.2893318
	speed: 0.0203s/iter; left time: 221.3963s
Epoch: 1 cost time: 13.57301115989685
Epoch: 1, Steps: 570 | Train Loss: 0.2720667 Vali Loss: 0.0508620 Test Loss: 0.1643254
Validation loss decreased (inf --> 0.050862).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1519352
	speed: 0.0599s/iter; left time: 642.5017s
	iters: 200, epoch: 2 | loss: 0.3509484
	speed: 0.0203s/iter; left time: 215.5101s
	iters: 300, epoch: 2 | loss: 0.2014882
	speed: 0.0203s/iter; left time: 213.5001s
	iters: 400, epoch: 2 | loss: 0.1643377
	speed: 0.0202s/iter; left time: 211.0476s
	iters: 500, epoch: 2 | loss: 0.2054745
	speed: 0.0202s/iter; left time: 208.7283s
Epoch: 2 cost time: 11.853280782699585
Epoch: 2, Steps: 570 | Train Loss: 0.2506685 Vali Loss: 0.0595456 Test Loss: 0.1846568
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1978940
	speed: 0.0592s/iter; left time: 601.3691s
	iters: 200, epoch: 3 | loss: 0.2030520
	speed: 0.0202s/iter; left time: 203.7036s
	iters: 300, epoch: 3 | loss: 0.1993396
	speed: 0.0203s/iter; left time: 201.8128s
	iters: 400, epoch: 3 | loss: 0.2456604
	speed: 0.0203s/iter; left time: 199.7016s
	iters: 500, epoch: 3 | loss: 0.2187476
	speed: 0.0202s/iter; left time: 197.5536s
Epoch: 3 cost time: 11.821781635284424
Epoch: 3, Steps: 570 | Train Loss: 0.2416597 Vali Loss: 0.0491925 Test Loss: 0.1655204
Validation loss decreased (0.050862 --> 0.049193).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1986958
	speed: 0.0618s/iter; left time: 592.3083s
	iters: 200, epoch: 4 | loss: 0.2960092
	speed: 0.0204s/iter; left time: 193.3287s
	iters: 300, epoch: 4 | loss: 0.1505438
	speed: 0.0203s/iter; left time: 190.4514s
	iters: 400, epoch: 4 | loss: 0.2486758
	speed: 0.0203s/iter; left time: 188.4749s
	iters: 500, epoch: 4 | loss: 0.2369038
	speed: 0.0204s/iter; left time: 187.3210s
Epoch: 4 cost time: 11.901076078414917
Epoch: 4, Steps: 570 | Train Loss: 0.2170803 Vali Loss: 0.0434961 Test Loss: 0.1504641
Validation loss decreased (0.049193 --> 0.043496).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1808418
	speed: 0.0638s/iter; left time: 575.1177s
	iters: 200, epoch: 5 | loss: 0.3033161
	speed: 0.0214s/iter; left time: 190.4659s
	iters: 300, epoch: 5 | loss: 0.2061118
	speed: 0.0203s/iter; left time: 178.7840s
	iters: 400, epoch: 5 | loss: 0.1633170
	speed: 0.0202s/iter; left time: 176.5755s
	iters: 500, epoch: 5 | loss: 0.1612096
	speed: 0.0203s/iter; left time: 174.7252s
Epoch: 5 cost time: 12.004498720169067
Epoch: 5, Steps: 570 | Train Loss: 0.2046678 Vali Loss: 0.0412646 Test Loss: 0.1425973
Validation loss decreased (0.043496 --> 0.041265).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2186451
	speed: 0.0606s/iter; left time: 512.5421s
	iters: 200, epoch: 6 | loss: 0.2232502
	speed: 0.0204s/iter; left time: 170.0519s
	iters: 300, epoch: 6 | loss: 0.1702347
	speed: 0.0203s/iter; left time: 167.2523s
	iters: 400, epoch: 6 | loss: 0.1301622
	speed: 0.0202s/iter; left time: 164.9986s
	iters: 500, epoch: 6 | loss: 0.2991161
	speed: 0.0202s/iter; left time: 162.7375s
Epoch: 6 cost time: 11.88091516494751
Epoch: 6, Steps: 570 | Train Loss: 0.1973558 Vali Loss: 0.0427427 Test Loss: 0.1396047
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2542164
	speed: 0.0593s/iter; left time: 467.3467s
	iters: 200, epoch: 7 | loss: 0.1945430
	speed: 0.0203s/iter; left time: 158.1857s
	iters: 300, epoch: 7 | loss: 0.2410037
	speed: 0.0203s/iter; left time: 156.1020s
	iters: 400, epoch: 7 | loss: 0.2642780
	speed: 0.0203s/iter; left time: 153.9725s
	iters: 500, epoch: 7 | loss: 0.1957774
	speed: 0.0203s/iter; left time: 151.9080s
Epoch: 7 cost time: 11.87338399887085
Epoch: 7, Steps: 570 | Train Loss: 0.1957441 Vali Loss: 0.0410006 Test Loss: 0.1377689
Validation loss decreased (0.041265 --> 0.041001).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.3068765
	speed: 0.0626s/iter; left time: 457.9796s
	iters: 200, epoch: 8 | loss: 0.2614260
	speed: 0.0204s/iter; left time: 147.0202s
	iters: 300, epoch: 8 | loss: 0.2810538
	speed: 0.0204s/iter; left time: 145.0418s
	iters: 400, epoch: 8 | loss: 0.1569218
	speed: 0.0204s/iter; left time: 142.8773s
	iters: 500, epoch: 8 | loss: 0.2196659
	speed: 0.0204s/iter; left time: 140.8824s
Epoch: 8 cost time: 11.939032793045044
Epoch: 8, Steps: 570 | Train Loss: 0.1931484 Vali Loss: 0.0406208 Test Loss: 0.1368923
Validation loss decreased (0.041001 --> 0.040621).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1863254
	speed: 0.0631s/iter; left time: 425.6731s
	iters: 200, epoch: 9 | loss: 0.1601709
	speed: 0.0202s/iter; left time: 134.0124s
	iters: 300, epoch: 9 | loss: 0.2391758
	speed: 0.0202s/iter; left time: 132.0241s
	iters: 400, epoch: 9 | loss: 0.1512734
	speed: 0.0202s/iter; left time: 129.9191s
	iters: 500, epoch: 9 | loss: 0.1400331
	speed: 0.0202s/iter; left time: 127.9910s
Epoch: 9 cost time: 11.836568355560303
Epoch: 9, Steps: 570 | Train Loss: 0.1909601 Vali Loss: 0.0404895 Test Loss: 0.1366577
Validation loss decreased (0.040621 --> 0.040490).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1864387
	speed: 0.0635s/iter; left time: 391.8969s
	iters: 200, epoch: 10 | loss: 0.1603970
	speed: 0.0224s/iter; left time: 136.1228s
	iters: 300, epoch: 10 | loss: 0.3640327
	speed: 0.0224s/iter; left time: 134.0062s
	iters: 400, epoch: 10 | loss: 0.2589222
	speed: 0.0223s/iter; left time: 130.9809s
	iters: 500, epoch: 10 | loss: 0.1839017
	speed: 0.0224s/iter; left time: 129.1702s
Epoch: 10 cost time: 13.06278109550476
Epoch: 10, Steps: 570 | Train Loss: 0.1907274 Vali Loss: 0.0405710 Test Loss: 0.1366405
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1536764
	speed: 0.0608s/iter; left time: 340.4841s
	iters: 200, epoch: 11 | loss: 0.1914997
	speed: 0.0203s/iter; left time: 111.6590s
	iters: 300, epoch: 11 | loss: 0.1716054
	speed: 0.0203s/iter; left time: 109.7536s
	iters: 400, epoch: 11 | loss: 0.2418479
	speed: 0.0203s/iter; left time: 107.6135s
	iters: 500, epoch: 11 | loss: 0.1371020
	speed: 0.0203s/iter; left time: 105.6157s
Epoch: 11 cost time: 11.891442060470581
Epoch: 11, Steps: 570 | Train Loss: 0.1920242 Vali Loss: 0.0406026 Test Loss: 0.1367934
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1620500
	speed: 0.0595s/iter; left time: 299.3802s
	iters: 200, epoch: 12 | loss: 0.1834520
	speed: 0.0202s/iter; left time: 99.4875s
	iters: 300, epoch: 12 | loss: 0.2701971
	speed: 0.0202s/iter; left time: 97.5619s
	iters: 400, epoch: 12 | loss: 0.1678637
	speed: 0.0202s/iter; left time: 95.3698s
	iters: 500, epoch: 12 | loss: 0.2864335
	speed: 0.0202s/iter; left time: 93.6143s
Epoch: 12 cost time: 11.843122482299805
Epoch: 12, Steps: 570 | Train Loss: 0.1902504 Vali Loss: 0.0404511 Test Loss: 0.1368661
Validation loss decreased (0.040490 --> 0.040451).  Saving model ...
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1836603
	speed: 0.0617s/iter; left time: 275.1044s
	iters: 200, epoch: 13 | loss: 0.1561827
	speed: 0.0204s/iter; left time: 88.8949s
	iters: 300, epoch: 13 | loss: 0.1430430
	speed: 0.0203s/iter; left time: 86.6576s
	iters: 400, epoch: 13 | loss: 0.1126068
	speed: 0.0204s/iter; left time: 84.7711s
	iters: 500, epoch: 13 | loss: 0.2230947
	speed: 0.0204s/iter; left time: 82.7152s
Epoch: 13 cost time: 11.92607569694519
Epoch: 13, Steps: 570 | Train Loss: 0.1903940 Vali Loss: 0.0404945 Test Loss: 0.1368427
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.2414682
	speed: 0.0607s/iter; left time: 236.2532s
	iters: 200, epoch: 14 | loss: 0.1673111
	speed: 0.0203s/iter; left time: 76.8723s
	iters: 300, epoch: 14 | loss: 0.1689683
	speed: 0.0203s/iter; left time: 74.9163s
	iters: 400, epoch: 14 | loss: 0.1259798
	speed: 0.0203s/iter; left time: 72.7295s
	iters: 500, epoch: 14 | loss: 0.1689760
	speed: 0.0203s/iter; left time: 70.8077s
Epoch: 14 cost time: 11.885411500930786
Epoch: 14, Steps: 570 | Train Loss: 0.1887200 Vali Loss: 0.0405117 Test Loss: 0.1368466
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1154020
	speed: 0.0628s/iter; left time: 208.6623s
	iters: 200, epoch: 15 | loss: 0.1926786
	speed: 0.0203s/iter; left time: 65.3183s
	iters: 300, epoch: 15 | loss: 0.1878429
	speed: 0.0203s/iter; left time: 63.3633s
	iters: 400, epoch: 15 | loss: 0.1667622
	speed: 0.0204s/iter; left time: 61.6039s
	iters: 500, epoch: 15 | loss: 0.1606423
	speed: 0.0202s/iter; left time: 59.1301s
Epoch: 15 cost time: 11.965455532073975
Epoch: 15, Steps: 570 | Train Loss: 0.1912055 Vali Loss: 0.0405028 Test Loss: 0.1368291
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1370014101266861, mae:0.23253858089447021
>>> S LR=1e-4 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1593207
	speed: 0.0212s/iter; left time: 240.1254s
	iters: 200, epoch: 1 | loss: 0.1500541
	speed: 0.0098s/iter; left time: 110.2287s
	iters: 300, epoch: 1 | loss: 0.1775667
	speed: 0.0098s/iter; left time: 109.2133s
	iters: 400, epoch: 1 | loss: 0.1989995
	speed: 0.0098s/iter; left time: 108.1293s
	iters: 500, epoch: 1 | loss: 0.1197055
	speed: 0.0099s/iter; left time: 107.5395s
Epoch: 1 cost time: 6.7997870445251465
Epoch: 1, Steps: 570 | Train Loss: 0.1755723 Vali Loss: 0.0490710 Test Loss: 0.1383416
Validation loss decreased (inf --> 0.049071).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1877120
	speed: 0.0352s/iter; left time: 377.5670s
	iters: 200, epoch: 2 | loss: 0.2138081
	speed: 0.0098s/iter; left time: 104.1276s
	iters: 300, epoch: 2 | loss: 0.0935228
	speed: 0.0098s/iter; left time: 103.1175s
	iters: 400, epoch: 2 | loss: 0.1146206
	speed: 0.0098s/iter; left time: 102.1681s
	iters: 500, epoch: 2 | loss: 0.1197210
	speed: 0.0098s/iter; left time: 101.2249s
Epoch: 2 cost time: 5.893084764480591
Epoch: 2, Steps: 570 | Train Loss: 0.1354987 Vali Loss: 0.0415615 Test Loss: 0.1237821
Validation loss decreased (0.049071 --> 0.041562).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0779078
	speed: 0.0367s/iter; left time: 373.3952s
	iters: 200, epoch: 3 | loss: 0.1360189
	speed: 0.0099s/iter; left time: 99.9555s
	iters: 300, epoch: 3 | loss: 0.1192735
	speed: 0.0099s/iter; left time: 98.6730s
	iters: 400, epoch: 3 | loss: 0.1238399
	speed: 0.0098s/iter; left time: 97.1150s
	iters: 500, epoch: 3 | loss: 0.1697780
	speed: 0.0099s/iter; left time: 96.2406s
Epoch: 3 cost time: 5.923243761062622
Epoch: 3, Steps: 570 | Train Loss: 0.1151923 Vali Loss: 0.0354938 Test Loss: 0.1364579
Validation loss decreased (0.041562 --> 0.035494).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1223904
	speed: 0.0346s/iter; left time: 331.9206s
	iters: 200, epoch: 4 | loss: 0.0682706
	speed: 0.0099s/iter; left time: 93.5437s
	iters: 300, epoch: 4 | loss: 0.0919898
	speed: 0.0099s/iter; left time: 92.6757s
	iters: 400, epoch: 4 | loss: 0.1102782
	speed: 0.0099s/iter; left time: 91.6733s
	iters: 500, epoch: 4 | loss: 0.0843490
	speed: 0.0098s/iter; left time: 90.3833s
Epoch: 4 cost time: 5.875159502029419
Epoch: 4, Steps: 570 | Train Loss: 0.1049406 Vali Loss: 0.0361618 Test Loss: 0.1463981
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0981885
	speed: 0.0348s/iter; left time: 313.9456s
	iters: 200, epoch: 5 | loss: 0.1043760
	speed: 0.0099s/iter; left time: 88.2454s
	iters: 300, epoch: 5 | loss: 0.0781021
	speed: 0.0099s/iter; left time: 87.3739s
	iters: 400, epoch: 5 | loss: 0.1062276
	speed: 0.0099s/iter; left time: 86.6823s
	iters: 500, epoch: 5 | loss: 0.1022661
	speed: 0.0099s/iter; left time: 85.4746s
Epoch: 5 cost time: 5.9195556640625
Epoch: 5, Steps: 570 | Train Loss: 0.0992090 Vali Loss: 0.0357772 Test Loss: 0.1445200
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0784157
	speed: 0.0346s/iter; left time: 292.3694s
	iters: 200, epoch: 6 | loss: 0.0605744
	speed: 0.0099s/iter; left time: 82.7396s
	iters: 300, epoch: 6 | loss: 0.0855181
	speed: 0.0099s/iter; left time: 81.7926s
	iters: 400, epoch: 6 | loss: 0.1078004
	speed: 0.0099s/iter; left time: 80.7063s
	iters: 500, epoch: 6 | loss: 0.0964364
	speed: 0.0099s/iter; left time: 79.7648s
Epoch: 6 cost time: 5.921599864959717
Epoch: 6, Steps: 570 | Train Loss: 0.0958232 Vali Loss: 0.0360062 Test Loss: 0.1466109
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13665613532066345, mae:0.23105916380882263
>>> S LR=1e-4 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1327102
	speed: 0.0230s/iter; left time: 260.3514s
	iters: 200, epoch: 1 | loss: 0.1394703
	speed: 0.0108s/iter; left time: 120.5790s
	iters: 300, epoch: 1 | loss: 0.1648735
	speed: 0.0108s/iter; left time: 119.6783s
	iters: 400, epoch: 1 | loss: 0.1279488
	speed: 0.0108s/iter; left time: 118.4789s
	iters: 500, epoch: 1 | loss: 0.1331011
	speed: 0.0108s/iter; left time: 118.1176s
Epoch: 1 cost time: 7.418417692184448
Epoch: 1, Steps: 570 | Train Loss: 0.1423769 Vali Loss: 0.0325439 Test Loss: 0.1097558
Validation loss decreased (inf --> 0.032544).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1161822
	speed: 0.0356s/iter; left time: 382.1763s
	iters: 200, epoch: 2 | loss: 0.1219371
	speed: 0.0096s/iter; left time: 102.4792s
	iters: 300, epoch: 2 | loss: 0.0658379
	speed: 0.0097s/iter; left time: 102.0611s
	iters: 400, epoch: 2 | loss: 0.0768527
	speed: 0.0097s/iter; left time: 101.4130s
	iters: 500, epoch: 2 | loss: 0.1011366
	speed: 0.0097s/iter; left time: 100.4048s
Epoch: 2 cost time: 5.848196268081665
Epoch: 2, Steps: 570 | Train Loss: 0.1116107 Vali Loss: 0.0316571 Test Loss: 0.1122794
Validation loss decreased (0.032544 --> 0.031657).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0613190
	speed: 0.0348s/iter; left time: 353.7633s
	iters: 200, epoch: 3 | loss: 0.1100741
	speed: 0.0096s/iter; left time: 97.0458s
	iters: 300, epoch: 3 | loss: 0.2069205
	speed: 0.0097s/iter; left time: 96.2392s
	iters: 400, epoch: 3 | loss: 0.1207236
	speed: 0.0097s/iter; left time: 95.3455s
	iters: 500, epoch: 3 | loss: 0.0725500
	speed: 0.0096s/iter; left time: 94.1788s
Epoch: 3 cost time: 5.792365550994873
Epoch: 3, Steps: 570 | Train Loss: 0.0981418 Vali Loss: 0.0311044 Test Loss: 0.1095368
Validation loss decreased (0.031657 --> 0.031104).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0576040
	speed: 0.0348s/iter; left time: 333.5384s
	iters: 200, epoch: 4 | loss: 0.0845212
	speed: 0.0096s/iter; left time: 91.2297s
	iters: 300, epoch: 4 | loss: 0.0682937
	speed: 0.0096s/iter; left time: 90.2049s
	iters: 400, epoch: 4 | loss: 0.0604067
	speed: 0.0096s/iter; left time: 89.1158s
	iters: 500, epoch: 4 | loss: 0.1002143
	speed: 0.0096s/iter; left time: 87.9312s
Epoch: 4 cost time: 5.759439945220947
Epoch: 4, Steps: 570 | Train Loss: 0.0898075 Vali Loss: 0.0303962 Test Loss: 0.1093715
Validation loss decreased (0.031104 --> 0.030396).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0987472
	speed: 0.0350s/iter; left time: 316.0498s
	iters: 200, epoch: 5 | loss: 0.1250267
	speed: 0.0096s/iter; left time: 85.2031s
	iters: 300, epoch: 5 | loss: 0.1011933
	speed: 0.0096s/iter; left time: 84.3550s
	iters: 400, epoch: 5 | loss: 0.0959901
	speed: 0.0096s/iter; left time: 83.6911s
	iters: 500, epoch: 5 | loss: 0.1044139
	speed: 0.0096s/iter; left time: 82.4285s
Epoch: 5 cost time: 5.758755683898926
Epoch: 5, Steps: 570 | Train Loss: 0.0849783 Vali Loss: 0.0310978 Test Loss: 0.1116060
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0514461
	speed: 0.0339s/iter; left time: 286.2119s
	iters: 200, epoch: 6 | loss: 0.1034246
	speed: 0.0095s/iter; left time: 79.7029s
	iters: 300, epoch: 6 | loss: 0.0988954
	speed: 0.0095s/iter; left time: 78.6664s
	iters: 400, epoch: 6 | loss: 0.0724485
	speed: 0.0095s/iter; left time: 77.7421s
	iters: 500, epoch: 6 | loss: 0.0686495
	speed: 0.0095s/iter; left time: 76.7756s
Epoch: 6 cost time: 5.699167490005493
Epoch: 6, Steps: 570 | Train Loss: 0.0822388 Vali Loss: 0.0310465 Test Loss: 0.1108814
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0680284
	speed: 0.0351s/iter; left time: 276.8077s
	iters: 200, epoch: 7 | loss: 0.0913032
	speed: 0.0096s/iter; left time: 75.0812s
	iters: 300, epoch: 7 | loss: 0.1745010
	speed: 0.0096s/iter; left time: 73.9262s
	iters: 400, epoch: 7 | loss: 0.1444204
	speed: 0.0096s/iter; left time: 72.9825s
	iters: 500, epoch: 7 | loss: 0.1018340
	speed: 0.0096s/iter; left time: 72.0201s
Epoch: 7 cost time: 5.77815842628479
Epoch: 7, Steps: 570 | Train Loss: 0.0808338 Vali Loss: 0.0304291 Test Loss: 0.1109060
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.109514020383358, mae:0.20058484375476837
>>> S LR=1e-4 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1672456
	speed: 0.0225s/iter; left time: 254.5378s
	iters: 200, epoch: 1 | loss: 0.1359976
	speed: 0.0108s/iter; left time: 120.6800s
	iters: 300, epoch: 1 | loss: 0.1342292
	speed: 0.0108s/iter; left time: 119.9504s
	iters: 400, epoch: 1 | loss: 0.0906227
	speed: 0.0108s/iter; left time: 118.4753s
	iters: 500, epoch: 1 | loss: 0.1570622
	speed: 0.0102s/iter; left time: 111.1161s
Epoch: 1 cost time: 7.229238986968994
Epoch: 1, Steps: 570 | Train Loss: 0.1814949 Vali Loss: 0.0428156 Test Loss: 0.1327374
Validation loss decreased (inf --> 0.042816).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1544021
	speed: 0.0345s/iter; left time: 369.9617s
	iters: 200, epoch: 2 | loss: 0.1787537
	speed: 0.0097s/iter; left time: 103.5187s
	iters: 300, epoch: 2 | loss: 0.1594902
	speed: 0.0096s/iter; left time: 101.5454s
	iters: 400, epoch: 2 | loss: 0.1847309
	speed: 0.0097s/iter; left time: 101.0032s
	iters: 500, epoch: 2 | loss: 0.1905114
	speed: 0.0097s/iter; left time: 99.9318s
Epoch: 2 cost time: 5.823822498321533
Epoch: 2, Steps: 570 | Train Loss: 0.1431680 Vali Loss: 0.0398235 Test Loss: 0.1325759
Validation loss decreased (0.042816 --> 0.039823).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1025933
	speed: 0.0357s/iter; left time: 363.0340s
	iters: 200, epoch: 3 | loss: 0.0795276
	speed: 0.0097s/iter; left time: 97.3487s
	iters: 300, epoch: 3 | loss: 0.1616498
	speed: 0.0097s/iter; left time: 96.3958s
	iters: 400, epoch: 3 | loss: 0.0996337
	speed: 0.0096s/iter; left time: 95.0107s
	iters: 500, epoch: 3 | loss: 0.0851685
	speed: 0.0107s/iter; left time: 104.7487s
Epoch: 3 cost time: 6.030290126800537
Epoch: 3, Steps: 570 | Train Loss: 0.1259437 Vali Loss: 0.0403554 Test Loss: 0.1383426
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0748212
	speed: 0.0371s/iter; left time: 356.1232s
	iters: 200, epoch: 4 | loss: 0.0859461
	speed: 0.0111s/iter; left time: 105.0146s
	iters: 300, epoch: 4 | loss: 0.0774421
	speed: 0.0111s/iter; left time: 104.3333s
	iters: 400, epoch: 4 | loss: 0.1428894
	speed: 0.0111s/iter; left time: 103.4875s
	iters: 500, epoch: 4 | loss: 0.1009284
	speed: 0.0111s/iter; left time: 102.1420s
Epoch: 4 cost time: 6.598183631896973
Epoch: 4, Steps: 570 | Train Loss: 0.1162838 Vali Loss: 0.0396749 Test Loss: 0.1442756
Validation loss decreased (0.039823 --> 0.039675).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0925447
	speed: 0.0390s/iter; left time: 351.7608s
	iters: 200, epoch: 5 | loss: 0.0617825
	speed: 0.0112s/iter; left time: 99.7907s
	iters: 300, epoch: 5 | loss: 0.1109276
	speed: 0.0112s/iter; left time: 98.5942s
	iters: 400, epoch: 5 | loss: 0.0869883
	speed: 0.0102s/iter; left time: 88.5861s
	iters: 500, epoch: 5 | loss: 0.1530383
	speed: 0.0106s/iter; left time: 91.2684s
Epoch: 5 cost time: 6.5172951221466064
Epoch: 5, Steps: 570 | Train Loss: 0.1102999 Vali Loss: 0.0392550 Test Loss: 0.1405176
Validation loss decreased (0.039675 --> 0.039255).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1001350
	speed: 0.0379s/iter; left time: 320.2601s
	iters: 200, epoch: 6 | loss: 0.1280200
	speed: 0.0096s/iter; left time: 80.0876s
	iters: 300, epoch: 6 | loss: 0.0853882
	speed: 0.0096s/iter; left time: 79.2831s
	iters: 400, epoch: 6 | loss: 0.0750415
	speed: 0.0096s/iter; left time: 78.4332s
	iters: 500, epoch: 6 | loss: 0.1430968
	speed: 0.0096s/iter; left time: 77.1015s
Epoch: 6 cost time: 5.906348705291748
Epoch: 6, Steps: 570 | Train Loss: 0.1066861 Vali Loss: 0.0393122 Test Loss: 0.1441558
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0590051
	speed: 0.0369s/iter; left time: 290.9464s
	iters: 200, epoch: 7 | loss: 0.1328627
	speed: 0.0097s/iter; left time: 75.1750s
	iters: 300, epoch: 7 | loss: 0.0835869
	speed: 0.0097s/iter; left time: 74.1680s
	iters: 400, epoch: 7 | loss: 0.0565334
	speed: 0.0096s/iter; left time: 73.1243s
	iters: 500, epoch: 7 | loss: 0.1417052
	speed: 0.0097s/iter; left time: 72.2953s
Epoch: 7 cost time: 5.83897852897644
Epoch: 7, Steps: 570 | Train Loss: 0.1047520 Vali Loss: 0.0390350 Test Loss: 0.1440088
Validation loss decreased (0.039255 --> 0.039035).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0940358
	speed: 0.0361s/iter; left time: 264.2925s
	iters: 200, epoch: 8 | loss: 0.1182816
	speed: 0.0097s/iter; left time: 69.5948s
	iters: 300, epoch: 8 | loss: 0.0673273
	speed: 0.0097s/iter; left time: 68.8562s
	iters: 400, epoch: 8 | loss: 0.1263992
	speed: 0.0097s/iter; left time: 68.0465s
	iters: 500, epoch: 8 | loss: 0.1114846
	speed: 0.0097s/iter; left time: 66.8665s
Epoch: 8 cost time: 5.870511293411255
Epoch: 8, Steps: 570 | Train Loss: 0.1037285 Vali Loss: 0.0394032 Test Loss: 0.1438540
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0898924
	speed: 0.0347s/iter; left time: 233.8814s
	iters: 200, epoch: 9 | loss: 0.1274884
	speed: 0.0097s/iter; left time: 64.1105s
	iters: 300, epoch: 9 | loss: 0.1179100
	speed: 0.0096s/iter; left time: 63.1000s
	iters: 400, epoch: 9 | loss: 0.0917982
	speed: 0.0096s/iter; left time: 61.9201s
	iters: 500, epoch: 9 | loss: 0.1066088
	speed: 0.0096s/iter; left time: 60.9219s
Epoch: 9 cost time: 5.765104532241821
Epoch: 9, Steps: 570 | Train Loss: 0.1032674 Vali Loss: 0.0393681 Test Loss: 0.1447984
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0892554
	speed: 0.0349s/iter; left time: 215.1171s
	iters: 200, epoch: 10 | loss: 0.1108361
	speed: 0.0096s/iter; left time: 58.5717s
	iters: 300, epoch: 10 | loss: 0.1262196
	speed: 0.0097s/iter; left time: 57.6909s
	iters: 400, epoch: 10 | loss: 0.1417519
	speed: 0.0097s/iter; left time: 56.6672s
	iters: 500, epoch: 10 | loss: 0.1260939
	speed: 0.0097s/iter; left time: 55.7947s
Epoch: 10 cost time: 5.810313940048218
Epoch: 10, Steps: 570 | Train Loss: 0.1031286 Vali Loss: 0.0392773 Test Loss: 0.1446709
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14421972632408142, mae:0.24114933609962463
>>> S LR=1e-4 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1795451
	speed: 0.0233s/iter; left time: 263.6702s
	iters: 200, epoch: 1 | loss: 0.1872657
	speed: 0.0113s/iter; left time: 126.9686s
	iters: 300, epoch: 1 | loss: 0.1386342
	speed: 0.0113s/iter; left time: 125.5246s
	iters: 400, epoch: 1 | loss: 0.1020454
	speed: 0.0113s/iter; left time: 124.4803s
	iters: 500, epoch: 1 | loss: 0.1547250
	speed: 0.0113s/iter; left time: 123.2936s
Epoch: 1 cost time: 7.70378851890564
Epoch: 1, Steps: 570 | Train Loss: 0.1729303 Vali Loss: 0.0400080 Test Loss: 0.1371294
Validation loss decreased (inf --> 0.040008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1376592
	speed: 0.0386s/iter; left time: 414.2013s
	iters: 200, epoch: 2 | loss: 0.1232099
	speed: 0.0113s/iter; left time: 120.1601s
	iters: 300, epoch: 2 | loss: 0.1433925
	speed: 0.0113s/iter; left time: 119.0389s
	iters: 400, epoch: 2 | loss: 0.0723220
	speed: 0.0113s/iter; left time: 117.8775s
	iters: 500, epoch: 2 | loss: 0.1083352
	speed: 0.0113s/iter; left time: 116.9024s
Epoch: 2 cost time: 6.739056348800659
Epoch: 2, Steps: 570 | Train Loss: 0.1349601 Vali Loss: 0.0382567 Test Loss: 0.1396467
Validation loss decreased (0.040008 --> 0.038257).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1527098
	speed: 0.0388s/iter; left time: 394.6085s
	iters: 200, epoch: 3 | loss: 0.1241413
	speed: 0.0114s/iter; left time: 114.1939s
	iters: 300, epoch: 3 | loss: 0.0713978
	speed: 0.0114s/iter; left time: 113.3672s
	iters: 400, epoch: 3 | loss: 0.1055942
	speed: 0.0114s/iter; left time: 112.1054s
	iters: 500, epoch: 3 | loss: 0.0765643
	speed: 0.0114s/iter; left time: 110.9335s
Epoch: 3 cost time: 6.836720943450928
Epoch: 3, Steps: 570 | Train Loss: 0.1082077 Vali Loss: 0.0373908 Test Loss: 0.1306251
Validation loss decreased (0.038257 --> 0.037391).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1036857
	speed: 0.0383s/iter; left time: 367.7107s
	iters: 200, epoch: 4 | loss: 0.0744826
	speed: 0.0113s/iter; left time: 107.2032s
	iters: 300, epoch: 4 | loss: 0.0707711
	speed: 0.0113s/iter; left time: 106.0907s
	iters: 400, epoch: 4 | loss: 0.0607115
	speed: 0.0113s/iter; left time: 105.0687s
	iters: 500, epoch: 4 | loss: 0.0785588
	speed: 0.0113s/iter; left time: 103.9844s
Epoch: 4 cost time: 6.724570989608765
Epoch: 4, Steps: 570 | Train Loss: 0.0908620 Vali Loss: 0.0392988 Test Loss: 0.1457498
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0881547
	speed: 0.0372s/iter; left time: 335.3221s
	iters: 200, epoch: 5 | loss: 0.0766548
	speed: 0.0118s/iter; left time: 105.7003s
	iters: 300, epoch: 5 | loss: 0.1158895
	speed: 0.0113s/iter; left time: 99.9495s
	iters: 400, epoch: 5 | loss: 0.0795100
	speed: 0.0113s/iter; left time: 98.9578s
	iters: 500, epoch: 5 | loss: 0.0971395
	speed: 0.0114s/iter; left time: 97.8824s
Epoch: 5 cost time: 6.8986077308654785
Epoch: 5, Steps: 570 | Train Loss: 0.0811763 Vali Loss: 0.0376464 Test Loss: 0.1527721
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0682516
	speed: 0.0390s/iter; left time: 329.9011s
	iters: 200, epoch: 6 | loss: 0.0534175
	speed: 0.0113s/iter; left time: 94.5010s
	iters: 300, epoch: 6 | loss: 0.0740099
	speed: 0.0113s/iter; left time: 93.1261s
	iters: 400, epoch: 6 | loss: 0.0603816
	speed: 0.0113s/iter; left time: 91.9199s
	iters: 500, epoch: 6 | loss: 0.0543879
	speed: 0.0113s/iter; left time: 90.9366s
Epoch: 6 cost time: 6.725815057754517
Epoch: 6, Steps: 570 | Train Loss: 0.0761914 Vali Loss: 0.0381052 Test Loss: 0.1564614
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13079072535037994, mae:0.22968018054962158
>>> S LR=1e-4 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.0810876
	speed: 0.0231s/iter; left time: 261.0258s
	iters: 200, epoch: 1 | loss: 0.1737526
	speed: 0.0110s/iter; left time: 123.3266s
	iters: 300, epoch: 1 | loss: 0.1007733
	speed: 0.0110s/iter; left time: 121.8156s
	iters: 400, epoch: 1 | loss: 0.1370804
	speed: 0.0110s/iter; left time: 120.8470s
	iters: 500, epoch: 1 | loss: 0.0913418
	speed: 0.0110s/iter; left time: 119.5465s
Epoch: 1 cost time: 7.522248268127441
Epoch: 1, Steps: 570 | Train Loss: 0.1407850 Vali Loss: 0.0360107 Test Loss: 0.1163319
Validation loss decreased (inf --> 0.036011).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1059337
	speed: 0.0385s/iter; left time: 413.3938s
	iters: 200, epoch: 2 | loss: 0.0649765
	speed: 0.0110s/iter; left time: 116.4511s
	iters: 300, epoch: 2 | loss: 0.1193586
	speed: 0.0110s/iter; left time: 115.6059s
	iters: 400, epoch: 2 | loss: 0.1510836
	speed: 0.0110s/iter; left time: 114.3879s
	iters: 500, epoch: 2 | loss: 0.1345192
	speed: 0.0110s/iter; left time: 113.2035s
Epoch: 2 cost time: 6.595457315444946
Epoch: 2, Steps: 570 | Train Loss: 0.1093302 Vali Loss: 0.0353442 Test Loss: 0.1167172
Validation loss decreased (0.036011 --> 0.035344).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1049346
	speed: 0.0388s/iter; left time: 394.6568s
	iters: 200, epoch: 3 | loss: 0.0537501
	speed: 0.0110s/iter; left time: 110.1739s
	iters: 300, epoch: 3 | loss: 0.0955011
	speed: 0.0109s/iter; left time: 108.8899s
	iters: 400, epoch: 3 | loss: 0.0976019
	speed: 0.0110s/iter; left time: 108.0470s
	iters: 500, epoch: 3 | loss: 0.0898852
	speed: 0.0110s/iter; left time: 106.9057s
Epoch: 3 cost time: 6.593543767929077
Epoch: 3, Steps: 570 | Train Loss: 0.0876194 Vali Loss: 0.0326335 Test Loss: 0.1133353
Validation loss decreased (0.035344 --> 0.032634).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0963431
	speed: 0.0391s/iter; left time: 375.2139s
	iters: 200, epoch: 4 | loss: 0.0595597
	speed: 0.0109s/iter; left time: 103.7861s
	iters: 300, epoch: 4 | loss: 0.0407302
	speed: 0.0109s/iter; left time: 102.8052s
	iters: 400, epoch: 4 | loss: 0.0764182
	speed: 0.0109s/iter; left time: 101.4916s
	iters: 500, epoch: 4 | loss: 0.0623713
	speed: 0.0109s/iter; left time: 100.4171s
Epoch: 4 cost time: 6.556785583496094
Epoch: 4, Steps: 570 | Train Loss: 0.0731260 Vali Loss: 0.0328773 Test Loss: 0.1205921
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0568412
	speed: 0.0388s/iter; left time: 350.0930s
	iters: 200, epoch: 5 | loss: 0.0498573
	speed: 0.0119s/iter; left time: 105.9483s
	iters: 300, epoch: 5 | loss: 0.0823811
	speed: 0.0110s/iter; left time: 97.0373s
	iters: 400, epoch: 5 | loss: 0.0713528
	speed: 0.0110s/iter; left time: 95.5924s
	iters: 500, epoch: 5 | loss: 0.0629753
	speed: 0.0110s/iter; left time: 94.6984s
Epoch: 5 cost time: 6.7599217891693115
Epoch: 5, Steps: 570 | Train Loss: 0.0643279 Vali Loss: 0.0330378 Test Loss: 0.1195074
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0914586
	speed: 0.0383s/iter; left time: 323.4813s
	iters: 200, epoch: 6 | loss: 0.0549567
	speed: 0.0110s/iter; left time: 92.2508s
	iters: 300, epoch: 6 | loss: 0.0569050
	speed: 0.0110s/iter; left time: 91.0834s
	iters: 400, epoch: 6 | loss: 0.0522568
	speed: 0.0111s/iter; left time: 90.1158s
	iters: 500, epoch: 6 | loss: 0.0547480
	speed: 0.0110s/iter; left time: 88.9453s
Epoch: 6 cost time: 6.6197264194488525
Epoch: 6, Steps: 570 | Train Loss: 0.0599739 Vali Loss: 0.0330086 Test Loss: 0.1204191
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11347533762454987, mae:0.20689021050930023
>>> S LR=1e-4 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1591874
	speed: 0.0234s/iter; left time: 264.3437s
	iters: 200, epoch: 1 | loss: 0.1831962
	speed: 0.0110s/iter; left time: 123.6284s
	iters: 300, epoch: 1 | loss: 0.2089191
	speed: 0.0113s/iter; left time: 125.1130s
	iters: 400, epoch: 1 | loss: 0.1636991
	speed: 0.0112s/iter; left time: 123.7456s
	iters: 500, epoch: 1 | loss: 0.1157722
	speed: 0.0113s/iter; left time: 122.6636s
Epoch: 1 cost time: 7.659217357635498
Epoch: 1, Steps: 570 | Train Loss: 0.1782888 Vali Loss: 0.0404736 Test Loss: 0.1302651
Validation loss decreased (inf --> 0.040474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1295277
	speed: 0.0381s/iter; left time: 408.8554s
	iters: 200, epoch: 2 | loss: 0.2165342
	speed: 0.0102s/iter; left time: 108.4667s
	iters: 300, epoch: 2 | loss: 0.1064543
	speed: 0.0102s/iter; left time: 107.4475s
	iters: 400, epoch: 2 | loss: 0.1238339
	speed: 0.0102s/iter; left time: 106.5827s
	iters: 500, epoch: 2 | loss: 0.1043591
	speed: 0.0102s/iter; left time: 105.3531s
Epoch: 2 cost time: 6.125666379928589
Epoch: 2, Steps: 570 | Train Loss: 0.1408722 Vali Loss: 0.0439965 Test Loss: 0.1409441
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1559751
	speed: 0.0352s/iter; left time: 358.0831s
	iters: 200, epoch: 3 | loss: 0.0895628
	speed: 0.0102s/iter; left time: 103.0483s
	iters: 300, epoch: 3 | loss: 0.1718731
	speed: 0.0102s/iter; left time: 101.9252s
	iters: 400, epoch: 3 | loss: 0.0694576
	speed: 0.0102s/iter; left time: 100.6363s
	iters: 500, epoch: 3 | loss: 0.1502626
	speed: 0.0102s/iter; left time: 99.7106s
Epoch: 3 cost time: 6.11214804649353
Epoch: 3, Steps: 570 | Train Loss: 0.1138628 Vali Loss: 0.0404563 Test Loss: 0.1526142
Validation loss decreased (0.040474 --> 0.040456).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1367694
	speed: 0.0367s/iter; left time: 352.1064s
	iters: 200, epoch: 4 | loss: 0.0969892
	speed: 0.0102s/iter; left time: 97.2387s
	iters: 300, epoch: 4 | loss: 0.0869837
	speed: 0.0102s/iter; left time: 95.9932s
	iters: 400, epoch: 4 | loss: 0.1420496
	speed: 0.0102s/iter; left time: 95.0805s
	iters: 500, epoch: 4 | loss: 0.0934160
	speed: 0.0102s/iter; left time: 94.0297s
Epoch: 4 cost time: 6.116997957229614
Epoch: 4, Steps: 570 | Train Loss: 0.0945804 Vali Loss: 0.0419706 Test Loss: 0.1550899
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0920704
	speed: 0.0383s/iter; left time: 345.4634s
	iters: 200, epoch: 5 | loss: 0.0777075
	speed: 0.0109s/iter; left time: 96.9335s
	iters: 300, epoch: 5 | loss: 0.1060663
	speed: 0.0102s/iter; left time: 90.3010s
	iters: 400, epoch: 5 | loss: 0.0513140
	speed: 0.0102s/iter; left time: 88.9697s
	iters: 500, epoch: 5 | loss: 0.1049486
	speed: 0.0102s/iter; left time: 87.7381s
Epoch: 5 cost time: 6.29815149307251
Epoch: 5, Steps: 570 | Train Loss: 0.0832179 Vali Loss: 0.0418862 Test Loss: 0.1565579
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0662341
	speed: 0.0373s/iter; left time: 315.4086s
	iters: 200, epoch: 6 | loss: 0.0685521
	speed: 0.0102s/iter; left time: 85.2338s
	iters: 300, epoch: 6 | loss: 0.0905726
	speed: 0.0102s/iter; left time: 84.1775s
	iters: 400, epoch: 6 | loss: 0.0657543
	speed: 0.0102s/iter; left time: 83.0821s
	iters: 500, epoch: 6 | loss: 0.0851176
	speed: 0.0102s/iter; left time: 82.0423s
Epoch: 6 cost time: 6.087334394454956
Epoch: 6, Steps: 570 | Train Loss: 0.0773127 Vali Loss: 0.0420648 Test Loss: 0.1633611
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15277422964572906, mae:0.2551383078098297
>>> S LR=1e-4 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2000083
	speed: 0.0271s/iter; left time: 306.4886s
	iters: 200, epoch: 1 | loss: 0.1531113
	speed: 0.0152s/iter; left time: 170.7092s
	iters: 300, epoch: 1 | loss: 0.2294130
	speed: 0.0152s/iter; left time: 168.9803s
	iters: 400, epoch: 1 | loss: 0.1195128
	speed: 0.0152s/iter; left time: 167.5254s
	iters: 500, epoch: 1 | loss: 0.1458460
	speed: 0.0152s/iter; left time: 166.0347s
Epoch: 1 cost time: 9.91493821144104
Epoch: 1, Steps: 570 | Train Loss: 0.1727134 Vali Loss: 0.0386647 Test Loss: 0.1245982
Validation loss decreased (inf --> 0.038665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1469039
	speed: 0.0469s/iter; left time: 503.1456s
	iters: 200, epoch: 2 | loss: 0.1419092
	speed: 0.0137s/iter; left time: 146.0603s
	iters: 300, epoch: 2 | loss: 0.1054168
	speed: 0.0138s/iter; left time: 144.8384s
	iters: 400, epoch: 2 | loss: 0.0963929
	speed: 0.0137s/iter; left time: 142.6622s
	iters: 500, epoch: 2 | loss: 0.1601444
	speed: 0.0136s/iter; left time: 140.3892s
Epoch: 2 cost time: 8.119065761566162
Epoch: 2, Steps: 570 | Train Loss: 0.1329775 Vali Loss: 0.0357063 Test Loss: 0.1264322
Validation loss decreased (0.038665 --> 0.035706).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2215188
	speed: 0.0447s/iter; left time: 454.5216s
	iters: 200, epoch: 3 | loss: 0.1376603
	speed: 0.0137s/iter; left time: 137.6439s
	iters: 300, epoch: 3 | loss: 0.0825640
	speed: 0.0137s/iter; left time: 136.1292s
	iters: 400, epoch: 3 | loss: 0.0799596
	speed: 0.0136s/iter; left time: 134.4745s
	iters: 500, epoch: 3 | loss: 0.0644788
	speed: 0.0136s/iter; left time: 133.1318s
Epoch: 3 cost time: 8.084709405899048
Epoch: 3, Steps: 570 | Train Loss: 0.1116666 Vali Loss: 0.0353669 Test Loss: 0.1293708
Validation loss decreased (0.035706 --> 0.035367).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0914909
	speed: 0.0445s/iter; left time: 426.8156s
	iters: 200, epoch: 4 | loss: 0.0921973
	speed: 0.0136s/iter; left time: 129.3257s
	iters: 300, epoch: 4 | loss: 0.1063689
	speed: 0.0136s/iter; left time: 127.7505s
	iters: 400, epoch: 4 | loss: 0.0902678
	speed: 0.0136s/iter; left time: 126.5589s
	iters: 500, epoch: 4 | loss: 0.0923638
	speed: 0.0136s/iter; left time: 124.9995s
Epoch: 4 cost time: 8.03351879119873
Epoch: 4, Steps: 570 | Train Loss: 0.1002810 Vali Loss: 0.0357831 Test Loss: 0.1345067
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0895178
	speed: 0.0478s/iter; left time: 431.4471s
	iters: 200, epoch: 5 | loss: 0.1028393
	speed: 0.0148s/iter; left time: 132.1476s
	iters: 300, epoch: 5 | loss: 0.0822786
	speed: 0.0138s/iter; left time: 121.5696s
	iters: 400, epoch: 5 | loss: 0.0990032
	speed: 0.0136s/iter; left time: 118.8707s
	iters: 500, epoch: 5 | loss: 0.0671467
	speed: 0.0136s/iter; left time: 117.1054s
Epoch: 5 cost time: 8.341331005096436
Epoch: 5, Steps: 570 | Train Loss: 0.0938712 Vali Loss: 0.0361800 Test Loss: 0.1291798
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0899189
	speed: 0.0457s/iter; left time: 385.8016s
	iters: 200, epoch: 6 | loss: 0.1101070
	speed: 0.0136s/iter; left time: 113.9512s
	iters: 300, epoch: 6 | loss: 0.0664013
	speed: 0.0137s/iter; left time: 112.8005s
	iters: 400, epoch: 6 | loss: 0.0845635
	speed: 0.0137s/iter; left time: 111.4670s
	iters: 500, epoch: 6 | loss: 0.0703498
	speed: 0.0137s/iter; left time: 110.1406s
Epoch: 6 cost time: 8.042816162109375
Epoch: 6, Steps: 570 | Train Loss: 0.0904879 Vali Loss: 0.0364133 Test Loss: 0.1368967
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12952369451522827, mae:0.22760073840618134
>>> S LR=1e-4 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2009139
	speed: 0.0251s/iter; left time: 283.5243s
	iters: 200, epoch: 1 | loss: 0.1106802
	speed: 0.0134s/iter; left time: 149.7453s
	iters: 300, epoch: 1 | loss: 0.0887125
	speed: 0.0133s/iter; left time: 147.9483s
	iters: 400, epoch: 1 | loss: 0.1711889
	speed: 0.0134s/iter; left time: 147.0743s
	iters: 500, epoch: 1 | loss: 0.1523882
	speed: 0.0134s/iter; left time: 146.1278s
Epoch: 1 cost time: 8.846055030822754
Epoch: 1, Steps: 570 | Train Loss: 0.1426700 Vali Loss: 0.0331577 Test Loss: 0.1106864
Validation loss decreased (inf --> 0.033158).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0847275
	speed: 0.0439s/iter; left time: 470.9371s
	iters: 200, epoch: 2 | loss: 0.1880749
	speed: 0.0134s/iter; left time: 142.0540s
	iters: 300, epoch: 2 | loss: 0.1243290
	speed: 0.0134s/iter; left time: 141.2812s
	iters: 400, epoch: 2 | loss: 0.0970628
	speed: 0.0134s/iter; left time: 140.0914s
	iters: 500, epoch: 2 | loss: 0.1027478
	speed: 0.0134s/iter; left time: 138.7067s
Epoch: 2 cost time: 7.934760808944702
Epoch: 2, Steps: 570 | Train Loss: 0.1106864 Vali Loss: 0.0334192 Test Loss: 0.1124835
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1186045
	speed: 0.0440s/iter; left time: 447.5308s
	iters: 200, epoch: 3 | loss: 0.0535330
	speed: 0.0135s/iter; left time: 135.7254s
	iters: 300, epoch: 3 | loss: 0.1073250
	speed: 0.0135s/iter; left time: 134.0004s
	iters: 400, epoch: 3 | loss: 0.0691392
	speed: 0.0134s/iter; left time: 132.5985s
	iters: 500, epoch: 3 | loss: 0.0805713
	speed: 0.0135s/iter; left time: 131.3754s
Epoch: 3 cost time: 7.960039138793945
Epoch: 3, Steps: 570 | Train Loss: 0.0951137 Vali Loss: 0.0318998 Test Loss: 0.1080403
Validation loss decreased (0.033158 --> 0.031900).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0522326
	speed: 0.0481s/iter; left time: 461.0773s
	iters: 200, epoch: 4 | loss: 0.0723296
	speed: 0.0149s/iter; left time: 141.0259s
	iters: 300, epoch: 4 | loss: 0.0991585
	speed: 0.0134s/iter; left time: 125.7930s
	iters: 400, epoch: 4 | loss: 0.0549610
	speed: 0.0134s/iter; left time: 124.6614s
	iters: 500, epoch: 4 | loss: 0.0587205
	speed: 0.0134s/iter; left time: 123.0768s
Epoch: 4 cost time: 8.242295265197754
Epoch: 4, Steps: 570 | Train Loss: 0.0852912 Vali Loss: 0.0314828 Test Loss: 0.1127983
Validation loss decreased (0.031900 --> 0.031483).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0571404
	speed: 0.0438s/iter; left time: 395.3179s
	iters: 200, epoch: 5 | loss: 0.0725231
	speed: 0.0134s/iter; left time: 119.7175s
	iters: 300, epoch: 5 | loss: 0.0612308
	speed: 0.0134s/iter; left time: 118.3331s
	iters: 400, epoch: 5 | loss: 0.0858582
	speed: 0.0134s/iter; left time: 116.8699s
	iters: 500, epoch: 5 | loss: 0.0652367
	speed: 0.0134s/iter; left time: 115.3669s
Epoch: 5 cost time: 7.93740177154541
Epoch: 5, Steps: 570 | Train Loss: 0.0787900 Vali Loss: 0.0319086 Test Loss: 0.1144943
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0655767
	speed: 0.0447s/iter; left time: 377.7332s
	iters: 200, epoch: 6 | loss: 0.1054318
	speed: 0.0133s/iter; left time: 111.0012s
	iters: 300, epoch: 6 | loss: 0.0892058
	speed: 0.0133s/iter; left time: 109.6505s
	iters: 400, epoch: 6 | loss: 0.0989188
	speed: 0.0133s/iter; left time: 108.3547s
	iters: 500, epoch: 6 | loss: 0.0873400
	speed: 0.0133s/iter; left time: 106.9727s
Epoch: 6 cost time: 7.842661380767822
Epoch: 6, Steps: 570 | Train Loss: 0.0751271 Vali Loss: 0.0322429 Test Loss: 0.1136793
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0596492
	speed: 0.0430s/iter; left time: 338.6661s
	iters: 200, epoch: 7 | loss: 0.1002603
	speed: 0.0132s/iter; left time: 102.9756s
	iters: 300, epoch: 7 | loss: 0.0669925
	speed: 0.0133s/iter; left time: 101.9128s
	iters: 400, epoch: 7 | loss: 0.0890219
	speed: 0.0134s/iter; left time: 101.2615s
	iters: 500, epoch: 7 | loss: 0.0872821
	speed: 0.0133s/iter; left time: 99.7295s
Epoch: 7 cost time: 7.846563339233398
Epoch: 7, Steps: 570 | Train Loss: 0.0733036 Vali Loss: 0.0320798 Test Loss: 0.1143724
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1129598468542099, mae:0.20607854425907135
>>> S LR=1e-4 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1118826
	speed: 0.0249s/iter; left time: 280.9158s
	iters: 200, epoch: 1 | loss: 0.2262527
	speed: 0.0135s/iter; left time: 150.7318s
	iters: 300, epoch: 1 | loss: 0.2957072
	speed: 0.0134s/iter; left time: 149.0440s
	iters: 400, epoch: 1 | loss: 0.1266808
	speed: 0.0134s/iter; left time: 147.8711s
	iters: 500, epoch: 1 | loss: 0.1911398
	speed: 0.0134s/iter; left time: 146.1936s
Epoch: 1 cost time: 8.83893871307373
Epoch: 1, Steps: 570 | Train Loss: 0.1809631 Vali Loss: 0.0414711 Test Loss: 0.1316260
Validation loss decreased (inf --> 0.041471).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1280002
	speed: 0.0457s/iter; left time: 490.2130s
	iters: 200, epoch: 2 | loss: 0.1071319
	speed: 0.0134s/iter; left time: 142.4511s
	iters: 300, epoch: 2 | loss: 0.1021322
	speed: 0.0134s/iter; left time: 141.1004s
	iters: 400, epoch: 2 | loss: 0.1066586
	speed: 0.0134s/iter; left time: 139.5230s
	iters: 500, epoch: 2 | loss: 0.1381784
	speed: 0.0133s/iter; left time: 137.9089s
Epoch: 2 cost time: 7.9078545570373535
Epoch: 2, Steps: 570 | Train Loss: 0.1417150 Vali Loss: 0.0401551 Test Loss: 0.1382039
Validation loss decreased (0.041471 --> 0.040155).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1593286
	speed: 0.0437s/iter; left time: 443.7749s
	iters: 200, epoch: 3 | loss: 0.1475909
	speed: 0.0135s/iter; left time: 135.7871s
	iters: 300, epoch: 3 | loss: 0.1064920
	speed: 0.0135s/iter; left time: 134.5607s
	iters: 400, epoch: 3 | loss: 0.0791515
	speed: 0.0135s/iter; left time: 133.1479s
	iters: 500, epoch: 3 | loss: 0.1231427
	speed: 0.0135s/iter; left time: 131.5284s
Epoch: 3 cost time: 7.963648319244385
Epoch: 3, Steps: 570 | Train Loss: 0.1212880 Vali Loss: 0.0411789 Test Loss: 0.1366334
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1330505
	speed: 0.0456s/iter; left time: 437.2093s
	iters: 200, epoch: 4 | loss: 0.1439764
	speed: 0.0134s/iter; left time: 127.2707s
	iters: 300, epoch: 4 | loss: 0.1029751
	speed: 0.0134s/iter; left time: 125.9670s
	iters: 400, epoch: 4 | loss: 0.0853170
	speed: 0.0134s/iter; left time: 124.2908s
	iters: 500, epoch: 4 | loss: 0.0556597
	speed: 0.0134s/iter; left time: 123.3284s
Epoch: 4 cost time: 7.980828762054443
Epoch: 4, Steps: 570 | Train Loss: 0.1074440 Vali Loss: 0.0403497 Test Loss: 0.1459630
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0898317
	speed: 0.0431s/iter; left time: 388.5471s
	iters: 200, epoch: 5 | loss: 0.1078158
	speed: 0.0134s/iter; left time: 119.5709s
	iters: 300, epoch: 5 | loss: 0.0867222
	speed: 0.0134s/iter; left time: 118.6398s
	iters: 400, epoch: 5 | loss: 0.1208162
	speed: 0.0134s/iter; left time: 116.7677s
	iters: 500, epoch: 5 | loss: 0.0731079
	speed: 0.0134s/iter; left time: 115.3900s
Epoch: 5 cost time: 7.952292442321777
Epoch: 5, Steps: 570 | Train Loss: 0.0989728 Vali Loss: 0.0413370 Test Loss: 0.1467454
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13839782774448395, mae:0.24226732552051544
>>> S LR=1e-4 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2021672
	speed: 0.0279s/iter; left time: 314.8884s
	iters: 200, epoch: 1 | loss: 0.1390781
	speed: 0.0162s/iter; left time: 181.1712s
	iters: 300, epoch: 1 | loss: 0.2381381
	speed: 0.0162s/iter; left time: 179.4952s
	iters: 400, epoch: 1 | loss: 0.1839798
	speed: 0.0162s/iter; left time: 177.8630s
	iters: 500, epoch: 1 | loss: 0.1475828
	speed: 0.0162s/iter; left time: 176.4896s
Epoch: 1 cost time: 10.441795349121094
Epoch: 1, Steps: 570 | Train Loss: 0.1714901 Vali Loss: 0.0406605 Test Loss: 0.1306766
Validation loss decreased (inf --> 0.040661).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1319226
	speed: 0.0492s/iter; left time: 527.5542s
	iters: 200, epoch: 2 | loss: 0.1698632
	speed: 0.0163s/iter; left time: 172.9235s
	iters: 300, epoch: 2 | loss: 0.1436289
	speed: 0.0163s/iter; left time: 171.1611s
	iters: 400, epoch: 2 | loss: 0.0821102
	speed: 0.0162s/iter; left time: 169.4892s
	iters: 500, epoch: 2 | loss: 0.0764470
	speed: 0.0162s/iter; left time: 167.7429s
Epoch: 2 cost time: 9.56358814239502
Epoch: 2, Steps: 570 | Train Loss: 0.1312489 Vali Loss: 0.0385547 Test Loss: 0.1364454
Validation loss decreased (0.040661 --> 0.038555).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1122839
	speed: 0.0490s/iter; left time: 497.7915s
	iters: 200, epoch: 3 | loss: 0.1176624
	speed: 0.0163s/iter; left time: 163.8838s
	iters: 300, epoch: 3 | loss: 0.1407215
	speed: 0.0163s/iter; left time: 162.1308s
	iters: 400, epoch: 3 | loss: 0.0936564
	speed: 0.0163s/iter; left time: 160.5805s
	iters: 500, epoch: 3 | loss: 0.0696341
	speed: 0.0163s/iter; left time: 158.9003s
Epoch: 3 cost time: 9.580974340438843
Epoch: 3, Steps: 570 | Train Loss: 0.0972635 Vali Loss: 0.0375050 Test Loss: 0.1325647
Validation loss decreased (0.038555 --> 0.037505).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0723389
	speed: 0.0501s/iter; left time: 480.1060s
	iters: 200, epoch: 4 | loss: 0.0888594
	speed: 0.0163s/iter; left time: 154.2598s
	iters: 300, epoch: 4 | loss: 0.0419996
	speed: 0.0162s/iter; left time: 152.5356s
	iters: 400, epoch: 4 | loss: 0.1080214
	speed: 0.0162s/iter; left time: 150.7377s
	iters: 500, epoch: 4 | loss: 0.0885240
	speed: 0.0162s/iter; left time: 149.1145s
Epoch: 4 cost time: 9.533605337142944
Epoch: 4, Steps: 570 | Train Loss: 0.0772739 Vali Loss: 0.0377208 Test Loss: 0.1399236
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0632500
	speed: 0.0506s/iter; left time: 456.3338s
	iters: 200, epoch: 5 | loss: 0.0996536
	speed: 0.0162s/iter; left time: 144.1502s
	iters: 300, epoch: 5 | loss: 0.0608553
	speed: 0.0162s/iter; left time: 142.5512s
	iters: 400, epoch: 5 | loss: 0.0768012
	speed: 0.0162s/iter; left time: 141.2053s
	iters: 500, epoch: 5 | loss: 0.0723391
	speed: 0.0162s/iter; left time: 139.4768s
Epoch: 5 cost time: 9.52287769317627
Epoch: 5, Steps: 570 | Train Loss: 0.0660565 Vali Loss: 0.0370657 Test Loss: 0.1433025
Validation loss decreased (0.037505 --> 0.037066).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0559120
	speed: 0.0485s/iter; left time: 409.8117s
	iters: 200, epoch: 6 | loss: 0.0432066
	speed: 0.0162s/iter; left time: 134.9207s
	iters: 300, epoch: 6 | loss: 0.0506377
	speed: 0.0161s/iter; left time: 133.1710s
	iters: 400, epoch: 6 | loss: 0.0635986
	speed: 0.0161s/iter; left time: 131.4731s
	iters: 500, epoch: 6 | loss: 0.0535187
	speed: 0.0161s/iter; left time: 129.8662s
Epoch: 6 cost time: 9.491068840026855
Epoch: 6, Steps: 570 | Train Loss: 0.0602648 Vali Loss: 0.0378023 Test Loss: 0.1412736
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0732934
	speed: 0.0493s/iter; left time: 388.5988s
	iters: 200, epoch: 7 | loss: 0.0785959
	speed: 0.0176s/iter; left time: 136.8252s
	iters: 300, epoch: 7 | loss: 0.0490459
	speed: 0.0176s/iter; left time: 135.0345s
	iters: 400, epoch: 7 | loss: 0.0561216
	speed: 0.0176s/iter; left time: 133.3050s
	iters: 500, epoch: 7 | loss: 0.0426788
	speed: 0.0176s/iter; left time: 131.5860s
Epoch: 7 cost time: 10.2798912525177
Epoch: 7, Steps: 570 | Train Loss: 0.0573294 Vali Loss: 0.0379681 Test Loss: 0.1431101
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0515274
	speed: 0.0488s/iter; left time: 357.1031s
	iters: 200, epoch: 8 | loss: 0.0467955
	speed: 0.0161s/iter; left time: 116.3200s
	iters: 300, epoch: 8 | loss: 0.0552687
	speed: 0.0161s/iter; left time: 114.6922s
	iters: 400, epoch: 8 | loss: 0.0487197
	speed: 0.0161s/iter; left time: 113.0641s
	iters: 500, epoch: 8 | loss: 0.0408548
	speed: 0.0162s/iter; left time: 111.7605s
Epoch: 8 cost time: 9.466827154159546
Epoch: 8, Steps: 570 | Train Loss: 0.0556954 Vali Loss: 0.0380228 Test Loss: 0.1424349
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1435336023569107, mae:0.23722144961357117
>>> S LR=1e-4 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1291610
	speed: 0.0286s/iter; left time: 323.1548s
	iters: 200, epoch: 1 | loss: 0.0764197
	speed: 0.0156s/iter; left time: 175.1675s
	iters: 300, epoch: 1 | loss: 0.1519589
	speed: 0.0166s/iter; left time: 184.6581s
	iters: 400, epoch: 1 | loss: 0.1350043
	speed: 0.0171s/iter; left time: 187.8317s
	iters: 500, epoch: 1 | loss: 0.0999806
	speed: 0.0170s/iter; left time: 185.8142s
Epoch: 1 cost time: 10.745451927185059
Epoch: 1, Steps: 570 | Train Loss: 0.1373180 Vali Loss: 0.0324319 Test Loss: 0.1109426
Validation loss decreased (inf --> 0.032432).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1143693
	speed: 0.0534s/iter; left time: 572.8732s
	iters: 200, epoch: 2 | loss: 0.0997336
	speed: 0.0157s/iter; left time: 166.8974s
	iters: 300, epoch: 2 | loss: 0.1661108
	speed: 0.0157s/iter; left time: 164.9160s
	iters: 400, epoch: 2 | loss: 0.1442142
	speed: 0.0157s/iter; left time: 163.4434s
	iters: 500, epoch: 2 | loss: 0.0896676
	speed: 0.0157s/iter; left time: 161.8404s
Epoch: 2 cost time: 9.309105157852173
Epoch: 2, Steps: 570 | Train Loss: 0.1061513 Vali Loss: 0.0321751 Test Loss: 0.1114039
Validation loss decreased (0.032432 --> 0.032175).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0594436
	speed: 0.0495s/iter; left time: 503.3104s
	iters: 200, epoch: 3 | loss: 0.1308726
	speed: 0.0157s/iter; left time: 158.0139s
	iters: 300, epoch: 3 | loss: 0.0790733
	speed: 0.0157s/iter; left time: 156.1344s
	iters: 400, epoch: 3 | loss: 0.0960142
	speed: 0.0157s/iter; left time: 154.5939s
	iters: 500, epoch: 3 | loss: 0.0481709
	speed: 0.0157s/iter; left time: 153.1064s
Epoch: 3 cost time: 9.2405104637146
Epoch: 3, Steps: 570 | Train Loss: 0.0796047 Vali Loss: 0.0324839 Test Loss: 0.1199027
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0743218
	speed: 0.0487s/iter; left time: 467.5181s
	iters: 200, epoch: 4 | loss: 0.0695055
	speed: 0.0157s/iter; left time: 148.8390s
	iters: 300, epoch: 4 | loss: 0.0460369
	speed: 0.0156s/iter; left time: 146.6432s
	iters: 400, epoch: 4 | loss: 0.0500235
	speed: 0.0156s/iter; left time: 145.1240s
	iters: 500, epoch: 4 | loss: 0.0665368
	speed: 0.0156s/iter; left time: 143.4377s
Epoch: 4 cost time: 9.201875448226929
Epoch: 4, Steps: 570 | Train Loss: 0.0617473 Vali Loss: 0.0331943 Test Loss: 0.1208291
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0532691
	speed: 0.0475s/iter; left time: 428.7025s
	iters: 200, epoch: 5 | loss: 0.0571532
	speed: 0.0156s/iter; left time: 139.3614s
	iters: 300, epoch: 5 | loss: 0.0406069
	speed: 0.0156s/iter; left time: 137.9759s
	iters: 400, epoch: 5 | loss: 0.0384020
	speed: 0.0156s/iter; left time: 136.3785s
	iters: 500, epoch: 5 | loss: 0.0567795
	speed: 0.0156s/iter; left time: 134.6524s
Epoch: 5 cost time: 9.205362796783447
Epoch: 5, Steps: 570 | Train Loss: 0.0523224 Vali Loss: 0.0325549 Test Loss: 0.1229036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11153729259967804, mae:0.20526477694511414
>>> S LR=1e-4 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1878656
	speed: 0.0274s/iter; left time: 309.8303s
	iters: 200, epoch: 1 | loss: 0.1503317
	speed: 0.0146s/iter; left time: 163.9085s
	iters: 300, epoch: 1 | loss: 0.1553499
	speed: 0.0146s/iter; left time: 161.9677s
	iters: 400, epoch: 1 | loss: 0.1482875
	speed: 0.0146s/iter; left time: 160.9159s
	iters: 500, epoch: 1 | loss: 0.2487927
	speed: 0.0146s/iter; left time: 158.9644s
Epoch: 1 cost time: 9.657531023025513
Epoch: 1, Steps: 570 | Train Loss: 0.1782845 Vali Loss: 0.0448254 Test Loss: 0.1421887
Validation loss decreased (inf --> 0.044825).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2554135
	speed: 0.0468s/iter; left time: 502.6992s
	iters: 200, epoch: 2 | loss: 0.0819446
	speed: 0.0166s/iter; left time: 176.8538s
	iters: 300, epoch: 2 | loss: 0.1568205
	speed: 0.0166s/iter; left time: 174.9608s
	iters: 400, epoch: 2 | loss: 0.1459018
	speed: 0.0166s/iter; left time: 173.4426s
	iters: 500, epoch: 2 | loss: 0.1881562
	speed: 0.0166s/iter; left time: 171.7203s
Epoch: 2 cost time: 9.646897315979004
Epoch: 2, Steps: 570 | Train Loss: 0.1375322 Vali Loss: 0.0437193 Test Loss: 0.1664172
Validation loss decreased (0.044825 --> 0.043719).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1106989
	speed: 0.0502s/iter; left time: 509.8017s
	iters: 200, epoch: 3 | loss: 0.0716456
	speed: 0.0168s/iter; left time: 169.0101s
	iters: 300, epoch: 3 | loss: 0.1155825
	speed: 0.0168s/iter; left time: 167.3966s
	iters: 400, epoch: 3 | loss: 0.0951339
	speed: 0.0168s/iter; left time: 165.7229s
	iters: 500, epoch: 3 | loss: 0.1013504
	speed: 0.0168s/iter; left time: 164.1621s
Epoch: 3 cost time: 9.840303659439087
Epoch: 3, Steps: 570 | Train Loss: 0.1021810 Vali Loss: 0.0439696 Test Loss: 0.1552055
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0591271
	speed: 0.0477s/iter; left time: 457.3597s
	iters: 200, epoch: 4 | loss: 0.0934392
	speed: 0.0166s/iter; left time: 157.3365s
	iters: 300, epoch: 4 | loss: 0.0830187
	speed: 0.0167s/iter; left time: 156.4957s
	iters: 400, epoch: 4 | loss: 0.0626722
	speed: 0.0161s/iter; left time: 149.9011s
	iters: 500, epoch: 4 | loss: 0.0831729
	speed: 0.0161s/iter; left time: 148.0417s
Epoch: 4 cost time: 9.560822486877441
Epoch: 4, Steps: 570 | Train Loss: 0.0785321 Vali Loss: 0.0440271 Test Loss: 0.1602340
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0599013
	speed: 0.0482s/iter; left time: 434.6126s
	iters: 200, epoch: 5 | loss: 0.0458381
	speed: 0.0146s/iter; left time: 129.9004s
	iters: 300, epoch: 5 | loss: 0.0706496
	speed: 0.0145s/iter; left time: 128.3244s
	iters: 400, epoch: 5 | loss: 0.0647620
	speed: 0.0145s/iter; left time: 126.8550s
	iters: 500, epoch: 5 | loss: 0.0595561
	speed: 0.0145s/iter; left time: 125.1493s
Epoch: 5 cost time: 8.564079999923706
Epoch: 5, Steps: 570 | Train Loss: 0.0644411 Vali Loss: 0.0449647 Test Loss: 0.1675063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1666298806667328, mae:0.26062577962875366
>>> S LR=1e-4 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1237423
	speed: 0.0291s/iter; left time: 328.6742s
	iters: 200, epoch: 1 | loss: 0.1815724
	speed: 0.0175s/iter; left time: 195.7683s
	iters: 300, epoch: 1 | loss: 0.2462361
	speed: 0.0175s/iter; left time: 193.8921s
	iters: 400, epoch: 1 | loss: 0.1788389
	speed: 0.0175s/iter; left time: 192.1647s
	iters: 500, epoch: 1 | loss: 0.1490097
	speed: 0.0175s/iter; left time: 190.6814s
Epoch: 1 cost time: 11.173964262008667
Epoch: 1, Steps: 570 | Train Loss: 0.1759496 Vali Loss: 0.0405915 Test Loss: 0.1223620
Validation loss decreased (inf --> 0.040592).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1617862
	speed: 0.0561s/iter; left time: 601.8396s
	iters: 200, epoch: 2 | loss: 0.1161629
	speed: 0.0176s/iter; left time: 186.6808s
	iters: 300, epoch: 2 | loss: 0.1891411
	speed: 0.0175s/iter; left time: 184.7555s
	iters: 400, epoch: 2 | loss: 0.1175508
	speed: 0.0175s/iter; left time: 182.5972s
	iters: 500, epoch: 2 | loss: 0.1008652
	speed: 0.0174s/iter; left time: 180.2660s
Epoch: 2 cost time: 10.307152509689331
Epoch: 2, Steps: 570 | Train Loss: 0.1339158 Vali Loss: 0.0374232 Test Loss: 0.1275478
Validation loss decreased (0.040592 --> 0.037423).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1054671
	speed: 0.0546s/iter; left time: 554.2935s
	iters: 200, epoch: 3 | loss: 0.1044656
	speed: 0.0175s/iter; left time: 175.7768s
	iters: 300, epoch: 3 | loss: 0.0944144
	speed: 0.0178s/iter; left time: 177.7825s
	iters: 400, epoch: 3 | loss: 0.0735033
	speed: 0.0196s/iter; left time: 193.1027s
	iters: 500, epoch: 3 | loss: 0.0800049
	speed: 0.0189s/iter; left time: 184.8216s
Epoch: 3 cost time: 10.702228307723999
Epoch: 3, Steps: 570 | Train Loss: 0.1096138 Vali Loss: 0.0367850 Test Loss: 0.1380908
Validation loss decreased (0.037423 --> 0.036785).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1024578
	speed: 0.0552s/iter; left time: 528.9740s
	iters: 200, epoch: 4 | loss: 0.0807087
	speed: 0.0175s/iter; left time: 166.0816s
	iters: 300, epoch: 4 | loss: 0.1176524
	speed: 0.0176s/iter; left time: 164.8182s
	iters: 400, epoch: 4 | loss: 0.0743253
	speed: 0.0175s/iter; left time: 162.6187s
	iters: 500, epoch: 4 | loss: 0.1025066
	speed: 0.0175s/iter; left time: 161.2583s
Epoch: 4 cost time: 10.385919094085693
Epoch: 4, Steps: 570 | Train Loss: 0.0958129 Vali Loss: 0.0359677 Test Loss: 0.1491540
Validation loss decreased (0.036785 --> 0.035968).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0981042
	speed: 0.0565s/iter; left time: 509.2402s
	iters: 200, epoch: 5 | loss: 0.0890039
	speed: 0.0175s/iter; left time: 156.0945s
	iters: 300, epoch: 5 | loss: 0.0888565
	speed: 0.0174s/iter; left time: 153.9203s
	iters: 400, epoch: 5 | loss: 0.0767713
	speed: 0.0175s/iter; left time: 152.4206s
	iters: 500, epoch: 5 | loss: 0.0893423
	speed: 0.0174s/iter; left time: 150.1742s
Epoch: 5 cost time: 10.236524105072021
Epoch: 5, Steps: 570 | Train Loss: 0.0885052 Vali Loss: 0.0351033 Test Loss: 0.1381938
Validation loss decreased (0.035968 --> 0.035103).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0585304
	speed: 0.0556s/iter; left time: 470.0459s
	iters: 200, epoch: 6 | loss: 0.0961952
	speed: 0.0176s/iter; left time: 146.7022s
	iters: 300, epoch: 6 | loss: 0.0568543
	speed: 0.0195s/iter; left time: 161.2667s
	iters: 400, epoch: 6 | loss: 0.1147570
	speed: 0.0188s/iter; left time: 153.4393s
	iters: 500, epoch: 6 | loss: 0.0965698
	speed: 0.0174s/iter; left time: 140.3702s
Epoch: 6 cost time: 10.604813814163208
Epoch: 6, Steps: 570 | Train Loss: 0.0843924 Vali Loss: 0.0359512 Test Loss: 0.1356498
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0749360
	speed: 0.0549s/iter; left time: 432.8635s
	iters: 200, epoch: 7 | loss: 0.0914239
	speed: 0.0197s/iter; left time: 152.9151s
	iters: 300, epoch: 7 | loss: 0.0927325
	speed: 0.0196s/iter; left time: 150.7858s
	iters: 400, epoch: 7 | loss: 0.0950167
	speed: 0.0192s/iter; left time: 145.8867s
	iters: 500, epoch: 7 | loss: 0.0729422
	speed: 0.0176s/iter; left time: 131.7791s
Epoch: 7 cost time: 10.894546031951904
Epoch: 7, Steps: 570 | Train Loss: 0.0821850 Vali Loss: 0.0361992 Test Loss: 0.1348134
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0950183
	speed: 0.0542s/iter; left time: 395.9589s
	iters: 200, epoch: 8 | loss: 0.0805518
	speed: 0.0177s/iter; left time: 127.3448s
	iters: 300, epoch: 8 | loss: 0.0654092
	speed: 0.0175s/iter; left time: 124.4226s
	iters: 400, epoch: 8 | loss: 0.0921706
	speed: 0.0175s/iter; left time: 122.4825s
	iters: 500, epoch: 8 | loss: 0.0705560
	speed: 0.0175s/iter; left time: 120.7973s
Epoch: 8 cost time: 10.314321041107178
Epoch: 8, Steps: 570 | Train Loss: 0.0809429 Vali Loss: 0.0364012 Test Loss: 0.1336432
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1384367048740387, mae:0.23469723761081696
>>> S LR=1e-4 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3223662
	speed: 0.0310s/iter; left time: 349.8385s
	iters: 200, epoch: 1 | loss: 0.1537991
	speed: 0.0192s/iter; left time: 214.9751s
	iters: 300, epoch: 1 | loss: 0.1459450
	speed: 0.0192s/iter; left time: 212.9125s
	iters: 400, epoch: 1 | loss: 0.1189527
	speed: 0.0192s/iter; left time: 211.1802s
	iters: 500, epoch: 1 | loss: 0.1627327
	speed: 0.0193s/iter; left time: 210.1295s
Epoch: 1 cost time: 12.181188821792603
Epoch: 1, Steps: 570 | Train Loss: 0.1423495 Vali Loss: 0.0342566 Test Loss: 0.1160065
Validation loss decreased (inf --> 0.034257).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0784758
	speed: 0.0558s/iter; left time: 598.2651s
	iters: 200, epoch: 2 | loss: 0.1506225
	speed: 0.0173s/iter; left time: 184.0805s
	iters: 300, epoch: 2 | loss: 0.2018219
	speed: 0.0173s/iter; left time: 182.4797s
	iters: 400, epoch: 2 | loss: 0.0973798
	speed: 0.0173s/iter; left time: 180.6123s
	iters: 500, epoch: 2 | loss: 0.1013597
	speed: 0.0173s/iter; left time: 178.4293s
Epoch: 2 cost time: 10.181748151779175
Epoch: 2, Steps: 570 | Train Loss: 0.1110151 Vali Loss: 0.0337430 Test Loss: 0.1126297
Validation loss decreased (0.034257 --> 0.033743).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0723053
	speed: 0.0541s/iter; left time: 549.9428s
	iters: 200, epoch: 3 | loss: 0.0978308
	speed: 0.0172s/iter; left time: 172.9512s
	iters: 300, epoch: 3 | loss: 0.0877824
	speed: 0.0172s/iter; left time: 171.5160s
	iters: 400, epoch: 3 | loss: 0.0614958
	speed: 0.0173s/iter; left time: 170.5319s
	iters: 500, epoch: 3 | loss: 0.0828163
	speed: 0.0173s/iter; left time: 168.9123s
Epoch: 3 cost time: 10.158051013946533
Epoch: 3, Steps: 570 | Train Loss: 0.0935252 Vali Loss: 0.0314537 Test Loss: 0.1139202
Validation loss decreased (0.033743 --> 0.031454).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0771512
	speed: 0.0583s/iter; left time: 559.4688s
	iters: 200, epoch: 4 | loss: 0.0534194
	speed: 0.0193s/iter; left time: 183.5907s
	iters: 300, epoch: 4 | loss: 0.1008888
	speed: 0.0193s/iter; left time: 180.9237s
	iters: 400, epoch: 4 | loss: 0.0948127
	speed: 0.0193s/iter; left time: 179.0236s
	iters: 500, epoch: 4 | loss: 0.0655654
	speed: 0.0193s/iter; left time: 177.0600s
Epoch: 4 cost time: 11.285115242004395
Epoch: 4, Steps: 570 | Train Loss: 0.0819110 Vali Loss: 0.0310465 Test Loss: 0.1164873
Validation loss decreased (0.031454 --> 0.031047).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0758533
	speed: 0.0583s/iter; left time: 525.5884s
	iters: 200, epoch: 5 | loss: 0.0758113
	speed: 0.0192s/iter; left time: 171.2769s
	iters: 300, epoch: 5 | loss: 0.0891967
	speed: 0.0193s/iter; left time: 169.9390s
	iters: 400, epoch: 5 | loss: 0.0821188
	speed: 0.0192s/iter; left time: 167.8313s
	iters: 500, epoch: 5 | loss: 0.0690964
	speed: 0.0192s/iter; left time: 165.7583s
Epoch: 5 cost time: 11.268300533294678
Epoch: 5, Steps: 570 | Train Loss: 0.0740409 Vali Loss: 0.0303999 Test Loss: 0.1191382
Validation loss decreased (0.031047 --> 0.030400).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0895123
	speed: 0.0554s/iter; left time: 468.1509s
	iters: 200, epoch: 6 | loss: 0.0536418
	speed: 0.0172s/iter; left time: 143.5641s
	iters: 300, epoch: 6 | loss: 0.0760207
	speed: 0.0172s/iter; left time: 141.5171s
	iters: 400, epoch: 6 | loss: 0.0678308
	speed: 0.0171s/iter; left time: 139.6433s
	iters: 500, epoch: 6 | loss: 0.0411321
	speed: 0.0172s/iter; left time: 138.3257s
Epoch: 6 cost time: 10.097928524017334
Epoch: 6, Steps: 570 | Train Loss: 0.0698439 Vali Loss: 0.0305295 Test Loss: 0.1187626
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0552860
	speed: 0.0530s/iter; left time: 417.5852s
	iters: 200, epoch: 7 | loss: 0.0935592
	speed: 0.0172s/iter; left time: 133.7556s
	iters: 300, epoch: 7 | loss: 0.0567441
	speed: 0.0172s/iter; left time: 132.2304s
	iters: 400, epoch: 7 | loss: 0.0623800
	speed: 0.0172s/iter; left time: 130.0696s
	iters: 500, epoch: 7 | loss: 0.0650910
	speed: 0.0171s/iter; left time: 128.2927s
Epoch: 7 cost time: 10.111096143722534
Epoch: 7, Steps: 570 | Train Loss: 0.0675897 Vali Loss: 0.0309758 Test Loss: 0.1209820
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0728332
	speed: 0.0571s/iter; left time: 417.1719s
	iters: 200, epoch: 8 | loss: 0.0558225
	speed: 0.0172s/iter; left time: 123.6697s
	iters: 300, epoch: 8 | loss: 0.0704171
	speed: 0.0171s/iter; left time: 121.8922s
	iters: 400, epoch: 8 | loss: 0.0651876
	speed: 0.0171s/iter; left time: 120.1327s
	iters: 500, epoch: 8 | loss: 0.0807433
	speed: 0.0171s/iter; left time: 118.4248s
Epoch: 8 cost time: 10.200564622879028
Epoch: 8, Steps: 570 | Train Loss: 0.0664055 Vali Loss: 0.0309398 Test Loss: 0.1214902
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11929459869861603, mae:0.20892292261123657
>>> S LR=1e-4 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2252741
	speed: 0.0291s/iter; left time: 328.4273s
	iters: 200, epoch: 1 | loss: 0.1404136
	speed: 0.0173s/iter; left time: 194.3369s
	iters: 300, epoch: 1 | loss: 0.1691642
	speed: 0.0173s/iter; left time: 192.2905s
	iters: 400, epoch: 1 | loss: 0.1761250
	speed: 0.0174s/iter; left time: 191.1248s
	iters: 500, epoch: 1 | loss: 0.2730192
	speed: 0.0173s/iter; left time: 188.9027s
Epoch: 1 cost time: 11.114252805709839
Epoch: 1, Steps: 570 | Train Loss: 0.1801865 Vali Loss: 0.0387911 Test Loss: 0.1291970
Validation loss decreased (inf --> 0.038791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2010094
	speed: 0.0551s/iter; left time: 591.5420s
	iters: 200, epoch: 2 | loss: 0.1908115
	speed: 0.0174s/iter; left time: 184.8727s
	iters: 300, epoch: 2 | loss: 0.3098817
	speed: 0.0174s/iter; left time: 183.3936s
	iters: 400, epoch: 2 | loss: 0.1334588
	speed: 0.0173s/iter; left time: 180.9601s
	iters: 500, epoch: 2 | loss: 0.0747111
	speed: 0.0173s/iter; left time: 178.9152s
Epoch: 2 cost time: 10.178837299346924
Epoch: 2, Steps: 570 | Train Loss: 0.1407706 Vali Loss: 0.0440398 Test Loss: 0.1512494
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1279901
	speed: 0.0538s/iter; left time: 546.3621s
	iters: 200, epoch: 3 | loss: 0.1178784
	speed: 0.0174s/iter; left time: 174.9269s
	iters: 300, epoch: 3 | loss: 0.1103833
	speed: 0.0174s/iter; left time: 173.0862s
	iters: 400, epoch: 3 | loss: 0.1117758
	speed: 0.0172s/iter; left time: 170.0454s
	iters: 500, epoch: 3 | loss: 0.1324782
	speed: 0.0173s/iter; left time: 168.7216s
Epoch: 3 cost time: 10.13048243522644
Epoch: 3, Steps: 570 | Train Loss: 0.1160730 Vali Loss: 0.0439805 Test Loss: 0.1485361
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1113673
	speed: 0.0589s/iter; left time: 564.7424s
	iters: 200, epoch: 4 | loss: 0.1088809
	speed: 0.0174s/iter; left time: 164.7111s
	iters: 300, epoch: 4 | loss: 0.1000137
	speed: 0.0173s/iter; left time: 162.5458s
	iters: 400, epoch: 4 | loss: 0.0955741
	speed: 0.0173s/iter; left time: 160.8487s
	iters: 500, epoch: 4 | loss: 0.0771345
	speed: 0.0173s/iter; left time: 159.1351s
Epoch: 4 cost time: 10.330426454544067
Epoch: 4, Steps: 570 | Train Loss: 0.0994457 Vali Loss: 0.0423393 Test Loss: 0.1516935
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1293630748987198, mae:0.22743315994739532
>>> S LR=1e-4 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1872774
	speed: 0.0348s/iter; left time: 392.8727s
	iters: 200, epoch: 1 | loss: 0.1447681
	speed: 0.0229s/iter; left time: 255.9774s
	iters: 300, epoch: 1 | loss: 0.1686283
	speed: 0.0229s/iter; left time: 254.2185s
	iters: 400, epoch: 1 | loss: 0.2223143
	speed: 0.0229s/iter; left time: 251.8762s
	iters: 500, epoch: 1 | loss: 0.1182122
	speed: 0.0229s/iter; left time: 249.1608s
Epoch: 1 cost time: 14.288258075714111
Epoch: 1, Steps: 570 | Train Loss: 0.1732968 Vali Loss: 0.0392737 Test Loss: 0.1302366
Validation loss decreased (inf --> 0.039274).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2115427
	speed: 0.0664s/iter; left time: 712.1255s
	iters: 200, epoch: 2 | loss: 0.1138016
	speed: 0.0211s/iter; left time: 224.2331s
	iters: 300, epoch: 2 | loss: 0.1368152
	speed: 0.0211s/iter; left time: 222.1934s
	iters: 400, epoch: 2 | loss: 0.1201396
	speed: 0.0211s/iter; left time: 220.4947s
	iters: 500, epoch: 2 | loss: 0.0879762
	speed: 0.0212s/iter; left time: 218.8960s
Epoch: 2 cost time: 12.354658603668213
Epoch: 2, Steps: 570 | Train Loss: 0.1319375 Vali Loss: 0.0399654 Test Loss: 0.1381301
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1030464
	speed: 0.0592s/iter; left time: 601.5622s
	iters: 200, epoch: 3 | loss: 0.0800028
	speed: 0.0211s/iter; left time: 212.0714s
	iters: 300, epoch: 3 | loss: 0.1353042
	speed: 0.0211s/iter; left time: 209.9913s
	iters: 400, epoch: 3 | loss: 0.0666921
	speed: 0.0211s/iter; left time: 207.9270s
	iters: 500, epoch: 3 | loss: 0.0661069
	speed: 0.0211s/iter; left time: 205.7962s
Epoch: 3 cost time: 12.264823198318481
Epoch: 3, Steps: 570 | Train Loss: 0.0954629 Vali Loss: 0.0380892 Test Loss: 0.1371846
Validation loss decreased (0.039274 --> 0.038089).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0642974
	speed: 0.0623s/iter; left time: 597.5495s
	iters: 200, epoch: 4 | loss: 0.0724723
	speed: 0.0211s/iter; left time: 200.6587s
	iters: 300, epoch: 4 | loss: 0.0707682
	speed: 0.0211s/iter; left time: 198.5423s
	iters: 400, epoch: 4 | loss: 0.0734773
	speed: 0.0211s/iter; left time: 196.2793s
	iters: 500, epoch: 4 | loss: 0.1219664
	speed: 0.0211s/iter; left time: 194.1716s
Epoch: 4 cost time: 12.338412046432495
Epoch: 4, Steps: 570 | Train Loss: 0.0721301 Vali Loss: 0.0397866 Test Loss: 0.1427363
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0780199
	speed: 0.0592s/iter; left time: 534.1424s
	iters: 200, epoch: 5 | loss: 0.0691222
	speed: 0.0210s/iter; left time: 187.7602s
	iters: 300, epoch: 5 | loss: 0.0461139
	speed: 0.0210s/iter; left time: 185.5716s
	iters: 400, epoch: 5 | loss: 0.0467350
	speed: 0.0210s/iter; left time: 183.5231s
	iters: 500, epoch: 5 | loss: 0.0616004
	speed: 0.0210s/iter; left time: 181.4139s
Epoch: 5 cost time: 12.251110553741455
Epoch: 5, Steps: 570 | Train Loss: 0.0598048 Vali Loss: 0.0386900 Test Loss: 0.1446824
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0412926
	speed: 0.0605s/iter; left time: 511.0481s
	iters: 200, epoch: 6 | loss: 0.0501695
	speed: 0.0229s/iter; left time: 191.4878s
	iters: 300, epoch: 6 | loss: 0.0474828
	speed: 0.0229s/iter; left time: 189.1189s
	iters: 400, epoch: 6 | loss: 0.0527519
	speed: 0.0229s/iter; left time: 186.7120s
	iters: 500, epoch: 6 | loss: 0.0623095
	speed: 0.0229s/iter; left time: 184.4008s
Epoch: 6 cost time: 13.338027477264404
Epoch: 6, Steps: 570 | Train Loss: 0.0532735 Vali Loss: 0.0398041 Test Loss: 0.1435981
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13735033571720123, mae:0.2312895506620407
>>> S LR=1e-4 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1307315
	speed: 0.0332s/iter; left time: 374.7472s
	iters: 200, epoch: 1 | loss: 0.0811845
	speed: 0.0204s/iter; left time: 228.6638s
	iters: 300, epoch: 1 | loss: 0.1569342
	speed: 0.0204s/iter; left time: 226.7293s
	iters: 400, epoch: 1 | loss: 0.1080592
	speed: 0.0204s/iter; left time: 224.6137s
	iters: 500, epoch: 1 | loss: 0.1492227
	speed: 0.0205s/iter; left time: 223.0154s
Epoch: 1 cost time: 12.969544172286987
Epoch: 1, Steps: 570 | Train Loss: 0.1401710 Vali Loss: 0.0344650 Test Loss: 0.1175337
Validation loss decreased (inf --> 0.034465).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1400294
	speed: 0.0617s/iter; left time: 662.6367s
	iters: 200, epoch: 2 | loss: 0.0875229
	speed: 0.0204s/iter; left time: 217.2919s
	iters: 300, epoch: 2 | loss: 0.0964231
	speed: 0.0204s/iter; left time: 215.1518s
	iters: 400, epoch: 2 | loss: 0.0957646
	speed: 0.0204s/iter; left time: 212.9497s
	iters: 500, epoch: 2 | loss: 0.0726956
	speed: 0.0205s/iter; left time: 211.4356s
Epoch: 2 cost time: 11.947820901870728
Epoch: 2, Steps: 570 | Train Loss: 0.1061379 Vali Loss: 0.0311804 Test Loss: 0.1117883
Validation loss decreased (0.034465 --> 0.031180).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0765407
	speed: 0.0608s/iter; left time: 618.0210s
	iters: 200, epoch: 3 | loss: 0.0536560
	speed: 0.0205s/iter; left time: 206.3008s
	iters: 300, epoch: 3 | loss: 0.0819649
	speed: 0.0205s/iter; left time: 204.0405s
	iters: 400, epoch: 3 | loss: 0.0802400
	speed: 0.0205s/iter; left time: 202.2338s
	iters: 500, epoch: 3 | loss: 0.0542827
	speed: 0.0205s/iter; left time: 200.2110s
Epoch: 3 cost time: 11.9499671459198
Epoch: 3, Steps: 570 | Train Loss: 0.0796501 Vali Loss: 0.0326651 Test Loss: 0.1218082
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0489701
	speed: 0.0581s/iter; left time: 557.2066s
	iters: 200, epoch: 4 | loss: 0.0591686
	speed: 0.0204s/iter; left time: 193.7187s
	iters: 300, epoch: 4 | loss: 0.0679465
	speed: 0.0204s/iter; left time: 191.5339s
	iters: 400, epoch: 4 | loss: 0.0566241
	speed: 0.0204s/iter; left time: 189.6037s
	iters: 500, epoch: 4 | loss: 0.0541095
	speed: 0.0204s/iter; left time: 187.5588s
Epoch: 4 cost time: 11.9076669216156
Epoch: 4, Steps: 570 | Train Loss: 0.0599305 Vali Loss: 0.0330007 Test Loss: 0.1241303
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0501769
	speed: 0.0579s/iter; left time: 522.4895s
	iters: 200, epoch: 5 | loss: 0.0430184
	speed: 0.0204s/iter; left time: 181.8024s
	iters: 300, epoch: 5 | loss: 0.0489389
	speed: 0.0204s/iter; left time: 180.2287s
	iters: 400, epoch: 5 | loss: 0.0533599
	speed: 0.0204s/iter; left time: 177.5869s
	iters: 500, epoch: 5 | loss: 0.0442533
	speed: 0.0204s/iter; left time: 175.5637s
Epoch: 5 cost time: 11.870622634887695
Epoch: 5, Steps: 570 | Train Loss: 0.0489603 Vali Loss: 0.0332105 Test Loss: 0.1249898
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11193277686834335, mae:0.20117704570293427
>>> S LR=1e-4 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1895008
	speed: 0.0325s/iter; left time: 367.0149s
	iters: 200, epoch: 1 | loss: 0.1515586
	speed: 0.0203s/iter; left time: 227.1320s
	iters: 300, epoch: 1 | loss: 0.1879747
	speed: 0.0189s/iter; left time: 209.4613s
	iters: 400, epoch: 1 | loss: 0.2326094
	speed: 0.0189s/iter; left time: 207.3725s
	iters: 500, epoch: 1 | loss: 0.1998193
	speed: 0.0189s/iter; left time: 205.7985s
Epoch: 1 cost time: 12.313898801803589
Epoch: 1, Steps: 570 | Train Loss: 0.1778841 Vali Loss: 0.0422235 Test Loss: 0.1388667
Validation loss decreased (inf --> 0.042223).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1061218
	speed: 0.0566s/iter; left time: 607.0566s
	iters: 200, epoch: 2 | loss: 0.2115945
	speed: 0.0190s/iter; left time: 202.4050s
	iters: 300, epoch: 2 | loss: 0.1010315
	speed: 0.0190s/iter; left time: 200.4760s
	iters: 400, epoch: 2 | loss: 0.1336767
	speed: 0.0188s/iter; left time: 196.4817s
	iters: 500, epoch: 2 | loss: 0.1332264
	speed: 0.0189s/iter; left time: 194.8395s
Epoch: 2 cost time: 11.071871757507324
Epoch: 2, Steps: 570 | Train Loss: 0.1345591 Vali Loss: 0.0425646 Test Loss: 0.1445489
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0877677
	speed: 0.0560s/iter; left time: 569.3915s
	iters: 200, epoch: 3 | loss: 0.0766221
	speed: 0.0190s/iter; left time: 191.4483s
	iters: 300, epoch: 3 | loss: 0.0886867
	speed: 0.0190s/iter; left time: 189.0279s
	iters: 400, epoch: 3 | loss: 0.0766070
	speed: 0.0190s/iter; left time: 187.1886s
	iters: 500, epoch: 3 | loss: 0.1183335
	speed: 0.0190s/iter; left time: 185.2322s
Epoch: 3 cost time: 11.072660207748413
Epoch: 3, Steps: 570 | Train Loss: 0.0981138 Vali Loss: 0.0432297 Test Loss: 0.1489923
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0525346
	speed: 0.0582s/iter; left time: 557.7790s
	iters: 200, epoch: 4 | loss: 0.0605758
	speed: 0.0190s/iter; left time: 180.2842s
	iters: 300, epoch: 4 | loss: 0.0564853
	speed: 0.0190s/iter; left time: 178.6614s
	iters: 400, epoch: 4 | loss: 0.0809669
	speed: 0.0190s/iter; left time: 176.5015s
	iters: 500, epoch: 4 | loss: 0.0489134
	speed: 0.0190s/iter; left time: 174.7084s
Epoch: 4 cost time: 11.07692289352417
Epoch: 4, Steps: 570 | Train Loss: 0.0708599 Vali Loss: 0.0413611 Test Loss: 0.1548478
Validation loss decreased (0.042223 --> 0.041361).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0616358
	speed: 0.0575s/iter; left time: 518.4013s
	iters: 200, epoch: 5 | loss: 0.0585969
	speed: 0.0189s/iter; left time: 168.9086s
	iters: 300, epoch: 5 | loss: 0.0441107
	speed: 0.0189s/iter; left time: 166.8021s
	iters: 400, epoch: 5 | loss: 0.0460263
	speed: 0.0189s/iter; left time: 164.9785s
	iters: 500, epoch: 5 | loss: 0.0472431
	speed: 0.0189s/iter; left time: 163.0427s
Epoch: 5 cost time: 11.036574840545654
Epoch: 5, Steps: 570 | Train Loss: 0.0550584 Vali Loss: 0.0435567 Test Loss: 0.1537963
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0569783
	speed: 0.0557s/iter; left time: 470.9357s
	iters: 200, epoch: 6 | loss: 0.0524440
	speed: 0.0189s/iter; left time: 157.6939s
	iters: 300, epoch: 6 | loss: 0.0378715
	speed: 0.0190s/iter; left time: 156.4964s
	iters: 400, epoch: 6 | loss: 0.0366704
	speed: 0.0190s/iter; left time: 154.5286s
	iters: 500, epoch: 6 | loss: 0.0434721
	speed: 0.0189s/iter; left time: 151.8787s
Epoch: 6 cost time: 11.060080289840698
Epoch: 6, Steps: 570 | Train Loss: 0.0472978 Vali Loss: 0.0444979 Test Loss: 0.1594108
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0338765
	speed: 0.0562s/iter; left time: 443.2651s
	iters: 200, epoch: 7 | loss: 0.0439002
	speed: 0.0190s/iter; left time: 148.0442s
	iters: 300, epoch: 7 | loss: 0.0464330
	speed: 0.0189s/iter; left time: 145.5079s
	iters: 400, epoch: 7 | loss: 0.0402920
	speed: 0.0190s/iter; left time: 143.9754s
	iters: 500, epoch: 7 | loss: 0.0279832
	speed: 0.0190s/iter; left time: 142.2438s
Epoch: 7 cost time: 11.088609457015991
Epoch: 7, Steps: 570 | Train Loss: 0.0438559 Vali Loss: 0.0442440 Test Loss: 0.1588785
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1548682451248169, mae:0.24982161819934845
>>> S LR=1e-4 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1716709
	speed: 0.0233s/iter; left time: 262.9386s
	iters: 200, epoch: 1 | loss: 0.1680501
	speed: 0.0118s/iter; left time: 131.8198s
	iters: 300, epoch: 1 | loss: 0.2105089
	speed: 0.0126s/iter; left time: 140.3998s
	iters: 400, epoch: 1 | loss: 0.1852394
	speed: 0.0124s/iter; left time: 136.1260s
	iters: 500, epoch: 1 | loss: 0.1472320
	speed: 0.0120s/iter; left time: 130.6538s
Epoch: 1 cost time: 8.08841061592102
Epoch: 1, Steps: 570 | Train Loss: 0.2096845 Vali Loss: 0.0473407 Test Loss: 0.1417611
Validation loss decreased (inf --> 0.047341).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2694356
	speed: 0.0397s/iter; left time: 426.3390s
	iters: 200, epoch: 2 | loss: 0.2620774
	speed: 0.0121s/iter; left time: 128.3926s
	iters: 300, epoch: 2 | loss: 0.1389521
	speed: 0.0111s/iter; left time: 117.1229s
	iters: 400, epoch: 2 | loss: 0.1365739
	speed: 0.0106s/iter; left time: 110.6616s
	iters: 500, epoch: 2 | loss: 0.1383535
	speed: 0.0106s/iter; left time: 109.3078s
Epoch: 2 cost time: 6.6483235359191895
Epoch: 2, Steps: 570 | Train Loss: 0.1752361 Vali Loss: 0.0424280 Test Loss: 0.1268324
Validation loss decreased (0.047341 --> 0.042428).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1197155
	speed: 0.0382s/iter; left time: 388.2203s
	iters: 200, epoch: 3 | loss: 0.2017812
	speed: 0.0120s/iter; left time: 120.3508s
	iters: 300, epoch: 3 | loss: 0.1617252
	speed: 0.0120s/iter; left time: 119.3869s
	iters: 400, epoch: 3 | loss: 0.1708789
	speed: 0.0120s/iter; left time: 117.9500s
	iters: 500, epoch: 3 | loss: 0.2024438
	speed: 0.0119s/iter; left time: 116.6371s
Epoch: 3 cost time: 7.102278232574463
Epoch: 3, Steps: 570 | Train Loss: 0.1595445 Vali Loss: 0.0363905 Test Loss: 0.1225952
Validation loss decreased (0.042428 --> 0.036391).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1448666
	speed: 0.0374s/iter; left time: 359.0353s
	iters: 200, epoch: 4 | loss: 0.0975759
	speed: 0.0119s/iter; left time: 113.1892s
	iters: 300, epoch: 4 | loss: 0.1550283
	speed: 0.0120s/iter; left time: 112.2331s
	iters: 400, epoch: 4 | loss: 0.1763410
	speed: 0.0119s/iter; left time: 110.9697s
	iters: 500, epoch: 4 | loss: 0.1503519
	speed: 0.0119s/iter; left time: 109.5502s
Epoch: 4 cost time: 7.046257972717285
Epoch: 4, Steps: 570 | Train Loss: 0.1521451 Vali Loss: 0.0365639 Test Loss: 0.1224743
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1409172
	speed: 0.0391s/iter; left time: 353.1333s
	iters: 200, epoch: 5 | loss: 0.1500045
	speed: 0.0115s/iter; left time: 102.2650s
	iters: 300, epoch: 5 | loss: 0.1134137
	speed: 0.0105s/iter; left time: 92.6956s
	iters: 400, epoch: 5 | loss: 0.1495363
	speed: 0.0105s/iter; left time: 91.6812s
	iters: 500, epoch: 5 | loss: 0.1490495
	speed: 0.0105s/iter; left time: 90.6077s
Epoch: 5 cost time: 6.49549412727356
Epoch: 5, Steps: 570 | Train Loss: 0.1491625 Vali Loss: 0.0361480 Test Loss: 0.1224032
Validation loss decreased (0.036391 --> 0.036148).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1424339
	speed: 0.0357s/iter; left time: 301.4483s
	iters: 200, epoch: 6 | loss: 0.0976709
	speed: 0.0104s/iter; left time: 87.0993s
	iters: 300, epoch: 6 | loss: 0.1468315
	speed: 0.0104s/iter; left time: 86.1931s
	iters: 400, epoch: 6 | loss: 0.1550857
	speed: 0.0105s/iter; left time: 85.2527s
	iters: 500, epoch: 6 | loss: 0.1561182
	speed: 0.0105s/iter; left time: 84.1878s
Epoch: 6 cost time: 6.225510120391846
Epoch: 6, Steps: 570 | Train Loss: 0.1467316 Vali Loss: 0.0359291 Test Loss: 0.1226117
Validation loss decreased (0.036148 --> 0.035929).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1476564
	speed: 0.0351s/iter; left time: 276.6786s
	iters: 200, epoch: 7 | loss: 0.1964862
	speed: 0.0105s/iter; left time: 81.4358s
	iters: 300, epoch: 7 | loss: 0.1252531
	speed: 0.0105s/iter; left time: 80.3588s
	iters: 400, epoch: 7 | loss: 0.1065932
	speed: 0.0105s/iter; left time: 79.2990s
	iters: 500, epoch: 7 | loss: 0.1310224
	speed: 0.0105s/iter; left time: 78.2581s
Epoch: 7 cost time: 6.230513095855713
Epoch: 7, Steps: 570 | Train Loss: 0.1465212 Vali Loss: 0.0360432 Test Loss: 0.1255601
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1568825
	speed: 0.0376s/iter; left time: 275.0250s
	iters: 200, epoch: 8 | loss: 0.1421954
	speed: 0.0118s/iter; left time: 84.9933s
	iters: 300, epoch: 8 | loss: 0.1710738
	speed: 0.0118s/iter; left time: 83.7580s
	iters: 400, epoch: 8 | loss: 0.1755635
	speed: 0.0111s/iter; left time: 77.9085s
	iters: 500, epoch: 8 | loss: 0.1044384
	speed: 0.0110s/iter; left time: 75.9690s
Epoch: 8 cost time: 6.768409252166748
Epoch: 8, Steps: 570 | Train Loss: 0.1448837 Vali Loss: 0.0357890 Test Loss: 0.1271300
Validation loss decreased (0.035929 --> 0.035789).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1892420
	speed: 0.0378s/iter; left time: 255.0695s
	iters: 200, epoch: 9 | loss: 0.1466364
	speed: 0.0105s/iter; left time: 69.8796s
	iters: 300, epoch: 9 | loss: 0.0691582
	speed: 0.0106s/iter; left time: 69.0257s
	iters: 400, epoch: 9 | loss: 0.1330570
	speed: 0.0105s/iter; left time: 67.6472s
	iters: 500, epoch: 9 | loss: 0.1087972
	speed: 0.0105s/iter; left time: 66.6586s
Epoch: 9 cost time: 6.274548053741455
Epoch: 9, Steps: 570 | Train Loss: 0.1447670 Vali Loss: 0.0363026 Test Loss: 0.1257825
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1383858
	speed: 0.0347s/iter; left time: 214.1608s
	iters: 200, epoch: 10 | loss: 0.1384074
	speed: 0.0105s/iter; left time: 63.6082s
	iters: 300, epoch: 10 | loss: 0.1130214
	speed: 0.0105s/iter; left time: 62.6452s
	iters: 400, epoch: 10 | loss: 0.1108113
	speed: 0.0105s/iter; left time: 61.7233s
	iters: 500, epoch: 10 | loss: 0.2126138
	speed: 0.0105s/iter; left time: 60.4700s
Epoch: 10 cost time: 6.243441820144653
Epoch: 10, Steps: 570 | Train Loss: 0.1451951 Vali Loss: 0.0361944 Test Loss: 0.1254286
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1702595
	speed: 0.0349s/iter; left time: 195.3082s
	iters: 200, epoch: 11 | loss: 0.1256020
	speed: 0.0105s/iter; left time: 57.6198s
	iters: 300, epoch: 11 | loss: 0.1112357
	speed: 0.0105s/iter; left time: 56.7259s
	iters: 400, epoch: 11 | loss: 0.2002600
	speed: 0.0105s/iter; left time: 55.7127s
	iters: 500, epoch: 11 | loss: 0.1326046
	speed: 0.0105s/iter; left time: 54.4311s
Epoch: 11 cost time: 6.22341513633728
Epoch: 11, Steps: 570 | Train Loss: 0.1453018 Vali Loss: 0.0360404 Test Loss: 0.1257782
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12727469205856323, mae:0.22043658792972565
>>> S LR=1e-4 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1651134
	speed: 0.0235s/iter; left time: 265.6288s
	iters: 200, epoch: 1 | loss: 0.1806086
	speed: 0.0107s/iter; left time: 119.5245s
	iters: 300, epoch: 1 | loss: 0.2102987
	speed: 0.0102s/iter; left time: 113.5183s
	iters: 400, epoch: 1 | loss: 0.1629782
	speed: 0.0102s/iter; left time: 112.0086s
	iters: 500, epoch: 1 | loss: 0.1705235
	speed: 0.0102s/iter; left time: 111.2846s
Epoch: 1 cost time: 7.2434892654418945
Epoch: 1, Steps: 570 | Train Loss: 0.1796028 Vali Loss: 0.0331331 Test Loss: 0.1113740
Validation loss decreased (inf --> 0.033133).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1256245
	speed: 0.0357s/iter; left time: 382.8766s
	iters: 200, epoch: 2 | loss: 0.1624190
	speed: 0.0102s/iter; left time: 108.0205s
	iters: 300, epoch: 2 | loss: 0.1027738
	speed: 0.0101s/iter; left time: 106.6335s
	iters: 400, epoch: 2 | loss: 0.1088365
	speed: 0.0101s/iter; left time: 105.7798s
	iters: 500, epoch: 2 | loss: 0.1347262
	speed: 0.0101s/iter; left time: 104.6764s
Epoch: 2 cost time: 6.095789194107056
Epoch: 2, Steps: 570 | Train Loss: 0.1512439 Vali Loss: 0.0316324 Test Loss: 0.1092647
Validation loss decreased (0.033133 --> 0.031632).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0792591
	speed: 0.0370s/iter; left time: 376.4574s
	iters: 200, epoch: 3 | loss: 0.1346280
	speed: 0.0102s/iter; left time: 102.7189s
	iters: 300, epoch: 3 | loss: 0.2838683
	speed: 0.0102s/iter; left time: 101.7651s
	iters: 400, epoch: 3 | loss: 0.1754148
	speed: 0.0102s/iter; left time: 100.2869s
	iters: 500, epoch: 3 | loss: 0.1048901
	speed: 0.0102s/iter; left time: 99.2120s
Epoch: 3 cost time: 6.129308462142944
Epoch: 3, Steps: 570 | Train Loss: 0.1403791 Vali Loss: 0.0308450 Test Loss: 0.1069642
Validation loss decreased (0.031632 --> 0.030845).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1125914
	speed: 0.0356s/iter; left time: 341.5953s
	iters: 200, epoch: 4 | loss: 0.1180120
	speed: 0.0101s/iter; left time: 96.2717s
	iters: 300, epoch: 4 | loss: 0.0918153
	speed: 0.0102s/iter; left time: 95.3995s
	iters: 400, epoch: 4 | loss: 0.0874710
	speed: 0.0102s/iter; left time: 94.4938s
	iters: 500, epoch: 4 | loss: 0.1819843
	speed: 0.0102s/iter; left time: 93.4642s
Epoch: 4 cost time: 6.078930616378784
Epoch: 4, Steps: 570 | Train Loss: 0.1353338 Vali Loss: 0.0302711 Test Loss: 0.1051226
Validation loss decreased (0.030845 --> 0.030271).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1218018
	speed: 0.0371s/iter; left time: 334.8255s
	iters: 200, epoch: 5 | loss: 0.1669005
	speed: 0.0103s/iter; left time: 91.9001s
	iters: 300, epoch: 5 | loss: 0.1286697
	speed: 0.0103s/iter; left time: 90.6609s
	iters: 400, epoch: 5 | loss: 0.1268324
	speed: 0.0103s/iter; left time: 89.5774s
	iters: 500, epoch: 5 | loss: 0.1412142
	speed: 0.0103s/iter; left time: 88.7014s
Epoch: 5 cost time: 6.154053211212158
Epoch: 5, Steps: 570 | Train Loss: 0.1332872 Vali Loss: 0.0305537 Test Loss: 0.1064819
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0967489
	speed: 0.0359s/iter; left time: 303.6757s
	iters: 200, epoch: 6 | loss: 0.1691709
	speed: 0.0102s/iter; left time: 85.4724s
	iters: 300, epoch: 6 | loss: 0.1384994
	speed: 0.0102s/iter; left time: 84.3480s
	iters: 400, epoch: 6 | loss: 0.0993744
	speed: 0.0102s/iter; left time: 83.2584s
	iters: 500, epoch: 6 | loss: 0.0939252
	speed: 0.0102s/iter; left time: 82.0162s
Epoch: 6 cost time: 6.103968858718872
Epoch: 6, Steps: 570 | Train Loss: 0.1320285 Vali Loss: 0.0304982 Test Loss: 0.1057930
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1180709
	speed: 0.0355s/iter; left time: 279.7728s
	iters: 200, epoch: 7 | loss: 0.1381727
	speed: 0.0102s/iter; left time: 79.6986s
	iters: 300, epoch: 7 | loss: 0.2374370
	speed: 0.0102s/iter; left time: 78.6621s
	iters: 400, epoch: 7 | loss: 0.1835917
	speed: 0.0102s/iter; left time: 77.6013s
	iters: 500, epoch: 7 | loss: 0.1461123
	speed: 0.0102s/iter; left time: 76.5409s
Epoch: 7 cost time: 6.124538898468018
Epoch: 7, Steps: 570 | Train Loss: 0.1318414 Vali Loss: 0.0301305 Test Loss: 0.1054016
Validation loss decreased (0.030271 --> 0.030130).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1121624
	speed: 0.0359s/iter; left time: 262.6471s
	iters: 200, epoch: 8 | loss: 0.1084039
	speed: 0.0101s/iter; left time: 73.0948s
	iters: 300, epoch: 8 | loss: 0.1131438
	speed: 0.0102s/iter; left time: 72.1905s
	iters: 400, epoch: 8 | loss: 0.1263542
	speed: 0.0102s/iter; left time: 71.2664s
	iters: 500, epoch: 8 | loss: 0.0841544
	speed: 0.0102s/iter; left time: 70.3004s
Epoch: 8 cost time: 6.100199937820435
Epoch: 8, Steps: 570 | Train Loss: 0.1315770 Vali Loss: 0.0301961 Test Loss: 0.1053372
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1223309
	speed: 0.0359s/iter; left time: 241.8084s
	iters: 200, epoch: 9 | loss: 0.1394351
	speed: 0.0117s/iter; left time: 77.5430s
	iters: 300, epoch: 9 | loss: 0.1136253
	speed: 0.0117s/iter; left time: 76.5496s
	iters: 400, epoch: 9 | loss: 0.1610978
	speed: 0.0117s/iter; left time: 75.4025s
	iters: 500, epoch: 9 | loss: 0.1094243
	speed: 0.0117s/iter; left time: 74.3293s
Epoch: 9 cost time: 6.858788251876831
Epoch: 9, Steps: 570 | Train Loss: 0.1311235 Vali Loss: 0.0302564 Test Loss: 0.1054424
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1697244
	speed: 0.0383s/iter; left time: 236.0794s
	iters: 200, epoch: 10 | loss: 0.1073634
	speed: 0.0102s/iter; left time: 61.6505s
	iters: 300, epoch: 10 | loss: 0.1128583
	speed: 0.0102s/iter; left time: 60.6873s
	iters: 400, epoch: 10 | loss: 0.0902336
	speed: 0.0101s/iter; left time: 59.5805s
	iters: 500, epoch: 10 | loss: 0.0898585
	speed: 0.0101s/iter; left time: 58.5482s
Epoch: 10 cost time: 6.228284120559692
Epoch: 10, Steps: 570 | Train Loss: 0.1318358 Vali Loss: 0.0302200 Test Loss: 0.1054705
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10553944855928421, mae:0.19426867365837097
>>> S LR=1e-4 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2173998
	speed: 0.0221s/iter; left time: 250.2854s
	iters: 200, epoch: 1 | loss: 0.1616890
	speed: 0.0102s/iter; left time: 114.2797s
	iters: 300, epoch: 1 | loss: 0.1509739
	speed: 0.0102s/iter; left time: 113.5804s
	iters: 400, epoch: 1 | loss: 0.1123783
	speed: 0.0102s/iter; left time: 112.1922s
	iters: 500, epoch: 1 | loss: 0.2070474
	speed: 0.0102s/iter; left time: 111.4168s
Epoch: 1 cost time: 7.068479537963867
Epoch: 1, Steps: 570 | Train Loss: 0.2182511 Vali Loss: 0.0441422 Test Loss: 0.1336455
Validation loss decreased (inf --> 0.044142).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1845077
	speed: 0.0367s/iter; left time: 394.0838s
	iters: 200, epoch: 2 | loss: 0.1996330
	speed: 0.0102s/iter; left time: 108.4167s
	iters: 300, epoch: 2 | loss: 0.1672538
	speed: 0.0102s/iter; left time: 107.6160s
	iters: 400, epoch: 2 | loss: 0.2765732
	speed: 0.0102s/iter; left time: 106.8201s
	iters: 500, epoch: 2 | loss: 0.2438993
	speed: 0.0102s/iter; left time: 105.5838s
Epoch: 2 cost time: 6.104103088378906
Epoch: 2, Steps: 570 | Train Loss: 0.1827459 Vali Loss: 0.0388668 Test Loss: 0.1268005
Validation loss decreased (0.044142 --> 0.038867).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1327910
	speed: 0.0364s/iter; left time: 370.0487s
	iters: 200, epoch: 3 | loss: 0.1367597
	speed: 0.0102s/iter; left time: 103.0585s
	iters: 300, epoch: 3 | loss: 0.2261742
	speed: 0.0102s/iter; left time: 101.9818s
	iters: 400, epoch: 3 | loss: 0.1418937
	speed: 0.0102s/iter; left time: 100.8430s
	iters: 500, epoch: 3 | loss: 0.1004469
	speed: 0.0102s/iter; left time: 99.6471s
Epoch: 3 cost time: 6.122304439544678
Epoch: 3, Steps: 570 | Train Loss: 0.1696331 Vali Loss: 0.0388819 Test Loss: 0.1262188
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1031976
	speed: 0.0347s/iter; left time: 332.7056s
	iters: 200, epoch: 4 | loss: 0.1228962
	speed: 0.0101s/iter; left time: 95.6922s
	iters: 300, epoch: 4 | loss: 0.1209688
	speed: 0.0101s/iter; left time: 95.2334s
	iters: 400, epoch: 4 | loss: 0.2148496
	speed: 0.0102s/iter; left time: 94.6140s
	iters: 500, epoch: 4 | loss: 0.1434219
	speed: 0.0102s/iter; left time: 93.3889s
Epoch: 4 cost time: 6.037465810775757
Epoch: 4, Steps: 570 | Train Loss: 0.1636838 Vali Loss: 0.0382296 Test Loss: 0.1254483
Validation loss decreased (0.038867 --> 0.038230).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1327286
	speed: 0.0360s/iter; left time: 324.5486s
	iters: 200, epoch: 5 | loss: 0.0855692
	speed: 0.0102s/iter; left time: 90.6371s
	iters: 300, epoch: 5 | loss: 0.1943658
	speed: 0.0101s/iter; left time: 89.4792s
	iters: 400, epoch: 5 | loss: 0.1533574
	speed: 0.0102s/iter; left time: 88.5748s
	iters: 500, epoch: 5 | loss: 0.2045862
	speed: 0.0101s/iter; left time: 87.4623s
Epoch: 5 cost time: 6.079162836074829
Epoch: 5, Steps: 570 | Train Loss: 0.1614243 Vali Loss: 0.0380380 Test Loss: 0.1238637
Validation loss decreased (0.038230 --> 0.038038).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1239913
	speed: 0.0365s/iter; left time: 308.2760s
	iters: 200, epoch: 6 | loss: 0.1821048
	speed: 0.0101s/iter; left time: 84.6900s
	iters: 300, epoch: 6 | loss: 0.1310985
	speed: 0.0102s/iter; left time: 83.9698s
	iters: 400, epoch: 6 | loss: 0.1130036
	speed: 0.0102s/iter; left time: 82.9673s
	iters: 500, epoch: 6 | loss: 0.2103380
	speed: 0.0101s/iter; left time: 81.5982s
Epoch: 6 cost time: 6.029457092285156
Epoch: 6, Steps: 570 | Train Loss: 0.1593995 Vali Loss: 0.0379537 Test Loss: 0.1243451
Validation loss decreased (0.038038 --> 0.037954).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1148501
	speed: 0.0362s/iter; left time: 285.0552s
	iters: 200, epoch: 7 | loss: 0.1806654
	speed: 0.0115s/iter; left time: 89.1667s
	iters: 300, epoch: 7 | loss: 0.1485318
	speed: 0.0115s/iter; left time: 88.0696s
	iters: 400, epoch: 7 | loss: 0.0870579
	speed: 0.0115s/iter; left time: 86.8855s
	iters: 500, epoch: 7 | loss: 0.2068649
	speed: 0.0114s/iter; left time: 85.5473s
Epoch: 7 cost time: 6.814827919006348
Epoch: 7, Steps: 570 | Train Loss: 0.1576800 Vali Loss: 0.0378578 Test Loss: 0.1242085
Validation loss decreased (0.037954 --> 0.037858).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1335312
	speed: 0.0364s/iter; left time: 266.1635s
	iters: 200, epoch: 8 | loss: 0.1534756
	speed: 0.0101s/iter; left time: 73.0198s
	iters: 300, epoch: 8 | loss: 0.1300088
	speed: 0.0102s/iter; left time: 72.2760s
	iters: 400, epoch: 8 | loss: 0.1975915
	speed: 0.0102s/iter; left time: 71.1786s
	iters: 500, epoch: 8 | loss: 0.1460537
	speed: 0.0101s/iter; left time: 70.0257s
Epoch: 8 cost time: 6.046162366867065
Epoch: 8, Steps: 570 | Train Loss: 0.1566480 Vali Loss: 0.0379453 Test Loss: 0.1241363
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1355364
	speed: 0.0349s/iter; left time: 235.0685s
	iters: 200, epoch: 9 | loss: 0.2049347
	speed: 0.0102s/iter; left time: 67.5307s
	iters: 300, epoch: 9 | loss: 0.1720397
	speed: 0.0102s/iter; left time: 66.4390s
	iters: 400, epoch: 9 | loss: 0.1383737
	speed: 0.0102s/iter; left time: 65.4610s
	iters: 500, epoch: 9 | loss: 0.1659307
	speed: 0.0101s/iter; left time: 64.3460s
Epoch: 9 cost time: 6.063991069793701
Epoch: 9, Steps: 570 | Train Loss: 0.1565384 Vali Loss: 0.0379514 Test Loss: 0.1243054
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1211166
	speed: 0.0357s/iter; left time: 220.1719s
	iters: 200, epoch: 10 | loss: 0.1906038
	speed: 0.0102s/iter; left time: 61.8721s
	iters: 300, epoch: 10 | loss: 0.2134787
	speed: 0.0102s/iter; left time: 60.6528s
	iters: 400, epoch: 10 | loss: 0.2099930
	speed: 0.0101s/iter; left time: 59.5168s
	iters: 500, epoch: 10 | loss: 0.1702721
	speed: 0.0101s/iter; left time: 58.4363s
Epoch: 10 cost time: 6.070331811904907
Epoch: 10, Steps: 570 | Train Loss: 0.1584549 Vali Loss: 0.0378923 Test Loss: 0.1243168
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12434937059879303, mae:0.22398309409618378
>>> S LR=1e-4 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2198863
	speed: 0.0233s/iter; left time: 262.7671s
	iters: 200, epoch: 1 | loss: 0.2025427
	speed: 0.0117s/iter; left time: 130.9480s
	iters: 300, epoch: 1 | loss: 0.1526745
	speed: 0.0117s/iter; left time: 129.3749s
	iters: 400, epoch: 1 | loss: 0.1271116
	speed: 0.0117s/iter; left time: 128.3259s
	iters: 500, epoch: 1 | loss: 0.1804385
	speed: 0.0117s/iter; left time: 127.0790s
Epoch: 1 cost time: 7.861356496810913
Epoch: 1, Steps: 570 | Train Loss: 0.2065445 Vali Loss: 0.0406334 Test Loss: 0.1317940
Validation loss decreased (inf --> 0.040633).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1871311
	speed: 0.0403s/iter; left time: 432.0333s
	iters: 200, epoch: 2 | loss: 0.1567474
	speed: 0.0119s/iter; left time: 126.8827s
	iters: 300, epoch: 2 | loss: 0.1535908
	speed: 0.0117s/iter; left time: 122.8020s
	iters: 400, epoch: 2 | loss: 0.0976590
	speed: 0.0116s/iter; left time: 121.3400s
	iters: 500, epoch: 2 | loss: 0.1626368
	speed: 0.0124s/iter; left time: 127.8464s
Epoch: 2 cost time: 7.24831223487854
Epoch: 2, Steps: 570 | Train Loss: 0.1725813 Vali Loss: 0.0375763 Test Loss: 0.1298747
Validation loss decreased (0.040633 --> 0.037576).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1949913
	speed: 0.0390s/iter; left time: 396.6284s
	iters: 200, epoch: 3 | loss: 0.1931999
	speed: 0.0117s/iter; left time: 117.5405s
	iters: 300, epoch: 3 | loss: 0.1088100
	speed: 0.0117s/iter; left time: 116.4915s
	iters: 400, epoch: 3 | loss: 0.1409307
	speed: 0.0117s/iter; left time: 115.0454s
	iters: 500, epoch: 3 | loss: 0.0911075
	speed: 0.0117s/iter; left time: 114.0967s
Epoch: 3 cost time: 6.949405670166016
Epoch: 3, Steps: 570 | Train Loss: 0.1534020 Vali Loss: 0.0364753 Test Loss: 0.1312387
Validation loss decreased (0.037576 --> 0.036475).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1246247
	speed: 0.0384s/iter; left time: 368.1321s
	iters: 200, epoch: 4 | loss: 0.1611446
	speed: 0.0118s/iter; left time: 111.7852s
	iters: 300, epoch: 4 | loss: 0.0892751
	speed: 0.0118s/iter; left time: 110.3690s
	iters: 400, epoch: 4 | loss: 0.1080733
	speed: 0.0118s/iter; left time: 109.2118s
	iters: 500, epoch: 4 | loss: 0.1236375
	speed: 0.0118s/iter; left time: 108.0304s
Epoch: 4 cost time: 7.02014946937561
Epoch: 4, Steps: 570 | Train Loss: 0.1430705 Vali Loss: 0.0365072 Test Loss: 0.1460692
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1408976
	speed: 0.0382s/iter; left time: 344.3861s
	iters: 200, epoch: 5 | loss: 0.1269062
	speed: 0.0118s/iter; left time: 104.9847s
	iters: 300, epoch: 5 | loss: 0.1929084
	speed: 0.0118s/iter; left time: 103.8877s
	iters: 400, epoch: 5 | loss: 0.1300407
	speed: 0.0118s/iter; left time: 102.7201s
	iters: 500, epoch: 5 | loss: 0.1385172
	speed: 0.0118s/iter; left time: 101.2988s
Epoch: 5 cost time: 6.998714447021484
Epoch: 5, Steps: 570 | Train Loss: 0.1374966 Vali Loss: 0.0360869 Test Loss: 0.1324077
Validation loss decreased (0.036475 --> 0.036087).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1085885
	speed: 0.0397s/iter; left time: 335.7043s
	iters: 200, epoch: 6 | loss: 0.0761222
	speed: 0.0117s/iter; left time: 97.7608s
	iters: 300, epoch: 6 | loss: 0.1234956
	speed: 0.0117s/iter; left time: 96.4905s
	iters: 400, epoch: 6 | loss: 0.1342998
	speed: 0.0117s/iter; left time: 95.5581s
	iters: 500, epoch: 6 | loss: 0.1021313
	speed: 0.0117s/iter; left time: 94.3455s
Epoch: 6 cost time: 6.955455780029297
Epoch: 6, Steps: 570 | Train Loss: 0.1335537 Vali Loss: 0.0357151 Test Loss: 0.1372023
Validation loss decreased (0.036087 --> 0.035715).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1423124
	speed: 0.0388s/iter; left time: 305.4930s
	iters: 200, epoch: 7 | loss: 0.1588731
	speed: 0.0117s/iter; left time: 91.1706s
	iters: 300, epoch: 7 | loss: 0.1292349
	speed: 0.0117s/iter; left time: 90.1609s
	iters: 400, epoch: 7 | loss: 0.0965391
	speed: 0.0117s/iter; left time: 88.6973s
	iters: 500, epoch: 7 | loss: 0.1123675
	speed: 0.0117s/iter; left time: 87.3736s
Epoch: 7 cost time: 6.979832410812378
Epoch: 7, Steps: 570 | Train Loss: 0.1322881 Vali Loss: 0.0359908 Test Loss: 0.1368481
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0886679
	speed: 0.0399s/iter; left time: 291.4879s
	iters: 200, epoch: 8 | loss: 0.1227034
	speed: 0.0128s/iter; left time: 92.0137s
	iters: 300, epoch: 8 | loss: 0.1341124
	speed: 0.0123s/iter; left time: 87.5752s
	iters: 400, epoch: 8 | loss: 0.1256883
	speed: 0.0117s/iter; left time: 81.9634s
	iters: 500, epoch: 8 | loss: 0.0965294
	speed: 0.0117s/iter; left time: 80.7357s
Epoch: 8 cost time: 7.255961894989014
Epoch: 8, Steps: 570 | Train Loss: 0.1320049 Vali Loss: 0.0358270 Test Loss: 0.1360172
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0991801
	speed: 0.0386s/iter; left time: 260.0351s
	iters: 200, epoch: 9 | loss: 0.1070644
	speed: 0.0127s/iter; left time: 84.0266s
	iters: 300, epoch: 9 | loss: 0.1433761
	speed: 0.0127s/iter; left time: 83.3612s
	iters: 400, epoch: 9 | loss: 0.0909570
	speed: 0.0127s/iter; left time: 82.1009s
	iters: 500, epoch: 9 | loss: 0.1360292
	speed: 0.0127s/iter; left time: 80.8087s
Epoch: 9 cost time: 7.469010829925537
Epoch: 9, Steps: 570 | Train Loss: 0.1321559 Vali Loss: 0.0355756 Test Loss: 0.1352010
Validation loss decreased (0.035715 --> 0.035576).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1124339
	speed: 0.0401s/iter; left time: 247.3788s
	iters: 200, epoch: 10 | loss: 0.1268232
	speed: 0.0126s/iter; left time: 76.4419s
	iters: 300, epoch: 10 | loss: 0.1080614
	speed: 0.0128s/iter; left time: 76.2520s
	iters: 400, epoch: 10 | loss: 0.0967346
	speed: 0.0128s/iter; left time: 74.9468s
	iters: 500, epoch: 10 | loss: 0.1687416
	speed: 0.0128s/iter; left time: 73.7229s
Epoch: 10 cost time: 7.446200847625732
Epoch: 10, Steps: 570 | Train Loss: 0.1314765 Vali Loss: 0.0358681 Test Loss: 0.1342212
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1098042
	speed: 0.0388s/iter; left time: 217.5843s
	iters: 200, epoch: 11 | loss: 0.2070942
	speed: 0.0116s/iter; left time: 63.9959s
	iters: 300, epoch: 11 | loss: 0.1247187
	speed: 0.0116s/iter; left time: 62.8368s
	iters: 400, epoch: 11 | loss: 0.1243200
	speed: 0.0116s/iter; left time: 61.6520s
	iters: 500, epoch: 11 | loss: 0.1786107
	speed: 0.0116s/iter; left time: 60.4688s
Epoch: 11 cost time: 6.897024869918823
Epoch: 11, Steps: 570 | Train Loss: 0.1310345 Vali Loss: 0.0359499 Test Loss: 0.1341955
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1068341
	speed: 0.0392s/iter; left time: 197.0056s
	iters: 200, epoch: 12 | loss: 0.0890755
	speed: 0.0117s/iter; left time: 57.5471s
	iters: 300, epoch: 12 | loss: 0.1151057
	speed: 0.0117s/iter; left time: 56.3769s
	iters: 400, epoch: 12 | loss: 0.1089877
	speed: 0.0117s/iter; left time: 55.3124s
	iters: 500, epoch: 12 | loss: 0.1118197
	speed: 0.0117s/iter; left time: 54.0496s
Epoch: 12 cost time: 6.9470555782318115
Epoch: 12, Steps: 570 | Train Loss: 0.1308052 Vali Loss: 0.0360543 Test Loss: 0.1340677
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13534358143806458, mae:0.22644494473934174
>>> S LR=1e-4 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1023206
	speed: 0.0228s/iter; left time: 257.9008s
	iters: 200, epoch: 1 | loss: 0.2467593
	speed: 0.0112s/iter; left time: 125.9966s
	iters: 300, epoch: 1 | loss: 0.1271292
	speed: 0.0113s/iter; left time: 125.0142s
	iters: 400, epoch: 1 | loss: 0.1668284
	speed: 0.0112s/iter; left time: 123.6937s
	iters: 500, epoch: 1 | loss: 0.1152504
	speed: 0.0112s/iter; left time: 122.5893s
Epoch: 1 cost time: 7.620620965957642
Epoch: 1, Steps: 570 | Train Loss: 0.1769825 Vali Loss: 0.0339524 Test Loss: 0.1106412
Validation loss decreased (inf --> 0.033952).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1284412
	speed: 0.0383s/iter; left time: 410.7933s
	iters: 200, epoch: 2 | loss: 0.0970486
	speed: 0.0113s/iter; left time: 120.6039s
	iters: 300, epoch: 2 | loss: 0.1629522
	speed: 0.0113s/iter; left time: 119.2500s
	iters: 400, epoch: 2 | loss: 0.2242286
	speed: 0.0113s/iter; left time: 118.1785s
	iters: 500, epoch: 2 | loss: 0.2244682
	speed: 0.0113s/iter; left time: 116.7759s
Epoch: 2 cost time: 6.762923717498779
Epoch: 2, Steps: 570 | Train Loss: 0.1484815 Vali Loss: 0.0330868 Test Loss: 0.1097542
Validation loss decreased (0.033952 --> 0.033087).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1423181
	speed: 0.0394s/iter; left time: 399.9152s
	iters: 200, epoch: 3 | loss: 0.0769102
	speed: 0.0113s/iter; left time: 114.0244s
	iters: 300, epoch: 3 | loss: 0.1589527
	speed: 0.0119s/iter; left time: 118.0695s
	iters: 400, epoch: 3 | loss: 0.1327530
	speed: 0.0124s/iter; left time: 122.1855s
	iters: 500, epoch: 3 | loss: 0.1586647
	speed: 0.0124s/iter; left time: 120.8905s
Epoch: 3 cost time: 7.096240043640137
Epoch: 3, Steps: 570 | Train Loss: 0.1352108 Vali Loss: 0.0305164 Test Loss: 0.1075482
Validation loss decreased (0.033087 --> 0.030516).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1436764
	speed: 0.0392s/iter; left time: 375.8656s
	iters: 200, epoch: 4 | loss: 0.0875238
	speed: 0.0124s/iter; left time: 117.2647s
	iters: 300, epoch: 4 | loss: 0.0740542
	speed: 0.0124s/iter; left time: 116.0268s
	iters: 400, epoch: 4 | loss: 0.1277369
	speed: 0.0119s/iter; left time: 110.6230s
	iters: 500, epoch: 4 | loss: 0.1317084
	speed: 0.0113s/iter; left time: 103.4166s
Epoch: 4 cost time: 7.1678314208984375
Epoch: 4, Steps: 570 | Train Loss: 0.1279927 Vali Loss: 0.0310941 Test Loss: 0.1078169
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1045370
	speed: 0.0382s/iter; left time: 344.4357s
	iters: 200, epoch: 5 | loss: 0.0964763
	speed: 0.0114s/iter; left time: 101.3034s
	iters: 300, epoch: 5 | loss: 0.1803711
	speed: 0.0114s/iter; left time: 100.1692s
	iters: 400, epoch: 5 | loss: 0.1021279
	speed: 0.0114s/iter; left time: 99.0828s
	iters: 500, epoch: 5 | loss: 0.1001225
	speed: 0.0114s/iter; left time: 97.9109s
Epoch: 5 cost time: 6.752560615539551
Epoch: 5, Steps: 570 | Train Loss: 0.1227064 Vali Loss: 0.0306925 Test Loss: 0.1084145
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1684068
	speed: 0.0381s/iter; left time: 321.7557s
	iters: 200, epoch: 6 | loss: 0.1311743
	speed: 0.0113s/iter; left time: 94.4756s
	iters: 300, epoch: 6 | loss: 0.0854264
	speed: 0.0113s/iter; left time: 93.2124s
	iters: 400, epoch: 6 | loss: 0.0863820
	speed: 0.0113s/iter; left time: 92.3246s
	iters: 500, epoch: 6 | loss: 0.1006020
	speed: 0.0113s/iter; left time: 91.3540s
Epoch: 6 cost time: 6.722865581512451
Epoch: 6, Steps: 570 | Train Loss: 0.1203311 Vali Loss: 0.0305669 Test Loss: 0.1081889
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10770360380411148, mae:0.19817419350147247
>>> S LR=1e-4 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2297282
	speed: 0.0238s/iter; left time: 269.1820s
	iters: 200, epoch: 1 | loss: 0.2545596
	speed: 0.0119s/iter; left time: 133.3577s
	iters: 300, epoch: 1 | loss: 0.2418731
	speed: 0.0119s/iter; left time: 131.8650s
	iters: 400, epoch: 1 | loss: 0.2107105
	speed: 0.0119s/iter; left time: 130.8868s
	iters: 500, epoch: 1 | loss: 0.1612038
	speed: 0.0119s/iter; left time: 129.7213s
Epoch: 1 cost time: 8.024367094039917
Epoch: 1, Steps: 570 | Train Loss: 0.2127306 Vali Loss: 0.0400561 Test Loss: 0.1256723
Validation loss decreased (inf --> 0.040056).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1809058
	speed: 0.0383s/iter; left time: 410.5818s
	iters: 200, epoch: 2 | loss: 0.2539427
	speed: 0.0119s/iter; left time: 126.5090s
	iters: 300, epoch: 2 | loss: 0.1437136
	speed: 0.0120s/iter; left time: 125.9155s
	iters: 400, epoch: 2 | loss: 0.1539494
	speed: 0.0120s/iter; left time: 124.8878s
	iters: 500, epoch: 2 | loss: 0.1212464
	speed: 0.0119s/iter; left time: 123.2939s
Epoch: 2 cost time: 7.084178447723389
Epoch: 2, Steps: 570 | Train Loss: 0.1803341 Vali Loss: 0.0422170 Test Loss: 0.1327944
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1790385
	speed: 0.0391s/iter; left time: 397.7400s
	iters: 200, epoch: 3 | loss: 0.1285866
	speed: 0.0108s/iter; left time: 108.3468s
	iters: 300, epoch: 3 | loss: 0.2494198
	speed: 0.0108s/iter; left time: 107.1520s
	iters: 400, epoch: 3 | loss: 0.1271361
	speed: 0.0107s/iter; left time: 105.9114s
	iters: 500, epoch: 3 | loss: 0.1932987
	speed: 0.0107s/iter; left time: 104.9083s
Epoch: 3 cost time: 6.411786079406738
Epoch: 3, Steps: 570 | Train Loss: 0.1611715 Vali Loss: 0.0389525 Test Loss: 0.1308416
Validation loss decreased (0.040056 --> 0.038952).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1708779
	speed: 0.0366s/iter; left time: 350.9540s
	iters: 200, epoch: 4 | loss: 0.1137372
	speed: 0.0108s/iter; left time: 102.0671s
	iters: 300, epoch: 4 | loss: 0.1388091
	speed: 0.0108s/iter; left time: 101.0236s
	iters: 400, epoch: 4 | loss: 0.2761552
	speed: 0.0107s/iter; left time: 99.8775s
	iters: 500, epoch: 4 | loss: 0.1565890
	speed: 0.0108s/iter; left time: 98.8235s
Epoch: 4 cost time: 6.413382291793823
Epoch: 4, Steps: 570 | Train Loss: 0.1533302 Vali Loss: 0.0392412 Test Loss: 0.1288303
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1308293
	speed: 0.0377s/iter; left time: 340.2273s
	iters: 200, epoch: 5 | loss: 0.1430727
	speed: 0.0114s/iter; left time: 101.7773s
	iters: 300, epoch: 5 | loss: 0.1583209
	speed: 0.0108s/iter; left time: 94.9346s
	iters: 400, epoch: 5 | loss: 0.1042027
	speed: 0.0108s/iter; left time: 94.0040s
	iters: 500, epoch: 5 | loss: 0.2189899
	speed: 0.0108s/iter; left time: 93.2645s
Epoch: 5 cost time: 6.653391361236572
Epoch: 5, Steps: 570 | Train Loss: 0.1472103 Vali Loss: 0.0384113 Test Loss: 0.1273958
Validation loss decreased (0.038952 --> 0.038411).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1242278
	speed: 0.0360s/iter; left time: 304.2642s
	iters: 200, epoch: 6 | loss: 0.1419731
	speed: 0.0108s/iter; left time: 89.8549s
	iters: 300, epoch: 6 | loss: 0.1677639
	speed: 0.0108s/iter; left time: 88.8666s
	iters: 400, epoch: 6 | loss: 0.1311752
	speed: 0.0108s/iter; left time: 87.7122s
	iters: 500, epoch: 6 | loss: 0.1473825
	speed: 0.0107s/iter; left time: 86.5000s
Epoch: 6 cost time: 6.418668270111084
Epoch: 6, Steps: 570 | Train Loss: 0.1441073 Vali Loss: 0.0384610 Test Loss: 0.1299349
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1150714
	speed: 0.0350s/iter; left time: 275.8125s
	iters: 200, epoch: 7 | loss: 0.1105937
	speed: 0.0108s/iter; left time: 83.7636s
	iters: 300, epoch: 7 | loss: 0.0901621
	speed: 0.0108s/iter; left time: 82.7462s
	iters: 400, epoch: 7 | loss: 0.1432523
	speed: 0.0108s/iter; left time: 81.5233s
	iters: 500, epoch: 7 | loss: 0.1102623
	speed: 0.0107s/iter; left time: 80.2377s
Epoch: 7 cost time: 6.393003463745117
Epoch: 7, Steps: 570 | Train Loss: 0.1423630 Vali Loss: 0.0383254 Test Loss: 0.1308315
Validation loss decreased (0.038411 --> 0.038325).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1036516
	speed: 0.0383s/iter; left time: 279.7743s
	iters: 200, epoch: 8 | loss: 0.2001366
	speed: 0.0108s/iter; left time: 77.5652s
	iters: 300, epoch: 8 | loss: 0.1717896
	speed: 0.0108s/iter; left time: 76.6060s
	iters: 400, epoch: 8 | loss: 0.1392426
	speed: 0.0108s/iter; left time: 75.5136s
	iters: 500, epoch: 8 | loss: 0.1036293
	speed: 0.0108s/iter; left time: 74.4887s
Epoch: 8 cost time: 6.431577205657959
Epoch: 8, Steps: 570 | Train Loss: 0.1417572 Vali Loss: 0.0382582 Test Loss: 0.1296995
Validation loss decreased (0.038325 --> 0.038258).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1346149
	speed: 0.0363s/iter; left time: 244.7446s
	iters: 200, epoch: 9 | loss: 0.1139142
	speed: 0.0107s/iter; left time: 71.1301s
	iters: 300, epoch: 9 | loss: 0.1693929
	speed: 0.0107s/iter; left time: 70.1838s
	iters: 400, epoch: 9 | loss: 0.1965543
	speed: 0.0107s/iter; left time: 69.0327s
	iters: 500, epoch: 9 | loss: 0.0760279
	speed: 0.0107s/iter; left time: 67.9949s
Epoch: 9 cost time: 6.409730911254883
Epoch: 9, Steps: 570 | Train Loss: 0.1404576 Vali Loss: 0.0381111 Test Loss: 0.1301980
Validation loss decreased (0.038258 --> 0.038111).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1572675
	speed: 0.0370s/iter; left time: 228.6039s
	iters: 200, epoch: 10 | loss: 0.0945768
	speed: 0.0107s/iter; left time: 64.9941s
	iters: 300, epoch: 10 | loss: 0.1526222
	speed: 0.0107s/iter; left time: 63.9599s
	iters: 400, epoch: 10 | loss: 0.1033907
	speed: 0.0107s/iter; left time: 62.8674s
	iters: 500, epoch: 10 | loss: 0.1892924
	speed: 0.0107s/iter; left time: 61.8098s
Epoch: 10 cost time: 6.380697250366211
Epoch: 10, Steps: 570 | Train Loss: 0.1416280 Vali Loss: 0.0382427 Test Loss: 0.1297712
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1079342
	speed: 0.0363s/iter; left time: 203.4723s
	iters: 200, epoch: 11 | loss: 0.1279507
	speed: 0.0119s/iter; left time: 65.4288s
	iters: 300, epoch: 11 | loss: 0.1239125
	speed: 0.0119s/iter; left time: 64.2367s
	iters: 400, epoch: 11 | loss: 0.0991862
	speed: 0.0119s/iter; left time: 62.9971s
	iters: 500, epoch: 11 | loss: 0.1107475
	speed: 0.0108s/iter; left time: 56.1884s
Epoch: 11 cost time: 6.8601624965667725
Epoch: 11, Steps: 570 | Train Loss: 0.1416083 Vali Loss: 0.0381092 Test Loss: 0.1299827
Validation loss decreased (0.038111 --> 0.038109).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1402452
	speed: 0.0362s/iter; left time: 182.2209s
	iters: 200, epoch: 12 | loss: 0.1825282
	speed: 0.0107s/iter; left time: 52.9115s
	iters: 300, epoch: 12 | loss: 0.1436926
	speed: 0.0107s/iter; left time: 51.8336s
	iters: 400, epoch: 12 | loss: 0.1494513
	speed: 0.0107s/iter; left time: 50.7728s
	iters: 500, epoch: 12 | loss: 0.1293393
	speed: 0.0107s/iter; left time: 49.6799s
Epoch: 12 cost time: 6.386044502258301
Epoch: 12, Steps: 570 | Train Loss: 0.1400896 Vali Loss: 0.0381985 Test Loss: 0.1299590
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1255239
	speed: 0.0374s/iter; left time: 166.6996s
	iters: 200, epoch: 13 | loss: 0.1955357
	speed: 0.0119s/iter; left time: 51.8597s
	iters: 300, epoch: 13 | loss: 0.0946122
	speed: 0.0119s/iter; left time: 50.6103s
	iters: 400, epoch: 13 | loss: 0.0879007
	speed: 0.0117s/iter; left time: 48.5881s
	iters: 500, epoch: 13 | loss: 0.1571923
	speed: 0.0108s/iter; left time: 43.6950s
Epoch: 13 cost time: 6.878678798675537
Epoch: 13, Steps: 570 | Train Loss: 0.1409352 Vali Loss: 0.0381611 Test Loss: 0.1299474
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2021568
	speed: 0.0353s/iter; left time: 137.3117s
	iters: 200, epoch: 14 | loss: 0.2175345
	speed: 0.0108s/iter; left time: 40.8305s
	iters: 300, epoch: 14 | loss: 0.1399572
	speed: 0.0108s/iter; left time: 39.7710s
	iters: 400, epoch: 14 | loss: 0.1233258
	speed: 0.0108s/iter; left time: 38.7212s
	iters: 500, epoch: 14 | loss: 0.1260684
	speed: 0.0108s/iter; left time: 37.5880s
Epoch: 14 cost time: 6.3934595584869385
Epoch: 14, Steps: 570 | Train Loss: 0.1415392 Vali Loss: 0.0381907 Test Loss: 0.1299414
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1300961822271347, mae:0.2297929972410202
>>> S LR=1e-4 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2102890
	speed: 0.0259s/iter; left time: 292.2155s
	iters: 200, epoch: 1 | loss: 0.1533967
	speed: 0.0144s/iter; left time: 161.3003s
	iters: 300, epoch: 1 | loss: 0.2761092
	speed: 0.0144s/iter; left time: 159.5820s
	iters: 400, epoch: 1 | loss: 0.1614887
	speed: 0.0144s/iter; left time: 158.1490s
	iters: 500, epoch: 1 | loss: 0.1485829
	speed: 0.0144s/iter; left time: 156.7460s
Epoch: 1 cost time: 9.393446445465088
Epoch: 1, Steps: 570 | Train Loss: 0.2059596 Vali Loss: 0.0394861 Test Loss: 0.1225659
Validation loss decreased (inf --> 0.039486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2314372
	speed: 0.0453s/iter; left time: 485.7639s
	iters: 200, epoch: 2 | loss: 0.1698028
	speed: 0.0145s/iter; left time: 154.0019s
	iters: 300, epoch: 2 | loss: 0.1305887
	speed: 0.0145s/iter; left time: 152.2419s
	iters: 400, epoch: 2 | loss: 0.0972801
	speed: 0.0145s/iter; left time: 151.0266s
	iters: 500, epoch: 2 | loss: 0.1849669
	speed: 0.0145s/iter; left time: 149.7351s
Epoch: 2 cost time: 8.537457942962646
Epoch: 2, Steps: 570 | Train Loss: 0.1734356 Vali Loss: 0.0361613 Test Loss: 0.1218808
Validation loss decreased (0.039486 --> 0.036161).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2782588
	speed: 0.0460s/iter; left time: 467.3950s
	iters: 200, epoch: 3 | loss: 0.2038205
	speed: 0.0145s/iter; left time: 145.8918s
	iters: 300, epoch: 3 | loss: 0.1018197
	speed: 0.0145s/iter; left time: 144.6180s
	iters: 400, epoch: 3 | loss: 0.1235126
	speed: 0.0145s/iter; left time: 142.7444s
	iters: 500, epoch: 3 | loss: 0.1039259
	speed: 0.0145s/iter; left time: 141.4539s
Epoch: 3 cost time: 8.510279655456543
Epoch: 3, Steps: 570 | Train Loss: 0.1554724 Vali Loss: 0.0346547 Test Loss: 0.1245454
Validation loss decreased (0.036161 --> 0.034655).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1285198
	speed: 0.0492s/iter; left time: 472.0392s
	iters: 200, epoch: 4 | loss: 0.1137847
	speed: 0.0162s/iter; left time: 154.0647s
	iters: 300, epoch: 4 | loss: 0.1417176
	speed: 0.0145s/iter; left time: 136.4536s
	iters: 400, epoch: 4 | loss: 0.1390637
	speed: 0.0145s/iter; left time: 134.3745s
	iters: 500, epoch: 4 | loss: 0.1257972
	speed: 0.0145s/iter; left time: 132.9299s
Epoch: 4 cost time: 8.856858015060425
Epoch: 4, Steps: 570 | Train Loss: 0.1489037 Vali Loss: 0.0347337 Test Loss: 0.1231497
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1274393
	speed: 0.0443s/iter; left time: 399.7478s
	iters: 200, epoch: 5 | loss: 0.1579018
	speed: 0.0144s/iter; left time: 128.1423s
	iters: 300, epoch: 5 | loss: 0.1141945
	speed: 0.0144s/iter; left time: 126.7745s
	iters: 400, epoch: 5 | loss: 0.1318435
	speed: 0.0144s/iter; left time: 125.2915s
	iters: 500, epoch: 5 | loss: 0.1588470
	speed: 0.0144s/iter; left time: 124.1666s
Epoch: 5 cost time: 8.559911251068115
Epoch: 5, Steps: 570 | Train Loss: 0.1454927 Vali Loss: 0.0347847 Test Loss: 0.1205694
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1209960
	speed: 0.0460s/iter; left time: 388.4167s
	iters: 200, epoch: 6 | loss: 0.1459212
	speed: 0.0143s/iter; left time: 119.7883s
	iters: 300, epoch: 6 | loss: 0.1059791
	speed: 0.0144s/iter; left time: 118.4145s
	iters: 400, epoch: 6 | loss: 0.1228782
	speed: 0.0143s/iter; left time: 116.9523s
	iters: 500, epoch: 6 | loss: 0.1322440
	speed: 0.0144s/iter; left time: 115.5906s
Epoch: 6 cost time: 8.420192241668701
Epoch: 6, Steps: 570 | Train Loss: 0.1421165 Vali Loss: 0.0348083 Test Loss: 0.1227518
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12467861920595169, mae:0.22157764434814453
>>> S LR=1e-4 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2747752
	speed: 0.0258s/iter; left time: 292.0815s
	iters: 200, epoch: 1 | loss: 0.1644503
	speed: 0.0141s/iter; left time: 158.0431s
	iters: 300, epoch: 1 | loss: 0.1118653
	speed: 0.0141s/iter; left time: 156.1955s
	iters: 400, epoch: 1 | loss: 0.2379458
	speed: 0.0141s/iter; left time: 155.3494s
	iters: 500, epoch: 1 | loss: 0.1801848
	speed: 0.0141s/iter; left time: 154.0833s
Epoch: 1 cost time: 9.26609468460083
Epoch: 1, Steps: 570 | Train Loss: 0.1781343 Vali Loss: 0.0337162 Test Loss: 0.1101398
Validation loss decreased (inf --> 0.033716).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1206250
	speed: 0.0468s/iter; left time: 502.1075s
	iters: 200, epoch: 2 | loss: 0.2304055
	speed: 0.0145s/iter; left time: 154.0186s
	iters: 300, epoch: 2 | loss: 0.1623478
	speed: 0.0142s/iter; left time: 149.8424s
	iters: 400, epoch: 2 | loss: 0.1442048
	speed: 0.0142s/iter; left time: 148.5543s
	iters: 500, epoch: 2 | loss: 0.1362916
	speed: 0.0142s/iter; left time: 146.8286s
Epoch: 2 cost time: 8.593178033828735
Epoch: 2, Steps: 570 | Train Loss: 0.1496608 Vali Loss: 0.0327845 Test Loss: 0.1110777
Validation loss decreased (0.033716 --> 0.032784).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1514398
	speed: 0.0478s/iter; left time: 486.1154s
	iters: 200, epoch: 3 | loss: 0.0835183
	speed: 0.0142s/iter; left time: 143.3665s
	iters: 300, epoch: 3 | loss: 0.1950675
	speed: 0.0142s/iter; left time: 141.7222s
	iters: 400, epoch: 3 | loss: 0.0949699
	speed: 0.0142s/iter; left time: 140.4873s
	iters: 500, epoch: 3 | loss: 0.1282420
	speed: 0.0142s/iter; left time: 138.8267s
Epoch: 3 cost time: 8.410776138305664
Epoch: 3, Steps: 570 | Train Loss: 0.1378267 Vali Loss: 0.0316273 Test Loss: 0.1067980
Validation loss decreased (0.032784 --> 0.031627).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1220196
	speed: 0.0467s/iter; left time: 447.8970s
	iters: 200, epoch: 4 | loss: 0.1195200
	speed: 0.0142s/iter; left time: 134.5268s
	iters: 300, epoch: 4 | loss: 0.1526415
	speed: 0.0142s/iter; left time: 132.9492s
	iters: 400, epoch: 4 | loss: 0.0811545
	speed: 0.0141s/iter; left time: 131.3827s
	iters: 500, epoch: 4 | loss: 0.0963744
	speed: 0.0141s/iter; left time: 129.8301s
Epoch: 4 cost time: 8.33439564704895
Epoch: 4, Steps: 570 | Train Loss: 0.1346482 Vali Loss: 0.0308658 Test Loss: 0.1064119
Validation loss decreased (0.031627 --> 0.030866).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0843223
	speed: 0.0445s/iter; left time: 401.7800s
	iters: 200, epoch: 5 | loss: 0.1559346
	speed: 0.0142s/iter; left time: 126.3975s
	iters: 300, epoch: 5 | loss: 0.1618259
	speed: 0.0141s/iter; left time: 124.8111s
	iters: 400, epoch: 5 | loss: 0.1136009
	speed: 0.0141s/iter; left time: 123.1665s
	iters: 500, epoch: 5 | loss: 0.1405681
	speed: 0.0142s/iter; left time: 122.2298s
Epoch: 5 cost time: 8.351547002792358
Epoch: 5, Steps: 570 | Train Loss: 0.1314053 Vali Loss: 0.0305034 Test Loss: 0.1054244
Validation loss decreased (0.030866 --> 0.030503).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0989509
	speed: 0.0458s/iter; left time: 387.3125s
	iters: 200, epoch: 6 | loss: 0.2305071
	speed: 0.0141s/iter; left time: 117.9418s
	iters: 300, epoch: 6 | loss: 0.1864426
	speed: 0.0141s/iter; left time: 116.3346s
	iters: 400, epoch: 6 | loss: 0.1401485
	speed: 0.0141s/iter; left time: 115.1005s
	iters: 500, epoch: 6 | loss: 0.1529880
	speed: 0.0141s/iter; left time: 113.4972s
Epoch: 6 cost time: 8.321500062942505
Epoch: 6, Steps: 570 | Train Loss: 0.1301870 Vali Loss: 0.0304534 Test Loss: 0.1051086
Validation loss decreased (0.030503 --> 0.030453).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1103611
	speed: 0.0440s/iter; left time: 347.0571s
	iters: 200, epoch: 7 | loss: 0.1577013
	speed: 0.0142s/iter; left time: 110.6483s
	iters: 300, epoch: 7 | loss: 0.1844331
	speed: 0.0142s/iter; left time: 108.7724s
	iters: 400, epoch: 7 | loss: 0.1249271
	speed: 0.0142s/iter; left time: 107.6274s
	iters: 500, epoch: 7 | loss: 0.1644244
	speed: 0.0142s/iter; left time: 106.0696s
Epoch: 7 cost time: 8.375241994857788
Epoch: 7, Steps: 570 | Train Loss: 0.1290687 Vali Loss: 0.0304381 Test Loss: 0.1052071
Validation loss decreased (0.030453 --> 0.030438).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0950547
	speed: 0.0447s/iter; left time: 326.4780s
	iters: 200, epoch: 8 | loss: 0.1106257
	speed: 0.0142s/iter; left time: 102.1121s
	iters: 300, epoch: 8 | loss: 0.1748175
	speed: 0.0141s/iter; left time: 100.6138s
	iters: 400, epoch: 8 | loss: 0.1325542
	speed: 0.0141s/iter; left time: 98.9291s
	iters: 500, epoch: 8 | loss: 0.1144896
	speed: 0.0141s/iter; left time: 97.4884s
Epoch: 8 cost time: 8.329675197601318
Epoch: 8, Steps: 570 | Train Loss: 0.1278429 Vali Loss: 0.0303929 Test Loss: 0.1049051
Validation loss decreased (0.030438 --> 0.030393).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1084467
	speed: 0.0442s/iter; left time: 297.9790s
	iters: 200, epoch: 9 | loss: 0.0997333
	speed: 0.0143s/iter; left time: 94.9973s
	iters: 300, epoch: 9 | loss: 0.1354030
	speed: 0.0162s/iter; left time: 106.1165s
	iters: 400, epoch: 9 | loss: 0.1271495
	speed: 0.0162s/iter; left time: 104.4848s
	iters: 500, epoch: 9 | loss: 0.1359371
	speed: 0.0162s/iter; left time: 102.8525s
Epoch: 9 cost time: 9.121448755264282
Epoch: 9, Steps: 570 | Train Loss: 0.1280056 Vali Loss: 0.0303240 Test Loss: 0.1047923
Validation loss decreased (0.030393 --> 0.030324).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1128767
	speed: 0.0492s/iter; left time: 303.5485s
	iters: 200, epoch: 10 | loss: 0.1092348
	speed: 0.0162s/iter; left time: 98.6093s
	iters: 300, epoch: 10 | loss: 0.1041506
	speed: 0.0163s/iter; left time: 97.0875s
	iters: 400, epoch: 10 | loss: 0.1331075
	speed: 0.0163s/iter; left time: 95.4818s
	iters: 500, epoch: 10 | loss: 0.1606019
	speed: 0.0163s/iter; left time: 93.9356s
Epoch: 10 cost time: 9.54584288597107
Epoch: 10, Steps: 570 | Train Loss: 0.1278247 Vali Loss: 0.0303440 Test Loss: 0.1048159
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1473809
	speed: 0.0480s/iter; left time: 268.7421s
	iters: 200, epoch: 11 | loss: 0.1821136
	speed: 0.0163s/iter; left time: 89.8211s
	iters: 300, epoch: 11 | loss: 0.1835919
	speed: 0.0164s/iter; left time: 88.4783s
	iters: 400, epoch: 11 | loss: 0.1115294
	speed: 0.0164s/iter; left time: 86.8267s
	iters: 500, epoch: 11 | loss: 0.2089076
	speed: 0.0158s/iter; left time: 82.1490s
Epoch: 11 cost time: 9.369432210922241
Epoch: 11, Steps: 570 | Train Loss: 0.1274987 Vali Loss: 0.0303527 Test Loss: 0.1048214
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1774233
	speed: 0.0474s/iter; left time: 238.3752s
	iters: 200, epoch: 12 | loss: 0.1435933
	speed: 0.0158s/iter; left time: 78.1493s
	iters: 300, epoch: 12 | loss: 0.0993771
	speed: 0.0144s/iter; left time: 69.4015s
	iters: 400, epoch: 12 | loss: 0.1598274
	speed: 0.0141s/iter; left time: 66.6560s
	iters: 500, epoch: 12 | loss: 0.1358170
	speed: 0.0141s/iter; left time: 65.2364s
Epoch: 12 cost time: 8.710781812667847
Epoch: 12, Steps: 570 | Train Loss: 0.1286132 Vali Loss: 0.0305055 Test Loss: 0.1048217
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10492922365665436, mae:0.1951056569814682
>>> S LR=1e-4 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1363267
	speed: 0.0256s/iter; left time: 289.3329s
	iters: 200, epoch: 1 | loss: 0.2576583
	speed: 0.0141s/iter; left time: 157.5916s
	iters: 300, epoch: 1 | loss: 0.3354358
	speed: 0.0140s/iter; left time: 155.8896s
	iters: 400, epoch: 1 | loss: 0.1852143
	speed: 0.0140s/iter; left time: 154.5061s
	iters: 500, epoch: 1 | loss: 0.2244921
	speed: 0.0141s/iter; left time: 153.1642s
Epoch: 1 cost time: 9.208600282669067
Epoch: 1, Steps: 570 | Train Loss: 0.2155413 Vali Loss: 0.0409199 Test Loss: 0.1296241
Validation loss decreased (inf --> 0.040920).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1628119
	speed: 0.0463s/iter; left time: 497.0628s
	iters: 200, epoch: 2 | loss: 0.1396414
	speed: 0.0140s/iter; left time: 149.1318s
	iters: 300, epoch: 2 | loss: 0.1235611
	speed: 0.0141s/iter; left time: 148.0589s
	iters: 400, epoch: 2 | loss: 0.1389097
	speed: 0.0141s/iter; left time: 146.6898s
	iters: 500, epoch: 2 | loss: 0.1930375
	speed: 0.0141s/iter; left time: 145.4249s
Epoch: 2 cost time: 8.431657791137695
Epoch: 2, Steps: 570 | Train Loss: 0.1803586 Vali Loss: 0.0391478 Test Loss: 0.1300074
Validation loss decreased (0.040920 --> 0.039148).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2123989
	speed: 0.0457s/iter; left time: 464.3873s
	iters: 200, epoch: 3 | loss: 0.2079044
	speed: 0.0140s/iter; left time: 141.0849s
	iters: 300, epoch: 3 | loss: 0.1329033
	speed: 0.0140s/iter; left time: 139.6053s
	iters: 400, epoch: 3 | loss: 0.1109100
	speed: 0.0140s/iter; left time: 138.3048s
	iters: 500, epoch: 3 | loss: 0.1746771
	speed: 0.0140s/iter; left time: 137.0993s
Epoch: 3 cost time: 8.2548987865448
Epoch: 3, Steps: 570 | Train Loss: 0.1658940 Vali Loss: 0.0388643 Test Loss: 0.1268289
Validation loss decreased (0.039148 --> 0.038864).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1904939
	speed: 0.0452s/iter; left time: 433.1334s
	iters: 200, epoch: 4 | loss: 0.1766871
	speed: 0.0142s/iter; left time: 134.3842s
	iters: 300, epoch: 4 | loss: 0.1816404
	speed: 0.0141s/iter; left time: 132.8339s
	iters: 400, epoch: 4 | loss: 0.1095869
	speed: 0.0141s/iter; left time: 131.3968s
	iters: 500, epoch: 4 | loss: 0.1237842
	speed: 0.0141s/iter; left time: 129.9449s
Epoch: 4 cost time: 8.344062566757202
Epoch: 4, Steps: 570 | Train Loss: 0.1596230 Vali Loss: 0.0383345 Test Loss: 0.1271704
Validation loss decreased (0.038864 --> 0.038335).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1511120
	speed: 0.0468s/iter; left time: 421.7929s
	iters: 200, epoch: 5 | loss: 0.1786457
	speed: 0.0141s/iter; left time: 125.8474s
	iters: 300, epoch: 5 | loss: 0.1393272
	speed: 0.0141s/iter; left time: 124.3888s
	iters: 400, epoch: 5 | loss: 0.1738535
	speed: 0.0141s/iter; left time: 123.0093s
	iters: 500, epoch: 5 | loss: 0.1096832
	speed: 0.0141s/iter; left time: 121.2000s
Epoch: 5 cost time: 8.284338235855103
Epoch: 5, Steps: 570 | Train Loss: 0.1555645 Vali Loss: 0.0384189 Test Loss: 0.1274666
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2217912
	speed: 0.0454s/iter; left time: 383.5259s
	iters: 200, epoch: 6 | loss: 0.1757760
	speed: 0.0159s/iter; left time: 132.3644s
	iters: 300, epoch: 6 | loss: 0.0903081
	speed: 0.0159s/iter; left time: 130.9041s
	iters: 400, epoch: 6 | loss: 0.1940204
	speed: 0.0158s/iter; left time: 128.8927s
	iters: 500, epoch: 6 | loss: 0.1918581
	speed: 0.0158s/iter; left time: 127.4720s
Epoch: 6 cost time: 9.288330078125
Epoch: 6, Steps: 570 | Train Loss: 0.1537357 Vali Loss: 0.0378365 Test Loss: 0.1263725
Validation loss decreased (0.038335 --> 0.037836).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1762537
	speed: 0.0465s/iter; left time: 366.6600s
	iters: 200, epoch: 7 | loss: 0.1022477
	speed: 0.0141s/iter; left time: 109.6236s
	iters: 300, epoch: 7 | loss: 0.0987878
	speed: 0.0141s/iter; left time: 108.3814s
	iters: 400, epoch: 7 | loss: 0.1752727
	speed: 0.0141s/iter; left time: 106.9296s
	iters: 500, epoch: 7 | loss: 0.1277146
	speed: 0.0141s/iter; left time: 105.5102s
Epoch: 7 cost time: 8.315191268920898
Epoch: 7, Steps: 570 | Train Loss: 0.1531010 Vali Loss: 0.0382078 Test Loss: 0.1277120
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1293289
	speed: 0.0468s/iter; left time: 342.2974s
	iters: 200, epoch: 8 | loss: 0.1753375
	speed: 0.0159s/iter; left time: 114.8180s
	iters: 300, epoch: 8 | loss: 0.1279400
	speed: 0.0159s/iter; left time: 113.0887s
	iters: 400, epoch: 8 | loss: 0.1701000
	speed: 0.0158s/iter; left time: 110.9607s
	iters: 500, epoch: 8 | loss: 0.0978731
	speed: 0.0158s/iter; left time: 109.4932s
Epoch: 8 cost time: 9.300803661346436
Epoch: 8, Steps: 570 | Train Loss: 0.1520821 Vali Loss: 0.0383846 Test Loss: 0.1281076
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2059143
	speed: 0.0459s/iter; left time: 309.1258s
	iters: 200, epoch: 9 | loss: 0.1427556
	speed: 0.0142s/iter; left time: 94.0202s
	iters: 300, epoch: 9 | loss: 0.1113632
	speed: 0.0141s/iter; left time: 92.3431s
	iters: 400, epoch: 9 | loss: 0.0928672
	speed: 0.0141s/iter; left time: 90.8850s
	iters: 500, epoch: 9 | loss: 0.1166731
	speed: 0.0141s/iter; left time: 89.4949s
Epoch: 9 cost time: 8.316327571868896
Epoch: 9, Steps: 570 | Train Loss: 0.1522379 Vali Loss: 0.0381471 Test Loss: 0.1280690
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12649694085121155, mae:0.2249101847410202
>>> S LR=1e-4 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2550329
	speed: 0.0285s/iter; left time: 321.6654s
	iters: 200, epoch: 1 | loss: 0.1805182
	speed: 0.0168s/iter; left time: 187.9236s
	iters: 300, epoch: 1 | loss: 0.2683520
	speed: 0.0168s/iter; left time: 186.1544s
	iters: 400, epoch: 1 | loss: 0.2051022
	speed: 0.0170s/iter; left time: 187.1078s
	iters: 500, epoch: 1 | loss: 0.1646086
	speed: 0.0182s/iter; left time: 198.4051s
Epoch: 1 cost time: 11.04687237739563
Epoch: 1, Steps: 570 | Train Loss: 0.2036613 Vali Loss: 0.0405687 Test Loss: 0.1301473
Validation loss decreased (inf --> 0.040569).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1664770
	speed: 0.0526s/iter; left time: 564.6940s
	iters: 200, epoch: 2 | loss: 0.2060628
	speed: 0.0182s/iter; left time: 193.9534s
	iters: 300, epoch: 2 | loss: 0.1707399
	speed: 0.0175s/iter; left time: 184.2822s
	iters: 400, epoch: 2 | loss: 0.0977672
	speed: 0.0168s/iter; left time: 175.4462s
	iters: 500, epoch: 2 | loss: 0.1191966
	speed: 0.0168s/iter; left time: 173.4590s
Epoch: 2 cost time: 10.23115611076355
Epoch: 2, Steps: 570 | Train Loss: 0.1713802 Vali Loss: 0.0402405 Test Loss: 0.1311401
Validation loss decreased (0.040569 --> 0.040241).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1365783
	speed: 0.0500s/iter; left time: 507.9069s
	iters: 200, epoch: 3 | loss: 0.1598782
	speed: 0.0168s/iter; left time: 168.8141s
	iters: 300, epoch: 3 | loss: 0.2456072
	speed: 0.0168s/iter; left time: 167.3546s
	iters: 400, epoch: 3 | loss: 0.1425972
	speed: 0.0168s/iter; left time: 165.7111s
	iters: 500, epoch: 3 | loss: 0.1165973
	speed: 0.0168s/iter; left time: 163.8088s
Epoch: 3 cost time: 9.862294435501099
Epoch: 3, Steps: 570 | Train Loss: 0.1482324 Vali Loss: 0.0388894 Test Loss: 0.1301213
Validation loss decreased (0.040241 --> 0.038889).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1240693
	speed: 0.0503s/iter; left time: 482.4101s
	iters: 200, epoch: 4 | loss: 0.1452442
	speed: 0.0168s/iter; left time: 159.3931s
	iters: 300, epoch: 4 | loss: 0.1282579
	speed: 0.0168s/iter; left time: 157.7247s
	iters: 400, epoch: 4 | loss: 0.1674708
	speed: 0.0168s/iter; left time: 156.0338s
	iters: 500, epoch: 4 | loss: 0.1803243
	speed: 0.0168s/iter; left time: 154.3670s
Epoch: 4 cost time: 9.853290319442749
Epoch: 4, Steps: 570 | Train Loss: 0.1357916 Vali Loss: 0.0370292 Test Loss: 0.1361692
Validation loss decreased (0.038889 --> 0.037029).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1137240
	speed: 0.0500s/iter; left time: 451.4333s
	iters: 200, epoch: 5 | loss: 0.1763037
	speed: 0.0168s/iter; left time: 149.4470s
	iters: 300, epoch: 5 | loss: 0.1238454
	speed: 0.0167s/iter; left time: 147.6721s
	iters: 400, epoch: 5 | loss: 0.1444888
	speed: 0.0168s/iter; left time: 146.2481s
	iters: 500, epoch: 5 | loss: 0.1164033
	speed: 0.0167s/iter; left time: 144.3596s
Epoch: 5 cost time: 9.854750633239746
Epoch: 5, Steps: 570 | Train Loss: 0.1280750 Vali Loss: 0.0362905 Test Loss: 0.1385759
Validation loss decreased (0.037029 --> 0.036290).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1350394
	speed: 0.0499s/iter; left time: 421.7117s
	iters: 200, epoch: 6 | loss: 0.1148838
	speed: 0.0167s/iter; left time: 139.4560s
	iters: 300, epoch: 6 | loss: 0.1232388
	speed: 0.0167s/iter; left time: 137.8284s
	iters: 400, epoch: 6 | loss: 0.1797467
	speed: 0.0167s/iter; left time: 136.1398s
	iters: 500, epoch: 6 | loss: 0.1060871
	speed: 0.0167s/iter; left time: 134.3267s
Epoch: 6 cost time: 9.784866571426392
Epoch: 6, Steps: 570 | Train Loss: 0.1247442 Vali Loss: 0.0370486 Test Loss: 0.1334887
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1321840
	speed: 0.0488s/iter; left time: 384.2379s
	iters: 200, epoch: 7 | loss: 0.1376198
	speed: 0.0167s/iter; left time: 129.9813s
	iters: 300, epoch: 7 | loss: 0.1486647
	speed: 0.0167s/iter; left time: 128.2012s
	iters: 400, epoch: 7 | loss: 0.0898186
	speed: 0.0167s/iter; left time: 126.5226s
	iters: 500, epoch: 7 | loss: 0.0992401
	speed: 0.0167s/iter; left time: 124.8578s
Epoch: 7 cost time: 9.826176881790161
Epoch: 7, Steps: 570 | Train Loss: 0.1233395 Vali Loss: 0.0362202 Test Loss: 0.1338285
Validation loss decreased (0.036290 --> 0.036220).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1161921
	speed: 0.0497s/iter; left time: 363.1013s
	iters: 200, epoch: 8 | loss: 0.0799867
	speed: 0.0167s/iter; left time: 120.6837s
	iters: 300, epoch: 8 | loss: 0.1032385
	speed: 0.0167s/iter; left time: 118.8934s
	iters: 400, epoch: 8 | loss: 0.0942423
	speed: 0.0167s/iter; left time: 117.2363s
	iters: 500, epoch: 8 | loss: 0.0832816
	speed: 0.0167s/iter; left time: 115.5205s
Epoch: 8 cost time: 9.821793794631958
Epoch: 8, Steps: 570 | Train Loss: 0.1225338 Vali Loss: 0.0365283 Test Loss: 0.1331490
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1119636
	speed: 0.0521s/iter; left time: 350.9796s
	iters: 200, epoch: 9 | loss: 0.0950274
	speed: 0.0183s/iter; left time: 121.2470s
	iters: 300, epoch: 9 | loss: 0.1087228
	speed: 0.0183s/iter; left time: 119.3777s
	iters: 400, epoch: 9 | loss: 0.1122934
	speed: 0.0182s/iter; left time: 117.3453s
	iters: 500, epoch: 9 | loss: 0.2011959
	speed: 0.0182s/iter; left time: 115.5137s
Epoch: 9 cost time: 10.668739557266235
Epoch: 9, Steps: 570 | Train Loss: 0.1221798 Vali Loss: 0.0363539 Test Loss: 0.1349329
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1340959
	speed: 0.0505s/iter; left time: 311.5490s
	iters: 200, epoch: 10 | loss: 0.0624199
	speed: 0.0167s/iter; left time: 101.4567s
	iters: 300, epoch: 10 | loss: 0.1811893
	speed: 0.0167s/iter; left time: 99.7397s
	iters: 400, epoch: 10 | loss: 0.1199379
	speed: 0.0167s/iter; left time: 98.0832s
	iters: 500, epoch: 10 | loss: 0.1118186
	speed: 0.0167s/iter; left time: 96.4268s
Epoch: 10 cost time: 9.84661602973938
Epoch: 10, Steps: 570 | Train Loss: 0.1213755 Vali Loss: 0.0366054 Test Loss: 0.1350657
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13399876654148102, mae:0.22529998421669006
>>> S LR=1e-4 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1405967
	speed: 0.0284s/iter; left time: 321.0175s
	iters: 200, epoch: 1 | loss: 0.1102858
	speed: 0.0163s/iter; left time: 183.0741s
	iters: 300, epoch: 1 | loss: 0.1892935
	speed: 0.0163s/iter; left time: 181.4143s
	iters: 400, epoch: 1 | loss: 0.1783556
	speed: 0.0164s/iter; left time: 180.0977s
	iters: 500, epoch: 1 | loss: 0.1160453
	speed: 0.0164s/iter; left time: 178.4895s
Epoch: 1 cost time: 10.581700325012207
Epoch: 1, Steps: 570 | Train Loss: 0.1733675 Vali Loss: 0.0328160 Test Loss: 0.1119665
Validation loss decreased (inf --> 0.032816).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1453997
	speed: 0.0505s/iter; left time: 541.7439s
	iters: 200, epoch: 2 | loss: 0.1113144
	speed: 0.0164s/iter; left time: 173.9641s
	iters: 300, epoch: 2 | loss: 0.2126010
	speed: 0.0164s/iter; left time: 172.4720s
	iters: 400, epoch: 2 | loss: 0.2085964
	speed: 0.0164s/iter; left time: 170.8984s
	iters: 500, epoch: 2 | loss: 0.1209326
	speed: 0.0164s/iter; left time: 168.9472s
Epoch: 2 cost time: 9.64956545829773
Epoch: 2, Steps: 570 | Train Loss: 0.1468529 Vali Loss: 0.0325407 Test Loss: 0.1112153
Validation loss decreased (0.032816 --> 0.032541).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1225367
	speed: 0.0495s/iter; left time: 503.2933s
	iters: 200, epoch: 3 | loss: 0.1541850
	speed: 0.0163s/iter; left time: 163.5395s
	iters: 300, epoch: 3 | loss: 0.1265723
	speed: 0.0162s/iter; left time: 161.8604s
	iters: 400, epoch: 3 | loss: 0.1833780
	speed: 0.0162s/iter; left time: 160.0551s
	iters: 500, epoch: 3 | loss: 0.0845940
	speed: 0.0162s/iter; left time: 158.4492s
Epoch: 3 cost time: 9.538428783416748
Epoch: 3, Steps: 570 | Train Loss: 0.1319189 Vali Loss: 0.0311824 Test Loss: 0.1091438
Validation loss decreased (0.032541 --> 0.031182).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1456145
	speed: 0.0494s/iter; left time: 473.5195s
	iters: 200, epoch: 4 | loss: 0.1763276
	speed: 0.0163s/iter; left time: 154.7254s
	iters: 300, epoch: 4 | loss: 0.0865769
	speed: 0.0163s/iter; left time: 153.0725s
	iters: 400, epoch: 4 | loss: 0.0820750
	speed: 0.0163s/iter; left time: 151.4213s
	iters: 500, epoch: 4 | loss: 0.1575467
	speed: 0.0163s/iter; left time: 149.7476s
Epoch: 4 cost time: 9.602344512939453
Epoch: 4, Steps: 570 | Train Loss: 0.1228628 Vali Loss: 0.0310180 Test Loss: 0.1094384
Validation loss decreased (0.031182 --> 0.031018).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1059582
	speed: 0.0497s/iter; left time: 448.3228s
	iters: 200, epoch: 5 | loss: 0.1338523
	speed: 0.0163s/iter; left time: 145.6146s
	iters: 300, epoch: 5 | loss: 0.1052184
	speed: 0.0163s/iter; left time: 144.0308s
	iters: 400, epoch: 5 | loss: 0.0833999
	speed: 0.0163s/iter; left time: 142.3188s
	iters: 500, epoch: 5 | loss: 0.1729009
	speed: 0.0163s/iter; left time: 140.7755s
Epoch: 5 cost time: 9.612690448760986
Epoch: 5, Steps: 570 | Train Loss: 0.1180276 Vali Loss: 0.0303736 Test Loss: 0.1098881
Validation loss decreased (0.031018 --> 0.030374).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1111668
	speed: 0.0492s/iter; left time: 416.0785s
	iters: 200, epoch: 6 | loss: 0.1546232
	speed: 0.0162s/iter; left time: 135.3446s
	iters: 300, epoch: 6 | loss: 0.1954763
	speed: 0.0162s/iter; left time: 133.7587s
	iters: 400, epoch: 6 | loss: 0.1144125
	speed: 0.0162s/iter; left time: 132.1578s
	iters: 500, epoch: 6 | loss: 0.1372193
	speed: 0.0162s/iter; left time: 130.5266s
Epoch: 6 cost time: 9.520221471786499
Epoch: 6, Steps: 570 | Train Loss: 0.1154385 Vali Loss: 0.0306152 Test Loss: 0.1098643
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1554357
	speed: 0.0478s/iter; left time: 377.0079s
	iters: 200, epoch: 7 | loss: 0.0826004
	speed: 0.0163s/iter; left time: 126.8805s
	iters: 300, epoch: 7 | loss: 0.0951041
	speed: 0.0163s/iter; left time: 125.2761s
	iters: 400, epoch: 7 | loss: 0.1602793
	speed: 0.0163s/iter; left time: 123.5332s
	iters: 500, epoch: 7 | loss: 0.1285047
	speed: 0.0163s/iter; left time: 121.8998s
Epoch: 7 cost time: 9.547061443328857
Epoch: 7, Steps: 570 | Train Loss: 0.1142708 Vali Loss: 0.0305915 Test Loss: 0.1099404
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0744401
	speed: 0.0480s/iter; left time: 350.7367s
	iters: 200, epoch: 8 | loss: 0.1458896
	speed: 0.0163s/iter; left time: 117.3906s
	iters: 300, epoch: 8 | loss: 0.1304733
	speed: 0.0163s/iter; left time: 115.8163s
	iters: 400, epoch: 8 | loss: 0.1373418
	speed: 0.0163s/iter; left time: 114.4131s
	iters: 500, epoch: 8 | loss: 0.1073349
	speed: 0.0163s/iter; left time: 112.9916s
Epoch: 8 cost time: 9.551692724227905
Epoch: 8, Steps: 570 | Train Loss: 0.1128682 Vali Loss: 0.0304005 Test Loss: 0.1098764
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11004951596260071, mae:0.1996450424194336
>>> S LR=1e-4 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2152446
	speed: 0.0271s/iter; left time: 306.8134s
	iters: 200, epoch: 1 | loss: 0.2054435
	speed: 0.0154s/iter; left time: 172.8645s
	iters: 300, epoch: 1 | loss: 0.1539846
	speed: 0.0153s/iter; left time: 170.2127s
	iters: 400, epoch: 1 | loss: 0.1941058
	speed: 0.0153s/iter; left time: 168.4194s
	iters: 500, epoch: 1 | loss: 0.3181858
	speed: 0.0153s/iter; left time: 166.8390s
Epoch: 1 cost time: 9.97915506362915
Epoch: 1, Steps: 570 | Train Loss: 0.2116668 Vali Loss: 0.0424532 Test Loss: 0.1321124
Validation loss decreased (inf --> 0.042453).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2781580
	speed: 0.0482s/iter; left time: 517.0643s
	iters: 200, epoch: 2 | loss: 0.1192603
	speed: 0.0155s/iter; left time: 164.5530s
	iters: 300, epoch: 2 | loss: 0.1975022
	speed: 0.0155s/iter; left time: 162.7262s
	iters: 400, epoch: 2 | loss: 0.1497995
	speed: 0.0155s/iter; left time: 161.5572s
	iters: 500, epoch: 2 | loss: 0.2452393
	speed: 0.0155s/iter; left time: 159.9769s
Epoch: 2 cost time: 9.121434450149536
Epoch: 2, Steps: 570 | Train Loss: 0.1784017 Vali Loss: 0.0396231 Test Loss: 0.1317860
Validation loss decreased (0.042453 --> 0.039623).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1686735
	speed: 0.0498s/iter; left time: 506.2797s
	iters: 200, epoch: 3 | loss: 0.1083106
	speed: 0.0155s/iter; left time: 155.5858s
	iters: 300, epoch: 3 | loss: 0.1781546
	speed: 0.0155s/iter; left time: 154.7885s
	iters: 400, epoch: 3 | loss: 0.1658510
	speed: 0.0155s/iter; left time: 152.4287s
	iters: 500, epoch: 3 | loss: 0.1587421
	speed: 0.0154s/iter; left time: 150.6560s
Epoch: 3 cost time: 9.085224866867065
Epoch: 3, Steps: 570 | Train Loss: 0.1582655 Vali Loss: 0.0394413 Test Loss: 0.1292296
Validation loss decreased (0.039623 --> 0.039441).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1154010
	speed: 0.0483s/iter; left time: 463.2262s
	iters: 200, epoch: 4 | loss: 0.1590081
	speed: 0.0155s/iter; left time: 146.7563s
	iters: 300, epoch: 4 | loss: 0.1573097
	speed: 0.0155s/iter; left time: 145.2319s
	iters: 400, epoch: 4 | loss: 0.1347455
	speed: 0.0154s/iter; left time: 143.0739s
	iters: 500, epoch: 4 | loss: 0.1771195
	speed: 0.0154s/iter; left time: 141.6605s
Epoch: 4 cost time: 9.087574243545532
Epoch: 4, Steps: 570 | Train Loss: 0.1472342 Vali Loss: 0.0396916 Test Loss: 0.1331700
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1429369
	speed: 0.0467s/iter; left time: 420.9144s
	iters: 200, epoch: 5 | loss: 0.1065191
	speed: 0.0155s/iter; left time: 138.0856s
	iters: 300, epoch: 5 | loss: 0.1210947
	speed: 0.0155s/iter; left time: 136.5091s
	iters: 400, epoch: 5 | loss: 0.1043574
	speed: 0.0155s/iter; left time: 134.8373s
	iters: 500, epoch: 5 | loss: 0.1402750
	speed: 0.0155s/iter; left time: 133.3947s
Epoch: 5 cost time: 9.088126420974731
Epoch: 5, Steps: 570 | Train Loss: 0.1391041 Vali Loss: 0.0406071 Test Loss: 0.1359927
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1352572
	speed: 0.0474s/iter; left time: 400.9199s
	iters: 200, epoch: 6 | loss: 0.0838789
	speed: 0.0155s/iter; left time: 129.4983s
	iters: 300, epoch: 6 | loss: 0.0928973
	speed: 0.0155s/iter; left time: 128.0808s
	iters: 400, epoch: 6 | loss: 0.1136319
	speed: 0.0155s/iter; left time: 126.3452s
	iters: 500, epoch: 6 | loss: 0.1100043
	speed: 0.0154s/iter; left time: 123.9783s
Epoch: 6 cost time: 9.087202072143555
Epoch: 6, Steps: 570 | Train Loss: 0.1362083 Vali Loss: 0.0389346 Test Loss: 0.1379836
Validation loss decreased (0.039441 --> 0.038935).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1572385
	speed: 0.0478s/iter; left time: 376.4598s
	iters: 200, epoch: 7 | loss: 0.1136995
	speed: 0.0155s/iter; left time: 120.2537s
	iters: 300, epoch: 7 | loss: 0.1127397
	speed: 0.0154s/iter; left time: 117.9674s
	iters: 400, epoch: 7 | loss: 0.1699889
	speed: 0.0154s/iter; left time: 116.4626s
	iters: 500, epoch: 7 | loss: 0.1568611
	speed: 0.0154s/iter; left time: 114.9613s
Epoch: 7 cost time: 9.036836862564087
Epoch: 7, Steps: 570 | Train Loss: 0.1344620 Vali Loss: 0.0390773 Test Loss: 0.1372278
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1037690
	speed: 0.0470s/iter; left time: 343.8776s
	iters: 200, epoch: 8 | loss: 0.2259812
	speed: 0.0154s/iter; left time: 110.7373s
	iters: 300, epoch: 8 | loss: 0.1242956
	speed: 0.0154s/iter; left time: 109.2862s
	iters: 400, epoch: 8 | loss: 0.1450970
	speed: 0.0154s/iter; left time: 107.6875s
	iters: 500, epoch: 8 | loss: 0.0958850
	speed: 0.0153s/iter; left time: 106.0425s
Epoch: 8 cost time: 8.993977546691895
Epoch: 8, Steps: 570 | Train Loss: 0.1325563 Vali Loss: 0.0391025 Test Loss: 0.1379633
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1156999
	speed: 0.0462s/iter; left time: 311.4984s
	iters: 200, epoch: 9 | loss: 0.1368076
	speed: 0.0154s/iter; left time: 102.0223s
	iters: 300, epoch: 9 | loss: 0.1567287
	speed: 0.0153s/iter; left time: 100.3012s
	iters: 400, epoch: 9 | loss: 0.1107672
	speed: 0.0153s/iter; left time: 98.6827s
	iters: 500, epoch: 9 | loss: 0.1328492
	speed: 0.0153s/iter; left time: 97.0839s
Epoch: 9 cost time: 9.007777214050293
Epoch: 9, Steps: 570 | Train Loss: 0.1322852 Vali Loss: 0.0391065 Test Loss: 0.1380195
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13817818462848663, mae:0.23476971685886383
>>> S LR=1e-4 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1424924
	speed: 0.0329s/iter; left time: 372.0113s
	iters: 200, epoch: 1 | loss: 0.2101776
	speed: 0.0208s/iter; left time: 233.5188s
	iters: 300, epoch: 1 | loss: 0.3386334
	speed: 0.0195s/iter; left time: 216.6388s
	iters: 400, epoch: 1 | loss: 0.2294670
	speed: 0.0187s/iter; left time: 205.6580s
	iters: 500, epoch: 1 | loss: 0.1676662
	speed: 0.0187s/iter; left time: 203.8421s
Epoch: 1 cost time: 12.423636198043823
Epoch: 1, Steps: 570 | Train Loss: 0.2080918 Vali Loss: 0.0403898 Test Loss: 0.1224171
Validation loss decreased (inf --> 0.040390).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2533986
	speed: 0.0568s/iter; left time: 609.3000s
	iters: 200, epoch: 2 | loss: 0.1539625
	speed: 0.0186s/iter; left time: 197.8842s
	iters: 300, epoch: 2 | loss: 0.1620104
	speed: 0.0186s/iter; left time: 195.8034s
	iters: 400, epoch: 2 | loss: 0.1387834
	speed: 0.0187s/iter; left time: 194.6444s
	iters: 500, epoch: 2 | loss: 0.1277678
	speed: 0.0186s/iter; left time: 192.3460s
Epoch: 2 cost time: 11.052546501159668
Epoch: 2, Steps: 570 | Train Loss: 0.1717921 Vali Loss: 0.0377514 Test Loss: 0.1273018
Validation loss decreased (0.040390 --> 0.037751).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1354762
	speed: 0.0579s/iter; left time: 588.0884s
	iters: 200, epoch: 3 | loss: 0.1480793
	speed: 0.0187s/iter; left time: 187.8436s
	iters: 300, epoch: 3 | loss: 0.1432800
	speed: 0.0188s/iter; left time: 187.1596s
	iters: 400, epoch: 3 | loss: 0.1089763
	speed: 0.0186s/iter; left time: 183.8795s
	iters: 500, epoch: 3 | loss: 0.1183892
	speed: 0.0206s/iter; left time: 200.9245s
Epoch: 3 cost time: 11.373915910720825
Epoch: 3, Steps: 570 | Train Loss: 0.1546425 Vali Loss: 0.0360849 Test Loss: 0.1340027
Validation loss decreased (0.037751 --> 0.036085).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1640683
	speed: 0.0611s/iter; left time: 585.9060s
	iters: 200, epoch: 4 | loss: 0.1763602
	speed: 0.0215s/iter; left time: 203.7402s
	iters: 300, epoch: 4 | loss: 0.1694287
	speed: 0.0215s/iter; left time: 201.8444s
	iters: 400, epoch: 4 | loss: 0.1009456
	speed: 0.0215s/iter; left time: 199.4465s
	iters: 500, epoch: 4 | loss: 0.1416764
	speed: 0.0214s/iter; left time: 197.1039s
Epoch: 4 cost time: 12.548388957977295
Epoch: 4, Steps: 570 | Train Loss: 0.1451348 Vali Loss: 0.0351043 Test Loss: 0.1289019
Validation loss decreased (0.036085 --> 0.035104).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1586238
	speed: 0.0623s/iter; left time: 562.0405s
	iters: 200, epoch: 5 | loss: 0.1453761
	speed: 0.0215s/iter; left time: 191.4184s
	iters: 300, epoch: 5 | loss: 0.1207920
	speed: 0.0214s/iter; left time: 188.9365s
	iters: 400, epoch: 5 | loss: 0.1269488
	speed: 0.0214s/iter; left time: 186.6548s
	iters: 500, epoch: 5 | loss: 0.1226374
	speed: 0.0214s/iter; left time: 184.4734s
Epoch: 5 cost time: 12.488831996917725
Epoch: 5, Steps: 570 | Train Loss: 0.1408261 Vali Loss: 0.0345765 Test Loss: 0.1332434
Validation loss decreased (0.035104 --> 0.034576).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0828350
	speed: 0.0599s/iter; left time: 506.5662s
	iters: 200, epoch: 6 | loss: 0.1510893
	speed: 0.0208s/iter; left time: 174.0076s
	iters: 300, epoch: 6 | loss: 0.0907750
	speed: 0.0186s/iter; left time: 153.1412s
	iters: 400, epoch: 6 | loss: 0.1587515
	speed: 0.0186s/iter; left time: 151.3554s
	iters: 500, epoch: 6 | loss: 0.1505148
	speed: 0.0186s/iter; left time: 149.5346s
Epoch: 6 cost time: 11.366083860397339
Epoch: 6, Steps: 570 | Train Loss: 0.1385038 Vali Loss: 0.0347284 Test Loss: 0.1316403
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1066051
	speed: 0.0551s/iter; left time: 434.6225s
	iters: 200, epoch: 7 | loss: 0.1527203
	speed: 0.0187s/iter; left time: 145.2624s
	iters: 300, epoch: 7 | loss: 0.1461912
	speed: 0.0187s/iter; left time: 143.3873s
	iters: 400, epoch: 7 | loss: 0.1382699
	speed: 0.0186s/iter; left time: 141.3049s
	iters: 500, epoch: 7 | loss: 0.1869414
	speed: 0.0186s/iter; left time: 139.1882s
Epoch: 7 cost time: 10.871952056884766
Epoch: 7, Steps: 570 | Train Loss: 0.1373207 Vali Loss: 0.0349825 Test Loss: 0.1266057
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1473718
	speed: 0.0557s/iter; left time: 407.4195s
	iters: 200, epoch: 8 | loss: 0.1079166
	speed: 0.0186s/iter; left time: 133.9805s
	iters: 300, epoch: 8 | loss: 0.1146075
	speed: 0.0185s/iter; left time: 131.8548s
	iters: 400, epoch: 8 | loss: 0.1609069
	speed: 0.0185s/iter; left time: 129.9485s
	iters: 500, epoch: 8 | loss: 0.1145801
	speed: 0.0185s/iter; left time: 128.1743s
Epoch: 8 cost time: 10.850090980529785
Epoch: 8, Steps: 570 | Train Loss: 0.1366312 Vali Loss: 0.0351880 Test Loss: 0.1254039
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13343840837478638, mae:0.2288070172071457
>>> S LR=1e-4 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3841106
	speed: 0.0312s/iter; left time: 353.0419s
	iters: 200, epoch: 1 | loss: 0.1833950
	speed: 0.0181s/iter; left time: 202.9866s
	iters: 300, epoch: 1 | loss: 0.1629973
	speed: 0.0181s/iter; left time: 201.2284s
	iters: 400, epoch: 1 | loss: 0.1559688
	speed: 0.0181s/iter; left time: 198.9369s
	iters: 500, epoch: 1 | loss: 0.2144813
	speed: 0.0181s/iter; left time: 197.6223s
Epoch: 1 cost time: 11.689270496368408
Epoch: 1, Steps: 570 | Train Loss: 0.1781150 Vali Loss: 0.0341248 Test Loss: 0.1147245
Validation loss decreased (inf --> 0.034125).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1182067
	speed: 0.0581s/iter; left time: 623.5263s
	iters: 200, epoch: 2 | loss: 0.2051763
	speed: 0.0184s/iter; left time: 195.2938s
	iters: 300, epoch: 2 | loss: 0.2309333
	speed: 0.0183s/iter; left time: 193.0256s
	iters: 400, epoch: 2 | loss: 0.1205259
	speed: 0.0184s/iter; left time: 191.6294s
	iters: 500, epoch: 2 | loss: 0.1211419
	speed: 0.0184s/iter; left time: 189.6787s
Epoch: 2 cost time: 10.750623941421509
Epoch: 2, Steps: 570 | Train Loss: 0.1491415 Vali Loss: 0.0322643 Test Loss: 0.1082606
Validation loss decreased (0.034125 --> 0.032264).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0903615
	speed: 0.0568s/iter; left time: 576.9010s
	iters: 200, epoch: 3 | loss: 0.1274339
	speed: 0.0182s/iter; left time: 183.2713s
	iters: 300, epoch: 3 | loss: 0.1211825
	speed: 0.0182s/iter; left time: 180.8783s
	iters: 400, epoch: 3 | loss: 0.1197106
	speed: 0.0181s/iter; left time: 178.9156s
	iters: 500, epoch: 3 | loss: 0.1060380
	speed: 0.0181s/iter; left time: 177.1487s
Epoch: 3 cost time: 10.651845693588257
Epoch: 3, Steps: 570 | Train Loss: 0.1374833 Vali Loss: 0.0313614 Test Loss: 0.1064045
Validation loss decreased (0.032264 --> 0.031361).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1397596
	speed: 0.0575s/iter; left time: 551.6807s
	iters: 200, epoch: 4 | loss: 0.0764695
	speed: 0.0182s/iter; left time: 172.6793s
	iters: 300, epoch: 4 | loss: 0.1833983
	speed: 0.0182s/iter; left time: 170.6840s
	iters: 400, epoch: 4 | loss: 0.1286897
	speed: 0.0182s/iter; left time: 169.0502s
	iters: 500, epoch: 4 | loss: 0.0996628
	speed: 0.0182s/iter; left time: 167.4098s
Epoch: 4 cost time: 10.66336464881897
Epoch: 4, Steps: 570 | Train Loss: 0.1314821 Vali Loss: 0.0304499 Test Loss: 0.1060970
Validation loss decreased (0.031361 --> 0.030450).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1148466
	speed: 0.0549s/iter; left time: 495.1826s
	iters: 200, epoch: 5 | loss: 0.1263189
	speed: 0.0183s/iter; left time: 162.9800s
	iters: 300, epoch: 5 | loss: 0.1412738
	speed: 0.0183s/iter; left time: 161.0403s
	iters: 400, epoch: 5 | loss: 0.1276208
	speed: 0.0183s/iter; left time: 159.3803s
	iters: 500, epoch: 5 | loss: 0.1041000
	speed: 0.0183s/iter; left time: 157.3343s
Epoch: 5 cost time: 10.707294225692749
Epoch: 5, Steps: 570 | Train Loss: 0.1275811 Vali Loss: 0.0302310 Test Loss: 0.1058066
Validation loss decreased (0.030450 --> 0.030231).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1902533
	speed: 0.0566s/iter; left time: 478.1831s
	iters: 200, epoch: 6 | loss: 0.1024624
	speed: 0.0182s/iter; left time: 151.5790s
	iters: 300, epoch: 6 | loss: 0.1471323
	speed: 0.0181s/iter; left time: 149.4256s
	iters: 400, epoch: 6 | loss: 0.1036073
	speed: 0.0182s/iter; left time: 148.4410s
	iters: 500, epoch: 6 | loss: 0.0821691
	speed: 0.0182s/iter; left time: 146.6955s
Epoch: 6 cost time: 10.640858173370361
Epoch: 6, Steps: 570 | Train Loss: 0.1258426 Vali Loss: 0.0299987 Test Loss: 0.1049985
Validation loss decreased (0.030231 --> 0.029999).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1082127
	speed: 0.0552s/iter; left time: 435.1595s
	iters: 200, epoch: 7 | loss: 0.1439881
	speed: 0.0181s/iter; left time: 140.9625s
	iters: 300, epoch: 7 | loss: 0.0841094
	speed: 0.0181s/iter; left time: 139.1185s
	iters: 400, epoch: 7 | loss: 0.1325714
	speed: 0.0181s/iter; left time: 137.2740s
	iters: 500, epoch: 7 | loss: 0.1120117
	speed: 0.0181s/iter; left time: 135.6718s
Epoch: 7 cost time: 10.634926795959473
Epoch: 7, Steps: 570 | Train Loss: 0.1241709 Vali Loss: 0.0298302 Test Loss: 0.1051237
Validation loss decreased (0.029999 --> 0.029830).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0997066
	speed: 0.0591s/iter; left time: 432.0445s
	iters: 200, epoch: 8 | loss: 0.1056011
	speed: 0.0183s/iter; left time: 131.9140s
	iters: 300, epoch: 8 | loss: 0.1324004
	speed: 0.0183s/iter; left time: 129.8039s
	iters: 400, epoch: 8 | loss: 0.1277326
	speed: 0.0183s/iter; left time: 127.9624s
	iters: 500, epoch: 8 | loss: 0.1589139
	speed: 0.0183s/iter; left time: 126.2138s
Epoch: 8 cost time: 10.687026262283325
Epoch: 8, Steps: 570 | Train Loss: 0.1229970 Vali Loss: 0.0298472 Test Loss: 0.1049224
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0653042
	speed: 0.0549s/iter; left time: 370.3293s
	iters: 200, epoch: 9 | loss: 0.1068230
	speed: 0.0181s/iter; left time: 120.3715s
	iters: 300, epoch: 9 | loss: 0.1302689
	speed: 0.0181s/iter; left time: 118.1374s
	iters: 400, epoch: 9 | loss: 0.1317150
	speed: 0.0181s/iter; left time: 116.6156s
	iters: 500, epoch: 9 | loss: 0.1069152
	speed: 0.0181s/iter; left time: 114.6371s
Epoch: 9 cost time: 10.592551946640015
Epoch: 9, Steps: 570 | Train Loss: 0.1232751 Vali Loss: 0.0299224 Test Loss: 0.1049182
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0850267
	speed: 0.0574s/iter; left time: 353.9178s
	iters: 200, epoch: 10 | loss: 0.0952502
	speed: 0.0203s/iter; left time: 123.2107s
	iters: 300, epoch: 10 | loss: 0.1695967
	speed: 0.0183s/iter; left time: 109.1118s
	iters: 400, epoch: 10 | loss: 0.1409134
	speed: 0.0183s/iter; left time: 107.5534s
	iters: 500, epoch: 10 | loss: 0.1171911
	speed: 0.0183s/iter; left time: 105.5473s
Epoch: 10 cost time: 11.122932195663452
Epoch: 10, Steps: 570 | Train Loss: 0.1236706 Vali Loss: 0.0297934 Test Loss: 0.1049396
Validation loss decreased (0.029830 --> 0.029793).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1394400
	speed: 0.0557s/iter; left time: 312.1171s
	iters: 200, epoch: 11 | loss: 0.1475997
	speed: 0.0182s/iter; left time: 100.1487s
	iters: 300, epoch: 11 | loss: 0.0933854
	speed: 0.0182s/iter; left time: 98.2841s
	iters: 400, epoch: 11 | loss: 0.1533953
	speed: 0.0182s/iter; left time: 96.5211s
	iters: 500, epoch: 11 | loss: 0.1299676
	speed: 0.0182s/iter; left time: 94.6096s
Epoch: 11 cost time: 10.640619993209839
Epoch: 11, Steps: 570 | Train Loss: 0.1236765 Vali Loss: 0.0297886 Test Loss: 0.1049627
Validation loss decreased (0.029793 --> 0.029789).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1727468
	speed: 0.0550s/iter; left time: 276.5956s
	iters: 200, epoch: 12 | loss: 0.1153083
	speed: 0.0183s/iter; left time: 90.2588s
	iters: 300, epoch: 12 | loss: 0.0945611
	speed: 0.0183s/iter; left time: 88.4082s
	iters: 400, epoch: 12 | loss: 0.1018662
	speed: 0.0183s/iter; left time: 86.4655s
	iters: 500, epoch: 12 | loss: 0.1085231
	speed: 0.0183s/iter; left time: 84.6912s
Epoch: 12 cost time: 10.691309690475464
Epoch: 12, Steps: 570 | Train Loss: 0.1230555 Vali Loss: 0.0297848 Test Loss: 0.1049643
Validation loss decreased (0.029789 --> 0.029785).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0948728
	speed: 0.0577s/iter; left time: 257.5172s
	iters: 200, epoch: 13 | loss: 0.1606615
	speed: 0.0182s/iter; left time: 79.2358s
	iters: 300, epoch: 13 | loss: 0.0919061
	speed: 0.0182s/iter; left time: 77.4481s
	iters: 400, epoch: 13 | loss: 0.1318220
	speed: 0.0181s/iter; left time: 75.3996s
	iters: 500, epoch: 13 | loss: 0.1572973
	speed: 0.0181s/iter; left time: 73.6135s
Epoch: 13 cost time: 10.641706228256226
Epoch: 13, Steps: 570 | Train Loss: 0.1244982 Vali Loss: 0.0298293 Test Loss: 0.1049688
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1296316
	speed: 0.0546s/iter; left time: 212.5110s
	iters: 200, epoch: 14 | loss: 0.1134148
	speed: 0.0183s/iter; left time: 69.3204s
	iters: 300, epoch: 14 | loss: 0.1244567
	speed: 0.0183s/iter; left time: 67.4797s
	iters: 400, epoch: 14 | loss: 0.1236009
	speed: 0.0183s/iter; left time: 65.6498s
	iters: 500, epoch: 14 | loss: 0.1355400
	speed: 0.0182s/iter; left time: 63.4356s
Epoch: 14 cost time: 10.689456701278687
Epoch: 14, Steps: 570 | Train Loss: 0.1238471 Vali Loss: 0.0299255 Test Loss: 0.1049687
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1317246
	speed: 0.0570s/iter; left time: 189.3340s
	iters: 200, epoch: 15 | loss: 0.1044191
	speed: 0.0181s/iter; left time: 58.3771s
	iters: 300, epoch: 15 | loss: 0.0741475
	speed: 0.0181s/iter; left time: 56.6222s
	iters: 400, epoch: 15 | loss: 0.1199112
	speed: 0.0181s/iter; left time: 54.7805s
	iters: 500, epoch: 15 | loss: 0.1698155
	speed: 0.0182s/iter; left time: 53.0328s
Epoch: 15 cost time: 10.60436725616455
Epoch: 15, Steps: 570 | Train Loss: 0.1231916 Vali Loss: 0.0297787 Test Loss: 0.1049708
Validation loss decreased (0.029785 --> 0.029779).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1322703
	speed: 0.0571s/iter; left time: 156.9875s
	iters: 200, epoch: 16 | loss: 0.1083440
	speed: 0.0181s/iter; left time: 48.1065s
	iters: 300, epoch: 16 | loss: 0.0999847
	speed: 0.0182s/iter; left time: 46.4376s
	iters: 400, epoch: 16 | loss: 0.0888042
	speed: 0.0182s/iter; left time: 44.5898s
	iters: 500, epoch: 16 | loss: 0.1332451
	speed: 0.0182s/iter; left time: 42.7359s
Epoch: 16 cost time: 10.630751609802246
Epoch: 16, Steps: 570 | Train Loss: 0.1237421 Vali Loss: 0.0298915 Test Loss: 0.1049702
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1168345
	speed: 0.0552s/iter; left time: 120.3067s
	iters: 200, epoch: 17 | loss: 0.1080847
	speed: 0.0181s/iter; left time: 37.7091s
	iters: 300, epoch: 17 | loss: 0.1034768
	speed: 0.0181s/iter; left time: 35.9116s
	iters: 400, epoch: 17 | loss: 0.1549898
	speed: 0.0181s/iter; left time: 34.0690s
	iters: 500, epoch: 17 | loss: 0.1548515
	speed: 0.0181s/iter; left time: 32.2290s
Epoch: 17 cost time: 10.609353303909302
Epoch: 17, Steps: 570 | Train Loss: 0.1245157 Vali Loss: 0.0297809 Test Loss: 0.1049705
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1612630
	speed: 0.0568s/iter; left time: 91.5646s
	iters: 200, epoch: 18 | loss: 0.1303127
	speed: 0.0205s/iter; left time: 31.0259s
	iters: 300, epoch: 18 | loss: 0.0696217
	speed: 0.0205s/iter; left time: 28.9714s
	iters: 400, epoch: 18 | loss: 0.0803058
	speed: 0.0205s/iter; left time: 26.8621s
	iters: 500, epoch: 18 | loss: 0.1383840
	speed: 0.0184s/iter; left time: 22.2784s
Epoch: 18 cost time: 11.610804080963135
Epoch: 18, Steps: 570 | Train Loss: 0.1235111 Vali Loss: 0.0299320 Test Loss: 0.1049704
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10511504113674164, mae:0.19440995156764984
>>> S LR=1e-4 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2573188
	speed: 0.0297s/iter; left time: 335.1513s
	iters: 200, epoch: 1 | loss: 0.1673542
	speed: 0.0183s/iter; left time: 204.4202s
	iters: 300, epoch: 1 | loss: 0.2035432
	speed: 0.0182s/iter; left time: 202.5910s
	iters: 400, epoch: 1 | loss: 0.2126761
	speed: 0.0182s/iter; left time: 199.8456s
	iters: 500, epoch: 1 | loss: 0.3022025
	speed: 0.0182s/iter; left time: 198.1546s
Epoch: 1 cost time: 11.57494854927063
Epoch: 1, Steps: 570 | Train Loss: 0.2147402 Vali Loss: 0.0386709 Test Loss: 0.1289564
Validation loss decreased (inf --> 0.038671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2629803
	speed: 0.0585s/iter; left time: 628.0671s
	iters: 200, epoch: 2 | loss: 0.2252882
	speed: 0.0207s/iter; left time: 219.8999s
	iters: 300, epoch: 2 | loss: 0.3575718
	speed: 0.0206s/iter; left time: 217.1110s
	iters: 400, epoch: 2 | loss: 0.2009303
	speed: 0.0206s/iter; left time: 214.7924s
	iters: 500, epoch: 2 | loss: 0.0925606
	speed: 0.0203s/iter; left time: 209.8452s
Epoch: 2 cost time: 11.849719047546387
Epoch: 2, Steps: 570 | Train Loss: 0.1803239 Vali Loss: 0.0443586 Test Loss: 0.1413825
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1429263
	speed: 0.0551s/iter; left time: 560.0813s
	iters: 200, epoch: 3 | loss: 0.1701712
	speed: 0.0182s/iter; left time: 183.5549s
	iters: 300, epoch: 3 | loss: 0.1513829
	speed: 0.0183s/iter; left time: 182.4065s
	iters: 400, epoch: 3 | loss: 0.1871774
	speed: 0.0183s/iter; left time: 180.2510s
	iters: 500, epoch: 3 | loss: 0.1786547
	speed: 0.0183s/iter; left time: 178.2945s
Epoch: 3 cost time: 10.698658466339111
Epoch: 3, Steps: 570 | Train Loss: 0.1636456 Vali Loss: 0.0409036 Test Loss: 0.1320202
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1617582
	speed: 0.0555s/iter; left time: 531.9421s
	iters: 200, epoch: 4 | loss: 0.1638597
	speed: 0.0184s/iter; left time: 174.5242s
	iters: 300, epoch: 4 | loss: 0.1420150
	speed: 0.0183s/iter; left time: 172.2895s
	iters: 400, epoch: 4 | loss: 0.1692642
	speed: 0.0183s/iter; left time: 170.0167s
	iters: 500, epoch: 4 | loss: 0.1106062
	speed: 0.0183s/iter; left time: 168.3557s
Epoch: 4 cost time: 10.746074438095093
Epoch: 4, Steps: 570 | Train Loss: 0.1559675 Vali Loss: 0.0386364 Test Loss: 0.1312052
Validation loss decreased (0.038671 --> 0.038636).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1413657
	speed: 0.0562s/iter; left time: 507.0363s
	iters: 200, epoch: 5 | loss: 0.1485675
	speed: 0.0181s/iter; left time: 161.6914s
	iters: 300, epoch: 5 | loss: 0.1382783
	speed: 0.0181s/iter; left time: 159.9013s
	iters: 400, epoch: 5 | loss: 0.1168073
	speed: 0.0181s/iter; left time: 158.1703s
	iters: 500, epoch: 5 | loss: 0.0889560
	speed: 0.0181s/iter; left time: 156.1052s
Epoch: 5 cost time: 10.602811574935913
Epoch: 5, Steps: 570 | Train Loss: 0.1510360 Vali Loss: 0.0378457 Test Loss: 0.1292984
Validation loss decreased (0.038636 --> 0.037846).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1868465
	speed: 0.0547s/iter; left time: 462.4625s
	iters: 200, epoch: 6 | loss: 0.1058032
	speed: 0.0181s/iter; left time: 151.4542s
	iters: 300, epoch: 6 | loss: 0.2166542
	speed: 0.0181s/iter; left time: 149.6231s
	iters: 400, epoch: 6 | loss: 0.1091802
	speed: 0.0181s/iter; left time: 147.9385s
	iters: 500, epoch: 6 | loss: 0.1453912
	speed: 0.0182s/iter; left time: 146.4428s
Epoch: 6 cost time: 10.632238149642944
Epoch: 6, Steps: 570 | Train Loss: 0.1486617 Vali Loss: 0.0379396 Test Loss: 0.1301558
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1302526
	speed: 0.0557s/iter; left time: 438.5958s
	iters: 200, epoch: 7 | loss: 0.1542099
	speed: 0.0184s/iter; left time: 142.8926s
	iters: 300, epoch: 7 | loss: 0.1613683
	speed: 0.0183s/iter; left time: 140.8461s
	iters: 400, epoch: 7 | loss: 0.1421275
	speed: 0.0183s/iter; left time: 138.9120s
	iters: 500, epoch: 7 | loss: 0.0994583
	speed: 0.0183s/iter; left time: 137.0696s
Epoch: 7 cost time: 10.723340511322021
Epoch: 7, Steps: 570 | Train Loss: 0.1479811 Vali Loss: 0.0378909 Test Loss: 0.1299464
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1142416
	speed: 0.0546s/iter; left time: 398.9869s
	iters: 200, epoch: 8 | loss: 0.1234327
	speed: 0.0182s/iter; left time: 131.3565s
	iters: 300, epoch: 8 | loss: 0.1710892
	speed: 0.0182s/iter; left time: 129.5962s
	iters: 400, epoch: 8 | loss: 0.2421329
	speed: 0.0182s/iter; left time: 127.5247s
	iters: 500, epoch: 8 | loss: 0.1451178
	speed: 0.0182s/iter; left time: 125.5703s
Epoch: 8 cost time: 10.651519536972046
Epoch: 8, Steps: 570 | Train Loss: 0.1476829 Vali Loss: 0.0379226 Test Loss: 0.1300586
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1294264793395996, mae:0.22864919900894165
>>> S LR=1e-4 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2042847
	speed: 0.0336s/iter; left time: 379.6987s
	iters: 200, epoch: 1 | loss: 0.1579283
	speed: 0.0219s/iter; left time: 244.7539s
	iters: 300, epoch: 1 | loss: 0.1996737
	speed: 0.0219s/iter; left time: 242.6746s
	iters: 400, epoch: 1 | loss: 0.2732318
	speed: 0.0219s/iter; left time: 240.7594s
	iters: 500, epoch: 1 | loss: 0.1670187
	speed: 0.0218s/iter; left time: 237.9347s
Epoch: 1 cost time: 13.689029693603516
Epoch: 1, Steps: 570 | Train Loss: 0.2050170 Vali Loss: 0.0401243 Test Loss: 0.1292612
Validation loss decreased (inf --> 0.040124).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2608263
	speed: 0.0620s/iter; left time: 665.5325s
	iters: 200, epoch: 2 | loss: 0.1453330
	speed: 0.0218s/iter; left time: 232.0530s
	iters: 300, epoch: 2 | loss: 0.1549633
	speed: 0.0219s/iter; left time: 230.4472s
	iters: 400, epoch: 2 | loss: 0.1610774
	speed: 0.0219s/iter; left time: 228.2891s
	iters: 500, epoch: 2 | loss: 0.1182576
	speed: 0.0219s/iter; left time: 226.1520s
Epoch: 2 cost time: 12.749770402908325
Epoch: 2, Steps: 570 | Train Loss: 0.1701651 Vali Loss: 0.0388756 Test Loss: 0.1274746
Validation loss decreased (0.040124 --> 0.038876).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2657304
	speed: 0.0618s/iter; left time: 628.1697s
	iters: 200, epoch: 3 | loss: 0.1139983
	speed: 0.0219s/iter; left time: 220.1957s
	iters: 300, epoch: 3 | loss: 0.1985907
	speed: 0.0219s/iter; left time: 218.3419s
	iters: 400, epoch: 3 | loss: 0.1164640
	speed: 0.0219s/iter; left time: 215.9038s
	iters: 500, epoch: 3 | loss: 0.1193732
	speed: 0.0219s/iter; left time: 213.4233s
Epoch: 3 cost time: 12.771764039993286
Epoch: 3, Steps: 570 | Train Loss: 0.1464696 Vali Loss: 0.0372375 Test Loss: 0.1402633
Validation loss decreased (0.038876 --> 0.037238).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1131305
	speed: 0.0645s/iter; left time: 618.3481s
	iters: 200, epoch: 4 | loss: 0.0999139
	speed: 0.0219s/iter; left time: 207.8191s
	iters: 300, epoch: 4 | loss: 0.1155753
	speed: 0.0219s/iter; left time: 205.7495s
	iters: 400, epoch: 4 | loss: 0.1058184
	speed: 0.0219s/iter; left time: 203.2778s
	iters: 500, epoch: 4 | loss: 0.1680255
	speed: 0.0219s/iter; left time: 201.1867s
Epoch: 4 cost time: 12.760048151016235
Epoch: 4, Steps: 570 | Train Loss: 0.1299794 Vali Loss: 0.0371458 Test Loss: 0.1417982
Validation loss decreased (0.037238 --> 0.037146).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1504293
	speed: 0.0616s/iter; left time: 555.7870s
	iters: 200, epoch: 5 | loss: 0.1258219
	speed: 0.0218s/iter; left time: 194.1588s
	iters: 300, epoch: 5 | loss: 0.0900354
	speed: 0.0218s/iter; left time: 191.8810s
	iters: 400, epoch: 5 | loss: 0.1137363
	speed: 0.0217s/iter; left time: 189.6162s
	iters: 500, epoch: 5 | loss: 0.1140945
	speed: 0.0217s/iter; left time: 187.4334s
Epoch: 5 cost time: 12.698445081710815
Epoch: 5, Steps: 570 | Train Loss: 0.1228012 Vali Loss: 0.0361384 Test Loss: 0.1419031
Validation loss decreased (0.037146 --> 0.036138).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1073141
	speed: 0.0626s/iter; left time: 528.6814s
	iters: 200, epoch: 6 | loss: 0.1323151
	speed: 0.0219s/iter; left time: 182.9502s
	iters: 300, epoch: 6 | loss: 0.1035420
	speed: 0.0219s/iter; left time: 180.7217s
	iters: 400, epoch: 6 | loss: 0.0994591
	speed: 0.0219s/iter; left time: 178.5454s
	iters: 500, epoch: 6 | loss: 0.1483284
	speed: 0.0219s/iter; left time: 176.6077s
Epoch: 6 cost time: 12.783865451812744
Epoch: 6, Steps: 570 | Train Loss: 0.1186486 Vali Loss: 0.0370682 Test Loss: 0.1356049
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1399117
	speed: 0.0608s/iter; left time: 479.0670s
	iters: 200, epoch: 7 | loss: 0.1314279
	speed: 0.0232s/iter; left time: 180.3632s
	iters: 300, epoch: 7 | loss: 0.1088089
	speed: 0.0235s/iter; left time: 180.6990s
	iters: 400, epoch: 7 | loss: 0.1165962
	speed: 0.0235s/iter; left time: 178.3312s
	iters: 500, epoch: 7 | loss: 0.1100211
	speed: 0.0235s/iter; left time: 175.9917s
Epoch: 7 cost time: 13.446239471435547
Epoch: 7, Steps: 570 | Train Loss: 0.1161654 Vali Loss: 0.0364213 Test Loss: 0.1349483
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0949142
	speed: 0.0649s/iter; left time: 474.6409s
	iters: 200, epoch: 8 | loss: 0.2248864
	speed: 0.0218s/iter; left time: 156.9738s
	iters: 300, epoch: 8 | loss: 0.0973242
	speed: 0.0218s/iter; left time: 154.7709s
	iters: 400, epoch: 8 | loss: 0.0915071
	speed: 0.0218s/iter; left time: 152.8052s
	iters: 500, epoch: 8 | loss: 0.0774409
	speed: 0.0218s/iter; left time: 150.6571s
Epoch: 8 cost time: 12.712472677230835
Epoch: 8, Steps: 570 | Train Loss: 0.1148945 Vali Loss: 0.0361390 Test Loss: 0.1364971
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14205965399742126, mae:0.2311355024576187
>>> S LR=1e-4 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1753421
	speed: 0.0328s/iter; left time: 370.3867s
	iters: 200, epoch: 1 | loss: 0.0989139
	speed: 0.0210s/iter; left time: 235.1271s
	iters: 300, epoch: 1 | loss: 0.1656028
	speed: 0.0210s/iter; left time: 233.1598s
	iters: 400, epoch: 1 | loss: 0.1312428
	speed: 0.0210s/iter; left time: 231.2061s
	iters: 500, epoch: 1 | loss: 0.1733267
	speed: 0.0210s/iter; left time: 229.0776s
Epoch: 1 cost time: 13.202439069747925
Epoch: 1, Steps: 570 | Train Loss: 0.1730613 Vali Loss: 0.0352282 Test Loss: 0.1181261
Validation loss decreased (inf --> 0.035228).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1693680
	speed: 0.0613s/iter; left time: 657.6274s
	iters: 200, epoch: 2 | loss: 0.1255713
	speed: 0.0212s/iter; left time: 224.9684s
	iters: 300, epoch: 2 | loss: 0.1327559
	speed: 0.0212s/iter; left time: 222.7782s
	iters: 400, epoch: 2 | loss: 0.1241877
	speed: 0.0211s/iter; left time: 220.5496s
	iters: 500, epoch: 2 | loss: 0.1043405
	speed: 0.0212s/iter; left time: 218.7186s
Epoch: 2 cost time: 12.366209030151367
Epoch: 2, Steps: 570 | Train Loss: 0.1466067 Vali Loss: 0.0328085 Test Loss: 0.1092286
Validation loss decreased (0.035228 --> 0.032809).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1212538
	speed: 0.0612s/iter; left time: 621.8128s
	iters: 200, epoch: 3 | loss: 0.1044343
	speed: 0.0211s/iter; left time: 212.1753s
	iters: 300, epoch: 3 | loss: 0.1231145
	speed: 0.0211s/iter; left time: 210.0841s
	iters: 400, epoch: 3 | loss: 0.1149569
	speed: 0.0211s/iter; left time: 207.9836s
	iters: 500, epoch: 3 | loss: 0.1192814
	speed: 0.0211s/iter; left time: 205.6960s
Epoch: 3 cost time: 12.324919939041138
Epoch: 3, Steps: 570 | Train Loss: 0.1310170 Vali Loss: 0.0310294 Test Loss: 0.1098928
Validation loss decreased (0.032809 --> 0.031029).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1025756
	speed: 0.0606s/iter; left time: 581.1985s
	iters: 200, epoch: 4 | loss: 0.1351104
	speed: 0.0210s/iter; left time: 199.4661s
	iters: 300, epoch: 4 | loss: 0.1387953
	speed: 0.0210s/iter; left time: 197.4269s
	iters: 400, epoch: 4 | loss: 0.1537128
	speed: 0.0210s/iter; left time: 195.2387s
	iters: 500, epoch: 4 | loss: 0.1073318
	speed: 0.0210s/iter; left time: 193.1730s
Epoch: 4 cost time: 12.293843746185303
Epoch: 4, Steps: 570 | Train Loss: 0.1212942 Vali Loss: 0.0302226 Test Loss: 0.1097836
Validation loss decreased (0.031029 --> 0.030223).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1627110
	speed: 0.0600s/iter; left time: 541.2902s
	iters: 200, epoch: 5 | loss: 0.0945868
	speed: 0.0211s/iter; left time: 187.9628s
	iters: 300, epoch: 5 | loss: 0.1059905
	speed: 0.0211s/iter; left time: 185.9319s
	iters: 400, epoch: 5 | loss: 0.1390586
	speed: 0.0211s/iter; left time: 183.6632s
	iters: 500, epoch: 5 | loss: 0.1129211
	speed: 0.0211s/iter; left time: 181.5438s
Epoch: 5 cost time: 12.303724527359009
Epoch: 5, Steps: 570 | Train Loss: 0.1150320 Vali Loss: 0.0303311 Test Loss: 0.1088183
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1035375
	speed: 0.0589s/iter; left time: 498.1741s
	iters: 200, epoch: 6 | loss: 0.1551655
	speed: 0.0211s/iter; left time: 176.2494s
	iters: 300, epoch: 6 | loss: 0.1549740
	speed: 0.0211s/iter; left time: 174.1716s
	iters: 400, epoch: 6 | loss: 0.0774004
	speed: 0.0211s/iter; left time: 172.0484s
	iters: 500, epoch: 6 | loss: 0.0829343
	speed: 0.0211s/iter; left time: 169.8316s
Epoch: 6 cost time: 12.287154197692871
Epoch: 6, Steps: 570 | Train Loss: 0.1109236 Vali Loss: 0.0298309 Test Loss: 0.1082491
Validation loss decreased (0.030223 --> 0.029831).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1066946
	speed: 0.0601s/iter; left time: 473.4537s
	iters: 200, epoch: 7 | loss: 0.1285324
	speed: 0.0211s/iter; left time: 164.0864s
	iters: 300, epoch: 7 | loss: 0.1409371
	speed: 0.0211s/iter; left time: 161.8119s
	iters: 400, epoch: 7 | loss: 0.0825900
	speed: 0.0211s/iter; left time: 159.7576s
	iters: 500, epoch: 7 | loss: 0.1402860
	speed: 0.0211s/iter; left time: 157.6706s
Epoch: 7 cost time: 12.314125061035156
Epoch: 7, Steps: 570 | Train Loss: 0.1094213 Vali Loss: 0.0299961 Test Loss: 0.1091201
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1057640
	speed: 0.0610s/iter; left time: 446.3288s
	iters: 200, epoch: 8 | loss: 0.1015079
	speed: 0.0212s/iter; left time: 152.6525s
	iters: 300, epoch: 8 | loss: 0.1285518
	speed: 0.0212s/iter; left time: 150.6151s
	iters: 400, epoch: 8 | loss: 0.0885675
	speed: 0.0212s/iter; left time: 148.4800s
	iters: 500, epoch: 8 | loss: 0.1589998
	speed: 0.0211s/iter; left time: 146.1662s
Epoch: 8 cost time: 12.345924854278564
Epoch: 8, Steps: 570 | Train Loss: 0.1085939 Vali Loss: 0.0296489 Test Loss: 0.1088099
Validation loss decreased (0.029831 --> 0.029649).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0922612
	speed: 0.0619s/iter; left time: 417.0958s
	iters: 200, epoch: 9 | loss: 0.1617527
	speed: 0.0212s/iter; left time: 140.5749s
	iters: 300, epoch: 9 | loss: 0.1232753
	speed: 0.0211s/iter; left time: 137.7511s
	iters: 400, epoch: 9 | loss: 0.0840215
	speed: 0.0211s/iter; left time: 135.7837s
	iters: 500, epoch: 9 | loss: 0.0747897
	speed: 0.0211s/iter; left time: 133.7750s
Epoch: 9 cost time: 12.319870948791504
Epoch: 9, Steps: 570 | Train Loss: 0.1087639 Vali Loss: 0.0297693 Test Loss: 0.1088985
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0877023
	speed: 0.0607s/iter; left time: 374.5599s
	iters: 200, epoch: 10 | loss: 0.0995926
	speed: 0.0212s/iter; left time: 128.4027s
	iters: 300, epoch: 10 | loss: 0.0852331
	speed: 0.0211s/iter; left time: 126.2449s
	iters: 400, epoch: 10 | loss: 0.1149084
	speed: 0.0211s/iter; left time: 124.0667s
	iters: 500, epoch: 10 | loss: 0.1500159
	speed: 0.0211s/iter; left time: 121.9151s
Epoch: 10 cost time: 12.335702180862427
Epoch: 10, Steps: 570 | Train Loss: 0.1069793 Vali Loss: 0.0297300 Test Loss: 0.1089661
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1062250
	speed: 0.0605s/iter; left time: 338.8481s
	iters: 200, epoch: 11 | loss: 0.0919843
	speed: 0.0211s/iter; left time: 116.2988s
	iters: 300, epoch: 11 | loss: 0.0915351
	speed: 0.0212s/iter; left time: 114.2318s
	iters: 400, epoch: 11 | loss: 0.0801368
	speed: 0.0211s/iter; left time: 111.9375s
	iters: 500, epoch: 11 | loss: 0.1485823
	speed: 0.0211s/iter; left time: 109.8422s
Epoch: 11 cost time: 12.297509908676147
Epoch: 11, Steps: 570 | Train Loss: 0.1080359 Vali Loss: 0.0296296 Test Loss: 0.1091473
Validation loss decreased (0.029649 --> 0.029630).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1039763
	speed: 0.0606s/iter; left time: 305.0760s
	iters: 200, epoch: 12 | loss: 0.1207647
	speed: 0.0211s/iter; left time: 104.2140s
	iters: 300, epoch: 12 | loss: 0.0951083
	speed: 0.0211s/iter; left time: 102.0056s
	iters: 400, epoch: 12 | loss: 0.1963736
	speed: 0.0211s/iter; left time: 99.8851s
	iters: 500, epoch: 12 | loss: 0.0974608
	speed: 0.0211s/iter; left time: 97.7923s
Epoch: 12 cost time: 12.321367263793945
Epoch: 12, Steps: 570 | Train Loss: 0.1070494 Vali Loss: 0.0296441 Test Loss: 0.1091507
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0853926
	speed: 0.0626s/iter; left time: 279.2848s
	iters: 200, epoch: 13 | loss: 0.1175986
	speed: 0.0211s/iter; left time: 91.9453s
	iters: 300, epoch: 13 | loss: 0.1656200
	speed: 0.0211s/iter; left time: 89.8373s
	iters: 400, epoch: 13 | loss: 0.0930413
	speed: 0.0211s/iter; left time: 87.7156s
	iters: 500, epoch: 13 | loss: 0.1178726
	speed: 0.0211s/iter; left time: 85.5953s
Epoch: 13 cost time: 12.309902429580688
Epoch: 13, Steps: 570 | Train Loss: 0.1075019 Vali Loss: 0.0296619 Test Loss: 0.1091518
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1188796
	speed: 0.0608s/iter; left time: 236.5219s
	iters: 200, epoch: 14 | loss: 0.0874909
	speed: 0.0213s/iter; left time: 80.9289s
	iters: 300, epoch: 14 | loss: 0.0853533
	speed: 0.0211s/iter; left time: 77.9652s
	iters: 400, epoch: 14 | loss: 0.1113609
	speed: 0.0211s/iter; left time: 75.8451s
	iters: 500, epoch: 14 | loss: 0.1359161
	speed: 0.0211s/iter; left time: 73.7188s
Epoch: 14 cost time: 12.46790099143982
Epoch: 14, Steps: 570 | Train Loss: 0.1067671 Vali Loss: 0.0296346 Test Loss: 0.1091616
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10926966369152069, mae:0.1962956339120865
>>> S LR=1e-4 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1997528
	speed: 0.0316s/iter; left time: 357.4261s
	iters: 200, epoch: 1 | loss: 0.1752656
	speed: 0.0198s/iter; left time: 222.0841s
	iters: 300, epoch: 1 | loss: 0.1983516
	speed: 0.0198s/iter; left time: 219.9650s
	iters: 400, epoch: 1 | loss: 0.2598040
	speed: 0.0198s/iter; left time: 217.9733s
	iters: 500, epoch: 1 | loss: 0.2258015
	speed: 0.0198s/iter; left time: 216.0542s
Epoch: 1 cost time: 12.53748869895935
Epoch: 1, Steps: 570 | Train Loss: 0.2105230 Vali Loss: 0.0413598 Test Loss: 0.1328395
Validation loss decreased (inf --> 0.041360).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1178522
	speed: 0.0584s/iter; left time: 626.6552s
	iters: 200, epoch: 2 | loss: 0.2849484
	speed: 0.0199s/iter; left time: 211.5803s
	iters: 300, epoch: 2 | loss: 0.1315280
	speed: 0.0198s/iter; left time: 208.9403s
	iters: 400, epoch: 2 | loss: 0.1511428
	speed: 0.0199s/iter; left time: 207.1733s
	iters: 500, epoch: 2 | loss: 0.1264798
	speed: 0.0198s/iter; left time: 205.0115s
Epoch: 2 cost time: 11.609927415847778
Epoch: 2, Steps: 570 | Train Loss: 0.1760934 Vali Loss: 0.0413256 Test Loss: 0.1336366
Validation loss decreased (0.041360 --> 0.041326).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1126576
	speed: 0.0608s/iter; left time: 617.4044s
	iters: 200, epoch: 3 | loss: 0.1305024
	speed: 0.0200s/iter; left time: 201.5741s
	iters: 300, epoch: 3 | loss: 0.1198334
	speed: 0.0200s/iter; left time: 199.0278s
	iters: 400, epoch: 3 | loss: 0.1612100
	speed: 0.0200s/iter; left time: 196.9898s
	iters: 500, epoch: 3 | loss: 0.1504014
	speed: 0.0200s/iter; left time: 194.9728s
Epoch: 3 cost time: 11.701565265655518
Epoch: 3, Steps: 570 | Train Loss: 0.1541678 Vali Loss: 0.0418797 Test Loss: 0.1316622
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1048494
	speed: 0.0569s/iter; left time: 545.7084s
	iters: 200, epoch: 4 | loss: 0.1432639
	speed: 0.0200s/iter; left time: 189.5911s
	iters: 300, epoch: 4 | loss: 0.1069199
	speed: 0.0201s/iter; left time: 188.6438s
	iters: 400, epoch: 4 | loss: 0.1740766
	speed: 0.0200s/iter; left time: 185.9750s
	iters: 500, epoch: 4 | loss: 0.1178916
	speed: 0.0199s/iter; left time: 182.8519s
Epoch: 4 cost time: 11.646360158920288
Epoch: 4, Steps: 570 | Train Loss: 0.1409281 Vali Loss: 0.0402732 Test Loss: 0.1331898
Validation loss decreased (0.041326 --> 0.040273).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1337337
	speed: 0.0604s/iter; left time: 545.0980s
	iters: 200, epoch: 5 | loss: 0.1484713
	speed: 0.0221s/iter; left time: 197.0755s
	iters: 300, epoch: 5 | loss: 0.1264172
	speed: 0.0220s/iter; left time: 194.1344s
	iters: 400, epoch: 5 | loss: 0.1099090
	speed: 0.0220s/iter; left time: 191.9488s
	iters: 500, epoch: 5 | loss: 0.1171877
	speed: 0.0207s/iter; left time: 178.4985s
Epoch: 5 cost time: 12.541932344436646
Epoch: 5, Steps: 570 | Train Loss: 0.1319648 Vali Loss: 0.0401458 Test Loss: 0.1370844
Validation loss decreased (0.040273 --> 0.040146).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1331660
	speed: 0.0585s/iter; left time: 494.7327s
	iters: 200, epoch: 6 | loss: 0.1162980
	speed: 0.0201s/iter; left time: 167.4452s
	iters: 300, epoch: 6 | loss: 0.1073345
	speed: 0.0200s/iter; left time: 165.1243s
	iters: 400, epoch: 6 | loss: 0.0893410
	speed: 0.0200s/iter; left time: 163.0365s
	iters: 500, epoch: 6 | loss: 0.1818074
	speed: 0.0200s/iter; left time: 161.1686s
Epoch: 6 cost time: 11.69297981262207
Epoch: 6, Steps: 570 | Train Loss: 0.1274603 Vali Loss: 0.0406930 Test Loss: 0.1406736
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1328548
	speed: 0.0573s/iter; left time: 451.2704s
	iters: 200, epoch: 7 | loss: 0.1408221
	speed: 0.0200s/iter; left time: 155.3832s
	iters: 300, epoch: 7 | loss: 0.1474254
	speed: 0.0200s/iter; left time: 153.8715s
	iters: 400, epoch: 7 | loss: 0.1278830
	speed: 0.0200s/iter; left time: 151.4921s
	iters: 500, epoch: 7 | loss: 0.1006986
	speed: 0.0200s/iter; left time: 149.5384s
Epoch: 7 cost time: 11.65159273147583
Epoch: 7, Steps: 570 | Train Loss: 0.1260588 Vali Loss: 0.0403862 Test Loss: 0.1383924
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1715219
	speed: 0.0574s/iter; left time: 419.9568s
	iters: 200, epoch: 8 | loss: 0.1664512
	speed: 0.0200s/iter; left time: 143.9478s
	iters: 300, epoch: 8 | loss: 0.1658465
	speed: 0.0200s/iter; left time: 142.1614s
	iters: 400, epoch: 8 | loss: 0.0892622
	speed: 0.0200s/iter; left time: 139.9021s
	iters: 500, epoch: 8 | loss: 0.1440291
	speed: 0.0199s/iter; left time: 137.7866s
Epoch: 8 cost time: 11.652548551559448
Epoch: 8, Steps: 570 | Train Loss: 0.1248426 Vali Loss: 0.0402815 Test Loss: 0.1363786
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13719618320465088, mae:0.2358366996049881
>>> S LR=1e-4 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1876778
	speed: 0.0234s/iter; left time: 264.8254s
	iters: 200, epoch: 1 | loss: 0.2113693
	speed: 0.0117s/iter; left time: 131.5122s
	iters: 300, epoch: 1 | loss: 0.2160107
	speed: 0.0116s/iter; left time: 129.0959s
	iters: 400, epoch: 1 | loss: 0.1944592
	speed: 0.0116s/iter; left time: 127.7649s
	iters: 500, epoch: 1 | loss: 0.1708959
	speed: 0.0116s/iter; left time: 126.8636s
Epoch: 1 cost time: 7.8660054206848145
Epoch: 1, Steps: 570 | Train Loss: 0.2434667 Vali Loss: 0.0443240 Test Loss: 0.1412887
Validation loss decreased (inf --> 0.044324).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3772821
	speed: 0.0382s/iter; left time: 410.2842s
	iters: 200, epoch: 2 | loss: 0.3014103
	speed: 0.0105s/iter; left time: 111.2172s
	iters: 300, epoch: 2 | loss: 0.1892383
	speed: 0.0105s/iter; left time: 110.2913s
	iters: 400, epoch: 2 | loss: 0.1503384
	speed: 0.0104s/iter; left time: 108.9566s
	iters: 500, epoch: 2 | loss: 0.1799509
	speed: 0.0104s/iter; left time: 107.8205s
Epoch: 2 cost time: 6.247997760772705
Epoch: 2, Steps: 570 | Train Loss: 0.2093771 Vali Loss: 0.0430584 Test Loss: 0.1299047
Validation loss decreased (0.044324 --> 0.043058).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1448112
	speed: 0.0361s/iter; left time: 367.0277s
	iters: 200, epoch: 3 | loss: 0.2304372
	speed: 0.0104s/iter; left time: 104.2308s
	iters: 300, epoch: 3 | loss: 0.1785520
	speed: 0.0104s/iter; left time: 103.3463s
	iters: 400, epoch: 3 | loss: 0.1932731
	speed: 0.0104s/iter; left time: 102.4017s
	iters: 500, epoch: 3 | loss: 0.2533851
	speed: 0.0104s/iter; left time: 101.0551s
Epoch: 3 cost time: 6.200632333755493
Epoch: 3, Steps: 570 | Train Loss: 0.1961254 Vali Loss: 0.0378323 Test Loss: 0.1209333
Validation loss decreased (0.043058 --> 0.037832).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1772130
	speed: 0.0359s/iter; left time: 344.7756s
	iters: 200, epoch: 4 | loss: 0.1211076
	speed: 0.0104s/iter; left time: 99.1320s
	iters: 300, epoch: 4 | loss: 0.1902696
	speed: 0.0105s/iter; left time: 98.2166s
	iters: 400, epoch: 4 | loss: 0.2004622
	speed: 0.0104s/iter; left time: 96.8542s
	iters: 500, epoch: 4 | loss: 0.1820133
	speed: 0.0104s/iter; left time: 95.7801s
Epoch: 4 cost time: 6.23574686050415
Epoch: 4, Steps: 570 | Train Loss: 0.1897820 Vali Loss: 0.0369267 Test Loss: 0.1173091
Validation loss decreased (0.037832 --> 0.036927).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1687382
	speed: 0.0380s/iter; left time: 342.9201s
	iters: 200, epoch: 5 | loss: 0.1699758
	speed: 0.0104s/iter; left time: 92.9424s
	iters: 300, epoch: 5 | loss: 0.1392874
	speed: 0.0103s/iter; left time: 91.2753s
	iters: 400, epoch: 5 | loss: 0.1832658
	speed: 0.0103s/iter; left time: 90.2281s
	iters: 500, epoch: 5 | loss: 0.2070267
	speed: 0.0104s/iter; left time: 89.3753s
Epoch: 5 cost time: 6.190499305725098
Epoch: 5, Steps: 570 | Train Loss: 0.1875631 Vali Loss: 0.0363139 Test Loss: 0.1183844
Validation loss decreased (0.036927 --> 0.036314).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1670215
	speed: 0.0376s/iter; left time: 317.9526s
	iters: 200, epoch: 6 | loss: 0.1205329
	speed: 0.0105s/iter; left time: 87.4794s
	iters: 300, epoch: 6 | loss: 0.2038627
	speed: 0.0105s/iter; left time: 86.5171s
	iters: 400, epoch: 6 | loss: 0.2099442
	speed: 0.0105s/iter; left time: 85.3177s
	iters: 500, epoch: 6 | loss: 0.2006169
	speed: 0.0105s/iter; left time: 84.2297s
Epoch: 6 cost time: 6.267369985580444
Epoch: 6, Steps: 570 | Train Loss: 0.1856480 Vali Loss: 0.0363001 Test Loss: 0.1165693
Validation loss decreased (0.036314 --> 0.036300).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1946178
	speed: 0.0364s/iter; left time: 286.6892s
	iters: 200, epoch: 7 | loss: 0.2498587
	speed: 0.0104s/iter; left time: 80.5804s
	iters: 300, epoch: 7 | loss: 0.1444506
	speed: 0.0103s/iter; left time: 79.4345s
	iters: 400, epoch: 7 | loss: 0.1424473
	speed: 0.0104s/iter; left time: 78.5038s
	iters: 500, epoch: 7 | loss: 0.1630217
	speed: 0.0104s/iter; left time: 77.5040s
Epoch: 7 cost time: 6.2024500370025635
Epoch: 7, Steps: 570 | Train Loss: 0.1849978 Vali Loss: 0.0361809 Test Loss: 0.1175367
Validation loss decreased (0.036300 --> 0.036181).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2004945
	speed: 0.0363s/iter; left time: 265.4978s
	iters: 200, epoch: 8 | loss: 0.1922903
	speed: 0.0115s/iter; left time: 82.9045s
	iters: 300, epoch: 8 | loss: 0.2187059
	speed: 0.0119s/iter; left time: 84.5348s
	iters: 400, epoch: 8 | loss: 0.2197714
	speed: 0.0119s/iter; left time: 83.3612s
	iters: 500, epoch: 8 | loss: 0.1321736
	speed: 0.0118s/iter; left time: 81.8838s
Epoch: 8 cost time: 6.875346899032593
Epoch: 8, Steps: 570 | Train Loss: 0.1842793 Vali Loss: 0.0360709 Test Loss: 0.1168861
Validation loss decreased (0.036181 --> 0.036071).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2352836
	speed: 0.0387s/iter; left time: 260.6879s
	iters: 200, epoch: 9 | loss: 0.1949717
	speed: 0.0120s/iter; left time: 79.9560s
	iters: 300, epoch: 9 | loss: 0.0903050
	speed: 0.0120s/iter; left time: 78.5986s
	iters: 400, epoch: 9 | loss: 0.1767167
	speed: 0.0120s/iter; left time: 77.4971s
	iters: 500, epoch: 9 | loss: 0.1532767
	speed: 0.0120s/iter; left time: 76.3192s
Epoch: 9 cost time: 7.160883665084839
Epoch: 9, Steps: 570 | Train Loss: 0.1835614 Vali Loss: 0.0365043 Test Loss: 0.1165683
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1613775
	speed: 0.0390s/iter; left time: 240.4241s
	iters: 200, epoch: 10 | loss: 0.1591428
	speed: 0.0119s/iter; left time: 72.3100s
	iters: 300, epoch: 10 | loss: 0.1210303
	speed: 0.0119s/iter; left time: 71.0548s
	iters: 400, epoch: 10 | loss: 0.1536015
	speed: 0.0119s/iter; left time: 69.9401s
	iters: 500, epoch: 10 | loss: 0.2864067
	speed: 0.0119s/iter; left time: 68.6984s
Epoch: 10 cost time: 7.0909104347229
Epoch: 10, Steps: 570 | Train Loss: 0.1837929 Vali Loss: 0.0363123 Test Loss: 0.1165574
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2010000
	speed: 0.0388s/iter; left time: 217.4795s
	iters: 200, epoch: 11 | loss: 0.1824156
	speed: 0.0117s/iter; left time: 64.3721s
	iters: 300, epoch: 11 | loss: 0.1535181
	speed: 0.0117s/iter; left time: 63.1362s
	iters: 400, epoch: 11 | loss: 0.3014449
	speed: 0.0117s/iter; left time: 61.9659s
	iters: 500, epoch: 11 | loss: 0.1522915
	speed: 0.0117s/iter; left time: 60.7865s
Epoch: 11 cost time: 7.014451503753662
Epoch: 11, Steps: 570 | Train Loss: 0.1850332 Vali Loss: 0.0361397 Test Loss: 0.1167133
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1169995367527008, mae:0.20968395471572876
>>> S LR=1e-4 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1838786
	speed: 0.0220s/iter; left time: 249.0925s
	iters: 200, epoch: 1 | loss: 0.2272960
	speed: 0.0103s/iter; left time: 115.0540s
	iters: 300, epoch: 1 | loss: 0.2627213
	speed: 0.0102s/iter; left time: 113.7620s
	iters: 400, epoch: 1 | loss: 0.1988718
	speed: 0.0102s/iter; left time: 112.4785s
	iters: 500, epoch: 1 | loss: 0.2147143
	speed: 0.0102s/iter; left time: 111.7235s
Epoch: 1 cost time: 7.067347764968872
Epoch: 1, Steps: 570 | Train Loss: 0.2154124 Vali Loss: 0.0348840 Test Loss: 0.1145914
Validation loss decreased (inf --> 0.034884).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1547401
	speed: 0.0357s/iter; left time: 382.8879s
	iters: 200, epoch: 2 | loss: 0.2027216
	speed: 0.0102s/iter; left time: 108.5531s
	iters: 300, epoch: 2 | loss: 0.1492148
	speed: 0.0102s/iter; left time: 107.6186s
	iters: 400, epoch: 2 | loss: 0.1475730
	speed: 0.0102s/iter; left time: 106.4720s
	iters: 500, epoch: 2 | loss: 0.1927490
	speed: 0.0102s/iter; left time: 105.3335s
Epoch: 2 cost time: 6.1276445388793945
Epoch: 2, Steps: 570 | Train Loss: 0.1862402 Vali Loss: 0.0328275 Test Loss: 0.1115525
Validation loss decreased (0.034884 --> 0.032828).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0980997
	speed: 0.0362s/iter; left time: 367.6048s
	iters: 200, epoch: 3 | loss: 0.1542785
	speed: 0.0102s/iter; left time: 103.0131s
	iters: 300, epoch: 3 | loss: 0.3276613
	speed: 0.0102s/iter; left time: 101.9491s
	iters: 400, epoch: 3 | loss: 0.2241382
	speed: 0.0102s/iter; left time: 100.9752s
	iters: 500, epoch: 3 | loss: 0.1289149
	speed: 0.0103s/iter; left time: 100.2577s
Epoch: 3 cost time: 6.12006139755249
Epoch: 3, Steps: 570 | Train Loss: 0.1761733 Vali Loss: 0.0324196 Test Loss: 0.1101272
Validation loss decreased (0.032828 --> 0.032420).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1519156
	speed: 0.0365s/iter; left time: 350.4822s
	iters: 200, epoch: 4 | loss: 0.1664162
	speed: 0.0102s/iter; left time: 96.7114s
	iters: 300, epoch: 4 | loss: 0.1155889
	speed: 0.0102s/iter; left time: 95.8014s
	iters: 400, epoch: 4 | loss: 0.1246234
	speed: 0.0102s/iter; left time: 94.4036s
	iters: 500, epoch: 4 | loss: 0.2219976
	speed: 0.0102s/iter; left time: 93.3631s
Epoch: 4 cost time: 6.069636583328247
Epoch: 4, Steps: 570 | Train Loss: 0.1717112 Vali Loss: 0.0312637 Test Loss: 0.1077793
Validation loss decreased (0.032420 --> 0.031264).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1403413
	speed: 0.0346s/iter; left time: 311.7477s
	iters: 200, epoch: 5 | loss: 0.2184902
	speed: 0.0102s/iter; left time: 90.9824s
	iters: 300, epoch: 5 | loss: 0.1611001
	speed: 0.0102s/iter; left time: 89.8732s
	iters: 400, epoch: 5 | loss: 0.1537712
	speed: 0.0102s/iter; left time: 88.6709s
	iters: 500, epoch: 5 | loss: 0.1812353
	speed: 0.0102s/iter; left time: 87.8129s
Epoch: 5 cost time: 6.081563711166382
Epoch: 5, Steps: 570 | Train Loss: 0.1700423 Vali Loss: 0.0313597 Test Loss: 0.1077311
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1200989
	speed: 0.0349s/iter; left time: 295.1728s
	iters: 200, epoch: 6 | loss: 0.2110419
	speed: 0.0102s/iter; left time: 85.1394s
	iters: 300, epoch: 6 | loss: 0.1584410
	speed: 0.0102s/iter; left time: 84.2787s
	iters: 400, epoch: 6 | loss: 0.1403338
	speed: 0.0102s/iter; left time: 83.2803s
	iters: 500, epoch: 6 | loss: 0.1022577
	speed: 0.0102s/iter; left time: 82.3118s
Epoch: 6 cost time: 6.1078290939331055
Epoch: 6, Steps: 570 | Train Loss: 0.1688200 Vali Loss: 0.0313235 Test Loss: 0.1073382
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1570026
	speed: 0.0365s/iter; left time: 287.2644s
	iters: 200, epoch: 7 | loss: 0.1903720
	speed: 0.0103s/iter; left time: 80.0440s
	iters: 300, epoch: 7 | loss: 0.3102909
	speed: 0.0103s/iter; left time: 78.9536s
	iters: 400, epoch: 7 | loss: 0.2130995
	speed: 0.0103s/iter; left time: 77.8167s
	iters: 500, epoch: 7 | loss: 0.1647310
	speed: 0.0102s/iter; left time: 76.6045s
Epoch: 7 cost time: 6.120690107345581
Epoch: 7, Steps: 570 | Train Loss: 0.1683314 Vali Loss: 0.0311306 Test Loss: 0.1072875
Validation loss decreased (0.031264 --> 0.031131).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1404358
	speed: 0.0357s/iter; left time: 261.2724s
	iters: 200, epoch: 8 | loss: 0.1415052
	speed: 0.0102s/iter; left time: 73.6812s
	iters: 300, epoch: 8 | loss: 0.1437805
	speed: 0.0102s/iter; left time: 72.6938s
	iters: 400, epoch: 8 | loss: 0.1485747
	speed: 0.0102s/iter; left time: 71.6661s
	iters: 500, epoch: 8 | loss: 0.0998439
	speed: 0.0103s/iter; left time: 70.8622s
Epoch: 8 cost time: 6.12568998336792
Epoch: 8, Steps: 570 | Train Loss: 0.1689835 Vali Loss: 0.0310711 Test Loss: 0.1069624
Validation loss decreased (0.031131 --> 0.031071).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1562791
	speed: 0.0366s/iter; left time: 246.5030s
	iters: 200, epoch: 9 | loss: 0.1670993
	speed: 0.0104s/iter; left time: 68.7396s
	iters: 300, epoch: 9 | loss: 0.1398946
	speed: 0.0103s/iter; left time: 67.5994s
	iters: 400, epoch: 9 | loss: 0.2065655
	speed: 0.0103s/iter; left time: 66.6592s
	iters: 500, epoch: 9 | loss: 0.1442655
	speed: 0.0104s/iter; left time: 65.6645s
Epoch: 9 cost time: 6.1933019161224365
Epoch: 9, Steps: 570 | Train Loss: 0.1678772 Vali Loss: 0.0311594 Test Loss: 0.1070787
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2338873
	speed: 0.0366s/iter; left time: 225.7522s
	iters: 200, epoch: 10 | loss: 0.1327796
	speed: 0.0104s/iter; left time: 63.1755s
	iters: 300, epoch: 10 | loss: 0.1272661
	speed: 0.0105s/iter; left time: 62.4592s
	iters: 400, epoch: 10 | loss: 0.1124554
	speed: 0.0104s/iter; left time: 61.3029s
	iters: 500, epoch: 10 | loss: 0.1189881
	speed: 0.0104s/iter; left time: 59.8772s
Epoch: 10 cost time: 6.200538873672485
Epoch: 10, Steps: 570 | Train Loss: 0.1694182 Vali Loss: 0.0311351 Test Loss: 0.1071128
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1555432
	speed: 0.0349s/iter; left time: 195.4257s
	iters: 200, epoch: 11 | loss: 0.1769008
	speed: 0.0103s/iter; left time: 56.4334s
	iters: 300, epoch: 11 | loss: 0.1984663
	speed: 0.0103s/iter; left time: 55.5535s
	iters: 400, epoch: 11 | loss: 0.1585166
	speed: 0.0103s/iter; left time: 54.5791s
	iters: 500, epoch: 11 | loss: 0.1496809
	speed: 0.0102s/iter; left time: 53.2885s
Epoch: 11 cost time: 6.095290184020996
Epoch: 11, Steps: 570 | Train Loss: 0.1671867 Vali Loss: 0.0310686 Test Loss: 0.1070945
Validation loss decreased (0.031071 --> 0.031069).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1411406
	speed: 0.0361s/iter; left time: 181.7725s
	iters: 200, epoch: 12 | loss: 0.1694443
	speed: 0.0104s/iter; left time: 51.2361s
	iters: 300, epoch: 12 | loss: 0.1329380
	speed: 0.0112s/iter; left time: 54.3267s
	iters: 400, epoch: 12 | loss: 0.2619224
	speed: 0.0102s/iter; left time: 48.1416s
	iters: 500, epoch: 12 | loss: 0.1578640
	speed: 0.0102s/iter; left time: 47.1651s
Epoch: 12 cost time: 6.333960771560669
Epoch: 12, Steps: 570 | Train Loss: 0.1681057 Vali Loss: 0.0310801 Test Loss: 0.1070875
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2786888
	speed: 0.0356s/iter; left time: 158.9235s
	iters: 200, epoch: 13 | loss: 0.2289647
	speed: 0.0102s/iter; left time: 44.6026s
	iters: 300, epoch: 13 | loss: 0.1305592
	speed: 0.0102s/iter; left time: 43.5933s
	iters: 400, epoch: 13 | loss: 0.1827722
	speed: 0.0102s/iter; left time: 42.5182s
	iters: 500, epoch: 13 | loss: 0.2163979
	speed: 0.0102s/iter; left time: 41.5118s
Epoch: 13 cost time: 6.091063022613525
Epoch: 13, Steps: 570 | Train Loss: 0.1680713 Vali Loss: 0.0310451 Test Loss: 0.1070772
Validation loss decreased (0.031069 --> 0.031045).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1731045
	speed: 0.0360s/iter; left time: 140.2688s
	iters: 200, epoch: 14 | loss: 0.1352159
	speed: 0.0102s/iter; left time: 38.5960s
	iters: 300, epoch: 14 | loss: 0.1763902
	speed: 0.0102s/iter; left time: 37.4882s
	iters: 400, epoch: 14 | loss: 0.1549064
	speed: 0.0102s/iter; left time: 36.4975s
	iters: 500, epoch: 14 | loss: 0.1656553
	speed: 0.0102s/iter; left time: 35.5418s
Epoch: 14 cost time: 6.078148126602173
Epoch: 14, Steps: 570 | Train Loss: 0.1681411 Vali Loss: 0.0310743 Test Loss: 0.1070731
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.0936552
	speed: 0.0374s/iter; left time: 124.2519s
	iters: 200, epoch: 15 | loss: 0.1848854
	speed: 0.0110s/iter; left time: 35.2860s
	iters: 300, epoch: 15 | loss: 0.1561784
	speed: 0.0102s/iter; left time: 31.8447s
	iters: 400, epoch: 15 | loss: 0.1450719
	speed: 0.0102s/iter; left time: 30.8268s
	iters: 500, epoch: 15 | loss: 0.1300471
	speed: 0.0102s/iter; left time: 29.8765s
Epoch: 15 cost time: 6.330914735794067
Epoch: 15, Steps: 570 | Train Loss: 0.1673426 Vali Loss: 0.0310164 Test Loss: 0.1070739
Validation loss decreased (0.031045 --> 0.031016).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2703530
	speed: 0.0359s/iter; left time: 98.8538s
	iters: 200, epoch: 16 | loss: 0.1432813
	speed: 0.0102s/iter; left time: 27.0918s
	iters: 300, epoch: 16 | loss: 0.1933523
	speed: 0.0102s/iter; left time: 26.1159s
	iters: 400, epoch: 16 | loss: 0.1401775
	speed: 0.0102s/iter; left time: 25.0352s
	iters: 500, epoch: 16 | loss: 0.2662629
	speed: 0.0102s/iter; left time: 24.0341s
Epoch: 16 cost time: 6.077019453048706
Epoch: 16, Steps: 570 | Train Loss: 0.1680799 Vali Loss: 0.0310040 Test Loss: 0.1070739
Validation loss decreased (0.031016 --> 0.031004).  Saving model ...
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1162424
	speed: 0.0351s/iter; left time: 76.6595s
	iters: 200, epoch: 17 | loss: 0.1382426
	speed: 0.0102s/iter; left time: 21.1942s
	iters: 300, epoch: 17 | loss: 0.1599464
	speed: 0.0103s/iter; left time: 20.3083s
	iters: 400, epoch: 17 | loss: 0.1330129
	speed: 0.0103s/iter; left time: 19.3157s
	iters: 500, epoch: 17 | loss: 0.1091579
	speed: 0.0102s/iter; left time: 18.2150s
Epoch: 17 cost time: 6.100223779678345
Epoch: 17, Steps: 570 | Train Loss: 0.1679699 Vali Loss: 0.0311605 Test Loss: 0.1070742
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1970695
	speed: 0.0358s/iter; left time: 57.7533s
	iters: 200, epoch: 18 | loss: 0.1819766
	speed: 0.0102s/iter; left time: 15.3683s
	iters: 300, epoch: 18 | loss: 0.1398003
	speed: 0.0102s/iter; left time: 14.3926s
	iters: 400, epoch: 18 | loss: 0.2458260
	speed: 0.0102s/iter; left time: 13.3636s
	iters: 500, epoch: 18 | loss: 0.1272808
	speed: 0.0102s/iter; left time: 12.3531s
Epoch: 18 cost time: 6.097237586975098
Epoch: 18, Steps: 570 | Train Loss: 0.1678426 Vali Loss: 0.0310935 Test Loss: 0.1070743
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1468061
	speed: 0.0350s/iter; left time: 36.4418s
	iters: 200, epoch: 19 | loss: 0.2019656
	speed: 0.0103s/iter; left time: 9.6492s
	iters: 300, epoch: 19 | loss: 0.1443098
	speed: 0.0102s/iter; left time: 8.6187s
	iters: 400, epoch: 19 | loss: 0.1827113
	speed: 0.0103s/iter; left time: 7.6103s
	iters: 500, epoch: 19 | loss: 0.1663177
	speed: 0.0103s/iter; left time: 6.5752s
Epoch: 19 cost time: 6.1094043254852295
Epoch: 19, Steps: 570 | Train Loss: 0.1679183 Vali Loss: 0.0310865 Test Loss: 0.1070742
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10720343142747879, mae:0.19449922442436218
>>> S LR=1e-4 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2717152
	speed: 0.0221s/iter; left time: 249.9514s
	iters: 200, epoch: 1 | loss: 0.1919200
	speed: 0.0103s/iter; left time: 114.9775s
	iters: 300, epoch: 1 | loss: 0.1721469
	speed: 0.0103s/iter; left time: 114.0491s
	iters: 400, epoch: 1 | loss: 0.1912525
	speed: 0.0102s/iter; left time: 112.4240s
	iters: 500, epoch: 1 | loss: 0.2192341
	speed: 0.0102s/iter; left time: 111.6275s
Epoch: 1 cost time: 7.080003499984741
Epoch: 1, Steps: 570 | Train Loss: 0.2531823 Vali Loss: 0.0452769 Test Loss: 0.1371432
Validation loss decreased (inf --> 0.045277).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2134607
	speed: 0.0382s/iter; left time: 410.3489s
	iters: 200, epoch: 2 | loss: 0.2302793
	speed: 0.0115s/iter; left time: 122.2189s
	iters: 300, epoch: 2 | loss: 0.2093918
	speed: 0.0115s/iter; left time: 121.3658s
	iters: 400, epoch: 2 | loss: 0.3210122
	speed: 0.0115s/iter; left time: 120.0244s
	iters: 500, epoch: 2 | loss: 0.2904720
	speed: 0.0115s/iter; left time: 119.1805s
Epoch: 2 cost time: 6.873295783996582
Epoch: 2, Steps: 570 | Train Loss: 0.2162535 Vali Loss: 0.0394828 Test Loss: 0.1269471
Validation loss decreased (0.045277 --> 0.039483).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1517523
	speed: 0.0388s/iter; left time: 394.4569s
	iters: 200, epoch: 3 | loss: 0.1738286
	speed: 0.0103s/iter; left time: 103.2790s
	iters: 300, epoch: 3 | loss: 0.2674031
	speed: 0.0103s/iter; left time: 102.3716s
	iters: 400, epoch: 3 | loss: 0.1728081
	speed: 0.0103s/iter; left time: 101.1607s
	iters: 500, epoch: 3 | loss: 0.1295760
	speed: 0.0103s/iter; left time: 100.1439s
Epoch: 3 cost time: 6.139518976211548
Epoch: 3, Steps: 570 | Train Loss: 0.2046847 Vali Loss: 0.0388393 Test Loss: 0.1240053
Validation loss decreased (0.039483 --> 0.038839).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1423169
	speed: 0.0374s/iter; left time: 358.4063s
	iters: 200, epoch: 4 | loss: 0.1196279
	speed: 0.0102s/iter; left time: 96.8508s
	iters: 300, epoch: 4 | loss: 0.1479514
	speed: 0.0102s/iter; left time: 95.8909s
	iters: 400, epoch: 4 | loss: 0.2557388
	speed: 0.0102s/iter; left time: 94.9176s
	iters: 500, epoch: 4 | loss: 0.1728795
	speed: 0.0103s/iter; left time: 94.3434s
Epoch: 4 cost time: 6.098707914352417
Epoch: 4, Steps: 570 | Train Loss: 0.2003706 Vali Loss: 0.0380082 Test Loss: 0.1227171
Validation loss decreased (0.038839 --> 0.038008).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1690086
	speed: 0.0361s/iter; left time: 325.6482s
	iters: 200, epoch: 5 | loss: 0.1138289
	speed: 0.0103s/iter; left time: 91.7670s
	iters: 300, epoch: 5 | loss: 0.2222798
	speed: 0.0103s/iter; left time: 90.7090s
	iters: 400, epoch: 5 | loss: 0.1810013
	speed: 0.0103s/iter; left time: 89.6744s
	iters: 500, epoch: 5 | loss: 0.2704540
	speed: 0.0103s/iter; left time: 88.8879s
Epoch: 5 cost time: 6.217735528945923
Epoch: 5, Steps: 570 | Train Loss: 0.1982586 Vali Loss: 0.0379944 Test Loss: 0.1222064
Validation loss decreased (0.038008 --> 0.037994).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1566691
	speed: 0.0356s/iter; left time: 300.8253s
	iters: 200, epoch: 6 | loss: 0.2042724
	speed: 0.0102s/iter; left time: 85.5137s
	iters: 300, epoch: 6 | loss: 0.1543543
	speed: 0.0102s/iter; left time: 84.4626s
	iters: 400, epoch: 6 | loss: 0.1356103
	speed: 0.0102s/iter; left time: 83.5290s
	iters: 500, epoch: 6 | loss: 0.2589698
	speed: 0.0102s/iter; left time: 82.3830s
Epoch: 6 cost time: 6.128281593322754
Epoch: 6, Steps: 570 | Train Loss: 0.1962042 Vali Loss: 0.0377881 Test Loss: 0.1214909
Validation loss decreased (0.037994 --> 0.037788).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1410201
	speed: 0.0360s/iter; left time: 284.0771s
	iters: 200, epoch: 7 | loss: 0.1816827
	speed: 0.0101s/iter; left time: 78.9250s
	iters: 300, epoch: 7 | loss: 0.1698692
	speed: 0.0102s/iter; left time: 78.0332s
	iters: 400, epoch: 7 | loss: 0.1121040
	speed: 0.0101s/iter; left time: 76.8748s
	iters: 500, epoch: 7 | loss: 0.2467522
	speed: 0.0101s/iter; left time: 75.8799s
Epoch: 7 cost time: 6.082579851150513
Epoch: 7, Steps: 570 | Train Loss: 0.1949584 Vali Loss: 0.0376832 Test Loss: 0.1212278
Validation loss decreased (0.037788 --> 0.037683).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1619421
	speed: 0.0356s/iter; left time: 260.3494s
	iters: 200, epoch: 8 | loss: 0.1663782
	speed: 0.0102s/iter; left time: 73.6369s
	iters: 300, epoch: 8 | loss: 0.2057867
	speed: 0.0102s/iter; left time: 72.7208s
	iters: 400, epoch: 8 | loss: 0.2380208
	speed: 0.0102s/iter; left time: 71.6566s
	iters: 500, epoch: 8 | loss: 0.1913848
	speed: 0.0102s/iter; left time: 70.6768s
Epoch: 8 cost time: 6.132549524307251
Epoch: 8, Steps: 570 | Train Loss: 0.1940011 Vali Loss: 0.0377196 Test Loss: 0.1212379
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1641670
	speed: 0.0363s/iter; left time: 244.8892s
	iters: 200, epoch: 9 | loss: 0.2517442
	speed: 0.0102s/iter; left time: 67.9026s
	iters: 300, epoch: 9 | loss: 0.1748283
	speed: 0.0102s/iter; left time: 66.9554s
	iters: 400, epoch: 9 | loss: 0.1468263
	speed: 0.0103s/iter; left time: 66.0421s
	iters: 500, epoch: 9 | loss: 0.2102880
	speed: 0.0102s/iter; left time: 64.9142s
Epoch: 9 cost time: 6.105045318603516
Epoch: 9, Steps: 570 | Train Loss: 0.1941774 Vali Loss: 0.0377329 Test Loss: 0.1211128
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1485558
	speed: 0.0352s/iter; left time: 217.4855s
	iters: 200, epoch: 10 | loss: 0.2596428
	speed: 0.0102s/iter; left time: 62.1949s
	iters: 300, epoch: 10 | loss: 0.2684875
	speed: 0.0102s/iter; left time: 61.2001s
	iters: 400, epoch: 10 | loss: 0.2387640
	speed: 0.0102s/iter; left time: 60.1444s
	iters: 500, epoch: 10 | loss: 0.2107720
	speed: 0.0102s/iter; left time: 59.0641s
Epoch: 10 cost time: 6.138669013977051
Epoch: 10, Steps: 570 | Train Loss: 0.1944507 Vali Loss: 0.0376656 Test Loss: 0.1210709
Validation loss decreased (0.037683 --> 0.037666).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2025677
	speed: 0.0371s/iter; left time: 207.5499s
	iters: 200, epoch: 11 | loss: 0.1455840
	speed: 0.0102s/iter; left time: 56.3023s
	iters: 300, epoch: 11 | loss: 0.2861103
	speed: 0.0103s/iter; left time: 55.3721s
	iters: 400, epoch: 11 | loss: 0.2113792
	speed: 0.0103s/iter; left time: 54.6902s
	iters: 500, epoch: 11 | loss: 0.2484015
	speed: 0.0103s/iter; left time: 53.6271s
Epoch: 11 cost time: 6.148652076721191
Epoch: 11, Steps: 570 | Train Loss: 0.1952446 Vali Loss: 0.0375751 Test Loss: 0.1211183
Validation loss decreased (0.037666 --> 0.037575).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1893025
	speed: 0.0368s/iter; left time: 185.1034s
	iters: 200, epoch: 12 | loss: 0.1501502
	speed: 0.0103s/iter; left time: 50.8582s
	iters: 300, epoch: 12 | loss: 0.1406924
	speed: 0.0103s/iter; left time: 49.8315s
	iters: 400, epoch: 12 | loss: 0.2059101
	speed: 0.0103s/iter; left time: 48.7898s
	iters: 500, epoch: 12 | loss: 0.1218690
	speed: 0.0103s/iter; left time: 47.7977s
Epoch: 12 cost time: 6.1858742237091064
Epoch: 12, Steps: 570 | Train Loss: 0.1942420 Vali Loss: 0.0375237 Test Loss: 0.1211153
Validation loss decreased (0.037575 --> 0.037524).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1712148
	speed: 0.0374s/iter; left time: 166.7351s
	iters: 200, epoch: 13 | loss: 0.2134530
	speed: 0.0103s/iter; left time: 44.7697s
	iters: 300, epoch: 13 | loss: 0.1888238
	speed: 0.0103s/iter; left time: 43.7364s
	iters: 400, epoch: 13 | loss: 0.2192576
	speed: 0.0103s/iter; left time: 42.6532s
	iters: 500, epoch: 13 | loss: 0.1854195
	speed: 0.0102s/iter; left time: 41.3667s
Epoch: 13 cost time: 6.135335922241211
Epoch: 13, Steps: 570 | Train Loss: 0.1955220 Vali Loss: 0.0375723 Test Loss: 0.1211076
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1921916
	speed: 0.0370s/iter; left time: 143.9121s
	iters: 200, epoch: 14 | loss: 0.2625243
	speed: 0.0103s/iter; left time: 39.2085s
	iters: 300, epoch: 14 | loss: 0.1469363
	speed: 0.0104s/iter; left time: 38.2531s
	iters: 400, epoch: 14 | loss: 0.1377284
	speed: 0.0104s/iter; left time: 37.2247s
	iters: 500, epoch: 14 | loss: 0.2483044
	speed: 0.0104s/iter; left time: 36.1810s
Epoch: 14 cost time: 6.19799542427063
Epoch: 14, Steps: 570 | Train Loss: 0.1947269 Vali Loss: 0.0375546 Test Loss: 0.1211091
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1406731
	speed: 0.0352s/iter; left time: 117.0125s
	iters: 200, epoch: 15 | loss: 0.2819975
	speed: 0.0102s/iter; left time: 32.9407s
	iters: 300, epoch: 15 | loss: 0.1037499
	speed: 0.0102s/iter; left time: 31.9287s
	iters: 400, epoch: 15 | loss: 0.1031731
	speed: 0.0102s/iter; left time: 30.8624s
	iters: 500, epoch: 15 | loss: 0.2672188
	speed: 0.0102s/iter; left time: 29.8389s
Epoch: 15 cost time: 6.117089509963989
Epoch: 15, Steps: 570 | Train Loss: 0.1948773 Vali Loss: 0.0375697 Test Loss: 0.1211064
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12123873829841614, mae:0.2167620211839676
>>> S LR=1e-4 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2480723
	speed: 0.0234s/iter; left time: 264.5386s
	iters: 200, epoch: 1 | loss: 0.2496953
	speed: 0.0117s/iter; left time: 131.1224s
	iters: 300, epoch: 1 | loss: 0.1629384
	speed: 0.0117s/iter; left time: 130.0614s
	iters: 400, epoch: 1 | loss: 0.1347725
	speed: 0.0117s/iter; left time: 128.7050s
	iters: 500, epoch: 1 | loss: 0.2174113
	speed: 0.0117s/iter; left time: 127.6337s
Epoch: 1 cost time: 7.893661975860596
Epoch: 1, Steps: 570 | Train Loss: 0.2403974 Vali Loss: 0.0414302 Test Loss: 0.1284464
Validation loss decreased (inf --> 0.041430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2181672
	speed: 0.0380s/iter; left time: 408.1372s
	iters: 200, epoch: 2 | loss: 0.1806186
	speed: 0.0117s/iter; left time: 124.7175s
	iters: 300, epoch: 2 | loss: 0.1731445
	speed: 0.0117s/iter; left time: 123.3796s
	iters: 400, epoch: 2 | loss: 0.1193685
	speed: 0.0117s/iter; left time: 122.3328s
	iters: 500, epoch: 2 | loss: 0.2115355
	speed: 0.0117s/iter; left time: 121.0251s
Epoch: 2 cost time: 6.969366550445557
Epoch: 2, Steps: 570 | Train Loss: 0.2084909 Vali Loss: 0.0393552 Test Loss: 0.1253681
Validation loss decreased (0.041430 --> 0.039355).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2542927
	speed: 0.0385s/iter; left time: 391.5666s
	iters: 200, epoch: 3 | loss: 0.2225956
	speed: 0.0117s/iter; left time: 118.1575s
	iters: 300, epoch: 3 | loss: 0.1389060
	speed: 0.0117s/iter; left time: 116.9742s
	iters: 400, epoch: 3 | loss: 0.1845082
	speed: 0.0117s/iter; left time: 115.7964s
	iters: 500, epoch: 3 | loss: 0.1097031
	speed: 0.0117s/iter; left time: 114.4373s
Epoch: 3 cost time: 6.9857189655303955
Epoch: 3, Steps: 570 | Train Loss: 0.1911349 Vali Loss: 0.0369315 Test Loss: 0.1237667
Validation loss decreased (0.039355 --> 0.036931).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1433163
	speed: 0.0394s/iter; left time: 377.8975s
	iters: 200, epoch: 4 | loss: 0.2397372
	speed: 0.0129s/iter; left time: 122.1448s
	iters: 300, epoch: 4 | loss: 0.1130071
	speed: 0.0129s/iter; left time: 121.3394s
	iters: 400, epoch: 4 | loss: 0.1212142
	speed: 0.0129s/iter; left time: 119.7283s
	iters: 500, epoch: 4 | loss: 0.1461757
	speed: 0.0129s/iter; left time: 118.3997s
Epoch: 4 cost time: 7.6289379596710205
Epoch: 4, Steps: 570 | Train Loss: 0.1824839 Vali Loss: 0.0360131 Test Loss: 0.1312912
Validation loss decreased (0.036931 --> 0.036013).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1904852
	speed: 0.0391s/iter; left time: 352.3540s
	iters: 200, epoch: 5 | loss: 0.1529815
	speed: 0.0118s/iter; left time: 105.3568s
	iters: 300, epoch: 5 | loss: 0.2347539
	speed: 0.0118s/iter; left time: 104.3910s
	iters: 400, epoch: 5 | loss: 0.1715884
	speed: 0.0118s/iter; left time: 103.1984s
	iters: 500, epoch: 5 | loss: 0.1596783
	speed: 0.0118s/iter; left time: 101.8402s
Epoch: 5 cost time: 6.999833583831787
Epoch: 5, Steps: 570 | Train Loss: 0.1786316 Vali Loss: 0.0356678 Test Loss: 0.1237260
Validation loss decreased (0.036013 --> 0.035668).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1618318
	speed: 0.0386s/iter; left time: 326.1485s
	iters: 200, epoch: 6 | loss: 0.0952186
	speed: 0.0118s/iter; left time: 98.6967s
	iters: 300, epoch: 6 | loss: 0.1807360
	speed: 0.0118s/iter; left time: 97.3902s
	iters: 400, epoch: 6 | loss: 0.2163036
	speed: 0.0118s/iter; left time: 96.1963s
	iters: 500, epoch: 6 | loss: 0.1371505
	speed: 0.0118s/iter; left time: 95.1123s
Epoch: 6 cost time: 7.010587930679321
Epoch: 6, Steps: 570 | Train Loss: 0.1751972 Vali Loss: 0.0353981 Test Loss: 0.1242597
Validation loss decreased (0.035668 --> 0.035398).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1924590
	speed: 0.0405s/iter; left time: 319.5318s
	iters: 200, epoch: 7 | loss: 0.1635031
	speed: 0.0118s/iter; left time: 91.5951s
	iters: 300, epoch: 7 | loss: 0.1638859
	speed: 0.0118s/iter; left time: 90.7395s
	iters: 400, epoch: 7 | loss: 0.1112845
	speed: 0.0118s/iter; left time: 89.0812s
	iters: 500, epoch: 7 | loss: 0.1491117
	speed: 0.0118s/iter; left time: 88.0522s
Epoch: 7 cost time: 7.07731819152832
Epoch: 7, Steps: 570 | Train Loss: 0.1729588 Vali Loss: 0.0356181 Test Loss: 0.1243523
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1130619
	speed: 0.0385s/iter; left time: 281.4930s
	iters: 200, epoch: 8 | loss: 0.1660865
	speed: 0.0118s/iter; left time: 84.9231s
	iters: 300, epoch: 8 | loss: 0.1783825
	speed: 0.0118s/iter; left time: 83.9100s
	iters: 400, epoch: 8 | loss: 0.1744603
	speed: 0.0118s/iter; left time: 82.8750s
	iters: 500, epoch: 8 | loss: 0.1138002
	speed: 0.0118s/iter; left time: 81.3520s
Epoch: 8 cost time: 6.994759798049927
Epoch: 8, Steps: 570 | Train Loss: 0.1741959 Vali Loss: 0.0355616 Test Loss: 0.1238246
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1181081
	speed: 0.0385s/iter; left time: 259.8459s
	iters: 200, epoch: 9 | loss: 0.1613084
	speed: 0.0118s/iter; left time: 78.3480s
	iters: 300, epoch: 9 | loss: 0.1669236
	speed: 0.0118s/iter; left time: 77.2668s
	iters: 400, epoch: 9 | loss: 0.1113793
	speed: 0.0118s/iter; left time: 76.0577s
	iters: 500, epoch: 9 | loss: 0.1842004
	speed: 0.0118s/iter; left time: 74.7900s
Epoch: 9 cost time: 7.008357286453247
Epoch: 9, Steps: 570 | Train Loss: 0.1739307 Vali Loss: 0.0353150 Test Loss: 0.1236529
Validation loss decreased (0.035398 --> 0.035315).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1360635
	speed: 0.0378s/iter; left time: 233.1025s
	iters: 200, epoch: 10 | loss: 0.2045525
	speed: 0.0117s/iter; left time: 71.1260s
	iters: 300, epoch: 10 | loss: 0.1364715
	speed: 0.0117s/iter; left time: 70.0141s
	iters: 400, epoch: 10 | loss: 0.1589536
	speed: 0.0117s/iter; left time: 68.8284s
	iters: 500, epoch: 10 | loss: 0.2009182
	speed: 0.0117s/iter; left time: 67.6649s
Epoch: 10 cost time: 6.964144468307495
Epoch: 10, Steps: 570 | Train Loss: 0.1725218 Vali Loss: 0.0354957 Test Loss: 0.1232478
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1473953
	speed: 0.0404s/iter; left time: 226.1333s
	iters: 200, epoch: 11 | loss: 0.2710498
	speed: 0.0118s/iter; left time: 64.9154s
	iters: 300, epoch: 11 | loss: 0.1947079
	speed: 0.0118s/iter; left time: 63.6259s
	iters: 400, epoch: 11 | loss: 0.1769625
	speed: 0.0118s/iter; left time: 62.3672s
	iters: 500, epoch: 11 | loss: 0.2512747
	speed: 0.0118s/iter; left time: 61.2111s
Epoch: 11 cost time: 6.984536170959473
Epoch: 11, Steps: 570 | Train Loss: 0.1727337 Vali Loss: 0.0356143 Test Loss: 0.1230756
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1387765
	speed: 0.0384s/iter; left time: 192.9482s
	iters: 200, epoch: 12 | loss: 0.1261944
	speed: 0.0117s/iter; left time: 57.9151s
	iters: 300, epoch: 12 | loss: 0.1333366
	speed: 0.0117s/iter; left time: 56.5533s
	iters: 400, epoch: 12 | loss: 0.1456277
	speed: 0.0117s/iter; left time: 55.3906s
	iters: 500, epoch: 12 | loss: 0.1508327
	speed: 0.0117s/iter; left time: 54.2055s
Epoch: 12 cost time: 6.967950820922852
Epoch: 12, Steps: 570 | Train Loss: 0.1731513 Vali Loss: 0.0356669 Test Loss: 0.1231489
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12377907335758209, mae:0.21612893044948578
>>> S LR=1e-4 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1338598
	speed: 0.0243s/iter; left time: 275.0650s
	iters: 200, epoch: 1 | loss: 0.2955535
	speed: 0.0124s/iter; left time: 139.1770s
	iters: 300, epoch: 1 | loss: 0.1714980
	speed: 0.0124s/iter; left time: 137.6666s
	iters: 400, epoch: 1 | loss: 0.2012621
	speed: 0.0120s/iter; left time: 131.5157s
	iters: 500, epoch: 1 | loss: 0.1521397
	speed: 0.0114s/iter; left time: 124.3695s
Epoch: 1 cost time: 8.100208759307861
Epoch: 1, Steps: 570 | Train Loss: 0.2127825 Vali Loss: 0.0349421 Test Loss: 0.1145424
Validation loss decreased (inf --> 0.034942).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1549543
	speed: 0.0384s/iter; left time: 411.5940s
	iters: 200, epoch: 2 | loss: 0.1190416
	speed: 0.0114s/iter; left time: 121.0443s
	iters: 300, epoch: 2 | loss: 0.2065533
	speed: 0.0114s/iter; left time: 120.2115s
	iters: 400, epoch: 2 | loss: 0.2724507
	speed: 0.0114s/iter; left time: 118.9596s
	iters: 500, epoch: 2 | loss: 0.2779300
	speed: 0.0114s/iter; left time: 117.6123s
Epoch: 2 cost time: 6.814342975616455
Epoch: 2, Steps: 570 | Train Loss: 0.1846873 Vali Loss: 0.0334183 Test Loss: 0.1097561
Validation loss decreased (0.034942 --> 0.033418).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1983673
	speed: 0.0389s/iter; left time: 395.0977s
	iters: 200, epoch: 3 | loss: 0.0970321
	speed: 0.0114s/iter; left time: 114.5384s
	iters: 300, epoch: 3 | loss: 0.1951262
	speed: 0.0114s/iter; left time: 113.2977s
	iters: 400, epoch: 3 | loss: 0.1564285
	speed: 0.0114s/iter; left time: 112.1874s
	iters: 500, epoch: 3 | loss: 0.2106140
	speed: 0.0114s/iter; left time: 111.0325s
Epoch: 3 cost time: 6.80272650718689
Epoch: 3, Steps: 570 | Train Loss: 0.1734161 Vali Loss: 0.0312125 Test Loss: 0.1079773
Validation loss decreased (0.033418 --> 0.031212).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1703854
	speed: 0.0383s/iter; left time: 367.4714s
	iters: 200, epoch: 4 | loss: 0.1091786
	speed: 0.0113s/iter; left time: 107.2210s
	iters: 300, epoch: 4 | loss: 0.0912407
	speed: 0.0113s/iter; left time: 106.2107s
	iters: 400, epoch: 4 | loss: 0.1544816
	speed: 0.0113s/iter; left time: 105.1274s
	iters: 500, epoch: 4 | loss: 0.1600214
	speed: 0.0113s/iter; left time: 103.8113s
Epoch: 4 cost time: 6.753371477127075
Epoch: 4, Steps: 570 | Train Loss: 0.1667142 Vali Loss: 0.0314218 Test Loss: 0.1084566
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1750719
	speed: 0.0377s/iter; left time: 340.1579s
	iters: 200, epoch: 5 | loss: 0.1171808
	speed: 0.0124s/iter; left time: 110.7118s
	iters: 300, epoch: 5 | loss: 0.2380345
	speed: 0.0124s/iter; left time: 109.4287s
	iters: 400, epoch: 5 | loss: 0.1577466
	speed: 0.0118s/iter; left time: 103.0317s
	iters: 500, epoch: 5 | loss: 0.1347547
	speed: 0.0114s/iter; left time: 97.9530s
Epoch: 5 cost time: 7.114935398101807
Epoch: 5, Steps: 570 | Train Loss: 0.1641528 Vali Loss: 0.0310908 Test Loss: 0.1076583
Validation loss decreased (0.031212 --> 0.031091).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2146058
	speed: 0.0391s/iter; left time: 330.6487s
	iters: 200, epoch: 6 | loss: 0.1787921
	speed: 0.0124s/iter; left time: 103.6240s
	iters: 300, epoch: 6 | loss: 0.1103521
	speed: 0.0124s/iter; left time: 102.3654s
	iters: 400, epoch: 6 | loss: 0.1148468
	speed: 0.0124s/iter; left time: 101.1454s
	iters: 500, epoch: 6 | loss: 0.1249100
	speed: 0.0123s/iter; left time: 98.7431s
Epoch: 6 cost time: 7.283761262893677
Epoch: 6, Steps: 570 | Train Loss: 0.1623902 Vali Loss: 0.0309243 Test Loss: 0.1075178
Validation loss decreased (0.031091 --> 0.030924).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1062968
	speed: 0.0390s/iter; left time: 307.2615s
	iters: 200, epoch: 7 | loss: 0.2120802
	speed: 0.0113s/iter; left time: 87.9588s
	iters: 300, epoch: 7 | loss: 0.1100620
	speed: 0.0113s/iter; left time: 86.8530s
	iters: 400, epoch: 7 | loss: 0.1183304
	speed: 0.0113s/iter; left time: 85.7156s
	iters: 500, epoch: 7 | loss: 0.1491428
	speed: 0.0113s/iter; left time: 84.5879s
Epoch: 7 cost time: 6.764179229736328
Epoch: 7, Steps: 570 | Train Loss: 0.1613630 Vali Loss: 0.0309184 Test Loss: 0.1069352
Validation loss decreased (0.030924 --> 0.030918).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0981253
	speed: 0.0387s/iter; left time: 282.7642s
	iters: 200, epoch: 8 | loss: 0.1939955
	speed: 0.0113s/iter; left time: 81.7563s
	iters: 300, epoch: 8 | loss: 0.1069070
	speed: 0.0113s/iter; left time: 80.6059s
	iters: 400, epoch: 8 | loss: 0.1302006
	speed: 0.0113s/iter; left time: 79.5191s
	iters: 500, epoch: 8 | loss: 0.1133184
	speed: 0.0113s/iter; left time: 78.3236s
Epoch: 8 cost time: 6.779322862625122
Epoch: 8, Steps: 570 | Train Loss: 0.1610553 Vali Loss: 0.0308465 Test Loss: 0.1070259
Validation loss decreased (0.030918 --> 0.030846).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2431948
	speed: 0.0380s/iter; left time: 256.0274s
	iters: 200, epoch: 9 | loss: 0.1085973
	speed: 0.0114s/iter; left time: 75.5307s
	iters: 300, epoch: 9 | loss: 0.1865964
	speed: 0.0113s/iter; left time: 74.1702s
	iters: 400, epoch: 9 | loss: 0.1574120
	speed: 0.0113s/iter; left time: 72.9982s
	iters: 500, epoch: 9 | loss: 0.2534977
	speed: 0.0113s/iter; left time: 71.7081s
Epoch: 9 cost time: 6.761131763458252
Epoch: 9, Steps: 570 | Train Loss: 0.1610307 Vali Loss: 0.0307559 Test Loss: 0.1071171
Validation loss decreased (0.030846 --> 0.030756).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1659242
	speed: 0.0385s/iter; left time: 237.5365s
	iters: 200, epoch: 10 | loss: 0.1408953
	speed: 0.0113s/iter; left time: 68.9002s
	iters: 300, epoch: 10 | loss: 0.1435749
	speed: 0.0113s/iter; left time: 67.7687s
	iters: 400, epoch: 10 | loss: 0.1516236
	speed: 0.0114s/iter; left time: 66.6502s
	iters: 500, epoch: 10 | loss: 0.1847495
	speed: 0.0113s/iter; left time: 65.4343s
Epoch: 10 cost time: 6.772582054138184
Epoch: 10, Steps: 570 | Train Loss: 0.1621241 Vali Loss: 0.0307923 Test Loss: 0.1069819
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1045091
	speed: 0.0373s/iter; left time: 209.0360s
	iters: 200, epoch: 11 | loss: 0.1686046
	speed: 0.0113s/iter; left time: 62.3653s
	iters: 300, epoch: 11 | loss: 0.1355993
	speed: 0.0113s/iter; left time: 61.2062s
	iters: 400, epoch: 11 | loss: 0.1975277
	speed: 0.0114s/iter; left time: 60.1965s
	iters: 500, epoch: 11 | loss: 0.2288408
	speed: 0.0113s/iter; left time: 58.9748s
Epoch: 11 cost time: 6.738894701004028
Epoch: 11, Steps: 570 | Train Loss: 0.1620241 Vali Loss: 0.0307820 Test Loss: 0.1069949
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1570746
	speed: 0.0393s/iter; left time: 197.8265s
	iters: 200, epoch: 12 | loss: 0.1310816
	speed: 0.0113s/iter; left time: 55.8519s
	iters: 300, epoch: 12 | loss: 0.1221883
	speed: 0.0113s/iter; left time: 54.7222s
	iters: 400, epoch: 12 | loss: 0.2274144
	speed: 0.0113s/iter; left time: 53.4047s
	iters: 500, epoch: 12 | loss: 0.1564860
	speed: 0.0113s/iter; left time: 52.4918s
Epoch: 12 cost time: 6.755852699279785
Epoch: 12, Steps: 570 | Train Loss: 0.1610206 Vali Loss: 0.0309605 Test Loss: 0.1069620
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10725592076778412, mae:0.19391117990016937
>>> S LR=1e-4 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2783804
	speed: 0.0229s/iter; left time: 259.3040s
	iters: 200, epoch: 1 | loss: 0.2968609
	speed: 0.0109s/iter; left time: 122.2370s
	iters: 300, epoch: 1 | loss: 0.2897148
	speed: 0.0109s/iter; left time: 121.4239s
	iters: 400, epoch: 1 | loss: 0.2546429
	speed: 0.0109s/iter; left time: 119.8767s
	iters: 500, epoch: 1 | loss: 0.1933793
	speed: 0.0109s/iter; left time: 118.8143s
Epoch: 1 cost time: 7.469797372817993
Epoch: 1, Steps: 570 | Train Loss: 0.2463851 Vali Loss: 0.0407427 Test Loss: 0.1276017
Validation loss decreased (inf --> 0.040743).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2231335
	speed: 0.0389s/iter; left time: 417.1259s
	iters: 200, epoch: 2 | loss: 0.2612929
	speed: 0.0109s/iter; left time: 116.1621s
	iters: 300, epoch: 2 | loss: 0.1658904
	speed: 0.0109s/iter; left time: 114.8140s
	iters: 400, epoch: 2 | loss: 0.1490159
	speed: 0.0109s/iter; left time: 113.4946s
	iters: 500, epoch: 2 | loss: 0.1372420
	speed: 0.0109s/iter; left time: 112.4935s
Epoch: 2 cost time: 6.5661468505859375
Epoch: 2, Steps: 570 | Train Loss: 0.2141372 Vali Loss: 0.0413223 Test Loss: 0.1334621
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2028353
	speed: 0.0390s/iter; left time: 395.8945s
	iters: 200, epoch: 3 | loss: 0.1479381
	speed: 0.0109s/iter; left time: 109.7071s
	iters: 300, epoch: 3 | loss: 0.3119744
	speed: 0.0108s/iter; left time: 107.5886s
	iters: 400, epoch: 3 | loss: 0.1643182
	speed: 0.0109s/iter; left time: 107.0043s
	iters: 500, epoch: 3 | loss: 0.2149195
	speed: 0.0108s/iter; left time: 105.8261s
Epoch: 3 cost time: 6.512139558792114
Epoch: 3, Steps: 570 | Train Loss: 0.1989329 Vali Loss: 0.0390687 Test Loss: 0.1283307
Validation loss decreased (0.040743 --> 0.039069).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2204579
	speed: 0.0400s/iter; left time: 383.7217s
	iters: 200, epoch: 4 | loss: 0.1215734
	speed: 0.0109s/iter; left time: 103.3076s
	iters: 300, epoch: 4 | loss: 0.1823641
	speed: 0.0109s/iter; left time: 102.4848s
	iters: 400, epoch: 4 | loss: 0.3284887
	speed: 0.0109s/iter; left time: 101.6167s
	iters: 500, epoch: 4 | loss: 0.1940572
	speed: 0.0109s/iter; left time: 100.4539s
Epoch: 4 cost time: 6.615925550460815
Epoch: 4, Steps: 570 | Train Loss: 0.1931664 Vali Loss: 0.0384747 Test Loss: 0.1235834
Validation loss decreased (0.039069 --> 0.038475).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1544074
	speed: 0.0381s/iter; left time: 343.9426s
	iters: 200, epoch: 5 | loss: 0.1763735
	speed: 0.0109s/iter; left time: 96.9145s
	iters: 300, epoch: 5 | loss: 0.1884855
	speed: 0.0109s/iter; left time: 95.8403s
	iters: 400, epoch: 5 | loss: 0.1312174
	speed: 0.0109s/iter; left time: 94.9367s
	iters: 500, epoch: 5 | loss: 0.2865742
	speed: 0.0108s/iter; left time: 93.4747s
Epoch: 5 cost time: 6.4974682331085205
Epoch: 5, Steps: 570 | Train Loss: 0.1891935 Vali Loss: 0.0382404 Test Loss: 0.1237181
Validation loss decreased (0.038475 --> 0.038240).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1670102
	speed: 0.0388s/iter; left time: 328.1620s
	iters: 200, epoch: 6 | loss: 0.1695378
	speed: 0.0110s/iter; left time: 91.5001s
	iters: 300, epoch: 6 | loss: 0.2052457
	speed: 0.0109s/iter; left time: 90.2466s
	iters: 400, epoch: 6 | loss: 0.1615627
	speed: 0.0109s/iter; left time: 89.1680s
	iters: 500, epoch: 6 | loss: 0.1889564
	speed: 0.0109s/iter; left time: 87.9572s
Epoch: 6 cost time: 6.560226202011108
Epoch: 6, Steps: 570 | Train Loss: 0.1867563 Vali Loss: 0.0381274 Test Loss: 0.1236598
Validation loss decreased (0.038240 --> 0.038127).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1554545
	speed: 0.0388s/iter; left time: 305.8887s
	iters: 200, epoch: 7 | loss: 0.1561173
	speed: 0.0108s/iter; left time: 84.1861s
	iters: 300, epoch: 7 | loss: 0.1041942
	speed: 0.0108s/iter; left time: 83.1396s
	iters: 400, epoch: 7 | loss: 0.1826666
	speed: 0.0108s/iter; left time: 82.1003s
	iters: 500, epoch: 7 | loss: 0.1262598
	speed: 0.0108s/iter; left time: 81.0313s
Epoch: 7 cost time: 6.513522386550903
Epoch: 7, Steps: 570 | Train Loss: 0.1865680 Vali Loss: 0.0378233 Test Loss: 0.1226259
Validation loss decreased (0.038127 --> 0.037823).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1319289
	speed: 0.0394s/iter; left time: 288.0824s
	iters: 200, epoch: 8 | loss: 0.2453094
	speed: 0.0109s/iter; left time: 78.7316s
	iters: 300, epoch: 8 | loss: 0.2528299
	speed: 0.0109s/iter; left time: 77.5312s
	iters: 400, epoch: 8 | loss: 0.1628805
	speed: 0.0109s/iter; left time: 76.3647s
	iters: 500, epoch: 8 | loss: 0.1206918
	speed: 0.0109s/iter; left time: 75.1195s
Epoch: 8 cost time: 6.556631803512573
Epoch: 8, Steps: 570 | Train Loss: 0.1859755 Vali Loss: 0.0377853 Test Loss: 0.1228058
Validation loss decreased (0.037823 --> 0.037785).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1822077
	speed: 0.0404s/iter; left time: 272.5822s
	iters: 200, epoch: 9 | loss: 0.1707561
	speed: 0.0121s/iter; left time: 80.2912s
	iters: 300, epoch: 9 | loss: 0.2528452
	speed: 0.0120s/iter; left time: 78.4066s
	iters: 400, epoch: 9 | loss: 0.2933286
	speed: 0.0120s/iter; left time: 77.4531s
	iters: 500, epoch: 9 | loss: 0.0957619
	speed: 0.0120s/iter; left time: 76.2891s
Epoch: 9 cost time: 7.116223335266113
Epoch: 9, Steps: 570 | Train Loss: 0.1851689 Vali Loss: 0.0376683 Test Loss: 0.1225370
Validation loss decreased (0.037785 --> 0.037668).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2046894
	speed: 0.0404s/iter; left time: 249.4387s
	iters: 200, epoch: 10 | loss: 0.1077073
	speed: 0.0109s/iter; left time: 66.0105s
	iters: 300, epoch: 10 | loss: 0.2328151
	speed: 0.0109s/iter; left time: 64.9162s
	iters: 400, epoch: 10 | loss: 0.1730310
	speed: 0.0109s/iter; left time: 63.7782s
	iters: 500, epoch: 10 | loss: 0.2571766
	speed: 0.0109s/iter; left time: 62.7329s
Epoch: 10 cost time: 6.525304794311523
Epoch: 10, Steps: 570 | Train Loss: 0.1853047 Vali Loss: 0.0378100 Test Loss: 0.1226114
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1423763
	speed: 0.0393s/iter; left time: 220.0749s
	iters: 200, epoch: 11 | loss: 0.1771114
	speed: 0.0121s/iter; left time: 66.3682s
	iters: 300, epoch: 11 | loss: 0.1611420
	speed: 0.0121s/iter; left time: 65.1519s
	iters: 400, epoch: 11 | loss: 0.1307653
	speed: 0.0118s/iter; left time: 62.4672s
	iters: 500, epoch: 11 | loss: 0.1416668
	speed: 0.0115s/iter; left time: 60.0713s
Epoch: 11 cost time: 7.081271409988403
Epoch: 11, Steps: 570 | Train Loss: 0.1855183 Vali Loss: 0.0377179 Test Loss: 0.1226066
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2201946
	speed: 0.0390s/iter; left time: 196.3867s
	iters: 200, epoch: 12 | loss: 0.2151704
	speed: 0.0108s/iter; left time: 53.3312s
	iters: 300, epoch: 12 | loss: 0.2162461
	speed: 0.0108s/iter; left time: 52.2579s
	iters: 400, epoch: 12 | loss: 0.1857782
	speed: 0.0108s/iter; left time: 51.1885s
	iters: 500, epoch: 12 | loss: 0.1795882
	speed: 0.0108s/iter; left time: 50.0968s
Epoch: 12 cost time: 6.466198205947876
Epoch: 12, Steps: 570 | Train Loss: 0.1848562 Vali Loss: 0.0377761 Test Loss: 0.1226393
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12266808748245239, mae:0.21800662577152252
>>> S LR=1e-4 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2245593
	speed: 0.0262s/iter; left time: 296.0514s
	iters: 200, epoch: 1 | loss: 0.1684853
	speed: 0.0146s/iter; left time: 163.4206s
	iters: 300, epoch: 1 | loss: 0.3211471
	speed: 0.0146s/iter; left time: 161.6959s
	iters: 400, epoch: 1 | loss: 0.2032432
	speed: 0.0146s/iter; left time: 160.3853s
	iters: 500, epoch: 1 | loss: 0.1820761
	speed: 0.0146s/iter; left time: 158.7094s
Epoch: 1 cost time: 9.522167444229126
Epoch: 1, Steps: 570 | Train Loss: 0.2399006 Vali Loss: 0.0427785 Test Loss: 0.1306434
Validation loss decreased (inf --> 0.042778).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2752884
	speed: 0.0480s/iter; left time: 514.9899s
	iters: 200, epoch: 2 | loss: 0.2133886
	speed: 0.0156s/iter; left time: 166.0915s
	iters: 300, epoch: 2 | loss: 0.1552828
	speed: 0.0144s/iter; left time: 151.9103s
	iters: 400, epoch: 2 | loss: 0.1010259
	speed: 0.0145s/iter; left time: 150.7811s
	iters: 500, epoch: 2 | loss: 0.2116741
	speed: 0.0144s/iter; left time: 148.9449s
Epoch: 2 cost time: 8.809296131134033
Epoch: 2, Steps: 570 | Train Loss: 0.2081482 Vali Loss: 0.0403047 Test Loss: 0.1306240
Validation loss decreased (0.042778 --> 0.040305).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3561242
	speed: 0.0455s/iter; left time: 462.0252s
	iters: 200, epoch: 3 | loss: 0.2204950
	speed: 0.0146s/iter; left time: 146.7217s
	iters: 300, epoch: 3 | loss: 0.1171003
	speed: 0.0146s/iter; left time: 145.1109s
	iters: 400, epoch: 3 | loss: 0.1504887
	speed: 0.0145s/iter; left time: 143.3754s
	iters: 500, epoch: 3 | loss: 0.1307606
	speed: 0.0146s/iter; left time: 142.2435s
Epoch: 3 cost time: 8.597763299942017
Epoch: 3, Steps: 570 | Train Loss: 0.1924965 Vali Loss: 0.0361226 Test Loss: 0.1208279
Validation loss decreased (0.040305 --> 0.036123).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1511607
	speed: 0.0470s/iter; left time: 450.5643s
	iters: 200, epoch: 4 | loss: 0.1515665
	speed: 0.0145s/iter; left time: 137.8598s
	iters: 300, epoch: 4 | loss: 0.1893427
	speed: 0.0145s/iter; left time: 136.6017s
	iters: 400, epoch: 4 | loss: 0.1793336
	speed: 0.0145s/iter; left time: 134.9406s
	iters: 500, epoch: 4 | loss: 0.1589197
	speed: 0.0145s/iter; left time: 133.2213s
Epoch: 4 cost time: 8.57286548614502
Epoch: 4, Steps: 570 | Train Loss: 0.1864021 Vali Loss: 0.0363296 Test Loss: 0.1201509
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1608534
	speed: 0.0473s/iter; left time: 427.1152s
	iters: 200, epoch: 5 | loss: 0.1961555
	speed: 0.0146s/iter; left time: 129.9674s
	iters: 300, epoch: 5 | loss: 0.1502487
	speed: 0.0146s/iter; left time: 128.9170s
	iters: 400, epoch: 5 | loss: 0.2070739
	speed: 0.0146s/iter; left time: 127.7283s
	iters: 500, epoch: 5 | loss: 0.2289825
	speed: 0.0146s/iter; left time: 125.9749s
Epoch: 5 cost time: 8.599048137664795
Epoch: 5, Steps: 570 | Train Loss: 0.1837229 Vali Loss: 0.0364248 Test Loss: 0.1183522
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1503269
	speed: 0.0458s/iter; left time: 386.8705s
	iters: 200, epoch: 6 | loss: 0.1644494
	speed: 0.0145s/iter; left time: 120.8346s
	iters: 300, epoch: 6 | loss: 0.1227033
	speed: 0.0145s/iter; left time: 119.7432s
	iters: 400, epoch: 6 | loss: 0.1336833
	speed: 0.0145s/iter; left time: 117.9587s
	iters: 500, epoch: 6 | loss: 0.1864679
	speed: 0.0145s/iter; left time: 116.6546s
Epoch: 6 cost time: 8.504641771316528
Epoch: 6, Steps: 570 | Train Loss: 0.1811083 Vali Loss: 0.0359927 Test Loss: 0.1184409
Validation loss decreased (0.036123 --> 0.035993).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1674712
	speed: 0.0473s/iter; left time: 372.6981s
	iters: 200, epoch: 7 | loss: 0.1535128
	speed: 0.0146s/iter; left time: 113.5121s
	iters: 300, epoch: 7 | loss: 0.1535735
	speed: 0.0144s/iter; left time: 110.7644s
	iters: 400, epoch: 7 | loss: 0.1591118
	speed: 0.0144s/iter; left time: 109.2945s
	iters: 500, epoch: 7 | loss: 0.2570687
	speed: 0.0145s/iter; left time: 108.5841s
Epoch: 7 cost time: 8.528036832809448
Epoch: 7, Steps: 570 | Train Loss: 0.1806878 Vali Loss: 0.0359717 Test Loss: 0.1182538
Validation loss decreased (0.035993 --> 0.035972).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2654402
	speed: 0.0456s/iter; left time: 333.3227s
	iters: 200, epoch: 8 | loss: 0.2056067
	speed: 0.0147s/iter; left time: 105.7625s
	iters: 300, epoch: 8 | loss: 0.2012092
	speed: 0.0151s/iter; left time: 107.4727s
	iters: 400, epoch: 8 | loss: 0.1335766
	speed: 0.0147s/iter; left time: 102.8968s
	iters: 500, epoch: 8 | loss: 0.1938920
	speed: 0.0147s/iter; left time: 101.4982s
Epoch: 8 cost time: 8.689953327178955
Epoch: 8, Steps: 570 | Train Loss: 0.1812953 Vali Loss: 0.0358305 Test Loss: 0.1186164
Validation loss decreased (0.035972 --> 0.035831).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2282482
	speed: 0.0461s/iter; left time: 310.5312s
	iters: 200, epoch: 9 | loss: 0.2401088
	speed: 0.0145s/iter; left time: 96.4084s
	iters: 300, epoch: 9 | loss: 0.2813075
	speed: 0.0145s/iter; left time: 95.0381s
	iters: 400, epoch: 9 | loss: 0.1736935
	speed: 0.0145s/iter; left time: 93.5842s
	iters: 500, epoch: 9 | loss: 0.1461558
	speed: 0.0145s/iter; left time: 92.1212s
Epoch: 9 cost time: 8.531420469284058
Epoch: 9, Steps: 570 | Train Loss: 0.1798262 Vali Loss: 0.0359265 Test Loss: 0.1182391
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2198753
	speed: 0.0462s/iter; left time: 284.9067s
	iters: 200, epoch: 10 | loss: 0.1590593
	speed: 0.0146s/iter; left time: 88.4218s
	iters: 300, epoch: 10 | loss: 0.1396611
	speed: 0.0145s/iter; left time: 86.8123s
	iters: 400, epoch: 10 | loss: 0.1561301
	speed: 0.0145s/iter; left time: 85.1185s
	iters: 500, epoch: 10 | loss: 0.2287549
	speed: 0.0145s/iter; left time: 83.7330s
Epoch: 10 cost time: 8.542136669158936
Epoch: 10, Steps: 570 | Train Loss: 0.1812996 Vali Loss: 0.0357415 Test Loss: 0.1182967
Validation loss decreased (0.035831 --> 0.035741).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1708783
	speed: 0.0471s/iter; left time: 263.9966s
	iters: 200, epoch: 11 | loss: 0.1346380
	speed: 0.0166s/iter; left time: 91.3540s
	iters: 300, epoch: 11 | loss: 0.1752318
	speed: 0.0166s/iter; left time: 89.6377s
	iters: 400, epoch: 11 | loss: 0.1480697
	speed: 0.0167s/iter; left time: 88.3859s
	iters: 500, epoch: 11 | loss: 0.1756489
	speed: 0.0167s/iter; left time: 86.8311s
Epoch: 11 cost time: 9.567527770996094
Epoch: 11, Steps: 570 | Train Loss: 0.1801225 Vali Loss: 0.0358335 Test Loss: 0.1183249
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1340475
	speed: 0.0490s/iter; left time: 246.6680s
	iters: 200, epoch: 12 | loss: 0.1357797
	speed: 0.0167s/iter; left time: 82.4468s
	iters: 300, epoch: 12 | loss: 0.2252299
	speed: 0.0167s/iter; left time: 80.6631s
	iters: 400, epoch: 12 | loss: 0.1735622
	speed: 0.0167s/iter; left time: 78.8073s
	iters: 500, epoch: 12 | loss: 0.1617371
	speed: 0.0166s/iter; left time: 77.0043s
Epoch: 12 cost time: 9.768913745880127
Epoch: 12, Steps: 570 | Train Loss: 0.1802552 Vali Loss: 0.0358689 Test Loss: 0.1182339
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1623314
	speed: 0.0482s/iter; left time: 214.8072s
	iters: 200, epoch: 13 | loss: 0.2980385
	speed: 0.0145s/iter; left time: 63.3025s
	iters: 300, epoch: 13 | loss: 0.2365808
	speed: 0.0145s/iter; left time: 61.8186s
	iters: 400, epoch: 13 | loss: 0.1347257
	speed: 0.0145s/iter; left time: 60.1507s
	iters: 500, epoch: 13 | loss: 0.2119412
	speed: 0.0145s/iter; left time: 58.7417s
Epoch: 13 cost time: 8.507900953292847
Epoch: 13, Steps: 570 | Train Loss: 0.1800116 Vali Loss: 0.0358219 Test Loss: 0.1182710
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11840040236711502, mae:0.21017874777317047
>>> S LR=1e-4 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.3262091
	speed: 0.0253s/iter; left time: 286.1374s
	iters: 200, epoch: 1 | loss: 0.2334928
	speed: 0.0141s/iter; left time: 157.7676s
	iters: 300, epoch: 1 | loss: 0.1304034
	speed: 0.0141s/iter; left time: 156.0776s
	iters: 400, epoch: 1 | loss: 0.3087494
	speed: 0.0141s/iter; left time: 154.9741s
	iters: 500, epoch: 1 | loss: 0.1851953
	speed: 0.0141s/iter; left time: 153.3283s
Epoch: 1 cost time: 9.203429460525513
Epoch: 1, Steps: 570 | Train Loss: 0.2135308 Vali Loss: 0.0351854 Test Loss: 0.1121759
Validation loss decreased (inf --> 0.035185).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1560801
	speed: 0.0459s/iter; left time: 492.7818s
	iters: 200, epoch: 2 | loss: 0.2603405
	speed: 0.0141s/iter; left time: 150.1471s
	iters: 300, epoch: 2 | loss: 0.1813902
	speed: 0.0141s/iter; left time: 148.6800s
	iters: 400, epoch: 2 | loss: 0.1739645
	speed: 0.0141s/iter; left time: 147.3737s
	iters: 500, epoch: 2 | loss: 0.1740397
	speed: 0.0141s/iter; left time: 145.9791s
Epoch: 2 cost time: 8.3291494846344
Epoch: 2, Steps: 570 | Train Loss: 0.1847033 Vali Loss: 0.0334163 Test Loss: 0.1128563
Validation loss decreased (0.035185 --> 0.033416).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1745701
	speed: 0.0457s/iter; left time: 464.4252s
	iters: 200, epoch: 3 | loss: 0.0916965
	speed: 0.0143s/iter; left time: 143.7475s
	iters: 300, epoch: 3 | loss: 0.2655243
	speed: 0.0142s/iter; left time: 141.7068s
	iters: 400, epoch: 3 | loss: 0.1193084
	speed: 0.0142s/iter; left time: 140.2565s
	iters: 500, epoch: 3 | loss: 0.1564149
	speed: 0.0142s/iter; left time: 138.8051s
Epoch: 3 cost time: 8.386986017227173
Epoch: 3, Steps: 570 | Train Loss: 0.1733597 Vali Loss: 0.0325966 Test Loss: 0.1092632
Validation loss decreased (0.033416 --> 0.032597).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1710155
	speed: 0.0462s/iter; left time: 443.0542s
	iters: 200, epoch: 4 | loss: 0.1713165
	speed: 0.0141s/iter; left time: 133.9695s
	iters: 300, epoch: 4 | loss: 0.2281473
	speed: 0.0141s/iter; left time: 132.5045s
	iters: 400, epoch: 4 | loss: 0.1088188
	speed: 0.0141s/iter; left time: 131.1214s
	iters: 500, epoch: 4 | loss: 0.1167992
	speed: 0.0141s/iter; left time: 129.7874s
Epoch: 4 cost time: 8.304601907730103
Epoch: 4, Steps: 570 | Train Loss: 0.1711486 Vali Loss: 0.0318584 Test Loss: 0.1081588
Validation loss decreased (0.032597 --> 0.031858).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1008181
	speed: 0.0467s/iter; left time: 421.4540s
	iters: 200, epoch: 5 | loss: 0.2113905
	speed: 0.0141s/iter; left time: 126.0904s
	iters: 300, epoch: 5 | loss: 0.1873090
	speed: 0.0141s/iter; left time: 124.6095s
	iters: 400, epoch: 5 | loss: 0.1391214
	speed: 0.0141s/iter; left time: 123.2153s
	iters: 500, epoch: 5 | loss: 0.1718204
	speed: 0.0141s/iter; left time: 121.7856s
Epoch: 5 cost time: 8.324331760406494
Epoch: 5, Steps: 570 | Train Loss: 0.1678171 Vali Loss: 0.0316838 Test Loss: 0.1074198
Validation loss decreased (0.031858 --> 0.031684).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1265574
	speed: 0.0452s/iter; left time: 382.2216s
	iters: 200, epoch: 6 | loss: 0.2663774
	speed: 0.0141s/iter; left time: 117.8520s
	iters: 300, epoch: 6 | loss: 0.2513412
	speed: 0.0141s/iter; left time: 116.7375s
	iters: 400, epoch: 6 | loss: 0.1808041
	speed: 0.0141s/iter; left time: 114.9609s
	iters: 500, epoch: 6 | loss: 0.1861196
	speed: 0.0141s/iter; left time: 113.7357s
Epoch: 6 cost time: 8.32617998123169
Epoch: 6, Steps: 570 | Train Loss: 0.1676333 Vali Loss: 0.0314388 Test Loss: 0.1065208
Validation loss decreased (0.031684 --> 0.031439).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1219458
	speed: 0.0459s/iter; left time: 361.5870s
	iters: 200, epoch: 7 | loss: 0.1762150
	speed: 0.0159s/iter; left time: 123.9705s
	iters: 300, epoch: 7 | loss: 0.2641794
	speed: 0.0162s/iter; left time: 124.6591s
	iters: 400, epoch: 7 | loss: 0.1432323
	speed: 0.0163s/iter; left time: 123.3087s
	iters: 500, epoch: 7 | loss: 0.2104717
	speed: 0.0163s/iter; left time: 121.6183s
Epoch: 7 cost time: 9.309368371963501
Epoch: 7, Steps: 570 | Train Loss: 0.1666407 Vali Loss: 0.0316780 Test Loss: 0.1070118
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1180373
	speed: 0.0484s/iter; left time: 353.7646s
	iters: 200, epoch: 8 | loss: 0.1437892
	speed: 0.0162s/iter; left time: 116.7293s
	iters: 300, epoch: 8 | loss: 0.2453150
	speed: 0.0162s/iter; left time: 115.1411s
	iters: 400, epoch: 8 | loss: 0.1764303
	speed: 0.0162s/iter; left time: 113.5133s
	iters: 500, epoch: 8 | loss: 0.1762521
	speed: 0.0162s/iter; left time: 111.8834s
Epoch: 8 cost time: 9.525748252868652
Epoch: 8, Steps: 570 | Train Loss: 0.1658747 Vali Loss: 0.0315785 Test Loss: 0.1066429
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1340992
	speed: 0.0479s/iter; left time: 323.0499s
	iters: 200, epoch: 9 | loss: 0.1258900
	speed: 0.0162s/iter; left time: 107.6023s
	iters: 300, epoch: 9 | loss: 0.2026037
	speed: 0.0162s/iter; left time: 106.0026s
	iters: 400, epoch: 9 | loss: 0.1912098
	speed: 0.0162s/iter; left time: 104.3781s
	iters: 500, epoch: 9 | loss: 0.1769525
	speed: 0.0162s/iter; left time: 102.7213s
Epoch: 9 cost time: 9.490880012512207
Epoch: 9, Steps: 570 | Train Loss: 0.1658195 Vali Loss: 0.0314607 Test Loss: 0.1065902
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10665639489889145, mae:0.19460304081439972
>>> S LR=1e-4 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1486581
	speed: 0.0260s/iter; left time: 293.5979s
	iters: 200, epoch: 1 | loss: 0.3040110
	speed: 0.0142s/iter; left time: 158.8614s
	iters: 300, epoch: 1 | loss: 0.3647439
	speed: 0.0142s/iter; left time: 157.1368s
	iters: 400, epoch: 1 | loss: 0.2090006
	speed: 0.0142s/iter; left time: 156.0697s
	iters: 500, epoch: 1 | loss: 0.2479500
	speed: 0.0141s/iter; left time: 154.1227s
Epoch: 1 cost time: 9.311775922775269
Epoch: 1, Steps: 570 | Train Loss: 0.2483465 Vali Loss: 0.0416773 Test Loss: 0.1333894
Validation loss decreased (inf --> 0.041677).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1817787
	speed: 0.0469s/iter; left time: 502.8560s
	iters: 200, epoch: 2 | loss: 0.1611614
	speed: 0.0160s/iter; left time: 169.6936s
	iters: 300, epoch: 2 | loss: 0.1544962
	speed: 0.0159s/iter; left time: 167.5436s
	iters: 400, epoch: 2 | loss: 0.1443753
	speed: 0.0159s/iter; left time: 166.3327s
	iters: 500, epoch: 2 | loss: 0.2389823
	speed: 0.0159s/iter; left time: 164.4341s
Epoch: 2 cost time: 9.403009414672852
Epoch: 2, Steps: 570 | Train Loss: 0.2143904 Vali Loss: 0.0401003 Test Loss: 0.1285614
Validation loss decreased (0.041677 --> 0.040100).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2431289
	speed: 0.0505s/iter; left time: 512.7126s
	iters: 200, epoch: 3 | loss: 0.2415338
	speed: 0.0164s/iter; left time: 165.0668s
	iters: 300, epoch: 3 | loss: 0.1550895
	speed: 0.0164s/iter; left time: 163.3438s
	iters: 400, epoch: 3 | loss: 0.1606947
	speed: 0.0164s/iter; left time: 161.9386s
	iters: 500, epoch: 3 | loss: 0.2334243
	speed: 0.0164s/iter; left time: 159.9674s
Epoch: 3 cost time: 9.630929470062256
Epoch: 3, Steps: 570 | Train Loss: 0.2013857 Vali Loss: 0.0389707 Test Loss: 0.1245744
Validation loss decreased (0.040100 --> 0.038971).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2451973
	speed: 0.0519s/iter; left time: 497.8883s
	iters: 200, epoch: 4 | loss: 0.1878610
	speed: 0.0165s/iter; left time: 156.5549s
	iters: 300, epoch: 4 | loss: 0.2008707
	speed: 0.0165s/iter; left time: 154.6516s
	iters: 400, epoch: 4 | loss: 0.1576786
	speed: 0.0165s/iter; left time: 153.1464s
	iters: 500, epoch: 4 | loss: 0.1608264
	speed: 0.0165s/iter; left time: 151.4425s
Epoch: 4 cost time: 9.672290325164795
Epoch: 4, Steps: 570 | Train Loss: 0.1970071 Vali Loss: 0.0384640 Test Loss: 0.1226670
Validation loss decreased (0.038971 --> 0.038464).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1731062
	speed: 0.0464s/iter; left time: 418.9839s
	iters: 200, epoch: 5 | loss: 0.2133598
	speed: 0.0143s/iter; left time: 127.8588s
	iters: 300, epoch: 5 | loss: 0.1717639
	speed: 0.0143s/iter; left time: 125.7125s
	iters: 400, epoch: 5 | loss: 0.2291717
	speed: 0.0141s/iter; left time: 122.9050s
	iters: 500, epoch: 5 | loss: 0.1421662
	speed: 0.0141s/iter; left time: 121.5005s
Epoch: 5 cost time: 8.374588012695312
Epoch: 5, Steps: 570 | Train Loss: 0.1935598 Vali Loss: 0.0383978 Test Loss: 0.1227356
Validation loss decreased (0.038464 --> 0.038398).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2736826
	speed: 0.0449s/iter; left time: 379.1930s
	iters: 200, epoch: 6 | loss: 0.2011435
	speed: 0.0142s/iter; left time: 118.3285s
	iters: 300, epoch: 6 | loss: 0.1046370
	speed: 0.0142s/iter; left time: 116.9430s
	iters: 400, epoch: 6 | loss: 0.2280953
	speed: 0.0142s/iter; left time: 115.5578s
	iters: 500, epoch: 6 | loss: 0.2381390
	speed: 0.0141s/iter; left time: 113.8555s
Epoch: 6 cost time: 8.349987268447876
Epoch: 6, Steps: 570 | Train Loss: 0.1922609 Vali Loss: 0.0380622 Test Loss: 0.1233175
Validation loss decreased (0.038398 --> 0.038062).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2313198
	speed: 0.0447s/iter; left time: 352.0810s
	iters: 200, epoch: 7 | loss: 0.1233922
	speed: 0.0143s/iter; left time: 110.9310s
	iters: 300, epoch: 7 | loss: 0.1501603
	speed: 0.0144s/iter; left time: 110.5386s
	iters: 400, epoch: 7 | loss: 0.2708328
	speed: 0.0142s/iter; left time: 107.7687s
	iters: 500, epoch: 7 | loss: 0.1710031
	speed: 0.0142s/iter; left time: 106.4408s
Epoch: 7 cost time: 8.416516542434692
Epoch: 7, Steps: 570 | Train Loss: 0.1924850 Vali Loss: 0.0378892 Test Loss: 0.1223697
Validation loss decreased (0.038062 --> 0.037889).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1686757
	speed: 0.0446s/iter; left time: 325.7942s
	iters: 200, epoch: 8 | loss: 0.2141830
	speed: 0.0142s/iter; left time: 102.5141s
	iters: 300, epoch: 8 | loss: 0.1573780
	speed: 0.0142s/iter; left time: 101.0854s
	iters: 400, epoch: 8 | loss: 0.1937735
	speed: 0.0142s/iter; left time: 99.7127s
	iters: 500, epoch: 8 | loss: 0.1249319
	speed: 0.0142s/iter; left time: 98.3093s
Epoch: 8 cost time: 8.37630319595337
Epoch: 8, Steps: 570 | Train Loss: 0.1920639 Vali Loss: 0.0380640 Test Loss: 0.1228305
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2627325
	speed: 0.0473s/iter; left time: 319.1402s
	iters: 200, epoch: 9 | loss: 0.1669216
	speed: 0.0159s/iter; left time: 105.2790s
	iters: 300, epoch: 9 | loss: 0.1361448
	speed: 0.0159s/iter; left time: 104.0406s
	iters: 400, epoch: 9 | loss: 0.1345875
	speed: 0.0159s/iter; left time: 102.5385s
	iters: 500, epoch: 9 | loss: 0.1630628
	speed: 0.0159s/iter; left time: 100.6507s
Epoch: 9 cost time: 9.296496152877808
Epoch: 9, Steps: 570 | Train Loss: 0.1907520 Vali Loss: 0.0378913 Test Loss: 0.1226839
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3079636
	speed: 0.0450s/iter; left time: 277.9468s
	iters: 200, epoch: 10 | loss: 0.2046952
	speed: 0.0141s/iter; left time: 85.8377s
	iters: 300, epoch: 10 | loss: 0.1964266
	speed: 0.0141s/iter; left time: 84.4718s
	iters: 400, epoch: 10 | loss: 0.2128126
	speed: 0.0141s/iter; left time: 82.9633s
	iters: 500, epoch: 10 | loss: 0.1673700
	speed: 0.0141s/iter; left time: 81.6536s
Epoch: 10 cost time: 8.311752080917358
Epoch: 10, Steps: 570 | Train Loss: 0.1904218 Vali Loss: 0.0379302 Test Loss: 0.1226464
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12249985337257385, mae:0.21757890284061432
>>> S LR=1e-4 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2690426
	speed: 0.0301s/iter; left time: 340.5556s
	iters: 200, epoch: 1 | loss: 0.1982981
	speed: 0.0172s/iter; left time: 192.5095s
	iters: 300, epoch: 1 | loss: 0.2973288
	speed: 0.0167s/iter; left time: 185.6298s
	iters: 400, epoch: 1 | loss: 0.2376143
	speed: 0.0167s/iter; left time: 184.1488s
	iters: 500, epoch: 1 | loss: 0.2004131
	speed: 0.0167s/iter; left time: 182.5791s
Epoch: 1 cost time: 10.973109483718872
Epoch: 1, Steps: 570 | Train Loss: 0.2354481 Vali Loss: 0.0412420 Test Loss: 0.1298254
Validation loss decreased (inf --> 0.041242).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2050101
	speed: 0.0513s/iter; left time: 550.9996s
	iters: 200, epoch: 2 | loss: 0.2548567
	speed: 0.0168s/iter; left time: 178.2604s
	iters: 300, epoch: 2 | loss: 0.2095893
	speed: 0.0168s/iter; left time: 176.6700s
	iters: 400, epoch: 2 | loss: 0.1353424
	speed: 0.0168s/iter; left time: 174.7218s
	iters: 500, epoch: 2 | loss: 0.1592037
	speed: 0.0168s/iter; left time: 173.2844s
Epoch: 2 cost time: 9.885119915008545
Epoch: 2, Steps: 570 | Train Loss: 0.2044954 Vali Loss: 0.0410611 Test Loss: 0.1320071
Validation loss decreased (0.041242 --> 0.041061).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1776997
	speed: 0.0513s/iter; left time: 521.4700s
	iters: 200, epoch: 3 | loss: 0.2043796
	speed: 0.0182s/iter; left time: 183.2067s
	iters: 300, epoch: 3 | loss: 0.2951731
	speed: 0.0182s/iter; left time: 181.4296s
	iters: 400, epoch: 3 | loss: 0.1800003
	speed: 0.0181s/iter; left time: 178.9600s
	iters: 500, epoch: 3 | loss: 0.1728231
	speed: 0.0174s/iter; left time: 170.2953s
Epoch: 3 cost time: 10.503339529037476
Epoch: 3, Steps: 570 | Train Loss: 0.1874764 Vali Loss: 0.0386829 Test Loss: 0.1267206
Validation loss decreased (0.041061 --> 0.038683).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1635793
	speed: 0.0519s/iter; left time: 497.3276s
	iters: 200, epoch: 4 | loss: 0.2018835
	speed: 0.0169s/iter; left time: 160.3915s
	iters: 300, epoch: 4 | loss: 0.2127094
	speed: 0.0168s/iter; left time: 158.2024s
	iters: 400, epoch: 4 | loss: 0.2177229
	speed: 0.0168s/iter; left time: 156.1419s
	iters: 500, epoch: 4 | loss: 0.1975816
	speed: 0.0168s/iter; left time: 154.1142s
Epoch: 4 cost time: 9.879043579101562
Epoch: 4, Steps: 570 | Train Loss: 0.1785924 Vali Loss: 0.0366974 Test Loss: 0.1263466
Validation loss decreased (0.038683 --> 0.036697).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1332304
	speed: 0.0502s/iter; left time: 452.6098s
	iters: 200, epoch: 5 | loss: 0.2217673
	speed: 0.0169s/iter; left time: 150.4288s
	iters: 300, epoch: 5 | loss: 0.1793883
	speed: 0.0169s/iter; left time: 148.7146s
	iters: 400, epoch: 5 | loss: 0.1777273
	speed: 0.0169s/iter; left time: 147.0415s
	iters: 500, epoch: 5 | loss: 0.1415254
	speed: 0.0169s/iter; left time: 145.3693s
Epoch: 5 cost time: 9.903112649917603
Epoch: 5, Steps: 570 | Train Loss: 0.1730330 Vali Loss: 0.0357819 Test Loss: 0.1315388
Validation loss decreased (0.036697 --> 0.035782).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2189647
	speed: 0.0520s/iter; left time: 439.5543s
	iters: 200, epoch: 6 | loss: 0.1389434
	speed: 0.0169s/iter; left time: 140.8016s
	iters: 300, epoch: 6 | loss: 0.1772773
	speed: 0.0168s/iter; left time: 138.5825s
	iters: 400, epoch: 6 | loss: 0.2496657
	speed: 0.0168s/iter; left time: 136.8649s
	iters: 500, epoch: 6 | loss: 0.1585131
	speed: 0.0171s/iter; left time: 137.9278s
Epoch: 6 cost time: 10.021929740905762
Epoch: 6, Steps: 570 | Train Loss: 0.1702985 Vali Loss: 0.0368539 Test Loss: 0.1250641
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1609547
	speed: 0.0514s/iter; left time: 405.1528s
	iters: 200, epoch: 7 | loss: 0.1735669
	speed: 0.0173s/iter; left time: 134.4796s
	iters: 300, epoch: 7 | loss: 0.2181357
	speed: 0.0181s/iter; left time: 138.7249s
	iters: 400, epoch: 7 | loss: 0.1188114
	speed: 0.0181s/iter; left time: 136.9410s
	iters: 500, epoch: 7 | loss: 0.1384278
	speed: 0.0181s/iter; left time: 135.1186s
Epoch: 7 cost time: 10.339497327804565
Epoch: 7, Steps: 570 | Train Loss: 0.1690784 Vali Loss: 0.0360897 Test Loss: 0.1262786
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1740229
	speed: 0.0519s/iter; left time: 379.4008s
	iters: 200, epoch: 8 | loss: 0.1080812
	speed: 0.0181s/iter; left time: 130.6144s
	iters: 300, epoch: 8 | loss: 0.1443875
	speed: 0.0181s/iter; left time: 128.8858s
	iters: 400, epoch: 8 | loss: 0.1043326
	speed: 0.0181s/iter; left time: 127.0325s
	iters: 500, epoch: 8 | loss: 0.1253415
	speed: 0.0181s/iter; left time: 125.1577s
Epoch: 8 cost time: 10.589096307754517
Epoch: 8, Steps: 570 | Train Loss: 0.1686012 Vali Loss: 0.0367412 Test Loss: 0.1241682
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13169381022453308, mae:0.22214508056640625
>>> S LR=1e-4 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1802686
	speed: 0.0284s/iter; left time: 320.4012s
	iters: 200, epoch: 1 | loss: 0.1380753
	speed: 0.0162s/iter; left time: 181.8744s
	iters: 300, epoch: 1 | loss: 0.2235005
	speed: 0.0162s/iter; left time: 180.0740s
	iters: 400, epoch: 1 | loss: 0.2229529
	speed: 0.0173s/iter; left time: 189.8176s
	iters: 500, epoch: 1 | loss: 0.1399183
	speed: 0.0168s/iter; left time: 182.7827s
Epoch: 1 cost time: 10.677618741989136
Epoch: 1, Steps: 570 | Train Loss: 0.2090643 Vali Loss: 0.0339322 Test Loss: 0.1137296
Validation loss decreased (inf --> 0.033932).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1586223
	speed: 0.0523s/iter; left time: 560.8048s
	iters: 200, epoch: 2 | loss: 0.1316514
	speed: 0.0163s/iter; left time: 172.7778s
	iters: 300, epoch: 2 | loss: 0.2296982
	speed: 0.0163s/iter; left time: 171.1965s
	iters: 400, epoch: 2 | loss: 0.2653341
	speed: 0.0162s/iter; left time: 169.2795s
	iters: 500, epoch: 2 | loss: 0.1828445
	speed: 0.0162s/iter; left time: 167.6254s
Epoch: 2 cost time: 9.674587488174438
Epoch: 2, Steps: 570 | Train Loss: 0.1823933 Vali Loss: 0.0338604 Test Loss: 0.1134979
Validation loss decreased (0.033932 --> 0.033860).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1469266
	speed: 0.0505s/iter; left time: 513.2255s
	iters: 200, epoch: 3 | loss: 0.1839951
	speed: 0.0163s/iter; left time: 163.7114s
	iters: 300, epoch: 3 | loss: 0.1531434
	speed: 0.0163s/iter; left time: 162.5378s
	iters: 400, epoch: 3 | loss: 0.2316310
	speed: 0.0179s/iter; left time: 176.8236s
	iters: 500, epoch: 3 | loss: 0.1078006
	speed: 0.0166s/iter; left time: 161.9465s
Epoch: 3 cost time: 9.787997722625732
Epoch: 3, Steps: 570 | Train Loss: 0.1699386 Vali Loss: 0.0314938 Test Loss: 0.1079876
Validation loss decreased (0.033860 --> 0.031494).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1826810
	speed: 0.0507s/iter; left time: 486.0035s
	iters: 200, epoch: 4 | loss: 0.2882569
	speed: 0.0163s/iter; left time: 154.3903s
	iters: 300, epoch: 4 | loss: 0.1497305
	speed: 0.0162s/iter; left time: 152.5770s
	iters: 400, epoch: 4 | loss: 0.1036580
	speed: 0.0162s/iter; left time: 150.9412s
	iters: 500, epoch: 4 | loss: 0.2174062
	speed: 0.0163s/iter; left time: 149.5496s
Epoch: 4 cost time: 9.59014892578125
Epoch: 4, Steps: 570 | Train Loss: 0.1641022 Vali Loss: 0.0307320 Test Loss: 0.1057858
Validation loss decreased (0.031494 --> 0.030732).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1708383
	speed: 0.0490s/iter; left time: 442.1727s
	iters: 200, epoch: 5 | loss: 0.1996347
	speed: 0.0163s/iter; left time: 145.0972s
	iters: 300, epoch: 5 | loss: 0.1608562
	speed: 0.0162s/iter; left time: 142.9092s
	iters: 400, epoch: 5 | loss: 0.1122269
	speed: 0.0162s/iter; left time: 141.0858s
	iters: 500, epoch: 5 | loss: 0.2184432
	speed: 0.0162s/iter; left time: 139.6789s
Epoch: 5 cost time: 9.565088748931885
Epoch: 5, Steps: 570 | Train Loss: 0.1606113 Vali Loss: 0.0306956 Test Loss: 0.1061744
Validation loss decreased (0.030732 --> 0.030696).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1525416
	speed: 0.0516s/iter; left time: 436.1368s
	iters: 200, epoch: 6 | loss: 0.2170970
	speed: 0.0163s/iter; left time: 135.8849s
	iters: 300, epoch: 6 | loss: 0.2933228
	speed: 0.0163s/iter; left time: 134.1535s
	iters: 400, epoch: 6 | loss: 0.1513458
	speed: 0.0163s/iter; left time: 132.5214s
	iters: 500, epoch: 6 | loss: 0.1616781
	speed: 0.0162s/iter; left time: 130.7701s
Epoch: 6 cost time: 9.589141845703125
Epoch: 6, Steps: 570 | Train Loss: 0.1587858 Vali Loss: 0.0307247 Test Loss: 0.1063548
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2231888
	speed: 0.0512s/iter; left time: 403.2706s
	iters: 200, epoch: 7 | loss: 0.1033148
	speed: 0.0162s/iter; left time: 125.7383s
	iters: 300, epoch: 7 | loss: 0.1424839
	speed: 0.0162s/iter; left time: 124.1687s
	iters: 400, epoch: 7 | loss: 0.2093660
	speed: 0.0162s/iter; left time: 122.5013s
	iters: 500, epoch: 7 | loss: 0.2545627
	speed: 0.0162s/iter; left time: 120.8872s
Epoch: 7 cost time: 9.486579656600952
Epoch: 7, Steps: 570 | Train Loss: 0.1590541 Vali Loss: 0.0308185 Test Loss: 0.1067398
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1020518
	speed: 0.0490s/iter; left time: 357.9493s
	iters: 200, epoch: 8 | loss: 0.2414064
	speed: 0.0162s/iter; left time: 116.5764s
	iters: 300, epoch: 8 | loss: 0.2000948
	speed: 0.0162s/iter; left time: 115.0090s
	iters: 400, epoch: 8 | loss: 0.2060641
	speed: 0.0162s/iter; left time: 113.3594s
	iters: 500, epoch: 8 | loss: 0.1299951
	speed: 0.0162s/iter; left time: 111.7336s
Epoch: 8 cost time: 9.497643232345581
Epoch: 8, Steps: 570 | Train Loss: 0.1574086 Vali Loss: 0.0306611 Test Loss: 0.1062575
Validation loss decreased (0.030696 --> 0.030661).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1324815
	speed: 0.0507s/iter; left time: 341.9834s
	iters: 200, epoch: 9 | loss: 0.1624430
	speed: 0.0177s/iter; left time: 117.2792s
	iters: 300, epoch: 9 | loss: 0.0937767
	speed: 0.0177s/iter; left time: 115.5583s
	iters: 400, epoch: 9 | loss: 0.1288415
	speed: 0.0167s/iter; left time: 107.7911s
	iters: 500, epoch: 9 | loss: 0.0776599
	speed: 0.0162s/iter; left time: 103.0399s
Epoch: 9 cost time: 10.051163673400879
Epoch: 9, Steps: 570 | Train Loss: 0.1572622 Vali Loss: 0.0306591 Test Loss: 0.1063943
Validation loss decreased (0.030661 --> 0.030659).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1867609
	speed: 0.0500s/iter; left time: 308.7915s
	iters: 200, epoch: 10 | loss: 0.1552322
	speed: 0.0177s/iter; left time: 107.4082s
	iters: 300, epoch: 10 | loss: 0.1245551
	speed: 0.0177s/iter; left time: 105.4195s
	iters: 400, epoch: 10 | loss: 0.2108375
	speed: 0.0177s/iter; left time: 103.8581s
	iters: 500, epoch: 10 | loss: 0.1294777
	speed: 0.0177s/iter; left time: 102.0324s
Epoch: 10 cost time: 10.27646017074585
Epoch: 10, Steps: 570 | Train Loss: 0.1577119 Vali Loss: 0.0306539 Test Loss: 0.1063213
Validation loss decreased (0.030659 --> 0.030654).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1112998
	speed: 0.0500s/iter; left time: 279.9730s
	iters: 200, epoch: 11 | loss: 0.1362342
	speed: 0.0162s/iter; left time: 89.2064s
	iters: 300, epoch: 11 | loss: 0.1123844
	speed: 0.0162s/iter; left time: 87.5757s
	iters: 400, epoch: 11 | loss: 0.1710750
	speed: 0.0162s/iter; left time: 86.0214s
	iters: 500, epoch: 11 | loss: 0.1408683
	speed: 0.0162s/iter; left time: 84.1681s
Epoch: 11 cost time: 9.543828964233398
Epoch: 11, Steps: 570 | Train Loss: 0.1575184 Vali Loss: 0.0307662 Test Loss: 0.1062605
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1027515
	speed: 0.0520s/iter; left time: 261.3628s
	iters: 200, epoch: 12 | loss: 0.1775548
	speed: 0.0162s/iter; left time: 79.9397s
	iters: 300, epoch: 12 | loss: 0.0939276
	speed: 0.0162s/iter; left time: 78.0376s
	iters: 400, epoch: 12 | loss: 0.1580895
	speed: 0.0162s/iter; left time: 76.4325s
	iters: 500, epoch: 12 | loss: 0.2556589
	speed: 0.0162s/iter; left time: 74.8953s
Epoch: 12 cost time: 9.675334215164185
Epoch: 12, Steps: 570 | Train Loss: 0.1564757 Vali Loss: 0.0306915 Test Loss: 0.1062736
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2121863
	speed: 0.0487s/iter; left time: 217.3599s
	iters: 200, epoch: 13 | loss: 0.2590533
	speed: 0.0163s/iter; left time: 71.0566s
	iters: 300, epoch: 13 | loss: 0.2078295
	speed: 0.0163s/iter; left time: 69.5325s
	iters: 400, epoch: 13 | loss: 0.1271095
	speed: 0.0163s/iter; left time: 67.8078s
	iters: 500, epoch: 13 | loss: 0.1571953
	speed: 0.0163s/iter; left time: 66.1221s
Epoch: 13 cost time: 9.558825969696045
Epoch: 13, Steps: 570 | Train Loss: 0.1568976 Vali Loss: 0.0308197 Test Loss: 0.1062894
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10646073520183563, mae:0.19301235675811768
>>> S LR=1e-4 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2518121
	speed: 0.0270s/iter; left time: 305.5753s
	iters: 200, epoch: 1 | loss: 0.2541539
	speed: 0.0153s/iter; left time: 171.2165s
	iters: 300, epoch: 1 | loss: 0.1747658
	speed: 0.0153s/iter; left time: 169.9444s
	iters: 400, epoch: 1 | loss: 0.2495993
	speed: 0.0153s/iter; left time: 168.4958s
	iters: 500, epoch: 1 | loss: 0.3896454
	speed: 0.0153s/iter; left time: 167.2772s
Epoch: 1 cost time: 9.956547260284424
Epoch: 1, Steps: 570 | Train Loss: 0.2437715 Vali Loss: 0.0410526 Test Loss: 0.1305391
Validation loss decreased (inf --> 0.041053).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3299882
	speed: 0.0487s/iter; left time: 522.9776s
	iters: 200, epoch: 2 | loss: 0.1405137
	speed: 0.0153s/iter; left time: 162.8973s
	iters: 300, epoch: 2 | loss: 0.2665808
	speed: 0.0153s/iter; left time: 161.5341s
	iters: 400, epoch: 2 | loss: 0.1815762
	speed: 0.0153s/iter; left time: 159.6867s
	iters: 500, epoch: 2 | loss: 0.2762882
	speed: 0.0153s/iter; left time: 158.3878s
Epoch: 2 cost time: 9.02169418334961
Epoch: 2, Steps: 570 | Train Loss: 0.2114752 Vali Loss: 0.0401657 Test Loss: 0.1296050
Validation loss decreased (0.041053 --> 0.040166).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2224553
	speed: 0.0505s/iter; left time: 513.2632s
	iters: 200, epoch: 3 | loss: 0.1416377
	speed: 0.0155s/iter; left time: 156.3453s
	iters: 300, epoch: 3 | loss: 0.1903223
	speed: 0.0155s/iter; left time: 154.5477s
	iters: 400, epoch: 3 | loss: 0.2188313
	speed: 0.0155s/iter; left time: 153.1180s
	iters: 500, epoch: 3 | loss: 0.2056634
	speed: 0.0155s/iter; left time: 151.4749s
Epoch: 3 cost time: 9.14360785484314
Epoch: 3, Steps: 570 | Train Loss: 0.1965213 Vali Loss: 0.0396575 Test Loss: 0.1258592
Validation loss decreased (0.040166 --> 0.039658).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1477092
	speed: 0.0486s/iter; left time: 466.2575s
	iters: 200, epoch: 4 | loss: 0.2037034
	speed: 0.0154s/iter; left time: 146.3011s
	iters: 300, epoch: 4 | loss: 0.1782269
	speed: 0.0154s/iter; left time: 144.6883s
	iters: 400, epoch: 4 | loss: 0.1481004
	speed: 0.0154s/iter; left time: 143.2244s
	iters: 500, epoch: 4 | loss: 0.2216411
	speed: 0.0154s/iter; left time: 141.6933s
Epoch: 4 cost time: 9.087422609329224
Epoch: 4, Steps: 570 | Train Loss: 0.1905797 Vali Loss: 0.0386287 Test Loss: 0.1252754
Validation loss decreased (0.039658 --> 0.038629).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1650914
	speed: 0.0502s/iter; left time: 452.6318s
	iters: 200, epoch: 5 | loss: 0.1392069
	speed: 0.0154s/iter; left time: 137.2293s
	iters: 300, epoch: 5 | loss: 0.1626345
	speed: 0.0154s/iter; left time: 135.6796s
	iters: 400, epoch: 5 | loss: 0.1389854
	speed: 0.0154s/iter; left time: 134.0549s
	iters: 500, epoch: 5 | loss: 0.1979387
	speed: 0.0154s/iter; left time: 132.4647s
Epoch: 5 cost time: 9.065229892730713
Epoch: 5, Steps: 570 | Train Loss: 0.1847873 Vali Loss: 0.0387809 Test Loss: 0.1246657
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2360773
	speed: 0.0495s/iter; left time: 418.6623s
	iters: 200, epoch: 6 | loss: 0.1282058
	speed: 0.0154s/iter; left time: 128.5039s
	iters: 300, epoch: 6 | loss: 0.1252855
	speed: 0.0154s/iter; left time: 126.9358s
	iters: 400, epoch: 6 | loss: 0.1435872
	speed: 0.0153s/iter; left time: 125.0630s
	iters: 500, epoch: 6 | loss: 0.1295628
	speed: 0.0154s/iter; left time: 123.7317s
Epoch: 6 cost time: 9.030335664749146
Epoch: 6, Steps: 570 | Train Loss: 0.1827357 Vali Loss: 0.0378310 Test Loss: 0.1240060
Validation loss decreased (0.038629 --> 0.037831).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2148020
	speed: 0.0477s/iter; left time: 375.9172s
	iters: 200, epoch: 7 | loss: 0.1531500
	speed: 0.0154s/iter; left time: 119.6075s
	iters: 300, epoch: 7 | loss: 0.1403367
	speed: 0.0154s/iter; left time: 117.9316s
	iters: 400, epoch: 7 | loss: 0.2238596
	speed: 0.0154s/iter; left time: 116.3690s
	iters: 500, epoch: 7 | loss: 0.1886050
	speed: 0.0153s/iter; left time: 114.8078s
Epoch: 7 cost time: 9.058942317962646
Epoch: 7, Steps: 570 | Train Loss: 0.1808919 Vali Loss: 0.0381625 Test Loss: 0.1239075
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1744460
	speed: 0.0493s/iter; left time: 360.0681s
	iters: 200, epoch: 8 | loss: 0.2732707
	speed: 0.0154s/iter; left time: 111.0159s
	iters: 300, epoch: 8 | loss: 0.1461139
	speed: 0.0154s/iter; left time: 109.5158s
	iters: 400, epoch: 8 | loss: 0.1976697
	speed: 0.0154s/iter; left time: 107.9428s
	iters: 500, epoch: 8 | loss: 0.1231450
	speed: 0.0154s/iter; left time: 106.3671s
Epoch: 8 cost time: 9.07153034210205
Epoch: 8, Steps: 570 | Train Loss: 0.1798455 Vali Loss: 0.0382019 Test Loss: 0.1240236
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1742264
	speed: 0.0488s/iter; left time: 328.8002s
	iters: 200, epoch: 9 | loss: 0.1716398
	speed: 0.0153s/iter; left time: 101.9392s
	iters: 300, epoch: 9 | loss: 0.1947635
	speed: 0.0154s/iter; left time: 100.4073s
	iters: 400, epoch: 9 | loss: 0.1626927
	speed: 0.0153s/iter; left time: 98.7781s
	iters: 500, epoch: 9 | loss: 0.2178103
	speed: 0.0153s/iter; left time: 97.3032s
Epoch: 9 cost time: 9.121096849441528
Epoch: 9, Steps: 570 | Train Loss: 0.1795061 Vali Loss: 0.0381253 Test Loss: 0.1240468
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12415692210197449, mae:0.2202131450176239
>>> S LR=1e-4 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.1718224
	speed: 0.0329s/iter; left time: 371.5020s
	iters: 200, epoch: 1 | loss: 0.2268919
	speed: 0.0209s/iter; left time: 234.4231s
	iters: 300, epoch: 1 | loss: 0.3924786
	speed: 0.0209s/iter; left time: 231.8508s
	iters: 400, epoch: 1 | loss: 0.2373331
	speed: 0.0209s/iter; left time: 229.9516s
	iters: 500, epoch: 1 | loss: 0.1746747
	speed: 0.0208s/iter; left time: 227.2306s
Epoch: 1 cost time: 13.157951831817627
Epoch: 1, Steps: 570 | Train Loss: 0.2393104 Vali Loss: 0.0402677 Test Loss: 0.1254851
Validation loss decreased (inf --> 0.040268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3662004
	speed: 0.0584s/iter; left time: 627.1686s
	iters: 200, epoch: 2 | loss: 0.1873447
	speed: 0.0185s/iter; left time: 197.0039s
	iters: 300, epoch: 2 | loss: 0.1434920
	speed: 0.0186s/iter; left time: 195.4837s
	iters: 400, epoch: 2 | loss: 0.1860392
	speed: 0.0185s/iter; left time: 193.1917s
	iters: 500, epoch: 2 | loss: 0.1747240
	speed: 0.0185s/iter; left time: 191.1054s
Epoch: 2 cost time: 10.872121095657349
Epoch: 2, Steps: 570 | Train Loss: 0.2064306 Vali Loss: 0.0394710 Test Loss: 0.1246882
Validation loss decreased (0.040268 --> 0.039471).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1626192
	speed: 0.0589s/iter; left time: 598.0496s
	iters: 200, epoch: 3 | loss: 0.1929874
	speed: 0.0186s/iter; left time: 187.3503s
	iters: 300, epoch: 3 | loss: 0.1905132
	speed: 0.0186s/iter; left time: 185.6097s
	iters: 400, epoch: 3 | loss: 0.1335315
	speed: 0.0186s/iter; left time: 183.6040s
	iters: 500, epoch: 3 | loss: 0.1617592
	speed: 0.0186s/iter; left time: 181.6165s
Epoch: 3 cost time: 10.931527614593506
Epoch: 3, Steps: 570 | Train Loss: 0.1911665 Vali Loss: 0.0371176 Test Loss: 0.1247718
Validation loss decreased (0.039471 --> 0.037118).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2160810
	speed: 0.0569s/iter; left time: 545.9277s
	iters: 200, epoch: 4 | loss: 0.2342492
	speed: 0.0187s/iter; left time: 177.3542s
	iters: 300, epoch: 4 | loss: 0.2327679
	speed: 0.0187s/iter; left time: 175.4259s
	iters: 400, epoch: 4 | loss: 0.1144193
	speed: 0.0187s/iter; left time: 173.2959s
	iters: 500, epoch: 4 | loss: 0.1820969
	speed: 0.0197s/iter; left time: 180.9786s
Epoch: 4 cost time: 11.222585439682007
Epoch: 4, Steps: 570 | Train Loss: 0.1845090 Vali Loss: 0.0363299 Test Loss: 0.1216281
Validation loss decreased (0.037118 --> 0.036330).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1954149
	speed: 0.0591s/iter; left time: 532.8811s
	iters: 200, epoch: 5 | loss: 0.1832713
	speed: 0.0185s/iter; left time: 164.7483s
	iters: 300, epoch: 5 | loss: 0.1478704
	speed: 0.0185s/iter; left time: 162.8684s
	iters: 400, epoch: 5 | loss: 0.1598403
	speed: 0.0185s/iter; left time: 161.4317s
	iters: 500, epoch: 5 | loss: 0.1492942
	speed: 0.0185s/iter; left time: 159.6043s
Epoch: 5 cost time: 10.82475471496582
Epoch: 5, Steps: 570 | Train Loss: 0.1815995 Vali Loss: 0.0359194 Test Loss: 0.1233090
Validation loss decreased (0.036330 --> 0.035919).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0922294
	speed: 0.0558s/iter; left time: 471.9037s
	iters: 200, epoch: 6 | loss: 0.1920307
	speed: 0.0186s/iter; left time: 155.2766s
	iters: 300, epoch: 6 | loss: 0.1341019
	speed: 0.0186s/iter; left time: 153.3928s
	iters: 400, epoch: 6 | loss: 0.1909718
	speed: 0.0186s/iter; left time: 151.7573s
	iters: 500, epoch: 6 | loss: 0.2015491
	speed: 0.0186s/iter; left time: 149.9421s
Epoch: 6 cost time: 10.899557828903198
Epoch: 6, Steps: 570 | Train Loss: 0.1781172 Vali Loss: 0.0356885 Test Loss: 0.1213842
Validation loss decreased (0.035919 --> 0.035688).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1272148
	speed: 0.0610s/iter; left time: 480.8889s
	iters: 200, epoch: 7 | loss: 0.1936340
	speed: 0.0208s/iter; left time: 161.4729s
	iters: 300, epoch: 7 | loss: 0.1695206
	speed: 0.0207s/iter; left time: 159.3424s
	iters: 400, epoch: 7 | loss: 0.1752819
	speed: 0.0208s/iter; left time: 157.5618s
	iters: 500, epoch: 7 | loss: 0.2660055
	speed: 0.0208s/iter; left time: 155.4852s
Epoch: 7 cost time: 12.157360792160034
Epoch: 7, Steps: 570 | Train Loss: 0.1775493 Vali Loss: 0.0359381 Test Loss: 0.1197132
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2009110
	speed: 0.0611s/iter; left time: 447.0366s
	iters: 200, epoch: 8 | loss: 0.1464746
	speed: 0.0191s/iter; left time: 137.4680s
	iters: 300, epoch: 8 | loss: 0.1319378
	speed: 0.0185s/iter; left time: 131.2595s
	iters: 400, epoch: 8 | loss: 0.2020423
	speed: 0.0184s/iter; left time: 129.3312s
	iters: 500, epoch: 8 | loss: 0.1637375
	speed: 0.0185s/iter; left time: 127.6747s
Epoch: 8 cost time: 11.021605491638184
Epoch: 8, Steps: 570 | Train Loss: 0.1764600 Vali Loss: 0.0359989 Test Loss: 0.1190498
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1011212
	speed: 0.0564s/iter; left time: 380.4629s
	iters: 200, epoch: 9 | loss: 0.2308899
	speed: 0.0185s/iter; left time: 123.1291s
	iters: 300, epoch: 9 | loss: 0.0854108
	speed: 0.0185s/iter; left time: 121.2502s
	iters: 400, epoch: 9 | loss: 0.2058382
	speed: 0.0185s/iter; left time: 119.0899s
	iters: 500, epoch: 9 | loss: 0.0903808
	speed: 0.0185s/iter; left time: 117.1482s
Epoch: 9 cost time: 10.828766822814941
Epoch: 9, Steps: 570 | Train Loss: 0.1771838 Vali Loss: 0.0361312 Test Loss: 0.1189771
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12152878195047379, mae:0.21458718180656433
>>> S LR=1e-4 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.4354633
	speed: 0.0324s/iter; left time: 365.6479s
	iters: 200, epoch: 1 | loss: 0.2187788
	speed: 0.0192s/iter; left time: 215.4432s
	iters: 300, epoch: 1 | loss: 0.1848990
	speed: 0.0183s/iter; left time: 202.9893s
	iters: 400, epoch: 1 | loss: 0.1852173
	speed: 0.0183s/iter; left time: 200.9114s
	iters: 500, epoch: 1 | loss: 0.2282899
	speed: 0.0204s/iter; left time: 222.1072s
Epoch: 1 cost time: 12.336395740509033
Epoch: 1, Steps: 570 | Train Loss: 0.2131448 Vali Loss: 0.0348121 Test Loss: 0.1170565
Validation loss decreased (inf --> 0.034812).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1382992
	speed: 0.0584s/iter; left time: 627.2042s
	iters: 200, epoch: 2 | loss: 0.2333079
	speed: 0.0183s/iter; left time: 194.3727s
	iters: 300, epoch: 2 | loss: 0.3303004
	speed: 0.0182s/iter; left time: 191.9940s
	iters: 400, epoch: 2 | loss: 0.1583095
	speed: 0.0182s/iter; left time: 190.1800s
	iters: 500, epoch: 2 | loss: 0.1446537
	speed: 0.0183s/iter; left time: 188.6682s
Epoch: 2 cost time: 10.718906879425049
Epoch: 2, Steps: 570 | Train Loss: 0.1845810 Vali Loss: 0.0331513 Test Loss: 0.1098865
Validation loss decreased (0.034812 --> 0.033151).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1185631
	speed: 0.0599s/iter; left time: 608.6024s
	iters: 200, epoch: 3 | loss: 0.1605121
	speed: 0.0202s/iter; left time: 203.0351s
	iters: 300, epoch: 3 | loss: 0.1461956
	speed: 0.0184s/iter; left time: 182.8716s
	iters: 400, epoch: 3 | loss: 0.1615608
	speed: 0.0184s/iter; left time: 181.2512s
	iters: 500, epoch: 3 | loss: 0.1259843
	speed: 0.0184s/iter; left time: 179.2736s
Epoch: 3 cost time: 11.18224573135376
Epoch: 3, Steps: 570 | Train Loss: 0.1732438 Vali Loss: 0.0325377 Test Loss: 0.1098718
Validation loss decreased (0.033151 --> 0.032538).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1927478
	speed: 0.0610s/iter; left time: 585.0210s
	iters: 200, epoch: 4 | loss: 0.1082198
	speed: 0.0212s/iter; left time: 201.5648s
	iters: 300, epoch: 4 | loss: 0.2937933
	speed: 0.0212s/iter; left time: 199.1268s
	iters: 400, epoch: 4 | loss: 0.1521845
	speed: 0.0212s/iter; left time: 196.5797s
	iters: 500, epoch: 4 | loss: 0.1275499
	speed: 0.0212s/iter; left time: 194.8880s
Epoch: 4 cost time: 12.357372999191284
Epoch: 4, Steps: 570 | Train Loss: 0.1693545 Vali Loss: 0.0317364 Test Loss: 0.1069269
Validation loss decreased (0.032538 --> 0.031736).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1377056
	speed: 0.0641s/iter; left time: 577.8756s
	iters: 200, epoch: 5 | loss: 0.1682817
	speed: 0.0212s/iter; left time: 189.0653s
	iters: 300, epoch: 5 | loss: 0.1769073
	speed: 0.0212s/iter; left time: 186.5775s
	iters: 400, epoch: 5 | loss: 0.1454250
	speed: 0.0211s/iter; left time: 184.4252s
	iters: 500, epoch: 5 | loss: 0.1520396
	speed: 0.0212s/iter; left time: 182.3400s
Epoch: 5 cost time: 12.269798517227173
Epoch: 5, Steps: 570 | Train Loss: 0.1668673 Vali Loss: 0.0317466 Test Loss: 0.1068615
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2525725
	speed: 0.0552s/iter; left time: 466.1742s
	iters: 200, epoch: 6 | loss: 0.1394629
	speed: 0.0182s/iter; left time: 151.8448s
	iters: 300, epoch: 6 | loss: 0.1844528
	speed: 0.0182s/iter; left time: 150.1231s
	iters: 400, epoch: 6 | loss: 0.1469741
	speed: 0.0182s/iter; left time: 148.3062s
	iters: 500, epoch: 6 | loss: 0.1070640
	speed: 0.0182s/iter; left time: 146.3505s
Epoch: 6 cost time: 10.624315977096558
Epoch: 6, Steps: 570 | Train Loss: 0.1650676 Vali Loss: 0.0312092 Test Loss: 0.1060880
Validation loss decreased (0.031736 --> 0.031209).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1510514
	speed: 0.0562s/iter; left time: 443.1601s
	iters: 200, epoch: 7 | loss: 0.2068123
	speed: 0.0182s/iter; left time: 141.7977s
	iters: 300, epoch: 7 | loss: 0.1153758
	speed: 0.0182s/iter; left time: 140.1270s
	iters: 400, epoch: 7 | loss: 0.1644728
	speed: 0.0197s/iter; left time: 149.4018s
	iters: 500, epoch: 7 | loss: 0.1418349
	speed: 0.0211s/iter; left time: 157.7967s
Epoch: 7 cost time: 11.488420963287354
Epoch: 7, Steps: 570 | Train Loss: 0.1628825 Vali Loss: 0.0311510 Test Loss: 0.1059336
Validation loss decreased (0.031209 --> 0.031151).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1256055
	speed: 0.0600s/iter; left time: 438.9955s
	iters: 200, epoch: 8 | loss: 0.1435597
	speed: 0.0197s/iter; left time: 142.1058s
	iters: 300, epoch: 8 | loss: 0.1701955
	speed: 0.0182s/iter; left time: 129.6657s
	iters: 400, epoch: 8 | loss: 0.1648039
	speed: 0.0183s/iter; left time: 127.9599s
	iters: 500, epoch: 8 | loss: 0.2259391
	speed: 0.0182s/iter; left time: 125.8507s
Epoch: 8 cost time: 11.09661602973938
Epoch: 8, Steps: 570 | Train Loss: 0.1624029 Vali Loss: 0.0312148 Test Loss: 0.1059031
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0855121
	speed: 0.0588s/iter; left time: 396.3003s
	iters: 200, epoch: 9 | loss: 0.1210900
	speed: 0.0182s/iter; left time: 120.9679s
	iters: 300, epoch: 9 | loss: 0.1846351
	speed: 0.0182s/iter; left time: 118.8918s
	iters: 400, epoch: 9 | loss: 0.1699109
	speed: 0.0182s/iter; left time: 117.2878s
	iters: 500, epoch: 9 | loss: 0.1476557
	speed: 0.0182s/iter; left time: 115.3613s
Epoch: 9 cost time: 10.649572134017944
Epoch: 9, Steps: 570 | Train Loss: 0.1621791 Vali Loss: 0.0313453 Test Loss: 0.1060028
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1085552
	speed: 0.0551s/iter; left time: 339.7818s
	iters: 200, epoch: 10 | loss: 0.1183602
	speed: 0.0183s/iter; left time: 111.1282s
	iters: 300, epoch: 10 | loss: 0.2213030
	speed: 0.0183s/iter; left time: 109.0275s
	iters: 400, epoch: 10 | loss: 0.1751849
	speed: 0.0183s/iter; left time: 107.3896s
	iters: 500, epoch: 10 | loss: 0.1617309
	speed: 0.0183s/iter; left time: 105.6254s
Epoch: 10 cost time: 10.69889521598816
Epoch: 10, Steps: 570 | Train Loss: 0.1630031 Vali Loss: 0.0311605 Test Loss: 0.1058716
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10606696456670761, mae:0.19326163828372955
>>> S LR=1e-4 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2656812
	speed: 0.0321s/iter; left time: 362.6658s
	iters: 200, epoch: 1 | loss: 0.1915043
	speed: 0.0203s/iter; left time: 227.6735s
	iters: 300, epoch: 1 | loss: 0.2426527
	speed: 0.0203s/iter; left time: 225.4980s
	iters: 400, epoch: 1 | loss: 0.2689413
	speed: 0.0204s/iter; left time: 224.0858s
	iters: 500, epoch: 1 | loss: 0.3404360
	speed: 0.0204s/iter; left time: 222.1589s
Epoch: 1 cost time: 12.827265739440918
Epoch: 1, Steps: 570 | Train Loss: 0.2481877 Vali Loss: 0.0402796 Test Loss: 0.1363021
Validation loss decreased (inf --> 0.040280).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3001812
	speed: 0.0566s/iter; left time: 607.3757s
	iters: 200, epoch: 2 | loss: 0.2724189
	speed: 0.0182s/iter; left time: 192.9686s
	iters: 300, epoch: 2 | loss: 0.4306322
	speed: 0.0181s/iter; left time: 190.9596s
	iters: 400, epoch: 2 | loss: 0.2158812
	speed: 0.0181s/iter; left time: 189.2933s
	iters: 500, epoch: 2 | loss: 0.1333730
	speed: 0.0181s/iter; left time: 187.2386s
Epoch: 2 cost time: 10.632810354232788
Epoch: 2, Steps: 570 | Train Loss: 0.2148918 Vali Loss: 0.0439019 Test Loss: 0.1355050
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1494007
	speed: 0.0547s/iter; left time: 555.7702s
	iters: 200, epoch: 3 | loss: 0.1930469
	speed: 0.0183s/iter; left time: 183.7233s
	iters: 300, epoch: 3 | loss: 0.1953371
	speed: 0.0182s/iter; left time: 181.4820s
	iters: 400, epoch: 3 | loss: 0.2365042
	speed: 0.0182s/iter; left time: 179.8489s
	iters: 500, epoch: 3 | loss: 0.1980267
	speed: 0.0181s/iter; left time: 177.0889s
Epoch: 3 cost time: 10.675519943237305
Epoch: 3, Steps: 570 | Train Loss: 0.1996547 Vali Loss: 0.0397778 Test Loss: 0.1288895
Validation loss decreased (0.040280 --> 0.039778).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1628731
	speed: 0.0550s/iter; left time: 527.7089s
	iters: 200, epoch: 4 | loss: 0.1976996
	speed: 0.0182s/iter; left time: 172.9016s
	iters: 300, epoch: 4 | loss: 0.1618490
	speed: 0.0182s/iter; left time: 170.8239s
	iters: 400, epoch: 4 | loss: 0.2374267
	speed: 0.0182s/iter; left time: 168.8704s
	iters: 500, epoch: 4 | loss: 0.1317616
	speed: 0.0182s/iter; left time: 167.1019s
Epoch: 4 cost time: 10.659017324447632
Epoch: 4, Steps: 570 | Train Loss: 0.1939295 Vali Loss: 0.0387329 Test Loss: 0.1242950
Validation loss decreased (0.039778 --> 0.038733).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1611156
	speed: 0.0547s/iter; left time: 493.0359s
	iters: 200, epoch: 5 | loss: 0.1802928
	speed: 0.0183s/iter; left time: 162.8758s
	iters: 300, epoch: 5 | loss: 0.1706761
	speed: 0.0182s/iter; left time: 160.9701s
	iters: 400, epoch: 5 | loss: 0.1713449
	speed: 0.0182s/iter; left time: 159.0907s
	iters: 500, epoch: 5 | loss: 0.1010261
	speed: 0.0182s/iter; left time: 157.3299s
Epoch: 5 cost time: 10.686867952346802
Epoch: 5, Steps: 570 | Train Loss: 0.1902148 Vali Loss: 0.0380515 Test Loss: 0.1233948
Validation loss decreased (0.038733 --> 0.038052).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2542662
	speed: 0.0575s/iter; left time: 486.2404s
	iters: 200, epoch: 6 | loss: 0.1245199
	speed: 0.0190s/iter; left time: 158.2812s
	iters: 300, epoch: 6 | loss: 0.3070162
	speed: 0.0182s/iter; left time: 150.2807s
	iters: 400, epoch: 6 | loss: 0.1279415
	speed: 0.0183s/iter; left time: 148.8809s
	iters: 500, epoch: 6 | loss: 0.1944127
	speed: 0.0182s/iter; left time: 146.7673s
Epoch: 6 cost time: 10.971001625061035
Epoch: 6, Steps: 570 | Train Loss: 0.1889182 Vali Loss: 0.0381541 Test Loss: 0.1227834
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1676200
	speed: 0.0580s/iter; left time: 457.3599s
	iters: 200, epoch: 7 | loss: 0.1893746
	speed: 0.0181s/iter; left time: 140.6732s
	iters: 300, epoch: 7 | loss: 0.2037131
	speed: 0.0180s/iter; left time: 138.5841s
	iters: 400, epoch: 7 | loss: 0.1800661
	speed: 0.0181s/iter; left time: 136.8400s
	iters: 500, epoch: 7 | loss: 0.1383364
	speed: 0.0181s/iter; left time: 135.0908s
Epoch: 7 cost time: 10.606497287750244
Epoch: 7, Steps: 570 | Train Loss: 0.1885585 Vali Loss: 0.0380144 Test Loss: 0.1230938
Validation loss decreased (0.038052 --> 0.038014).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1530971
	speed: 0.0563s/iter; left time: 411.9476s
	iters: 200, epoch: 8 | loss: 0.1448538
	speed: 0.0181s/iter; left time: 130.7008s
	iters: 300, epoch: 8 | loss: 0.2080295
	speed: 0.0181s/iter; left time: 128.6138s
	iters: 400, epoch: 8 | loss: 0.2789818
	speed: 0.0181s/iter; left time: 126.6781s
	iters: 500, epoch: 8 | loss: 0.1538753
	speed: 0.0181s/iter; left time: 124.8869s
Epoch: 8 cost time: 10.581348657608032
Epoch: 8, Steps: 570 | Train Loss: 0.1877384 Vali Loss: 0.0380068 Test Loss: 0.1230376
Validation loss decreased (0.038014 --> 0.038007).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1750699
	speed: 0.0543s/iter; left time: 366.0858s
	iters: 200, epoch: 9 | loss: 0.2124076
	speed: 0.0182s/iter; left time: 120.6255s
	iters: 300, epoch: 9 | loss: 0.2373208
	speed: 0.0182s/iter; left time: 118.8441s
	iters: 400, epoch: 9 | loss: 0.3472399
	speed: 0.0182s/iter; left time: 116.9714s
	iters: 500, epoch: 9 | loss: 0.1361022
	speed: 0.0182s/iter; left time: 115.1633s
Epoch: 9 cost time: 10.610543489456177
Epoch: 9, Steps: 570 | Train Loss: 0.1873418 Vali Loss: 0.0380926 Test Loss: 0.1229900
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1605183
	speed: 0.0549s/iter; left time: 338.9435s
	iters: 200, epoch: 10 | loss: 0.1726916
	speed: 0.0181s/iter; left time: 109.8567s
	iters: 300, epoch: 10 | loss: 0.2060131
	speed: 0.0181s/iter; left time: 108.0491s
	iters: 400, epoch: 10 | loss: 0.1830906
	speed: 0.0181s/iter; left time: 106.5063s
	iters: 500, epoch: 10 | loss: 0.2097424
	speed: 0.0181s/iter; left time: 104.4133s
Epoch: 10 cost time: 10.592825651168823
Epoch: 10, Steps: 570 | Train Loss: 0.1866821 Vali Loss: 0.0378977 Test Loss: 0.1228806
Validation loss decreased (0.038007 --> 0.037898).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1572385
	speed: 0.0573s/iter; left time: 320.8261s
	iters: 200, epoch: 11 | loss: 0.2069866
	speed: 0.0183s/iter; left time: 100.5685s
	iters: 300, epoch: 11 | loss: 0.2335167
	speed: 0.0182s/iter; left time: 98.5641s
	iters: 400, epoch: 11 | loss: 0.1967697
	speed: 0.0183s/iter; left time: 96.7620s
	iters: 500, epoch: 11 | loss: 0.1791615
	speed: 0.0195s/iter; left time: 101.5817s
Epoch: 11 cost time: 10.960933208465576
Epoch: 11, Steps: 570 | Train Loss: 0.1884694 Vali Loss: 0.0379348 Test Loss: 0.1228516
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1294791
	speed: 0.0587s/iter; left time: 295.3775s
	iters: 200, epoch: 12 | loss: 0.2353686
	speed: 0.0183s/iter; left time: 90.3084s
	iters: 300, epoch: 12 | loss: 0.1766561
	speed: 0.0183s/iter; left time: 88.4266s
	iters: 400, epoch: 12 | loss: 0.1446253
	speed: 0.0183s/iter; left time: 86.5822s
	iters: 500, epoch: 12 | loss: 0.2427367
	speed: 0.0183s/iter; left time: 84.7801s
Epoch: 12 cost time: 10.673624753952026
Epoch: 12, Steps: 570 | Train Loss: 0.1872707 Vali Loss: 0.0379874 Test Loss: 0.1228629
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1530698
	speed: 0.0566s/iter; left time: 252.2805s
	iters: 200, epoch: 13 | loss: 0.1050199
	speed: 0.0182s/iter; left time: 79.4624s
	iters: 300, epoch: 13 | loss: 0.1649543
	speed: 0.0182s/iter; left time: 77.5217s
	iters: 400, epoch: 13 | loss: 0.1187337
	speed: 0.0182s/iter; left time: 75.6130s
	iters: 500, epoch: 13 | loss: 0.1327991
	speed: 0.0182s/iter; left time: 73.8159s
Epoch: 13 cost time: 10.641176700592041
Epoch: 13, Steps: 570 | Train Loss: 0.1873255 Vali Loss: 0.0381698 Test Loss: 0.1228629
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12302480638027191, mae:0.21774838864803314
>>> S LR=1e-4 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2285424
	speed: 0.0359s/iter; left time: 406.0049s
	iters: 200, epoch: 1 | loss: 0.1959453
	speed: 0.0238s/iter; left time: 266.3315s
	iters: 300, epoch: 1 | loss: 0.2253847
	speed: 0.0238s/iter; left time: 264.6097s
	iters: 400, epoch: 1 | loss: 0.3077883
	speed: 0.0238s/iter; left time: 261.9161s
	iters: 500, epoch: 1 | loss: 0.2055381
	speed: 0.0238s/iter; left time: 259.4389s
Epoch: 1 cost time: 14.833340883255005
Epoch: 1, Steps: 570 | Train Loss: 0.2359927 Vali Loss: 0.0412596 Test Loss: 0.1340895
Validation loss decreased (inf --> 0.041260).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2971377
	speed: 0.0661s/iter; left time: 709.6380s
	iters: 200, epoch: 2 | loss: 0.1818156
	speed: 0.0220s/iter; left time: 233.6766s
	iters: 300, epoch: 2 | loss: 0.1687161
	speed: 0.0220s/iter; left time: 231.4343s
	iters: 400, epoch: 2 | loss: 0.1915097
	speed: 0.0220s/iter; left time: 229.1432s
	iters: 500, epoch: 2 | loss: 0.1538472
	speed: 0.0220s/iter; left time: 226.9116s
Epoch: 2 cost time: 12.873375415802002
Epoch: 2, Steps: 570 | Train Loss: 0.2047570 Vali Loss: 0.0377460 Test Loss: 0.1267897
Validation loss decreased (0.041260 --> 0.037746).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3905979
	speed: 0.0648s/iter; left time: 658.4207s
	iters: 200, epoch: 3 | loss: 0.1331293
	speed: 0.0235s/iter; left time: 236.7305s
	iters: 300, epoch: 3 | loss: 0.2312494
	speed: 0.0235s/iter; left time: 234.3618s
	iters: 400, epoch: 3 | loss: 0.1348021
	speed: 0.0235s/iter; left time: 232.0292s
	iters: 500, epoch: 3 | loss: 0.1379371
	speed: 0.0236s/iter; left time: 230.0172s
Epoch: 3 cost time: 13.703800916671753
Epoch: 3, Steps: 570 | Train Loss: 0.1859677 Vali Loss: 0.0375920 Test Loss: 0.1315290
Validation loss decreased (0.037746 --> 0.037592).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1304436
	speed: 0.0650s/iter; left time: 623.0343s
	iters: 200, epoch: 4 | loss: 0.1377991
	speed: 0.0235s/iter; left time: 223.0761s
	iters: 300, epoch: 4 | loss: 0.1558671
	speed: 0.0235s/iter; left time: 220.9353s
	iters: 400, epoch: 4 | loss: 0.1321266
	speed: 0.0235s/iter; left time: 218.7042s
	iters: 500, epoch: 4 | loss: 0.2193190
	speed: 0.0236s/iter; left time: 216.5439s
Epoch: 4 cost time: 13.727669477462769
Epoch: 4, Steps: 570 | Train Loss: 0.1750634 Vali Loss: 0.0381888 Test Loss: 0.1323729
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2087090
	speed: 0.0646s/iter; left time: 583.1230s
	iters: 200, epoch: 5 | loss: 0.1871657
	speed: 0.0235s/iter; left time: 209.8387s
	iters: 300, epoch: 5 | loss: 0.1150683
	speed: 0.0234s/iter; left time: 206.2999s
	iters: 400, epoch: 5 | loss: 0.1471108
	speed: 0.0232s/iter; left time: 202.2718s
	iters: 500, epoch: 5 | loss: 0.1585138
	speed: 0.0235s/iter; left time: 202.5575s
Epoch: 5 cost time: 13.655484199523926
Epoch: 5, Steps: 570 | Train Loss: 0.1701314 Vali Loss: 0.0364380 Test Loss: 0.1323110
Validation loss decreased (0.037592 --> 0.036438).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1374752
	speed: 0.0674s/iter; left time: 569.4204s
	iters: 200, epoch: 6 | loss: 0.1943958
	speed: 0.0234s/iter; left time: 195.5706s
	iters: 300, epoch: 6 | loss: 0.1312199
	speed: 0.0234s/iter; left time: 193.1262s
	iters: 400, epoch: 6 | loss: 0.1537072
	speed: 0.0220s/iter; left time: 179.4720s
	iters: 500, epoch: 6 | loss: 0.2387888
	speed: 0.0218s/iter; left time: 175.8908s
Epoch: 6 cost time: 13.239113807678223
Epoch: 6, Steps: 570 | Train Loss: 0.1663921 Vali Loss: 0.0376093 Test Loss: 0.1327419
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1994020
	speed: 0.0616s/iter; left time: 485.2732s
	iters: 200, epoch: 7 | loss: 0.1876452
	speed: 0.0219s/iter; left time: 170.3897s
	iters: 300, epoch: 7 | loss: 0.1282263
	speed: 0.0219s/iter; left time: 167.9693s
	iters: 400, epoch: 7 | loss: 0.1872255
	speed: 0.0219s/iter; left time: 165.7222s
	iters: 500, epoch: 7 | loss: 0.1684632
	speed: 0.0219s/iter; left time: 163.6225s
Epoch: 7 cost time: 12.753390789031982
Epoch: 7, Steps: 570 | Train Loss: 0.1632587 Vali Loss: 0.0371696 Test Loss: 0.1293307
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1331055
	speed: 0.0641s/iter; left time: 468.8732s
	iters: 200, epoch: 8 | loss: 0.3664547
	speed: 0.0219s/iter; left time: 157.6866s
	iters: 300, epoch: 8 | loss: 0.1347957
	speed: 0.0218s/iter; left time: 155.2011s
	iters: 400, epoch: 8 | loss: 0.1377333
	speed: 0.0218s/iter; left time: 153.1009s
	iters: 500, epoch: 8 | loss: 0.1324550
	speed: 0.0218s/iter; left time: 150.7867s
Epoch: 8 cost time: 12.727877616882324
Epoch: 8, Steps: 570 | Train Loss: 0.1635661 Vali Loss: 0.0363408 Test Loss: 0.1305055
Validation loss decreased (0.036438 --> 0.036341).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1540264
	speed: 0.0627s/iter; left time: 422.8265s
	iters: 200, epoch: 9 | loss: 0.1530254
	speed: 0.0218s/iter; left time: 144.5093s
	iters: 300, epoch: 9 | loss: 0.1731012
	speed: 0.0217s/iter; left time: 142.1838s
	iters: 400, epoch: 9 | loss: 0.1136852
	speed: 0.0218s/iter; left time: 140.1276s
	iters: 500, epoch: 9 | loss: 0.1386875
	speed: 0.0217s/iter; left time: 137.7716s
Epoch: 9 cost time: 12.695062160491943
Epoch: 9, Steps: 570 | Train Loss: 0.1632613 Vali Loss: 0.0364020 Test Loss: 0.1305924
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1890516
	speed: 0.0645s/iter; left time: 397.7469s
	iters: 200, epoch: 10 | loss: 0.1777084
	speed: 0.0228s/iter; left time: 138.2699s
	iters: 300, epoch: 10 | loss: 0.1585314
	speed: 0.0219s/iter; left time: 130.8414s
	iters: 400, epoch: 10 | loss: 0.2231798
	speed: 0.0219s/iter; left time: 128.5340s
	iters: 500, epoch: 10 | loss: 0.1362386
	speed: 0.0219s/iter; left time: 126.4821s
Epoch: 10 cost time: 13.043030500411987
Epoch: 10, Steps: 570 | Train Loss: 0.1631123 Vali Loss: 0.0367330 Test Loss: 0.1304251
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1536103
	speed: 0.0653s/iter; left time: 365.4839s
	iters: 200, epoch: 11 | loss: 0.1231495
	speed: 0.0218s/iter; left time: 120.0514s
	iters: 300, epoch: 11 | loss: 0.0952775
	speed: 0.0218s/iter; left time: 117.7988s
	iters: 400, epoch: 11 | loss: 0.1490527
	speed: 0.0219s/iter; left time: 115.8491s
	iters: 500, epoch: 11 | loss: 0.1354564
	speed: 0.0219s/iter; left time: 113.8466s
Epoch: 11 cost time: 12.752514362335205
Epoch: 11, Steps: 570 | Train Loss: 0.1647409 Vali Loss: 0.0365692 Test Loss: 0.1302698
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13065563142299652, mae:0.22039152681827545
>>> S LR=1e-4 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2245692
	speed: 0.0334s/iter; left time: 377.6865s
	iters: 200, epoch: 1 | loss: 0.1115563
	speed: 0.0211s/iter; left time: 236.8825s
	iters: 300, epoch: 1 | loss: 0.1878438
	speed: 0.0211s/iter; left time: 234.7476s
	iters: 400, epoch: 1 | loss: 0.1822821
	speed: 0.0212s/iter; left time: 233.5441s
	iters: 500, epoch: 1 | loss: 0.1914830
	speed: 0.0212s/iter; left time: 230.6006s
Epoch: 1 cost time: 13.348724603652954
Epoch: 1, Steps: 570 | Train Loss: 0.2084477 Vali Loss: 0.0358248 Test Loss: 0.1168671
Validation loss decreased (inf --> 0.035825).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1910029
	speed: 0.0605s/iter; left time: 648.9349s
	iters: 200, epoch: 2 | loss: 0.1554090
	speed: 0.0210s/iter; left time: 223.5536s
	iters: 300, epoch: 2 | loss: 0.1933596
	speed: 0.0210s/iter; left time: 221.5444s
	iters: 400, epoch: 2 | loss: 0.1739943
	speed: 0.0210s/iter; left time: 219.3334s
	iters: 500, epoch: 2 | loss: 0.1342452
	speed: 0.0210s/iter; left time: 217.3475s
Epoch: 2 cost time: 12.291658401489258
Epoch: 2, Steps: 570 | Train Loss: 0.1819581 Vali Loss: 0.0339660 Test Loss: 0.1128424
Validation loss decreased (0.035825 --> 0.033966).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1476856
	speed: 0.0628s/iter; left time: 638.3715s
	iters: 200, epoch: 3 | loss: 0.1343072
	speed: 0.0218s/iter; left time: 219.5592s
	iters: 300, epoch: 3 | loss: 0.1520180
	speed: 0.0212s/iter; left time: 210.9869s
	iters: 400, epoch: 3 | loss: 0.1175260
	speed: 0.0212s/iter; left time: 209.1569s
	iters: 500, epoch: 3 | loss: 0.1330050
	speed: 0.0212s/iter; left time: 206.6473s
Epoch: 3 cost time: 12.622357606887817
Epoch: 3, Steps: 570 | Train Loss: 0.1689923 Vali Loss: 0.0322714 Test Loss: 0.1111303
Validation loss decreased (0.033966 --> 0.032271).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1280914
	speed: 0.0616s/iter; left time: 590.4882s
	iters: 200, epoch: 4 | loss: 0.1610201
	speed: 0.0212s/iter; left time: 201.6710s
	iters: 300, epoch: 4 | loss: 0.1810815
	speed: 0.0212s/iter; left time: 198.9017s
	iters: 400, epoch: 4 | loss: 0.1934283
	speed: 0.0212s/iter; left time: 197.1037s
	iters: 500, epoch: 4 | loss: 0.1406226
	speed: 0.0212s/iter; left time: 195.0815s
Epoch: 4 cost time: 12.514435291290283
Epoch: 4, Steps: 570 | Train Loss: 0.1620428 Vali Loss: 0.0313951 Test Loss: 0.1091258
Validation loss decreased (0.032271 --> 0.031395).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2168635
	speed: 0.0626s/iter; left time: 564.3013s
	iters: 200, epoch: 5 | loss: 0.1224253
	speed: 0.0212s/iter; left time: 189.2285s
	iters: 300, epoch: 5 | loss: 0.1725936
	speed: 0.0212s/iter; left time: 186.7882s
	iters: 400, epoch: 5 | loss: 0.1747887
	speed: 0.0212s/iter; left time: 184.6714s
	iters: 500, epoch: 5 | loss: 0.1418588
	speed: 0.0212s/iter; left time: 182.5864s
Epoch: 5 cost time: 12.338262557983398
Epoch: 5, Steps: 570 | Train Loss: 0.1582018 Vali Loss: 0.0313481 Test Loss: 0.1072632
Validation loss decreased (0.031395 --> 0.031348).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1406751
	speed: 0.0603s/iter; left time: 509.4623s
	iters: 200, epoch: 6 | loss: 0.2068769
	speed: 0.0211s/iter; left time: 175.8827s
	iters: 300, epoch: 6 | loss: 0.2108958
	speed: 0.0210s/iter; left time: 173.4453s
	iters: 400, epoch: 6 | loss: 0.1205302
	speed: 0.0210s/iter; left time: 171.4266s
	iters: 500, epoch: 6 | loss: 0.0977733
	speed: 0.0211s/iter; left time: 169.5741s
Epoch: 6 cost time: 12.282696008682251
Epoch: 6, Steps: 570 | Train Loss: 0.1553905 Vali Loss: 0.0309036 Test Loss: 0.1065795
Validation loss decreased (0.031348 --> 0.030904).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1580333
	speed: 0.0615s/iter; left time: 484.3154s
	iters: 200, epoch: 7 | loss: 0.1878279
	speed: 0.0212s/iter; left time: 165.0460s
	iters: 300, epoch: 7 | loss: 0.2043487
	speed: 0.0212s/iter; left time: 163.0118s
	iters: 400, epoch: 7 | loss: 0.1080838
	speed: 0.0212s/iter; left time: 160.6673s
	iters: 500, epoch: 7 | loss: 0.1758189
	speed: 0.0212s/iter; left time: 158.5818s
Epoch: 7 cost time: 12.371784687042236
Epoch: 7, Steps: 570 | Train Loss: 0.1545030 Vali Loss: 0.0312611 Test Loss: 0.1068720
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1361905
	speed: 0.0599s/iter; left time: 438.2533s
	iters: 200, epoch: 8 | loss: 0.1486422
	speed: 0.0211s/iter; left time: 152.1137s
	iters: 300, epoch: 8 | loss: 0.1517189
	speed: 0.0211s/iter; left time: 150.0281s
	iters: 400, epoch: 8 | loss: 0.1402429
	speed: 0.0211s/iter; left time: 147.9160s
	iters: 500, epoch: 8 | loss: 0.2312417
	speed: 0.0211s/iter; left time: 145.8380s
Epoch: 8 cost time: 12.290407657623291
Epoch: 8, Steps: 570 | Train Loss: 0.1544176 Vali Loss: 0.0305992 Test Loss: 0.1066149
Validation loss decreased (0.030904 --> 0.030599).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1374701
	speed: 0.0608s/iter; left time: 409.6974s
	iters: 200, epoch: 9 | loss: 0.2166413
	speed: 0.0211s/iter; left time: 140.0248s
	iters: 300, epoch: 9 | loss: 0.1914839
	speed: 0.0211s/iter; left time: 137.8359s
	iters: 400, epoch: 9 | loss: 0.1427836
	speed: 0.0211s/iter; left time: 135.7162s
	iters: 500, epoch: 9 | loss: 0.0980463
	speed: 0.0211s/iter; left time: 133.6035s
Epoch: 9 cost time: 12.320760250091553
Epoch: 9, Steps: 570 | Train Loss: 0.1537405 Vali Loss: 0.0307984 Test Loss: 0.1066903
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1147917
	speed: 0.0608s/iter; left time: 375.4119s
	iters: 200, epoch: 10 | loss: 0.1413172
	speed: 0.0230s/iter; left time: 139.6548s
	iters: 300, epoch: 10 | loss: 0.1228207
	speed: 0.0231s/iter; left time: 137.8404s
	iters: 400, epoch: 10 | loss: 0.1411375
	speed: 0.0231s/iter; left time: 135.4910s
	iters: 500, epoch: 10 | loss: 0.1989320
	speed: 0.0225s/iter; left time: 129.6716s
Epoch: 10 cost time: 13.195985317230225
Epoch: 10, Steps: 570 | Train Loss: 0.1525075 Vali Loss: 0.0306659 Test Loss: 0.1067022
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1912039
	speed: 0.0603s/iter; left time: 337.8782s
	iters: 200, epoch: 11 | loss: 0.1376076
	speed: 0.0230s/iter; left time: 126.6495s
	iters: 300, epoch: 11 | loss: 0.1328631
	speed: 0.0230s/iter; left time: 124.1511s
	iters: 400, epoch: 11 | loss: 0.1080323
	speed: 0.0230s/iter; left time: 121.9806s
	iters: 500, epoch: 11 | loss: 0.1844459
	speed: 0.0230s/iter; left time: 119.5825s
Epoch: 11 cost time: 13.315412044525146
Epoch: 11, Steps: 570 | Train Loss: 0.1541307 Vali Loss: 0.0306310 Test Loss: 0.1067437
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1067432388663292, mae:0.19338148832321167
>>> S LR=1e-4 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_S        Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           S                   
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       __NONE__            

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-S              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: []
train 18219
[DEBUG] kept columns: []
val 2608
[DEBUG] kept columns: []
test 5237
	iters: 100, epoch: 1 | loss: 0.2304418
	speed: 0.0319s/iter; left time: 360.5616s
	iters: 200, epoch: 1 | loss: 0.1931158
	speed: 0.0199s/iter; left time: 223.1024s
	iters: 300, epoch: 1 | loss: 0.2382321
	speed: 0.0199s/iter; left time: 221.0260s
	iters: 400, epoch: 1 | loss: 0.2880331
	speed: 0.0199s/iter; left time: 218.7627s
	iters: 500, epoch: 1 | loss: 0.2621817
	speed: 0.0198s/iter; left time: 216.2114s
Epoch: 1 cost time: 12.591323852539062
Epoch: 1, Steps: 570 | Train Loss: 0.2416867 Vali Loss: 0.0419444 Test Loss: 0.1319764
Validation loss decreased (inf --> 0.041944).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1287801
	speed: 0.0586s/iter; left time: 628.7115s
	iters: 200, epoch: 2 | loss: 0.3341736
	speed: 0.0200s/iter; left time: 212.7087s
	iters: 300, epoch: 2 | loss: 0.1748788
	speed: 0.0200s/iter; left time: 210.4345s
	iters: 400, epoch: 2 | loss: 0.1521483
	speed: 0.0200s/iter; left time: 208.4285s
	iters: 500, epoch: 2 | loss: 0.1576729
	speed: 0.0199s/iter; left time: 205.9316s
Epoch: 2 cost time: 11.660462379455566
Epoch: 2, Steps: 570 | Train Loss: 0.2114857 Vali Loss: 0.0419746 Test Loss: 0.1347700
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1345927
	speed: 0.0614s/iter; left time: 623.3895s
	iters: 200, epoch: 3 | loss: 0.1449842
	speed: 0.0230s/iter; left time: 231.1984s
	iters: 300, epoch: 3 | loss: 0.1801339
	speed: 0.0230s/iter; left time: 229.3913s
	iters: 400, epoch: 3 | loss: 0.2205692
	speed: 0.0231s/iter; left time: 228.1800s
	iters: 500, epoch: 3 | loss: 0.1652334
	speed: 0.0231s/iter; left time: 225.0994s
Epoch: 3 cost time: 13.412150144577026
Epoch: 3, Steps: 570 | Train Loss: 0.1943418 Vali Loss: 0.0396069 Test Loss: 0.1273372
Validation loss decreased (0.041944 --> 0.039607).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1656714
	speed: 0.0648s/iter; left time: 621.3687s
	iters: 200, epoch: 4 | loss: 0.2545159
	speed: 0.0230s/iter; left time: 218.1308s
	iters: 300, epoch: 4 | loss: 0.1575152
	speed: 0.0229s/iter; left time: 215.4886s
	iters: 400, epoch: 4 | loss: 0.2221324
	speed: 0.0230s/iter; left time: 213.3496s
	iters: 500, epoch: 4 | loss: 0.1878295
	speed: 0.0209s/iter; left time: 192.0950s
Epoch: 4 cost time: 12.948394060134888
Epoch: 4, Steps: 570 | Train Loss: 0.1863799 Vali Loss: 0.0398135 Test Loss: 0.1269938
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1734541
	speed: 0.0610s/iter; left time: 550.1422s
	iters: 200, epoch: 5 | loss: 0.2485990
	speed: 0.0204s/iter; left time: 181.7275s
	iters: 300, epoch: 5 | loss: 0.1727182
	speed: 0.0212s/iter; left time: 187.3199s
	iters: 400, epoch: 5 | loss: 0.1470349
	speed: 0.0220s/iter; left time: 192.1207s
	iters: 500, epoch: 5 | loss: 0.1756981
	speed: 0.0200s/iter; left time: 172.3314s
Epoch: 5 cost time: 12.225392818450928
Epoch: 5, Steps: 570 | Train Loss: 0.1796178 Vali Loss: 0.0387230 Test Loss: 0.1272207
Validation loss decreased (0.039607 --> 0.038723).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1768159
	speed: 0.0581s/iter; left time: 491.2275s
	iters: 200, epoch: 6 | loss: 0.1472081
	speed: 0.0198s/iter; left time: 165.7020s
	iters: 300, epoch: 6 | loss: 0.1713522
	speed: 0.0198s/iter; left time: 163.6921s
	iters: 400, epoch: 6 | loss: 0.1129469
	speed: 0.0198s/iter; left time: 161.5805s
	iters: 500, epoch: 6 | loss: 0.2678102
	speed: 0.0199s/iter; left time: 159.8742s
Epoch: 6 cost time: 11.583188772201538
Epoch: 6, Steps: 570 | Train Loss: 0.1776207 Vali Loss: 0.0390767 Test Loss: 0.1293675
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2058645
	speed: 0.0617s/iter; left time: 486.1854s
	iters: 200, epoch: 7 | loss: 0.1810497
	speed: 0.0213s/iter; left time: 165.8700s
	iters: 300, epoch: 7 | loss: 0.1893235
	speed: 0.0219s/iter; left time: 168.5243s
	iters: 400, epoch: 7 | loss: 0.2266811
	speed: 0.0230s/iter; left time: 174.6937s
	iters: 500, epoch: 7 | loss: 0.1698355
	speed: 0.0230s/iter; left time: 172.4253s
Epoch: 7 cost time: 13.022634744644165
Epoch: 7, Steps: 570 | Train Loss: 0.1768092 Vali Loss: 0.0387138 Test Loss: 0.1274758
Validation loss decreased (0.038723 --> 0.038714).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2392374
	speed: 0.0632s/iter; left time: 461.8826s
	iters: 200, epoch: 8 | loss: 0.2337250
	speed: 0.0199s/iter; left time: 143.7014s
	iters: 300, epoch: 8 | loss: 0.2391004
	speed: 0.0200s/iter; left time: 142.3846s
	iters: 400, epoch: 8 | loss: 0.1330205
	speed: 0.0200s/iter; left time: 140.4020s
	iters: 500, epoch: 8 | loss: 0.2021916
	speed: 0.0200s/iter; left time: 138.2925s
Epoch: 8 cost time: 11.725240230560303
Epoch: 8, Steps: 570 | Train Loss: 0.1765539 Vali Loss: 0.0386049 Test Loss: 0.1268884
Validation loss decreased (0.038714 --> 0.038605).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1904368
	speed: 0.0586s/iter; left time: 394.7895s
	iters: 200, epoch: 9 | loss: 0.1494017
	speed: 0.0200s/iter; left time: 132.6894s
	iters: 300, epoch: 9 | loss: 0.2322972
	speed: 0.0200s/iter; left time: 130.7882s
	iters: 400, epoch: 9 | loss: 0.1479488
	speed: 0.0200s/iter; left time: 128.6836s
	iters: 500, epoch: 9 | loss: 0.1129712
	speed: 0.0200s/iter; left time: 126.5556s
Epoch: 9 cost time: 11.658643007278442
Epoch: 9, Steps: 570 | Train Loss: 0.1745968 Vali Loss: 0.0385792 Test Loss: 0.1276252
Validation loss decreased (0.038605 --> 0.038579).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1764053
	speed: 0.0604s/iter; left time: 372.7587s
	iters: 200, epoch: 10 | loss: 0.1534876
	speed: 0.0215s/iter; left time: 130.6396s
	iters: 300, epoch: 10 | loss: 0.3034867
	speed: 0.0200s/iter; left time: 119.6566s
	iters: 400, epoch: 10 | loss: 0.2467632
	speed: 0.0200s/iter; left time: 117.5568s
	iters: 500, epoch: 10 | loss: 0.1878047
	speed: 0.0201s/iter; left time: 115.8084s
Epoch: 10 cost time: 12.06223201751709
Epoch: 10, Steps: 570 | Train Loss: 0.1744173 Vali Loss: 0.0386826 Test Loss: 0.1275730
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1374457
	speed: 0.0582s/iter; left time: 326.0025s
	iters: 200, epoch: 11 | loss: 0.1624886
	speed: 0.0200s/iter; left time: 109.9941s
	iters: 300, epoch: 11 | loss: 0.1624458
	speed: 0.0200s/iter; left time: 108.1079s
	iters: 400, epoch: 11 | loss: 0.2163287
	speed: 0.0200s/iter; left time: 105.8623s
	iters: 500, epoch: 11 | loss: 0.1216269
	speed: 0.0200s/iter; left time: 103.9419s
Epoch: 11 cost time: 11.703371047973633
Epoch: 11, Steps: 570 | Train Loss: 0.1753632 Vali Loss: 0.0387320 Test Loss: 0.1275573
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1695462
	speed: 0.0565s/iter; left time: 284.3626s
	iters: 200, epoch: 12 | loss: 0.1820231
	speed: 0.0199s/iter; left time: 98.1231s
	iters: 300, epoch: 12 | loss: 0.2369647
	speed: 0.0199s/iter; left time: 96.0185s
	iters: 400, epoch: 12 | loss: 0.1572500
	speed: 0.0200s/iter; left time: 94.4550s
	iters: 500, epoch: 12 | loss: 0.2620138
	speed: 0.0199s/iter; left time: 92.0056s
Epoch: 12 cost time: 11.608083963394165
Epoch: 12, Steps: 570 | Train Loss: 0.1741968 Vali Loss: 0.0386342 Test Loss: 0.1275396
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_S_TimeXer_custom_ftS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-S_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: []
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1277373731136322, mae:0.2235722690820694
