===== SWEEP for MS_Raw =====
>>> MS_Raw LR=1e-3 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1668184
	speed: 0.0230s/iter; left time: 259.6982s
	iters: 200, epoch: 1 | loss: 0.1968358
	speed: 0.0113s/iter; left time: 126.6258s
	iters: 300, epoch: 1 | loss: 0.1832968
	speed: 0.0100s/iter; left time: 110.5755s
	iters: 400, epoch: 1 | loss: 0.1859085
	speed: 0.0098s/iter; left time: 108.1500s
	iters: 500, epoch: 1 | loss: 0.2158217
	speed: 0.0098s/iter; left time: 107.3504s
Epoch: 1 cost time: 7.133281230926514
Epoch: 1, Steps: 570 | Train Loss: 0.2083975 Vali Loss: 0.0515174 Test Loss: 0.1629780
Validation loss decreased (inf --> 0.051517).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3291485
	speed: 0.0352s/iter; left time: 377.3228s
	iters: 200, epoch: 2 | loss: 0.2241254
	speed: 0.0099s/iter; left time: 105.2440s
	iters: 300, epoch: 2 | loss: 0.1987359
	speed: 0.0099s/iter; left time: 104.1771s
	iters: 400, epoch: 2 | loss: 0.2423836
	speed: 0.0099s/iter; left time: 103.1364s
	iters: 500, epoch: 2 | loss: 0.2867766
	speed: 0.0104s/iter; left time: 107.4192s
Epoch: 2 cost time: 6.073883771896362
Epoch: 2, Steps: 570 | Train Loss: 0.2576519 Vali Loss: 0.0684576 Test Loss: 0.1809007
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1952623
	speed: 0.0381s/iter; left time: 387.6290s
	iters: 200, epoch: 3 | loss: 0.2611968
	speed: 0.0114s/iter; left time: 114.6436s
	iters: 300, epoch: 3 | loss: 0.1721100
	speed: 0.0114s/iter; left time: 113.6240s
	iters: 400, epoch: 3 | loss: 0.2667773
	speed: 0.0114s/iter; left time: 112.2341s
	iters: 500, epoch: 3 | loss: 0.3224335
	speed: 0.0114s/iter; left time: 111.1873s
Epoch: 3 cost time: 6.7784082889556885
Epoch: 3, Steps: 570 | Train Loss: 0.2467329 Vali Loss: 0.0648856 Test Loss: 0.1647076
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3145069
	speed: 0.0379s/iter; left time: 363.2120s
	iters: 200, epoch: 4 | loss: 0.1908078
	speed: 0.0114s/iter; left time: 108.5692s
	iters: 300, epoch: 4 | loss: 0.2720823
	speed: 0.0105s/iter; left time: 98.2494s
	iters: 400, epoch: 4 | loss: 0.2160956
	speed: 0.0100s/iter; left time: 93.2580s
	iters: 500, epoch: 4 | loss: 0.2266363
	speed: 0.0100s/iter; left time: 92.1318s
Epoch: 4 cost time: 6.332274675369263
Epoch: 4, Steps: 570 | Train Loss: 0.2179058 Vali Loss: 0.0635907 Test Loss: 0.1608318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1631806194782257, mae:0.26068833470344543
>>> MS_Raw LR=1e-3 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1879944
	speed: 0.0228s/iter; left time: 257.4700s
	iters: 200, epoch: 1 | loss: 0.1874471
	speed: 0.0098s/iter; left time: 110.3245s
	iters: 300, epoch: 1 | loss: 0.2482666
	speed: 0.0098s/iter; left time: 108.4744s
	iters: 400, epoch: 1 | loss: 0.1488428
	speed: 0.0097s/iter; left time: 107.1423s
	iters: 500, epoch: 1 | loss: 0.1444412
	speed: 0.0098s/iter; left time: 106.5112s
Epoch: 1 cost time: 6.921605110168457
Epoch: 1, Steps: 570 | Train Loss: 0.1682830 Vali Loss: 0.0436042 Test Loss: 0.1377011
Validation loss decreased (inf --> 0.043604).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1398871
	speed: 0.0350s/iter; left time: 375.0533s
	iters: 200, epoch: 2 | loss: 0.1850255
	speed: 0.0112s/iter; left time: 118.6908s
	iters: 300, epoch: 2 | loss: 0.1077379
	speed: 0.0111s/iter; left time: 117.0576s
	iters: 400, epoch: 2 | loss: 0.1096446
	speed: 0.0111s/iter; left time: 116.0082s
	iters: 500, epoch: 2 | loss: 0.2028266
	speed: 0.0111s/iter; left time: 114.7325s
Epoch: 2 cost time: 6.509740352630615
Epoch: 2, Steps: 570 | Train Loss: 0.1612543 Vali Loss: 0.0431032 Test Loss: 0.1407291
Validation loss decreased (0.043604 --> 0.043103).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0767745
	speed: 0.0383s/iter; left time: 389.1412s
	iters: 200, epoch: 3 | loss: 0.1207427
	speed: 0.0111s/iter; left time: 111.3309s
	iters: 300, epoch: 3 | loss: 0.2777740
	speed: 0.0097s/iter; left time: 96.8752s
	iters: 400, epoch: 3 | loss: 0.1337653
	speed: 0.0097s/iter; left time: 95.4589s
	iters: 500, epoch: 3 | loss: 0.1266848
	speed: 0.0096s/iter; left time: 94.1094s
Epoch: 3 cost time: 6.086637258529663
Epoch: 3, Steps: 570 | Train Loss: 0.1380364 Vali Loss: 0.0397742 Test Loss: 0.1264060
Validation loss decreased (0.043103 --> 0.039774).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0792852
	speed: 0.0371s/iter; left time: 355.9884s
	iters: 200, epoch: 4 | loss: 0.0799794
	speed: 0.0109s/iter; left time: 103.0189s
	iters: 300, epoch: 4 | loss: 0.0885246
	speed: 0.0109s/iter; left time: 102.5997s
	iters: 400, epoch: 4 | loss: 0.0728028
	speed: 0.0109s/iter; left time: 101.0001s
	iters: 500, epoch: 4 | loss: 0.1350426
	speed: 0.0108s/iter; left time: 99.6146s
Epoch: 4 cost time: 6.401651620864868
Epoch: 4, Steps: 570 | Train Loss: 0.1146851 Vali Loss: 0.0357869 Test Loss: 0.1162586
Validation loss decreased (0.039774 --> 0.035787).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1119463
	speed: 0.0349s/iter; left time: 314.4799s
	iters: 200, epoch: 5 | loss: 0.1653396
	speed: 0.0097s/iter; left time: 86.3332s
	iters: 300, epoch: 5 | loss: 0.1019746
	speed: 0.0097s/iter; left time: 85.2522s
	iters: 400, epoch: 5 | loss: 0.1152093
	speed: 0.0097s/iter; left time: 84.1876s
	iters: 500, epoch: 5 | loss: 0.0985917
	speed: 0.0096s/iter; left time: 83.1863s
Epoch: 5 cost time: 5.80197548866272
Epoch: 5, Steps: 570 | Train Loss: 0.1009639 Vali Loss: 0.0364314 Test Loss: 0.1136684
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0581600
	speed: 0.0367s/iter; left time: 309.9519s
	iters: 200, epoch: 6 | loss: 0.1095032
	speed: 0.0096s/iter; left time: 80.3831s
	iters: 300, epoch: 6 | loss: 0.1278585
	speed: 0.0096s/iter; left time: 79.3575s
	iters: 400, epoch: 6 | loss: 0.0641890
	speed: 0.0096s/iter; left time: 78.4301s
	iters: 500, epoch: 6 | loss: 0.0766375
	speed: 0.0096s/iter; left time: 77.4564s
Epoch: 6 cost time: 5.767342567443848
Epoch: 6, Steps: 570 | Train Loss: 0.0925622 Vali Loss: 0.0370014 Test Loss: 0.1155212
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0849662
	speed: 0.0348s/iter; left time: 274.0468s
	iters: 200, epoch: 7 | loss: 0.0992069
	speed: 0.0096s/iter; left time: 75.0797s
	iters: 300, epoch: 7 | loss: 0.1484343
	speed: 0.0096s/iter; left time: 74.1018s
	iters: 400, epoch: 7 | loss: 0.1500152
	speed: 0.0096s/iter; left time: 73.1284s
	iters: 500, epoch: 7 | loss: 0.1286581
	speed: 0.0096s/iter; left time: 72.1327s
Epoch: 7 cost time: 5.78197169303894
Epoch: 7, Steps: 570 | Train Loss: 0.0875537 Vali Loss: 0.0360128 Test Loss: 0.1157063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11642131209373474, mae:0.20923534035682678
>>> MS_Raw LR=1e-3 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2429955
	speed: 0.0211s/iter; left time: 238.7878s
	iters: 200, epoch: 1 | loss: 0.1262257
	speed: 0.0097s/iter; left time: 108.2401s
	iters: 300, epoch: 1 | loss: 0.1267452
	speed: 0.0097s/iter; left time: 107.4955s
	iters: 400, epoch: 1 | loss: 0.1871254
	speed: 0.0097s/iter; left time: 106.2814s
	iters: 500, epoch: 1 | loss: 0.2177178
	speed: 0.0097s/iter; left time: 105.4102s
Epoch: 1 cost time: 6.711023569107056
Epoch: 1, Steps: 570 | Train Loss: 0.2265803 Vali Loss: 0.0527771 Test Loss: 0.1677906
Validation loss decreased (inf --> 0.052777).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1989672
	speed: 0.0350s/iter; left time: 375.2230s
	iters: 200, epoch: 2 | loss: 0.2996998
	speed: 0.0097s/iter; left time: 102.7132s
	iters: 300, epoch: 2 | loss: 0.1947185
	speed: 0.0096s/iter; left time: 101.5227s
	iters: 400, epoch: 2 | loss: 0.2522361
	speed: 0.0097s/iter; left time: 100.9026s
	iters: 500, epoch: 2 | loss: 0.2612756
	speed: 0.0096s/iter; left time: 99.6402s
Epoch: 2 cost time: 5.815845251083374
Epoch: 2, Steps: 570 | Train Loss: 0.2259816 Vali Loss: 0.0574514 Test Loss: 0.1699410
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1365477
	speed: 0.0351s/iter; left time: 357.0109s
	iters: 200, epoch: 3 | loss: 0.1770229
	speed: 0.0098s/iter; left time: 98.6694s
	iters: 300, epoch: 3 | loss: 0.2543505
	speed: 0.0098s/iter; left time: 97.5719s
	iters: 400, epoch: 3 | loss: 0.1783216
	speed: 0.0098s/iter; left time: 96.3963s
	iters: 500, epoch: 3 | loss: 0.1370625
	speed: 0.0098s/iter; left time: 95.3331s
Epoch: 3 cost time: 5.867055177688599
Epoch: 3, Steps: 570 | Train Loss: 0.2107144 Vali Loss: 0.0469428 Test Loss: 0.1451066
Validation loss decreased (0.052777 --> 0.046943).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1333973
	speed: 0.0363s/iter; left time: 348.4791s
	iters: 200, epoch: 4 | loss: 0.0943953
	speed: 0.0098s/iter; left time: 92.8547s
	iters: 300, epoch: 4 | loss: 0.1297451
	speed: 0.0098s/iter; left time: 92.1161s
	iters: 400, epoch: 4 | loss: 0.2211343
	speed: 0.0098s/iter; left time: 90.8555s
	iters: 500, epoch: 4 | loss: 0.1433680
	speed: 0.0098s/iter; left time: 89.8557s
Epoch: 4 cost time: 5.865715265274048
Epoch: 4, Steps: 570 | Train Loss: 0.1749125 Vali Loss: 0.0473251 Test Loss: 0.1498124
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1313210
	speed: 0.0357s/iter; left time: 321.9899s
	iters: 200, epoch: 5 | loss: 0.1570131
	speed: 0.0107s/iter; left time: 95.1932s
	iters: 300, epoch: 5 | loss: 0.2370802
	speed: 0.0098s/iter; left time: 86.8153s
	iters: 400, epoch: 5 | loss: 0.1019689
	speed: 0.0098s/iter; left time: 85.2888s
	iters: 500, epoch: 5 | loss: 0.2425003
	speed: 0.0097s/iter; left time: 83.9529s
Epoch: 5 cost time: 6.074777364730835
Epoch: 5, Steps: 570 | Train Loss: 0.1612860 Vali Loss: 0.0438437 Test Loss: 0.1477919
Validation loss decreased (0.046943 --> 0.043844).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1151529
	speed: 0.0365s/iter; left time: 308.8255s
	iters: 200, epoch: 6 | loss: 0.1784842
	speed: 0.0097s/iter; left time: 81.2175s
	iters: 300, epoch: 6 | loss: 0.1698503
	speed: 0.0098s/iter; left time: 80.5249s
	iters: 400, epoch: 6 | loss: 0.1325180
	speed: 0.0098s/iter; left time: 79.5872s
	iters: 500, epoch: 6 | loss: 0.1904864
	speed: 0.0098s/iter; left time: 78.6121s
Epoch: 6 cost time: 5.809621810913086
Epoch: 6, Steps: 570 | Train Loss: 0.1502975 Vali Loss: 0.0432721 Test Loss: 0.1421744
Validation loss decreased (0.043844 --> 0.043272).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0912671
	speed: 0.0344s/iter; left time: 271.3731s
	iters: 200, epoch: 7 | loss: 0.1507141
	speed: 0.0098s/iter; left time: 75.9292s
	iters: 300, epoch: 7 | loss: 0.1111932
	speed: 0.0098s/iter; left time: 75.0159s
	iters: 400, epoch: 7 | loss: 0.0750316
	speed: 0.0098s/iter; left time: 74.0027s
	iters: 500, epoch: 7 | loss: 0.1784825
	speed: 0.0098s/iter; left time: 72.9800s
Epoch: 7 cost time: 5.849860906600952
Epoch: 7, Steps: 570 | Train Loss: 0.1443310 Vali Loss: 0.0433332 Test Loss: 0.1409613
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0878188
	speed: 0.0346s/iter; left time: 253.1096s
	iters: 200, epoch: 8 | loss: 0.1318479
	speed: 0.0098s/iter; left time: 70.5196s
	iters: 300, epoch: 8 | loss: 0.1270279
	speed: 0.0097s/iter; left time: 69.0433s
	iters: 400, epoch: 8 | loss: 0.1578188
	speed: 0.0097s/iter; left time: 68.1320s
	iters: 500, epoch: 8 | loss: 0.1500511
	speed: 0.0098s/iter; left time: 67.4058s
Epoch: 8 cost time: 5.835051774978638
Epoch: 8, Steps: 570 | Train Loss: 0.1401656 Vali Loss: 0.0427601 Test Loss: 0.1404220
Validation loss decreased (0.043272 --> 0.042760).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1381372
	speed: 0.0374s/iter; left time: 252.3912s
	iters: 200, epoch: 9 | loss: 0.1403579
	speed: 0.0098s/iter; left time: 65.2818s
	iters: 300, epoch: 9 | loss: 0.1187568
	speed: 0.0099s/iter; left time: 64.4831s
	iters: 400, epoch: 9 | loss: 0.0885384
	speed: 0.0099s/iter; left time: 63.4570s
	iters: 500, epoch: 9 | loss: 0.1417777
	speed: 0.0098s/iter; left time: 62.3891s
Epoch: 9 cost time: 5.913389205932617
Epoch: 9, Steps: 570 | Train Loss: 0.1382025 Vali Loss: 0.0433924 Test Loss: 0.1427714
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1171558
	speed: 0.0359s/iter; left time: 221.6164s
	iters: 200, epoch: 10 | loss: 0.1783067
	speed: 0.0110s/iter; left time: 66.7486s
	iters: 300, epoch: 10 | loss: 0.1544783
	speed: 0.0106s/iter; left time: 63.3594s
	iters: 400, epoch: 10 | loss: 0.1501161
	speed: 0.0098s/iter; left time: 57.3143s
	iters: 500, epoch: 10 | loss: 0.1953642
	speed: 0.0097s/iter; left time: 56.1724s
Epoch: 10 cost time: 6.151362657546997
Epoch: 10, Steps: 570 | Train Loss: 0.1372004 Vali Loss: 0.0433279 Test Loss: 0.1432870
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1529302
	speed: 0.0346s/iter; left time: 194.0437s
	iters: 200, epoch: 11 | loss: 0.1255644
	speed: 0.0098s/iter; left time: 53.8676s
	iters: 300, epoch: 11 | loss: 0.1809491
	speed: 0.0098s/iter; left time: 52.9118s
	iters: 400, epoch: 11 | loss: 0.1512925
	speed: 0.0098s/iter; left time: 51.7720s
	iters: 500, epoch: 11 | loss: 0.1629266
	speed: 0.0098s/iter; left time: 50.7855s
Epoch: 11 cost time: 5.8521106243133545
Epoch: 11, Steps: 570 | Train Loss: 0.1363042 Vali Loss: 0.0431477 Test Loss: 0.1432028
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1405969113111496, mae:0.24108478426933289
>>> MS_Raw LR=1e-3 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2673554
	speed: 0.0231s/iter; left time: 260.9081s
	iters: 200, epoch: 1 | loss: 0.2358598
	speed: 0.0113s/iter; left time: 126.9466s
	iters: 300, epoch: 1 | loss: 0.1605896
	speed: 0.0113s/iter; left time: 125.8491s
	iters: 400, epoch: 1 | loss: 0.2092649
	speed: 0.0113s/iter; left time: 124.6000s
	iters: 500, epoch: 1 | loss: 0.3037598
	speed: 0.0113s/iter; left time: 123.5120s
Epoch: 1 cost time: 7.6832427978515625
Epoch: 1, Steps: 570 | Train Loss: 0.2843307 Vali Loss: 0.0668196 Test Loss: 0.1870127
Validation loss decreased (inf --> 0.066820).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2432782
	speed: 0.0385s/iter; left time: 413.4575s
	iters: 200, epoch: 2 | loss: 0.1925197
	speed: 0.0115s/iter; left time: 121.9960s
	iters: 300, epoch: 2 | loss: 0.1782432
	speed: 0.0115s/iter; left time: 120.9042s
	iters: 400, epoch: 2 | loss: 0.1232579
	speed: 0.0115s/iter; left time: 119.9019s
	iters: 500, epoch: 2 | loss: 0.2400337
	speed: 0.0115s/iter; left time: 118.7267s
Epoch: 2 cost time: 6.860767126083374
Epoch: 2, Steps: 570 | Train Loss: 0.2810881 Vali Loss: 0.0608437 Test Loss: 0.1798609
Validation loss decreased (0.066820 --> 0.060844).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3295406
	speed: 0.0390s/iter; left time: 396.0591s
	iters: 200, epoch: 3 | loss: 0.4188828
	speed: 0.0114s/iter; left time: 114.3658s
	iters: 300, epoch: 3 | loss: 0.1578331
	speed: 0.0114s/iter; left time: 113.5112s
	iters: 400, epoch: 3 | loss: 0.2161615
	speed: 0.0114s/iter; left time: 112.1058s
	iters: 500, epoch: 3 | loss: 0.2143182
	speed: 0.0114s/iter; left time: 111.1058s
Epoch: 3 cost time: 6.7772581577301025
Epoch: 3, Steps: 570 | Train Loss: 0.2520068 Vali Loss: 0.0636789 Test Loss: 0.1797697
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1728122
	speed: 0.0384s/iter; left time: 368.3650s
	iters: 200, epoch: 4 | loss: 0.2393166
	speed: 0.0115s/iter; left time: 108.8164s
	iters: 300, epoch: 4 | loss: 0.1626475
	speed: 0.0114s/iter; left time: 107.4029s
	iters: 400, epoch: 4 | loss: 0.1333545
	speed: 0.0115s/iter; left time: 106.4449s
	iters: 500, epoch: 4 | loss: 0.1654302
	speed: 0.0114s/iter; left time: 105.2311s
Epoch: 4 cost time: 6.777161121368408
Epoch: 4, Steps: 570 | Train Loss: 0.2222100 Vali Loss: 0.0608348 Test Loss: 0.1682695
Validation loss decreased (0.060844 --> 0.060835).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1581249
	speed: 0.0380s/iter; left time: 342.9863s
	iters: 200, epoch: 5 | loss: 0.1555440
	speed: 0.0114s/iter; left time: 101.7823s
	iters: 300, epoch: 5 | loss: 0.2902546
	speed: 0.0114s/iter; left time: 100.7312s
	iters: 400, epoch: 5 | loss: 0.1749023
	speed: 0.0114s/iter; left time: 99.4496s
	iters: 500, epoch: 5 | loss: 0.2035597
	speed: 0.0114s/iter; left time: 98.4895s
Epoch: 5 cost time: 6.806787490844727
Epoch: 5, Steps: 570 | Train Loss: 0.2089508 Vali Loss: 0.0620068 Test Loss: 0.1694303
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1826471
	speed: 0.0371s/iter; left time: 313.7642s
	iters: 200, epoch: 6 | loss: 0.1136283
	speed: 0.0114s/iter; left time: 95.2655s
	iters: 300, epoch: 6 | loss: 0.2019654
	speed: 0.0114s/iter; left time: 94.0481s
	iters: 400, epoch: 6 | loss: 0.1772547
	speed: 0.0114s/iter; left time: 92.8443s
	iters: 500, epoch: 6 | loss: 0.1489908
	speed: 0.0114s/iter; left time: 91.5670s
Epoch: 6 cost time: 6.756057024002075
Epoch: 6, Steps: 570 | Train Loss: 0.2033361 Vali Loss: 0.0616341 Test Loss: 0.1669102
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2622835
	speed: 0.0368s/iter; left time: 290.3404s
	iters: 200, epoch: 7 | loss: 0.2151243
	speed: 0.0114s/iter; left time: 88.5280s
	iters: 300, epoch: 7 | loss: 0.2167960
	speed: 0.0114s/iter; left time: 87.2609s
	iters: 400, epoch: 7 | loss: 0.1562091
	speed: 0.0114s/iter; left time: 86.0741s
	iters: 500, epoch: 7 | loss: 0.2143835
	speed: 0.0113s/iter; left time: 84.8418s
Epoch: 7 cost time: 6.734003305435181
Epoch: 7, Steps: 570 | Train Loss: 0.1996851 Vali Loss: 0.0609210 Test Loss: 0.1667071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1685466766357422, mae:0.27037519216537476
>>> MS_Raw LR=1e-3 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1208526
	speed: 0.0231s/iter; left time: 260.8962s
	iters: 200, epoch: 1 | loss: 0.2859458
	speed: 0.0110s/iter; left time: 123.6992s
	iters: 300, epoch: 1 | loss: 0.1719414
	speed: 0.0111s/iter; left time: 122.7663s
	iters: 400, epoch: 1 | loss: 0.2156864
	speed: 0.0110s/iter; left time: 121.4207s
	iters: 500, epoch: 1 | loss: 0.1559027
	speed: 0.0110s/iter; left time: 120.4289s
Epoch: 1 cost time: 7.547462701797485
Epoch: 1, Steps: 570 | Train Loss: 0.2086973 Vali Loss: 0.0515904 Test Loss: 0.1532065
Validation loss decreased (inf --> 0.051590).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2164857
	speed: 0.0414s/iter; left time: 444.3556s
	iters: 200, epoch: 2 | loss: 0.1621193
	speed: 0.0118s/iter; left time: 125.1196s
	iters: 300, epoch: 2 | loss: 0.2461625
	speed: 0.0111s/iter; left time: 116.6412s
	iters: 400, epoch: 2 | loss: 0.3248372
	speed: 0.0111s/iter; left time: 115.4710s
	iters: 500, epoch: 2 | loss: 0.3872446
	speed: 0.0111s/iter; left time: 114.3336s
Epoch: 2 cost time: 6.790144681930542
Epoch: 2, Steps: 570 | Train Loss: 0.2381216 Vali Loss: 0.0526147 Test Loss: 0.1589930
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2298876
	speed: 0.0375s/iter; left time: 380.7479s
	iters: 200, epoch: 3 | loss: 0.0892347
	speed: 0.0111s/iter; left time: 111.7275s
	iters: 300, epoch: 3 | loss: 0.2041319
	speed: 0.0111s/iter; left time: 110.5515s
	iters: 400, epoch: 3 | loss: 0.2050402
	speed: 0.0111s/iter; left time: 109.3919s
	iters: 500, epoch: 3 | loss: 0.2003963
	speed: 0.0111s/iter; left time: 107.9656s
Epoch: 3 cost time: 6.649464845657349
Epoch: 3, Steps: 570 | Train Loss: 0.1838980 Vali Loss: 0.0454281 Test Loss: 0.1411109
Validation loss decreased (0.051590 --> 0.045428).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1862133
	speed: 0.0375s/iter; left time: 359.4266s
	iters: 200, epoch: 4 | loss: 0.1526703
	speed: 0.0111s/iter; left time: 105.0642s
	iters: 300, epoch: 4 | loss: 0.0859537
	speed: 0.0111s/iter; left time: 103.9664s
	iters: 400, epoch: 4 | loss: 0.1531971
	speed: 0.0111s/iter; left time: 102.8837s
	iters: 500, epoch: 4 | loss: 0.1257672
	speed: 0.0111s/iter; left time: 101.7677s
Epoch: 4 cost time: 6.601027965545654
Epoch: 4, Steps: 570 | Train Loss: 0.1588286 Vali Loss: 0.0467338 Test Loss: 0.1424807
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1165126
	speed: 0.0367s/iter; left time: 331.1811s
	iters: 200, epoch: 5 | loss: 0.1202716
	speed: 0.0111s/iter; left time: 99.0521s
	iters: 300, epoch: 5 | loss: 0.1846251
	speed: 0.0110s/iter; left time: 97.4163s
	iters: 400, epoch: 5 | loss: 0.1324604
	speed: 0.0111s/iter; left time: 96.3998s
	iters: 500, epoch: 5 | loss: 0.1090243
	speed: 0.0110s/iter; left time: 95.2411s
Epoch: 5 cost time: 6.602887868881226
Epoch: 5, Steps: 570 | Train Loss: 0.1417700 Vali Loss: 0.0407827 Test Loss: 0.1379961
Validation loss decreased (0.045428 --> 0.040783).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1700202
	speed: 0.0381s/iter; left time: 322.1251s
	iters: 200, epoch: 6 | loss: 0.1496533
	speed: 0.0111s/iter; left time: 92.6404s
	iters: 300, epoch: 6 | loss: 0.0920784
	speed: 0.0111s/iter; left time: 91.6117s
	iters: 400, epoch: 6 | loss: 0.0841550
	speed: 0.0111s/iter; left time: 90.5172s
	iters: 500, epoch: 6 | loss: 0.1100778
	speed: 0.0111s/iter; left time: 89.4349s
Epoch: 6 cost time: 6.651402473449707
Epoch: 6, Steps: 570 | Train Loss: 0.1324151 Vali Loss: 0.0401964 Test Loss: 0.1361016
Validation loss decreased (0.040783 --> 0.040196).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0873016
	speed: 0.0392s/iter; left time: 308.5459s
	iters: 200, epoch: 7 | loss: 0.1881062
	speed: 0.0111s/iter; left time: 86.1949s
	iters: 300, epoch: 7 | loss: 0.1087534
	speed: 0.0111s/iter; left time: 85.0765s
	iters: 400, epoch: 7 | loss: 0.1095457
	speed: 0.0111s/iter; left time: 83.9874s
	iters: 500, epoch: 7 | loss: 0.0909741
	speed: 0.0111s/iter; left time: 82.8423s
Epoch: 7 cost time: 6.63675332069397
Epoch: 7, Steps: 570 | Train Loss: 0.1267670 Vali Loss: 0.0402969 Test Loss: 0.1349403
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1074128
	speed: 0.0366s/iter; left time: 267.5675s
	iters: 200, epoch: 8 | loss: 0.1466217
	speed: 0.0111s/iter; left time: 79.7400s
	iters: 300, epoch: 8 | loss: 0.1092096
	speed: 0.0111s/iter; left time: 78.6206s
	iters: 400, epoch: 8 | loss: 0.0924052
	speed: 0.0111s/iter; left time: 77.5092s
	iters: 500, epoch: 8 | loss: 0.1204413
	speed: 0.0111s/iter; left time: 76.4908s
Epoch: 8 cost time: 6.594736576080322
Epoch: 8, Steps: 570 | Train Loss: 0.1230836 Vali Loss: 0.0399046 Test Loss: 0.1353944
Validation loss decreased (0.040196 --> 0.039905).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1407759
	speed: 0.0390s/iter; left time: 262.8073s
	iters: 200, epoch: 9 | loss: 0.0852659
	speed: 0.0121s/iter; left time: 80.2030s
	iters: 300, epoch: 9 | loss: 0.1555552
	speed: 0.0121s/iter; left time: 78.9706s
	iters: 400, epoch: 9 | loss: 0.1433156
	speed: 0.0121s/iter; left time: 77.7858s
	iters: 500, epoch: 9 | loss: 0.1607147
	speed: 0.0114s/iter; left time: 72.1926s
Epoch: 9 cost time: 7.0693747997283936
Epoch: 9, Steps: 570 | Train Loss: 0.1213381 Vali Loss: 0.0391797 Test Loss: 0.1352211
Validation loss decreased (0.039905 --> 0.039180).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1191340
	speed: 0.0380s/iter; left time: 234.4789s
	iters: 200, epoch: 10 | loss: 0.0910964
	speed: 0.0111s/iter; left time: 67.3509s
	iters: 300, epoch: 10 | loss: 0.1056505
	speed: 0.0111s/iter; left time: 66.2361s
	iters: 400, epoch: 10 | loss: 0.1334907
	speed: 0.0111s/iter; left time: 65.1045s
	iters: 500, epoch: 10 | loss: 0.1398455
	speed: 0.0111s/iter; left time: 64.0924s
Epoch: 10 cost time: 6.62571382522583
Epoch: 10, Steps: 570 | Train Loss: 0.1202429 Vali Loss: 0.0395060 Test Loss: 0.1355136
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0820738
	speed: 0.0375s/iter; left time: 210.2093s
	iters: 200, epoch: 11 | loss: 0.0953467
	speed: 0.0111s/iter; left time: 60.8948s
	iters: 300, epoch: 11 | loss: 0.1034635
	speed: 0.0111s/iter; left time: 59.7101s
	iters: 400, epoch: 11 | loss: 0.1124705
	speed: 0.0111s/iter; left time: 58.7125s
	iters: 500, epoch: 11 | loss: 0.1682471
	speed: 0.0111s/iter; left time: 57.5840s
Epoch: 11 cost time: 6.652884006500244
Epoch: 11, Steps: 570 | Train Loss: 0.1195659 Vali Loss: 0.0396204 Test Loss: 0.1359874
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1432239
	speed: 0.0378s/iter; left time: 190.3660s
	iters: 200, epoch: 12 | loss: 0.0984666
	speed: 0.0111s/iter; left time: 54.4924s
	iters: 300, epoch: 12 | loss: 0.0857073
	speed: 0.0110s/iter; left time: 53.3743s
	iters: 400, epoch: 12 | loss: 0.1472204
	speed: 0.0110s/iter; left time: 52.2754s
	iters: 500, epoch: 12 | loss: 0.1346401
	speed: 0.0110s/iter; left time: 51.1234s
Epoch: 12 cost time: 6.590363502502441
Epoch: 12, Steps: 570 | Train Loss: 0.1190357 Vali Loss: 0.0397651 Test Loss: 0.1360321
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13543544709682465, mae:0.23163580894470215
>>> MS_Raw LR=1e-3 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2081373
	speed: 0.0228s/iter; left time: 257.7631s
	iters: 200, epoch: 1 | loss: 0.3531043
	speed: 0.0104s/iter; left time: 116.1085s
	iters: 300, epoch: 1 | loss: 0.3283095
	speed: 0.0113s/iter; left time: 125.6135s
	iters: 400, epoch: 1 | loss: 0.2961910
	speed: 0.0113s/iter; left time: 124.6849s
	iters: 500, epoch: 1 | loss: 0.2852784
	speed: 0.0114s/iter; left time: 123.8908s
Epoch: 1 cost time: 7.562789678573608
Epoch: 1, Steps: 570 | Train Loss: 0.2701385 Vali Loss: 0.0734769 Test Loss: 0.2123958
Validation loss decreased (inf --> 0.073477).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2973227
	speed: 0.0381s/iter; left time: 408.6803s
	iters: 200, epoch: 2 | loss: 0.2906811
	speed: 0.0103s/iter; left time: 109.3910s
	iters: 300, epoch: 2 | loss: 0.1953369
	speed: 0.0103s/iter; left time: 108.1225s
	iters: 400, epoch: 2 | loss: 0.2043611
	speed: 0.0103s/iter; left time: 107.0639s
	iters: 500, epoch: 2 | loss: 0.2483530
	speed: 0.0103s/iter; left time: 106.3313s
Epoch: 2 cost time: 6.1680402755737305
Epoch: 2, Steps: 570 | Train Loss: 0.2728299 Vali Loss: 0.0679701 Test Loss: 0.1997746
Validation loss decreased (0.073477 --> 0.067970).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1554442
	speed: 0.0381s/iter; left time: 387.4419s
	iters: 200, epoch: 3 | loss: 0.1863188
	speed: 0.0104s/iter; left time: 104.3944s
	iters: 300, epoch: 3 | loss: 0.2836081
	speed: 0.0104s/iter; left time: 103.2024s
	iters: 400, epoch: 3 | loss: 0.2544675
	speed: 0.0104s/iter; left time: 102.2446s
	iters: 500, epoch: 3 | loss: 0.2589924
	speed: 0.0103s/iter; left time: 100.6286s
Epoch: 3 cost time: 6.203661203384399
Epoch: 3, Steps: 570 | Train Loss: 0.2451306 Vali Loss: 0.0637612 Test Loss: 0.1744619
Validation loss decreased (0.067970 --> 0.063761).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2316469
	speed: 0.0361s/iter; left time: 346.4747s
	iters: 200, epoch: 4 | loss: 0.1120871
	speed: 0.0103s/iter; left time: 97.7234s
	iters: 300, epoch: 4 | loss: 0.2192818
	speed: 0.0103s/iter; left time: 96.6802s
	iters: 400, epoch: 4 | loss: 0.3106847
	speed: 0.0103s/iter; left time: 95.5892s
	iters: 500, epoch: 4 | loss: 0.2026028
	speed: 0.0103s/iter; left time: 94.3581s
Epoch: 4 cost time: 6.159931421279907
Epoch: 4, Steps: 570 | Train Loss: 0.2175378 Vali Loss: 0.0593487 Test Loss: 0.1607444
Validation loss decreased (0.063761 --> 0.059349).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1770361
	speed: 0.0376s/iter; left time: 338.9837s
	iters: 200, epoch: 5 | loss: 0.1810164
	speed: 0.0102s/iter; left time: 91.1785s
	iters: 300, epoch: 5 | loss: 0.2119149
	speed: 0.0102s/iter; left time: 90.0506s
	iters: 400, epoch: 5 | loss: 0.1309484
	speed: 0.0103s/iter; left time: 89.5577s
	iters: 500, epoch: 5 | loss: 0.2969440
	speed: 0.0102s/iter; left time: 88.2651s
Epoch: 5 cost time: 6.110923767089844
Epoch: 5, Steps: 570 | Train Loss: 0.1965188 Vali Loss: 0.0559909 Test Loss: 0.1539086
Validation loss decreased (0.059349 --> 0.055991).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1419153
	speed: 0.0359s/iter; left time: 303.5789s
	iters: 200, epoch: 6 | loss: 0.1659421
	speed: 0.0102s/iter; left time: 85.4723s
	iters: 300, epoch: 6 | loss: 0.2197290
	speed: 0.0102s/iter; left time: 84.4140s
	iters: 400, epoch: 6 | loss: 0.1411058
	speed: 0.0102s/iter; left time: 83.4618s
	iters: 500, epoch: 6 | loss: 0.1455500
	speed: 0.0102s/iter; left time: 82.5170s
Epoch: 6 cost time: 6.147005796432495
Epoch: 6, Steps: 570 | Train Loss: 0.1863750 Vali Loss: 0.0566236 Test Loss: 0.1557629
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1294671
	speed: 0.0376s/iter; left time: 296.3168s
	iters: 200, epoch: 7 | loss: 0.1749182
	speed: 0.0104s/iter; left time: 80.7183s
	iters: 300, epoch: 7 | loss: 0.1338294
	speed: 0.0103s/iter; left time: 79.2726s
	iters: 400, epoch: 7 | loss: 0.2332579
	speed: 0.0103s/iter; left time: 78.3166s
	iters: 500, epoch: 7 | loss: 0.1354468
	speed: 0.0103s/iter; left time: 77.4077s
Epoch: 7 cost time: 6.215693712234497
Epoch: 7, Steps: 570 | Train Loss: 0.1792891 Vali Loss: 0.0548309 Test Loss: 0.1546936
Validation loss decreased (0.055991 --> 0.054831).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1518206
	speed: 0.0369s/iter; left time: 269.6240s
	iters: 200, epoch: 8 | loss: 0.2262946
	speed: 0.0103s/iter; left time: 74.3962s
	iters: 300, epoch: 8 | loss: 0.2203848
	speed: 0.0103s/iter; left time: 73.4677s
	iters: 400, epoch: 8 | loss: 0.1756611
	speed: 0.0103s/iter; left time: 72.4633s
	iters: 500, epoch: 8 | loss: 0.1367280
	speed: 0.0104s/iter; left time: 71.5935s
Epoch: 8 cost time: 6.189295291900635
Epoch: 8, Steps: 570 | Train Loss: 0.1763261 Vali Loss: 0.0542998 Test Loss: 0.1541872
Validation loss decreased (0.054831 --> 0.054300).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1023468
	speed: 0.0366s/iter; left time: 246.9269s
	iters: 200, epoch: 9 | loss: 0.1155551
	speed: 0.0103s/iter; left time: 68.7130s
	iters: 300, epoch: 9 | loss: 0.2510663
	speed: 0.0104s/iter; left time: 67.7510s
	iters: 400, epoch: 9 | loss: 0.2702790
	speed: 0.0103s/iter; left time: 66.5532s
	iters: 500, epoch: 9 | loss: 0.0944196
	speed: 0.0103s/iter; left time: 65.4601s
Epoch: 9 cost time: 6.193512439727783
Epoch: 9, Steps: 570 | Train Loss: 0.1741916 Vali Loss: 0.0551400 Test Loss: 0.1549536
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2340378
	speed: 0.0352s/iter; left time: 217.1341s
	iters: 200, epoch: 10 | loss: 0.0925931
	speed: 0.0103s/iter; left time: 62.4565s
	iters: 300, epoch: 10 | loss: 0.1878417
	speed: 0.0103s/iter; left time: 61.4575s
	iters: 400, epoch: 10 | loss: 0.0969002
	speed: 0.0103s/iter; left time: 60.5964s
	iters: 500, epoch: 10 | loss: 0.1904809
	speed: 0.0103s/iter; left time: 59.5557s
Epoch: 10 cost time: 6.144996643066406
Epoch: 10, Steps: 570 | Train Loss: 0.1730067 Vali Loss: 0.0548287 Test Loss: 0.1543280
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1151982
	speed: 0.0382s/iter; left time: 213.8631s
	iters: 200, epoch: 11 | loss: 0.1987495
	speed: 0.0103s/iter; left time: 56.8477s
	iters: 300, epoch: 11 | loss: 0.1097980
	speed: 0.0103s/iter; left time: 55.6657s
	iters: 400, epoch: 11 | loss: 0.1088090
	speed: 0.0103s/iter; left time: 54.6913s
	iters: 500, epoch: 11 | loss: 0.1258720
	speed: 0.0103s/iter; left time: 53.7954s
Epoch: 11 cost time: 6.191657304763794
Epoch: 11, Steps: 570 | Train Loss: 0.1726455 Vali Loss: 0.0548595 Test Loss: 0.1545657
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15438935160636902, mae:0.2481307089328766
>>> MS_Raw LR=1e-3 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1910524
	speed: 0.0266s/iter; left time: 300.9296s
	iters: 200, epoch: 1 | loss: 0.1724668
	speed: 0.0149s/iter; left time: 167.1346s
	iters: 300, epoch: 1 | loss: 0.2917525
	speed: 0.0154s/iter; left time: 170.4707s
	iters: 400, epoch: 1 | loss: 0.1924879
	speed: 0.0154s/iter; left time: 169.5698s
	iters: 500, epoch: 1 | loss: 0.1730633
	speed: 0.0144s/iter; left time: 157.1398s
Epoch: 1 cost time: 9.82634687423706
Epoch: 1, Steps: 570 | Train Loss: 0.2224579 Vali Loss: 0.0565231 Test Loss: 0.1590333
Validation loss decreased (inf --> 0.056523).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2762584
	speed: 0.0484s/iter; left time: 519.3174s
	iters: 200, epoch: 2 | loss: 0.2946938
	speed: 0.0159s/iter; left time: 168.9292s
	iters: 300, epoch: 2 | loss: 0.2403137
	speed: 0.0159s/iter; left time: 167.2811s
	iters: 400, epoch: 2 | loss: 0.2267851
	speed: 0.0159s/iter; left time: 166.1642s
	iters: 500, epoch: 2 | loss: 0.3126200
	speed: 0.0159s/iter; left time: 163.9265s
Epoch: 2 cost time: 9.359599351882935
Epoch: 2, Steps: 570 | Train Loss: 0.2804122 Vali Loss: 0.0803362 Test Loss: 0.2180425
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4174822
	speed: 0.0481s/iter; left time: 488.4627s
	iters: 200, epoch: 3 | loss: 0.3376241
	speed: 0.0159s/iter; left time: 159.5716s
	iters: 300, epoch: 3 | loss: 0.1651516
	speed: 0.0159s/iter; left time: 158.0877s
	iters: 400, epoch: 3 | loss: 0.2693733
	speed: 0.0159s/iter; left time: 156.4100s
	iters: 500, epoch: 3 | loss: 0.2479194
	speed: 0.0157s/iter; left time: 153.7024s
Epoch: 3 cost time: 9.303808689117432
Epoch: 3, Steps: 570 | Train Loss: 0.2874916 Vali Loss: 0.0774770 Test Loss: 0.1967589
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2508566
	speed: 0.0473s/iter; left time: 453.9451s
	iters: 200, epoch: 4 | loss: 0.2272388
	speed: 0.0146s/iter; left time: 138.1321s
	iters: 300, epoch: 4 | loss: 0.2643112
	speed: 0.0137s/iter; left time: 128.7549s
	iters: 400, epoch: 4 | loss: 0.2609861
	speed: 0.0137s/iter; left time: 127.3424s
	iters: 500, epoch: 4 | loss: 0.2996611
	speed: 0.0137s/iter; left time: 125.8946s
Epoch: 4 cost time: 8.417403936386108
Epoch: 4, Steps: 570 | Train Loss: 0.2648740 Vali Loss: 0.0613281 Test Loss: 0.1687082
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1592792421579361, mae:0.2639329433441162
>>> MS_Raw LR=1e-3 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2919293
	speed: 0.0253s/iter; left time: 286.3125s
	iters: 200, epoch: 1 | loss: 0.1859017
	speed: 0.0135s/iter; left time: 150.8099s
	iters: 300, epoch: 1 | loss: 0.1094763
	speed: 0.0134s/iter; left time: 149.1020s
	iters: 400, epoch: 1 | loss: 0.2039593
	speed: 0.0135s/iter; left time: 148.1086s
	iters: 500, epoch: 1 | loss: 0.2330858
	speed: 0.0135s/iter; left time: 147.1263s
Epoch: 1 cost time: 8.914008378982544
Epoch: 1, Steps: 570 | Train Loss: 0.1849884 Vali Loss: 0.0479409 Test Loss: 0.1547139
Validation loss decreased (inf --> 0.047941).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1143082
	speed: 0.0461s/iter; left time: 494.6359s
	iters: 200, epoch: 2 | loss: 0.3537095
	speed: 0.0135s/iter; left time: 143.8647s
	iters: 300, epoch: 2 | loss: 0.3505127
	speed: 0.0135s/iter; left time: 142.0557s
	iters: 400, epoch: 2 | loss: 0.2553155
	speed: 0.0135s/iter; left time: 140.6111s
	iters: 500, epoch: 2 | loss: 0.2997040
	speed: 0.0135s/iter; left time: 139.0600s
Epoch: 2 cost time: 8.14826226234436
Epoch: 2, Steps: 570 | Train Loss: 0.2630000 Vali Loss: 0.0724070 Test Loss: 0.1898956
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2477942
	speed: 0.0458s/iter; left time: 465.6149s
	iters: 200, epoch: 3 | loss: 0.1261086
	speed: 0.0152s/iter; left time: 152.6101s
	iters: 300, epoch: 3 | loss: 0.2619452
	speed: 0.0152s/iter; left time: 151.0316s
	iters: 400, epoch: 3 | loss: 0.1103649
	speed: 0.0151s/iter; left time: 149.2976s
	iters: 500, epoch: 3 | loss: 0.2083330
	speed: 0.0152s/iter; left time: 147.8971s
Epoch: 3 cost time: 8.897177696228027
Epoch: 3, Steps: 570 | Train Loss: 0.2439919 Vali Loss: 0.0668979 Test Loss: 0.1739569
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1651082
	speed: 0.0459s/iter; left time: 440.1582s
	iters: 200, epoch: 4 | loss: 0.2440787
	speed: 0.0134s/iter; left time: 126.9382s
	iters: 300, epoch: 4 | loss: 0.3100405
	speed: 0.0134s/iter; left time: 125.5872s
	iters: 400, epoch: 4 | loss: 0.1410217
	speed: 0.0134s/iter; left time: 124.2529s
	iters: 500, epoch: 4 | loss: 0.1318116
	speed: 0.0134s/iter; left time: 122.8351s
Epoch: 4 cost time: 8.01339840888977
Epoch: 4, Steps: 570 | Train Loss: 0.2142600 Vali Loss: 0.0600810 Test Loss: 0.1641871
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1549413502216339, mae:0.2512667179107666
>>> MS_Raw LR=1e-3 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1190500
	speed: 0.0250s/iter; left time: 282.1155s
	iters: 200, epoch: 1 | loss: 0.3118449
	speed: 0.0133s/iter; left time: 149.1151s
	iters: 300, epoch: 1 | loss: 0.3297839
	speed: 0.0133s/iter; left time: 147.5347s
	iters: 400, epoch: 1 | loss: 0.2602028
	speed: 0.0133s/iter; left time: 146.2025s
	iters: 500, epoch: 1 | loss: 0.2521578
	speed: 0.0133s/iter; left time: 144.9578s
Epoch: 1 cost time: 8.789040565490723
Epoch: 1, Steps: 570 | Train Loss: 0.2388101 Vali Loss: 0.0638805 Test Loss: 0.1876526
Validation loss decreased (inf --> 0.063880).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2265279
	speed: 0.0463s/iter; left time: 497.3314s
	iters: 200, epoch: 2 | loss: 0.1576295
	speed: 0.0134s/iter; left time: 142.3329s
	iters: 300, epoch: 2 | loss: 0.1770525
	speed: 0.0134s/iter; left time: 141.1723s
	iters: 400, epoch: 2 | loss: 0.2324228
	speed: 0.0134s/iter; left time: 139.7304s
	iters: 500, epoch: 2 | loss: 0.3294505
	speed: 0.0134s/iter; left time: 138.4112s
Epoch: 2 cost time: 7.966223239898682
Epoch: 2, Steps: 570 | Train Loss: 0.2661254 Vali Loss: 0.0713454 Test Loss: 0.1848145
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2670662
	speed: 0.0462s/iter; left time: 469.7800s
	iters: 200, epoch: 3 | loss: 0.2732421
	speed: 0.0151s/iter; left time: 152.0696s
	iters: 300, epoch: 3 | loss: 0.2004428
	speed: 0.0151s/iter; left time: 150.2436s
	iters: 400, epoch: 3 | loss: 0.1749303
	speed: 0.0148s/iter; left time: 145.6438s
	iters: 500, epoch: 3 | loss: 0.2124099
	speed: 0.0135s/iter; left time: 131.4798s
Epoch: 3 cost time: 8.634317636489868
Epoch: 3, Steps: 570 | Train Loss: 0.2391176 Vali Loss: 0.0647277 Test Loss: 0.1720510
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2196204
	speed: 0.0452s/iter; left time: 433.8474s
	iters: 200, epoch: 4 | loss: 0.1945581
	speed: 0.0136s/iter; left time: 129.0802s
	iters: 300, epoch: 4 | loss: 0.1817180
	speed: 0.0136s/iter; left time: 127.2595s
	iters: 400, epoch: 4 | loss: 0.1947605
	speed: 0.0135s/iter; left time: 125.7486s
	iters: 500, epoch: 4 | loss: 0.1333836
	speed: 0.0135s/iter; left time: 124.1975s
Epoch: 4 cost time: 7.98197865486145
Epoch: 4, Steps: 570 | Train Loss: 0.2129358 Vali Loss: 0.0605438 Test Loss: 0.1664300
Validation loss decreased (0.063880 --> 0.060544).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1738715
	speed: 0.0439s/iter; left time: 395.6636s
	iters: 200, epoch: 5 | loss: 0.2195346
	speed: 0.0134s/iter; left time: 119.5102s
	iters: 300, epoch: 5 | loss: 0.1826030
	speed: 0.0134s/iter; left time: 118.4195s
	iters: 400, epoch: 5 | loss: 0.2756516
	speed: 0.0134s/iter; left time: 116.9107s
	iters: 500, epoch: 5 | loss: 0.1223429
	speed: 0.0134s/iter; left time: 115.5573s
Epoch: 5 cost time: 7.9157514572143555
Epoch: 5, Steps: 570 | Train Loss: 0.1918286 Vali Loss: 0.0575880 Test Loss: 0.1577104
Validation loss decreased (0.060544 --> 0.057588).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2719165
	speed: 0.0445s/iter; left time: 375.6722s
	iters: 200, epoch: 6 | loss: 0.1927407
	speed: 0.0133s/iter; left time: 111.3669s
	iters: 300, epoch: 6 | loss: 0.0962062
	speed: 0.0133s/iter; left time: 109.9714s
	iters: 400, epoch: 6 | loss: 0.2174937
	speed: 0.0133s/iter; left time: 108.6492s
	iters: 500, epoch: 6 | loss: 0.1846272
	speed: 0.0133s/iter; left time: 107.4197s
Epoch: 6 cost time: 7.885255575180054
Epoch: 6, Steps: 570 | Train Loss: 0.1781630 Vali Loss: 0.0573460 Test Loss: 0.1543588
Validation loss decreased (0.057588 --> 0.057346).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1491029
	speed: 0.0453s/iter; left time: 356.8843s
	iters: 200, epoch: 7 | loss: 0.0993516
	speed: 0.0135s/iter; left time: 105.0322s
	iters: 300, epoch: 7 | loss: 0.1379019
	speed: 0.0135s/iter; left time: 103.8948s
	iters: 400, epoch: 7 | loss: 0.2205217
	speed: 0.0135s/iter; left time: 102.5989s
	iters: 500, epoch: 7 | loss: 0.1336048
	speed: 0.0135s/iter; left time: 101.2323s
Epoch: 7 cost time: 7.991861581802368
Epoch: 7, Steps: 570 | Train Loss: 0.1709848 Vali Loss: 0.0576333 Test Loss: 0.1552133
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1184507
	speed: 0.0459s/iter; left time: 335.8350s
	iters: 200, epoch: 8 | loss: 0.1265137
	speed: 0.0152s/iter; left time: 109.4199s
	iters: 300, epoch: 8 | loss: 0.1915678
	speed: 0.0151s/iter; left time: 107.4542s
	iters: 400, epoch: 8 | loss: 0.2026834
	speed: 0.0150s/iter; left time: 105.3018s
	iters: 500, epoch: 8 | loss: 0.1000716
	speed: 0.0135s/iter; left time: 93.5765s
Epoch: 8 cost time: 8.635869026184082
Epoch: 8, Steps: 570 | Train Loss: 0.1666280 Vali Loss: 0.0592988 Test Loss: 0.1568683
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1650104
	speed: 0.0452s/iter; left time: 304.6995s
	iters: 200, epoch: 9 | loss: 0.1470891
	speed: 0.0134s/iter; left time: 89.1711s
	iters: 300, epoch: 9 | loss: 0.1308380
	speed: 0.0134s/iter; left time: 87.7939s
	iters: 400, epoch: 9 | loss: 0.1730627
	speed: 0.0134s/iter; left time: 86.5391s
	iters: 500, epoch: 9 | loss: 0.1253441
	speed: 0.0134s/iter; left time: 85.2409s
Epoch: 9 cost time: 7.953642129898071
Epoch: 9, Steps: 570 | Train Loss: 0.1645545 Vali Loss: 0.0580829 Test Loss: 0.1555741
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15459345281124115, mae:0.2520411014556885
>>> MS_Raw LR=1e-3 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2702464
	speed: 0.0283s/iter; left time: 319.5865s
	iters: 200, epoch: 1 | loss: 0.2674955
	speed: 0.0163s/iter; left time: 182.7679s
	iters: 300, epoch: 1 | loss: 0.3488625
	speed: 0.0163s/iter; left time: 181.1539s
	iters: 400, epoch: 1 | loss: 0.2293683
	speed: 0.0163s/iter; left time: 179.4313s
	iters: 500, epoch: 1 | loss: 0.2553122
	speed: 0.0163s/iter; left time: 177.6003s
Epoch: 1 cost time: 10.551230430603027
Epoch: 1, Steps: 570 | Train Loss: 0.3194285 Vali Loss: 0.0671749 Test Loss: 0.1898966
Validation loss decreased (inf --> 0.067175).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3389419
	speed: 0.0535s/iter; left time: 574.0299s
	iters: 200, epoch: 2 | loss: 0.3397476
	speed: 0.0163s/iter; left time: 173.4658s
	iters: 300, epoch: 2 | loss: 0.3092797
	speed: 0.0163s/iter; left time: 172.0226s
	iters: 400, epoch: 2 | loss: 0.2053859
	speed: 0.0163s/iter; left time: 170.3586s
	iters: 500, epoch: 2 | loss: 0.2841223
	speed: 0.0163s/iter; left time: 168.5309s
Epoch: 2 cost time: 9.640654802322388
Epoch: 2, Steps: 570 | Train Loss: 0.2695681 Vali Loss: 0.0684227 Test Loss: 0.1898351
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2059644
	speed: 0.0503s/iter; left time: 511.2515s
	iters: 200, epoch: 3 | loss: 0.2477117
	speed: 0.0164s/iter; left time: 164.9718s
	iters: 300, epoch: 3 | loss: 0.3639211
	speed: 0.0164s/iter; left time: 163.2525s
	iters: 400, epoch: 3 | loss: 0.2139793
	speed: 0.0164s/iter; left time: 161.5865s
	iters: 500, epoch: 3 | loss: 0.2109823
	speed: 0.0164s/iter; left time: 159.8704s
Epoch: 3 cost time: 9.644002914428711
Epoch: 3, Steps: 570 | Train Loss: 0.2380238 Vali Loss: 0.0639201 Test Loss: 0.1737082
Validation loss decreased (0.067175 --> 0.063920).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2504411
	speed: 0.0514s/iter; left time: 492.6210s
	iters: 200, epoch: 4 | loss: 0.1834994
	speed: 0.0163s/iter; left time: 154.6451s
	iters: 300, epoch: 4 | loss: 0.2105092
	speed: 0.0163s/iter; left time: 152.8973s
	iters: 400, epoch: 4 | loss: 0.2755169
	speed: 0.0163s/iter; left time: 151.3706s
	iters: 500, epoch: 4 | loss: 0.2003397
	speed: 0.0163s/iter; left time: 149.8537s
Epoch: 4 cost time: 9.61193299293518
Epoch: 4, Steps: 570 | Train Loss: 0.2210738 Vali Loss: 0.0653202 Test Loss: 0.1676902
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1212686
	speed: 0.0519s/iter; left time: 468.0216s
	iters: 200, epoch: 5 | loss: 0.2460476
	speed: 0.0171s/iter; left time: 152.6080s
	iters: 300, epoch: 5 | loss: 0.1491101
	speed: 0.0164s/iter; left time: 144.7586s
	iters: 400, epoch: 5 | loss: 0.1874050
	speed: 0.0164s/iter; left time: 142.8702s
	iters: 500, epoch: 5 | loss: 0.1471154
	speed: 0.0164s/iter; left time: 141.4831s
Epoch: 5 cost time: 9.839411973953247
Epoch: 5, Steps: 570 | Train Loss: 0.2057814 Vali Loss: 0.0583800 Test Loss: 0.1598453
Validation loss decreased (0.063920 --> 0.058380).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2401012
	speed: 0.0507s/iter; left time: 428.2493s
	iters: 200, epoch: 6 | loss: 0.1714445
	speed: 0.0172s/iter; left time: 143.2231s
	iters: 300, epoch: 6 | loss: 0.2459915
	speed: 0.0171s/iter; left time: 141.0910s
	iters: 400, epoch: 6 | loss: 0.1931977
	speed: 0.0171s/iter; left time: 139.3029s
	iters: 500, epoch: 6 | loss: 0.1885254
	speed: 0.0171s/iter; left time: 138.0601s
Epoch: 6 cost time: 10.071401357650757
Epoch: 6, Steps: 570 | Train Loss: 0.1941076 Vali Loss: 0.0599090 Test Loss: 0.1608659
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1485454
	speed: 0.0518s/iter; left time: 407.8620s
	iters: 200, epoch: 7 | loss: 0.2220893
	speed: 0.0165s/iter; left time: 128.6907s
	iters: 300, epoch: 7 | loss: 0.2589035
	speed: 0.0164s/iter; left time: 125.9304s
	iters: 400, epoch: 7 | loss: 0.1114334
	speed: 0.0164s/iter; left time: 124.1590s
	iters: 500, epoch: 7 | loss: 0.1242444
	speed: 0.0164s/iter; left time: 122.8111s
Epoch: 7 cost time: 9.763171434402466
Epoch: 7, Steps: 570 | Train Loss: 0.1875073 Vali Loss: 0.0603522 Test Loss: 0.1618410
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1701197
	speed: 0.0492s/iter; left time: 359.4976s
	iters: 200, epoch: 8 | loss: 0.1515106
	speed: 0.0163s/iter; left time: 117.4735s
	iters: 300, epoch: 8 | loss: 0.2233585
	speed: 0.0163s/iter; left time: 115.7702s
	iters: 400, epoch: 8 | loss: 0.0997724
	speed: 0.0163s/iter; left time: 114.1298s
	iters: 500, epoch: 8 | loss: 0.1245760
	speed: 0.0163s/iter; left time: 112.4648s
Epoch: 8 cost time: 9.572277307510376
Epoch: 8, Steps: 570 | Train Loss: 0.1838400 Vali Loss: 0.0598232 Test Loss: 0.1601604
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1600600779056549, mae:0.25847792625427246
>>> MS_Raw LR=1e-3 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2592842
	speed: 0.0293s/iter; left time: 331.6172s
	iters: 200, epoch: 1 | loss: 0.1940206
	speed: 0.0173s/iter; left time: 193.2768s
	iters: 300, epoch: 1 | loss: 0.3411418
	speed: 0.0172s/iter; left time: 191.4869s
	iters: 400, epoch: 1 | loss: 0.2999641
	speed: 0.0172s/iter; left time: 189.7662s
	iters: 500, epoch: 1 | loss: 0.1544883
	speed: 0.0173s/iter; left time: 188.0772s
Epoch: 1 cost time: 11.094825029373169
Epoch: 1, Steps: 570 | Train Loss: 0.3029523 Vali Loss: 0.0649792 Test Loss: 0.1817163
Validation loss decreased (inf --> 0.064979).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2204731
	speed: 0.0510s/iter; left time: 547.4645s
	iters: 200, epoch: 2 | loss: 0.2015020
	speed: 0.0159s/iter; left time: 168.8819s
	iters: 300, epoch: 2 | loss: 0.3120509
	speed: 0.0159s/iter; left time: 167.1558s
	iters: 400, epoch: 2 | loss: 0.4567918
	speed: 0.0159s/iter; left time: 165.6539s
	iters: 500, epoch: 2 | loss: 0.2119895
	speed: 0.0159s/iter; left time: 163.9337s
Epoch: 2 cost time: 9.380663394927979
Epoch: 2, Steps: 570 | Train Loss: 0.2555726 Vali Loss: 0.0691800 Test Loss: 0.1844113
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2225079
	speed: 0.0497s/iter; left time: 504.6314s
	iters: 200, epoch: 3 | loss: 0.2669656
	speed: 0.0159s/iter; left time: 160.1121s
	iters: 300, epoch: 3 | loss: 0.1537148
	speed: 0.0159s/iter; left time: 158.4863s
	iters: 400, epoch: 3 | loss: 0.2292681
	speed: 0.0159s/iter; left time: 156.7534s
	iters: 500, epoch: 3 | loss: 0.2172293
	speed: 0.0159s/iter; left time: 155.2425s
Epoch: 3 cost time: 9.351631879806519
Epoch: 3, Steps: 570 | Train Loss: 0.2331770 Vali Loss: 0.0565890 Test Loss: 0.1642408
Validation loss decreased (0.064979 --> 0.056589).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2177852
	speed: 0.0484s/iter; left time: 464.3757s
	iters: 200, epoch: 4 | loss: 0.3362504
	speed: 0.0158s/iter; left time: 149.7180s
	iters: 300, epoch: 4 | loss: 0.2126502
	speed: 0.0158s/iter; left time: 148.1508s
	iters: 400, epoch: 4 | loss: 0.1504691
	speed: 0.0158s/iter; left time: 146.4862s
	iters: 500, epoch: 4 | loss: 0.3105541
	speed: 0.0158s/iter; left time: 144.8307s
Epoch: 4 cost time: 9.310561656951904
Epoch: 4, Steps: 570 | Train Loss: 0.2091449 Vali Loss: 0.0589450 Test Loss: 0.1651395
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2018463
	speed: 0.0501s/iter; left time: 452.3880s
	iters: 200, epoch: 5 | loss: 0.3313251
	speed: 0.0161s/iter; left time: 143.5607s
	iters: 300, epoch: 5 | loss: 0.2012002
	speed: 0.0159s/iter; left time: 140.0191s
	iters: 400, epoch: 5 | loss: 0.1302354
	speed: 0.0159s/iter; left time: 138.2767s
	iters: 500, epoch: 5 | loss: 0.2003354
	speed: 0.0158s/iter; left time: 136.5124s
Epoch: 5 cost time: 9.464362621307373
Epoch: 5, Steps: 570 | Train Loss: 0.1946756 Vali Loss: 0.0567082 Test Loss: 0.1582989
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2129356
	speed: 0.0500s/iter; left time: 422.5623s
	iters: 200, epoch: 6 | loss: 0.2304875
	speed: 0.0158s/iter; left time: 132.2874s
	iters: 300, epoch: 6 | loss: 0.2754611
	speed: 0.0158s/iter; left time: 130.6976s
	iters: 400, epoch: 6 | loss: 0.1710404
	speed: 0.0158s/iter; left time: 128.7458s
	iters: 500, epoch: 6 | loss: 0.1663898
	speed: 0.0158s/iter; left time: 127.1250s
Epoch: 6 cost time: 9.304511547088623
Epoch: 6, Steps: 570 | Train Loss: 0.1853511 Vali Loss: 0.0544491 Test Loss: 0.1538800
Validation loss decreased (0.056589 --> 0.054449).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2040665
	speed: 0.0485s/iter; left time: 381.9401s
	iters: 200, epoch: 7 | loss: 0.1018395
	speed: 0.0158s/iter; left time: 122.6585s
	iters: 300, epoch: 7 | loss: 0.1823076
	speed: 0.0158s/iter; left time: 121.0789s
	iters: 400, epoch: 7 | loss: 0.1981986
	speed: 0.0158s/iter; left time: 119.6276s
	iters: 500, epoch: 7 | loss: 0.3003233
	speed: 0.0158s/iter; left time: 117.8931s
Epoch: 7 cost time: 9.272435665130615
Epoch: 7, Steps: 570 | Train Loss: 0.1801386 Vali Loss: 0.0555357 Test Loss: 0.1576312
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1524271
	speed: 0.0486s/iter; left time: 355.3504s
	iters: 200, epoch: 8 | loss: 0.2910529
	speed: 0.0172s/iter; left time: 124.0757s
	iters: 300, epoch: 8 | loss: 0.2003015
	speed: 0.0172s/iter; left time: 122.3707s
	iters: 400, epoch: 8 | loss: 0.1914104
	speed: 0.0172s/iter; left time: 120.6084s
	iters: 500, epoch: 8 | loss: 0.1669760
	speed: 0.0172s/iter; left time: 118.8419s
Epoch: 8 cost time: 10.10786509513855
Epoch: 8, Steps: 570 | Train Loss: 0.1769568 Vali Loss: 0.0551039 Test Loss: 0.1566411
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1595635
	speed: 0.0496s/iter; left time: 334.2925s
	iters: 200, epoch: 9 | loss: 0.1816410
	speed: 0.0157s/iter; left time: 104.5268s
	iters: 300, epoch: 9 | loss: 0.0986668
	speed: 0.0158s/iter; left time: 103.6422s
	iters: 400, epoch: 9 | loss: 0.1745072
	speed: 0.0158s/iter; left time: 102.0434s
	iters: 500, epoch: 9 | loss: 0.1041569
	speed: 0.0158s/iter; left time: 100.5023s
Epoch: 9 cost time: 9.270026922225952
Epoch: 9, Steps: 570 | Train Loss: 0.1748284 Vali Loss: 0.0550290 Test Loss: 0.1563157
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15406329929828644, mae:0.2528390884399414
>>> MS_Raw LR=1e-3 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3087568
	speed: 0.0280s/iter; left time: 316.6105s
	iters: 200, epoch: 1 | loss: 0.3462889
	speed: 0.0161s/iter; left time: 179.7971s
	iters: 300, epoch: 1 | loss: 0.2530968
	speed: 0.0161s/iter; left time: 178.6095s
	iters: 400, epoch: 1 | loss: 0.3330573
	speed: 0.0161s/iter; left time: 177.2118s
	iters: 500, epoch: 1 | loss: 0.4840830
	speed: 0.0161s/iter; left time: 175.9118s
Epoch: 1 cost time: 10.416978120803833
Epoch: 1, Steps: 570 | Train Loss: 0.2991262 Vali Loss: 0.0749524 Test Loss: 0.2021642
Validation loss decreased (inf --> 0.074952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4184516
	speed: 0.0490s/iter; left time: 526.0842s
	iters: 200, epoch: 2 | loss: 0.1698274
	speed: 0.0162s/iter; left time: 172.2011s
	iters: 300, epoch: 2 | loss: 0.3770357
	speed: 0.0162s/iter; left time: 170.3513s
	iters: 400, epoch: 2 | loss: 0.2762246
	speed: 0.0146s/iter; left time: 152.8023s
	iters: 500, epoch: 2 | loss: 0.2991737
	speed: 0.0146s/iter; left time: 150.9779s
Epoch: 2 cost time: 9.036964893341064
Epoch: 2, Steps: 570 | Train Loss: 0.2748205 Vali Loss: 0.0604024 Test Loss: 0.1754508
Validation loss decreased (0.074952 --> 0.060402).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2303173
	speed: 0.0469s/iter; left time: 476.7879s
	iters: 200, epoch: 3 | loss: 0.1447184
	speed: 0.0146s/iter; left time: 147.3198s
	iters: 300, epoch: 3 | loss: 0.2395865
	speed: 0.0147s/iter; left time: 146.0412s
	iters: 400, epoch: 3 | loss: 0.3493069
	speed: 0.0147s/iter; left time: 145.0726s
	iters: 500, epoch: 3 | loss: 0.2475004
	speed: 0.0147s/iter; left time: 143.5924s
Epoch: 3 cost time: 8.660646915435791
Epoch: 3, Steps: 570 | Train Loss: 0.2622324 Vali Loss: 0.0659564 Test Loss: 0.1945945
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1808744
	speed: 0.0464s/iter; left time: 444.5572s
	iters: 200, epoch: 4 | loss: 0.3168277
	speed: 0.0147s/iter; left time: 139.2683s
	iters: 300, epoch: 4 | loss: 0.3154862
	speed: 0.0147s/iter; left time: 137.8895s
	iters: 400, epoch: 4 | loss: 0.2198539
	speed: 0.0147s/iter; left time: 136.4008s
	iters: 500, epoch: 4 | loss: 0.2445161
	speed: 0.0146s/iter; left time: 134.4686s
Epoch: 4 cost time: 8.629490375518799
Epoch: 4, Steps: 570 | Train Loss: 0.2500855 Vali Loss: 0.0656367 Test Loss: 0.1755282
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2021067
	speed: 0.0451s/iter; left time: 407.1210s
	iters: 200, epoch: 5 | loss: 0.1661894
	speed: 0.0145s/iter; left time: 129.5099s
	iters: 300, epoch: 5 | loss: 0.1782910
	speed: 0.0145s/iter; left time: 127.9859s
	iters: 400, epoch: 5 | loss: 0.1894042
	speed: 0.0145s/iter; left time: 126.4700s
	iters: 500, epoch: 5 | loss: 0.2144025
	speed: 0.0145s/iter; left time: 125.0438s
Epoch: 5 cost time: 8.54588532447815
Epoch: 5, Steps: 570 | Train Loss: 0.2293930 Vali Loss: 0.0615150 Test Loss: 0.1702067
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.175662562251091, mae:0.26966238021850586
>>> MS_Raw LR=1e-3 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2576005
	speed: 0.0297s/iter; left time: 335.5164s
	iters: 200, epoch: 1 | loss: 0.3177054
	speed: 0.0175s/iter; left time: 195.9463s
	iters: 300, epoch: 1 | loss: 0.4582160
	speed: 0.0175s/iter; left time: 193.9846s
	iters: 400, epoch: 1 | loss: 0.2453062
	speed: 0.0175s/iter; left time: 192.5725s
	iters: 500, epoch: 1 | loss: 0.1802820
	speed: 0.0175s/iter; left time: 190.8400s
Epoch: 1 cost time: 11.249401569366455
Epoch: 1, Steps: 570 | Train Loss: 0.2986423 Vali Loss: 0.0624207 Test Loss: 0.1859441
Validation loss decreased (inf --> 0.062421).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3728313
	speed: 0.0581s/iter; left time: 623.7645s
	iters: 200, epoch: 2 | loss: 0.1625194
	speed: 0.0197s/iter; left time: 209.2836s
	iters: 300, epoch: 2 | loss: 0.2098111
	speed: 0.0197s/iter; left time: 207.2402s
	iters: 400, epoch: 2 | loss: 0.2316139
	speed: 0.0197s/iter; left time: 204.9795s
	iters: 500, epoch: 2 | loss: 0.2099084
	speed: 0.0197s/iter; left time: 203.1329s
Epoch: 2 cost time: 11.513313055038452
Epoch: 2, Steps: 570 | Train Loss: 0.2463334 Vali Loss: 0.0672368 Test Loss: 0.1854389
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1567222
	speed: 0.0566s/iter; left time: 575.5133s
	iters: 200, epoch: 3 | loss: 0.2328888
	speed: 0.0177s/iter; left time: 177.7977s
	iters: 300, epoch: 3 | loss: 0.2081664
	speed: 0.0193s/iter; left time: 192.2114s
	iters: 400, epoch: 3 | loss: 0.1160073
	speed: 0.0176s/iter; left time: 173.3553s
	iters: 500, epoch: 3 | loss: 0.1852383
	speed: 0.0176s/iter; left time: 171.4747s
Epoch: 3 cost time: 10.479041576385498
Epoch: 3, Steps: 570 | Train Loss: 0.2161097 Vali Loss: 0.0575502 Test Loss: 0.1623097
Validation loss decreased (0.062421 --> 0.057550).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2091047
	speed: 0.0569s/iter; left time: 545.4617s
	iters: 200, epoch: 4 | loss: 0.1903538
	speed: 0.0175s/iter; left time: 166.1302s
	iters: 300, epoch: 4 | loss: 0.2823515
	speed: 0.0175s/iter; left time: 164.3527s
	iters: 400, epoch: 4 | loss: 0.1222386
	speed: 0.0175s/iter; left time: 162.4982s
	iters: 500, epoch: 4 | loss: 0.2279944
	speed: 0.0175s/iter; left time: 160.7147s
Epoch: 4 cost time: 10.261772871017456
Epoch: 4, Steps: 570 | Train Loss: 0.1895393 Vali Loss: 0.0610897 Test Loss: 0.1650018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2419203
	speed: 0.0534s/iter; left time: 481.9974s
	iters: 200, epoch: 5 | loss: 0.1397381
	speed: 0.0175s/iter; left time: 156.0745s
	iters: 300, epoch: 5 | loss: 0.1961470
	speed: 0.0175s/iter; left time: 154.2807s
	iters: 400, epoch: 5 | loss: 0.2142258
	speed: 0.0175s/iter; left time: 152.5730s
	iters: 500, epoch: 5 | loss: 0.2020703
	speed: 0.0175s/iter; left time: 150.8153s
Epoch: 5 cost time: 10.249549388885498
Epoch: 5, Steps: 570 | Train Loss: 0.1776697 Vali Loss: 0.0597592 Test Loss: 0.1574803
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1256947
	speed: 0.0543s/iter; left time: 458.8979s
	iters: 200, epoch: 6 | loss: 0.1939256
	speed: 0.0175s/iter; left time: 146.5018s
	iters: 300, epoch: 6 | loss: 0.1321706
	speed: 0.0176s/iter; left time: 144.8365s
	iters: 400, epoch: 6 | loss: 0.1912255
	speed: 0.0176s/iter; left time: 143.1946s
	iters: 500, epoch: 6 | loss: 0.1801842
	speed: 0.0176s/iter; left time: 141.3267s
Epoch: 6 cost time: 10.279688119888306
Epoch: 6, Steps: 570 | Train Loss: 0.1691510 Vali Loss: 0.0597679 Test Loss: 0.1599545
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16255781054496765, mae:0.2579495906829834
>>> MS_Raw LR=1e-3 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4043203
	speed: 0.0290s/iter; left time: 327.4946s
	iters: 200, epoch: 1 | loss: 0.1992670
	speed: 0.0171s/iter; left time: 191.8257s
	iters: 300, epoch: 1 | loss: 0.1797327
	speed: 0.0170s/iter; left time: 188.9575s
	iters: 400, epoch: 1 | loss: 0.1445734
	speed: 0.0170s/iter; left time: 187.4228s
	iters: 500, epoch: 1 | loss: 0.1533082
	speed: 0.0170s/iter; left time: 185.7217s
Epoch: 1 cost time: 10.964553356170654
Epoch: 1, Steps: 570 | Train Loss: 0.2059793 Vali Loss: 0.0638378 Test Loss: 0.1858505
Validation loss decreased (inf --> 0.063838).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3128408
	speed: 0.0559s/iter; left time: 600.3397s
	iters: 200, epoch: 2 | loss: 0.3340852
	speed: 0.0173s/iter; left time: 183.7070s
	iters: 300, epoch: 2 | loss: 0.4815163
	speed: 0.0173s/iter; left time: 182.5142s
	iters: 400, epoch: 2 | loss: 0.2596833
	speed: 0.0173s/iter; left time: 180.5150s
	iters: 500, epoch: 2 | loss: 0.1839698
	speed: 0.0173s/iter; left time: 179.1618s
Epoch: 2 cost time: 10.184093236923218
Epoch: 2, Steps: 570 | Train Loss: 0.2772075 Vali Loss: 0.0627708 Test Loss: 0.1783495
Validation loss decreased (0.063838 --> 0.062771).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1760170
	speed: 0.0560s/iter; left time: 568.8704s
	iters: 200, epoch: 3 | loss: 0.1966718
	speed: 0.0172s/iter; left time: 172.7469s
	iters: 300, epoch: 3 | loss: 0.1913995
	speed: 0.0172s/iter; left time: 171.3092s
	iters: 400, epoch: 3 | loss: 0.1781942
	speed: 0.0171s/iter; left time: 169.0805s
	iters: 500, epoch: 3 | loss: 0.1715818
	speed: 0.0171s/iter; left time: 167.3459s
Epoch: 3 cost time: 10.077521562576294
Epoch: 3, Steps: 570 | Train Loss: 0.2209164 Vali Loss: 0.0596031 Test Loss: 0.1728491
Validation loss decreased (0.062771 --> 0.059603).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1805340
	speed: 0.0557s/iter; left time: 533.9758s
	iters: 200, epoch: 4 | loss: 0.0905904
	speed: 0.0181s/iter; left time: 171.3614s
	iters: 300, epoch: 4 | loss: 0.2791197
	speed: 0.0172s/iter; left time: 161.4637s
	iters: 400, epoch: 4 | loss: 0.1629296
	speed: 0.0173s/iter; left time: 160.5733s
	iters: 500, epoch: 4 | loss: 0.1282458
	speed: 0.0173s/iter; left time: 158.6179s
Epoch: 4 cost time: 10.419745922088623
Epoch: 4, Steps: 570 | Train Loss: 0.1975164 Vali Loss: 0.0578438 Test Loss: 0.1621911
Validation loss decreased (0.059603 --> 0.057844).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1482425
	speed: 0.0567s/iter; left time: 511.4443s
	iters: 200, epoch: 5 | loss: 0.1782770
	speed: 0.0173s/iter; left time: 153.8976s
	iters: 300, epoch: 5 | loss: 0.1629610
	speed: 0.0172s/iter; left time: 151.9039s
	iters: 400, epoch: 5 | loss: 0.1764713
	speed: 0.0172s/iter; left time: 150.1818s
	iters: 500, epoch: 5 | loss: 0.1842960
	speed: 0.0172s/iter; left time: 148.1882s
Epoch: 5 cost time: 10.082205295562744
Epoch: 5, Steps: 570 | Train Loss: 0.1851035 Vali Loss: 0.0581966 Test Loss: 0.1593677
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2247585
	speed: 0.0552s/iter; left time: 466.3421s
	iters: 200, epoch: 6 | loss: 0.1118122
	speed: 0.0170s/iter; left time: 142.1789s
	iters: 300, epoch: 6 | loss: 0.1594950
	speed: 0.0171s/iter; left time: 140.7262s
	iters: 400, epoch: 6 | loss: 0.1419411
	speed: 0.0170s/iter; left time: 138.6458s
	iters: 500, epoch: 6 | loss: 0.1376313
	speed: 0.0171s/iter; left time: 137.3339s
Epoch: 6 cost time: 9.996176719665527
Epoch: 6, Steps: 570 | Train Loss: 0.1773759 Vali Loss: 0.0558292 Test Loss: 0.1570787
Validation loss decreased (0.057844 --> 0.055829).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1612963
	speed: 0.0537s/iter; left time: 422.8271s
	iters: 200, epoch: 7 | loss: 0.1753921
	speed: 0.0173s/iter; left time: 134.4753s
	iters: 300, epoch: 7 | loss: 0.1152870
	speed: 0.0173s/iter; left time: 132.7021s
	iters: 400, epoch: 7 | loss: 0.1577708
	speed: 0.0173s/iter; left time: 130.8415s
	iters: 500, epoch: 7 | loss: 0.1604751
	speed: 0.0173s/iter; left time: 129.1225s
Epoch: 7 cost time: 10.126170873641968
Epoch: 7, Steps: 570 | Train Loss: 0.1730504 Vali Loss: 0.0571969 Test Loss: 0.1591050
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1169839
	speed: 0.0532s/iter; left time: 388.7168s
	iters: 200, epoch: 8 | loss: 0.1007759
	speed: 0.0172s/iter; left time: 123.7419s
	iters: 300, epoch: 8 | loss: 0.2006591
	speed: 0.0171s/iter; left time: 121.8536s
	iters: 400, epoch: 8 | loss: 0.2258077
	speed: 0.0171s/iter; left time: 120.0922s
	iters: 500, epoch: 8 | loss: 0.2066380
	speed: 0.0171s/iter; left time: 118.3941s
Epoch: 8 cost time: 10.047049045562744
Epoch: 8, Steps: 570 | Train Loss: 0.1705565 Vali Loss: 0.0568154 Test Loss: 0.1585337
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1093133
	speed: 0.0533s/iter; left time: 359.2998s
	iters: 200, epoch: 9 | loss: 0.1208550
	speed: 0.0171s/iter; left time: 113.8698s
	iters: 300, epoch: 9 | loss: 0.1547902
	speed: 0.0171s/iter; left time: 112.0051s
	iters: 400, epoch: 9 | loss: 0.1336278
	speed: 0.0171s/iter; left time: 110.2503s
	iters: 500, epoch: 9 | loss: 0.1185609
	speed: 0.0171s/iter; left time: 108.5591s
Epoch: 9 cost time: 10.062439918518066
Epoch: 9, Steps: 570 | Train Loss: 0.1690572 Vali Loss: 0.0568122 Test Loss: 0.1580576
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15728867053985596, mae:0.2547375559806824
>>> MS_Raw LR=1e-3 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2556352
	speed: 0.0321s/iter; left time: 362.2327s
	iters: 200, epoch: 1 | loss: 0.1872244
	speed: 0.0194s/iter; left time: 217.4046s
	iters: 300, epoch: 1 | loss: 0.2462130
	speed: 0.0194s/iter; left time: 215.1444s
	iters: 400, epoch: 1 | loss: 0.2578883
	speed: 0.0192s/iter; left time: 211.7401s
	iters: 500, epoch: 1 | loss: 0.3866651
	speed: 0.0193s/iter; left time: 210.7373s
Epoch: 1 cost time: 12.351327419281006
Epoch: 1, Steps: 570 | Train Loss: 0.2572709 Vali Loss: 0.0606518 Test Loss: 0.1839672
Validation loss decreased (inf --> 0.060652).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4579217
	speed: 0.0568s/iter; left time: 609.0621s
	iters: 200, epoch: 2 | loss: 0.3687385
	speed: 0.0186s/iter; left time: 197.5473s
	iters: 300, epoch: 2 | loss: 0.3783978
	speed: 0.0193s/iter; left time: 202.8120s
	iters: 400, epoch: 2 | loss: 0.2041424
	speed: 0.0181s/iter; left time: 189.1513s
	iters: 500, epoch: 2 | loss: 0.3030787
	speed: 0.0172s/iter; left time: 177.5866s
Epoch: 2 cost time: 10.640686750411987
Epoch: 2, Steps: 570 | Train Loss: 0.2547372 Vali Loss: 0.0611325 Test Loss: 0.1727885
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1552677
	speed: 0.0539s/iter; left time: 548.0149s
	iters: 200, epoch: 3 | loss: 0.2073597
	speed: 0.0172s/iter; left time: 172.6447s
	iters: 300, epoch: 3 | loss: 0.2164321
	speed: 0.0171s/iter; left time: 170.8187s
	iters: 400, epoch: 3 | loss: 0.2554320
	speed: 0.0172s/iter; left time: 169.1475s
	iters: 500, epoch: 3 | loss: 0.2286625
	speed: 0.0171s/iter; left time: 167.3140s
Epoch: 3 cost time: 10.048091888427734
Epoch: 3, Steps: 570 | Train Loss: 0.2108641 Vali Loss: 0.0606534 Test Loss: 0.1671809
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1449989
	speed: 0.0535s/iter; left time: 513.4419s
	iters: 200, epoch: 4 | loss: 0.1873359
	speed: 0.0171s/iter; left time: 162.7542s
	iters: 300, epoch: 4 | loss: 0.1576527
	speed: 0.0172s/iter; left time: 161.2616s
	iters: 400, epoch: 4 | loss: 0.2044394
	speed: 0.0171s/iter; left time: 159.3282s
	iters: 500, epoch: 4 | loss: 0.1120493
	speed: 0.0172s/iter; left time: 157.9000s
Epoch: 4 cost time: 10.114600896835327
Epoch: 4, Steps: 570 | Train Loss: 0.1912532 Vali Loss: 0.0578707 Test Loss: 0.1583105
Validation loss decreased (0.060652 --> 0.057871).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1316964
	speed: 0.0551s/iter; left time: 496.7498s
	iters: 200, epoch: 5 | loss: 0.1546748
	speed: 0.0173s/iter; left time: 154.1159s
	iters: 300, epoch: 5 | loss: 0.1557725
	speed: 0.0173s/iter; left time: 152.8322s
	iters: 400, epoch: 5 | loss: 0.2160063
	speed: 0.0173s/iter; left time: 151.0458s
	iters: 500, epoch: 5 | loss: 0.1194131
	speed: 0.0173s/iter; left time: 149.4499s
Epoch: 5 cost time: 10.159153699874878
Epoch: 5, Steps: 570 | Train Loss: 0.1778205 Vali Loss: 0.0576764 Test Loss: 0.1575596
Validation loss decreased (0.057871 --> 0.057676).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2322009
	speed: 0.0580s/iter; left time: 489.7362s
	iters: 200, epoch: 6 | loss: 0.1299272
	speed: 0.0172s/iter; left time: 143.6537s
	iters: 300, epoch: 6 | loss: 0.3989783
	speed: 0.0172s/iter; left time: 142.0014s
	iters: 400, epoch: 6 | loss: 0.1361643
	speed: 0.0172s/iter; left time: 140.2332s
	iters: 500, epoch: 6 | loss: 0.2072702
	speed: 0.0172s/iter; left time: 138.4696s
Epoch: 6 cost time: 10.109267711639404
Epoch: 6, Steps: 570 | Train Loss: 0.1666638 Vali Loss: 0.0567906 Test Loss: 0.1548798
Validation loss decreased (0.057676 --> 0.056791).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1350531
	speed: 0.0548s/iter; left time: 431.6230s
	iters: 200, epoch: 7 | loss: 0.1668256
	speed: 0.0172s/iter; left time: 133.6921s
	iters: 300, epoch: 7 | loss: 0.1984801
	speed: 0.0172s/iter; left time: 131.9719s
	iters: 400, epoch: 7 | loss: 0.1426664
	speed: 0.0173s/iter; left time: 130.9979s
	iters: 500, epoch: 7 | loss: 0.1303774
	speed: 0.0173s/iter; left time: 129.1660s
Epoch: 7 cost time: 10.12760329246521
Epoch: 7, Steps: 570 | Train Loss: 0.1604715 Vali Loss: 0.0566994 Test Loss: 0.1539143
Validation loss decreased (0.056791 --> 0.056699).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0793495
	speed: 0.0577s/iter; left time: 422.1245s
	iters: 200, epoch: 8 | loss: 0.0816441
	speed: 0.0174s/iter; left time: 125.7187s
	iters: 300, epoch: 8 | loss: 0.1428428
	speed: 0.0174s/iter; left time: 124.0247s
	iters: 400, epoch: 8 | loss: 0.1213741
	speed: 0.0174s/iter; left time: 122.1017s
	iters: 500, epoch: 8 | loss: 0.1387340
	speed: 0.0174s/iter; left time: 120.4340s
Epoch: 8 cost time: 10.27138352394104
Epoch: 8, Steps: 570 | Train Loss: 0.1568428 Vali Loss: 0.0571787 Test Loss: 0.1558457
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2026256
	speed: 0.0580s/iter; left time: 390.8511s
	iters: 200, epoch: 9 | loss: 0.1673106
	speed: 0.0190s/iter; left time: 125.9928s
	iters: 300, epoch: 9 | loss: 0.1801844
	speed: 0.0194s/iter; left time: 126.8430s
	iters: 400, epoch: 9 | loss: 0.2959049
	speed: 0.0195s/iter; left time: 125.5808s
	iters: 500, epoch: 9 | loss: 0.1356361
	speed: 0.0195s/iter; left time: 123.6049s
Epoch: 9 cost time: 11.337470293045044
Epoch: 9, Steps: 570 | Train Loss: 0.1549962 Vali Loss: 0.0568263 Test Loss: 0.1550211
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1370055
	speed: 0.0614s/iter; left time: 378.8395s
	iters: 200, epoch: 10 | loss: 0.1289415
	speed: 0.0173s/iter; left time: 105.3231s
	iters: 300, epoch: 10 | loss: 0.1983363
	speed: 0.0174s/iter; left time: 103.6338s
	iters: 400, epoch: 10 | loss: 0.1467326
	speed: 0.0174s/iter; left time: 101.9013s
	iters: 500, epoch: 10 | loss: 0.1663210
	speed: 0.0173s/iter; left time: 100.1157s
Epoch: 10 cost time: 10.391501188278198
Epoch: 10, Steps: 570 | Train Loss: 0.1536804 Vali Loss: 0.0567571 Test Loss: 0.1549835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15411075949668884, mae:0.2524541914463043
>>> MS_Raw LR=1e-3 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2633941
	speed: 0.0354s/iter; left time: 399.5265s
	iters: 200, epoch: 1 | loss: 0.2882230
	speed: 0.0215s/iter; left time: 240.3196s
	iters: 300, epoch: 1 | loss: 0.3079577
	speed: 0.0213s/iter; left time: 236.7133s
	iters: 400, epoch: 1 | loss: 0.4719545
	speed: 0.0213s/iter; left time: 234.0943s
	iters: 500, epoch: 1 | loss: 0.3473301
	speed: 0.0213s/iter; left time: 232.0343s
Epoch: 1 cost time: 13.614471435546875
Epoch: 1, Steps: 570 | Train Loss: 0.3496201 Vali Loss: 0.0691530 Test Loss: 0.2032876
Validation loss decreased (inf --> 0.069153).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3026515
	speed: 0.0619s/iter; left time: 663.8034s
	iters: 200, epoch: 2 | loss: 0.2586778
	speed: 0.0214s/iter; left time: 226.9856s
	iters: 300, epoch: 2 | loss: 0.2658741
	speed: 0.0213s/iter; left time: 224.7301s
	iters: 400, epoch: 2 | loss: 0.3067841
	speed: 0.0214s/iter; left time: 222.7819s
	iters: 500, epoch: 2 | loss: 0.2336292
	speed: 0.0213s/iter; left time: 220.4606s
Epoch: 2 cost time: 12.48885464668274
Epoch: 2, Steps: 570 | Train Loss: 0.2770482 Vali Loss: 0.0684681 Test Loss: 0.1803966
Validation loss decreased (0.069153 --> 0.068468).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5014133
	speed: 0.0647s/iter; left time: 657.0260s
	iters: 200, epoch: 3 | loss: 0.3132436
	speed: 0.0213s/iter; left time: 214.6876s
	iters: 300, epoch: 3 | loss: 0.3100383
	speed: 0.0214s/iter; left time: 212.7790s
	iters: 400, epoch: 3 | loss: 0.2355167
	speed: 0.0213s/iter; left time: 210.3238s
	iters: 500, epoch: 3 | loss: 0.2293372
	speed: 0.0213s/iter; left time: 208.2993s
Epoch: 3 cost time: 12.49863338470459
Epoch: 3, Steps: 570 | Train Loss: 0.2852790 Vali Loss: 0.0618621 Test Loss: 0.1858376
Validation loss decreased (0.068468 --> 0.061862).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1910913
	speed: 0.0619s/iter; left time: 593.7576s
	iters: 200, epoch: 4 | loss: 0.2064937
	speed: 0.0213s/iter; left time: 202.0320s
	iters: 300, epoch: 4 | loss: 0.3060553
	speed: 0.0213s/iter; left time: 199.9100s
	iters: 400, epoch: 4 | loss: 0.2156951
	speed: 0.0213s/iter; left time: 197.7649s
	iters: 500, epoch: 4 | loss: 0.2605067
	speed: 0.0213s/iter; left time: 195.5423s
Epoch: 4 cost time: 12.41650915145874
Epoch: 4, Steps: 570 | Train Loss: 0.2557708 Vali Loss: 0.0617414 Test Loss: 0.1765215
Validation loss decreased (0.061862 --> 0.061741).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2731111
	speed: 0.0629s/iter; left time: 567.5597s
	iters: 200, epoch: 5 | loss: 0.1924176
	speed: 0.0231s/iter; left time: 206.2761s
	iters: 300, epoch: 5 | loss: 0.1932702
	speed: 0.0223s/iter; left time: 196.6875s
	iters: 400, epoch: 5 | loss: 0.2116029
	speed: 0.0213s/iter; left time: 186.0546s
	iters: 500, epoch: 5 | loss: 0.2595659
	speed: 0.0213s/iter; left time: 183.9340s
Epoch: 5 cost time: 12.875200033187866
Epoch: 5, Steps: 570 | Train Loss: 0.2348923 Vali Loss: 0.0627406 Test Loss: 0.1726262
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2130222
	speed: 0.0606s/iter; left time: 512.1677s
	iters: 200, epoch: 6 | loss: 0.3572890
	speed: 0.0214s/iter; left time: 178.8923s
	iters: 300, epoch: 6 | loss: 0.2064936
	speed: 0.0214s/iter; left time: 176.8148s
	iters: 400, epoch: 6 | loss: 0.2617048
	speed: 0.0214s/iter; left time: 174.1645s
	iters: 500, epoch: 6 | loss: 0.3124670
	speed: 0.0213s/iter; left time: 171.7094s
Epoch: 6 cost time: 12.455599308013916
Epoch: 6, Steps: 570 | Train Loss: 0.2221600 Vali Loss: 0.0617320 Test Loss: 0.1794897
Validation loss decreased (0.061741 --> 0.061732).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2988350
	speed: 0.0639s/iter; left time: 503.3986s
	iters: 200, epoch: 7 | loss: 0.1856506
	speed: 0.0214s/iter; left time: 166.3302s
	iters: 300, epoch: 7 | loss: 0.1715053
	speed: 0.0214s/iter; left time: 164.0324s
	iters: 400, epoch: 7 | loss: 0.2193801
	speed: 0.0213s/iter; left time: 161.7086s
	iters: 500, epoch: 7 | loss: 0.2082414
	speed: 0.0214s/iter; left time: 159.8093s
Epoch: 7 cost time: 12.501641988754272
Epoch: 7, Steps: 570 | Train Loss: 0.2201508 Vali Loss: 0.0617448 Test Loss: 0.1733547
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1307898
	speed: 0.0644s/iter; left time: 470.9465s
	iters: 200, epoch: 8 | loss: 0.3508490
	speed: 0.0214s/iter; left time: 154.4055s
	iters: 300, epoch: 8 | loss: 0.1427951
	speed: 0.0214s/iter; left time: 152.0646s
	iters: 400, epoch: 8 | loss: 0.1989607
	speed: 0.0214s/iter; left time: 149.8367s
	iters: 500, epoch: 8 | loss: 0.2051648
	speed: 0.0214s/iter; left time: 147.6700s
Epoch: 8 cost time: 12.5099515914917
Epoch: 8, Steps: 570 | Train Loss: 0.2198184 Vali Loss: 0.0605993 Test Loss: 0.1703959
Validation loss decreased (0.061732 --> 0.060599).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2086617
	speed: 0.0644s/iter; left time: 433.8981s
	iters: 200, epoch: 9 | loss: 0.1701879
	speed: 0.0213s/iter; left time: 141.3316s
	iters: 300, epoch: 9 | loss: 0.2340400
	speed: 0.0213s/iter; left time: 139.2276s
	iters: 400, epoch: 9 | loss: 0.2145180
	speed: 0.0213s/iter; left time: 137.3245s
	iters: 500, epoch: 9 | loss: 0.1757907
	speed: 0.0213s/iter; left time: 135.1047s
Epoch: 9 cost time: 12.461314678192139
Epoch: 9, Steps: 570 | Train Loss: 0.2117511 Vali Loss: 0.0595498 Test Loss: 0.1690634
Validation loss decreased (0.060599 --> 0.059550).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1913969
	speed: 0.0621s/iter; left time: 383.4713s
	iters: 200, epoch: 10 | loss: 0.1887120
	speed: 0.0214s/iter; left time: 129.6341s
	iters: 300, epoch: 10 | loss: 0.1581029
	speed: 0.0214s/iter; left time: 127.5972s
	iters: 400, epoch: 10 | loss: 0.3914342
	speed: 0.0213s/iter; left time: 125.3430s
	iters: 500, epoch: 10 | loss: 0.2320722
	speed: 0.0213s/iter; left time: 123.1746s
Epoch: 10 cost time: 12.505444526672363
Epoch: 10, Steps: 570 | Train Loss: 0.2091234 Vali Loss: 0.0599943 Test Loss: 0.1690989
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1834012
	speed: 0.0623s/iter; left time: 348.8856s
	iters: 200, epoch: 11 | loss: 0.1807611
	speed: 0.0214s/iter; left time: 117.8634s
	iters: 300, epoch: 11 | loss: 0.1376544
	speed: 0.0214s/iter; left time: 115.6916s
	iters: 400, epoch: 11 | loss: 0.1764182
	speed: 0.0214s/iter; left time: 113.4402s
	iters: 500, epoch: 11 | loss: 0.1822242
	speed: 0.0214s/iter; left time: 111.3706s
Epoch: 11 cost time: 12.485766887664795
Epoch: 11, Steps: 570 | Train Loss: 0.2081567 Vali Loss: 0.0601298 Test Loss: 0.1693076
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2462718
	speed: 0.0607s/iter; left time: 305.3773s
	iters: 200, epoch: 12 | loss: 0.1744411
	speed: 0.0213s/iter; left time: 105.0456s
	iters: 300, epoch: 12 | loss: 0.3393806
	speed: 0.0213s/iter; left time: 102.8801s
	iters: 400, epoch: 12 | loss: 0.1140367
	speed: 0.0213s/iter; left time: 100.9233s
	iters: 500, epoch: 12 | loss: 0.2412114
	speed: 0.0213s/iter; left time: 98.5994s
Epoch: 12 cost time: 12.463565826416016
Epoch: 12, Steps: 570 | Train Loss: 0.2077105 Vali Loss: 0.0600915 Test Loss: 0.1693314
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16930536925792694, mae:0.26500973105430603
>>> MS_Raw LR=1e-3 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.5048662
	speed: 0.0322s/iter; left time: 363.8844s
	iters: 200, epoch: 1 | loss: 0.1369040
	speed: 0.0206s/iter; left time: 230.3655s
	iters: 300, epoch: 1 | loss: 0.2355949
	speed: 0.0205s/iter; left time: 228.0557s
	iters: 400, epoch: 1 | loss: 0.2787115
	speed: 0.0205s/iter; left time: 225.8022s
	iters: 500, epoch: 1 | loss: 0.2199036
	speed: 0.0205s/iter; left time: 223.8256s
Epoch: 1 cost time: 12.931718587875366
Epoch: 1, Steps: 570 | Train Loss: 0.3321772 Vali Loss: 0.0685171 Test Loss: 0.1871986
Validation loss decreased (inf --> 0.068517).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2593084
	speed: 0.0658s/iter; left time: 706.3345s
	iters: 200, epoch: 2 | loss: 0.1782596
	speed: 0.0224s/iter; left time: 237.9249s
	iters: 300, epoch: 2 | loss: 0.3906453
	speed: 0.0224s/iter; left time: 235.7527s
	iters: 400, epoch: 2 | loss: 0.1749899
	speed: 0.0224s/iter; left time: 233.6758s
	iters: 500, epoch: 2 | loss: 0.2072232
	speed: 0.0224s/iter; left time: 231.3499s
Epoch: 2 cost time: 13.071722269058228
Epoch: 2, Steps: 570 | Train Loss: 0.2578903 Vali Loss: 0.0668498 Test Loss: 0.1912969
Validation loss decreased (0.068517 --> 0.066850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2249382
	speed: 0.0623s/iter; left time: 633.3638s
	iters: 200, epoch: 3 | loss: 0.1607056
	speed: 0.0207s/iter; left time: 207.8232s
	iters: 300, epoch: 3 | loss: 0.1565936
	speed: 0.0206s/iter; left time: 205.6190s
	iters: 400, epoch: 3 | loss: 0.1524085
	speed: 0.0207s/iter; left time: 203.6900s
	iters: 500, epoch: 3 | loss: 0.1550296
	speed: 0.0206s/iter; left time: 201.4525s
Epoch: 3 cost time: 12.072071552276611
Epoch: 3, Steps: 570 | Train Loss: 0.2275447 Vali Loss: 0.0636690 Test Loss: 0.1738327
Validation loss decreased (0.066850 --> 0.063669).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1582057
	speed: 0.0636s/iter; left time: 610.1411s
	iters: 200, epoch: 4 | loss: 0.2079531
	speed: 0.0224s/iter; left time: 212.7945s
	iters: 300, epoch: 4 | loss: 0.1579667
	speed: 0.0224s/iter; left time: 210.3908s
	iters: 400, epoch: 4 | loss: 0.2145253
	speed: 0.0224s/iter; left time: 208.0360s
	iters: 500, epoch: 4 | loss: 0.1629684
	speed: 0.0224s/iter; left time: 205.8659s
Epoch: 4 cost time: 13.101523399353027
Epoch: 4, Steps: 570 | Train Loss: 0.1952149 Vali Loss: 0.0597343 Test Loss: 0.1581925
Validation loss decreased (0.063669 --> 0.059734).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2804677
	speed: 0.0622s/iter; left time: 561.2154s
	iters: 200, epoch: 5 | loss: 0.1796376
	speed: 0.0206s/iter; left time: 184.0553s
	iters: 300, epoch: 5 | loss: 0.1583485
	speed: 0.0206s/iter; left time: 181.6475s
	iters: 400, epoch: 5 | loss: 0.1763235
	speed: 0.0206s/iter; left time: 179.8181s
	iters: 500, epoch: 5 | loss: 0.1554981
	speed: 0.0206s/iter; left time: 177.8523s
Epoch: 5 cost time: 12.054197788238525
Epoch: 5, Steps: 570 | Train Loss: 0.1784757 Vali Loss: 0.0619457 Test Loss: 0.1574815
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1472059
	speed: 0.0586s/iter; left time: 495.3497s
	iters: 200, epoch: 6 | loss: 0.1663551
	speed: 0.0206s/iter; left time: 172.2421s
	iters: 300, epoch: 6 | loss: 0.1644344
	speed: 0.0206s/iter; left time: 170.1701s
	iters: 400, epoch: 6 | loss: 0.1136185
	speed: 0.0206s/iter; left time: 168.2200s
	iters: 500, epoch: 6 | loss: 0.1272855
	speed: 0.0206s/iter; left time: 166.1179s
Epoch: 6 cost time: 12.045087575912476
Epoch: 6, Steps: 570 | Train Loss: 0.1690723 Vali Loss: 0.0634737 Test Loss: 0.1590462
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1238686
	speed: 0.0627s/iter; left time: 494.0997s
	iters: 200, epoch: 7 | loss: 0.1984115
	speed: 0.0206s/iter; left time: 160.1578s
	iters: 300, epoch: 7 | loss: 0.1817501
	speed: 0.0206s/iter; left time: 158.2145s
	iters: 400, epoch: 7 | loss: 0.1394706
	speed: 0.0206s/iter; left time: 156.1388s
	iters: 500, epoch: 7 | loss: 0.1559870
	speed: 0.0206s/iter; left time: 154.4004s
Epoch: 7 cost time: 12.020030975341797
Epoch: 7, Steps: 570 | Train Loss: 0.1623321 Vali Loss: 0.0616060 Test Loss: 0.1566058
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1584259569644928, mae:0.2586020827293396
>>> MS_Raw LR=1e-3 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3459812
	speed: 0.0324s/iter; left time: 365.9767s
	iters: 200, epoch: 1 | loss: 0.2204933
	speed: 0.0209s/iter; left time: 233.6223s
	iters: 300, epoch: 1 | loss: 0.3470292
	speed: 0.0208s/iter; left time: 231.3145s
	iters: 400, epoch: 1 | loss: 0.3688976
	speed: 0.0208s/iter; left time: 229.3130s
	iters: 500, epoch: 1 | loss: 0.3242333
	speed: 0.0209s/iter; left time: 227.5121s
Epoch: 1 cost time: 13.099961280822754
Epoch: 1, Steps: 570 | Train Loss: 0.3072776 Vali Loss: 0.0635447 Test Loss: 0.1786053
Validation loss decreased (inf --> 0.063545).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1897742
	speed: 0.0587s/iter; left time: 629.8796s
	iters: 200, epoch: 2 | loss: 0.5891153
	speed: 0.0190s/iter; left time: 201.8377s
	iters: 300, epoch: 2 | loss: 0.2883355
	speed: 0.0190s/iter; left time: 199.8334s
	iters: 400, epoch: 2 | loss: 0.1507711
	speed: 0.0190s/iter; left time: 197.7940s
	iters: 500, epoch: 2 | loss: 0.1833827
	speed: 0.0190s/iter; left time: 195.8928s
Epoch: 2 cost time: 11.118589878082275
Epoch: 2, Steps: 570 | Train Loss: 0.2681090 Vali Loss: 0.0624694 Test Loss: 0.1786789
Validation loss decreased (0.063545 --> 0.062469).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1649375
	speed: 0.0589s/iter; left time: 598.4502s
	iters: 200, epoch: 3 | loss: 0.1788609
	speed: 0.0189s/iter; left time: 189.8581s
	iters: 300, epoch: 3 | loss: 0.1947482
	speed: 0.0190s/iter; left time: 188.8418s
	iters: 400, epoch: 3 | loss: 0.2425351
	speed: 0.0191s/iter; left time: 188.4957s
	iters: 500, epoch: 3 | loss: 0.2817035
	speed: 0.0191s/iter; left time: 186.7773s
Epoch: 3 cost time: 11.12070345878601
Epoch: 3, Steps: 570 | Train Loss: 0.2410358 Vali Loss: 0.0631183 Test Loss: 0.1702424
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1540900
	speed: 0.0584s/iter; left time: 560.4470s
	iters: 200, epoch: 4 | loss: 0.2941101
	speed: 0.0209s/iter; left time: 198.2492s
	iters: 300, epoch: 4 | loss: 0.1636501
	speed: 0.0209s/iter; left time: 196.2989s
	iters: 400, epoch: 4 | loss: 0.2417484
	speed: 0.0210s/iter; left time: 194.9643s
	iters: 500, epoch: 4 | loss: 0.1856163
	speed: 0.0210s/iter; left time: 192.9265s
Epoch: 4 cost time: 12.220476865768433
Epoch: 4, Steps: 570 | Train Loss: 0.2178987 Vali Loss: 0.0632832 Test Loss: 0.1700603
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1762531
	speed: 0.0584s/iter; left time: 526.8257s
	iters: 200, epoch: 5 | loss: 0.3220015
	speed: 0.0192s/iter; left time: 171.5053s
	iters: 300, epoch: 5 | loss: 0.1489344
	speed: 0.0192s/iter; left time: 169.8032s
	iters: 400, epoch: 5 | loss: 0.1708648
	speed: 0.0192s/iter; left time: 167.7092s
	iters: 500, epoch: 5 | loss: 0.1593254
	speed: 0.0192s/iter; left time: 165.6165s
Epoch: 5 cost time: 11.258552074432373
Epoch: 5, Steps: 570 | Train Loss: 0.2111658 Vali Loss: 0.0593761 Test Loss: 0.1635990
Validation loss decreased (0.062469 --> 0.059376).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2397203
	speed: 0.0597s/iter; left time: 504.8619s
	iters: 200, epoch: 6 | loss: 0.2457219
	speed: 0.0209s/iter; left time: 174.4094s
	iters: 300, epoch: 6 | loss: 0.1633635
	speed: 0.0209s/iter; left time: 172.3009s
	iters: 400, epoch: 6 | loss: 0.1521265
	speed: 0.0209s/iter; left time: 170.2944s
	iters: 500, epoch: 6 | loss: 0.2515264
	speed: 0.0210s/iter; left time: 168.6833s
Epoch: 6 cost time: 12.207436561584473
Epoch: 6, Steps: 570 | Train Loss: 0.2006975 Vali Loss: 0.0586759 Test Loss: 0.1642092
Validation loss decreased (0.059376 --> 0.058676).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2224349
	speed: 0.0588s/iter; left time: 463.2455s
	iters: 200, epoch: 7 | loss: 0.2338411
	speed: 0.0190s/iter; left time: 148.1076s
	iters: 300, epoch: 7 | loss: 0.2719557
	speed: 0.0190s/iter; left time: 146.1921s
	iters: 400, epoch: 7 | loss: 0.3161416
	speed: 0.0190s/iter; left time: 144.3982s
	iters: 500, epoch: 7 | loss: 0.1665621
	speed: 0.0191s/iter; left time: 142.8376s
Epoch: 7 cost time: 11.175379037857056
Epoch: 7, Steps: 570 | Train Loss: 0.1945284 Vali Loss: 0.0596985 Test Loss: 0.1651743
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2725866
	speed: 0.0579s/iter; left time: 423.2568s
	iters: 200, epoch: 8 | loss: 0.2585613
	speed: 0.0191s/iter; left time: 138.0337s
	iters: 300, epoch: 8 | loss: 0.2563990
	speed: 0.0191s/iter; left time: 136.1116s
	iters: 400, epoch: 8 | loss: 0.1603610
	speed: 0.0191s/iter; left time: 134.2029s
	iters: 500, epoch: 8 | loss: 0.2072012
	speed: 0.0191s/iter; left time: 132.3293s
Epoch: 8 cost time: 11.204555988311768
Epoch: 8, Steps: 570 | Train Loss: 0.1912372 Vali Loss: 0.0585950 Test Loss: 0.1643800
Validation loss decreased (0.058676 --> 0.058595).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1484015
	speed: 0.0588s/iter; left time: 396.4647s
	iters: 200, epoch: 9 | loss: 0.1572453
	speed: 0.0192s/iter; left time: 127.6833s
	iters: 300, epoch: 9 | loss: 0.2903929
	speed: 0.0192s/iter; left time: 125.6139s
	iters: 400, epoch: 9 | loss: 0.1727037
	speed: 0.0192s/iter; left time: 123.7555s
	iters: 500, epoch: 9 | loss: 0.1098155
	speed: 0.0192s/iter; left time: 121.8106s
Epoch: 9 cost time: 11.252059698104858
Epoch: 9, Steps: 570 | Train Loss: 0.1892703 Vali Loss: 0.0585207 Test Loss: 0.1643788
Validation loss decreased (0.058595 --> 0.058521).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2391348
	speed: 0.0601s/iter; left time: 371.1380s
	iters: 200, epoch: 10 | loss: 0.1191047
	speed: 0.0189s/iter; left time: 114.9036s
	iters: 300, epoch: 10 | loss: 0.2457750
	speed: 0.0189s/iter; left time: 113.0201s
	iters: 400, epoch: 10 | loss: 0.2172185
	speed: 0.0189s/iter; left time: 111.0967s
	iters: 500, epoch: 10 | loss: 0.1814567
	speed: 0.0189s/iter; left time: 109.1882s
Epoch: 10 cost time: 11.106205701828003
Epoch: 10, Steps: 570 | Train Loss: 0.1883511 Vali Loss: 0.0584853 Test Loss: 0.1639752
Validation loss decreased (0.058521 --> 0.058485).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1710032
	speed: 0.0592s/iter; left time: 331.4266s
	iters: 200, epoch: 11 | loss: 0.1714001
	speed: 0.0192s/iter; left time: 105.3624s
	iters: 300, epoch: 11 | loss: 0.1431176
	speed: 0.0191s/iter; left time: 103.3775s
	iters: 400, epoch: 11 | loss: 0.2365137
	speed: 0.0191s/iter; left time: 101.4644s
	iters: 500, epoch: 11 | loss: 0.1492564
	speed: 0.0191s/iter; left time: 99.4942s
Epoch: 11 cost time: 11.22128415107727
Epoch: 11, Steps: 570 | Train Loss: 0.1880311 Vali Loss: 0.0585991 Test Loss: 0.1641587
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1611707
	speed: 0.0574s/iter; left time: 288.8042s
	iters: 200, epoch: 12 | loss: 0.1814352
	speed: 0.0191s/iter; left time: 94.3629s
	iters: 300, epoch: 12 | loss: 0.3350646
	speed: 0.0191s/iter; left time: 92.5128s
	iters: 400, epoch: 12 | loss: 0.2441531
	speed: 0.0190s/iter; left time: 89.9437s
	iters: 500, epoch: 12 | loss: 0.2772302
	speed: 0.0190s/iter; left time: 87.8411s
Epoch: 12 cost time: 11.170199871063232
Epoch: 12, Steps: 570 | Train Loss: 0.1877626 Vali Loss: 0.0584666 Test Loss: 0.1642219
Validation loss decreased (0.058485 --> 0.058467).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1725542
	speed: 0.0577s/iter; left time: 257.3178s
	iters: 200, epoch: 13 | loss: 0.1736616
	speed: 0.0190s/iter; left time: 82.9060s
	iters: 300, epoch: 13 | loss: 0.1994443
	speed: 0.0190s/iter; left time: 81.0221s
	iters: 400, epoch: 13 | loss: 0.1422995
	speed: 0.0190s/iter; left time: 79.1231s
	iters: 500, epoch: 13 | loss: 0.1748704
	speed: 0.0189s/iter; left time: 76.8968s
Epoch: 13 cost time: 11.1414315700531
Epoch: 13, Steps: 570 | Train Loss: 0.1873977 Vali Loss: 0.0586605 Test Loss: 0.1642319
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2812103
	speed: 0.0576s/iter; left time: 223.9821s
	iters: 200, epoch: 14 | loss: 0.2077650
	speed: 0.0191s/iter; left time: 72.3990s
	iters: 300, epoch: 14 | loss: 0.1620535
	speed: 0.0191s/iter; left time: 70.3206s
	iters: 400, epoch: 14 | loss: 0.1186182
	speed: 0.0190s/iter; left time: 68.3656s
	iters: 500, epoch: 14 | loss: 0.1526008
	speed: 0.0190s/iter; left time: 66.5013s
Epoch: 14 cost time: 11.207809448242188
Epoch: 14, Steps: 570 | Train Loss: 0.1874303 Vali Loss: 0.0584769 Test Loss: 0.1642397
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1220352
	speed: 0.0604s/iter; left time: 200.5347s
	iters: 200, epoch: 15 | loss: 0.2429871
	speed: 0.0190s/iter; left time: 61.1902s
	iters: 300, epoch: 15 | loss: 0.1776120
	speed: 0.0190s/iter; left time: 59.3003s
	iters: 400, epoch: 15 | loss: 0.1808693
	speed: 0.0190s/iter; left time: 57.3970s
	iters: 500, epoch: 15 | loss: 0.1404826
	speed: 0.0190s/iter; left time: 55.4865s
Epoch: 15 cost time: 11.15330982208252
Epoch: 15, Steps: 570 | Train Loss: 0.1875341 Vali Loss: 0.0586241 Test Loss: 0.1642427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16442342102527618, mae:0.2625240385532379
>>> MS_Raw LR=1e-3 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1777191
	speed: 0.0220s/iter; left time: 249.1676s
	iters: 200, epoch: 1 | loss: 0.1935108
	speed: 0.0106s/iter; left time: 118.2549s
	iters: 300, epoch: 1 | loss: 0.2110804
	speed: 0.0106s/iter; left time: 117.2606s
	iters: 400, epoch: 1 | loss: 0.2278834
	speed: 0.0105s/iter; left time: 115.8446s
	iters: 500, epoch: 1 | loss: 0.2286975
	speed: 0.0105s/iter; left time: 114.7623s
Epoch: 1 cost time: 7.206924915313721
Epoch: 1, Steps: 570 | Train Loss: 0.2393754 Vali Loss: 0.0499301 Test Loss: 0.1551164
Validation loss decreased (inf --> 0.049930).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3729154
	speed: 0.0367s/iter; left time: 393.8965s
	iters: 200, epoch: 2 | loss: 0.3245559
	speed: 0.0106s/iter; left time: 112.5128s
	iters: 300, epoch: 2 | loss: 0.2269728
	speed: 0.0106s/iter; left time: 111.7102s
	iters: 400, epoch: 2 | loss: 0.1790629
	speed: 0.0106s/iter; left time: 110.1903s
	iters: 500, epoch: 2 | loss: 0.2005681
	speed: 0.0106s/iter; left time: 109.4021s
Epoch: 2 cost time: 6.346376180648804
Epoch: 2, Steps: 570 | Train Loss: 0.2194005 Vali Loss: 0.0467984 Test Loss: 0.1458801
Validation loss decreased (0.049930 --> 0.046798).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1609079
	speed: 0.0362s/iter; left time: 368.0135s
	iters: 200, epoch: 3 | loss: 0.2279218
	speed: 0.0106s/iter; left time: 106.4611s
	iters: 300, epoch: 3 | loss: 0.1517598
	speed: 0.0106s/iter; left time: 105.5501s
	iters: 400, epoch: 3 | loss: 0.1926924
	speed: 0.0106s/iter; left time: 104.2501s
	iters: 500, epoch: 3 | loss: 0.2619040
	speed: 0.0106s/iter; left time: 103.0484s
Epoch: 3 cost time: 6.312310695648193
Epoch: 3, Steps: 570 | Train Loss: 0.1928285 Vali Loss: 0.0434940 Test Loss: 0.1316906
Validation loss decreased (0.046798 --> 0.043494).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1974011
	speed: 0.0382s/iter; left time: 365.9013s
	iters: 200, epoch: 4 | loss: 0.0997751
	speed: 0.0106s/iter; left time: 100.4139s
	iters: 300, epoch: 4 | loss: 0.1813466
	speed: 0.0106s/iter; left time: 99.4201s
	iters: 400, epoch: 4 | loss: 0.1814042
	speed: 0.0105s/iter; left time: 97.9981s
	iters: 500, epoch: 4 | loss: 0.1456451
	speed: 0.0105s/iter; left time: 96.9235s
Epoch: 4 cost time: 6.325330495834351
Epoch: 4, Steps: 570 | Train Loss: 0.1741642 Vali Loss: 0.0419364 Test Loss: 0.1319740
Validation loss decreased (0.043494 --> 0.041936).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2005041
	speed: 0.0370s/iter; left time: 333.6540s
	iters: 200, epoch: 5 | loss: 0.1612382
	speed: 0.0106s/iter; left time: 94.2283s
	iters: 300, epoch: 5 | loss: 0.1828484
	speed: 0.0115s/iter; left time: 101.0394s
	iters: 400, epoch: 5 | loss: 0.1539630
	speed: 0.0121s/iter; left time: 105.1444s
	iters: 500, epoch: 5 | loss: 0.1531187
	speed: 0.0121s/iter; left time: 104.0089s
Epoch: 5 cost time: 6.816124677658081
Epoch: 5, Steps: 570 | Train Loss: 0.1631698 Vali Loss: 0.0412901 Test Loss: 0.1334837
Validation loss decreased (0.041936 --> 0.041290).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1511397
	speed: 0.0388s/iter; left time: 328.2072s
	iters: 200, epoch: 6 | loss: 0.1123220
	speed: 0.0120s/iter; left time: 99.9593s
	iters: 300, epoch: 6 | loss: 0.2148315
	speed: 0.0120s/iter; left time: 98.8255s
	iters: 400, epoch: 6 | loss: 0.1687021
	speed: 0.0120s/iter; left time: 97.7823s
	iters: 500, epoch: 6 | loss: 0.1469876
	speed: 0.0120s/iter; left time: 96.2371s
Epoch: 6 cost time: 7.126294374465942
Epoch: 6, Steps: 570 | Train Loss: 0.1537006 Vali Loss: 0.0401119 Test Loss: 0.1313482
Validation loss decreased (0.041290 --> 0.040112).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1674063
	speed: 0.0399s/iter; left time: 314.7231s
	iters: 200, epoch: 7 | loss: 0.2014802
	speed: 0.0122s/iter; left time: 94.6757s
	iters: 300, epoch: 7 | loss: 0.1516421
	speed: 0.0121s/iter; left time: 92.8379s
	iters: 400, epoch: 7 | loss: 0.1144426
	speed: 0.0120s/iter; left time: 91.2222s
	iters: 500, epoch: 7 | loss: 0.1227431
	speed: 0.0120s/iter; left time: 89.8959s
Epoch: 7 cost time: 7.1979289054870605
Epoch: 7, Steps: 570 | Train Loss: 0.1511042 Vali Loss: 0.0403949 Test Loss: 0.1302827
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1535092
	speed: 0.0399s/iter; left time: 292.0345s
	iters: 200, epoch: 8 | loss: 0.1330004
	speed: 0.0121s/iter; left time: 87.0838s
	iters: 300, epoch: 8 | loss: 0.1745556
	speed: 0.0119s/iter; left time: 84.7685s
	iters: 400, epoch: 8 | loss: 0.2076908
	speed: 0.0118s/iter; left time: 82.7958s
	iters: 500, epoch: 8 | loss: 0.1386951
	speed: 0.0118s/iter; left time: 81.3673s
Epoch: 8 cost time: 7.036319971084595
Epoch: 8, Steps: 570 | Train Loss: 0.1473867 Vali Loss: 0.0400983 Test Loss: 0.1308237
Validation loss decreased (0.040112 --> 0.040098).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2033126
	speed: 0.0377s/iter; left time: 254.2834s
	iters: 200, epoch: 9 | loss: 0.1391253
	speed: 0.0107s/iter; left time: 71.3613s
	iters: 300, epoch: 9 | loss: 0.0781884
	speed: 0.0105s/iter; left time: 68.6273s
	iters: 400, epoch: 9 | loss: 0.1423060
	speed: 0.0105s/iter; left time: 67.5980s
	iters: 500, epoch: 9 | loss: 0.1406676
	speed: 0.0115s/iter; left time: 73.1579s
Epoch: 9 cost time: 6.631273031234741
Epoch: 9, Steps: 570 | Train Loss: 0.1468509 Vali Loss: 0.0405770 Test Loss: 0.1315916
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1316060
	speed: 0.0383s/iter; left time: 236.4510s
	iters: 200, epoch: 10 | loss: 0.1492279
	speed: 0.0118s/iter; left time: 71.7807s
	iters: 300, epoch: 10 | loss: 0.1004063
	speed: 0.0118s/iter; left time: 70.7442s
	iters: 400, epoch: 10 | loss: 0.1272062
	speed: 0.0118s/iter; left time: 69.2800s
	iters: 500, epoch: 10 | loss: 0.1947585
	speed: 0.0118s/iter; left time: 68.0993s
Epoch: 10 cost time: 6.9936277866363525
Epoch: 10, Steps: 570 | Train Loss: 0.1463307 Vali Loss: 0.0401553 Test Loss: 0.1311446
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1390495
	speed: 0.0380s/iter; left time: 212.8760s
	iters: 200, epoch: 11 | loss: 0.1162399
	speed: 0.0116s/iter; left time: 63.7912s
	iters: 300, epoch: 11 | loss: 0.1146599
	speed: 0.0121s/iter; left time: 65.3353s
	iters: 400, epoch: 11 | loss: 0.1900888
	speed: 0.0121s/iter; left time: 64.1521s
	iters: 500, epoch: 11 | loss: 0.1377741
	speed: 0.0121s/iter; left time: 63.0719s
Epoch: 11 cost time: 6.961166858673096
Epoch: 11, Steps: 570 | Train Loss: 0.1467670 Vali Loss: 0.0401198 Test Loss: 0.1309380
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1310017704963684, mae:0.22413523495197296
>>> MS_Raw LR=1e-3 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2011288
	speed: 0.0219s/iter; left time: 248.0521s
	iters: 200, epoch: 1 | loss: 0.2121019
	speed: 0.0103s/iter; left time: 115.1146s
	iters: 300, epoch: 1 | loss: 0.2554605
	speed: 0.0103s/iter; left time: 114.5222s
	iters: 400, epoch: 1 | loss: 0.2007774
	speed: 0.0103s/iter; left time: 113.5030s
	iters: 500, epoch: 1 | loss: 0.1596668
	speed: 0.0103s/iter; left time: 112.5690s
Epoch: 1 cost time: 7.090914964675903
Epoch: 1, Steps: 570 | Train Loss: 0.1986092 Vali Loss: 0.0408514 Test Loss: 0.1363988
Validation loss decreased (inf --> 0.040851).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1544909
	speed: 0.0371s/iter; left time: 397.9906s
	iters: 200, epoch: 2 | loss: 0.1977520
	speed: 0.0104s/iter; left time: 110.1813s
	iters: 300, epoch: 2 | loss: 0.1335832
	speed: 0.0104s/iter; left time: 109.5719s
	iters: 400, epoch: 2 | loss: 0.1909222
	speed: 0.0104s/iter; left time: 108.0722s
	iters: 500, epoch: 2 | loss: 0.1895629
	speed: 0.0104s/iter; left time: 107.4503s
Epoch: 2 cost time: 6.21839451789856
Epoch: 2, Steps: 570 | Train Loss: 0.1816486 Vali Loss: 0.0411289 Test Loss: 0.1282441
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0831251
	speed: 0.0361s/iter; left time: 366.3673s
	iters: 200, epoch: 3 | loss: 0.1447144
	speed: 0.0103s/iter; left time: 103.4428s
	iters: 300, epoch: 3 | loss: 0.3137289
	speed: 0.0103s/iter; left time: 102.7084s
	iters: 400, epoch: 3 | loss: 0.1911944
	speed: 0.0103s/iter; left time: 101.7955s
	iters: 500, epoch: 3 | loss: 0.1429696
	speed: 0.0103s/iter; left time: 100.1497s
Epoch: 3 cost time: 6.148053169250488
Epoch: 3, Steps: 570 | Train Loss: 0.1624195 Vali Loss: 0.0374713 Test Loss: 0.1170176
Validation loss decreased (0.040851 --> 0.037471).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1103782
	speed: 0.0364s/iter; left time: 348.7019s
	iters: 200, epoch: 4 | loss: 0.1187697
	speed: 0.0102s/iter; left time: 96.5816s
	iters: 300, epoch: 4 | loss: 0.0884880
	speed: 0.0102s/iter; left time: 95.9156s
	iters: 400, epoch: 4 | loss: 0.0976685
	speed: 0.0102s/iter; left time: 94.6244s
	iters: 500, epoch: 4 | loss: 0.1811225
	speed: 0.0102s/iter; left time: 93.7194s
Epoch: 4 cost time: 6.108402729034424
Epoch: 4, Steps: 570 | Train Loss: 0.1434960 Vali Loss: 0.0341161 Test Loss: 0.1104835
Validation loss decreased (0.037471 --> 0.034116).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1103035
	speed: 0.0358s/iter; left time: 322.6398s
	iters: 200, epoch: 5 | loss: 0.1790779
	speed: 0.0102s/iter; left time: 91.3693s
	iters: 300, epoch: 5 | loss: 0.1173813
	speed: 0.0102s/iter; left time: 90.0719s
	iters: 400, epoch: 5 | loss: 0.1384535
	speed: 0.0102s/iter; left time: 89.3581s
	iters: 500, epoch: 5 | loss: 0.1380685
	speed: 0.0102s/iter; left time: 88.2715s
Epoch: 5 cost time: 6.1290106773376465
Epoch: 5, Steps: 570 | Train Loss: 0.1332018 Vali Loss: 0.0354310 Test Loss: 0.1137024
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0893482
	speed: 0.0363s/iter; left time: 306.8207s
	iters: 200, epoch: 6 | loss: 0.1794420
	speed: 0.0102s/iter; left time: 85.3625s
	iters: 300, epoch: 6 | loss: 0.1483492
	speed: 0.0103s/iter; left time: 84.6473s
	iters: 400, epoch: 6 | loss: 0.0914391
	speed: 0.0102s/iter; left time: 83.5082s
	iters: 500, epoch: 6 | loss: 0.0890388
	speed: 0.0102s/iter; left time: 82.3407s
Epoch: 6 cost time: 6.120213270187378
Epoch: 6, Steps: 570 | Train Loss: 0.1277808 Vali Loss: 0.0344818 Test Loss: 0.1114692
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1217993
	speed: 0.0355s/iter; left time: 279.8397s
	iters: 200, epoch: 7 | loss: 0.1507055
	speed: 0.0102s/iter; left time: 79.4368s
	iters: 300, epoch: 7 | loss: 0.2469890
	speed: 0.0102s/iter; left time: 78.3313s
	iters: 400, epoch: 7 | loss: 0.1859451
	speed: 0.0102s/iter; left time: 77.3706s
	iters: 500, epoch: 7 | loss: 0.1438853
	speed: 0.0102s/iter; left time: 76.3611s
Epoch: 7 cost time: 6.126203298568726
Epoch: 7, Steps: 570 | Train Loss: 0.1256190 Vali Loss: 0.0339808 Test Loss: 0.1099915
Validation loss decreased (0.034116 --> 0.033981).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1184343
	speed: 0.0370s/iter; left time: 270.6820s
	iters: 200, epoch: 8 | loss: 0.0885658
	speed: 0.0103s/iter; left time: 74.0794s
	iters: 300, epoch: 8 | loss: 0.1112555
	speed: 0.0103s/iter; left time: 72.9194s
	iters: 400, epoch: 8 | loss: 0.1127180
	speed: 0.0103s/iter; left time: 72.0324s
	iters: 500, epoch: 8 | loss: 0.0920499
	speed: 0.0103s/iter; left time: 71.0934s
Epoch: 8 cost time: 6.165135860443115
Epoch: 8, Steps: 570 | Train Loss: 0.1232764 Vali Loss: 0.0343710 Test Loss: 0.1123049
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1152850
	speed: 0.0345s/iter; left time: 232.8175s
	iters: 200, epoch: 9 | loss: 0.1366268
	speed: 0.0102s/iter; left time: 67.4947s
	iters: 300, epoch: 9 | loss: 0.1035083
	speed: 0.0102s/iter; left time: 66.8944s
	iters: 400, epoch: 9 | loss: 0.1578759
	speed: 0.0103s/iter; left time: 66.1269s
	iters: 500, epoch: 9 | loss: 0.1022582
	speed: 0.0103s/iter; left time: 65.0911s
Epoch: 9 cost time: 6.110942602157593
Epoch: 9, Steps: 570 | Train Loss: 0.1214196 Vali Loss: 0.0341249 Test Loss: 0.1114252
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1141844
	speed: 0.0349s/iter; left time: 215.5442s
	iters: 200, epoch: 10 | loss: 0.1014069
	speed: 0.0103s/iter; left time: 62.3574s
	iters: 300, epoch: 10 | loss: 0.1240180
	speed: 0.0103s/iter; left time: 61.3275s
	iters: 400, epoch: 10 | loss: 0.0875974
	speed: 0.0102s/iter; left time: 60.1644s
	iters: 500, epoch: 10 | loss: 0.0761100
	speed: 0.0103s/iter; left time: 59.3238s
Epoch: 10 cost time: 6.106062412261963
Epoch: 10, Steps: 570 | Train Loss: 0.1217547 Vali Loss: 0.0341139 Test Loss: 0.1113909
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11014990508556366, mae:0.20213402807712555
>>> MS_Raw LR=1e-3 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2760210
	speed: 0.0235s/iter; left time: 265.3804s
	iters: 200, epoch: 1 | loss: 0.1569620
	speed: 0.0105s/iter; left time: 117.4833s
	iters: 300, epoch: 1 | loss: 0.1703339
	speed: 0.0104s/iter; left time: 115.1175s
	iters: 400, epoch: 1 | loss: 0.1834075
	speed: 0.0104s/iter; left time: 113.9392s
	iters: 500, epoch: 1 | loss: 0.2316654
	speed: 0.0104s/iter; left time: 113.3207s
Epoch: 1 cost time: 7.290808439254761
Epoch: 1, Steps: 570 | Train Loss: 0.2487522 Vali Loss: 0.0535518 Test Loss: 0.1598241
Validation loss decreased (inf --> 0.053552).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2102094
	speed: 0.0387s/iter; left time: 415.3879s
	iters: 200, epoch: 2 | loss: 0.5037255
	speed: 0.0104s/iter; left time: 110.1972s
	iters: 300, epoch: 2 | loss: 0.3371377
	speed: 0.0104s/iter; left time: 109.1616s
	iters: 400, epoch: 2 | loss: 0.4152882
	speed: 0.0104s/iter; left time: 108.4938s
	iters: 500, epoch: 2 | loss: 0.3067176
	speed: 0.0103s/iter; left time: 106.7451s
Epoch: 2 cost time: 6.230154514312744
Epoch: 2, Steps: 570 | Train Loss: 0.2717112 Vali Loss: 0.0605821 Test Loss: 0.1763985
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1737072
	speed: 0.0376s/iter; left time: 381.7730s
	iters: 200, epoch: 3 | loss: 0.2173738
	speed: 0.0105s/iter; left time: 105.7993s
	iters: 300, epoch: 3 | loss: 0.3133671
	speed: 0.0105s/iter; left time: 104.4302s
	iters: 400, epoch: 3 | loss: 0.2098190
	speed: 0.0105s/iter; left time: 103.1974s
	iters: 500, epoch: 3 | loss: 0.2057551
	speed: 0.0104s/iter; left time: 101.7256s
Epoch: 3 cost time: 6.352153062820435
Epoch: 3, Steps: 570 | Train Loss: 0.2512181 Vali Loss: 0.0534191 Test Loss: 0.1621263
Validation loss decreased (0.053552 --> 0.053419).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1413024
	speed: 0.0382s/iter; left time: 366.4459s
	iters: 200, epoch: 4 | loss: 0.1723188
	speed: 0.0116s/iter; left time: 110.5426s
	iters: 300, epoch: 4 | loss: 0.1920038
	speed: 0.0104s/iter; left time: 98.0018s
	iters: 400, epoch: 4 | loss: 0.3015375
	speed: 0.0104s/iter; left time: 96.4748s
	iters: 500, epoch: 4 | loss: 0.1878215
	speed: 0.0104s/iter; left time: 95.3659s
Epoch: 4 cost time: 6.4830543994903564
Epoch: 4, Steps: 570 | Train Loss: 0.2239809 Vali Loss: 0.0535721 Test Loss: 0.1619853
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2102711
	speed: 0.0377s/iter; left time: 340.2459s
	iters: 200, epoch: 5 | loss: 0.1812565
	speed: 0.0103s/iter; left time: 92.1915s
	iters: 300, epoch: 5 | loss: 0.2270057
	speed: 0.0103s/iter; left time: 91.2172s
	iters: 400, epoch: 5 | loss: 0.1802817
	speed: 0.0103s/iter; left time: 90.1621s
	iters: 500, epoch: 5 | loss: 0.3264125
	speed: 0.0103s/iter; left time: 89.0996s
Epoch: 5 cost time: 6.194150686264038
Epoch: 5, Steps: 570 | Train Loss: 0.2111830 Vali Loss: 0.0497295 Test Loss: 0.1540494
Validation loss decreased (0.053419 --> 0.049729).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1856858
	speed: 0.0379s/iter; left time: 319.9769s
	iters: 200, epoch: 6 | loss: 0.2089431
	speed: 0.0117s/iter; left time: 97.3093s
	iters: 300, epoch: 6 | loss: 0.1692455
	speed: 0.0108s/iter; left time: 88.9282s
	iters: 400, epoch: 6 | loss: 0.1765668
	speed: 0.0103s/iter; left time: 84.2246s
	iters: 500, epoch: 6 | loss: 0.2485469
	speed: 0.0103s/iter; left time: 83.2185s
Epoch: 6 cost time: 6.41654372215271
Epoch: 6, Steps: 570 | Train Loss: 0.2018977 Vali Loss: 0.0494379 Test Loss: 0.1522202
Validation loss decreased (0.049729 --> 0.049438).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1340874
	speed: 0.0363s/iter; left time: 285.9193s
	iters: 200, epoch: 7 | loss: 0.1357253
	speed: 0.0104s/iter; left time: 81.0465s
	iters: 300, epoch: 7 | loss: 0.1856140
	speed: 0.0104s/iter; left time: 80.2512s
	iters: 400, epoch: 7 | loss: 0.1292744
	speed: 0.0104s/iter; left time: 78.7787s
	iters: 500, epoch: 7 | loss: 0.2150543
	speed: 0.0104s/iter; left time: 77.4539s
Epoch: 7 cost time: 6.229576349258423
Epoch: 7, Steps: 570 | Train Loss: 0.1983729 Vali Loss: 0.0494550 Test Loss: 0.1508071
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1108174
	speed: 0.0366s/iter; left time: 267.5504s
	iters: 200, epoch: 8 | loss: 0.1593016
	speed: 0.0104s/iter; left time: 75.0348s
	iters: 300, epoch: 8 | loss: 0.1904207
	speed: 0.0104s/iter; left time: 73.6800s
	iters: 400, epoch: 8 | loss: 0.1893917
	speed: 0.0104s/iter; left time: 72.7979s
	iters: 500, epoch: 8 | loss: 0.1773364
	speed: 0.0110s/iter; left time: 75.8226s
Epoch: 8 cost time: 6.39841365814209
Epoch: 8, Steps: 570 | Train Loss: 0.1954682 Vali Loss: 0.0490171 Test Loss: 0.1501433
Validation loss decreased (0.049438 --> 0.049017).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1811720
	speed: 0.0380s/iter; left time: 256.1685s
	iters: 200, epoch: 9 | loss: 0.2337634
	speed: 0.0104s/iter; left time: 68.8694s
	iters: 300, epoch: 9 | loss: 0.1826662
	speed: 0.0104s/iter; left time: 68.0846s
	iters: 400, epoch: 9 | loss: 0.1685027
	speed: 0.0104s/iter; left time: 67.0631s
	iters: 500, epoch: 9 | loss: 0.2114587
	speed: 0.0104s/iter; left time: 65.9980s
Epoch: 9 cost time: 6.262510538101196
Epoch: 9, Steps: 570 | Train Loss: 0.1932855 Vali Loss: 0.0489839 Test Loss: 0.1497300
Validation loss decreased (0.049017 --> 0.048984).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1468959
	speed: 0.0380s/iter; left time: 234.7254s
	iters: 200, epoch: 10 | loss: 0.2943932
	speed: 0.0116s/iter; left time: 70.6998s
	iters: 300, epoch: 10 | loss: 0.2734065
	speed: 0.0116s/iter; left time: 69.3118s
	iters: 400, epoch: 10 | loss: 0.2248660
	speed: 0.0117s/iter; left time: 68.3994s
	iters: 500, epoch: 10 | loss: 0.2291971
	speed: 0.0107s/iter; left time: 61.5740s
Epoch: 10 cost time: 6.770306587219238
Epoch: 10, Steps: 570 | Train Loss: 0.1929867 Vali Loss: 0.0490412 Test Loss: 0.1497344
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2016304
	speed: 0.0359s/iter; left time: 200.8548s
	iters: 200, epoch: 11 | loss: 0.1890531
	speed: 0.0103s/iter; left time: 56.7442s
	iters: 300, epoch: 11 | loss: 0.2562253
	speed: 0.0104s/iter; left time: 55.9239s
	iters: 400, epoch: 11 | loss: 0.1936106
	speed: 0.0104s/iter; left time: 55.0030s
	iters: 500, epoch: 11 | loss: 0.1959444
	speed: 0.0103s/iter; left time: 53.6188s
Epoch: 11 cost time: 6.1896820068359375
Epoch: 11, Steps: 570 | Train Loss: 0.1928420 Vali Loss: 0.0488997 Test Loss: 0.1497000
Validation loss decreased (0.048984 --> 0.048900).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1751735
	speed: 0.0374s/iter; left time: 188.0470s
	iters: 200, epoch: 12 | loss: 0.2051178
	speed: 0.0104s/iter; left time: 51.0885s
	iters: 300, epoch: 12 | loss: 0.1418368
	speed: 0.0103s/iter; left time: 49.9818s
	iters: 400, epoch: 12 | loss: 0.1730569
	speed: 0.0104s/iter; left time: 49.0283s
	iters: 500, epoch: 12 | loss: 0.0879592
	speed: 0.0103s/iter; left time: 47.8984s
Epoch: 12 cost time: 6.222593307495117
Epoch: 12, Steps: 570 | Train Loss: 0.1935263 Vali Loss: 0.0489174 Test Loss: 0.1497241
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1612099
	speed: 0.0389s/iter; left time: 173.3918s
	iters: 200, epoch: 13 | loss: 0.2018778
	speed: 0.0103s/iter; left time: 44.9099s
	iters: 300, epoch: 13 | loss: 0.1750134
	speed: 0.0103s/iter; left time: 43.9604s
	iters: 400, epoch: 13 | loss: 0.2200643
	speed: 0.0103s/iter; left time: 43.0150s
	iters: 500, epoch: 13 | loss: 0.1767964
	speed: 0.0103s/iter; left time: 42.0082s
Epoch: 13 cost time: 6.200184345245361
Epoch: 13, Steps: 570 | Train Loss: 0.1924223 Vali Loss: 0.0490513 Test Loss: 0.1496656
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1728437
	speed: 0.0374s/iter; left time: 145.4439s
	iters: 200, epoch: 14 | loss: 0.2402483
	speed: 0.0116s/iter; left time: 44.1132s
	iters: 300, epoch: 14 | loss: 0.1398079
	speed: 0.0116s/iter; left time: 42.9203s
	iters: 400, epoch: 14 | loss: 0.1153657
	speed: 0.0116s/iter; left time: 41.7350s
	iters: 500, epoch: 14 | loss: 0.2750791
	speed: 0.0116s/iter; left time: 40.6321s
Epoch: 14 cost time: 6.957946062088013
Epoch: 14, Steps: 570 | Train Loss: 0.1909967 Vali Loss: 0.0488073 Test Loss: 0.1496678
Validation loss decreased (0.048900 --> 0.048807).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1617509
	speed: 0.0378s/iter; left time: 125.6373s
	iters: 200, epoch: 15 | loss: 0.2353400
	speed: 0.0104s/iter; left time: 33.5156s
	iters: 300, epoch: 15 | loss: 0.1058330
	speed: 0.0104s/iter; left time: 32.4307s
	iters: 400, epoch: 15 | loss: 0.0849429
	speed: 0.0104s/iter; left time: 31.4167s
	iters: 500, epoch: 15 | loss: 0.2182889
	speed: 0.0104s/iter; left time: 30.3334s
Epoch: 15 cost time: 6.209580421447754
Epoch: 15, Steps: 570 | Train Loss: 0.1929903 Vali Loss: 0.0488566 Test Loss: 0.1496770
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.1995316
	speed: 0.0359s/iter; left time: 98.6355s
	iters: 200, epoch: 16 | loss: 0.1273779
	speed: 0.0103s/iter; left time: 27.4093s
	iters: 300, epoch: 16 | loss: 0.1738085
	speed: 0.0104s/iter; left time: 26.4477s
	iters: 400, epoch: 16 | loss: 0.1989763
	speed: 0.0104s/iter; left time: 25.3825s
	iters: 500, epoch: 16 | loss: 0.1810515
	speed: 0.0103s/iter; left time: 24.2960s
Epoch: 16 cost time: 6.189153671264648
Epoch: 16, Steps: 570 | Train Loss: 0.1922915 Vali Loss: 0.0491062 Test Loss: 0.1496811
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1572271
	speed: 0.0369s/iter; left time: 80.4220s
	iters: 200, epoch: 17 | loss: 0.1318000
	speed: 0.0103s/iter; left time: 21.4776s
	iters: 300, epoch: 17 | loss: 0.1215536
	speed: 0.0103s/iter; left time: 20.4628s
	iters: 400, epoch: 17 | loss: 0.1946611
	speed: 0.0103s/iter; left time: 19.3943s
	iters: 500, epoch: 17 | loss: 0.1164205
	speed: 0.0103s/iter; left time: 18.3600s
Epoch: 17 cost time: 6.186206102371216
Epoch: 17, Steps: 570 | Train Loss: 0.1921213 Vali Loss: 0.0491891 Test Loss: 0.1496846
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14987124502658844, mae:0.24645471572875977
>>> MS_Raw LR=1e-3 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3265904
	speed: 0.0237s/iter; left time: 267.8213s
	iters: 200, epoch: 1 | loss: 0.2824314
	speed: 0.0119s/iter; left time: 132.8077s
	iters: 300, epoch: 1 | loss: 0.2027302
	speed: 0.0119s/iter; left time: 131.7485s
	iters: 400, epoch: 1 | loss: 0.1829416
	speed: 0.0118s/iter; left time: 130.3277s
	iters: 500, epoch: 1 | loss: 0.2720419
	speed: 0.0118s/iter; left time: 128.6727s
Epoch: 1 cost time: 7.983585834503174
Epoch: 1, Steps: 570 | Train Loss: 0.2819023 Vali Loss: 0.0710527 Test Loss: 0.1796554
Validation loss decreased (inf --> 0.071053).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2995609
	speed: 0.0391s/iter; left time: 419.5703s
	iters: 200, epoch: 2 | loss: 0.2093853
	speed: 0.0119s/iter; left time: 126.2715s
	iters: 300, epoch: 2 | loss: 0.2064758
	speed: 0.0119s/iter; left time: 125.0471s
	iters: 400, epoch: 2 | loss: 0.1652062
	speed: 0.0119s/iter; left time: 123.6346s
	iters: 500, epoch: 2 | loss: 0.2448857
	speed: 0.0119s/iter; left time: 122.5999s
Epoch: 2 cost time: 7.0721282958984375
Epoch: 2, Steps: 570 | Train Loss: 0.3054748 Vali Loss: 0.0641825 Test Loss: 0.1975380
Validation loss decreased (0.071053 --> 0.064182).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3358017
	speed: 0.0397s/iter; left time: 403.3540s
	iters: 200, epoch: 3 | loss: 0.4676081
	speed: 0.0118s/iter; left time: 119.1195s
	iters: 300, epoch: 3 | loss: 0.1594378
	speed: 0.0118s/iter; left time: 117.8367s
	iters: 400, epoch: 3 | loss: 0.2910548
	speed: 0.0119s/iter; left time: 117.6980s
	iters: 500, epoch: 3 | loss: 0.2464300
	speed: 0.0129s/iter; left time: 125.8273s
Epoch: 3 cost time: 7.253817081451416
Epoch: 3, Steps: 570 | Train Loss: 0.2865843 Vali Loss: 0.0679678 Test Loss: 0.1888290
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1879116
	speed: 0.0392s/iter; left time: 376.3254s
	iters: 200, epoch: 4 | loss: 0.3424387
	speed: 0.0119s/iter; left time: 112.5727s
	iters: 300, epoch: 4 | loss: 0.1733771
	speed: 0.0119s/iter; left time: 111.4835s
	iters: 400, epoch: 4 | loss: 0.1620296
	speed: 0.0119s/iter; left time: 110.2641s
	iters: 500, epoch: 4 | loss: 0.2221527
	speed: 0.0119s/iter; left time: 109.2555s
Epoch: 4 cost time: 7.057035207748413
Epoch: 4, Steps: 570 | Train Loss: 0.2680516 Vali Loss: 0.0610722 Test Loss: 0.1731480
Validation loss decreased (0.064182 --> 0.061072).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2432520
	speed: 0.0392s/iter; left time: 353.2365s
	iters: 200, epoch: 5 | loss: 0.2601934
	speed: 0.0118s/iter; left time: 105.3472s
	iters: 300, epoch: 5 | loss: 0.2983795
	speed: 0.0118s/iter; left time: 104.0914s
	iters: 400, epoch: 5 | loss: 0.2202662
	speed: 0.0118s/iter; left time: 102.9798s
	iters: 500, epoch: 5 | loss: 0.2291308
	speed: 0.0118s/iter; left time: 101.7882s
Epoch: 5 cost time: 7.008415699005127
Epoch: 5, Steps: 570 | Train Loss: 0.2547676 Vali Loss: 0.0613823 Test Loss: 0.1707520
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2284081
	speed: 0.0385s/iter; left time: 325.5185s
	iters: 200, epoch: 6 | loss: 0.1313824
	speed: 0.0118s/iter; left time: 98.7621s
	iters: 300, epoch: 6 | loss: 0.2413198
	speed: 0.0118s/iter; left time: 97.5564s
	iters: 400, epoch: 6 | loss: 0.3221701
	speed: 0.0118s/iter; left time: 96.4483s
	iters: 500, epoch: 6 | loss: 0.1760595
	speed: 0.0118s/iter; left time: 95.0769s
Epoch: 6 cost time: 7.025369167327881
Epoch: 6, Steps: 570 | Train Loss: 0.2456368 Vali Loss: 0.0611322 Test Loss: 0.1657845
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2951231
	speed: 0.0395s/iter; left time: 311.3315s
	iters: 200, epoch: 7 | loss: 0.2469725
	speed: 0.0129s/iter; left time: 100.1762s
	iters: 300, epoch: 7 | loss: 0.2372079
	speed: 0.0118s/iter; left time: 90.9045s
	iters: 400, epoch: 7 | loss: 0.1685892
	speed: 0.0118s/iter; left time: 89.7271s
	iters: 500, epoch: 7 | loss: 0.2855080
	speed: 0.0118s/iter; left time: 88.4827s
Epoch: 7 cost time: 7.242494344711304
Epoch: 7, Steps: 570 | Train Loss: 0.2416486 Vali Loss: 0.0592097 Test Loss: 0.1649025
Validation loss decreased (0.061072 --> 0.059210).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1336527
	speed: 0.0404s/iter; left time: 295.1387s
	iters: 200, epoch: 8 | loss: 0.2625571
	speed: 0.0129s/iter; left time: 92.9663s
	iters: 300, epoch: 8 | loss: 0.1553656
	speed: 0.0118s/iter; left time: 84.2179s
	iters: 400, epoch: 8 | loss: 0.1543682
	speed: 0.0118s/iter; left time: 82.7927s
	iters: 500, epoch: 8 | loss: 0.2160325
	speed: 0.0128s/iter; left time: 88.6535s
Epoch: 8 cost time: 7.390286684036255
Epoch: 8, Steps: 570 | Train Loss: 0.2399890 Vali Loss: 0.0591067 Test Loss: 0.1641041
Validation loss decreased (0.059210 --> 0.059107).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1801660
	speed: 0.0392s/iter; left time: 264.4200s
	iters: 200, epoch: 9 | loss: 0.1819342
	speed: 0.0118s/iter; left time: 78.6856s
	iters: 300, epoch: 9 | loss: 0.2147153
	speed: 0.0119s/iter; left time: 77.5190s
	iters: 400, epoch: 9 | loss: 0.2052983
	speed: 0.0118s/iter; left time: 76.2913s
	iters: 500, epoch: 9 | loss: 0.2915892
	speed: 0.0118s/iter; left time: 75.1051s
Epoch: 9 cost time: 7.06157922744751
Epoch: 9, Steps: 570 | Train Loss: 0.2384743 Vali Loss: 0.0582299 Test Loss: 0.1634074
Validation loss decreased (0.059107 --> 0.058230).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1885498
	speed: 0.0396s/iter; left time: 244.5188s
	iters: 200, epoch: 10 | loss: 0.2248306
	speed: 0.0123s/iter; left time: 74.9409s
	iters: 300, epoch: 10 | loss: 0.1583959
	speed: 0.0126s/iter; left time: 75.1673s
	iters: 400, epoch: 10 | loss: 0.2134813
	speed: 0.0118s/iter; left time: 69.3949s
	iters: 500, epoch: 10 | loss: 0.4080054
	speed: 0.0118s/iter; left time: 68.1005s
Epoch: 10 cost time: 7.223699331283569
Epoch: 10, Steps: 570 | Train Loss: 0.2358646 Vali Loss: 0.0583463 Test Loss: 0.1634760
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1674199
	speed: 0.0382s/iter; left time: 213.9465s
	iters: 200, epoch: 11 | loss: 0.3668125
	speed: 0.0118s/iter; left time: 64.9594s
	iters: 300, epoch: 11 | loss: 0.2715604
	speed: 0.0118s/iter; left time: 63.9141s
	iters: 400, epoch: 11 | loss: 0.2415816
	speed: 0.0118s/iter; left time: 62.6596s
	iters: 500, epoch: 11 | loss: 0.2843077
	speed: 0.0118s/iter; left time: 61.4499s
Epoch: 11 cost time: 6.990102052688599
Epoch: 11, Steps: 570 | Train Loss: 0.2364390 Vali Loss: 0.0585822 Test Loss: 0.1633486
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2286063
	speed: 0.0380s/iter; left time: 191.3982s
	iters: 200, epoch: 12 | loss: 0.1283193
	speed: 0.0119s/iter; left time: 58.7367s
	iters: 300, epoch: 12 | loss: 0.2065744
	speed: 0.0119s/iter; left time: 57.4309s
	iters: 400, epoch: 12 | loss: 0.2635843
	speed: 0.0119s/iter; left time: 56.3581s
	iters: 500, epoch: 12 | loss: 0.2058234
	speed: 0.0119s/iter; left time: 55.2027s
Epoch: 12 cost time: 7.063588857650757
Epoch: 12, Steps: 570 | Train Loss: 0.2372949 Vali Loss: 0.0585811 Test Loss: 0.1633064
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16357727348804474, mae:0.25873905420303345
>>> MS_Raw LR=1e-3 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1796685
	speed: 0.0233s/iter; left time: 263.3416s
	iters: 200, epoch: 1 | loss: 0.3203726
	speed: 0.0115s/iter; left time: 128.4469s
	iters: 300, epoch: 1 | loss: 0.2118618
	speed: 0.0115s/iter; left time: 127.3942s
	iters: 400, epoch: 1 | loss: 0.2701736
	speed: 0.0115s/iter; left time: 126.0773s
	iters: 500, epoch: 1 | loss: 0.2387635
	speed: 0.0115s/iter; left time: 125.0302s
Epoch: 1 cost time: 7.770305871963501
Epoch: 1, Steps: 570 | Train Loss: 0.2496155 Vali Loss: 0.0789338 Test Loss: 0.2181921
Validation loss decreased (inf --> 0.078934).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2929499
	speed: 0.0393s/iter; left time: 421.5594s
	iters: 200, epoch: 2 | loss: 0.2174159
	speed: 0.0115s/iter; left time: 121.8380s
	iters: 300, epoch: 2 | loss: 0.2474419
	speed: 0.0115s/iter; left time: 120.8650s
	iters: 400, epoch: 2 | loss: 0.3588068
	speed: 0.0115s/iter; left time: 119.4987s
	iters: 500, epoch: 2 | loss: 0.5979308
	speed: 0.0115s/iter; left time: 118.5278s
Epoch: 2 cost time: 6.946237564086914
Epoch: 2, Steps: 570 | Train Loss: 0.3421846 Vali Loss: 0.0665686 Test Loss: 0.1938915
Validation loss decreased (0.078934 --> 0.066569).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3956637
	speed: 0.0417s/iter; left time: 424.1754s
	iters: 200, epoch: 3 | loss: 0.1582731
	speed: 0.0126s/iter; left time: 126.7777s
	iters: 300, epoch: 3 | loss: 0.3669603
	speed: 0.0124s/iter; left time: 123.2164s
	iters: 400, epoch: 3 | loss: 0.2793542
	speed: 0.0114s/iter; left time: 112.7679s
	iters: 500, epoch: 3 | loss: 0.3144830
	speed: 0.0115s/iter; left time: 111.7638s
Epoch: 3 cost time: 7.159841775894165
Epoch: 3, Steps: 570 | Train Loss: 0.2952531 Vali Loss: 0.0628071 Test Loss: 0.1831682
Validation loss decreased (0.066569 --> 0.062807).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2594198
	speed: 0.0403s/iter; left time: 386.2086s
	iters: 200, epoch: 4 | loss: 0.1618074
	speed: 0.0116s/iter; left time: 109.7901s
	iters: 300, epoch: 4 | loss: 0.1491181
	speed: 0.0115s/iter; left time: 108.1594s
	iters: 400, epoch: 4 | loss: 0.2702274
	speed: 0.0115s/iter; left time: 107.1520s
	iters: 500, epoch: 4 | loss: 0.2366442
	speed: 0.0116s/iter; left time: 106.2620s
Epoch: 4 cost time: 7.001988649368286
Epoch: 4, Steps: 570 | Train Loss: 0.2701998 Vali Loss: 0.0637959 Test Loss: 0.1755745
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2900212
	speed: 0.0386s/iter; left time: 347.8910s
	iters: 200, epoch: 5 | loss: 0.2182794
	speed: 0.0115s/iter; left time: 102.2339s
	iters: 300, epoch: 5 | loss: 0.3421086
	speed: 0.0115s/iter; left time: 101.1493s
	iters: 400, epoch: 5 | loss: 0.1955701
	speed: 0.0114s/iter; left time: 99.6338s
	iters: 500, epoch: 5 | loss: 0.2884355
	speed: 0.0115s/iter; left time: 99.2000s
Epoch: 5 cost time: 6.867518663406372
Epoch: 5, Steps: 570 | Train Loss: 0.2586808 Vali Loss: 0.0617454 Test Loss: 0.1717319
Validation loss decreased (0.062807 --> 0.061745).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2905227
	speed: 0.0381s/iter; left time: 322.3593s
	iters: 200, epoch: 6 | loss: 0.2730651
	speed: 0.0115s/iter; left time: 95.6337s
	iters: 300, epoch: 6 | loss: 0.1626481
	speed: 0.0115s/iter; left time: 94.6061s
	iters: 400, epoch: 6 | loss: 0.1758117
	speed: 0.0115s/iter; left time: 93.4894s
	iters: 500, epoch: 6 | loss: 0.2027135
	speed: 0.0115s/iter; left time: 92.2641s
Epoch: 6 cost time: 6.831092119216919
Epoch: 6, Steps: 570 | Train Loss: 0.2503739 Vali Loss: 0.0603163 Test Loss: 0.1696076
Validation loss decreased (0.061745 --> 0.060316).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1629372
	speed: 0.0381s/iter; left time: 300.5519s
	iters: 200, epoch: 7 | loss: 0.4093698
	speed: 0.0115s/iter; left time: 89.2770s
	iters: 300, epoch: 7 | loss: 0.2375754
	speed: 0.0115s/iter; left time: 88.1293s
	iters: 400, epoch: 7 | loss: 0.1748221
	speed: 0.0115s/iter; left time: 86.9799s
	iters: 500, epoch: 7 | loss: 0.1773041
	speed: 0.0115s/iter; left time: 85.8366s
Epoch: 7 cost time: 6.831254005432129
Epoch: 7, Steps: 570 | Train Loss: 0.2470633 Vali Loss: 0.0601705 Test Loss: 0.1683172
Validation loss decreased (0.060316 --> 0.060171).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1559660
	speed: 0.0388s/iter; left time: 283.5740s
	iters: 200, epoch: 8 | loss: 0.2440483
	speed: 0.0114s/iter; left time: 82.4809s
	iters: 300, epoch: 8 | loss: 0.2035100
	speed: 0.0114s/iter; left time: 81.1643s
	iters: 400, epoch: 8 | loss: 0.2517019
	speed: 0.0114s/iter; left time: 80.2274s
	iters: 500, epoch: 8 | loss: 0.1877975
	speed: 0.0114s/iter; left time: 78.8961s
Epoch: 8 cost time: 6.8148980140686035
Epoch: 8, Steps: 570 | Train Loss: 0.2481832 Vali Loss: 0.0595144 Test Loss: 0.1678012
Validation loss decreased (0.060171 --> 0.059514).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3043793
	speed: 0.0386s/iter; left time: 260.5032s
	iters: 200, epoch: 9 | loss: 0.1733602
	speed: 0.0115s/iter; left time: 76.4071s
	iters: 300, epoch: 9 | loss: 0.3501782
	speed: 0.0115s/iter; left time: 75.1938s
	iters: 400, epoch: 9 | loss: 0.3207723
	speed: 0.0115s/iter; left time: 73.9575s
	iters: 500, epoch: 9 | loss: 0.3596117
	speed: 0.0115s/iter; left time: 72.8101s
Epoch: 9 cost time: 6.8547043800354
Epoch: 9, Steps: 570 | Train Loss: 0.2453948 Vali Loss: 0.0594102 Test Loss: 0.1675649
Validation loss decreased (0.059514 --> 0.059410).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1794396
	speed: 0.0383s/iter; left time: 236.1750s
	iters: 200, epoch: 10 | loss: 0.2279155
	speed: 0.0115s/iter; left time: 69.6167s
	iters: 300, epoch: 10 | loss: 0.1558017
	speed: 0.0115s/iter; left time: 68.4466s
	iters: 400, epoch: 10 | loss: 0.2411603
	speed: 0.0115s/iter; left time: 67.2786s
	iters: 500, epoch: 10 | loss: 0.2668256
	speed: 0.0115s/iter; left time: 66.2570s
Epoch: 10 cost time: 6.830664873123169
Epoch: 10, Steps: 570 | Train Loss: 0.2453270 Vali Loss: 0.0596609 Test Loss: 0.1673820
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1222677
	speed: 0.0374s/iter; left time: 209.6627s
	iters: 200, epoch: 11 | loss: 0.1957473
	speed: 0.0115s/iter; left time: 63.2589s
	iters: 300, epoch: 11 | loss: 0.2241580
	speed: 0.0115s/iter; left time: 62.1027s
	iters: 400, epoch: 11 | loss: 0.2861233
	speed: 0.0115s/iter; left time: 60.8556s
	iters: 500, epoch: 11 | loss: 0.3761418
	speed: 0.0115s/iter; left time: 59.6990s
Epoch: 11 cost time: 6.839263677597046
Epoch: 11, Steps: 570 | Train Loss: 0.2456568 Vali Loss: 0.0596132 Test Loss: 0.1673657
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2111523
	speed: 0.0396s/iter; left time: 199.2461s
	iters: 200, epoch: 12 | loss: 0.1821611
	speed: 0.0116s/iter; left time: 57.0449s
	iters: 300, epoch: 12 | loss: 0.1647033
	speed: 0.0115s/iter; left time: 55.7952s
	iters: 400, epoch: 12 | loss: 0.3011793
	speed: 0.0115s/iter; left time: 54.5235s
	iters: 500, epoch: 12 | loss: 0.2388800
	speed: 0.0115s/iter; left time: 53.4459s
Epoch: 12 cost time: 6.863969564437866
Epoch: 12, Steps: 570 | Train Loss: 0.2440781 Vali Loss: 0.0597405 Test Loss: 0.1674265
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16781757771968842, mae:0.2611628472805023
>>> MS_Raw LR=1e-3 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3327174
	speed: 0.0237s/iter; left time: 267.7626s
	iters: 200, epoch: 1 | loss: 0.3182364
	speed: 0.0120s/iter; left time: 134.5875s
	iters: 300, epoch: 1 | loss: 0.3426073
	speed: 0.0110s/iter; left time: 121.5991s
	iters: 400, epoch: 1 | loss: 0.3059278
	speed: 0.0109s/iter; left time: 119.6426s
	iters: 500, epoch: 1 | loss: 0.4027936
	speed: 0.0109s/iter; left time: 118.6676s
Epoch: 1 cost time: 7.647228956222534
Epoch: 1, Steps: 570 | Train Loss: 0.3039419 Vali Loss: 0.0807907 Test Loss: 0.2209334
Validation loss decreased (inf --> 0.080791).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3536313
	speed: 0.0389s/iter; left time: 417.5146s
	iters: 200, epoch: 2 | loss: 0.3966191
	speed: 0.0109s/iter; left time: 115.4960s
	iters: 300, epoch: 2 | loss: 0.2305571
	speed: 0.0109s/iter; left time: 114.5287s
	iters: 400, epoch: 2 | loss: 0.2279711
	speed: 0.0109s/iter; left time: 113.2736s
	iters: 500, epoch: 2 | loss: 0.2820280
	speed: 0.0109s/iter; left time: 112.2163s
Epoch: 2 cost time: 6.514926433563232
Epoch: 2, Steps: 570 | Train Loss: 0.3421060 Vali Loss: 0.0724195 Test Loss: 0.1958509
Validation loss decreased (0.080791 --> 0.072419).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2353123
	speed: 0.0394s/iter; left time: 400.6828s
	iters: 200, epoch: 3 | loss: 0.2257837
	speed: 0.0108s/iter; left time: 109.0254s
	iters: 300, epoch: 3 | loss: 0.2265708
	speed: 0.0109s/iter; left time: 108.4603s
	iters: 400, epoch: 3 | loss: 0.2759785
	speed: 0.0109s/iter; left time: 107.2492s
	iters: 500, epoch: 3 | loss: 0.2378863
	speed: 0.0108s/iter; left time: 105.8420s
Epoch: 3 cost time: 6.534125089645386
Epoch: 3, Steps: 570 | Train Loss: 0.2737085 Vali Loss: 0.0630089 Test Loss: 0.1675890
Validation loss decreased (0.072419 --> 0.063009).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2410200
	speed: 0.0380s/iter; left time: 364.6680s
	iters: 200, epoch: 4 | loss: 0.1390311
	speed: 0.0109s/iter; left time: 103.8547s
	iters: 300, epoch: 4 | loss: 0.2606155
	speed: 0.0109s/iter; left time: 102.5946s
	iters: 400, epoch: 4 | loss: 0.4015678
	speed: 0.0109s/iter; left time: 101.5794s
	iters: 500, epoch: 4 | loss: 0.2342789
	speed: 0.0109s/iter; left time: 100.2215s
Epoch: 4 cost time: 6.514981508255005
Epoch: 4, Steps: 570 | Train Loss: 0.2503709 Vali Loss: 0.0647304 Test Loss: 0.1658181
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2422166
	speed: 0.0386s/iter; left time: 348.5775s
	iters: 200, epoch: 5 | loss: 0.1894854
	speed: 0.0109s/iter; left time: 97.2818s
	iters: 300, epoch: 5 | loss: 0.2011713
	speed: 0.0109s/iter; left time: 96.5799s
	iters: 400, epoch: 5 | loss: 0.1729721
	speed: 0.0110s/iter; left time: 95.5028s
	iters: 500, epoch: 5 | loss: 0.3241611
	speed: 0.0109s/iter; left time: 93.9081s
Epoch: 5 cost time: 6.501520156860352
Epoch: 5, Steps: 570 | Train Loss: 0.2379840 Vali Loss: 0.0632330 Test Loss: 0.1627935
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1657743
	speed: 0.0373s/iter; left time: 315.0705s
	iters: 200, epoch: 6 | loss: 0.2104838
	speed: 0.0110s/iter; left time: 91.5923s
	iters: 300, epoch: 6 | loss: 0.2671312
	speed: 0.0109s/iter; left time: 90.3181s
	iters: 400, epoch: 6 | loss: 0.2211233
	speed: 0.0110s/iter; left time: 89.4001s
	iters: 500, epoch: 6 | loss: 0.1637257
	speed: 0.0110s/iter; left time: 88.7097s
Epoch: 6 cost time: 6.58054256439209
Epoch: 6, Steps: 570 | Train Loss: 0.2299352 Vali Loss: 0.0637382 Test Loss: 0.1610361
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16782337427139282, mae:0.265283465385437
>>> MS_Raw LR=1e-3 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2021424
	speed: 0.0265s/iter; left time: 299.4383s
	iters: 200, epoch: 1 | loss: 0.1925161
	speed: 0.0146s/iter; left time: 163.7794s
	iters: 300, epoch: 1 | loss: 0.3646648
	speed: 0.0146s/iter; left time: 162.0083s
	iters: 400, epoch: 1 | loss: 0.3172990
	speed: 0.0146s/iter; left time: 160.8355s
	iters: 500, epoch: 1 | loss: 0.1780760
	speed: 0.0147s/iter; left time: 159.7180s
Epoch: 1 cost time: 9.57908010482788
Epoch: 1, Steps: 570 | Train Loss: 0.2514787 Vali Loss: 0.0618211 Test Loss: 0.1670834
Validation loss decreased (inf --> 0.061821).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3758127
	speed: 0.0486s/iter; left time: 521.2502s
	iters: 200, epoch: 2 | loss: 0.2328117
	speed: 0.0168s/iter; left time: 178.5958s
	iters: 300, epoch: 2 | loss: 0.2166753
	speed: 0.0169s/iter; left time: 177.9679s
	iters: 400, epoch: 2 | loss: 0.1600483
	speed: 0.0166s/iter; left time: 173.1842s
	iters: 500, epoch: 2 | loss: 0.2440310
	speed: 0.0163s/iter; left time: 168.1346s
Epoch: 2 cost time: 9.568652868270874
Epoch: 2, Steps: 570 | Train Loss: 0.2545696 Vali Loss: 0.0566529 Test Loss: 0.1636013
Validation loss decreased (0.061821 --> 0.056653).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3808836
	speed: 0.0483s/iter; left time: 491.0707s
	iters: 200, epoch: 3 | loss: 0.2466947
	speed: 0.0145s/iter; left time: 146.3709s
	iters: 300, epoch: 3 | loss: 0.1148460
	speed: 0.0145s/iter; left time: 144.7711s
	iters: 400, epoch: 3 | loss: 0.1709522
	speed: 0.0146s/iter; left time: 143.6082s
	iters: 500, epoch: 3 | loss: 0.1981073
	speed: 0.0145s/iter; left time: 141.8233s
Epoch: 3 cost time: 8.594972133636475
Epoch: 3, Steps: 570 | Train Loss: 0.2202817 Vali Loss: 0.0512793 Test Loss: 0.1501765
Validation loss decreased (0.056653 --> 0.051279).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1944005
	speed: 0.0474s/iter; left time: 454.8517s
	iters: 200, epoch: 4 | loss: 0.1566377
	speed: 0.0146s/iter; left time: 138.8980s
	iters: 300, epoch: 4 | loss: 0.2081069
	speed: 0.0146s/iter; left time: 137.4730s
	iters: 400, epoch: 4 | loss: 0.1892206
	speed: 0.0146s/iter; left time: 135.6599s
	iters: 500, epoch: 4 | loss: 0.2124998
	speed: 0.0146s/iter; left time: 134.2333s
Epoch: 4 cost time: 8.640824317932129
Epoch: 4, Steps: 570 | Train Loss: 0.1995000 Vali Loss: 0.0463360 Test Loss: 0.1446078
Validation loss decreased (0.051279 --> 0.046336).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1876682
	speed: 0.0489s/iter; left time: 441.3588s
	iters: 200, epoch: 5 | loss: 0.1668259
	speed: 0.0148s/iter; left time: 131.6922s
	iters: 300, epoch: 5 | loss: 0.1381411
	speed: 0.0148s/iter; left time: 130.3092s
	iters: 400, epoch: 5 | loss: 0.2317812
	speed: 0.0148s/iter; left time: 128.7428s
	iters: 500, epoch: 5 | loss: 0.1862955
	speed: 0.0148s/iter; left time: 127.1600s
Epoch: 5 cost time: 8.705947160720825
Epoch: 5, Steps: 570 | Train Loss: 0.1858906 Vali Loss: 0.0453545 Test Loss: 0.1382442
Validation loss decreased (0.046336 --> 0.045354).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1635985
	speed: 0.0499s/iter; left time: 421.5065s
	iters: 200, epoch: 6 | loss: 0.1883183
	speed: 0.0164s/iter; left time: 137.1458s
	iters: 300, epoch: 6 | loss: 0.1240506
	speed: 0.0164s/iter; left time: 135.5198s
	iters: 400, epoch: 6 | loss: 0.1124600
	speed: 0.0164s/iter; left time: 133.9652s
	iters: 500, epoch: 6 | loss: 0.1650752
	speed: 0.0164s/iter; left time: 132.3276s
Epoch: 6 cost time: 9.671847105026245
Epoch: 6, Steps: 570 | Train Loss: 0.1777709 Vali Loss: 0.0447077 Test Loss: 0.1378238
Validation loss decreased (0.045354 --> 0.044708).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1421961
	speed: 0.0486s/iter; left time: 383.2385s
	iters: 200, epoch: 7 | loss: 0.1592079
	speed: 0.0146s/iter; left time: 113.8452s
	iters: 300, epoch: 7 | loss: 0.1536149
	speed: 0.0146s/iter; left time: 112.2556s
	iters: 400, epoch: 7 | loss: 0.1435184
	speed: 0.0146s/iter; left time: 111.0528s
	iters: 500, epoch: 7 | loss: 0.1989434
	speed: 0.0146s/iter; left time: 109.2319s
Epoch: 7 cost time: 8.652366876602173
Epoch: 7, Steps: 570 | Train Loss: 0.1743078 Vali Loss: 0.0442103 Test Loss: 0.1381981
Validation loss decreased (0.044708 --> 0.044210).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2754486
	speed: 0.0472s/iter; left time: 345.2967s
	iters: 200, epoch: 8 | loss: 0.1697963
	speed: 0.0146s/iter; left time: 105.0917s
	iters: 300, epoch: 8 | loss: 0.2003881
	speed: 0.0146s/iter; left time: 103.8396s
	iters: 400, epoch: 8 | loss: 0.1058447
	speed: 0.0146s/iter; left time: 102.1424s
	iters: 500, epoch: 8 | loss: 0.2092163
	speed: 0.0146s/iter; left time: 100.7209s
Epoch: 8 cost time: 8.628287553787231
Epoch: 8, Steps: 570 | Train Loss: 0.1720699 Vali Loss: 0.0444646 Test Loss: 0.1381192
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2775129
	speed: 0.0497s/iter; left time: 334.9380s
	iters: 200, epoch: 9 | loss: 0.1869513
	speed: 0.0147s/iter; left time: 97.5022s
	iters: 300, epoch: 9 | loss: 0.2404243
	speed: 0.0147s/iter; left time: 96.0062s
	iters: 400, epoch: 9 | loss: 0.1877683
	speed: 0.0147s/iter; left time: 94.7397s
	iters: 500, epoch: 9 | loss: 0.1491519
	speed: 0.0147s/iter; left time: 92.9978s
Epoch: 9 cost time: 8.705002307891846
Epoch: 9, Steps: 570 | Train Loss: 0.1709610 Vali Loss: 0.0442922 Test Loss: 0.1373717
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1937200
	speed: 0.0492s/iter; left time: 303.5642s
	iters: 200, epoch: 10 | loss: 0.1355558
	speed: 0.0147s/iter; left time: 89.0534s
	iters: 300, epoch: 10 | loss: 0.1136709
	speed: 0.0146s/iter; left time: 87.4332s
	iters: 400, epoch: 10 | loss: 0.1265586
	speed: 0.0146s/iter; left time: 85.9939s
	iters: 500, epoch: 10 | loss: 0.2174215
	speed: 0.0147s/iter; left time: 84.5820s
Epoch: 10 cost time: 8.632203578948975
Epoch: 10, Steps: 570 | Train Loss: 0.1704257 Vali Loss: 0.0441107 Test Loss: 0.1373031
Validation loss decreased (0.044210 --> 0.044111).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1637001
	speed: 0.0468s/iter; left time: 261.9715s
	iters: 200, epoch: 11 | loss: 0.1189625
	speed: 0.0146s/iter; left time: 80.5755s
	iters: 300, epoch: 11 | loss: 0.1546430
	speed: 0.0146s/iter; left time: 79.1090s
	iters: 400, epoch: 11 | loss: 0.1115248
	speed: 0.0147s/iter; left time: 77.6733s
	iters: 500, epoch: 11 | loss: 0.1244606
	speed: 0.0146s/iter; left time: 76.0966s
Epoch: 11 cost time: 8.662953853607178
Epoch: 11, Steps: 570 | Train Loss: 0.1703624 Vali Loss: 0.0442272 Test Loss: 0.1372467
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1294420
	speed: 0.0500s/iter; left time: 251.7714s
	iters: 200, epoch: 12 | loss: 0.1040739
	speed: 0.0168s/iter; left time: 82.8515s
	iters: 300, epoch: 12 | loss: 0.1994811
	speed: 0.0168s/iter; left time: 81.2194s
	iters: 400, epoch: 12 | loss: 0.1641083
	speed: 0.0168s/iter; left time: 79.5431s
	iters: 500, epoch: 12 | loss: 0.1259927
	speed: 0.0168s/iter; left time: 77.8088s
Epoch: 12 cost time: 9.86551570892334
Epoch: 12, Steps: 570 | Train Loss: 0.1692939 Vali Loss: 0.0441475 Test Loss: 0.1371971
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2209660
	speed: 0.0515s/iter; left time: 229.8218s
	iters: 200, epoch: 13 | loss: 0.2390860
	speed: 0.0152s/iter; left time: 66.1015s
	iters: 300, epoch: 13 | loss: 0.2171553
	speed: 0.0147s/iter; left time: 62.5116s
	iters: 400, epoch: 13 | loss: 0.1052573
	speed: 0.0147s/iter; left time: 61.2703s
	iters: 500, epoch: 13 | loss: 0.1743914
	speed: 0.0148s/iter; left time: 59.9494s
Epoch: 13 cost time: 8.969385623931885
Epoch: 13, Steps: 570 | Train Loss: 0.1694824 Vali Loss: 0.0442130 Test Loss: 0.1371884
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13750919699668884, mae:0.2309766709804535
>>> MS_Raw LR=1e-3 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3579784
	speed: 0.0258s/iter; left time: 291.4398s
	iters: 200, epoch: 1 | loss: 0.2492652
	speed: 0.0143s/iter; left time: 159.6650s
	iters: 300, epoch: 1 | loss: 0.1267075
	speed: 0.0143s/iter; left time: 158.2748s
	iters: 400, epoch: 1 | loss: 0.2885725
	speed: 0.0142s/iter; left time: 156.7595s
	iters: 500, epoch: 1 | loss: 0.1961450
	speed: 0.0143s/iter; left time: 155.3937s
Epoch: 1 cost time: 9.327277898788452
Epoch: 1, Steps: 570 | Train Loss: 0.2143978 Vali Loss: 0.0422654 Test Loss: 0.1404254
Validation loss decreased (inf --> 0.042265).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1853428
	speed: 0.0466s/iter; left time: 500.0456s
	iters: 200, epoch: 2 | loss: 0.3092574
	speed: 0.0144s/iter; left time: 153.5157s
	iters: 300, epoch: 2 | loss: 0.2416447
	speed: 0.0145s/iter; left time: 152.2012s
	iters: 400, epoch: 2 | loss: 0.1907769
	speed: 0.0144s/iter; left time: 150.3431s
	iters: 500, epoch: 2 | loss: 0.3004417
	speed: 0.0144s/iter; left time: 148.4030s
Epoch: 2 cost time: 8.523329019546509
Epoch: 2, Steps: 570 | Train Loss: 0.2455699 Vali Loss: 0.0700985 Test Loss: 0.1969756
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3261602
	speed: 0.0477s/iter; left time: 484.5533s
	iters: 200, epoch: 3 | loss: 0.1153121
	speed: 0.0143s/iter; left time: 144.2675s
	iters: 300, epoch: 3 | loss: 0.3054507
	speed: 0.0143s/iter; left time: 142.4725s
	iters: 400, epoch: 3 | loss: 0.1318701
	speed: 0.0143s/iter; left time: 140.9956s
	iters: 500, epoch: 3 | loss: 0.2147380
	speed: 0.0143s/iter; left time: 139.7037s
Epoch: 3 cost time: 8.477291584014893
Epoch: 3, Steps: 570 | Train Loss: 0.2506641 Vali Loss: 0.0531762 Test Loss: 0.1599999
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2274706
	speed: 0.0467s/iter; left time: 447.6523s
	iters: 200, epoch: 4 | loss: 0.1663541
	speed: 0.0142s/iter; left time: 135.1340s
	iters: 300, epoch: 4 | loss: 0.3156635
	speed: 0.0142s/iter; left time: 133.7128s
	iters: 400, epoch: 4 | loss: 0.1417001
	speed: 0.0143s/iter; left time: 132.4993s
	iters: 500, epoch: 4 | loss: 0.1505014
	speed: 0.0143s/iter; left time: 131.3044s
Epoch: 4 cost time: 8.387474060058594
Epoch: 4, Steps: 570 | Train Loss: 0.2101283 Vali Loss: 0.0509230 Test Loss: 0.1516359
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1406233012676239, mae:0.23075206577777863
>>> MS_Raw LR=1e-3 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1255287
	speed: 0.0258s/iter; left time: 291.0422s
	iters: 200, epoch: 1 | loss: 0.3506041
	speed: 0.0142s/iter; left time: 159.2642s
	iters: 300, epoch: 1 | loss: 0.3245904
	speed: 0.0142s/iter; left time: 157.5299s
	iters: 400, epoch: 1 | loss: 0.2325457
	speed: 0.0142s/iter; left time: 156.3668s
	iters: 500, epoch: 1 | loss: 0.2726045
	speed: 0.0142s/iter; left time: 154.7281s
Epoch: 1 cost time: 9.307618379592896
Epoch: 1, Steps: 570 | Train Loss: 0.2607614 Vali Loss: 0.0578785 Test Loss: 0.1718232
Validation loss decreased (inf --> 0.057879).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2770151
	speed: 0.0463s/iter; left time: 496.4063s
	iters: 200, epoch: 2 | loss: 0.2334131
	speed: 0.0143s/iter; left time: 151.5212s
	iters: 300, epoch: 2 | loss: 0.1974951
	speed: 0.0143s/iter; left time: 150.3460s
	iters: 400, epoch: 2 | loss: 0.2227008
	speed: 0.0143s/iter; left time: 148.8216s
	iters: 500, epoch: 2 | loss: 0.3233249
	speed: 0.0143s/iter; left time: 147.6811s
Epoch: 2 cost time: 8.436219215393066
Epoch: 2, Steps: 570 | Train Loss: 0.2962000 Vali Loss: 0.0627234 Test Loss: 0.1698018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2439906
	speed: 0.0465s/iter; left time: 472.7582s
	iters: 200, epoch: 3 | loss: 0.3127278
	speed: 0.0143s/iter; left time: 143.9949s
	iters: 300, epoch: 3 | loss: 0.2239275
	speed: 0.0143s/iter; left time: 142.3437s
	iters: 400, epoch: 3 | loss: 0.2060677
	speed: 0.0143s/iter; left time: 140.6076s
	iters: 500, epoch: 3 | loss: 0.2406228
	speed: 0.0143s/iter; left time: 139.5497s
Epoch: 3 cost time: 8.44880723953247
Epoch: 3, Steps: 570 | Train Loss: 0.2465655 Vali Loss: 0.0627705 Test Loss: 0.1686419
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3114236
	speed: 0.0472s/iter; left time: 452.8687s
	iters: 200, epoch: 4 | loss: 0.1990649
	speed: 0.0143s/iter; left time: 135.5017s
	iters: 300, epoch: 4 | loss: 0.2273496
	speed: 0.0142s/iter; left time: 133.5988s
	iters: 400, epoch: 4 | loss: 0.2008995
	speed: 0.0142s/iter; left time: 132.1551s
	iters: 500, epoch: 4 | loss: 0.1867630
	speed: 0.0142s/iter; left time: 130.9236s
Epoch: 4 cost time: 8.407023906707764
Epoch: 4, Steps: 570 | Train Loss: 0.2317419 Vali Loss: 0.0565305 Test Loss: 0.1541988
Validation loss decreased (0.057879 --> 0.056530).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1827768
	speed: 0.0469s/iter; left time: 423.0648s
	iters: 200, epoch: 5 | loss: 0.2424145
	speed: 0.0142s/iter; left time: 126.4893s
	iters: 300, epoch: 5 | loss: 0.1769633
	speed: 0.0142s/iter; left time: 124.9021s
	iters: 400, epoch: 5 | loss: 0.3183462
	speed: 0.0142s/iter; left time: 123.6338s
	iters: 500, epoch: 5 | loss: 0.1517796
	speed: 0.0141s/iter; left time: 121.5983s
Epoch: 5 cost time: 8.370394468307495
Epoch: 5, Steps: 570 | Train Loss: 0.2206718 Vali Loss: 0.0559052 Test Loss: 0.1531190
Validation loss decreased (0.056530 --> 0.055905).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2887405
	speed: 0.0465s/iter; left time: 392.6630s
	iters: 200, epoch: 6 | loss: 0.2290369
	speed: 0.0143s/iter; left time: 119.7776s
	iters: 300, epoch: 6 | loss: 0.1388823
	speed: 0.0143s/iter; left time: 117.9906s
	iters: 400, epoch: 6 | loss: 0.2632432
	speed: 0.0143s/iter; left time: 116.4327s
	iters: 500, epoch: 6 | loss: 0.2012624
	speed: 0.0142s/iter; left time: 114.7055s
Epoch: 6 cost time: 8.459156513214111
Epoch: 6, Steps: 570 | Train Loss: 0.2157504 Vali Loss: 0.0545692 Test Loss: 0.1535233
Validation loss decreased (0.055905 --> 0.054569).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2609769
	speed: 0.0494s/iter; left time: 389.2658s
	iters: 200, epoch: 7 | loss: 0.1198593
	speed: 0.0142s/iter; left time: 110.6526s
	iters: 300, epoch: 7 | loss: 0.1548982
	speed: 0.0142s/iter; left time: 109.1618s
	iters: 400, epoch: 7 | loss: 0.2881845
	speed: 0.0142s/iter; left time: 107.7194s
	iters: 500, epoch: 7 | loss: 0.1886747
	speed: 0.0142s/iter; left time: 106.2521s
Epoch: 7 cost time: 8.395876407623291
Epoch: 7, Steps: 570 | Train Loss: 0.2104953 Vali Loss: 0.0552722 Test Loss: 0.1542632
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1520666
	speed: 0.0469s/iter; left time: 342.7226s
	iters: 200, epoch: 8 | loss: 0.1610115
	speed: 0.0143s/iter; left time: 102.8199s
	iters: 300, epoch: 8 | loss: 0.2201933
	speed: 0.0142s/iter; left time: 101.2809s
	iters: 400, epoch: 8 | loss: 0.1989685
	speed: 0.0142s/iter; left time: 99.6321s
	iters: 500, epoch: 8 | loss: 0.1495541
	speed: 0.0142s/iter; left time: 98.2065s
Epoch: 8 cost time: 8.422451496124268
Epoch: 8, Steps: 570 | Train Loss: 0.2098225 Vali Loss: 0.0553594 Test Loss: 0.1540214
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2585093
	speed: 0.0460s/iter; left time: 310.0236s
	iters: 200, epoch: 9 | loss: 0.1992339
	speed: 0.0142s/iter; left time: 94.1748s
	iters: 300, epoch: 9 | loss: 0.1346188
	speed: 0.0142s/iter; left time: 92.6560s
	iters: 400, epoch: 9 | loss: 0.1820253
	speed: 0.0142s/iter; left time: 91.3271s
	iters: 500, epoch: 9 | loss: 0.1771368
	speed: 0.0142s/iter; left time: 89.8493s
Epoch: 9 cost time: 8.395344018936157
Epoch: 9, Steps: 570 | Train Loss: 0.2070904 Vali Loss: 0.0549729 Test Loss: 0.1534572
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15372373163700104, mae:0.25145941972732544
>>> MS_Raw LR=1e-3 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3330847
	speed: 0.0289s/iter; left time: 326.8567s
	iters: 200, epoch: 1 | loss: 0.4218915
	speed: 0.0169s/iter; left time: 189.8223s
	iters: 300, epoch: 1 | loss: 0.2805955
	speed: 0.0169s/iter; left time: 187.9941s
	iters: 400, epoch: 1 | loss: 0.3035471
	speed: 0.0170s/iter; left time: 186.6234s
	iters: 500, epoch: 1 | loss: 0.2725039
	speed: 0.0170s/iter; left time: 184.9571s
Epoch: 1 cost time: 10.911869764328003
Epoch: 1, Steps: 570 | Train Loss: 0.3454965 Vali Loss: 0.0697863 Test Loss: 0.1908302
Validation loss decreased (inf --> 0.069786).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4603559
	speed: 0.0514s/iter; left time: 551.7973s
	iters: 200, epoch: 2 | loss: 0.3383348
	speed: 0.0170s/iter; left time: 180.2733s
	iters: 300, epoch: 2 | loss: 0.2927231
	speed: 0.0170s/iter; left time: 178.8444s
	iters: 400, epoch: 2 | loss: 0.3209269
	speed: 0.0170s/iter; left time: 177.0746s
	iters: 500, epoch: 2 | loss: 0.3092749
	speed: 0.0169s/iter; left time: 175.0081s
Epoch: 2 cost time: 9.99508547782898
Epoch: 2, Steps: 570 | Train Loss: 0.2911564 Vali Loss: 0.0641279 Test Loss: 0.1778177
Validation loss decreased (0.069786 --> 0.064128).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2104033
	speed: 0.0512s/iter; left time: 520.4413s
	iters: 200, epoch: 3 | loss: 0.2310549
	speed: 0.0170s/iter; left time: 170.5993s
	iters: 300, epoch: 3 | loss: 0.4158018
	speed: 0.0170s/iter; left time: 169.0652s
	iters: 400, epoch: 3 | loss: 0.2733926
	speed: 0.0170s/iter; left time: 167.1734s
	iters: 500, epoch: 3 | loss: 0.2293164
	speed: 0.0170s/iter; left time: 165.4912s
Epoch: 3 cost time: 9.955244541168213
Epoch: 3, Steps: 570 | Train Loss: 0.2670521 Vali Loss: 0.0600581 Test Loss: 0.1713327
Validation loss decreased (0.064128 --> 0.060058).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3341044
	speed: 0.0526s/iter; left time: 504.1561s
	iters: 200, epoch: 4 | loss: 0.2223510
	speed: 0.0169s/iter; left time: 160.4615s
	iters: 300, epoch: 4 | loss: 0.2641203
	speed: 0.0169s/iter; left time: 158.7806s
	iters: 400, epoch: 4 | loss: 0.3035638
	speed: 0.0169s/iter; left time: 157.1776s
	iters: 500, epoch: 4 | loss: 0.2579872
	speed: 0.0169s/iter; left time: 155.4697s
Epoch: 4 cost time: 9.935884237289429
Epoch: 4, Steps: 570 | Train Loss: 0.2549842 Vali Loss: 0.0583454 Test Loss: 0.1644505
Validation loss decreased (0.060058 --> 0.058345).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1485283
	speed: 0.0517s/iter; left time: 466.2093s
	iters: 200, epoch: 5 | loss: 0.3071730
	speed: 0.0184s/iter; left time: 164.2674s
	iters: 300, epoch: 5 | loss: 0.2212565
	speed: 0.0184s/iter; left time: 162.4157s
	iters: 400, epoch: 5 | loss: 0.2692057
	speed: 0.0174s/iter; left time: 151.7461s
	iters: 500, epoch: 5 | loss: 0.1740633
	speed: 0.0169s/iter; left time: 145.3933s
Epoch: 5 cost time: 10.4313485622406
Epoch: 5, Steps: 570 | Train Loss: 0.2406700 Vali Loss: 0.0549469 Test Loss: 0.1616737
Validation loss decreased (0.058345 --> 0.054947).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3004594
	speed: 0.0509s/iter; left time: 430.3191s
	iters: 200, epoch: 6 | loss: 0.2355074
	speed: 0.0168s/iter; left time: 140.6954s
	iters: 300, epoch: 6 | loss: 0.3626229
	speed: 0.0168s/iter; left time: 138.8996s
	iters: 400, epoch: 6 | loss: 0.2579860
	speed: 0.0169s/iter; left time: 137.3930s
	iters: 500, epoch: 6 | loss: 0.2163518
	speed: 0.0169s/iter; left time: 135.6719s
Epoch: 6 cost time: 9.916961908340454
Epoch: 6, Steps: 570 | Train Loss: 0.2339336 Vali Loss: 0.0543129 Test Loss: 0.1576901
Validation loss decreased (0.054947 --> 0.054313).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1825576
	speed: 0.0529s/iter; left time: 417.1150s
	iters: 200, epoch: 7 | loss: 0.2221727
	speed: 0.0186s/iter; left time: 144.5491s
	iters: 300, epoch: 7 | loss: 0.3218852
	speed: 0.0183s/iter; left time: 140.3970s
	iters: 400, epoch: 7 | loss: 0.1682148
	speed: 0.0185s/iter; left time: 140.1147s
	iters: 500, epoch: 7 | loss: 0.1819262
	speed: 0.0185s/iter; left time: 138.4690s
Epoch: 7 cost time: 10.847031593322754
Epoch: 7, Steps: 570 | Train Loss: 0.2284274 Vali Loss: 0.0537960 Test Loss: 0.1573032
Validation loss decreased (0.054313 --> 0.053796).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2675963
	speed: 0.0517s/iter; left time: 377.8780s
	iters: 200, epoch: 8 | loss: 0.1502899
	speed: 0.0169s/iter; left time: 122.0261s
	iters: 300, epoch: 8 | loss: 0.2123189
	speed: 0.0169s/iter; left time: 120.2870s
	iters: 400, epoch: 8 | loss: 0.1475389
	speed: 0.0169s/iter; left time: 118.5959s
	iters: 500, epoch: 8 | loss: 0.1974163
	speed: 0.0169s/iter; left time: 117.0221s
Epoch: 8 cost time: 9.926576137542725
Epoch: 8, Steps: 570 | Train Loss: 0.2272331 Vali Loss: 0.0537581 Test Loss: 0.1568641
Validation loss decreased (0.053796 --> 0.053758).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2166151
	speed: 0.0514s/iter; left time: 346.4162s
	iters: 200, epoch: 9 | loss: 0.1553343
	speed: 0.0169s/iter; left time: 112.4445s
	iters: 300, epoch: 9 | loss: 0.2586129
	speed: 0.0169s/iter; left time: 110.6254s
	iters: 400, epoch: 9 | loss: 0.2952958
	speed: 0.0169s/iter; left time: 108.7618s
	iters: 500, epoch: 9 | loss: 0.3034004
	speed: 0.0169s/iter; left time: 107.0037s
Epoch: 9 cost time: 9.964208841323853
Epoch: 9, Steps: 570 | Train Loss: 0.2247944 Vali Loss: 0.0537391 Test Loss: 0.1563775
Validation loss decreased (0.053758 --> 0.053739).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3168563
	speed: 0.0513s/iter; left time: 316.5966s
	iters: 200, epoch: 10 | loss: 0.0878856
	speed: 0.0169s/iter; left time: 102.7627s
	iters: 300, epoch: 10 | loss: 0.3373968
	speed: 0.0169s/iter; left time: 101.0689s
	iters: 400, epoch: 10 | loss: 0.2689933
	speed: 0.0169s/iter; left time: 99.3879s
	iters: 500, epoch: 10 | loss: 0.2301403
	speed: 0.0169s/iter; left time: 97.7329s
Epoch: 10 cost time: 9.965820074081421
Epoch: 10, Steps: 570 | Train Loss: 0.2245514 Vali Loss: 0.0535284 Test Loss: 0.1562473
Validation loss decreased (0.053739 --> 0.053528).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1871051
	speed: 0.0510s/iter; left time: 285.7341s
	iters: 200, epoch: 11 | loss: 0.2793106
	speed: 0.0169s/iter; left time: 92.8697s
	iters: 300, epoch: 11 | loss: 0.1377579
	speed: 0.0169s/iter; left time: 91.4258s
	iters: 400, epoch: 11 | loss: 0.2009258
	speed: 0.0169s/iter; left time: 89.7633s
	iters: 500, epoch: 11 | loss: 0.3015958
	speed: 0.0169s/iter; left time: 88.0842s
Epoch: 11 cost time: 9.950570821762085
Epoch: 11, Steps: 570 | Train Loss: 0.2249263 Vali Loss: 0.0536926 Test Loss: 0.1561432
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2742327
	speed: 0.0507s/iter; left time: 255.0878s
	iters: 200, epoch: 12 | loss: 0.2219787
	speed: 0.0170s/iter; left time: 83.5992s
	iters: 300, epoch: 12 | loss: 0.1666441
	speed: 0.0169s/iter; left time: 81.7613s
	iters: 400, epoch: 12 | loss: 0.2601201
	speed: 0.0169s/iter; left time: 80.0353s
	iters: 500, epoch: 12 | loss: 0.2562214
	speed: 0.0169s/iter; left time: 78.4261s
Epoch: 12 cost time: 9.944604873657227
Epoch: 12, Steps: 570 | Train Loss: 0.2220818 Vali Loss: 0.0534947 Test Loss: 0.1561710
Validation loss decreased (0.053528 --> 0.053495).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2680194
	speed: 0.0510s/iter; left time: 227.6664s
	iters: 200, epoch: 13 | loss: 0.2794768
	speed: 0.0170s/iter; left time: 73.9353s
	iters: 300, epoch: 13 | loss: 0.2121294
	speed: 0.0169s/iter; left time: 72.2045s
	iters: 400, epoch: 13 | loss: 0.1974308
	speed: 0.0169s/iter; left time: 70.4601s
	iters: 500, epoch: 13 | loss: 0.1572743
	speed: 0.0169s/iter; left time: 68.7132s
Epoch: 13 cost time: 9.958629846572876
Epoch: 13, Steps: 570 | Train Loss: 0.2236310 Vali Loss: 0.0535584 Test Loss: 0.1561416
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2315268
	speed: 0.0508s/iter; left time: 197.5625s
	iters: 200, epoch: 14 | loss: 0.1732250
	speed: 0.0182s/iter; left time: 69.1156s
	iters: 300, epoch: 14 | loss: 0.3574424
	speed: 0.0184s/iter; left time: 67.9357s
	iters: 400, epoch: 14 | loss: 0.1625539
	speed: 0.0184s/iter; left time: 66.1014s
	iters: 500, epoch: 14 | loss: 0.1681940
	speed: 0.0184s/iter; left time: 64.2448s
Epoch: 14 cost time: 10.71595048904419
Epoch: 14, Steps: 570 | Train Loss: 0.2241748 Vali Loss: 0.0537431 Test Loss: 0.1561242
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2904820
	speed: 0.0520s/iter; left time: 172.8280s
	iters: 200, epoch: 15 | loss: 0.2192653
	speed: 0.0169s/iter; left time: 54.5422s
	iters: 300, epoch: 15 | loss: 0.2122760
	speed: 0.0169s/iter; left time: 52.8295s
	iters: 400, epoch: 15 | loss: 0.2134637
	speed: 0.0169s/iter; left time: 51.1347s
	iters: 500, epoch: 15 | loss: 0.1997483
	speed: 0.0169s/iter; left time: 49.4606s
Epoch: 15 cost time: 9.939172744750977
Epoch: 15, Steps: 570 | Train Loss: 0.2233492 Vali Loss: 0.0536967 Test Loss: 0.1561356
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15627369284629822, mae:0.25418999791145325
>>> MS_Raw LR=1e-3 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2144737
	speed: 0.0281s/iter; left time: 317.4182s
	iters: 200, epoch: 1 | loss: 0.3402271
	speed: 0.0163s/iter; left time: 183.0685s
	iters: 300, epoch: 1 | loss: 0.4058509
	speed: 0.0163s/iter; left time: 181.0561s
	iters: 400, epoch: 1 | loss: 0.2971203
	speed: 0.0163s/iter; left time: 179.6199s
	iters: 500, epoch: 1 | loss: 0.1734860
	speed: 0.0163s/iter; left time: 178.0604s
Epoch: 1 cost time: 10.53521990776062
Epoch: 1, Steps: 570 | Train Loss: 0.3428784 Vali Loss: 0.0651933 Test Loss: 0.1866074
Validation loss decreased (inf --> 0.065193).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2711714
	speed: 0.0515s/iter; left time: 553.0718s
	iters: 200, epoch: 2 | loss: 0.1883248
	speed: 0.0164s/iter; left time: 174.2136s
	iters: 300, epoch: 2 | loss: 0.2948382
	speed: 0.0164s/iter; left time: 172.3345s
	iters: 400, epoch: 2 | loss: 0.3790845
	speed: 0.0164s/iter; left time: 170.8355s
	iters: 500, epoch: 2 | loss: 0.2702579
	speed: 0.0164s/iter; left time: 169.2917s
Epoch: 2 cost time: 9.636291742324829
Epoch: 2, Steps: 570 | Train Loss: 0.2971498 Vali Loss: 0.0673031 Test Loss: 0.1794859
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2691230
	speed: 0.0495s/iter; left time: 503.3517s
	iters: 200, epoch: 3 | loss: 0.2847893
	speed: 0.0164s/iter; left time: 165.2800s
	iters: 300, epoch: 3 | loss: 0.1823582
	speed: 0.0164s/iter; left time: 163.5225s
	iters: 400, epoch: 3 | loss: 0.3311642
	speed: 0.0164s/iter; left time: 161.9747s
	iters: 500, epoch: 3 | loss: 0.1644257
	speed: 0.0164s/iter; left time: 160.3247s
Epoch: 3 cost time: 9.63059401512146
Epoch: 3, Steps: 570 | Train Loss: 0.2645965 Vali Loss: 0.0609325 Test Loss: 0.1718027
Validation loss decreased (0.065193 --> 0.060933).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2358768
	speed: 0.0495s/iter; left time: 474.3881s
	iters: 200, epoch: 4 | loss: 0.5337734
	speed: 0.0163s/iter; left time: 155.1206s
	iters: 300, epoch: 4 | loss: 0.2043590
	speed: 0.0163s/iter; left time: 153.4451s
	iters: 400, epoch: 4 | loss: 0.1743312
	speed: 0.0163s/iter; left time: 151.7642s
	iters: 500, epoch: 4 | loss: 0.3348444
	speed: 0.0163s/iter; left time: 150.1519s
Epoch: 4 cost time: 9.607975482940674
Epoch: 4, Steps: 570 | Train Loss: 0.2481150 Vali Loss: 0.0584789 Test Loss: 0.1644980
Validation loss decreased (0.060933 --> 0.058479).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2391319
	speed: 0.0523s/iter; left time: 472.2344s
	iters: 200, epoch: 5 | loss: 0.3235899
	speed: 0.0164s/iter; left time: 146.2449s
	iters: 300, epoch: 5 | loss: 0.1979586
	speed: 0.0164s/iter; left time: 144.7413s
	iters: 400, epoch: 5 | loss: 0.1689177
	speed: 0.0164s/iter; left time: 143.1037s
	iters: 500, epoch: 5 | loss: 0.2987221
	speed: 0.0164s/iter; left time: 141.5346s
Epoch: 5 cost time: 9.636091947555542
Epoch: 5, Steps: 570 | Train Loss: 0.2362265 Vali Loss: 0.0601912 Test Loss: 0.1622988
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2104980
	speed: 0.0487s/iter; left time: 411.1858s
	iters: 200, epoch: 6 | loss: 0.3277321
	speed: 0.0164s/iter; left time: 137.1477s
	iters: 300, epoch: 6 | loss: 0.4561567
	speed: 0.0164s/iter; left time: 135.5545s
	iters: 400, epoch: 6 | loss: 0.2088858
	speed: 0.0164s/iter; left time: 133.8838s
	iters: 500, epoch: 6 | loss: 0.2088178
	speed: 0.0164s/iter; left time: 132.2192s
Epoch: 6 cost time: 9.651597738265991
Epoch: 6, Steps: 570 | Train Loss: 0.2292538 Vali Loss: 0.0588901 Test Loss: 0.1615104
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3115033
	speed: 0.0498s/iter; left time: 392.6757s
	iters: 200, epoch: 7 | loss: 0.1426938
	speed: 0.0163s/iter; left time: 127.1022s
	iters: 300, epoch: 7 | loss: 0.2557999
	speed: 0.0163s/iter; left time: 125.4499s
	iters: 400, epoch: 7 | loss: 0.3230401
	speed: 0.0163s/iter; left time: 123.8312s
	iters: 500, epoch: 7 | loss: 0.3296988
	speed: 0.0163s/iter; left time: 122.1801s
Epoch: 7 cost time: 9.655315637588501
Epoch: 7, Steps: 570 | Train Loss: 0.2278809 Vali Loss: 0.0594008 Test Loss: 0.1616243
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16471463441848755, mae:0.2595165967941284
>>> MS_Raw LR=1e-3 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2977015
	speed: 0.0272s/iter; left time: 307.1251s
	iters: 200, epoch: 1 | loss: 0.3025633
	speed: 0.0154s/iter; left time: 172.8771s
	iters: 300, epoch: 1 | loss: 0.2813328
	speed: 0.0154s/iter; left time: 171.1616s
	iters: 400, epoch: 1 | loss: 0.3453762
	speed: 0.0155s/iter; left time: 170.0745s
	iters: 500, epoch: 1 | loss: 0.6158192
	speed: 0.0154s/iter; left time: 168.3993s
Epoch: 1 cost time: 10.026345491409302
Epoch: 1, Steps: 570 | Train Loss: 0.3398425 Vali Loss: 0.0795060 Test Loss: 0.2115769
Validation loss decreased (inf --> 0.079506).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4421618
	speed: 0.0484s/iter; left time: 519.1704s
	iters: 200, epoch: 2 | loss: 0.1749569
	speed: 0.0155s/iter; left time: 164.8503s
	iters: 300, epoch: 2 | loss: 0.2967185
	speed: 0.0155s/iter; left time: 163.4043s
	iters: 400, epoch: 2 | loss: 0.2667936
	speed: 0.0155s/iter; left time: 161.7644s
	iters: 500, epoch: 2 | loss: 0.3372166
	speed: 0.0155s/iter; left time: 160.1842s
Epoch: 2 cost time: 9.1700599193573
Epoch: 2, Steps: 570 | Train Loss: 0.2999388 Vali Loss: 0.0653191 Test Loss: 0.1817264
Validation loss decreased (0.079506 --> 0.065319).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2608772
	speed: 0.0479s/iter; left time: 486.5108s
	iters: 200, epoch: 3 | loss: 0.1706884
	speed: 0.0153s/iter; left time: 154.4204s
	iters: 300, epoch: 3 | loss: 0.3815733
	speed: 0.0153s/iter; left time: 152.7744s
	iters: 400, epoch: 3 | loss: 0.2664266
	speed: 0.0155s/iter; left time: 152.4436s
	iters: 500, epoch: 3 | loss: 0.2473663
	speed: 0.0155s/iter; left time: 151.4501s
Epoch: 3 cost time: 9.06816554069519
Epoch: 3, Steps: 570 | Train Loss: 0.2685149 Vali Loss: 0.0612395 Test Loss: 0.1667740
Validation loss decreased (0.065319 --> 0.061240).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2239064
	speed: 0.0496s/iter; left time: 475.9092s
	iters: 200, epoch: 4 | loss: 0.2824219
	speed: 0.0154s/iter; left time: 146.1736s
	iters: 300, epoch: 4 | loss: 0.3538493
	speed: 0.0154s/iter; left time: 144.6830s
	iters: 400, epoch: 4 | loss: 0.2288669
	speed: 0.0154s/iter; left time: 142.9603s
	iters: 500, epoch: 4 | loss: 0.3610906
	speed: 0.0154s/iter; left time: 141.3603s
Epoch: 4 cost time: 9.045531034469604
Epoch: 4, Steps: 570 | Train Loss: 0.2505508 Vali Loss: 0.0605412 Test Loss: 0.1656972
Validation loss decreased (0.061240 --> 0.060541).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2240075
	speed: 0.0505s/iter; left time: 455.7888s
	iters: 200, epoch: 5 | loss: 0.2118904
	speed: 0.0171s/iter; left time: 152.8095s
	iters: 300, epoch: 5 | loss: 0.2205756
	speed: 0.0170s/iter; left time: 150.3552s
	iters: 400, epoch: 5 | loss: 0.2091028
	speed: 0.0171s/iter; left time: 148.7205s
	iters: 500, epoch: 5 | loss: 0.1949403
	speed: 0.0170s/iter; left time: 146.9672s
Epoch: 5 cost time: 10.025384426116943
Epoch: 5, Steps: 570 | Train Loss: 0.2422824 Vali Loss: 0.0583978 Test Loss: 0.1641003
Validation loss decreased (0.060541 --> 0.058398).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2339019
	speed: 0.0495s/iter; left time: 418.3388s
	iters: 200, epoch: 6 | loss: 0.1755083
	speed: 0.0154s/iter; left time: 128.9640s
	iters: 300, epoch: 6 | loss: 0.1500492
	speed: 0.0154s/iter; left time: 127.4076s
	iters: 400, epoch: 6 | loss: 0.1486233
	speed: 0.0154s/iter; left time: 125.9175s
	iters: 500, epoch: 6 | loss: 0.2213362
	speed: 0.0154s/iter; left time: 124.3552s
Epoch: 6 cost time: 9.0731041431427
Epoch: 6, Steps: 570 | Train Loss: 0.2372961 Vali Loss: 0.0585612 Test Loss: 0.1626155
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3091866
	speed: 0.0468s/iter; left time: 368.9463s
	iters: 200, epoch: 7 | loss: 0.2188091
	speed: 0.0154s/iter; left time: 119.7715s
	iters: 300, epoch: 7 | loss: 0.1809100
	speed: 0.0154s/iter; left time: 118.4960s
	iters: 400, epoch: 7 | loss: 0.2696238
	speed: 0.0154s/iter; left time: 116.8422s
	iters: 500, epoch: 7 | loss: 0.3083701
	speed: 0.0154s/iter; left time: 115.2584s
Epoch: 7 cost time: 9.054751634597778
Epoch: 7, Steps: 570 | Train Loss: 0.2330361 Vali Loss: 0.0587148 Test Loss: 0.1625889
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2236156
	speed: 0.0490s/iter; left time: 358.2563s
	iters: 200, epoch: 8 | loss: 0.2934226
	speed: 0.0154s/iter; left time: 111.2486s
	iters: 300, epoch: 8 | loss: 0.1606408
	speed: 0.0154s/iter; left time: 109.6722s
	iters: 400, epoch: 8 | loss: 0.2432509
	speed: 0.0154s/iter; left time: 108.0531s
	iters: 500, epoch: 8 | loss: 0.1970395
	speed: 0.0154s/iter; left time: 106.4215s
Epoch: 8 cost time: 9.156473398208618
Epoch: 8, Steps: 570 | Train Loss: 0.2315208 Vali Loss: 0.0578444 Test Loss: 0.1620613
Validation loss decreased (0.058398 --> 0.057844).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1934782
	speed: 0.0498s/iter; left time: 335.4320s
	iters: 200, epoch: 9 | loss: 0.2204364
	speed: 0.0159s/iter; left time: 105.3908s
	iters: 300, epoch: 9 | loss: 0.2244284
	speed: 0.0154s/iter; left time: 100.5936s
	iters: 400, epoch: 9 | loss: 0.1628443
	speed: 0.0154s/iter; left time: 99.1080s
	iters: 500, epoch: 9 | loss: 0.2247437
	speed: 0.0154s/iter; left time: 97.6637s
Epoch: 9 cost time: 9.29423713684082
Epoch: 9, Steps: 570 | Train Loss: 0.2303209 Vali Loss: 0.0581975 Test Loss: 0.1621438
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2562991
	speed: 0.0469s/iter; left time: 289.3930s
	iters: 200, epoch: 10 | loss: 0.2500834
	speed: 0.0155s/iter; left time: 93.8121s
	iters: 300, epoch: 10 | loss: 0.2114974
	speed: 0.0155s/iter; left time: 92.3126s
	iters: 400, epoch: 10 | loss: 0.2712291
	speed: 0.0154s/iter; left time: 90.6455s
	iters: 500, epoch: 10 | loss: 0.3080527
	speed: 0.0155s/iter; left time: 89.2015s
Epoch: 10 cost time: 9.093405485153198
Epoch: 10, Steps: 570 | Train Loss: 0.2312544 Vali Loss: 0.0581431 Test Loss: 0.1621729
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2140190
	speed: 0.0475s/iter; left time: 265.8196s
	iters: 200, epoch: 11 | loss: 0.1459406
	speed: 0.0154s/iter; left time: 84.9498s
	iters: 300, epoch: 11 | loss: 0.2325401
	speed: 0.0155s/iter; left time: 83.4619s
	iters: 400, epoch: 11 | loss: 0.2320054
	speed: 0.0155s/iter; left time: 81.9060s
	iters: 500, epoch: 11 | loss: 0.3245713
	speed: 0.0154s/iter; left time: 80.2522s
Epoch: 11 cost time: 9.050488233566284
Epoch: 11, Steps: 570 | Train Loss: 0.2307453 Vali Loss: 0.0582252 Test Loss: 0.1622383
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16231337189674377, mae:0.25703009963035583
>>> MS_Raw LR=1e-3 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1897985
	speed: 0.0309s/iter; left time: 349.0332s
	iters: 200, epoch: 1 | loss: 0.2887057
	speed: 0.0186s/iter; left time: 207.7990s
	iters: 300, epoch: 1 | loss: 0.4413811
	speed: 0.0185s/iter; left time: 205.8663s
	iters: 400, epoch: 1 | loss: 0.2888007
	speed: 0.0186s/iter; left time: 204.3840s
	iters: 500, epoch: 1 | loss: 0.2090833
	speed: 0.0186s/iter; left time: 202.6071s
Epoch: 1 cost time: 11.86935305595398
Epoch: 1, Steps: 570 | Train Loss: 0.2503787 Vali Loss: 0.0560616 Test Loss: 0.1611836
Validation loss decreased (inf --> 0.056062).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3634200
	speed: 0.0574s/iter; left time: 615.8769s
	iters: 200, epoch: 2 | loss: 0.2976031
	speed: 0.0185s/iter; left time: 196.6649s
	iters: 300, epoch: 2 | loss: 0.2022951
	speed: 0.0185s/iter; left time: 194.8816s
	iters: 400, epoch: 2 | loss: 0.2796339
	speed: 0.0184s/iter; left time: 192.3995s
	iters: 500, epoch: 2 | loss: 0.2375820
	speed: 0.0184s/iter; left time: 190.5960s
Epoch: 2 cost time: 10.839621543884277
Epoch: 2, Steps: 570 | Train Loss: 0.2878703 Vali Loss: 0.0673999 Test Loss: 0.1945417
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1964109
	speed: 0.0553s/iter; left time: 562.2888s
	iters: 200, epoch: 3 | loss: 0.2394517
	speed: 0.0183s/iter; left time: 184.3820s
	iters: 300, epoch: 3 | loss: 0.2163593
	speed: 0.0183s/iter; left time: 182.5327s
	iters: 400, epoch: 3 | loss: 0.1630104
	speed: 0.0183s/iter; left time: 180.6022s
	iters: 500, epoch: 3 | loss: 0.2052260
	speed: 0.0184s/iter; left time: 179.8370s
Epoch: 3 cost time: 10.746439695358276
Epoch: 3, Steps: 570 | Train Loss: 0.2572694 Vali Loss: 0.0582203 Test Loss: 0.1707456
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2638965
	speed: 0.0577s/iter; left time: 553.2089s
	iters: 200, epoch: 4 | loss: 0.2769852
	speed: 0.0207s/iter; left time: 196.5774s
	iters: 300, epoch: 4 | loss: 0.2741510
	speed: 0.0208s/iter; left time: 194.9402s
	iters: 400, epoch: 4 | loss: 0.1484838
	speed: 0.0187s/iter; left time: 173.7178s
	iters: 500, epoch: 4 | loss: 0.2438200
	speed: 0.0195s/iter; left time: 179.3640s
Epoch: 4 cost time: 11.574183940887451
Epoch: 4, Steps: 570 | Train Loss: 0.2353540 Vali Loss: 0.0568876 Test Loss: 0.1671759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16143308579921722, mae:0.261800080537796
>>> MS_Raw LR=1e-3 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4577753
	speed: 0.0311s/iter; left time: 351.7791s
	iters: 200, epoch: 1 | loss: 0.1889921
	speed: 0.0184s/iter; left time: 205.7553s
	iters: 300, epoch: 1 | loss: 0.1929015
	speed: 0.0199s/iter; left time: 220.4224s
	iters: 400, epoch: 1 | loss: 0.1672915
	speed: 0.0212s/iter; left time: 233.4186s
	iters: 500, epoch: 1 | loss: 0.3148077
	speed: 0.0187s/iter; left time: 203.4420s
Epoch: 1 cost time: 12.26714038848877
Epoch: 1, Steps: 570 | Train Loss: 0.2371157 Vali Loss: 0.0581155 Test Loss: 0.1931640
Validation loss decreased (inf --> 0.058115).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1904044
	speed: 0.0562s/iter; left time: 603.2626s
	iters: 200, epoch: 2 | loss: 0.3319464
	speed: 0.0183s/iter; left time: 194.2357s
	iters: 300, epoch: 2 | loss: 0.5493437
	speed: 0.0182s/iter; left time: 192.0378s
	iters: 400, epoch: 2 | loss: 0.2594875
	speed: 0.0183s/iter; left time: 190.4172s
	iters: 500, epoch: 2 | loss: 0.1825258
	speed: 0.0182s/iter; left time: 188.2923s
Epoch: 2 cost time: 10.724416017532349
Epoch: 2, Steps: 570 | Train Loss: 0.2861869 Vali Loss: 0.0610071 Test Loss: 0.1707035
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1784080
	speed: 0.0605s/iter; left time: 614.5413s
	iters: 200, epoch: 3 | loss: 0.1907181
	speed: 0.0212s/iter; left time: 213.1641s
	iters: 300, epoch: 3 | loss: 0.2150978
	speed: 0.0212s/iter; left time: 210.7111s
	iters: 400, epoch: 3 | loss: 0.1987578
	speed: 0.0212s/iter; left time: 208.9276s
	iters: 500, epoch: 3 | loss: 0.1934327
	speed: 0.0212s/iter; left time: 206.7085s
Epoch: 3 cost time: 12.352148294448853
Epoch: 3, Steps: 570 | Train Loss: 0.2373628 Vali Loss: 0.0554212 Test Loss: 0.1654473
Validation loss decreased (0.058115 --> 0.055421).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2528630
	speed: 0.0585s/iter; left time: 560.8609s
	iters: 200, epoch: 4 | loss: 0.1235906
	speed: 0.0184s/iter; left time: 174.9091s
	iters: 300, epoch: 4 | loss: 0.2539161
	speed: 0.0189s/iter; left time: 177.4226s
	iters: 400, epoch: 4 | loss: 0.1838807
	speed: 0.0214s/iter; left time: 199.0127s
	iters: 500, epoch: 4 | loss: 0.1295810
	speed: 0.0214s/iter; left time: 196.6923s
Epoch: 4 cost time: 11.711063861846924
Epoch: 4, Steps: 570 | Train Loss: 0.2169620 Vali Loss: 0.0554162 Test Loss: 0.1523077
Validation loss decreased (0.055421 --> 0.055416).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1547552
	speed: 0.0638s/iter; left time: 575.5146s
	iters: 200, epoch: 5 | loss: 0.2026396
	speed: 0.0211s/iter; left time: 187.9979s
	iters: 300, epoch: 5 | loss: 0.1919032
	speed: 0.0211s/iter; left time: 185.8762s
	iters: 400, epoch: 5 | loss: 0.2043490
	speed: 0.0210s/iter; left time: 183.5068s
	iters: 500, epoch: 5 | loss: 0.1990732
	speed: 0.0210s/iter; left time: 181.3782s
Epoch: 5 cost time: 12.294918060302734
Epoch: 5, Steps: 570 | Train Loss: 0.2062961 Vali Loss: 0.0577610 Test Loss: 0.1532470
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2716459
	speed: 0.0605s/iter; left time: 511.1537s
	iters: 200, epoch: 6 | loss: 0.1615687
	speed: 0.0211s/iter; left time: 175.8574s
	iters: 300, epoch: 6 | loss: 0.2168526
	speed: 0.0211s/iter; left time: 173.7816s
	iters: 400, epoch: 6 | loss: 0.1593640
	speed: 0.0211s/iter; left time: 171.8372s
	iters: 500, epoch: 6 | loss: 0.1377405
	speed: 0.0211s/iter; left time: 169.5419s
Epoch: 6 cost time: 12.284571409225464
Epoch: 6, Steps: 570 | Train Loss: 0.2025473 Vali Loss: 0.0542774 Test Loss: 0.1501711
Validation loss decreased (0.055416 --> 0.054277).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1793858
	speed: 0.0641s/iter; left time: 505.3722s
	iters: 200, epoch: 7 | loss: 0.3043558
	speed: 0.0212s/iter; left time: 165.1549s
	iters: 300, epoch: 7 | loss: 0.1265976
	speed: 0.0212s/iter; left time: 162.9239s
	iters: 400, epoch: 7 | loss: 0.2142242
	speed: 0.0212s/iter; left time: 160.7453s
	iters: 500, epoch: 7 | loss: 0.1831573
	speed: 0.0212s/iter; left time: 158.7638s
Epoch: 7 cost time: 12.404348134994507
Epoch: 7, Steps: 570 | Train Loss: 0.1984276 Vali Loss: 0.0547133 Test Loss: 0.1501346
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1364244
	speed: 0.0584s/iter; left time: 427.1289s
	iters: 200, epoch: 8 | loss: 0.1428776
	speed: 0.0184s/iter; left time: 133.0201s
	iters: 300, epoch: 8 | loss: 0.2285191
	speed: 0.0184s/iter; left time: 131.1645s
	iters: 400, epoch: 8 | loss: 0.2212646
	speed: 0.0185s/iter; left time: 129.4571s
	iters: 500, epoch: 8 | loss: 0.2518257
	speed: 0.0184s/iter; left time: 127.4249s
Epoch: 8 cost time: 10.889464378356934
Epoch: 8, Steps: 570 | Train Loss: 0.1964491 Vali Loss: 0.0545418 Test Loss: 0.1491979
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1176716
	speed: 0.0569s/iter; left time: 383.5081s
	iters: 200, epoch: 9 | loss: 0.2062732
	speed: 0.0182s/iter; left time: 121.1362s
	iters: 300, epoch: 9 | loss: 0.2390584
	speed: 0.0182s/iter; left time: 119.0211s
	iters: 400, epoch: 9 | loss: 0.1789776
	speed: 0.0182s/iter; left time: 117.1777s
	iters: 500, epoch: 9 | loss: 0.1672723
	speed: 0.0182s/iter; left time: 115.3805s
Epoch: 9 cost time: 10.64834189414978
Epoch: 9, Steps: 570 | Train Loss: 0.1971224 Vali Loss: 0.0542637 Test Loss: 0.1488945
Validation loss decreased (0.054277 --> 0.054264).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1279312
	speed: 0.0555s/iter; left time: 342.3636s
	iters: 200, epoch: 10 | loss: 0.1533802
	speed: 0.0184s/iter; left time: 111.5952s
	iters: 300, epoch: 10 | loss: 0.2471815
	speed: 0.0183s/iter; left time: 109.4044s
	iters: 400, epoch: 10 | loss: 0.2247956
	speed: 0.0183s/iter; left time: 107.5436s
	iters: 500, epoch: 10 | loss: 0.2233932
	speed: 0.0183s/iter; left time: 105.8000s
Epoch: 10 cost time: 10.762070178985596
Epoch: 10, Steps: 570 | Train Loss: 0.1957112 Vali Loss: 0.0542442 Test Loss: 0.1490749
Validation loss decreased (0.054264 --> 0.054244).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2585023
	speed: 0.0565s/iter; left time: 316.3023s
	iters: 200, epoch: 11 | loss: 0.2559385
	speed: 0.0184s/iter; left time: 101.0186s
	iters: 300, epoch: 11 | loss: 0.1487543
	speed: 0.0184s/iter; left time: 99.3648s
	iters: 400, epoch: 11 | loss: 0.2045055
	speed: 0.0183s/iter; left time: 97.2332s
	iters: 500, epoch: 11 | loss: 0.1912563
	speed: 0.0183s/iter; left time: 95.3164s
Epoch: 11 cost time: 10.728624820709229
Epoch: 11, Steps: 570 | Train Loss: 0.1963690 Vali Loss: 0.0544495 Test Loss: 0.1492017
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2479386
	speed: 0.0572s/iter; left time: 287.6827s
	iters: 200, epoch: 12 | loss: 0.2418561
	speed: 0.0212s/iter; left time: 104.5014s
	iters: 300, epoch: 12 | loss: 0.1374248
	speed: 0.0212s/iter; left time: 102.2035s
	iters: 400, epoch: 12 | loss: 0.1622343
	speed: 0.0211s/iter; left time: 99.9390s
	iters: 500, epoch: 12 | loss: 0.1916432
	speed: 0.0212s/iter; left time: 98.0755s
Epoch: 12 cost time: 12.335132598876953
Epoch: 12, Steps: 570 | Train Loss: 0.1951744 Vali Loss: 0.0542789 Test Loss: 0.1491429
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1677894
	speed: 0.0598s/iter; left time: 266.9745s
	iters: 200, epoch: 13 | loss: 0.2673208
	speed: 0.0214s/iter; left time: 93.3875s
	iters: 300, epoch: 13 | loss: 0.1751967
	speed: 0.0214s/iter; left time: 91.1399s
	iters: 400, epoch: 13 | loss: 0.2055026
	speed: 0.0214s/iter; left time: 88.9584s
	iters: 500, epoch: 13 | loss: 0.2717972
	speed: 0.0214s/iter; left time: 86.7688s
Epoch: 13 cost time: 12.473856925964355
Epoch: 13, Steps: 570 | Train Loss: 0.1961132 Vali Loss: 0.0543760 Test Loss: 0.1491305
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14925047755241394, mae:0.24429486691951752
>>> MS_Raw LR=1e-3 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3445646
	speed: 0.0303s/iter; left time: 341.9766s
	iters: 200, epoch: 1 | loss: 0.1877764
	speed: 0.0183s/iter; left time: 204.8931s
	iters: 300, epoch: 1 | loss: 0.3729849
	speed: 0.0183s/iter; left time: 202.9978s
	iters: 400, epoch: 1 | loss: 0.3171844
	speed: 0.0184s/iter; left time: 202.8219s
	iters: 500, epoch: 1 | loss: 0.3730814
	speed: 0.0185s/iter; left time: 201.2848s
Epoch: 1 cost time: 11.71208930015564
Epoch: 1, Steps: 570 | Train Loss: 0.2813609 Vali Loss: 0.0633417 Test Loss: 0.1786923
Validation loss decreased (inf --> 0.063342).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3185824
	speed: 0.0580s/iter; left time: 622.9112s
	iters: 200, epoch: 2 | loss: 0.3732510
	speed: 0.0185s/iter; left time: 197.0307s
	iters: 300, epoch: 2 | loss: 0.4587632
	speed: 0.0184s/iter; left time: 193.8819s
	iters: 400, epoch: 2 | loss: 0.2056504
	speed: 0.0184s/iter; left time: 191.6792s
	iters: 500, epoch: 2 | loss: 0.1887688
	speed: 0.0184s/iter; left time: 190.5629s
Epoch: 2 cost time: 11.015934944152832
Epoch: 2, Steps: 570 | Train Loss: 0.2697050 Vali Loss: 0.0622225 Test Loss: 0.1683851
Validation loss decreased (0.063342 --> 0.062223).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1565359
	speed: 0.0562s/iter; left time: 570.8214s
	iters: 200, epoch: 3 | loss: 0.2706599
	speed: 0.0184s/iter; left time: 185.4065s
	iters: 300, epoch: 3 | loss: 0.2815258
	speed: 0.0185s/iter; left time: 183.9896s
	iters: 400, epoch: 3 | loss: 0.3146517
	speed: 0.0184s/iter; left time: 181.8300s
	iters: 500, epoch: 3 | loss: 0.2551386
	speed: 0.0185s/iter; left time: 180.3491s
Epoch: 3 cost time: 10.818274736404419
Epoch: 3, Steps: 570 | Train Loss: 0.2377717 Vali Loss: 0.0598904 Test Loss: 0.1628170
Validation loss decreased (0.062223 --> 0.059890).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2135967
	speed: 0.0565s/iter; left time: 542.2675s
	iters: 200, epoch: 4 | loss: 0.2030511
	speed: 0.0183s/iter; left time: 173.9775s
	iters: 300, epoch: 4 | loss: 0.1808579
	speed: 0.0183s/iter; left time: 171.5029s
	iters: 400, epoch: 4 | loss: 0.2235925
	speed: 0.0183s/iter; left time: 169.7442s
	iters: 500, epoch: 4 | loss: 0.1414864
	speed: 0.0183s/iter; left time: 168.0367s
Epoch: 4 cost time: 10.77483081817627
Epoch: 4, Steps: 570 | Train Loss: 0.2207926 Vali Loss: 0.0544014 Test Loss: 0.1543365
Validation loss decreased (0.059890 --> 0.054401).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1340903
	speed: 0.0587s/iter; left time: 529.7844s
	iters: 200, epoch: 5 | loss: 0.2077597
	speed: 0.0183s/iter; left time: 163.2655s
	iters: 300, epoch: 5 | loss: 0.1357080
	speed: 0.0183s/iter; left time: 161.0034s
	iters: 400, epoch: 5 | loss: 0.1882963
	speed: 0.0183s/iter; left time: 159.2748s
	iters: 500, epoch: 5 | loss: 0.1163111
	speed: 0.0183s/iter; left time: 157.4091s
Epoch: 5 cost time: 10.722166061401367
Epoch: 5, Steps: 570 | Train Loss: 0.2083121 Vali Loss: 0.0520057 Test Loss: 0.1467012
Validation loss decreased (0.054401 --> 0.052006).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2263478
	speed: 0.0579s/iter; left time: 489.6810s
	iters: 200, epoch: 6 | loss: 0.1294562
	speed: 0.0183s/iter; left time: 152.4813s
	iters: 300, epoch: 6 | loss: 0.4127450
	speed: 0.0183s/iter; left time: 150.7261s
	iters: 400, epoch: 6 | loss: 0.1523789
	speed: 0.0183s/iter; left time: 148.9692s
	iters: 500, epoch: 6 | loss: 0.2137214
	speed: 0.0183s/iter; left time: 147.1352s
Epoch: 6 cost time: 10.759484767913818
Epoch: 6, Steps: 570 | Train Loss: 0.1999501 Vali Loss: 0.0507813 Test Loss: 0.1440697
Validation loss decreased (0.052006 --> 0.050781).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1522244
	speed: 0.0586s/iter; left time: 461.9201s
	iters: 200, epoch: 7 | loss: 0.1638225
	speed: 0.0184s/iter; left time: 143.4443s
	iters: 300, epoch: 7 | loss: 0.2337635
	speed: 0.0184s/iter; left time: 141.1870s
	iters: 400, epoch: 7 | loss: 0.1708054
	speed: 0.0184s/iter; left time: 139.3355s
	iters: 500, epoch: 7 | loss: 0.1548209
	speed: 0.0184s/iter; left time: 137.5835s
Epoch: 7 cost time: 10.806462049484253
Epoch: 7, Steps: 570 | Train Loss: 0.1966750 Vali Loss: 0.0515746 Test Loss: 0.1437420
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1198446
	speed: 0.0561s/iter; left time: 410.1581s
	iters: 200, epoch: 8 | loss: 0.1399414
	speed: 0.0183s/iter; left time: 132.2853s
	iters: 300, epoch: 8 | loss: 0.1922701
	speed: 0.0184s/iter; left time: 130.5032s
	iters: 400, epoch: 8 | loss: 0.2479041
	speed: 0.0184s/iter; left time: 128.8036s
	iters: 500, epoch: 8 | loss: 0.1562815
	speed: 0.0183s/iter; left time: 126.7988s
Epoch: 8 cost time: 10.758810758590698
Epoch: 8, Steps: 570 | Train Loss: 0.1939699 Vali Loss: 0.0508912 Test Loss: 0.1437241
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2116522
	speed: 0.0606s/iter; left time: 408.5214s
	iters: 200, epoch: 9 | loss: 0.2552299
	speed: 0.0206s/iter; left time: 137.0821s
	iters: 300, epoch: 9 | loss: 0.2623025
	speed: 0.0206s/iter; left time: 135.0169s
	iters: 400, epoch: 9 | loss: 0.3542818
	speed: 0.0207s/iter; left time: 133.3826s
	iters: 500, epoch: 9 | loss: 0.1560402
	speed: 0.0207s/iter; left time: 131.1483s
Epoch: 9 cost time: 12.076926231384277
Epoch: 9, Steps: 570 | Train Loss: 0.1923798 Vali Loss: 0.0505789 Test Loss: 0.1431689
Validation loss decreased (0.050781 --> 0.050579).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1748650
	speed: 0.0628s/iter; left time: 387.4268s
	iters: 200, epoch: 10 | loss: 0.1834387
	speed: 0.0184s/iter; left time: 111.9583s
	iters: 300, epoch: 10 | loss: 0.2298550
	speed: 0.0185s/iter; left time: 110.2522s
	iters: 400, epoch: 10 | loss: 0.2008950
	speed: 0.0184s/iter; left time: 108.3143s
	iters: 500, epoch: 10 | loss: 0.2051430
	speed: 0.0185s/iter; left time: 106.5357s
Epoch: 10 cost time: 10.92962646484375
Epoch: 10, Steps: 570 | Train Loss: 0.1923975 Vali Loss: 0.0504339 Test Loss: 0.1432166
Validation loss decreased (0.050579 --> 0.050434).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1846491
	speed: 0.0586s/iter; left time: 328.4558s
	iters: 200, epoch: 11 | loss: 0.2004280
	speed: 0.0197s/iter; left time: 108.6409s
	iters: 300, epoch: 11 | loss: 0.1794293
	speed: 0.0193s/iter; left time: 104.0884s
	iters: 400, epoch: 11 | loss: 0.1951572
	speed: 0.0207s/iter; left time: 109.4731s
	iters: 500, epoch: 11 | loss: 0.1286800
	speed: 0.0206s/iter; left time: 107.0272s
Epoch: 11 cost time: 11.843754529953003
Epoch: 11, Steps: 570 | Train Loss: 0.1942597 Vali Loss: 0.0503781 Test Loss: 0.1431744
Validation loss decreased (0.050434 --> 0.050378).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1566080
	speed: 0.0600s/iter; left time: 301.7374s
	iters: 200, epoch: 12 | loss: 0.2663315
	speed: 0.0206s/iter; left time: 101.7644s
	iters: 300, epoch: 12 | loss: 0.1894167
	speed: 0.0196s/iter; left time: 94.4566s
	iters: 400, epoch: 12 | loss: 0.1221318
	speed: 0.0188s/iter; left time: 89.1718s
	iters: 500, epoch: 12 | loss: 0.2709911
	speed: 0.0203s/iter; left time: 94.1899s
Epoch: 12 cost time: 11.601364850997925
Epoch: 12, Steps: 570 | Train Loss: 0.1917216 Vali Loss: 0.0504367 Test Loss: 0.1431719
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1706440
	speed: 0.0592s/iter; left time: 264.1111s
	iters: 200, epoch: 13 | loss: 0.1085223
	speed: 0.0183s/iter; left time: 79.7681s
	iters: 300, epoch: 13 | loss: 0.1748090
	speed: 0.0183s/iter; left time: 77.8631s
	iters: 400, epoch: 13 | loss: 0.1320335
	speed: 0.0183s/iter; left time: 76.0485s
	iters: 500, epoch: 13 | loss: 0.1230229
	speed: 0.0183s/iter; left time: 74.2288s
Epoch: 13 cost time: 10.701249837875366
Epoch: 13, Steps: 570 | Train Loss: 0.1911351 Vali Loss: 0.0506621 Test Loss: 0.1431873
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1293672
	speed: 0.0573s/iter; left time: 223.0366s
	iters: 200, epoch: 14 | loss: 0.1320582
	speed: 0.0183s/iter; left time: 69.3903s
	iters: 300, epoch: 14 | loss: 0.1745252
	speed: 0.0183s/iter; left time: 67.4496s
	iters: 400, epoch: 14 | loss: 0.1491092
	speed: 0.0182s/iter; left time: 65.5292s
	iters: 500, epoch: 14 | loss: 0.1423359
	speed: 0.0183s/iter; left time: 63.7456s
Epoch: 14 cost time: 10.706887483596802
Epoch: 14, Steps: 570 | Train Loss: 0.1921796 Vali Loss: 0.0504895 Test Loss: 0.1431945
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14335070550441742, mae:0.24025031924247742
>>> MS_Raw LR=1e-3 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2392795
	speed: 0.0366s/iter; left time: 413.2098s
	iters: 200, epoch: 1 | loss: 0.3235706
	speed: 0.0240s/iter; left time: 269.2779s
	iters: 300, epoch: 1 | loss: 0.2933561
	speed: 0.0240s/iter; left time: 266.9777s
	iters: 400, epoch: 1 | loss: 0.4406134
	speed: 0.0240s/iter; left time: 264.2511s
	iters: 500, epoch: 1 | loss: 0.4308271
	speed: 0.0240s/iter; left time: 261.6202s
Epoch: 1 cost time: 14.89320182800293
Epoch: 1, Steps: 570 | Train Loss: 0.3484697 Vali Loss: 0.0637454 Test Loss: 0.1881898
Validation loss decreased (inf --> 0.063745).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3287198
	speed: 0.0640s/iter; left time: 686.6308s
	iters: 200, epoch: 2 | loss: 0.2529510
	speed: 0.0221s/iter; left time: 235.0033s
	iters: 300, epoch: 2 | loss: 0.2642837
	speed: 0.0221s/iter; left time: 232.9362s
	iters: 400, epoch: 2 | loss: 0.2760209
	speed: 0.0221s/iter; left time: 230.4774s
	iters: 500, epoch: 2 | loss: 0.2563839
	speed: 0.0221s/iter; left time: 228.3273s
Epoch: 2 cost time: 12.916168212890625
Epoch: 2, Steps: 570 | Train Loss: 0.2911943 Vali Loss: 0.0618177 Test Loss: 0.1784082
Validation loss decreased (0.063745 --> 0.061818).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5450932
	speed: 0.0628s/iter; left time: 637.9514s
	iters: 200, epoch: 3 | loss: 0.2047932
	speed: 0.0221s/iter; left time: 222.2651s
	iters: 300, epoch: 3 | loss: 0.3956991
	speed: 0.0221s/iter; left time: 220.5920s
	iters: 400, epoch: 3 | loss: 0.2368403
	speed: 0.0222s/iter; left time: 218.5436s
	iters: 500, epoch: 3 | loss: 0.2099386
	speed: 0.0222s/iter; left time: 216.2904s
Epoch: 3 cost time: 12.914965391159058
Epoch: 3, Steps: 570 | Train Loss: 0.2846029 Vali Loss: 0.0579255 Test Loss: 0.1641819
Validation loss decreased (0.061818 --> 0.057925).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2046410
	speed: 0.0629s/iter; left time: 603.3088s
	iters: 200, epoch: 4 | loss: 0.2222010
	speed: 0.0222s/iter; left time: 210.2439s
	iters: 300, epoch: 4 | loss: 0.2790974
	speed: 0.0221s/iter; left time: 207.7170s
	iters: 400, epoch: 4 | loss: 0.2107026
	speed: 0.0221s/iter; left time: 205.4006s
	iters: 500, epoch: 4 | loss: 0.3143312
	speed: 0.0221s/iter; left time: 203.2493s
Epoch: 4 cost time: 12.928107261657715
Epoch: 4, Steps: 570 | Train Loss: 0.2583972 Vali Loss: 0.0568851 Test Loss: 0.1662834
Validation loss decreased (0.057925 --> 0.056885).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2783979
	speed: 0.0641s/iter; left time: 578.0486s
	iters: 200, epoch: 5 | loss: 0.2492633
	speed: 0.0221s/iter; left time: 197.0421s
	iters: 300, epoch: 5 | loss: 0.1835204
	speed: 0.0221s/iter; left time: 194.5379s
	iters: 400, epoch: 5 | loss: 0.2364521
	speed: 0.0221s/iter; left time: 192.6043s
	iters: 500, epoch: 5 | loss: 0.2786642
	speed: 0.0221s/iter; left time: 190.1425s
Epoch: 5 cost time: 12.877729415893555
Epoch: 5, Steps: 570 | Train Loss: 0.2471538 Vali Loss: 0.0547942 Test Loss: 0.1584070
Validation loss decreased (0.056885 --> 0.054794).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2043900
	speed: 0.0656s/iter; left time: 554.0619s
	iters: 200, epoch: 6 | loss: 0.3686359
	speed: 0.0221s/iter; left time: 184.3579s
	iters: 300, epoch: 6 | loss: 0.2122341
	speed: 0.0220s/iter; left time: 181.7775s
	iters: 400, epoch: 6 | loss: 0.1944636
	speed: 0.0221s/iter; left time: 179.9761s
	iters: 500, epoch: 6 | loss: 0.3643658
	speed: 0.0221s/iter; left time: 177.6038s
Epoch: 6 cost time: 12.875674962997437
Epoch: 6, Steps: 570 | Train Loss: 0.2404939 Vali Loss: 0.0540997 Test Loss: 0.1588474
Validation loss decreased (0.054794 --> 0.054100).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2972192
	speed: 0.0665s/iter; left time: 523.8316s
	iters: 200, epoch: 7 | loss: 0.1989725
	speed: 0.0221s/iter; left time: 172.3306s
	iters: 300, epoch: 7 | loss: 0.1605517
	speed: 0.0222s/iter; left time: 170.3198s
	iters: 400, epoch: 7 | loss: 0.1990369
	speed: 0.0222s/iter; left time: 168.2163s
	iters: 500, epoch: 7 | loss: 0.1980347
	speed: 0.0222s/iter; left time: 165.8350s
Epoch: 7 cost time: 12.938779830932617
Epoch: 7, Steps: 570 | Train Loss: 0.2361313 Vali Loss: 0.0534070 Test Loss: 0.1574572
Validation loss decreased (0.054100 --> 0.053407).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1609631
	speed: 0.0630s/iter; left time: 460.7685s
	iters: 200, epoch: 8 | loss: 0.6042265
	speed: 0.0221s/iter; left time: 159.4083s
	iters: 300, epoch: 8 | loss: 0.1642970
	speed: 0.0221s/iter; left time: 157.0907s
	iters: 400, epoch: 8 | loss: 0.2039292
	speed: 0.0221s/iter; left time: 154.9136s
	iters: 500, epoch: 8 | loss: 0.2035870
	speed: 0.0221s/iter; left time: 152.6726s
Epoch: 8 cost time: 12.887463808059692
Epoch: 8, Steps: 570 | Train Loss: 0.2348030 Vali Loss: 0.0534884 Test Loss: 0.1569922
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2348224
	speed: 0.0614s/iter; left time: 414.1737s
	iters: 200, epoch: 9 | loss: 0.1998831
	speed: 0.0220s/iter; left time: 146.2564s
	iters: 300, epoch: 9 | loss: 0.3595006
	speed: 0.0220s/iter; left time: 144.0730s
	iters: 400, epoch: 9 | loss: 0.1851474
	speed: 0.0220s/iter; left time: 141.7490s
	iters: 500, epoch: 9 | loss: 0.2093672
	speed: 0.0220s/iter; left time: 139.6460s
Epoch: 9 cost time: 12.814566373825073
Epoch: 9, Steps: 570 | Train Loss: 0.2342727 Vali Loss: 0.0532538 Test Loss: 0.1566123
Validation loss decreased (0.053407 --> 0.053254).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2134637
	speed: 0.0656s/iter; left time: 404.7665s
	iters: 200, epoch: 10 | loss: 0.2708219
	speed: 0.0238s/iter; left time: 144.7886s
	iters: 300, epoch: 10 | loss: 0.2378317
	speed: 0.0222s/iter; left time: 132.3294s
	iters: 400, epoch: 10 | loss: 0.3833191
	speed: 0.0222s/iter; left time: 130.1266s
	iters: 500, epoch: 10 | loss: 0.2913111
	speed: 0.0222s/iter; left time: 128.0900s
Epoch: 10 cost time: 13.310836553573608
Epoch: 10, Steps: 570 | Train Loss: 0.2342428 Vali Loss: 0.0534238 Test Loss: 0.1564279
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1943801
	speed: 0.0625s/iter; left time: 350.0941s
	iters: 200, epoch: 11 | loss: 0.1655978
	speed: 0.0221s/iter; left time: 121.3177s
	iters: 300, epoch: 11 | loss: 0.1294974
	speed: 0.0221s/iter; left time: 119.1360s
	iters: 400, epoch: 11 | loss: 0.2129554
	speed: 0.0221s/iter; left time: 117.0643s
	iters: 500, epoch: 11 | loss: 0.1963433
	speed: 0.0221s/iter; left time: 115.0097s
Epoch: 11 cost time: 12.85259199142456
Epoch: 11, Steps: 570 | Train Loss: 0.2345260 Vali Loss: 0.0532203 Test Loss: 0.1563416
Validation loss decreased (0.053254 --> 0.053220).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2545201
	speed: 0.0630s/iter; left time: 316.9316s
	iters: 200, epoch: 12 | loss: 0.1851709
	speed: 0.0221s/iter; left time: 109.0887s
	iters: 300, epoch: 12 | loss: 0.3137481
	speed: 0.0221s/iter; left time: 106.8095s
	iters: 400, epoch: 12 | loss: 0.1479778
	speed: 0.0221s/iter; left time: 104.5762s
	iters: 500, epoch: 12 | loss: 0.2617011
	speed: 0.0221s/iter; left time: 102.4850s
Epoch: 12 cost time: 12.944554567337036
Epoch: 12, Steps: 570 | Train Loss: 0.2333996 Vali Loss: 0.0531982 Test Loss: 0.1563964
Validation loss decreased (0.053220 --> 0.053198).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3771702
	speed: 0.0630s/iter; left time: 280.9791s
	iters: 200, epoch: 13 | loss: 0.1694183
	speed: 0.0220s/iter; left time: 96.0643s
	iters: 300, epoch: 13 | loss: 0.1437278
	speed: 0.0220s/iter; left time: 93.7794s
	iters: 400, epoch: 13 | loss: 0.2160377
	speed: 0.0220s/iter; left time: 91.6386s
	iters: 500, epoch: 13 | loss: 0.4250709
	speed: 0.0220s/iter; left time: 89.3646s
Epoch: 13 cost time: 12.843805313110352
Epoch: 13, Steps: 570 | Train Loss: 0.2338304 Vali Loss: 0.0532326 Test Loss: 0.1563705
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2406413
	speed: 0.0640s/iter; left time: 249.1741s
	iters: 200, epoch: 14 | loss: 0.3010644
	speed: 0.0241s/iter; left time: 91.2672s
	iters: 300, epoch: 14 | loss: 0.2287150
	speed: 0.0240s/iter; left time: 88.5892s
	iters: 400, epoch: 14 | loss: 0.1924923
	speed: 0.0240s/iter; left time: 86.2351s
	iters: 500, epoch: 14 | loss: 0.1605249
	speed: 0.0240s/iter; left time: 83.9164s
Epoch: 14 cost time: 13.96327829360962
Epoch: 14, Steps: 570 | Train Loss: 0.2321255 Vali Loss: 0.0534521 Test Loss: 0.1563781
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2224185
	speed: 0.0653s/iter; left time: 216.8939s
	iters: 200, epoch: 15 | loss: 0.2126149
	speed: 0.0240s/iter; left time: 77.4429s
	iters: 300, epoch: 15 | loss: 0.1061153
	speed: 0.0230s/iter; left time: 71.7883s
	iters: 400, epoch: 15 | loss: 0.2380839
	speed: 0.0222s/iter; left time: 66.9714s
	iters: 500, epoch: 15 | loss: 0.2103924
	speed: 0.0222s/iter; left time: 64.7462s
Epoch: 15 cost time: 13.364700078964233
Epoch: 15, Steps: 570 | Train Loss: 0.2347845 Vali Loss: 0.0533193 Test Loss: 0.1563731
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1566171944141388, mae:0.2542649507522583
>>> MS_Raw LR=1e-3 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3377392
	speed: 0.0335s/iter; left time: 378.4876s
	iters: 200, epoch: 1 | loss: 0.1646500
	speed: 0.0214s/iter; left time: 240.2599s
	iters: 300, epoch: 1 | loss: 0.2190873
	speed: 0.0214s/iter; left time: 237.6443s
	iters: 400, epoch: 1 | loss: 0.2957370
	speed: 0.0214s/iter; left time: 235.2651s
	iters: 500, epoch: 1 | loss: 0.2291556
	speed: 0.0214s/iter; left time: 232.9343s
Epoch: 1 cost time: 13.460057973861694
Epoch: 1, Steps: 570 | Train Loss: 0.3399138 Vali Loss: 0.0699984 Test Loss: 0.1897158
Validation loss decreased (inf --> 0.069998).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2779487
	speed: 0.0660s/iter; left time: 708.0701s
	iters: 200, epoch: 2 | loss: 0.2231273
	speed: 0.0215s/iter; left time: 228.8003s
	iters: 300, epoch: 2 | loss: 0.3795634
	speed: 0.0215s/iter; left time: 226.6984s
	iters: 400, epoch: 2 | loss: 0.2643101
	speed: 0.0215s/iter; left time: 224.7466s
	iters: 500, epoch: 2 | loss: 0.2047420
	speed: 0.0215s/iter; left time: 221.7101s
Epoch: 2 cost time: 12.578626871109009
Epoch: 2, Steps: 570 | Train Loss: 0.2844722 Vali Loss: 0.0626669 Test Loss: 0.1898932
Validation loss decreased (0.069998 --> 0.062667).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2739033
	speed: 0.0628s/iter; left time: 638.0424s
	iters: 200, epoch: 3 | loss: 0.2690250
	speed: 0.0215s/iter; left time: 216.1092s
	iters: 300, epoch: 3 | loss: 0.1724478
	speed: 0.0215s/iter; left time: 213.9892s
	iters: 400, epoch: 3 | loss: 0.1621042
	speed: 0.0215s/iter; left time: 211.7339s
	iters: 500, epoch: 3 | loss: 0.2729535
	speed: 0.0215s/iter; left time: 209.9647s
Epoch: 3 cost time: 12.637756586074829
Epoch: 3, Steps: 570 | Train Loss: 0.2619222 Vali Loss: 0.0608310 Test Loss: 0.1616126
Validation loss decreased (0.062667 --> 0.060831).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1626700
	speed: 0.0617s/iter; left time: 591.6796s
	iters: 200, epoch: 4 | loss: 0.2158362
	speed: 0.0214s/iter; left time: 203.4275s
	iters: 300, epoch: 4 | loss: 0.2240596
	speed: 0.0214s/iter; left time: 201.4175s
	iters: 400, epoch: 4 | loss: 0.3337071
	speed: 0.0215s/iter; left time: 199.2960s
	iters: 500, epoch: 4 | loss: 0.1876449
	speed: 0.0215s/iter; left time: 197.1875s
Epoch: 4 cost time: 12.51682424545288
Epoch: 4, Steps: 570 | Train Loss: 0.2398474 Vali Loss: 0.0581919 Test Loss: 0.1548366
Validation loss decreased (0.060831 --> 0.058192).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3035271
	speed: 0.0620s/iter; left time: 559.0104s
	iters: 200, epoch: 5 | loss: 0.1793818
	speed: 0.0214s/iter; left time: 190.6779s
	iters: 300, epoch: 5 | loss: 0.2417612
	speed: 0.0214s/iter; left time: 188.5096s
	iters: 400, epoch: 5 | loss: 0.2484414
	speed: 0.0214s/iter; left time: 186.6874s
	iters: 500, epoch: 5 | loss: 0.1850076
	speed: 0.0214s/iter; left time: 184.7880s
Epoch: 5 cost time: 12.507558584213257
Epoch: 5, Steps: 570 | Train Loss: 0.2259612 Vali Loss: 0.0581790 Test Loss: 0.1517878
Validation loss decreased (0.058192 --> 0.058179).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2080330
	speed: 0.0623s/iter; left time: 526.1681s
	iters: 200, epoch: 6 | loss: 0.3204569
	speed: 0.0214s/iter; left time: 178.6750s
	iters: 300, epoch: 6 | loss: 0.2294517
	speed: 0.0214s/iter; left time: 176.4946s
	iters: 400, epoch: 6 | loss: 0.1415012
	speed: 0.0214s/iter; left time: 174.6868s
	iters: 500, epoch: 6 | loss: 0.1335572
	speed: 0.0214s/iter; left time: 172.4696s
Epoch: 6 cost time: 12.525114059448242
Epoch: 6, Steps: 570 | Train Loss: 0.2220644 Vali Loss: 0.0585967 Test Loss: 0.1529160
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1969465
	speed: 0.0611s/iter; left time: 481.4859s
	iters: 200, epoch: 7 | loss: 0.2675973
	speed: 0.0214s/iter; left time: 166.2251s
	iters: 300, epoch: 7 | loss: 0.2175160
	speed: 0.0213s/iter; left time: 163.9531s
	iters: 400, epoch: 7 | loss: 0.1372379
	speed: 0.0214s/iter; left time: 161.8741s
	iters: 500, epoch: 7 | loss: 0.1875855
	speed: 0.0213s/iter; left time: 159.6118s
Epoch: 7 cost time: 12.429672718048096
Epoch: 7, Steps: 570 | Train Loss: 0.2186270 Vali Loss: 0.0573958 Test Loss: 0.1515518
Validation loss decreased (0.058179 --> 0.057396).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2150478
	speed: 0.0623s/iter; left time: 455.3784s
	iters: 200, epoch: 8 | loss: 0.2058710
	speed: 0.0214s/iter; left time: 153.9957s
	iters: 300, epoch: 8 | loss: 0.2225778
	speed: 0.0214s/iter; left time: 151.8911s
	iters: 400, epoch: 8 | loss: 0.2368623
	speed: 0.0213s/iter; left time: 149.6766s
	iters: 500, epoch: 8 | loss: 0.2915786
	speed: 0.0214s/iter; left time: 147.7121s
Epoch: 8 cost time: 12.505874395370483
Epoch: 8, Steps: 570 | Train Loss: 0.2145763 Vali Loss: 0.0559872 Test Loss: 0.1507481
Validation loss decreased (0.057396 --> 0.055987).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1523317
	speed: 0.0636s/iter; left time: 429.0074s
	iters: 200, epoch: 9 | loss: 0.3080234
	speed: 0.0233s/iter; left time: 154.9783s
	iters: 300, epoch: 9 | loss: 0.1853736
	speed: 0.0233s/iter; left time: 152.6492s
	iters: 400, epoch: 9 | loss: 0.1888307
	speed: 0.0228s/iter; left time: 146.8008s
	iters: 500, epoch: 9 | loss: 0.1443109
	speed: 0.0214s/iter; left time: 135.9362s
Epoch: 9 cost time: 13.246346473693848
Epoch: 9, Steps: 570 | Train Loss: 0.2150063 Vali Loss: 0.0561404 Test Loss: 0.1507259
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1206441
	speed: 0.0619s/iter; left time: 382.1396s
	iters: 200, epoch: 10 | loss: 0.2277396
	speed: 0.0215s/iter; left time: 130.3132s
	iters: 300, epoch: 10 | loss: 0.1638017
	speed: 0.0215s/iter; left time: 128.1653s
	iters: 400, epoch: 10 | loss: 0.2121173
	speed: 0.0214s/iter; left time: 125.9329s
	iters: 500, epoch: 10 | loss: 0.2538242
	speed: 0.0215s/iter; left time: 123.8129s
Epoch: 10 cost time: 12.501073122024536
Epoch: 10, Steps: 570 | Train Loss: 0.2131337 Vali Loss: 0.0561769 Test Loss: 0.1508286
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2837865
	speed: 0.0628s/iter; left time: 351.8433s
	iters: 200, epoch: 11 | loss: 0.2379410
	speed: 0.0233s/iter; left time: 128.3784s
	iters: 300, epoch: 11 | loss: 0.1742121
	speed: 0.0233s/iter; left time: 125.9446s
	iters: 400, epoch: 11 | loss: 0.1710873
	speed: 0.0233s/iter; left time: 123.5373s
	iters: 500, epoch: 11 | loss: 0.2518443
	speed: 0.0216s/iter; left time: 112.4265s
Epoch: 11 cost time: 13.306060791015625
Epoch: 11, Steps: 570 | Train Loss: 0.2131534 Vali Loss: 0.0561333 Test Loss: 0.1507716
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15090881288051605, mae:0.2482869029045105
>>> MS_Raw LR=1e-3 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3404231
	speed: 0.0321s/iter; left time: 362.7930s
	iters: 200, epoch: 1 | loss: 0.2426745
	speed: 0.0201s/iter; left time: 224.8484s
	iters: 300, epoch: 1 | loss: 0.4168512
	speed: 0.0201s/iter; left time: 222.7215s
	iters: 400, epoch: 1 | loss: 0.3796895
	speed: 0.0209s/iter; left time: 229.8723s
	iters: 500, epoch: 1 | loss: 0.2751806
	speed: 0.0221s/iter; left time: 240.9137s
Epoch: 1 cost time: 13.125860691070557
Epoch: 1, Steps: 570 | Train Loss: 0.3250057 Vali Loss: 0.0661804 Test Loss: 0.1876831
Validation loss decreased (inf --> 0.066180).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1786113
	speed: 0.0608s/iter; left time: 652.3826s
	iters: 200, epoch: 2 | loss: 0.5230356
	speed: 0.0201s/iter; left time: 213.6571s
	iters: 300, epoch: 2 | loss: 0.3196713
	speed: 0.0201s/iter; left time: 211.2923s
	iters: 400, epoch: 2 | loss: 0.1660084
	speed: 0.0200s/iter; left time: 208.8452s
	iters: 500, epoch: 2 | loss: 0.1820250
	speed: 0.0200s/iter; left time: 207.0165s
Epoch: 2 cost time: 11.758277416229248
Epoch: 2, Steps: 570 | Train Loss: 0.2875961 Vali Loss: 0.0598336 Test Loss: 0.1854444
Validation loss decreased (0.066180 --> 0.059834).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1814147
	speed: 0.0615s/iter; left time: 625.0949s
	iters: 200, epoch: 3 | loss: 0.1833535
	speed: 0.0201s/iter; left time: 202.2621s
	iters: 300, epoch: 3 | loss: 0.2722208
	speed: 0.0201s/iter; left time: 199.8024s
	iters: 400, epoch: 3 | loss: 0.2516907
	speed: 0.0201s/iter; left time: 198.5369s
	iters: 500, epoch: 3 | loss: 0.2900542
	speed: 0.0201s/iter; left time: 196.4392s
Epoch: 3 cost time: 11.753311157226562
Epoch: 3, Steps: 570 | Train Loss: 0.2670503 Vali Loss: 0.0646542 Test Loss: 0.1743281
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1391644
	speed: 0.0580s/iter; left time: 556.6911s
	iters: 200, epoch: 4 | loss: 0.4543982
	speed: 0.0200s/iter; left time: 190.1806s
	iters: 300, epoch: 4 | loss: 0.1633909
	speed: 0.0200s/iter; left time: 188.1715s
	iters: 400, epoch: 4 | loss: 0.2394994
	speed: 0.0200s/iter; left time: 186.0312s
	iters: 500, epoch: 4 | loss: 0.2080919
	speed: 0.0200s/iter; left time: 183.8241s
Epoch: 4 cost time: 11.660005569458008
Epoch: 4, Steps: 570 | Train Loss: 0.2490871 Vali Loss: 0.0620873 Test Loss: 0.1656219
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2104890
	speed: 0.0574s/iter; left time: 518.0643s
	iters: 200, epoch: 5 | loss: 0.4366803
	speed: 0.0200s/iter; left time: 178.6269s
	iters: 300, epoch: 5 | loss: 0.2191622
	speed: 0.0200s/iter; left time: 176.5765s
	iters: 400, epoch: 5 | loss: 0.2156383
	speed: 0.0200s/iter; left time: 174.5477s
	iters: 500, epoch: 5 | loss: 0.2265786
	speed: 0.0200s/iter; left time: 172.8190s
Epoch: 5 cost time: 11.70806074142456
Epoch: 5, Steps: 570 | Train Loss: 0.2388819 Vali Loss: 0.0566011 Test Loss: 0.1586045
Validation loss decreased (0.059834 --> 0.056601).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2559460
	speed: 0.0611s/iter; left time: 516.4475s
	iters: 200, epoch: 6 | loss: 0.2333039
	speed: 0.0211s/iter; left time: 176.0322s
	iters: 300, epoch: 6 | loss: 0.2261849
	speed: 0.0200s/iter; left time: 165.2880s
	iters: 400, epoch: 6 | loss: 0.1795142
	speed: 0.0200s/iter; left time: 163.2153s
	iters: 500, epoch: 6 | loss: 0.3686235
	speed: 0.0200s/iter; left time: 161.2266s
Epoch: 6 cost time: 12.16398000717163
Epoch: 6, Steps: 570 | Train Loss: 0.2322234 Vali Loss: 0.0568356 Test Loss: 0.1558356
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2439669
	speed: 0.0596s/iter; left time: 469.7153s
	iters: 200, epoch: 7 | loss: 0.2223335
	speed: 0.0202s/iter; left time: 156.8877s
	iters: 300, epoch: 7 | loss: 0.2759081
	speed: 0.0201s/iter; left time: 154.4834s
	iters: 400, epoch: 7 | loss: 0.4412869
	speed: 0.0201s/iter; left time: 152.5443s
	iters: 500, epoch: 7 | loss: 0.1374561
	speed: 0.0201s/iter; left time: 150.5758s
Epoch: 7 cost time: 11.77683138847351
Epoch: 7, Steps: 570 | Train Loss: 0.2276247 Vali Loss: 0.0568543 Test Loss: 0.1559284
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2687363
	speed: 0.0584s/iter; left time: 427.1104s
	iters: 200, epoch: 8 | loss: 0.3044820
	speed: 0.0200s/iter; left time: 144.2657s
	iters: 300, epoch: 8 | loss: 0.2953758
	speed: 0.0200s/iter; left time: 142.2788s
	iters: 400, epoch: 8 | loss: 0.1874395
	speed: 0.0200s/iter; left time: 140.3665s
	iters: 500, epoch: 8 | loss: 0.2586952
	speed: 0.0200s/iter; left time: 138.2191s
Epoch: 8 cost time: 11.667883157730103
Epoch: 8, Steps: 570 | Train Loss: 0.2268142 Vali Loss: 0.0565078 Test Loss: 0.1549985
Validation loss decreased (0.056601 --> 0.056508).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2243491
	speed: 0.0614s/iter; left time: 414.1859s
	iters: 200, epoch: 9 | loss: 0.1885431
	speed: 0.0222s/iter; left time: 147.3810s
	iters: 300, epoch: 9 | loss: 0.2734574
	speed: 0.0221s/iter; left time: 144.6265s
	iters: 400, epoch: 9 | loss: 0.1793066
	speed: 0.0221s/iter; left time: 142.5774s
	iters: 500, epoch: 9 | loss: 0.1427067
	speed: 0.0221s/iter; left time: 140.2613s
Epoch: 9 cost time: 12.866188764572144
Epoch: 9, Steps: 570 | Train Loss: 0.2260832 Vali Loss: 0.0563967 Test Loss: 0.1547564
Validation loss decreased (0.056508 --> 0.056397).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2403950
	speed: 0.0619s/iter; left time: 382.1335s
	iters: 200, epoch: 10 | loss: 0.1651448
	speed: 0.0200s/iter; left time: 121.2710s
	iters: 300, epoch: 10 | loss: 0.2896049
	speed: 0.0200s/iter; left time: 119.3544s
	iters: 400, epoch: 10 | loss: 0.3092924
	speed: 0.0200s/iter; left time: 117.1895s
	iters: 500, epoch: 10 | loss: 0.2361620
	speed: 0.0200s/iter; left time: 115.2495s
Epoch: 10 cost time: 11.67744255065918
Epoch: 10, Steps: 570 | Train Loss: 0.2255608 Vali Loss: 0.0564119 Test Loss: 0.1546019
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2059657
	speed: 0.0627s/iter; left time: 350.9130s
	iters: 200, epoch: 11 | loss: 0.1982250
	speed: 0.0209s/iter; left time: 115.2135s
	iters: 300, epoch: 11 | loss: 0.1643462
	speed: 0.0201s/iter; left time: 108.5674s
	iters: 400, epoch: 11 | loss: 0.2687558
	speed: 0.0201s/iter; left time: 106.4806s
	iters: 500, epoch: 11 | loss: 0.1734656
	speed: 0.0200s/iter; left time: 104.1842s
Epoch: 11 cost time: 12.115852355957031
Epoch: 11, Steps: 570 | Train Loss: 0.2242707 Vali Loss: 0.0564297 Test Loss: 0.1546341
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2062238
	speed: 0.0586s/iter; left time: 294.5916s
	iters: 200, epoch: 12 | loss: 0.1974917
	speed: 0.0199s/iter; left time: 98.2669s
	iters: 300, epoch: 12 | loss: 0.3693649
	speed: 0.0199s/iter; left time: 96.2096s
	iters: 400, epoch: 12 | loss: 0.2459300
	speed: 0.0199s/iter; left time: 94.2127s
	iters: 500, epoch: 12 | loss: 0.3968561
	speed: 0.0199s/iter; left time: 92.1482s
Epoch: 12 cost time: 11.6617271900177
Epoch: 12, Steps: 570 | Train Loss: 0.2242734 Vali Loss: 0.0563085 Test Loss: 0.1546287
Validation loss decreased (0.056397 --> 0.056308).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2222096
	speed: 0.0589s/iter; left time: 262.8790s
	iters: 200, epoch: 13 | loss: 0.1883194
	speed: 0.0200s/iter; left time: 87.3490s
	iters: 300, epoch: 13 | loss: 0.2055316
	speed: 0.0200s/iter; left time: 85.3542s
	iters: 400, epoch: 13 | loss: 0.1621581
	speed: 0.0200s/iter; left time: 83.3763s
	iters: 500, epoch: 13 | loss: 0.3007304
	speed: 0.0200s/iter; left time: 81.2995s
Epoch: 13 cost time: 11.699053287506104
Epoch: 13, Steps: 570 | Train Loss: 0.2250128 Vali Loss: 0.0565566 Test Loss: 0.1546288
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2919002
	speed: 0.0626s/iter; left time: 243.5209s
	iters: 200, epoch: 14 | loss: 0.2277680
	speed: 0.0222s/iter; left time: 84.2932s
	iters: 300, epoch: 14 | loss: 0.2307416
	speed: 0.0222s/iter; left time: 81.8326s
	iters: 400, epoch: 14 | loss: 0.1529334
	speed: 0.0221s/iter; left time: 79.5340s
	iters: 500, epoch: 14 | loss: 0.1951609
	speed: 0.0221s/iter; left time: 77.3089s
Epoch: 14 cost time: 13.03209638595581
Epoch: 14, Steps: 570 | Train Loss: 0.2229430 Vali Loss: 0.0564357 Test Loss: 0.1546331
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1179616
	speed: 0.0630s/iter; left time: 209.2059s
	iters: 200, epoch: 15 | loss: 0.2970698
	speed: 0.0222s/iter; left time: 71.4310s
	iters: 300, epoch: 15 | loss: 0.2058809
	speed: 0.0222s/iter; left time: 69.2000s
	iters: 400, epoch: 15 | loss: 0.2033745
	speed: 0.0222s/iter; left time: 66.9348s
	iters: 500, epoch: 15 | loss: 0.2084622
	speed: 0.0222s/iter; left time: 64.7611s
Epoch: 15 cost time: 12.923995971679688
Epoch: 15, Steps: 570 | Train Loss: 0.2243458 Vali Loss: 0.0565327 Test Loss: 0.1546283
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15482033789157867, mae:0.25201061367988586
>>> MS_Raw LR=1e-3 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2117237
	speed: 0.0243s/iter; left time: 275.1306s
	iters: 200, epoch: 1 | loss: 0.1962214
	speed: 0.0119s/iter; left time: 132.7513s
	iters: 300, epoch: 1 | loss: 0.2084974
	speed: 0.0118s/iter; left time: 131.1262s
	iters: 400, epoch: 1 | loss: 0.2296560
	speed: 0.0118s/iter; left time: 130.0252s
	iters: 500, epoch: 1 | loss: 0.2272920
	speed: 0.0119s/iter; left time: 129.4477s
Epoch: 1 cost time: 8.044426202774048
Epoch: 1, Steps: 570 | Train Loss: 0.2698223 Vali Loss: 0.0505259 Test Loss: 0.1521214
Validation loss decreased (inf --> 0.050526).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5054663
	speed: 0.0372s/iter; left time: 399.2159s
	iters: 200, epoch: 2 | loss: 0.3730318
	speed: 0.0104s/iter; left time: 111.0739s
	iters: 300, epoch: 2 | loss: 0.2677314
	speed: 0.0105s/iter; left time: 110.4579s
	iters: 400, epoch: 2 | loss: 0.2034914
	speed: 0.0105s/iter; left time: 109.2774s
	iters: 500, epoch: 2 | loss: 0.2365679
	speed: 0.0105s/iter; left time: 108.4743s
Epoch: 2 cost time: 6.265126943588257
Epoch: 2, Steps: 570 | Train Loss: 0.2636143 Vali Loss: 0.0675508 Test Loss: 0.1951685
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2460580
	speed: 0.0375s/iter; left time: 380.5560s
	iters: 200, epoch: 3 | loss: 0.3752654
	speed: 0.0118s/iter; left time: 118.8923s
	iters: 300, epoch: 3 | loss: 0.2134835
	speed: 0.0118s/iter; left time: 117.5445s
	iters: 400, epoch: 3 | loss: 0.2111763
	speed: 0.0118s/iter; left time: 116.3868s
	iters: 500, epoch: 3 | loss: 0.2905028
	speed: 0.0118s/iter; left time: 115.4556s
Epoch: 3 cost time: 6.994714260101318
Epoch: 3, Steps: 570 | Train Loss: 0.2672945 Vali Loss: 0.0502162 Test Loss: 0.1495679
Validation loss decreased (0.050526 --> 0.050216).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4105504
	speed: 0.0382s/iter; left time: 365.9208s
	iters: 200, epoch: 4 | loss: 0.1554852
	speed: 0.0104s/iter; left time: 99.0665s
	iters: 300, epoch: 4 | loss: 0.2539790
	speed: 0.0105s/iter; left time: 98.7046s
	iters: 400, epoch: 4 | loss: 0.2332794
	speed: 0.0105s/iter; left time: 97.6924s
	iters: 500, epoch: 4 | loss: 0.2072173
	speed: 0.0105s/iter; left time: 96.5389s
Epoch: 4 cost time: 6.253560543060303
Epoch: 4, Steps: 570 | Train Loss: 0.2372657 Vali Loss: 0.0477580 Test Loss: 0.1426489
Validation loss decreased (0.050216 --> 0.047758).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2328312
	speed: 0.0380s/iter; left time: 342.4257s
	iters: 200, epoch: 5 | loss: 0.2216953
	speed: 0.0118s/iter; left time: 105.0284s
	iters: 300, epoch: 5 | loss: 0.1907568
	speed: 0.0118s/iter; left time: 103.9669s
	iters: 400, epoch: 5 | loss: 0.1760155
	speed: 0.0118s/iter; left time: 102.7865s
	iters: 500, epoch: 5 | loss: 0.2505337
	speed: 0.0118s/iter; left time: 101.5941s
Epoch: 5 cost time: 7.011742115020752
Epoch: 5, Steps: 570 | Train Loss: 0.2250188 Vali Loss: 0.0460322 Test Loss: 0.1390025
Validation loss decreased (0.047758 --> 0.046032).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1989035
	speed: 0.0380s/iter; left time: 321.3144s
	iters: 200, epoch: 6 | loss: 0.1535221
	speed: 0.0107s/iter; left time: 89.3797s
	iters: 300, epoch: 6 | loss: 0.2412390
	speed: 0.0118s/iter; left time: 97.2850s
	iters: 400, epoch: 6 | loss: 0.2632490
	speed: 0.0118s/iter; left time: 96.1355s
	iters: 500, epoch: 6 | loss: 0.2396662
	speed: 0.0118s/iter; left time: 94.9078s
Epoch: 6 cost time: 6.760094165802002
Epoch: 6, Steps: 570 | Train Loss: 0.2193443 Vali Loss: 0.0450908 Test Loss: 0.1399323
Validation loss decreased (0.046032 --> 0.045091).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2661636
	speed: 0.0383s/iter; left time: 301.8102s
	iters: 200, epoch: 7 | loss: 0.2804905
	speed: 0.0105s/iter; left time: 81.6178s
	iters: 300, epoch: 7 | loss: 0.1554718
	speed: 0.0105s/iter; left time: 80.4984s
	iters: 400, epoch: 7 | loss: 0.1617900
	speed: 0.0105s/iter; left time: 79.3901s
	iters: 500, epoch: 7 | loss: 0.1971248
	speed: 0.0105s/iter; left time: 78.3349s
Epoch: 7 cost time: 6.2680535316467285
Epoch: 7, Steps: 570 | Train Loss: 0.2169546 Vali Loss: 0.0455527 Test Loss: 0.1369280
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2547485
	speed: 0.0369s/iter; left time: 269.7434s
	iters: 200, epoch: 8 | loss: 0.2095753
	speed: 0.0106s/iter; left time: 76.0994s
	iters: 300, epoch: 8 | loss: 0.2478575
	speed: 0.0106s/iter; left time: 75.2598s
	iters: 400, epoch: 8 | loss: 0.2990359
	speed: 0.0106s/iter; left time: 74.2197s
	iters: 500, epoch: 8 | loss: 0.1562864
	speed: 0.0106s/iter; left time: 73.1075s
Epoch: 8 cost time: 6.305384159088135
Epoch: 8, Steps: 570 | Train Loss: 0.2126635 Vali Loss: 0.0449546 Test Loss: 0.1366721
Validation loss decreased (0.045091 --> 0.044955).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2795043
	speed: 0.0372s/iter; left time: 250.5304s
	iters: 200, epoch: 9 | loss: 0.1916270
	speed: 0.0105s/iter; left time: 69.5380s
	iters: 300, epoch: 9 | loss: 0.1030944
	speed: 0.0105s/iter; left time: 68.4513s
	iters: 400, epoch: 9 | loss: 0.1902943
	speed: 0.0105s/iter; left time: 67.6216s
	iters: 500, epoch: 9 | loss: 0.1884133
	speed: 0.0105s/iter; left time: 66.5624s
Epoch: 9 cost time: 6.277142763137817
Epoch: 9, Steps: 570 | Train Loss: 0.2139503 Vali Loss: 0.0453385 Test Loss: 0.1365460
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1995925
	speed: 0.0381s/iter; left time: 235.3545s
	iters: 200, epoch: 10 | loss: 0.1834594
	speed: 0.0105s/iter; left time: 63.5250s
	iters: 300, epoch: 10 | loss: 0.1525384
	speed: 0.0105s/iter; left time: 62.4789s
	iters: 400, epoch: 10 | loss: 0.1993958
	speed: 0.0105s/iter; left time: 61.5089s
	iters: 500, epoch: 10 | loss: 0.3330832
	speed: 0.0105s/iter; left time: 60.4885s
Epoch: 10 cost time: 6.253633499145508
Epoch: 10, Steps: 570 | Train Loss: 0.2125980 Vali Loss: 0.0449574 Test Loss: 0.1366582
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2353677
	speed: 0.0380s/iter; left time: 213.0542s
	iters: 200, epoch: 11 | loss: 0.1963727
	speed: 0.0106s/iter; left time: 58.2448s
	iters: 300, epoch: 11 | loss: 0.1679645
	speed: 0.0106s/iter; left time: 57.2779s
	iters: 400, epoch: 11 | loss: 0.3239220
	speed: 0.0106s/iter; left time: 56.1246s
	iters: 500, epoch: 11 | loss: 0.1685197
	speed: 0.0106s/iter; left time: 54.9931s
Epoch: 11 cost time: 6.32048225402832
Epoch: 11, Steps: 570 | Train Loss: 0.2125218 Vali Loss: 0.0449107 Test Loss: 0.1366072
Validation loss decreased (0.044955 --> 0.044911).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2075755
	speed: 0.0376s/iter; left time: 189.0274s
	iters: 200, epoch: 12 | loss: 0.2189093
	speed: 0.0105s/iter; left time: 52.0071s
	iters: 300, epoch: 12 | loss: 0.1716382
	speed: 0.0105s/iter; left time: 50.8007s
	iters: 400, epoch: 12 | loss: 0.1820216
	speed: 0.0105s/iter; left time: 49.7680s
	iters: 500, epoch: 12 | loss: 0.3031299
	speed: 0.0105s/iter; left time: 48.7467s
Epoch: 12 cost time: 6.320996522903442
Epoch: 12, Steps: 570 | Train Loss: 0.2114540 Vali Loss: 0.0450061 Test Loss: 0.1366529
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1022834
	speed: 0.0384s/iter; left time: 171.2229s
	iters: 200, epoch: 13 | loss: 0.2675892
	speed: 0.0106s/iter; left time: 46.1713s
	iters: 300, epoch: 13 | loss: 0.1558159
	speed: 0.0106s/iter; left time: 45.0086s
	iters: 400, epoch: 13 | loss: 0.1571575
	speed: 0.0106s/iter; left time: 44.0075s
	iters: 500, epoch: 13 | loss: 0.2214960
	speed: 0.0106s/iter; left time: 42.9853s
Epoch: 13 cost time: 6.442925930023193
Epoch: 13, Steps: 570 | Train Loss: 0.2133635 Vali Loss: 0.0450953 Test Loss: 0.1366360
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1524723
	speed: 0.0363s/iter; left time: 141.2722s
	iters: 200, epoch: 14 | loss: 0.1994179
	speed: 0.0105s/iter; left time: 39.7727s
	iters: 300, epoch: 14 | loss: 0.2454288
	speed: 0.0105s/iter; left time: 38.6860s
	iters: 400, epoch: 14 | loss: 0.2762757
	speed: 0.0105s/iter; left time: 37.5459s
	iters: 500, epoch: 14 | loss: 0.2121911
	speed: 0.0105s/iter; left time: 36.5375s
Epoch: 14 cost time: 6.251251459121704
Epoch: 14, Steps: 570 | Train Loss: 0.2123307 Vali Loss: 0.0449673 Test Loss: 0.1366275
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13682235777378082, mae:0.23013094067573547
>>> MS_Raw LR=1e-3 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2720160
	speed: 0.0235s/iter; left time: 265.3767s
	iters: 200, epoch: 1 | loss: 0.2550612
	speed: 0.0115s/iter; left time: 129.0461s
	iters: 300, epoch: 1 | loss: 0.2996303
	speed: 0.0116s/iter; left time: 128.5137s
	iters: 400, epoch: 1 | loss: 0.2450242
	speed: 0.0116s/iter; left time: 127.2142s
	iters: 500, epoch: 1 | loss: 0.2024878
	speed: 0.0116s/iter; left time: 126.6628s
Epoch: 1 cost time: 7.836121320724487
Epoch: 1, Steps: 570 | Train Loss: 0.2292420 Vali Loss: 0.0406269 Test Loss: 0.1289614
Validation loss decreased (inf --> 0.040627).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1660670
	speed: 0.0382s/iter; left time: 409.8579s
	iters: 200, epoch: 2 | loss: 0.2225348
	speed: 0.0103s/iter; left time: 109.6920s
	iters: 300, epoch: 2 | loss: 0.1696781
	speed: 0.0103s/iter; left time: 108.6853s
	iters: 400, epoch: 2 | loss: 0.2024043
	speed: 0.0103s/iter; left time: 107.4326s
	iters: 500, epoch: 2 | loss: 0.2608290
	speed: 0.0103s/iter; left time: 106.3184s
Epoch: 2 cost time: 6.185946464538574
Epoch: 2, Steps: 570 | Train Loss: 0.2151188 Vali Loss: 0.0432774 Test Loss: 0.1319082
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1073155
	speed: 0.0354s/iter; left time: 359.6720s
	iters: 200, epoch: 3 | loss: 0.2045198
	speed: 0.0103s/iter; left time: 103.7523s
	iters: 300, epoch: 3 | loss: 0.3562557
	speed: 0.0103s/iter; left time: 102.8958s
	iters: 400, epoch: 3 | loss: 0.1984722
	speed: 0.0103s/iter; left time: 101.5998s
	iters: 500, epoch: 3 | loss: 0.1355830
	speed: 0.0103s/iter; left time: 100.5931s
Epoch: 3 cost time: 6.163942337036133
Epoch: 3, Steps: 570 | Train Loss: 0.1942021 Vali Loss: 0.0354472 Test Loss: 0.1168530
Validation loss decreased (0.040627 --> 0.035447).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1595048
	speed: 0.0370s/iter; left time: 355.2184s
	iters: 200, epoch: 4 | loss: 0.1545954
	speed: 0.0103s/iter; left time: 98.0467s
	iters: 300, epoch: 4 | loss: 0.1039984
	speed: 0.0103s/iter; left time: 97.0864s
	iters: 400, epoch: 4 | loss: 0.1309091
	speed: 0.0103s/iter; left time: 96.0202s
	iters: 500, epoch: 4 | loss: 0.2197086
	speed: 0.0103s/iter; left time: 94.8396s
Epoch: 4 cost time: 6.234886169433594
Epoch: 4, Steps: 570 | Train Loss: 0.1774322 Vali Loss: 0.0345319 Test Loss: 0.1144773
Validation loss decreased (0.035447 --> 0.034532).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1512218
	speed: 0.0361s/iter; left time: 325.4485s
	iters: 200, epoch: 5 | loss: 0.2394757
	speed: 0.0102s/iter; left time: 91.2666s
	iters: 300, epoch: 5 | loss: 0.1671902
	speed: 0.0102s/iter; left time: 90.2895s
	iters: 400, epoch: 5 | loss: 0.1594759
	speed: 0.0103s/iter; left time: 89.6995s
	iters: 500, epoch: 5 | loss: 0.1756693
	speed: 0.0103s/iter; left time: 88.3985s
Epoch: 5 cost time: 6.131312847137451
Epoch: 5, Steps: 570 | Train Loss: 0.1706449 Vali Loss: 0.0340808 Test Loss: 0.1143026
Validation loss decreased (0.034532 --> 0.034081).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1132660
	speed: 0.0355s/iter; left time: 299.6881s
	iters: 200, epoch: 6 | loss: 0.2210791
	speed: 0.0103s/iter; left time: 86.2023s
	iters: 300, epoch: 6 | loss: 0.1718553
	speed: 0.0103s/iter; left time: 85.1252s
	iters: 400, epoch: 6 | loss: 0.1357596
	speed: 0.0103s/iter; left time: 84.3406s
	iters: 500, epoch: 6 | loss: 0.1047990
	speed: 0.0103s/iter; left time: 83.2784s
Epoch: 6 cost time: 6.198092222213745
Epoch: 6, Steps: 570 | Train Loss: 0.1650022 Vali Loss: 0.0340683 Test Loss: 0.1121477
Validation loss decreased (0.034081 --> 0.034068).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1775665
	speed: 0.0375s/iter; left time: 295.8780s
	iters: 200, epoch: 7 | loss: 0.1840083
	speed: 0.0103s/iter; left time: 80.2836s
	iters: 300, epoch: 7 | loss: 0.3098571
	speed: 0.0103s/iter; left time: 79.3588s
	iters: 400, epoch: 7 | loss: 0.2166393
	speed: 0.0103s/iter; left time: 78.3867s
	iters: 500, epoch: 7 | loss: 0.1808318
	speed: 0.0104s/iter; left time: 77.4808s
Epoch: 7 cost time: 6.197023391723633
Epoch: 7, Steps: 570 | Train Loss: 0.1634188 Vali Loss: 0.0334270 Test Loss: 0.1127313
Validation loss decreased (0.034068 --> 0.033427).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1337667
	speed: 0.0369s/iter; left time: 269.6884s
	iters: 200, epoch: 8 | loss: 0.1220730
	speed: 0.0104s/iter; left time: 74.8767s
	iters: 300, epoch: 8 | loss: 0.1137987
	speed: 0.0104s/iter; left time: 73.7215s
	iters: 400, epoch: 8 | loss: 0.1611990
	speed: 0.0103s/iter; left time: 72.5485s
	iters: 500, epoch: 8 | loss: 0.1009670
	speed: 0.0104s/iter; left time: 71.6177s
Epoch: 8 cost time: 6.285123586654663
Epoch: 8, Steps: 570 | Train Loss: 0.1629380 Vali Loss: 0.0332468 Test Loss: 0.1121480
Validation loss decreased (0.033427 --> 0.033247).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1463883
	speed: 0.0360s/iter; left time: 242.4544s
	iters: 200, epoch: 9 | loss: 0.1533737
	speed: 0.0103s/iter; left time: 68.4900s
	iters: 300, epoch: 9 | loss: 0.1479795
	speed: 0.0103s/iter; left time: 67.4192s
	iters: 400, epoch: 9 | loss: 0.2016435
	speed: 0.0103s/iter; left time: 66.3547s
	iters: 500, epoch: 9 | loss: 0.1387911
	speed: 0.0103s/iter; left time: 65.3221s
Epoch: 9 cost time: 6.184344291687012
Epoch: 9, Steps: 570 | Train Loss: 0.1612467 Vali Loss: 0.0334340 Test Loss: 0.1120927
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2028267
	speed: 0.0360s/iter; left time: 221.9316s
	iters: 200, epoch: 10 | loss: 0.1325454
	speed: 0.0103s/iter; left time: 62.6152s
	iters: 300, epoch: 10 | loss: 0.1501399
	speed: 0.0103s/iter; left time: 61.6570s
	iters: 400, epoch: 10 | loss: 0.1044933
	speed: 0.0103s/iter; left time: 60.6021s
	iters: 500, epoch: 10 | loss: 0.1074002
	speed: 0.0103s/iter; left time: 59.5437s
Epoch: 10 cost time: 6.152193784713745
Epoch: 10, Steps: 570 | Train Loss: 0.1624086 Vali Loss: 0.0333549 Test Loss: 0.1120792
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1523762
	speed: 0.0372s/iter; left time: 208.2181s
	iters: 200, epoch: 11 | loss: 0.1533564
	speed: 0.0103s/iter; left time: 56.9212s
	iters: 300, epoch: 11 | loss: 0.1951946
	speed: 0.0104s/iter; left time: 55.9885s
	iters: 400, epoch: 11 | loss: 0.1608341
	speed: 0.0104s/iter; left time: 55.2619s
	iters: 500, epoch: 11 | loss: 0.1590894
	speed: 0.0104s/iter; left time: 54.0937s
Epoch: 11 cost time: 6.201117753982544
Epoch: 11, Steps: 570 | Train Loss: 0.1606826 Vali Loss: 0.0332173 Test Loss: 0.1120477
Validation loss decreased (0.033247 --> 0.033217).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1488593
	speed: 0.0362s/iter; left time: 182.0531s
	iters: 200, epoch: 12 | loss: 0.1528861
	speed: 0.0103s/iter; left time: 50.8437s
	iters: 300, epoch: 12 | loss: 0.1186375
	speed: 0.0103s/iter; left time: 49.7804s
	iters: 400, epoch: 12 | loss: 0.2596448
	speed: 0.0103s/iter; left time: 48.6659s
	iters: 500, epoch: 12 | loss: 0.1406447
	speed: 0.0103s/iter; left time: 47.6860s
Epoch: 12 cost time: 6.163286924362183
Epoch: 12, Steps: 570 | Train Loss: 0.1614960 Vali Loss: 0.0332660 Test Loss: 0.1121420
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2797479
	speed: 0.0349s/iter; left time: 155.9040s
	iters: 200, epoch: 13 | loss: 0.2159488
	speed: 0.0103s/iter; left time: 45.1097s
	iters: 300, epoch: 13 | loss: 0.1232705
	speed: 0.0103s/iter; left time: 43.9836s
	iters: 400, epoch: 13 | loss: 0.1761489
	speed: 0.0103s/iter; left time: 42.9548s
	iters: 500, epoch: 13 | loss: 0.1888717
	speed: 0.0103s/iter; left time: 41.9367s
Epoch: 13 cost time: 6.173721551895142
Epoch: 13, Steps: 570 | Train Loss: 0.1612591 Vali Loss: 0.0332204 Test Loss: 0.1121158
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1898113
	speed: 0.0354s/iter; left time: 137.7370s
	iters: 200, epoch: 14 | loss: 0.1162388
	speed: 0.0104s/iter; left time: 39.4080s
	iters: 300, epoch: 14 | loss: 0.1605986
	speed: 0.0104s/iter; left time: 38.4980s
	iters: 400, epoch: 14 | loss: 0.1655512
	speed: 0.0104s/iter; left time: 37.4059s
	iters: 500, epoch: 14 | loss: 0.1636503
	speed: 0.0104s/iter; left time: 36.3676s
Epoch: 14 cost time: 6.204495906829834
Epoch: 14, Steps: 570 | Train Loss: 0.1613626 Vali Loss: 0.0332831 Test Loss: 0.1121289
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11220263689756393, mae:0.20432178676128387
>>> MS_Raw LR=1e-3 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2665744
	speed: 0.0235s/iter; left time: 265.4933s
	iters: 200, epoch: 1 | loss: 0.1625039
	speed: 0.0116s/iter; left time: 129.7814s
	iters: 300, epoch: 1 | loss: 0.1715275
	speed: 0.0116s/iter; left time: 128.3010s
	iters: 400, epoch: 1 | loss: 0.2192196
	speed: 0.0116s/iter; left time: 127.2616s
	iters: 500, epoch: 1 | loss: 0.2436446
	speed: 0.0116s/iter; left time: 126.4374s
Epoch: 1 cost time: 7.840657472610474
Epoch: 1, Steps: 570 | Train Loss: 0.2679370 Vali Loss: 0.0518775 Test Loss: 0.1528189
Validation loss decreased (inf --> 0.051878).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3995857
	speed: 0.0374s/iter; left time: 401.6908s
	iters: 200, epoch: 2 | loss: 0.3813215
	speed: 0.0105s/iter; left time: 111.1063s
	iters: 300, epoch: 2 | loss: 0.2108474
	speed: 0.0104s/iter; left time: 109.6251s
	iters: 400, epoch: 2 | loss: 0.3423056
	speed: 0.0104s/iter; left time: 108.1671s
	iters: 500, epoch: 2 | loss: 0.3010347
	speed: 0.0104s/iter; left time: 107.4665s
Epoch: 2 cost time: 6.254590272903442
Epoch: 2, Steps: 570 | Train Loss: 0.2640337 Vali Loss: 0.0516810 Test Loss: 0.1591369
Validation loss decreased (0.051878 --> 0.051681).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1683755
	speed: 0.0369s/iter; left time: 375.4138s
	iters: 200, epoch: 3 | loss: 0.2236179
	speed: 0.0102s/iter; left time: 102.7740s
	iters: 300, epoch: 3 | loss: 0.2537792
	speed: 0.0102s/iter; left time: 101.7850s
	iters: 400, epoch: 3 | loss: 0.1891318
	speed: 0.0102s/iter; left time: 100.8787s
	iters: 500, epoch: 3 | loss: 0.1693430
	speed: 0.0102s/iter; left time: 99.9565s
Epoch: 3 cost time: 6.139186143875122
Epoch: 3, Steps: 570 | Train Loss: 0.2363307 Vali Loss: 0.0479477 Test Loss: 0.1425689
Validation loss decreased (0.051681 --> 0.047948).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1491272
	speed: 0.0367s/iter; left time: 351.8663s
	iters: 200, epoch: 4 | loss: 0.1335760
	speed: 0.0102s/iter; left time: 96.7472s
	iters: 300, epoch: 4 | loss: 0.1788428
	speed: 0.0102s/iter; left time: 95.8581s
	iters: 400, epoch: 4 | loss: 0.2666694
	speed: 0.0102s/iter; left time: 94.7381s
	iters: 500, epoch: 4 | loss: 0.1612497
	speed: 0.0102s/iter; left time: 93.6008s
Epoch: 4 cost time: 6.10774302482605
Epoch: 4, Steps: 570 | Train Loss: 0.2194571 Vali Loss: 0.0480028 Test Loss: 0.1399659
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1819476
	speed: 0.0370s/iter; left time: 333.5760s
	iters: 200, epoch: 5 | loss: 0.1414169
	speed: 0.0103s/iter; left time: 91.4764s
	iters: 300, epoch: 5 | loss: 0.2882839
	speed: 0.0102s/iter; left time: 90.0717s
	iters: 400, epoch: 5 | loss: 0.1805757
	speed: 0.0103s/iter; left time: 89.6498s
	iters: 500, epoch: 5 | loss: 0.3003975
	speed: 0.0103s/iter; left time: 88.9181s
Epoch: 5 cost time: 6.1831066608428955
Epoch: 5, Steps: 570 | Train Loss: 0.2111736 Vali Loss: 0.0444598 Test Loss: 0.1373426
Validation loss decreased (0.047948 --> 0.044460).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1481559
	speed: 0.0371s/iter; left time: 313.8854s
	iters: 200, epoch: 6 | loss: 0.2157323
	speed: 0.0103s/iter; left time: 86.2306s
	iters: 300, epoch: 6 | loss: 0.2078682
	speed: 0.0104s/iter; left time: 85.4331s
	iters: 400, epoch: 6 | loss: 0.1530166
	speed: 0.0103s/iter; left time: 84.3612s
	iters: 500, epoch: 6 | loss: 0.1808219
	speed: 0.0103s/iter; left time: 83.1414s
Epoch: 6 cost time: 6.206140756607056
Epoch: 6, Steps: 570 | Train Loss: 0.2026788 Vali Loss: 0.0443465 Test Loss: 0.1363007
Validation loss decreased (0.044460 --> 0.044347).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2109874
	speed: 0.0376s/iter; left time: 296.2628s
	iters: 200, epoch: 7 | loss: 0.1694206
	speed: 0.0103s/iter; left time: 79.9507s
	iters: 300, epoch: 7 | loss: 0.1643476
	speed: 0.0103s/iter; left time: 79.2037s
	iters: 400, epoch: 7 | loss: 0.1253503
	speed: 0.0103s/iter; left time: 77.9273s
	iters: 500, epoch: 7 | loss: 0.2321343
	speed: 0.0103s/iter; left time: 76.8637s
Epoch: 7 cost time: 6.1509222984313965
Epoch: 7, Steps: 570 | Train Loss: 0.2003247 Vali Loss: 0.0449832 Test Loss: 0.1369952
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1437660
	speed: 0.0358s/iter; left time: 261.5282s
	iters: 200, epoch: 8 | loss: 0.1740367
	speed: 0.0103s/iter; left time: 74.3977s
	iters: 300, epoch: 8 | loss: 0.2138445
	speed: 0.0103s/iter; left time: 73.2813s
	iters: 400, epoch: 8 | loss: 0.2274852
	speed: 0.0114s/iter; left time: 79.9445s
	iters: 500, epoch: 8 | loss: 0.2640571
	speed: 0.0116s/iter; left time: 80.1902s
Epoch: 8 cost time: 6.490483522415161
Epoch: 8, Steps: 570 | Train Loss: 0.1992223 Vali Loss: 0.0450322 Test Loss: 0.1366178
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1558319
	speed: 0.0380s/iter; left time: 255.8707s
	iters: 200, epoch: 9 | loss: 0.2155426
	speed: 0.0116s/iter; left time: 77.0217s
	iters: 300, epoch: 9 | loss: 0.1660830
	speed: 0.0116s/iter; left time: 75.7807s
	iters: 400, epoch: 9 | loss: 0.1353658
	speed: 0.0116s/iter; left time: 74.5498s
	iters: 500, epoch: 9 | loss: 0.2189843
	speed: 0.0116s/iter; left time: 73.4025s
Epoch: 9 cost time: 6.8910791873931885
Epoch: 9, Steps: 570 | Train Loss: 0.1988193 Vali Loss: 0.0453159 Test Loss: 0.1367790
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1364724338054657, mae:0.23290593922138214
>>> MS_Raw LR=1e-3 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3146958
	speed: 0.0244s/iter; left time: 276.2269s
	iters: 200, epoch: 1 | loss: 0.2838693
	speed: 0.0127s/iter; left time: 142.1215s
	iters: 300, epoch: 1 | loss: 0.1965312
	speed: 0.0127s/iter; left time: 140.6188s
	iters: 400, epoch: 1 | loss: 0.1757296
	speed: 0.0127s/iter; left time: 139.3287s
	iters: 500, epoch: 1 | loss: 0.2426057
	speed: 0.0127s/iter; left time: 137.9498s
Epoch: 1 cost time: 8.454090118408203
Epoch: 1, Steps: 570 | Train Loss: 0.3048955 Vali Loss: 0.0569524 Test Loss: 0.1670164
Validation loss decreased (inf --> 0.056952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3564685
	speed: 0.0415s/iter; left time: 444.9796s
	iters: 200, epoch: 2 | loss: 0.2490194
	speed: 0.0128s/iter; left time: 136.0182s
	iters: 300, epoch: 2 | loss: 0.2912205
	speed: 0.0119s/iter; left time: 125.6043s
	iters: 400, epoch: 2 | loss: 0.2075615
	speed: 0.0120s/iter; left time: 125.4894s
	iters: 500, epoch: 2 | loss: 0.3259264
	speed: 0.0122s/iter; left time: 126.0876s
Epoch: 2 cost time: 7.403697729110718
Epoch: 2, Steps: 570 | Train Loss: 0.3621097 Vali Loss: 0.0655616 Test Loss: 0.2010690
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4145622
	speed: 0.0409s/iter; left time: 415.8317s
	iters: 200, epoch: 3 | loss: 0.4263114
	speed: 0.0129s/iter; left time: 130.1813s
	iters: 300, epoch: 3 | loss: 0.1655468
	speed: 0.0123s/iter; left time: 122.6180s
	iters: 400, epoch: 3 | loss: 0.3101531
	speed: 0.0118s/iter; left time: 116.5368s
	iters: 500, epoch: 3 | loss: 0.2383604
	speed: 0.0119s/iter; left time: 115.6992s
Epoch: 3 cost time: 7.315310001373291
Epoch: 3, Steps: 570 | Train Loss: 0.3143142 Vali Loss: 0.0663429 Test Loss: 0.1853718
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2161061
	speed: 0.0385s/iter; left time: 369.1844s
	iters: 200, epoch: 4 | loss: 0.3722821
	speed: 0.0118s/iter; left time: 112.2760s
	iters: 300, epoch: 4 | loss: 0.2015136
	speed: 0.0119s/iter; left time: 111.3898s
	iters: 400, epoch: 4 | loss: 0.1925986
	speed: 0.0119s/iter; left time: 110.2133s
	iters: 500, epoch: 4 | loss: 0.2151652
	speed: 0.0119s/iter; left time: 108.9673s
Epoch: 4 cost time: 7.044461965560913
Epoch: 4, Steps: 570 | Train Loss: 0.2983768 Vali Loss: 0.0602570 Test Loss: 0.1767666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16728396713733673, mae:0.26014572381973267
>>> MS_Raw LR=1e-3 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1621534
	speed: 0.0242s/iter; left time: 273.3839s
	iters: 200, epoch: 1 | loss: 0.4235111
	speed: 0.0125s/iter; left time: 140.4393s
	iters: 300, epoch: 1 | loss: 0.2352856
	speed: 0.0126s/iter; left time: 139.3554s
	iters: 400, epoch: 1 | loss: 0.4525290
	speed: 0.0115s/iter; left time: 126.5006s
	iters: 500, epoch: 1 | loss: 0.2929428
	speed: 0.0114s/iter; left time: 124.3841s
Epoch: 1 cost time: 8.104491710662842
Epoch: 1, Steps: 570 | Train Loss: 0.3089340 Vali Loss: 0.0703744 Test Loss: 0.2047924
Validation loss decreased (inf --> 0.070374).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2462121
	speed: 0.0398s/iter; left time: 427.2321s
	iters: 200, epoch: 2 | loss: 0.1961503
	speed: 0.0115s/iter; left time: 121.9798s
	iters: 300, epoch: 2 | loss: 0.1915278
	speed: 0.0115s/iter; left time: 120.8102s
	iters: 400, epoch: 2 | loss: 0.3650100
	speed: 0.0115s/iter; left time: 119.9225s
	iters: 500, epoch: 2 | loss: 0.5563440
	speed: 0.0117s/iter; left time: 120.6965s
Epoch: 2 cost time: 6.9012861251831055
Epoch: 2, Steps: 570 | Train Loss: 0.3197718 Vali Loss: 0.0647909 Test Loss: 0.1861613
Validation loss decreased (0.070374 --> 0.064791).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3419395
	speed: 0.0397s/iter; left time: 403.5890s
	iters: 200, epoch: 3 | loss: 0.1741049
	speed: 0.0120s/iter; left time: 120.2399s
	iters: 300, epoch: 3 | loss: 0.3266390
	speed: 0.0115s/iter; left time: 114.3836s
	iters: 400, epoch: 3 | loss: 0.2794829
	speed: 0.0115s/iter; left time: 113.3986s
	iters: 500, epoch: 3 | loss: 0.4134959
	speed: 0.0115s/iter; left time: 112.3169s
Epoch: 3 cost time: 6.928102493286133
Epoch: 3, Steps: 570 | Train Loss: 0.3013770 Vali Loss: 0.0672429 Test Loss: 0.1973960
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2597378
	speed: 0.0393s/iter; left time: 377.0970s
	iters: 200, epoch: 4 | loss: 0.1957911
	speed: 0.0115s/iter; left time: 109.5020s
	iters: 300, epoch: 4 | loss: 0.2042681
	speed: 0.0116s/iter; left time: 108.5081s
	iters: 400, epoch: 4 | loss: 0.2713029
	speed: 0.0115s/iter; left time: 107.2623s
	iters: 500, epoch: 4 | loss: 0.2831668
	speed: 0.0116s/iter; left time: 106.2407s
Epoch: 4 cost time: 6.884552001953125
Epoch: 4, Steps: 570 | Train Loss: 0.3059611 Vali Loss: 0.0696376 Test Loss: 0.1842965
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3049182
	speed: 0.0380s/iter; left time: 343.2250s
	iters: 200, epoch: 5 | loss: 0.2351806
	speed: 0.0115s/iter; left time: 102.6348s
	iters: 300, epoch: 5 | loss: 0.4495172
	speed: 0.0115s/iter; left time: 101.5639s
	iters: 400, epoch: 5 | loss: 0.2376069
	speed: 0.0115s/iter; left time: 100.3240s
	iters: 500, epoch: 5 | loss: 0.2409071
	speed: 0.0115s/iter; left time: 98.9599s
Epoch: 5 cost time: 6.849483489990234
Epoch: 5, Steps: 570 | Train Loss: 0.2914947 Vali Loss: 0.0645789 Test Loss: 0.1771692
Validation loss decreased (0.064791 --> 0.064579).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3137941
	speed: 0.0379s/iter; left time: 320.5983s
	iters: 200, epoch: 6 | loss: 0.3051760
	speed: 0.0114s/iter; left time: 95.5931s
	iters: 300, epoch: 6 | loss: 0.1748664
	speed: 0.0115s/iter; left time: 94.7492s
	iters: 400, epoch: 6 | loss: 0.2137271
	speed: 0.0115s/iter; left time: 93.7901s
	iters: 500, epoch: 6 | loss: 0.2155635
	speed: 0.0115s/iter; left time: 92.6543s
Epoch: 6 cost time: 6.85455846786499
Epoch: 6, Steps: 570 | Train Loss: 0.2856273 Vali Loss: 0.0634681 Test Loss: 0.1763937
Validation loss decreased (0.064579 --> 0.063468).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2200189
	speed: 0.0393s/iter; left time: 309.5230s
	iters: 200, epoch: 7 | loss: 0.3610333
	speed: 0.0115s/iter; left time: 89.4106s
	iters: 300, epoch: 7 | loss: 0.2429709
	speed: 0.0115s/iter; left time: 88.1169s
	iters: 400, epoch: 7 | loss: 0.2551625
	speed: 0.0115s/iter; left time: 87.0501s
	iters: 500, epoch: 7 | loss: 0.2693877
	speed: 0.0115s/iter; left time: 86.2425s
Epoch: 7 cost time: 6.887654066085815
Epoch: 7, Steps: 570 | Train Loss: 0.2844154 Vali Loss: 0.0636506 Test Loss: 0.1754195
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1919257
	speed: 0.0390s/iter; left time: 285.0577s
	iters: 200, epoch: 8 | loss: 0.2944022
	speed: 0.0114s/iter; left time: 82.5449s
	iters: 300, epoch: 8 | loss: 0.2542833
	speed: 0.0115s/iter; left time: 81.5094s
	iters: 400, epoch: 8 | loss: 0.2601533
	speed: 0.0115s/iter; left time: 80.4094s
	iters: 500, epoch: 8 | loss: 0.2570642
	speed: 0.0114s/iter; left time: 79.0779s
Epoch: 8 cost time: 6.851423263549805
Epoch: 8, Steps: 570 | Train Loss: 0.2814559 Vali Loss: 0.0634190 Test Loss: 0.1761353
Validation loss decreased (0.063468 --> 0.063419).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3800250
	speed: 0.0392s/iter; left time: 264.4881s
	iters: 200, epoch: 9 | loss: 0.1612675
	speed: 0.0115s/iter; left time: 76.1361s
	iters: 300, epoch: 9 | loss: 0.3236064
	speed: 0.0115s/iter; left time: 75.0779s
	iters: 400, epoch: 9 | loss: 0.3164397
	speed: 0.0115s/iter; left time: 73.9240s
	iters: 500, epoch: 9 | loss: 0.3997166
	speed: 0.0115s/iter; left time: 72.8134s
Epoch: 9 cost time: 6.839833736419678
Epoch: 9, Steps: 570 | Train Loss: 0.2817927 Vali Loss: 0.0627447 Test Loss: 0.1758721
Validation loss decreased (0.063419 --> 0.062745).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2104461
	speed: 0.0379s/iter; left time: 233.6623s
	iters: 200, epoch: 10 | loss: 0.2363057
	speed: 0.0114s/iter; left time: 69.3714s
	iters: 300, epoch: 10 | loss: 0.2046684
	speed: 0.0114s/iter; left time: 68.2090s
	iters: 400, epoch: 10 | loss: 0.2702019
	speed: 0.0114s/iter; left time: 67.1949s
	iters: 500, epoch: 10 | loss: 0.2903891
	speed: 0.0115s/iter; left time: 66.4739s
Epoch: 10 cost time: 6.85007381439209
Epoch: 10, Steps: 570 | Train Loss: 0.2824371 Vali Loss: 0.0631095 Test Loss: 0.1755162
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1698792
	speed: 0.0380s/iter; left time: 212.9380s
	iters: 200, epoch: 11 | loss: 0.2862641
	speed: 0.0115s/iter; left time: 63.1030s
	iters: 300, epoch: 11 | loss: 0.2626987
	speed: 0.0115s/iter; left time: 61.9407s
	iters: 400, epoch: 11 | loss: 0.3237939
	speed: 0.0115s/iter; left time: 60.8031s
	iters: 500, epoch: 11 | loss: 0.4603405
	speed: 0.0115s/iter; left time: 59.6628s
Epoch: 11 cost time: 6.80780291557312
Epoch: 11, Steps: 570 | Train Loss: 0.2805423 Vali Loss: 0.0631211 Test Loss: 0.1755228
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2366856
	speed: 0.0372s/iter; left time: 187.2023s
	iters: 200, epoch: 12 | loss: 0.2605909
	speed: 0.0114s/iter; left time: 56.3435s
	iters: 300, epoch: 12 | loss: 0.1787814
	speed: 0.0114s/iter; left time: 55.2102s
	iters: 400, epoch: 12 | loss: 0.3991050
	speed: 0.0114s/iter; left time: 54.0721s
	iters: 500, epoch: 12 | loss: 0.2452077
	speed: 0.0114s/iter; left time: 52.9367s
Epoch: 12 cost time: 6.805649280548096
Epoch: 12, Steps: 570 | Train Loss: 0.2828113 Vali Loss: 0.0631685 Test Loss: 0.1755223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17613042891025543, mae:0.26716727018356323
>>> MS_Raw LR=1e-3 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3310875
	speed: 0.0227s/iter; left time: 256.1151s
	iters: 200, epoch: 1 | loss: 0.3205411
	speed: 0.0108s/iter; left time: 120.8925s
	iters: 300, epoch: 1 | loss: 0.4598767
	speed: 0.0108s/iter; left time: 120.0269s
	iters: 400, epoch: 1 | loss: 0.3615898
	speed: 0.0108s/iter; left time: 118.6402s
	iters: 500, epoch: 1 | loss: 0.2669631
	speed: 0.0108s/iter; left time: 117.7054s
Epoch: 1 cost time: 7.3901612758636475
Epoch: 1, Steps: 570 | Train Loss: 0.3139204 Vali Loss: 0.0577420 Test Loss: 0.1718128
Validation loss decreased (inf --> 0.057742).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2738406
	speed: 0.0376s/iter; left time: 403.3492s
	iters: 200, epoch: 2 | loss: 0.3333329
	speed: 0.0109s/iter; left time: 115.3640s
	iters: 300, epoch: 2 | loss: 0.1958640
	speed: 0.0108s/iter; left time: 113.6172s
	iters: 400, epoch: 2 | loss: 0.2421278
	speed: 0.0108s/iter; left time: 112.7926s
	iters: 500, epoch: 2 | loss: 0.2657471
	speed: 0.0108s/iter; left time: 111.6014s
Epoch: 2 cost time: 6.49003005027771
Epoch: 2, Steps: 570 | Train Loss: 0.3191139 Vali Loss: 0.0683331 Test Loss: 0.1963060
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1974169
	speed: 0.0380s/iter; left time: 386.4395s
	iters: 200, epoch: 3 | loss: 0.2441244
	speed: 0.0109s/iter; left time: 109.4972s
	iters: 300, epoch: 3 | loss: 0.3068202
	speed: 0.0109s/iter; left time: 108.2909s
	iters: 400, epoch: 3 | loss: 0.3356909
	speed: 0.0109s/iter; left time: 107.4077s
	iters: 500, epoch: 3 | loss: 0.3248774
	speed: 0.0109s/iter; left time: 106.5424s
Epoch: 3 cost time: 6.497335433959961
Epoch: 3, Steps: 570 | Train Loss: 0.2982767 Vali Loss: 0.0630827 Test Loss: 0.1717639
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2849285
	speed: 0.0373s/iter; left time: 358.0106s
	iters: 200, epoch: 4 | loss: 0.1341906
	speed: 0.0120s/iter; left time: 114.2619s
	iters: 300, epoch: 4 | loss: 0.3374710
	speed: 0.0117s/iter; left time: 109.5835s
	iters: 400, epoch: 4 | loss: 0.4772728
	speed: 0.0108s/iter; left time: 100.5391s
	iters: 500, epoch: 4 | loss: 0.3229633
	speed: 0.0108s/iter; left time: 99.2938s
Epoch: 4 cost time: 6.743804454803467
Epoch: 4, Steps: 570 | Train Loss: 0.2769645 Vali Loss: 0.0623952 Test Loss: 0.1707577
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17203237116336823, mae:0.27029332518577576
>>> MS_Raw LR=1e-3 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2435709
	speed: 0.0284s/iter; left time: 320.6788s
	iters: 200, epoch: 1 | loss: 0.1911342
	speed: 0.0164s/iter; left time: 183.8651s
	iters: 300, epoch: 1 | loss: 0.3567736
	speed: 0.0165s/iter; left time: 182.6930s
	iters: 400, epoch: 1 | loss: 0.2810073
	speed: 0.0164s/iter; left time: 180.6409s
	iters: 500, epoch: 1 | loss: 0.2252716
	speed: 0.0165s/iter; left time: 179.4796s
Epoch: 1 cost time: 10.608845472335815
Epoch: 1, Steps: 570 | Train Loss: 0.2713187 Vali Loss: 0.0512629 Test Loss: 0.1473980
Validation loss decreased (inf --> 0.051263).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3252781
	speed: 0.0492s/iter; left time: 528.3923s
	iters: 200, epoch: 2 | loss: 0.2741295
	speed: 0.0147s/iter; left time: 155.8835s
	iters: 300, epoch: 2 | loss: 0.2366938
	speed: 0.0146s/iter; left time: 154.2674s
	iters: 400, epoch: 2 | loss: 0.1830042
	speed: 0.0147s/iter; left time: 152.8595s
	iters: 500, epoch: 2 | loss: 0.3432406
	speed: 0.0146s/iter; left time: 151.2898s
Epoch: 2 cost time: 8.6710205078125
Epoch: 2, Steps: 570 | Train Loss: 0.2852060 Vali Loss: 0.0700450 Test Loss: 0.2050198
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5130218
	speed: 0.0476s/iter; left time: 483.9823s
	iters: 200, epoch: 3 | loss: 0.3435275
	speed: 0.0144s/iter; left time: 145.2218s
	iters: 300, epoch: 3 | loss: 0.1621601
	speed: 0.0144s/iter; left time: 143.8276s
	iters: 400, epoch: 3 | loss: 0.2179836
	speed: 0.0144s/iter; left time: 142.1230s
	iters: 500, epoch: 3 | loss: 0.2560741
	speed: 0.0144s/iter; left time: 140.8606s
Epoch: 3 cost time: 8.475370168685913
Epoch: 3, Steps: 570 | Train Loss: 0.3024391 Vali Loss: 0.0615400 Test Loss: 0.1726220
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2690701
	speed: 0.0482s/iter; left time: 462.6518s
	iters: 200, epoch: 4 | loss: 0.2230475
	speed: 0.0146s/iter; left time: 138.6917s
	iters: 300, epoch: 4 | loss: 0.2580901
	speed: 0.0146s/iter; left time: 136.8451s
	iters: 400, epoch: 4 | loss: 0.2845585
	speed: 0.0146s/iter; left time: 135.6848s
	iters: 500, epoch: 4 | loss: 0.2436915
	speed: 0.0146s/iter; left time: 134.0869s
Epoch: 4 cost time: 8.61992335319519
Epoch: 4, Steps: 570 | Train Loss: 0.2748295 Vali Loss: 0.0567464 Test Loss: 0.1649906
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14764295518398285, mae:0.2447245717048645
>>> MS_Raw LR=1e-3 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3579422
	speed: 0.0258s/iter; left time: 291.3810s
	iters: 200, epoch: 1 | loss: 0.3188561
	speed: 0.0143s/iter; left time: 159.7826s
	iters: 300, epoch: 1 | loss: 0.1412449
	speed: 0.0143s/iter; left time: 158.3523s
	iters: 400, epoch: 1 | loss: 0.3408230
	speed: 0.0143s/iter; left time: 157.0758s
	iters: 500, epoch: 1 | loss: 0.2369466
	speed: 0.0143s/iter; left time: 155.5954s
Epoch: 1 cost time: 9.334291458129883
Epoch: 1, Steps: 570 | Train Loss: 0.2422368 Vali Loss: 0.0484057 Test Loss: 0.1495427
Validation loss decreased (inf --> 0.048406).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1942520
	speed: 0.0477s/iter; left time: 512.0598s
	iters: 200, epoch: 2 | loss: 0.2967184
	speed: 0.0144s/iter; left time: 152.7196s
	iters: 300, epoch: 2 | loss: 0.2182838
	speed: 0.0144s/iter; left time: 151.4888s
	iters: 400, epoch: 2 | loss: 0.2311323
	speed: 0.0144s/iter; left time: 150.0818s
	iters: 500, epoch: 2 | loss: 0.2057789
	speed: 0.0143s/iter; left time: 148.1107s
Epoch: 2 cost time: 8.502806425094604
Epoch: 2, Steps: 570 | Train Loss: 0.2377276 Vali Loss: 0.0728795 Test Loss: 0.2161092
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3237036
	speed: 0.0457s/iter; left time: 464.3586s
	iters: 200, epoch: 3 | loss: 0.1564135
	speed: 0.0142s/iter; left time: 143.2329s
	iters: 300, epoch: 3 | loss: 0.3661249
	speed: 0.0143s/iter; left time: 142.1208s
	iters: 400, epoch: 3 | loss: 0.1727637
	speed: 0.0143s/iter; left time: 140.9241s
	iters: 500, epoch: 3 | loss: 0.2421882
	speed: 0.0143s/iter; left time: 139.2033s
Epoch: 3 cost time: 8.436079025268555
Epoch: 3, Steps: 570 | Train Loss: 0.2786699 Vali Loss: 0.0570485 Test Loss: 0.1763236
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2777259
	speed: 0.0458s/iter; left time: 438.8183s
	iters: 200, epoch: 4 | loss: 0.2660138
	speed: 0.0143s/iter; left time: 135.9524s
	iters: 300, epoch: 4 | loss: 0.3011681
	speed: 0.0143s/iter; left time: 134.5904s
	iters: 400, epoch: 4 | loss: 0.1803908
	speed: 0.0143s/iter; left time: 132.9360s
	iters: 500, epoch: 4 | loss: 0.1449819
	speed: 0.0143s/iter; left time: 131.4930s
Epoch: 4 cost time: 8.444193363189697
Epoch: 4, Steps: 570 | Train Loss: 0.2481087 Vali Loss: 0.0525879 Test Loss: 0.1558835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.149746373295784, mae:0.24280180037021637
>>> MS_Raw LR=1e-3 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1354365
	speed: 0.0276s/iter; left time: 311.6488s
	iters: 200, epoch: 1 | loss: 0.3682787
	speed: 0.0143s/iter; left time: 160.1749s
	iters: 300, epoch: 1 | loss: 0.2754350
	speed: 0.0143s/iter; left time: 158.6136s
	iters: 400, epoch: 1 | loss: 0.2626590
	speed: 0.0143s/iter; left time: 157.6015s
	iters: 500, epoch: 1 | loss: 0.2970988
	speed: 0.0143s/iter; left time: 156.4066s
Epoch: 1 cost time: 9.535715818405151
Epoch: 1, Steps: 570 | Train Loss: 0.2840688 Vali Loss: 0.0640136 Test Loss: 0.1812901
Validation loss decreased (inf --> 0.064014).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2767709
	speed: 0.0480s/iter; left time: 515.5105s
	iters: 200, epoch: 2 | loss: 0.1961362
	speed: 0.0144s/iter; left time: 153.0410s
	iters: 300, epoch: 2 | loss: 0.1926715
	speed: 0.0144s/iter; left time: 151.4744s
	iters: 400, epoch: 2 | loss: 0.2650085
	speed: 0.0144s/iter; left time: 150.0635s
	iters: 500, epoch: 2 | loss: 0.3407041
	speed: 0.0144s/iter; left time: 149.0179s
Epoch: 2 cost time: 8.540446519851685
Epoch: 2, Steps: 570 | Train Loss: 0.2870881 Vali Loss: 0.0582459 Test Loss: 0.1693398
Validation loss decreased (0.064014 --> 0.058246).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2637312
	speed: 0.0468s/iter; left time: 475.9600s
	iters: 200, epoch: 3 | loss: 0.3161782
	speed: 0.0143s/iter; left time: 143.7590s
	iters: 300, epoch: 3 | loss: 0.2022959
	speed: 0.0143s/iter; left time: 142.4935s
	iters: 400, epoch: 3 | loss: 0.2054545
	speed: 0.0143s/iter; left time: 141.2716s
	iters: 500, epoch: 3 | loss: 0.2705434
	speed: 0.0164s/iter; left time: 160.3199s
Epoch: 3 cost time: 8.8562650680542
Epoch: 3, Steps: 570 | Train Loss: 0.2598173 Vali Loss: 0.0578059 Test Loss: 0.1630261
Validation loss decreased (0.058246 --> 0.057806).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2894474
	speed: 0.0516s/iter; left time: 494.6044s
	iters: 200, epoch: 4 | loss: 0.2260659
	speed: 0.0142s/iter; left time: 135.1904s
	iters: 300, epoch: 4 | loss: 0.2424885
	speed: 0.0142s/iter; left time: 133.8001s
	iters: 400, epoch: 4 | loss: 0.2020031
	speed: 0.0143s/iter; left time: 132.6958s
	iters: 500, epoch: 4 | loss: 0.1781809
	speed: 0.0143s/iter; left time: 131.2429s
Epoch: 4 cost time: 8.691572189331055
Epoch: 4, Steps: 570 | Train Loss: 0.2434683 Vali Loss: 0.0540485 Test Loss: 0.1607744
Validation loss decreased (0.057806 --> 0.054049).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2027901
	speed: 0.0489s/iter; left time: 441.0278s
	iters: 200, epoch: 5 | loss: 0.3091655
	speed: 0.0166s/iter; left time: 147.9653s
	iters: 300, epoch: 5 | loss: 0.1973173
	speed: 0.0166s/iter; left time: 146.1726s
	iters: 400, epoch: 5 | loss: 0.3333797
	speed: 0.0166s/iter; left time: 144.3973s
	iters: 500, epoch: 5 | loss: 0.2070854
	speed: 0.0166s/iter; left time: 143.1872s
Epoch: 5 cost time: 9.697163581848145
Epoch: 5, Steps: 570 | Train Loss: 0.2325874 Vali Loss: 0.0519195 Test Loss: 0.1577916
Validation loss decreased (0.054049 --> 0.051919).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2825751
	speed: 0.0503s/iter; left time: 424.8540s
	iters: 200, epoch: 6 | loss: 0.2050829
	speed: 0.0152s/iter; left time: 127.2679s
	iters: 300, epoch: 6 | loss: 0.1434190
	speed: 0.0143s/iter; left time: 117.9212s
	iters: 400, epoch: 6 | loss: 0.2691714
	speed: 0.0143s/iter; left time: 116.9214s
	iters: 500, epoch: 6 | loss: 0.1810805
	speed: 0.0143s/iter; left time: 115.3539s
Epoch: 6 cost time: 8.664576768875122
Epoch: 6, Steps: 570 | Train Loss: 0.2260295 Vali Loss: 0.0501509 Test Loss: 0.1582185
Validation loss decreased (0.051919 --> 0.050151).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3239396
	speed: 0.0469s/iter; left time: 369.4120s
	iters: 200, epoch: 7 | loss: 0.1413668
	speed: 0.0144s/iter; left time: 111.7301s
	iters: 300, epoch: 7 | loss: 0.1768094
	speed: 0.0144s/iter; left time: 110.5303s
	iters: 400, epoch: 7 | loss: 0.3414020
	speed: 0.0144s/iter; left time: 108.8078s
	iters: 500, epoch: 7 | loss: 0.2191450
	speed: 0.0143s/iter; left time: 107.2448s
Epoch: 7 cost time: 8.547470808029175
Epoch: 7, Steps: 570 | Train Loss: 0.2243734 Vali Loss: 0.0499334 Test Loss: 0.1556317
Validation loss decreased (0.050151 --> 0.049933).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1709580
	speed: 0.0479s/iter; left time: 350.3752s
	iters: 200, epoch: 8 | loss: 0.2004823
	speed: 0.0145s/iter; left time: 104.2820s
	iters: 300, epoch: 8 | loss: 0.2172453
	speed: 0.0144s/iter; left time: 102.5238s
	iters: 400, epoch: 8 | loss: 0.1888614
	speed: 0.0144s/iter; left time: 100.6238s
	iters: 500, epoch: 8 | loss: 0.1446288
	speed: 0.0144s/iter; left time: 99.6782s
Epoch: 8 cost time: 8.602750062942505
Epoch: 8, Steps: 570 | Train Loss: 0.2232421 Vali Loss: 0.0503342 Test Loss: 0.1561412
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2895650
	speed: 0.0490s/iter; left time: 330.0111s
	iters: 200, epoch: 9 | loss: 0.1684789
	speed: 0.0143s/iter; left time: 94.6952s
	iters: 300, epoch: 9 | loss: 0.1635505
	speed: 0.0142s/iter; left time: 93.2050s
	iters: 400, epoch: 9 | loss: 0.1515073
	speed: 0.0143s/iter; left time: 91.9022s
	iters: 500, epoch: 9 | loss: 0.2116920
	speed: 0.0143s/iter; left time: 90.4700s
Epoch: 9 cost time: 8.419826030731201
Epoch: 9, Steps: 570 | Train Loss: 0.2210441 Vali Loss: 0.0499185 Test Loss: 0.1554581
Validation loss decreased (0.049933 --> 0.049918).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2955706
	speed: 0.0463s/iter; left time: 285.8912s
	iters: 200, epoch: 10 | loss: 0.2255763
	speed: 0.0143s/iter; left time: 86.6265s
	iters: 300, epoch: 10 | loss: 0.1939872
	speed: 0.0143s/iter; left time: 85.2810s
	iters: 400, epoch: 10 | loss: 0.2501310
	speed: 0.0143s/iter; left time: 83.7997s
	iters: 500, epoch: 10 | loss: 0.2223947
	speed: 0.0143s/iter; left time: 82.4760s
Epoch: 10 cost time: 8.421456336975098
Epoch: 10, Steps: 570 | Train Loss: 0.2197289 Vali Loss: 0.0500757 Test Loss: 0.1554331
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2479482
	speed: 0.0452s/iter; left time: 253.2347s
	iters: 200, epoch: 11 | loss: 0.1726053
	speed: 0.0143s/iter; left time: 78.9047s
	iters: 300, epoch: 11 | loss: 0.1634731
	speed: 0.0143s/iter; left time: 77.4507s
	iters: 400, epoch: 11 | loss: 0.2541782
	speed: 0.0144s/iter; left time: 76.2315s
	iters: 500, epoch: 11 | loss: 0.1446469
	speed: 0.0143s/iter; left time: 74.5336s
Epoch: 11 cost time: 8.473797798156738
Epoch: 11, Steps: 570 | Train Loss: 0.2199666 Vali Loss: 0.0500236 Test Loss: 0.1554699
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1390455
	speed: 0.0480s/iter; left time: 241.5536s
	iters: 200, epoch: 12 | loss: 0.1907740
	speed: 0.0144s/iter; left time: 70.8707s
	iters: 300, epoch: 12 | loss: 0.2275511
	speed: 0.0144s/iter; left time: 69.3472s
	iters: 400, epoch: 12 | loss: 0.1400598
	speed: 0.0144s/iter; left time: 68.0068s
	iters: 500, epoch: 12 | loss: 0.2891672
	speed: 0.0144s/iter; left time: 66.5861s
Epoch: 12 cost time: 8.505484104156494
Epoch: 12, Steps: 570 | Train Loss: 0.2222741 Vali Loss: 0.0498362 Test Loss: 0.1554103
Validation loss decreased (0.049918 --> 0.049836).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1693378
	speed: 0.0472s/iter; left time: 210.3726s
	iters: 200, epoch: 13 | loss: 0.1841998
	speed: 0.0144s/iter; left time: 62.9988s
	iters: 300, epoch: 13 | loss: 0.2378055
	speed: 0.0145s/iter; left time: 61.6738s
	iters: 400, epoch: 13 | loss: 0.2329025
	speed: 0.0145s/iter; left time: 60.1425s
	iters: 500, epoch: 13 | loss: 0.2395816
	speed: 0.0144s/iter; left time: 58.6483s
Epoch: 13 cost time: 8.585042238235474
Epoch: 13, Steps: 570 | Train Loss: 0.2195402 Vali Loss: 0.0501228 Test Loss: 0.1554241
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1925913
	speed: 0.0461s/iter; left time: 179.2611s
	iters: 200, epoch: 14 | loss: 0.2345678
	speed: 0.0144s/iter; left time: 54.4475s
	iters: 300, epoch: 14 | loss: 0.1716644
	speed: 0.0143s/iter; left time: 52.9308s
	iters: 400, epoch: 14 | loss: 0.2786288
	speed: 0.0144s/iter; left time: 51.5686s
	iters: 500, epoch: 14 | loss: 0.2081250
	speed: 0.0144s/iter; left time: 50.1118s
Epoch: 14 cost time: 8.469043254852295
Epoch: 14, Steps: 570 | Train Loss: 0.2213041 Vali Loss: 0.0503268 Test Loss: 0.1554163
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2340338
	speed: 0.0461s/iter; left time: 152.9682s
	iters: 200, epoch: 15 | loss: 0.1625172
	speed: 0.0144s/iter; left time: 46.3809s
	iters: 300, epoch: 15 | loss: 0.2733411
	speed: 0.0144s/iter; left time: 45.0126s
	iters: 400, epoch: 15 | loss: 0.2272985
	speed: 0.0144s/iter; left time: 43.5134s
	iters: 500, epoch: 15 | loss: 0.1665039
	speed: 0.0144s/iter; left time: 42.0385s
Epoch: 15 cost time: 8.503800630569458
Epoch: 15, Steps: 570 | Train Loss: 0.2200371 Vali Loss: 0.0499670 Test Loss: 0.1554104
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15562692284584045, mae:0.2503296732902527
>>> MS_Raw LR=1e-3 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4231477
	speed: 0.0288s/iter; left time: 325.2290s
	iters: 200, epoch: 1 | loss: 0.2990322
	speed: 0.0169s/iter; left time: 189.5824s
	iters: 300, epoch: 1 | loss: 0.4513031
	speed: 0.0169s/iter; left time: 188.1555s
	iters: 400, epoch: 1 | loss: 0.2904619
	speed: 0.0169s/iter; left time: 186.3809s
	iters: 500, epoch: 1 | loss: 0.2761419
	speed: 0.0169s/iter; left time: 184.7378s
Epoch: 1 cost time: 10.8966224193573
Epoch: 1, Steps: 570 | Train Loss: 0.3566688 Vali Loss: 0.0702681 Test Loss: 0.1946494
Validation loss decreased (inf --> 0.070268).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4136405
	speed: 0.0513s/iter; left time: 550.2200s
	iters: 200, epoch: 2 | loss: 0.3237491
	speed: 0.0170s/iter; left time: 180.5260s
	iters: 300, epoch: 2 | loss: 0.3927438
	speed: 0.0170s/iter; left time: 178.6879s
	iters: 400, epoch: 2 | loss: 0.2460304
	speed: 0.0169s/iter; left time: 176.6233s
	iters: 500, epoch: 2 | loss: 0.3138577
	speed: 0.0170s/iter; left time: 175.2953s
Epoch: 2 cost time: 9.976891279220581
Epoch: 2, Steps: 570 | Train Loss: 0.3107000 Vali Loss: 0.0631987 Test Loss: 0.1842450
Validation loss decreased (0.070268 --> 0.063199).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2380202
	speed: 0.0535s/iter; left time: 543.3756s
	iters: 200, epoch: 3 | loss: 0.2695333
	speed: 0.0169s/iter; left time: 170.0348s
	iters: 300, epoch: 3 | loss: 0.4293661
	speed: 0.0169s/iter; left time: 168.6357s
	iters: 400, epoch: 3 | loss: 0.2429115
	speed: 0.0169s/iter; left time: 166.4699s
	iters: 500, epoch: 3 | loss: 0.2631704
	speed: 0.0169s/iter; left time: 164.6637s
Epoch: 3 cost time: 9.956318616867065
Epoch: 3, Steps: 570 | Train Loss: 0.2844806 Vali Loss: 0.0596799 Test Loss: 0.1749096
Validation loss decreased (0.063199 --> 0.059680).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3597705
	speed: 0.0540s/iter; left time: 517.4758s
	iters: 200, epoch: 4 | loss: 0.3170551
	speed: 0.0173s/iter; left time: 164.4162s
	iters: 300, epoch: 4 | loss: 0.2862722
	speed: 0.0182s/iter; left time: 170.6210s
	iters: 400, epoch: 4 | loss: 0.3588545
	speed: 0.0169s/iter; left time: 156.8599s
	iters: 500, epoch: 4 | loss: 0.2317751
	speed: 0.0169s/iter; left time: 155.2731s
Epoch: 4 cost time: 10.168071269989014
Epoch: 4, Steps: 570 | Train Loss: 0.2729959 Vali Loss: 0.0586416 Test Loss: 0.1634108
Validation loss decreased (0.059680 --> 0.058642).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1480240
	speed: 0.0526s/iter; left time: 474.0843s
	iters: 200, epoch: 5 | loss: 0.2854924
	speed: 0.0169s/iter; left time: 150.7436s
	iters: 300, epoch: 5 | loss: 0.2601712
	speed: 0.0169s/iter; left time: 148.7933s
	iters: 400, epoch: 5 | loss: 0.2432022
	speed: 0.0169s/iter; left time: 147.0092s
	iters: 500, epoch: 5 | loss: 0.2031509
	speed: 0.0169s/iter; left time: 145.3904s
Epoch: 5 cost time: 9.961719989776611
Epoch: 5, Steps: 570 | Train Loss: 0.2617277 Vali Loss: 0.0552872 Test Loss: 0.1606847
Validation loss decreased (0.058642 --> 0.055287).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3094109
	speed: 0.0522s/iter; left time: 441.3005s
	iters: 200, epoch: 6 | loss: 0.2309000
	speed: 0.0169s/iter; left time: 140.8485s
	iters: 300, epoch: 6 | loss: 0.2965054
	speed: 0.0169s/iter; left time: 139.4174s
	iters: 400, epoch: 6 | loss: 0.3793553
	speed: 0.0169s/iter; left time: 137.4978s
	iters: 500, epoch: 6 | loss: 0.1989893
	speed: 0.0169s/iter; left time: 135.7404s
Epoch: 6 cost time: 9.945235252380371
Epoch: 6, Steps: 570 | Train Loss: 0.2568656 Vali Loss: 0.0557706 Test Loss: 0.1589244
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1992728
	speed: 0.0508s/iter; left time: 400.3871s
	iters: 200, epoch: 7 | loss: 0.2386451
	speed: 0.0169s/iter; left time: 131.8123s
	iters: 300, epoch: 7 | loss: 0.3433176
	speed: 0.0169s/iter; left time: 129.9503s
	iters: 400, epoch: 7 | loss: 0.1856261
	speed: 0.0169s/iter; left time: 128.2724s
	iters: 500, epoch: 7 | loss: 0.2049061
	speed: 0.0169s/iter; left time: 126.6542s
Epoch: 7 cost time: 9.98362398147583
Epoch: 7, Steps: 570 | Train Loss: 0.2552189 Vali Loss: 0.0553833 Test Loss: 0.1578540
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2772514
	speed: 0.0505s/iter; left time: 369.3114s
	iters: 200, epoch: 8 | loss: 0.1852691
	speed: 0.0169s/iter; left time: 121.9656s
	iters: 300, epoch: 8 | loss: 0.2553893
	speed: 0.0169s/iter; left time: 120.3446s
	iters: 400, epoch: 8 | loss: 0.1523726
	speed: 0.0169s/iter; left time: 118.4934s
	iters: 500, epoch: 8 | loss: 0.1697097
	speed: 0.0169s/iter; left time: 116.8248s
Epoch: 8 cost time: 9.948853254318237
Epoch: 8, Steps: 570 | Train Loss: 0.2544855 Vali Loss: 0.0552160 Test Loss: 0.1583025
Validation loss decreased (0.055287 --> 0.055216).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2468323
	speed: 0.0527s/iter; left time: 355.5297s
	iters: 200, epoch: 9 | loss: 0.1402135
	speed: 0.0180s/iter; left time: 119.3974s
	iters: 300, epoch: 9 | loss: 0.2766612
	speed: 0.0170s/iter; left time: 111.0289s
	iters: 400, epoch: 9 | loss: 0.2861530
	speed: 0.0170s/iter; left time: 109.4109s
	iters: 500, epoch: 9 | loss: 0.3543449
	speed: 0.0170s/iter; left time: 107.5656s
Epoch: 9 cost time: 10.236961364746094
Epoch: 9, Steps: 570 | Train Loss: 0.2515577 Vali Loss: 0.0554824 Test Loss: 0.1580071
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3629105
	speed: 0.0509s/iter; left time: 314.0027s
	iters: 200, epoch: 10 | loss: 0.1137268
	speed: 0.0169s/iter; left time: 102.6575s
	iters: 300, epoch: 10 | loss: 0.3536044
	speed: 0.0169s/iter; left time: 101.0138s
	iters: 400, epoch: 10 | loss: 0.3374973
	speed: 0.0169s/iter; left time: 99.3108s
	iters: 500, epoch: 10 | loss: 0.2181917
	speed: 0.0169s/iter; left time: 97.6336s
Epoch: 10 cost time: 9.949589967727661
Epoch: 10, Steps: 570 | Train Loss: 0.2517068 Vali Loss: 0.0553969 Test Loss: 0.1578377
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1954637
	speed: 0.0498s/iter; left time: 279.0238s
	iters: 200, epoch: 11 | loss: 0.2611381
	speed: 0.0169s/iter; left time: 93.1365s
	iters: 300, epoch: 11 | loss: 0.1358562
	speed: 0.0169s/iter; left time: 91.4346s
	iters: 400, epoch: 11 | loss: 0.2665876
	speed: 0.0174s/iter; left time: 92.3298s
	iters: 500, epoch: 11 | loss: 0.3374287
	speed: 0.0181s/iter; left time: 94.1920s
Epoch: 11 cost time: 10.214757919311523
Epoch: 11, Steps: 570 | Train Loss: 0.2517991 Vali Loss: 0.0553704 Test Loss: 0.1576126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15853843092918396, mae:0.2533927857875824
>>> MS_Raw LR=1e-3 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2764733
	speed: 0.0289s/iter; left time: 327.0203s
	iters: 200, epoch: 1 | loss: 0.2327543
	speed: 0.0163s/iter; left time: 182.3523s
	iters: 300, epoch: 1 | loss: 0.3357033
	speed: 0.0163s/iter; left time: 180.8600s
	iters: 400, epoch: 1 | loss: 0.3047566
	speed: 0.0163s/iter; left time: 179.0986s
	iters: 500, epoch: 1 | loss: 0.1972861
	speed: 0.0163s/iter; left time: 177.8786s
Epoch: 1 cost time: 10.602493286132812
Epoch: 1, Steps: 570 | Train Loss: 0.3256827 Vali Loss: 0.0674371 Test Loss: 0.1923324
Validation loss decreased (inf --> 0.067437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2472515
	speed: 0.0510s/iter; left time: 546.9526s
	iters: 200, epoch: 2 | loss: 0.1821082
	speed: 0.0163s/iter; left time: 173.5775s
	iters: 300, epoch: 2 | loss: 0.3611526
	speed: 0.0163s/iter; left time: 171.7741s
	iters: 400, epoch: 2 | loss: 0.4608039
	speed: 0.0163s/iter; left time: 170.1570s
	iters: 500, epoch: 2 | loss: 0.3331698
	speed: 0.0163s/iter; left time: 168.9065s
Epoch: 2 cost time: 9.624946355819702
Epoch: 2, Steps: 570 | Train Loss: 0.3138315 Vali Loss: 0.0646692 Test Loss: 0.1826266
Validation loss decreased (0.067437 --> 0.064669).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3125826
	speed: 0.0507s/iter; left time: 515.3158s
	iters: 200, epoch: 3 | loss: 0.3133857
	speed: 0.0164s/iter; left time: 164.8794s
	iters: 300, epoch: 3 | loss: 0.1997578
	speed: 0.0164s/iter; left time: 163.0935s
	iters: 400, epoch: 3 | loss: 0.3287965
	speed: 0.0164s/iter; left time: 161.5550s
	iters: 500, epoch: 3 | loss: 0.1674982
	speed: 0.0164s/iter; left time: 159.9723s
Epoch: 3 cost time: 9.644025564193726
Epoch: 3, Steps: 570 | Train Loss: 0.2841374 Vali Loss: 0.0582497 Test Loss: 0.1715780
Validation loss decreased (0.064669 --> 0.058250).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1959866
	speed: 0.0500s/iter; left time: 479.7765s
	iters: 200, epoch: 4 | loss: 0.6555514
	speed: 0.0164s/iter; left time: 155.4129s
	iters: 300, epoch: 4 | loss: 0.2739381
	speed: 0.0164s/iter; left time: 153.5586s
	iters: 400, epoch: 4 | loss: 0.1755477
	speed: 0.0164s/iter; left time: 152.0525s
	iters: 500, epoch: 4 | loss: 0.3965024
	speed: 0.0164s/iter; left time: 150.2981s
Epoch: 4 cost time: 9.65489912033081
Epoch: 4, Steps: 570 | Train Loss: 0.2689576 Vali Loss: 0.0583956 Test Loss: 0.1655976
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2582152
	speed: 0.0509s/iter; left time: 459.5438s
	iters: 200, epoch: 5 | loss: 0.3659150
	speed: 0.0164s/iter; left time: 146.0719s
	iters: 300, epoch: 5 | loss: 0.2310751
	speed: 0.0164s/iter; left time: 144.4427s
	iters: 400, epoch: 5 | loss: 0.1816646
	speed: 0.0164s/iter; left time: 142.6623s
	iters: 500, epoch: 5 | loss: 0.3596244
	speed: 0.0164s/iter; left time: 141.0550s
Epoch: 5 cost time: 9.649826288223267
Epoch: 5, Steps: 570 | Train Loss: 0.2582919 Vali Loss: 0.0567488 Test Loss: 0.1616790
Validation loss decreased (0.058250 --> 0.056749).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2957802
	speed: 0.0508s/iter; left time: 429.6361s
	iters: 200, epoch: 6 | loss: 0.3656701
	speed: 0.0164s/iter; left time: 136.7941s
	iters: 300, epoch: 6 | loss: 0.5005087
	speed: 0.0164s/iter; left time: 135.4939s
	iters: 400, epoch: 6 | loss: 0.2646871
	speed: 0.0164s/iter; left time: 133.7924s
	iters: 500, epoch: 6 | loss: 0.2224196
	speed: 0.0164s/iter; left time: 132.1058s
Epoch: 6 cost time: 9.653474569320679
Epoch: 6, Steps: 570 | Train Loss: 0.2525463 Vali Loss: 0.0566615 Test Loss: 0.1613017
Validation loss decreased (0.056749 --> 0.056661).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2991766
	speed: 0.0507s/iter; left time: 399.5428s
	iters: 200, epoch: 7 | loss: 0.1717590
	speed: 0.0163s/iter; left time: 126.7350s
	iters: 300, epoch: 7 | loss: 0.2409506
	speed: 0.0163s/iter; left time: 125.0750s
	iters: 400, epoch: 7 | loss: 0.3314831
	speed: 0.0163s/iter; left time: 123.8108s
	iters: 500, epoch: 7 | loss: 0.3442245
	speed: 0.0164s/iter; left time: 122.4999s
Epoch: 7 cost time: 9.62721037864685
Epoch: 7, Steps: 570 | Train Loss: 0.2513187 Vali Loss: 0.0563184 Test Loss: 0.1605487
Validation loss decreased (0.056661 --> 0.056318).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1689795
	speed: 0.0512s/iter; left time: 374.5355s
	iters: 200, epoch: 8 | loss: 0.3971741
	speed: 0.0163s/iter; left time: 117.7355s
	iters: 300, epoch: 8 | loss: 0.3039874
	speed: 0.0163s/iter; left time: 116.1054s
	iters: 400, epoch: 8 | loss: 0.2689097
	speed: 0.0163s/iter; left time: 114.4600s
	iters: 500, epoch: 8 | loss: 0.2332681
	speed: 0.0163s/iter; left time: 112.8271s
Epoch: 8 cost time: 9.62436056137085
Epoch: 8, Steps: 570 | Train Loss: 0.2480591 Vali Loss: 0.0560904 Test Loss: 0.1599616
Validation loss decreased (0.056318 --> 0.056090).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1714244
	speed: 0.0525s/iter; left time: 353.7346s
	iters: 200, epoch: 9 | loss: 0.2399662
	speed: 0.0163s/iter; left time: 108.4663s
	iters: 300, epoch: 9 | loss: 0.1432478
	speed: 0.0163s/iter; left time: 106.8993s
	iters: 400, epoch: 9 | loss: 0.2058955
	speed: 0.0164s/iter; left time: 105.5232s
	iters: 500, epoch: 9 | loss: 0.1150765
	speed: 0.0163s/iter; left time: 103.6534s
Epoch: 9 cost time: 9.632782220840454
Epoch: 9, Steps: 570 | Train Loss: 0.2479948 Vali Loss: 0.0558472 Test Loss: 0.1595002
Validation loss decreased (0.056090 --> 0.055847).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3212492
	speed: 0.0513s/iter; left time: 316.4958s
	iters: 200, epoch: 10 | loss: 0.2343052
	speed: 0.0163s/iter; left time: 99.0854s
	iters: 300, epoch: 10 | loss: 0.1787103
	speed: 0.0163s/iter; left time: 97.5277s
	iters: 400, epoch: 10 | loss: 0.2474824
	speed: 0.0163s/iter; left time: 95.6339s
	iters: 500, epoch: 10 | loss: 0.1732036
	speed: 0.0163s/iter; left time: 94.1396s
Epoch: 10 cost time: 9.601993083953857
Epoch: 10, Steps: 570 | Train Loss: 0.2465933 Vali Loss: 0.0556785 Test Loss: 0.1596540
Validation loss decreased (0.055847 --> 0.055678).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1643394
	speed: 0.0500s/iter; left time: 279.8259s
	iters: 200, epoch: 11 | loss: 0.1678609
	speed: 0.0163s/iter; left time: 89.6085s
	iters: 300, epoch: 11 | loss: 0.2018326
	speed: 0.0163s/iter; left time: 87.9660s
	iters: 400, epoch: 11 | loss: 0.2276821
	speed: 0.0163s/iter; left time: 86.2094s
	iters: 500, epoch: 11 | loss: 0.1991215
	speed: 0.0163s/iter; left time: 84.9159s
Epoch: 11 cost time: 9.585314989089966
Epoch: 11, Steps: 570 | Train Loss: 0.2476586 Vali Loss: 0.0559690 Test Loss: 0.1596856
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1573327
	speed: 0.0514s/iter; left time: 258.5837s
	iters: 200, epoch: 12 | loss: 0.2785705
	speed: 0.0164s/iter; left time: 80.8736s
	iters: 300, epoch: 12 | loss: 0.1592060
	speed: 0.0164s/iter; left time: 79.2141s
	iters: 400, epoch: 12 | loss: 0.2363529
	speed: 0.0164s/iter; left time: 77.5202s
	iters: 500, epoch: 12 | loss: 0.3511350
	speed: 0.0164s/iter; left time: 75.9134s
Epoch: 12 cost time: 9.621078968048096
Epoch: 12, Steps: 570 | Train Loss: 0.2443652 Vali Loss: 0.0558417 Test Loss: 0.1596739
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3338568
	speed: 0.0506s/iter; left time: 225.7232s
	iters: 200, epoch: 13 | loss: 0.2935806
	speed: 0.0163s/iter; left time: 70.9521s
	iters: 300, epoch: 13 | loss: 0.2703342
	speed: 0.0162s/iter; left time: 69.2215s
	iters: 400, epoch: 13 | loss: 0.1846772
	speed: 0.0163s/iter; left time: 68.0063s
	iters: 500, epoch: 13 | loss: 0.2558920
	speed: 0.0163s/iter; left time: 66.0156s
Epoch: 13 cost time: 9.599379777908325
Epoch: 13, Steps: 570 | Train Loss: 0.2451861 Vali Loss: 0.0559950 Test Loss: 0.1596886
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15988914668560028, mae:0.255709171295166
>>> MS_Raw LR=1e-3 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3528516
	speed: 0.0275s/iter; left time: 310.2222s
	iters: 200, epoch: 1 | loss: 0.3574461
	speed: 0.0154s/iter; left time: 172.9588s
	iters: 300, epoch: 1 | loss: 0.2459876
	speed: 0.0154s/iter; left time: 171.1839s
	iters: 400, epoch: 1 | loss: 0.3437310
	speed: 0.0155s/iter; left time: 170.0146s
	iters: 500, epoch: 1 | loss: 0.5735512
	speed: 0.0155s/iter; left time: 168.6764s
Epoch: 1 cost time: 10.06455397605896
Epoch: 1, Steps: 570 | Train Loss: 0.3299547 Vali Loss: 0.0726970 Test Loss: 0.1894750
Validation loss decreased (inf --> 0.072697).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4155256
	speed: 0.0486s/iter; left time: 521.7674s
	iters: 200, epoch: 2 | loss: 0.1897063
	speed: 0.0155s/iter; left time: 164.5921s
	iters: 300, epoch: 2 | loss: 0.3088529
	speed: 0.0155s/iter; left time: 162.8111s
	iters: 400, epoch: 2 | loss: 0.3127601
	speed: 0.0155s/iter; left time: 161.4516s
	iters: 500, epoch: 2 | loss: 0.4591195
	speed: 0.0154s/iter; left time: 159.2332s
Epoch: 2 cost time: 9.096610307693481
Epoch: 2, Steps: 570 | Train Loss: 0.3048152 Vali Loss: 0.0728215 Test Loss: 0.1978776
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3362475
	speed: 0.0469s/iter; left time: 476.8051s
	iters: 200, epoch: 3 | loss: 0.1796288
	speed: 0.0155s/iter; left time: 155.5334s
	iters: 300, epoch: 3 | loss: 0.3259010
	speed: 0.0154s/iter; left time: 153.7453s
	iters: 400, epoch: 3 | loss: 0.3156268
	speed: 0.0155s/iter; left time: 152.5499s
	iters: 500, epoch: 3 | loss: 0.2664908
	speed: 0.0155s/iter; left time: 150.9601s
Epoch: 3 cost time: 9.06705355644226
Epoch: 3, Steps: 570 | Train Loss: 0.3005098 Vali Loss: 0.0633868 Test Loss: 0.1851613
Validation loss decreased (0.072697 --> 0.063387).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2100977
	speed: 0.0481s/iter; left time: 461.4791s
	iters: 200, epoch: 4 | loss: 0.3616856
	speed: 0.0154s/iter; left time: 146.1379s
	iters: 300, epoch: 4 | loss: 0.4346203
	speed: 0.0154s/iter; left time: 144.3893s
	iters: 400, epoch: 4 | loss: 0.2474310
	speed: 0.0154s/iter; left time: 142.8799s
	iters: 500, epoch: 4 | loss: 0.3295820
	speed: 0.0154s/iter; left time: 141.5421s
Epoch: 4 cost time: 9.08295750617981
Epoch: 4, Steps: 570 | Train Loss: 0.2913144 Vali Loss: 0.0619122 Test Loss: 0.1752462
Validation loss decreased (0.063387 --> 0.061912).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3288084
	speed: 0.0521s/iter; left time: 469.7619s
	iters: 200, epoch: 5 | loss: 0.2195111
	speed: 0.0156s/iter; left time: 139.1207s
	iters: 300, epoch: 5 | loss: 0.2494730
	speed: 0.0155s/iter; left time: 137.1586s
	iters: 400, epoch: 5 | loss: 0.1984664
	speed: 0.0156s/iter; left time: 135.8318s
	iters: 500, epoch: 5 | loss: 0.2411065
	speed: 0.0155s/iter; left time: 133.9634s
Epoch: 5 cost time: 9.172489881515503
Epoch: 5, Steps: 570 | Train Loss: 0.2832449 Vali Loss: 0.0608572 Test Loss: 0.1716351
Validation loss decreased (0.061912 --> 0.060857).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3289462
	speed: 0.0529s/iter; left time: 447.3389s
	iters: 200, epoch: 6 | loss: 0.2251569
	speed: 0.0155s/iter; left time: 129.2674s
	iters: 300, epoch: 6 | loss: 0.1530811
	speed: 0.0155s/iter; left time: 127.7134s
	iters: 400, epoch: 6 | loss: 0.1735361
	speed: 0.0155s/iter; left time: 125.9441s
	iters: 500, epoch: 6 | loss: 0.2480948
	speed: 0.0168s/iter; left time: 134.8802s
Epoch: 6 cost time: 9.509129524230957
Epoch: 6, Steps: 570 | Train Loss: 0.2769288 Vali Loss: 0.0607782 Test Loss: 0.1672092
Validation loss decreased (0.060857 --> 0.060778).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2894515
	speed: 0.0495s/iter; left time: 390.3308s
	iters: 200, epoch: 7 | loss: 0.2232478
	speed: 0.0154s/iter; left time: 119.7992s
	iters: 300, epoch: 7 | loss: 0.2083797
	speed: 0.0154s/iter; left time: 117.9645s
	iters: 400, epoch: 7 | loss: 0.2925494
	speed: 0.0154s/iter; left time: 116.4212s
	iters: 500, epoch: 7 | loss: 0.2986919
	speed: 0.0154s/iter; left time: 114.9812s
Epoch: 7 cost time: 9.09462857246399
Epoch: 7, Steps: 570 | Train Loss: 0.2726304 Vali Loss: 0.0607205 Test Loss: 0.1663236
Validation loss decreased (0.060778 --> 0.060720).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2765966
	speed: 0.0510s/iter; left time: 372.7394s
	iters: 200, epoch: 8 | loss: 0.3518615
	speed: 0.0177s/iter; left time: 127.8733s
	iters: 300, epoch: 8 | loss: 0.1765554
	speed: 0.0177s/iter; left time: 125.9590s
	iters: 400, epoch: 8 | loss: 0.2702326
	speed: 0.0177s/iter; left time: 124.1162s
	iters: 500, epoch: 8 | loss: 0.2131765
	speed: 0.0177s/iter; left time: 122.3740s
Epoch: 8 cost time: 10.222383975982666
Epoch: 8, Steps: 570 | Train Loss: 0.2694661 Vali Loss: 0.0601330 Test Loss: 0.1655186
Validation loss decreased (0.060720 --> 0.060133).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2739267
	speed: 0.0516s/iter; left time: 347.6760s
	iters: 200, epoch: 9 | loss: 0.3057661
	speed: 0.0177s/iter; left time: 117.3313s
	iters: 300, epoch: 9 | loss: 0.2766374
	speed: 0.0177s/iter; left time: 115.5715s
	iters: 400, epoch: 9 | loss: 0.1855141
	speed: 0.0172s/iter; left time: 110.9953s
	iters: 500, epoch: 9 | loss: 0.2378395
	speed: 0.0154s/iter; left time: 97.4781s
Epoch: 9 cost time: 9.937765121459961
Epoch: 9, Steps: 570 | Train Loss: 0.2694652 Vali Loss: 0.0601589 Test Loss: 0.1652751
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2965716
	speed: 0.0480s/iter; left time: 296.0652s
	iters: 200, epoch: 10 | loss: 0.3119071
	speed: 0.0154s/iter; left time: 93.7615s
	iters: 300, epoch: 10 | loss: 0.1638429
	speed: 0.0154s/iter; left time: 92.2118s
	iters: 400, epoch: 10 | loss: 0.3317775
	speed: 0.0155s/iter; left time: 90.7349s
	iters: 500, epoch: 10 | loss: 0.5118732
	speed: 0.0154s/iter; left time: 89.1155s
Epoch: 10 cost time: 9.113977432250977
Epoch: 10, Steps: 570 | Train Loss: 0.2700157 Vali Loss: 0.0602742 Test Loss: 0.1647697
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2693446
	speed: 0.0477s/iter; left time: 267.2071s
	iters: 200, epoch: 11 | loss: 0.1961205
	speed: 0.0154s/iter; left time: 84.8785s
	iters: 300, epoch: 11 | loss: 0.2544862
	speed: 0.0154s/iter; left time: 83.3493s
	iters: 400, epoch: 11 | loss: 0.2897861
	speed: 0.0154s/iter; left time: 81.8003s
	iters: 500, epoch: 11 | loss: 0.3234709
	speed: 0.0154s/iter; left time: 80.2464s
Epoch: 11 cost time: 9.100020408630371
Epoch: 11, Steps: 570 | Train Loss: 0.2692987 Vali Loss: 0.0602649 Test Loss: 0.1648742
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16577757894992828, mae:0.26132142543792725
>>> MS_Raw LR=1e-3 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2132039
	speed: 0.0303s/iter; left time: 342.8938s
	iters: 200, epoch: 1 | loss: 0.2482248
	speed: 0.0186s/iter; left time: 208.2560s
	iters: 300, epoch: 1 | loss: 0.4155103
	speed: 0.0186s/iter; left time: 206.2561s
	iters: 400, epoch: 1 | loss: 0.2788582
	speed: 0.0186s/iter; left time: 204.9103s
	iters: 500, epoch: 1 | loss: 0.2421324
	speed: 0.0186s/iter; left time: 203.0447s
Epoch: 1 cost time: 11.829562664031982
Epoch: 1, Steps: 570 | Train Loss: 0.2878056 Vali Loss: 0.0654367 Test Loss: 0.1771272
Validation loss decreased (inf --> 0.065437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5202433
	speed: 0.0611s/iter; left time: 655.6451s
	iters: 200, epoch: 2 | loss: 0.2306121
	speed: 0.0210s/iter; left time: 223.7381s
	iters: 300, epoch: 2 | loss: 0.2242718
	speed: 0.0210s/iter; left time: 220.7226s
	iters: 400, epoch: 2 | loss: 0.2614449
	speed: 0.0209s/iter; left time: 217.8016s
	iters: 500, epoch: 2 | loss: 0.2152333
	speed: 0.0209s/iter; left time: 215.7392s
Epoch: 2 cost time: 12.227595567703247
Epoch: 2, Steps: 570 | Train Loss: 0.2904823 Vali Loss: 0.0628499 Test Loss: 0.1861763
Validation loss decreased (0.065437 --> 0.062850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2092441
	speed: 0.0587s/iter; left time: 596.9072s
	iters: 200, epoch: 3 | loss: 0.3344850
	speed: 0.0188s/iter; left time: 189.3130s
	iters: 300, epoch: 3 | loss: 0.2349855
	speed: 0.0188s/iter; left time: 187.0821s
	iters: 400, epoch: 3 | loss: 0.1700952
	speed: 0.0188s/iter; left time: 185.2309s
	iters: 500, epoch: 3 | loss: 0.2035912
	speed: 0.0188s/iter; left time: 183.0214s
Epoch: 3 cost time: 11.003241539001465
Epoch: 3, Steps: 570 | Train Loss: 0.2683181 Vali Loss: 0.0603431 Test Loss: 0.1769986
Validation loss decreased (0.062850 --> 0.060343).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2909709
	speed: 0.0564s/iter; left time: 540.6202s
	iters: 200, epoch: 4 | loss: 0.3411694
	speed: 0.0186s/iter; left time: 176.1554s
	iters: 300, epoch: 4 | loss: 0.3257471
	speed: 0.0186s/iter; left time: 174.2864s
	iters: 400, epoch: 4 | loss: 0.1559393
	speed: 0.0185s/iter; left time: 172.2273s
	iters: 500, epoch: 4 | loss: 0.2574477
	speed: 0.0185s/iter; left time: 170.4236s
Epoch: 4 cost time: 10.884256601333618
Epoch: 4, Steps: 570 | Train Loss: 0.2628267 Vali Loss: 0.0567002 Test Loss: 0.1610373
Validation loss decreased (0.060343 --> 0.056700).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2836421
	speed: 0.0566s/iter; left time: 510.8460s
	iters: 200, epoch: 5 | loss: 0.2339277
	speed: 0.0186s/iter; left time: 166.0772s
	iters: 300, epoch: 5 | loss: 0.2372324
	speed: 0.0186s/iter; left time: 164.3398s
	iters: 400, epoch: 5 | loss: 0.2867775
	speed: 0.0186s/iter; left time: 162.3505s
	iters: 500, epoch: 5 | loss: 0.2466409
	speed: 0.0186s/iter; left time: 160.6081s
Epoch: 5 cost time: 10.915096998214722
Epoch: 5, Steps: 570 | Train Loss: 0.2554568 Vali Loss: 0.0538172 Test Loss: 0.1566114
Validation loss decreased (0.056700 --> 0.053817).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1382849
	speed: 0.0588s/iter; left time: 497.3319s
	iters: 200, epoch: 6 | loss: 0.2312297
	speed: 0.0185s/iter; left time: 154.3493s
	iters: 300, epoch: 6 | loss: 0.2006404
	speed: 0.0185s/iter; left time: 152.5575s
	iters: 400, epoch: 6 | loss: 0.2580297
	speed: 0.0185s/iter; left time: 150.9395s
	iters: 500, epoch: 6 | loss: 0.2003629
	speed: 0.0185s/iter; left time: 148.8351s
Epoch: 6 cost time: 10.808360815048218
Epoch: 6, Steps: 570 | Train Loss: 0.2458913 Vali Loss: 0.0522738 Test Loss: 0.1558172
Validation loss decreased (0.053817 --> 0.052274).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1853729
	speed: 0.0558s/iter; left time: 439.8648s
	iters: 200, epoch: 7 | loss: 0.2679348
	speed: 0.0185s/iter; left time: 144.1474s
	iters: 300, epoch: 7 | loss: 0.1970098
	speed: 0.0185s/iter; left time: 142.2222s
	iters: 400, epoch: 7 | loss: 0.2792156
	speed: 0.0185s/iter; left time: 140.4063s
	iters: 500, epoch: 7 | loss: 0.3566693
	speed: 0.0185s/iter; left time: 138.5037s
Epoch: 7 cost time: 10.844084739685059
Epoch: 7, Steps: 570 | Train Loss: 0.2409843 Vali Loss: 0.0515541 Test Loss: 0.1536989
Validation loss decreased (0.052274 --> 0.051554).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2299775
	speed: 0.0580s/iter; left time: 424.3755s
	iters: 200, epoch: 8 | loss: 0.2109481
	speed: 0.0186s/iter; left time: 134.4302s
	iters: 300, epoch: 8 | loss: 0.1976876
	speed: 0.0186s/iter; left time: 132.4104s
	iters: 400, epoch: 8 | loss: 0.3727143
	speed: 0.0186s/iter; left time: 130.5297s
	iters: 500, epoch: 8 | loss: 0.2535819
	speed: 0.0186s/iter; left time: 128.7419s
Epoch: 8 cost time: 10.984886646270752
Epoch: 8, Steps: 570 | Train Loss: 0.2374367 Vali Loss: 0.0513114 Test Loss: 0.1529048
Validation loss decreased (0.051554 --> 0.051311).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1614419
	speed: 0.0567s/iter; left time: 382.2578s
	iters: 200, epoch: 9 | loss: 0.3201469
	speed: 0.0186s/iter; left time: 123.5614s
	iters: 300, epoch: 9 | loss: 0.1190581
	speed: 0.0185s/iter; left time: 121.3355s
	iters: 400, epoch: 9 | loss: 0.2792606
	speed: 0.0185s/iter; left time: 119.1970s
	iters: 500, epoch: 9 | loss: 0.1153495
	speed: 0.0185s/iter; left time: 117.6073s
Epoch: 9 cost time: 10.870237112045288
Epoch: 9, Steps: 570 | Train Loss: 0.2353253 Vali Loss: 0.0511915 Test Loss: 0.1528212
Validation loss decreased (0.051311 --> 0.051191).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2203282
	speed: 0.0576s/iter; left time: 355.4678s
	iters: 200, epoch: 10 | loss: 0.2659106
	speed: 0.0187s/iter; left time: 113.7334s
	iters: 300, epoch: 10 | loss: 0.1446058
	speed: 0.0187s/iter; left time: 111.6673s
	iters: 400, epoch: 10 | loss: 0.2124428
	speed: 0.0187s/iter; left time: 109.8516s
	iters: 500, epoch: 10 | loss: 0.2000332
	speed: 0.0187s/iter; left time: 107.9504s
Epoch: 10 cost time: 10.923904180526733
Epoch: 10, Steps: 570 | Train Loss: 0.2360373 Vali Loss: 0.0511895 Test Loss: 0.1525097
Validation loss decreased (0.051191 --> 0.051189).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1884583
	speed: 0.0567s/iter; left time: 317.3529s
	iters: 200, epoch: 11 | loss: 0.3364536
	speed: 0.0185s/iter; left time: 101.9707s
	iters: 300, epoch: 11 | loss: 0.2422140
	speed: 0.0185s/iter; left time: 99.9149s
	iters: 400, epoch: 11 | loss: 0.1363387
	speed: 0.0185s/iter; left time: 98.1153s
	iters: 500, epoch: 11 | loss: 0.3151762
	speed: 0.0185s/iter; left time: 96.1527s
Epoch: 11 cost time: 10.821075916290283
Epoch: 11, Steps: 570 | Train Loss: 0.2365175 Vali Loss: 0.0511866 Test Loss: 0.1524168
Validation loss decreased (0.051189 --> 0.051187).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3024474
	speed: 0.0551s/iter; left time: 277.0101s
	iters: 200, epoch: 12 | loss: 0.3122122
	speed: 0.0185s/iter; left time: 91.0130s
	iters: 300, epoch: 12 | loss: 0.1375531
	speed: 0.0186s/iter; left time: 89.6433s
	iters: 400, epoch: 12 | loss: 0.2285809
	speed: 0.0186s/iter; left time: 87.8641s
	iters: 500, epoch: 12 | loss: 0.1865078
	speed: 0.0185s/iter; left time: 85.5521s
Epoch: 12 cost time: 10.839592933654785
Epoch: 12, Steps: 570 | Train Loss: 0.2352742 Vali Loss: 0.0509963 Test Loss: 0.1524491
Validation loss decreased (0.051187 --> 0.050996).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3926801
	speed: 0.0578s/iter; left time: 258.0437s
	iters: 200, epoch: 13 | loss: 0.2231462
	speed: 0.0185s/iter; left time: 80.6662s
	iters: 300, epoch: 13 | loss: 0.2874231
	speed: 0.0185s/iter; left time: 78.6811s
	iters: 400, epoch: 13 | loss: 0.1770340
	speed: 0.0184s/iter; left time: 76.6822s
	iters: 500, epoch: 13 | loss: 0.2780897
	speed: 0.0185s/iter; left time: 75.0582s
Epoch: 13 cost time: 10.79673957824707
Epoch: 13, Steps: 570 | Train Loss: 0.2350211 Vali Loss: 0.0510677 Test Loss: 0.1524323
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.3067077
	speed: 0.0552s/iter; left time: 214.9584s
	iters: 200, epoch: 14 | loss: 0.1708578
	speed: 0.0188s/iter; left time: 71.1096s
	iters: 300, epoch: 14 | loss: 0.1416878
	speed: 0.0188s/iter; left time: 69.4468s
	iters: 400, epoch: 14 | loss: 0.2449211
	speed: 0.0188s/iter; left time: 67.3489s
	iters: 500, epoch: 14 | loss: 0.2723967
	speed: 0.0188s/iter; left time: 65.6307s
Epoch: 14 cost time: 10.998902559280396
Epoch: 14, Steps: 570 | Train Loss: 0.2351534 Vali Loss: 0.0510622 Test Loss: 0.1524382
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1750597
	speed: 0.0564s/iter; left time: 187.1699s
	iters: 200, epoch: 15 | loss: 0.2392311
	speed: 0.0186s/iter; left time: 59.7730s
	iters: 300, epoch: 15 | loss: 0.1884887
	speed: 0.0186s/iter; left time: 57.9439s
	iters: 400, epoch: 15 | loss: 0.2420480
	speed: 0.0186s/iter; left time: 56.1345s
	iters: 500, epoch: 15 | loss: 0.1719001
	speed: 0.0186s/iter; left time: 54.3055s
Epoch: 15 cost time: 10.862620830535889
Epoch: 15, Steps: 570 | Train Loss: 0.2347518 Vali Loss: 0.0510754 Test Loss: 0.1524345
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15269137918949127, mae:0.24526135623455048
>>> MS_Raw LR=1e-3 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4440405
	speed: 0.0304s/iter; left time: 343.5352s
	iters: 200, epoch: 1 | loss: 0.2563414
	speed: 0.0184s/iter; left time: 206.0785s
	iters: 300, epoch: 1 | loss: 0.2045213
	speed: 0.0184s/iter; left time: 203.8831s
	iters: 400, epoch: 1 | loss: 0.1961407
	speed: 0.0183s/iter; left time: 201.7991s
	iters: 500, epoch: 1 | loss: 0.2555127
	speed: 0.0183s/iter; left time: 199.8263s
Epoch: 1 cost time: 11.722833156585693
Epoch: 1, Steps: 570 | Train Loss: 0.2561358 Vali Loss: 0.0489382 Test Loss: 0.1559181
Validation loss decreased (inf --> 0.048938).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1675851
	speed: 0.0583s/iter; left time: 625.8002s
	iters: 200, epoch: 2 | loss: 0.3353744
	speed: 0.0183s/iter; left time: 194.3096s
	iters: 300, epoch: 2 | loss: 0.5020998
	speed: 0.0182s/iter; left time: 192.0444s
	iters: 400, epoch: 2 | loss: 0.2674504
	speed: 0.0183s/iter; left time: 190.3900s
	iters: 500, epoch: 2 | loss: 0.2010202
	speed: 0.0183s/iter; left time: 188.6574s
Epoch: 2 cost time: 10.70786714553833
Epoch: 2, Steps: 570 | Train Loss: 0.2872678 Vali Loss: 0.0682885 Test Loss: 0.1902094
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2125782
	speed: 0.0554s/iter; left time: 563.2242s
	iters: 200, epoch: 3 | loss: 0.2854894
	speed: 0.0183s/iter; left time: 184.4496s
	iters: 300, epoch: 3 | loss: 0.2461788
	speed: 0.0183s/iter; left time: 182.4225s
	iters: 400, epoch: 3 | loss: 0.2213762
	speed: 0.0183s/iter; left time: 180.4530s
	iters: 500, epoch: 3 | loss: 0.1950367
	speed: 0.0183s/iter; left time: 178.8777s
Epoch: 3 cost time: 10.69500470161438
Epoch: 3, Steps: 570 | Train Loss: 0.2838300 Vali Loss: 0.0612267 Test Loss: 0.1770139
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2848371
	speed: 0.0549s/iter; left time: 526.5892s
	iters: 200, epoch: 4 | loss: 0.1449135
	speed: 0.0183s/iter; left time: 174.0890s
	iters: 300, epoch: 4 | loss: 0.4600289
	speed: 0.0184s/iter; left time: 172.4480s
	iters: 400, epoch: 4 | loss: 0.1936486
	speed: 0.0183s/iter; left time: 170.4534s
	iters: 500, epoch: 4 | loss: 0.1924767
	speed: 0.0184s/iter; left time: 168.8132s
Epoch: 4 cost time: 10.73425841331482
Epoch: 4, Steps: 570 | Train Loss: 0.2692256 Vali Loss: 0.0593378 Test Loss: 0.1638209
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15614116191864014, mae:0.2531272768974304
>>> MS_Raw LR=1e-3 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3439945
	speed: 0.0324s/iter; left time: 366.0954s
	iters: 200, epoch: 1 | loss: 0.2224072
	speed: 0.0205s/iter; left time: 229.6814s
	iters: 300, epoch: 1 | loss: 0.2982511
	speed: 0.0205s/iter; left time: 227.6179s
	iters: 400, epoch: 1 | loss: 0.3607741
	speed: 0.0205s/iter; left time: 226.0125s
	iters: 500, epoch: 1 | loss: 0.4477174
	speed: 0.0205s/iter; left time: 223.7115s
Epoch: 1 cost time: 12.960856437683105
Epoch: 1, Steps: 570 | Train Loss: 0.2980871 Vali Loss: 0.0661756 Test Loss: 0.1882649
Validation loss decreased (inf --> 0.066176).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3172938
	speed: 0.0591s/iter; left time: 634.4809s
	iters: 200, epoch: 2 | loss: 0.4120645
	speed: 0.0182s/iter; left time: 193.4279s
	iters: 300, epoch: 2 | loss: 0.5728456
	speed: 0.0181s/iter; left time: 190.9965s
	iters: 400, epoch: 2 | loss: 0.2337411
	speed: 0.0181s/iter; left time: 189.1928s
	iters: 500, epoch: 2 | loss: 0.2605494
	speed: 0.0182s/iter; left time: 187.6593s
Epoch: 2 cost time: 10.661794185638428
Epoch: 2, Steps: 570 | Train Loss: 0.3149009 Vali Loss: 0.0684825 Test Loss: 0.1888304
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1760447
	speed: 0.0586s/iter; left time: 595.7395s
	iters: 200, epoch: 3 | loss: 0.3244613
	speed: 0.0205s/iter; left time: 206.6517s
	iters: 300, epoch: 3 | loss: 0.3146085
	speed: 0.0205s/iter; left time: 204.2884s
	iters: 400, epoch: 3 | loss: 0.3546068
	speed: 0.0205s/iter; left time: 202.4553s
	iters: 500, epoch: 3 | loss: 0.3117248
	speed: 0.0205s/iter; left time: 199.6727s
Epoch: 3 cost time: 11.705176830291748
Epoch: 3, Steps: 570 | Train Loss: 0.2925788 Vali Loss: 0.0609396 Test Loss: 0.1662711
Validation loss decreased (0.066176 --> 0.060940).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2310022
	speed: 0.0557s/iter; left time: 533.9776s
	iters: 200, epoch: 4 | loss: 0.2679229
	speed: 0.0182s/iter; left time: 172.3023s
	iters: 300, epoch: 4 | loss: 0.2043655
	speed: 0.0181s/iter; left time: 170.3892s
	iters: 400, epoch: 4 | loss: 0.2407873
	speed: 0.0181s/iter; left time: 168.5971s
	iters: 500, epoch: 4 | loss: 0.1919197
	speed: 0.0181s/iter; left time: 166.5379s
Epoch: 4 cost time: 10.62608528137207
Epoch: 4, Steps: 570 | Train Loss: 0.2716240 Vali Loss: 0.0596362 Test Loss: 0.1630546
Validation loss decreased (0.060940 --> 0.059636).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2280511
	speed: 0.0571s/iter; left time: 515.1660s
	iters: 200, epoch: 5 | loss: 0.2428658
	speed: 0.0184s/iter; left time: 164.3973s
	iters: 300, epoch: 5 | loss: 0.2224826
	speed: 0.0184s/iter; left time: 162.2501s
	iters: 400, epoch: 5 | loss: 0.2465171
	speed: 0.0184s/iter; left time: 160.0716s
	iters: 500, epoch: 5 | loss: 0.1690178
	speed: 0.0183s/iter; left time: 158.0569s
Epoch: 5 cost time: 10.94510006904602
Epoch: 5, Steps: 570 | Train Loss: 0.2609641 Vali Loss: 0.0581607 Test Loss: 0.1598530
Validation loss decreased (0.059636 --> 0.058161).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4152997
	speed: 0.0560s/iter; left time: 473.0759s
	iters: 200, epoch: 6 | loss: 0.1902053
	speed: 0.0185s/iter; left time: 154.1066s
	iters: 300, epoch: 6 | loss: 0.4684936
	speed: 0.0185s/iter; left time: 152.3266s
	iters: 400, epoch: 6 | loss: 0.1891903
	speed: 0.0185s/iter; left time: 150.7497s
	iters: 500, epoch: 6 | loss: 0.2699345
	speed: 0.0184s/iter; left time: 148.5389s
Epoch: 6 cost time: 10.807851552963257
Epoch: 6, Steps: 570 | Train Loss: 0.2563190 Vali Loss: 0.0575713 Test Loss: 0.1564931
Validation loss decreased (0.058161 --> 0.057571).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1933302
	speed: 0.0557s/iter; left time: 438.6222s
	iters: 200, epoch: 7 | loss: 0.2402638
	speed: 0.0183s/iter; left time: 142.0154s
	iters: 300, epoch: 7 | loss: 0.2761043
	speed: 0.0183s/iter; left time: 140.2466s
	iters: 400, epoch: 7 | loss: 0.2309266
	speed: 0.0183s/iter; left time: 138.4243s
	iters: 500, epoch: 7 | loss: 0.1958035
	speed: 0.0183s/iter; left time: 136.7888s
Epoch: 7 cost time: 10.68164324760437
Epoch: 7, Steps: 570 | Train Loss: 0.2547132 Vali Loss: 0.0579028 Test Loss: 0.1565990
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1519305
	speed: 0.0565s/iter; left time: 413.3852s
	iters: 200, epoch: 8 | loss: 0.1581205
	speed: 0.0184s/iter; left time: 132.6122s
	iters: 300, epoch: 8 | loss: 0.2114730
	speed: 0.0183s/iter; left time: 130.0152s
	iters: 400, epoch: 8 | loss: 0.2588448
	speed: 0.0183s/iter; left time: 128.5967s
	iters: 500, epoch: 8 | loss: 0.1707231
	speed: 0.0183s/iter; left time: 126.2894s
Epoch: 8 cost time: 10.920087337493896
Epoch: 8, Steps: 570 | Train Loss: 0.2521554 Vali Loss: 0.0575652 Test Loss: 0.1560879
Validation loss decreased (0.057571 --> 0.057565).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2606703
	speed: 0.0594s/iter; left time: 400.1992s
	iters: 200, epoch: 9 | loss: 0.2921563
	speed: 0.0205s/iter; left time: 136.2311s
	iters: 300, epoch: 9 | loss: 0.2700184
	speed: 0.0205s/iter; left time: 134.1911s
	iters: 400, epoch: 9 | loss: 0.4152758
	speed: 0.0206s/iter; left time: 132.8539s
	iters: 500, epoch: 9 | loss: 0.2096159
	speed: 0.0206s/iter; left time: 130.9372s
Epoch: 9 cost time: 12.122866153717041
Epoch: 9, Steps: 570 | Train Loss: 0.2526055 Vali Loss: 0.0574870 Test Loss: 0.1556351
Validation loss decreased (0.057565 --> 0.057487).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2231581
	speed: 0.0575s/iter; left time: 354.6627s
	iters: 200, epoch: 10 | loss: 0.2138534
	speed: 0.0183s/iter; left time: 110.8642s
	iters: 300, epoch: 10 | loss: 0.3480861
	speed: 0.0183s/iter; left time: 109.2215s
	iters: 400, epoch: 10 | loss: 0.2435866
	speed: 0.0183s/iter; left time: 107.3718s
	iters: 500, epoch: 10 | loss: 0.2342066
	speed: 0.0182s/iter; left time: 105.2840s
Epoch: 10 cost time: 10.712459802627563
Epoch: 10, Steps: 570 | Train Loss: 0.2514910 Vali Loss: 0.0572551 Test Loss: 0.1555971
Validation loss decreased (0.057487 --> 0.057255).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2281349
	speed: 0.0554s/iter; left time: 310.0959s
	iters: 200, epoch: 11 | loss: 0.2650180
	speed: 0.0183s/iter; left time: 100.5884s
	iters: 300, epoch: 11 | loss: 0.2456894
	speed: 0.0183s/iter; left time: 98.6612s
	iters: 400, epoch: 11 | loss: 0.2605615
	speed: 0.0183s/iter; left time: 96.9849s
	iters: 500, epoch: 11 | loss: 0.1960399
	speed: 0.0183s/iter; left time: 95.1671s
Epoch: 11 cost time: 10.713662147521973
Epoch: 11, Steps: 570 | Train Loss: 0.2525947 Vali Loss: 0.0572932 Test Loss: 0.1556307
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1464265
	speed: 0.0596s/iter; left time: 299.6950s
	iters: 200, epoch: 12 | loss: 0.3264920
	speed: 0.0188s/iter; left time: 92.7061s
	iters: 300, epoch: 12 | loss: 0.2778126
	speed: 0.0184s/iter; left time: 88.6874s
	iters: 400, epoch: 12 | loss: 0.1597119
	speed: 0.0184s/iter; left time: 86.8750s
	iters: 500, epoch: 12 | loss: 0.3305517
	speed: 0.0183s/iter; left time: 84.9784s
Epoch: 12 cost time: 11.121992349624634
Epoch: 12, Steps: 570 | Train Loss: 0.2501300 Vali Loss: 0.0573288 Test Loss: 0.1556164
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2810948
	speed: 0.0578s/iter; left time: 257.8071s
	iters: 200, epoch: 13 | loss: 0.1267352
	speed: 0.0183s/iter; left time: 79.8057s
	iters: 300, epoch: 13 | loss: 0.1804745
	speed: 0.0183s/iter; left time: 78.0458s
	iters: 400, epoch: 13 | loss: 0.1703719
	speed: 0.0183s/iter; left time: 76.1592s
	iters: 500, epoch: 13 | loss: 0.1641101
	speed: 0.0183s/iter; left time: 74.1914s
Epoch: 13 cost time: 10.689493894577026
Epoch: 13, Steps: 570 | Train Loss: 0.2510339 Vali Loss: 0.0575678 Test Loss: 0.1556001
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15581247210502625, mae:0.2524816393852234
>>> MS_Raw LR=1e-3 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2820024
	speed: 0.0346s/iter; left time: 390.6020s
	iters: 200, epoch: 1 | loss: 0.3506850
	speed: 0.0222s/iter; left time: 249.1940s
	iters: 300, epoch: 1 | loss: 0.3158914
	speed: 0.0223s/iter; left time: 247.3557s
	iters: 400, epoch: 1 | loss: 0.4694290
	speed: 0.0223s/iter; left time: 244.9808s
	iters: 500, epoch: 1 | loss: 0.4384179
	speed: 0.0222s/iter; left time: 241.5435s
Epoch: 1 cost time: 13.958975791931152
Epoch: 1, Steps: 570 | Train Loss: 0.3687771 Vali Loss: 0.0628052 Test Loss: 0.1830931
Validation loss decreased (inf --> 0.062805).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3938585
	speed: 0.0655s/iter; left time: 703.2580s
	iters: 200, epoch: 2 | loss: 0.2715237
	speed: 0.0223s/iter; left time: 236.9446s
	iters: 300, epoch: 2 | loss: 0.2369220
	speed: 0.0223s/iter; left time: 234.7791s
	iters: 400, epoch: 2 | loss: 0.2923615
	speed: 0.0223s/iter; left time: 232.5482s
	iters: 500, epoch: 2 | loss: 0.2706907
	speed: 0.0223s/iter; left time: 229.8899s
Epoch: 2 cost time: 13.034988641738892
Epoch: 2, Steps: 570 | Train Loss: 0.3097597 Vali Loss: 0.0641888 Test Loss: 0.1786072
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.6045175
	speed: 0.0619s/iter; left time: 629.1350s
	iters: 200, epoch: 3 | loss: 0.1884619
	speed: 0.0220s/iter; left time: 221.2471s
	iters: 300, epoch: 3 | loss: 0.3644444
	speed: 0.0220s/iter; left time: 219.1738s
	iters: 400, epoch: 3 | loss: 0.2941984
	speed: 0.0220s/iter; left time: 216.8365s
	iters: 500, epoch: 3 | loss: 0.2039631
	speed: 0.0220s/iter; left time: 214.6347s
Epoch: 3 cost time: 12.840678930282593
Epoch: 3, Steps: 570 | Train Loss: 0.2877696 Vali Loss: 0.0594068 Test Loss: 0.1651690
Validation loss decreased (0.062805 --> 0.059407).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2447802
	speed: 0.0634s/iter; left time: 608.3165s
	iters: 200, epoch: 4 | loss: 0.1950940
	speed: 0.0221s/iter; left time: 209.7103s
	iters: 300, epoch: 4 | loss: 0.2962869
	speed: 0.0221s/iter; left time: 207.5514s
	iters: 400, epoch: 4 | loss: 0.2045498
	speed: 0.0221s/iter; left time: 205.3448s
	iters: 500, epoch: 4 | loss: 0.3095154
	speed: 0.0221s/iter; left time: 203.0566s
Epoch: 4 cost time: 12.91637659072876
Epoch: 4, Steps: 570 | Train Loss: 0.2705669 Vali Loss: 0.0570208 Test Loss: 0.1616229
Validation loss decreased (0.059407 --> 0.057021).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2788117
	speed: 0.0635s/iter; left time: 572.5462s
	iters: 200, epoch: 5 | loss: 0.2860644
	speed: 0.0221s/iter; left time: 197.5134s
	iters: 300, epoch: 5 | loss: 0.2103918
	speed: 0.0221s/iter; left time: 195.0741s
	iters: 400, epoch: 5 | loss: 0.2173960
	speed: 0.0221s/iter; left time: 192.9960s
	iters: 500, epoch: 5 | loss: 0.2649921
	speed: 0.0221s/iter; left time: 190.3877s
Epoch: 5 cost time: 12.941391944885254
Epoch: 5, Steps: 570 | Train Loss: 0.2607152 Vali Loss: 0.0576824 Test Loss: 0.1600697
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1931576
	speed: 0.0620s/iter; left time: 523.8627s
	iters: 200, epoch: 6 | loss: 0.3377065
	speed: 0.0221s/iter; left time: 184.2330s
	iters: 300, epoch: 6 | loss: 0.1976932
	speed: 0.0221s/iter; left time: 182.0315s
	iters: 400, epoch: 6 | loss: 0.1933704
	speed: 0.0221s/iter; left time: 179.8414s
	iters: 500, epoch: 6 | loss: 0.3341262
	speed: 0.0221s/iter; left time: 177.6101s
Epoch: 6 cost time: 12.840129137039185
Epoch: 6, Steps: 570 | Train Loss: 0.2561844 Vali Loss: 0.0569983 Test Loss: 0.1571478
Validation loss decreased (0.057021 --> 0.056998).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3503615
	speed: 0.0629s/iter; left time: 495.4725s
	iters: 200, epoch: 7 | loss: 0.2650831
	speed: 0.0221s/iter; left time: 172.1385s
	iters: 300, epoch: 7 | loss: 0.1854428
	speed: 0.0221s/iter; left time: 170.0320s
	iters: 400, epoch: 7 | loss: 0.2032392
	speed: 0.0221s/iter; left time: 167.8418s
	iters: 500, epoch: 7 | loss: 0.2495519
	speed: 0.0221s/iter; left time: 165.4686s
Epoch: 7 cost time: 12.938048124313354
Epoch: 7, Steps: 570 | Train Loss: 0.2529105 Vali Loss: 0.0565248 Test Loss: 0.1552147
Validation loss decreased (0.056998 --> 0.056525).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1709098
	speed: 0.0648s/iter; left time: 473.6906s
	iters: 200, epoch: 8 | loss: 0.5014006
	speed: 0.0221s/iter; left time: 159.6995s
	iters: 300, epoch: 8 | loss: 0.1560250
	speed: 0.0221s/iter; left time: 157.4443s
	iters: 400, epoch: 8 | loss: 0.2622548
	speed: 0.0222s/iter; left time: 155.4440s
	iters: 500, epoch: 8 | loss: 0.2482225
	speed: 0.0240s/iter; left time: 165.8761s
Epoch: 8 cost time: 13.282984733581543
Epoch: 8, Steps: 570 | Train Loss: 0.2526525 Vali Loss: 0.0563946 Test Loss: 0.1553344
Validation loss decreased (0.056525 --> 0.056395).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2847161
	speed: 0.0658s/iter; left time: 443.7796s
	iters: 200, epoch: 9 | loss: 0.2171539
	speed: 0.0220s/iter; left time: 146.0866s
	iters: 300, epoch: 9 | loss: 0.3929270
	speed: 0.0221s/iter; left time: 144.6795s
	iters: 400, epoch: 9 | loss: 0.2341013
	speed: 0.0221s/iter; left time: 142.5273s
	iters: 500, epoch: 9 | loss: 0.1879824
	speed: 0.0221s/iter; left time: 140.3322s
Epoch: 9 cost time: 12.910492181777954
Epoch: 9, Steps: 570 | Train Loss: 0.2493533 Vali Loss: 0.0561724 Test Loss: 0.1555994
Validation loss decreased (0.056395 --> 0.056172).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2559296
	speed: 0.0634s/iter; left time: 391.0535s
	iters: 200, epoch: 10 | loss: 0.2823784
	speed: 0.0221s/iter; left time: 134.3564s
	iters: 300, epoch: 10 | loss: 0.2442188
	speed: 0.0221s/iter; left time: 132.2133s
	iters: 400, epoch: 10 | loss: 0.3683121
	speed: 0.0221s/iter; left time: 129.9267s
	iters: 500, epoch: 10 | loss: 0.2910262
	speed: 0.0221s/iter; left time: 127.6935s
Epoch: 10 cost time: 12.935142040252686
Epoch: 10, Steps: 570 | Train Loss: 0.2496015 Vali Loss: 0.0566815 Test Loss: 0.1553975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1941482
	speed: 0.0629s/iter; left time: 352.5625s
	iters: 200, epoch: 11 | loss: 0.1915396
	speed: 0.0220s/iter; left time: 121.1406s
	iters: 300, epoch: 11 | loss: 0.1241986
	speed: 0.0220s/iter; left time: 118.9656s
	iters: 400, epoch: 11 | loss: 0.1996565
	speed: 0.0220s/iter; left time: 116.7519s
	iters: 500, epoch: 11 | loss: 0.1841637
	speed: 0.0220s/iter; left time: 114.6275s
Epoch: 11 cost time: 12.886799335479736
Epoch: 11, Steps: 570 | Train Loss: 0.2511690 Vali Loss: 0.0564752 Test Loss: 0.1553328
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2536335
	speed: 0.0624s/iter; left time: 313.9872s
	iters: 200, epoch: 12 | loss: 0.2307326
	speed: 0.0221s/iter; left time: 108.7554s
	iters: 300, epoch: 12 | loss: 0.3589673
	speed: 0.0220s/iter; left time: 106.5103s
	iters: 400, epoch: 12 | loss: 0.1117583
	speed: 0.0220s/iter; left time: 104.3013s
	iters: 500, epoch: 12 | loss: 0.2942688
	speed: 0.0220s/iter; left time: 102.0848s
Epoch: 12 cost time: 12.858314037322998
Epoch: 12, Steps: 570 | Train Loss: 0.2487588 Vali Loss: 0.0564325 Test Loss: 0.1553530
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15584561228752136, mae:0.2539593577384949
>>> MS_Raw LR=1e-3 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3483191
	speed: 0.0353s/iter; left time: 399.4844s
	iters: 200, epoch: 1 | loss: 0.1764646
	speed: 0.0214s/iter; left time: 239.1469s
	iters: 300, epoch: 1 | loss: 0.2731398
	speed: 0.0214s/iter; left time: 237.3210s
	iters: 400, epoch: 1 | loss: 0.3596932
	speed: 0.0214s/iter; left time: 235.1200s
	iters: 500, epoch: 1 | loss: 0.2425520
	speed: 0.0214s/iter; left time: 233.0818s
Epoch: 1 cost time: 13.632115602493286
Epoch: 1, Steps: 570 | Train Loss: 0.3932763 Vali Loss: 0.0687599 Test Loss: 0.1930391
Validation loss decreased (inf --> 0.068760).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3420772
	speed: 0.0622s/iter; left time: 667.3931s
	iters: 200, epoch: 2 | loss: 0.2079389
	speed: 0.0215s/iter; left time: 228.5542s
	iters: 300, epoch: 2 | loss: 0.4470553
	speed: 0.0214s/iter; left time: 225.7975s
	iters: 400, epoch: 2 | loss: 0.2903394
	speed: 0.0215s/iter; left time: 223.7457s
	iters: 500, epoch: 2 | loss: 0.2193912
	speed: 0.0214s/iter; left time: 221.2971s
Epoch: 2 cost time: 12.540116548538208
Epoch: 2, Steps: 570 | Train Loss: 0.3195452 Vali Loss: 0.0677651 Test Loss: 0.1936957
Validation loss decreased (0.068760 --> 0.067765).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2322346
	speed: 0.0619s/iter; left time: 628.9639s
	iters: 200, epoch: 3 | loss: 0.2921307
	speed: 0.0213s/iter; left time: 214.4216s
	iters: 300, epoch: 3 | loss: 0.1781242
	speed: 0.0213s/iter; left time: 212.5699s
	iters: 400, epoch: 3 | loss: 0.1827128
	speed: 0.0214s/iter; left time: 210.6644s
	iters: 500, epoch: 3 | loss: 0.2208113
	speed: 0.0213s/iter; left time: 208.1058s
Epoch: 3 cost time: 12.45408320426941
Epoch: 3, Steps: 570 | Train Loss: 0.2932154 Vali Loss: 0.0649118 Test Loss: 0.1745840
Validation loss decreased (0.067765 --> 0.064912).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2069071
	speed: 0.0614s/iter; left time: 588.4885s
	iters: 200, epoch: 4 | loss: 0.2678215
	speed: 0.0213s/iter; left time: 202.3082s
	iters: 300, epoch: 4 | loss: 0.2591911
	speed: 0.0213s/iter; left time: 200.3613s
	iters: 400, epoch: 4 | loss: 0.3349337
	speed: 0.0213s/iter; left time: 198.2425s
	iters: 500, epoch: 4 | loss: 0.1894222
	speed: 0.0213s/iter; left time: 196.1405s
Epoch: 4 cost time: 12.47758173942566
Epoch: 4, Steps: 570 | Train Loss: 0.2769989 Vali Loss: 0.0618164 Test Loss: 0.1722599
Validation loss decreased (0.064912 --> 0.061816).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4016593
	speed: 0.0634s/iter; left time: 572.1047s
	iters: 200, epoch: 5 | loss: 0.1939733
	speed: 0.0212s/iter; left time: 189.2088s
	iters: 300, epoch: 5 | loss: 0.3224022
	speed: 0.0212s/iter; left time: 186.9955s
	iters: 400, epoch: 5 | loss: 0.2390254
	speed: 0.0212s/iter; left time: 184.9479s
	iters: 500, epoch: 5 | loss: 0.2287242
	speed: 0.0212s/iter; left time: 182.8069s
Epoch: 5 cost time: 12.410192966461182
Epoch: 5, Steps: 570 | Train Loss: 0.2684514 Vali Loss: 0.0615603 Test Loss: 0.1668281
Validation loss decreased (0.061816 --> 0.061560).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2436883
	speed: 0.0618s/iter; left time: 522.1876s
	iters: 200, epoch: 6 | loss: 0.3324875
	speed: 0.0213s/iter; left time: 178.0909s
	iters: 300, epoch: 6 | loss: 0.2827042
	speed: 0.0213s/iter; left time: 175.8906s
	iters: 400, epoch: 6 | loss: 0.1656434
	speed: 0.0213s/iter; left time: 173.7649s
	iters: 500, epoch: 6 | loss: 0.1709646
	speed: 0.0214s/iter; left time: 171.9288s
Epoch: 6 cost time: 12.46495270729065
Epoch: 6, Steps: 570 | Train Loss: 0.2631734 Vali Loss: 0.0609450 Test Loss: 0.1660672
Validation loss decreased (0.061560 --> 0.060945).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2456770
	speed: 0.0641s/iter; left time: 505.2211s
	iters: 200, epoch: 7 | loss: 0.3631036
	speed: 0.0213s/iter; left time: 165.8590s
	iters: 300, epoch: 7 | loss: 0.3073087
	speed: 0.0213s/iter; left time: 163.7327s
	iters: 400, epoch: 7 | loss: 0.1740722
	speed: 0.0213s/iter; left time: 161.4005s
	iters: 500, epoch: 7 | loss: 0.2432873
	speed: 0.0213s/iter; left time: 159.4964s
Epoch: 7 cost time: 12.440860748291016
Epoch: 7, Steps: 570 | Train Loss: 0.2611012 Vali Loss: 0.0604223 Test Loss: 0.1646789
Validation loss decreased (0.060945 --> 0.060422).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2533799
	speed: 0.0628s/iter; left time: 459.1734s
	iters: 200, epoch: 8 | loss: 0.2918572
	speed: 0.0215s/iter; left time: 154.7585s
	iters: 300, epoch: 8 | loss: 0.2444859
	speed: 0.0215s/iter; left time: 152.6401s
	iters: 400, epoch: 8 | loss: 0.2939004
	speed: 0.0214s/iter; left time: 150.3483s
	iters: 500, epoch: 8 | loss: 0.3102149
	speed: 0.0215s/iter; left time: 148.3793s
Epoch: 8 cost time: 12.79290509223938
Epoch: 8, Steps: 570 | Train Loss: 0.2591132 Vali Loss: 0.0587517 Test Loss: 0.1642147
Validation loss decreased (0.060422 --> 0.058752).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2027416
	speed: 0.0644s/iter; left time: 434.1265s
	iters: 200, epoch: 9 | loss: 0.3553377
	speed: 0.0212s/iter; left time: 140.9894s
	iters: 300, epoch: 9 | loss: 0.2911352
	speed: 0.0212s/iter; left time: 138.9336s
	iters: 400, epoch: 9 | loss: 0.2423984
	speed: 0.0212s/iter; left time: 136.6732s
	iters: 500, epoch: 9 | loss: 0.1473337
	speed: 0.0212s/iter; left time: 134.7334s
Epoch: 9 cost time: 12.397204160690308
Epoch: 9, Steps: 570 | Train Loss: 0.2591514 Vali Loss: 0.0583740 Test Loss: 0.1639684
Validation loss decreased (0.058752 --> 0.058374).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1709135
	speed: 0.0607s/iter; left time: 374.8342s
	iters: 200, epoch: 10 | loss: 0.2414147
	speed: 0.0213s/iter; left time: 129.4764s
	iters: 300, epoch: 10 | loss: 0.1864398
	speed: 0.0213s/iter; left time: 127.3783s
	iters: 400, epoch: 10 | loss: 0.2411635
	speed: 0.0213s/iter; left time: 125.3422s
	iters: 500, epoch: 10 | loss: 0.3385921
	speed: 0.0213s/iter; left time: 123.0638s
Epoch: 10 cost time: 12.49129605293274
Epoch: 10, Steps: 570 | Train Loss: 0.2577685 Vali Loss: 0.0582898 Test Loss: 0.1638390
Validation loss decreased (0.058374 --> 0.058290).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.4224576
	speed: 0.0616s/iter; left time: 345.0947s
	iters: 200, epoch: 11 | loss: 0.2363219
	speed: 0.0213s/iter; left time: 117.3366s
	iters: 300, epoch: 11 | loss: 0.2084909
	speed: 0.0224s/iter; left time: 121.0329s
	iters: 400, epoch: 11 | loss: 0.1982952
	speed: 0.0233s/iter; left time: 123.4618s
	iters: 500, epoch: 11 | loss: 0.2825384
	speed: 0.0233s/iter; left time: 121.0525s
Epoch: 11 cost time: 13.11565113067627
Epoch: 11, Steps: 570 | Train Loss: 0.2576231 Vali Loss: 0.0584254 Test Loss: 0.1637842
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3107935
	speed: 0.0650s/iter; left time: 327.0725s
	iters: 200, epoch: 12 | loss: 0.2872938
	speed: 0.0232s/iter; left time: 114.3292s
	iters: 300, epoch: 12 | loss: 0.2831005
	speed: 0.0216s/iter; left time: 104.1733s
	iters: 400, epoch: 12 | loss: 0.4618843
	speed: 0.0212s/iter; left time: 100.4118s
	iters: 500, epoch: 12 | loss: 0.1982855
	speed: 0.0212s/iter; left time: 98.3433s
Epoch: 12 cost time: 12.803019762039185
Epoch: 12, Steps: 570 | Train Loss: 0.2571457 Vali Loss: 0.0585422 Test Loss: 0.1637864
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1983078
	speed: 0.0628s/iter; left time: 280.2915s
	iters: 200, epoch: 13 | loss: 0.3412160
	speed: 0.0212s/iter; left time: 92.6287s
	iters: 300, epoch: 13 | loss: 0.3556422
	speed: 0.0212s/iter; left time: 90.4981s
	iters: 400, epoch: 13 | loss: 0.2023166
	speed: 0.0212s/iter; left time: 88.2321s
	iters: 500, epoch: 13 | loss: 0.2963874
	speed: 0.0212s/iter; left time: 86.2062s
Epoch: 13 cost time: 12.356579303741455
Epoch: 13, Steps: 570 | Train Loss: 0.2576762 Vali Loss: 0.0589034 Test Loss: 0.1637957
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16409872472286224, mae:0.2606174945831299
>>> MS_Raw LR=1e-3 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3804397
	speed: 0.0344s/iter; left time: 388.9677s
	iters: 200, epoch: 1 | loss: 0.3089974
	speed: 0.0222s/iter; left time: 248.7203s
	iters: 300, epoch: 1 | loss: 0.3638180
	speed: 0.0222s/iter; left time: 246.9605s
	iters: 400, epoch: 1 | loss: 0.4387281
	speed: 0.0222s/iter; left time: 244.3404s
	iters: 500, epoch: 1 | loss: 0.3337742
	speed: 0.0221s/iter; left time: 241.3379s
Epoch: 1 cost time: 13.930208683013916
Epoch: 1, Steps: 570 | Train Loss: 0.3645407 Vali Loss: 0.0670480 Test Loss: 0.1957417
Validation loss decreased (inf --> 0.067048).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2270536
	speed: 0.0616s/iter; left time: 660.8829s
	iters: 200, epoch: 2 | loss: 0.5691278
	speed: 0.0201s/iter; left time: 214.0516s
	iters: 300, epoch: 2 | loss: 0.2426668
	speed: 0.0202s/iter; left time: 212.3905s
	iters: 400, epoch: 2 | loss: 0.2305209
	speed: 0.0202s/iter; left time: 210.4342s
	iters: 500, epoch: 2 | loss: 0.1968035
	speed: 0.0202s/iter; left time: 208.5280s
Epoch: 2 cost time: 11.80476999282837
Epoch: 2, Steps: 570 | Train Loss: 0.3082443 Vali Loss: 0.0630910 Test Loss: 0.1835305
Validation loss decreased (0.067048 --> 0.063091).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1988384
	speed: 0.0598s/iter; left time: 608.0160s
	iters: 200, epoch: 3 | loss: 0.2185974
	speed: 0.0201s/iter; left time: 201.9732s
	iters: 300, epoch: 3 | loss: 0.2903170
	speed: 0.0201s/iter; left time: 199.8482s
	iters: 400, epoch: 3 | loss: 0.3049778
	speed: 0.0200s/iter; left time: 197.5667s
	iters: 500, epoch: 3 | loss: 0.2555400
	speed: 0.0201s/iter; left time: 195.7385s
Epoch: 3 cost time: 11.756833791732788
Epoch: 3, Steps: 570 | Train Loss: 0.2866641 Vali Loss: 0.0612436 Test Loss: 0.1738186
Validation loss decreased (0.063091 --> 0.061244).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1943121
	speed: 0.0606s/iter; left time: 581.1512s
	iters: 200, epoch: 4 | loss: 0.4831101
	speed: 0.0201s/iter; left time: 191.2119s
	iters: 300, epoch: 4 | loss: 0.1913214
	speed: 0.0201s/iter; left time: 189.1481s
	iters: 400, epoch: 4 | loss: 0.2798837
	speed: 0.0201s/iter; left time: 187.1494s
	iters: 500, epoch: 4 | loss: 0.2258324
	speed: 0.0201s/iter; left time: 184.9293s
Epoch: 4 cost time: 11.812935829162598
Epoch: 4, Steps: 570 | Train Loss: 0.2727965 Vali Loss: 0.0597988 Test Loss: 0.1625510
Validation loss decreased (0.061244 --> 0.059799).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2511033
	speed: 0.0597s/iter; left time: 538.2847s
	iters: 200, epoch: 5 | loss: 0.6101279
	speed: 0.0201s/iter; left time: 179.3420s
	iters: 300, epoch: 5 | loss: 0.2532804
	speed: 0.0201s/iter; left time: 177.2798s
	iters: 400, epoch: 5 | loss: 0.2133041
	speed: 0.0201s/iter; left time: 175.2612s
	iters: 500, epoch: 5 | loss: 0.2544225
	speed: 0.0201s/iter; left time: 173.2567s
Epoch: 5 cost time: 11.74287486076355
Epoch: 5, Steps: 570 | Train Loss: 0.2646309 Vali Loss: 0.0560531 Test Loss: 0.1614465
Validation loss decreased (0.059799 --> 0.056053).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2450040
	speed: 0.0593s/iter; left time: 501.4743s
	iters: 200, epoch: 6 | loss: 0.3549562
	speed: 0.0200s/iter; left time: 167.3741s
	iters: 300, epoch: 6 | loss: 0.2124002
	speed: 0.0201s/iter; left time: 165.4724s
	iters: 400, epoch: 6 | loss: 0.1401052
	speed: 0.0201s/iter; left time: 163.5513s
	iters: 500, epoch: 6 | loss: 0.4268948
	speed: 0.0200s/iter; left time: 161.3735s
Epoch: 6 cost time: 11.749406337738037
Epoch: 6, Steps: 570 | Train Loss: 0.2608943 Vali Loss: 0.0560516 Test Loss: 0.1611834
Validation loss decreased (0.056053 --> 0.056052).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2776586
	speed: 0.0594s/iter; left time: 468.5092s
	iters: 200, epoch: 7 | loss: 0.2870423
	speed: 0.0201s/iter; left time: 156.0841s
	iters: 300, epoch: 7 | loss: 0.3501499
	speed: 0.0201s/iter; left time: 154.0561s
	iters: 400, epoch: 7 | loss: 0.4562049
	speed: 0.0201s/iter; left time: 152.1097s
	iters: 500, epoch: 7 | loss: 0.2012505
	speed: 0.0201s/iter; left time: 150.0150s
Epoch: 7 cost time: 11.726979732513428
Epoch: 7, Steps: 570 | Train Loss: 0.2569121 Vali Loss: 0.0560550 Test Loss: 0.1617218
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3294926
	speed: 0.0581s/iter; left time: 424.8905s
	iters: 200, epoch: 8 | loss: 0.4140672
	speed: 0.0201s/iter; left time: 144.9955s
	iters: 300, epoch: 8 | loss: 0.3153934
	speed: 0.0201s/iter; left time: 142.6775s
	iters: 400, epoch: 8 | loss: 0.1939416
	speed: 0.0201s/iter; left time: 140.8328s
	iters: 500, epoch: 8 | loss: 0.2573278
	speed: 0.0201s/iter; left time: 138.7443s
Epoch: 8 cost time: 11.742860794067383
Epoch: 8, Steps: 570 | Train Loss: 0.2557399 Vali Loss: 0.0562486 Test Loss: 0.1602705
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2525150
	speed: 0.0584s/iter; left time: 393.5513s
	iters: 200, epoch: 9 | loss: 0.2477296
	speed: 0.0201s/iter; left time: 133.3244s
	iters: 300, epoch: 9 | loss: 0.3376626
	speed: 0.0201s/iter; left time: 131.4100s
	iters: 400, epoch: 9 | loss: 0.1935522
	speed: 0.0200s/iter; left time: 129.0178s
	iters: 500, epoch: 9 | loss: 0.1374224
	speed: 0.0200s/iter; left time: 126.7487s
Epoch: 9 cost time: 11.730626821517944
Epoch: 9, Steps: 570 | Train Loss: 0.2557171 Vali Loss: 0.0556010 Test Loss: 0.1605741
Validation loss decreased (0.056052 --> 0.055601).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2737424
	speed: 0.0643s/iter; left time: 396.7413s
	iters: 200, epoch: 10 | loss: 0.1813244
	speed: 0.0200s/iter; left time: 121.6661s
	iters: 300, epoch: 10 | loss: 0.4009261
	speed: 0.0200s/iter; left time: 119.6123s
	iters: 400, epoch: 10 | loss: 0.3548692
	speed: 0.0200s/iter; left time: 117.5849s
	iters: 500, epoch: 10 | loss: 0.2752964
	speed: 0.0201s/iter; left time: 115.7325s
Epoch: 10 cost time: 11.712273359298706
Epoch: 10, Steps: 570 | Train Loss: 0.2539065 Vali Loss: 0.0560734 Test Loss: 0.1604954
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2159983
	speed: 0.0595s/iter; left time: 333.2451s
	iters: 200, epoch: 11 | loss: 0.2328295
	speed: 0.0200s/iter; left time: 109.8363s
	iters: 300, epoch: 11 | loss: 0.1948394
	speed: 0.0200s/iter; left time: 108.0686s
	iters: 400, epoch: 11 | loss: 0.2906358
	speed: 0.0199s/iter; left time: 105.4967s
	iters: 500, epoch: 11 | loss: 0.2166879
	speed: 0.0200s/iter; left time: 103.7735s
Epoch: 11 cost time: 11.644631147384644
Epoch: 11, Steps: 570 | Train Loss: 0.2556766 Vali Loss: 0.0561369 Test Loss: 0.1604189
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2205788
	speed: 0.0593s/iter; left time: 298.5358s
	iters: 200, epoch: 12 | loss: 0.2239135
	speed: 0.0200s/iter; left time: 98.4812s
	iters: 300, epoch: 12 | loss: 0.4537135
	speed: 0.0200s/iter; left time: 96.5329s
	iters: 400, epoch: 12 | loss: 0.2867092
	speed: 0.0200s/iter; left time: 94.5194s
	iters: 500, epoch: 12 | loss: 0.3965144
	speed: 0.0200s/iter; left time: 92.4863s
Epoch: 12 cost time: 11.659355163574219
Epoch: 12, Steps: 570 | Train Loss: 0.2542800 Vali Loss: 0.0559142 Test Loss: 0.1604519
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16082032024860382, mae:0.2550908029079437
>>> MS_Raw LR=5e-4 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1944437
	speed: 0.0224s/iter; left time: 253.0588s
	iters: 200, epoch: 1 | loss: 0.1642704
	speed: 0.0099s/iter; left time: 111.2326s
	iters: 300, epoch: 1 | loss: 0.2080029
	speed: 0.0100s/iter; left time: 110.5885s
	iters: 400, epoch: 1 | loss: 0.1865716
	speed: 0.0099s/iter; left time: 109.3025s
	iters: 500, epoch: 1 | loss: 0.1544829
	speed: 0.0099s/iter; left time: 108.4298s
Epoch: 1 cost time: 6.958572149276733
Epoch: 1, Steps: 570 | Train Loss: 0.1804872 Vali Loss: 0.0488531 Test Loss: 0.1410827
Validation loss decreased (inf --> 0.048853).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1664304
	speed: 0.0367s/iter; left time: 394.0282s
	iters: 200, epoch: 2 | loss: 0.2020042
	speed: 0.0099s/iter; left time: 105.4718s
	iters: 300, epoch: 2 | loss: 0.1241654
	speed: 0.0099s/iter; left time: 104.2881s
	iters: 400, epoch: 2 | loss: 0.1342875
	speed: 0.0099s/iter; left time: 103.6021s
	iters: 500, epoch: 2 | loss: 0.1565352
	speed: 0.0099s/iter; left time: 102.7049s
Epoch: 2 cost time: 5.930832862854004
Epoch: 2, Steps: 570 | Train Loss: 0.1322044 Vali Loss: 0.0428261 Test Loss: 0.1458761
Validation loss decreased (0.048853 --> 0.042826).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0983299
	speed: 0.0378s/iter; left time: 383.7121s
	iters: 200, epoch: 3 | loss: 0.0833045
	speed: 0.0111s/iter; left time: 111.9810s
	iters: 300, epoch: 3 | loss: 0.0775792
	speed: 0.0112s/iter; left time: 111.5104s
	iters: 400, epoch: 3 | loss: 0.1087999
	speed: 0.0112s/iter; left time: 109.9904s
	iters: 500, epoch: 3 | loss: 0.1334865
	speed: 0.0111s/iter; left time: 108.5472s
Epoch: 3 cost time: 6.635986566543579
Epoch: 3, Steps: 570 | Train Loss: 0.0894185 Vali Loss: 0.0405665 Test Loss: 0.1412212
Validation loss decreased (0.042826 --> 0.040567).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0738157
	speed: 0.0364s/iter; left time: 349.5675s
	iters: 200, epoch: 4 | loss: 0.0421157
	speed: 0.0100s/iter; left time: 94.4659s
	iters: 300, epoch: 4 | loss: 0.0593118
	speed: 0.0099s/iter; left time: 93.2857s
	iters: 400, epoch: 4 | loss: 0.0594450
	speed: 0.0100s/iter; left time: 92.4538s
	iters: 500, epoch: 4 | loss: 0.0589572
	speed: 0.0099s/iter; left time: 91.1101s
Epoch: 4 cost time: 5.952483892440796
Epoch: 4, Steps: 570 | Train Loss: 0.0601401 Vali Loss: 0.0413942 Test Loss: 0.1406739
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0557960
	speed: 0.0374s/iter; left time: 337.4748s
	iters: 200, epoch: 5 | loss: 0.0553470
	speed: 0.0100s/iter; left time: 88.8767s
	iters: 300, epoch: 5 | loss: 0.0386101
	speed: 0.0099s/iter; left time: 87.5310s
	iters: 400, epoch: 5 | loss: 0.0521770
	speed: 0.0099s/iter; left time: 86.5119s
	iters: 500, epoch: 5 | loss: 0.0316364
	speed: 0.0099s/iter; left time: 85.5586s
Epoch: 5 cost time: 5.961403846740723
Epoch: 5, Steps: 570 | Train Loss: 0.0463121 Vali Loss: 0.0392300 Test Loss: 0.1354600
Validation loss decreased (0.040567 --> 0.039230).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0314671
	speed: 0.0363s/iter; left time: 307.0054s
	iters: 200, epoch: 6 | loss: 0.0347356
	speed: 0.0115s/iter; left time: 95.6814s
	iters: 300, epoch: 6 | loss: 0.0368734
	speed: 0.0114s/iter; left time: 94.0535s
	iters: 400, epoch: 6 | loss: 0.0429091
	speed: 0.0114s/iter; left time: 92.9551s
	iters: 500, epoch: 6 | loss: 0.0451638
	speed: 0.0114s/iter; left time: 91.8435s
Epoch: 6 cost time: 6.6630539894104
Epoch: 6, Steps: 570 | Train Loss: 0.0389716 Vali Loss: 0.0409728 Test Loss: 0.1399496
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0390323
	speed: 0.0369s/iter; left time: 290.6229s
	iters: 200, epoch: 7 | loss: 0.0337189
	speed: 0.0114s/iter; left time: 88.5701s
	iters: 300, epoch: 7 | loss: 0.0284107
	speed: 0.0114s/iter; left time: 87.4211s
	iters: 400, epoch: 7 | loss: 0.0361575
	speed: 0.0102s/iter; left time: 77.3993s
	iters: 500, epoch: 7 | loss: 0.0334786
	speed: 0.0099s/iter; left time: 74.0279s
Epoch: 7 cost time: 6.385227918624878
Epoch: 7, Steps: 570 | Train Loss: 0.0354632 Vali Loss: 0.0407551 Test Loss: 0.1402271
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0376807
	speed: 0.0367s/iter; left time: 268.0245s
	iters: 200, epoch: 8 | loss: 0.0568481
	speed: 0.0111s/iter; left time: 80.2113s
	iters: 300, epoch: 8 | loss: 0.0314264
	speed: 0.0108s/iter; left time: 76.8660s
	iters: 400, epoch: 8 | loss: 0.0443626
	speed: 0.0099s/iter; left time: 69.5472s
	iters: 500, epoch: 8 | loss: 0.0328621
	speed: 0.0110s/iter; left time: 75.8722s
Epoch: 8 cost time: 6.3824462890625
Epoch: 8, Steps: 570 | Train Loss: 0.0336702 Vali Loss: 0.0409307 Test Loss: 0.1423887
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.135650172829628, mae:0.23488344252109528
>>> MS_Raw LR=5e-4 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1940793
	speed: 0.0214s/iter; left time: 241.2853s
	iters: 200, epoch: 1 | loss: 0.1388180
	speed: 0.0098s/iter; left time: 109.8138s
	iters: 300, epoch: 1 | loss: 0.2141243
	speed: 0.0098s/iter; left time: 109.1997s
	iters: 400, epoch: 1 | loss: 0.1099621
	speed: 0.0098s/iter; left time: 107.4294s
	iters: 500, epoch: 1 | loss: 0.1165200
	speed: 0.0098s/iter; left time: 106.5104s
Epoch: 1 cost time: 6.786109209060669
Epoch: 1, Steps: 570 | Train Loss: 0.1467942 Vali Loss: 0.0391663 Test Loss: 0.1277200
Validation loss decreased (inf --> 0.039166).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1055574
	speed: 0.0353s/iter; left time: 378.4663s
	iters: 200, epoch: 2 | loss: 0.1487699
	speed: 0.0097s/iter; left time: 103.4253s
	iters: 300, epoch: 2 | loss: 0.0745109
	speed: 0.0097s/iter; left time: 102.6217s
	iters: 400, epoch: 2 | loss: 0.0588041
	speed: 0.0097s/iter; left time: 101.5449s
	iters: 500, epoch: 2 | loss: 0.0908444
	speed: 0.0097s/iter; left time: 100.5691s
Epoch: 2 cost time: 5.8721044063568115
Epoch: 2, Steps: 570 | Train Loss: 0.1147852 Vali Loss: 0.0365444 Test Loss: 0.1178358
Validation loss decreased (0.039166 --> 0.036544).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0494687
	speed: 0.0379s/iter; left time: 385.3344s
	iters: 200, epoch: 3 | loss: 0.0652063
	speed: 0.0109s/iter; left time: 109.4614s
	iters: 300, epoch: 3 | loss: 0.1403556
	speed: 0.0110s/iter; left time: 109.2781s
	iters: 400, epoch: 3 | loss: 0.0767204
	speed: 0.0110s/iter; left time: 108.1928s
	iters: 500, epoch: 3 | loss: 0.0613843
	speed: 0.0110s/iter; left time: 107.1236s
Epoch: 3 cost time: 6.548755645751953
Epoch: 3, Steps: 570 | Train Loss: 0.0810848 Vali Loss: 0.0354074 Test Loss: 0.1190029
Validation loss decreased (0.036544 --> 0.035407).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0427368
	speed: 0.0357s/iter; left time: 342.2756s
	iters: 200, epoch: 4 | loss: 0.0439321
	speed: 0.0097s/iter; left time: 92.3522s
	iters: 300, epoch: 4 | loss: 0.0371526
	speed: 0.0098s/iter; left time: 91.5942s
	iters: 400, epoch: 4 | loss: 0.0446692
	speed: 0.0097s/iter; left time: 90.5401s
	iters: 500, epoch: 4 | loss: 0.0675589
	speed: 0.0098s/iter; left time: 89.6653s
Epoch: 4 cost time: 5.847045421600342
Epoch: 4, Steps: 570 | Train Loss: 0.0567281 Vali Loss: 0.0344380 Test Loss: 0.1204967
Validation loss decreased (0.035407 --> 0.034438).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0475336
	speed: 0.0357s/iter; left time: 321.9456s
	iters: 200, epoch: 5 | loss: 0.0603414
	speed: 0.0098s/iter; left time: 87.5119s
	iters: 300, epoch: 5 | loss: 0.0557232
	speed: 0.0098s/iter; left time: 86.5179s
	iters: 400, epoch: 5 | loss: 0.0629306
	speed: 0.0098s/iter; left time: 85.3789s
	iters: 500, epoch: 5 | loss: 0.0599310
	speed: 0.0098s/iter; left time: 84.4997s
Epoch: 5 cost time: 5.866745471954346
Epoch: 5, Steps: 570 | Train Loss: 0.0443423 Vali Loss: 0.0358920 Test Loss: 0.1261836
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0302408
	speed: 0.0351s/iter; left time: 296.8065s
	iters: 200, epoch: 6 | loss: 0.0627531
	speed: 0.0098s/iter; left time: 81.8265s
	iters: 300, epoch: 6 | loss: 0.0530466
	speed: 0.0098s/iter; left time: 81.1804s
	iters: 400, epoch: 6 | loss: 0.0300475
	speed: 0.0098s/iter; left time: 80.0183s
	iters: 500, epoch: 6 | loss: 0.0230651
	speed: 0.0098s/iter; left time: 78.9465s
Epoch: 6 cost time: 5.871471881866455
Epoch: 6, Steps: 570 | Train Loss: 0.0382273 Vali Loss: 0.0365799 Test Loss: 0.1277658
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0277006
	speed: 0.0359s/iter; left time: 283.1276s
	iters: 200, epoch: 7 | loss: 0.0329772
	speed: 0.0098s/iter; left time: 76.1906s
	iters: 300, epoch: 7 | loss: 0.0540259
	speed: 0.0098s/iter; left time: 75.1984s
	iters: 400, epoch: 7 | loss: 0.0743621
	speed: 0.0098s/iter; left time: 74.2063s
	iters: 500, epoch: 7 | loss: 0.0309425
	speed: 0.0098s/iter; left time: 73.2246s
Epoch: 7 cost time: 5.889540672302246
Epoch: 7, Steps: 570 | Train Loss: 0.0351306 Vali Loss: 0.0364887 Test Loss: 0.1271494
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12067621946334839, mae:0.216682568192482
>>> MS_Raw LR=5e-4 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1714890
	speed: 0.0230s/iter; left time: 260.2095s
	iters: 200, epoch: 1 | loss: 0.1268095
	speed: 0.0110s/iter; left time: 123.1161s
	iters: 300, epoch: 1 | loss: 0.1375185
	speed: 0.0105s/iter; left time: 116.4037s
	iters: 400, epoch: 1 | loss: 0.0977060
	speed: 0.0098s/iter; left time: 108.0410s
	iters: 500, epoch: 1 | loss: 0.1776273
	speed: 0.0098s/iter; left time: 107.3438s
Epoch: 1 cost time: 7.1545751094818115
Epoch: 1, Steps: 570 | Train Loss: 0.1847429 Vali Loss: 0.0443673 Test Loss: 0.1467872
Validation loss decreased (inf --> 0.044367).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1578133
	speed: 0.0370s/iter; left time: 396.5911s
	iters: 200, epoch: 2 | loss: 0.2252475
	speed: 0.0099s/iter; left time: 105.6766s
	iters: 300, epoch: 2 | loss: 0.1275061
	speed: 0.0107s/iter; left time: 112.8678s
	iters: 400, epoch: 2 | loss: 0.1975546
	speed: 0.0113s/iter; left time: 118.2619s
	iters: 500, epoch: 2 | loss: 0.1235378
	speed: 0.0113s/iter; left time: 116.7721s
Epoch: 2 cost time: 6.4402453899383545
Epoch: 2, Steps: 570 | Train Loss: 0.1313124 Vali Loss: 0.0441769 Test Loss: 0.1452591
Validation loss decreased (0.044367 --> 0.044177).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0545728
	speed: 0.0389s/iter; left time: 395.7318s
	iters: 200, epoch: 3 | loss: 0.0621531
	speed: 0.0112s/iter; left time: 112.7406s
	iters: 300, epoch: 3 | loss: 0.0807057
	speed: 0.0112s/iter; left time: 111.8310s
	iters: 400, epoch: 3 | loss: 0.0659295
	speed: 0.0112s/iter; left time: 110.6056s
	iters: 500, epoch: 3 | loss: 0.0607469
	speed: 0.0112s/iter; left time: 109.2930s
Epoch: 3 cost time: 6.701701879501343
Epoch: 3, Steps: 570 | Train Loss: 0.0804944 Vali Loss: 0.0399675 Test Loss: 0.1428847
Validation loss decreased (0.044177 --> 0.039968).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0398316
	speed: 0.0377s/iter; left time: 361.7267s
	iters: 200, epoch: 4 | loss: 0.0337781
	speed: 0.0113s/iter; left time: 106.9743s
	iters: 300, epoch: 4 | loss: 0.0411565
	speed: 0.0113s/iter; left time: 105.7376s
	iters: 400, epoch: 4 | loss: 0.0658094
	speed: 0.0100s/iter; left time: 92.4916s
	iters: 500, epoch: 4 | loss: 0.0430230
	speed: 0.0099s/iter; left time: 91.0965s
Epoch: 4 cost time: 6.367978096008301
Epoch: 4, Steps: 570 | Train Loss: 0.0502238 Vali Loss: 0.0407962 Test Loss: 0.1488430
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0395215
	speed: 0.0353s/iter; left time: 318.4343s
	iters: 200, epoch: 5 | loss: 0.0381135
	speed: 0.0098s/iter; left time: 87.8107s
	iters: 300, epoch: 5 | loss: 0.0297308
	speed: 0.0108s/iter; left time: 95.3588s
	iters: 400, epoch: 5 | loss: 0.0274207
	speed: 0.0098s/iter; left time: 85.6711s
	iters: 500, epoch: 5 | loss: 0.0346355
	speed: 0.0098s/iter; left time: 84.4704s
Epoch: 5 cost time: 5.968109369277954
Epoch: 5, Steps: 570 | Train Loss: 0.0374292 Vali Loss: 0.0404922 Test Loss: 0.1463897
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0315148
	speed: 0.0372s/iter; left time: 314.0722s
	iters: 200, epoch: 6 | loss: 0.0427770
	speed: 0.0099s/iter; left time: 82.7281s
	iters: 300, epoch: 6 | loss: 0.0287391
	speed: 0.0098s/iter; left time: 81.1365s
	iters: 400, epoch: 6 | loss: 0.0242794
	speed: 0.0098s/iter; left time: 80.1656s
	iters: 500, epoch: 6 | loss: 0.0340353
	speed: 0.0099s/iter; left time: 79.3266s
Epoch: 6 cost time: 5.94371223449707
Epoch: 6, Steps: 570 | Train Loss: 0.0319297 Vali Loss: 0.0407948 Test Loss: 0.1484461
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.143092542886734, mae:0.2408505529165268
>>> MS_Raw LR=5e-4 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2388572
	speed: 0.0233s/iter; left time: 263.3954s
	iters: 200, epoch: 1 | loss: 0.2025720
	speed: 0.0114s/iter; left time: 127.9187s
	iters: 300, epoch: 1 | loss: 0.1443961
	speed: 0.0114s/iter; left time: 126.8483s
	iters: 400, epoch: 1 | loss: 0.0870342
	speed: 0.0114s/iter; left time: 125.5374s
	iters: 500, epoch: 1 | loss: 0.1572416
	speed: 0.0114s/iter; left time: 124.5104s
Epoch: 1 cost time: 7.746150732040405
Epoch: 1, Steps: 570 | Train Loss: 0.2009764 Vali Loss: 0.0460886 Test Loss: 0.1417371
Validation loss decreased (inf --> 0.046089).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1435807
	speed: 0.0400s/iter; left time: 429.6569s
	iters: 200, epoch: 2 | loss: 0.1392410
	speed: 0.0114s/iter; left time: 121.1957s
	iters: 300, epoch: 2 | loss: 0.1236219
	speed: 0.0114s/iter; left time: 120.2022s
	iters: 400, epoch: 2 | loss: 0.0819476
	speed: 0.0114s/iter; left time: 118.8824s
	iters: 500, epoch: 2 | loss: 0.1863607
	speed: 0.0114s/iter; left time: 117.8635s
Epoch: 2 cost time: 6.843102216720581
Epoch: 2, Steps: 570 | Train Loss: 0.1794212 Vali Loss: 0.0579344 Test Loss: 0.1662709
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1860282
	speed: 0.0388s/iter; left time: 394.2432s
	iters: 200, epoch: 3 | loss: 0.1703259
	speed: 0.0115s/iter; left time: 115.2383s
	iters: 300, epoch: 3 | loss: 0.1034399
	speed: 0.0114s/iter; left time: 114.0243s
	iters: 400, epoch: 3 | loss: 0.1257529
	speed: 0.0114s/iter; left time: 112.8788s
	iters: 500, epoch: 3 | loss: 0.1156912
	speed: 0.0115s/iter; left time: 111.8079s
Epoch: 3 cost time: 6.821720123291016
Epoch: 3, Steps: 570 | Train Loss: 0.1496666 Vali Loss: 0.0448545 Test Loss: 0.1353032
Validation loss decreased (0.046089 --> 0.044854).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1272880
	speed: 0.0382s/iter; left time: 366.6098s
	iters: 200, epoch: 4 | loss: 0.1286890
	speed: 0.0114s/iter; left time: 108.3148s
	iters: 300, epoch: 4 | loss: 0.0969923
	speed: 0.0114s/iter; left time: 107.3656s
	iters: 400, epoch: 4 | loss: 0.0714660
	speed: 0.0114s/iter; left time: 106.2453s
	iters: 500, epoch: 4 | loss: 0.1516775
	speed: 0.0114s/iter; left time: 104.9470s
Epoch: 4 cost time: 6.821744918823242
Epoch: 4, Steps: 570 | Train Loss: 0.1244113 Vali Loss: 0.0458936 Test Loss: 0.1368112
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0831007
	speed: 0.0373s/iter; left time: 336.6148s
	iters: 200, epoch: 5 | loss: 0.0894234
	speed: 0.0114s/iter; left time: 101.5558s
	iters: 300, epoch: 5 | loss: 0.1539751
	speed: 0.0114s/iter; left time: 100.4577s
	iters: 400, epoch: 5 | loss: 0.0966540
	speed: 0.0114s/iter; left time: 99.4615s
	iters: 500, epoch: 5 | loss: 0.1262841
	speed: 0.0114s/iter; left time: 98.3442s
Epoch: 5 cost time: 6.782228946685791
Epoch: 5, Steps: 570 | Train Loss: 0.1050426 Vali Loss: 0.0450158 Test Loss: 0.1372498
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0814576
	speed: 0.0381s/iter; left time: 321.8385s
	iters: 200, epoch: 6 | loss: 0.0685639
	speed: 0.0114s/iter; left time: 95.4000s
	iters: 300, epoch: 6 | loss: 0.0879787
	speed: 0.0114s/iter; left time: 94.3267s
	iters: 400, epoch: 6 | loss: 0.0606897
	speed: 0.0114s/iter; left time: 93.1903s
	iters: 500, epoch: 6 | loss: 0.0625465
	speed: 0.0114s/iter; left time: 91.9707s
Epoch: 6 cost time: 6.855918645858765
Epoch: 6, Steps: 570 | Train Loss: 0.0924215 Vali Loss: 0.0437972 Test Loss: 0.1383720
Validation loss decreased (0.044854 --> 0.043797).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0925268
	speed: 0.0391s/iter; left time: 307.9477s
	iters: 200, epoch: 7 | loss: 0.0876379
	speed: 0.0114s/iter; left time: 88.5182s
	iters: 300, epoch: 7 | loss: 0.0903184
	speed: 0.0114s/iter; left time: 87.3809s
	iters: 400, epoch: 7 | loss: 0.0643708
	speed: 0.0114s/iter; left time: 86.2401s
	iters: 500, epoch: 7 | loss: 0.1023967
	speed: 0.0114s/iter; left time: 85.0855s
Epoch: 7 cost time: 6.777711391448975
Epoch: 7, Steps: 570 | Train Loss: 0.0852080 Vali Loss: 0.0439345 Test Loss: 0.1393003
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0709743
	speed: 0.0371s/iter; left time: 271.5628s
	iters: 200, epoch: 8 | loss: 0.0723450
	speed: 0.0114s/iter; left time: 82.1930s
	iters: 300, epoch: 8 | loss: 0.0668660
	speed: 0.0114s/iter; left time: 81.0603s
	iters: 400, epoch: 8 | loss: 0.0706788
	speed: 0.0114s/iter; left time: 79.9205s
	iters: 500, epoch: 8 | loss: 0.0804036
	speed: 0.0114s/iter; left time: 78.8065s
Epoch: 8 cost time: 6.786161422729492
Epoch: 8, Steps: 570 | Train Loss: 0.0810429 Vali Loss: 0.0440970 Test Loss: 0.1393788
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0490901
	speed: 0.0379s/iter; left time: 255.6213s
	iters: 200, epoch: 9 | loss: 0.0777733
	speed: 0.0114s/iter; left time: 75.9067s
	iters: 300, epoch: 9 | loss: 0.0971335
	speed: 0.0115s/iter; left time: 74.9619s
	iters: 400, epoch: 9 | loss: 0.0591456
	speed: 0.0115s/iter; left time: 73.8091s
	iters: 500, epoch: 9 | loss: 0.0914075
	speed: 0.0115s/iter; left time: 72.6147s
Epoch: 9 cost time: 6.818837404251099
Epoch: 9, Steps: 570 | Train Loss: 0.0786846 Vali Loss: 0.0439969 Test Loss: 0.1393926
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13855166733264923, mae:0.23596133291721344
>>> MS_Raw LR=5e-4 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.0974500
	speed: 0.0235s/iter; left time: 265.8678s
	iters: 200, epoch: 1 | loss: 0.2052382
	speed: 0.0118s/iter; left time: 132.3426s
	iters: 300, epoch: 1 | loss: 0.1459617
	speed: 0.0118s/iter; left time: 131.3029s
	iters: 400, epoch: 1 | loss: 0.1657365
	speed: 0.0118s/iter; left time: 129.8849s
	iters: 500, epoch: 1 | loss: 0.1082806
	speed: 0.0119s/iter; left time: 129.4162s
Epoch: 1 cost time: 7.975814342498779
Epoch: 1, Steps: 570 | Train Loss: 0.1601642 Vali Loss: 0.0422012 Test Loss: 0.1301945
Validation loss decreased (inf --> 0.042201).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1238574
	speed: 0.0382s/iter; left time: 410.3867s
	iters: 200, epoch: 2 | loss: 0.0918113
	speed: 0.0118s/iter; left time: 125.6450s
	iters: 300, epoch: 2 | loss: 0.1213746
	speed: 0.0118s/iter; left time: 124.4359s
	iters: 400, epoch: 2 | loss: 0.1729004
	speed: 0.0118s/iter; left time: 123.2892s
	iters: 500, epoch: 2 | loss: 0.1869538
	speed: 0.0118s/iter; left time: 122.1841s
Epoch: 2 cost time: 6.976348400115967
Epoch: 2, Steps: 570 | Train Loss: 0.1370953 Vali Loss: 0.0412954 Test Loss: 0.1261017
Validation loss decreased (0.042201 --> 0.041295).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1401310
	speed: 0.0389s/iter; left time: 395.7703s
	iters: 200, epoch: 3 | loss: 0.0646986
	speed: 0.0120s/iter; left time: 120.3742s
	iters: 300, epoch: 3 | loss: 0.1279343
	speed: 0.0119s/iter; left time: 119.0276s
	iters: 400, epoch: 3 | loss: 0.1239163
	speed: 0.0120s/iter; left time: 117.8959s
	iters: 500, epoch: 3 | loss: 0.1246570
	speed: 0.0120s/iter; left time: 116.6765s
Epoch: 3 cost time: 7.127087831497192
Epoch: 3, Steps: 570 | Train Loss: 0.1077242 Vali Loss: 0.0355741 Test Loss: 0.1213372
Validation loss decreased (0.041295 --> 0.035574).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0936984
	speed: 0.0416s/iter; left time: 398.9349s
	iters: 200, epoch: 4 | loss: 0.0660693
	speed: 0.0121s/iter; left time: 114.7617s
	iters: 300, epoch: 4 | loss: 0.0422177
	speed: 0.0121s/iter; left time: 113.6135s
	iters: 400, epoch: 4 | loss: 0.1038613
	speed: 0.0110s/iter; left time: 102.3396s
	iters: 500, epoch: 4 | loss: 0.0759548
	speed: 0.0110s/iter; left time: 101.0814s
Epoch: 4 cost time: 6.91135311126709
Epoch: 4, Steps: 570 | Train Loss: 0.0860111 Vali Loss: 0.0350507 Test Loss: 0.1255417
Validation loss decreased (0.035574 --> 0.035051).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0573087
	speed: 0.0376s/iter; left time: 339.2051s
	iters: 200, epoch: 5 | loss: 0.0602667
	speed: 0.0110s/iter; left time: 98.2975s
	iters: 300, epoch: 5 | loss: 0.0824649
	speed: 0.0110s/iter; left time: 96.9803s
	iters: 400, epoch: 5 | loss: 0.0633375
	speed: 0.0110s/iter; left time: 95.9178s
	iters: 500, epoch: 5 | loss: 0.0625824
	speed: 0.0110s/iter; left time: 94.9068s
Epoch: 5 cost time: 6.56067419052124
Epoch: 5, Steps: 570 | Train Loss: 0.0691570 Vali Loss: 0.0333579 Test Loss: 0.1244702
Validation loss decreased (0.035051 --> 0.033358).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0775955
	speed: 0.0367s/iter; left time: 309.8266s
	iters: 200, epoch: 6 | loss: 0.0551258
	speed: 0.0110s/iter; left time: 91.5539s
	iters: 300, epoch: 6 | loss: 0.0558651
	speed: 0.0110s/iter; left time: 90.4673s
	iters: 400, epoch: 6 | loss: 0.0444722
	speed: 0.0110s/iter; left time: 89.3783s
	iters: 500, epoch: 6 | loss: 0.0528609
	speed: 0.0110s/iter; left time: 88.2942s
Epoch: 6 cost time: 6.5613415241241455
Epoch: 6, Steps: 570 | Train Loss: 0.0584916 Vali Loss: 0.0337634 Test Loss: 0.1316425
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0433577
	speed: 0.0383s/iter; left time: 301.4629s
	iters: 200, epoch: 7 | loss: 0.0621938
	speed: 0.0111s/iter; left time: 86.3449s
	iters: 300, epoch: 7 | loss: 0.0465754
	speed: 0.0111s/iter; left time: 85.1061s
	iters: 400, epoch: 7 | loss: 0.0555614
	speed: 0.0111s/iter; left time: 83.9769s
	iters: 500, epoch: 7 | loss: 0.0376010
	speed: 0.0111s/iter; left time: 82.9261s
Epoch: 7 cost time: 6.602259635925293
Epoch: 7, Steps: 570 | Train Loss: 0.0522816 Vali Loss: 0.0336066 Test Loss: 0.1316548
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0479672
	speed: 0.0368s/iter; left time: 269.1381s
	iters: 200, epoch: 8 | loss: 0.0504123
	speed: 0.0111s/iter; left time: 79.7343s
	iters: 300, epoch: 8 | loss: 0.0374279
	speed: 0.0111s/iter; left time: 78.6192s
	iters: 400, epoch: 8 | loss: 0.0494475
	speed: 0.0111s/iter; left time: 77.5008s
	iters: 500, epoch: 8 | loss: 0.0504735
	speed: 0.0111s/iter; left time: 76.3775s
Epoch: 8 cost time: 6.582440614700317
Epoch: 8, Steps: 570 | Train Loss: 0.0490019 Vali Loss: 0.0342471 Test Loss: 0.1331143
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12465690076351166, mae:0.21787424385547638
>>> MS_Raw LR=5e-4 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2019889
	speed: 0.0234s/iter; left time: 264.9499s
	iters: 200, epoch: 1 | loss: 0.2130914
	speed: 0.0114s/iter; left time: 127.2976s
	iters: 300, epoch: 1 | loss: 0.1833379
	speed: 0.0104s/iter; left time: 115.5568s
	iters: 400, epoch: 1 | loss: 0.1353990
	speed: 0.0110s/iter; left time: 120.7163s
	iters: 500, epoch: 1 | loss: 0.1589779
	speed: 0.0114s/iter; left time: 124.1524s
Epoch: 1 cost time: 7.6108245849609375
Epoch: 1, Steps: 570 | Train Loss: 0.1984546 Vali Loss: 0.0496909 Test Loss: 0.1584453
Validation loss decreased (inf --> 0.049691).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1731774
	speed: 0.0376s/iter; left time: 403.9230s
	iters: 200, epoch: 2 | loss: 0.2615232
	speed: 0.0103s/iter; left time: 109.7357s
	iters: 300, epoch: 2 | loss: 0.1243211
	speed: 0.0103s/iter; left time: 108.7656s
	iters: 400, epoch: 2 | loss: 0.1666401
	speed: 0.0103s/iter; left time: 107.6709s
	iters: 500, epoch: 2 | loss: 0.1445317
	speed: 0.0103s/iter; left time: 106.6721s
Epoch: 2 cost time: 6.199178457260132
Epoch: 2, Steps: 570 | Train Loss: 0.2028869 Vali Loss: 0.0559001 Test Loss: 0.1606367
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1585160
	speed: 0.0379s/iter; left time: 385.0241s
	iters: 200, epoch: 3 | loss: 0.1345448
	speed: 0.0114s/iter; left time: 114.8323s
	iters: 300, epoch: 3 | loss: 0.1909739
	speed: 0.0114s/iter; left time: 113.4754s
	iters: 400, epoch: 3 | loss: 0.1253612
	speed: 0.0114s/iter; left time: 112.4383s
	iters: 500, epoch: 3 | loss: 0.1260650
	speed: 0.0114s/iter; left time: 111.2306s
Epoch: 3 cost time: 6.8017356395721436
Epoch: 3, Steps: 570 | Train Loss: 0.1610141 Vali Loss: 0.0496181 Test Loss: 0.1464581
Validation loss decreased (0.049691 --> 0.049618).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1535898
	speed: 0.0368s/iter; left time: 352.9081s
	iters: 200, epoch: 4 | loss: 0.1112829
	speed: 0.0103s/iter; left time: 98.0060s
	iters: 300, epoch: 4 | loss: 0.1107739
	speed: 0.0103s/iter; left time: 97.1216s
	iters: 400, epoch: 4 | loss: 0.2499674
	speed: 0.0104s/iter; left time: 96.4366s
	iters: 500, epoch: 4 | loss: 0.0918426
	speed: 0.0104s/iter; left time: 95.1411s
Epoch: 4 cost time: 6.184078931808472
Epoch: 4, Steps: 570 | Train Loss: 0.1255826 Vali Loss: 0.0450062 Test Loss: 0.1426192
Validation loss decreased (0.049618 --> 0.045006).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1097186
	speed: 0.0368s/iter; left time: 331.9542s
	iters: 200, epoch: 5 | loss: 0.1317494
	speed: 0.0105s/iter; left time: 93.8878s
	iters: 300, epoch: 5 | loss: 0.1488588
	speed: 0.0118s/iter; left time: 104.1925s
	iters: 400, epoch: 5 | loss: 0.0857320
	speed: 0.0118s/iter; left time: 102.5045s
	iters: 500, epoch: 5 | loss: 0.1473603
	speed: 0.0118s/iter; left time: 101.4414s
Epoch: 5 cost time: 6.720784664154053
Epoch: 5, Steps: 570 | Train Loss: 0.1054959 Vali Loss: 0.0452785 Test Loss: 0.1415697
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0955923
	speed: 0.0390s/iter; left time: 329.2347s
	iters: 200, epoch: 6 | loss: 0.0796199
	speed: 0.0118s/iter; left time: 98.1918s
	iters: 300, epoch: 6 | loss: 0.0931741
	speed: 0.0112s/iter; left time: 92.0646s
	iters: 400, epoch: 6 | loss: 0.0931934
	speed: 0.0114s/iter; left time: 92.9575s
	iters: 500, epoch: 6 | loss: 0.1077420
	speed: 0.0114s/iter; left time: 91.6769s
Epoch: 6 cost time: 6.861103057861328
Epoch: 6, Steps: 570 | Train Loss: 0.0928161 Vali Loss: 0.0452328 Test Loss: 0.1478300
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0777740
	speed: 0.0382s/iter; left time: 300.8773s
	iters: 200, epoch: 7 | loss: 0.0906318
	speed: 0.0117s/iter; left time: 91.4186s
	iters: 300, epoch: 7 | loss: 0.0649016
	speed: 0.0117s/iter; left time: 90.1740s
	iters: 400, epoch: 7 | loss: 0.0970137
	speed: 0.0117s/iter; left time: 89.0157s
	iters: 500, epoch: 7 | loss: 0.0612615
	speed: 0.0117s/iter; left time: 87.7238s
Epoch: 7 cost time: 6.930943012237549
Epoch: 7, Steps: 570 | Train Loss: 0.0846187 Vali Loss: 0.0453729 Test Loss: 0.1449361
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1428108662366867, mae:0.2442036122083664
>>> MS_Raw LR=5e-4 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1978606
	speed: 0.0256s/iter; left time: 288.8595s
	iters: 200, epoch: 1 | loss: 0.1406488
	speed: 0.0136s/iter; left time: 152.5686s
	iters: 300, epoch: 1 | loss: 0.2377709
	speed: 0.0136s/iter; left time: 150.8254s
	iters: 400, epoch: 1 | loss: 0.1688309
	speed: 0.0136s/iter; left time: 149.6879s
	iters: 500, epoch: 1 | loss: 0.1429378
	speed: 0.0136s/iter; left time: 148.3767s
Epoch: 1 cost time: 9.000446319580078
Epoch: 1, Steps: 570 | Train Loss: 0.1824579 Vali Loss: 0.0461201 Test Loss: 0.1406951
Validation loss decreased (inf --> 0.046120).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1808321
	speed: 0.0444s/iter; left time: 476.6527s
	iters: 200, epoch: 2 | loss: 0.1237853
	speed: 0.0136s/iter; left time: 144.9870s
	iters: 300, epoch: 2 | loss: 0.1161452
	speed: 0.0136s/iter; left time: 143.6165s
	iters: 400, epoch: 2 | loss: 0.0831951
	speed: 0.0136s/iter; left time: 142.2477s
	iters: 500, epoch: 2 | loss: 0.1708268
	speed: 0.0136s/iter; left time: 140.3361s
Epoch: 2 cost time: 8.050748586654663
Epoch: 2, Steps: 570 | Train Loss: 0.1403602 Vali Loss: 0.0479635 Test Loss: 0.1585671
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1754857
	speed: 0.0444s/iter; left time: 451.3433s
	iters: 200, epoch: 3 | loss: 0.0950794
	speed: 0.0136s/iter; left time: 137.0447s
	iters: 300, epoch: 3 | loss: 0.0790503
	speed: 0.0136s/iter; left time: 135.7133s
	iters: 400, epoch: 3 | loss: 0.0907891
	speed: 0.0136s/iter; left time: 134.2382s
	iters: 500, epoch: 3 | loss: 0.0887034
	speed: 0.0136s/iter; left time: 133.0706s
Epoch: 3 cost time: 8.037103414535522
Epoch: 3, Steps: 570 | Train Loss: 0.1063732 Vali Loss: 0.0409150 Test Loss: 0.1384491
Validation loss decreased (0.046120 --> 0.040915).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0839169
	speed: 0.0449s/iter; left time: 430.4576s
	iters: 200, epoch: 4 | loss: 0.0629344
	speed: 0.0136s/iter; left time: 129.1617s
	iters: 300, epoch: 4 | loss: 0.0953755
	speed: 0.0136s/iter; left time: 127.7703s
	iters: 400, epoch: 4 | loss: 0.0753769
	speed: 0.0136s/iter; left time: 126.2927s
	iters: 500, epoch: 4 | loss: 0.0546866
	speed: 0.0136s/iter; left time: 125.0300s
Epoch: 4 cost time: 8.064031839370728
Epoch: 4, Steps: 570 | Train Loss: 0.0716987 Vali Loss: 0.0403713 Test Loss: 0.1423966
Validation loss decreased (0.040915 --> 0.040371).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0682062
	speed: 0.0468s/iter; left time: 422.4737s
	iters: 200, epoch: 5 | loss: 0.0543592
	speed: 0.0153s/iter; left time: 136.7134s
	iters: 300, epoch: 5 | loss: 0.0492750
	speed: 0.0154s/iter; left time: 135.9414s
	iters: 400, epoch: 5 | loss: 0.0439108
	speed: 0.0154s/iter; left time: 134.0809s
	iters: 500, epoch: 5 | loss: 0.0325127
	speed: 0.0154s/iter; left time: 132.5044s
Epoch: 5 cost time: 9.037996292114258
Epoch: 5, Steps: 570 | Train Loss: 0.0540604 Vali Loss: 0.0405654 Test Loss: 0.1445131
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0450938
	speed: 0.0483s/iter; left time: 408.1217s
	iters: 200, epoch: 6 | loss: 0.0751078
	speed: 0.0154s/iter; left time: 128.5278s
	iters: 300, epoch: 6 | loss: 0.0407169
	speed: 0.0154s/iter; left time: 126.9344s
	iters: 400, epoch: 6 | loss: 0.0473953
	speed: 0.0154s/iter; left time: 125.4242s
	iters: 500, epoch: 6 | loss: 0.0438990
	speed: 0.0149s/iter; left time: 120.2679s
Epoch: 6 cost time: 8.865463495254517
Epoch: 6, Steps: 570 | Train Loss: 0.0449369 Vali Loss: 0.0414444 Test Loss: 0.1482243
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0427545
	speed: 0.0451s/iter; left time: 355.7274s
	iters: 200, epoch: 7 | loss: 0.0429754
	speed: 0.0137s/iter; left time: 106.8221s
	iters: 300, epoch: 7 | loss: 0.0315846
	speed: 0.0137s/iter; left time: 105.4040s
	iters: 400, epoch: 7 | loss: 0.0442837
	speed: 0.0137s/iter; left time: 103.6905s
	iters: 500, epoch: 7 | loss: 0.0533348
	speed: 0.0137s/iter; left time: 102.3071s
Epoch: 7 cost time: 8.092047691345215
Epoch: 7, Steps: 570 | Train Loss: 0.0403531 Vali Loss: 0.0424153 Test Loss: 0.1492263
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1425885260105133, mae:0.24156534671783447
>>> MS_Raw LR=5e-4 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2268765
	speed: 0.0269s/iter; left time: 304.1527s
	iters: 200, epoch: 1 | loss: 0.1184546
	speed: 0.0141s/iter; left time: 158.3915s
	iters: 300, epoch: 1 | loss: 0.1239855
	speed: 0.0135s/iter; left time: 149.5981s
	iters: 400, epoch: 1 | loss: 0.1680717
	speed: 0.0135s/iter; left time: 148.4984s
	iters: 500, epoch: 1 | loss: 0.1292608
	speed: 0.0135s/iter; left time: 147.5463s
Epoch: 1 cost time: 9.152660846710205
Epoch: 1, Steps: 570 | Train Loss: 0.1520934 Vali Loss: 0.0372690 Test Loss: 0.1163540
Validation loss decreased (inf --> 0.037269).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0825776
	speed: 0.0445s/iter; left time: 477.8770s
	iters: 200, epoch: 2 | loss: 0.2555671
	speed: 0.0134s/iter; left time: 142.2277s
	iters: 300, epoch: 2 | loss: 0.1489368
	speed: 0.0134s/iter; left time: 140.6590s
	iters: 400, epoch: 2 | loss: 0.0923580
	speed: 0.0134s/iter; left time: 139.5673s
	iters: 500, epoch: 2 | loss: 0.0957127
	speed: 0.0134s/iter; left time: 138.2961s
Epoch: 2 cost time: 7.940032482147217
Epoch: 2, Steps: 570 | Train Loss: 0.1173969 Vali Loss: 0.0392548 Test Loss: 0.1194504
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1095200
	speed: 0.0471s/iter; left time: 478.8090s
	iters: 200, epoch: 3 | loss: 0.0508968
	speed: 0.0152s/iter; left time: 153.1372s
	iters: 300, epoch: 3 | loss: 0.0897601
	speed: 0.0152s/iter; left time: 151.3141s
	iters: 400, epoch: 3 | loss: 0.0699842
	speed: 0.0152s/iter; left time: 149.6124s
	iters: 500, epoch: 3 | loss: 0.0651250
	speed: 0.0140s/iter; left time: 136.5299s
Epoch: 3 cost time: 8.748886823654175
Epoch: 3, Steps: 570 | Train Loss: 0.0834549 Vali Loss: 0.0350599 Test Loss: 0.1154133
Validation loss decreased (0.037269 --> 0.035060).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0440067
	speed: 0.0451s/iter; left time: 432.4535s
	iters: 200, epoch: 4 | loss: 0.0632474
	speed: 0.0135s/iter; left time: 128.4265s
	iters: 300, epoch: 4 | loss: 0.0656902
	speed: 0.0136s/iter; left time: 127.5094s
	iters: 400, epoch: 4 | loss: 0.0422224
	speed: 0.0136s/iter; left time: 126.1455s
	iters: 500, epoch: 4 | loss: 0.0366644
	speed: 0.0135s/iter; left time: 124.4539s
Epoch: 4 cost time: 8.007375001907349
Epoch: 4, Steps: 570 | Train Loss: 0.0564874 Vali Loss: 0.0340818 Test Loss: 0.1165414
Validation loss decreased (0.035060 --> 0.034082).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0329393
	speed: 0.0467s/iter; left time: 421.6617s
	iters: 200, epoch: 5 | loss: 0.0378728
	speed: 0.0135s/iter; left time: 120.7067s
	iters: 300, epoch: 5 | loss: 0.0312857
	speed: 0.0135s/iter; left time: 119.1641s
	iters: 400, epoch: 5 | loss: 0.0266005
	speed: 0.0135s/iter; left time: 117.7138s
	iters: 500, epoch: 5 | loss: 0.0470453
	speed: 0.0135s/iter; left time: 116.4294s
Epoch: 5 cost time: 7.9750306606292725
Epoch: 5, Steps: 570 | Train Loss: 0.0417427 Vali Loss: 0.0357250 Test Loss: 0.1175037
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0335595
	speed: 0.0446s/iter; left time: 376.9393s
	iters: 200, epoch: 6 | loss: 0.0529354
	speed: 0.0134s/iter; left time: 112.2853s
	iters: 300, epoch: 6 | loss: 0.0342036
	speed: 0.0135s/iter; left time: 111.1508s
	iters: 400, epoch: 6 | loss: 0.0658579
	speed: 0.0135s/iter; left time: 109.7047s
	iters: 500, epoch: 6 | loss: 0.0367821
	speed: 0.0134s/iter; left time: 108.1506s
Epoch: 6 cost time: 8.016699075698853
Epoch: 6, Steps: 570 | Train Loss: 0.0348177 Vali Loss: 0.0363659 Test Loss: 0.1205297
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0248893
	speed: 0.0446s/iter; left time: 351.3883s
	iters: 200, epoch: 7 | loss: 0.0280079
	speed: 0.0135s/iter; left time: 105.2286s
	iters: 300, epoch: 7 | loss: 0.0273204
	speed: 0.0135s/iter; left time: 103.7988s
	iters: 400, epoch: 7 | loss: 0.0482202
	speed: 0.0135s/iter; left time: 102.2849s
	iters: 500, epoch: 7 | loss: 0.0353472
	speed: 0.0135s/iter; left time: 101.0473s
Epoch: 7 cost time: 7.981110334396362
Epoch: 7, Steps: 570 | Train Loss: 0.0313630 Vali Loss: 0.0362975 Test Loss: 0.1222203
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11669544130563736, mae:0.2160900980234146
>>> MS_Raw LR=5e-4 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1069971
	speed: 0.0252s/iter; left time: 285.3428s
	iters: 200, epoch: 1 | loss: 0.2587161
	speed: 0.0135s/iter; left time: 150.9238s
	iters: 300, epoch: 1 | loss: 0.2063680
	speed: 0.0134s/iter; left time: 149.2105s
	iters: 400, epoch: 1 | loss: 0.2087482
	speed: 0.0134s/iter; left time: 147.9566s
	iters: 500, epoch: 1 | loss: 0.2114511
	speed: 0.0134s/iter; left time: 146.5623s
Epoch: 1 cost time: 8.902355909347534
Epoch: 1, Steps: 570 | Train Loss: 0.1899124 Vali Loss: 0.0503171 Test Loss: 0.1435419
Validation loss decreased (inf --> 0.050317).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1118510
	speed: 0.0457s/iter; left time: 490.5389s
	iters: 200, epoch: 2 | loss: 0.1333888
	speed: 0.0135s/iter; left time: 143.1430s
	iters: 300, epoch: 2 | loss: 0.0712786
	speed: 0.0135s/iter; left time: 142.2434s
	iters: 400, epoch: 2 | loss: 0.0988185
	speed: 0.0135s/iter; left time: 140.6275s
	iters: 500, epoch: 2 | loss: 0.1156343
	speed: 0.0135s/iter; left time: 139.1682s
Epoch: 2 cost time: 8.002100467681885
Epoch: 2, Steps: 570 | Train Loss: 0.1346016 Vali Loss: 0.0433708 Test Loss: 0.1410017
Validation loss decreased (0.050317 --> 0.043371).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0975002
	speed: 0.0449s/iter; left time: 456.5891s
	iters: 200, epoch: 3 | loss: 0.1073149
	speed: 0.0134s/iter; left time: 134.6859s
	iters: 300, epoch: 3 | loss: 0.0861029
	speed: 0.0134s/iter; left time: 133.3168s
	iters: 400, epoch: 3 | loss: 0.0734350
	speed: 0.0134s/iter; left time: 132.0306s
	iters: 500, epoch: 3 | loss: 0.0743892
	speed: 0.0134s/iter; left time: 130.6772s
Epoch: 3 cost time: 7.932413101196289
Epoch: 3, Steps: 570 | Train Loss: 0.0793540 Vali Loss: 0.0424974 Test Loss: 0.1376587
Validation loss decreased (0.043371 --> 0.042497).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0444206
	speed: 0.0452s/iter; left time: 433.0744s
	iters: 200, epoch: 4 | loss: 0.0393224
	speed: 0.0135s/iter; left time: 128.2088s
	iters: 300, epoch: 4 | loss: 0.0441419
	speed: 0.0135s/iter; left time: 126.7678s
	iters: 400, epoch: 4 | loss: 0.0433377
	speed: 0.0135s/iter; left time: 125.4577s
	iters: 500, epoch: 4 | loss: 0.0273443
	speed: 0.0140s/iter; left time: 128.5850s
Epoch: 4 cost time: 8.19377589225769
Epoch: 4, Steps: 570 | Train Loss: 0.0454741 Vali Loss: 0.0429966 Test Loss: 0.1436175
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0456207
	speed: 0.0469s/iter; left time: 422.8032s
	iters: 200, epoch: 5 | loss: 0.0484772
	speed: 0.0135s/iter; left time: 120.0527s
	iters: 300, epoch: 5 | loss: 0.0314100
	speed: 0.0135s/iter; left time: 118.7473s
	iters: 400, epoch: 5 | loss: 0.0519954
	speed: 0.0135s/iter; left time: 117.5825s
	iters: 500, epoch: 5 | loss: 0.0293121
	speed: 0.0135s/iter; left time: 116.1638s
Epoch: 5 cost time: 7.937653541564941
Epoch: 5, Steps: 570 | Train Loss: 0.0318291 Vali Loss: 0.0437204 Test Loss: 0.1449698
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0287018
	speed: 0.0445s/iter; left time: 375.7077s
	iters: 200, epoch: 6 | loss: 0.0228253
	speed: 0.0135s/iter; left time: 112.4380s
	iters: 300, epoch: 6 | loss: 0.0222545
	speed: 0.0134s/iter; left time: 110.9419s
	iters: 400, epoch: 6 | loss: 0.0427278
	speed: 0.0134s/iter; left time: 109.5717s
	iters: 500, epoch: 6 | loss: 0.0231968
	speed: 0.0135s/iter; left time: 108.3288s
Epoch: 6 cost time: 7.9236249923706055
Epoch: 6, Steps: 570 | Train Loss: 0.0262436 Vali Loss: 0.0438920 Test Loss: 0.1476728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13781242072582245, mae:0.24142491817474365
>>> MS_Raw LR=5e-4 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1986155
	speed: 0.0284s/iter; left time: 320.5140s
	iters: 200, epoch: 1 | loss: 0.1691805
	speed: 0.0163s/iter; left time: 182.8691s
	iters: 300, epoch: 1 | loss: 0.2655474
	speed: 0.0163s/iter; left time: 180.9498s
	iters: 400, epoch: 1 | loss: 0.1940346
	speed: 0.0163s/iter; left time: 179.3498s
	iters: 500, epoch: 1 | loss: 0.1390540
	speed: 0.0163s/iter; left time: 178.1806s
Epoch: 1 cost time: 10.560123682022095
Epoch: 1, Steps: 570 | Train Loss: 0.1975997 Vali Loss: 0.0505389 Test Loss: 0.1476364
Validation loss decreased (inf --> 0.050539).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2220080
	speed: 0.0521s/iter; left time: 558.8062s
	iters: 200, epoch: 2 | loss: 0.2834747
	speed: 0.0163s/iter; left time: 172.8965s
	iters: 300, epoch: 2 | loss: 0.3231107
	speed: 0.0162s/iter; left time: 170.8679s
	iters: 400, epoch: 2 | loss: 0.2974539
	speed: 0.0162s/iter; left time: 169.2385s
	iters: 500, epoch: 2 | loss: 0.2700153
	speed: 0.0163s/iter; left time: 168.1210s
Epoch: 2 cost time: 9.570971965789795
Epoch: 2, Steps: 570 | Train Loss: 0.2516783 Vali Loss: 0.0667279 Test Loss: 0.1820506
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1836330
	speed: 0.0495s/iter; left time: 502.9980s
	iters: 200, epoch: 3 | loss: 0.2148254
	speed: 0.0163s/iter; left time: 163.6878s
	iters: 300, epoch: 3 | loss: 0.3247426
	speed: 0.0163s/iter; left time: 162.1467s
	iters: 400, epoch: 3 | loss: 0.1836453
	speed: 0.0163s/iter; left time: 160.6307s
	iters: 500, epoch: 3 | loss: 0.1678694
	speed: 0.0163s/iter; left time: 158.8851s
Epoch: 3 cost time: 9.602243900299072
Epoch: 3, Steps: 570 | Train Loss: 0.2291430 Vali Loss: 0.0621862 Test Loss: 0.1663595
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2186916
	speed: 0.0493s/iter; left time: 472.5486s
	iters: 200, epoch: 4 | loss: 0.1787783
	speed: 0.0163s/iter; left time: 154.8164s
	iters: 300, epoch: 4 | loss: 0.1733173
	speed: 0.0163s/iter; left time: 153.0741s
	iters: 400, epoch: 4 | loss: 0.1957897
	speed: 0.0163s/iter; left time: 151.6864s
	iters: 500, epoch: 4 | loss: 0.1448365
	speed: 0.0163s/iter; left time: 149.8750s
Epoch: 4 cost time: 9.550341367721558
Epoch: 4, Steps: 570 | Train Loss: 0.1949281 Vali Loss: 0.0626483 Test Loss: 0.1643371
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14789031445980072, mae:0.24401988089084625
>>> MS_Raw LR=5e-4 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1967783
	speed: 0.0287s/iter; left time: 324.1472s
	iters: 200, epoch: 1 | loss: 0.0812769
	speed: 0.0168s/iter; left time: 187.9469s
	iters: 300, epoch: 1 | loss: 0.2097766
	speed: 0.0170s/iter; left time: 188.3993s
	iters: 400, epoch: 1 | loss: 0.1258427
	speed: 0.0169s/iter; left time: 186.0939s
	iters: 500, epoch: 1 | loss: 0.0920935
	speed: 0.0170s/iter; left time: 184.9608s
Epoch: 1 cost time: 10.872954607009888
Epoch: 1, Steps: 570 | Train Loss: 0.1694094 Vali Loss: 0.0414194 Test Loss: 0.1318534
Validation loss decreased (inf --> 0.041419).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1300433
	speed: 0.0517s/iter; left time: 554.4466s
	iters: 200, epoch: 2 | loss: 0.1766018
	speed: 0.0170s/iter; left time: 181.0158s
	iters: 300, epoch: 2 | loss: 0.1776148
	speed: 0.0159s/iter; left time: 167.6834s
	iters: 400, epoch: 2 | loss: 0.6121952
	speed: 0.0158s/iter; left time: 165.1094s
	iters: 500, epoch: 2 | loss: 0.2668276
	speed: 0.0158s/iter; left time: 163.7100s
Epoch: 2 cost time: 9.579361200332642
Epoch: 2, Steps: 570 | Train Loss: 0.2193054 Vali Loss: 0.0827282 Test Loss: 0.2201046
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2272870
	speed: 0.0526s/iter; left time: 534.6843s
	iters: 200, epoch: 3 | loss: 0.2946670
	speed: 0.0158s/iter; left time: 159.0965s
	iters: 300, epoch: 3 | loss: 0.1645177
	speed: 0.0158s/iter; left time: 157.6633s
	iters: 400, epoch: 3 | loss: 0.2846656
	speed: 0.0158s/iter; left time: 155.8497s
	iters: 500, epoch: 3 | loss: 0.1483205
	speed: 0.0158s/iter; left time: 154.1436s
Epoch: 3 cost time: 9.389548063278198
Epoch: 3, Steps: 570 | Train Loss: 0.2507399 Vali Loss: 0.0618857 Test Loss: 0.1737114
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1715246
	speed: 0.0487s/iter; left time: 466.7922s
	iters: 200, epoch: 4 | loss: 0.3059893
	speed: 0.0158s/iter; left time: 150.1130s
	iters: 300, epoch: 4 | loss: 0.2712645
	speed: 0.0158s/iter; left time: 148.0309s
	iters: 400, epoch: 4 | loss: 0.1277343
	speed: 0.0158s/iter; left time: 146.4117s
	iters: 500, epoch: 4 | loss: 0.2868744
	speed: 0.0158s/iter; left time: 144.9651s
Epoch: 4 cost time: 9.3187997341156
Epoch: 4, Steps: 570 | Train Loss: 0.2091032 Vali Loss: 0.0661804 Test Loss: 0.1758471
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1320623755455017, mae:0.23152689635753632
>>> MS_Raw LR=5e-4 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1846964
	speed: 0.0264s/iter; left time: 297.9813s
	iters: 200, epoch: 1 | loss: 0.1534819
	speed: 0.0147s/iter; left time: 164.1769s
	iters: 300, epoch: 1 | loss: 0.1390241
	speed: 0.0146s/iter; left time: 162.4265s
	iters: 400, epoch: 1 | loss: 0.1953725
	speed: 0.0146s/iter; left time: 161.0509s
	iters: 500, epoch: 1 | loss: 0.3213199
	speed: 0.0147s/iter; left time: 159.8669s
Epoch: 1 cost time: 9.57527780532837
Epoch: 1, Steps: 570 | Train Loss: 0.2022955 Vali Loss: 0.0596252 Test Loss: 0.1810754
Validation loss decreased (inf --> 0.059625).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3014162
	speed: 0.0480s/iter; left time: 515.5089s
	iters: 200, epoch: 2 | loss: 0.1825785
	speed: 0.0147s/iter; left time: 156.0644s
	iters: 300, epoch: 2 | loss: 0.2656878
	speed: 0.0147s/iter; left time: 154.2894s
	iters: 400, epoch: 2 | loss: 0.2396755
	speed: 0.0147s/iter; left time: 153.7419s
	iters: 500, epoch: 2 | loss: 0.3102220
	speed: 0.0147s/iter; left time: 152.0068s
Epoch: 2 cost time: 8.679274082183838
Epoch: 2, Steps: 570 | Train Loss: 0.2341447 Vali Loss: 0.0562900 Test Loss: 0.1692586
Validation loss decreased (0.059625 --> 0.056290).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2520309
	speed: 0.0492s/iter; left time: 499.9782s
	iters: 200, epoch: 3 | loss: 0.1126558
	speed: 0.0147s/iter; left time: 147.5560s
	iters: 300, epoch: 3 | loss: 0.2455842
	speed: 0.0146s/iter; left time: 145.8287s
	iters: 400, epoch: 3 | loss: 0.1633121
	speed: 0.0146s/iter; left time: 144.4584s
	iters: 500, epoch: 3 | loss: 0.1875406
	speed: 0.0146s/iter; left time: 142.9295s
Epoch: 3 cost time: 8.676074981689453
Epoch: 3, Steps: 570 | Train Loss: 0.1976280 Vali Loss: 0.0501224 Test Loss: 0.1469226
Validation loss decreased (0.056290 --> 0.050122).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1423798
	speed: 0.0489s/iter; left time: 469.3926s
	iters: 200, epoch: 4 | loss: 0.1833380
	speed: 0.0147s/iter; left time: 139.2859s
	iters: 300, epoch: 4 | loss: 0.1767692
	speed: 0.0147s/iter; left time: 137.7146s
	iters: 400, epoch: 4 | loss: 0.1392000
	speed: 0.0146s/iter; left time: 135.9776s
	iters: 500, epoch: 4 | loss: 0.1467425
	speed: 0.0146s/iter; left time: 134.5482s
Epoch: 4 cost time: 8.651200532913208
Epoch: 4, Steps: 570 | Train Loss: 0.1538924 Vali Loss: 0.0479066 Test Loss: 0.1444010
Validation loss decreased (0.050122 --> 0.047907).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0917977
	speed: 0.0486s/iter; left time: 438.4202s
	iters: 200, epoch: 5 | loss: 0.1277048
	speed: 0.0162s/iter; left time: 144.1214s
	iters: 300, epoch: 5 | loss: 0.1231754
	speed: 0.0161s/iter; left time: 142.4586s
	iters: 400, epoch: 5 | loss: 0.0834559
	speed: 0.0162s/iter; left time: 140.8520s
	iters: 500, epoch: 5 | loss: 0.1487637
	speed: 0.0161s/iter; left time: 139.2017s
Epoch: 5 cost time: 9.358419418334961
Epoch: 5, Steps: 570 | Train Loss: 0.1337128 Vali Loss: 0.0466142 Test Loss: 0.1435483
Validation loss decreased (0.047907 --> 0.046614).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1269798
	speed: 0.0497s/iter; left time: 420.2162s
	iters: 200, epoch: 6 | loss: 0.1186455
	speed: 0.0147s/iter; left time: 122.3685s
	iters: 300, epoch: 6 | loss: 0.0984075
	speed: 0.0147s/iter; left time: 120.9493s
	iters: 400, epoch: 6 | loss: 0.0881625
	speed: 0.0147s/iter; left time: 119.5195s
	iters: 500, epoch: 6 | loss: 0.1166409
	speed: 0.0147s/iter; left time: 118.0078s
Epoch: 6 cost time: 8.677679538726807
Epoch: 6, Steps: 570 | Train Loss: 0.1221631 Vali Loss: 0.0458232 Test Loss: 0.1406332
Validation loss decreased (0.046614 --> 0.045823).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1413343
	speed: 0.0484s/iter; left time: 381.2081s
	iters: 200, epoch: 7 | loss: 0.0839411
	speed: 0.0146s/iter; left time: 113.7649s
	iters: 300, epoch: 7 | loss: 0.1261159
	speed: 0.0146s/iter; left time: 112.3170s
	iters: 400, epoch: 7 | loss: 0.0824899
	speed: 0.0146s/iter; left time: 110.8543s
	iters: 500, epoch: 7 | loss: 0.1464380
	speed: 0.0146s/iter; left time: 109.3739s
Epoch: 7 cost time: 8.62876296043396
Epoch: 7, Steps: 570 | Train Loss: 0.1152028 Vali Loss: 0.0455213 Test Loss: 0.1399625
Validation loss decreased (0.045823 --> 0.045521).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0983356
	speed: 0.0483s/iter; left time: 353.2044s
	iters: 200, epoch: 8 | loss: 0.1660734
	speed: 0.0162s/iter; left time: 116.8149s
	iters: 300, epoch: 8 | loss: 0.0982681
	speed: 0.0162s/iter; left time: 115.3314s
	iters: 400, epoch: 8 | loss: 0.1109750
	speed: 0.0162s/iter; left time: 113.4144s
	iters: 500, epoch: 8 | loss: 0.0811666
	speed: 0.0162s/iter; left time: 111.8502s
Epoch: 8 cost time: 9.533292293548584
Epoch: 8, Steps: 570 | Train Loss: 0.1107535 Vali Loss: 0.0446388 Test Loss: 0.1394486
Validation loss decreased (0.045521 --> 0.044639).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0843178
	speed: 0.0488s/iter; left time: 328.7215s
	iters: 200, epoch: 9 | loss: 0.0957296
	speed: 0.0162s/iter; left time: 107.3061s
	iters: 300, epoch: 9 | loss: 0.0958310
	speed: 0.0162s/iter; left time: 105.7834s
	iters: 400, epoch: 9 | loss: 0.0913657
	speed: 0.0162s/iter; left time: 104.0782s
	iters: 500, epoch: 9 | loss: 0.1282018
	speed: 0.0161s/iter; left time: 102.3765s
Epoch: 9 cost time: 9.472947835922241
Epoch: 9, Steps: 570 | Train Loss: 0.1083913 Vali Loss: 0.0448575 Test Loss: 0.1397041
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1445305
	speed: 0.0475s/iter; left time: 293.3902s
	iters: 200, epoch: 10 | loss: 0.1169368
	speed: 0.0146s/iter; left time: 88.6225s
	iters: 300, epoch: 10 | loss: 0.0864425
	speed: 0.0146s/iter; left time: 87.1776s
	iters: 400, epoch: 10 | loss: 0.1313425
	speed: 0.0146s/iter; left time: 86.0074s
	iters: 500, epoch: 10 | loss: 0.1608877
	speed: 0.0146s/iter; left time: 84.5127s
Epoch: 10 cost time: 8.590143203735352
Epoch: 10, Steps: 570 | Train Loss: 0.1071333 Vali Loss: 0.0449487 Test Loss: 0.1401038
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1228852
	speed: 0.0457s/iter; left time: 255.9025s
	iters: 200, epoch: 11 | loss: 0.0852268
	speed: 0.0147s/iter; left time: 80.7717s
	iters: 300, epoch: 11 | loss: 0.0976405
	speed: 0.0152s/iter; left time: 82.1484s
	iters: 400, epoch: 11 | loss: 0.1279954
	speed: 0.0156s/iter; left time: 82.8953s
	iters: 500, epoch: 11 | loss: 0.1509469
	speed: 0.0147s/iter; left time: 76.3396s
Epoch: 11 cost time: 8.7776620388031
Epoch: 11, Steps: 570 | Train Loss: 0.1064138 Vali Loss: 0.0450237 Test Loss: 0.1398980
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13961860537528992, mae:0.2440221607685089
>>> MS_Raw LR=5e-4 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1424365
	speed: 0.0296s/iter; left time: 333.9600s
	iters: 200, epoch: 1 | loss: 0.1840478
	speed: 0.0175s/iter; left time: 196.1879s
	iters: 300, epoch: 1 | loss: 0.2390462
	speed: 0.0175s/iter; left time: 194.3617s
	iters: 400, epoch: 1 | loss: 0.1257376
	speed: 0.0175s/iter; left time: 192.1510s
	iters: 500, epoch: 1 | loss: 0.1427562
	speed: 0.0175s/iter; left time: 190.2529s
Epoch: 1 cost time: 11.224066495895386
Epoch: 1, Steps: 570 | Train Loss: 0.1878913 Vali Loss: 0.0468647 Test Loss: 0.1412132
Validation loss decreased (inf --> 0.046865).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2610076
	speed: 0.0561s/iter; left time: 602.2445s
	iters: 200, epoch: 2 | loss: 0.1107580
	speed: 0.0176s/iter; left time: 186.5854s
	iters: 300, epoch: 2 | loss: 0.1036385
	speed: 0.0175s/iter; left time: 184.6909s
	iters: 400, epoch: 2 | loss: 0.1070925
	speed: 0.0175s/iter; left time: 182.8272s
	iters: 500, epoch: 2 | loss: 0.1219436
	speed: 0.0176s/iter; left time: 181.4980s
Epoch: 2 cost time: 10.338179349899292
Epoch: 2, Steps: 570 | Train Loss: 0.1391301 Vali Loss: 0.0438123 Test Loss: 0.1367771
Validation loss decreased (0.046865 --> 0.043812).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0830769
	speed: 0.0571s/iter; left time: 580.0272s
	iters: 200, epoch: 3 | loss: 0.0651449
	speed: 0.0198s/iter; left time: 198.7563s
	iters: 300, epoch: 3 | loss: 0.0848362
	speed: 0.0197s/iter; left time: 196.3616s
	iters: 400, epoch: 3 | loss: 0.0720099
	speed: 0.0197s/iter; left time: 193.8371s
	iters: 500, epoch: 3 | loss: 0.0553302
	speed: 0.0196s/iter; left time: 191.1830s
Epoch: 3 cost time: 11.510072231292725
Epoch: 3, Steps: 570 | Train Loss: 0.0927919 Vali Loss: 0.0406958 Test Loss: 0.1434521
Validation loss decreased (0.043812 --> 0.040696).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0647112
	speed: 0.0560s/iter; left time: 537.2615s
	iters: 200, epoch: 4 | loss: 0.0716239
	speed: 0.0175s/iter; left time: 165.9584s
	iters: 300, epoch: 4 | loss: 0.0661048
	speed: 0.0175s/iter; left time: 164.3468s
	iters: 400, epoch: 4 | loss: 0.0359052
	speed: 0.0175s/iter; left time: 162.5843s
	iters: 500, epoch: 4 | loss: 0.0596870
	speed: 0.0175s/iter; left time: 160.7243s
Epoch: 4 cost time: 10.270425081253052
Epoch: 4, Steps: 570 | Train Loss: 0.0583398 Vali Loss: 0.0424002 Test Loss: 0.1405669
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0493537
	speed: 0.0534s/iter; left time: 481.6764s
	iters: 200, epoch: 5 | loss: 0.0440921
	speed: 0.0174s/iter; left time: 154.9869s
	iters: 300, epoch: 5 | loss: 0.0384487
	speed: 0.0174s/iter; left time: 153.2431s
	iters: 400, epoch: 5 | loss: 0.0319154
	speed: 0.0174s/iter; left time: 151.4779s
	iters: 500, epoch: 5 | loss: 0.0568911
	speed: 0.0174s/iter; left time: 149.9089s
Epoch: 5 cost time: 10.18605899810791
Epoch: 5, Steps: 570 | Train Loss: 0.0422725 Vali Loss: 0.0417912 Test Loss: 0.1395553
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0277847
	speed: 0.0531s/iter; left time: 448.9339s
	iters: 200, epoch: 6 | loss: 0.0349614
	speed: 0.0174s/iter; left time: 145.5126s
	iters: 300, epoch: 6 | loss: 0.0368796
	speed: 0.0174s/iter; left time: 143.8670s
	iters: 400, epoch: 6 | loss: 0.0483236
	speed: 0.0174s/iter; left time: 141.9815s
	iters: 500, epoch: 6 | loss: 0.0325147
	speed: 0.0174s/iter; left time: 140.0629s
Epoch: 6 cost time: 10.205065965652466
Epoch: 6, Steps: 570 | Train Loss: 0.0343979 Vali Loss: 0.0434447 Test Loss: 0.1454348
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14360164105892181, mae:0.24396653473377228
>>> MS_Raw LR=5e-4 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3013273
	speed: 0.0313s/iter; left time: 353.9593s
	iters: 200, epoch: 1 | loss: 0.1627599
	speed: 0.0198s/iter; left time: 221.7884s
	iters: 300, epoch: 1 | loss: 0.1636733
	speed: 0.0198s/iter; left time: 219.5197s
	iters: 400, epoch: 1 | loss: 0.1275357
	speed: 0.0198s/iter; left time: 217.8824s
	iters: 500, epoch: 1 | loss: 0.1798341
	speed: 0.0198s/iter; left time: 215.5872s
Epoch: 1 cost time: 12.388570070266724
Epoch: 1, Steps: 570 | Train Loss: 0.1556122 Vali Loss: 0.0425841 Test Loss: 0.1366059
Validation loss decreased (inf --> 0.042584).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1080536
	speed: 0.0564s/iter; left time: 605.2186s
	iters: 200, epoch: 2 | loss: 0.1725593
	speed: 0.0175s/iter; left time: 185.6190s
	iters: 300, epoch: 2 | loss: 0.1873654
	speed: 0.0174s/iter; left time: 183.2060s
	iters: 400, epoch: 2 | loss: 0.1795883
	speed: 0.0174s/iter; left time: 181.6109s
	iters: 500, epoch: 2 | loss: 0.1130972
	speed: 0.0174s/iter; left time: 179.2441s
Epoch: 2 cost time: 10.213126182556152
Epoch: 2, Steps: 570 | Train Loss: 0.1257417 Vali Loss: 0.0436001 Test Loss: 0.1318278
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0872726
	speed: 0.0541s/iter; left time: 549.3406s
	iters: 200, epoch: 3 | loss: 0.0909489
	speed: 0.0175s/iter; left time: 175.9536s
	iters: 300, epoch: 3 | loss: 0.1098259
	speed: 0.0174s/iter; left time: 173.8154s
	iters: 400, epoch: 3 | loss: 0.0617533
	speed: 0.0174s/iter; left time: 171.9256s
	iters: 500, epoch: 3 | loss: 0.0701032
	speed: 0.0175s/iter; left time: 170.6534s
Epoch: 3 cost time: 10.244900703430176
Epoch: 3, Steps: 570 | Train Loss: 0.0934521 Vali Loss: 0.0351826 Test Loss: 0.1203531
Validation loss decreased (0.042584 --> 0.035183).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0649448
	speed: 0.0592s/iter; left time: 567.5694s
	iters: 200, epoch: 4 | loss: 0.0549003
	speed: 0.0199s/iter; left time: 188.6412s
	iters: 300, epoch: 4 | loss: 0.0712037
	speed: 0.0175s/iter; left time: 164.3332s
	iters: 400, epoch: 4 | loss: 0.0707857
	speed: 0.0180s/iter; left time: 167.5994s
	iters: 500, epoch: 4 | loss: 0.0471515
	speed: 0.0174s/iter; left time: 160.0498s
Epoch: 4 cost time: 10.782225847244263
Epoch: 4, Steps: 570 | Train Loss: 0.0624750 Vali Loss: 0.0335348 Test Loss: 0.1206524
Validation loss decreased (0.035183 --> 0.033535).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0518756
	speed: 0.0563s/iter; left time: 507.9216s
	iters: 200, epoch: 5 | loss: 0.0462244
	speed: 0.0174s/iter; left time: 154.9216s
	iters: 300, epoch: 5 | loss: 0.0481729
	speed: 0.0174s/iter; left time: 153.1636s
	iters: 400, epoch: 5 | loss: 0.0416372
	speed: 0.0174s/iter; left time: 151.4363s
	iters: 500, epoch: 5 | loss: 0.0582077
	speed: 0.0173s/iter; left time: 148.9714s
Epoch: 5 cost time: 10.343491077423096
Epoch: 5, Steps: 570 | Train Loss: 0.0454446 Vali Loss: 0.0346301 Test Loss: 0.1202264
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0512787
	speed: 0.0559s/iter; left time: 472.7432s
	iters: 200, epoch: 6 | loss: 0.0321706
	speed: 0.0197s/iter; left time: 164.7599s
	iters: 300, epoch: 6 | loss: 0.0402475
	speed: 0.0192s/iter; left time: 158.6555s
	iters: 400, epoch: 6 | loss: 0.0389622
	speed: 0.0173s/iter; left time: 141.1665s
	iters: 500, epoch: 6 | loss: 0.0262756
	speed: 0.0173s/iter; left time: 139.1661s
Epoch: 6 cost time: 10.805414915084839
Epoch: 6, Steps: 570 | Train Loss: 0.0372056 Vali Loss: 0.0347524 Test Loss: 0.1218830
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0415928
	speed: 0.0538s/iter; left time: 423.6849s
	iters: 200, epoch: 7 | loss: 0.0410634
	speed: 0.0172s/iter; left time: 134.0544s
	iters: 300, epoch: 7 | loss: 0.0310007
	speed: 0.0172s/iter; left time: 132.3705s
	iters: 400, epoch: 7 | loss: 0.0346273
	speed: 0.0172s/iter; left time: 130.6105s
	iters: 500, epoch: 7 | loss: 0.0262612
	speed: 0.0172s/iter; left time: 128.8974s
Epoch: 7 cost time: 10.181587219238281
Epoch: 7, Steps: 570 | Train Loss: 0.0329937 Vali Loss: 0.0353262 Test Loss: 0.1226116
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12082037329673767, mae:0.21284867823123932
>>> MS_Raw LR=5e-4 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2177885
	speed: 0.0319s/iter; left time: 360.2608s
	iters: 200, epoch: 1 | loss: 0.1740898
	speed: 0.0194s/iter; left time: 217.4379s
	iters: 300, epoch: 1 | loss: 0.2318988
	speed: 0.0195s/iter; left time: 216.0353s
	iters: 400, epoch: 1 | loss: 0.1778409
	speed: 0.0194s/iter; left time: 213.4628s
	iters: 500, epoch: 1 | loss: 0.2104654
	speed: 0.0195s/iter; left time: 212.4441s
Epoch: 1 cost time: 12.38361930847168
Epoch: 1, Steps: 570 | Train Loss: 0.1894304 Vali Loss: 0.0450520 Test Loss: 0.1393649
Validation loss decreased (inf --> 0.045052).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2218399
	speed: 0.0600s/iter; left time: 643.9170s
	iters: 200, epoch: 2 | loss: 0.2031770
	speed: 0.0200s/iter; left time: 213.0550s
	iters: 300, epoch: 2 | loss: 0.2917352
	speed: 0.0199s/iter; left time: 209.7367s
	iters: 400, epoch: 2 | loss: 0.1115078
	speed: 0.0199s/iter; left time: 207.8540s
	iters: 500, epoch: 2 | loss: 0.0887230
	speed: 0.0200s/iter; left time: 206.7711s
Epoch: 2 cost time: 11.701354503631592
Epoch: 2, Steps: 570 | Train Loss: 0.1400354 Vali Loss: 0.0453597 Test Loss: 0.1389147
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0976101
	speed: 0.0594s/iter; left time: 603.4186s
	iters: 200, epoch: 3 | loss: 0.0790695
	speed: 0.0200s/iter; left time: 201.5307s
	iters: 300, epoch: 3 | loss: 0.0755557
	speed: 0.0201s/iter; left time: 199.7391s
	iters: 400, epoch: 3 | loss: 0.0531154
	speed: 0.0200s/iter; left time: 197.3874s
	iters: 500, epoch: 3 | loss: 0.0669597
	speed: 0.0200s/iter; left time: 195.3571s
Epoch: 3 cost time: 11.690524101257324
Epoch: 3, Steps: 570 | Train Loss: 0.0817688 Vali Loss: 0.0419895 Test Loss: 0.1375994
Validation loss decreased (0.045052 --> 0.041990).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0431753
	speed: 0.0587s/iter; left time: 563.3460s
	iters: 200, epoch: 4 | loss: 0.0574122
	speed: 0.0175s/iter; left time: 166.3606s
	iters: 300, epoch: 4 | loss: 0.0522037
	speed: 0.0172s/iter; left time: 161.3918s
	iters: 400, epoch: 4 | loss: 0.0496517
	speed: 0.0172s/iter; left time: 159.7452s
	iters: 500, epoch: 4 | loss: 0.0428037
	speed: 0.0172s/iter; left time: 157.8391s
Epoch: 4 cost time: 10.398092031478882
Epoch: 4, Steps: 570 | Train Loss: 0.0467967 Vali Loss: 0.0405782 Test Loss: 0.1369759
Validation loss decreased (0.041990 --> 0.040578).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0329710
	speed: 0.0565s/iter; left time: 509.5998s
	iters: 200, epoch: 5 | loss: 0.0373534
	speed: 0.0191s/iter; left time: 170.2964s
	iters: 300, epoch: 5 | loss: 0.0254652
	speed: 0.0172s/iter; left time: 151.6731s
	iters: 400, epoch: 5 | loss: 0.0320666
	speed: 0.0172s/iter; left time: 149.8236s
	iters: 500, epoch: 5 | loss: 0.0248615
	speed: 0.0172s/iter; left time: 148.1404s
Epoch: 5 cost time: 10.537740468978882
Epoch: 5, Steps: 570 | Train Loss: 0.0323576 Vali Loss: 0.0408936 Test Loss: 0.1396430
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0270176
	speed: 0.0525s/iter; left time: 443.3844s
	iters: 200, epoch: 6 | loss: 0.0235493
	speed: 0.0181s/iter; left time: 151.1673s
	iters: 300, epoch: 6 | loss: 0.0301357
	speed: 0.0198s/iter; left time: 163.6814s
	iters: 400, epoch: 6 | loss: 0.0253702
	speed: 0.0198s/iter; left time: 161.7081s
	iters: 500, epoch: 6 | loss: 0.0251508
	speed: 0.0189s/iter; left time: 151.8169s
Epoch: 6 cost time: 10.84366250038147
Epoch: 6, Steps: 570 | Train Loss: 0.0259659 Vali Loss: 0.0409562 Test Loss: 0.1410119
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0220625
	speed: 0.0560s/iter; left time: 441.6982s
	iters: 200, epoch: 7 | loss: 0.0194717
	speed: 0.0172s/iter; left time: 133.5881s
	iters: 300, epoch: 7 | loss: 0.0231270
	speed: 0.0171s/iter; left time: 131.7153s
	iters: 400, epoch: 7 | loss: 0.0367678
	speed: 0.0171s/iter; left time: 129.8075s
	iters: 500, epoch: 7 | loss: 0.0201000
	speed: 0.0172s/iter; left time: 128.4964s
Epoch: 7 cost time: 10.341521739959717
Epoch: 7, Steps: 570 | Train Loss: 0.0229394 Vali Loss: 0.0413790 Test Loss: 0.1412562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13710694015026093, mae:0.2393602728843689
>>> MS_Raw LR=5e-4 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1982598
	speed: 0.0331s/iter; left time: 373.9468s
	iters: 200, epoch: 1 | loss: 0.1722663
	speed: 0.0214s/iter; left time: 239.3578s
	iters: 300, epoch: 1 | loss: 0.2368596
	speed: 0.0213s/iter; left time: 236.9776s
	iters: 400, epoch: 1 | loss: 0.2784756
	speed: 0.0214s/iter; left time: 235.6703s
	iters: 500, epoch: 1 | loss: 0.2624359
	speed: 0.0214s/iter; left time: 232.9734s
Epoch: 1 cost time: 13.411997318267822
Epoch: 1, Steps: 570 | Train Loss: 0.2215046 Vali Loss: 0.0689446 Test Loss: 0.2047751
Validation loss decreased (inf --> 0.068945).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3135594
	speed: 0.0617s/iter; left time: 662.2118s
	iters: 200, epoch: 2 | loss: 0.2461600
	speed: 0.0213s/iter; left time: 226.2808s
	iters: 300, epoch: 2 | loss: 0.1640294
	speed: 0.0213s/iter; left time: 224.4112s
	iters: 400, epoch: 2 | loss: 0.2334460
	speed: 0.0213s/iter; left time: 222.0637s
	iters: 500, epoch: 2 | loss: 0.1787507
	speed: 0.0213s/iter; left time: 219.9565s
Epoch: 2 cost time: 12.448729991912842
Epoch: 2, Steps: 570 | Train Loss: 0.2409333 Vali Loss: 0.0579337 Test Loss: 0.1650611
Validation loss decreased (0.068945 --> 0.057934).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3445709
	speed: 0.0619s/iter; left time: 628.6165s
	iters: 200, epoch: 3 | loss: 0.1344387
	speed: 0.0213s/iter; left time: 214.2300s
	iters: 300, epoch: 3 | loss: 0.1870665
	speed: 0.0213s/iter; left time: 212.2524s
	iters: 400, epoch: 3 | loss: 0.1502970
	speed: 0.0213s/iter; left time: 209.8027s
	iters: 500, epoch: 3 | loss: 0.1235990
	speed: 0.0213s/iter; left time: 207.6782s
Epoch: 3 cost time: 12.439862251281738
Epoch: 3, Steps: 570 | Train Loss: 0.1725269 Vali Loss: 0.0474227 Test Loss: 0.1467401
Validation loss decreased (0.057934 --> 0.047423).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1178306
	speed: 0.0613s/iter; left time: 587.4833s
	iters: 200, epoch: 4 | loss: 0.1037992
	speed: 0.0213s/iter; left time: 202.2184s
	iters: 300, epoch: 4 | loss: 0.1877244
	speed: 0.0213s/iter; left time: 199.8951s
	iters: 400, epoch: 4 | loss: 0.1446683
	speed: 0.0213s/iter; left time: 197.4359s
	iters: 500, epoch: 4 | loss: 0.1847490
	speed: 0.0213s/iter; left time: 195.5648s
Epoch: 4 cost time: 12.421838521957397
Epoch: 4, Steps: 570 | Train Loss: 0.1489754 Vali Loss: 0.0459652 Test Loss: 0.1424586
Validation loss decreased (0.047423 --> 0.045965).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1684721
	speed: 0.0629s/iter; left time: 567.4356s
	iters: 200, epoch: 5 | loss: 0.2174387
	speed: 0.0214s/iter; left time: 191.0922s
	iters: 300, epoch: 5 | loss: 0.1022878
	speed: 0.0214s/iter; left time: 189.0263s
	iters: 400, epoch: 5 | loss: 0.1460482
	speed: 0.0214s/iter; left time: 186.7844s
	iters: 500, epoch: 5 | loss: 0.1213383
	speed: 0.0214s/iter; left time: 184.6724s
Epoch: 5 cost time: 12.524340391159058
Epoch: 5, Steps: 570 | Train Loss: 0.1338308 Vali Loss: 0.0453069 Test Loss: 0.1409828
Validation loss decreased (0.045965 --> 0.045307).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1173596
	speed: 0.0627s/iter; left time: 530.2517s
	iters: 200, epoch: 6 | loss: 0.1838098
	speed: 0.0213s/iter; left time: 178.2490s
	iters: 300, epoch: 6 | loss: 0.1131455
	speed: 0.0213s/iter; left time: 175.8598s
	iters: 400, epoch: 6 | loss: 0.0865408
	speed: 0.0213s/iter; left time: 173.5826s
	iters: 500, epoch: 6 | loss: 0.1666597
	speed: 0.0213s/iter; left time: 171.7730s
Epoch: 6 cost time: 12.474158525466919
Epoch: 6, Steps: 570 | Train Loss: 0.1246720 Vali Loss: 0.0451699 Test Loss: 0.1443853
Validation loss decreased (0.045307 --> 0.045170).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1408811
	speed: 0.0625s/iter; left time: 492.4047s
	iters: 200, epoch: 7 | loss: 0.1244936
	speed: 0.0214s/iter; left time: 166.2050s
	iters: 300, epoch: 7 | loss: 0.1025622
	speed: 0.0213s/iter; left time: 163.8615s
	iters: 400, epoch: 7 | loss: 0.1524026
	speed: 0.0213s/iter; left time: 161.7027s
	iters: 500, epoch: 7 | loss: 0.1064116
	speed: 0.0214s/iter; left time: 159.8395s
Epoch: 7 cost time: 12.454524040222168
Epoch: 7, Steps: 570 | Train Loss: 0.1183561 Vali Loss: 0.0456586 Test Loss: 0.1454745
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1128823
	speed: 0.0605s/iter; left time: 442.2694s
	iters: 200, epoch: 8 | loss: 0.1403389
	speed: 0.0213s/iter; left time: 153.4654s
	iters: 300, epoch: 8 | loss: 0.0930431
	speed: 0.0213s/iter; left time: 151.3363s
	iters: 400, epoch: 8 | loss: 0.0984493
	speed: 0.0213s/iter; left time: 149.1713s
	iters: 500, epoch: 8 | loss: 0.0983002
	speed: 0.0213s/iter; left time: 147.2181s
Epoch: 8 cost time: 12.393674373626709
Epoch: 8, Steps: 570 | Train Loss: 0.1149548 Vali Loss: 0.0459172 Test Loss: 0.1456573
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1132303
	speed: 0.0601s/iter; left time: 405.2208s
	iters: 200, epoch: 9 | loss: 0.1282349
	speed: 0.0213s/iter; left time: 141.5247s
	iters: 300, epoch: 9 | loss: 0.1326363
	speed: 0.0213s/iter; left time: 139.4407s
	iters: 400, epoch: 9 | loss: 0.0945258
	speed: 0.0213s/iter; left time: 137.2066s
	iters: 500, epoch: 9 | loss: 0.1243167
	speed: 0.0213s/iter; left time: 135.1084s
Epoch: 9 cost time: 12.41371202468872
Epoch: 9, Steps: 570 | Train Loss: 0.1132426 Vali Loss: 0.0457194 Test Loss: 0.1453414
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14455336332321167, mae:0.23860737681388855
>>> MS_Raw LR=5e-4 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1611827
	speed: 0.0323s/iter; left time: 364.9353s
	iters: 200, epoch: 1 | loss: 0.0880886
	speed: 0.0206s/iter; left time: 230.3260s
	iters: 300, epoch: 1 | loss: 0.1551008
	speed: 0.0206s/iter; left time: 228.2704s
	iters: 400, epoch: 1 | loss: 0.1174971
	speed: 0.0206s/iter; left time: 226.7934s
	iters: 500, epoch: 1 | loss: 0.1570380
	speed: 0.0206s/iter; left time: 224.3838s
Epoch: 1 cost time: 12.958658695220947
Epoch: 1, Steps: 570 | Train Loss: 0.1819967 Vali Loss: 0.0417195 Test Loss: 0.1302326
Validation loss decreased (inf --> 0.041720).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2005797
	speed: 0.0620s/iter; left time: 665.0090s
	iters: 200, epoch: 2 | loss: 0.1317277
	speed: 0.0221s/iter; left time: 234.6929s
	iters: 300, epoch: 2 | loss: 0.2992740
	speed: 0.0205s/iter; left time: 216.3010s
	iters: 400, epoch: 2 | loss: 0.2557242
	speed: 0.0206s/iter; left time: 214.4293s
	iters: 500, epoch: 2 | loss: 0.1844640
	speed: 0.0205s/iter; left time: 212.2026s
Epoch: 2 cost time: 12.207678079605103
Epoch: 2, Steps: 570 | Train Loss: 0.2159472 Vali Loss: 0.0691888 Test Loss: 0.2015038
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1917845
	speed: 0.0597s/iter; left time: 606.2384s
	iters: 200, epoch: 3 | loss: 0.1939210
	speed: 0.0206s/iter; left time: 207.2058s
	iters: 300, epoch: 3 | loss: 0.1543978
	speed: 0.0205s/iter; left time: 204.4907s
	iters: 400, epoch: 3 | loss: 0.1578405
	speed: 0.0205s/iter; left time: 202.5005s
	iters: 500, epoch: 3 | loss: 0.1485855
	speed: 0.0205s/iter; left time: 200.4367s
Epoch: 3 cost time: 11.99506664276123
Epoch: 3, Steps: 570 | Train Loss: 0.2254620 Vali Loss: 0.0597600 Test Loss: 0.1643411
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1238583
	speed: 0.0588s/iter; left time: 564.1992s
	iters: 200, epoch: 4 | loss: 0.1780287
	speed: 0.0206s/iter; left time: 195.7397s
	iters: 300, epoch: 4 | loss: 0.1466343
	speed: 0.0206s/iter; left time: 193.6528s
	iters: 400, epoch: 4 | loss: 0.2122630
	speed: 0.0206s/iter; left time: 191.7420s
	iters: 500, epoch: 4 | loss: 0.1696354
	speed: 0.0206s/iter; left time: 189.6530s
Epoch: 4 cost time: 12.029236078262329
Epoch: 4, Steps: 570 | Train Loss: 0.1947377 Vali Loss: 0.0546327 Test Loss: 0.1529316
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13044115900993347, mae:0.23281407356262207
>>> MS_Raw LR=5e-4 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2434345
	speed: 0.0329s/iter; left time: 372.1069s
	iters: 200, epoch: 1 | loss: 0.1531063
	speed: 0.0204s/iter; left time: 228.7474s
	iters: 300, epoch: 1 | loss: 0.2530334
	speed: 0.0190s/iter; left time: 211.1459s
	iters: 400, epoch: 1 | loss: 0.2281839
	speed: 0.0189s/iter; left time: 208.3233s
	iters: 500, epoch: 1 | loss: 0.2358771
	speed: 0.0189s/iter; left time: 206.1420s
Epoch: 1 cost time: 12.400996923446655
Epoch: 1, Steps: 570 | Train Loss: 0.2170983 Vali Loss: 0.0559171 Test Loss: 0.1756478
Validation loss decreased (inf --> 0.055917).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1163736
	speed: 0.0596s/iter; left time: 639.7876s
	iters: 200, epoch: 2 | loss: 0.4850007
	speed: 0.0209s/iter; left time: 222.4883s
	iters: 300, epoch: 2 | loss: 0.2708116
	speed: 0.0209s/iter; left time: 220.0722s
	iters: 400, epoch: 2 | loss: 0.1452087
	speed: 0.0209s/iter; left time: 218.1642s
	iters: 500, epoch: 2 | loss: 0.1954087
	speed: 0.0209s/iter; left time: 215.9434s
Epoch: 2 cost time: 12.243374824523926
Epoch: 2, Steps: 570 | Train Loss: 0.2521133 Vali Loss: 0.0596861 Test Loss: 0.1777243
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1769210
	speed: 0.0584s/iter; left time: 593.6826s
	iters: 200, epoch: 3 | loss: 0.1579297
	speed: 0.0190s/iter; left time: 191.5663s
	iters: 300, epoch: 3 | loss: 0.2444570
	speed: 0.0191s/iter; left time: 189.7829s
	iters: 400, epoch: 3 | loss: 0.1686455
	speed: 0.0190s/iter; left time: 187.5028s
	iters: 500, epoch: 3 | loss: 0.2149357
	speed: 0.0190s/iter; left time: 185.4611s
Epoch: 3 cost time: 11.193714618682861
Epoch: 3, Steps: 570 | Train Loss: 0.2108717 Vali Loss: 0.0600512 Test Loss: 0.1710273
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1616878
	speed: 0.0578s/iter; left time: 554.4199s
	iters: 200, epoch: 4 | loss: 0.2954238
	speed: 0.0209s/iter; left time: 198.4853s
	iters: 300, epoch: 4 | loss: 0.1252136
	speed: 0.0209s/iter; left time: 196.2291s
	iters: 400, epoch: 4 | loss: 0.1872400
	speed: 0.0209s/iter; left time: 194.3500s
	iters: 500, epoch: 4 | loss: 0.1753382
	speed: 0.0192s/iter; left time: 176.2106s
Epoch: 4 cost time: 11.871518850326538
Epoch: 4, Steps: 570 | Train Loss: 0.1836865 Vali Loss: 0.0583106 Test Loss: 0.1626222
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17591072618961334, mae:0.27432191371917725
>>> MS_Raw LR=5e-4 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1875591
	speed: 0.0238s/iter; left time: 268.6954s
	iters: 200, epoch: 1 | loss: 0.1685902
	speed: 0.0105s/iter; left time: 117.8060s
	iters: 300, epoch: 1 | loss: 0.2426253
	speed: 0.0105s/iter; left time: 117.0881s
	iters: 400, epoch: 1 | loss: 0.2055227
	speed: 0.0105s/iter; left time: 115.6823s
	iters: 500, epoch: 1 | loss: 0.1781254
	speed: 0.0105s/iter; left time: 114.8524s
Epoch: 1 cost time: 7.3765788078308105
Epoch: 1, Steps: 570 | Train Loss: 0.2129296 Vali Loss: 0.0461688 Test Loss: 0.1384224
Validation loss decreased (inf --> 0.046169).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2534581
	speed: 0.0370s/iter; left time: 396.7761s
	iters: 200, epoch: 2 | loss: 0.2095187
	speed: 0.0106s/iter; left time: 112.8679s
	iters: 300, epoch: 2 | loss: 0.1648936
	speed: 0.0106s/iter; left time: 111.8617s
	iters: 400, epoch: 2 | loss: 0.1565098
	speed: 0.0106s/iter; left time: 110.5322s
	iters: 500, epoch: 2 | loss: 0.1552203
	speed: 0.0106s/iter; left time: 109.4668s
Epoch: 2 cost time: 6.358527660369873
Epoch: 2, Steps: 570 | Train Loss: 0.1706752 Vali Loss: 0.0441416 Test Loss: 0.1367652
Validation loss decreased (0.046169 --> 0.044142).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1195780
	speed: 0.0371s/iter; left time: 377.1770s
	iters: 200, epoch: 3 | loss: 0.1630878
	speed: 0.0106s/iter; left time: 106.1982s
	iters: 300, epoch: 3 | loss: 0.1316595
	speed: 0.0106s/iter; left time: 105.5377s
	iters: 400, epoch: 3 | loss: 0.1441677
	speed: 0.0106s/iter; left time: 104.6693s
	iters: 500, epoch: 3 | loss: 0.1832184
	speed: 0.0105s/iter; left time: 102.4414s
Epoch: 3 cost time: 6.314462184906006
Epoch: 3, Steps: 570 | Train Loss: 0.1405180 Vali Loss: 0.0383746 Test Loss: 0.1244795
Validation loss decreased (0.044142 --> 0.038375).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1192791
	speed: 0.0386s/iter; left time: 370.3282s
	iters: 200, epoch: 4 | loss: 0.0985092
	speed: 0.0118s/iter; left time: 112.1530s
	iters: 300, epoch: 4 | loss: 0.1505321
	speed: 0.0118s/iter; left time: 111.1129s
	iters: 400, epoch: 4 | loss: 0.1254500
	speed: 0.0118s/iter; left time: 109.9099s
	iters: 500, epoch: 4 | loss: 0.1224056
	speed: 0.0118s/iter; left time: 108.6898s
Epoch: 4 cost time: 6.926439046859741
Epoch: 4, Steps: 570 | Train Loss: 0.1215223 Vali Loss: 0.0378357 Test Loss: 0.1281882
Validation loss decreased (0.038375 --> 0.037836).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1180496
	speed: 0.0405s/iter; left time: 365.1979s
	iters: 200, epoch: 5 | loss: 0.1264121
	speed: 0.0106s/iter; left time: 94.2317s
	iters: 300, epoch: 5 | loss: 0.0851760
	speed: 0.0106s/iter; left time: 93.2229s
	iters: 400, epoch: 5 | loss: 0.1103657
	speed: 0.0106s/iter; left time: 92.4830s
	iters: 500, epoch: 5 | loss: 0.1040657
	speed: 0.0106s/iter; left time: 91.0538s
Epoch: 5 cost time: 6.384679555892944
Epoch: 5, Steps: 570 | Train Loss: 0.1098918 Vali Loss: 0.0366639 Test Loss: 0.1306551
Validation loss decreased (0.037836 --> 0.036664).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0982700
	speed: 0.0380s/iter; left time: 321.0100s
	iters: 200, epoch: 6 | loss: 0.1011713
	speed: 0.0118s/iter; left time: 98.2855s
	iters: 300, epoch: 6 | loss: 0.1064663
	speed: 0.0118s/iter; left time: 97.2462s
	iters: 400, epoch: 6 | loss: 0.1059360
	speed: 0.0118s/iter; left time: 96.0308s
	iters: 500, epoch: 6 | loss: 0.1032415
	speed: 0.0118s/iter; left time: 94.8176s
Epoch: 6 cost time: 6.998813629150391
Epoch: 6, Steps: 570 | Train Loss: 0.1038395 Vali Loss: 0.0361007 Test Loss: 0.1349440
Validation loss decreased (0.036664 --> 0.036101).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1149267
	speed: 0.0390s/iter; left time: 307.7495s
	iters: 200, epoch: 7 | loss: 0.1476670
	speed: 0.0104s/iter; left time: 81.2041s
	iters: 300, epoch: 7 | loss: 0.0790868
	speed: 0.0104s/iter; left time: 80.0617s
	iters: 400, epoch: 7 | loss: 0.0798678
	speed: 0.0104s/iter; left time: 79.1480s
	iters: 500, epoch: 7 | loss: 0.1045000
	speed: 0.0104s/iter; left time: 78.0774s
Epoch: 7 cost time: 6.231562376022339
Epoch: 7, Steps: 570 | Train Loss: 0.1021100 Vali Loss: 0.0367107 Test Loss: 0.1336253
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0942366
	speed: 0.0358s/iter; left time: 261.8498s
	iters: 200, epoch: 8 | loss: 0.0988189
	speed: 0.0105s/iter; left time: 75.5320s
	iters: 300, epoch: 8 | loss: 0.1260353
	speed: 0.0104s/iter; left time: 74.3000s
	iters: 400, epoch: 8 | loss: 0.1617311
	speed: 0.0105s/iter; left time: 73.4524s
	iters: 500, epoch: 8 | loss: 0.0782998
	speed: 0.0105s/iter; left time: 72.6901s
Epoch: 8 cost time: 6.232880115509033
Epoch: 8, Steps: 570 | Train Loss: 0.0995351 Vali Loss: 0.0362384 Test Loss: 0.1333975
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1689786
	speed: 0.0356s/iter; left time: 239.7422s
	iters: 200, epoch: 9 | loss: 0.0877496
	speed: 0.0105s/iter; left time: 69.8639s
	iters: 300, epoch: 9 | loss: 0.0617598
	speed: 0.0105s/iter; left time: 68.8455s
	iters: 400, epoch: 9 | loss: 0.0963161
	speed: 0.0105s/iter; left time: 67.7760s
	iters: 500, epoch: 9 | loss: 0.0842207
	speed: 0.0105s/iter; left time: 66.7944s
Epoch: 9 cost time: 6.252473831176758
Epoch: 9, Steps: 570 | Train Loss: 0.0986069 Vali Loss: 0.0366251 Test Loss: 0.1347573
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13512693345546722, mae:0.23280654847621918
>>> MS_Raw LR=5e-4 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2258161
	speed: 0.0223s/iter; left time: 251.8159s
	iters: 200, epoch: 1 | loss: 0.1745539
	speed: 0.0104s/iter; left time: 116.6803s
	iters: 300, epoch: 1 | loss: 0.2272285
	speed: 0.0104s/iter; left time: 115.8643s
	iters: 400, epoch: 1 | loss: 0.1798825
	speed: 0.0104s/iter; left time: 114.6801s
	iters: 500, epoch: 1 | loss: 0.1475461
	speed: 0.0104s/iter; left time: 113.8578s
Epoch: 1 cost time: 7.1869120597839355
Epoch: 1, Steps: 570 | Train Loss: 0.1818829 Vali Loss: 0.0384824 Test Loss: 0.1245723
Validation loss decreased (inf --> 0.038482).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1269545
	speed: 0.0364s/iter; left time: 390.0873s
	iters: 200, epoch: 2 | loss: 0.1704410
	speed: 0.0103s/iter; left time: 109.9105s
	iters: 300, epoch: 2 | loss: 0.1202096
	speed: 0.0103s/iter; left time: 108.9310s
	iters: 400, epoch: 2 | loss: 0.1311851
	speed: 0.0103s/iter; left time: 107.6454s
	iters: 500, epoch: 2 | loss: 0.1385412
	speed: 0.0103s/iter; left time: 106.7011s
Epoch: 2 cost time: 6.1983418464660645
Epoch: 2, Steps: 570 | Train Loss: 0.1543717 Vali Loss: 0.0365131 Test Loss: 0.1147417
Validation loss decreased (0.038482 --> 0.036513).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0716504
	speed: 0.0376s/iter; left time: 382.0507s
	iters: 200, epoch: 3 | loss: 0.1160610
	speed: 0.0104s/iter; left time: 104.5526s
	iters: 300, epoch: 3 | loss: 0.2342663
	speed: 0.0104s/iter; left time: 103.1280s
	iters: 400, epoch: 3 | loss: 0.1401396
	speed: 0.0103s/iter; left time: 101.9658s
	iters: 500, epoch: 3 | loss: 0.0908380
	speed: 0.0103s/iter; left time: 100.7999s
Epoch: 3 cost time: 6.196711778640747
Epoch: 3, Steps: 570 | Train Loss: 0.1285174 Vali Loss: 0.0326620 Test Loss: 0.1128577
Validation loss decreased (0.036513 --> 0.032662).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1006823
	speed: 0.0351s/iter; left time: 336.8318s
	iters: 200, epoch: 4 | loss: 0.0886865
	speed: 0.0102s/iter; left time: 96.9102s
	iters: 300, epoch: 4 | loss: 0.0701043
	speed: 0.0102s/iter; left time: 95.8169s
	iters: 400, epoch: 4 | loss: 0.0819835
	speed: 0.0102s/iter; left time: 94.9605s
	iters: 500, epoch: 4 | loss: 0.1388223
	speed: 0.0102s/iter; left time: 93.7644s
Epoch: 4 cost time: 6.104479789733887
Epoch: 4, Steps: 570 | Train Loss: 0.1119747 Vali Loss: 0.0325327 Test Loss: 0.1104302
Validation loss decreased (0.032662 --> 0.032533).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0873269
	speed: 0.0372s/iter; left time: 335.5989s
	iters: 200, epoch: 5 | loss: 0.1224051
	speed: 0.0105s/iter; left time: 94.0545s
	iters: 300, epoch: 5 | loss: 0.0985460
	speed: 0.0104s/iter; left time: 91.3840s
	iters: 400, epoch: 5 | loss: 0.1158594
	speed: 0.0104s/iter; left time: 90.3052s
	iters: 500, epoch: 5 | loss: 0.0986964
	speed: 0.0103s/iter; left time: 88.9777s
Epoch: 5 cost time: 6.296904802322388
Epoch: 5, Steps: 570 | Train Loss: 0.1033130 Vali Loss: 0.0320356 Test Loss: 0.1119445
Validation loss decreased (0.032533 --> 0.032036).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0776036
	speed: 0.0363s/iter; left time: 306.6694s
	iters: 200, epoch: 6 | loss: 0.1331430
	speed: 0.0103s/iter; left time: 86.2295s
	iters: 300, epoch: 6 | loss: 0.1295920
	speed: 0.0103s/iter; left time: 85.2431s
	iters: 400, epoch: 6 | loss: 0.0783443
	speed: 0.0104s/iter; left time: 84.4442s
	iters: 500, epoch: 6 | loss: 0.0676099
	speed: 0.0103s/iter; left time: 83.1636s
Epoch: 6 cost time: 6.156935453414917
Epoch: 6, Steps: 570 | Train Loss: 0.0982573 Vali Loss: 0.0314279 Test Loss: 0.1120153
Validation loss decreased (0.032036 --> 0.031428).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0900342
	speed: 0.0368s/iter; left time: 289.8955s
	iters: 200, epoch: 7 | loss: 0.1217557
	speed: 0.0103s/iter; left time: 80.2529s
	iters: 300, epoch: 7 | loss: 0.1556553
	speed: 0.0103s/iter; left time: 79.1415s
	iters: 400, epoch: 7 | loss: 0.1425365
	speed: 0.0103s/iter; left time: 77.9174s
	iters: 500, epoch: 7 | loss: 0.0993003
	speed: 0.0103s/iter; left time: 77.1701s
Epoch: 7 cost time: 6.1420958042144775
Epoch: 7, Steps: 570 | Train Loss: 0.0967970 Vali Loss: 0.0316864 Test Loss: 0.1134103
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0859262
	speed: 0.0366s/iter; left time: 267.3000s
	iters: 200, epoch: 8 | loss: 0.0744396
	speed: 0.0102s/iter; left time: 73.7253s
	iters: 300, epoch: 8 | loss: 0.0877784
	speed: 0.0102s/iter; left time: 72.7571s
	iters: 400, epoch: 8 | loss: 0.0967927
	speed: 0.0103s/iter; left time: 71.9635s
	iters: 500, epoch: 8 | loss: 0.0578659
	speed: 0.0103s/iter; left time: 71.0509s
Epoch: 8 cost time: 6.247151851654053
Epoch: 8, Steps: 570 | Train Loss: 0.0951235 Vali Loss: 0.0315706 Test Loss: 0.1138512
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0745744
	speed: 0.0353s/iter; left time: 237.7310s
	iters: 200, epoch: 9 | loss: 0.1081465
	speed: 0.0103s/iter; left time: 68.5543s
	iters: 300, epoch: 9 | loss: 0.0850372
	speed: 0.0104s/iter; left time: 67.7433s
	iters: 400, epoch: 9 | loss: 0.1032244
	speed: 0.0104s/iter; left time: 66.9249s
	iters: 500, epoch: 9 | loss: 0.0823691
	speed: 0.0103s/iter; left time: 65.2381s
Epoch: 9 cost time: 6.167146444320679
Epoch: 9, Steps: 570 | Train Loss: 0.0938647 Vali Loss: 0.0316149 Test Loss: 0.1139777
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11217200011014938, mae:0.20515543222427368
>>> MS_Raw LR=5e-4 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2126052
	speed: 0.0225s/iter; left time: 254.2276s
	iters: 200, epoch: 1 | loss: 0.1374715
	speed: 0.0103s/iter; left time: 115.0741s
	iters: 300, epoch: 1 | loss: 0.1647153
	speed: 0.0103s/iter; left time: 114.4018s
	iters: 400, epoch: 1 | loss: 0.1097612
	speed: 0.0103s/iter; left time: 112.8535s
	iters: 500, epoch: 1 | loss: 0.2070301
	speed: 0.0104s/iter; left time: 112.8309s
Epoch: 1 cost time: 7.1377832889556885
Epoch: 1, Steps: 570 | Train Loss: 0.2159055 Vali Loss: 0.0433398 Test Loss: 0.1446968
Validation loss decreased (inf --> 0.043340).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1930389
	speed: 0.0349s/iter; left time: 374.0830s
	iters: 200, epoch: 2 | loss: 0.2482810
	speed: 0.0102s/iter; left time: 108.6105s
	iters: 300, epoch: 2 | loss: 0.1856881
	speed: 0.0101s/iter; left time: 106.8592s
	iters: 400, epoch: 2 | loss: 0.2534928
	speed: 0.0102s/iter; left time: 106.3075s
	iters: 500, epoch: 2 | loss: 0.1951734
	speed: 0.0101s/iter; left time: 104.7947s
Epoch: 2 cost time: 6.038321495056152
Epoch: 2, Steps: 570 | Train Loss: 0.1715210 Vali Loss: 0.0442632 Test Loss: 0.1414142
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0967074
	speed: 0.0344s/iter; left time: 349.6436s
	iters: 200, epoch: 3 | loss: 0.1278625
	speed: 0.0103s/iter; left time: 103.8368s
	iters: 300, epoch: 3 | loss: 0.1800192
	speed: 0.0103s/iter; left time: 102.4355s
	iters: 400, epoch: 3 | loss: 0.1153174
	speed: 0.0103s/iter; left time: 101.4526s
	iters: 500, epoch: 3 | loss: 0.0864907
	speed: 0.0102s/iter; left time: 99.6417s
Epoch: 3 cost time: 6.104459047317505
Epoch: 3, Steps: 570 | Train Loss: 0.1365773 Vali Loss: 0.0402464 Test Loss: 0.1316162
Validation loss decreased (0.043340 --> 0.040246).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0689162
	speed: 0.0349s/iter; left time: 334.9217s
	iters: 200, epoch: 4 | loss: 0.0810238
	speed: 0.0103s/iter; left time: 97.3724s
	iters: 300, epoch: 4 | loss: 0.0791520
	speed: 0.0103s/iter; left time: 97.0431s
	iters: 400, epoch: 4 | loss: 0.1398570
	speed: 0.0103s/iter; left time: 96.1186s
	iters: 500, epoch: 4 | loss: 0.0956015
	speed: 0.0103s/iter; left time: 95.1153s
Epoch: 4 cost time: 6.135430574417114
Epoch: 4, Steps: 570 | Train Loss: 0.1136333 Vali Loss: 0.0403347 Test Loss: 0.1356540
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1071966
	speed: 0.0345s/iter; left time: 311.2440s
	iters: 200, epoch: 5 | loss: 0.0704997
	speed: 0.0103s/iter; left time: 92.3309s
	iters: 300, epoch: 5 | loss: 0.0892456
	speed: 0.0104s/iter; left time: 91.5391s
	iters: 400, epoch: 5 | loss: 0.1097680
	speed: 0.0104s/iter; left time: 90.4081s
	iters: 500, epoch: 5 | loss: 0.1410007
	speed: 0.0105s/iter; left time: 90.5245s
Epoch: 5 cost time: 6.176481485366821
Epoch: 5, Steps: 570 | Train Loss: 0.1049160 Vali Loss: 0.0393753 Test Loss: 0.1345298
Validation loss decreased (0.040246 --> 0.039375).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0837624
	speed: 0.0351s/iter; left time: 296.2168s
	iters: 200, epoch: 6 | loss: 0.0961889
	speed: 0.0102s/iter; left time: 84.9037s
	iters: 300, epoch: 6 | loss: 0.1093323
	speed: 0.0102s/iter; left time: 84.2195s
	iters: 400, epoch: 6 | loss: 0.0809935
	speed: 0.0102s/iter; left time: 83.1598s
	iters: 500, epoch: 6 | loss: 0.1131487
	speed: 0.0102s/iter; left time: 81.8274s
Epoch: 6 cost time: 6.063662767410278
Epoch: 6, Steps: 570 | Train Loss: 0.0989067 Vali Loss: 0.0389056 Test Loss: 0.1327591
Validation loss decreased (0.039375 --> 0.038906).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0908248
	speed: 0.0343s/iter; left time: 270.3844s
	iters: 200, epoch: 7 | loss: 0.0762231
	speed: 0.0102s/iter; left time: 79.1400s
	iters: 300, epoch: 7 | loss: 0.0909373
	speed: 0.0101s/iter; left time: 77.8543s
	iters: 400, epoch: 7 | loss: 0.0681608
	speed: 0.0102s/iter; left time: 76.9630s
	iters: 500, epoch: 7 | loss: 0.0986060
	speed: 0.0102s/iter; left time: 75.9965s
Epoch: 7 cost time: 6.048494577407837
Epoch: 7, Steps: 570 | Train Loss: 0.0962614 Vali Loss: 0.0390874 Test Loss: 0.1329040
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0775798
	speed: 0.0342s/iter; left time: 250.0481s
	iters: 200, epoch: 8 | loss: 0.1064886
	speed: 0.0102s/iter; left time: 73.5727s
	iters: 300, epoch: 8 | loss: 0.0902569
	speed: 0.0102s/iter; left time: 72.4037s
	iters: 400, epoch: 8 | loss: 0.0937475
	speed: 0.0102s/iter; left time: 71.4110s
	iters: 500, epoch: 8 | loss: 0.0717437
	speed: 0.0102s/iter; left time: 70.3746s
Epoch: 8 cost time: 6.0391504764556885
Epoch: 8, Steps: 570 | Train Loss: 0.0940405 Vali Loss: 0.0391326 Test Loss: 0.1337127
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0720170
	speed: 0.0343s/iter; left time: 231.4626s
	iters: 200, epoch: 9 | loss: 0.1180055
	speed: 0.0102s/iter; left time: 68.0127s
	iters: 300, epoch: 9 | loss: 0.0763217
	speed: 0.0102s/iter; left time: 66.7175s
	iters: 400, epoch: 9 | loss: 0.0791094
	speed: 0.0101s/iter; left time: 65.3511s
	iters: 500, epoch: 9 | loss: 0.0849110
	speed: 0.0102s/iter; left time: 64.4827s
Epoch: 9 cost time: 6.067607402801514
Epoch: 9, Steps: 570 | Train Loss: 0.0928958 Vali Loss: 0.0394123 Test Loss: 0.1342105
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13295453786849976, mae:0.23362568020820618
>>> MS_Raw LR=5e-4 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2748502
	speed: 0.0254s/iter; left time: 286.5851s
	iters: 200, epoch: 1 | loss: 0.2084380
	speed: 0.0130s/iter; left time: 145.2800s
	iters: 300, epoch: 1 | loss: 0.2147193
	speed: 0.0129s/iter; left time: 143.6102s
	iters: 400, epoch: 1 | loss: 0.1102636
	speed: 0.0130s/iter; left time: 142.5551s
	iters: 500, epoch: 1 | loss: 0.2449139
	speed: 0.0130s/iter; left time: 141.5507s
Epoch: 1 cost time: 8.682089805603027
Epoch: 1, Steps: 570 | Train Loss: 0.2353376 Vali Loss: 0.0468720 Test Loss: 0.1393561
Validation loss decreased (inf --> 0.046872).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1956535
	speed: 0.0420s/iter; left time: 450.9638s
	iters: 200, epoch: 2 | loss: 0.1641064
	speed: 0.0128s/iter; left time: 135.6906s
	iters: 300, epoch: 2 | loss: 0.1314635
	speed: 0.0128s/iter; left time: 134.9277s
	iters: 400, epoch: 2 | loss: 0.1056886
	speed: 0.0128s/iter; left time: 133.3366s
	iters: 500, epoch: 2 | loss: 0.1730652
	speed: 0.0128s/iter; left time: 131.8694s
Epoch: 2 cost time: 7.590817213058472
Epoch: 2, Steps: 570 | Train Loss: 0.1995923 Vali Loss: 0.0450163 Test Loss: 0.1359542
Validation loss decreased (0.046872 --> 0.045016).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1934972
	speed: 0.0426s/iter; left time: 432.5133s
	iters: 200, epoch: 3 | loss: 0.2169630
	speed: 0.0128s/iter; left time: 129.2583s
	iters: 300, epoch: 3 | loss: 0.1213193
	speed: 0.0128s/iter; left time: 127.9456s
	iters: 400, epoch: 3 | loss: 0.1498200
	speed: 0.0128s/iter; left time: 126.4561s
	iters: 500, epoch: 3 | loss: 0.1662777
	speed: 0.0121s/iter; left time: 117.6712s
Epoch: 3 cost time: 7.504917860031128
Epoch: 3, Steps: 570 | Train Loss: 0.1741398 Vali Loss: 0.0422012 Test Loss: 0.1378659
Validation loss decreased (0.045016 --> 0.042201).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1304682
	speed: 0.0423s/iter; left time: 406.0193s
	iters: 200, epoch: 4 | loss: 0.1854112
	speed: 0.0130s/iter; left time: 123.3086s
	iters: 300, epoch: 4 | loss: 0.1072130
	speed: 0.0126s/iter; left time: 118.5095s
	iters: 400, epoch: 4 | loss: 0.0934103
	speed: 0.0119s/iter; left time: 110.9001s
	iters: 500, epoch: 4 | loss: 0.1440407
	speed: 0.0119s/iter; left time: 109.6674s
Epoch: 4 cost time: 7.419775009155273
Epoch: 4, Steps: 570 | Train Loss: 0.1554324 Vali Loss: 0.0426190 Test Loss: 0.1270937
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1229717
	speed: 0.0385s/iter; left time: 347.2297s
	iters: 200, epoch: 5 | loss: 0.1247959
	speed: 0.0118s/iter; left time: 105.5245s
	iters: 300, epoch: 5 | loss: 0.1960773
	speed: 0.0119s/iter; left time: 104.6767s
	iters: 400, epoch: 5 | loss: 0.1387040
	speed: 0.0118s/iter; left time: 103.3000s
	iters: 500, epoch: 5 | loss: 0.1279780
	speed: 0.0118s/iter; left time: 102.0227s
Epoch: 5 cost time: 7.015894174575806
Epoch: 5, Steps: 570 | Train Loss: 0.1429132 Vali Loss: 0.0403843 Test Loss: 0.1261380
Validation loss decreased (0.042201 --> 0.040384).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1534443
	speed: 0.0408s/iter; left time: 345.0279s
	iters: 200, epoch: 6 | loss: 0.0734791
	speed: 0.0119s/iter; left time: 99.1609s
	iters: 300, epoch: 6 | loss: 0.1539678
	speed: 0.0119s/iter; left time: 97.9839s
	iters: 400, epoch: 6 | loss: 0.1341914
	speed: 0.0119s/iter; left time: 96.9198s
	iters: 500, epoch: 6 | loss: 0.1050217
	speed: 0.0119s/iter; left time: 95.4616s
Epoch: 6 cost time: 7.071390151977539
Epoch: 6, Steps: 570 | Train Loss: 0.1340782 Vali Loss: 0.0394809 Test Loss: 0.1283349
Validation loss decreased (0.040384 --> 0.039481).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1350735
	speed: 0.0390s/iter; left time: 307.0653s
	iters: 200, epoch: 7 | loss: 0.1328423
	speed: 0.0119s/iter; left time: 92.5089s
	iters: 300, epoch: 7 | loss: 0.1311206
	speed: 0.0119s/iter; left time: 91.2914s
	iters: 400, epoch: 7 | loss: 0.0903304
	speed: 0.0119s/iter; left time: 90.1932s
	iters: 500, epoch: 7 | loss: 0.1177615
	speed: 0.0119s/iter; left time: 88.9235s
Epoch: 7 cost time: 7.067863702774048
Epoch: 7, Steps: 570 | Train Loss: 0.1292391 Vali Loss: 0.0397825 Test Loss: 0.1285097
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0874919
	speed: 0.0382s/iter; left time: 279.0918s
	iters: 200, epoch: 8 | loss: 0.1236357
	speed: 0.0119s/iter; left time: 85.6945s
	iters: 300, epoch: 8 | loss: 0.1306811
	speed: 0.0119s/iter; left time: 84.6222s
	iters: 400, epoch: 8 | loss: 0.1075007
	speed: 0.0119s/iter; left time: 83.4157s
	iters: 500, epoch: 8 | loss: 0.1073734
	speed: 0.0119s/iter; left time: 82.1457s
Epoch: 8 cost time: 7.0494303703308105
Epoch: 8, Steps: 570 | Train Loss: 0.1282189 Vali Loss: 0.0393154 Test Loss: 0.1281180
Validation loss decreased (0.039481 --> 0.039315).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1067264
	speed: 0.0398s/iter; left time: 268.4728s
	iters: 200, epoch: 9 | loss: 0.1032476
	speed: 0.0119s/iter; left time: 78.7917s
	iters: 300, epoch: 9 | loss: 0.1405332
	speed: 0.0119s/iter; left time: 77.5301s
	iters: 400, epoch: 9 | loss: 0.0929061
	speed: 0.0118s/iter; left time: 76.2968s
	iters: 500, epoch: 9 | loss: 0.1268479
	speed: 0.0119s/iter; left time: 75.1678s
Epoch: 9 cost time: 7.070791959762573
Epoch: 9, Steps: 570 | Train Loss: 0.1259667 Vali Loss: 0.0393005 Test Loss: 0.1285784
Validation loss decreased (0.039315 --> 0.039301).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1167146
	speed: 0.0396s/iter; left time: 244.3670s
	iters: 200, epoch: 10 | loss: 0.1376054
	speed: 0.0119s/iter; left time: 72.1379s
	iters: 300, epoch: 10 | loss: 0.1336108
	speed: 0.0119s/iter; left time: 70.9305s
	iters: 400, epoch: 10 | loss: 0.1067017
	speed: 0.0119s/iter; left time: 69.7935s
	iters: 500, epoch: 10 | loss: 0.1816334
	speed: 0.0119s/iter; left time: 68.5796s
Epoch: 10 cost time: 7.085950136184692
Epoch: 10, Steps: 570 | Train Loss: 0.1260375 Vali Loss: 0.0393978 Test Loss: 0.1289789
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1116521
	speed: 0.0395s/iter; left time: 221.4772s
	iters: 200, epoch: 11 | loss: 0.1775654
	speed: 0.0119s/iter; left time: 65.3238s
	iters: 300, epoch: 11 | loss: 0.1322004
	speed: 0.0119s/iter; left time: 64.2565s
	iters: 400, epoch: 11 | loss: 0.1197584
	speed: 0.0119s/iter; left time: 63.0180s
	iters: 500, epoch: 11 | loss: 0.1856377
	speed: 0.0119s/iter; left time: 61.9539s
Epoch: 11 cost time: 7.140973329544067
Epoch: 11, Steps: 570 | Train Loss: 0.1244359 Vali Loss: 0.0394877 Test Loss: 0.1293370
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0919617
	speed: 0.0400s/iter; left time: 201.3010s
	iters: 200, epoch: 12 | loss: 0.0905452
	speed: 0.0119s/iter; left time: 58.5689s
	iters: 300, epoch: 12 | loss: 0.1048527
	speed: 0.0119s/iter; left time: 57.3702s
	iters: 400, epoch: 12 | loss: 0.1121643
	speed: 0.0119s/iter; left time: 56.0807s
	iters: 500, epoch: 12 | loss: 0.1147581
	speed: 0.0119s/iter; left time: 54.9373s
Epoch: 12 cost time: 7.109248638153076
Epoch: 12, Steps: 570 | Train Loss: 0.1251730 Vali Loss: 0.0395623 Test Loss: 0.1292676
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12871778011322021, mae:0.22809365391731262
>>> MS_Raw LR=5e-4 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1300711
	speed: 0.0233s/iter; left time: 263.7038s
	iters: 200, epoch: 1 | loss: 0.3094113
	speed: 0.0115s/iter; left time: 128.2822s
	iters: 300, epoch: 1 | loss: 0.1772321
	speed: 0.0115s/iter; left time: 127.3552s
	iters: 400, epoch: 1 | loss: 0.1927970
	speed: 0.0114s/iter; left time: 125.9155s
	iters: 500, epoch: 1 | loss: 0.1227823
	speed: 0.0114s/iter; left time: 124.6602s
Epoch: 1 cost time: 7.762124300003052
Epoch: 1, Steps: 570 | Train Loss: 0.1955146 Vali Loss: 0.0420059 Test Loss: 0.1293657
Validation loss decreased (inf --> 0.042006).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1480882
	speed: 0.0396s/iter; left time: 425.1734s
	iters: 200, epoch: 2 | loss: 0.1168805
	speed: 0.0114s/iter; left time: 121.4915s
	iters: 300, epoch: 2 | loss: 0.1539083
	speed: 0.0115s/iter; left time: 120.7899s
	iters: 400, epoch: 2 | loss: 0.2182992
	speed: 0.0115s/iter; left time: 119.5298s
	iters: 500, epoch: 2 | loss: 0.6056554
	speed: 0.0115s/iter; left time: 118.6825s
Epoch: 2 cost time: 6.8474578857421875
Epoch: 2, Steps: 570 | Train Loss: 0.1892001 Vali Loss: 0.0559730 Test Loss: 0.1621517
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2122157
	speed: 0.0377s/iter; left time: 382.6705s
	iters: 200, epoch: 3 | loss: 0.0970625
	speed: 0.0115s/iter; left time: 115.3312s
	iters: 300, epoch: 3 | loss: 0.1917423
	speed: 0.0115s/iter; left time: 114.1774s
	iters: 400, epoch: 3 | loss: 0.1587247
	speed: 0.0115s/iter; left time: 113.0190s
	iters: 500, epoch: 3 | loss: 0.2420566
	speed: 0.0115s/iter; left time: 111.8237s
Epoch: 3 cost time: 6.831886053085327
Epoch: 3, Steps: 570 | Train Loss: 0.1813456 Vali Loss: 0.0372267 Test Loss: 0.1250522
Validation loss decreased (0.042006 --> 0.037227).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1855680
	speed: 0.0381s/iter; left time: 365.8644s
	iters: 200, epoch: 4 | loss: 0.0917098
	speed: 0.0114s/iter; left time: 108.3597s
	iters: 300, epoch: 4 | loss: 0.0880305
	speed: 0.0114s/iter; left time: 107.4866s
	iters: 400, epoch: 4 | loss: 0.1410631
	speed: 0.0114s/iter; left time: 106.0438s
	iters: 500, epoch: 4 | loss: 0.1505861
	speed: 0.0114s/iter; left time: 104.8803s
Epoch: 4 cost time: 6.81981086730957
Epoch: 4, Steps: 570 | Train Loss: 0.1574655 Vali Loss: 0.0376252 Test Loss: 0.1238940
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1433762
	speed: 0.0376s/iter; left time: 339.5870s
	iters: 200, epoch: 5 | loss: 0.1362560
	speed: 0.0114s/iter; left time: 102.1012s
	iters: 300, epoch: 5 | loss: 0.2190448
	speed: 0.0115s/iter; left time: 101.1763s
	iters: 400, epoch: 5 | loss: 0.1679020
	speed: 0.0115s/iter; left time: 99.9939s
	iters: 500, epoch: 5 | loss: 0.1148061
	speed: 0.0115s/iter; left time: 98.9100s
Epoch: 5 cost time: 6.820630311965942
Epoch: 5, Steps: 570 | Train Loss: 0.1475436 Vali Loss: 0.0346353 Test Loss: 0.1169233
Validation loss decreased (0.037227 --> 0.034635).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1732468
	speed: 0.0381s/iter; left time: 322.2157s
	iters: 200, epoch: 6 | loss: 0.1484320
	speed: 0.0114s/iter; left time: 95.3509s
	iters: 300, epoch: 6 | loss: 0.0845025
	speed: 0.0114s/iter; left time: 94.3079s
	iters: 400, epoch: 6 | loss: 0.0988227
	speed: 0.0114s/iter; left time: 93.1120s
	iters: 500, epoch: 6 | loss: 0.1221070
	speed: 0.0114s/iter; left time: 91.9002s
Epoch: 6 cost time: 6.827648639678955
Epoch: 6, Steps: 570 | Train Loss: 0.1396978 Vali Loss: 0.0338739 Test Loss: 0.1158155
Validation loss decreased (0.034635 --> 0.033874).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1004824
	speed: 0.0402s/iter; left time: 316.5376s
	iters: 200, epoch: 7 | loss: 0.2261177
	speed: 0.0115s/iter; left time: 89.8362s
	iters: 300, epoch: 7 | loss: 0.1112074
	speed: 0.0115s/iter; left time: 88.6096s
	iters: 400, epoch: 7 | loss: 0.1229349
	speed: 0.0115s/iter; left time: 87.1806s
	iters: 500, epoch: 7 | loss: 0.1122292
	speed: 0.0115s/iter; left time: 86.0232s
Epoch: 7 cost time: 6.891731262207031
Epoch: 7, Steps: 570 | Train Loss: 0.1377403 Vali Loss: 0.0337382 Test Loss: 0.1156678
Validation loss decreased (0.033874 --> 0.033738).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1037824
	speed: 0.0397s/iter; left time: 290.0744s
	iters: 200, epoch: 8 | loss: 0.1524660
	speed: 0.0115s/iter; left time: 82.9947s
	iters: 300, epoch: 8 | loss: 0.1183857
	speed: 0.0115s/iter; left time: 81.9346s
	iters: 400, epoch: 8 | loss: 0.1234620
	speed: 0.0115s/iter; left time: 80.6480s
	iters: 500, epoch: 8 | loss: 0.1097233
	speed: 0.0115s/iter; left time: 79.4952s
Epoch: 8 cost time: 6.868237495422363
Epoch: 8, Steps: 570 | Train Loss: 0.1357162 Vali Loss: 0.0336374 Test Loss: 0.1146246
Validation loss decreased (0.033738 --> 0.033637).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1797483
	speed: 0.0381s/iter; left time: 256.8887s
	iters: 200, epoch: 9 | loss: 0.0966282
	speed: 0.0115s/iter; left time: 76.2161s
	iters: 300, epoch: 9 | loss: 0.1592433
	speed: 0.0115s/iter; left time: 74.9794s
	iters: 400, epoch: 9 | loss: 0.1242249
	speed: 0.0115s/iter; left time: 73.8751s
	iters: 500, epoch: 9 | loss: 0.2368679
	speed: 0.0115s/iter; left time: 72.8209s
Epoch: 9 cost time: 6.851416349411011
Epoch: 9, Steps: 570 | Train Loss: 0.1345700 Vali Loss: 0.0333215 Test Loss: 0.1144174
Validation loss decreased (0.033637 --> 0.033322).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1224813
	speed: 0.0391s/iter; left time: 241.2426s
	iters: 200, epoch: 10 | loss: 0.0959411
	speed: 0.0114s/iter; left time: 69.4252s
	iters: 300, epoch: 10 | loss: 0.1260364
	speed: 0.0114s/iter; left time: 68.2522s
	iters: 400, epoch: 10 | loss: 0.1690525
	speed: 0.0114s/iter; left time: 67.0214s
	iters: 500, epoch: 10 | loss: 0.1556181
	speed: 0.0114s/iter; left time: 66.0768s
Epoch: 10 cost time: 6.8432722091674805
Epoch: 10, Steps: 570 | Train Loss: 0.1346377 Vali Loss: 0.0333686 Test Loss: 0.1149346
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1144761
	speed: 0.0375s/iter; left time: 210.1626s
	iters: 200, epoch: 11 | loss: 0.1198494
	speed: 0.0114s/iter; left time: 62.8759s
	iters: 300, epoch: 11 | loss: 0.1082775
	speed: 0.0114s/iter; left time: 61.7518s
	iters: 400, epoch: 11 | loss: 0.1738293
	speed: 0.0114s/iter; left time: 60.6085s
	iters: 500, epoch: 11 | loss: 0.1408115
	speed: 0.0114s/iter; left time: 59.4896s
Epoch: 11 cost time: 6.7871458530426025
Epoch: 11, Steps: 570 | Train Loss: 0.1339782 Vali Loss: 0.0333226 Test Loss: 0.1150690
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1342557
	speed: 0.0377s/iter; left time: 189.8668s
	iters: 200, epoch: 12 | loss: 0.1216956
	speed: 0.0114s/iter; left time: 56.3736s
	iters: 300, epoch: 12 | loss: 0.1211447
	speed: 0.0114s/iter; left time: 55.2036s
	iters: 400, epoch: 12 | loss: 0.1809108
	speed: 0.0114s/iter; left time: 54.1266s
	iters: 500, epoch: 12 | loss: 0.1421872
	speed: 0.0114s/iter; left time: 52.8810s
Epoch: 12 cost time: 6.785269737243652
Epoch: 12, Steps: 570 | Train Loss: 0.1330528 Vali Loss: 0.0335861 Test Loss: 0.1150666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11457356065511703, mae:0.2082524299621582
>>> MS_Raw LR=5e-4 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2563054
	speed: 0.0230s/iter; left time: 259.5019s
	iters: 200, epoch: 1 | loss: 0.3060882
	speed: 0.0109s/iter; left time: 122.5105s
	iters: 300, epoch: 1 | loss: 0.2427146
	speed: 0.0110s/iter; left time: 121.6681s
	iters: 400, epoch: 1 | loss: 0.1704900
	speed: 0.0109s/iter; left time: 120.2665s
	iters: 500, epoch: 1 | loss: 0.1884707
	speed: 0.0110s/iter; left time: 119.4714s
Epoch: 1 cost time: 7.493437767028809
Epoch: 1, Steps: 570 | Train Loss: 0.2254649 Vali Loss: 0.0460251 Test Loss: 0.1410485
Validation loss decreased (inf --> 0.046025).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2278082
	speed: 0.0377s/iter; left time: 404.9575s
	iters: 200, epoch: 2 | loss: 0.2863010
	speed: 0.0109s/iter; left time: 116.3971s
	iters: 300, epoch: 2 | loss: 0.1574631
	speed: 0.0110s/iter; left time: 115.3577s
	iters: 400, epoch: 2 | loss: 0.1781293
	speed: 0.0109s/iter; left time: 114.1761s
	iters: 500, epoch: 2 | loss: 0.3219774
	speed: 0.0110s/iter; left time: 113.2693s
Epoch: 2 cost time: 6.570505857467651
Epoch: 2, Steps: 570 | Train Loss: 0.2344164 Vali Loss: 0.0522266 Test Loss: 0.1590629
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1617962
	speed: 0.0373s/iter; left time: 378.8188s
	iters: 200, epoch: 3 | loss: 0.1521518
	speed: 0.0109s/iter; left time: 110.0409s
	iters: 300, epoch: 3 | loss: 0.2234536
	speed: 0.0109s/iter; left time: 108.8208s
	iters: 400, epoch: 3 | loss: 0.1817826
	speed: 0.0109s/iter; left time: 107.8690s
	iters: 500, epoch: 3 | loss: 0.2091747
	speed: 0.0109s/iter; left time: 106.2972s
Epoch: 3 cost time: 6.5143349170684814
Epoch: 3, Steps: 570 | Train Loss: 0.2069548 Vali Loss: 0.0490118 Test Loss: 0.1398464
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2131798
	speed: 0.0364s/iter; left time: 349.2418s
	iters: 200, epoch: 4 | loss: 0.1151125
	speed: 0.0109s/iter; left time: 103.3067s
	iters: 300, epoch: 4 | loss: 0.1875534
	speed: 0.0109s/iter; left time: 101.9591s
	iters: 400, epoch: 4 | loss: 0.2876613
	speed: 0.0109s/iter; left time: 100.9859s
	iters: 500, epoch: 4 | loss: 0.1665280
	speed: 0.0109s/iter; left time: 99.8374s
Epoch: 4 cost time: 6.485705614089966
Epoch: 4, Steps: 570 | Train Loss: 0.1805104 Vali Loss: 0.0436446 Test Loss: 0.1359658
Validation loss decreased (0.046025 --> 0.043645).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1752025
	speed: 0.0384s/iter; left time: 346.1823s
	iters: 200, epoch: 5 | loss: 0.1700835
	speed: 0.0109s/iter; left time: 97.2465s
	iters: 300, epoch: 5 | loss: 0.1537457
	speed: 0.0109s/iter; left time: 96.2745s
	iters: 400, epoch: 5 | loss: 0.1103722
	speed: 0.0109s/iter; left time: 94.9227s
	iters: 500, epoch: 5 | loss: 0.2354374
	speed: 0.0109s/iter; left time: 93.5687s
Epoch: 5 cost time: 6.496883869171143
Epoch: 5, Steps: 570 | Train Loss: 0.1616194 Vali Loss: 0.0424842 Test Loss: 0.1335908
Validation loss decreased (0.043645 --> 0.042484).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1213849
	speed: 0.0370s/iter; left time: 312.4204s
	iters: 200, epoch: 6 | loss: 0.1398307
	speed: 0.0110s/iter; left time: 91.5688s
	iters: 300, epoch: 6 | loss: 0.1669592
	speed: 0.0110s/iter; left time: 90.4258s
	iters: 400, epoch: 6 | loss: 0.1325021
	speed: 0.0109s/iter; left time: 89.1554s
	iters: 500, epoch: 6 | loss: 0.1601461
	speed: 0.0109s/iter; left time: 88.0280s
Epoch: 6 cost time: 6.523748397827148
Epoch: 6, Steps: 570 | Train Loss: 0.1514458 Vali Loss: 0.0423038 Test Loss: 0.1384318
Validation loss decreased (0.042484 --> 0.042304).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1293175
	speed: 0.0377s/iter; left time: 297.0643s
	iters: 200, epoch: 7 | loss: 0.1011876
	speed: 0.0109s/iter; left time: 84.5515s
	iters: 300, epoch: 7 | loss: 0.0974072
	speed: 0.0109s/iter; left time: 83.6592s
	iters: 400, epoch: 7 | loss: 0.1650061
	speed: 0.0109s/iter; left time: 82.6484s
	iters: 500, epoch: 7 | loss: 0.1089765
	speed: 0.0108s/iter; left time: 81.1597s
Epoch: 7 cost time: 6.484671354293823
Epoch: 7, Steps: 570 | Train Loss: 0.1461564 Vali Loss: 0.0408922 Test Loss: 0.1339641
Validation loss decreased (0.042304 --> 0.040892).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1181434
	speed: 0.0369s/iter; left time: 269.9076s
	iters: 200, epoch: 8 | loss: 0.1858453
	speed: 0.0110s/iter; left time: 79.0581s
	iters: 300, epoch: 8 | loss: 0.1627850
	speed: 0.0110s/iter; left time: 77.9194s
	iters: 400, epoch: 8 | loss: 0.1537389
	speed: 0.0110s/iter; left time: 77.0328s
	iters: 500, epoch: 8 | loss: 0.1267983
	speed: 0.0109s/iter; left time: 75.6692s
Epoch: 8 cost time: 6.541278123855591
Epoch: 8, Steps: 570 | Train Loss: 0.1429851 Vali Loss: 0.0401977 Test Loss: 0.1338758
Validation loss decreased (0.040892 --> 0.040198).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1155324
	speed: 0.0386s/iter; left time: 260.3990s
	iters: 200, epoch: 9 | loss: 0.1059210
	speed: 0.0121s/iter; left time: 80.2716s
	iters: 300, epoch: 9 | loss: 0.1898012
	speed: 0.0121s/iter; left time: 79.2914s
	iters: 400, epoch: 9 | loss: 0.1801835
	speed: 0.0109s/iter; left time: 69.9200s
	iters: 500, epoch: 9 | loss: 0.0898061
	speed: 0.0109s/iter; left time: 68.8796s
Epoch: 9 cost time: 6.87575626373291
Epoch: 9, Steps: 570 | Train Loss: 0.1410465 Vali Loss: 0.0404282 Test Loss: 0.1336343
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1446062
	speed: 0.0365s/iter; left time: 225.2171s
	iters: 200, epoch: 10 | loss: 0.0783195
	speed: 0.0109s/iter; left time: 65.9345s
	iters: 300, epoch: 10 | loss: 0.1531917
	speed: 0.0109s/iter; left time: 64.9348s
	iters: 400, epoch: 10 | loss: 0.1077531
	speed: 0.0109s/iter; left time: 63.9739s
	iters: 500, epoch: 10 | loss: 0.1898513
	speed: 0.0109s/iter; left time: 62.6483s
Epoch: 10 cost time: 6.444032907485962
Epoch: 10, Steps: 570 | Train Loss: 0.1413932 Vali Loss: 0.0402531 Test Loss: 0.1331305
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0896061
	speed: 0.0370s/iter; left time: 207.4425s
	iters: 200, epoch: 11 | loss: 0.1391569
	speed: 0.0109s/iter; left time: 59.7878s
	iters: 300, epoch: 11 | loss: 0.1467878
	speed: 0.0109s/iter; left time: 58.6474s
	iters: 400, epoch: 11 | loss: 0.1015909
	speed: 0.0109s/iter; left time: 57.5775s
	iters: 500, epoch: 11 | loss: 0.1169378
	speed: 0.0108s/iter; left time: 56.2719s
Epoch: 11 cost time: 6.456847906112671
Epoch: 11, Steps: 570 | Train Loss: 0.1408087 Vali Loss: 0.0402770 Test Loss: 0.1330332
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13402952253818512, mae:0.23121598362922668
>>> MS_Raw LR=5e-4 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1887528
	speed: 0.0283s/iter; left time: 320.0314s
	iters: 200, epoch: 1 | loss: 0.1745297
	speed: 0.0164s/iter; left time: 183.2698s
	iters: 300, epoch: 1 | loss: 0.2686448
	speed: 0.0163s/iter; left time: 181.0834s
	iters: 400, epoch: 1 | loss: 0.1905873
	speed: 0.0158s/iter; left time: 173.8784s
	iters: 500, epoch: 1 | loss: 0.1562005
	speed: 0.0147s/iter; left time: 160.0554s
Epoch: 1 cost time: 10.23359227180481
Epoch: 1, Steps: 570 | Train Loss: 0.2121014 Vali Loss: 0.0457071 Test Loss: 0.1369302
Validation loss decreased (inf --> 0.045707).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2004817
	speed: 0.0482s/iter; left time: 517.3714s
	iters: 200, epoch: 2 | loss: 0.1453238
	speed: 0.0146s/iter; left time: 154.9660s
	iters: 300, epoch: 2 | loss: 0.1475892
	speed: 0.0146s/iter; left time: 153.2646s
	iters: 400, epoch: 2 | loss: 0.0873680
	speed: 0.0146s/iter; left time: 151.8747s
	iters: 500, epoch: 2 | loss: 0.1953811
	speed: 0.0146s/iter; left time: 150.4011s
Epoch: 2 cost time: 8.75748586654663
Epoch: 2, Steps: 570 | Train Loss: 0.1697742 Vali Loss: 0.0448095 Test Loss: 0.1532207
Validation loss decreased (0.045707 --> 0.044810).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2172320
	speed: 0.0483s/iter; left time: 490.4620s
	iters: 200, epoch: 3 | loss: 0.1722004
	speed: 0.0145s/iter; left time: 145.5998s
	iters: 300, epoch: 3 | loss: 0.0974896
	speed: 0.0145s/iter; left time: 144.3485s
	iters: 400, epoch: 3 | loss: 0.1056065
	speed: 0.0146s/iter; left time: 143.5362s
	iters: 500, epoch: 3 | loss: 0.0902604
	speed: 0.0145s/iter; left time: 141.8981s
Epoch: 3 cost time: 8.644123077392578
Epoch: 3, Steps: 570 | Train Loss: 0.1363809 Vali Loss: 0.0369532 Test Loss: 0.1324762
Validation loss decreased (0.044810 --> 0.036953).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1073803
	speed: 0.0483s/iter; left time: 463.1548s
	iters: 200, epoch: 4 | loss: 0.0982647
	speed: 0.0163s/iter; left time: 154.9991s
	iters: 300, epoch: 4 | loss: 0.1236442
	speed: 0.0163s/iter; left time: 153.0053s
	iters: 400, epoch: 4 | loss: 0.1236129
	speed: 0.0163s/iter; left time: 151.4838s
	iters: 500, epoch: 4 | loss: 0.0928323
	speed: 0.0163s/iter; left time: 149.6919s
Epoch: 4 cost time: 9.602758169174194
Epoch: 4, Steps: 570 | Train Loss: 0.1142296 Vali Loss: 0.0382205 Test Loss: 0.1314452
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1057231
	speed: 0.0489s/iter; left time: 441.0584s
	iters: 200, epoch: 5 | loss: 0.0959686
	speed: 0.0144s/iter; left time: 128.8332s
	iters: 300, epoch: 5 | loss: 0.1053961
	speed: 0.0144s/iter; left time: 127.0933s
	iters: 400, epoch: 5 | loss: 0.0760272
	speed: 0.0144s/iter; left time: 125.6420s
	iters: 500, epoch: 5 | loss: 0.0985045
	speed: 0.0144s/iter; left time: 124.2054s
Epoch: 5 cost time: 8.477984189987183
Epoch: 5, Steps: 570 | Train Loss: 0.1028115 Vali Loss: 0.0374991 Test Loss: 0.1352442
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0769622
	speed: 0.0456s/iter; left time: 384.9728s
	iters: 200, epoch: 6 | loss: 0.1111268
	speed: 0.0145s/iter; left time: 121.1161s
	iters: 300, epoch: 6 | loss: 0.0763125
	speed: 0.0144s/iter; left time: 119.1505s
	iters: 400, epoch: 6 | loss: 0.0836025
	speed: 0.0144s/iter; left time: 117.4855s
	iters: 500, epoch: 6 | loss: 0.0896173
	speed: 0.0144s/iter; left time: 115.9127s
Epoch: 6 cost time: 8.504351377487183
Epoch: 6, Steps: 570 | Train Loss: 0.0954362 Vali Loss: 0.0381863 Test Loss: 0.1341667
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1326751559972763, mae:0.23089633882045746
>>> MS_Raw LR=5e-4 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2571278
	speed: 0.0257s/iter; left time: 290.1327s
	iters: 200, epoch: 1 | loss: 0.1795674
	speed: 0.0142s/iter; left time: 159.2906s
	iters: 300, epoch: 1 | loss: 0.1446693
	speed: 0.0142s/iter; left time: 157.3987s
	iters: 400, epoch: 1 | loss: 0.2394119
	speed: 0.0142s/iter; left time: 155.9765s
	iters: 500, epoch: 1 | loss: 0.1704829
	speed: 0.0142s/iter; left time: 154.9769s
Epoch: 1 cost time: 9.296292304992676
Epoch: 1, Steps: 570 | Train Loss: 0.1852389 Vali Loss: 0.0390686 Test Loss: 0.1200361
Validation loss decreased (inf --> 0.039069).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1506557
	speed: 0.0457s/iter; left time: 490.0759s
	iters: 200, epoch: 2 | loss: 0.2355483
	speed: 0.0142s/iter; left time: 151.4207s
	iters: 300, epoch: 2 | loss: 0.1674860
	speed: 0.0142s/iter; left time: 149.7465s
	iters: 400, epoch: 2 | loss: 0.1498764
	speed: 0.0143s/iter; left time: 148.6503s
	iters: 500, epoch: 2 | loss: 0.1291158
	speed: 0.0142s/iter; left time: 147.0617s
Epoch: 2 cost time: 8.395573616027832
Epoch: 2, Steps: 570 | Train Loss: 0.1558052 Vali Loss: 0.0364324 Test Loss: 0.1229202
Validation loss decreased (0.039069 --> 0.036432).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1597399
	speed: 0.0469s/iter; left time: 476.1700s
	iters: 200, epoch: 3 | loss: 0.0761815
	speed: 0.0143s/iter; left time: 144.0487s
	iters: 300, epoch: 3 | loss: 0.1524725
	speed: 0.0143s/iter; left time: 142.1639s
	iters: 400, epoch: 3 | loss: 0.1095894
	speed: 0.0143s/iter; left time: 140.8212s
	iters: 500, epoch: 3 | loss: 0.1125388
	speed: 0.0143s/iter; left time: 139.6962s
Epoch: 3 cost time: 8.474654197692871
Epoch: 3, Steps: 570 | Train Loss: 0.1273141 Vali Loss: 0.0354726 Test Loss: 0.1159626
Validation loss decreased (0.036432 --> 0.035473).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1125436
	speed: 0.0455s/iter; left time: 436.0955s
	iters: 200, epoch: 4 | loss: 0.1218719
	speed: 0.0143s/iter; left time: 135.2986s
	iters: 300, epoch: 4 | loss: 0.1170438
	speed: 0.0142s/iter; left time: 133.5297s
	iters: 400, epoch: 4 | loss: 0.0681171
	speed: 0.0142s/iter; left time: 132.0701s
	iters: 500, epoch: 4 | loss: 0.0770603
	speed: 0.0142s/iter; left time: 130.7644s
Epoch: 4 cost time: 8.43222713470459
Epoch: 4, Steps: 570 | Train Loss: 0.1111331 Vali Loss: 0.0332167 Test Loss: 0.1165192
Validation loss decreased (0.035473 --> 0.033217).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0582938
	speed: 0.0493s/iter; left time: 445.0865s
	iters: 200, epoch: 5 | loss: 0.0808735
	speed: 0.0160s/iter; left time: 142.5408s
	iters: 300, epoch: 5 | loss: 0.1255110
	speed: 0.0160s/iter; left time: 141.0894s
	iters: 400, epoch: 5 | loss: 0.0846190
	speed: 0.0159s/iter; left time: 139.0741s
	iters: 500, epoch: 5 | loss: 0.1239723
	speed: 0.0160s/iter; left time: 137.8152s
Epoch: 5 cost time: 9.432737112045288
Epoch: 5, Steps: 570 | Train Loss: 0.0998496 Vali Loss: 0.0335846 Test Loss: 0.1124407
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0829497
	speed: 0.0471s/iter; left time: 397.7350s
	iters: 200, epoch: 6 | loss: 0.1824692
	speed: 0.0142s/iter; left time: 118.7919s
	iters: 300, epoch: 6 | loss: 0.1384225
	speed: 0.0142s/iter; left time: 117.1945s
	iters: 400, epoch: 6 | loss: 0.1213723
	speed: 0.0142s/iter; left time: 115.9970s
	iters: 500, epoch: 6 | loss: 0.1057120
	speed: 0.0142s/iter; left time: 114.6693s
Epoch: 6 cost time: 8.370989561080933
Epoch: 6, Steps: 570 | Train Loss: 0.0947269 Vali Loss: 0.0343582 Test Loss: 0.1162853
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0796793
	speed: 0.0472s/iter; left time: 371.7147s
	iters: 200, epoch: 7 | loss: 0.1019718
	speed: 0.0143s/iter; left time: 111.5523s
	iters: 300, epoch: 7 | loss: 0.1382055
	speed: 0.0144s/iter; left time: 110.4490s
	iters: 400, epoch: 7 | loss: 0.1120844
	speed: 0.0144s/iter; left time: 108.9389s
	iters: 500, epoch: 7 | loss: 0.1253088
	speed: 0.0144s/iter; left time: 107.5242s
Epoch: 7 cost time: 8.588906288146973
Epoch: 7, Steps: 570 | Train Loss: 0.0917960 Vali Loss: 0.0335369 Test Loss: 0.1151851
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11667660623788834, mae:0.2073177695274353
>>> MS_Raw LR=5e-4 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1167674
	speed: 0.0260s/iter; left time: 294.2865s
	iters: 200, epoch: 1 | loss: 0.2955054
	speed: 0.0144s/iter; left time: 160.8360s
	iters: 300, epoch: 1 | loss: 0.2616664
	speed: 0.0143s/iter; left time: 159.0764s
	iters: 400, epoch: 1 | loss: 0.2577615
	speed: 0.0143s/iter; left time: 157.7772s
	iters: 500, epoch: 1 | loss: 0.2450613
	speed: 0.0144s/iter; left time: 156.8572s
Epoch: 1 cost time: 9.4032723903656
Epoch: 1, Steps: 570 | Train Loss: 0.2198592 Vali Loss: 0.0458057 Test Loss: 0.1364354
Validation loss decreased (inf --> 0.045806).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1457091
	speed: 0.0490s/iter; left time: 525.7298s
	iters: 200, epoch: 2 | loss: 0.1517224
	speed: 0.0160s/iter; left time: 170.1578s
	iters: 300, epoch: 2 | loss: 0.1078367
	speed: 0.0160s/iter; left time: 168.3070s
	iters: 400, epoch: 2 | loss: 0.1300821
	speed: 0.0158s/iter; left time: 164.6261s
	iters: 500, epoch: 2 | loss: 0.1867114
	speed: 0.0143s/iter; left time: 148.0873s
Epoch: 2 cost time: 9.135030508041382
Epoch: 2, Steps: 570 | Train Loss: 0.1734601 Vali Loss: 0.0465346 Test Loss: 0.1419535
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1603560
	speed: 0.0449s/iter; left time: 456.5936s
	iters: 200, epoch: 3 | loss: 0.1496567
	speed: 0.0142s/iter; left time: 142.7730s
	iters: 300, epoch: 3 | loss: 0.1131109
	speed: 0.0142s/iter; left time: 141.2855s
	iters: 400, epoch: 3 | loss: 0.1033980
	speed: 0.0142s/iter; left time: 140.4296s
	iters: 500, epoch: 3 | loss: 0.1396991
	speed: 0.0142s/iter; left time: 138.7476s
Epoch: 3 cost time: 8.364190340042114
Epoch: 3, Steps: 570 | Train Loss: 0.1330556 Vali Loss: 0.0399300 Test Loss: 0.1306822
Validation loss decreased (0.045806 --> 0.039930).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1255874
	speed: 0.0493s/iter; left time: 472.7495s
	iters: 200, epoch: 4 | loss: 0.0922611
	speed: 0.0160s/iter; left time: 151.7404s
	iters: 300, epoch: 4 | loss: 0.1204252
	speed: 0.0144s/iter; left time: 135.4796s
	iters: 400, epoch: 4 | loss: 0.0807351
	speed: 0.0141s/iter; left time: 131.4656s
	iters: 500, epoch: 4 | loss: 0.0890441
	speed: 0.0141s/iter; left time: 129.5493s
Epoch: 4 cost time: 8.728670835494995
Epoch: 4, Steps: 570 | Train Loss: 0.1093582 Vali Loss: 0.0405465 Test Loss: 0.1377843
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1012835
	speed: 0.0479s/iter; left time: 431.8332s
	iters: 200, epoch: 5 | loss: 0.1233751
	speed: 0.0143s/iter; left time: 127.6761s
	iters: 300, epoch: 5 | loss: 0.0911026
	speed: 0.0143s/iter; left time: 125.8043s
	iters: 400, epoch: 5 | loss: 0.1299900
	speed: 0.0142s/iter; left time: 124.0854s
	iters: 500, epoch: 5 | loss: 0.0800860
	speed: 0.0142s/iter; left time: 122.5686s
Epoch: 5 cost time: 8.402878284454346
Epoch: 5, Steps: 570 | Train Loss: 0.0979579 Vali Loss: 0.0395616 Test Loss: 0.1374321
Validation loss decreased (0.039930 --> 0.039562).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1015463
	speed: 0.0458s/iter; left time: 387.0744s
	iters: 200, epoch: 6 | loss: 0.0948733
	speed: 0.0142s/iter; left time: 118.3770s
	iters: 300, epoch: 6 | loss: 0.0730019
	speed: 0.0142s/iter; left time: 117.1451s
	iters: 400, epoch: 6 | loss: 0.1324817
	speed: 0.0141s/iter; left time: 115.3199s
	iters: 500, epoch: 6 | loss: 0.0903305
	speed: 0.0142s/iter; left time: 114.0796s
Epoch: 6 cost time: 8.370905876159668
Epoch: 6, Steps: 570 | Train Loss: 0.0920441 Vali Loss: 0.0392771 Test Loss: 0.1379205
Validation loss decreased (0.039562 --> 0.039277).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1402810
	speed: 0.0461s/iter; left time: 363.6462s
	iters: 200, epoch: 7 | loss: 0.0584416
	speed: 0.0143s/iter; left time: 111.5599s
	iters: 300, epoch: 7 | loss: 0.0678023
	speed: 0.0144s/iter; left time: 110.2937s
	iters: 400, epoch: 7 | loss: 0.1021162
	speed: 0.0143s/iter; left time: 108.4358s
	iters: 500, epoch: 7 | loss: 0.0978183
	speed: 0.0143s/iter; left time: 106.6458s
Epoch: 7 cost time: 8.441719770431519
Epoch: 7, Steps: 570 | Train Loss: 0.0904201 Vali Loss: 0.0401387 Test Loss: 0.1376490
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0721863
	speed: 0.0478s/iter; left time: 349.3409s
	iters: 200, epoch: 8 | loss: 0.0762913
	speed: 0.0143s/iter; left time: 102.7671s
	iters: 300, epoch: 8 | loss: 0.0771560
	speed: 0.0143s/iter; left time: 101.3527s
	iters: 400, epoch: 8 | loss: 0.0905376
	speed: 0.0142s/iter; left time: 99.7259s
	iters: 500, epoch: 8 | loss: 0.0657823
	speed: 0.0142s/iter; left time: 98.3175s
Epoch: 8 cost time: 8.378861427307129
Epoch: 8, Steps: 570 | Train Loss: 0.0885404 Vali Loss: 0.0401814 Test Loss: 0.1384605
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1196062
	speed: 0.0445s/iter; left time: 299.7906s
	iters: 200, epoch: 9 | loss: 0.0744827
	speed: 0.0142s/iter; left time: 94.3163s
	iters: 300, epoch: 9 | loss: 0.0610878
	speed: 0.0142s/iter; left time: 92.8581s
	iters: 400, epoch: 9 | loss: 0.0683761
	speed: 0.0142s/iter; left time: 91.5463s
	iters: 500, epoch: 9 | loss: 0.0821749
	speed: 0.0142s/iter; left time: 90.1239s
Epoch: 9 cost time: 8.368259191513062
Epoch: 9, Steps: 570 | Train Loss: 0.0874677 Vali Loss: 0.0394991 Test Loss: 0.1376500
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1380898505449295, mae:0.2346818745136261
>>> MS_Raw LR=5e-4 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2557442
	speed: 0.0287s/iter; left time: 324.2248s
	iters: 200, epoch: 1 | loss: 0.2155398
	speed: 0.0168s/iter; left time: 188.6323s
	iters: 300, epoch: 1 | loss: 0.2420019
	speed: 0.0168s/iter; left time: 186.8407s
	iters: 400, epoch: 1 | loss: 0.2215629
	speed: 0.0168s/iter; left time: 185.1370s
	iters: 500, epoch: 1 | loss: 0.1729687
	speed: 0.0168s/iter; left time: 183.3743s
Epoch: 1 cost time: 10.828773975372314
Epoch: 1, Steps: 570 | Train Loss: 0.2311400 Vali Loss: 0.0515341 Test Loss: 0.1655550
Validation loss decreased (inf --> 0.051534).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2657224
	speed: 0.0512s/iter; left time: 549.5497s
	iters: 200, epoch: 2 | loss: 0.2257499
	speed: 0.0169s/iter; left time: 179.4518s
	iters: 300, epoch: 2 | loss: 0.3500930
	speed: 0.0169s/iter; left time: 177.5685s
	iters: 400, epoch: 2 | loss: 0.2537546
	speed: 0.0169s/iter; left time: 175.9307s
	iters: 500, epoch: 2 | loss: 0.2537118
	speed: 0.0169s/iter; left time: 174.3327s
Epoch: 2 cost time: 9.958146333694458
Epoch: 2, Steps: 570 | Train Loss: 0.2654837 Vali Loss: 0.0593745 Test Loss: 0.1681601
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2091331
	speed: 0.0499s/iter; left time: 507.5288s
	iters: 200, epoch: 3 | loss: 0.2144510
	speed: 0.0170s/iter; left time: 170.9785s
	iters: 300, epoch: 3 | loss: 0.3650085
	speed: 0.0170s/iter; left time: 169.3190s
	iters: 400, epoch: 3 | loss: 0.2017132
	speed: 0.0170s/iter; left time: 167.6354s
	iters: 500, epoch: 3 | loss: 0.1605293
	speed: 0.0170s/iter; left time: 165.7095s
Epoch: 3 cost time: 9.965749740600586
Epoch: 3, Steps: 570 | Train Loss: 0.2349367 Vali Loss: 0.0586023 Test Loss: 0.1637388
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1823092
	speed: 0.0510s/iter; left time: 488.8550s
	iters: 200, epoch: 4 | loss: 0.1900171
	speed: 0.0170s/iter; left time: 160.9293s
	iters: 300, epoch: 4 | loss: 0.2166175
	speed: 0.0170s/iter; left time: 159.4041s
	iters: 400, epoch: 4 | loss: 0.2219737
	speed: 0.0170s/iter; left time: 157.6089s
	iters: 500, epoch: 4 | loss: 0.2073140
	speed: 0.0170s/iter; left time: 155.8442s
Epoch: 4 cost time: 9.956892490386963
Epoch: 4, Steps: 570 | Train Loss: 0.2113202 Vali Loss: 0.0572437 Test Loss: 0.1619374
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16583923995494843, mae:0.2654508650302887
>>> MS_Raw LR=5e-4 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1760582
	speed: 0.0284s/iter; left time: 320.4365s
	iters: 200, epoch: 1 | loss: 0.1070482
	speed: 0.0165s/iter; left time: 184.6352s
	iters: 300, epoch: 1 | loss: 0.2112269
	speed: 0.0165s/iter; left time: 182.9261s
	iters: 400, epoch: 1 | loss: 0.1858908
	speed: 0.0165s/iter; left time: 181.0267s
	iters: 500, epoch: 1 | loss: 0.1099274
	speed: 0.0164s/iter; left time: 178.7314s
Epoch: 1 cost time: 10.61527419090271
Epoch: 1, Steps: 570 | Train Loss: 0.2009359 Vali Loss: 0.0405242 Test Loss: 0.1315651
Validation loss decreased (inf --> 0.040524).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2052581
	speed: 0.0534s/iter; left time: 573.0515s
	iters: 200, epoch: 2 | loss: 0.1780758
	speed: 0.0179s/iter; left time: 190.6896s
	iters: 300, epoch: 2 | loss: 0.3228746
	speed: 0.0179s/iter; left time: 188.5158s
	iters: 400, epoch: 2 | loss: 0.3696241
	speed: 0.0179s/iter; left time: 186.5864s
	iters: 500, epoch: 2 | loss: 0.2204932
	speed: 0.0179s/iter; left time: 184.8214s
Epoch: 2 cost time: 10.53537654876709
Epoch: 2, Steps: 570 | Train Loss: 0.2766150 Vali Loss: 0.0629898 Test Loss: 0.1795397
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2809814
	speed: 0.0535s/iter; left time: 543.5863s
	iters: 200, epoch: 3 | loss: 0.2335446
	speed: 0.0179s/iter; left time: 180.2319s
	iters: 300, epoch: 3 | loss: 0.1699868
	speed: 0.0179s/iter; left time: 178.5271s
	iters: 400, epoch: 3 | loss: 0.2662534
	speed: 0.0171s/iter; left time: 168.3929s
	iters: 500, epoch: 3 | loss: 0.1413514
	speed: 0.0164s/iter; left time: 160.0072s
Epoch: 3 cost time: 10.18321681022644
Epoch: 3, Steps: 570 | Train Loss: 0.2469185 Vali Loss: 0.0556733 Test Loss: 0.1584507
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1767578
	speed: 0.0530s/iter; left time: 507.9400s
	iters: 200, epoch: 4 | loss: 0.4568399
	speed: 0.0166s/iter; left time: 157.3080s
	iters: 300, epoch: 4 | loss: 0.2135920
	speed: 0.0166s/iter; left time: 155.6279s
	iters: 400, epoch: 4 | loss: 0.1967251
	speed: 0.0166s/iter; left time: 153.8304s
	iters: 500, epoch: 4 | loss: 0.3326260
	speed: 0.0165s/iter; left time: 152.0842s
Epoch: 4 cost time: 9.7593355178833
Epoch: 4, Steps: 570 | Train Loss: 0.2256985 Vali Loss: 0.0552150 Test Loss: 0.1522728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13178963959217072, mae:0.22601796686649323
>>> MS_Raw LR=5e-4 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2132356
	speed: 0.0268s/iter; left time: 303.1196s
	iters: 200, epoch: 1 | loss: 0.2197873
	speed: 0.0152s/iter; left time: 170.5612s
	iters: 300, epoch: 1 | loss: 0.1616414
	speed: 0.0152s/iter; left time: 168.5284s
	iters: 400, epoch: 1 | loss: 0.2144824
	speed: 0.0152s/iter; left time: 166.9967s
	iters: 500, epoch: 1 | loss: 0.3870519
	speed: 0.0152s/iter; left time: 165.5702s
Epoch: 1 cost time: 9.878968000411987
Epoch: 1, Steps: 570 | Train Loss: 0.2323277 Vali Loss: 0.0471214 Test Loss: 0.1549581
Validation loss decreased (inf --> 0.047121).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2906809
	speed: 0.0479s/iter; left time: 514.1025s
	iters: 200, epoch: 2 | loss: 0.1560972
	speed: 0.0153s/iter; left time: 162.2342s
	iters: 300, epoch: 2 | loss: 0.3482560
	speed: 0.0152s/iter; left time: 160.5746s
	iters: 400, epoch: 2 | loss: 0.2620814
	speed: 0.0153s/iter; left time: 159.3598s
	iters: 500, epoch: 2 | loss: 0.3732356
	speed: 0.0153s/iter; left time: 157.9389s
Epoch: 2 cost time: 9.02228856086731
Epoch: 2, Steps: 570 | Train Loss: 0.2595969 Vali Loss: 0.0632168 Test Loss: 0.1850292
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2194456
	speed: 0.0472s/iter; left time: 479.7594s
	iters: 200, epoch: 3 | loss: 0.1570438
	speed: 0.0167s/iter; left time: 168.3169s
	iters: 300, epoch: 3 | loss: 0.4517294
	speed: 0.0169s/iter; left time: 168.1936s
	iters: 400, epoch: 3 | loss: 0.2757720
	speed: 0.0169s/iter; left time: 166.6249s
	iters: 500, epoch: 3 | loss: 0.2946413
	speed: 0.0169s/iter; left time: 164.9114s
Epoch: 3 cost time: 9.74096131324768
Epoch: 3, Steps: 570 | Train Loss: 0.2807978 Vali Loss: 0.0621568 Test Loss: 0.1712141
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2104102
	speed: 0.0505s/iter; left time: 484.5685s
	iters: 200, epoch: 4 | loss: 0.3161986
	speed: 0.0154s/iter; left time: 145.9113s
	iters: 300, epoch: 4 | loss: 0.3023233
	speed: 0.0153s/iter; left time: 144.1002s
	iters: 400, epoch: 4 | loss: 0.1917839
	speed: 0.0153s/iter; left time: 142.4333s
	iters: 500, epoch: 4 | loss: 0.2984703
	speed: 0.0153s/iter; left time: 140.7519s
Epoch: 4 cost time: 9.073081731796265
Epoch: 4, Steps: 570 | Train Loss: 0.2446291 Vali Loss: 0.0604046 Test Loss: 0.1626612
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15516559779644012, mae:0.24410508573055267
>>> MS_Raw LR=5e-4 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1601215
	speed: 0.0327s/iter; left time: 369.2646s
	iters: 200, epoch: 1 | loss: 0.2679668
	speed: 0.0209s/iter; left time: 233.6469s
	iters: 300, epoch: 1 | loss: 0.3529364
	speed: 0.0209s/iter; left time: 231.7693s
	iters: 400, epoch: 1 | loss: 0.1937822
	speed: 0.0196s/iter; left time: 215.3888s
	iters: 500, epoch: 1 | loss: 0.1617287
	speed: 0.0188s/iter; left time: 204.6742s
Epoch: 1 cost time: 12.644274711608887
Epoch: 1, Steps: 570 | Train Loss: 0.2158539 Vali Loss: 0.0480296 Test Loss: 0.1407557
Validation loss decreased (inf --> 0.048030).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3049391
	speed: 0.0572s/iter; left time: 613.5628s
	iters: 200, epoch: 2 | loss: 0.1487861
	speed: 0.0187s/iter; left time: 199.2890s
	iters: 300, epoch: 2 | loss: 0.1564662
	speed: 0.0187s/iter; left time: 197.0060s
	iters: 400, epoch: 2 | loss: 0.1327024
	speed: 0.0188s/iter; left time: 195.6498s
	iters: 500, epoch: 2 | loss: 0.1627572
	speed: 0.0187s/iter; left time: 193.6360s
Epoch: 2 cost time: 11.057374238967896
Epoch: 2, Steps: 570 | Train Loss: 0.1726822 Vali Loss: 0.0468829 Test Loss: 0.1471639
Validation loss decreased (0.048030 --> 0.046883).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1179763
	speed: 0.0567s/iter; left time: 575.8614s
	iters: 200, epoch: 3 | loss: 0.1013117
	speed: 0.0187s/iter; left time: 187.7943s
	iters: 300, epoch: 3 | loss: 0.1304374
	speed: 0.0186s/iter; left time: 185.5746s
	iters: 400, epoch: 3 | loss: 0.1004486
	speed: 0.0186s/iter; left time: 183.8572s
	iters: 500, epoch: 3 | loss: 0.0968303
	speed: 0.0187s/iter; left time: 182.0496s
Epoch: 3 cost time: 10.90641188621521
Epoch: 3, Steps: 570 | Train Loss: 0.1370727 Vali Loss: 0.0421463 Test Loss: 0.1415687
Validation loss decreased (0.046883 --> 0.042146).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1208971
	speed: 0.0585s/iter; left time: 560.8311s
	iters: 200, epoch: 4 | loss: 0.1769108
	speed: 0.0197s/iter; left time: 187.2735s
	iters: 300, epoch: 4 | loss: 0.1254952
	speed: 0.0185s/iter; left time: 173.8554s
	iters: 400, epoch: 4 | loss: 0.0638355
	speed: 0.0185s/iter; left time: 172.2026s
	iters: 500, epoch: 4 | loss: 0.1190091
	speed: 0.0185s/iter; left time: 170.2241s
Epoch: 4 cost time: 11.213042497634888
Epoch: 4, Steps: 570 | Train Loss: 0.1120965 Vali Loss: 0.0393526 Test Loss: 0.1339446
Validation loss decreased (0.042146 --> 0.039353).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1096135
	speed: 0.0585s/iter; left time: 527.4084s
	iters: 200, epoch: 5 | loss: 0.1083995
	speed: 0.0187s/iter; left time: 166.3903s
	iters: 300, epoch: 5 | loss: 0.1029091
	speed: 0.0186s/iter; left time: 164.1692s
	iters: 400, epoch: 5 | loss: 0.0780801
	speed: 0.0186s/iter; left time: 162.3336s
	iters: 500, epoch: 5 | loss: 0.0935497
	speed: 0.0187s/iter; left time: 160.8364s
Epoch: 5 cost time: 10.897828817367554
Epoch: 5, Steps: 570 | Train Loss: 0.0984703 Vali Loss: 0.0383031 Test Loss: 0.1369257
Validation loss decreased (0.039353 --> 0.038303).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0612615
	speed: 0.0599s/iter; left time: 505.8547s
	iters: 200, epoch: 6 | loss: 0.0969343
	speed: 0.0209s/iter; left time: 174.6335s
	iters: 300, epoch: 6 | loss: 0.0809905
	speed: 0.0210s/iter; left time: 172.8791s
	iters: 400, epoch: 6 | loss: 0.1350560
	speed: 0.0209s/iter; left time: 170.6797s
	iters: 500, epoch: 6 | loss: 0.0834133
	speed: 0.0209s/iter; left time: 168.3520s
Epoch: 6 cost time: 12.220994472503662
Epoch: 6, Steps: 570 | Train Loss: 0.0927784 Vali Loss: 0.0386098 Test Loss: 0.1366741
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0775667
	speed: 0.0583s/iter; left time: 459.1808s
	iters: 200, epoch: 7 | loss: 0.0709670
	speed: 0.0188s/iter; left time: 146.4848s
	iters: 300, epoch: 7 | loss: 0.0941858
	speed: 0.0187s/iter; left time: 143.7508s
	iters: 400, epoch: 7 | loss: 0.0993690
	speed: 0.0187s/iter; left time: 142.0123s
	iters: 500, epoch: 7 | loss: 0.1505994
	speed: 0.0187s/iter; left time: 139.8728s
Epoch: 7 cost time: 10.985583782196045
Epoch: 7, Steps: 570 | Train Loss: 0.0896315 Vali Loss: 0.0384480 Test Loss: 0.1356376
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0899162
	speed: 0.0615s/iter; left time: 449.8823s
	iters: 200, epoch: 8 | loss: 0.0799357
	speed: 0.0209s/iter; left time: 151.0684s
	iters: 300, epoch: 8 | loss: 0.0750812
	speed: 0.0210s/iter; left time: 149.5303s
	iters: 400, epoch: 8 | loss: 0.1160712
	speed: 0.0210s/iter; left time: 147.1264s
	iters: 500, epoch: 8 | loss: 0.0674134
	speed: 0.0210s/iter; left time: 144.9018s
Epoch: 8 cost time: 12.33284044265747
Epoch: 8, Steps: 570 | Train Loss: 0.0882210 Vali Loss: 0.0388550 Test Loss: 0.1363302
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13711073994636536, mae:0.23102308809757233
>>> MS_Raw LR=5e-4 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3742481
	speed: 0.0323s/iter; left time: 365.3524s
	iters: 200, epoch: 1 | loss: 0.1943786
	speed: 0.0206s/iter; left time: 230.3254s
	iters: 300, epoch: 1 | loss: 0.1684622
	speed: 0.0210s/iter; left time: 232.7183s
	iters: 400, epoch: 1 | loss: 0.1639359
	speed: 0.0211s/iter; left time: 232.1370s
	iters: 500, epoch: 1 | loss: 0.1772284
	speed: 0.0211s/iter; left time: 229.9912s
Epoch: 1 cost time: 13.139686822891235
Epoch: 1, Steps: 570 | Train Loss: 0.1876974 Vali Loss: 0.0407946 Test Loss: 0.1276755
Validation loss decreased (inf --> 0.040795).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1380969
	speed: 0.0606s/iter; left time: 649.9427s
	iters: 200, epoch: 2 | loss: 0.2264183
	speed: 0.0210s/iter; left time: 223.5113s
	iters: 300, epoch: 2 | loss: 0.2026057
	speed: 0.0210s/iter; left time: 221.3269s
	iters: 400, epoch: 2 | loss: 0.2185692
	speed: 0.0210s/iter; left time: 219.4776s
	iters: 500, epoch: 2 | loss: 0.1197596
	speed: 0.0210s/iter; left time: 217.3792s
Epoch: 2 cost time: 12.304228067398071
Epoch: 2, Steps: 570 | Train Loss: 0.1580204 Vali Loss: 0.0412605 Test Loss: 0.1215693
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0871293
	speed: 0.0599s/iter; left time: 608.6166s
	iters: 200, epoch: 3 | loss: 0.1306126
	speed: 0.0206s/iter; left time: 206.9598s
	iters: 300, epoch: 3 | loss: 0.1405563
	speed: 0.0197s/iter; left time: 196.6336s
	iters: 400, epoch: 3 | loss: 0.0955729
	speed: 0.0184s/iter; left time: 181.5424s
	iters: 500, epoch: 3 | loss: 0.1021546
	speed: 0.0184s/iter; left time: 179.6634s
Epoch: 3 cost time: 11.455474615097046
Epoch: 3, Steps: 570 | Train Loss: 0.1316289 Vali Loss: 0.0364323 Test Loss: 0.1165626
Validation loss decreased (0.040795 --> 0.036432).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1236294
	speed: 0.0627s/iter; left time: 601.1371s
	iters: 200, epoch: 4 | loss: 0.0730140
	speed: 0.0205s/iter; left time: 194.7921s
	iters: 300, epoch: 4 | loss: 0.1182805
	speed: 0.0207s/iter; left time: 194.1956s
	iters: 400, epoch: 4 | loss: 0.0956322
	speed: 0.0213s/iter; left time: 197.9095s
	iters: 500, epoch: 4 | loss: 0.0843183
	speed: 0.0212s/iter; left time: 194.5967s
Epoch: 4 cost time: 12.215018272399902
Epoch: 4, Steps: 570 | Train Loss: 0.1119665 Vali Loss: 0.0349799 Test Loss: 0.1142847
Validation loss decreased (0.036432 --> 0.034980).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0831127
	speed: 0.0613s/iter; left time: 552.7950s
	iters: 200, epoch: 5 | loss: 0.0967013
	speed: 0.0212s/iter; left time: 189.3050s
	iters: 300, epoch: 5 | loss: 0.0894479
	speed: 0.0206s/iter; left time: 181.7602s
	iters: 400, epoch: 5 | loss: 0.0886109
	speed: 0.0203s/iter; left time: 176.6766s
	iters: 500, epoch: 5 | loss: 0.0990796
	speed: 0.0183s/iter; left time: 157.8262s
Epoch: 5 cost time: 11.792809247970581
Epoch: 5, Steps: 570 | Train Loss: 0.0984995 Vali Loss: 0.0343408 Test Loss: 0.1158925
Validation loss decreased (0.034980 --> 0.034341).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1077913
	speed: 0.0590s/iter; left time: 498.6642s
	iters: 200, epoch: 6 | loss: 0.0714055
	speed: 0.0183s/iter; left time: 152.4272s
	iters: 300, epoch: 6 | loss: 0.1109908
	speed: 0.0183s/iter; left time: 150.9915s
	iters: 400, epoch: 6 | loss: 0.0810228
	speed: 0.0183s/iter; left time: 149.0488s
	iters: 500, epoch: 6 | loss: 0.0629373
	speed: 0.0182s/iter; left time: 146.8135s
Epoch: 6 cost time: 10.722545623779297
Epoch: 6, Steps: 570 | Train Loss: 0.0925016 Vali Loss: 0.0345410 Test Loss: 0.1169708
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0780927
	speed: 0.0560s/iter; left time: 441.0582s
	iters: 200, epoch: 7 | loss: 0.1124896
	speed: 0.0183s/iter; left time: 142.7359s
	iters: 300, epoch: 7 | loss: 0.0596608
	speed: 0.0183s/iter; left time: 140.8334s
	iters: 400, epoch: 7 | loss: 0.1044410
	speed: 0.0182s/iter; left time: 138.3514s
	iters: 500, epoch: 7 | loss: 0.0788359
	speed: 0.0182s/iter; left time: 136.2711s
Epoch: 7 cost time: 10.735435962677002
Epoch: 7, Steps: 570 | Train Loss: 0.0886925 Vali Loss: 0.0339803 Test Loss: 0.1164838
Validation loss decreased (0.034341 --> 0.033980).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0700560
	speed: 0.0577s/iter; left time: 422.1617s
	iters: 200, epoch: 8 | loss: 0.0891792
	speed: 0.0207s/iter; left time: 148.9516s
	iters: 300, epoch: 8 | loss: 0.0794379
	speed: 0.0187s/iter; left time: 132.6759s
	iters: 400, epoch: 8 | loss: 0.0846472
	speed: 0.0183s/iter; left time: 128.4494s
	iters: 500, epoch: 8 | loss: 0.1003609
	speed: 0.0183s/iter; left time: 126.4363s
Epoch: 8 cost time: 11.328595876693726
Epoch: 8, Steps: 570 | Train Loss: 0.0865921 Vali Loss: 0.0339551 Test Loss: 0.1166554
Validation loss decreased (0.033980 --> 0.033955).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0524424
	speed: 0.0612s/iter; left time: 412.4878s
	iters: 200, epoch: 9 | loss: 0.0777009
	speed: 0.0212s/iter; left time: 140.7460s
	iters: 300, epoch: 9 | loss: 0.0828364
	speed: 0.0212s/iter; left time: 138.8084s
	iters: 400, epoch: 9 | loss: 0.0816082
	speed: 0.0212s/iter; left time: 136.8291s
	iters: 500, epoch: 9 | loss: 0.0778431
	speed: 0.0211s/iter; left time: 134.0600s
Epoch: 9 cost time: 12.377849102020264
Epoch: 9, Steps: 570 | Train Loss: 0.0863239 Vali Loss: 0.0340197 Test Loss: 0.1164078
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0703812
	speed: 0.0606s/iter; left time: 374.0483s
	iters: 200, epoch: 10 | loss: 0.0600727
	speed: 0.0198s/iter; left time: 120.1897s
	iters: 300, epoch: 10 | loss: 0.1222803
	speed: 0.0183s/iter; left time: 109.5221s
	iters: 400, epoch: 10 | loss: 0.0940767
	speed: 0.0196s/iter; left time: 115.3249s
	iters: 500, epoch: 10 | loss: 0.0836515
	speed: 0.0205s/iter; left time: 118.0520s
Epoch: 10 cost time: 11.659680604934692
Epoch: 10, Steps: 570 | Train Loss: 0.0867250 Vali Loss: 0.0338425 Test Loss: 0.1164990
Validation loss decreased (0.033955 --> 0.033843).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0886704
	speed: 0.0606s/iter; left time: 339.4293s
	iters: 200, epoch: 11 | loss: 0.0949598
	speed: 0.0206s/iter; left time: 113.3484s
	iters: 300, epoch: 11 | loss: 0.0609087
	speed: 0.0206s/iter; left time: 111.4826s
	iters: 400, epoch: 11 | loss: 0.1235714
	speed: 0.0207s/iter; left time: 109.7420s
	iters: 500, epoch: 11 | loss: 0.1064821
	speed: 0.0206s/iter; left time: 107.2167s
Epoch: 11 cost time: 12.058775901794434
Epoch: 11, Steps: 570 | Train Loss: 0.0859769 Vali Loss: 0.0337616 Test Loss: 0.1164080
Validation loss decreased (0.033843 --> 0.033762).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1195657
	speed: 0.0588s/iter; left time: 295.9241s
	iters: 200, epoch: 12 | loss: 0.0771970
	speed: 0.0183s/iter; left time: 90.4215s
	iters: 300, epoch: 12 | loss: 0.0692294
	speed: 0.0183s/iter; left time: 88.5974s
	iters: 400, epoch: 12 | loss: 0.0837279
	speed: 0.0184s/iter; left time: 86.9548s
	iters: 500, epoch: 12 | loss: 0.0855555
	speed: 0.0183s/iter; left time: 84.9419s
Epoch: 12 cost time: 10.77449631690979
Epoch: 12, Steps: 570 | Train Loss: 0.0858482 Vali Loss: 0.0338301 Test Loss: 0.1163966
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0759818
	speed: 0.0580s/iter; left time: 258.9512s
	iters: 200, epoch: 13 | loss: 0.0878199
	speed: 0.0207s/iter; left time: 90.2816s
	iters: 300, epoch: 13 | loss: 0.0670783
	speed: 0.0207s/iter; left time: 88.4034s
	iters: 400, epoch: 13 | loss: 0.1085088
	speed: 0.0192s/iter; left time: 79.7914s
	iters: 500, epoch: 13 | loss: 0.1070844
	speed: 0.0211s/iter; left time: 85.8660s
Epoch: 13 cost time: 12.033950090408325
Epoch: 13, Steps: 570 | Train Loss: 0.0867677 Vali Loss: 0.0338175 Test Loss: 0.1164519
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.0902542
	speed: 0.0606s/iter; left time: 235.7082s
	iters: 200, epoch: 14 | loss: 0.0839087
	speed: 0.0211s/iter; left time: 79.9447s
	iters: 300, epoch: 14 | loss: 0.0895629
	speed: 0.0211s/iter; left time: 77.8413s
	iters: 400, epoch: 14 | loss: 0.0804068
	speed: 0.0210s/iter; left time: 75.3175s
	iters: 500, epoch: 14 | loss: 0.0657523
	speed: 0.0205s/iter; left time: 71.4287s
Epoch: 14 cost time: 12.164124965667725
Epoch: 14, Steps: 570 | Train Loss: 0.0862531 Vali Loss: 0.0338502 Test Loss: 0.1164589
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11655744165182114, mae:0.20830540359020233
>>> MS_Raw LR=5e-4 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2465455
	speed: 0.0330s/iter; left time: 373.1110s
	iters: 200, epoch: 1 | loss: 0.1742174
	speed: 0.0205s/iter; left time: 229.9221s
	iters: 300, epoch: 1 | loss: 0.2763492
	speed: 0.0195s/iter; left time: 216.5714s
	iters: 400, epoch: 1 | loss: 0.2178470
	speed: 0.0184s/iter; left time: 202.0679s
	iters: 500, epoch: 1 | loss: 0.2626901
	speed: 0.0184s/iter; left time: 200.1304s
Epoch: 1 cost time: 12.353875398635864
Epoch: 1, Steps: 570 | Train Loss: 0.2196197 Vali Loss: 0.0462815 Test Loss: 0.1330467
Validation loss decreased (inf --> 0.046282).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2293462
	speed: 0.0586s/iter; left time: 628.4397s
	iters: 200, epoch: 2 | loss: 0.1865129
	speed: 0.0183s/iter; left time: 194.9197s
	iters: 300, epoch: 2 | loss: 0.3665048
	speed: 0.0184s/iter; left time: 193.3041s
	iters: 400, epoch: 2 | loss: 0.1814012
	speed: 0.0184s/iter; left time: 191.4656s
	iters: 500, epoch: 2 | loss: 0.1074840
	speed: 0.0183s/iter; left time: 189.4021s
Epoch: 2 cost time: 10.764797687530518
Epoch: 2, Steps: 570 | Train Loss: 0.1843974 Vali Loss: 0.0468489 Test Loss: 0.1434171
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1040126
	speed: 0.0603s/iter; left time: 612.5618s
	iters: 200, epoch: 3 | loss: 0.1511192
	speed: 0.0211s/iter; left time: 212.5864s
	iters: 300, epoch: 3 | loss: 0.1757332
	speed: 0.0211s/iter; left time: 210.0976s
	iters: 400, epoch: 3 | loss: 0.1398604
	speed: 0.0211s/iter; left time: 208.1526s
	iters: 500, epoch: 3 | loss: 0.1326717
	speed: 0.0211s/iter; left time: 206.2333s
Epoch: 3 cost time: 12.322081804275513
Epoch: 3, Steps: 570 | Train Loss: 0.1427732 Vali Loss: 0.0422266 Test Loss: 0.1323110
Validation loss decreased (0.046282 --> 0.042227).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0990643
	speed: 0.0601s/iter; left time: 576.5689s
	iters: 200, epoch: 4 | loss: 0.1284356
	speed: 0.0195s/iter; left time: 185.2556s
	iters: 300, epoch: 4 | loss: 0.1189185
	speed: 0.0182s/iter; left time: 170.7789s
	iters: 400, epoch: 4 | loss: 0.1148597
	speed: 0.0182s/iter; left time: 168.9951s
	iters: 500, epoch: 4 | loss: 0.0875525
	speed: 0.0181s/iter; left time: 166.7623s
Epoch: 4 cost time: 11.057256698608398
Epoch: 4, Steps: 570 | Train Loss: 0.1152169 Vali Loss: 0.0403422 Test Loss: 0.1315215
Validation loss decreased (0.042227 --> 0.040342).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0930144
	speed: 0.0552s/iter; left time: 497.9349s
	iters: 200, epoch: 5 | loss: 0.1091283
	speed: 0.0183s/iter; left time: 163.2098s
	iters: 300, epoch: 5 | loss: 0.0675936
	speed: 0.0183s/iter; left time: 161.2207s
	iters: 400, epoch: 5 | loss: 0.0938081
	speed: 0.0183s/iter; left time: 159.3805s
	iters: 500, epoch: 5 | loss: 0.0558497
	speed: 0.0183s/iter; left time: 157.3900s
Epoch: 5 cost time: 10.689748525619507
Epoch: 5, Steps: 570 | Train Loss: 0.1007919 Vali Loss: 0.0410147 Test Loss: 0.1349144
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1119724
	speed: 0.0548s/iter; left time: 462.8800s
	iters: 200, epoch: 6 | loss: 0.0632188
	speed: 0.0183s/iter; left time: 152.5317s
	iters: 300, epoch: 6 | loss: 0.1177115
	speed: 0.0182s/iter; left time: 150.3262s
	iters: 400, epoch: 6 | loss: 0.0846691
	speed: 0.0182s/iter; left time: 148.2642s
	iters: 500, epoch: 6 | loss: 0.0950823
	speed: 0.0182s/iter; left time: 146.6579s
Epoch: 6 cost time: 10.682338237762451
Epoch: 6, Steps: 570 | Train Loss: 0.0944268 Vali Loss: 0.0401300 Test Loss: 0.1352709
Validation loss decreased (0.040342 --> 0.040130).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0799287
	speed: 0.0559s/iter; left time: 440.8094s
	iters: 200, epoch: 7 | loss: 0.0747626
	speed: 0.0184s/iter; left time: 143.0078s
	iters: 300, epoch: 7 | loss: 0.1034898
	speed: 0.0183s/iter; left time: 140.6814s
	iters: 400, epoch: 7 | loss: 0.0954349
	speed: 0.0184s/iter; left time: 139.3001s
	iters: 500, epoch: 7 | loss: 0.0578673
	speed: 0.0184s/iter; left time: 137.3212s
Epoch: 7 cost time: 10.786954164505005
Epoch: 7, Steps: 570 | Train Loss: 0.0923948 Vali Loss: 0.0397917 Test Loss: 0.1350439
Validation loss decreased (0.040130 --> 0.039792).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0772300
	speed: 0.0603s/iter; left time: 440.6368s
	iters: 200, epoch: 8 | loss: 0.0666272
	speed: 0.0186s/iter; left time: 134.2908s
	iters: 300, epoch: 8 | loss: 0.0906120
	speed: 0.0182s/iter; left time: 129.2625s
	iters: 400, epoch: 8 | loss: 0.1087127
	speed: 0.0182s/iter; left time: 127.5375s
	iters: 500, epoch: 8 | loss: 0.0791122
	speed: 0.0182s/iter; left time: 125.5105s
Epoch: 8 cost time: 10.931132793426514
Epoch: 8, Steps: 570 | Train Loss: 0.0900067 Vali Loss: 0.0397980 Test Loss: 0.1351777
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0902390
	speed: 0.0564s/iter; left time: 379.9701s
	iters: 200, epoch: 9 | loss: 0.1244761
	speed: 0.0181s/iter; left time: 120.5084s
	iters: 300, epoch: 9 | loss: 0.1000864
	speed: 0.0181s/iter; left time: 118.5913s
	iters: 400, epoch: 9 | loss: 0.1546550
	speed: 0.0181s/iter; left time: 116.6105s
	iters: 500, epoch: 9 | loss: 0.0599694
	speed: 0.0181s/iter; left time: 114.9166s
Epoch: 9 cost time: 10.606695652008057
Epoch: 9, Steps: 570 | Train Loss: 0.0894911 Vali Loss: 0.0397211 Test Loss: 0.1346833
Validation loss decreased (0.039792 --> 0.039721).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0847079
	speed: 0.0565s/iter; left time: 348.6069s
	iters: 200, epoch: 10 | loss: 0.0722764
	speed: 0.0184s/iter; left time: 111.6004s
	iters: 300, epoch: 10 | loss: 0.0958148
	speed: 0.0183s/iter; left time: 109.4935s
	iters: 400, epoch: 10 | loss: 0.0959902
	speed: 0.0183s/iter; left time: 107.6820s
	iters: 500, epoch: 10 | loss: 0.0901856
	speed: 0.0183s/iter; left time: 105.8609s
Epoch: 10 cost time: 10.764179944992065
Epoch: 10, Steps: 570 | Train Loss: 0.0890617 Vali Loss: 0.0394520 Test Loss: 0.1355194
Validation loss decreased (0.039721 --> 0.039452).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0883052
	speed: 0.0573s/iter; left time: 321.0525s
	iters: 200, epoch: 11 | loss: 0.0981652
	speed: 0.0183s/iter; left time: 100.4506s
	iters: 300, epoch: 11 | loss: 0.0668945
	speed: 0.0183s/iter; left time: 98.7472s
	iters: 400, epoch: 11 | loss: 0.1120059
	speed: 0.0183s/iter; left time: 96.8970s
	iters: 500, epoch: 11 | loss: 0.0745076
	speed: 0.0183s/iter; left time: 94.9550s
Epoch: 11 cost time: 10.689029932022095
Epoch: 11, Steps: 570 | Train Loss: 0.0892274 Vali Loss: 0.0395513 Test Loss: 0.1355649
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0855307
	speed: 0.0560s/iter; left time: 281.7834s
	iters: 200, epoch: 12 | loss: 0.1050664
	speed: 0.0182s/iter; left time: 89.9090s
	iters: 300, epoch: 12 | loss: 0.0800592
	speed: 0.0183s/iter; left time: 88.2411s
	iters: 400, epoch: 12 | loss: 0.0910716
	speed: 0.0182s/iter; left time: 86.2373s
	iters: 500, epoch: 12 | loss: 0.0960518
	speed: 0.0182s/iter; left time: 84.2172s
Epoch: 12 cost time: 10.63782811164856
Epoch: 12, Steps: 570 | Train Loss: 0.0887536 Vali Loss: 0.0395426 Test Loss: 0.1356473
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0758656
	speed: 0.0544s/iter; left time: 242.7543s
	iters: 200, epoch: 13 | loss: 0.0575939
	speed: 0.0182s/iter; left time: 79.5284s
	iters: 300, epoch: 13 | loss: 0.0811126
	speed: 0.0182s/iter; left time: 77.6607s
	iters: 400, epoch: 13 | loss: 0.0636982
	speed: 0.0182s/iter; left time: 75.7967s
	iters: 500, epoch: 13 | loss: 0.0718686
	speed: 0.0183s/iter; left time: 74.1217s
Epoch: 13 cost time: 10.644042730331421
Epoch: 13, Steps: 570 | Train Loss: 0.0880837 Vali Loss: 0.0396148 Test Loss: 0.1357707
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1356518715620041, mae:0.23420971632003784
>>> MS_Raw LR=5e-4 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2044321
	speed: 0.0363s/iter; left time: 409.8072s
	iters: 200, epoch: 1 | loss: 0.1907370
	speed: 0.0239s/iter; left time: 268.1922s
	iters: 300, epoch: 1 | loss: 0.2209329
	speed: 0.0226s/iter; left time: 251.1401s
	iters: 400, epoch: 1 | loss: 0.3088663
	speed: 0.0221s/iter; left time: 243.0136s
	iters: 500, epoch: 1 | loss: 0.3752808
	speed: 0.0221s/iter; left time: 240.7930s
Epoch: 1 cost time: 14.305854797363281
Epoch: 1, Steps: 570 | Train Loss: 0.2527241 Vali Loss: 0.0623574 Test Loss: 0.1859929
Validation loss decreased (inf --> 0.062357).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3072649
	speed: 0.0667s/iter; left time: 715.4694s
	iters: 200, epoch: 2 | loss: 0.2502496
	speed: 0.0230s/iter; left time: 244.8562s
	iters: 300, epoch: 2 | loss: 0.1918114
	speed: 0.0220s/iter; left time: 231.8309s
	iters: 400, epoch: 2 | loss: 0.3376081
	speed: 0.0226s/iter; left time: 235.8763s
	iters: 500, epoch: 2 | loss: 0.2363885
	speed: 0.0240s/iter; left time: 247.6745s
Epoch: 2 cost time: 13.560559511184692
Epoch: 2, Steps: 570 | Train Loss: 0.2683277 Vali Loss: 0.0661320 Test Loss: 0.1890021
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4923572
	speed: 0.0640s/iter; left time: 650.1734s
	iters: 200, epoch: 3 | loss: 0.1829364
	speed: 0.0222s/iter; left time: 223.4075s
	iters: 300, epoch: 3 | loss: 0.2508573
	speed: 0.0222s/iter; left time: 220.7227s
	iters: 400, epoch: 3 | loss: 0.2537628
	speed: 0.0222s/iter; left time: 218.6963s
	iters: 500, epoch: 3 | loss: 0.1679934
	speed: 0.0222s/iter; left time: 216.3155s
Epoch: 3 cost time: 12.947141885757446
Epoch: 3, Steps: 570 | Train Loss: 0.2455218 Vali Loss: 0.0570564 Test Loss: 0.1525956
Validation loss decreased (0.062357 --> 0.057056).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1775687
	speed: 0.0670s/iter; left time: 642.1816s
	iters: 200, epoch: 4 | loss: 0.1459089
	speed: 0.0221s/iter; left time: 209.3677s
	iters: 300, epoch: 4 | loss: 0.2227755
	speed: 0.0220s/iter; left time: 206.8180s
	iters: 400, epoch: 4 | loss: 0.1869705
	speed: 0.0220s/iter; left time: 204.3703s
	iters: 500, epoch: 4 | loss: 0.2770719
	speed: 0.0220s/iter; left time: 201.9333s
Epoch: 4 cost time: 13.054447889328003
Epoch: 4, Steps: 570 | Train Loss: 0.2214344 Vali Loss: 0.0565339 Test Loss: 0.1514897
Validation loss decreased (0.057056 --> 0.056534).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2272343
	speed: 0.0633s/iter; left time: 571.0938s
	iters: 200, epoch: 5 | loss: 0.1697168
	speed: 0.0222s/iter; left time: 197.8083s
	iters: 300, epoch: 5 | loss: 0.1575013
	speed: 0.0222s/iter; left time: 195.7330s
	iters: 400, epoch: 5 | loss: 0.2007736
	speed: 0.0222s/iter; left time: 193.2992s
	iters: 500, epoch: 5 | loss: 0.2119050
	speed: 0.0222s/iter; left time: 191.1336s
Epoch: 5 cost time: 12.97317123413086
Epoch: 5, Steps: 570 | Train Loss: 0.2082672 Vali Loss: 0.0547199 Test Loss: 0.1453940
Validation loss decreased (0.056534 --> 0.054720).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1648124
	speed: 0.0631s/iter; left time: 533.0890s
	iters: 200, epoch: 6 | loss: 0.3070776
	speed: 0.0220s/iter; left time: 183.4233s
	iters: 300, epoch: 6 | loss: 0.1929084
	speed: 0.0220s/iter; left time: 181.1558s
	iters: 400, epoch: 6 | loss: 0.1536869
	speed: 0.0219s/iter; left time: 178.9083s
	iters: 500, epoch: 6 | loss: 0.2804589
	speed: 0.0220s/iter; left time: 176.7757s
Epoch: 6 cost time: 12.829725742340088
Epoch: 6, Steps: 570 | Train Loss: 0.2023327 Vali Loss: 0.0543583 Test Loss: 0.1462831
Validation loss decreased (0.054720 --> 0.054358).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2472715
	speed: 0.0659s/iter; left time: 519.2380s
	iters: 200, epoch: 7 | loss: 0.1912365
	speed: 0.0222s/iter; left time: 172.3836s
	iters: 300, epoch: 7 | loss: 0.1569330
	speed: 0.0221s/iter; left time: 169.9949s
	iters: 400, epoch: 7 | loss: 0.1843344
	speed: 0.0221s/iter; left time: 167.7003s
	iters: 500, epoch: 7 | loss: 0.2040082
	speed: 0.0221s/iter; left time: 165.4265s
Epoch: 7 cost time: 12.9348726272583
Epoch: 7, Steps: 570 | Train Loss: 0.1976341 Vali Loss: 0.0550024 Test Loss: 0.1458890
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1246326
	speed: 0.0640s/iter; left time: 467.9252s
	iters: 200, epoch: 8 | loss: 0.4012249
	speed: 0.0220s/iter; left time: 158.7660s
	iters: 300, epoch: 8 | loss: 0.1279386
	speed: 0.0220s/iter; left time: 156.5581s
	iters: 400, epoch: 8 | loss: 0.1646966
	speed: 0.0220s/iter; left time: 154.2251s
	iters: 500, epoch: 8 | loss: 0.1723369
	speed: 0.0220s/iter; left time: 152.1231s
Epoch: 8 cost time: 12.837534189224243
Epoch: 8, Steps: 570 | Train Loss: 0.1953455 Vali Loss: 0.0543657 Test Loss: 0.1452569
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1745945
	speed: 0.0653s/iter; left time: 440.3339s
	iters: 200, epoch: 9 | loss: 0.1344898
	speed: 0.0236s/iter; left time: 156.9673s
	iters: 300, epoch: 9 | loss: 0.2274153
	speed: 0.0220s/iter; left time: 144.2193s
	iters: 400, epoch: 9 | loss: 0.1888725
	speed: 0.0220s/iter; left time: 141.9144s
	iters: 500, epoch: 9 | loss: 0.1694360
	speed: 0.0220s/iter; left time: 139.7637s
Epoch: 9 cost time: 13.199166774749756
Epoch: 9, Steps: 570 | Train Loss: 0.1939532 Vali Loss: 0.0545372 Test Loss: 0.1449776
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14646118879318237, mae:0.24671439826488495
>>> MS_Raw LR=5e-4 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2160419
	speed: 0.0331s/iter; left time: 374.0284s
	iters: 200, epoch: 1 | loss: 0.1162213
	speed: 0.0213s/iter; left time: 238.7968s
	iters: 300, epoch: 1 | loss: 0.1844167
	speed: 0.0213s/iter; left time: 236.4658s
	iters: 400, epoch: 1 | loss: 0.1534699
	speed: 0.0213s/iter; left time: 234.4042s
	iters: 500, epoch: 1 | loss: 0.1646366
	speed: 0.0213s/iter; left time: 232.5554s
Epoch: 1 cost time: 13.381217002868652
Epoch: 1, Steps: 570 | Train Loss: 0.2125935 Vali Loss: 0.0405905 Test Loss: 0.1299499
Validation loss decreased (inf --> 0.040591).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2203218
	speed: 0.0642s/iter; left time: 689.1340s
	iters: 200, epoch: 2 | loss: 0.2456415
	speed: 0.0219s/iter; left time: 232.4602s
	iters: 300, epoch: 2 | loss: 0.5099041
	speed: 0.0214s/iter; left time: 225.0429s
	iters: 400, epoch: 2 | loss: 0.2630272
	speed: 0.0214s/iter; left time: 222.9710s
	iters: 500, epoch: 2 | loss: 0.2143973
	speed: 0.0214s/iter; left time: 220.7461s
Epoch: 2 cost time: 12.753188610076904
Epoch: 2, Steps: 570 | Train Loss: 0.2649165 Vali Loss: 0.0637003 Test Loss: 0.1830065
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2386678
	speed: 0.0609s/iter; left time: 619.2559s
	iters: 200, epoch: 3 | loss: 0.2139221
	speed: 0.0213s/iter; left time: 214.4858s
	iters: 300, epoch: 3 | loss: 0.1634926
	speed: 0.0213s/iter; left time: 212.4905s
	iters: 400, epoch: 3 | loss: 0.1910556
	speed: 0.0213s/iter; left time: 210.1657s
	iters: 500, epoch: 3 | loss: 0.2340789
	speed: 0.0213s/iter; left time: 208.1115s
Epoch: 3 cost time: 12.45103931427002
Epoch: 3, Steps: 570 | Train Loss: 0.2446887 Vali Loss: 0.0576729 Test Loss: 0.1636531
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1887436
	speed: 0.0606s/iter; left time: 581.6216s
	iters: 200, epoch: 4 | loss: 0.2005028
	speed: 0.0213s/iter; left time: 202.0280s
	iters: 300, epoch: 4 | loss: 0.2122133
	speed: 0.0213s/iter; left time: 200.0988s
	iters: 400, epoch: 4 | loss: 0.2909198
	speed: 0.0213s/iter; left time: 197.8455s
	iters: 500, epoch: 4 | loss: 0.1725634
	speed: 0.0213s/iter; left time: 195.7322s
Epoch: 4 cost time: 12.41495418548584
Epoch: 4, Steps: 570 | Train Loss: 0.2258179 Vali Loss: 0.0539668 Test Loss: 0.1522814
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13016191124916077, mae:0.22739572823047638
>>> MS_Raw LR=5e-4 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2422605
	speed: 0.0344s/iter; left time: 388.2708s
	iters: 200, epoch: 1 | loss: 0.1829510
	speed: 0.0223s/iter; left time: 249.7938s
	iters: 300, epoch: 1 | loss: 0.2373776
	speed: 0.0225s/iter; left time: 249.5937s
	iters: 400, epoch: 1 | loss: 0.3229593
	speed: 0.0232s/iter; left time: 255.4666s
	iters: 500, epoch: 1 | loss: 0.4051868
	speed: 0.0211s/iter; left time: 229.7754s
Epoch: 1 cost time: 13.817939281463623
Epoch: 1, Steps: 570 | Train Loss: 0.2792140 Vali Loss: 0.0759798 Test Loss: 0.2162345
Validation loss decreased (inf --> 0.075980).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2276985
	speed: 0.0624s/iter; left time: 669.6828s
	iters: 200, epoch: 2 | loss: 0.4476156
	speed: 0.0202s/iter; left time: 215.0362s
	iters: 300, epoch: 2 | loss: 0.2548041
	speed: 0.0207s/iter; left time: 218.1406s
	iters: 400, epoch: 2 | loss: 0.1816117
	speed: 0.0232s/iter; left time: 242.0652s
	iters: 500, epoch: 2 | loss: 0.1685787
	speed: 0.0232s/iter; left time: 239.7407s
Epoch: 2 cost time: 12.664169073104858
Epoch: 2, Steps: 570 | Train Loss: 0.2823152 Vali Loss: 0.0623125 Test Loss: 0.1725155
Validation loss decreased (0.075980 --> 0.062312).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1956048
	speed: 0.0645s/iter; left time: 655.2074s
	iters: 200, epoch: 3 | loss: 0.1986732
	speed: 0.0232s/iter; left time: 233.6382s
	iters: 300, epoch: 3 | loss: 0.2300066
	speed: 0.0232s/iter; left time: 231.0875s
	iters: 400, epoch: 3 | loss: 0.2127498
	speed: 0.0232s/iter; left time: 228.9510s
	iters: 500, epoch: 3 | loss: 0.2054931
	speed: 0.0232s/iter; left time: 226.3437s
Epoch: 3 cost time: 13.553040742874146
Epoch: 3, Steps: 570 | Train Loss: 0.2416417 Vali Loss: 0.0628371 Test Loss: 0.1696558
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1648703
	speed: 0.0633s/iter; left time: 607.3372s
	iters: 200, epoch: 4 | loss: 0.4601944
	speed: 0.0203s/iter; left time: 192.4205s
	iters: 300, epoch: 4 | loss: 0.1544110
	speed: 0.0202s/iter; left time: 190.1517s
	iters: 400, epoch: 4 | loss: 0.2180265
	speed: 0.0202s/iter; left time: 187.8862s
	iters: 500, epoch: 4 | loss: 0.1886454
	speed: 0.0202s/iter; left time: 185.9563s
Epoch: 4 cost time: 11.856116533279419
Epoch: 4, Steps: 570 | Train Loss: 0.2286725 Vali Loss: 0.0597612 Test Loss: 0.1620128
Validation loss decreased (0.062312 --> 0.059761).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1822467
	speed: 0.0604s/iter; left time: 544.7807s
	iters: 200, epoch: 5 | loss: 0.2959248
	speed: 0.0201s/iter; left time: 179.2222s
	iters: 300, epoch: 5 | loss: 0.1727977
	speed: 0.0230s/iter; left time: 203.3094s
	iters: 400, epoch: 5 | loss: 0.1904349
	speed: 0.0230s/iter; left time: 200.9685s
	iters: 500, epoch: 5 | loss: 0.2039821
	speed: 0.0231s/iter; left time: 199.0772s
Epoch: 5 cost time: 12.84210467338562
Epoch: 5, Steps: 570 | Train Loss: 0.2188623 Vali Loss: 0.0574483 Test Loss: 0.1568991
Validation loss decreased (0.059761 --> 0.057448).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2260060
	speed: 0.0665s/iter; left time: 561.7204s
	iters: 200, epoch: 6 | loss: 0.2270817
	speed: 0.0232s/iter; left time: 193.8711s
	iters: 300, epoch: 6 | loss: 0.2142158
	speed: 0.0232s/iter; left time: 191.5231s
	iters: 400, epoch: 6 | loss: 0.1900075
	speed: 0.0232s/iter; left time: 189.1106s
	iters: 500, epoch: 6 | loss: 0.2526564
	speed: 0.0232s/iter; left time: 186.9199s
Epoch: 6 cost time: 13.533343076705933
Epoch: 6, Steps: 570 | Train Loss: 0.2127382 Vali Loss: 0.0570407 Test Loss: 0.1548477
Validation loss decreased (0.057448 --> 0.057041).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1727831
	speed: 0.0671s/iter; left time: 528.4704s
	iters: 200, epoch: 7 | loss: 0.2374889
	speed: 0.0232s/iter; left time: 180.3697s
	iters: 300, epoch: 7 | loss: 0.2728970
	speed: 0.0231s/iter; left time: 177.6776s
	iters: 400, epoch: 7 | loss: 0.2354636
	speed: 0.0231s/iter; left time: 175.4172s
	iters: 500, epoch: 7 | loss: 0.1577698
	speed: 0.0231s/iter; left time: 173.0961s
Epoch: 7 cost time: 13.502089262008667
Epoch: 7, Steps: 570 | Train Loss: 0.2092387 Vali Loss: 0.0582214 Test Loss: 0.1559023
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2333621
	speed: 0.0662s/iter; left time: 484.2295s
	iters: 200, epoch: 8 | loss: 0.3190812
	speed: 0.0231s/iter; left time: 166.5308s
	iters: 300, epoch: 8 | loss: 0.2758017
	speed: 0.0231s/iter; left time: 164.3075s
	iters: 400, epoch: 8 | loss: 0.1584807
	speed: 0.0231s/iter; left time: 161.9970s
	iters: 500, epoch: 8 | loss: 0.2110446
	speed: 0.0231s/iter; left time: 159.5587s
Epoch: 8 cost time: 13.436898708343506
Epoch: 8, Steps: 570 | Train Loss: 0.2084264 Vali Loss: 0.0572500 Test Loss: 0.1541620
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1923905
	speed: 0.0640s/iter; left time: 431.5568s
	iters: 200, epoch: 9 | loss: 0.1711386
	speed: 0.0232s/iter; left time: 154.0211s
	iters: 300, epoch: 9 | loss: 0.2769994
	speed: 0.0231s/iter; left time: 150.9521s
	iters: 400, epoch: 9 | loss: 0.1681122
	speed: 0.0231s/iter; left time: 148.5441s
	iters: 500, epoch: 9 | loss: 0.1237359
	speed: 0.0231s/iter; left time: 146.6064s
Epoch: 9 cost time: 13.451696634292603
Epoch: 9, Steps: 570 | Train Loss: 0.2062991 Vali Loss: 0.0573906 Test Loss: 0.1547263
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1550510972738266, mae:0.25246042013168335
>>> MS_Raw LR=5e-4 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1968861
	speed: 0.0220s/iter; left time: 248.3476s
	iters: 200, epoch: 1 | loss: 0.2074055
	speed: 0.0105s/iter; left time: 118.0777s
	iters: 300, epoch: 1 | loss: 0.2668394
	speed: 0.0106s/iter; left time: 117.4208s
	iters: 400, epoch: 1 | loss: 0.2510618
	speed: 0.0105s/iter; left time: 116.0543s
	iters: 500, epoch: 1 | loss: 0.1887305
	speed: 0.0106s/iter; left time: 115.1210s
Epoch: 1 cost time: 7.201883792877197
Epoch: 1, Steps: 570 | Train Loss: 0.2436748 Vali Loss: 0.0457816 Test Loss: 0.1451397
Validation loss decreased (inf --> 0.045782).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3275155
	speed: 0.0367s/iter; left time: 393.9784s
	iters: 200, epoch: 2 | loss: 0.1967727
	speed: 0.0106s/iter; left time: 112.8306s
	iters: 300, epoch: 2 | loss: 0.1991920
	speed: 0.0106s/iter; left time: 111.6061s
	iters: 400, epoch: 2 | loss: 0.1718873
	speed: 0.0106s/iter; left time: 110.8609s
	iters: 500, epoch: 2 | loss: 0.2023968
	speed: 0.0106s/iter; left time: 109.3674s
Epoch: 2 cost time: 6.350244045257568
Epoch: 2, Steps: 570 | Train Loss: 0.2031243 Vali Loss: 0.0430505 Test Loss: 0.1352728
Validation loss decreased (0.045782 --> 0.043050).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1456728
	speed: 0.0383s/iter; left time: 389.4692s
	iters: 200, epoch: 3 | loss: 0.2073755
	speed: 0.0106s/iter; left time: 106.4031s
	iters: 300, epoch: 3 | loss: 0.1619648
	speed: 0.0106s/iter; left time: 105.1686s
	iters: 400, epoch: 3 | loss: 0.1799439
	speed: 0.0105s/iter; left time: 103.8754s
	iters: 500, epoch: 3 | loss: 0.2282066
	speed: 0.0105s/iter; left time: 102.6007s
Epoch: 3 cost time: 6.33696436882019
Epoch: 3, Steps: 570 | Train Loss: 0.1790444 Vali Loss: 0.0378854 Test Loss: 0.1217924
Validation loss decreased (0.043050 --> 0.037885).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1916265
	speed: 0.0374s/iter; left time: 358.4098s
	iters: 200, epoch: 4 | loss: 0.0987980
	speed: 0.0106s/iter; left time: 100.2918s
	iters: 300, epoch: 4 | loss: 0.1622420
	speed: 0.0106s/iter; left time: 99.4342s
	iters: 400, epoch: 4 | loss: 0.1659676
	speed: 0.0106s/iter; left time: 98.6858s
	iters: 500, epoch: 4 | loss: 0.1543243
	speed: 0.0106s/iter; left time: 97.5838s
Epoch: 4 cost time: 6.301753520965576
Epoch: 4, Steps: 570 | Train Loss: 0.1644141 Vali Loss: 0.0373587 Test Loss: 0.1246603
Validation loss decreased (0.037885 --> 0.037359).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1373155
	speed: 0.0374s/iter; left time: 337.7071s
	iters: 200, epoch: 5 | loss: 0.1544386
	speed: 0.0107s/iter; left time: 95.1868s
	iters: 300, epoch: 5 | loss: 0.1008306
	speed: 0.0107s/iter; left time: 94.3651s
	iters: 400, epoch: 5 | loss: 0.1563086
	speed: 0.0107s/iter; left time: 93.1186s
	iters: 500, epoch: 5 | loss: 0.1853543
	speed: 0.0107s/iter; left time: 92.0455s
Epoch: 5 cost time: 6.362225294113159
Epoch: 5, Steps: 570 | Train Loss: 0.1551671 Vali Loss: 0.0357990 Test Loss: 0.1252222
Validation loss decreased (0.037359 --> 0.035799).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1380461
	speed: 0.0359s/iter; left time: 303.0957s
	iters: 200, epoch: 6 | loss: 0.1179587
	speed: 0.0106s/iter; left time: 88.5924s
	iters: 300, epoch: 6 | loss: 0.1492406
	speed: 0.0106s/iter; left time: 87.3475s
	iters: 400, epoch: 6 | loss: 0.1771906
	speed: 0.0106s/iter; left time: 86.0741s
	iters: 500, epoch: 6 | loss: 0.1527208
	speed: 0.0106s/iter; left time: 85.2441s
Epoch: 6 cost time: 6.326488494873047
Epoch: 6, Steps: 570 | Train Loss: 0.1508814 Vali Loss: 0.0361586 Test Loss: 0.1267179
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1690600
	speed: 0.0365s/iter; left time: 287.8725s
	iters: 200, epoch: 7 | loss: 0.2181375
	speed: 0.0119s/iter; left time: 92.2847s
	iters: 300, epoch: 7 | loss: 0.1134887
	speed: 0.0119s/iter; left time: 91.4996s
	iters: 400, epoch: 7 | loss: 0.1205991
	speed: 0.0118s/iter; left time: 89.7176s
	iters: 500, epoch: 7 | loss: 0.1330346
	speed: 0.0118s/iter; left time: 88.5643s
Epoch: 7 cost time: 7.030780792236328
Epoch: 7, Steps: 570 | Train Loss: 0.1488097 Vali Loss: 0.0360066 Test Loss: 0.1266913
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1359771
	speed: 0.0367s/iter; left time: 268.0929s
	iters: 200, epoch: 8 | loss: 0.1457441
	speed: 0.0106s/iter; left time: 76.4620s
	iters: 300, epoch: 8 | loss: 0.1882059
	speed: 0.0106s/iter; left time: 75.4025s
	iters: 400, epoch: 8 | loss: 0.2122235
	speed: 0.0106s/iter; left time: 74.3838s
	iters: 500, epoch: 8 | loss: 0.0939350
	speed: 0.0106s/iter; left time: 73.1752s
Epoch: 8 cost time: 6.287495136260986
Epoch: 8, Steps: 570 | Train Loss: 0.1469399 Vali Loss: 0.0357397 Test Loss: 0.1275342
Validation loss decreased (0.035799 --> 0.035740).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2393412
	speed: 0.0366s/iter; left time: 246.5990s
	iters: 200, epoch: 9 | loss: 0.1287752
	speed: 0.0104s/iter; left time: 69.3940s
	iters: 300, epoch: 9 | loss: 0.0813232
	speed: 0.0105s/iter; left time: 68.3934s
	iters: 400, epoch: 9 | loss: 0.1237925
	speed: 0.0105s/iter; left time: 67.3623s
	iters: 500, epoch: 9 | loss: 0.1202961
	speed: 0.0105s/iter; left time: 66.4713s
Epoch: 9 cost time: 6.232393264770508
Epoch: 9, Steps: 570 | Train Loss: 0.1460428 Vali Loss: 0.0362367 Test Loss: 0.1276402
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1430824
	speed: 0.0348s/iter; left time: 214.9924s
	iters: 200, epoch: 10 | loss: 0.1595148
	speed: 0.0105s/iter; left time: 63.7308s
	iters: 300, epoch: 10 | loss: 0.1019429
	speed: 0.0105s/iter; left time: 62.6514s
	iters: 400, epoch: 10 | loss: 0.1213916
	speed: 0.0105s/iter; left time: 61.5383s
	iters: 500, epoch: 10 | loss: 0.2282617
	speed: 0.0105s/iter; left time: 60.5178s
Epoch: 10 cost time: 6.235641717910767
Epoch: 10, Steps: 570 | Train Loss: 0.1460244 Vali Loss: 0.0359605 Test Loss: 0.1277746
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1593354
	speed: 0.0385s/iter; left time: 215.5424s
	iters: 200, epoch: 11 | loss: 0.1470495
	speed: 0.0107s/iter; left time: 58.5999s
	iters: 300, epoch: 11 | loss: 0.1202945
	speed: 0.0106s/iter; left time: 57.4376s
	iters: 400, epoch: 11 | loss: 0.2002390
	speed: 0.0106s/iter; left time: 56.2386s
	iters: 500, epoch: 11 | loss: 0.1476796
	speed: 0.0106s/iter; left time: 55.1977s
Epoch: 11 cost time: 6.331272840499878
Epoch: 11, Steps: 570 | Train Loss: 0.1469775 Vali Loss: 0.0358628 Test Loss: 0.1277538
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1277076005935669, mae:0.22084355354309082
>>> MS_Raw LR=5e-4 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2401721
	speed: 0.0237s/iter; left time: 267.3627s
	iters: 200, epoch: 1 | loss: 0.2424997
	speed: 0.0116s/iter; left time: 130.4673s
	iters: 300, epoch: 1 | loss: 0.3234658
	speed: 0.0105s/iter; left time: 116.8234s
	iters: 400, epoch: 1 | loss: 0.1961393
	speed: 0.0112s/iter; left time: 123.3106s
	iters: 500, epoch: 1 | loss: 0.1873902
	speed: 0.0116s/iter; left time: 126.8466s
Epoch: 1 cost time: 7.73227596282959
Epoch: 1, Steps: 570 | Train Loss: 0.2151568 Vali Loss: 0.0361725 Test Loss: 0.1191960
Validation loss decreased (inf --> 0.036173).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1610263
	speed: 0.0386s/iter; left time: 414.6353s
	iters: 200, epoch: 2 | loss: 0.2114646
	speed: 0.0103s/iter; left time: 110.0183s
	iters: 300, epoch: 2 | loss: 0.1568907
	speed: 0.0103s/iter; left time: 108.9498s
	iters: 400, epoch: 2 | loss: 0.1601709
	speed: 0.0104s/iter; left time: 108.1824s
	iters: 500, epoch: 2 | loss: 0.1835256
	speed: 0.0104s/iter; left time: 107.0382s
Epoch: 2 cost time: 6.193507671356201
Epoch: 2, Steps: 570 | Train Loss: 0.1871854 Vali Loss: 0.0372932 Test Loss: 0.1156548
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0921855
	speed: 0.0361s/iter; left time: 366.9748s
	iters: 200, epoch: 3 | loss: 0.1439721
	speed: 0.0103s/iter; left time: 103.9155s
	iters: 300, epoch: 3 | loss: 0.2918147
	speed: 0.0104s/iter; left time: 103.1233s
	iters: 400, epoch: 3 | loss: 0.1909704
	speed: 0.0103s/iter; left time: 101.9630s
	iters: 500, epoch: 3 | loss: 0.1056564
	speed: 0.0104s/iter; left time: 101.2347s
Epoch: 3 cost time: 6.208097219467163
Epoch: 3, Steps: 570 | Train Loss: 0.1657281 Vali Loss: 0.0321570 Test Loss: 0.1056891
Validation loss decreased (0.036173 --> 0.032157).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1245359
	speed: 0.0379s/iter; left time: 363.1089s
	iters: 200, epoch: 4 | loss: 0.1304310
	speed: 0.0104s/iter; left time: 98.9104s
	iters: 300, epoch: 4 | loss: 0.0928682
	speed: 0.0104s/iter; left time: 97.7271s
	iters: 400, epoch: 4 | loss: 0.1208657
	speed: 0.0111s/iter; left time: 102.9042s
	iters: 500, epoch: 4 | loss: 0.1988564
	speed: 0.0117s/iter; left time: 107.1162s
Epoch: 4 cost time: 6.5490405559539795
Epoch: 4, Steps: 570 | Train Loss: 0.1537255 Vali Loss: 0.0323878 Test Loss: 0.1043980
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1135346
	speed: 0.0374s/iter; left time: 337.4606s
	iters: 200, epoch: 5 | loss: 0.1933572
	speed: 0.0103s/iter; left time: 92.2563s
	iters: 300, epoch: 5 | loss: 0.1349498
	speed: 0.0103s/iter; left time: 91.2503s
	iters: 400, epoch: 5 | loss: 0.1440819
	speed: 0.0104s/iter; left time: 90.2933s
	iters: 500, epoch: 5 | loss: 0.1472165
	speed: 0.0103s/iter; left time: 89.0116s
Epoch: 5 cost time: 6.202342748641968
Epoch: 5, Steps: 570 | Train Loss: 0.1476107 Vali Loss: 0.0316899 Test Loss: 0.1041419
Validation loss decreased (0.032157 --> 0.031690).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1084595
	speed: 0.0389s/iter; left time: 328.6182s
	iters: 200, epoch: 6 | loss: 0.1837830
	speed: 0.0117s/iter; left time: 97.3003s
	iters: 300, epoch: 6 | loss: 0.1503467
	speed: 0.0105s/iter; left time: 86.3118s
	iters: 400, epoch: 6 | loss: 0.1284380
	speed: 0.0104s/iter; left time: 84.8025s
	iters: 500, epoch: 6 | loss: 0.1001743
	speed: 0.0104s/iter; left time: 83.9613s
Epoch: 6 cost time: 6.502588272094727
Epoch: 6, Steps: 570 | Train Loss: 0.1432669 Vali Loss: 0.0317257 Test Loss: 0.1050080
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1394527
	speed: 0.0368s/iter; left time: 289.7271s
	iters: 200, epoch: 7 | loss: 0.1708174
	speed: 0.0104s/iter; left time: 80.9691s
	iters: 300, epoch: 7 | loss: 0.2254554
	speed: 0.0104s/iter; left time: 80.0193s
	iters: 400, epoch: 7 | loss: 0.1847659
	speed: 0.0104s/iter; left time: 79.1314s
	iters: 500, epoch: 7 | loss: 0.1539829
	speed: 0.0104s/iter; left time: 77.9929s
Epoch: 7 cost time: 6.264772891998291
Epoch: 7, Steps: 570 | Train Loss: 0.1421129 Vali Loss: 0.0313872 Test Loss: 0.1043943
Validation loss decreased (0.031690 --> 0.031387).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1260215
	speed: 0.0358s/iter; left time: 261.5242s
	iters: 200, epoch: 8 | loss: 0.0947148
	speed: 0.0103s/iter; left time: 74.5591s
	iters: 300, epoch: 8 | loss: 0.1159244
	speed: 0.0104s/iter; left time: 73.6665s
	iters: 400, epoch: 8 | loss: 0.1393307
	speed: 0.0104s/iter; left time: 72.6303s
	iters: 500, epoch: 8 | loss: 0.0789673
	speed: 0.0103s/iter; left time: 71.3007s
Epoch: 8 cost time: 6.186243295669556
Epoch: 8, Steps: 570 | Train Loss: 0.1416707 Vali Loss: 0.0313756 Test Loss: 0.1045958
Validation loss decreased (0.031387 --> 0.031376).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1174904
	speed: 0.0371s/iter; left time: 249.9757s
	iters: 200, epoch: 9 | loss: 0.1468606
	speed: 0.0104s/iter; left time: 69.3439s
	iters: 300, epoch: 9 | loss: 0.1139230
	speed: 0.0105s/iter; left time: 68.4058s
	iters: 400, epoch: 9 | loss: 0.1485003
	speed: 0.0107s/iter; left time: 68.6112s
	iters: 500, epoch: 9 | loss: 0.1246711
	speed: 0.0116s/iter; left time: 73.7613s
Epoch: 9 cost time: 6.51837682723999
Epoch: 9, Steps: 570 | Train Loss: 0.1395523 Vali Loss: 0.0313584 Test Loss: 0.1043669
Validation loss decreased (0.031376 --> 0.031358).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1400148
	speed: 0.0377s/iter; left time: 232.6062s
	iters: 200, epoch: 10 | loss: 0.1162626
	speed: 0.0104s/iter; left time: 63.0545s
	iters: 300, epoch: 10 | loss: 0.1198061
	speed: 0.0103s/iter; left time: 61.4544s
	iters: 400, epoch: 10 | loss: 0.1005436
	speed: 0.0103s/iter; left time: 60.4632s
	iters: 500, epoch: 10 | loss: 0.1011312
	speed: 0.0103s/iter; left time: 59.4478s
Epoch: 10 cost time: 6.177607297897339
Epoch: 10, Steps: 570 | Train Loss: 0.1411722 Vali Loss: 0.0313830 Test Loss: 0.1042795
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1380363
	speed: 0.0363s/iter; left time: 203.4383s
	iters: 200, epoch: 11 | loss: 0.1670581
	speed: 0.0104s/iter; left time: 57.1327s
	iters: 300, epoch: 11 | loss: 0.1588926
	speed: 0.0104s/iter; left time: 56.1242s
	iters: 400, epoch: 11 | loss: 0.1483600
	speed: 0.0104s/iter; left time: 55.2700s
	iters: 500, epoch: 11 | loss: 0.1227315
	speed: 0.0104s/iter; left time: 54.2597s
Epoch: 11 cost time: 6.2323503494262695
Epoch: 11, Steps: 570 | Train Loss: 0.1392189 Vali Loss: 0.0312490 Test Loss: 0.1042706
Validation loss decreased (0.031358 --> 0.031249).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1175639
	speed: 0.0378s/iter; left time: 190.2476s
	iters: 200, epoch: 12 | loss: 0.1478161
	speed: 0.0104s/iter; left time: 51.1648s
	iters: 300, epoch: 12 | loss: 0.1135787
	speed: 0.0104s/iter; left time: 50.3665s
	iters: 400, epoch: 12 | loss: 0.1800499
	speed: 0.0104s/iter; left time: 49.1774s
	iters: 500, epoch: 12 | loss: 0.1252864
	speed: 0.0104s/iter; left time: 47.9667s
Epoch: 12 cost time: 6.2264018058776855
Epoch: 12, Steps: 570 | Train Loss: 0.1398091 Vali Loss: 0.0313090 Test Loss: 0.1042849
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2295697
	speed: 0.0366s/iter; left time: 163.4766s
	iters: 200, epoch: 13 | loss: 0.1836542
	speed: 0.0104s/iter; left time: 45.4951s
	iters: 300, epoch: 13 | loss: 0.1145843
	speed: 0.0104s/iter; left time: 44.2077s
	iters: 400, epoch: 13 | loss: 0.1641874
	speed: 0.0104s/iter; left time: 43.2347s
	iters: 500, epoch: 13 | loss: 0.1717600
	speed: 0.0104s/iter; left time: 42.3281s
Epoch: 13 cost time: 6.212274789810181
Epoch: 13, Steps: 570 | Train Loss: 0.1398790 Vali Loss: 0.0312312 Test Loss: 0.1042820
Validation loss decreased (0.031249 --> 0.031231).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1311188
	speed: 0.0367s/iter; left time: 142.6520s
	iters: 200, epoch: 14 | loss: 0.1039703
	speed: 0.0104s/iter; left time: 39.4980s
	iters: 300, epoch: 14 | loss: 0.1311249
	speed: 0.0104s/iter; left time: 38.5456s
	iters: 400, epoch: 14 | loss: 0.1338442
	speed: 0.0104s/iter; left time: 37.5155s
	iters: 500, epoch: 14 | loss: 0.1419042
	speed: 0.0104s/iter; left time: 36.3513s
Epoch: 14 cost time: 6.251631021499634
Epoch: 14, Steps: 570 | Train Loss: 0.1398163 Vali Loss: 0.0312761 Test Loss: 0.1042791
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.0882273
	speed: 0.0378s/iter; left time: 125.4636s
	iters: 200, epoch: 15 | loss: 0.1478414
	speed: 0.0117s/iter; left time: 37.6810s
	iters: 300, epoch: 15 | loss: 0.1274982
	speed: 0.0117s/iter; left time: 36.5551s
	iters: 400, epoch: 15 | loss: 0.1245105
	speed: 0.0117s/iter; left time: 35.2350s
	iters: 500, epoch: 15 | loss: 0.1308725
	speed: 0.0117s/iter; left time: 34.1399s
Epoch: 15 cost time: 6.895220994949341
Epoch: 15, Steps: 570 | Train Loss: 0.1395391 Vali Loss: 0.0312022 Test Loss: 0.1042811
Validation loss decreased (0.031231 --> 0.031202).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.2173437
	speed: 0.0373s/iter; left time: 102.6893s
	iters: 200, epoch: 16 | loss: 0.1206843
	speed: 0.0103s/iter; left time: 27.4335s
	iters: 300, epoch: 16 | loss: 0.1893770
	speed: 0.0104s/iter; left time: 26.4196s
	iters: 400, epoch: 16 | loss: 0.1291029
	speed: 0.0104s/iter; left time: 25.4045s
	iters: 500, epoch: 16 | loss: 0.2286672
	speed: 0.0104s/iter; left time: 24.3573s
Epoch: 16 cost time: 6.238776683807373
Epoch: 16, Steps: 570 | Train Loss: 0.1400929 Vali Loss: 0.0311803 Test Loss: 0.1042822
Validation loss decreased (0.031202 --> 0.031180).  Saving model ...
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1043478
	speed: 0.0362s/iter; left time: 79.0323s
	iters: 200, epoch: 17 | loss: 0.1241303
	speed: 0.0103s/iter; left time: 21.5055s
	iters: 300, epoch: 17 | loss: 0.1408147
	speed: 0.0104s/iter; left time: 20.5334s
	iters: 400, epoch: 17 | loss: 0.1139410
	speed: 0.0103s/iter; left time: 19.4043s
	iters: 500, epoch: 17 | loss: 0.0959115
	speed: 0.0103s/iter; left time: 18.3889s
Epoch: 17 cost time: 6.217726469039917
Epoch: 17, Steps: 570 | Train Loss: 0.1397438 Vali Loss: 0.0313544 Test Loss: 0.1042828
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1547170
	speed: 0.0358s/iter; left time: 57.6964s
	iters: 200, epoch: 18 | loss: 0.1407096
	speed: 0.0104s/iter; left time: 15.7588s
	iters: 300, epoch: 18 | loss: 0.1202417
	speed: 0.0104s/iter; left time: 14.7309s
	iters: 400, epoch: 18 | loss: 0.2134871
	speed: 0.0104s/iter; left time: 13.6836s
	iters: 500, epoch: 18 | loss: 0.1240891
	speed: 0.0104s/iter; left time: 12.6424s
Epoch: 18 cost time: 6.24921727180481
Epoch: 18, Steps: 570 | Train Loss: 0.1396246 Vali Loss: 0.0312675 Test Loss: 0.1042829
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.814697265625e-09
	iters: 100, epoch: 19 | loss: 0.1086819
	speed: 0.0386s/iter; left time: 40.2211s
	iters: 200, epoch: 19 | loss: 0.1497446
	speed: 0.0117s/iter; left time: 11.0366s
	iters: 300, epoch: 19 | loss: 0.1158870
	speed: 0.0117s/iter; left time: 9.8379s
	iters: 400, epoch: 19 | loss: 0.1645359
	speed: 0.0116s/iter; left time: 8.6249s
	iters: 500, epoch: 19 | loss: 0.1304467
	speed: 0.0107s/iter; left time: 6.8301s
Epoch: 19 cost time: 6.7771406173706055
Epoch: 19, Steps: 570 | Train Loss: 0.1395322 Vali Loss: 0.0313423 Test Loss: 0.1042826
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1044272854924202, mae:0.19677524268627167
>>> MS_Raw LR=5e-4 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2458244
	speed: 0.0237s/iter; left time: 267.5510s
	iters: 200, epoch: 1 | loss: 0.1580599
	speed: 0.0116s/iter; left time: 130.4826s
	iters: 300, epoch: 1 | loss: 0.1607421
	speed: 0.0116s/iter; left time: 128.8078s
	iters: 400, epoch: 1 | loss: 0.1947172
	speed: 0.0116s/iter; left time: 127.9727s
	iters: 500, epoch: 1 | loss: 0.2462651
	speed: 0.0117s/iter; left time: 127.3575s
Epoch: 1 cost time: 7.896573305130005
Epoch: 1, Steps: 570 | Train Loss: 0.2496192 Vali Loss: 0.0448467 Test Loss: 0.1367395
Validation loss decreased (inf --> 0.044847).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2090575
	speed: 0.0391s/iter; left time: 420.1087s
	iters: 200, epoch: 2 | loss: 0.2855562
	speed: 0.0104s/iter; left time: 110.4080s
	iters: 300, epoch: 2 | loss: 0.1796440
	speed: 0.0104s/iter; left time: 109.7509s
	iters: 400, epoch: 2 | loss: 0.3255115
	speed: 0.0104s/iter; left time: 108.6814s
	iters: 500, epoch: 2 | loss: 0.2540377
	speed: 0.0104s/iter; left time: 107.3971s
Epoch: 2 cost time: 6.267757415771484
Epoch: 2, Steps: 570 | Train Loss: 0.2090411 Vali Loss: 0.0425315 Test Loss: 0.1379918
Validation loss decreased (0.044847 --> 0.042531).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1236370
	speed: 0.0373s/iter; left time: 378.6799s
	iters: 200, epoch: 3 | loss: 0.1724854
	speed: 0.0104s/iter; left time: 105.1094s
	iters: 300, epoch: 3 | loss: 0.2191168
	speed: 0.0104s/iter; left time: 104.0300s
	iters: 400, epoch: 3 | loss: 0.1433497
	speed: 0.0104s/iter; left time: 102.6997s
	iters: 500, epoch: 3 | loss: 0.1347058
	speed: 0.0104s/iter; left time: 101.7193s
Epoch: 3 cost time: 6.282226085662842
Epoch: 3, Steps: 570 | Train Loss: 0.1822572 Vali Loss: 0.0381314 Test Loss: 0.1287609
Validation loss decreased (0.042531 --> 0.038131).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0993757
	speed: 0.0379s/iter; left time: 363.3274s
	iters: 200, epoch: 4 | loss: 0.1030221
	speed: 0.0103s/iter; left time: 98.1270s
	iters: 300, epoch: 4 | loss: 0.1255772
	speed: 0.0103s/iter; left time: 97.0332s
	iters: 400, epoch: 4 | loss: 0.1874091
	speed: 0.0104s/iter; left time: 96.3236s
	iters: 500, epoch: 4 | loss: 0.1362787
	speed: 0.0103s/iter; left time: 95.0464s
Epoch: 4 cost time: 6.21260404586792
Epoch: 4, Steps: 570 | Train Loss: 0.1654112 Vali Loss: 0.0390523 Test Loss: 0.1291916
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1629340
	speed: 0.0376s/iter; left time: 339.4088s
	iters: 200, epoch: 5 | loss: 0.1039051
	speed: 0.0105s/iter; left time: 93.4329s
	iters: 300, epoch: 5 | loss: 0.1660782
	speed: 0.0105s/iter; left time: 92.4887s
	iters: 400, epoch: 5 | loss: 0.1498400
	speed: 0.0104s/iter; left time: 90.8093s
	iters: 500, epoch: 5 | loss: 0.2172457
	speed: 0.0104s/iter; left time: 89.9758s
Epoch: 5 cost time: 6.240770578384399
Epoch: 5, Steps: 570 | Train Loss: 0.1577477 Vali Loss: 0.0375868 Test Loss: 0.1292249
Validation loss decreased (0.038131 --> 0.037587).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1206211
	speed: 0.0374s/iter; left time: 316.2497s
	iters: 200, epoch: 6 | loss: 0.1372995
	speed: 0.0104s/iter; left time: 86.5336s
	iters: 300, epoch: 6 | loss: 0.1432529
	speed: 0.0104s/iter; left time: 85.5455s
	iters: 400, epoch: 6 | loss: 0.1195650
	speed: 0.0104s/iter; left time: 84.6343s
	iters: 500, epoch: 6 | loss: 0.1516001
	speed: 0.0103s/iter; left time: 83.3013s
Epoch: 6 cost time: 6.23473858833313
Epoch: 6, Steps: 570 | Train Loss: 0.1522886 Vali Loss: 0.0371695 Test Loss: 0.1265572
Validation loss decreased (0.037587 --> 0.037169).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1134902
	speed: 0.0377s/iter; left time: 296.9252s
	iters: 200, epoch: 7 | loss: 0.1240653
	speed: 0.0103s/iter; left time: 80.2634s
	iters: 300, epoch: 7 | loss: 0.1308912
	speed: 0.0103s/iter; left time: 79.2337s
	iters: 400, epoch: 7 | loss: 0.1020128
	speed: 0.0102s/iter; left time: 77.6601s
	iters: 500, epoch: 7 | loss: 0.1568721
	speed: 0.0103s/iter; left time: 76.7516s
Epoch: 7 cost time: 6.1570658683776855
Epoch: 7, Steps: 570 | Train Loss: 0.1493799 Vali Loss: 0.0368687 Test Loss: 0.1266420
Validation loss decreased (0.037169 --> 0.036869).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1191704
	speed: 0.0390s/iter; left time: 284.7764s
	iters: 200, epoch: 8 | loss: 0.1438675
	speed: 0.0116s/iter; left time: 83.8708s
	iters: 300, epoch: 8 | loss: 0.1819857
	speed: 0.0111s/iter; left time: 79.1389s
	iters: 400, epoch: 8 | loss: 0.1481585
	speed: 0.0103s/iter; left time: 72.0582s
	iters: 500, epoch: 8 | loss: 0.1317616
	speed: 0.0102s/iter; left time: 70.7990s
Epoch: 8 cost time: 6.506788730621338
Epoch: 8, Steps: 570 | Train Loss: 0.1479293 Vali Loss: 0.0369548 Test Loss: 0.1264471
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1167659
	speed: 0.0376s/iter; left time: 253.4523s
	iters: 200, epoch: 9 | loss: 0.1701135
	speed: 0.0102s/iter; left time: 67.7921s
	iters: 300, epoch: 9 | loss: 0.1141123
	speed: 0.0102s/iter; left time: 66.8889s
	iters: 400, epoch: 9 | loss: 0.1052207
	speed: 0.0102s/iter; left time: 65.8698s
	iters: 500, epoch: 9 | loss: 0.1552950
	speed: 0.0102s/iter; left time: 64.6780s
Epoch: 9 cost time: 6.089434385299683
Epoch: 9, Steps: 570 | Train Loss: 0.1471686 Vali Loss: 0.0371080 Test Loss: 0.1267642
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1323274
	speed: 0.0377s/iter; left time: 232.6087s
	iters: 200, epoch: 10 | loss: 0.2113402
	speed: 0.0103s/iter; left time: 62.5911s
	iters: 300, epoch: 10 | loss: 0.2047139
	speed: 0.0104s/iter; left time: 61.8213s
	iters: 400, epoch: 10 | loss: 0.1622301
	speed: 0.0103s/iter; left time: 60.6266s
	iters: 500, epoch: 10 | loss: 0.1510198
	speed: 0.0103s/iter; left time: 59.5609s
Epoch: 10 cost time: 6.176168203353882
Epoch: 10, Steps: 570 | Train Loss: 0.1486454 Vali Loss: 0.0370910 Test Loss: 0.1269608
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12679612636566162, mae:0.22187824547290802
>>> MS_Raw LR=5e-4 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3012963
	speed: 0.0250s/iter; left time: 282.8072s
	iters: 200, epoch: 1 | loss: 0.2677741
	speed: 0.0129s/iter; left time: 144.9578s
	iters: 300, epoch: 1 | loss: 0.1750219
	speed: 0.0129s/iter; left time: 143.5387s
	iters: 400, epoch: 1 | loss: 0.1297865
	speed: 0.0129s/iter; left time: 142.4370s
	iters: 500, epoch: 1 | loss: 0.2133226
	speed: 0.0129s/iter; left time: 141.0896s
Epoch: 1 cost time: 8.640400171279907
Epoch: 1, Steps: 570 | Train Loss: 0.2574803 Vali Loss: 0.0458579 Test Loss: 0.1352860
Validation loss decreased (inf --> 0.045858).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1982875
	speed: 0.0419s/iter; left time: 450.0396s
	iters: 200, epoch: 2 | loss: 0.1828269
	speed: 0.0129s/iter; left time: 137.4329s
	iters: 300, epoch: 2 | loss: 0.2175472
	speed: 0.0129s/iter; left time: 135.7956s
	iters: 400, epoch: 2 | loss: 0.1286643
	speed: 0.0129s/iter; left time: 134.7070s
	iters: 500, epoch: 2 | loss: 0.2117110
	speed: 0.0129s/iter; left time: 133.6529s
Epoch: 2 cost time: 7.7034752368927
Epoch: 2, Steps: 570 | Train Loss: 0.2258754 Vali Loss: 0.0447057 Test Loss: 0.1362181
Validation loss decreased (0.045858 --> 0.044706).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2756763
	speed: 0.0413s/iter; left time: 419.6654s
	iters: 200, epoch: 3 | loss: 0.2064056
	speed: 0.0118s/iter; left time: 118.9844s
	iters: 300, epoch: 3 | loss: 0.1095314
	speed: 0.0119s/iter; left time: 118.1121s
	iters: 400, epoch: 3 | loss: 0.2068678
	speed: 0.0118s/iter; left time: 116.5243s
	iters: 500, epoch: 3 | loss: 0.2011012
	speed: 0.0118s/iter; left time: 115.4728s
Epoch: 3 cost time: 7.039470911026001
Epoch: 3, Steps: 570 | Train Loss: 0.2037236 Vali Loss: 0.0462443 Test Loss: 0.1363997
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1503361
	speed: 0.0389s/iter; left time: 372.8049s
	iters: 200, epoch: 4 | loss: 0.2408571
	speed: 0.0128s/iter; left time: 121.4386s
	iters: 300, epoch: 4 | loss: 0.1057899
	speed: 0.0128s/iter; left time: 119.9204s
	iters: 400, epoch: 4 | loss: 0.1237857
	speed: 0.0127s/iter; left time: 118.3328s
	iters: 500, epoch: 4 | loss: 0.1619836
	speed: 0.0127s/iter; left time: 117.1106s
Epoch: 4 cost time: 7.538034677505493
Epoch: 4, Steps: 570 | Train Loss: 0.1848698 Vali Loss: 0.0414682 Test Loss: 0.1244780
Validation loss decreased (0.044706 --> 0.041468).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1547678
	speed: 0.0405s/iter; left time: 365.3971s
	iters: 200, epoch: 5 | loss: 0.1490418
	speed: 0.0127s/iter; left time: 113.5773s
	iters: 300, epoch: 5 | loss: 0.2137638
	speed: 0.0128s/iter; left time: 112.4758s
	iters: 400, epoch: 5 | loss: 0.1746981
	speed: 0.0127s/iter; left time: 110.8957s
	iters: 500, epoch: 5 | loss: 0.1618993
	speed: 0.0127s/iter; left time: 109.5301s
Epoch: 5 cost time: 7.5502119064331055
Epoch: 5, Steps: 570 | Train Loss: 0.1739019 Vali Loss: 0.0393822 Test Loss: 0.1224011
Validation loss decreased (0.041468 --> 0.039382).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1413294
	speed: 0.0416s/iter; left time: 351.4434s
	iters: 200, epoch: 6 | loss: 0.0935599
	speed: 0.0118s/iter; left time: 98.3287s
	iters: 300, epoch: 6 | loss: 0.2263413
	speed: 0.0118s/iter; left time: 97.3236s
	iters: 400, epoch: 6 | loss: 0.1823796
	speed: 0.0118s/iter; left time: 96.0361s
	iters: 500, epoch: 6 | loss: 0.1201744
	speed: 0.0118s/iter; left time: 94.8242s
Epoch: 6 cost time: 7.1154258251190186
Epoch: 6, Steps: 570 | Train Loss: 0.1673662 Vali Loss: 0.0386579 Test Loss: 0.1205866
Validation loss decreased (0.039382 --> 0.038658).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1570462
	speed: 0.0413s/iter; left time: 325.2215s
	iters: 200, epoch: 7 | loss: 0.1613402
	speed: 0.0127s/iter; left time: 99.0643s
	iters: 300, epoch: 7 | loss: 0.1535271
	speed: 0.0128s/iter; left time: 98.0523s
	iters: 400, epoch: 7 | loss: 0.1166422
	speed: 0.0128s/iter; left time: 96.6684s
	iters: 500, epoch: 7 | loss: 0.1554347
	speed: 0.0128s/iter; left time: 95.5229s
Epoch: 7 cost time: 7.583322525024414
Epoch: 7, Steps: 570 | Train Loss: 0.1631525 Vali Loss: 0.0386661 Test Loss: 0.1209979
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0983596
	speed: 0.0407s/iter; left time: 297.9070s
	iters: 200, epoch: 8 | loss: 0.1509856
	speed: 0.0118s/iter; left time: 85.1472s
	iters: 300, epoch: 8 | loss: 0.1772835
	speed: 0.0118s/iter; left time: 84.1448s
	iters: 400, epoch: 8 | loss: 0.1319452
	speed: 0.0118s/iter; left time: 82.9325s
	iters: 500, epoch: 8 | loss: 0.1221954
	speed: 0.0118s/iter; left time: 81.6433s
Epoch: 8 cost time: 7.092625141143799
Epoch: 8, Steps: 570 | Train Loss: 0.1622830 Vali Loss: 0.0382901 Test Loss: 0.1199921
Validation loss decreased (0.038658 --> 0.038290).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1114881
	speed: 0.0405s/iter; left time: 273.1927s
	iters: 200, epoch: 9 | loss: 0.1543981
	speed: 0.0119s/iter; left time: 78.7518s
	iters: 300, epoch: 9 | loss: 0.1817339
	speed: 0.0119s/iter; left time: 77.5287s
	iters: 400, epoch: 9 | loss: 0.1271408
	speed: 0.0119s/iter; left time: 76.3385s
	iters: 500, epoch: 9 | loss: 0.1836076
	speed: 0.0118s/iter; left time: 75.1383s
Epoch: 9 cost time: 7.043806076049805
Epoch: 9, Steps: 570 | Train Loss: 0.1617940 Vali Loss: 0.0380872 Test Loss: 0.1199515
Validation loss decreased (0.038290 --> 0.038087).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1570071
	speed: 0.0393s/iter; left time: 242.6389s
	iters: 200, epoch: 10 | loss: 0.1784642
	speed: 0.0119s/iter; left time: 71.9978s
	iters: 300, epoch: 10 | loss: 0.1366245
	speed: 0.0119s/iter; left time: 70.8111s
	iters: 400, epoch: 10 | loss: 0.1409702
	speed: 0.0119s/iter; left time: 69.6160s
	iters: 500, epoch: 10 | loss: 0.1993697
	speed: 0.0119s/iter; left time: 68.4324s
Epoch: 10 cost time: 7.0763750076293945
Epoch: 10, Steps: 570 | Train Loss: 0.1603146 Vali Loss: 0.0381728 Test Loss: 0.1202390
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1282211
	speed: 0.0385s/iter; left time: 215.7421s
	iters: 200, epoch: 11 | loss: 0.2455364
	speed: 0.0118s/iter; left time: 65.0943s
	iters: 300, epoch: 11 | loss: 0.1538334
	speed: 0.0118s/iter; left time: 63.8725s
	iters: 400, epoch: 11 | loss: 0.1733185
	speed: 0.0118s/iter; left time: 62.7806s
	iters: 500, epoch: 11 | loss: 0.2067696
	speed: 0.0118s/iter; left time: 61.5538s
Epoch: 11 cost time: 7.027007341384888
Epoch: 11, Steps: 570 | Train Loss: 0.1596519 Vali Loss: 0.0382238 Test Loss: 0.1203443
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1390537
	speed: 0.0382s/iter; left time: 192.2221s
	iters: 200, epoch: 12 | loss: 0.1245567
	speed: 0.0118s/iter; left time: 58.2598s
	iters: 300, epoch: 12 | loss: 0.1152004
	speed: 0.0118s/iter; left time: 57.0243s
	iters: 400, epoch: 12 | loss: 0.1446932
	speed: 0.0118s/iter; left time: 55.8569s
	iters: 500, epoch: 12 | loss: 0.1685894
	speed: 0.0118s/iter; left time: 54.6031s
Epoch: 12 cost time: 7.028629541397095
Epoch: 12, Steps: 570 | Train Loss: 0.1602082 Vali Loss: 0.0383167 Test Loss: 0.1203712
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12011267244815826, mae:0.2147633582353592
>>> MS_Raw LR=5e-4 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1519469
	speed: 0.0229s/iter; left time: 259.0571s
	iters: 200, epoch: 1 | loss: 0.3518038
	speed: 0.0114s/iter; left time: 127.8033s
	iters: 300, epoch: 1 | loss: 0.1749141
	speed: 0.0114s/iter; left time: 126.7054s
	iters: 400, epoch: 1 | loss: 0.2966926
	speed: 0.0114s/iter; left time: 125.2983s
	iters: 500, epoch: 1 | loss: 0.1596343
	speed: 0.0114s/iter; left time: 124.2566s
Epoch: 1 cost time: 7.698774576187134
Epoch: 1, Steps: 570 | Train Loss: 0.2292013 Vali Loss: 0.0412115 Test Loss: 0.1274067
Validation loss decreased (inf --> 0.041211).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1706311
	speed: 0.0415s/iter; left time: 445.5396s
	iters: 200, epoch: 2 | loss: 0.1401508
	speed: 0.0123s/iter; left time: 130.5371s
	iters: 300, epoch: 2 | loss: 0.1847728
	speed: 0.0115s/iter; left time: 120.9009s
	iters: 400, epoch: 2 | loss: 0.2843027
	speed: 0.0115s/iter; left time: 119.6193s
	iters: 500, epoch: 2 | loss: 0.2906266
	speed: 0.0114s/iter; left time: 118.1114s
Epoch: 2 cost time: 7.045135259628296
Epoch: 2, Steps: 570 | Train Loss: 0.2022052 Vali Loss: 0.0417904 Test Loss: 0.1300673
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1933681
	speed: 0.0380s/iter; left time: 386.1801s
	iters: 200, epoch: 3 | loss: 0.0985367
	speed: 0.0114s/iter; left time: 114.9793s
	iters: 300, epoch: 3 | loss: 0.1996156
	speed: 0.0114s/iter; left time: 113.9054s
	iters: 400, epoch: 3 | loss: 0.1665078
	speed: 0.0115s/iter; left time: 113.1256s
	iters: 500, epoch: 3 | loss: 0.2089575
	speed: 0.0115s/iter; left time: 111.7815s
Epoch: 3 cost time: 6.779023170471191
Epoch: 3, Steps: 570 | Train Loss: 0.1803595 Vali Loss: 0.0353008 Test Loss: 0.1156385
Validation loss decreased (0.041211 --> 0.035301).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1596104
	speed: 0.0392s/iter; left time: 376.0095s
	iters: 200, epoch: 4 | loss: 0.1095146
	speed: 0.0115s/iter; left time: 108.8706s
	iters: 300, epoch: 4 | loss: 0.0954783
	speed: 0.0115s/iter; left time: 107.9818s
	iters: 400, epoch: 4 | loss: 0.1333924
	speed: 0.0115s/iter; left time: 106.9296s
	iters: 500, epoch: 4 | loss: 0.1625584
	speed: 0.0115s/iter; left time: 105.3450s
Epoch: 4 cost time: 6.864339351654053
Epoch: 4, Steps: 570 | Train Loss: 0.1650652 Vali Loss: 0.0338985 Test Loss: 0.1111508
Validation loss decreased (0.035301 --> 0.033899).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1666282
	speed: 0.0395s/iter; left time: 356.3147s
	iters: 200, epoch: 5 | loss: 0.1077879
	speed: 0.0115s/iter; left time: 102.3759s
	iters: 300, epoch: 5 | loss: 0.2390414
	speed: 0.0114s/iter; left time: 100.8658s
	iters: 400, epoch: 5 | loss: 0.1366075
	speed: 0.0114s/iter; left time: 99.5508s
	iters: 500, epoch: 5 | loss: 0.1202177
	speed: 0.0126s/iter; left time: 108.3791s
Epoch: 5 cost time: 7.00616455078125
Epoch: 5, Steps: 570 | Train Loss: 0.1558943 Vali Loss: 0.0339489 Test Loss: 0.1121132
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1796040
	speed: 0.0397s/iter; left time: 335.4926s
	iters: 200, epoch: 6 | loss: 0.1611378
	speed: 0.0126s/iter; left time: 105.3283s
	iters: 300, epoch: 6 | loss: 0.1117627
	speed: 0.0126s/iter; left time: 104.1098s
	iters: 400, epoch: 6 | loss: 0.1110432
	speed: 0.0126s/iter; left time: 103.0072s
	iters: 500, epoch: 6 | loss: 0.1269647
	speed: 0.0126s/iter; left time: 101.5213s
Epoch: 6 cost time: 7.4975361824035645
Epoch: 6, Steps: 570 | Train Loss: 0.1512940 Vali Loss: 0.0335551 Test Loss: 0.1112797
Validation loss decreased (0.033899 --> 0.033555).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1086403
	speed: 0.0413s/iter; left time: 325.5426s
	iters: 200, epoch: 7 | loss: 0.1870593
	speed: 0.0126s/iter; left time: 98.2954s
	iters: 300, epoch: 7 | loss: 0.0947685
	speed: 0.0126s/iter; left time: 96.8806s
	iters: 400, epoch: 7 | loss: 0.1145303
	speed: 0.0126s/iter; left time: 95.7408s
	iters: 500, epoch: 7 | loss: 0.1414022
	speed: 0.0126s/iter; left time: 94.4046s
Epoch: 7 cost time: 7.505728244781494
Epoch: 7, Steps: 570 | Train Loss: 0.1482953 Vali Loss: 0.0331711 Test Loss: 0.1111351
Validation loss decreased (0.033555 --> 0.033171).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1101499
	speed: 0.0402s/iter; left time: 294.0682s
	iters: 200, epoch: 8 | loss: 0.1743105
	speed: 0.0126s/iter; left time: 90.8729s
	iters: 300, epoch: 8 | loss: 0.1020674
	speed: 0.0126s/iter; left time: 89.6524s
	iters: 400, epoch: 8 | loss: 0.1296077
	speed: 0.0126s/iter; left time: 88.3045s
	iters: 500, epoch: 8 | loss: 0.1146621
	speed: 0.0126s/iter; left time: 87.1785s
Epoch: 8 cost time: 7.452226877212524
Epoch: 8, Steps: 570 | Train Loss: 0.1471755 Vali Loss: 0.0333272 Test Loss: 0.1113495
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2292286
	speed: 0.0390s/iter; left time: 262.7754s
	iters: 200, epoch: 9 | loss: 0.1055641
	speed: 0.0127s/iter; left time: 84.1448s
	iters: 300, epoch: 9 | loss: 0.1617718
	speed: 0.0127s/iter; left time: 82.8380s
	iters: 400, epoch: 9 | loss: 0.1685493
	speed: 0.0127s/iter; left time: 81.4919s
	iters: 500, epoch: 9 | loss: 0.2229301
	speed: 0.0126s/iter; left time: 80.0664s
Epoch: 9 cost time: 7.458922863006592
Epoch: 9, Steps: 570 | Train Loss: 0.1456881 Vali Loss: 0.0330472 Test Loss: 0.1112786
Validation loss decreased (0.033171 --> 0.033047).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1415712
	speed: 0.0407s/iter; left time: 250.9478s
	iters: 200, epoch: 10 | loss: 0.1169592
	speed: 0.0126s/iter; left time: 76.7841s
	iters: 300, epoch: 10 | loss: 0.1292818
	speed: 0.0126s/iter; left time: 75.5146s
	iters: 400, epoch: 10 | loss: 0.1493463
	speed: 0.0127s/iter; left time: 74.3461s
	iters: 500, epoch: 10 | loss: 0.1628127
	speed: 0.0126s/iter; left time: 72.9728s
Epoch: 10 cost time: 7.488367080688477
Epoch: 10, Steps: 570 | Train Loss: 0.1465767 Vali Loss: 0.0331408 Test Loss: 0.1112651
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1133842
	speed: 0.0386s/iter; left time: 216.1162s
	iters: 200, epoch: 11 | loss: 0.1636380
	speed: 0.0126s/iter; left time: 69.3386s
	iters: 300, epoch: 11 | loss: 0.1353102
	speed: 0.0126s/iter; left time: 68.0388s
	iters: 400, epoch: 11 | loss: 0.1801481
	speed: 0.0126s/iter; left time: 66.7766s
	iters: 500, epoch: 11 | loss: 0.2217366
	speed: 0.0126s/iter; left time: 65.6859s
Epoch: 11 cost time: 7.452308177947998
Epoch: 11, Steps: 570 | Train Loss: 0.1468188 Vali Loss: 0.0330274 Test Loss: 0.1112319
Validation loss decreased (0.033047 --> 0.033027).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1327773
	speed: 0.0426s/iter; left time: 214.4809s
	iters: 200, epoch: 12 | loss: 0.1372503
	speed: 0.0126s/iter; left time: 62.2478s
	iters: 300, epoch: 12 | loss: 0.1172687
	speed: 0.0126s/iter; left time: 60.9513s
	iters: 400, epoch: 12 | loss: 0.2106243
	speed: 0.0126s/iter; left time: 59.7910s
	iters: 500, epoch: 12 | loss: 0.1307931
	speed: 0.0120s/iter; left time: 55.6253s
Epoch: 12 cost time: 7.345813274383545
Epoch: 12, Steps: 570 | Train Loss: 0.1459731 Vali Loss: 0.0332833 Test Loss: 0.1112486
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2057044
	speed: 0.0401s/iter; left time: 178.7533s
	iters: 200, epoch: 13 | loss: 0.1851881
	speed: 0.0125s/iter; left time: 54.7229s
	iters: 300, epoch: 13 | loss: 0.1428877
	speed: 0.0126s/iter; left time: 53.6701s
	iters: 400, epoch: 13 | loss: 0.1263070
	speed: 0.0122s/iter; left time: 50.7583s
	iters: 500, epoch: 13 | loss: 0.1877145
	speed: 0.0115s/iter; left time: 46.6212s
Epoch: 13 cost time: 7.232044458389282
Epoch: 13, Steps: 570 | Train Loss: 0.1447158 Vali Loss: 0.0331614 Test Loss: 0.1112201
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1153721
	speed: 0.0394s/iter; left time: 153.1974s
	iters: 200, epoch: 14 | loss: 0.2060436
	speed: 0.0126s/iter; left time: 47.6092s
	iters: 300, epoch: 14 | loss: 0.1331390
	speed: 0.0126s/iter; left time: 46.3991s
	iters: 400, epoch: 14 | loss: 0.1472175
	speed: 0.0126s/iter; left time: 45.2127s
	iters: 500, epoch: 14 | loss: 0.2155699
	speed: 0.0126s/iter; left time: 44.0862s
Epoch: 14 cost time: 7.470412492752075
Epoch: 14, Steps: 570 | Train Loss: 0.1452995 Vali Loss: 0.0329629 Test Loss: 0.1111845
Validation loss decreased (0.033027 --> 0.032963).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1701639
	speed: 0.0418s/iter; left time: 138.9334s
	iters: 200, epoch: 15 | loss: 0.1698841
	speed: 0.0127s/iter; left time: 40.8257s
	iters: 300, epoch: 15 | loss: 0.1489871
	speed: 0.0127s/iter; left time: 39.5491s
	iters: 400, epoch: 15 | loss: 0.1076717
	speed: 0.0126s/iter; left time: 38.1662s
	iters: 500, epoch: 15 | loss: 0.1245630
	speed: 0.0126s/iter; left time: 36.9191s
Epoch: 15 cost time: 7.514424085617065
Epoch: 15, Steps: 570 | Train Loss: 0.1444354 Vali Loss: 0.0330157 Test Loss: 0.1111896
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1521598
	speed: 0.0414s/iter; left time: 113.7734s
	iters: 200, epoch: 16 | loss: 0.1556416
	speed: 0.0127s/iter; left time: 33.5538s
	iters: 300, epoch: 16 | loss: 0.1187774
	speed: 0.0127s/iter; left time: 32.3650s
	iters: 400, epoch: 16 | loss: 0.0956007
	speed: 0.0126s/iter; left time: 30.9565s
	iters: 500, epoch: 16 | loss: 0.1450910
	speed: 0.0126s/iter; left time: 29.7243s
Epoch: 16 cost time: 7.472324848175049
Epoch: 16, Steps: 570 | Train Loss: 0.1461396 Vali Loss: 0.0330571 Test Loss: 0.1111890
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1512654
	speed: 0.0395s/iter; left time: 86.0744s
	iters: 200, epoch: 17 | loss: 0.0914336
	speed: 0.0126s/iter; left time: 26.2164s
	iters: 300, epoch: 17 | loss: 0.1645135
	speed: 0.0126s/iter; left time: 24.9459s
	iters: 400, epoch: 17 | loss: 0.0635268
	speed: 0.0126s/iter; left time: 23.7136s
	iters: 500, epoch: 17 | loss: 0.1457991
	speed: 0.0126s/iter; left time: 22.4349s
Epoch: 17 cost time: 7.481920957565308
Epoch: 17, Steps: 570 | Train Loss: 0.1452971 Vali Loss: 0.0331200 Test Loss: 0.1111891
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11135132610797882, mae:0.20238979160785675
>>> MS_Raw LR=5e-4 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3023773
	speed: 0.0237s/iter; left time: 268.3757s
	iters: 200, epoch: 1 | loss: 0.3520382
	speed: 0.0120s/iter; left time: 134.6575s
	iters: 300, epoch: 1 | loss: 0.3291507
	speed: 0.0110s/iter; left time: 121.8049s
	iters: 400, epoch: 1 | loss: 0.2533366
	speed: 0.0108s/iter; left time: 119.1627s
	iters: 500, epoch: 1 | loss: 0.2025783
	speed: 0.0109s/iter; left time: 118.3888s
Epoch: 1 cost time: 7.64365291595459
Epoch: 1, Steps: 570 | Train Loss: 0.2592653 Vali Loss: 0.0470340 Test Loss: 0.1491200
Validation loss decreased (inf --> 0.047034).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2725223
	speed: 0.0388s/iter; left time: 415.8470s
	iters: 200, epoch: 2 | loss: 0.3464039
	speed: 0.0109s/iter; left time: 116.1258s
	iters: 300, epoch: 2 | loss: 0.1615402
	speed: 0.0110s/iter; left time: 115.4127s
	iters: 400, epoch: 2 | loss: 0.1890907
	speed: 0.0109s/iter; left time: 114.1248s
	iters: 500, epoch: 2 | loss: 0.1945120
	speed: 0.0109s/iter; left time: 112.8204s
Epoch: 2 cost time: 6.548222064971924
Epoch: 2, Steps: 570 | Train Loss: 0.2294851 Vali Loss: 0.0506599 Test Loss: 0.1529285
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1668201
	speed: 0.0370s/iter; left time: 376.2501s
	iters: 200, epoch: 3 | loss: 0.1748754
	speed: 0.0109s/iter; left time: 110.1613s
	iters: 300, epoch: 3 | loss: 0.2789643
	speed: 0.0109s/iter; left time: 108.9194s
	iters: 400, epoch: 3 | loss: 0.1677472
	speed: 0.0109s/iter; left time: 107.4614s
	iters: 500, epoch: 3 | loss: 0.2055227
	speed: 0.0109s/iter; left time: 106.6298s
Epoch: 3 cost time: 6.522808313369751
Epoch: 3, Steps: 570 | Train Loss: 0.2052950 Vali Loss: 0.0422072 Test Loss: 0.1373033
Validation loss decreased (0.047034 --> 0.042207).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1818763
	speed: 0.0374s/iter; left time: 358.6319s
	iters: 200, epoch: 4 | loss: 0.1296567
	speed: 0.0108s/iter; left time: 102.9036s
	iters: 300, epoch: 4 | loss: 0.1650539
	speed: 0.0109s/iter; left time: 101.9840s
	iters: 400, epoch: 4 | loss: 0.3428080
	speed: 0.0109s/iter; left time: 100.9635s
	iters: 500, epoch: 4 | loss: 0.1801892
	speed: 0.0108s/iter; left time: 99.7153s
Epoch: 4 cost time: 6.4916040897369385
Epoch: 4, Steps: 570 | Train Loss: 0.1827566 Vali Loss: 0.0414400 Test Loss: 0.1408591
Validation loss decreased (0.042207 --> 0.041440).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1668240
	speed: 0.0380s/iter; left time: 342.8683s
	iters: 200, epoch: 5 | loss: 0.1677529
	speed: 0.0109s/iter; left time: 96.9143s
	iters: 300, epoch: 5 | loss: 0.1709006
	speed: 0.0109s/iter; left time: 95.9655s
	iters: 400, epoch: 5 | loss: 0.1128015
	speed: 0.0109s/iter; left time: 94.7641s
	iters: 500, epoch: 5 | loss: 0.2561677
	speed: 0.0109s/iter; left time: 93.6726s
Epoch: 5 cost time: 6.508579254150391
Epoch: 5, Steps: 570 | Train Loss: 0.1705200 Vali Loss: 0.0390431 Test Loss: 0.1338034
Validation loss decreased (0.041440 --> 0.039043).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1403041
	speed: 0.0388s/iter; left time: 327.5151s
	iters: 200, epoch: 6 | loss: 0.1482296
	speed: 0.0109s/iter; left time: 90.7850s
	iters: 300, epoch: 6 | loss: 0.1887355
	speed: 0.0112s/iter; left time: 92.0784s
	iters: 400, epoch: 6 | loss: 0.1394947
	speed: 0.0114s/iter; left time: 92.9744s
	iters: 500, epoch: 6 | loss: 0.1561777
	speed: 0.0109s/iter; left time: 87.4457s
Epoch: 6 cost time: 6.590046644210815
Epoch: 6, Steps: 570 | Train Loss: 0.1623241 Vali Loss: 0.0388792 Test Loss: 0.1365796
Validation loss decreased (0.039043 --> 0.038879).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1332874
	speed: 0.0374s/iter; left time: 294.5718s
	iters: 200, epoch: 7 | loss: 0.1300848
	speed: 0.0108s/iter; left time: 84.3900s
	iters: 300, epoch: 7 | loss: 0.1099305
	speed: 0.0108s/iter; left time: 83.2028s
	iters: 400, epoch: 7 | loss: 0.1499352
	speed: 0.0108s/iter; left time: 82.1352s
	iters: 500, epoch: 7 | loss: 0.1161368
	speed: 0.0108s/iter; left time: 81.0643s
Epoch: 7 cost time: 6.478965759277344
Epoch: 7, Steps: 570 | Train Loss: 0.1599118 Vali Loss: 0.0385099 Test Loss: 0.1332457
Validation loss decreased (0.038879 --> 0.038510).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1220800
	speed: 0.0373s/iter; left time: 273.0654s
	iters: 200, epoch: 8 | loss: 0.1919292
	speed: 0.0108s/iter; left time: 78.1199s
	iters: 300, epoch: 8 | loss: 0.2086399
	speed: 0.0109s/iter; left time: 77.2357s
	iters: 400, epoch: 8 | loss: 0.1443205
	speed: 0.0108s/iter; left time: 75.9146s
	iters: 500, epoch: 8 | loss: 0.0975310
	speed: 0.0108s/iter; left time: 74.6987s
Epoch: 8 cost time: 6.477285146713257
Epoch: 8, Steps: 570 | Train Loss: 0.1577346 Vali Loss: 0.0380855 Test Loss: 0.1331222
Validation loss decreased (0.038510 --> 0.038086).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1655697
	speed: 0.0386s/iter; left time: 260.3591s
	iters: 200, epoch: 9 | loss: 0.1161146
	speed: 0.0121s/iter; left time: 80.1219s
	iters: 300, epoch: 9 | loss: 0.2196243
	speed: 0.0121s/iter; left time: 78.8283s
	iters: 400, epoch: 9 | loss: 0.2073046
	speed: 0.0109s/iter; left time: 70.1789s
	iters: 500, epoch: 9 | loss: 0.1035316
	speed: 0.0108s/iter; left time: 68.6157s
Epoch: 9 cost time: 6.855144262313843
Epoch: 9, Steps: 570 | Train Loss: 0.1557757 Vali Loss: 0.0381641 Test Loss: 0.1334061
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1572970
	speed: 0.0361s/iter; left time: 222.5558s
	iters: 200, epoch: 10 | loss: 0.0930295
	speed: 0.0109s/iter; left time: 66.0683s
	iters: 300, epoch: 10 | loss: 0.1732631
	speed: 0.0109s/iter; left time: 64.8854s
	iters: 400, epoch: 10 | loss: 0.1366965
	speed: 0.0109s/iter; left time: 63.7120s
	iters: 500, epoch: 10 | loss: 0.1793620
	speed: 0.0108s/iter; left time: 62.5512s
Epoch: 10 cost time: 6.442249298095703
Epoch: 10, Steps: 570 | Train Loss: 0.1560762 Vali Loss: 0.0381785 Test Loss: 0.1330903
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1224089
	speed: 0.0357s/iter; left time: 199.8830s
	iters: 200, epoch: 11 | loss: 0.1424767
	speed: 0.0109s/iter; left time: 59.7535s
	iters: 300, epoch: 11 | loss: 0.1435373
	speed: 0.0109s/iter; left time: 58.8151s
	iters: 400, epoch: 11 | loss: 0.1171310
	speed: 0.0109s/iter; left time: 57.8971s
	iters: 500, epoch: 11 | loss: 0.1325386
	speed: 0.0109s/iter; left time: 56.5508s
Epoch: 11 cost time: 6.478220224380493
Epoch: 11, Steps: 570 | Train Loss: 0.1562124 Vali Loss: 0.0382650 Test Loss: 0.1332655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13330425322055817, mae:0.2314433604478836
>>> MS_Raw LR=5e-4 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2088144
	speed: 0.0284s/iter; left time: 320.8309s
	iters: 200, epoch: 1 | loss: 0.1824291
	speed: 0.0155s/iter; left time: 173.5457s
	iters: 300, epoch: 1 | loss: 0.2788930
	speed: 0.0147s/iter; left time: 163.1976s
	iters: 400, epoch: 1 | loss: 0.2357036
	speed: 0.0163s/iter; left time: 178.8135s
	iters: 500, epoch: 1 | loss: 0.1783668
	speed: 0.0162s/iter; left time: 176.7814s
Epoch: 1 cost time: 10.29509687423706
Epoch: 1, Steps: 570 | Train Loss: 0.2419916 Vali Loss: 0.0462555 Test Loss: 0.1280871
Validation loss decreased (inf --> 0.046256).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3006781
	speed: 0.0481s/iter; left time: 516.3217s
	iters: 200, epoch: 2 | loss: 0.1948502
	speed: 0.0146s/iter; left time: 154.9317s
	iters: 300, epoch: 2 | loss: 0.1645432
	speed: 0.0145s/iter; left time: 152.9312s
	iters: 400, epoch: 2 | loss: 0.1193968
	speed: 0.0156s/iter; left time: 162.6153s
	iters: 500, epoch: 2 | loss: 0.2239374
	speed: 0.0167s/iter; left time: 172.1046s
Epoch: 2 cost time: 9.064303874969482
Epoch: 2, Steps: 570 | Train Loss: 0.2050041 Vali Loss: 0.0459917 Test Loss: 0.1426752
Validation loss decreased (0.046256 --> 0.045992).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3307565
	speed: 0.0523s/iter; left time: 531.0917s
	iters: 200, epoch: 3 | loss: 0.1560543
	speed: 0.0166s/iter; left time: 166.7044s
	iters: 300, epoch: 3 | loss: 0.0987948
	speed: 0.0166s/iter; left time: 165.2012s
	iters: 400, epoch: 3 | loss: 0.1366630
	speed: 0.0166s/iter; left time: 163.3368s
	iters: 500, epoch: 3 | loss: 0.1182564
	speed: 0.0166s/iter; left time: 161.8832s
Epoch: 3 cost time: 9.76691198348999
Epoch: 3, Steps: 570 | Train Loss: 0.1765109 Vali Loss: 0.0391808 Test Loss: 0.1271644
Validation loss decreased (0.045992 --> 0.039181).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1397561
	speed: 0.0484s/iter; left time: 463.8973s
	iters: 200, epoch: 4 | loss: 0.1401083
	speed: 0.0146s/iter; left time: 138.5362s
	iters: 300, epoch: 4 | loss: 0.1984763
	speed: 0.0145s/iter; left time: 136.3483s
	iters: 400, epoch: 4 | loss: 0.1807085
	speed: 0.0145s/iter; left time: 134.7381s
	iters: 500, epoch: 4 | loss: 0.1222808
	speed: 0.0145s/iter; left time: 133.2229s
Epoch: 4 cost time: 8.623505353927612
Epoch: 4, Steps: 570 | Train Loss: 0.1574438 Vali Loss: 0.0374154 Test Loss: 0.1241968
Validation loss decreased (0.039181 --> 0.037415).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1441234
	speed: 0.0492s/iter; left time: 444.1173s
	iters: 200, epoch: 5 | loss: 0.1478885
	speed: 0.0144s/iter; left time: 128.7014s
	iters: 300, epoch: 5 | loss: 0.1427533
	speed: 0.0144s/iter; left time: 127.3169s
	iters: 400, epoch: 5 | loss: 0.1568673
	speed: 0.0144s/iter; left time: 125.8661s
	iters: 500, epoch: 5 | loss: 0.1767756
	speed: 0.0144s/iter; left time: 124.4376s
Epoch: 5 cost time: 8.553967475891113
Epoch: 5, Steps: 570 | Train Loss: 0.1490328 Vali Loss: 0.0381137 Test Loss: 0.1268485
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1252706
	speed: 0.0458s/iter; left time: 386.7732s
	iters: 200, epoch: 6 | loss: 0.1413923
	speed: 0.0145s/iter; left time: 121.4516s
	iters: 300, epoch: 6 | loss: 0.1185930
	speed: 0.0146s/iter; left time: 120.1469s
	iters: 400, epoch: 6 | loss: 0.1176067
	speed: 0.0145s/iter; left time: 118.4912s
	iters: 500, epoch: 6 | loss: 0.1488429
	speed: 0.0145s/iter; left time: 116.8970s
Epoch: 6 cost time: 8.569528579711914
Epoch: 6, Steps: 570 | Train Loss: 0.1430332 Vali Loss: 0.0376692 Test Loss: 0.1223561
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1383386
	speed: 0.0465s/iter; left time: 366.0807s
	iters: 200, epoch: 7 | loss: 0.1056294
	speed: 0.0166s/iter; left time: 128.9937s
	iters: 300, epoch: 7 | loss: 0.1030869
	speed: 0.0145s/iter; left time: 111.5614s
	iters: 400, epoch: 7 | loss: 0.1361030
	speed: 0.0145s/iter; left time: 110.1679s
	iters: 500, epoch: 7 | loss: 0.2070615
	speed: 0.0145s/iter; left time: 108.4079s
Epoch: 7 cost time: 8.827389001846313
Epoch: 7, Steps: 570 | Train Loss: 0.1416667 Vali Loss: 0.0376299 Test Loss: 0.1246513
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12436190247535706, mae:0.21817733347415924
>>> MS_Raw LR=5e-4 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3041493
	speed: 0.0261s/iter; left time: 295.5044s
	iters: 200, epoch: 1 | loss: 0.2585823
	speed: 0.0143s/iter; left time: 160.3062s
	iters: 300, epoch: 1 | loss: 0.1520086
	speed: 0.0143s/iter; left time: 158.8432s
	iters: 400, epoch: 1 | loss: 0.3295628
	speed: 0.0143s/iter; left time: 157.2052s
	iters: 500, epoch: 1 | loss: 0.1836459
	speed: 0.0143s/iter; left time: 155.8028s
Epoch: 1 cost time: 9.389180898666382
Epoch: 1, Steps: 570 | Train Loss: 0.2175849 Vali Loss: 0.0411615 Test Loss: 0.1243817
Validation loss decreased (inf --> 0.041161).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1491904
	speed: 0.0473s/iter; left time: 507.8012s
	iters: 200, epoch: 2 | loss: 0.2791035
	speed: 0.0144s/iter; left time: 152.7545s
	iters: 300, epoch: 2 | loss: 0.1883979
	speed: 0.0144s/iter; left time: 151.4525s
	iters: 400, epoch: 2 | loss: 0.1699372
	speed: 0.0144s/iter; left time: 150.0929s
	iters: 500, epoch: 2 | loss: 0.1642059
	speed: 0.0144s/iter; left time: 149.1589s
Epoch: 2 cost time: 8.633160829544067
Epoch: 2, Steps: 570 | Train Loss: 0.1894586 Vali Loss: 0.0383928 Test Loss: 0.1226561
Validation loss decreased (0.041161 --> 0.038393).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1771815
	speed: 0.0483s/iter; left time: 490.4489s
	iters: 200, epoch: 3 | loss: 0.0839687
	speed: 0.0162s/iter; left time: 162.7996s
	iters: 300, epoch: 3 | loss: 0.2152462
	speed: 0.0161s/iter; left time: 160.2029s
	iters: 400, epoch: 3 | loss: 0.1249974
	speed: 0.0161s/iter; left time: 158.6531s
	iters: 500, epoch: 3 | loss: 0.1507803
	speed: 0.0161s/iter; left time: 156.9849s
Epoch: 3 cost time: 9.470762968063354
Epoch: 3, Steps: 570 | Train Loss: 0.1661950 Vali Loss: 0.0359099 Test Loss: 0.1177011
Validation loss decreased (0.038393 --> 0.035910).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1583731
	speed: 0.0466s/iter; left time: 447.1044s
	iters: 200, epoch: 4 | loss: 0.1549593
	speed: 0.0143s/iter; left time: 135.6118s
	iters: 300, epoch: 4 | loss: 0.1846991
	speed: 0.0143s/iter; left time: 134.3383s
	iters: 400, epoch: 4 | loss: 0.0967964
	speed: 0.0164s/iter; left time: 152.6826s
	iters: 500, epoch: 4 | loss: 0.1095245
	speed: 0.0164s/iter; left time: 150.9369s
Epoch: 4 cost time: 9.012915849685669
Epoch: 4, Steps: 570 | Train Loss: 0.1546359 Vali Loss: 0.0341666 Test Loss: 0.1127359
Validation loss decreased (0.035910 --> 0.034167).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0815493
	speed: 0.0512s/iter; left time: 461.7636s
	iters: 200, epoch: 5 | loss: 0.1315108
	speed: 0.0160s/iter; left time: 142.8852s
	iters: 300, epoch: 5 | loss: 0.1942120
	speed: 0.0161s/iter; left time: 141.8385s
	iters: 400, epoch: 5 | loss: 0.1044161
	speed: 0.0142s/iter; left time: 124.2102s
	iters: 500, epoch: 5 | loss: 0.1637261
	speed: 0.0143s/iter; left time: 123.0320s
Epoch: 5 cost time: 8.959649324417114
Epoch: 5, Steps: 570 | Train Loss: 0.1448837 Vali Loss: 0.0341896 Test Loss: 0.1115746
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1139430
	speed: 0.0444s/iter; left time: 374.8040s
	iters: 200, epoch: 6 | loss: 0.2346027
	speed: 0.0143s/iter; left time: 119.4026s
	iters: 300, epoch: 6 | loss: 0.2354135
	speed: 0.0143s/iter; left time: 117.7936s
	iters: 400, epoch: 6 | loss: 0.1607544
	speed: 0.0142s/iter; left time: 116.0920s
	iters: 500, epoch: 6 | loss: 0.1464290
	speed: 0.0142s/iter; left time: 114.3270s
Epoch: 6 cost time: 8.397758960723877
Epoch: 6, Steps: 570 | Train Loss: 0.1417928 Vali Loss: 0.0337849 Test Loss: 0.1103700
Validation loss decreased (0.034167 --> 0.033785).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1030021
	speed: 0.0468s/iter; left time: 368.9764s
	iters: 200, epoch: 7 | loss: 0.1366124
	speed: 0.0142s/iter; left time: 110.5180s
	iters: 300, epoch: 7 | loss: 0.2279001
	speed: 0.0142s/iter; left time: 109.3256s
	iters: 400, epoch: 7 | loss: 0.1248613
	speed: 0.0142s/iter; left time: 107.3347s
	iters: 500, epoch: 7 | loss: 0.1861413
	speed: 0.0142s/iter; left time: 105.9324s
Epoch: 7 cost time: 8.381710529327393
Epoch: 7, Steps: 570 | Train Loss: 0.1395018 Vali Loss: 0.0332101 Test Loss: 0.1089533
Validation loss decreased (0.033785 --> 0.033210).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0943482
	speed: 0.0470s/iter; left time: 343.6120s
	iters: 200, epoch: 8 | loss: 0.1349510
	speed: 0.0143s/iter; left time: 103.0748s
	iters: 300, epoch: 8 | loss: 0.2093175
	speed: 0.0142s/iter; left time: 101.1859s
	iters: 400, epoch: 8 | loss: 0.1370911
	speed: 0.0143s/iter; left time: 100.1247s
	iters: 500, epoch: 8 | loss: 0.1521060
	speed: 0.0143s/iter; left time: 98.5765s
Epoch: 8 cost time: 8.390963554382324
Epoch: 8, Steps: 570 | Train Loss: 0.1379513 Vali Loss: 0.0333427 Test Loss: 0.1091910
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0990435
	speed: 0.0444s/iter; left time: 299.5854s
	iters: 200, epoch: 9 | loss: 0.1075702
	speed: 0.0156s/iter; left time: 103.4538s
	iters: 300, epoch: 9 | loss: 0.1758587
	speed: 0.0143s/iter; left time: 93.2870s
	iters: 400, epoch: 9 | loss: 0.1283492
	speed: 0.0142s/iter; left time: 91.7773s
	iters: 500, epoch: 9 | loss: 0.1375320
	speed: 0.0145s/iter; left time: 92.1092s
Epoch: 9 cost time: 8.726757526397705
Epoch: 9, Steps: 570 | Train Loss: 0.1371401 Vali Loss: 0.0331055 Test Loss: 0.1088744
Validation loss decreased (0.033210 --> 0.033106).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1440584
	speed: 0.0468s/iter; left time: 288.7654s
	iters: 200, epoch: 10 | loss: 0.1124659
	speed: 0.0143s/iter; left time: 86.7469s
	iters: 300, epoch: 10 | loss: 0.1372264
	speed: 0.0143s/iter; left time: 85.3369s
	iters: 400, epoch: 10 | loss: 0.1360071
	speed: 0.0143s/iter; left time: 83.7681s
	iters: 500, epoch: 10 | loss: 0.1742094
	speed: 0.0143s/iter; left time: 82.4668s
Epoch: 10 cost time: 8.435585737228394
Epoch: 10, Steps: 570 | Train Loss: 0.1371056 Vali Loss: 0.0330677 Test Loss: 0.1088897
Validation loss decreased (0.033106 --> 0.033068).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2021715
	speed: 0.0472s/iter; left time: 264.1613s
	iters: 200, epoch: 11 | loss: 0.1225517
	speed: 0.0153s/iter; left time: 83.9757s
	iters: 300, epoch: 11 | loss: 0.1704631
	speed: 0.0143s/iter; left time: 77.3943s
	iters: 400, epoch: 11 | loss: 0.0939213
	speed: 0.0143s/iter; left time: 75.8471s
	iters: 500, epoch: 11 | loss: 0.2140114
	speed: 0.0143s/iter; left time: 74.4715s
Epoch: 11 cost time: 8.746671676635742
Epoch: 11, Steps: 570 | Train Loss: 0.1350687 Vali Loss: 0.0329884 Test Loss: 0.1088659
Validation loss decreased (0.033068 --> 0.032988).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1625562
	speed: 0.0453s/iter; left time: 228.1218s
	iters: 200, epoch: 12 | loss: 0.1708721
	speed: 0.0142s/iter; left time: 70.1873s
	iters: 300, epoch: 12 | loss: 0.1148917
	speed: 0.0142s/iter; left time: 68.7506s
	iters: 400, epoch: 12 | loss: 0.1476015
	speed: 0.0142s/iter; left time: 67.3943s
	iters: 500, epoch: 12 | loss: 0.1615509
	speed: 0.0142s/iter; left time: 65.9346s
Epoch: 12 cost time: 8.422970533370972
Epoch: 12, Steps: 570 | Train Loss: 0.1370205 Vali Loss: 0.0331084 Test Loss: 0.1088943
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1212869
	speed: 0.0456s/iter; left time: 203.3434s
	iters: 200, epoch: 13 | loss: 0.0968870
	speed: 0.0143s/iter; left time: 62.4062s
	iters: 300, epoch: 13 | loss: 0.1208057
	speed: 0.0143s/iter; left time: 60.8785s
	iters: 400, epoch: 13 | loss: 0.0852482
	speed: 0.0143s/iter; left time: 59.5058s
	iters: 500, epoch: 13 | loss: 0.1432980
	speed: 0.0143s/iter; left time: 58.0285s
Epoch: 13 cost time: 8.461057424545288
Epoch: 13, Steps: 570 | Train Loss: 0.1366182 Vali Loss: 0.0329717 Test Loss: 0.1089000
Validation loss decreased (0.032988 --> 0.032972).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1207893
	speed: 0.0458s/iter; left time: 178.2352s
	iters: 200, epoch: 14 | loss: 0.2127361
	speed: 0.0143s/iter; left time: 54.1732s
	iters: 300, epoch: 14 | loss: 0.0937397
	speed: 0.0142s/iter; left time: 52.5787s
	iters: 400, epoch: 14 | loss: 0.0882648
	speed: 0.0143s/iter; left time: 51.3511s
	iters: 500, epoch: 14 | loss: 0.0805607
	speed: 0.0142s/iter; left time: 49.7329s
Epoch: 14 cost time: 8.448575496673584
Epoch: 14, Steps: 570 | Train Loss: 0.1345381 Vali Loss: 0.0330430 Test Loss: 0.1089277
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1321850
	speed: 0.0445s/iter; left time: 147.7450s
	iters: 200, epoch: 15 | loss: 0.1116377
	speed: 0.0143s/iter; left time: 45.9584s
	iters: 300, epoch: 15 | loss: 0.1358414
	speed: 0.0143s/iter; left time: 44.5233s
	iters: 400, epoch: 15 | loss: 0.1307736
	speed: 0.0143s/iter; left time: 43.0716s
	iters: 500, epoch: 15 | loss: 0.1802043
	speed: 0.0142s/iter; left time: 41.5726s
Epoch: 15 cost time: 8.401792287826538
Epoch: 15, Steps: 570 | Train Loss: 0.1356780 Vali Loss: 0.0330492 Test Loss: 0.1089440
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1402374
	speed: 0.0461s/iter; left time: 126.7662s
	iters: 200, epoch: 16 | loss: 0.1551928
	speed: 0.0142s/iter; left time: 37.7217s
	iters: 300, epoch: 16 | loss: 0.1137916
	speed: 0.0142s/iter; left time: 36.3005s
	iters: 400, epoch: 16 | loss: 0.1630017
	speed: 0.0142s/iter; left time: 34.8797s
	iters: 500, epoch: 16 | loss: 0.1067045
	speed: 0.0143s/iter; left time: 33.5351s
Epoch: 16 cost time: 8.437893867492676
Epoch: 16, Steps: 570 | Train Loss: 0.1356732 Vali Loss: 0.0331464 Test Loss: 0.1089477
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10903660207986832, mae:0.19916637241840363
>>> MS_Raw LR=5e-4 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1381665
	speed: 0.0266s/iter; left time: 300.3423s
	iters: 200, epoch: 1 | loss: 0.3449165
	speed: 0.0143s/iter; left time: 159.8489s
	iters: 300, epoch: 1 | loss: 0.2914426
	speed: 0.0142s/iter; left time: 158.1165s
	iters: 400, epoch: 1 | loss: 0.2373642
	speed: 0.0143s/iter; left time: 157.0245s
	iters: 500, epoch: 1 | loss: 0.2826465
	speed: 0.0142s/iter; left time: 155.1451s
Epoch: 1 cost time: 9.415107727050781
Epoch: 1, Steps: 570 | Train Loss: 0.2493833 Vali Loss: 0.0467754 Test Loss: 0.1420881
Validation loss decreased (inf --> 0.046775).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1900936
	speed: 0.0463s/iter; left time: 497.2786s
	iters: 200, epoch: 2 | loss: 0.2193269
	speed: 0.0143s/iter; left time: 151.9253s
	iters: 300, epoch: 2 | loss: 0.1439174
	speed: 0.0144s/iter; left time: 151.3567s
	iters: 400, epoch: 2 | loss: 0.1681918
	speed: 0.0144s/iter; left time: 150.0084s
	iters: 500, epoch: 2 | loss: 0.2402062
	speed: 0.0144s/iter; left time: 148.4749s
Epoch: 2 cost time: 8.493396043777466
Epoch: 2, Steps: 570 | Train Loss: 0.2090211 Vali Loss: 0.0434395 Test Loss: 0.1385605
Validation loss decreased (0.046775 --> 0.043440).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2056979
	speed: 0.0469s/iter; left time: 477.0080s
	iters: 200, epoch: 3 | loss: 0.2125686
	speed: 0.0144s/iter; left time: 145.1539s
	iters: 300, epoch: 3 | loss: 0.1561041
	speed: 0.0144s/iter; left time: 143.3598s
	iters: 400, epoch: 3 | loss: 0.1571902
	speed: 0.0144s/iter; left time: 142.3080s
	iters: 500, epoch: 3 | loss: 0.2057050
	speed: 0.0144s/iter; left time: 140.5345s
Epoch: 3 cost time: 8.522432088851929
Epoch: 3, Steps: 570 | Train Loss: 0.1796085 Vali Loss: 0.0421454 Test Loss: 0.1335378
Validation loss decreased (0.043440 --> 0.042145).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2165372
	speed: 0.0482s/iter; left time: 462.2922s
	iters: 200, epoch: 4 | loss: 0.1942196
	speed: 0.0162s/iter; left time: 153.3072s
	iters: 300, epoch: 4 | loss: 0.1731071
	speed: 0.0144s/iter; left time: 135.4250s
	iters: 400, epoch: 4 | loss: 0.1457002
	speed: 0.0144s/iter; left time: 133.6582s
	iters: 500, epoch: 4 | loss: 0.1088841
	speed: 0.0144s/iter; left time: 132.1620s
Epoch: 4 cost time: 8.865705251693726
Epoch: 4, Steps: 570 | Train Loss: 0.1631498 Vali Loss: 0.0403996 Test Loss: 0.1263688
Validation loss decreased (0.042145 --> 0.040400).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1325023
	speed: 0.0466s/iter; left time: 420.4430s
	iters: 200, epoch: 5 | loss: 0.1555424
	speed: 0.0144s/iter; left time: 128.3999s
	iters: 300, epoch: 5 | loss: 0.1323898
	speed: 0.0144s/iter; left time: 127.0031s
	iters: 400, epoch: 5 | loss: 0.2263586
	speed: 0.0144s/iter; left time: 125.3393s
	iters: 500, epoch: 5 | loss: 0.1418733
	speed: 0.0144s/iter; left time: 123.8086s
Epoch: 5 cost time: 8.487643241882324
Epoch: 5, Steps: 570 | Train Loss: 0.1533076 Vali Loss: 0.0393731 Test Loss: 0.1267292
Validation loss decreased (0.040400 --> 0.039373).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1757096
	speed: 0.0484s/iter; left time: 409.0844s
	iters: 200, epoch: 6 | loss: 0.1593852
	speed: 0.0163s/iter; left time: 136.0210s
	iters: 300, epoch: 6 | loss: 0.1035415
	speed: 0.0145s/iter; left time: 119.8874s
	iters: 400, epoch: 6 | loss: 0.1843241
	speed: 0.0145s/iter; left time: 118.1290s
	iters: 500, epoch: 6 | loss: 0.1459927
	speed: 0.0144s/iter; left time: 116.2152s
Epoch: 6 cost time: 8.923920154571533
Epoch: 6, Steps: 570 | Train Loss: 0.1486886 Vali Loss: 0.0387617 Test Loss: 0.1253418
Validation loss decreased (0.039373 --> 0.038762).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1954851
	speed: 0.0469s/iter; left time: 369.4940s
	iters: 200, epoch: 7 | loss: 0.0975353
	speed: 0.0144s/iter; left time: 112.3446s
	iters: 300, epoch: 7 | loss: 0.0966628
	speed: 0.0144s/iter; left time: 110.7477s
	iters: 400, epoch: 7 | loss: 0.2145246
	speed: 0.0144s/iter; left time: 108.9931s
	iters: 500, epoch: 7 | loss: 0.1329321
	speed: 0.0144s/iter; left time: 107.6484s
Epoch: 7 cost time: 8.512826681137085
Epoch: 7, Steps: 570 | Train Loss: 0.1470587 Vali Loss: 0.0387335 Test Loss: 0.1235380
Validation loss decreased (0.038762 --> 0.038734).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1238119
	speed: 0.0489s/iter; left time: 357.3686s
	iters: 200, epoch: 8 | loss: 0.1432588
	speed: 0.0160s/iter; left time: 115.3677s
	iters: 300, epoch: 8 | loss: 0.1247279
	speed: 0.0160s/iter; left time: 113.7814s
	iters: 400, epoch: 8 | loss: 0.1522371
	speed: 0.0160s/iter; left time: 112.4136s
	iters: 500, epoch: 8 | loss: 0.0975019
	speed: 0.0160s/iter; left time: 110.6143s
Epoch: 8 cost time: 9.439984798431396
Epoch: 8, Steps: 570 | Train Loss: 0.1456697 Vali Loss: 0.0395853 Test Loss: 0.1261854
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2091442
	speed: 0.0476s/iter; left time: 321.2031s
	iters: 200, epoch: 9 | loss: 0.1126706
	speed: 0.0143s/iter; left time: 94.9196s
	iters: 300, epoch: 9 | loss: 0.0992757
	speed: 0.0143s/iter; left time: 93.6513s
	iters: 400, epoch: 9 | loss: 0.1102065
	speed: 0.0143s/iter; left time: 92.1370s
	iters: 500, epoch: 9 | loss: 0.1507562
	speed: 0.0143s/iter; left time: 90.8615s
Epoch: 9 cost time: 8.427344799041748
Epoch: 9, Steps: 570 | Train Loss: 0.1442083 Vali Loss: 0.0391426 Test Loss: 0.1253360
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1900224
	speed: 0.0460s/iter; left time: 283.8025s
	iters: 200, epoch: 10 | loss: 0.1614278
	speed: 0.0142s/iter; left time: 86.4653s
	iters: 300, epoch: 10 | loss: 0.1242339
	speed: 0.0143s/iter; left time: 85.1892s
	iters: 400, epoch: 10 | loss: 0.1666936
	speed: 0.0143s/iter; left time: 83.7351s
	iters: 500, epoch: 10 | loss: 0.1359811
	speed: 0.0142s/iter; left time: 82.1185s
Epoch: 10 cost time: 8.369952201843262
Epoch: 10, Steps: 570 | Train Loss: 0.1436869 Vali Loss: 0.0391266 Test Loss: 0.1257459
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12369126081466675, mae:0.22086134552955627
>>> MS_Raw LR=5e-4 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2958392
	speed: 0.0291s/iter; left time: 329.0804s
	iters: 200, epoch: 1 | loss: 0.1971780
	speed: 0.0171s/iter; left time: 191.0875s
	iters: 300, epoch: 1 | loss: 0.2727989
	speed: 0.0170s/iter; left time: 188.2769s
	iters: 400, epoch: 1 | loss: 0.2513632
	speed: 0.0170s/iter; left time: 186.5012s
	iters: 500, epoch: 1 | loss: 0.2136229
	speed: 0.0169s/iter; left time: 184.4971s
Epoch: 1 cost time: 10.940832138061523
Epoch: 1, Steps: 570 | Train Loss: 0.2550540 Vali Loss: 0.0474312 Test Loss: 0.1496193
Validation loss decreased (inf --> 0.047431).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2432267
	speed: 0.0517s/iter; left time: 554.3584s
	iters: 200, epoch: 2 | loss: 0.2498724
	speed: 0.0170s/iter; left time: 180.8741s
	iters: 300, epoch: 2 | loss: 0.2779619
	speed: 0.0170s/iter; left time: 178.8037s
	iters: 400, epoch: 2 | loss: 0.1651098
	speed: 0.0170s/iter; left time: 176.9804s
	iters: 500, epoch: 2 | loss: 0.1844755
	speed: 0.0170s/iter; left time: 175.2944s
Epoch: 2 cost time: 9.992630958557129
Epoch: 2, Steps: 570 | Train Loss: 0.2384399 Vali Loss: 0.0586837 Test Loss: 0.1700942
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2058848
	speed: 0.0500s/iter; left time: 508.5044s
	iters: 200, epoch: 3 | loss: 0.1983583
	speed: 0.0170s/iter; left time: 170.6446s
	iters: 300, epoch: 3 | loss: 0.3410145
	speed: 0.0169s/iter; left time: 168.7408s
	iters: 400, epoch: 3 | loss: 0.1681196
	speed: 0.0170s/iter; left time: 167.2121s
	iters: 500, epoch: 3 | loss: 0.1727709
	speed: 0.0170s/iter; left time: 165.4636s
Epoch: 3 cost time: 9.934950351715088
Epoch: 3, Steps: 570 | Train Loss: 0.2248720 Vali Loss: 0.0464250 Test Loss: 0.1407486
Validation loss decreased (0.047431 --> 0.046425).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1574557
	speed: 0.0541s/iter; left time: 519.1934s
	iters: 200, epoch: 4 | loss: 0.2051149
	speed: 0.0170s/iter; left time: 161.4396s
	iters: 300, epoch: 4 | loss: 0.2613001
	speed: 0.0170s/iter; left time: 159.8161s
	iters: 400, epoch: 4 | loss: 0.2122735
	speed: 0.0170s/iter; left time: 157.9571s
	iters: 500, epoch: 4 | loss: 0.2093787
	speed: 0.0170s/iter; left time: 156.2061s
Epoch: 4 cost time: 10.021089315414429
Epoch: 4, Steps: 570 | Train Loss: 0.1972890 Vali Loss: 0.0443675 Test Loss: 0.1331053
Validation loss decreased (0.046425 --> 0.044367).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1237682
	speed: 0.0513s/iter; left time: 462.8591s
	iters: 200, epoch: 5 | loss: 0.2852994
	speed: 0.0170s/iter; left time: 151.4425s
	iters: 300, epoch: 5 | loss: 0.1794762
	speed: 0.0169s/iter; left time: 149.2592s
	iters: 400, epoch: 5 | loss: 0.2154945
	speed: 0.0169s/iter; left time: 147.5295s
	iters: 500, epoch: 5 | loss: 0.1389254
	speed: 0.0169s/iter; left time: 146.0367s
Epoch: 5 cost time: 9.98228669166565
Epoch: 5, Steps: 570 | Train Loss: 0.1862711 Vali Loss: 0.0417370 Test Loss: 0.1288609
Validation loss decreased (0.044367 --> 0.041737).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2081187
	speed: 0.0512s/iter; left time: 432.8351s
	iters: 200, epoch: 6 | loss: 0.1423266
	speed: 0.0170s/iter; left time: 142.0613s
	iters: 300, epoch: 6 | loss: 0.2063590
	speed: 0.0170s/iter; left time: 140.2229s
	iters: 400, epoch: 6 | loss: 0.2357511
	speed: 0.0170s/iter; left time: 138.8051s
	iters: 500, epoch: 6 | loss: 0.1809550
	speed: 0.0170s/iter; left time: 137.1007s
Epoch: 6 cost time: 10.014776468276978
Epoch: 6, Steps: 570 | Train Loss: 0.1806376 Vali Loss: 0.0412314 Test Loss: 0.1279439
Validation loss decreased (0.041737 --> 0.041231).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1608773
	speed: 0.0516s/iter; left time: 406.9871s
	iters: 200, epoch: 7 | loss: 0.2030581
	speed: 0.0170s/iter; left time: 132.0565s
	iters: 300, epoch: 7 | loss: 0.2310962
	speed: 0.0170s/iter; left time: 130.2417s
	iters: 400, epoch: 7 | loss: 0.1222981
	speed: 0.0169s/iter; left time: 128.3060s
	iters: 500, epoch: 7 | loss: 0.1308530
	speed: 0.0169s/iter; left time: 126.6319s
Epoch: 7 cost time: 9.996341705322266
Epoch: 7, Steps: 570 | Train Loss: 0.1756744 Vali Loss: 0.0416139 Test Loss: 0.1276427
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1781857
	speed: 0.0506s/iter; left time: 370.0749s
	iters: 200, epoch: 8 | loss: 0.1287111
	speed: 0.0169s/iter; left time: 122.1382s
	iters: 300, epoch: 8 | loss: 0.1429879
	speed: 0.0170s/iter; left time: 120.6334s
	iters: 400, epoch: 8 | loss: 0.1149336
	speed: 0.0170s/iter; left time: 118.8951s
	iters: 500, epoch: 8 | loss: 0.1402981
	speed: 0.0169s/iter; left time: 117.1047s
Epoch: 8 cost time: 9.92774510383606
Epoch: 8, Steps: 570 | Train Loss: 0.1750025 Vali Loss: 0.0413127 Test Loss: 0.1273950
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1620007
	speed: 0.0499s/iter; left time: 336.3016s
	iters: 200, epoch: 9 | loss: 0.1230296
	speed: 0.0170s/iter; left time: 112.9909s
	iters: 300, epoch: 9 | loss: 0.1626625
	speed: 0.0170s/iter; left time: 111.4988s
	iters: 400, epoch: 9 | loss: 0.2064057
	speed: 0.0170s/iter; left time: 109.6676s
	iters: 500, epoch: 9 | loss: 0.2402835
	speed: 0.0171s/iter; left time: 108.1778s
Epoch: 9 cost time: 9.991116285324097
Epoch: 9, Steps: 570 | Train Loss: 0.1738157 Vali Loss: 0.0414313 Test Loss: 0.1275823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1281076818704605, mae:0.2205001711845398
>>> MS_Raw LR=5e-4 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2068312
	speed: 0.0283s/iter; left time: 320.0809s
	iters: 200, epoch: 1 | loss: 0.1475040
	speed: 0.0164s/iter; left time: 183.7623s
	iters: 300, epoch: 1 | loss: 0.2655107
	speed: 0.0164s/iter; left time: 182.0436s
	iters: 400, epoch: 1 | loss: 0.1900390
	speed: 0.0164s/iter; left time: 180.3208s
	iters: 500, epoch: 1 | loss: 0.1433915
	speed: 0.0164s/iter; left time: 178.6626s
Epoch: 1 cost time: 10.588725328445435
Epoch: 1, Steps: 570 | Train Loss: 0.2343052 Vali Loss: 0.0426553 Test Loss: 0.1378862
Validation loss decreased (inf --> 0.042655).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1608283
	speed: 0.0521s/iter; left time: 558.5533s
	iters: 200, epoch: 2 | loss: 0.1833935
	speed: 0.0179s/iter; left time: 190.0237s
	iters: 300, epoch: 2 | loss: 0.2451425
	speed: 0.0179s/iter; left time: 188.0523s
	iters: 400, epoch: 2 | loss: 0.3889318
	speed: 0.0179s/iter; left time: 186.4362s
	iters: 500, epoch: 2 | loss: 0.2141431
	speed: 0.0179s/iter; left time: 184.4087s
Epoch: 2 cost time: 10.512794971466064
Epoch: 2, Steps: 570 | Train Loss: 0.2236655 Vali Loss: 0.0419637 Test Loss: 0.1399358
Validation loss decreased (0.042655 --> 0.041964).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2036266
	speed: 0.0531s/iter; left time: 539.9351s
	iters: 200, epoch: 3 | loss: 0.2122304
	speed: 0.0164s/iter; left time: 165.0708s
	iters: 300, epoch: 3 | loss: 0.1900365
	speed: 0.0164s/iter; left time: 163.6005s
	iters: 400, epoch: 3 | loss: 0.2440022
	speed: 0.0164s/iter; left time: 161.6043s
	iters: 500, epoch: 3 | loss: 0.1065650
	speed: 0.0164s/iter; left time: 160.4830s
Epoch: 3 cost time: 9.68408465385437
Epoch: 3, Steps: 570 | Train Loss: 0.1956232 Vali Loss: 0.0376617 Test Loss: 0.1246283
Validation loss decreased (0.041964 --> 0.037662).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1733230
	speed: 0.0503s/iter; left time: 482.5977s
	iters: 200, epoch: 4 | loss: 0.3698699
	speed: 0.0164s/iter; left time: 155.2701s
	iters: 300, epoch: 4 | loss: 0.1629041
	speed: 0.0164s/iter; left time: 153.6640s
	iters: 400, epoch: 4 | loss: 0.1191096
	speed: 0.0163s/iter; left time: 151.8585s
	iters: 500, epoch: 4 | loss: 0.2356152
	speed: 0.0164s/iter; left time: 150.3823s
Epoch: 4 cost time: 9.644526481628418
Epoch: 4, Steps: 570 | Train Loss: 0.1789920 Vali Loss: 0.0367390 Test Loss: 0.1175551
Validation loss decreased (0.037662 --> 0.036739).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1773712
	speed: 0.0497s/iter; left time: 448.2281s
	iters: 200, epoch: 5 | loss: 0.2478509
	speed: 0.0164s/iter; left time: 146.6310s
	iters: 300, epoch: 5 | loss: 0.1592406
	speed: 0.0165s/iter; left time: 145.5170s
	iters: 400, epoch: 5 | loss: 0.1151561
	speed: 0.0165s/iter; left time: 143.8966s
	iters: 500, epoch: 5 | loss: 0.2273076
	speed: 0.0165s/iter; left time: 142.0253s
Epoch: 5 cost time: 9.702965497970581
Epoch: 5, Steps: 570 | Train Loss: 0.1693784 Vali Loss: 0.0352099 Test Loss: 0.1135109
Validation loss decreased (0.036739 --> 0.035210).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1581204
	speed: 0.0534s/iter; left time: 450.9086s
	iters: 200, epoch: 6 | loss: 0.2331288
	speed: 0.0172s/iter; left time: 143.5878s
	iters: 300, epoch: 6 | loss: 0.2776801
	speed: 0.0164s/iter; left time: 135.6529s
	iters: 400, epoch: 6 | loss: 0.1604757
	speed: 0.0164s/iter; left time: 134.0801s
	iters: 500, epoch: 6 | loss: 0.1558830
	speed: 0.0164s/iter; left time: 132.2430s
Epoch: 6 cost time: 9.907132148742676
Epoch: 6, Steps: 570 | Train Loss: 0.1640407 Vali Loss: 0.0348077 Test Loss: 0.1118976
Validation loss decreased (0.035210 --> 0.034808).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2196183
	speed: 0.0522s/iter; left time: 411.3886s
	iters: 200, epoch: 7 | loss: 0.1099205
	speed: 0.0164s/iter; left time: 127.3864s
	iters: 300, epoch: 7 | loss: 0.1736868
	speed: 0.0164s/iter; left time: 125.8910s
	iters: 400, epoch: 7 | loss: 0.2072969
	speed: 0.0164s/iter; left time: 124.4272s
	iters: 500, epoch: 7 | loss: 0.2354021
	speed: 0.0164s/iter; left time: 122.3905s
Epoch: 7 cost time: 9.640367269515991
Epoch: 7, Steps: 570 | Train Loss: 0.1619769 Vali Loss: 0.0341742 Test Loss: 0.1114734
Validation loss decreased (0.034808 --> 0.034174).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0833036
	speed: 0.0505s/iter; left time: 368.8680s
	iters: 200, epoch: 8 | loss: 0.2457558
	speed: 0.0164s/iter; left time: 118.2984s
	iters: 300, epoch: 8 | loss: 0.1971235
	speed: 0.0164s/iter; left time: 116.5942s
	iters: 400, epoch: 8 | loss: 0.1781801
	speed: 0.0164s/iter; left time: 115.0927s
	iters: 500, epoch: 8 | loss: 0.1443961
	speed: 0.0165s/iter; left time: 113.8841s
Epoch: 8 cost time: 9.734803676605225
Epoch: 8, Steps: 570 | Train Loss: 0.1589763 Vali Loss: 0.0339690 Test Loss: 0.1106487
Validation loss decreased (0.034174 --> 0.033969).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0992123
	speed: 0.0515s/iter; left time: 346.9547s
	iters: 200, epoch: 9 | loss: 0.1586944
	speed: 0.0179s/iter; left time: 119.2010s
	iters: 300, epoch: 9 | loss: 0.0967666
	speed: 0.0179s/iter; left time: 117.1918s
	iters: 400, epoch: 9 | loss: 0.1272036
	speed: 0.0179s/iter; left time: 115.2183s
	iters: 500, epoch: 9 | loss: 0.0852321
	speed: 0.0179s/iter; left time: 113.3357s
Epoch: 9 cost time: 10.497414827346802
Epoch: 9, Steps: 570 | Train Loss: 0.1580761 Vali Loss: 0.0339173 Test Loss: 0.1107529
Validation loss decreased (0.033969 --> 0.033917).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1669910
	speed: 0.0529s/iter; left time: 326.3556s
	iters: 200, epoch: 10 | loss: 0.1650951
	speed: 0.0164s/iter; left time: 99.5738s
	iters: 300, epoch: 10 | loss: 0.1311248
	speed: 0.0164s/iter; left time: 97.7726s
	iters: 400, epoch: 10 | loss: 0.1945249
	speed: 0.0164s/iter; left time: 96.2666s
	iters: 500, epoch: 10 | loss: 0.1179071
	speed: 0.0164s/iter; left time: 94.5250s
Epoch: 10 cost time: 9.6607346534729
Epoch: 10, Steps: 570 | Train Loss: 0.1578447 Vali Loss: 0.0338990 Test Loss: 0.1106659
Validation loss decreased (0.033917 --> 0.033899).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1007985
	speed: 0.0514s/iter; left time: 287.6200s
	iters: 200, epoch: 11 | loss: 0.1268860
	speed: 0.0168s/iter; left time: 92.5015s
	iters: 300, epoch: 11 | loss: 0.1053247
	speed: 0.0164s/iter; left time: 88.8121s
	iters: 400, epoch: 11 | loss: 0.1901793
	speed: 0.0165s/iter; left time: 87.2509s
	iters: 500, epoch: 11 | loss: 0.1574086
	speed: 0.0164s/iter; left time: 85.5246s
Epoch: 11 cost time: 9.883954048156738
Epoch: 11, Steps: 570 | Train Loss: 0.1576925 Vali Loss: 0.0340112 Test Loss: 0.1106179
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1106339
	speed: 0.0507s/iter; left time: 254.8587s
	iters: 200, epoch: 12 | loss: 0.1610774
	speed: 0.0164s/iter; left time: 80.9860s
	iters: 300, epoch: 12 | loss: 0.0931303
	speed: 0.0164s/iter; left time: 79.2862s
	iters: 400, epoch: 12 | loss: 0.1648269
	speed: 0.0164s/iter; left time: 77.6109s
	iters: 500, epoch: 12 | loss: 0.2387092
	speed: 0.0164s/iter; left time: 75.9429s
Epoch: 12 cost time: 9.64483094215393
Epoch: 12, Steps: 570 | Train Loss: 0.1574193 Vali Loss: 0.0339695 Test Loss: 0.1105909
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2163615
	speed: 0.0494s/iter; left time: 220.3397s
	iters: 200, epoch: 13 | loss: 0.2399940
	speed: 0.0165s/iter; left time: 71.7901s
	iters: 300, epoch: 13 | loss: 0.2056655
	speed: 0.0165s/iter; left time: 70.1593s
	iters: 400, epoch: 13 | loss: 0.1324357
	speed: 0.0164s/iter; left time: 68.3785s
	iters: 500, epoch: 13 | loss: 0.1442983
	speed: 0.0165s/iter; left time: 66.8177s
Epoch: 13 cost time: 9.678538799285889
Epoch: 13, Steps: 570 | Train Loss: 0.1575063 Vali Loss: 0.0340451 Test Loss: 0.1105785
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11083490401506424, mae:0.20302008092403412
>>> MS_Raw LR=5e-4 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2738749
	speed: 0.0271s/iter; left time: 306.5079s
	iters: 200, epoch: 1 | loss: 0.2410658
	speed: 0.0155s/iter; left time: 173.2409s
	iters: 300, epoch: 1 | loss: 0.1838185
	speed: 0.0154s/iter; left time: 171.4193s
	iters: 400, epoch: 1 | loss: 0.3203909
	speed: 0.0154s/iter; left time: 169.7657s
	iters: 500, epoch: 1 | loss: 0.3899314
	speed: 0.0154s/iter; left time: 168.2514s
Epoch: 1 cost time: 10.022406101226807
Epoch: 1, Steps: 570 | Train Loss: 0.2626514 Vali Loss: 0.0484837 Test Loss: 0.1565852
Validation loss decreased (inf --> 0.048484).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2507294
	speed: 0.0482s/iter; left time: 516.7596s
	iters: 200, epoch: 2 | loss: 0.1554500
	speed: 0.0155s/iter; left time: 164.9797s
	iters: 300, epoch: 2 | loss: 0.2832112
	speed: 0.0163s/iter; left time: 171.1816s
	iters: 400, epoch: 2 | loss: 0.2342743
	speed: 0.0171s/iter; left time: 177.9315s
	iters: 500, epoch: 2 | loss: 0.3202891
	speed: 0.0170s/iter; left time: 176.0746s
Epoch: 2 cost time: 9.621971130371094
Epoch: 2, Steps: 570 | Train Loss: 0.2514978 Vali Loss: 0.0754417 Test Loss: 0.2028981
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3472426
	speed: 0.0481s/iter; left time: 488.9935s
	iters: 200, epoch: 3 | loss: 0.1513417
	speed: 0.0154s/iter; left time: 155.2861s
	iters: 300, epoch: 3 | loss: 0.3537053
	speed: 0.0154s/iter; left time: 153.3068s
	iters: 400, epoch: 3 | loss: 0.2166460
	speed: 0.0154s/iter; left time: 151.8755s
	iters: 500, epoch: 3 | loss: 0.2753240
	speed: 0.0154s/iter; left time: 150.2251s
Epoch: 3 cost time: 9.069942712783813
Epoch: 3, Steps: 570 | Train Loss: 0.2626431 Vali Loss: 0.0480382 Test Loss: 0.1509399
Validation loss decreased (0.048484 --> 0.048038).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1961316
	speed: 0.0481s/iter; left time: 461.7360s
	iters: 200, epoch: 4 | loss: 0.2935966
	speed: 0.0154s/iter; left time: 146.3884s
	iters: 300, epoch: 4 | loss: 0.3480114
	speed: 0.0154s/iter; left time: 144.7616s
	iters: 400, epoch: 4 | loss: 0.2189986
	speed: 0.0155s/iter; left time: 143.7177s
	iters: 500, epoch: 4 | loss: 0.2833834
	speed: 0.0155s/iter; left time: 142.0080s
Epoch: 4 cost time: 9.089573383331299
Epoch: 4, Steps: 570 | Train Loss: 0.2311800 Vali Loss: 0.0482368 Test Loss: 0.1470153
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1678876
	speed: 0.0480s/iter; left time: 433.1294s
	iters: 200, epoch: 5 | loss: 0.1962808
	speed: 0.0154s/iter; left time: 137.6828s
	iters: 300, epoch: 5 | loss: 0.1936736
	speed: 0.0154s/iter; left time: 135.9655s
	iters: 400, epoch: 5 | loss: 0.1584071
	speed: 0.0154s/iter; left time: 134.2914s
	iters: 500, epoch: 5 | loss: 0.2072518
	speed: 0.0154s/iter; left time: 132.7184s
Epoch: 5 cost time: 9.034584760665894
Epoch: 5, Steps: 570 | Train Loss: 0.2162158 Vali Loss: 0.0466264 Test Loss: 0.1401968
Validation loss decreased (0.048038 --> 0.046626).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1975028
	speed: 0.0478s/iter; left time: 403.9488s
	iters: 200, epoch: 6 | loss: 0.1984609
	speed: 0.0155s/iter; left time: 129.2812s
	iters: 300, epoch: 6 | loss: 0.1290805
	speed: 0.0155s/iter; left time: 127.6477s
	iters: 400, epoch: 6 | loss: 0.1410978
	speed: 0.0155s/iter; left time: 126.2028s
	iters: 500, epoch: 6 | loss: 0.1558844
	speed: 0.0155s/iter; left time: 124.4833s
Epoch: 6 cost time: 9.102726697921753
Epoch: 6, Steps: 570 | Train Loss: 0.2068572 Vali Loss: 0.0456033 Test Loss: 0.1415516
Validation loss decreased (0.046626 --> 0.045603).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2529387
	speed: 0.0492s/iter; left time: 387.5608s
	iters: 200, epoch: 7 | loss: 0.1949639
	speed: 0.0154s/iter; left time: 120.0338s
	iters: 300, epoch: 7 | loss: 0.1584079
	speed: 0.0155s/iter; left time: 118.8488s
	iters: 400, epoch: 7 | loss: 0.2333105
	speed: 0.0155s/iter; left time: 117.1352s
	iters: 500, epoch: 7 | loss: 0.2131604
	speed: 0.0154s/iter; left time: 115.4559s
Epoch: 7 cost time: 9.095977306365967
Epoch: 7, Steps: 570 | Train Loss: 0.2030053 Vali Loss: 0.0455402 Test Loss: 0.1392490
Validation loss decreased (0.045603 --> 0.045540).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1815846
	speed: 0.0501s/iter; left time: 366.2087s
	iters: 200, epoch: 8 | loss: 0.2485581
	speed: 0.0155s/iter; left time: 111.4655s
	iters: 300, epoch: 8 | loss: 0.1278086
	speed: 0.0154s/iter; left time: 109.7831s
	iters: 400, epoch: 8 | loss: 0.1952574
	speed: 0.0155s/iter; left time: 108.5032s
	iters: 500, epoch: 8 | loss: 0.1229836
	speed: 0.0155s/iter; left time: 106.8672s
Epoch: 8 cost time: 9.104357242584229
Epoch: 8, Steps: 570 | Train Loss: 0.2005512 Vali Loss: 0.0445065 Test Loss: 0.1393705
Validation loss decreased (0.045540 --> 0.044507).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1886239
	speed: 0.0477s/iter; left time: 321.3547s
	iters: 200, epoch: 9 | loss: 0.1721874
	speed: 0.0154s/iter; left time: 102.3101s
	iters: 300, epoch: 9 | loss: 0.2327887
	speed: 0.0154s/iter; left time: 100.6663s
	iters: 400, epoch: 9 | loss: 0.1441329
	speed: 0.0154s/iter; left time: 98.8867s
	iters: 500, epoch: 9 | loss: 0.1836031
	speed: 0.0154s/iter; left time: 97.3579s
Epoch: 9 cost time: 9.055256843566895
Epoch: 9, Steps: 570 | Train Loss: 0.1996132 Vali Loss: 0.0446082 Test Loss: 0.1392387
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.2538546
	speed: 0.0491s/iter; left time: 302.9164s
	iters: 200, epoch: 10 | loss: 0.2266675
	speed: 0.0155s/iter; left time: 94.2412s
	iters: 300, epoch: 10 | loss: 0.1425828
	speed: 0.0156s/iter; left time: 93.0027s
	iters: 400, epoch: 10 | loss: 0.2254750
	speed: 0.0155s/iter; left time: 91.2481s
	iters: 500, epoch: 10 | loss: 0.3943844
	speed: 0.0155s/iter; left time: 89.5653s
Epoch: 10 cost time: 9.244706392288208
Epoch: 10, Steps: 570 | Train Loss: 0.2003246 Vali Loss: 0.0444149 Test Loss: 0.1389218
Validation loss decreased (0.044507 --> 0.044415).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2145433
	speed: 0.0493s/iter; left time: 275.9604s
	iters: 200, epoch: 11 | loss: 0.1607526
	speed: 0.0155s/iter; left time: 85.4020s
	iters: 300, epoch: 11 | loss: 0.1815906
	speed: 0.0155s/iter; left time: 83.8500s
	iters: 400, epoch: 11 | loss: 0.2530977
	speed: 0.0155s/iter; left time: 82.1791s
	iters: 500, epoch: 11 | loss: 0.2577681
	speed: 0.0155s/iter; left time: 80.7150s
Epoch: 11 cost time: 9.166627168655396
Epoch: 11, Steps: 570 | Train Loss: 0.1997284 Vali Loss: 0.0445360 Test Loss: 0.1388688
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1345384
	speed: 0.0478s/iter; left time: 240.2674s
	iters: 200, epoch: 12 | loss: 0.3895433
	speed: 0.0155s/iter; left time: 76.5720s
	iters: 300, epoch: 12 | loss: 0.2682382
	speed: 0.0155s/iter; left time: 74.9047s
	iters: 400, epoch: 12 | loss: 0.1882094
	speed: 0.0155s/iter; left time: 73.3680s
	iters: 500, epoch: 12 | loss: 0.1769363
	speed: 0.0155s/iter; left time: 71.8059s
Epoch: 12 cost time: 9.134803771972656
Epoch: 12, Steps: 570 | Train Loss: 0.2000720 Vali Loss: 0.0445321 Test Loss: 0.1389161
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2760415
	speed: 0.0482s/iter; left time: 214.8642s
	iters: 200, epoch: 13 | loss: 0.1822870
	speed: 0.0170s/iter; left time: 74.2696s
	iters: 300, epoch: 13 | loss: 0.1951600
	speed: 0.0171s/iter; left time: 72.7010s
	iters: 400, epoch: 13 | loss: 0.2494859
	speed: 0.0170s/iter; left time: 70.7341s
	iters: 500, epoch: 13 | loss: 0.1471906
	speed: 0.0170s/iter; left time: 68.9754s
Epoch: 13 cost time: 9.900202989578247
Epoch: 13, Steps: 570 | Train Loss: 0.2007352 Vali Loss: 0.0444837 Test Loss: 0.1388606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1390725076198578, mae:0.2316804677248001
>>> MS_Raw LR=5e-4 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1979800
	speed: 0.0327s/iter; left time: 369.7110s
	iters: 200, epoch: 1 | loss: 0.2329361
	speed: 0.0209s/iter; left time: 233.7143s
	iters: 300, epoch: 1 | loss: 0.3890593
	speed: 0.0209s/iter; left time: 231.6172s
	iters: 400, epoch: 1 | loss: 0.1947859
	speed: 0.0209s/iter; left time: 229.5924s
	iters: 500, epoch: 1 | loss: 0.1655631
	speed: 0.0208s/iter; left time: 227.2435s
Epoch: 1 cost time: 13.12596321105957
Epoch: 1, Steps: 570 | Train Loss: 0.2447270 Vali Loss: 0.0476489 Test Loss: 0.1459083
Validation loss decreased (inf --> 0.047649).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3815386
	speed: 0.0595s/iter; left time: 638.2411s
	iters: 200, epoch: 2 | loss: 0.1765963
	speed: 0.0187s/iter; left time: 199.1495s
	iters: 300, epoch: 2 | loss: 0.1362110
	speed: 0.0187s/iter; left time: 196.7280s
	iters: 400, epoch: 2 | loss: 0.1704368
	speed: 0.0187s/iter; left time: 194.6322s
	iters: 500, epoch: 2 | loss: 0.1821329
	speed: 0.0186s/iter; left time: 192.4144s
Epoch: 2 cost time: 10.956067562103271
Epoch: 2, Steps: 570 | Train Loss: 0.2095919 Vali Loss: 0.0445460 Test Loss: 0.1347510
Validation loss decreased (0.047649 --> 0.044546).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1477922
	speed: 0.0571s/iter; left time: 579.8712s
	iters: 200, epoch: 3 | loss: 0.1658632
	speed: 0.0186s/iter; left time: 187.3731s
	iters: 300, epoch: 3 | loss: 0.2155154
	speed: 0.0187s/iter; left time: 185.8804s
	iters: 400, epoch: 3 | loss: 0.1262809
	speed: 0.0186s/iter; left time: 183.9068s
	iters: 500, epoch: 3 | loss: 0.1303732
	speed: 0.0187s/iter; left time: 182.2092s
Epoch: 3 cost time: 10.925706148147583
Epoch: 3, Steps: 570 | Train Loss: 0.1854190 Vali Loss: 0.0436595 Test Loss: 0.1318966
Validation loss decreased (0.044546 --> 0.043659).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1870910
	speed: 0.0571s/iter; left time: 547.5735s
	iters: 200, epoch: 4 | loss: 0.2351542
	speed: 0.0188s/iter; left time: 178.0941s
	iters: 300, epoch: 4 | loss: 0.1840209
	speed: 0.0187s/iter; left time: 175.9223s
	iters: 400, epoch: 4 | loss: 0.0944235
	speed: 0.0187s/iter; left time: 173.7842s
	iters: 500, epoch: 4 | loss: 0.1628318
	speed: 0.0187s/iter; left time: 172.1848s
Epoch: 4 cost time: 11.011226415634155
Epoch: 4, Steps: 570 | Train Loss: 0.1660591 Vali Loss: 0.0401228 Test Loss: 0.1307222
Validation loss decreased (0.043659 --> 0.040123).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2354830
	speed: 0.0628s/iter; left time: 566.5209s
	iters: 200, epoch: 5 | loss: 0.1616431
	speed: 0.0209s/iter; left time: 186.2300s
	iters: 300, epoch: 5 | loss: 0.1415432
	speed: 0.0200s/iter; left time: 176.4608s
	iters: 400, epoch: 5 | loss: 0.1302704
	speed: 0.0208s/iter; left time: 181.5825s
	iters: 500, epoch: 5 | loss: 0.1366715
	speed: 0.0214s/iter; left time: 184.7415s
Epoch: 5 cost time: 12.233418941497803
Epoch: 5, Steps: 570 | Train Loss: 0.1549483 Vali Loss: 0.0393205 Test Loss: 0.1318874
Validation loss decreased (0.040123 --> 0.039320).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0862106
	speed: 0.0591s/iter; left time: 499.5353s
	iters: 200, epoch: 6 | loss: 0.1426957
	speed: 0.0187s/iter; left time: 156.3839s
	iters: 300, epoch: 6 | loss: 0.1217947
	speed: 0.0187s/iter; left time: 154.1171s
	iters: 400, epoch: 6 | loss: 0.1642987
	speed: 0.0187s/iter; left time: 152.3880s
	iters: 500, epoch: 6 | loss: 0.1378561
	speed: 0.0187s/iter; left time: 150.3682s
Epoch: 6 cost time: 10.981086730957031
Epoch: 6, Steps: 570 | Train Loss: 0.1476896 Vali Loss: 0.0385074 Test Loss: 0.1282430
Validation loss decreased (0.039320 --> 0.038507).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1076406
	speed: 0.0595s/iter; left time: 469.0157s
	iters: 200, epoch: 7 | loss: 0.1230809
	speed: 0.0215s/iter; left time: 166.9157s
	iters: 300, epoch: 7 | loss: 0.1243722
	speed: 0.0215s/iter; left time: 165.1244s
	iters: 400, epoch: 7 | loss: 0.1548696
	speed: 0.0215s/iter; left time: 163.0679s
	iters: 500, epoch: 7 | loss: 0.2566475
	speed: 0.0215s/iter; left time: 161.0002s
Epoch: 7 cost time: 12.382429599761963
Epoch: 7, Steps: 570 | Train Loss: 0.1445968 Vali Loss: 0.0385820 Test Loss: 0.1284373
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1278794
	speed: 0.0564s/iter; left time: 412.1239s
	iters: 200, epoch: 8 | loss: 0.1256059
	speed: 0.0186s/iter; left time: 134.1691s
	iters: 300, epoch: 8 | loss: 0.1016735
	speed: 0.0186s/iter; left time: 132.3370s
	iters: 400, epoch: 8 | loss: 0.1710809
	speed: 0.0186s/iter; left time: 130.5298s
	iters: 500, epoch: 8 | loss: 0.1221571
	speed: 0.0186s/iter; left time: 128.4342s
Epoch: 8 cost time: 10.912103414535522
Epoch: 8, Steps: 570 | Train Loss: 0.1430321 Vali Loss: 0.0382561 Test Loss: 0.1283470
Validation loss decreased (0.038507 --> 0.038256).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0890513
	speed: 0.0581s/iter; left time: 391.5040s
	iters: 200, epoch: 9 | loss: 0.1911742
	speed: 0.0185s/iter; left time: 122.9946s
	iters: 300, epoch: 9 | loss: 0.0837665
	speed: 0.0185s/iter; left time: 120.9705s
	iters: 400, epoch: 9 | loss: 0.1713939
	speed: 0.0186s/iter; left time: 119.8214s
	iters: 500, epoch: 9 | loss: 0.0705790
	speed: 0.0187s/iter; left time: 118.2802s
Epoch: 9 cost time: 10.893603086471558
Epoch: 9, Steps: 570 | Train Loss: 0.1432252 Vali Loss: 0.0386749 Test Loss: 0.1292707
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1382120
	speed: 0.0552s/iter; left time: 340.7872s
	iters: 200, epoch: 10 | loss: 0.1594550
	speed: 0.0185s/iter; left time: 112.1467s
	iters: 300, epoch: 10 | loss: 0.1034489
	speed: 0.0185s/iter; left time: 110.3623s
	iters: 400, epoch: 10 | loss: 0.1186969
	speed: 0.0185s/iter; left time: 108.5262s
	iters: 500, epoch: 10 | loss: 0.1209665
	speed: 0.0185s/iter; left time: 106.6083s
Epoch: 10 cost time: 10.783344745635986
Epoch: 10, Steps: 570 | Train Loss: 0.1419138 Vali Loss: 0.0382800 Test Loss: 0.1293405
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1135975
	speed: 0.0572s/iter; left time: 320.3019s
	iters: 200, epoch: 11 | loss: 0.2162677
	speed: 0.0192s/iter; left time: 105.5213s
	iters: 300, epoch: 11 | loss: 0.1270639
	speed: 0.0185s/iter; left time: 99.9173s
	iters: 400, epoch: 11 | loss: 0.0953551
	speed: 0.0185s/iter; left time: 98.0947s
	iters: 500, epoch: 11 | loss: 0.2087691
	speed: 0.0185s/iter; left time: 96.2459s
Epoch: 11 cost time: 11.12228012084961
Epoch: 11, Steps: 570 | Train Loss: 0.1425096 Vali Loss: 0.0383815 Test Loss: 0.1293128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12851981818675995, mae:0.22300393879413605
>>> MS_Raw LR=5e-4 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4062195
	speed: 0.0324s/iter; left time: 365.8314s
	iters: 200, epoch: 1 | loss: 0.2367173
	speed: 0.0206s/iter; left time: 230.4626s
	iters: 300, epoch: 1 | loss: 0.1880140
	speed: 0.0206s/iter; left time: 228.2173s
	iters: 400, epoch: 1 | loss: 0.1825474
	speed: 0.0206s/iter; left time: 226.9769s
	iters: 500, epoch: 1 | loss: 0.2249993
	speed: 0.0206s/iter; left time: 224.3118s
Epoch: 1 cost time: 12.959134340286255
Epoch: 1, Steps: 570 | Train Loss: 0.2210236 Vali Loss: 0.0382343 Test Loss: 0.1270257
Validation loss decreased (inf --> 0.038234).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1443575
	speed: 0.0598s/iter; left time: 641.3054s
	iters: 200, epoch: 2 | loss: 0.2346351
	speed: 0.0201s/iter; left time: 213.4366s
	iters: 300, epoch: 2 | loss: 0.3214695
	speed: 0.0184s/iter; left time: 194.1184s
	iters: 400, epoch: 2 | loss: 0.1769039
	speed: 0.0184s/iter; left time: 192.1548s
	iters: 500, epoch: 2 | loss: 0.1559059
	speed: 0.0184s/iter; left time: 190.3324s
Epoch: 2 cost time: 11.182176351547241
Epoch: 2, Steps: 570 | Train Loss: 0.1931597 Vali Loss: 0.0417072 Test Loss: 0.1257905
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1181805
	speed: 0.0556s/iter; left time: 565.3531s
	iters: 200, epoch: 3 | loss: 0.1790282
	speed: 0.0184s/iter; left time: 184.7928s
	iters: 300, epoch: 3 | loss: 0.1843037
	speed: 0.0184s/iter; left time: 182.8263s
	iters: 400, epoch: 3 | loss: 0.1559345
	speed: 0.0184s/iter; left time: 181.1014s
	iters: 500, epoch: 3 | loss: 0.1333293
	speed: 0.0184s/iter; left time: 179.2726s
Epoch: 3 cost time: 10.760296106338501
Epoch: 3, Steps: 570 | Train Loss: 0.1680607 Vali Loss: 0.0361680 Test Loss: 0.1142172
Validation loss decreased (0.038234 --> 0.036168).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1780870
	speed: 0.0576s/iter; left time: 552.3281s
	iters: 200, epoch: 4 | loss: 0.1038720
	speed: 0.0210s/iter; left time: 199.3706s
	iters: 300, epoch: 4 | loss: 0.2237743
	speed: 0.0211s/iter; left time: 197.7095s
	iters: 400, epoch: 4 | loss: 0.1229403
	speed: 0.0210s/iter; left time: 195.3334s
	iters: 500, epoch: 4 | loss: 0.1177608
	speed: 0.0210s/iter; left time: 193.4041s
Epoch: 4 cost time: 12.059272289276123
Epoch: 4, Steps: 570 | Train Loss: 0.1538203 Vali Loss: 0.0342794 Test Loss: 0.1126993
Validation loss decreased (0.036168 --> 0.034279).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1363425
	speed: 0.0590s/iter; left time: 531.9131s
	iters: 200, epoch: 5 | loss: 0.1396369
	speed: 0.0211s/iter; left time: 188.6271s
	iters: 300, epoch: 5 | loss: 0.1429909
	speed: 0.0211s/iter; left time: 186.3941s
	iters: 400, epoch: 5 | loss: 0.1354701
	speed: 0.0212s/iter; left time: 184.4756s
	iters: 500, epoch: 5 | loss: 0.1390233
	speed: 0.0212s/iter; left time: 182.3844s
Epoch: 5 cost time: 12.366208553314209
Epoch: 5, Steps: 570 | Train Loss: 0.1457334 Vali Loss: 0.0337416 Test Loss: 0.1117296
Validation loss decreased (0.034279 --> 0.033742).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2053926
	speed: 0.0605s/iter; left time: 511.5311s
	iters: 200, epoch: 6 | loss: 0.1320635
	speed: 0.0211s/iter; left time: 176.5521s
	iters: 300, epoch: 6 | loss: 0.1648138
	speed: 0.0209s/iter; left time: 172.1883s
	iters: 400, epoch: 6 | loss: 0.1140018
	speed: 0.0182s/iter; left time: 148.5984s
	iters: 500, epoch: 6 | loss: 0.0900856
	speed: 0.0182s/iter; left time: 146.3973s
Epoch: 6 cost time: 11.51750922203064
Epoch: 6, Steps: 570 | Train Loss: 0.1408665 Vali Loss: 0.0336674 Test Loss: 0.1124479
Validation loss decreased (0.033742 --> 0.033667).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1324584
	speed: 0.0589s/iter; left time: 463.8457s
	iters: 200, epoch: 7 | loss: 0.1815987
	speed: 0.0213s/iter; left time: 165.8898s
	iters: 300, epoch: 7 | loss: 0.1007532
	speed: 0.0213s/iter; left time: 163.6453s
	iters: 400, epoch: 7 | loss: 0.1524494
	speed: 0.0213s/iter; left time: 161.2712s
	iters: 500, epoch: 7 | loss: 0.1171991
	speed: 0.0213s/iter; left time: 159.3042s
Epoch: 7 cost time: 12.458998680114746
Epoch: 7, Steps: 570 | Train Loss: 0.1371023 Vali Loss: 0.0332240 Test Loss: 0.1123765
Validation loss decreased (0.033667 --> 0.033224).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1047971
	speed: 0.0641s/iter; left time: 468.4370s
	iters: 200, epoch: 8 | loss: 0.1174079
	speed: 0.0212s/iter; left time: 153.0884s
	iters: 300, epoch: 8 | loss: 0.1243928
	speed: 0.0213s/iter; left time: 151.2879s
	iters: 400, epoch: 8 | loss: 0.1190089
	speed: 0.0212s/iter; left time: 148.8960s
	iters: 500, epoch: 8 | loss: 0.1612852
	speed: 0.0213s/iter; left time: 146.8689s
Epoch: 8 cost time: 12.44318699836731
Epoch: 8, Steps: 570 | Train Loss: 0.1349000 Vali Loss: 0.0330598 Test Loss: 0.1125979
Validation loss decreased (0.033224 --> 0.033060).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0788062
	speed: 0.0606s/iter; left time: 408.6666s
	iters: 200, epoch: 9 | loss: 0.1062236
	speed: 0.0211s/iter; left time: 140.4204s
	iters: 300, epoch: 9 | loss: 0.1499604
	speed: 0.0211s/iter; left time: 138.2687s
	iters: 400, epoch: 9 | loss: 0.1308397
	speed: 0.0211s/iter; left time: 136.1675s
	iters: 500, epoch: 9 | loss: 0.1163688
	speed: 0.0211s/iter; left time: 134.0486s
Epoch: 9 cost time: 12.347087144851685
Epoch: 9, Steps: 570 | Train Loss: 0.1347633 Vali Loss: 0.0328941 Test Loss: 0.1120978
Validation loss decreased (0.033060 --> 0.032894).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1081880
	speed: 0.0590s/iter; left time: 364.0989s
	iters: 200, epoch: 10 | loss: 0.0949696
	speed: 0.0184s/iter; left time: 111.4278s
	iters: 300, epoch: 10 | loss: 0.1786988
	speed: 0.0183s/iter; left time: 109.5401s
	iters: 400, epoch: 10 | loss: 0.1464879
	speed: 0.0183s/iter; left time: 107.6935s
	iters: 500, epoch: 10 | loss: 0.1142340
	speed: 0.0183s/iter; left time: 105.8163s
Epoch: 10 cost time: 10.876500844955444
Epoch: 10, Steps: 570 | Train Loss: 0.1351930 Vali Loss: 0.0327680 Test Loss: 0.1121678
Validation loss decreased (0.032894 --> 0.032768).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1656882
	speed: 0.0590s/iter; left time: 330.2631s
	iters: 200, epoch: 11 | loss: 0.1380123
	speed: 0.0212s/iter; left time: 116.3591s
	iters: 300, epoch: 11 | loss: 0.0956098
	speed: 0.0212s/iter; left time: 114.2866s
	iters: 400, epoch: 11 | loss: 0.1846106
	speed: 0.0212s/iter; left time: 112.1401s
	iters: 500, epoch: 11 | loss: 0.1490075
	speed: 0.0212s/iter; left time: 110.0421s
Epoch: 11 cost time: 12.3831045627594
Epoch: 11, Steps: 570 | Train Loss: 0.1345975 Vali Loss: 0.0328031 Test Loss: 0.1123543
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1867373
	speed: 0.0632s/iter; left time: 317.8983s
	iters: 200, epoch: 12 | loss: 0.1077482
	speed: 0.0211s/iter; left time: 104.0947s
	iters: 300, epoch: 12 | loss: 0.0930673
	speed: 0.0211s/iter; left time: 101.8863s
	iters: 400, epoch: 12 | loss: 0.1318797
	speed: 0.0212s/iter; left time: 100.1052s
	iters: 500, epoch: 12 | loss: 0.1422749
	speed: 0.0211s/iter; left time: 97.8799s
Epoch: 12 cost time: 12.341312885284424
Epoch: 12, Steps: 570 | Train Loss: 0.1345187 Vali Loss: 0.0327841 Test Loss: 0.1122793
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1140422
	speed: 0.0606s/iter; left time: 270.2864s
	iters: 200, epoch: 13 | loss: 0.1710508
	speed: 0.0213s/iter; left time: 92.8674s
	iters: 300, epoch: 13 | loss: 0.1083229
	speed: 0.0213s/iter; left time: 90.8991s
	iters: 400, epoch: 13 | loss: 0.1506232
	speed: 0.0213s/iter; left time: 88.5855s
	iters: 500, epoch: 13 | loss: 0.2035553
	speed: 0.0213s/iter; left time: 86.4246s
Epoch: 13 cost time: 12.456392765045166
Epoch: 13, Steps: 570 | Train Loss: 0.1355682 Vali Loss: 0.0328358 Test Loss: 0.1122939
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1123042106628418, mae:0.20286034047603607
>>> MS_Raw LR=5e-4 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2797449
	speed: 0.0328s/iter; left time: 370.3248s
	iters: 200, epoch: 1 | loss: 0.1862150
	speed: 0.0206s/iter; left time: 231.2306s
	iters: 300, epoch: 1 | loss: 0.3039144
	speed: 0.0206s/iter; left time: 228.9725s
	iters: 400, epoch: 1 | loss: 0.2908368
	speed: 0.0193s/iter; left time: 212.3743s
	iters: 500, epoch: 1 | loss: 0.3222593
	speed: 0.0183s/iter; left time: 199.5409s
Epoch: 1 cost time: 12.49592399597168
Epoch: 1, Steps: 570 | Train Loss: 0.2490867 Vali Loss: 0.0448612 Test Loss: 0.1411850
Validation loss decreased (inf --> 0.044861).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3115781
	speed: 0.0581s/iter; left time: 622.9726s
	iters: 200, epoch: 2 | loss: 0.3009275
	speed: 0.0184s/iter; left time: 195.6196s
	iters: 300, epoch: 2 | loss: 0.4145051
	speed: 0.0184s/iter; left time: 193.7068s
	iters: 400, epoch: 2 | loss: 0.1729305
	speed: 0.0184s/iter; left time: 191.9266s
	iters: 500, epoch: 2 | loss: 0.1927388
	speed: 0.0184s/iter; left time: 189.8884s
Epoch: 2 cost time: 10.860132217407227
Epoch: 2, Steps: 570 | Train Loss: 0.2132458 Vali Loss: 0.0427954 Test Loss: 0.1374245
Validation loss decreased (0.044861 --> 0.042795).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1280790
	speed: 0.0555s/iter; left time: 564.1777s
	iters: 200, epoch: 3 | loss: 0.2055959
	speed: 0.0182s/iter; left time: 183.3577s
	iters: 300, epoch: 3 | loss: 0.2088492
	speed: 0.0182s/iter; left time: 181.2554s
	iters: 400, epoch: 3 | loss: 0.2187045
	speed: 0.0182s/iter; left time: 179.6177s
	iters: 500, epoch: 3 | loss: 0.1717113
	speed: 0.0182s/iter; left time: 177.7804s
Epoch: 3 cost time: 10.682307481765747
Epoch: 3, Steps: 570 | Train Loss: 0.1804804 Vali Loss: 0.0406638 Test Loss: 0.1281530
Validation loss decreased (0.042795 --> 0.040664).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1274240
	speed: 0.0559s/iter; left time: 536.5211s
	iters: 200, epoch: 4 | loss: 0.1697613
	speed: 0.0185s/iter; left time: 175.2095s
	iters: 300, epoch: 4 | loss: 0.1532433
	speed: 0.0184s/iter; left time: 172.9889s
	iters: 400, epoch: 4 | loss: 0.1963158
	speed: 0.0184s/iter; left time: 171.2522s
	iters: 500, epoch: 4 | loss: 0.1010367
	speed: 0.0184s/iter; left time: 169.1717s
Epoch: 4 cost time: 10.826906442642212
Epoch: 4, Steps: 570 | Train Loss: 0.1598551 Vali Loss: 0.0383151 Test Loss: 0.1256488
Validation loss decreased (0.040664 --> 0.038315).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1172608
	speed: 0.0569s/iter; left time: 513.1156s
	iters: 200, epoch: 5 | loss: 0.1494514
	speed: 0.0183s/iter; left time: 162.8998s
	iters: 300, epoch: 5 | loss: 0.1080816
	speed: 0.0183s/iter; left time: 161.0903s
	iters: 400, epoch: 5 | loss: 0.1401497
	speed: 0.0182s/iter; left time: 159.1514s
	iters: 500, epoch: 5 | loss: 0.0738565
	speed: 0.0183s/iter; left time: 157.4378s
Epoch: 5 cost time: 10.705665111541748
Epoch: 5, Steps: 570 | Train Loss: 0.1475491 Vali Loss: 0.0380924 Test Loss: 0.1269571
Validation loss decreased (0.038315 --> 0.038092).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1919727
	speed: 0.0551s/iter; left time: 465.6702s
	iters: 200, epoch: 6 | loss: 0.0946734
	speed: 0.0184s/iter; left time: 153.7854s
	iters: 300, epoch: 6 | loss: 0.2285027
	speed: 0.0185s/iter; left time: 152.8146s
	iters: 400, epoch: 6 | loss: 0.1166387
	speed: 0.0185s/iter; left time: 150.7138s
	iters: 500, epoch: 6 | loss: 0.1483490
	speed: 0.0185s/iter; left time: 149.1440s
Epoch: 6 cost time: 10.830536127090454
Epoch: 6, Steps: 570 | Train Loss: 0.1427690 Vali Loss: 0.0374106 Test Loss: 0.1276500
Validation loss decreased (0.038092 --> 0.037411).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1298775
	speed: 0.0564s/iter; left time: 444.6699s
	iters: 200, epoch: 7 | loss: 0.1101149
	speed: 0.0183s/iter; left time: 142.4986s
	iters: 300, epoch: 7 | loss: 0.1458274
	speed: 0.0193s/iter; left time: 148.3119s
	iters: 400, epoch: 7 | loss: 0.1348525
	speed: 0.0213s/iter; left time: 161.1939s
	iters: 500, epoch: 7 | loss: 0.1037479
	speed: 0.0213s/iter; left time: 159.1007s
Epoch: 7 cost time: 11.647900819778442
Epoch: 7, Steps: 570 | Train Loss: 0.1406734 Vali Loss: 0.0375035 Test Loss: 0.1276350
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1153444
	speed: 0.0602s/iter; left time: 440.3868s
	iters: 200, epoch: 8 | loss: 0.0958842
	speed: 0.0210s/iter; left time: 151.7319s
	iters: 300, epoch: 8 | loss: 0.1312107
	speed: 0.0211s/iter; left time: 149.7379s
	iters: 400, epoch: 8 | loss: 0.1608980
	speed: 0.0211s/iter; left time: 148.1104s
	iters: 500, epoch: 8 | loss: 0.1197002
	speed: 0.0211s/iter; left time: 146.0764s
Epoch: 8 cost time: 12.267745733261108
Epoch: 8, Steps: 570 | Train Loss: 0.1382457 Vali Loss: 0.0379177 Test Loss: 0.1280280
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1367284
	speed: 0.0599s/iter; left time: 403.8155s
	iters: 200, epoch: 9 | loss: 0.1761189
	speed: 0.0183s/iter; left time: 121.7207s
	iters: 300, epoch: 9 | loss: 0.1626104
	speed: 0.0183s/iter; left time: 119.7586s
	iters: 400, epoch: 9 | loss: 0.2542892
	speed: 0.0183s/iter; left time: 118.0341s
	iters: 500, epoch: 9 | loss: 0.1088795
	speed: 0.0183s/iter; left time: 116.1791s
Epoch: 9 cost time: 10.924011707305908
Epoch: 9, Steps: 570 | Train Loss: 0.1378798 Vali Loss: 0.0379509 Test Loss: 0.1280553
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12781256437301636, mae:0.22418509423732758
>>> MS_Raw LR=5e-4 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2265389
	speed: 0.0339s/iter; left time: 383.5745s
	iters: 200, epoch: 1 | loss: 0.2037170
	speed: 0.0221s/iter; left time: 247.1429s
	iters: 300, epoch: 1 | loss: 0.2611356
	speed: 0.0221s/iter; left time: 245.1821s
	iters: 400, epoch: 1 | loss: 0.3736100
	speed: 0.0221s/iter; left time: 242.6700s
	iters: 500, epoch: 1 | loss: 0.3269736
	speed: 0.0220s/iter; left time: 240.2827s
Epoch: 1 cost time: 13.820697546005249
Epoch: 1, Steps: 570 | Train Loss: 0.2639419 Vali Loss: 0.0465951 Test Loss: 0.1468236
Validation loss decreased (inf --> 0.046595).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3247042
	speed: 0.0644s/iter; left time: 690.9265s
	iters: 200, epoch: 2 | loss: 0.2474189
	speed: 0.0221s/iter; left time: 234.9149s
	iters: 300, epoch: 2 | loss: 0.2419414
	speed: 0.0220s/iter; left time: 232.1955s
	iters: 400, epoch: 2 | loss: 0.3111796
	speed: 0.0221s/iter; left time: 230.3633s
	iters: 500, epoch: 2 | loss: 0.2558926
	speed: 0.0221s/iter; left time: 228.1441s
Epoch: 2 cost time: 12.916957139968872
Epoch: 2, Steps: 570 | Train Loss: 0.2886750 Vali Loss: 0.0646475 Test Loss: 0.1807764
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4931170
	speed: 0.0631s/iter; left time: 641.6495s
	iters: 200, epoch: 3 | loss: 0.2203465
	speed: 0.0223s/iter; left time: 224.0007s
	iters: 300, epoch: 3 | loss: 0.3041163
	speed: 0.0223s/iter; left time: 221.6986s
	iters: 400, epoch: 3 | loss: 0.2258451
	speed: 0.0223s/iter; left time: 219.6135s
	iters: 500, epoch: 3 | loss: 0.1609135
	speed: 0.0223s/iter; left time: 217.3376s
Epoch: 3 cost time: 13.000610113143921
Epoch: 3, Steps: 570 | Train Loss: 0.2678624 Vali Loss: 0.0592624 Test Loss: 0.1633920
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1885575
	speed: 0.0635s/iter; left time: 609.3001s
	iters: 200, epoch: 4 | loss: 0.2064136
	speed: 0.0222s/iter; left time: 210.9695s
	iters: 300, epoch: 4 | loss: 0.2522214
	speed: 0.0222s/iter; left time: 208.6435s
	iters: 400, epoch: 4 | loss: 0.2098793
	speed: 0.0222s/iter; left time: 206.4037s
	iters: 500, epoch: 4 | loss: 0.3203610
	speed: 0.0221s/iter; left time: 203.5383s
Epoch: 4 cost time: 12.98905348777771
Epoch: 4, Steps: 570 | Train Loss: 0.2464373 Vali Loss: 0.0537332 Test Loss: 0.1535708
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14701522886753082, mae:0.238888680934906
>>> MS_Raw LR=5e-4 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2473196
	speed: 0.0335s/iter; left time: 378.7591s
	iters: 200, epoch: 1 | loss: 0.1257081
	speed: 0.0215s/iter; left time: 240.4307s
	iters: 300, epoch: 1 | loss: 0.1898378
	speed: 0.0215s/iter; left time: 238.8457s
	iters: 400, epoch: 1 | loss: 0.2509260
	speed: 0.0215s/iter; left time: 236.8456s
	iters: 500, epoch: 1 | loss: 0.2319994
	speed: 0.0215s/iter; left time: 234.1057s
Epoch: 1 cost time: 13.50700831413269
Epoch: 1, Steps: 570 | Train Loss: 0.2497239 Vali Loss: 0.0487074 Test Loss: 0.1458330
Validation loss decreased (inf --> 0.048707).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2340444
	speed: 0.0626s/iter; left time: 671.6103s
	iters: 200, epoch: 2 | loss: 0.1911051
	speed: 0.0214s/iter; left time: 227.9159s
	iters: 300, epoch: 2 | loss: 0.3099531
	speed: 0.0214s/iter; left time: 225.7353s
	iters: 400, epoch: 2 | loss: 0.2114587
	speed: 0.0214s/iter; left time: 223.7376s
	iters: 500, epoch: 2 | loss: 0.2178767
	speed: 0.0214s/iter; left time: 221.5439s
Epoch: 2 cost time: 12.572762489318848
Epoch: 2, Steps: 570 | Train Loss: 0.2483829 Vali Loss: 0.0637570 Test Loss: 0.1865307
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2303837
	speed: 0.0615s/iter; left time: 624.4470s
	iters: 200, epoch: 3 | loss: 0.2040206
	speed: 0.0214s/iter; left time: 214.8056s
	iters: 300, epoch: 3 | loss: 0.2155994
	speed: 0.0213s/iter; left time: 212.4318s
	iters: 400, epoch: 3 | loss: 0.1691144
	speed: 0.0213s/iter; left time: 210.2028s
	iters: 500, epoch: 3 | loss: 0.2280182
	speed: 0.0213s/iter; left time: 208.1452s
Epoch: 3 cost time: 12.438317060470581
Epoch: 3, Steps: 570 | Train Loss: 0.2552357 Vali Loss: 0.0537550 Test Loss: 0.1570746
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1636872
	speed: 0.0637s/iter; left time: 611.4072s
	iters: 200, epoch: 4 | loss: 0.2324255
	speed: 0.0213s/iter; left time: 202.0033s
	iters: 300, epoch: 4 | loss: 0.2311193
	speed: 0.0213s/iter; left time: 199.9722s
	iters: 400, epoch: 4 | loss: 0.2508463
	speed: 0.0213s/iter; left time: 197.6785s
	iters: 500, epoch: 4 | loss: 0.1465907
	speed: 0.0214s/iter; left time: 196.6850s
Epoch: 4 cost time: 12.477612018585205
Epoch: 4, Steps: 570 | Train Loss: 0.2251661 Vali Loss: 0.0478529 Test Loss: 0.1428172
Validation loss decreased (0.048707 --> 0.047853).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3381991
	speed: 0.0627s/iter; left time: 565.5523s
	iters: 200, epoch: 5 | loss: 0.1688681
	speed: 0.0214s/iter; left time: 190.8579s
	iters: 300, epoch: 5 | loss: 0.2440124
	speed: 0.0213s/iter; left time: 187.8565s
	iters: 400, epoch: 5 | loss: 0.2265646
	speed: 0.0213s/iter; left time: 185.9377s
	iters: 500, epoch: 5 | loss: 0.1937955
	speed: 0.0213s/iter; left time: 183.6962s
Epoch: 5 cost time: 12.480116844177246
Epoch: 5, Steps: 570 | Train Loss: 0.2147581 Vali Loss: 0.0463137 Test Loss: 0.1410170
Validation loss decreased (0.047853 --> 0.046314).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1619216
	speed: 0.0620s/iter; left time: 523.8267s
	iters: 200, epoch: 6 | loss: 0.2720591
	speed: 0.0214s/iter; left time: 178.8032s
	iters: 300, epoch: 6 | loss: 0.2588261
	speed: 0.0214s/iter; left time: 176.5791s
	iters: 400, epoch: 6 | loss: 0.1421844
	speed: 0.0214s/iter; left time: 174.5637s
	iters: 500, epoch: 6 | loss: 0.1271585
	speed: 0.0214s/iter; left time: 172.3998s
Epoch: 6 cost time: 12.527610778808594
Epoch: 6, Steps: 570 | Train Loss: 0.2085781 Vali Loss: 0.0456530 Test Loss: 0.1389347
Validation loss decreased (0.046314 --> 0.045653).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1957026
	speed: 0.0632s/iter; left time: 497.9148s
	iters: 200, epoch: 7 | loss: 0.2440834
	speed: 0.0215s/iter; left time: 167.2984s
	iters: 300, epoch: 7 | loss: 0.2426528
	speed: 0.0215s/iter; left time: 165.0625s
	iters: 400, epoch: 7 | loss: 0.1396694
	speed: 0.0215s/iter; left time: 163.0709s
	iters: 500, epoch: 7 | loss: 0.2076509
	speed: 0.0215s/iter; left time: 160.7270s
Epoch: 7 cost time: 12.583860874176025
Epoch: 7, Steps: 570 | Train Loss: 0.2040462 Vali Loss: 0.0450921 Test Loss: 0.1383753
Validation loss decreased (0.045653 --> 0.045092).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1679175
	speed: 0.0657s/iter; left time: 480.6055s
	iters: 200, epoch: 8 | loss: 0.2228707
	speed: 0.0214s/iter; left time: 154.1652s
	iters: 300, epoch: 8 | loss: 0.2266141
	speed: 0.0213s/iter; left time: 151.8064s
	iters: 400, epoch: 8 | loss: 0.1868207
	speed: 0.0213s/iter; left time: 149.6116s
	iters: 500, epoch: 8 | loss: 0.2489204
	speed: 0.0213s/iter; left time: 147.5310s
Epoch: 8 cost time: 12.514102697372437
Epoch: 8, Steps: 570 | Train Loss: 0.2040983 Vali Loss: 0.0444818 Test Loss: 0.1387045
Validation loss decreased (0.045092 --> 0.044482).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1514863
	speed: 0.0626s/iter; left time: 421.7886s
	iters: 200, epoch: 9 | loss: 0.3282959
	speed: 0.0214s/iter; left time: 141.9216s
	iters: 300, epoch: 9 | loss: 0.2165562
	speed: 0.0214s/iter; left time: 139.7227s
	iters: 400, epoch: 9 | loss: 0.1657842
	speed: 0.0214s/iter; left time: 137.8982s
	iters: 500, epoch: 9 | loss: 0.1373940
	speed: 0.0214s/iter; left time: 135.5677s
Epoch: 9 cost time: 12.510788917541504
Epoch: 9, Steps: 570 | Train Loss: 0.2025875 Vali Loss: 0.0441560 Test Loss: 0.1378595
Validation loss decreased (0.044482 --> 0.044156).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1225090
	speed: 0.0626s/iter; left time: 386.2836s
	iters: 200, epoch: 10 | loss: 0.2219221
	speed: 0.0213s/iter; left time: 129.4408s
	iters: 300, epoch: 10 | loss: 0.1584260
	speed: 0.0213s/iter; left time: 127.4657s
	iters: 400, epoch: 10 | loss: 0.1926998
	speed: 0.0213s/iter; left time: 125.0766s
	iters: 500, epoch: 10 | loss: 0.2200271
	speed: 0.0213s/iter; left time: 123.0273s
Epoch: 10 cost time: 12.469228744506836
Epoch: 10, Steps: 570 | Train Loss: 0.2016098 Vali Loss: 0.0441128 Test Loss: 0.1378013
Validation loss decreased (0.044156 --> 0.044113).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.3134599
	speed: 0.0624s/iter; left time: 349.6525s
	iters: 200, epoch: 11 | loss: 0.2411440
	speed: 0.0214s/iter; left time: 117.6292s
	iters: 300, epoch: 11 | loss: 0.1653250
	speed: 0.0214s/iter; left time: 115.4189s
	iters: 400, epoch: 11 | loss: 0.1539716
	speed: 0.0214s/iter; left time: 113.3405s
	iters: 500, epoch: 11 | loss: 0.2373441
	speed: 0.0214s/iter; left time: 111.0935s
Epoch: 11 cost time: 12.507747173309326
Epoch: 11, Steps: 570 | Train Loss: 0.2021595 Vali Loss: 0.0440318 Test Loss: 0.1377459
Validation loss decreased (0.044113 --> 0.044032).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.2353914
	speed: 0.0620s/iter; left time: 311.7491s
	iters: 200, epoch: 12 | loss: 0.3114094
	speed: 0.0215s/iter; left time: 105.8038s
	iters: 300, epoch: 12 | loss: 0.1593771
	speed: 0.0214s/iter; left time: 103.5497s
	iters: 400, epoch: 12 | loss: 0.3602030
	speed: 0.0214s/iter; left time: 101.4795s
	iters: 500, epoch: 12 | loss: 0.1722682
	speed: 0.0215s/iter; left time: 99.3445s
Epoch: 12 cost time: 12.541833639144897
Epoch: 12, Steps: 570 | Train Loss: 0.2014231 Vali Loss: 0.0440433 Test Loss: 0.1377519
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1846561
	speed: 0.0606s/iter; left time: 270.3787s
	iters: 200, epoch: 13 | loss: 0.2406921
	speed: 0.0213s/iter; left time: 93.0295s
	iters: 300, epoch: 13 | loss: 0.2706851
	speed: 0.0213s/iter; left time: 90.8977s
	iters: 400, epoch: 13 | loss: 0.1599784
	speed: 0.0213s/iter; left time: 88.7390s
	iters: 500, epoch: 13 | loss: 0.2028231
	speed: 0.0213s/iter; left time: 86.6432s
Epoch: 13 cost time: 12.451791763305664
Epoch: 13, Steps: 570 | Train Loss: 0.2015567 Vali Loss: 0.0441264 Test Loss: 0.1377645
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1936617
	speed: 0.0616s/iter; left time: 239.4967s
	iters: 200, epoch: 14 | loss: 0.2265234
	speed: 0.0214s/iter; left time: 81.0357s
	iters: 300, epoch: 14 | loss: 0.2004135
	speed: 0.0214s/iter; left time: 78.8832s
	iters: 400, epoch: 14 | loss: 0.1715649
	speed: 0.0214s/iter; left time: 76.8222s
	iters: 500, epoch: 14 | loss: 0.2285334
	speed: 0.0214s/iter; left time: 74.5704s
Epoch: 14 cost time: 12.494691610336304
Epoch: 14, Steps: 570 | Train Loss: 0.2025883 Vali Loss: 0.0440201 Test Loss: 0.1377260
Validation loss decreased (0.044032 --> 0.044020).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1840862
	speed: 0.0626s/iter; left time: 207.7857s
	iters: 200, epoch: 15 | loss: 0.1368307
	speed: 0.0213s/iter; left time: 68.5588s
	iters: 300, epoch: 15 | loss: 0.1548997
	speed: 0.0213s/iter; left time: 66.4628s
	iters: 400, epoch: 15 | loss: 0.1958587
	speed: 0.0213s/iter; left time: 64.3600s
	iters: 500, epoch: 15 | loss: 0.1892700
	speed: 0.0213s/iter; left time: 62.2644s
Epoch: 15 cost time: 12.450138092041016
Epoch: 15, Steps: 570 | Train Loss: 0.2019070 Vali Loss: 0.0439447 Test Loss: 0.1377172
Validation loss decreased (0.044020 --> 0.043945).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1813580
	speed: 0.0626s/iter; left time: 172.2488s
	iters: 200, epoch: 16 | loss: 0.1363460
	speed: 0.0214s/iter; left time: 56.8381s
	iters: 300, epoch: 16 | loss: 0.2831162
	speed: 0.0214s/iter; left time: 54.6696s
	iters: 400, epoch: 16 | loss: 0.2373928
	speed: 0.0214s/iter; left time: 52.5385s
	iters: 500, epoch: 16 | loss: 0.2242551
	speed: 0.0214s/iter; left time: 50.4192s
Epoch: 16 cost time: 12.564082145690918
Epoch: 16, Steps: 570 | Train Loss: 0.2016798 Vali Loss: 0.0439457 Test Loss: 0.1377160
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.2514225
	speed: 0.0615s/iter; left time: 134.1015s
	iters: 200, epoch: 17 | loss: 0.3110075
	speed: 0.0214s/iter; left time: 44.4538s
	iters: 300, epoch: 17 | loss: 0.2045411
	speed: 0.0214s/iter; left time: 42.3289s
	iters: 400, epoch: 17 | loss: 0.2309391
	speed: 0.0214s/iter; left time: 40.1740s
	iters: 500, epoch: 17 | loss: 0.1832193
	speed: 0.0214s/iter; left time: 38.0556s
Epoch: 17 cost time: 12.47177529335022
Epoch: 17, Steps: 570 | Train Loss: 0.2015760 Vali Loss: 0.0441191 Test Loss: 0.1377131
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1943845
	speed: 0.0633s/iter; left time: 101.9249s
	iters: 200, epoch: 18 | loss: 0.3082238
	speed: 0.0233s/iter; left time: 35.1925s
	iters: 300, epoch: 18 | loss: 0.2240575
	speed: 0.0226s/iter; left time: 31.9046s
	iters: 400, epoch: 18 | loss: 0.2067386
	speed: 0.0214s/iter; left time: 28.1003s
	iters: 500, epoch: 18 | loss: 0.2080798
	speed: 0.0214s/iter; left time: 25.9677s
Epoch: 18 cost time: 12.971764326095581
Epoch: 18, Steps: 570 | Train Loss: 0.2016109 Vali Loss: 0.0440172 Test Loss: 0.1377118
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13791650533676147, mae:0.23043178021907806
>>> MS_Raw LR=5e-4 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3004980
	speed: 0.0341s/iter; left time: 385.8505s
	iters: 200, epoch: 1 | loss: 0.1989134
	speed: 0.0224s/iter; left time: 250.3778s
	iters: 300, epoch: 1 | loss: 0.3044634
	speed: 0.0224s/iter; left time: 248.5991s
	iters: 400, epoch: 1 | loss: 0.2734650
	speed: 0.0223s/iter; left time: 245.6240s
	iters: 500, epoch: 1 | loss: 0.2556673
	speed: 0.0223s/iter; left time: 243.6036s
Epoch: 1 cost time: 13.972961902618408
Epoch: 1, Steps: 570 | Train Loss: 0.2702008 Vali Loss: 0.0588236 Test Loss: 0.1728681
Validation loss decreased (inf --> 0.058824).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1507782
	speed: 0.0621s/iter; left time: 666.4943s
	iters: 200, epoch: 2 | loss: 0.4606629
	speed: 0.0203s/iter; left time: 215.4438s
	iters: 300, epoch: 2 | loss: 0.3003632
	speed: 0.0203s/iter; left time: 213.4786s
	iters: 400, epoch: 2 | loss: 0.2307945
	speed: 0.0203s/iter; left time: 211.5716s
	iters: 500, epoch: 2 | loss: 0.1799846
	speed: 0.0203s/iter; left time: 209.2132s
Epoch: 2 cost time: 11.867460489273071
Epoch: 2, Steps: 570 | Train Loss: 0.2892339 Vali Loss: 0.0639202 Test Loss: 0.1825890
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2069496
	speed: 0.0595s/iter; left time: 604.4383s
	iters: 200, epoch: 3 | loss: 0.2117680
	speed: 0.0201s/iter; left time: 202.5686s
	iters: 300, epoch: 3 | loss: 0.2944541
	speed: 0.0201s/iter; left time: 200.0962s
	iters: 400, epoch: 3 | loss: 0.2844866
	speed: 0.0201s/iter; left time: 198.2769s
	iters: 500, epoch: 3 | loss: 0.2531351
	speed: 0.0201s/iter; left time: 196.3141s
Epoch: 3 cost time: 11.727534770965576
Epoch: 3, Steps: 570 | Train Loss: 0.2709073 Vali Loss: 0.0599584 Test Loss: 0.1668101
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1952371
	speed: 0.0600s/iter; left time: 575.2651s
	iters: 200, epoch: 4 | loss: 0.3761272
	speed: 0.0201s/iter; left time: 190.5262s
	iters: 300, epoch: 4 | loss: 0.1631347
	speed: 0.0200s/iter; left time: 187.9871s
	iters: 400, epoch: 4 | loss: 0.2734665
	speed: 0.0200s/iter; left time: 185.4817s
	iters: 500, epoch: 4 | loss: 0.1820910
	speed: 0.0200s/iter; left time: 183.7755s
Epoch: 4 cost time: 11.716382026672363
Epoch: 4, Steps: 570 | Train Loss: 0.2504997 Vali Loss: 0.0569234 Test Loss: 0.1600959
Validation loss decreased (0.058824 --> 0.056923).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2042698
	speed: 0.0598s/iter; left time: 539.2184s
	iters: 200, epoch: 5 | loss: 0.3836574
	speed: 0.0202s/iter; left time: 180.4049s
	iters: 300, epoch: 5 | loss: 0.2233628
	speed: 0.0202s/iter; left time: 178.1518s
	iters: 400, epoch: 5 | loss: 0.2100992
	speed: 0.0202s/iter; left time: 175.8972s
	iters: 500, epoch: 5 | loss: 0.2138872
	speed: 0.0202s/iter; left time: 174.0436s
Epoch: 5 cost time: 11.797846794128418
Epoch: 5, Steps: 570 | Train Loss: 0.2398774 Vali Loss: 0.0535849 Test Loss: 0.1552137
Validation loss decreased (0.056923 --> 0.053585).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2638490
	speed: 0.0620s/iter; left time: 523.8110s
	iters: 200, epoch: 6 | loss: 0.2066480
	speed: 0.0201s/iter; left time: 168.2025s
	iters: 300, epoch: 6 | loss: 0.2113417
	speed: 0.0201s/iter; left time: 165.9775s
	iters: 400, epoch: 6 | loss: 0.1573086
	speed: 0.0201s/iter; left time: 163.8152s
	iters: 500, epoch: 6 | loss: 0.3463879
	speed: 0.0201s/iter; left time: 162.0450s
Epoch: 6 cost time: 11.770113468170166
Epoch: 6, Steps: 570 | Train Loss: 0.2346667 Vali Loss: 0.0539009 Test Loss: 0.1536500
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2611862
	speed: 0.0586s/iter; left time: 461.7765s
	iters: 200, epoch: 7 | loss: 0.2718537
	speed: 0.0201s/iter; left time: 156.6388s
	iters: 300, epoch: 7 | loss: 0.2823459
	speed: 0.0201s/iter; left time: 154.6666s
	iters: 400, epoch: 7 | loss: 0.3576207
	speed: 0.0201s/iter; left time: 152.5156s
	iters: 500, epoch: 7 | loss: 0.1743409
	speed: 0.0201s/iter; left time: 150.4115s
Epoch: 7 cost time: 11.72800350189209
Epoch: 7, Steps: 570 | Train Loss: 0.2333656 Vali Loss: 0.0536834 Test Loss: 0.1523338
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2495489
	speed: 0.0583s/iter; left time: 426.4105s
	iters: 200, epoch: 8 | loss: 0.4250316
	speed: 0.0202s/iter; left time: 145.3158s
	iters: 300, epoch: 8 | loss: 0.2799234
	speed: 0.0201s/iter; left time: 142.7020s
	iters: 400, epoch: 8 | loss: 0.1764279
	speed: 0.0201s/iter; left time: 141.1452s
	iters: 500, epoch: 8 | loss: 0.2514960
	speed: 0.0202s/iter; left time: 139.2624s
Epoch: 8 cost time: 11.771520614624023
Epoch: 8, Steps: 570 | Train Loss: 0.2304643 Vali Loss: 0.0535885 Test Loss: 0.1519138
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15540441870689392, mae:0.24983768165111542
>>> MS_Raw LR=1e-4 DO=0.0 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1513899
	speed: 0.0215s/iter; left time: 242.8229s
	iters: 200, epoch: 1 | loss: 0.1708261
	speed: 0.0099s/iter; left time: 110.5381s
	iters: 300, epoch: 1 | loss: 0.2072538
	speed: 0.0099s/iter; left time: 109.8040s
	iters: 400, epoch: 1 | loss: 0.1874213
	speed: 0.0099s/iter; left time: 108.4987s
	iters: 500, epoch: 1 | loss: 0.1462569
	speed: 0.0099s/iter; left time: 107.6256s
Epoch: 1 cost time: 6.842114448547363
Epoch: 1, Steps: 570 | Train Loss: 0.1782682 Vali Loss: 0.0488664 Test Loss: 0.1440767
Validation loss decreased (inf --> 0.048866).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1783890
	speed: 0.0361s/iter; left time: 387.3080s
	iters: 200, epoch: 2 | loss: 0.2236717
	speed: 0.0100s/iter; left time: 105.7802s
	iters: 300, epoch: 2 | loss: 0.1199877
	speed: 0.0099s/iter; left time: 104.7275s
	iters: 400, epoch: 2 | loss: 0.1373761
	speed: 0.0099s/iter; left time: 103.6678s
	iters: 500, epoch: 2 | loss: 0.1278298
	speed: 0.0099s/iter; left time: 102.6456s
Epoch: 2 cost time: 6.036304473876953
Epoch: 2, Steps: 570 | Train Loss: 0.1318140 Vali Loss: 0.0394691 Test Loss: 0.1216232
Validation loss decreased (0.048866 --> 0.039469).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0813655
	speed: 0.0360s/iter; left time: 365.7920s
	iters: 200, epoch: 3 | loss: 0.1225430
	speed: 0.0100s/iter; left time: 100.8635s
	iters: 300, epoch: 3 | loss: 0.0964295
	speed: 0.0100s/iter; left time: 100.0623s
	iters: 400, epoch: 3 | loss: 0.1345346
	speed: 0.0101s/iter; left time: 99.1396s
	iters: 500, epoch: 3 | loss: 0.1609011
	speed: 0.0100s/iter; left time: 97.6307s
Epoch: 3 cost time: 6.022839069366455
Epoch: 3, Steps: 570 | Train Loss: 0.1044723 Vali Loss: 0.0375850 Test Loss: 0.1230151
Validation loss decreased (0.039469 --> 0.037585).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1030105
	speed: 0.0354s/iter; left time: 339.2492s
	iters: 200, epoch: 4 | loss: 0.0546012
	speed: 0.0098s/iter; left time: 93.4062s
	iters: 300, epoch: 4 | loss: 0.0743815
	speed: 0.0098s/iter; left time: 92.4480s
	iters: 400, epoch: 4 | loss: 0.0863305
	speed: 0.0099s/iter; left time: 91.7340s
	iters: 500, epoch: 4 | loss: 0.0859571
	speed: 0.0099s/iter; left time: 90.5857s
Epoch: 4 cost time: 5.899631500244141
Epoch: 4, Steps: 570 | Train Loss: 0.0912220 Vali Loss: 0.0352333 Test Loss: 0.1292616
Validation loss decreased (0.037585 --> 0.035233).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0888323
	speed: 0.0356s/iter; left time: 321.0675s
	iters: 200, epoch: 5 | loss: 0.0870868
	speed: 0.0107s/iter; left time: 95.8417s
	iters: 300, epoch: 5 | loss: 0.0659903
	speed: 0.0112s/iter; left time: 98.8195s
	iters: 400, epoch: 5 | loss: 0.0912737
	speed: 0.0112s/iter; left time: 97.5580s
	iters: 500, epoch: 5 | loss: 0.0844885
	speed: 0.0112s/iter; left time: 96.3520s
Epoch: 5 cost time: 6.505140781402588
Epoch: 5, Steps: 570 | Train Loss: 0.0837980 Vali Loss: 0.0351836 Test Loss: 0.1282767
Validation loss decreased (0.035233 --> 0.035184).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0707374
	speed: 0.0364s/iter; left time: 307.8791s
	iters: 200, epoch: 6 | loss: 0.0545981
	speed: 0.0100s/iter; left time: 83.5494s
	iters: 300, epoch: 6 | loss: 0.0826763
	speed: 0.0100s/iter; left time: 82.4302s
	iters: 400, epoch: 6 | loss: 0.0825454
	speed: 0.0100s/iter; left time: 81.5400s
	iters: 500, epoch: 6 | loss: 0.0937315
	speed: 0.0100s/iter; left time: 80.2393s
Epoch: 6 cost time: 6.002572298049927
Epoch: 6, Steps: 570 | Train Loss: 0.0797587 Vali Loss: 0.0353576 Test Loss: 0.1341149
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0572066
	speed: 0.0365s/iter; left time: 288.0375s
	iters: 200, epoch: 7 | loss: 0.0860813
	speed: 0.0100s/iter; left time: 77.8031s
	iters: 300, epoch: 7 | loss: 0.0820051
	speed: 0.0100s/iter; left time: 76.7707s
	iters: 400, epoch: 7 | loss: 0.0914026
	speed: 0.0099s/iter; left time: 75.3533s
	iters: 500, epoch: 7 | loss: 0.0608955
	speed: 0.0099s/iter; left time: 74.4226s
Epoch: 7 cost time: 5.9521355628967285
Epoch: 7, Steps: 570 | Train Loss: 0.0778621 Vali Loss: 0.0352114 Test Loss: 0.1327515
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0954885
	speed: 0.0348s/iter; left time: 254.3312s
	iters: 200, epoch: 8 | loss: 0.0881027
	speed: 0.0100s/iter; left time: 72.0576s
	iters: 300, epoch: 8 | loss: 0.0847088
	speed: 0.0100s/iter; left time: 71.0044s
	iters: 400, epoch: 8 | loss: 0.1198116
	speed: 0.0100s/iter; left time: 70.0984s
	iters: 500, epoch: 8 | loss: 0.0666076
	speed: 0.0100s/iter; left time: 68.9114s
Epoch: 8 cost time: 5.9641289710998535
Epoch: 8, Steps: 570 | Train Loss: 0.0767807 Vali Loss: 0.0349456 Test Loss: 0.1335279
Validation loss decreased (0.035184 --> 0.034946).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0757837
	speed: 0.0363s/iter; left time: 244.7228s
	iters: 200, epoch: 9 | loss: 0.0716201
	speed: 0.0099s/iter; left time: 65.8806s
	iters: 300, epoch: 9 | loss: 0.0531166
	speed: 0.0099s/iter; left time: 64.9349s
	iters: 400, epoch: 9 | loss: 0.0605998
	speed: 0.0100s/iter; left time: 64.3450s
	iters: 500, epoch: 9 | loss: 0.0825795
	speed: 0.0100s/iter; left time: 63.1326s
Epoch: 9 cost time: 6.067619800567627
Epoch: 9, Steps: 570 | Train Loss: 0.0762669 Vali Loss: 0.0351849 Test Loss: 0.1326815
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0987884
	speed: 0.0349s/iter; left time: 215.1115s
	iters: 200, epoch: 10 | loss: 0.0958489
	speed: 0.0100s/iter; left time: 60.4497s
	iters: 300, epoch: 10 | loss: 0.0612050
	speed: 0.0099s/iter; left time: 59.2918s
	iters: 400, epoch: 10 | loss: 0.0695738
	speed: 0.0099s/iter; left time: 58.3209s
	iters: 500, epoch: 10 | loss: 0.0914397
	speed: 0.0099s/iter; left time: 57.2831s
Epoch: 10 cost time: 5.937500953674316
Epoch: 10, Steps: 570 | Train Loss: 0.0759110 Vali Loss: 0.0349752 Test Loss: 0.1329615
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0891797
	speed: 0.0352s/iter; left time: 197.2075s
	iters: 200, epoch: 11 | loss: 0.0654194
	speed: 0.0100s/iter; left time: 54.8042s
	iters: 300, epoch: 11 | loss: 0.0499686
	speed: 0.0099s/iter; left time: 53.6298s
	iters: 400, epoch: 11 | loss: 0.0801086
	speed: 0.0100s/iter; left time: 52.8410s
	iters: 500, epoch: 11 | loss: 0.0725849
	speed: 0.0100s/iter; left time: 51.9310s
Epoch: 11 cost time: 5.956725120544434
Epoch: 11, Steps: 570 | Train Loss: 0.0758053 Vali Loss: 0.0349229 Test Loss: 0.1328993
Validation loss decreased (0.034946 --> 0.034923).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0766716
	speed: 0.0350s/iter; left time: 176.0430s
	iters: 200, epoch: 12 | loss: 0.1050293
	speed: 0.0099s/iter; left time: 48.8139s
	iters: 300, epoch: 12 | loss: 0.0558165
	speed: 0.0099s/iter; left time: 47.9918s
	iters: 400, epoch: 12 | loss: 0.0781581
	speed: 0.0100s/iter; left time: 47.1773s
	iters: 500, epoch: 12 | loss: 0.1023269
	speed: 0.0100s/iter; left time: 46.1424s
Epoch: 12 cost time: 5.957489967346191
Epoch: 12, Steps: 570 | Train Loss: 0.0757633 Vali Loss: 0.0349610 Test Loss: 0.1328122
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0476927
	speed: 0.0352s/iter; left time: 157.0860s
	iters: 200, epoch: 13 | loss: 0.0836869
	speed: 0.0099s/iter; left time: 43.3659s
	iters: 300, epoch: 13 | loss: 0.0739400
	speed: 0.0099s/iter; left time: 42.3628s
	iters: 400, epoch: 13 | loss: 0.0708614
	speed: 0.0100s/iter; left time: 41.5009s
	iters: 500, epoch: 13 | loss: 0.0761347
	speed: 0.0099s/iter; left time: 40.3670s
Epoch: 13 cost time: 5.950868844985962
Epoch: 13, Steps: 570 | Train Loss: 0.0757305 Vali Loss: 0.0349727 Test Loss: 0.1329227
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0647223
	speed: 0.0358s/iter; left time: 139.2708s
	iters: 200, epoch: 14 | loss: 0.0526018
	speed: 0.0100s/iter; left time: 37.7971s
	iters: 300, epoch: 14 | loss: 0.0859268
	speed: 0.0099s/iter; left time: 36.6139s
	iters: 400, epoch: 14 | loss: 0.0826752
	speed: 0.0099s/iter; left time: 35.7216s
	iters: 500, epoch: 14 | loss: 0.0700437
	speed: 0.0099s/iter; left time: 34.6919s
Epoch: 14 cost time: 5.955758810043335
Epoch: 14, Steps: 570 | Train Loss: 0.0756925 Vali Loss: 0.0349790 Test Loss: 0.1329065
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13309873640537262, mae:0.23310883343219757
>>> MS_Raw LR=1e-4 DO=0.0 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1296794
	speed: 0.0212s/iter; left time: 239.6324s
	iters: 200, epoch: 1 | loss: 0.1537673
	speed: 0.0097s/iter; left time: 109.1325s
	iters: 300, epoch: 1 | loss: 0.1868851
	speed: 0.0098s/iter; left time: 108.3354s
	iters: 400, epoch: 1 | loss: 0.1413876
	speed: 0.0097s/iter; left time: 107.1887s
	iters: 500, epoch: 1 | loss: 0.1430622
	speed: 0.0098s/iter; left time: 106.3151s
Epoch: 1 cost time: 6.754400014877319
Epoch: 1, Steps: 570 | Train Loss: 0.1467088 Vali Loss: 0.0350296 Test Loss: 0.1152290
Validation loss decreased (inf --> 0.035030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1114759
	speed: 0.0360s/iter; left time: 386.3702s
	iters: 200, epoch: 2 | loss: 0.1284230
	speed: 0.0108s/iter; left time: 114.6301s
	iters: 300, epoch: 2 | loss: 0.0688358
	speed: 0.0097s/iter; left time: 102.5404s
	iters: 400, epoch: 2 | loss: 0.1128854
	speed: 0.0097s/iter; left time: 101.6500s
	iters: 500, epoch: 2 | loss: 0.1115896
	speed: 0.0098s/iter; left time: 101.7123s
Epoch: 2 cost time: 6.090850114822388
Epoch: 2, Steps: 570 | Train Loss: 0.1114781 Vali Loss: 0.0329555 Test Loss: 0.1099542
Validation loss decreased (0.035030 --> 0.032956).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0609866
	speed: 0.0354s/iter; left time: 359.2919s
	iters: 200, epoch: 3 | loss: 0.0976384
	speed: 0.0098s/iter; left time: 98.4593s
	iters: 300, epoch: 3 | loss: 0.1724140
	speed: 0.0098s/iter; left time: 97.8275s
	iters: 400, epoch: 3 | loss: 0.0866911
	speed: 0.0098s/iter; left time: 96.6102s
	iters: 500, epoch: 3 | loss: 0.0692270
	speed: 0.0098s/iter; left time: 95.8131s
Epoch: 3 cost time: 5.848011016845703
Epoch: 3, Steps: 570 | Train Loss: 0.0921401 Vali Loss: 0.0308499 Test Loss: 0.1111345
Validation loss decreased (0.032956 --> 0.030850).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0585588
	speed: 0.0343s/iter; left time: 329.1829s
	iters: 200, epoch: 4 | loss: 0.0662341
	speed: 0.0097s/iter; left time: 92.1888s
	iters: 300, epoch: 4 | loss: 0.0571444
	speed: 0.0097s/iter; left time: 91.1438s
	iters: 400, epoch: 4 | loss: 0.0533146
	speed: 0.0097s/iter; left time: 90.3511s
	iters: 500, epoch: 4 | loss: 0.0809954
	speed: 0.0097s/iter; left time: 89.1851s
Epoch: 4 cost time: 5.826592206954956
Epoch: 4, Steps: 570 | Train Loss: 0.0807265 Vali Loss: 0.0310337 Test Loss: 0.1128686
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0621617
	speed: 0.0346s/iter; left time: 312.3880s
	iters: 200, epoch: 5 | loss: 0.1101965
	speed: 0.0098s/iter; left time: 87.4823s
	iters: 300, epoch: 5 | loss: 0.0706058
	speed: 0.0098s/iter; left time: 86.5131s
	iters: 400, epoch: 5 | loss: 0.0821538
	speed: 0.0098s/iter; left time: 85.4436s
	iters: 500, epoch: 5 | loss: 0.0852641
	speed: 0.0098s/iter; left time: 84.8463s
Epoch: 5 cost time: 5.896863698959351
Epoch: 5, Steps: 570 | Train Loss: 0.0744010 Vali Loss: 0.0319490 Test Loss: 0.1164137
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0432204
	speed: 0.0351s/iter; left time: 296.3232s
	iters: 200, epoch: 6 | loss: 0.1052784
	speed: 0.0097s/iter; left time: 81.0383s
	iters: 300, epoch: 6 | loss: 0.1071064
	speed: 0.0097s/iter; left time: 80.0460s
	iters: 400, epoch: 6 | loss: 0.0691435
	speed: 0.0097s/iter; left time: 78.9060s
	iters: 500, epoch: 6 | loss: 0.0560922
	speed: 0.0097s/iter; left time: 78.2959s
Epoch: 6 cost time: 5.863462686538696
Epoch: 6, Steps: 570 | Train Loss: 0.0713012 Vali Loss: 0.0315096 Test Loss: 0.1154929
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11129950731992722, mae:0.20474335551261902
>>> MS_Raw LR=1e-4 DO=0.0 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1780639
	speed: 0.0230s/iter; left time: 259.6484s
	iters: 200, epoch: 1 | loss: 0.1372520
	speed: 0.0112s/iter; left time: 125.3624s
	iters: 300, epoch: 1 | loss: 0.1191107
	speed: 0.0112s/iter; left time: 124.1200s
	iters: 400, epoch: 1 | loss: 0.0929553
	speed: 0.0112s/iter; left time: 123.1544s
	iters: 500, epoch: 1 | loss: 0.1663685
	speed: 0.0112s/iter; left time: 122.1493s
Epoch: 1 cost time: 7.608202695846558
Epoch: 1, Steps: 570 | Train Loss: 0.1820953 Vali Loss: 0.0429141 Test Loss: 0.1349617
Validation loss decreased (inf --> 0.042914).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1548477
	speed: 0.0375s/iter; left time: 402.4651s
	iters: 200, epoch: 2 | loss: 0.2209670
	speed: 0.0112s/iter; left time: 119.2044s
	iters: 300, epoch: 2 | loss: 0.1052781
	speed: 0.0111s/iter; left time: 117.4112s
	iters: 400, epoch: 2 | loss: 0.1976978
	speed: 0.0112s/iter; left time: 116.5865s
	iters: 500, epoch: 2 | loss: 0.1454997
	speed: 0.0111s/iter; left time: 115.1854s
Epoch: 2 cost time: 6.666982650756836
Epoch: 2, Steps: 570 | Train Loss: 0.1344605 Vali Loss: 0.0395189 Test Loss: 0.1307461
Validation loss decreased (0.042914 --> 0.039519).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0897920
	speed: 0.0379s/iter; left time: 384.9668s
	iters: 200, epoch: 3 | loss: 0.0834154
	speed: 0.0112s/iter; left time: 112.7938s
	iters: 300, epoch: 3 | loss: 0.1152317
	speed: 0.0112s/iter; left time: 111.3050s
	iters: 400, epoch: 3 | loss: 0.0778258
	speed: 0.0112s/iter; left time: 110.3598s
	iters: 500, epoch: 3 | loss: 0.0889585
	speed: 0.0111s/iter; left time: 108.7714s
Epoch: 3 cost time: 6.687484979629517
Epoch: 3, Steps: 570 | Train Loss: 0.1071869 Vali Loss: 0.0380230 Test Loss: 0.1316162
Validation loss decreased (0.039519 --> 0.038023).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0710069
	speed: 0.0373s/iter; left time: 357.8075s
	iters: 200, epoch: 4 | loss: 0.0664880
	speed: 0.0111s/iter; left time: 105.6627s
	iters: 300, epoch: 4 | loss: 0.0639720
	speed: 0.0111s/iter; left time: 104.2568s
	iters: 400, epoch: 4 | loss: 0.1217632
	speed: 0.0111s/iter; left time: 103.3584s
	iters: 500, epoch: 4 | loss: 0.0955939
	speed: 0.0108s/iter; left time: 98.9294s
Epoch: 4 cost time: 6.4887659549713135
Epoch: 4, Steps: 570 | Train Loss: 0.0925274 Vali Loss: 0.0394200 Test Loss: 0.1415058
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0904921
	speed: 0.0349s/iter; left time: 314.4397s
	iters: 200, epoch: 5 | loss: 0.0606137
	speed: 0.0098s/iter; left time: 87.3782s
	iters: 300, epoch: 5 | loss: 0.0757486
	speed: 0.0098s/iter; left time: 86.3937s
	iters: 400, epoch: 5 | loss: 0.0715954
	speed: 0.0098s/iter; left time: 85.2653s
	iters: 500, epoch: 5 | loss: 0.0930780
	speed: 0.0098s/iter; left time: 84.4448s
Epoch: 5 cost time: 5.859261989593506
Epoch: 5, Steps: 570 | Train Loss: 0.0848515 Vali Loss: 0.0375565 Test Loss: 0.1370987
Validation loss decreased (0.038023 --> 0.037556).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0669339
	speed: 0.0350s/iter; left time: 295.7698s
	iters: 200, epoch: 6 | loss: 0.0817979
	speed: 0.0097s/iter; left time: 81.4100s
	iters: 300, epoch: 6 | loss: 0.0868388
	speed: 0.0098s/iter; left time: 80.8185s
	iters: 400, epoch: 6 | loss: 0.0847087
	speed: 0.0098s/iter; left time: 79.5415s
	iters: 500, epoch: 6 | loss: 0.0854470
	speed: 0.0098s/iter; left time: 78.8518s
Epoch: 6 cost time: 5.852444887161255
Epoch: 6, Steps: 570 | Train Loss: 0.0807174 Vali Loss: 0.0377012 Test Loss: 0.1391779
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0496188
	speed: 0.0357s/iter; left time: 281.2066s
	iters: 200, epoch: 7 | loss: 0.0840604
	speed: 0.0098s/iter; left time: 76.3024s
	iters: 300, epoch: 7 | loss: 0.0612264
	speed: 0.0098s/iter; left time: 74.9072s
	iters: 400, epoch: 7 | loss: 0.0641417
	speed: 0.0098s/iter; left time: 73.9207s
	iters: 500, epoch: 7 | loss: 0.0803898
	speed: 0.0098s/iter; left time: 73.1496s
Epoch: 7 cost time: 5.893758535385132
Epoch: 7, Steps: 570 | Train Loss: 0.0786098 Vali Loss: 0.0379949 Test Loss: 0.1402828
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0726003
	speed: 0.0357s/iter; left time: 260.7131s
	iters: 200, epoch: 8 | loss: 0.0959347
	speed: 0.0097s/iter; left time: 70.2854s
	iters: 300, epoch: 8 | loss: 0.0586260
	speed: 0.0097s/iter; left time: 68.8805s
	iters: 400, epoch: 8 | loss: 0.0814930
	speed: 0.0097s/iter; left time: 67.9513s
	iters: 500, epoch: 8 | loss: 0.0738687
	speed: 0.0097s/iter; left time: 67.1179s
Epoch: 8 cost time: 5.8131561279296875
Epoch: 8, Steps: 570 | Train Loss: 0.0774923 Vali Loss: 0.0378750 Test Loss: 0.1392616
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13732154667377472, mae:0.2374982088804245
>>> MS_Raw LR=1e-4 DO=0.0 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2075656
	speed: 0.0232s/iter; left time: 261.9546s
	iters: 200, epoch: 1 | loss: 0.1891302
	speed: 0.0114s/iter; left time: 127.9190s
	iters: 300, epoch: 1 | loss: 0.1438425
	speed: 0.0114s/iter; left time: 126.5263s
	iters: 400, epoch: 1 | loss: 0.0960854
	speed: 0.0114s/iter; left time: 124.9396s
	iters: 500, epoch: 1 | loss: 0.1460082
	speed: 0.0114s/iter; left time: 123.9070s
Epoch: 1 cost time: 7.715063571929932
Epoch: 1, Steps: 570 | Train Loss: 0.1726389 Vali Loss: 0.0416023 Test Loss: 0.1333482
Validation loss decreased (inf --> 0.041602).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1125999
	speed: 0.0403s/iter; left time: 432.3091s
	iters: 200, epoch: 2 | loss: 0.1601015
	speed: 0.0125s/iter; left time: 132.3976s
	iters: 300, epoch: 2 | loss: 0.0863702
	speed: 0.0125s/iter; left time: 131.3161s
	iters: 400, epoch: 2 | loss: 0.0722242
	speed: 0.0125s/iter; left time: 130.2135s
	iters: 500, epoch: 2 | loss: 0.1252543
	speed: 0.0125s/iter; left time: 128.7201s
Epoch: 2 cost time: 7.412073135375977
Epoch: 2, Steps: 570 | Train Loss: 0.1206118 Vali Loss: 0.0371007 Test Loss: 0.1300596
Validation loss decreased (0.041602 --> 0.037101).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1112814
	speed: 0.0392s/iter; left time: 398.4464s
	iters: 200, epoch: 3 | loss: 0.1019169
	speed: 0.0114s/iter; left time: 114.9137s
	iters: 300, epoch: 3 | loss: 0.0533755
	speed: 0.0114s/iter; left time: 114.0490s
	iters: 400, epoch: 3 | loss: 0.0745492
	speed: 0.0114s/iter; left time: 112.7298s
	iters: 500, epoch: 3 | loss: 0.0664679
	speed: 0.0114s/iter; left time: 111.5717s
Epoch: 3 cost time: 6.792311429977417
Epoch: 3, Steps: 570 | Train Loss: 0.0850507 Vali Loss: 0.0382536 Test Loss: 0.1343134
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0650218
	speed: 0.0390s/iter; left time: 373.6904s
	iters: 200, epoch: 4 | loss: 0.0675176
	speed: 0.0114s/iter; left time: 108.0546s
	iters: 300, epoch: 4 | loss: 0.0475311
	speed: 0.0114s/iter; left time: 106.9196s
	iters: 400, epoch: 4 | loss: 0.0494996
	speed: 0.0114s/iter; left time: 105.9674s
	iters: 500, epoch: 4 | loss: 0.0569383
	speed: 0.0114s/iter; left time: 104.7819s
Epoch: 4 cost time: 6.757643222808838
Epoch: 4, Steps: 570 | Train Loss: 0.0661452 Vali Loss: 0.0368891 Test Loss: 0.1419170
Validation loss decreased (0.037101 --> 0.036889).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0638862
	speed: 0.0378s/iter; left time: 340.9954s
	iters: 200, epoch: 5 | loss: 0.0473970
	speed: 0.0114s/iter; left time: 102.0101s
	iters: 300, epoch: 5 | loss: 0.0737297
	speed: 0.0114s/iter; left time: 100.7620s
	iters: 400, epoch: 5 | loss: 0.0438493
	speed: 0.0114s/iter; left time: 99.5542s
	iters: 500, epoch: 5 | loss: 0.0572657
	speed: 0.0114s/iter; left time: 98.3623s
Epoch: 5 cost time: 6.858055591583252
Epoch: 5, Steps: 570 | Train Loss: 0.0570209 Vali Loss: 0.0372287 Test Loss: 0.1375001
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0528088
	speed: 0.0381s/iter; left time: 321.7327s
	iters: 200, epoch: 6 | loss: 0.0441225
	speed: 0.0114s/iter; left time: 95.4116s
	iters: 300, epoch: 6 | loss: 0.0589389
	speed: 0.0114s/iter; left time: 94.1754s
	iters: 400, epoch: 6 | loss: 0.0440373
	speed: 0.0114s/iter; left time: 93.0408s
	iters: 500, epoch: 6 | loss: 0.0396450
	speed: 0.0114s/iter; left time: 91.7759s
Epoch: 6 cost time: 6.814604043960571
Epoch: 6, Steps: 570 | Train Loss: 0.0524589 Vali Loss: 0.0373383 Test Loss: 0.1398008
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0418494
	speed: 0.0382s/iter; left time: 301.2485s
	iters: 200, epoch: 7 | loss: 0.0407792
	speed: 0.0114s/iter; left time: 89.0557s
	iters: 300, epoch: 7 | loss: 0.0543232
	speed: 0.0114s/iter; left time: 87.7167s
	iters: 400, epoch: 7 | loss: 0.0451226
	speed: 0.0114s/iter; left time: 86.6252s
	iters: 500, epoch: 7 | loss: 0.0532091
	speed: 0.0114s/iter; left time: 85.5159s
Epoch: 7 cost time: 6.816563606262207
Epoch: 7, Steps: 570 | Train Loss: 0.0501880 Vali Loss: 0.0371221 Test Loss: 0.1395622
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1421547830104828, mae:0.2445380836725235
>>> MS_Raw LR=1e-4 DO=0.0 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.0821424
	speed: 0.0227s/iter; left time: 256.1956s
	iters: 200, epoch: 1 | loss: 0.2055272
	speed: 0.0110s/iter; left time: 122.8523s
	iters: 300, epoch: 1 | loss: 0.1187363
	speed: 0.0110s/iter; left time: 121.8869s
	iters: 400, epoch: 1 | loss: 0.1494484
	speed: 0.0110s/iter; left time: 120.6026s
	iters: 500, epoch: 1 | loss: 0.1010472
	speed: 0.0110s/iter; left time: 119.4900s
Epoch: 1 cost time: 7.474491357803345
Epoch: 1, Steps: 570 | Train Loss: 0.1439106 Vali Loss: 0.0382256 Test Loss: 0.1186200
Validation loss decreased (inf --> 0.038226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1050378
	speed: 0.0379s/iter; left time: 406.7717s
	iters: 200, epoch: 2 | loss: 0.0721160
	speed: 0.0110s/iter; left time: 117.1746s
	iters: 300, epoch: 2 | loss: 0.1025319
	speed: 0.0110s/iter; left time: 116.0256s
	iters: 400, epoch: 2 | loss: 0.1451430
	speed: 0.0111s/iter; left time: 115.3256s
	iters: 500, epoch: 2 | loss: 0.1316334
	speed: 0.0110s/iter; left time: 114.0508s
Epoch: 2 cost time: 6.611313819885254
Epoch: 2, Steps: 570 | Train Loss: 0.1032850 Vali Loss: 0.0366824 Test Loss: 0.1188014
Validation loss decreased (0.038226 --> 0.036682).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0892414
	speed: 0.0388s/iter; left time: 393.9450s
	iters: 200, epoch: 3 | loss: 0.0581202
	speed: 0.0111s/iter; left time: 111.5733s
	iters: 300, epoch: 3 | loss: 0.0749623
	speed: 0.0111s/iter; left time: 110.6518s
	iters: 400, epoch: 3 | loss: 0.0981017
	speed: 0.0111s/iter; left time: 109.5545s
	iters: 500, epoch: 3 | loss: 0.0787319
	speed: 0.0111s/iter; left time: 108.1686s
Epoch: 3 cost time: 6.631909608840942
Epoch: 3, Steps: 570 | Train Loss: 0.0738748 Vali Loss: 0.0344610 Test Loss: 0.1209547
Validation loss decreased (0.036682 --> 0.034461).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0760859
	speed: 0.0383s/iter; left time: 367.3055s
	iters: 200, epoch: 4 | loss: 0.0513707
	speed: 0.0121s/iter; left time: 114.9478s
	iters: 300, epoch: 4 | loss: 0.0340439
	speed: 0.0121s/iter; left time: 113.7986s
	iters: 400, epoch: 4 | loss: 0.0534885
	speed: 0.0117s/iter; left time: 108.9260s
	iters: 500, epoch: 4 | loss: 0.0699914
	speed: 0.0111s/iter; left time: 101.6196s
Epoch: 4 cost time: 7.012072801589966
Epoch: 4, Steps: 570 | Train Loss: 0.0581782 Vali Loss: 0.0338879 Test Loss: 0.1185862
Validation loss decreased (0.034461 --> 0.033888).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0432031
	speed: 0.0397s/iter; left time: 358.5795s
	iters: 200, epoch: 5 | loss: 0.0489614
	speed: 0.0121s/iter; left time: 107.6542s
	iters: 300, epoch: 5 | loss: 0.0570353
	speed: 0.0121s/iter; left time: 106.4924s
	iters: 400, epoch: 5 | loss: 0.0587425
	speed: 0.0121s/iter; left time: 105.2943s
	iters: 500, epoch: 5 | loss: 0.0486464
	speed: 0.0121s/iter; left time: 104.0633s
Epoch: 5 cost time: 7.183860540390015
Epoch: 5, Steps: 570 | Train Loss: 0.0501565 Vali Loss: 0.0345894 Test Loss: 0.1200429
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0685314
	speed: 0.0387s/iter; left time: 326.7926s
	iters: 200, epoch: 6 | loss: 0.0445221
	speed: 0.0111s/iter; left time: 92.8536s
	iters: 300, epoch: 6 | loss: 0.0449592
	speed: 0.0111s/iter; left time: 91.7703s
	iters: 400, epoch: 6 | loss: 0.0366026
	speed: 0.0111s/iter; left time: 90.6088s
	iters: 500, epoch: 6 | loss: 0.0413571
	speed: 0.0111s/iter; left time: 89.4773s
Epoch: 6 cost time: 6.675524711608887
Epoch: 6, Steps: 570 | Train Loss: 0.0462577 Vali Loss: 0.0350961 Test Loss: 0.1203088
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0393076
	speed: 0.0378s/iter; left time: 297.7720s
	iters: 200, epoch: 7 | loss: 0.0463046
	speed: 0.0111s/iter; left time: 86.0772s
	iters: 300, epoch: 7 | loss: 0.0442514
	speed: 0.0111s/iter; left time: 84.9827s
	iters: 400, epoch: 7 | loss: 0.0389046
	speed: 0.0111s/iter; left time: 83.8332s
	iters: 500, epoch: 7 | loss: 0.0392465
	speed: 0.0111s/iter; left time: 82.7325s
Epoch: 7 cost time: 6.5874714851379395
Epoch: 7, Steps: 570 | Train Loss: 0.0443031 Vali Loss: 0.0349080 Test Loss: 0.1201539
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11877221614122391, mae:0.21709507703781128
>>> MS_Raw LR=1e-4 DO=0.0 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1887072
	speed: 0.0237s/iter; left time: 267.5769s
	iters: 200, epoch: 1 | loss: 0.1759307
	speed: 0.0113s/iter; left time: 126.6646s
	iters: 300, epoch: 1 | loss: 0.2258705
	speed: 0.0114s/iter; left time: 126.4248s
	iters: 400, epoch: 1 | loss: 0.1309080
	speed: 0.0117s/iter; left time: 128.7588s
	iters: 500, epoch: 1 | loss: 0.1294963
	speed: 0.0117s/iter; left time: 127.7343s
Epoch: 1 cost time: 7.848819732666016
Epoch: 1, Steps: 570 | Train Loss: 0.1765686 Vali Loss: 0.0423134 Test Loss: 0.1332751
Validation loss decreased (inf --> 0.042313).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1715980
	speed: 0.0398s/iter; left time: 427.3240s
	iters: 200, epoch: 2 | loss: 0.1917507
	speed: 0.0118s/iter; left time: 125.1411s
	iters: 300, epoch: 2 | loss: 0.0993218
	speed: 0.0117s/iter; left time: 123.2091s
	iters: 400, epoch: 2 | loss: 0.0857142
	speed: 0.0117s/iter; left time: 122.2404s
	iters: 500, epoch: 2 | loss: 0.1163648
	speed: 0.0117s/iter; left time: 121.1266s
Epoch: 2 cost time: 6.966057062149048
Epoch: 2, Steps: 570 | Train Loss: 0.1256958 Vali Loss: 0.0456945 Test Loss: 0.1378805
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1145572
	speed: 0.0370s/iter; left time: 375.4755s
	iters: 200, epoch: 3 | loss: 0.0797853
	speed: 0.0103s/iter; left time: 103.5060s
	iters: 300, epoch: 3 | loss: 0.0870536
	speed: 0.0103s/iter; left time: 102.1626s
	iters: 400, epoch: 3 | loss: 0.0757016
	speed: 0.0103s/iter; left time: 101.3015s
	iters: 500, epoch: 3 | loss: 0.1084943
	speed: 0.0103s/iter; left time: 100.2480s
Epoch: 3 cost time: 6.156662940979004
Epoch: 3, Steps: 570 | Train Loss: 0.0880999 Vali Loss: 0.0434391 Test Loss: 0.1412951
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0574450
	speed: 0.0380s/iter; left time: 364.8213s
	iters: 200, epoch: 4 | loss: 0.0721468
	speed: 0.0117s/iter; left time: 111.3072s
	iters: 300, epoch: 4 | loss: 0.0654138
	speed: 0.0117s/iter; left time: 109.9121s
	iters: 400, epoch: 4 | loss: 0.0990636
	speed: 0.0117s/iter; left time: 108.5728s
	iters: 500, epoch: 4 | loss: 0.0713094
	speed: 0.0109s/iter; left time: 100.2494s
Epoch: 4 cost time: 6.720710515975952
Epoch: 4, Steps: 570 | Train Loss: 0.0684439 Vali Loss: 0.0446042 Test Loss: 0.1375321
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1334594041109085, mae:0.23299375176429749
>>> MS_Raw LR=1e-4 DO=0.0 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1846062
	speed: 0.0252s/iter; left time: 284.5758s
	iters: 200, epoch: 1 | loss: 0.1460764
	speed: 0.0136s/iter; left time: 152.3305s
	iters: 300, epoch: 1 | loss: 0.2441318
	speed: 0.0136s/iter; left time: 150.8730s
	iters: 400, epoch: 1 | loss: 0.1463033
	speed: 0.0136s/iter; left time: 149.8708s
	iters: 500, epoch: 1 | loss: 0.1389970
	speed: 0.0136s/iter; left time: 148.4793s
Epoch: 1 cost time: 8.96597170829773
Epoch: 1, Steps: 570 | Train Loss: 0.1763569 Vali Loss: 0.0408216 Test Loss: 0.1298443
Validation loss decreased (inf --> 0.040822).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1671756
	speed: 0.0448s/iter; left time: 480.2138s
	iters: 200, epoch: 2 | loss: 0.1170338
	speed: 0.0136s/iter; left time: 144.0820s
	iters: 300, epoch: 2 | loss: 0.1050745
	speed: 0.0135s/iter; left time: 142.6471s
	iters: 400, epoch: 2 | loss: 0.1136662
	speed: 0.0135s/iter; left time: 141.3323s
	iters: 500, epoch: 2 | loss: 0.1486110
	speed: 0.0136s/iter; left time: 140.0694s
Epoch: 2 cost time: 8.042799472808838
Epoch: 2, Steps: 570 | Train Loss: 0.1301342 Vali Loss: 0.0375515 Test Loss: 0.1284046
Validation loss decreased (0.040822 --> 0.037552).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1702181
	speed: 0.0465s/iter; left time: 472.9022s
	iters: 200, epoch: 3 | loss: 0.0794896
	speed: 0.0150s/iter; left time: 150.7532s
	iters: 300, epoch: 3 | loss: 0.0642059
	speed: 0.0136s/iter; left time: 135.7079s
	iters: 400, epoch: 3 | loss: 0.0825356
	speed: 0.0136s/iter; left time: 133.9576s
	iters: 500, epoch: 3 | loss: 0.0720266
	speed: 0.0136s/iter; left time: 132.4691s
Epoch: 3 cost time: 8.360477447509766
Epoch: 3, Steps: 570 | Train Loss: 0.0985180 Vali Loss: 0.0344121 Test Loss: 0.1251863
Validation loss decreased (0.037552 --> 0.034412).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0837777
	speed: 0.0440s/iter; left time: 422.0961s
	iters: 200, epoch: 4 | loss: 0.0715140
	speed: 0.0136s/iter; left time: 129.5171s
	iters: 300, epoch: 4 | loss: 0.1077494
	speed: 0.0137s/iter; left time: 128.2971s
	iters: 400, epoch: 4 | loss: 0.0905709
	speed: 0.0137s/iter; left time: 127.0251s
	iters: 500, epoch: 4 | loss: 0.0786342
	speed: 0.0137s/iter; left time: 125.7247s
Epoch: 4 cost time: 8.039461374282837
Epoch: 4, Steps: 570 | Train Loss: 0.0826425 Vali Loss: 0.0340419 Test Loss: 0.1338193
Validation loss decreased (0.034412 --> 0.034042).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0822442
	speed: 0.0460s/iter; left time: 415.1278s
	iters: 200, epoch: 5 | loss: 0.0708540
	speed: 0.0137s/iter; left time: 122.3294s
	iters: 300, epoch: 5 | loss: 0.0620825
	speed: 0.0137s/iter; left time: 120.5100s
	iters: 400, epoch: 5 | loss: 0.0708510
	speed: 0.0137s/iter; left time: 119.1628s
	iters: 500, epoch: 5 | loss: 0.0573040
	speed: 0.0137s/iter; left time: 118.3439s
Epoch: 5 cost time: 8.075492858886719
Epoch: 5, Steps: 570 | Train Loss: 0.0745537 Vali Loss: 0.0338613 Test Loss: 0.1355065
Validation loss decreased (0.034042 --> 0.033861).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0625130
	speed: 0.0458s/iter; left time: 387.1205s
	iters: 200, epoch: 6 | loss: 0.1003545
	speed: 0.0153s/iter; left time: 127.7769s
	iters: 300, epoch: 6 | loss: 0.0615088
	speed: 0.0153s/iter; left time: 126.2605s
	iters: 400, epoch: 6 | loss: 0.0667660
	speed: 0.0153s/iter; left time: 124.3391s
	iters: 500, epoch: 6 | loss: 0.0611838
	speed: 0.0152s/iter; left time: 122.4173s
Epoch: 6 cost time: 8.977247953414917
Epoch: 6, Steps: 570 | Train Loss: 0.0702705 Vali Loss: 0.0333649 Test Loss: 0.1425450
Validation loss decreased (0.033861 --> 0.033365).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0654657
	speed: 0.0446s/iter; left time: 351.4974s
	iters: 200, epoch: 7 | loss: 0.0705935
	speed: 0.0136s/iter; left time: 105.4680s
	iters: 300, epoch: 7 | loss: 0.0509100
	speed: 0.0136s/iter; left time: 104.2227s
	iters: 400, epoch: 7 | loss: 0.0633409
	speed: 0.0136s/iter; left time: 102.8482s
	iters: 500, epoch: 7 | loss: 0.0975587
	speed: 0.0136s/iter; left time: 101.5187s
Epoch: 7 cost time: 7.9870765209198
Epoch: 7, Steps: 570 | Train Loss: 0.0681824 Vali Loss: 0.0336655 Test Loss: 0.1403572
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0956806
	speed: 0.0440s/iter; left time: 322.0016s
	iters: 200, epoch: 8 | loss: 0.0627450
	speed: 0.0137s/iter; left time: 99.1141s
	iters: 300, epoch: 8 | loss: 0.0663303
	speed: 0.0137s/iter; left time: 97.6571s
	iters: 400, epoch: 8 | loss: 0.0545766
	speed: 0.0137s/iter; left time: 95.8492s
	iters: 500, epoch: 8 | loss: 0.0640488
	speed: 0.0137s/iter; left time: 94.4684s
Epoch: 8 cost time: 8.208652973175049
Epoch: 8, Steps: 570 | Train Loss: 0.0669320 Vali Loss: 0.0336026 Test Loss: 0.1410938
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0882823
	speed: 0.0478s/iter; left time: 321.9117s
	iters: 200, epoch: 9 | loss: 0.0625098
	speed: 0.0157s/iter; left time: 104.1062s
	iters: 300, epoch: 9 | loss: 0.0696202
	speed: 0.0157s/iter; left time: 102.6148s
	iters: 400, epoch: 9 | loss: 0.0970610
	speed: 0.0157s/iter; left time: 101.0722s
	iters: 500, epoch: 9 | loss: 0.0535186
	speed: 0.0157s/iter; left time: 99.5506s
Epoch: 9 cost time: 9.210913181304932
Epoch: 9, Steps: 570 | Train Loss: 0.0663572 Vali Loss: 0.0335445 Test Loss: 0.1410328
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14278028905391693, mae:0.2392059564590454
>>> MS_Raw LR=1e-4 DO=0.0 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2086009
	speed: 0.0252s/iter; left time: 285.2182s
	iters: 200, epoch: 1 | loss: 0.1268833
	speed: 0.0135s/iter; left time: 150.9484s
	iters: 300, epoch: 1 | loss: 0.0825019
	speed: 0.0135s/iter; left time: 149.3448s
	iters: 400, epoch: 1 | loss: 0.1786777
	speed: 0.0135s/iter; left time: 148.2704s
	iters: 500, epoch: 1 | loss: 0.1494922
	speed: 0.0135s/iter; left time: 146.6190s
Epoch: 1 cost time: 8.901540279388428
Epoch: 1, Steps: 570 | Train Loss: 0.1467718 Vali Loss: 0.0342594 Test Loss: 0.1109782
Validation loss decreased (inf --> 0.034259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0795360
	speed: 0.0491s/iter; left time: 526.6305s
	iters: 200, epoch: 2 | loss: 0.1822288
	speed: 0.0140s/iter; left time: 148.7063s
	iters: 300, epoch: 2 | loss: 0.1266771
	speed: 0.0134s/iter; left time: 141.5108s
	iters: 400, epoch: 2 | loss: 0.0741273
	speed: 0.0134s/iter; left time: 140.1607s
	iters: 500, epoch: 2 | loss: 0.0941638
	speed: 0.0134s/iter; left time: 138.6127s
Epoch: 2 cost time: 8.175861597061157
Epoch: 2, Steps: 570 | Train Loss: 0.1086508 Vali Loss: 0.0347206 Test Loss: 0.1152831
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1089271
	speed: 0.0458s/iter; left time: 465.7408s
	iters: 200, epoch: 3 | loss: 0.0491227
	speed: 0.0152s/iter; left time: 152.8057s
	iters: 300, epoch: 3 | loss: 0.0805668
	speed: 0.0152s/iter; left time: 150.9915s
	iters: 400, epoch: 3 | loss: 0.0633435
	speed: 0.0152s/iter; left time: 149.6667s
	iters: 500, epoch: 3 | loss: 0.0806450
	speed: 0.0137s/iter; left time: 133.3311s
Epoch: 3 cost time: 8.64818000793457
Epoch: 3, Steps: 570 | Train Loss: 0.0849287 Vali Loss: 0.0339566 Test Loss: 0.1128228
Validation loss decreased (0.034259 --> 0.033957).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0430873
	speed: 0.0436s/iter; left time: 418.4201s
	iters: 200, epoch: 4 | loss: 0.0846040
	speed: 0.0134s/iter; left time: 127.3641s
	iters: 300, epoch: 4 | loss: 0.0854110
	speed: 0.0134s/iter; left time: 125.8222s
	iters: 400, epoch: 4 | loss: 0.0510526
	speed: 0.0134s/iter; left time: 124.7398s
	iters: 500, epoch: 4 | loss: 0.0482591
	speed: 0.0134s/iter; left time: 123.3422s
Epoch: 4 cost time: 7.910881280899048
Epoch: 4, Steps: 570 | Train Loss: 0.0707148 Vali Loss: 0.0325064 Test Loss: 0.1138103
Validation loss decreased (0.033957 --> 0.032506).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0418888
	speed: 0.0437s/iter; left time: 394.4648s
	iters: 200, epoch: 5 | loss: 0.0535754
	speed: 0.0135s/iter; left time: 120.8793s
	iters: 300, epoch: 5 | loss: 0.0558173
	speed: 0.0136s/iter; left time: 119.6113s
	iters: 400, epoch: 5 | loss: 0.0423305
	speed: 0.0136s/iter; left time: 118.4094s
	iters: 500, epoch: 5 | loss: 0.0710006
	speed: 0.0135s/iter; left time: 116.8068s
Epoch: 5 cost time: 8.0374755859375
Epoch: 5, Steps: 570 | Train Loss: 0.0630975 Vali Loss: 0.0331896 Test Loss: 0.1157545
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0559983
	speed: 0.0453s/iter; left time: 383.1130s
	iters: 200, epoch: 6 | loss: 0.0775681
	speed: 0.0135s/iter; left time: 112.4352s
	iters: 300, epoch: 6 | loss: 0.0614349
	speed: 0.0134s/iter; left time: 110.9547s
	iters: 400, epoch: 6 | loss: 0.0877111
	speed: 0.0134s/iter; left time: 109.5192s
	iters: 500, epoch: 6 | loss: 0.0537601
	speed: 0.0134s/iter; left time: 108.0250s
Epoch: 6 cost time: 7.982623815536499
Epoch: 6, Steps: 570 | Train Loss: 0.0592694 Vali Loss: 0.0337582 Test Loss: 0.1174152
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0422037
	speed: 0.0431s/iter; left time: 339.7121s
	iters: 200, epoch: 7 | loss: 0.0650079
	speed: 0.0135s/iter; left time: 105.1607s
	iters: 300, epoch: 7 | loss: 0.0573400
	speed: 0.0135s/iter; left time: 103.8292s
	iters: 400, epoch: 7 | loss: 0.0773056
	speed: 0.0135s/iter; left time: 102.4811s
	iters: 500, epoch: 7 | loss: 0.0634231
	speed: 0.0135s/iter; left time: 101.0444s
Epoch: 7 cost time: 7.943813800811768
Epoch: 7, Steps: 570 | Train Loss: 0.0573789 Vali Loss: 0.0333042 Test Loss: 0.1173780
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1139611005783081, mae:0.2082395851612091
>>> MS_Raw LR=1e-4 DO=0.0 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1144149
	speed: 0.0256s/iter; left time: 288.7914s
	iters: 200, epoch: 1 | loss: 0.2406504
	speed: 0.0135s/iter; left time: 151.6930s
	iters: 300, epoch: 1 | loss: 0.2033081
	speed: 0.0135s/iter; left time: 149.7785s
	iters: 400, epoch: 1 | loss: 0.1833813
	speed: 0.0135s/iter; left time: 148.5325s
	iters: 500, epoch: 1 | loss: 0.2188929
	speed: 0.0135s/iter; left time: 147.1429s
Epoch: 1 cost time: 8.954799890518188
Epoch: 1, Steps: 570 | Train Loss: 0.1830724 Vali Loss: 0.0439534 Test Loss: 0.1360427
Validation loss decreased (inf --> 0.043953).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1161361
	speed: 0.0467s/iter; left time: 500.9716s
	iters: 200, epoch: 2 | loss: 0.1070751
	speed: 0.0137s/iter; left time: 145.8601s
	iters: 300, epoch: 2 | loss: 0.0788092
	speed: 0.0136s/iter; left time: 143.1392s
	iters: 400, epoch: 2 | loss: 0.1083257
	speed: 0.0136s/iter; left time: 141.7547s
	iters: 500, epoch: 2 | loss: 0.1613746
	speed: 0.0136s/iter; left time: 140.0234s
Epoch: 2 cost time: 8.075362920761108
Epoch: 2, Steps: 570 | Train Loss: 0.1330781 Vali Loss: 0.0425666 Test Loss: 0.1355622
Validation loss decreased (0.043953 --> 0.042567).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1262835
	speed: 0.0458s/iter; left time: 465.8452s
	iters: 200, epoch: 3 | loss: 0.1231543
	speed: 0.0136s/iter; left time: 136.8818s
	iters: 300, epoch: 3 | loss: 0.1130273
	speed: 0.0136s/iter; left time: 135.3863s
	iters: 400, epoch: 3 | loss: 0.0933835
	speed: 0.0136s/iter; left time: 134.1232s
	iters: 500, epoch: 3 | loss: 0.0828833
	speed: 0.0136s/iter; left time: 132.4821s
Epoch: 3 cost time: 8.060388326644897
Epoch: 3, Steps: 570 | Train Loss: 0.1018775 Vali Loss: 0.0402669 Test Loss: 0.1315529
Validation loss decreased (0.042567 --> 0.040267).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0914271
	speed: 0.0464s/iter; left time: 444.8057s
	iters: 200, epoch: 4 | loss: 0.0881497
	speed: 0.0136s/iter; left time: 129.2847s
	iters: 300, epoch: 4 | loss: 0.1122045
	speed: 0.0136s/iter; left time: 127.5851s
	iters: 400, epoch: 4 | loss: 0.0924591
	speed: 0.0136s/iter; left time: 126.3861s
	iters: 500, epoch: 4 | loss: 0.0600994
	speed: 0.0136s/iter; left time: 124.8990s
Epoch: 4 cost time: 8.039272546768188
Epoch: 4, Steps: 570 | Train Loss: 0.0849475 Vali Loss: 0.0398159 Test Loss: 0.1358591
Validation loss decreased (0.040267 --> 0.039816).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0953159
	speed: 0.0476s/iter; left time: 429.7826s
	iters: 200, epoch: 5 | loss: 0.0844836
	speed: 0.0135s/iter; left time: 120.3982s
	iters: 300, epoch: 5 | loss: 0.0806522
	speed: 0.0135s/iter; left time: 119.2810s
	iters: 400, epoch: 5 | loss: 0.1095421
	speed: 0.0135s/iter; left time: 117.5109s
	iters: 500, epoch: 5 | loss: 0.0639920
	speed: 0.0135s/iter; left time: 116.0627s
Epoch: 5 cost time: 7.997544288635254
Epoch: 5, Steps: 570 | Train Loss: 0.0758155 Vali Loss: 0.0397634 Test Loss: 0.1374840
Validation loss decreased (0.039816 --> 0.039763).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0751844
	speed: 0.0486s/iter; left time: 410.6167s
	iters: 200, epoch: 6 | loss: 0.0710672
	speed: 0.0150s/iter; left time: 125.0920s
	iters: 300, epoch: 6 | loss: 0.0579034
	speed: 0.0152s/iter; left time: 125.5347s
	iters: 400, epoch: 6 | loss: 0.1137909
	speed: 0.0152s/iter; left time: 123.9239s
	iters: 500, epoch: 6 | loss: 0.0788763
	speed: 0.0152s/iter; left time: 122.4417s
Epoch: 6 cost time: 8.791796684265137
Epoch: 6, Steps: 570 | Train Loss: 0.0710732 Vali Loss: 0.0392962 Test Loss: 0.1376793
Validation loss decreased (0.039763 --> 0.039296).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0663552
	speed: 0.0468s/iter; left time: 368.8935s
	iters: 200, epoch: 7 | loss: 0.0596826
	speed: 0.0135s/iter; left time: 105.1500s
	iters: 300, epoch: 7 | loss: 0.0695392
	speed: 0.0135s/iter; left time: 103.5904s
	iters: 400, epoch: 7 | loss: 0.0918856
	speed: 0.0135s/iter; left time: 102.0923s
	iters: 500, epoch: 7 | loss: 0.0480557
	speed: 0.0135s/iter; left time: 100.7685s
Epoch: 7 cost time: 8.000723123550415
Epoch: 7, Steps: 570 | Train Loss: 0.0685185 Vali Loss: 0.0394485 Test Loss: 0.1380076
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0535319
	speed: 0.0468s/iter; left time: 342.0110s
	iters: 200, epoch: 8 | loss: 0.0492976
	speed: 0.0137s/iter; left time: 98.6053s
	iters: 300, epoch: 8 | loss: 0.0699289
	speed: 0.0137s/iter; left time: 97.2111s
	iters: 400, epoch: 8 | loss: 0.0725985
	speed: 0.0137s/iter; left time: 95.7937s
	iters: 500, epoch: 8 | loss: 0.0543380
	speed: 0.0136s/iter; left time: 94.1924s
Epoch: 8 cost time: 8.246795892715454
Epoch: 8, Steps: 570 | Train Loss: 0.0673541 Vali Loss: 0.0400491 Test Loss: 0.1392234
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0756388
	speed: 0.0450s/iter; left time: 303.0486s
	iters: 200, epoch: 9 | loss: 0.0615586
	speed: 0.0135s/iter; left time: 89.6912s
	iters: 300, epoch: 9 | loss: 0.0448848
	speed: 0.0135s/iter; left time: 88.4420s
	iters: 400, epoch: 9 | loss: 0.0649287
	speed: 0.0135s/iter; left time: 87.1294s
	iters: 500, epoch: 9 | loss: 0.0648801
	speed: 0.0135s/iter; left time: 85.6608s
Epoch: 9 cost time: 8.008362054824829
Epoch: 9, Steps: 570 | Train Loss: 0.0667382 Vali Loss: 0.0394727 Test Loss: 0.1387659
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13790731132030487, mae:0.24107909202575684
>>> MS_Raw LR=1e-4 DO=0.0 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2078299
	speed: 0.0284s/iter; left time: 320.7675s
	iters: 200, epoch: 1 | loss: 0.1424055
	speed: 0.0164s/iter; left time: 183.8194s
	iters: 300, epoch: 1 | loss: 0.1897625
	speed: 0.0164s/iter; left time: 182.1197s
	iters: 400, epoch: 1 | loss: 0.1409163
	speed: 0.0164s/iter; left time: 180.3332s
	iters: 500, epoch: 1 | loss: 0.1303341
	speed: 0.0164s/iter; left time: 178.7943s
Epoch: 1 cost time: 10.598057746887207
Epoch: 1, Steps: 570 | Train Loss: 0.1713149 Vali Loss: 0.0450306 Test Loss: 0.1379519
Validation loss decreased (inf --> 0.045031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1361812
	speed: 0.0520s/iter; left time: 557.9142s
	iters: 200, epoch: 2 | loss: 0.1315437
	speed: 0.0163s/iter; left time: 173.6025s
	iters: 300, epoch: 2 | loss: 0.1162446
	speed: 0.0163s/iter; left time: 171.9497s
	iters: 400, epoch: 2 | loss: 0.0781730
	speed: 0.0163s/iter; left time: 170.3853s
	iters: 500, epoch: 2 | loss: 0.0761840
	speed: 0.0163s/iter; left time: 168.8331s
Epoch: 2 cost time: 9.617472410202026
Epoch: 2, Steps: 570 | Train Loss: 0.1173301 Vali Loss: 0.0351438 Test Loss: 0.1238170
Validation loss decreased (0.045031 --> 0.035144).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0778482
	speed: 0.0517s/iter; left time: 525.1416s
	iters: 200, epoch: 3 | loss: 0.0825490
	speed: 0.0164s/iter; left time: 164.6266s
	iters: 300, epoch: 3 | loss: 0.1426406
	speed: 0.0164s/iter; left time: 162.9330s
	iters: 400, epoch: 3 | loss: 0.0660927
	speed: 0.0163s/iter; left time: 161.2157s
	iters: 500, epoch: 3 | loss: 0.0541380
	speed: 0.0163s/iter; left time: 159.4982s
Epoch: 3 cost time: 9.638730525970459
Epoch: 3, Steps: 570 | Train Loss: 0.0766610 Vali Loss: 0.0350214 Test Loss: 0.1284641
Validation loss decreased (0.035144 --> 0.035021).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0515998
	speed: 0.0525s/iter; left time: 503.4032s
	iters: 200, epoch: 4 | loss: 0.0599067
	speed: 0.0164s/iter; left time: 155.9317s
	iters: 300, epoch: 4 | loss: 0.0413344
	speed: 0.0164s/iter; left time: 153.9414s
	iters: 400, epoch: 4 | loss: 0.0718858
	speed: 0.0163s/iter; left time: 151.7315s
	iters: 500, epoch: 4 | loss: 0.0584151
	speed: 0.0164s/iter; left time: 150.5515s
Epoch: 4 cost time: 9.656755208969116
Epoch: 4, Steps: 570 | Train Loss: 0.0558121 Vali Loss: 0.0368052 Test Loss: 0.1358294
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0419310
	speed: 0.0517s/iter; left time: 466.8135s
	iters: 200, epoch: 5 | loss: 0.0496591
	speed: 0.0163s/iter; left time: 145.4624s
	iters: 300, epoch: 5 | loss: 0.0489003
	speed: 0.0163s/iter; left time: 143.8269s
	iters: 400, epoch: 5 | loss: 0.0590560
	speed: 0.0163s/iter; left time: 142.2209s
	iters: 500, epoch: 5 | loss: 0.0397884
	speed: 0.0163s/iter; left time: 140.5430s
Epoch: 5 cost time: 9.622173070907593
Epoch: 5, Steps: 570 | Train Loss: 0.0466488 Vali Loss: 0.0354055 Test Loss: 0.1407815
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0395191
	speed: 0.0493s/iter; left time: 416.5646s
	iters: 200, epoch: 6 | loss: 0.0326661
	speed: 0.0163s/iter; left time: 135.9587s
	iters: 300, epoch: 6 | loss: 0.0438034
	speed: 0.0163s/iter; left time: 134.3713s
	iters: 400, epoch: 6 | loss: 0.0483762
	speed: 0.0163s/iter; left time: 132.7763s
	iters: 500, epoch: 6 | loss: 0.0372350
	speed: 0.0164s/iter; left time: 131.7493s
Epoch: 6 cost time: 9.605723857879639
Epoch: 6, Steps: 570 | Train Loss: 0.0420321 Vali Loss: 0.0355620 Test Loss: 0.1407559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12866666913032532, mae:0.23136582970619202
>>> MS_Raw LR=1e-4 DO=0.0 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1477773
	speed: 0.0293s/iter; left time: 330.8175s
	iters: 200, epoch: 1 | loss: 0.0753202
	speed: 0.0172s/iter; left time: 193.1980s
	iters: 300, epoch: 1 | loss: 0.1597915
	speed: 0.0172s/iter; left time: 191.1569s
	iters: 400, epoch: 1 | loss: 0.1282118
	speed: 0.0172s/iter; left time: 189.4048s
	iters: 500, epoch: 1 | loss: 0.0819353
	speed: 0.0172s/iter; left time: 187.7671s
Epoch: 1 cost time: 11.032791137695312
Epoch: 1, Steps: 570 | Train Loss: 0.1416919 Vali Loss: 0.0340319 Test Loss: 0.1118738
Validation loss decreased (inf --> 0.034032).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1035396
	speed: 0.0530s/iter; left time: 569.1786s
	iters: 200, epoch: 2 | loss: 0.0897047
	speed: 0.0158s/iter; left time: 168.1067s
	iters: 300, epoch: 2 | loss: 0.1571794
	speed: 0.0158s/iter; left time: 166.1166s
	iters: 400, epoch: 2 | loss: 0.0875617
	speed: 0.0157s/iter; left time: 164.1551s
	iters: 500, epoch: 2 | loss: 0.0733796
	speed: 0.0169s/iter; left time: 174.3033s
Epoch: 2 cost time: 9.458636283874512
Epoch: 2, Steps: 570 | Train Loss: 0.0999425 Vali Loss: 0.0362646 Test Loss: 0.1160469
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0676384
	speed: 0.0500s/iter; left time: 508.2448s
	iters: 200, epoch: 3 | loss: 0.0603915
	speed: 0.0158s/iter; left time: 159.1645s
	iters: 300, epoch: 3 | loss: 0.0641372
	speed: 0.0158s/iter; left time: 157.6402s
	iters: 400, epoch: 3 | loss: 0.0787638
	speed: 0.0158s/iter; left time: 155.8384s
	iters: 500, epoch: 3 | loss: 0.0494916
	speed: 0.0158s/iter; left time: 154.6106s
Epoch: 3 cost time: 9.323343992233276
Epoch: 3, Steps: 570 | Train Loss: 0.0663488 Vali Loss: 0.0348005 Test Loss: 0.1191276
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0568060
	speed: 0.0493s/iter; left time: 472.4664s
	iters: 200, epoch: 4 | loss: 0.0655669
	speed: 0.0158s/iter; left time: 149.7916s
	iters: 300, epoch: 4 | loss: 0.0402272
	speed: 0.0158s/iter; left time: 148.1249s
	iters: 400, epoch: 4 | loss: 0.0446116
	speed: 0.0162s/iter; left time: 150.2562s
	iters: 500, epoch: 4 | loss: 0.0549300
	speed: 0.0169s/iter; left time: 155.0623s
Epoch: 4 cost time: 9.483816623687744
Epoch: 4, Steps: 570 | Train Loss: 0.0491865 Vali Loss: 0.0349448 Test Loss: 0.1214562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11205563694238663, mae:0.20530520379543304
>>> MS_Raw LR=1e-4 DO=0.0 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1708764
	speed: 0.0273s/iter; left time: 308.3141s
	iters: 200, epoch: 1 | loss: 0.1193258
	speed: 0.0146s/iter; left time: 163.1468s
	iters: 300, epoch: 1 | loss: 0.1656508
	speed: 0.0145s/iter; left time: 161.1710s
	iters: 400, epoch: 1 | loss: 0.1511722
	speed: 0.0146s/iter; left time: 160.1600s
	iters: 500, epoch: 1 | loss: 0.2388563
	speed: 0.0145s/iter; left time: 158.1691s
Epoch: 1 cost time: 9.616031169891357
Epoch: 1, Steps: 570 | Train Loss: 0.1793625 Vali Loss: 0.0441069 Test Loss: 0.1392629
Validation loss decreased (inf --> 0.044107).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1864589
	speed: 0.0486s/iter; left time: 521.1284s
	iters: 200, epoch: 2 | loss: 0.0733957
	speed: 0.0146s/iter; left time: 155.6034s
	iters: 300, epoch: 2 | loss: 0.1169123
	speed: 0.0146s/iter; left time: 153.6439s
	iters: 400, epoch: 2 | loss: 0.1325214
	speed: 0.0146s/iter; left time: 152.4504s
	iters: 500, epoch: 2 | loss: 0.1146732
	speed: 0.0146s/iter; left time: 151.0147s
Epoch: 2 cost time: 8.627950191497803
Epoch: 2, Steps: 570 | Train Loss: 0.1177451 Vali Loss: 0.0400731 Test Loss: 0.1421569
Validation loss decreased (0.044107 --> 0.040073).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0823320
	speed: 0.0484s/iter; left time: 491.2986s
	iters: 200, epoch: 3 | loss: 0.0564177
	speed: 0.0147s/iter; left time: 148.2106s
	iters: 300, epoch: 3 | loss: 0.0987329
	speed: 0.0147s/iter; left time: 146.6386s
	iters: 400, epoch: 3 | loss: 0.0602564
	speed: 0.0147s/iter; left time: 145.2089s
	iters: 500, epoch: 3 | loss: 0.0829141
	speed: 0.0147s/iter; left time: 143.6977s
Epoch: 3 cost time: 8.70287036895752
Epoch: 3, Steps: 570 | Train Loss: 0.0726184 Vali Loss: 0.0375189 Test Loss: 0.1363660
Validation loss decreased (0.040073 --> 0.037519).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0425757
	speed: 0.0494s/iter; left time: 473.3493s
	iters: 200, epoch: 4 | loss: 0.0856920
	speed: 0.0147s/iter; left time: 139.1852s
	iters: 300, epoch: 4 | loss: 0.0566378
	speed: 0.0147s/iter; left time: 137.6001s
	iters: 400, epoch: 4 | loss: 0.0437738
	speed: 0.0146s/iter; left time: 135.9302s
	iters: 500, epoch: 4 | loss: 0.0620285
	speed: 0.0146s/iter; left time: 134.6257s
Epoch: 4 cost time: 8.649948120117188
Epoch: 4, Steps: 570 | Train Loss: 0.0526851 Vali Loss: 0.0370105 Test Loss: 0.1403879
Validation loss decreased (0.037519 --> 0.037011).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0406114
	speed: 0.0489s/iter; left time: 441.4564s
	iters: 200, epoch: 5 | loss: 0.0422068
	speed: 0.0147s/iter; left time: 131.3106s
	iters: 300, epoch: 5 | loss: 0.0453009
	speed: 0.0147s/iter; left time: 129.9727s
	iters: 400, epoch: 5 | loss: 0.0435832
	speed: 0.0147s/iter; left time: 128.5542s
	iters: 500, epoch: 5 | loss: 0.0368674
	speed: 0.0147s/iter; left time: 126.9239s
Epoch: 5 cost time: 8.664835691452026
Epoch: 5, Steps: 570 | Train Loss: 0.0436435 Vali Loss: 0.0378411 Test Loss: 0.1423287
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0305940
	speed: 0.0451s/iter; left time: 381.0239s
	iters: 200, epoch: 6 | loss: 0.0309110
	speed: 0.0147s/iter; left time: 123.0329s
	iters: 300, epoch: 6 | loss: 0.0290665
	speed: 0.0147s/iter; left time: 121.3368s
	iters: 400, epoch: 6 | loss: 0.0337679
	speed: 0.0147s/iter; left time: 119.7840s
	iters: 500, epoch: 6 | loss: 0.0298539
	speed: 0.0147s/iter; left time: 118.2984s
Epoch: 6 cost time: 8.628554344177246
Epoch: 6, Steps: 570 | Train Loss: 0.0393141 Vali Loss: 0.0380284 Test Loss: 0.1433180
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0388735
	speed: 0.0455s/iter; left time: 358.8809s
	iters: 200, epoch: 7 | loss: 0.0317292
	speed: 0.0146s/iter; left time: 113.7104s
	iters: 300, epoch: 7 | loss: 0.0503877
	speed: 0.0146s/iter; left time: 112.0944s
	iters: 400, epoch: 7 | loss: 0.0319478
	speed: 0.0146s/iter; left time: 110.6525s
	iters: 500, epoch: 7 | loss: 0.0518978
	speed: 0.0146s/iter; left time: 109.0866s
Epoch: 7 cost time: 8.597370624542236
Epoch: 7, Steps: 570 | Train Loss: 0.0371862 Vali Loss: 0.0383767 Test Loss: 0.1444984
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14058546721935272, mae:0.2441914826631546
>>> MS_Raw LR=1e-4 DO=0.0 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1207708
	speed: 0.0315s/iter; left time: 355.5498s
	iters: 200, epoch: 1 | loss: 0.1658366
	speed: 0.0196s/iter; left time: 219.2657s
	iters: 300, epoch: 1 | loss: 0.2600677
	speed: 0.0196s/iter; left time: 217.0912s
	iters: 400, epoch: 1 | loss: 0.1324711
	speed: 0.0196s/iter; left time: 215.9602s
	iters: 500, epoch: 1 | loss: 0.1258223
	speed: 0.0184s/iter; left time: 200.0509s
Epoch: 1 cost time: 12.13432788848877
Epoch: 1, Steps: 570 | Train Loss: 0.1767459 Vali Loss: 0.0456234 Test Loss: 0.1338982
Validation loss decreased (inf --> 0.045623).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1645802
	speed: 0.0585s/iter; left time: 627.2690s
	iters: 200, epoch: 2 | loss: 0.1161484
	speed: 0.0175s/iter; left time: 186.5047s
	iters: 300, epoch: 2 | loss: 0.1286412
	speed: 0.0175s/iter; left time: 184.5601s
	iters: 400, epoch: 2 | loss: 0.1164942
	speed: 0.0175s/iter; left time: 182.9094s
	iters: 500, epoch: 2 | loss: 0.1442048
	speed: 0.0175s/iter; left time: 181.1541s
Epoch: 2 cost time: 10.308471918106079
Epoch: 2, Steps: 570 | Train Loss: 0.1249090 Vali Loss: 0.0433283 Test Loss: 0.1317271
Validation loss decreased (0.045623 --> 0.043328).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0977896
	speed: 0.0546s/iter; left time: 554.4777s
	iters: 200, epoch: 3 | loss: 0.0681730
	speed: 0.0175s/iter; left time: 176.2667s
	iters: 300, epoch: 3 | loss: 0.0849765
	speed: 0.0175s/iter; left time: 174.7904s
	iters: 400, epoch: 3 | loss: 0.0804550
	speed: 0.0175s/iter; left time: 172.8869s
	iters: 500, epoch: 3 | loss: 0.0725421
	speed: 0.0175s/iter; left time: 171.1792s
Epoch: 3 cost time: 10.308072328567505
Epoch: 3, Steps: 570 | Train Loss: 0.0941606 Vali Loss: 0.0353566 Test Loss: 0.1254870
Validation loss decreased (0.043328 --> 0.035357).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0793846
	speed: 0.0543s/iter; left time: 520.8441s
	iters: 200, epoch: 4 | loss: 0.0919872
	speed: 0.0176s/iter; left time: 166.6789s
	iters: 300, epoch: 4 | loss: 0.0671227
	speed: 0.0176s/iter; left time: 165.0841s
	iters: 400, epoch: 4 | loss: 0.0602730
	speed: 0.0176s/iter; left time: 163.3419s
	iters: 500, epoch: 4 | loss: 0.0878569
	speed: 0.0176s/iter; left time: 161.4018s
Epoch: 4 cost time: 10.301536560058594
Epoch: 4, Steps: 570 | Train Loss: 0.0772238 Vali Loss: 0.0342536 Test Loss: 0.1399447
Validation loss decreased (0.035357 --> 0.034254).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0656800
	speed: 0.0569s/iter; left time: 512.9483s
	iters: 200, epoch: 5 | loss: 0.0561583
	speed: 0.0176s/iter; left time: 156.5934s
	iters: 300, epoch: 5 | loss: 0.0804801
	speed: 0.0175s/iter; left time: 154.4507s
	iters: 400, epoch: 5 | loss: 0.0545313
	speed: 0.0176s/iter; left time: 153.2311s
	iters: 500, epoch: 5 | loss: 0.0810072
	speed: 0.0175s/iter; left time: 151.1581s
Epoch: 5 cost time: 10.313895463943481
Epoch: 5, Steps: 570 | Train Loss: 0.0680126 Vali Loss: 0.0335107 Test Loss: 0.1322938
Validation loss decreased (0.034254 --> 0.033511).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0404243
	speed: 0.0557s/iter; left time: 470.3785s
	iters: 200, epoch: 6 | loss: 0.0678751
	speed: 0.0177s/iter; left time: 147.6770s
	iters: 300, epoch: 6 | loss: 0.0676996
	speed: 0.0177s/iter; left time: 145.7270s
	iters: 400, epoch: 6 | loss: 0.0885342
	speed: 0.0176s/iter; left time: 143.2092s
	iters: 500, epoch: 6 | loss: 0.0566523
	speed: 0.0176s/iter; left time: 141.3406s
Epoch: 6 cost time: 10.375487089157104
Epoch: 6, Steps: 570 | Train Loss: 0.0635844 Vali Loss: 0.0332794 Test Loss: 0.1336828
Validation loss decreased (0.033511 --> 0.033279).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0589511
	speed: 0.0541s/iter; left time: 426.1673s
	iters: 200, epoch: 7 | loss: 0.0571943
	speed: 0.0173s/iter; left time: 134.8977s
	iters: 300, epoch: 7 | loss: 0.0717927
	speed: 0.0174s/iter; left time: 133.4002s
	iters: 400, epoch: 7 | loss: 0.0719622
	speed: 0.0173s/iter; left time: 131.5209s
	iters: 500, epoch: 7 | loss: 0.0520488
	speed: 0.0173s/iter; left time: 129.6660s
Epoch: 7 cost time: 10.209954977035522
Epoch: 7, Steps: 570 | Train Loss: 0.0611406 Vali Loss: 0.0330539 Test Loss: 0.1343281
Validation loss decreased (0.033279 --> 0.033054).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0647300
	speed: 0.0559s/iter; left time: 408.9592s
	iters: 200, epoch: 8 | loss: 0.0595467
	speed: 0.0174s/iter; left time: 125.3827s
	iters: 300, epoch: 8 | loss: 0.0460011
	speed: 0.0174s/iter; left time: 123.5962s
	iters: 400, epoch: 8 | loss: 0.0597768
	speed: 0.0174s/iter; left time: 121.7682s
	iters: 500, epoch: 8 | loss: 0.0478682
	speed: 0.0174s/iter; left time: 120.2670s
Epoch: 8 cost time: 10.2029128074646
Epoch: 8, Steps: 570 | Train Loss: 0.0599008 Vali Loss: 0.0333627 Test Loss: 0.1343927
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0450619
	speed: 0.0546s/iter; left time: 368.0485s
	iters: 200, epoch: 9 | loss: 0.0991942
	speed: 0.0175s/iter; left time: 116.1873s
	iters: 300, epoch: 9 | loss: 0.0457475
	speed: 0.0175s/iter; left time: 114.2416s
	iters: 400, epoch: 9 | loss: 0.0412745
	speed: 0.0175s/iter; left time: 112.7635s
	iters: 500, epoch: 9 | loss: 0.0411304
	speed: 0.0175s/iter; left time: 110.8356s
Epoch: 9 cost time: 10.235085725784302
Epoch: 9, Steps: 570 | Train Loss: 0.0593183 Vali Loss: 0.0332272 Test Loss: 0.1348051
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0575047
	speed: 0.0539s/iter; left time: 332.7027s
	iters: 200, epoch: 10 | loss: 0.0695797
	speed: 0.0175s/iter; left time: 106.3958s
	iters: 300, epoch: 10 | loss: 0.0439022
	speed: 0.0175s/iter; left time: 104.7765s
	iters: 400, epoch: 10 | loss: 0.0652481
	speed: 0.0175s/iter; left time: 102.5244s
	iters: 500, epoch: 10 | loss: 0.0322872
	speed: 0.0174s/iter; left time: 100.5017s
Epoch: 10 cost time: 10.23813009262085
Epoch: 10, Steps: 570 | Train Loss: 0.0589843 Vali Loss: 0.0331905 Test Loss: 0.1361058
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13452480733394623, mae:0.23368285596370697
>>> MS_Raw LR=1e-4 DO=0.0 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3226862
	speed: 0.0319s/iter; left time: 360.0955s
	iters: 200, epoch: 1 | loss: 0.1668440
	speed: 0.0194s/iter; left time: 216.7467s
	iters: 300, epoch: 1 | loss: 0.1776613
	speed: 0.0194s/iter; left time: 214.8577s
	iters: 400, epoch: 1 | loss: 0.1115717
	speed: 0.0193s/iter; left time: 212.8579s
	iters: 500, epoch: 1 | loss: 0.1671815
	speed: 0.0193s/iter; left time: 210.2350s
Epoch: 1 cost time: 12.325745820999146
Epoch: 1, Steps: 570 | Train Loss: 0.1464359 Vali Loss: 0.0346369 Test Loss: 0.1122974
Validation loss decreased (inf --> 0.034637).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0989168
	speed: 0.0596s/iter; left time: 639.8026s
	iters: 200, epoch: 2 | loss: 0.1485835
	speed: 0.0193s/iter; left time: 205.4311s
	iters: 300, epoch: 2 | loss: 0.1692001
	speed: 0.0194s/iter; left time: 203.8674s
	iters: 400, epoch: 2 | loss: 0.0990008
	speed: 0.0193s/iter; left time: 201.6355s
	iters: 500, epoch: 2 | loss: 0.0971779
	speed: 0.0193s/iter; left time: 199.2737s
Epoch: 2 cost time: 11.299652099609375
Epoch: 2, Steps: 570 | Train Loss: 0.1085422 Vali Loss: 0.0356164 Test Loss: 0.1155539
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0768530
	speed: 0.0547s/iter; left time: 555.5238s
	iters: 200, epoch: 3 | loss: 0.0811924
	speed: 0.0172s/iter; left time: 173.0455s
	iters: 300, epoch: 3 | loss: 0.0978360
	speed: 0.0172s/iter; left time: 171.4733s
	iters: 400, epoch: 3 | loss: 0.0615743
	speed: 0.0172s/iter; left time: 169.3309s
	iters: 500, epoch: 3 | loss: 0.0687462
	speed: 0.0172s/iter; left time: 167.9282s
Epoch: 3 cost time: 10.118266582489014
Epoch: 3, Steps: 570 | Train Loss: 0.0823146 Vali Loss: 0.0338312 Test Loss: 0.1130264
Validation loss decreased (0.034637 --> 0.033831).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0664183
	speed: 0.0561s/iter; left time: 538.1572s
	iters: 200, epoch: 4 | loss: 0.0526979
	speed: 0.0174s/iter; left time: 164.8075s
	iters: 300, epoch: 4 | loss: 0.0824772
	speed: 0.0174s/iter; left time: 163.0750s
	iters: 400, epoch: 4 | loss: 0.0836798
	speed: 0.0173s/iter; left time: 161.1172s
	iters: 500, epoch: 4 | loss: 0.0645510
	speed: 0.0173s/iter; left time: 159.3963s
Epoch: 4 cost time: 10.178994417190552
Epoch: 4, Steps: 570 | Train Loss: 0.0654951 Vali Loss: 0.0329143 Test Loss: 0.1138199
Validation loss decreased (0.033831 --> 0.032914).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0522060
	speed: 0.0538s/iter; left time: 485.1043s
	iters: 200, epoch: 5 | loss: 0.0592664
	speed: 0.0173s/iter; left time: 154.4763s
	iters: 300, epoch: 5 | loss: 0.0512895
	speed: 0.0173s/iter; left time: 152.6519s
	iters: 400, epoch: 5 | loss: 0.0640452
	speed: 0.0173s/iter; left time: 150.9601s
	iters: 500, epoch: 5 | loss: 0.0600721
	speed: 0.0174s/iter; left time: 149.6142s
Epoch: 5 cost time: 10.197610855102539
Epoch: 5, Steps: 570 | Train Loss: 0.0567611 Vali Loss: 0.0334743 Test Loss: 0.1158179
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0593614
	speed: 0.0549s/iter; left time: 464.0521s
	iters: 200, epoch: 6 | loss: 0.0394505
	speed: 0.0173s/iter; left time: 144.6482s
	iters: 300, epoch: 6 | loss: 0.0592579
	speed: 0.0172s/iter; left time: 142.0771s
	iters: 400, epoch: 6 | loss: 0.0466528
	speed: 0.0172s/iter; left time: 140.1865s
	iters: 500, epoch: 6 | loss: 0.0352588
	speed: 0.0172s/iter; left time: 138.5569s
Epoch: 6 cost time: 10.125632524490356
Epoch: 6, Steps: 570 | Train Loss: 0.0526633 Vali Loss: 0.0331158 Test Loss: 0.1148413
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0470458
	speed: 0.0546s/iter; left time: 429.9817s
	iters: 200, epoch: 7 | loss: 0.0658160
	speed: 0.0171s/iter; left time: 133.1356s
	iters: 300, epoch: 7 | loss: 0.0436879
	speed: 0.0171s/iter; left time: 131.5744s
	iters: 400, epoch: 7 | loss: 0.0596417
	speed: 0.0171s/iter; left time: 129.8077s
	iters: 500, epoch: 7 | loss: 0.0392330
	speed: 0.0171s/iter; left time: 127.9699s
Epoch: 7 cost time: 10.043862104415894
Epoch: 7, Steps: 570 | Train Loss: 0.0504884 Vali Loss: 0.0333423 Test Loss: 0.1157486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11395978182554245, mae:0.20874567329883575
>>> MS_Raw LR=1e-4 DO=0.0 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2526689
	speed: 0.0291s/iter; left time: 329.0484s
	iters: 200, epoch: 1 | loss: 0.1506011
	speed: 0.0173s/iter; left time: 194.1204s
	iters: 300, epoch: 1 | loss: 0.1895043
	speed: 0.0172s/iter; left time: 191.4388s
	iters: 400, epoch: 1 | loss: 0.1955848
	speed: 0.0172s/iter; left time: 189.3322s
	iters: 500, epoch: 1 | loss: 0.2660136
	speed: 0.0172s/iter; left time: 187.8859s
Epoch: 1 cost time: 11.075180768966675
Epoch: 1, Steps: 570 | Train Loss: 0.1832555 Vali Loss: 0.0414752 Test Loss: 0.1353214
Validation loss decreased (inf --> 0.041475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1894857
	speed: 0.0541s/iter; left time: 580.1729s
	iters: 200, epoch: 2 | loss: 0.2140321
	speed: 0.0172s/iter; left time: 182.9506s
	iters: 300, epoch: 2 | loss: 0.2231693
	speed: 0.0172s/iter; left time: 181.4170s
	iters: 400, epoch: 2 | loss: 0.1023709
	speed: 0.0173s/iter; left time: 179.9714s
	iters: 500, epoch: 2 | loss: 0.0706140
	speed: 0.0172s/iter; left time: 178.1345s
Epoch: 2 cost time: 10.115846395492554
Epoch: 2, Steps: 570 | Train Loss: 0.1284721 Vali Loss: 0.0430929 Test Loss: 0.1399398
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1038830
	speed: 0.0528s/iter; left time: 536.8172s
	iters: 200, epoch: 3 | loss: 0.1072234
	speed: 0.0172s/iter; left time: 172.8929s
	iters: 300, epoch: 3 | loss: 0.0985372
	speed: 0.0172s/iter; left time: 171.3353s
	iters: 400, epoch: 3 | loss: 0.0693403
	speed: 0.0172s/iter; left time: 169.6513s
	iters: 500, epoch: 3 | loss: 0.0678159
	speed: 0.0172s/iter; left time: 168.2053s
Epoch: 3 cost time: 10.080064535140991
Epoch: 3, Steps: 570 | Train Loss: 0.0921640 Vali Loss: 0.0411940 Test Loss: 0.1413373
Validation loss decreased (0.041475 --> 0.041194).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0639332
	speed: 0.0551s/iter; left time: 528.1277s
	iters: 200, epoch: 4 | loss: 0.0903152
	speed: 0.0171s/iter; left time: 162.3062s
	iters: 300, epoch: 4 | loss: 0.0720685
	speed: 0.0171s/iter; left time: 160.3109s
	iters: 400, epoch: 4 | loss: 0.0802401
	speed: 0.0171s/iter; left time: 158.6333s
	iters: 500, epoch: 4 | loss: 0.0611074
	speed: 0.0171s/iter; left time: 157.1239s
Epoch: 4 cost time: 10.018308162689209
Epoch: 4, Steps: 570 | Train Loss: 0.0717763 Vali Loss: 0.0385932 Test Loss: 0.1380353
Validation loss decreased (0.041194 --> 0.038593).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0552789
	speed: 0.0539s/iter; left time: 486.2962s
	iters: 200, epoch: 5 | loss: 0.0573784
	speed: 0.0171s/iter; left time: 152.8282s
	iters: 300, epoch: 5 | loss: 0.0559159
	speed: 0.0171s/iter; left time: 150.8818s
	iters: 400, epoch: 5 | loss: 0.0563369
	speed: 0.0171s/iter; left time: 149.1398s
	iters: 500, epoch: 5 | loss: 0.0454566
	speed: 0.0171s/iter; left time: 147.7469s
Epoch: 5 cost time: 10.02873969078064
Epoch: 5, Steps: 570 | Train Loss: 0.0615526 Vali Loss: 0.0402327 Test Loss: 0.1463692
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0563857
	speed: 0.0525s/iter; left time: 443.7752s
	iters: 200, epoch: 6 | loss: 0.0544896
	speed: 0.0172s/iter; left time: 143.2817s
	iters: 300, epoch: 6 | loss: 0.0795186
	speed: 0.0171s/iter; left time: 141.3800s
	iters: 400, epoch: 6 | loss: 0.0644698
	speed: 0.0172s/iter; left time: 139.9765s
	iters: 500, epoch: 6 | loss: 0.0572942
	speed: 0.0172s/iter; left time: 138.2683s
Epoch: 6 cost time: 10.033161878585815
Epoch: 6, Steps: 570 | Train Loss: 0.0564596 Vali Loss: 0.0390845 Test Loss: 0.1458327
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0485623
	speed: 0.0542s/iter; left time: 427.2893s
	iters: 200, epoch: 7 | loss: 0.0468063
	speed: 0.0173s/iter; left time: 134.7346s
	iters: 300, epoch: 7 | loss: 0.0684707
	speed: 0.0174s/iter; left time: 133.2757s
	iters: 400, epoch: 7 | loss: 0.0643950
	speed: 0.0173s/iter; left time: 131.1428s
	iters: 500, epoch: 7 | loss: 0.0415587
	speed: 0.0173s/iter; left time: 129.7239s
Epoch: 7 cost time: 10.119400262832642
Epoch: 7, Steps: 570 | Train Loss: 0.0539953 Vali Loss: 0.0394990 Test Loss: 0.1465579
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13822001218795776, mae:0.23914697766304016
>>> MS_Raw LR=1e-4 DO=0.0 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1888228
	speed: 0.0329s/iter; left time: 371.8807s
	iters: 200, epoch: 1 | loss: 0.1582943
	speed: 0.0213s/iter; left time: 238.4095s
	iters: 300, epoch: 1 | loss: 0.1563228
	speed: 0.0213s/iter; left time: 236.4062s
	iters: 400, epoch: 1 | loss: 0.2523674
	speed: 0.0213s/iter; left time: 234.0944s
	iters: 500, epoch: 1 | loss: 0.2365478
	speed: 0.0213s/iter; left time: 232.4330s
Epoch: 1 cost time: 13.353864192962646
Epoch: 1, Steps: 570 | Train Loss: 0.1755242 Vali Loss: 0.0442618 Test Loss: 0.1377467
Validation loss decreased (inf --> 0.044262).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1871693
	speed: 0.0620s/iter; left time: 665.7432s
	iters: 200, epoch: 2 | loss: 0.0924348
	speed: 0.0213s/iter; left time: 226.5256s
	iters: 300, epoch: 2 | loss: 0.1252180
	speed: 0.0213s/iter; left time: 224.2497s
	iters: 400, epoch: 2 | loss: 0.1210898
	speed: 0.0213s/iter; left time: 222.2999s
	iters: 500, epoch: 2 | loss: 0.0729622
	speed: 0.0213s/iter; left time: 220.0139s
Epoch: 2 cost time: 12.458402633666992
Epoch: 2, Steps: 570 | Train Loss: 0.1170748 Vali Loss: 0.0391907 Test Loss: 0.1344381
Validation loss decreased (0.044262 --> 0.039191).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0959562
	speed: 0.0628s/iter; left time: 638.0737s
	iters: 200, epoch: 3 | loss: 0.0675417
	speed: 0.0213s/iter; left time: 214.5057s
	iters: 300, epoch: 3 | loss: 0.0984169
	speed: 0.0213s/iter; left time: 212.3308s
	iters: 400, epoch: 3 | loss: 0.0519896
	speed: 0.0213s/iter; left time: 210.2496s
	iters: 500, epoch: 3 | loss: 0.0565442
	speed: 0.0213s/iter; left time: 208.0856s
Epoch: 3 cost time: 12.464117050170898
Epoch: 3, Steps: 570 | Train Loss: 0.0725646 Vali Loss: 0.0358213 Test Loss: 0.1385621
Validation loss decreased (0.039191 --> 0.035821).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0500028
	speed: 0.0619s/iter; left time: 593.8470s
	iters: 200, epoch: 4 | loss: 0.0390338
	speed: 0.0214s/iter; left time: 202.8456s
	iters: 300, epoch: 4 | loss: 0.0459121
	speed: 0.0214s/iter; left time: 200.7764s
	iters: 400, epoch: 4 | loss: 0.0498361
	speed: 0.0214s/iter; left time: 198.6022s
	iters: 500, epoch: 4 | loss: 0.0820427
	speed: 0.0214s/iter; left time: 196.6461s
Epoch: 4 cost time: 12.482069969177246
Epoch: 4, Steps: 570 | Train Loss: 0.0506902 Vali Loss: 0.0382494 Test Loss: 0.1395986
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0575483
	speed: 0.0598s/iter; left time: 539.8806s
	iters: 200, epoch: 5 | loss: 0.0359831
	speed: 0.0213s/iter; left time: 189.9874s
	iters: 300, epoch: 5 | loss: 0.0293592
	speed: 0.0213s/iter; left time: 187.9840s
	iters: 400, epoch: 5 | loss: 0.0327550
	speed: 0.0213s/iter; left time: 185.7937s
	iters: 500, epoch: 5 | loss: 0.0358799
	speed: 0.0213s/iter; left time: 183.5747s
Epoch: 5 cost time: 12.390175819396973
Epoch: 5, Steps: 570 | Train Loss: 0.0410975 Vali Loss: 0.0380475 Test Loss: 0.1372982
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0283897
	speed: 0.0610s/iter; left time: 515.1128s
	iters: 200, epoch: 6 | loss: 0.0320395
	speed: 0.0214s/iter; left time: 178.6322s
	iters: 300, epoch: 6 | loss: 0.0325276
	speed: 0.0213s/iter; left time: 176.0243s
	iters: 400, epoch: 6 | loss: 0.0307756
	speed: 0.0213s/iter; left time: 173.9089s
	iters: 500, epoch: 6 | loss: 0.0497869
	speed: 0.0213s/iter; left time: 171.7391s
Epoch: 6 cost time: 12.450729846954346
Epoch: 6, Steps: 570 | Train Loss: 0.0364597 Vali Loss: 0.0385614 Test Loss: 0.1396468
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13873861730098724, mae:0.24120382964611053
>>> MS_Raw LR=1e-4 DO=0.0 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1323162
	speed: 0.0340s/iter; left time: 384.0102s
	iters: 200, epoch: 1 | loss: 0.0824137
	speed: 0.0206s/iter; left time: 231.2178s
	iters: 300, epoch: 1 | loss: 0.1541070
	speed: 0.0207s/iter; left time: 229.3084s
	iters: 400, epoch: 1 | loss: 0.1056086
	speed: 0.0207s/iter; left time: 227.3436s
	iters: 500, epoch: 1 | loss: 0.1541315
	speed: 0.0206s/iter; left time: 224.7437s
Epoch: 1 cost time: 13.160211086273193
Epoch: 1, Steps: 570 | Train Loss: 0.1440308 Vali Loss: 0.0353116 Test Loss: 0.1119556
Validation loss decreased (inf --> 0.035312).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1237014
	speed: 0.0623s/iter; left time: 668.9796s
	iters: 200, epoch: 2 | loss: 0.0813918
	speed: 0.0207s/iter; left time: 219.9384s
	iters: 300, epoch: 2 | loss: 0.1027531
	speed: 0.0207s/iter; left time: 217.7200s
	iters: 400, epoch: 2 | loss: 0.0933123
	speed: 0.0207s/iter; left time: 215.7011s
	iters: 500, epoch: 2 | loss: 0.0625068
	speed: 0.0207s/iter; left time: 213.8200s
Epoch: 2 cost time: 12.10452914237976
Epoch: 2, Steps: 570 | Train Loss: 0.0988597 Vali Loss: 0.0343631 Test Loss: 0.1173671
Validation loss decreased (0.035312 --> 0.034363).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0641420
	speed: 0.0615s/iter; left time: 624.9767s
	iters: 200, epoch: 3 | loss: 0.0536526
	speed: 0.0207s/iter; left time: 208.6071s
	iters: 300, epoch: 3 | loss: 0.0694883
	speed: 0.0208s/iter; left time: 206.7894s
	iters: 400, epoch: 3 | loss: 0.0559392
	speed: 0.0208s/iter; left time: 204.6441s
	iters: 500, epoch: 3 | loss: 0.0553465
	speed: 0.0208s/iter; left time: 202.6980s
Epoch: 3 cost time: 12.166207075119019
Epoch: 3, Steps: 570 | Train Loss: 0.0621782 Vali Loss: 0.0342525 Test Loss: 0.1219186
Validation loss decreased (0.034363 --> 0.034253).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0366462
	speed: 0.0651s/iter; left time: 624.5169s
	iters: 200, epoch: 4 | loss: 0.0427919
	speed: 0.0208s/iter; left time: 197.3934s
	iters: 300, epoch: 4 | loss: 0.0457355
	speed: 0.0208s/iter; left time: 195.5836s
	iters: 400, epoch: 4 | loss: 0.0432367
	speed: 0.0208s/iter; left time: 193.2059s
	iters: 500, epoch: 4 | loss: 0.0349271
	speed: 0.0208s/iter; left time: 191.1193s
Epoch: 4 cost time: 12.16149377822876
Epoch: 4, Steps: 570 | Train Loss: 0.0436198 Vali Loss: 0.0343519 Test Loss: 0.1205175
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0357755
	speed: 0.0603s/iter; left time: 544.0857s
	iters: 200, epoch: 5 | loss: 0.0355270
	speed: 0.0207s/iter; left time: 184.8702s
	iters: 300, epoch: 5 | loss: 0.0306037
	speed: 0.0207s/iter; left time: 182.8750s
	iters: 400, epoch: 5 | loss: 0.0420264
	speed: 0.0207s/iter; left time: 180.5179s
	iters: 500, epoch: 5 | loss: 0.0385151
	speed: 0.0207s/iter; left time: 178.5519s
Epoch: 5 cost time: 12.084835052490234
Epoch: 5, Steps: 570 | Train Loss: 0.0357689 Vali Loss: 0.0346102 Test Loss: 0.1223844
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0234594
	speed: 0.0612s/iter; left time: 516.8610s
	iters: 200, epoch: 6 | loss: 0.0269406
	speed: 0.0208s/iter; left time: 173.5291s
	iters: 300, epoch: 6 | loss: 0.0281651
	speed: 0.0207s/iter; left time: 171.1807s
	iters: 400, epoch: 6 | loss: 0.0390316
	speed: 0.0207s/iter; left time: 169.1198s
	iters: 500, epoch: 6 | loss: 0.0268994
	speed: 0.0207s/iter; left time: 167.0232s
Epoch: 6 cost time: 12.129702806472778
Epoch: 6, Steps: 570 | Train Loss: 0.0320021 Vali Loss: 0.0347968 Test Loss: 0.1230432
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12209206074476242, mae:0.2197163850069046
>>> MS_Raw LR=1e-4 DO=0.0 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1993479
	speed: 0.0330s/iter; left time: 372.3866s
	iters: 200, epoch: 1 | loss: 0.1782197
	speed: 0.0209s/iter; left time: 233.9479s
	iters: 300, epoch: 1 | loss: 0.1975592
	speed: 0.0209s/iter; left time: 232.5591s
	iters: 400, epoch: 1 | loss: 0.2005119
	speed: 0.0211s/iter; left time: 231.6793s
	iters: 500, epoch: 1 | loss: 0.1762355
	speed: 0.0210s/iter; left time: 228.9403s
Epoch: 1 cost time: 13.21158504486084
Epoch: 1, Steps: 570 | Train Loss: 0.1741566 Vali Loss: 0.0434220 Test Loss: 0.1350538
Validation loss decreased (inf --> 0.043422).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0638883
	speed: 0.0607s/iter; left time: 651.8636s
	iters: 200, epoch: 2 | loss: 0.1771397
	speed: 0.0190s/iter; left time: 201.9040s
	iters: 300, epoch: 2 | loss: 0.0777541
	speed: 0.0190s/iter; left time: 199.9582s
	iters: 400, epoch: 2 | loss: 0.0867392
	speed: 0.0190s/iter; left time: 198.3093s
	iters: 500, epoch: 2 | loss: 0.0822950
	speed: 0.0190s/iter; left time: 196.2843s
Epoch: 2 cost time: 11.143260955810547
Epoch: 2, Steps: 570 | Train Loss: 0.1135138 Vali Loss: 0.0410773 Test Loss: 0.1439481
Validation loss decreased (0.043422 --> 0.041077).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0571769
	speed: 0.0595s/iter; left time: 604.7378s
	iters: 200, epoch: 3 | loss: 0.0578771
	speed: 0.0201s/iter; left time: 202.4746s
	iters: 300, epoch: 3 | loss: 0.0776076
	speed: 0.0190s/iter; left time: 189.3876s
	iters: 400, epoch: 3 | loss: 0.0569135
	speed: 0.0190s/iter; left time: 187.2752s
	iters: 500, epoch: 3 | loss: 0.0758753
	speed: 0.0190s/iter; left time: 185.0769s
Epoch: 3 cost time: 11.44015121459961
Epoch: 3, Steps: 570 | Train Loss: 0.0699668 Vali Loss: 0.0388080 Test Loss: 0.1375320
Validation loss decreased (0.041077 --> 0.038808).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0319529
	speed: 0.0589s/iter; left time: 564.6715s
	iters: 200, epoch: 4 | loss: 0.0382339
	speed: 0.0190s/iter; left time: 180.4305s
	iters: 300, epoch: 4 | loss: 0.0422708
	speed: 0.0190s/iter; left time: 178.5332s
	iters: 400, epoch: 4 | loss: 0.0494687
	speed: 0.0190s/iter; left time: 176.4884s
	iters: 500, epoch: 4 | loss: 0.0360663
	speed: 0.0190s/iter; left time: 174.5416s
Epoch: 4 cost time: 11.113801002502441
Epoch: 4, Steps: 570 | Train Loss: 0.0483091 Vali Loss: 0.0379723 Test Loss: 0.1417125
Validation loss decreased (0.038808 --> 0.037972).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0414709
	speed: 0.0567s/iter; left time: 511.5868s
	iters: 200, epoch: 5 | loss: 0.0288012
	speed: 0.0190s/iter; left time: 169.4945s
	iters: 300, epoch: 5 | loss: 0.0336405
	speed: 0.0190s/iter; left time: 167.4783s
	iters: 400, epoch: 5 | loss: 0.0298387
	speed: 0.0190s/iter; left time: 165.2905s
	iters: 500, epoch: 5 | loss: 0.0345208
	speed: 0.0190s/iter; left time: 163.8699s
Epoch: 5 cost time: 11.120320796966553
Epoch: 5, Steps: 570 | Train Loss: 0.0384476 Vali Loss: 0.0387255 Test Loss: 0.1445214
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0388057
	speed: 0.0585s/iter; left time: 494.5839s
	iters: 200, epoch: 6 | loss: 0.0374171
	speed: 0.0190s/iter; left time: 158.2572s
	iters: 300, epoch: 6 | loss: 0.0292357
	speed: 0.0189s/iter; left time: 156.2907s
	iters: 400, epoch: 6 | loss: 0.0309061
	speed: 0.0190s/iter; left time: 154.5969s
	iters: 500, epoch: 6 | loss: 0.0376697
	speed: 0.0191s/iter; left time: 153.4469s
Epoch: 6 cost time: 11.10156512260437
Epoch: 6, Steps: 570 | Train Loss: 0.0338836 Vali Loss: 0.0390634 Test Loss: 0.1482659
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0233778
	speed: 0.0568s/iter; left time: 447.7405s
	iters: 200, epoch: 7 | loss: 0.0288248
	speed: 0.0190s/iter; left time: 148.1017s
	iters: 300, epoch: 7 | loss: 0.0329367
	speed: 0.0190s/iter; left time: 146.1680s
	iters: 400, epoch: 7 | loss: 0.0305000
	speed: 0.0190s/iter; left time: 144.2380s
	iters: 500, epoch: 7 | loss: 0.0248829
	speed: 0.0190s/iter; left time: 142.3568s
Epoch: 7 cost time: 11.125111818313599
Epoch: 7, Steps: 570 | Train Loss: 0.0316444 Vali Loss: 0.0388381 Test Loss: 0.1495141
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14190757274627686, mae:0.24510309100151062
>>> MS_Raw LR=1e-4 DO=0.1 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1661820
	speed: 0.0233s/iter; left time: 263.0459s
	iters: 200, epoch: 1 | loss: 0.1882960
	speed: 0.0106s/iter; left time: 118.3588s
	iters: 300, epoch: 1 | loss: 0.2432883
	speed: 0.0106s/iter; left time: 117.9925s
	iters: 400, epoch: 1 | loss: 0.2106672
	speed: 0.0106s/iter; left time: 116.8500s
	iters: 500, epoch: 1 | loss: 0.1615628
	speed: 0.0106s/iter; left time: 115.5393s
Epoch: 1 cost time: 7.362395524978638
Epoch: 1, Steps: 570 | Train Loss: 0.2132680 Vali Loss: 0.0489154 Test Loss: 0.1486931
Validation loss decreased (inf --> 0.048915).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2554823
	speed: 0.0361s/iter; left time: 387.5290s
	iters: 200, epoch: 2 | loss: 0.2682980
	speed: 0.0106s/iter; left time: 112.4600s
	iters: 300, epoch: 2 | loss: 0.1647600
	speed: 0.0106s/iter; left time: 111.4330s
	iters: 400, epoch: 2 | loss: 0.1572925
	speed: 0.0106s/iter; left time: 110.5474s
	iters: 500, epoch: 2 | loss: 0.1673287
	speed: 0.0106s/iter; left time: 109.4064s
Epoch: 2 cost time: 6.3213348388671875
Epoch: 2, Steps: 570 | Train Loss: 0.1726924 Vali Loss: 0.0418939 Test Loss: 0.1265778
Validation loss decreased (0.048915 --> 0.041894).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1181338
	speed: 0.0361s/iter; left time: 367.2057s
	iters: 200, epoch: 3 | loss: 0.2001222
	speed: 0.0106s/iter; left time: 106.6352s
	iters: 300, epoch: 3 | loss: 0.1377586
	speed: 0.0106s/iter; left time: 105.4868s
	iters: 400, epoch: 3 | loss: 0.1699878
	speed: 0.0106s/iter; left time: 104.3782s
	iters: 500, epoch: 3 | loss: 0.2055827
	speed: 0.0106s/iter; left time: 103.4245s
Epoch: 3 cost time: 6.321676254272461
Epoch: 3, Steps: 570 | Train Loss: 0.1537922 Vali Loss: 0.0383821 Test Loss: 0.1203843
Validation loss decreased (0.041894 --> 0.038382).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1481126
	speed: 0.0360s/iter; left time: 344.8010s
	iters: 200, epoch: 4 | loss: 0.0932456
	speed: 0.0105s/iter; left time: 100.0159s
	iters: 300, epoch: 4 | loss: 0.1380324
	speed: 0.0105s/iter; left time: 98.9608s
	iters: 400, epoch: 4 | loss: 0.1560184
	speed: 0.0105s/iter; left time: 97.8863s
	iters: 500, epoch: 4 | loss: 0.1368372
	speed: 0.0105s/iter; left time: 96.8045s
Epoch: 4 cost time: 6.269501686096191
Epoch: 4, Steps: 570 | Train Loss: 0.1447483 Vali Loss: 0.0380562 Test Loss: 0.1202246
Validation loss decreased (0.038382 --> 0.038056).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1547439
	speed: 0.0370s/iter; left time: 333.4423s
	iters: 200, epoch: 5 | loss: 0.1538793
	speed: 0.0119s/iter; left time: 106.0626s
	iters: 300, epoch: 5 | loss: 0.1062656
	speed: 0.0115s/iter; left time: 101.4682s
	iters: 400, epoch: 5 | loss: 0.1278121
	speed: 0.0107s/iter; left time: 92.9621s
	iters: 500, epoch: 5 | loss: 0.1534337
	speed: 0.0106s/iter; left time: 91.3548s
Epoch: 5 cost time: 6.673305988311768
Epoch: 5, Steps: 570 | Train Loss: 0.1410183 Vali Loss: 0.0372186 Test Loss: 0.1193272
Validation loss decreased (0.038056 --> 0.037219).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1385755
	speed: 0.0360s/iter; left time: 303.8418s
	iters: 200, epoch: 6 | loss: 0.0998583
	speed: 0.0105s/iter; left time: 88.0803s
	iters: 300, epoch: 6 | loss: 0.1453860
	speed: 0.0106s/iter; left time: 87.1290s
	iters: 400, epoch: 6 | loss: 0.1546631
	speed: 0.0106s/iter; left time: 86.0503s
	iters: 500, epoch: 6 | loss: 0.1294211
	speed: 0.0106s/iter; left time: 85.3020s
Epoch: 6 cost time: 6.314205884933472
Epoch: 6, Steps: 570 | Train Loss: 0.1377903 Vali Loss: 0.0368099 Test Loss: 0.1188920
Validation loss decreased (0.037219 --> 0.036810).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1413189
	speed: 0.0364s/iter; left time: 286.5754s
	iters: 200, epoch: 7 | loss: 0.2008557
	speed: 0.0106s/iter; left time: 82.2483s
	iters: 300, epoch: 7 | loss: 0.1179606
	speed: 0.0106s/iter; left time: 81.1154s
	iters: 400, epoch: 7 | loss: 0.1264820
	speed: 0.0106s/iter; left time: 80.2063s
	iters: 500, epoch: 7 | loss: 0.1174680
	speed: 0.0106s/iter; left time: 79.0427s
Epoch: 7 cost time: 6.318687438964844
Epoch: 7, Steps: 570 | Train Loss: 0.1374366 Vali Loss: 0.0371287 Test Loss: 0.1191760
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1442029
	speed: 0.0364s/iter; left time: 266.2926s
	iters: 200, epoch: 8 | loss: 0.1226638
	speed: 0.0106s/iter; left time: 76.1657s
	iters: 300, epoch: 8 | loss: 0.1857536
	speed: 0.0106s/iter; left time: 75.2314s
	iters: 400, epoch: 8 | loss: 0.1947010
	speed: 0.0106s/iter; left time: 74.3539s
	iters: 500, epoch: 8 | loss: 0.1027075
	speed: 0.0106s/iter; left time: 73.1563s
Epoch: 8 cost time: 6.271077871322632
Epoch: 8, Steps: 570 | Train Loss: 0.1363312 Vali Loss: 0.0368068 Test Loss: 0.1189497
Validation loss decreased (0.036810 --> 0.036807).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1744780
	speed: 0.0357s/iter; left time: 240.6657s
	iters: 200, epoch: 9 | loss: 0.1239212
	speed: 0.0106s/iter; left time: 70.3702s
	iters: 300, epoch: 9 | loss: 0.0659825
	speed: 0.0105s/iter; left time: 68.6590s
	iters: 400, epoch: 9 | loss: 0.1558087
	speed: 0.0105s/iter; left time: 67.8840s
	iters: 500, epoch: 9 | loss: 0.1267672
	speed: 0.0105s/iter; left time: 66.8014s
Epoch: 9 cost time: 6.310453176498413
Epoch: 9, Steps: 570 | Train Loss: 0.1359967 Vali Loss: 0.0371288 Test Loss: 0.1191462
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1579017
	speed: 0.0380s/iter; left time: 234.5303s
	iters: 200, epoch: 10 | loss: 0.1459462
	speed: 0.0105s/iter; left time: 63.5606s
	iters: 300, epoch: 10 | loss: 0.1129273
	speed: 0.0105s/iter; left time: 62.5647s
	iters: 400, epoch: 10 | loss: 0.1299830
	speed: 0.0105s/iter; left time: 61.4433s
	iters: 500, epoch: 10 | loss: 0.1774755
	speed: 0.0105s/iter; left time: 60.3592s
Epoch: 10 cost time: 6.255577802658081
Epoch: 10, Steps: 570 | Train Loss: 0.1356069 Vali Loss: 0.0369601 Test Loss: 0.1190087
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1467692
	speed: 0.0361s/iter; left time: 202.0201s
	iters: 200, epoch: 11 | loss: 0.1327035
	speed: 0.0105s/iter; left time: 57.5725s
	iters: 300, epoch: 11 | loss: 0.1024538
	speed: 0.0105s/iter; left time: 56.5355s
	iters: 400, epoch: 11 | loss: 0.1856325
	speed: 0.0105s/iter; left time: 55.7198s
	iters: 500, epoch: 11 | loss: 0.1188164
	speed: 0.0105s/iter; left time: 54.8210s
Epoch: 11 cost time: 6.284163475036621
Epoch: 11, Steps: 570 | Train Loss: 0.1367319 Vali Loss: 0.0368543 Test Loss: 0.1190960
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1191156804561615, mae:0.21371115744113922
>>> MS_Raw LR=1e-4 DO=0.1 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1632898
	speed: 0.0236s/iter; left time: 266.7123s
	iters: 200, epoch: 1 | loss: 0.1962866
	speed: 0.0116s/iter; left time: 129.5483s
	iters: 300, epoch: 1 | loss: 0.2366278
	speed: 0.0115s/iter; left time: 127.9718s
	iters: 400, epoch: 1 | loss: 0.1839257
	speed: 0.0104s/iter; left time: 114.6947s
	iters: 500, epoch: 1 | loss: 0.1764508
	speed: 0.0115s/iter; left time: 125.6106s
Epoch: 1 cost time: 7.723623275756836
Epoch: 1, Steps: 570 | Train Loss: 0.1842088 Vali Loss: 0.0355790 Test Loss: 0.1113996
Validation loss decreased (inf --> 0.035579).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1228776
	speed: 0.0370s/iter; left time: 397.4505s
	iters: 200, epoch: 2 | loss: 0.1663849
	speed: 0.0102s/iter; left time: 108.7856s
	iters: 300, epoch: 2 | loss: 0.1062605
	speed: 0.0103s/iter; left time: 108.0413s
	iters: 400, epoch: 2 | loss: 0.1292071
	speed: 0.0102s/iter; left time: 106.6265s
	iters: 500, epoch: 2 | loss: 0.1493803
	speed: 0.0102s/iter; left time: 105.6319s
Epoch: 2 cost time: 6.11694860458374
Epoch: 2, Steps: 570 | Train Loss: 0.1527847 Vali Loss: 0.0330815 Test Loss: 0.1088629
Validation loss decreased (0.035579 --> 0.033082).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0841182
	speed: 0.0367s/iter; left time: 373.3422s
	iters: 200, epoch: 3 | loss: 0.1208962
	speed: 0.0103s/iter; left time: 103.9192s
	iters: 300, epoch: 3 | loss: 0.2659534
	speed: 0.0103s/iter; left time: 102.8344s
	iters: 400, epoch: 3 | loss: 0.1304747
	speed: 0.0103s/iter; left time: 101.9037s
	iters: 500, epoch: 3 | loss: 0.1050824
	speed: 0.0103s/iter; left time: 100.3993s
Epoch: 3 cost time: 6.185122013092041
Epoch: 3, Steps: 570 | Train Loss: 0.1381241 Vali Loss: 0.0310028 Test Loss: 0.1073266
Validation loss decreased (0.033082 --> 0.031003).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1128397
	speed: 0.0358s/iter; left time: 343.8292s
	iters: 200, epoch: 4 | loss: 0.0994237
	speed: 0.0104s/iter; left time: 98.2465s
	iters: 300, epoch: 4 | loss: 0.1038814
	speed: 0.0103s/iter; left time: 97.1206s
	iters: 400, epoch: 4 | loss: 0.0991919
	speed: 0.0103s/iter; left time: 96.1248s
	iters: 500, epoch: 4 | loss: 0.1753294
	speed: 0.0103s/iter; left time: 95.0064s
Epoch: 4 cost time: 6.164118528366089
Epoch: 4, Steps: 570 | Train Loss: 0.1310582 Vali Loss: 0.0308950 Test Loss: 0.1073900
Validation loss decreased (0.031003 --> 0.030895).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0961585
	speed: 0.0358s/iter; left time: 323.1838s
	iters: 200, epoch: 5 | loss: 0.1698866
	speed: 0.0103s/iter; left time: 91.5460s
	iters: 300, epoch: 5 | loss: 0.1103002
	speed: 0.0103s/iter; left time: 90.8841s
	iters: 400, epoch: 5 | loss: 0.1169631
	speed: 0.0103s/iter; left time: 89.8986s
	iters: 500, epoch: 5 | loss: 0.1244035
	speed: 0.0103s/iter; left time: 89.0061s
Epoch: 5 cost time: 6.1615917682647705
Epoch: 5, Steps: 570 | Train Loss: 0.1278323 Vali Loss: 0.0307792 Test Loss: 0.1089362
Validation loss decreased (0.030895 --> 0.030779).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0868208
	speed: 0.0364s/iter; left time: 307.5780s
	iters: 200, epoch: 6 | loss: 0.1824658
	speed: 0.0103s/iter; left time: 85.7518s
	iters: 300, epoch: 6 | loss: 0.1520076
	speed: 0.0103s/iter; left time: 84.6702s
	iters: 400, epoch: 6 | loss: 0.1010766
	speed: 0.0103s/iter; left time: 83.7199s
	iters: 500, epoch: 6 | loss: 0.0868167
	speed: 0.0102s/iter; left time: 82.4870s
Epoch: 6 cost time: 6.180606842041016
Epoch: 6, Steps: 570 | Train Loss: 0.1265988 Vali Loss: 0.0305154 Test Loss: 0.1082917
Validation loss decreased (0.030779 --> 0.030515).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1266780
	speed: 0.0374s/iter; left time: 294.8810s
	iters: 200, epoch: 7 | loss: 0.1439131
	speed: 0.0103s/iter; left time: 80.4033s
	iters: 300, epoch: 7 | loss: 0.2094483
	speed: 0.0103s/iter; left time: 79.2341s
	iters: 400, epoch: 7 | loss: 0.1722923
	speed: 0.0103s/iter; left time: 78.0530s
	iters: 500, epoch: 7 | loss: 0.1462710
	speed: 0.0103s/iter; left time: 77.0664s
Epoch: 7 cost time: 6.254994869232178
Epoch: 7, Steps: 570 | Train Loss: 0.1256750 Vali Loss: 0.0302904 Test Loss: 0.1083232
Validation loss decreased (0.030515 --> 0.030290).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1091781
	speed: 0.0372s/iter; left time: 271.7871s
	iters: 200, epoch: 8 | loss: 0.0930290
	speed: 0.0103s/iter; left time: 74.5755s
	iters: 300, epoch: 8 | loss: 0.1188539
	speed: 0.0103s/iter; left time: 73.5612s
	iters: 400, epoch: 8 | loss: 0.1192022
	speed: 0.0103s/iter; left time: 72.4983s
	iters: 500, epoch: 8 | loss: 0.0936297
	speed: 0.0103s/iter; left time: 71.3751s
Epoch: 8 cost time: 6.194746255874634
Epoch: 8, Steps: 570 | Train Loss: 0.1259217 Vali Loss: 0.0301730 Test Loss: 0.1081155
Validation loss decreased (0.030290 --> 0.030173).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1100343
	speed: 0.0356s/iter; left time: 239.6624s
	iters: 200, epoch: 9 | loss: 0.1464002
	speed: 0.0102s/iter; left time: 67.7692s
	iters: 300, epoch: 9 | loss: 0.1102298
	speed: 0.0102s/iter; left time: 66.8956s
	iters: 400, epoch: 9 | loss: 0.1361244
	speed: 0.0102s/iter; left time: 65.8853s
	iters: 500, epoch: 9 | loss: 0.1263459
	speed: 0.0102s/iter; left time: 64.9834s
Epoch: 9 cost time: 6.103278636932373
Epoch: 9, Steps: 570 | Train Loss: 0.1245330 Vali Loss: 0.0302652 Test Loss: 0.1083011
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1255611
	speed: 0.0349s/iter; left time: 215.3290s
	iters: 200, epoch: 10 | loss: 0.1017917
	speed: 0.0104s/iter; left time: 62.8725s
	iters: 300, epoch: 10 | loss: 0.1145379
	speed: 0.0103s/iter; left time: 61.7402s
	iters: 400, epoch: 10 | loss: 0.0913101
	speed: 0.0104s/iter; left time: 60.7965s
	iters: 500, epoch: 10 | loss: 0.0766238
	speed: 0.0104s/iter; left time: 59.7699s
Epoch: 10 cost time: 6.189494371414185
Epoch: 10, Steps: 570 | Train Loss: 0.1257018 Vali Loss: 0.0302718 Test Loss: 0.1083023
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1139698
	speed: 0.0356s/iter; left time: 199.1545s
	iters: 200, epoch: 11 | loss: 0.1388310
	speed: 0.0103s/iter; left time: 56.4249s
	iters: 300, epoch: 11 | loss: 0.1469189
	speed: 0.0103s/iter; left time: 55.4694s
	iters: 400, epoch: 11 | loss: 0.1414951
	speed: 0.0103s/iter; left time: 54.5133s
	iters: 500, epoch: 11 | loss: 0.1077557
	speed: 0.0102s/iter; left time: 53.2980s
Epoch: 11 cost time: 6.122919797897339
Epoch: 11, Steps: 570 | Train Loss: 0.1238729 Vali Loss: 0.0301528 Test Loss: 0.1083141
Validation loss decreased (0.030173 --> 0.030153).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1152398
	speed: 0.0375s/iter; left time: 188.6171s
	iters: 200, epoch: 12 | loss: 0.1277250
	speed: 0.0103s/iter; left time: 50.9897s
	iters: 300, epoch: 12 | loss: 0.1104521
	speed: 0.0103s/iter; left time: 49.8217s
	iters: 400, epoch: 12 | loss: 0.1891102
	speed: 0.0103s/iter; left time: 48.8521s
	iters: 500, epoch: 12 | loss: 0.1129850
	speed: 0.0103s/iter; left time: 47.8903s
Epoch: 12 cost time: 6.2061028480529785
Epoch: 12, Steps: 570 | Train Loss: 0.1244618 Vali Loss: 0.0302571 Test Loss: 0.1083152
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1319189
	speed: 0.0361s/iter; left time: 160.9436s
	iters: 200, epoch: 13 | loss: 0.1576452
	speed: 0.0103s/iter; left time: 45.0207s
	iters: 300, epoch: 13 | loss: 0.0837472
	speed: 0.0103s/iter; left time: 43.9385s
	iters: 400, epoch: 13 | loss: 0.1625548
	speed: 0.0103s/iter; left time: 42.9043s
	iters: 500, epoch: 13 | loss: 0.1285427
	speed: 0.0104s/iter; left time: 42.0463s
Epoch: 13 cost time: 6.143728256225586
Epoch: 13, Steps: 570 | Train Loss: 0.1248096 Vali Loss: 0.0301347 Test Loss: 0.1083239
Validation loss decreased (0.030153 --> 0.030135).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1196261
	speed: 0.0366s/iter; left time: 142.4340s
	iters: 200, epoch: 14 | loss: 0.0963889
	speed: 0.0104s/iter; left time: 39.2502s
	iters: 300, epoch: 14 | loss: 0.1159598
	speed: 0.0104s/iter; left time: 38.2020s
	iters: 400, epoch: 14 | loss: 0.1377869
	speed: 0.0104s/iter; left time: 37.1677s
	iters: 500, epoch: 14 | loss: 0.1410586
	speed: 0.0104s/iter; left time: 36.1527s
Epoch: 14 cost time: 6.202133417129517
Epoch: 14, Steps: 570 | Train Loss: 0.1254393 Vali Loss: 0.0301758 Test Loss: 0.1083240
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.0806293
	speed: 0.0356s/iter; left time: 118.1102s
	iters: 200, epoch: 15 | loss: 0.1490056
	speed: 0.0103s/iter; left time: 33.1755s
	iters: 300, epoch: 15 | loss: 0.1265745
	speed: 0.0103s/iter; left time: 32.1766s
	iters: 400, epoch: 15 | loss: 0.1200736
	speed: 0.0104s/iter; left time: 31.2758s
	iters: 500, epoch: 15 | loss: 0.0979574
	speed: 0.0103s/iter; left time: 30.2108s
Epoch: 15 cost time: 6.161574125289917
Epoch: 15, Steps: 570 | Train Loss: 0.1243336 Vali Loss: 0.0301346 Test Loss: 0.1083250
Validation loss decreased (0.030135 --> 0.030135).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1814100
	speed: 0.0355s/iter; left time: 97.6300s
	iters: 200, epoch: 16 | loss: 0.1212711
	speed: 0.0103s/iter; left time: 27.2824s
	iters: 300, epoch: 16 | loss: 0.1605145
	speed: 0.0103s/iter; left time: 26.2981s
	iters: 400, epoch: 16 | loss: 0.1443062
	speed: 0.0103s/iter; left time: 25.1823s
	iters: 500, epoch: 16 | loss: 0.2023915
	speed: 0.0103s/iter; left time: 24.2031s
Epoch: 16 cost time: 6.171667814254761
Epoch: 16, Steps: 570 | Train Loss: 0.1248819 Vali Loss: 0.0301262 Test Loss: 0.1083253
Validation loss decreased (0.030135 --> 0.030126).  Saving model ...
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.0958868
	speed: 0.0390s/iter; left time: 85.1489s
	iters: 200, epoch: 17 | loss: 0.1025478
	speed: 0.0102s/iter; left time: 21.3043s
	iters: 300, epoch: 17 | loss: 0.1280416
	speed: 0.0102s/iter; left time: 20.2369s
	iters: 400, epoch: 17 | loss: 0.1144716
	speed: 0.0102s/iter; left time: 19.2692s
	iters: 500, epoch: 17 | loss: 0.0766145
	speed: 0.0102s/iter; left time: 18.2197s
Epoch: 17 cost time: 6.131014585494995
Epoch: 17, Steps: 570 | Train Loss: 0.1247482 Vali Loss: 0.0302355 Test Loss: 0.1083252
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1366455
	speed: 0.0356s/iter; left time: 57.4293s
	iters: 200, epoch: 18 | loss: 0.1215379
	speed: 0.0103s/iter; left time: 15.5848s
	iters: 300, epoch: 18 | loss: 0.0830668
	speed: 0.0104s/iter; left time: 14.6160s
	iters: 400, epoch: 18 | loss: 0.2063132
	speed: 0.0103s/iter; left time: 13.5470s
	iters: 500, epoch: 18 | loss: 0.1021243
	speed: 0.0103s/iter; left time: 12.5279s
Epoch: 18 cost time: 6.206244945526123
Epoch: 18, Steps: 570 | Train Loss: 0.1247364 Vali Loss: 0.0302222 Test Loss: 0.1083251
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1282438
	speed: 0.0352s/iter; left time: 36.6465s
	iters: 200, epoch: 19 | loss: 0.1352768
	speed: 0.0103s/iter; left time: 9.6574s
	iters: 300, epoch: 19 | loss: 0.1141587
	speed: 0.0103s/iter; left time: 8.6531s
	iters: 400, epoch: 19 | loss: 0.1481847
	speed: 0.0103s/iter; left time: 7.6244s
	iters: 500, epoch: 19 | loss: 0.1201239
	speed: 0.0103s/iter; left time: 6.5852s
Epoch: 19 cost time: 6.158963203430176
Epoch: 19, Steps: 570 | Train Loss: 0.1244544 Vali Loss: 0.0302172 Test Loss: 0.1083252
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10847773402929306, mae:0.19956164062023163
>>> MS_Raw LR=1e-4 DO=0.1 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2209077
	speed: 0.0237s/iter; left time: 268.3810s
	iters: 200, epoch: 1 | loss: 0.1631805
	speed: 0.0117s/iter; left time: 130.5474s
	iters: 300, epoch: 1 | loss: 0.1428613
	speed: 0.0110s/iter; left time: 122.2453s
	iters: 400, epoch: 1 | loss: 0.1150904
	speed: 0.0104s/iter; left time: 114.4409s
	iters: 500, epoch: 1 | loss: 0.2018290
	speed: 0.0104s/iter; left time: 113.8023s
Epoch: 1 cost time: 7.508547782897949
Epoch: 1, Steps: 570 | Train Loss: 0.2200478 Vali Loss: 0.0456244 Test Loss: 0.1333508
Validation loss decreased (inf --> 0.045624).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1866460
	speed: 0.0369s/iter; left time: 396.1398s
	iters: 200, epoch: 2 | loss: 0.2389505
	speed: 0.0105s/iter; left time: 111.7426s
	iters: 300, epoch: 2 | loss: 0.1493279
	speed: 0.0106s/iter; left time: 111.1998s
	iters: 400, epoch: 2 | loss: 0.2726944
	speed: 0.0105s/iter; left time: 109.4595s
	iters: 500, epoch: 2 | loss: 0.2013200
	speed: 0.0105s/iter; left time: 108.2523s
Epoch: 2 cost time: 6.282792091369629
Epoch: 2, Steps: 570 | Train Loss: 0.1774382 Vali Loss: 0.0395741 Test Loss: 0.1253181
Validation loss decreased (0.045624 --> 0.039574).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1207781
	speed: 0.0376s/iter; left time: 382.0056s
	iters: 200, epoch: 3 | loss: 0.1570719
	speed: 0.0104s/iter; left time: 104.3987s
	iters: 300, epoch: 3 | loss: 0.1950693
	speed: 0.0104s/iter; left time: 103.3472s
	iters: 400, epoch: 3 | loss: 0.1283651
	speed: 0.0104s/iter; left time: 102.5739s
	iters: 500, epoch: 3 | loss: 0.1199954
	speed: 0.0104s/iter; left time: 101.5096s
Epoch: 3 cost time: 6.232168912887573
Epoch: 3, Steps: 570 | Train Loss: 0.1601210 Vali Loss: 0.0392600 Test Loss: 0.1258912
Validation loss decreased (0.039574 --> 0.039260).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0857576
	speed: 0.0385s/iter; left time: 369.6421s
	iters: 200, epoch: 4 | loss: 0.1435241
	speed: 0.0104s/iter; left time: 98.5342s
	iters: 300, epoch: 4 | loss: 0.1204739
	speed: 0.0104s/iter; left time: 97.5033s
	iters: 400, epoch: 4 | loss: 0.1990416
	speed: 0.0104s/iter; left time: 96.8000s
	iters: 500, epoch: 4 | loss: 0.1360075
	speed: 0.0104s/iter; left time: 95.2715s
Epoch: 4 cost time: 6.231087923049927
Epoch: 4, Steps: 570 | Train Loss: 0.1509492 Vali Loss: 0.0388266 Test Loss: 0.1260145
Validation loss decreased (0.039260 --> 0.038827).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1325593
	speed: 0.0361s/iter; left time: 325.4236s
	iters: 200, epoch: 5 | loss: 0.1007131
	speed: 0.0104s/iter; left time: 92.4651s
	iters: 300, epoch: 5 | loss: 0.1569553
	speed: 0.0104s/iter; left time: 91.7289s
	iters: 400, epoch: 5 | loss: 0.1501538
	speed: 0.0104s/iter; left time: 90.7750s
	iters: 500, epoch: 5 | loss: 0.1873112
	speed: 0.0104s/iter; left time: 89.7321s
Epoch: 5 cost time: 6.184554815292358
Epoch: 5, Steps: 570 | Train Loss: 0.1477954 Vali Loss: 0.0387457 Test Loss: 0.1248546
Validation loss decreased (0.038827 --> 0.038746).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1031383
	speed: 0.0385s/iter; left time: 325.0831s
	iters: 200, epoch: 6 | loss: 0.1437926
	speed: 0.0103s/iter; left time: 86.1502s
	iters: 300, epoch: 6 | loss: 0.1388285
	speed: 0.0103s/iter; left time: 85.3458s
	iters: 400, epoch: 6 | loss: 0.1307970
	speed: 0.0103s/iter; left time: 84.2524s
	iters: 500, epoch: 6 | loss: 0.1496309
	speed: 0.0103s/iter; left time: 83.0442s
Epoch: 6 cost time: 6.221371650695801
Epoch: 6, Steps: 570 | Train Loss: 0.1451480 Vali Loss: 0.0380487 Test Loss: 0.1235802
Validation loss decreased (0.038746 --> 0.038049).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1069827
	speed: 0.0367s/iter; left time: 289.3639s
	iters: 200, epoch: 7 | loss: 0.1461647
	speed: 0.0104s/iter; left time: 80.8478s
	iters: 300, epoch: 7 | loss: 0.1125339
	speed: 0.0104s/iter; left time: 79.6139s
	iters: 400, epoch: 7 | loss: 0.0938165
	speed: 0.0104s/iter; left time: 78.5437s
	iters: 500, epoch: 7 | loss: 0.1562604
	speed: 0.0104s/iter; left time: 77.6470s
Epoch: 7 cost time: 6.232619047164917
Epoch: 7, Steps: 570 | Train Loss: 0.1428303 Vali Loss: 0.0379655 Test Loss: 0.1234711
Validation loss decreased (0.038049 --> 0.037965).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1077710
	speed: 0.0357s/iter; left time: 261.2553s
	iters: 200, epoch: 8 | loss: 0.1454666
	speed: 0.0104s/iter; left time: 74.8115s
	iters: 300, epoch: 8 | loss: 0.1180467
	speed: 0.0104s/iter; left time: 73.6953s
	iters: 400, epoch: 8 | loss: 0.1400131
	speed: 0.0104s/iter; left time: 72.8375s
	iters: 500, epoch: 8 | loss: 0.1238756
	speed: 0.0104s/iter; left time: 71.7121s
Epoch: 8 cost time: 6.204780578613281
Epoch: 8, Steps: 570 | Train Loss: 0.1415453 Vali Loss: 0.0379648 Test Loss: 0.1236288
Validation loss decreased (0.037965 --> 0.037965).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1197457
	speed: 0.0358s/iter; left time: 241.0636s
	iters: 200, epoch: 9 | loss: 0.1663950
	speed: 0.0104s/iter; left time: 69.1393s
	iters: 300, epoch: 9 | loss: 0.1219669
	speed: 0.0104s/iter; left time: 67.9035s
	iters: 400, epoch: 9 | loss: 0.1165582
	speed: 0.0104s/iter; left time: 66.8277s
	iters: 500, epoch: 9 | loss: 0.1473963
	speed: 0.0104s/iter; left time: 65.8016s
Epoch: 9 cost time: 6.215240716934204
Epoch: 9, Steps: 570 | Train Loss: 0.1408470 Vali Loss: 0.0381282 Test Loss: 0.1237652
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1218221
	speed: 0.0360s/iter; left time: 222.1708s
	iters: 200, epoch: 10 | loss: 0.1730519
	speed: 0.0103s/iter; left time: 62.8017s
	iters: 300, epoch: 10 | loss: 0.1865845
	speed: 0.0103s/iter; left time: 61.6996s
	iters: 400, epoch: 10 | loss: 0.1654164
	speed: 0.0103s/iter; left time: 60.7607s
	iters: 500, epoch: 10 | loss: 0.1427130
	speed: 0.0103s/iter; left time: 59.6745s
Epoch: 10 cost time: 6.146522760391235
Epoch: 10, Steps: 570 | Train Loss: 0.1427504 Vali Loss: 0.0381587 Test Loss: 0.1238057
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1540829
	speed: 0.0371s/iter; left time: 207.9188s
	iters: 200, epoch: 11 | loss: 0.1129410
	speed: 0.0104s/iter; left time: 57.2007s
	iters: 300, epoch: 11 | loss: 0.1937230
	speed: 0.0104s/iter; left time: 56.2305s
	iters: 400, epoch: 11 | loss: 0.1644548
	speed: 0.0104s/iter; left time: 55.1665s
	iters: 500, epoch: 11 | loss: 0.1550523
	speed: 0.0104s/iter; left time: 54.0880s
Epoch: 11 cost time: 6.24174427986145
Epoch: 11, Steps: 570 | Train Loss: 0.1425434 Vali Loss: 0.0379050 Test Loss: 0.1238274
Validation loss decreased (0.037965 --> 0.037905).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1438372
	speed: 0.0370s/iter; left time: 186.3843s
	iters: 200, epoch: 12 | loss: 0.1561584
	speed: 0.0103s/iter; left time: 50.8954s
	iters: 300, epoch: 12 | loss: 0.1043206
	speed: 0.0103s/iter; left time: 49.7962s
	iters: 400, epoch: 12 | loss: 0.1268635
	speed: 0.0103s/iter; left time: 48.7570s
	iters: 500, epoch: 12 | loss: 0.0814305
	speed: 0.0103s/iter; left time: 47.7047s
Epoch: 12 cost time: 6.181318759918213
Epoch: 12, Steps: 570 | Train Loss: 0.1417405 Vali Loss: 0.0379074 Test Loss: 0.1238480
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1408719
	speed: 0.0369s/iter; left time: 164.6936s
	iters: 200, epoch: 13 | loss: 0.1521952
	speed: 0.0103s/iter; left time: 45.0802s
	iters: 300, epoch: 13 | loss: 0.1613741
	speed: 0.0103s/iter; left time: 44.0385s
	iters: 400, epoch: 13 | loss: 0.1620815
	speed: 0.0103s/iter; left time: 42.9800s
	iters: 500, epoch: 13 | loss: 0.1417292
	speed: 0.0103s/iter; left time: 41.9572s
Epoch: 13 cost time: 6.151130676269531
Epoch: 13, Steps: 570 | Train Loss: 0.1424282 Vali Loss: 0.0379697 Test Loss: 0.1238488
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1171110
	speed: 0.0355s/iter; left time: 138.2902s
	iters: 200, epoch: 14 | loss: 0.1668206
	speed: 0.0103s/iter; left time: 39.1922s
	iters: 300, epoch: 14 | loss: 0.1107595
	speed: 0.0103s/iter; left time: 38.1674s
	iters: 400, epoch: 14 | loss: 0.0863452
	speed: 0.0103s/iter; left time: 37.0516s
	iters: 500, epoch: 14 | loss: 0.1830739
	speed: 0.0103s/iter; left time: 36.0229s
Epoch: 14 cost time: 6.170258522033691
Epoch: 14, Steps: 570 | Train Loss: 0.1414670 Vali Loss: 0.0378636 Test Loss: 0.1238594
Validation loss decreased (0.037905 --> 0.037864).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1206651
	speed: 0.0363s/iter; left time: 120.6768s
	iters: 200, epoch: 15 | loss: 0.1962299
	speed: 0.0104s/iter; left time: 33.5072s
	iters: 300, epoch: 15 | loss: 0.0880813
	speed: 0.0104s/iter; left time: 32.4481s
	iters: 400, epoch: 15 | loss: 0.0686535
	speed: 0.0104s/iter; left time: 31.4209s
	iters: 500, epoch: 15 | loss: 0.2198229
	speed: 0.0104s/iter; left time: 30.3733s
Epoch: 15 cost time: 6.231422424316406
Epoch: 15, Steps: 570 | Train Loss: 0.1417189 Vali Loss: 0.0379597 Test Loss: 0.1238618
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1515440
	speed: 0.0371s/iter; left time: 102.0583s
	iters: 200, epoch: 16 | loss: 0.1062499
	speed: 0.0104s/iter; left time: 27.6548s
	iters: 300, epoch: 16 | loss: 0.1378633
	speed: 0.0104s/iter; left time: 26.6015s
	iters: 400, epoch: 16 | loss: 0.1257110
	speed: 0.0104s/iter; left time: 25.5422s
	iters: 500, epoch: 16 | loss: 0.1545956
	speed: 0.0104s/iter; left time: 24.5120s
Epoch: 16 cost time: 6.235305547714233
Epoch: 16, Steps: 570 | Train Loss: 0.1420061 Vali Loss: 0.0381102 Test Loss: 0.1238612
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1119800
	speed: 0.0361s/iter; left time: 78.8170s
	iters: 200, epoch: 17 | loss: 0.0862425
	speed: 0.0104s/iter; left time: 21.6543s
	iters: 300, epoch: 17 | loss: 0.0969094
	speed: 0.0104s/iter; left time: 20.6122s
	iters: 400, epoch: 17 | loss: 0.1524913
	speed: 0.0104s/iter; left time: 19.5479s
	iters: 500, epoch: 17 | loss: 0.0960862
	speed: 0.0104s/iter; left time: 18.5671s
Epoch: 17 cost time: 6.225822687149048
Epoch: 17, Steps: 570 | Train Loss: 0.1422323 Vali Loss: 0.0381015 Test Loss: 0.1238618
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1240406259894371, mae:0.2200387865304947
>>> MS_Raw LR=1e-4 DO=0.1 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2494522
	speed: 0.0238s/iter; left time: 269.1788s
	iters: 200, epoch: 1 | loss: 0.2129330
	speed: 0.0119s/iter; left time: 133.0936s
	iters: 300, epoch: 1 | loss: 0.1523527
	speed: 0.0119s/iter; left time: 131.5508s
	iters: 400, epoch: 1 | loss: 0.1196123
	speed: 0.0118s/iter; left time: 130.0755s
	iters: 500, epoch: 1 | loss: 0.1970649
	speed: 0.0118s/iter; left time: 128.8924s
Epoch: 1 cost time: 7.997518062591553
Epoch: 1, Steps: 570 | Train Loss: 0.2074562 Vali Loss: 0.0426341 Test Loss: 0.1295917
Validation loss decreased (inf --> 0.042634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1755087
	speed: 0.0391s/iter; left time: 419.3494s
	iters: 200, epoch: 2 | loss: 0.1553559
	speed: 0.0119s/iter; left time: 126.1777s
	iters: 300, epoch: 2 | loss: 0.1324689
	speed: 0.0119s/iter; left time: 125.2359s
	iters: 400, epoch: 2 | loss: 0.0915983
	speed: 0.0119s/iter; left time: 123.8342s
	iters: 500, epoch: 2 | loss: 0.1688437
	speed: 0.0119s/iter; left time: 122.6159s
Epoch: 2 cost time: 7.076568603515625
Epoch: 2, Steps: 570 | Train Loss: 0.1654598 Vali Loss: 0.0396928 Test Loss: 0.1245952
Validation loss decreased (0.042634 --> 0.039693).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1581594
	speed: 0.0400s/iter; left time: 406.6794s
	iters: 200, epoch: 3 | loss: 0.1721560
	speed: 0.0119s/iter; left time: 119.9068s
	iters: 300, epoch: 3 | loss: 0.1140315
	speed: 0.0119s/iter; left time: 118.8055s
	iters: 400, epoch: 3 | loss: 0.1244937
	speed: 0.0119s/iter; left time: 117.3664s
	iters: 500, epoch: 3 | loss: 0.1060665
	speed: 0.0119s/iter; left time: 115.8177s
Epoch: 3 cost time: 7.1277453899383545
Epoch: 3, Steps: 570 | Train Loss: 0.1411879 Vali Loss: 0.0367619 Test Loss: 0.1210644
Validation loss decreased (0.039693 --> 0.036762).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1151561
	speed: 0.0399s/iter; left time: 382.3539s
	iters: 200, epoch: 4 | loss: 0.1654308
	speed: 0.0118s/iter; left time: 112.2707s
	iters: 300, epoch: 4 | loss: 0.0820960
	speed: 0.0118s/iter; left time: 111.0880s
	iters: 400, epoch: 4 | loss: 0.0956668
	speed: 0.0118s/iter; left time: 110.0446s
	iters: 500, epoch: 4 | loss: 0.1009726
	speed: 0.0118s/iter; left time: 108.6900s
Epoch: 4 cost time: 7.021167516708374
Epoch: 4, Steps: 570 | Train Loss: 0.1289499 Vali Loss: 0.0352489 Test Loss: 0.1231693
Validation loss decreased (0.036762 --> 0.035249).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1123193
	speed: 0.0405s/iter; left time: 364.9995s
	iters: 200, epoch: 5 | loss: 0.1100611
	speed: 0.0118s/iter; left time: 105.3757s
	iters: 300, epoch: 5 | loss: 0.1749112
	speed: 0.0118s/iter; left time: 104.1627s
	iters: 400, epoch: 5 | loss: 0.1129525
	speed: 0.0118s/iter; left time: 103.0434s
	iters: 500, epoch: 5 | loss: 0.1089170
	speed: 0.0118s/iter; left time: 101.8980s
Epoch: 5 cost time: 7.0570387840271
Epoch: 5, Steps: 570 | Train Loss: 0.1233984 Vali Loss: 0.0358403 Test Loss: 0.1185238
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1055258
	speed: 0.0384s/iter; left time: 324.2669s
	iters: 200, epoch: 6 | loss: 0.0744367
	speed: 0.0118s/iter; left time: 98.7925s
	iters: 300, epoch: 6 | loss: 0.1253520
	speed: 0.0118s/iter; left time: 97.3039s
	iters: 400, epoch: 6 | loss: 0.1410496
	speed: 0.0118s/iter; left time: 96.1147s
	iters: 500, epoch: 6 | loss: 0.0853137
	speed: 0.0118s/iter; left time: 95.1364s
Epoch: 6 cost time: 7.032080173492432
Epoch: 6, Steps: 570 | Train Loss: 0.1182106 Vali Loss: 0.0345302 Test Loss: 0.1180393
Validation loss decreased (0.035249 --> 0.034530).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1296884
	speed: 0.0422s/iter; left time: 332.2941s
	iters: 200, epoch: 7 | loss: 0.1308485
	speed: 0.0120s/iter; left time: 93.0872s
	iters: 300, epoch: 7 | loss: 0.1279680
	speed: 0.0119s/iter; left time: 91.1818s
	iters: 400, epoch: 7 | loss: 0.1000333
	speed: 0.0119s/iter; left time: 90.0591s
	iters: 500, epoch: 7 | loss: 0.1005313
	speed: 0.0119s/iter; left time: 88.7890s
Epoch: 7 cost time: 7.203036546707153
Epoch: 7, Steps: 570 | Train Loss: 0.1169174 Vali Loss: 0.0343042 Test Loss: 0.1196582
Validation loss decreased (0.034530 --> 0.034304).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0725371
	speed: 0.0401s/iter; left time: 292.8282s
	iters: 200, epoch: 8 | loss: 0.1225613
	speed: 0.0119s/iter; left time: 85.6475s
	iters: 300, epoch: 8 | loss: 0.0996163
	speed: 0.0119s/iter; left time: 84.4429s
	iters: 400, epoch: 8 | loss: 0.0855558
	speed: 0.0119s/iter; left time: 83.2251s
	iters: 500, epoch: 8 | loss: 0.0986222
	speed: 0.0119s/iter; left time: 81.9856s
Epoch: 8 cost time: 7.0816566944122314
Epoch: 8, Steps: 570 | Train Loss: 0.1168448 Vali Loss: 0.0341010 Test Loss: 0.1192758
Validation loss decreased (0.034304 --> 0.034101).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0960807
	speed: 0.0389s/iter; left time: 262.1216s
	iters: 200, epoch: 9 | loss: 0.1103233
	speed: 0.0118s/iter; left time: 78.5251s
	iters: 300, epoch: 9 | loss: 0.1214779
	speed: 0.0118s/iter; left time: 77.2104s
	iters: 400, epoch: 9 | loss: 0.0919171
	speed: 0.0118s/iter; left time: 76.0002s
	iters: 500, epoch: 9 | loss: 0.1461041
	speed: 0.0118s/iter; left time: 74.7718s
Epoch: 9 cost time: 7.050534248352051
Epoch: 9, Steps: 570 | Train Loss: 0.1163970 Vali Loss: 0.0340609 Test Loss: 0.1190358
Validation loss decreased (0.034101 --> 0.034061).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1156739
	speed: 0.0389s/iter; left time: 239.8105s
	iters: 200, epoch: 10 | loss: 0.1168119
	speed: 0.0119s/iter; left time: 72.2202s
	iters: 300, epoch: 10 | loss: 0.0976095
	speed: 0.0119s/iter; left time: 71.0742s
	iters: 400, epoch: 10 | loss: 0.0884077
	speed: 0.0119s/iter; left time: 69.8097s
	iters: 500, epoch: 10 | loss: 0.1521445
	speed: 0.0119s/iter; left time: 68.4903s
Epoch: 10 cost time: 7.057065010070801
Epoch: 10, Steps: 570 | Train Loss: 0.1171683 Vali Loss: 0.0342109 Test Loss: 0.1189131
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0946117
	speed: 0.0390s/iter; left time: 218.2271s
	iters: 200, epoch: 11 | loss: 0.1715285
	speed: 0.0124s/iter; left time: 68.0026s
	iters: 300, epoch: 11 | loss: 0.1023363
	speed: 0.0119s/iter; left time: 64.2652s
	iters: 400, epoch: 11 | loss: 0.1114139
	speed: 0.0119s/iter; left time: 62.9326s
	iters: 500, epoch: 11 | loss: 0.1463158
	speed: 0.0119s/iter; left time: 61.7071s
Epoch: 11 cost time: 7.209232807159424
Epoch: 11, Steps: 570 | Train Loss: 0.1154145 Vali Loss: 0.0342090 Test Loss: 0.1189196
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1003364
	speed: 0.0388s/iter; left time: 195.2274s
	iters: 200, epoch: 12 | loss: 0.0884850
	speed: 0.0119s/iter; left time: 58.5476s
	iters: 300, epoch: 12 | loss: 0.0798764
	speed: 0.0119s/iter; left time: 57.5045s
	iters: 400, epoch: 12 | loss: 0.0917849
	speed: 0.0119s/iter; left time: 56.2378s
	iters: 500, epoch: 12 | loss: 0.1094390
	speed: 0.0119s/iter; left time: 54.9796s
Epoch: 12 cost time: 7.0647101402282715
Epoch: 12, Steps: 570 | Train Loss: 0.1151760 Vali Loss: 0.0342856 Test Loss: 0.1188759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11919538676738739, mae:0.2178240269422531
>>> MS_Raw LR=1e-4 DO=0.1 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1061446
	speed: 0.0246s/iter; left time: 278.3914s
	iters: 200, epoch: 1 | loss: 0.2938389
	speed: 0.0126s/iter; left time: 140.7460s
	iters: 300, epoch: 1 | loss: 0.1393132
	speed: 0.0125s/iter; left time: 139.0592s
	iters: 400, epoch: 1 | loss: 0.1742748
	speed: 0.0125s/iter; left time: 137.9757s
	iters: 500, epoch: 1 | loss: 0.1219428
	speed: 0.0126s/iter; left time: 137.4796s
Epoch: 1 cost time: 8.419556379318237
Epoch: 1, Steps: 570 | Train Loss: 0.1809858 Vali Loss: 0.0358772 Test Loss: 0.1120169
Validation loss decreased (inf --> 0.035877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1285634
	speed: 0.0392s/iter; left time: 420.7025s
	iters: 200, epoch: 2 | loss: 0.1006706
	speed: 0.0115s/iter; left time: 121.8507s
	iters: 300, epoch: 2 | loss: 0.1497626
	speed: 0.0115s/iter; left time: 120.7808s
	iters: 400, epoch: 2 | loss: 0.2290181
	speed: 0.0115s/iter; left time: 119.7337s
	iters: 500, epoch: 2 | loss: 0.2421417
	speed: 0.0115s/iter; left time: 118.4008s
Epoch: 2 cost time: 6.872653245925903
Epoch: 2, Steps: 570 | Train Loss: 0.1469245 Vali Loss: 0.0362476 Test Loss: 0.1125096
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1461935
	speed: 0.0394s/iter; left time: 400.4171s
	iters: 200, epoch: 3 | loss: 0.0874312
	speed: 0.0115s/iter; left time: 116.0133s
	iters: 300, epoch: 3 | loss: 0.1629128
	speed: 0.0115s/iter; left time: 114.8257s
	iters: 400, epoch: 3 | loss: 0.1303105
	speed: 0.0115s/iter; left time: 113.5475s
	iters: 500, epoch: 3 | loss: 0.1554490
	speed: 0.0115s/iter; left time: 112.6695s
Epoch: 3 cost time: 6.895224332809448
Epoch: 3, Steps: 570 | Train Loss: 0.1299274 Vali Loss: 0.0332274 Test Loss: 0.1086616
Validation loss decreased (0.035877 --> 0.033227).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1100514
	speed: 0.0406s/iter; left time: 389.2600s
	iters: 200, epoch: 4 | loss: 0.0898602
	speed: 0.0115s/iter; left time: 109.1540s
	iters: 300, epoch: 4 | loss: 0.0719668
	speed: 0.0115s/iter; left time: 107.9663s
	iters: 400, epoch: 4 | loss: 0.1100080
	speed: 0.0115s/iter; left time: 106.7599s
	iters: 500, epoch: 4 | loss: 0.1275932
	speed: 0.0115s/iter; left time: 105.4923s
Epoch: 4 cost time: 6.8605499267578125
Epoch: 4, Steps: 570 | Train Loss: 0.1192766 Vali Loss: 0.0334128 Test Loss: 0.1083727
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0998100
	speed: 0.0377s/iter; left time: 340.0512s
	iters: 200, epoch: 5 | loss: 0.0951665
	speed: 0.0115s/iter; left time: 102.3762s
	iters: 300, epoch: 5 | loss: 0.1616226
	speed: 0.0115s/iter; left time: 101.2386s
	iters: 400, epoch: 5 | loss: 0.0922074
	speed: 0.0115s/iter; left time: 100.1246s
	iters: 500, epoch: 5 | loss: 0.1030626
	speed: 0.0115s/iter; left time: 99.0563s
Epoch: 5 cost time: 6.829313278198242
Epoch: 5, Steps: 570 | Train Loss: 0.1137036 Vali Loss: 0.0332378 Test Loss: 0.1093978
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1444074
	speed: 0.0381s/iter; left time: 322.2610s
	iters: 200, epoch: 6 | loss: 0.1259873
	speed: 0.0115s/iter; left time: 96.2983s
	iters: 300, epoch: 6 | loss: 0.0823032
	speed: 0.0115s/iter; left time: 95.1164s
	iters: 400, epoch: 6 | loss: 0.0880875
	speed: 0.0115s/iter; left time: 93.9541s
	iters: 500, epoch: 6 | loss: 0.0839217
	speed: 0.0115s/iter; left time: 92.9068s
Epoch: 6 cost time: 6.8659467697143555
Epoch: 6, Steps: 570 | Train Loss: 0.1108379 Vali Loss: 0.0329414 Test Loss: 0.1084211
Validation loss decreased (0.033227 --> 0.032941).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0801231
	speed: 0.0395s/iter; left time: 311.6586s
	iters: 200, epoch: 7 | loss: 0.1289176
	speed: 0.0115s/iter; left time: 89.2225s
	iters: 300, epoch: 7 | loss: 0.0806299
	speed: 0.0115s/iter; left time: 88.2266s
	iters: 400, epoch: 7 | loss: 0.0882797
	speed: 0.0115s/iter; left time: 86.9944s
	iters: 500, epoch: 7 | loss: 0.0941452
	speed: 0.0115s/iter; left time: 85.8422s
Epoch: 7 cost time: 6.837911128997803
Epoch: 7, Steps: 570 | Train Loss: 0.1095375 Vali Loss: 0.0327797 Test Loss: 0.1082623
Validation loss decreased (0.032941 --> 0.032780).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0955910
	speed: 0.0383s/iter; left time: 279.7579s
	iters: 200, epoch: 8 | loss: 0.1279755
	speed: 0.0114s/iter; left time: 82.4290s
	iters: 300, epoch: 8 | loss: 0.0893521
	speed: 0.0114s/iter; left time: 81.2610s
	iters: 400, epoch: 8 | loss: 0.1013135
	speed: 0.0114s/iter; left time: 80.1025s
	iters: 500, epoch: 8 | loss: 0.1093070
	speed: 0.0114s/iter; left time: 78.9563s
Epoch: 8 cost time: 6.808714151382446
Epoch: 8, Steps: 570 | Train Loss: 0.1093392 Vali Loss: 0.0331353 Test Loss: 0.1088808
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1575224
	speed: 0.0374s/iter; left time: 252.1317s
	iters: 200, epoch: 9 | loss: 0.0802651
	speed: 0.0114s/iter; left time: 75.8576s
	iters: 300, epoch: 9 | loss: 0.1117401
	speed: 0.0114s/iter; left time: 74.7258s
	iters: 400, epoch: 9 | loss: 0.1396321
	speed: 0.0114s/iter; left time: 73.5554s
	iters: 500, epoch: 9 | loss: 0.1535444
	speed: 0.0114s/iter; left time: 72.4205s
Epoch: 9 cost time: 6.789028644561768
Epoch: 9, Steps: 570 | Train Loss: 0.1096551 Vali Loss: 0.0328618 Test Loss: 0.1087080
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1076999
	speed: 0.0374s/iter; left time: 230.5472s
	iters: 200, epoch: 10 | loss: 0.0950411
	speed: 0.0115s/iter; left time: 69.8091s
	iters: 300, epoch: 10 | loss: 0.0886016
	speed: 0.0115s/iter; left time: 68.6400s
	iters: 400, epoch: 10 | loss: 0.1124933
	speed: 0.0115s/iter; left time: 67.4531s
	iters: 500, epoch: 10 | loss: 0.1248781
	speed: 0.0115s/iter; left time: 66.3046s
Epoch: 10 cost time: 6.833340167999268
Epoch: 10, Steps: 570 | Train Loss: 0.1088378 Vali Loss: 0.0329134 Test Loss: 0.1087530
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10842026770114899, mae:0.19971726834774017
>>> MS_Raw LR=1e-4 DO=0.1 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2666608
	speed: 0.0226s/iter; left time: 255.7326s
	iters: 200, epoch: 1 | loss: 0.2344479
	speed: 0.0120s/iter; left time: 134.8418s
	iters: 300, epoch: 1 | loss: 0.2681766
	speed: 0.0123s/iter; left time: 136.2326s
	iters: 400, epoch: 1 | loss: 0.1758684
	speed: 0.0123s/iter; left time: 135.0812s
	iters: 500, epoch: 1 | loss: 0.1921344
	speed: 0.0123s/iter; left time: 133.8164s
Epoch: 1 cost time: 8.063459396362305
Epoch: 1, Steps: 570 | Train Loss: 0.2114521 Vali Loss: 0.0422289 Test Loss: 0.1334401
Validation loss decreased (inf --> 0.042229).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2222213
	speed: 0.0409s/iter; left time: 439.0908s
	iters: 200, epoch: 2 | loss: 0.2736513
	speed: 0.0125s/iter; left time: 132.4705s
	iters: 300, epoch: 2 | loss: 0.1277289
	speed: 0.0120s/iter; left time: 126.3522s
	iters: 400, epoch: 2 | loss: 0.1396603
	speed: 0.0118s/iter; left time: 123.2710s
	iters: 500, epoch: 2 | loss: 0.1350700
	speed: 0.0108s/iter; left time: 111.7436s
Epoch: 2 cost time: 7.025104999542236
Epoch: 2, Steps: 570 | Train Loss: 0.1713502 Vali Loss: 0.0425691 Test Loss: 0.1256566
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1520723
	speed: 0.0396s/iter; left time: 402.5448s
	iters: 200, epoch: 3 | loss: 0.1291768
	speed: 0.0117s/iter; left time: 117.3102s
	iters: 300, epoch: 3 | loss: 0.1434106
	speed: 0.0108s/iter; left time: 107.9345s
	iters: 400, epoch: 3 | loss: 0.1218131
	speed: 0.0108s/iter; left time: 106.8968s
	iters: 500, epoch: 3 | loss: 0.1572614
	speed: 0.0108s/iter; left time: 105.7387s
Epoch: 3 cost time: 6.64998722076416
Epoch: 3, Steps: 570 | Train Loss: 0.1472495 Vali Loss: 0.0413527 Test Loss: 0.1271744
Validation loss decreased (0.042229 --> 0.041353).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1284194
	speed: 0.0368s/iter; left time: 353.0939s
	iters: 200, epoch: 4 | loss: 0.1104371
	speed: 0.0108s/iter; left time: 102.2064s
	iters: 300, epoch: 4 | loss: 0.1248381
	speed: 0.0108s/iter; left time: 101.0660s
	iters: 400, epoch: 4 | loss: 0.2190025
	speed: 0.0108s/iter; left time: 100.1254s
	iters: 500, epoch: 4 | loss: 0.1397098
	speed: 0.0108s/iter; left time: 98.8988s
Epoch: 4 cost time: 6.436102628707886
Epoch: 4, Steps: 570 | Train Loss: 0.1364210 Vali Loss: 0.0399190 Test Loss: 0.1251965
Validation loss decreased (0.041353 --> 0.039919).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1347206
	speed: 0.0380s/iter; left time: 342.7119s
	iters: 200, epoch: 5 | loss: 0.1331736
	speed: 0.0108s/iter; left time: 96.2642s
	iters: 300, epoch: 5 | loss: 0.1527700
	speed: 0.0108s/iter; left time: 95.1161s
	iters: 400, epoch: 5 | loss: 0.1086815
	speed: 0.0107s/iter; left time: 93.6060s
	iters: 500, epoch: 5 | loss: 0.2206286
	speed: 0.0107s/iter; left time: 92.6066s
Epoch: 5 cost time: 6.492500066757202
Epoch: 5, Steps: 570 | Train Loss: 0.1303347 Vali Loss: 0.0386281 Test Loss: 0.1224689
Validation loss decreased (0.039919 --> 0.038628).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1115298
	speed: 0.0399s/iter; left time: 336.8490s
	iters: 200, epoch: 6 | loss: 0.1223001
	speed: 0.0123s/iter; left time: 102.4048s
	iters: 300, epoch: 6 | loss: 0.1253359
	speed: 0.0111s/iter; left time: 91.7366s
	iters: 400, epoch: 6 | loss: 0.1120289
	speed: 0.0124s/iter; left time: 101.1666s
	iters: 500, epoch: 6 | loss: 0.1296152
	speed: 0.0124s/iter; left time: 100.0154s
Epoch: 6 cost time: 7.2454071044921875
Epoch: 6, Steps: 570 | Train Loss: 0.1268731 Vali Loss: 0.0391719 Test Loss: 0.1254759
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1168155
	speed: 0.0396s/iter; left time: 312.3929s
	iters: 200, epoch: 7 | loss: 0.1033156
	speed: 0.0124s/iter; left time: 96.8029s
	iters: 300, epoch: 7 | loss: 0.0881221
	speed: 0.0118s/iter; left time: 90.7175s
	iters: 400, epoch: 7 | loss: 0.1157171
	speed: 0.0108s/iter; left time: 82.2413s
	iters: 500, epoch: 7 | loss: 0.0893376
	speed: 0.0109s/iter; left time: 81.3398s
Epoch: 7 cost time: 6.905873537063599
Epoch: 7, Steps: 570 | Train Loss: 0.1247528 Vali Loss: 0.0385924 Test Loss: 0.1243976
Validation loss decreased (0.038628 --> 0.038592).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0976155
	speed: 0.0370s/iter; left time: 270.4907s
	iters: 200, epoch: 8 | loss: 0.1807430
	speed: 0.0108s/iter; left time: 78.1050s
	iters: 300, epoch: 8 | loss: 0.1563657
	speed: 0.0108s/iter; left time: 76.6712s
	iters: 400, epoch: 8 | loss: 0.1276036
	speed: 0.0107s/iter; left time: 75.3541s
	iters: 500, epoch: 8 | loss: 0.0864860
	speed: 0.0108s/iter; left time: 74.3673s
Epoch: 8 cost time: 6.455137729644775
Epoch: 8, Steps: 570 | Train Loss: 0.1243899 Vali Loss: 0.0384668 Test Loss: 0.1241978
Validation loss decreased (0.038592 --> 0.038467).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1099533
	speed: 0.0371s/iter; left time: 249.9062s
	iters: 200, epoch: 9 | loss: 0.0833538
	speed: 0.0108s/iter; left time: 71.6345s
	iters: 300, epoch: 9 | loss: 0.1339110
	speed: 0.0108s/iter; left time: 70.5707s
	iters: 400, epoch: 9 | loss: 0.1569254
	speed: 0.0108s/iter; left time: 69.6932s
	iters: 500, epoch: 9 | loss: 0.0781038
	speed: 0.0108s/iter; left time: 68.3933s
Epoch: 9 cost time: 6.4611897468566895
Epoch: 9, Steps: 570 | Train Loss: 0.1230334 Vali Loss: 0.0385081 Test Loss: 0.1237361
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1158035
	speed: 0.0375s/iter; left time: 231.4797s
	iters: 200, epoch: 10 | loss: 0.0832513
	speed: 0.0109s/iter; left time: 65.8910s
	iters: 300, epoch: 10 | loss: 0.1323909
	speed: 0.0108s/iter; left time: 64.7641s
	iters: 400, epoch: 10 | loss: 0.0938356
	speed: 0.0109s/iter; left time: 63.8529s
	iters: 500, epoch: 10 | loss: 0.1200961
	speed: 0.0109s/iter; left time: 62.7619s
Epoch: 10 cost time: 6.480654239654541
Epoch: 10, Steps: 570 | Train Loss: 0.1232119 Vali Loss: 0.0384464 Test Loss: 0.1238844
Validation loss decreased (0.038467 --> 0.038446).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0880294
	speed: 0.0388s/iter; left time: 217.2878s
	iters: 200, epoch: 11 | loss: 0.1333495
	speed: 0.0111s/iter; left time: 61.0654s
	iters: 300, epoch: 11 | loss: 0.1132784
	speed: 0.0120s/iter; left time: 64.8586s
	iters: 400, epoch: 11 | loss: 0.0909003
	speed: 0.0120s/iter; left time: 63.6324s
	iters: 500, epoch: 11 | loss: 0.0962447
	speed: 0.0120s/iter; left time: 62.2163s
Epoch: 11 cost time: 6.871223449707031
Epoch: 11, Steps: 570 | Train Loss: 0.1235934 Vali Loss: 0.0384384 Test Loss: 0.1238350
Validation loss decreased (0.038446 --> 0.038438).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1400836
	speed: 0.0373s/iter; left time: 187.8177s
	iters: 200, epoch: 12 | loss: 0.1498244
	speed: 0.0108s/iter; left time: 53.2179s
	iters: 300, epoch: 12 | loss: 0.1078468
	speed: 0.0108s/iter; left time: 52.0624s
	iters: 400, epoch: 12 | loss: 0.1485666
	speed: 0.0108s/iter; left time: 51.0455s
	iters: 500, epoch: 12 | loss: 0.1239595
	speed: 0.0107s/iter; left time: 49.7550s
Epoch: 12 cost time: 6.454135417938232
Epoch: 12, Steps: 570 | Train Loss: 0.1226309 Vali Loss: 0.0384481 Test Loss: 0.1238305
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0807109
	speed: 0.0361s/iter; left time: 160.8338s
	iters: 200, epoch: 13 | loss: 0.1681882
	speed: 0.0109s/iter; left time: 47.4169s
	iters: 300, epoch: 13 | loss: 0.0886898
	speed: 0.0109s/iter; left time: 46.3241s
	iters: 400, epoch: 13 | loss: 0.0915739
	speed: 0.0109s/iter; left time: 45.2089s
	iters: 500, epoch: 13 | loss: 0.1158995
	speed: 0.0107s/iter; left time: 43.6164s
Epoch: 13 cost time: 6.458467960357666
Epoch: 13, Steps: 570 | Train Loss: 0.1236351 Vali Loss: 0.0384767 Test Loss: 0.1238470
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1881920
	speed: 0.0378s/iter; left time: 146.9282s
	iters: 200, epoch: 14 | loss: 0.1902320
	speed: 0.0120s/iter; left time: 45.4242s
	iters: 300, epoch: 14 | loss: 0.1145264
	speed: 0.0120s/iter; left time: 44.3194s
	iters: 400, epoch: 14 | loss: 0.1251795
	speed: 0.0109s/iter; left time: 38.9837s
	iters: 500, epoch: 14 | loss: 0.1174224
	speed: 0.0108s/iter; left time: 37.6939s
Epoch: 14 cost time: 6.804464340209961
Epoch: 14, Steps: 570 | Train Loss: 0.1234293 Vali Loss: 0.0384395 Test Loss: 0.1238526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1240076944231987, mae:0.22189994156360626
>>> MS_Raw LR=1e-4 DO=0.1 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2047569
	speed: 0.0268s/iter; left time: 303.1468s
	iters: 200, epoch: 1 | loss: 0.1721311
	speed: 0.0146s/iter; left time: 163.6925s
	iters: 300, epoch: 1 | loss: 0.2918872
	speed: 0.0146s/iter; left time: 162.5088s
	iters: 400, epoch: 1 | loss: 0.1840911
	speed: 0.0147s/iter; left time: 161.3419s
	iters: 500, epoch: 1 | loss: 0.1514521
	speed: 0.0147s/iter; left time: 160.0844s
Epoch: 1 cost time: 9.626728057861328
Epoch: 1, Steps: 570 | Train Loss: 0.2111790 Vali Loss: 0.0435493 Test Loss: 0.1358985
Validation loss decreased (inf --> 0.043549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2041141
	speed: 0.0480s/iter; left time: 515.0606s
	iters: 200, epoch: 2 | loss: 0.1462274
	speed: 0.0146s/iter; left time: 155.5934s
	iters: 300, epoch: 2 | loss: 0.1372207
	speed: 0.0146s/iter; left time: 153.7048s
	iters: 400, epoch: 2 | loss: 0.1192545
	speed: 0.0146s/iter; left time: 152.2598s
	iters: 500, epoch: 2 | loss: 0.1763059
	speed: 0.0146s/iter; left time: 150.5724s
Epoch: 2 cost time: 8.668962955474854
Epoch: 2, Steps: 570 | Train Loss: 0.1698193 Vali Loss: 0.0397341 Test Loss: 0.1301434
Validation loss decreased (0.043549 --> 0.039734).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2607693
	speed: 0.0468s/iter; left time: 475.2716s
	iters: 200, epoch: 3 | loss: 0.1628471
	speed: 0.0146s/iter; left time: 146.6538s
	iters: 300, epoch: 3 | loss: 0.1069581
	speed: 0.0148s/iter; left time: 147.7337s
	iters: 400, epoch: 3 | loss: 0.1171424
	speed: 0.0167s/iter; left time: 165.0076s
	iters: 500, epoch: 3 | loss: 0.1060702
	speed: 0.0168s/iter; left time: 163.8750s
Epoch: 3 cost time: 9.226580381393433
Epoch: 3, Steps: 570 | Train Loss: 0.1490578 Vali Loss: 0.0359175 Test Loss: 0.1201296
Validation loss decreased (0.039734 --> 0.035917).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1515058
	speed: 0.0517s/iter; left time: 496.2118s
	iters: 200, epoch: 4 | loss: 0.1164116
	speed: 0.0168s/iter; left time: 159.3061s
	iters: 300, epoch: 4 | loss: 0.1514658
	speed: 0.0168s/iter; left time: 157.6473s
	iters: 400, epoch: 4 | loss: 0.1478230
	speed: 0.0168s/iter; left time: 155.8648s
	iters: 500, epoch: 4 | loss: 0.1313840
	speed: 0.0168s/iter; left time: 154.4347s
Epoch: 4 cost time: 9.867477178573608
Epoch: 4, Steps: 570 | Train Loss: 0.1398823 Vali Loss: 0.0353378 Test Loss: 0.1230004
Validation loss decreased (0.035917 --> 0.035338).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1263737
	speed: 0.0499s/iter; left time: 450.1266s
	iters: 200, epoch: 5 | loss: 0.1141983
	speed: 0.0166s/iter; left time: 148.3024s
	iters: 300, epoch: 5 | loss: 0.1274197
	speed: 0.0166s/iter; left time: 146.6170s
	iters: 400, epoch: 5 | loss: 0.1358247
	speed: 0.0166s/iter; left time: 144.8587s
	iters: 500, epoch: 5 | loss: 0.1271198
	speed: 0.0166s/iter; left time: 143.2200s
Epoch: 5 cost time: 9.740049839019775
Epoch: 5, Steps: 570 | Train Loss: 0.1352223 Vali Loss: 0.0348664 Test Loss: 0.1199729
Validation loss decreased (0.035338 --> 0.034866).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0976155
	speed: 0.0498s/iter; left time: 421.2006s
	iters: 200, epoch: 6 | loss: 0.1496920
	speed: 0.0168s/iter; left time: 139.9054s
	iters: 300, epoch: 6 | loss: 0.1000441
	speed: 0.0167s/iter; left time: 138.0686s
	iters: 400, epoch: 6 | loss: 0.0984927
	speed: 0.0167s/iter; left time: 136.5018s
	iters: 500, epoch: 6 | loss: 0.1439775
	speed: 0.0167s/iter; left time: 134.5499s
Epoch: 6 cost time: 9.818142652511597
Epoch: 6, Steps: 570 | Train Loss: 0.1312461 Vali Loss: 0.0346095 Test Loss: 0.1215637
Validation loss decreased (0.034866 --> 0.034610).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1307121
	speed: 0.0495s/iter; left time: 390.1480s
	iters: 200, epoch: 7 | loss: 0.1020568
	speed: 0.0166s/iter; left time: 129.5018s
	iters: 300, epoch: 7 | loss: 0.1043422
	speed: 0.0162s/iter; left time: 124.5936s
	iters: 400, epoch: 7 | loss: 0.1314693
	speed: 0.0145s/iter; left time: 110.1324s
	iters: 500, epoch: 7 | loss: 0.2119968
	speed: 0.0145s/iter; left time: 108.6412s
Epoch: 7 cost time: 9.168764591217041
Epoch: 7, Steps: 570 | Train Loss: 0.1305236 Vali Loss: 0.0346760 Test Loss: 0.1211119
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1867866
	speed: 0.0461s/iter; left time: 337.3096s
	iters: 200, epoch: 8 | loss: 0.1295784
	speed: 0.0147s/iter; left time: 105.7406s
	iters: 300, epoch: 8 | loss: 0.1420640
	speed: 0.0147s/iter; left time: 104.2291s
	iters: 400, epoch: 8 | loss: 0.0948894
	speed: 0.0146s/iter; left time: 102.3200s
	iters: 500, epoch: 8 | loss: 0.1524995
	speed: 0.0146s/iter; left time: 101.1191s
Epoch: 8 cost time: 8.625536680221558
Epoch: 8, Steps: 570 | Train Loss: 0.1304179 Vali Loss: 0.0348385 Test Loss: 0.1214825
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1644307
	speed: 0.0480s/iter; left time: 323.6012s
	iters: 200, epoch: 9 | loss: 0.1492928
	speed: 0.0145s/iter; left time: 96.3978s
	iters: 300, epoch: 9 | loss: 0.1900343
	speed: 0.0145s/iter; left time: 94.9030s
	iters: 400, epoch: 9 | loss: 0.1507646
	speed: 0.0145s/iter; left time: 93.4294s
	iters: 500, epoch: 9 | loss: 0.1052462
	speed: 0.0145s/iter; left time: 91.9970s
Epoch: 9 cost time: 8.565718412399292
Epoch: 9, Steps: 570 | Train Loss: 0.1295061 Vali Loss: 0.0347421 Test Loss: 0.1210433
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12174582481384277, mae:0.21724450588226318
>>> MS_Raw LR=1e-4 DO=0.1 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2714466
	speed: 0.0259s/iter; left time: 292.2979s
	iters: 200, epoch: 1 | loss: 0.1833450
	speed: 0.0142s/iter; left time: 158.9737s
	iters: 300, epoch: 1 | loss: 0.1116743
	speed: 0.0142s/iter; left time: 157.5309s
	iters: 400, epoch: 1 | loss: 0.2457210
	speed: 0.0142s/iter; left time: 155.9214s
	iters: 500, epoch: 1 | loss: 0.1758959
	speed: 0.0142s/iter; left time: 154.4532s
Epoch: 1 cost time: 9.309945106506348
Epoch: 1, Steps: 570 | Train Loss: 0.1832130 Vali Loss: 0.0354777 Test Loss: 0.1102525
Validation loss decreased (inf --> 0.035478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1255521
	speed: 0.0458s/iter; left time: 491.0300s
	iters: 200, epoch: 2 | loss: 0.2327390
	speed: 0.0143s/iter; left time: 152.1060s
	iters: 300, epoch: 2 | loss: 0.1772514
	speed: 0.0143s/iter; left time: 150.5722s
	iters: 400, epoch: 2 | loss: 0.1205304
	speed: 0.0143s/iter; left time: 149.3824s
	iters: 500, epoch: 2 | loss: 0.1233689
	speed: 0.0143s/iter; left time: 147.7609s
Epoch: 2 cost time: 8.439820051193237
Epoch: 2, Steps: 570 | Train Loss: 0.1506715 Vali Loss: 0.0339201 Test Loss: 0.1126614
Validation loss decreased (0.035478 --> 0.033920).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1473355
	speed: 0.0455s/iter; left time: 462.5027s
	iters: 200, epoch: 3 | loss: 0.0864547
	speed: 0.0142s/iter; left time: 142.5671s
	iters: 300, epoch: 3 | loss: 0.1745018
	speed: 0.0142s/iter; left time: 141.9163s
	iters: 400, epoch: 3 | loss: 0.1090745
	speed: 0.0154s/iter; left time: 151.9573s
	iters: 500, epoch: 3 | loss: 0.1212042
	speed: 0.0159s/iter; left time: 155.1788s
Epoch: 3 cost time: 8.799126863479614
Epoch: 3, Steps: 570 | Train Loss: 0.1344462 Vali Loss: 0.0329960 Test Loss: 0.1109708
Validation loss decreased (0.033920 --> 0.032996).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1262608
	speed: 0.0468s/iter; left time: 449.2014s
	iters: 200, epoch: 4 | loss: 0.1213391
	speed: 0.0143s/iter; left time: 135.2667s
	iters: 300, epoch: 4 | loss: 0.1373242
	speed: 0.0143s/iter; left time: 133.8820s
	iters: 400, epoch: 4 | loss: 0.0776137
	speed: 0.0142s/iter; left time: 132.3815s
	iters: 500, epoch: 4 | loss: 0.0916152
	speed: 0.0142s/iter; left time: 130.7712s
Epoch: 4 cost time: 8.38807487487793
Epoch: 4, Steps: 570 | Train Loss: 0.1285917 Vali Loss: 0.0319500 Test Loss: 0.1105838
Validation loss decreased (0.032996 --> 0.031950).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0646266
	speed: 0.0456s/iter; left time: 411.5797s
	iters: 200, epoch: 5 | loss: 0.1230586
	speed: 0.0141s/iter; left time: 126.1498s
	iters: 300, epoch: 5 | loss: 0.1696747
	speed: 0.0141s/iter; left time: 124.6364s
	iters: 400, epoch: 5 | loss: 0.1049808
	speed: 0.0141s/iter; left time: 123.2460s
	iters: 500, epoch: 5 | loss: 0.1418797
	speed: 0.0141s/iter; left time: 121.9004s
Epoch: 5 cost time: 8.36150336265564
Epoch: 5, Steps: 570 | Train Loss: 0.1240557 Vali Loss: 0.0317498 Test Loss: 0.1098400
Validation loss decreased (0.031950 --> 0.031750).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1115341
	speed: 0.0451s/iter; left time: 380.9574s
	iters: 200, epoch: 6 | loss: 0.2230012
	speed: 0.0142s/iter; left time: 118.4062s
	iters: 300, epoch: 6 | loss: 0.1876464
	speed: 0.0142s/iter; left time: 117.2470s
	iters: 400, epoch: 6 | loss: 0.1356148
	speed: 0.0142s/iter; left time: 115.6579s
	iters: 500, epoch: 6 | loss: 0.1370379
	speed: 0.0142s/iter; left time: 114.0779s
Epoch: 6 cost time: 8.37508773803711
Epoch: 6, Steps: 570 | Train Loss: 0.1222151 Vali Loss: 0.0315075 Test Loss: 0.1099989
Validation loss decreased (0.031750 --> 0.031507).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0917359
	speed: 0.0472s/iter; left time: 371.6822s
	iters: 200, epoch: 7 | loss: 0.1327952
	speed: 0.0142s/iter; left time: 110.2046s
	iters: 300, epoch: 7 | loss: 0.1693450
	speed: 0.0142s/iter; left time: 108.6911s
	iters: 400, epoch: 7 | loss: 0.1225072
	speed: 0.0142s/iter; left time: 107.3521s
	iters: 500, epoch: 7 | loss: 0.1464634
	speed: 0.0142s/iter; left time: 106.4286s
Epoch: 7 cost time: 8.349700689315796
Epoch: 7, Steps: 570 | Train Loss: 0.1204937 Vali Loss: 0.0312481 Test Loss: 0.1096683
Validation loss decreased (0.031507 --> 0.031248).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0855149
	speed: 0.0454s/iter; left time: 331.7182s
	iters: 200, epoch: 8 | loss: 0.1063012
	speed: 0.0143s/iter; left time: 103.0129s
	iters: 300, epoch: 8 | loss: 0.1573913
	speed: 0.0143s/iter; left time: 101.6902s
	iters: 400, epoch: 8 | loss: 0.1176097
	speed: 0.0143s/iter; left time: 100.0474s
	iters: 500, epoch: 8 | loss: 0.1097314
	speed: 0.0143s/iter; left time: 98.7274s
Epoch: 8 cost time: 8.43140196800232
Epoch: 8, Steps: 570 | Train Loss: 0.1196738 Vali Loss: 0.0313694 Test Loss: 0.1097663
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0974496
	speed: 0.0455s/iter; left time: 306.4289s
	iters: 200, epoch: 9 | loss: 0.1121854
	speed: 0.0142s/iter; left time: 94.1802s
	iters: 300, epoch: 9 | loss: 0.1125480
	speed: 0.0142s/iter; left time: 92.5893s
	iters: 400, epoch: 9 | loss: 0.0968294
	speed: 0.0142s/iter; left time: 91.1944s
	iters: 500, epoch: 9 | loss: 0.1291035
	speed: 0.0141s/iter; left time: 89.5738s
Epoch: 9 cost time: 8.353727102279663
Epoch: 9, Steps: 570 | Train Loss: 0.1191862 Vali Loss: 0.0312849 Test Loss: 0.1098480
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1136008
	speed: 0.0467s/iter; left time: 287.9682s
	iters: 200, epoch: 10 | loss: 0.1118148
	speed: 0.0142s/iter; left time: 85.9447s
	iters: 300, epoch: 10 | loss: 0.1124306
	speed: 0.0142s/iter; left time: 84.5045s
	iters: 400, epoch: 10 | loss: 0.1297452
	speed: 0.0141s/iter; left time: 83.0409s
	iters: 500, epoch: 10 | loss: 0.1475537
	speed: 0.0141s/iter; left time: 81.5437s
Epoch: 10 cost time: 8.334047555923462
Epoch: 10, Steps: 570 | Train Loss: 0.1196228 Vali Loss: 0.0313251 Test Loss: 0.1098910
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10982311517000198, mae:0.20000316202640533
>>> MS_Raw LR=1e-4 DO=0.1 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1340132
	speed: 0.0279s/iter; left time: 315.5479s
	iters: 200, epoch: 1 | loss: 0.2731330
	speed: 0.0160s/iter; left time: 179.7736s
	iters: 300, epoch: 1 | loss: 0.2700988
	speed: 0.0150s/iter; left time: 166.2756s
	iters: 400, epoch: 1 | loss: 0.2357663
	speed: 0.0142s/iter; left time: 156.6125s
	iters: 500, epoch: 1 | loss: 0.2441259
	speed: 0.0142s/iter; left time: 154.8936s
Epoch: 1 cost time: 9.779451370239258
Epoch: 1, Steps: 570 | Train Loss: 0.2175356 Vali Loss: 0.0434821 Test Loss: 0.1324463
Validation loss decreased (inf --> 0.043482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1540688
	speed: 0.0485s/iter; left time: 520.3619s
	iters: 200, epoch: 2 | loss: 0.1154824
	speed: 0.0144s/iter; left time: 153.5975s
	iters: 300, epoch: 2 | loss: 0.1036720
	speed: 0.0145s/iter; left time: 152.3583s
	iters: 400, epoch: 2 | loss: 0.1394471
	speed: 0.0144s/iter; left time: 150.6636s
	iters: 500, epoch: 2 | loss: 0.2109354
	speed: 0.0144s/iter; left time: 149.2702s
Epoch: 2 cost time: 8.503076553344727
Epoch: 2, Steps: 570 | Train Loss: 0.1765220 Vali Loss: 0.0419425 Test Loss: 0.1278307
Validation loss decreased (0.043482 --> 0.041942).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1866744
	speed: 0.0464s/iter; left time: 470.9775s
	iters: 200, epoch: 3 | loss: 0.1807503
	speed: 0.0144s/iter; left time: 145.3272s
	iters: 300, epoch: 3 | loss: 0.1508223
	speed: 0.0145s/iter; left time: 144.2826s
	iters: 400, epoch: 3 | loss: 0.1283116
	speed: 0.0145s/iter; left time: 143.0108s
	iters: 500, epoch: 3 | loss: 0.1517522
	speed: 0.0145s/iter; left time: 141.3716s
Epoch: 3 cost time: 8.616644859313965
Epoch: 3, Steps: 570 | Train Loss: 0.1552826 Vali Loss: 0.0393618 Test Loss: 0.1237901
Validation loss decreased (0.041942 --> 0.039362).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1693730
	speed: 0.0481s/iter; left time: 461.7290s
	iters: 200, epoch: 4 | loss: 0.1441906
	speed: 0.0163s/iter; left time: 154.3604s
	iters: 300, epoch: 4 | loss: 0.1830863
	speed: 0.0163s/iter; left time: 152.8476s
	iters: 400, epoch: 4 | loss: 0.1477285
	speed: 0.0163s/iter; left time: 151.1010s
	iters: 500, epoch: 4 | loss: 0.1046303
	speed: 0.0162s/iter; left time: 149.3075s
Epoch: 4 cost time: 9.543181657791138
Epoch: 4, Steps: 570 | Train Loss: 0.1463910 Vali Loss: 0.0377049 Test Loss: 0.1226720
Validation loss decreased (0.039362 --> 0.037705).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1406279
	speed: 0.0472s/iter; left time: 425.9563s
	iters: 200, epoch: 5 | loss: 0.1610852
	speed: 0.0144s/iter; left time: 128.7247s
	iters: 300, epoch: 5 | loss: 0.1367887
	speed: 0.0145s/iter; left time: 127.4710s
	iters: 400, epoch: 5 | loss: 0.1876882
	speed: 0.0144s/iter; left time: 125.7247s
	iters: 500, epoch: 5 | loss: 0.1052222
	speed: 0.0144s/iter; left time: 124.2614s
Epoch: 5 cost time: 8.489254236221313
Epoch: 5, Steps: 570 | Train Loss: 0.1414276 Vali Loss: 0.0380426 Test Loss: 0.1222891
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2116309
	speed: 0.0447s/iter; left time: 377.9928s
	iters: 200, epoch: 6 | loss: 0.1298434
	speed: 0.0144s/iter; left time: 119.8378s
	iters: 300, epoch: 6 | loss: 0.0935109
	speed: 0.0143s/iter; left time: 118.2942s
	iters: 400, epoch: 6 | loss: 0.1730927
	speed: 0.0144s/iter; left time: 117.0273s
	iters: 500, epoch: 6 | loss: 0.1374914
	speed: 0.0143s/iter; left time: 115.3949s
Epoch: 6 cost time: 8.434705257415771
Epoch: 6, Steps: 570 | Train Loss: 0.1391261 Vali Loss: 0.0377288 Test Loss: 0.1226217
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1686033
	speed: 0.0452s/iter; left time: 356.3130s
	iters: 200, epoch: 7 | loss: 0.0903399
	speed: 0.0144s/iter; left time: 112.1303s
	iters: 300, epoch: 7 | loss: 0.1061012
	speed: 0.0144s/iter; left time: 110.7511s
	iters: 400, epoch: 7 | loss: 0.1717959
	speed: 0.0144s/iter; left time: 108.9349s
	iters: 500, epoch: 7 | loss: 0.1215039
	speed: 0.0144s/iter; left time: 107.4858s
Epoch: 7 cost time: 8.450045585632324
Epoch: 7, Steps: 570 | Train Loss: 0.1389024 Vali Loss: 0.0375392 Test Loss: 0.1220629
Validation loss decreased (0.037705 --> 0.037539).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1050478
	speed: 0.0455s/iter; left time: 332.6323s
	iters: 200, epoch: 8 | loss: 0.1073643
	speed: 0.0144s/iter; left time: 103.7043s
	iters: 300, epoch: 8 | loss: 0.1274797
	speed: 0.0144s/iter; left time: 102.2914s
	iters: 400, epoch: 8 | loss: 0.1463042
	speed: 0.0144s/iter; left time: 100.9367s
	iters: 500, epoch: 8 | loss: 0.1025157
	speed: 0.0144s/iter; left time: 99.4627s
Epoch: 8 cost time: 8.461096286773682
Epoch: 8, Steps: 570 | Train Loss: 0.1376869 Vali Loss: 0.0380538 Test Loss: 0.1229385
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1774512
	speed: 0.0457s/iter; left time: 307.8020s
	iters: 200, epoch: 9 | loss: 0.1372954
	speed: 0.0144s/iter; left time: 95.5341s
	iters: 300, epoch: 9 | loss: 0.0735341
	speed: 0.0144s/iter; left time: 94.1330s
	iters: 400, epoch: 9 | loss: 0.1188553
	speed: 0.0144s/iter; left time: 92.6459s
	iters: 500, epoch: 9 | loss: 0.1156157
	speed: 0.0144s/iter; left time: 91.2541s
Epoch: 9 cost time: 8.456011533737183
Epoch: 9, Steps: 570 | Train Loss: 0.1363195 Vali Loss: 0.0376753 Test Loss: 0.1227020
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1548845
	speed: 0.0461s/iter; left time: 284.5934s
	iters: 200, epoch: 10 | loss: 0.1635989
	speed: 0.0143s/iter; left time: 86.7370s
	iters: 300, epoch: 10 | loss: 0.1354944
	speed: 0.0143s/iter; left time: 85.5933s
	iters: 400, epoch: 10 | loss: 0.1608072
	speed: 0.0143s/iter; left time: 83.8592s
	iters: 500, epoch: 10 | loss: 0.1307496
	speed: 0.0143s/iter; left time: 82.6329s
Epoch: 10 cost time: 8.401552200317383
Epoch: 10, Steps: 570 | Train Loss: 0.1368901 Vali Loss: 0.0376425 Test Loss: 0.1224218
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12225611507892609, mae:0.21893946826457977
>>> MS_Raw LR=1e-4 DO=0.1 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2642496
	speed: 0.0306s/iter; left time: 345.6500s
	iters: 200, epoch: 1 | loss: 0.1672373
	speed: 0.0184s/iter; left time: 206.2680s
	iters: 300, epoch: 1 | loss: 0.2110314
	speed: 0.0176s/iter; left time: 195.8099s
	iters: 400, epoch: 1 | loss: 0.1752806
	speed: 0.0169s/iter; left time: 186.3208s
	iters: 500, epoch: 1 | loss: 0.1534884
	speed: 0.0169s/iter; left time: 184.6245s
Epoch: 1 cost time: 11.285790920257568
Epoch: 1, Steps: 570 | Train Loss: 0.2048573 Vali Loss: 0.0442407 Test Loss: 0.1334456
Validation loss decreased (inf --> 0.044241).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1922308
	speed: 0.0536s/iter; left time: 574.9862s
	iters: 200, epoch: 2 | loss: 0.1989005
	speed: 0.0172s/iter; left time: 182.9969s
	iters: 300, epoch: 2 | loss: 0.1904143
	speed: 0.0169s/iter; left time: 177.7465s
	iters: 400, epoch: 2 | loss: 0.1112681
	speed: 0.0169s/iter; left time: 176.3633s
	iters: 500, epoch: 2 | loss: 0.1280198
	speed: 0.0182s/iter; left time: 188.1337s
Epoch: 2 cost time: 10.3955237865448
Epoch: 2, Steps: 570 | Train Loss: 0.1616140 Vali Loss: 0.0378118 Test Loss: 0.1226735
Validation loss decreased (0.044241 --> 0.037812).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1237671
	speed: 0.0519s/iter; left time: 527.8049s
	iters: 200, epoch: 3 | loss: 0.1354339
	speed: 0.0169s/iter; left time: 170.5313s
	iters: 300, epoch: 3 | loss: 0.2374647
	speed: 0.0169s/iter; left time: 168.8157s
	iters: 400, epoch: 3 | loss: 0.1247521
	speed: 0.0169s/iter; left time: 167.1116s
	iters: 500, epoch: 3 | loss: 0.0987477
	speed: 0.0169s/iter; left time: 165.3290s
Epoch: 3 cost time: 9.984603643417358
Epoch: 3, Steps: 570 | Train Loss: 0.1346405 Vali Loss: 0.0368421 Test Loss: 0.1211564
Validation loss decreased (0.037812 --> 0.036842).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0937603
	speed: 0.0525s/iter; left time: 503.8024s
	iters: 200, epoch: 4 | loss: 0.1194085
	speed: 0.0169s/iter; left time: 160.7146s
	iters: 300, epoch: 4 | loss: 0.1261603
	speed: 0.0169s/iter; left time: 159.0926s
	iters: 400, epoch: 4 | loss: 0.1470387
	speed: 0.0169s/iter; left time: 157.3066s
	iters: 500, epoch: 4 | loss: 0.1260980
	speed: 0.0169s/iter; left time: 155.5108s
Epoch: 4 cost time: 9.993114948272705
Epoch: 4, Steps: 570 | Train Loss: 0.1197446 Vali Loss: 0.0364672 Test Loss: 0.1205641
Validation loss decreased (0.036842 --> 0.036467).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0868400
	speed: 0.0550s/iter; left time: 495.7133s
	iters: 200, epoch: 5 | loss: 0.1205349
	speed: 0.0169s/iter; left time: 150.8375s
	iters: 300, epoch: 5 | loss: 0.1141921
	speed: 0.0169s/iter; left time: 149.3797s
	iters: 400, epoch: 5 | loss: 0.1284914
	speed: 0.0170s/iter; left time: 147.8965s
	iters: 500, epoch: 5 | loss: 0.0882356
	speed: 0.0170s/iter; left time: 146.1302s
Epoch: 5 cost time: 9.979516506195068
Epoch: 5, Steps: 570 | Train Loss: 0.1131571 Vali Loss: 0.0348938 Test Loss: 0.1195340
Validation loss decreased (0.036467 --> 0.034894).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1147439
	speed: 0.0515s/iter; left time: 434.8093s
	iters: 200, epoch: 6 | loss: 0.0958291
	speed: 0.0170s/iter; left time: 141.8544s
	iters: 300, epoch: 6 | loss: 0.1061931
	speed: 0.0170s/iter; left time: 140.1087s
	iters: 400, epoch: 6 | loss: 0.1339055
	speed: 0.0170s/iter; left time: 138.4066s
	iters: 500, epoch: 6 | loss: 0.1064150
	speed: 0.0170s/iter; left time: 136.6222s
Epoch: 6 cost time: 10.018980979919434
Epoch: 6, Steps: 570 | Train Loss: 0.1091125 Vali Loss: 0.0349584 Test Loss: 0.1170439
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1292955
	speed: 0.0518s/iter; left time: 408.2759s
	iters: 200, epoch: 7 | loss: 0.1387319
	speed: 0.0169s/iter; left time: 131.7306s
	iters: 300, epoch: 7 | loss: 0.1260076
	speed: 0.0169s/iter; left time: 129.9914s
	iters: 400, epoch: 7 | loss: 0.0798721
	speed: 0.0169s/iter; left time: 128.3372s
	iters: 500, epoch: 7 | loss: 0.0855768
	speed: 0.0169s/iter; left time: 126.5408s
Epoch: 7 cost time: 9.962383508682251
Epoch: 7, Steps: 570 | Train Loss: 0.1072664 Vali Loss: 0.0340650 Test Loss: 0.1183059
Validation loss decreased (0.034894 --> 0.034065).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0993857
	speed: 0.0506s/iter; left time: 369.8929s
	iters: 200, epoch: 8 | loss: 0.0821224
	speed: 0.0169s/iter; left time: 121.9896s
	iters: 300, epoch: 8 | loss: 0.1028370
	speed: 0.0169s/iter; left time: 120.3225s
	iters: 400, epoch: 8 | loss: 0.0694930
	speed: 0.0169s/iter; left time: 118.6833s
	iters: 500, epoch: 8 | loss: 0.0738068
	speed: 0.0169s/iter; left time: 116.9815s
Epoch: 8 cost time: 9.961901664733887
Epoch: 8, Steps: 570 | Train Loss: 0.1070141 Vali Loss: 0.0343289 Test Loss: 0.1180926
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0767808
	speed: 0.0500s/iter; left time: 337.0919s
	iters: 200, epoch: 9 | loss: 0.0842962
	speed: 0.0169s/iter; left time: 112.0113s
	iters: 300, epoch: 9 | loss: 0.0946802
	speed: 0.0169s/iter; left time: 110.2328s
	iters: 400, epoch: 9 | loss: 0.0880783
	speed: 0.0168s/iter; left time: 108.5008s
	iters: 500, epoch: 9 | loss: 0.1501595
	speed: 0.0168s/iter; left time: 106.8163s
Epoch: 9 cost time: 9.924157619476318
Epoch: 9, Steps: 570 | Train Loss: 0.1058018 Vali Loss: 0.0342370 Test Loss: 0.1178512
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1148590
	speed: 0.0524s/iter; left time: 323.4671s
	iters: 200, epoch: 10 | loss: 0.0611055
	speed: 0.0184s/iter; left time: 111.9779s
	iters: 300, epoch: 10 | loss: 0.1586422
	speed: 0.0171s/iter; left time: 102.1786s
	iters: 400, epoch: 10 | loss: 0.0999018
	speed: 0.0169s/iter; left time: 99.0671s
	iters: 500, epoch: 10 | loss: 0.0855434
	speed: 0.0169s/iter; left time: 97.3510s
Epoch: 10 cost time: 10.252867937088013
Epoch: 10, Steps: 570 | Train Loss: 0.1060700 Vali Loss: 0.0345414 Test Loss: 0.1175926
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1184559091925621, mae:0.21707218885421753
>>> MS_Raw LR=1e-4 DO=0.1 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1555285
	speed: 0.0283s/iter; left time: 319.9375s
	iters: 200, epoch: 1 | loss: 0.1058938
	speed: 0.0165s/iter; left time: 184.8389s
	iters: 300, epoch: 1 | loss: 0.1976846
	speed: 0.0165s/iter; left time: 183.1516s
	iters: 400, epoch: 1 | loss: 0.1717134
	speed: 0.0165s/iter; left time: 181.9563s
	iters: 500, epoch: 1 | loss: 0.1015578
	speed: 0.0165s/iter; left time: 180.0575s
Epoch: 1 cost time: 10.641869068145752
Epoch: 1, Steps: 570 | Train Loss: 0.1783853 Vali Loss: 0.0342684 Test Loss: 0.1115713
Validation loss decreased (inf --> 0.034268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1322298
	speed: 0.0531s/iter; left time: 569.9091s
	iters: 200, epoch: 2 | loss: 0.1116886
	speed: 0.0166s/iter; left time: 176.5465s
	iters: 300, epoch: 2 | loss: 0.2077729
	speed: 0.0166s/iter; left time: 174.5591s
	iters: 400, epoch: 2 | loss: 0.1784001
	speed: 0.0165s/iter; left time: 172.5631s
	iters: 500, epoch: 2 | loss: 0.1166745
	speed: 0.0166s/iter; left time: 171.1020s
Epoch: 2 cost time: 9.922757625579834
Epoch: 2, Steps: 570 | Train Loss: 0.1438919 Vali Loss: 0.0351572 Test Loss: 0.1138219
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1210392
	speed: 0.0519s/iter; left time: 526.9203s
	iters: 200, epoch: 3 | loss: 0.1237201
	speed: 0.0165s/iter; left time: 165.9099s
	iters: 300, epoch: 3 | loss: 0.1078374
	speed: 0.0165s/iter; left time: 164.0425s
	iters: 400, epoch: 3 | loss: 0.1568393
	speed: 0.0165s/iter; left time: 162.2520s
	iters: 500, epoch: 3 | loss: 0.0859967
	speed: 0.0165s/iter; left time: 160.6762s
Epoch: 3 cost time: 9.713839769363403
Epoch: 3, Steps: 570 | Train Loss: 0.1227649 Vali Loss: 0.0325438 Test Loss: 0.1098657
Validation loss decreased (0.034268 --> 0.032544).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1230057
	speed: 0.0528s/iter; left time: 506.2525s
	iters: 200, epoch: 4 | loss: 0.1713229
	speed: 0.0179s/iter; left time: 170.1374s
	iters: 300, epoch: 4 | loss: 0.0925769
	speed: 0.0179s/iter; left time: 168.2856s
	iters: 400, epoch: 4 | loss: 0.0831985
	speed: 0.0179s/iter; left time: 166.4655s
	iters: 500, epoch: 4 | loss: 0.1476100
	speed: 0.0179s/iter; left time: 164.7181s
Epoch: 4 cost time: 10.55945372581482
Epoch: 4, Steps: 570 | Train Loss: 0.1103549 Vali Loss: 0.0322846 Test Loss: 0.1100513
Validation loss decreased (0.032544 --> 0.032285).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1093887
	speed: 0.0525s/iter; left time: 473.3894s
	iters: 200, epoch: 5 | loss: 0.1200557
	speed: 0.0164s/iter; left time: 146.6069s
	iters: 300, epoch: 5 | loss: 0.1096876
	speed: 0.0164s/iter; left time: 145.0167s
	iters: 400, epoch: 5 | loss: 0.0723158
	speed: 0.0165s/iter; left time: 143.5536s
	iters: 500, epoch: 5 | loss: 0.1374758
	speed: 0.0164s/iter; left time: 141.7471s
Epoch: 5 cost time: 9.707770347595215
Epoch: 5, Steps: 570 | Train Loss: 0.1053676 Vali Loss: 0.0319508 Test Loss: 0.1103467
Validation loss decreased (0.032285 --> 0.031951).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0999631
	speed: 0.0538s/iter; left time: 454.6707s
	iters: 200, epoch: 6 | loss: 0.1338409
	speed: 0.0164s/iter; left time: 137.2014s
	iters: 300, epoch: 6 | loss: 0.1689444
	speed: 0.0164s/iter; left time: 135.5142s
	iters: 400, epoch: 6 | loss: 0.1071086
	speed: 0.0164s/iter; left time: 133.9417s
	iters: 500, epoch: 6 | loss: 0.1048287
	speed: 0.0164s/iter; left time: 132.0987s
Epoch: 6 cost time: 9.715508699417114
Epoch: 6, Steps: 570 | Train Loss: 0.1028331 Vali Loss: 0.0320684 Test Loss: 0.1101003
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1261138
	speed: 0.0509s/iter; left time: 400.8079s
	iters: 200, epoch: 7 | loss: 0.0776426
	speed: 0.0165s/iter; left time: 128.3088s
	iters: 300, epoch: 7 | loss: 0.0916797
	speed: 0.0165s/iter; left time: 126.8035s
	iters: 400, epoch: 7 | loss: 0.1496750
	speed: 0.0165s/iter; left time: 125.0913s
	iters: 500, epoch: 7 | loss: 0.0992560
	speed: 0.0165s/iter; left time: 123.2715s
Epoch: 7 cost time: 9.742568731307983
Epoch: 7, Steps: 570 | Train Loss: 0.1012986 Vali Loss: 0.0322577 Test Loss: 0.1099045
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0672307
	speed: 0.0554s/iter; left time: 404.8371s
	iters: 200, epoch: 8 | loss: 0.1146743
	speed: 0.0179s/iter; left time: 129.2021s
	iters: 300, epoch: 8 | loss: 0.1142103
	speed: 0.0179s/iter; left time: 127.4024s
	iters: 400, epoch: 8 | loss: 0.1174164
	speed: 0.0179s/iter; left time: 125.6430s
	iters: 500, epoch: 8 | loss: 0.0964760
	speed: 0.0179s/iter; left time: 123.8455s
Epoch: 8 cost time: 10.539762258529663
Epoch: 8, Steps: 570 | Train Loss: 0.0999613 Vali Loss: 0.0321173 Test Loss: 0.1101281
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11049826443195343, mae:0.2042028158903122
>>> MS_Raw LR=1e-4 DO=0.1 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2063830
	speed: 0.0294s/iter; left time: 332.1583s
	iters: 200, epoch: 1 | loss: 0.1870340
	speed: 0.0177s/iter; left time: 198.1072s
	iters: 300, epoch: 1 | loss: 0.1797046
	speed: 0.0176s/iter; left time: 195.8347s
	iters: 400, epoch: 1 | loss: 0.1959289
	speed: 0.0176s/iter; left time: 193.9828s
	iters: 500, epoch: 1 | loss: 0.3154422
	speed: 0.0176s/iter; left time: 192.1831s
Epoch: 1 cost time: 11.287006378173828
Epoch: 1, Steps: 570 | Train Loss: 0.2134551 Vali Loss: 0.0435308 Test Loss: 0.1349582
Validation loss decreased (inf --> 0.043531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2284414
	speed: 0.0527s/iter; left time: 565.9404s
	iters: 200, epoch: 2 | loss: 0.1208357
	speed: 0.0178s/iter; left time: 189.2765s
	iters: 300, epoch: 2 | loss: 0.1812132
	speed: 0.0178s/iter; left time: 187.4382s
	iters: 400, epoch: 2 | loss: 0.1583438
	speed: 0.0178s/iter; left time: 185.5855s
	iters: 500, epoch: 2 | loss: 0.2020065
	speed: 0.0178s/iter; left time: 183.9791s
Epoch: 2 cost time: 10.478584051132202
Epoch: 2, Steps: 570 | Train Loss: 0.1656884 Vali Loss: 0.0411948 Test Loss: 0.1304179
Validation loss decreased (0.043531 --> 0.041195).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1608097
	speed: 0.0519s/iter; left time: 527.4829s
	iters: 200, epoch: 3 | loss: 0.0874227
	speed: 0.0177s/iter; left time: 177.6461s
	iters: 300, epoch: 3 | loss: 0.1694377
	speed: 0.0177s/iter; left time: 176.0592s
	iters: 400, epoch: 3 | loss: 0.1177407
	speed: 0.0177s/iter; left time: 174.3329s
	iters: 500, epoch: 3 | loss: 0.1368724
	speed: 0.0177s/iter; left time: 172.4607s
Epoch: 3 cost time: 10.352555751800537
Epoch: 3, Steps: 570 | Train Loss: 0.1359576 Vali Loss: 0.0376442 Test Loss: 0.1299606
Validation loss decreased (0.041195 --> 0.037644).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0844448
	speed: 0.0518s/iter; left time: 496.3666s
	iters: 200, epoch: 4 | loss: 0.1618553
	speed: 0.0177s/iter; left time: 167.7467s
	iters: 300, epoch: 4 | loss: 0.1517792
	speed: 0.0177s/iter; left time: 165.9443s
	iters: 400, epoch: 4 | loss: 0.1055960
	speed: 0.0177s/iter; left time: 164.3779s
	iters: 500, epoch: 4 | loss: 0.1550536
	speed: 0.0177s/iter; left time: 162.4790s
Epoch: 4 cost time: 10.35840392112732
Epoch: 4, Steps: 570 | Train Loss: 0.1223496 Vali Loss: 0.0364399 Test Loss: 0.1311539
Validation loss decreased (0.037644 --> 0.036440).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1185952
	speed: 0.0531s/iter; left time: 478.8828s
	iters: 200, epoch: 5 | loss: 0.0921470
	speed: 0.0178s/iter; left time: 158.9075s
	iters: 300, epoch: 5 | loss: 0.0994880
	speed: 0.0178s/iter; left time: 157.0074s
	iters: 400, epoch: 5 | loss: 0.0897295
	speed: 0.0178s/iter; left time: 155.3085s
	iters: 500, epoch: 5 | loss: 0.0979272
	speed: 0.0178s/iter; left time: 153.5456s
Epoch: 5 cost time: 10.478554487228394
Epoch: 5, Steps: 570 | Train Loss: 0.1141438 Vali Loss: 0.0361733 Test Loss: 0.1294257
Validation loss decreased (0.036440 --> 0.036173).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0919634
	speed: 0.0543s/iter; left time: 458.8380s
	iters: 200, epoch: 6 | loss: 0.0713519
	speed: 0.0154s/iter; left time: 128.4986s
	iters: 300, epoch: 6 | loss: 0.0640771
	speed: 0.0153s/iter; left time: 126.4074s
	iters: 400, epoch: 6 | loss: 0.0877847
	speed: 0.0153s/iter; left time: 124.8331s
	iters: 500, epoch: 6 | loss: 0.0983191
	speed: 0.0153s/iter; left time: 123.2684s
Epoch: 6 cost time: 9.134541511535645
Epoch: 6, Steps: 570 | Train Loss: 0.1107003 Vali Loss: 0.0353952 Test Loss: 0.1319505
Validation loss decreased (0.036173 --> 0.035395).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1243195
	speed: 0.0477s/iter; left time: 376.1480s
	iters: 200, epoch: 7 | loss: 0.0919826
	speed: 0.0154s/iter; left time: 119.8927s
	iters: 300, epoch: 7 | loss: 0.1036018
	speed: 0.0154s/iter; left time: 118.4307s
	iters: 400, epoch: 7 | loss: 0.1400468
	speed: 0.0154s/iter; left time: 116.7860s
	iters: 500, epoch: 7 | loss: 0.1277194
	speed: 0.0154s/iter; left time: 114.9857s
Epoch: 7 cost time: 9.065195560455322
Epoch: 7, Steps: 570 | Train Loss: 0.1090898 Vali Loss: 0.0352193 Test Loss: 0.1302587
Validation loss decreased (0.035395 --> 0.035219).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0812892
	speed: 0.0483s/iter; left time: 352.8040s
	iters: 200, epoch: 8 | loss: 0.1107979
	speed: 0.0154s/iter; left time: 111.0415s
	iters: 300, epoch: 8 | loss: 0.0703831
	speed: 0.0154s/iter; left time: 109.6005s
	iters: 400, epoch: 8 | loss: 0.1055723
	speed: 0.0154s/iter; left time: 107.9900s
	iters: 500, epoch: 8 | loss: 0.0826987
	speed: 0.0154s/iter; left time: 106.4247s
Epoch: 8 cost time: 9.09945273399353
Epoch: 8, Steps: 570 | Train Loss: 0.1076544 Vali Loss: 0.0354851 Test Loss: 0.1311845
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0923762
	speed: 0.0474s/iter; left time: 319.7182s
	iters: 200, epoch: 9 | loss: 0.0993528
	speed: 0.0154s/iter; left time: 102.3321s
	iters: 300, epoch: 9 | loss: 0.1253577
	speed: 0.0154s/iter; left time: 100.8797s
	iters: 400, epoch: 9 | loss: 0.0924837
	speed: 0.0155s/iter; left time: 99.5283s
	iters: 500, epoch: 9 | loss: 0.1125001
	speed: 0.0155s/iter; left time: 97.9949s
Epoch: 9 cost time: 9.08117413520813
Epoch: 9, Steps: 570 | Train Loss: 0.1072153 Vali Loss: 0.0354216 Test Loss: 0.1312207
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1162508
	speed: 0.0473s/iter; left time: 291.9704s
	iters: 200, epoch: 10 | loss: 0.1318796
	speed: 0.0153s/iter; left time: 93.1144s
	iters: 300, epoch: 10 | loss: 0.0907145
	speed: 0.0154s/iter; left time: 91.6658s
	iters: 400, epoch: 10 | loss: 0.1265460
	speed: 0.0154s/iter; left time: 90.1714s
	iters: 500, epoch: 10 | loss: 0.1289427
	speed: 0.0154s/iter; left time: 88.6467s
Epoch: 10 cost time: 9.044782400131226
Epoch: 10, Steps: 570 | Train Loss: 0.1082149 Vali Loss: 0.0353202 Test Loss: 0.1312223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13045193254947662, mae:0.23218737542629242
>>> MS_Raw LR=1e-4 DO=0.1 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1391820
	speed: 0.0304s/iter; left time: 343.9041s
	iters: 200, epoch: 1 | loss: 0.2029080
	speed: 0.0187s/iter; left time: 208.9577s
	iters: 300, epoch: 1 | loss: 0.3258815
	speed: 0.0186s/iter; left time: 207.0021s
	iters: 400, epoch: 1 | loss: 0.1845980
	speed: 0.0186s/iter; left time: 204.9891s
	iters: 500, epoch: 1 | loss: 0.1627738
	speed: 0.0187s/iter; left time: 203.4198s
Epoch: 1 cost time: 11.858160495758057
Epoch: 1, Steps: 570 | Train Loss: 0.2102097 Vali Loss: 0.0448969 Test Loss: 0.1337774
Validation loss decreased (inf --> 0.044897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2993554
	speed: 0.0567s/iter; left time: 608.4146s
	iters: 200, epoch: 2 | loss: 0.1644480
	speed: 0.0187s/iter; left time: 199.1059s
	iters: 300, epoch: 2 | loss: 0.1396863
	speed: 0.0188s/iter; left time: 198.4511s
	iters: 400, epoch: 2 | loss: 0.1331915
	speed: 0.0188s/iter; left time: 196.4964s
	iters: 500, epoch: 2 | loss: 0.1542030
	speed: 0.0188s/iter; left time: 194.3806s
Epoch: 2 cost time: 11.030022859573364
Epoch: 2, Steps: 570 | Train Loss: 0.1688071 Vali Loss: 0.0415520 Test Loss: 0.1278588
Validation loss decreased (0.044897 --> 0.041552).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1257951
	speed: 0.0583s/iter; left time: 592.4053s
	iters: 200, epoch: 3 | loss: 0.1143206
	speed: 0.0186s/iter; left time: 187.5838s
	iters: 300, epoch: 3 | loss: 0.1279311
	speed: 0.0186s/iter; left time: 185.3742s
	iters: 400, epoch: 3 | loss: 0.1258806
	speed: 0.0186s/iter; left time: 183.1751s
	iters: 500, epoch: 3 | loss: 0.0975429
	speed: 0.0186s/iter; left time: 181.5770s
Epoch: 3 cost time: 11.078929662704468
Epoch: 3, Steps: 570 | Train Loss: 0.1449889 Vali Loss: 0.0376083 Test Loss: 0.1195712
Validation loss decreased (0.041552 --> 0.037608).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1677614
	speed: 0.0614s/iter; left time: 588.5549s
	iters: 200, epoch: 4 | loss: 0.1814447
	speed: 0.0188s/iter; left time: 178.0424s
	iters: 300, epoch: 4 | loss: 0.1515219
	speed: 0.0187s/iter; left time: 175.2843s
	iters: 400, epoch: 4 | loss: 0.1079124
	speed: 0.0187s/iter; left time: 173.7162s
	iters: 500, epoch: 4 | loss: 0.1271523
	speed: 0.0187s/iter; left time: 171.6860s
Epoch: 4 cost time: 10.963404893875122
Epoch: 4, Steps: 570 | Train Loss: 0.1339066 Vali Loss: 0.0367072 Test Loss: 0.1212885
Validation loss decreased (0.037608 --> 0.036707).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1465802
	speed: 0.0574s/iter; left time: 517.8522s
	iters: 200, epoch: 5 | loss: 0.1292708
	speed: 0.0186s/iter; left time: 166.1281s
	iters: 300, epoch: 5 | loss: 0.1207413
	speed: 0.0186s/iter; left time: 164.2269s
	iters: 400, epoch: 5 | loss: 0.1002995
	speed: 0.0187s/iter; left time: 162.8783s
	iters: 500, epoch: 5 | loss: 0.1350384
	speed: 0.0187s/iter; left time: 160.9866s
Epoch: 5 cost time: 10.893622636795044
Epoch: 5, Steps: 570 | Train Loss: 0.1279273 Vali Loss: 0.0351292 Test Loss: 0.1215083
Validation loss decreased (0.036707 --> 0.035129).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0720300
	speed: 0.0569s/iter; left time: 480.5725s
	iters: 200, epoch: 6 | loss: 0.1259978
	speed: 0.0187s/iter; left time: 156.3370s
	iters: 300, epoch: 6 | loss: 0.0900185
	speed: 0.0187s/iter; left time: 154.6670s
	iters: 400, epoch: 6 | loss: 0.1716787
	speed: 0.0187s/iter; left time: 152.2530s
	iters: 500, epoch: 6 | loss: 0.1148341
	speed: 0.0187s/iter; left time: 150.5246s
Epoch: 6 cost time: 10.988960266113281
Epoch: 6, Steps: 570 | Train Loss: 0.1261035 Vali Loss: 0.0348515 Test Loss: 0.1216410
Validation loss decreased (0.035129 --> 0.034851).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0961893
	speed: 0.0601s/iter; left time: 474.0175s
	iters: 200, epoch: 7 | loss: 0.1358449
	speed: 0.0187s/iter; left time: 145.3845s
	iters: 300, epoch: 7 | loss: 0.1310754
	speed: 0.0187s/iter; left time: 143.6947s
	iters: 400, epoch: 7 | loss: 0.1342554
	speed: 0.0187s/iter; left time: 141.5441s
	iters: 500, epoch: 7 | loss: 0.1742030
	speed: 0.0187s/iter; left time: 140.0284s
Epoch: 7 cost time: 11.128916501998901
Epoch: 7, Steps: 570 | Train Loss: 0.1236303 Vali Loss: 0.0349391 Test Loss: 0.1203975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1173634
	speed: 0.0570s/iter; left time: 416.5158s
	iters: 200, epoch: 8 | loss: 0.0968303
	speed: 0.0188s/iter; left time: 135.7632s
	iters: 300, epoch: 8 | loss: 0.0950346
	speed: 0.0188s/iter; left time: 133.9463s
	iters: 400, epoch: 8 | loss: 0.1503787
	speed: 0.0188s/iter; left time: 131.8856s
	iters: 500, epoch: 8 | loss: 0.0932398
	speed: 0.0188s/iter; left time: 130.0239s
Epoch: 8 cost time: 11.05151081085205
Epoch: 8, Steps: 570 | Train Loss: 0.1230835 Vali Loss: 0.0348350 Test Loss: 0.1202207
Validation loss decreased (0.034851 --> 0.034835).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0810930
	speed: 0.0596s/iter; left time: 401.8061s
	iters: 200, epoch: 9 | loss: 0.1697227
	speed: 0.0209s/iter; left time: 138.5786s
	iters: 300, epoch: 9 | loss: 0.0800193
	speed: 0.0209s/iter; left time: 136.6368s
	iters: 400, epoch: 9 | loss: 0.1001454
	speed: 0.0209s/iter; left time: 134.5532s
	iters: 500, epoch: 9 | loss: 0.0645827
	speed: 0.0209s/iter; left time: 132.4307s
Epoch: 9 cost time: 12.22958493232727
Epoch: 9, Steps: 570 | Train Loss: 0.1228311 Vali Loss: 0.0350171 Test Loss: 0.1199624
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1279257
	speed: 0.0572s/iter; left time: 352.8732s
	iters: 200, epoch: 10 | loss: 0.1399926
	speed: 0.0186s/iter; left time: 113.0134s
	iters: 300, epoch: 10 | loss: 0.0904599
	speed: 0.0186s/iter; left time: 111.1009s
	iters: 400, epoch: 10 | loss: 0.1062682
	speed: 0.0186s/iter; left time: 109.3387s
	iters: 500, epoch: 10 | loss: 0.1082861
	speed: 0.0186s/iter; left time: 107.4456s
Epoch: 10 cost time: 10.920109033584595
Epoch: 10, Steps: 570 | Train Loss: 0.1224287 Vali Loss: 0.0346467 Test Loss: 0.1207519
Validation loss decreased (0.034835 --> 0.034647).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1097813
	speed: 0.0575s/iter; left time: 322.0730s
	iters: 200, epoch: 11 | loss: 0.1797248
	speed: 0.0186s/iter; left time: 102.5355s
	iters: 300, epoch: 11 | loss: 0.1089150
	speed: 0.0187s/iter; left time: 100.7495s
	iters: 400, epoch: 11 | loss: 0.0766252
	speed: 0.0186s/iter; left time: 98.8581s
	iters: 500, epoch: 11 | loss: 0.1812996
	speed: 0.0187s/iter; left time: 97.1481s
Epoch: 11 cost time: 10.94952940940857
Epoch: 11, Steps: 570 | Train Loss: 0.1225361 Vali Loss: 0.0347175 Test Loss: 0.1206732
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1092781
	speed: 0.0556s/iter; left time: 279.6107s
	iters: 200, epoch: 12 | loss: 0.1323999
	speed: 0.0186s/iter; left time: 91.8310s
	iters: 300, epoch: 12 | loss: 0.0689266
	speed: 0.0186s/iter; left time: 89.9641s
	iters: 400, epoch: 12 | loss: 0.1341790
	speed: 0.0186s/iter; left time: 88.0623s
	iters: 500, epoch: 12 | loss: 0.1126035
	speed: 0.0186s/iter; left time: 86.2003s
Epoch: 12 cost time: 10.893728494644165
Epoch: 12, Steps: 570 | Train Loss: 0.1226761 Vali Loss: 0.0345742 Test Loss: 0.1206448
Validation loss decreased (0.034647 --> 0.034574).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1307561
	speed: 0.0578s/iter; left time: 257.6960s
	iters: 200, epoch: 13 | loss: 0.1051752
	speed: 0.0187s/iter; left time: 81.4781s
	iters: 300, epoch: 13 | loss: 0.1009801
	speed: 0.0187s/iter; left time: 79.5805s
	iters: 400, epoch: 13 | loss: 0.0950372
	speed: 0.0187s/iter; left time: 77.6984s
	iters: 500, epoch: 13 | loss: 0.1825068
	speed: 0.0187s/iter; left time: 75.8404s
Epoch: 13 cost time: 10.942044973373413
Epoch: 13, Steps: 570 | Train Loss: 0.1217264 Vali Loss: 0.0346610 Test Loss: 0.1205635
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0927252
	speed: 0.0559s/iter; left time: 217.6401s
	iters: 200, epoch: 14 | loss: 0.0829122
	speed: 0.0187s/iter; left time: 70.9193s
	iters: 300, epoch: 14 | loss: 0.1211418
	speed: 0.0187s/iter; left time: 69.1011s
	iters: 400, epoch: 14 | loss: 0.1085075
	speed: 0.0187s/iter; left time: 67.2192s
	iters: 500, epoch: 14 | loss: 0.1663618
	speed: 0.0187s/iter; left time: 65.3533s
Epoch: 14 cost time: 10.938497304916382
Epoch: 14, Steps: 570 | Train Loss: 0.1223126 Vali Loss: 0.0347010 Test Loss: 0.1205924
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.0744673
	speed: 0.0579s/iter; left time: 192.1396s
	iters: 200, epoch: 15 | loss: 0.1225159
	speed: 0.0186s/iter; left time: 59.9429s
	iters: 300, epoch: 15 | loss: 0.0960377
	speed: 0.0186s/iter; left time: 58.0930s
	iters: 400, epoch: 15 | loss: 0.1466675
	speed: 0.0186s/iter; left time: 56.2239s
	iters: 500, epoch: 15 | loss: 0.1094004
	speed: 0.0186s/iter; left time: 54.3548s
Epoch: 15 cost time: 11.06730055809021
Epoch: 15, Steps: 570 | Train Loss: 0.1223412 Vali Loss: 0.0346324 Test Loss: 0.1206264
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1208055168390274, mae:0.21598626673221588
>>> MS_Raw LR=1e-4 DO=0.1 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3847196
	speed: 0.0304s/iter; left time: 343.1925s
	iters: 200, epoch: 1 | loss: 0.1989159
	speed: 0.0183s/iter; left time: 204.9803s
	iters: 300, epoch: 1 | loss: 0.1971601
	speed: 0.0183s/iter; left time: 202.8947s
	iters: 400, epoch: 1 | loss: 0.1440938
	speed: 0.0183s/iter; left time: 201.4977s
	iters: 500, epoch: 1 | loss: 0.2128971
	speed: 0.0183s/iter; left time: 199.5610s
Epoch: 1 cost time: 11.686944484710693
Epoch: 1, Steps: 570 | Train Loss: 0.1825047 Vali Loss: 0.0356258 Test Loss: 0.1134578
Validation loss decreased (inf --> 0.035626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1396966
	speed: 0.0554s/iter; left time: 594.3631s
	iters: 200, epoch: 2 | loss: 0.2030740
	speed: 0.0183s/iter; left time: 194.6552s
	iters: 300, epoch: 2 | loss: 0.1893833
	speed: 0.0183s/iter; left time: 192.3999s
	iters: 400, epoch: 2 | loss: 0.1223289
	speed: 0.0183s/iter; left time: 191.2727s
	iters: 500, epoch: 2 | loss: 0.1044574
	speed: 0.0183s/iter; left time: 189.0906s
Epoch: 2 cost time: 10.732076406478882
Epoch: 2, Steps: 570 | Train Loss: 0.1498083 Vali Loss: 0.0350216 Test Loss: 0.1101953
Validation loss decreased (0.035626 --> 0.035022).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0859063
	speed: 0.0555s/iter; left time: 563.7377s
	iters: 200, epoch: 3 | loss: 0.1234981
	speed: 0.0183s/iter; left time: 183.8724s
	iters: 300, epoch: 3 | loss: 0.1394759
	speed: 0.0191s/iter; left time: 190.5671s
	iters: 400, epoch: 3 | loss: 0.1237412
	speed: 0.0212s/iter; left time: 209.3585s
	iters: 500, epoch: 3 | loss: 0.1110266
	speed: 0.0212s/iter; left time: 207.0381s
Epoch: 3 cost time: 11.570682048797607
Epoch: 3, Steps: 570 | Train Loss: 0.1336981 Vali Loss: 0.0334302 Test Loss: 0.1088812
Validation loss decreased (0.035022 --> 0.033430).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1316584
	speed: 0.0598s/iter; left time: 573.3119s
	iters: 200, epoch: 4 | loss: 0.0832696
	speed: 0.0203s/iter; left time: 192.5430s
	iters: 300, epoch: 4 | loss: 0.1686378
	speed: 0.0182s/iter; left time: 170.9770s
	iters: 400, epoch: 4 | loss: 0.1234927
	speed: 0.0182s/iter; left time: 168.9093s
	iters: 500, epoch: 4 | loss: 0.1014236
	speed: 0.0181s/iter; left time: 166.2284s
Epoch: 4 cost time: 11.145501613616943
Epoch: 4, Steps: 570 | Train Loss: 0.1239407 Vali Loss: 0.0317841 Test Loss: 0.1084288
Validation loss decreased (0.033430 --> 0.031784).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0984245
	speed: 0.0554s/iter; left time: 499.5267s
	iters: 200, epoch: 5 | loss: 0.1071849
	speed: 0.0180s/iter; left time: 160.9012s
	iters: 300, epoch: 5 | loss: 0.1203405
	speed: 0.0180s/iter; left time: 159.0860s
	iters: 400, epoch: 5 | loss: 0.1267540
	speed: 0.0180s/iter; left time: 157.1649s
	iters: 500, epoch: 5 | loss: 0.1044165
	speed: 0.0180s/iter; left time: 155.4733s
Epoch: 5 cost time: 10.575783252716064
Epoch: 5, Steps: 570 | Train Loss: 0.1184903 Vali Loss: 0.0319481 Test Loss: 0.1089144
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1653547
	speed: 0.0579s/iter; left time: 489.6884s
	iters: 200, epoch: 6 | loss: 0.0927161
	speed: 0.0182s/iter; left time: 151.6082s
	iters: 300, epoch: 6 | loss: 0.1343766
	speed: 0.0181s/iter; left time: 149.1270s
	iters: 400, epoch: 6 | loss: 0.0845097
	speed: 0.0181s/iter; left time: 147.3812s
	iters: 500, epoch: 6 | loss: 0.0728186
	speed: 0.0181s/iter; left time: 145.4650s
Epoch: 6 cost time: 10.80377745628357
Epoch: 6, Steps: 570 | Train Loss: 0.1161634 Vali Loss: 0.0314554 Test Loss: 0.1089152
Validation loss decreased (0.031784 --> 0.031455).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1205332
	speed: 0.0591s/iter; left time: 466.1559s
	iters: 200, epoch: 7 | loss: 0.1601523
	speed: 0.0205s/iter; left time: 159.2000s
	iters: 300, epoch: 7 | loss: 0.0827276
	speed: 0.0205s/iter; left time: 157.3511s
	iters: 400, epoch: 7 | loss: 0.1225206
	speed: 0.0204s/iter; left time: 154.7022s
	iters: 500, epoch: 7 | loss: 0.0939513
	speed: 0.0204s/iter; left time: 152.9746s
Epoch: 7 cost time: 11.975061416625977
Epoch: 7, Steps: 570 | Train Loss: 0.1140560 Vali Loss: 0.0314774 Test Loss: 0.1093833
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0813401
	speed: 0.0563s/iter; left time: 411.3268s
	iters: 200, epoch: 8 | loss: 0.0968648
	speed: 0.0183s/iter; left time: 131.7227s
	iters: 300, epoch: 8 | loss: 0.1148806
	speed: 0.0182s/iter; left time: 129.6733s
	iters: 400, epoch: 8 | loss: 0.1035178
	speed: 0.0182s/iter; left time: 127.7072s
	iters: 500, epoch: 8 | loss: 0.1377087
	speed: 0.0182s/iter; left time: 125.9824s
Epoch: 8 cost time: 10.681812763214111
Epoch: 8, Steps: 570 | Train Loss: 0.1131360 Vali Loss: 0.0315018 Test Loss: 0.1090401
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0662846
	speed: 0.0573s/iter; left time: 386.0617s
	iters: 200, epoch: 9 | loss: 0.0926176
	speed: 0.0181s/iter; left time: 120.3450s
	iters: 300, epoch: 9 | loss: 0.1140424
	speed: 0.0181s/iter; left time: 118.5055s
	iters: 400, epoch: 9 | loss: 0.1118420
	speed: 0.0181s/iter; left time: 116.6897s
	iters: 500, epoch: 9 | loss: 0.0876799
	speed: 0.0181s/iter; left time: 114.8580s
Epoch: 9 cost time: 10.612219095230103
Epoch: 9, Steps: 570 | Train Loss: 0.1132773 Vali Loss: 0.0314580 Test Loss: 0.1089168
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10906100273132324, mae:0.20073860883712769
>>> MS_Raw LR=1e-4 DO=0.1 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2622037
	speed: 0.0329s/iter; left time: 372.1798s
	iters: 200, epoch: 1 | loss: 0.1800064
	speed: 0.0206s/iter; left time: 230.3524s
	iters: 300, epoch: 1 | loss: 0.2144991
	speed: 0.0206s/iter; left time: 228.4230s
	iters: 400, epoch: 1 | loss: 0.2300204
	speed: 0.0205s/iter; left time: 225.5675s
	iters: 500, epoch: 1 | loss: 0.3149802
	speed: 0.0205s/iter; left time: 223.3239s
Epoch: 1 cost time: 12.996079206466675
Epoch: 1, Steps: 570 | Train Loss: 0.2178458 Vali Loss: 0.0412033 Test Loss: 0.1345358
Validation loss decreased (inf --> 0.041203).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2365496
	speed: 0.0574s/iter; left time: 615.5236s
	iters: 200, epoch: 2 | loss: 0.2591004
	speed: 0.0182s/iter; left time: 193.0226s
	iters: 300, epoch: 2 | loss: 0.3177629
	speed: 0.0181s/iter; left time: 190.1423s
	iters: 400, epoch: 2 | loss: 0.1723979
	speed: 0.0180s/iter; left time: 188.1800s
	iters: 500, epoch: 2 | loss: 0.0800868
	speed: 0.0180s/iter; left time: 186.4085s
Epoch: 2 cost time: 10.60620379447937
Epoch: 2, Steps: 570 | Train Loss: 0.1743670 Vali Loss: 0.0447428 Test Loss: 0.1367654
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1199422
	speed: 0.0548s/iter; left time: 556.9354s
	iters: 200, epoch: 3 | loss: 0.1599562
	speed: 0.0181s/iter; left time: 182.1716s
	iters: 300, epoch: 3 | loss: 0.1599515
	speed: 0.0181s/iter; left time: 180.2313s
	iters: 400, epoch: 3 | loss: 0.1801567
	speed: 0.0181s/iter; left time: 178.4269s
	iters: 500, epoch: 3 | loss: 0.1400699
	speed: 0.0181s/iter; left time: 176.5390s
Epoch: 3 cost time: 10.599270105361938
Epoch: 3, Steps: 570 | Train Loss: 0.1508053 Vali Loss: 0.0413297 Test Loss: 0.1289753
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1095312
	speed: 0.0565s/iter; left time: 542.3047s
	iters: 200, epoch: 4 | loss: 0.1352073
	speed: 0.0182s/iter; left time: 172.9214s
	iters: 300, epoch: 4 | loss: 0.1411973
	speed: 0.0182s/iter; left time: 171.0959s
	iters: 400, epoch: 4 | loss: 0.1697282
	speed: 0.0182s/iter; left time: 168.9803s
	iters: 500, epoch: 4 | loss: 0.0927050
	speed: 0.0182s/iter; left time: 167.4518s
Epoch: 4 cost time: 10.668814659118652
Epoch: 4, Steps: 570 | Train Loss: 0.1389273 Vali Loss: 0.0384533 Test Loss: 0.1248211
Validation loss decreased (0.041203 --> 0.038453).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1008001
	speed: 0.0562s/iter; left time: 506.5521s
	iters: 200, epoch: 5 | loss: 0.1308750
	speed: 0.0182s/iter; left time: 162.2751s
	iters: 300, epoch: 5 | loss: 0.1068856
	speed: 0.0181s/iter; left time: 159.9822s
	iters: 400, epoch: 5 | loss: 0.1131738
	speed: 0.0180s/iter; left time: 157.3614s
	iters: 500, epoch: 5 | loss: 0.0717618
	speed: 0.0180s/iter; left time: 155.6049s
Epoch: 5 cost time: 10.659767866134644
Epoch: 5, Steps: 570 | Train Loss: 0.1323583 Vali Loss: 0.0376206 Test Loss: 0.1269149
Validation loss decreased (0.038453 --> 0.037621).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1632042
	speed: 0.0561s/iter; left time: 474.4951s
	iters: 200, epoch: 6 | loss: 0.1068073
	speed: 0.0182s/iter; left time: 151.7272s
	iters: 300, epoch: 6 | loss: 0.2113397
	speed: 0.0180s/iter; left time: 148.6925s
	iters: 400, epoch: 6 | loss: 0.1107387
	speed: 0.0180s/iter; left time: 146.9105s
	iters: 500, epoch: 6 | loss: 0.1167599
	speed: 0.0181s/iter; left time: 145.6576s
Epoch: 6 cost time: 10.622298240661621
Epoch: 6, Steps: 570 | Train Loss: 0.1287186 Vali Loss: 0.0375797 Test Loss: 0.1266044
Validation loss decreased (0.037621 --> 0.037580).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1238780
	speed: 0.0561s/iter; left time: 442.1234s
	iters: 200, epoch: 7 | loss: 0.1068896
	speed: 0.0182s/iter; left time: 141.3881s
	iters: 300, epoch: 7 | loss: 0.1458076
	speed: 0.0182s/iter; left time: 139.4938s
	iters: 400, epoch: 7 | loss: 0.1221422
	speed: 0.0182s/iter; left time: 137.8821s
	iters: 500, epoch: 7 | loss: 0.0889262
	speed: 0.0182s/iter; left time: 136.1118s
Epoch: 7 cost time: 10.761664390563965
Epoch: 7, Steps: 570 | Train Loss: 0.1286428 Vali Loss: 0.0375248 Test Loss: 0.1260683
Validation loss decreased (0.037580 --> 0.037525).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1094912
	speed: 0.0556s/iter; left time: 406.3113s
	iters: 200, epoch: 8 | loss: 0.0991819
	speed: 0.0184s/iter; left time: 132.7297s
	iters: 300, epoch: 8 | loss: 0.1341850
	speed: 0.0184s/iter; left time: 130.6822s
	iters: 400, epoch: 8 | loss: 0.1574862
	speed: 0.0184s/iter; left time: 128.9943s
	iters: 500, epoch: 8 | loss: 0.1078135
	speed: 0.0184s/iter; left time: 127.1779s
Epoch: 8 cost time: 10.751497983932495
Epoch: 8, Steps: 570 | Train Loss: 0.1276205 Vali Loss: 0.0374951 Test Loss: 0.1265586
Validation loss decreased (0.037525 --> 0.037495).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1345530
	speed: 0.0569s/iter; left time: 383.8872s
	iters: 200, epoch: 9 | loss: 0.1701355
	speed: 0.0183s/iter; left time: 121.5465s
	iters: 300, epoch: 9 | loss: 0.1660757
	speed: 0.0184s/iter; left time: 120.0512s
	iters: 400, epoch: 9 | loss: 0.2267914
	speed: 0.0183s/iter; left time: 117.9995s
	iters: 500, epoch: 9 | loss: 0.0914125
	speed: 0.0184s/iter; left time: 116.6014s
Epoch: 9 cost time: 10.767433404922485
Epoch: 9, Steps: 570 | Train Loss: 0.1275924 Vali Loss: 0.0375651 Test Loss: 0.1264918
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1320315
	speed: 0.0561s/iter; left time: 345.9935s
	iters: 200, epoch: 10 | loss: 0.1074320
	speed: 0.0181s/iter; left time: 110.0738s
	iters: 300, epoch: 10 | loss: 0.1262881
	speed: 0.0181s/iter; left time: 108.1698s
	iters: 400, epoch: 10 | loss: 0.1170432
	speed: 0.0181s/iter; left time: 106.5386s
	iters: 500, epoch: 10 | loss: 0.1459234
	speed: 0.0181s/iter; left time: 104.5433s
Epoch: 10 cost time: 10.612694263458252
Epoch: 10, Steps: 570 | Train Loss: 0.1270538 Vali Loss: 0.0372558 Test Loss: 0.1263026
Validation loss decreased (0.037495 --> 0.037256).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1405462
	speed: 0.0563s/iter; left time: 315.4121s
	iters: 200, epoch: 11 | loss: 0.1231383
	speed: 0.0183s/iter; left time: 100.5634s
	iters: 300, epoch: 11 | loss: 0.1248415
	speed: 0.0183s/iter; left time: 98.7255s
	iters: 400, epoch: 11 | loss: 0.1385459
	speed: 0.0183s/iter; left time: 96.8341s
	iters: 500, epoch: 11 | loss: 0.1068804
	speed: 0.0182s/iter; left time: 94.8862s
Epoch: 11 cost time: 10.70485806465149
Epoch: 11, Steps: 570 | Train Loss: 0.1275050 Vali Loss: 0.0372520 Test Loss: 0.1262792
Validation loss decreased (0.037256 --> 0.037252).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1180813
	speed: 0.0557s/iter; left time: 279.9855s
	iters: 200, epoch: 12 | loss: 0.1363812
	speed: 0.0182s/iter; left time: 89.5476s
	iters: 300, epoch: 12 | loss: 0.1083949
	speed: 0.0182s/iter; left time: 88.1495s
	iters: 400, epoch: 12 | loss: 0.0979449
	speed: 0.0184s/iter; left time: 86.9872s
	iters: 500, epoch: 12 | loss: 0.1293892
	speed: 0.0184s/iter; left time: 85.1079s
Epoch: 12 cost time: 10.735074758529663
Epoch: 12, Steps: 570 | Train Loss: 0.1270305 Vali Loss: 0.0372749 Test Loss: 0.1262751
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1076863
	speed: 0.0552s/iter; left time: 246.3673s
	iters: 200, epoch: 13 | loss: 0.0892995
	speed: 0.0181s/iter; left time: 78.9966s
	iters: 300, epoch: 13 | loss: 0.1081605
	speed: 0.0181s/iter; left time: 77.0956s
	iters: 400, epoch: 13 | loss: 0.0759180
	speed: 0.0181s/iter; left time: 75.2350s
	iters: 500, epoch: 13 | loss: 0.1010875
	speed: 0.0181s/iter; left time: 73.6851s
Epoch: 13 cost time: 10.60531210899353
Epoch: 13, Steps: 570 | Train Loss: 0.1264350 Vali Loss: 0.0374249 Test Loss: 0.1263012
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0805550
	speed: 0.0557s/iter; left time: 216.8663s
	iters: 200, epoch: 14 | loss: 0.0965289
	speed: 0.0184s/iter; left time: 69.6407s
	iters: 300, epoch: 14 | loss: 0.1239678
	speed: 0.0184s/iter; left time: 67.7646s
	iters: 400, epoch: 14 | loss: 0.1377636
	speed: 0.0183s/iter; left time: 65.8196s
	iters: 500, epoch: 14 | loss: 0.1081927
	speed: 0.0184s/iter; left time: 64.1748s
Epoch: 14 cost time: 10.722809076309204
Epoch: 14, Steps: 570 | Train Loss: 0.1268316 Vali Loss: 0.0373815 Test Loss: 0.1263072
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1264682114124298, mae:0.22387194633483887
>>> MS_Raw LR=1e-4 DO=0.1 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2027539
	speed: 0.0360s/iter; left time: 406.7757s
	iters: 200, epoch: 1 | loss: 0.1669776
	speed: 0.0240s/iter; left time: 268.5016s
	iters: 300, epoch: 1 | loss: 0.1981617
	speed: 0.0240s/iter; left time: 266.4895s
	iters: 400, epoch: 1 | loss: 0.2945663
	speed: 0.0240s/iter; left time: 264.0163s
	iters: 500, epoch: 1 | loss: 0.2654594
	speed: 0.0239s/iter; left time: 260.9810s
Epoch: 1 cost time: 14.922728061676025
Epoch: 1, Steps: 570 | Train Loss: 0.2067640 Vali Loss: 0.0437287 Test Loss: 0.1357310
Validation loss decreased (inf --> 0.043729).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2346632
	speed: 0.0659s/iter; left time: 707.3377s
	iters: 200, epoch: 2 | loss: 0.1298181
	speed: 0.0221s/iter; left time: 235.0740s
	iters: 300, epoch: 2 | loss: 0.1294292
	speed: 0.0221s/iter; left time: 232.3549s
	iters: 400, epoch: 2 | loss: 0.1555942
	speed: 0.0221s/iter; left time: 230.0918s
	iters: 500, epoch: 2 | loss: 0.1474744
	speed: 0.0221s/iter; left time: 227.8714s
Epoch: 2 cost time: 12.911939144134521
Epoch: 2, Steps: 570 | Train Loss: 0.1592953 Vali Loss: 0.0386249 Test Loss: 0.1238144
Validation loss decreased (0.043729 --> 0.038625).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2576421
	speed: 0.0629s/iter; left time: 639.4780s
	iters: 200, epoch: 3 | loss: 0.1106855
	speed: 0.0220s/iter; left time: 221.6917s
	iters: 300, epoch: 3 | loss: 0.1619062
	speed: 0.0220s/iter; left time: 219.4073s
	iters: 400, epoch: 3 | loss: 0.1001397
	speed: 0.0220s/iter; left time: 216.8291s
	iters: 500, epoch: 3 | loss: 0.0994980
	speed: 0.0220s/iter; left time: 214.9103s
Epoch: 3 cost time: 12.875211238861084
Epoch: 3, Steps: 570 | Train Loss: 0.1308025 Vali Loss: 0.0353702 Test Loss: 0.1231166
Validation loss decreased (0.038625 --> 0.035370).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1022077
	speed: 0.0629s/iter; left time: 603.1958s
	iters: 200, epoch: 4 | loss: 0.0759279
	speed: 0.0219s/iter; left time: 208.0188s
	iters: 300, epoch: 4 | loss: 0.1092489
	speed: 0.0219s/iter; left time: 205.7820s
	iters: 400, epoch: 4 | loss: 0.0982543
	speed: 0.0219s/iter; left time: 203.9177s
	iters: 500, epoch: 4 | loss: 0.1520389
	speed: 0.0219s/iter; left time: 201.4690s
Epoch: 4 cost time: 12.793083190917969
Epoch: 4, Steps: 570 | Train Loss: 0.1136707 Vali Loss: 0.0346266 Test Loss: 0.1269748
Validation loss decreased (0.035370 --> 0.034627).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1267427
	speed: 0.0663s/iter; left time: 597.6586s
	iters: 200, epoch: 5 | loss: 0.1023141
	speed: 0.0221s/iter; left time: 196.9466s
	iters: 300, epoch: 5 | loss: 0.0798481
	speed: 0.0220s/iter; left time: 194.2849s
	iters: 400, epoch: 5 | loss: 0.0946030
	speed: 0.0220s/iter; left time: 192.0359s
	iters: 500, epoch: 5 | loss: 0.0963447
	speed: 0.0221s/iter; left time: 190.7361s
Epoch: 5 cost time: 12.903640747070312
Epoch: 5, Steps: 570 | Train Loss: 0.1071186 Vali Loss: 0.0336836 Test Loss: 0.1273362
Validation loss decreased (0.034627 --> 0.033684).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0972172
	speed: 0.0652s/iter; left time: 550.9970s
	iters: 200, epoch: 6 | loss: 0.1180001
	speed: 0.0220s/iter; left time: 183.6511s
	iters: 300, epoch: 6 | loss: 0.0808669
	speed: 0.0220s/iter; left time: 181.4299s
	iters: 400, epoch: 6 | loss: 0.0732322
	speed: 0.0220s/iter; left time: 179.0266s
	iters: 500, epoch: 6 | loss: 0.1540477
	speed: 0.0220s/iter; left time: 177.0107s
Epoch: 6 cost time: 12.854381084442139
Epoch: 6, Steps: 570 | Train Loss: 0.1037475 Vali Loss: 0.0350687 Test Loss: 0.1272723
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1238752
	speed: 0.0622s/iter; left time: 490.4250s
	iters: 200, epoch: 7 | loss: 0.1158283
	speed: 0.0221s/iter; left time: 172.2063s
	iters: 300, epoch: 7 | loss: 0.0841666
	speed: 0.0221s/iter; left time: 169.7514s
	iters: 400, epoch: 7 | loss: 0.0927563
	speed: 0.0221s/iter; left time: 167.2486s
	iters: 500, epoch: 7 | loss: 0.1020523
	speed: 0.0221s/iter; left time: 165.2909s
Epoch: 7 cost time: 12.880855798721313
Epoch: 7, Steps: 570 | Train Loss: 0.1008883 Vali Loss: 0.0350252 Test Loss: 0.1266070
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1005726
	speed: 0.0614s/iter; left time: 448.7327s
	iters: 200, epoch: 8 | loss: 0.2125474
	speed: 0.0220s/iter; left time: 158.8818s
	iters: 300, epoch: 8 | loss: 0.0797290
	speed: 0.0220s/iter; left time: 156.4645s
	iters: 400, epoch: 8 | loss: 0.0906385
	speed: 0.0220s/iter; left time: 154.3872s
	iters: 500, epoch: 8 | loss: 0.0828229
	speed: 0.0220s/iter; left time: 152.3225s
Epoch: 8 cost time: 12.822962045669556
Epoch: 8, Steps: 570 | Train Loss: 0.1002590 Vali Loss: 0.0339656 Test Loss: 0.1274215
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12748165428638458, mae:0.22400608658790588
>>> MS_Raw LR=1e-4 DO=0.1 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1785491
	speed: 0.0356s/iter; left time: 402.4498s
	iters: 200, epoch: 1 | loss: 0.1034653
	speed: 0.0234s/iter; left time: 261.7799s
	iters: 300, epoch: 1 | loss: 0.1610785
	speed: 0.0235s/iter; left time: 260.6034s
	iters: 400, epoch: 1 | loss: 0.1331869
	speed: 0.0235s/iter; left time: 258.0880s
	iters: 500, epoch: 1 | loss: 0.1715312
	speed: 0.0234s/iter; left time: 254.8818s
Epoch: 1 cost time: 14.632594347000122
Epoch: 1, Steps: 570 | Train Loss: 0.1773544 Vali Loss: 0.0365672 Test Loss: 0.1138351
Validation loss decreased (inf --> 0.036567).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1486347
	speed: 0.0648s/iter; left time: 695.3232s
	iters: 200, epoch: 2 | loss: 0.1087361
	speed: 0.0214s/iter; left time: 227.5289s
	iters: 300, epoch: 2 | loss: 0.1416785
	speed: 0.0214s/iter; left time: 225.3655s
	iters: 400, epoch: 2 | loss: 0.1260082
	speed: 0.0214s/iter; left time: 223.2839s
	iters: 500, epoch: 2 | loss: 0.0900498
	speed: 0.0214s/iter; left time: 220.8832s
Epoch: 2 cost time: 12.581598043441772
Epoch: 2, Steps: 570 | Train Loss: 0.1427053 Vali Loss: 0.0326686 Test Loss: 0.1104448
Validation loss decreased (0.036567 --> 0.032669).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1181588
	speed: 0.0620s/iter; left time: 630.2010s
	iters: 200, epoch: 3 | loss: 0.1013483
	speed: 0.0214s/iter; left time: 214.9448s
	iters: 300, epoch: 3 | loss: 0.1209200
	speed: 0.0213s/iter; left time: 211.8701s
	iters: 400, epoch: 3 | loss: 0.0976466
	speed: 0.0213s/iter; left time: 210.1593s
	iters: 500, epoch: 3 | loss: 0.1044774
	speed: 0.0214s/iter; left time: 208.5479s
Epoch: 3 cost time: 12.490017175674438
Epoch: 3, Steps: 570 | Train Loss: 0.1186728 Vali Loss: 0.0319777 Test Loss: 0.1122661
Validation loss decreased (0.032669 --> 0.031978).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0921805
	speed: 0.0635s/iter; left time: 609.4172s
	iters: 200, epoch: 4 | loss: 0.1141695
	speed: 0.0219s/iter; left time: 207.9596s
	iters: 300, epoch: 4 | loss: 0.1044969
	speed: 0.0233s/iter; left time: 219.2235s
	iters: 400, epoch: 4 | loss: 0.1281468
	speed: 0.0233s/iter; left time: 216.7962s
	iters: 500, epoch: 4 | loss: 0.0988808
	speed: 0.0233s/iter; left time: 214.5897s
Epoch: 4 cost time: 13.289117336273193
Epoch: 4, Steps: 570 | Train Loss: 0.1057914 Vali Loss: 0.0311259 Test Loss: 0.1089387
Validation loss decreased (0.031978 --> 0.031126).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1255900
	speed: 0.0672s/iter; left time: 606.1781s
	iters: 200, epoch: 5 | loss: 0.0753093
	speed: 0.0233s/iter; left time: 207.5082s
	iters: 300, epoch: 5 | loss: 0.0820977
	speed: 0.0232s/iter; left time: 204.5488s
	iters: 400, epoch: 5 | loss: 0.1364666
	speed: 0.0213s/iter; left time: 186.1038s
	iters: 500, epoch: 5 | loss: 0.0913140
	speed: 0.0213s/iter; left time: 183.8334s
Epoch: 5 cost time: 12.912447214126587
Epoch: 5, Steps: 570 | Train Loss: 0.0997650 Vali Loss: 0.0314607 Test Loss: 0.1088687
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0785641
	speed: 0.0607s/iter; left time: 513.2614s
	iters: 200, epoch: 6 | loss: 0.1225024
	speed: 0.0214s/iter; left time: 178.5149s
	iters: 300, epoch: 6 | loss: 0.1325319
	speed: 0.0214s/iter; left time: 176.2378s
	iters: 400, epoch: 6 | loss: 0.0782834
	speed: 0.0226s/iter; left time: 184.5073s
	iters: 500, epoch: 6 | loss: 0.0707568
	speed: 0.0234s/iter; left time: 188.0912s
Epoch: 6 cost time: 12.969465494155884
Epoch: 6, Steps: 570 | Train Loss: 0.0953235 Vali Loss: 0.0311220 Test Loss: 0.1090435
Validation loss decreased (0.031126 --> 0.031122).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0702489
	speed: 0.0645s/iter; left time: 508.5564s
	iters: 200, epoch: 7 | loss: 0.1165190
	speed: 0.0219s/iter; left time: 170.1270s
	iters: 300, epoch: 7 | loss: 0.1115409
	speed: 0.0214s/iter; left time: 164.2686s
	iters: 400, epoch: 7 | loss: 0.0763219
	speed: 0.0214s/iter; left time: 162.1870s
	iters: 500, epoch: 7 | loss: 0.1219211
	speed: 0.0214s/iter; left time: 159.9138s
Epoch: 7 cost time: 12.729079246520996
Epoch: 7, Steps: 570 | Train Loss: 0.0939907 Vali Loss: 0.0313113 Test Loss: 0.1090514
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0761810
	speed: 0.0611s/iter; left time: 446.9325s
	iters: 200, epoch: 8 | loss: 0.0958735
	speed: 0.0214s/iter; left time: 154.1695s
	iters: 300, epoch: 8 | loss: 0.0982624
	speed: 0.0224s/iter; left time: 159.5065s
	iters: 400, epoch: 8 | loss: 0.0802097
	speed: 0.0233s/iter; left time: 163.5605s
	iters: 500, epoch: 8 | loss: 0.1419071
	speed: 0.0233s/iter; left time: 161.2370s
Epoch: 8 cost time: 13.114238739013672
Epoch: 8, Steps: 570 | Train Loss: 0.0933016 Vali Loss: 0.0310123 Test Loss: 0.1087838
Validation loss decreased (0.031122 --> 0.031012).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0783801
	speed: 0.0646s/iter; left time: 435.1626s
	iters: 200, epoch: 9 | loss: 0.1293915
	speed: 0.0233s/iter; left time: 154.4946s
	iters: 300, epoch: 9 | loss: 0.1090923
	speed: 0.0233s/iter; left time: 152.1213s
	iters: 400, epoch: 9 | loss: 0.0697182
	speed: 0.0233s/iter; left time: 149.9786s
	iters: 500, epoch: 9 | loss: 0.0602542
	speed: 0.0229s/iter; left time: 145.3975s
Epoch: 9 cost time: 13.399911165237427
Epoch: 9, Steps: 570 | Train Loss: 0.0938148 Vali Loss: 0.0310205 Test Loss: 0.1087866
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0679607
	speed: 0.0606s/iter; left time: 373.8417s
	iters: 200, epoch: 10 | loss: 0.0885144
	speed: 0.0213s/iter; left time: 129.5395s
	iters: 300, epoch: 10 | loss: 0.0781095
	speed: 0.0213s/iter; left time: 127.3978s
	iters: 400, epoch: 10 | loss: 0.0953951
	speed: 0.0213s/iter; left time: 125.2485s
	iters: 500, epoch: 10 | loss: 0.1224032
	speed: 0.0213s/iter; left time: 123.1216s
Epoch: 10 cost time: 12.427515506744385
Epoch: 10, Steps: 570 | Train Loss: 0.0919785 Vali Loss: 0.0310270 Test Loss: 0.1089423
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0876282
	speed: 0.0604s/iter; left time: 338.0473s
	iters: 200, epoch: 11 | loss: 0.0823253
	speed: 0.0213s/iter; left time: 117.2215s
	iters: 300, epoch: 11 | loss: 0.0980454
	speed: 0.0213s/iter; left time: 115.2301s
	iters: 400, epoch: 11 | loss: 0.0720253
	speed: 0.0213s/iter; left time: 112.9578s
	iters: 500, epoch: 11 | loss: 0.1342674
	speed: 0.0214s/iter; left time: 111.0797s
Epoch: 11 cost time: 12.455103158950806
Epoch: 11, Steps: 570 | Train Loss: 0.0928769 Vali Loss: 0.0309564 Test Loss: 0.1089035
Validation loss decreased (0.031012 --> 0.030956).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0873149
	speed: 0.0645s/iter; left time: 324.4660s
	iters: 200, epoch: 12 | loss: 0.0897143
	speed: 0.0215s/iter; left time: 105.8082s
	iters: 300, epoch: 12 | loss: 0.0802560
	speed: 0.0214s/iter; left time: 103.4987s
	iters: 400, epoch: 12 | loss: 0.1330236
	speed: 0.0215s/iter; left time: 101.5160s
	iters: 500, epoch: 12 | loss: 0.1009890
	speed: 0.0214s/iter; left time: 99.2789s
Epoch: 12 cost time: 12.513286590576172
Epoch: 12, Steps: 570 | Train Loss: 0.0916396 Vali Loss: 0.0309637 Test Loss: 0.1088975
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0757189
	speed: 0.0599s/iter; left time: 267.0221s
	iters: 200, epoch: 13 | loss: 0.1029050
	speed: 0.0213s/iter; left time: 92.7377s
	iters: 300, epoch: 13 | loss: 0.1308431
	speed: 0.0212s/iter; left time: 90.5330s
	iters: 400, epoch: 13 | loss: 0.0862136
	speed: 0.0212s/iter; left time: 88.3956s
	iters: 500, epoch: 13 | loss: 0.0903103
	speed: 0.0213s/iter; left time: 86.3927s
Epoch: 13 cost time: 12.403916835784912
Epoch: 13, Steps: 570 | Train Loss: 0.0925450 Vali Loss: 0.0310434 Test Loss: 0.1089011
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0980130
	speed: 0.0601s/iter; left time: 234.0041s
	iters: 200, epoch: 14 | loss: 0.0712179
	speed: 0.0214s/iter; left time: 81.0114s
	iters: 300, epoch: 14 | loss: 0.0745564
	speed: 0.0213s/iter; left time: 78.7481s
	iters: 400, epoch: 14 | loss: 0.0895295
	speed: 0.0214s/iter; left time: 76.6890s
	iters: 500, epoch: 14 | loss: 0.1133360
	speed: 0.0213s/iter; left time: 74.4971s
Epoch: 14 cost time: 12.44896674156189
Epoch: 14, Steps: 570 | Train Loss: 0.0920662 Vali Loss: 0.0309956 Test Loss: 0.1088896
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1090446412563324, mae:0.20337125658988953
>>> MS_Raw LR=1e-4 DO=0.1 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2186458
	speed: 0.0350s/iter; left time: 395.2317s
	iters: 200, epoch: 1 | loss: 0.2041420
	speed: 0.0200s/iter; left time: 224.3955s
	iters: 300, epoch: 1 | loss: 0.1998271
	speed: 0.0201s/iter; left time: 222.6571s
	iters: 400, epoch: 1 | loss: 0.2263469
	speed: 0.0200s/iter; left time: 220.0692s
	iters: 500, epoch: 1 | loss: 0.2081954
	speed: 0.0201s/iter; left time: 218.5932s
Epoch: 1 cost time: 12.966522693634033
Epoch: 1, Steps: 570 | Train Loss: 0.2079525 Vali Loss: 0.0443054 Test Loss: 0.1338999
Validation loss decreased (inf --> 0.044305).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0878384
	speed: 0.0602s/iter; left time: 645.6340s
	iters: 200, epoch: 2 | loss: 0.2626744
	speed: 0.0201s/iter; left time: 214.0583s
	iters: 300, epoch: 2 | loss: 0.1360231
	speed: 0.0201s/iter; left time: 211.7052s
	iters: 400, epoch: 2 | loss: 0.1155632
	speed: 0.0201s/iter; left time: 209.7366s
	iters: 500, epoch: 2 | loss: 0.1218925
	speed: 0.0201s/iter; left time: 207.6682s
Epoch: 2 cost time: 11.7864670753479
Epoch: 2, Steps: 570 | Train Loss: 0.1629091 Vali Loss: 0.0399663 Test Loss: 0.1289942
Validation loss decreased (0.044305 --> 0.039966).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0891363
	speed: 0.0611s/iter; left time: 621.2238s
	iters: 200, epoch: 3 | loss: 0.1080725
	speed: 0.0201s/iter; left time: 202.2911s
	iters: 300, epoch: 3 | loss: 0.1031212
	speed: 0.0201s/iter; left time: 200.3114s
	iters: 400, epoch: 3 | loss: 0.1273677
	speed: 0.0201s/iter; left time: 198.1885s
	iters: 500, epoch: 3 | loss: 0.1084824
	speed: 0.0201s/iter; left time: 196.1697s
Epoch: 3 cost time: 11.747270345687866
Epoch: 3, Steps: 570 | Train Loss: 0.1317193 Vali Loss: 0.0394654 Test Loss: 0.1277618
Validation loss decreased (0.039966 --> 0.039465).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0673430
	speed: 0.0612s/iter; left time: 586.5281s
	iters: 200, epoch: 4 | loss: 0.1248085
	speed: 0.0200s/iter; left time: 190.0301s
	iters: 300, epoch: 4 | loss: 0.0912658
	speed: 0.0201s/iter; left time: 188.5188s
	iters: 400, epoch: 4 | loss: 0.1342447
	speed: 0.0200s/iter; left time: 186.2129s
	iters: 500, epoch: 4 | loss: 0.0975383
	speed: 0.0201s/iter; left time: 184.5679s
Epoch: 4 cost time: 11.70975112915039
Epoch: 4, Steps: 570 | Train Loss: 0.1173056 Vali Loss: 0.0376338 Test Loss: 0.1263050
Validation loss decreased (0.039465 --> 0.037634).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1109312
	speed: 0.0614s/iter; left time: 554.0250s
	iters: 200, epoch: 5 | loss: 0.1237783
	speed: 0.0202s/iter; left time: 180.0908s
	iters: 300, epoch: 5 | loss: 0.1165981
	speed: 0.0202s/iter; left time: 178.0463s
	iters: 400, epoch: 5 | loss: 0.0904403
	speed: 0.0199s/iter; left time: 173.7618s
	iters: 500, epoch: 5 | loss: 0.1135031
	speed: 0.0199s/iter; left time: 171.3867s
Epoch: 5 cost time: 11.746366262435913
Epoch: 5, Steps: 570 | Train Loss: 0.1088367 Vali Loss: 0.0365250 Test Loss: 0.1262030
Validation loss decreased (0.037634 --> 0.036525).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1269113
	speed: 0.0621s/iter; left time: 524.5723s
	iters: 200, epoch: 6 | loss: 0.1076501
	speed: 0.0200s/iter; left time: 167.3072s
	iters: 300, epoch: 6 | loss: 0.1019956
	speed: 0.0200s/iter; left time: 165.1444s
	iters: 400, epoch: 6 | loss: 0.0877422
	speed: 0.0200s/iter; left time: 163.2987s
	iters: 500, epoch: 6 | loss: 0.1660132
	speed: 0.0200s/iter; left time: 161.0905s
Epoch: 6 cost time: 11.721249341964722
Epoch: 6, Steps: 570 | Train Loss: 0.1055819 Vali Loss: 0.0368312 Test Loss: 0.1275319
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1239618
	speed: 0.0608s/iter; left time: 479.5405s
	iters: 200, epoch: 7 | loss: 0.1024051
	speed: 0.0223s/iter; left time: 173.2255s
	iters: 300, epoch: 7 | loss: 0.1231804
	speed: 0.0222s/iter; left time: 170.1557s
	iters: 400, epoch: 7 | loss: 0.0943301
	speed: 0.0218s/iter; left time: 164.9806s
	iters: 500, epoch: 7 | loss: 0.0661685
	speed: 0.0201s/iter; left time: 150.7181s
Epoch: 7 cost time: 12.557000160217285
Epoch: 7, Steps: 570 | Train Loss: 0.1039574 Vali Loss: 0.0366394 Test Loss: 0.1269912
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1205875
	speed: 0.0597s/iter; left time: 436.4810s
	iters: 200, epoch: 8 | loss: 0.1459271
	speed: 0.0201s/iter; left time: 144.7574s
	iters: 300, epoch: 8 | loss: 0.1205403
	speed: 0.0201s/iter; left time: 142.8918s
	iters: 400, epoch: 8 | loss: 0.0813425
	speed: 0.0201s/iter; left time: 141.1731s
	iters: 500, epoch: 8 | loss: 0.1189137
	speed: 0.0201s/iter; left time: 138.9327s
Epoch: 8 cost time: 11.773037672042847
Epoch: 8, Steps: 570 | Train Loss: 0.1026915 Vali Loss: 0.0364686 Test Loss: 0.1263820
Validation loss decreased (0.036525 --> 0.036469).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1197486
	speed: 0.0604s/iter; left time: 407.1351s
	iters: 200, epoch: 9 | loss: 0.0918249
	speed: 0.0200s/iter; left time: 132.8698s
	iters: 300, epoch: 9 | loss: 0.1258810
	speed: 0.0200s/iter; left time: 130.9091s
	iters: 400, epoch: 9 | loss: 0.0980082
	speed: 0.0200s/iter; left time: 128.9198s
	iters: 500, epoch: 9 | loss: 0.0667927
	speed: 0.0200s/iter; left time: 126.8502s
Epoch: 9 cost time: 11.74398422241211
Epoch: 9, Steps: 570 | Train Loss: 0.1020714 Vali Loss: 0.0364871 Test Loss: 0.1269563
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1081315
	speed: 0.0587s/iter; left time: 362.2968s
	iters: 200, epoch: 10 | loss: 0.0703289
	speed: 0.0199s/iter; left time: 121.0711s
	iters: 300, epoch: 10 | loss: 0.1466069
	speed: 0.0199s/iter; left time: 118.9791s
	iters: 400, epoch: 10 | loss: 0.1373107
	speed: 0.0199s/iter; left time: 116.9315s
	iters: 500, epoch: 10 | loss: 0.1043450
	speed: 0.0199s/iter; left time: 114.9255s
Epoch: 10 cost time: 11.696372985839844
Epoch: 10, Steps: 570 | Train Loss: 0.1018137 Vali Loss: 0.0365492 Test Loss: 0.1266269
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0926427
	speed: 0.0607s/iter; left time: 339.8849s
	iters: 200, epoch: 11 | loss: 0.0865288
	speed: 0.0221s/iter; left time: 121.4595s
	iters: 300, epoch: 11 | loss: 0.0943823
	speed: 0.0216s/iter; left time: 116.4481s
	iters: 400, epoch: 11 | loss: 0.1200916
	speed: 0.0200s/iter; left time: 106.0811s
	iters: 500, epoch: 11 | loss: 0.0841507
	speed: 0.0200s/iter; left time: 104.1964s
Epoch: 11 cost time: 12.274529457092285
Epoch: 11, Steps: 570 | Train Loss: 0.1023736 Vali Loss: 0.0365195 Test Loss: 0.1265664
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12653130292892456, mae:0.22853916883468628
>>> MS_Raw LR=1e-4 DO=0.2 EL=2 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1838763
	speed: 0.0222s/iter; left time: 251.0311s
	iters: 200, epoch: 1 | loss: 0.2262921
	speed: 0.0106s/iter; left time: 118.7131s
	iters: 300, epoch: 1 | loss: 0.2421962
	speed: 0.0106s/iter; left time: 117.1444s
	iters: 400, epoch: 1 | loss: 0.2350823
	speed: 0.0105s/iter; left time: 115.7548s
	iters: 500, epoch: 1 | loss: 0.1849077
	speed: 0.0105s/iter; left time: 114.6602s
Epoch: 1 cost time: 7.225843191146851
Epoch: 1, Steps: 570 | Train Loss: 0.2469439 Vali Loss: 0.0468240 Test Loss: 0.1477441
Validation loss decreased (inf --> 0.046824).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3650033
	speed: 0.0368s/iter; left time: 395.1503s
	iters: 200, epoch: 2 | loss: 0.3034966
	speed: 0.0105s/iter; left time: 112.1443s
	iters: 300, epoch: 2 | loss: 0.2237196
	speed: 0.0105s/iter; left time: 110.9111s
	iters: 400, epoch: 2 | loss: 0.1715376
	speed: 0.0105s/iter; left time: 109.9140s
	iters: 500, epoch: 2 | loss: 0.2009435
	speed: 0.0105s/iter; left time: 108.5826s
Epoch: 2 cost time: 6.325387716293335
Epoch: 2, Steps: 570 | Train Loss: 0.2086817 Vali Loss: 0.0431858 Test Loss: 0.1302046
Validation loss decreased (0.046824 --> 0.043186).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1407596
	speed: 0.0393s/iter; left time: 399.6680s
	iters: 200, epoch: 3 | loss: 0.2522303
	speed: 0.0105s/iter; left time: 105.7376s
	iters: 300, epoch: 3 | loss: 0.1577499
	speed: 0.0105s/iter; left time: 104.9268s
	iters: 400, epoch: 3 | loss: 0.1961393
	speed: 0.0106s/iter; left time: 104.5506s
	iters: 500, epoch: 3 | loss: 0.2381822
	speed: 0.0106s/iter; left time: 103.2281s
Epoch: 3 cost time: 6.4038238525390625
Epoch: 3, Steps: 570 | Train Loss: 0.1940981 Vali Loss: 0.0392426 Test Loss: 0.1196013
Validation loss decreased (0.043186 --> 0.039243).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1993661
	speed: 0.0371s/iter; left time: 355.6156s
	iters: 200, epoch: 4 | loss: 0.1229510
	speed: 0.0106s/iter; left time: 100.6257s
	iters: 300, epoch: 4 | loss: 0.1835459
	speed: 0.0106s/iter; left time: 99.3618s
	iters: 400, epoch: 4 | loss: 0.1944800
	speed: 0.0106s/iter; left time: 98.5941s
	iters: 500, epoch: 4 | loss: 0.1841007
	speed: 0.0106s/iter; left time: 97.6178s
Epoch: 4 cost time: 6.380546569824219
Epoch: 4, Steps: 570 | Train Loss: 0.1866241 Vali Loss: 0.0382622 Test Loss: 0.1176750
Validation loss decreased (0.039243 --> 0.038262).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1781220
	speed: 0.0389s/iter; left time: 351.2727s
	iters: 200, epoch: 5 | loss: 0.1857679
	speed: 0.0119s/iter; left time: 106.1877s
	iters: 300, epoch: 5 | loss: 0.1451971
	speed: 0.0119s/iter; left time: 105.2673s
	iters: 400, epoch: 5 | loss: 0.1592865
	speed: 0.0118s/iter; left time: 103.1879s
	iters: 500, epoch: 5 | loss: 0.2001340
	speed: 0.0119s/iter; left time: 102.2796s
Epoch: 5 cost time: 7.092593431472778
Epoch: 5, Steps: 570 | Train Loss: 0.1833853 Vali Loss: 0.0377534 Test Loss: 0.1163326
Validation loss decreased (0.038262 --> 0.037753).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1641723
	speed: 0.0375s/iter; left time: 316.6061s
	iters: 200, epoch: 6 | loss: 0.1214992
	speed: 0.0106s/iter; left time: 88.4465s
	iters: 300, epoch: 6 | loss: 0.1937904
	speed: 0.0106s/iter; left time: 87.4157s
	iters: 400, epoch: 6 | loss: 0.2075890
	speed: 0.0105s/iter; left time: 85.9447s
	iters: 500, epoch: 6 | loss: 0.1625378
	speed: 0.0106s/iter; left time: 85.0313s
Epoch: 6 cost time: 6.310732364654541
Epoch: 6, Steps: 570 | Train Loss: 0.1814093 Vali Loss: 0.0374731 Test Loss: 0.1154826
Validation loss decreased (0.037753 --> 0.037473).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2088200
	speed: 0.0367s/iter; left time: 289.2476s
	iters: 200, epoch: 7 | loss: 0.2539992
	speed: 0.0105s/iter; left time: 81.6786s
	iters: 300, epoch: 7 | loss: 0.1518456
	speed: 0.0105s/iter; left time: 80.6420s
	iters: 400, epoch: 7 | loss: 0.1531211
	speed: 0.0105s/iter; left time: 79.6324s
	iters: 500, epoch: 7 | loss: 0.1590254
	speed: 0.0105s/iter; left time: 78.5260s
Epoch: 7 cost time: 6.298113107681274
Epoch: 7, Steps: 570 | Train Loss: 0.1806771 Vali Loss: 0.0374486 Test Loss: 0.1151799
Validation loss decreased (0.037473 --> 0.037449).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1841307
	speed: 0.0379s/iter; left time: 277.1064s
	iters: 200, epoch: 8 | loss: 0.1829584
	speed: 0.0106s/iter; left time: 76.0858s
	iters: 300, epoch: 8 | loss: 0.2311469
	speed: 0.0105s/iter; left time: 74.9103s
	iters: 400, epoch: 8 | loss: 0.2344930
	speed: 0.0105s/iter; left time: 73.8495s
	iters: 500, epoch: 8 | loss: 0.1260647
	speed: 0.0105s/iter; left time: 72.6925s
Epoch: 8 cost time: 6.298609972000122
Epoch: 8, Steps: 570 | Train Loss: 0.1801370 Vali Loss: 0.0372930 Test Loss: 0.1151874
Validation loss decreased (0.037449 --> 0.037293).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2357312
	speed: 0.0368s/iter; left time: 248.0715s
	iters: 200, epoch: 9 | loss: 0.1606665
	speed: 0.0104s/iter; left time: 69.3114s
	iters: 300, epoch: 9 | loss: 0.0794805
	speed: 0.0104s/iter; left time: 68.1602s
	iters: 400, epoch: 9 | loss: 0.1917628
	speed: 0.0104s/iter; left time: 67.1508s
	iters: 500, epoch: 9 | loss: 0.1591353
	speed: 0.0104s/iter; left time: 66.0579s
Epoch: 9 cost time: 6.241824150085449
Epoch: 9, Steps: 570 | Train Loss: 0.1792545 Vali Loss: 0.0375814 Test Loss: 0.1152591
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2054558
	speed: 0.0362s/iter; left time: 223.3108s
	iters: 200, epoch: 10 | loss: 0.1715946
	speed: 0.0105s/iter; left time: 63.6010s
	iters: 300, epoch: 10 | loss: 0.1450879
	speed: 0.0105s/iter; left time: 62.4398s
	iters: 400, epoch: 10 | loss: 0.1791696
	speed: 0.0104s/iter; left time: 61.3141s
	iters: 500, epoch: 10 | loss: 0.2627719
	speed: 0.0105s/iter; left time: 60.3369s
Epoch: 10 cost time: 6.270932912826538
Epoch: 10, Steps: 570 | Train Loss: 0.1789110 Vali Loss: 0.0374061 Test Loss: 0.1154338
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2018587
	speed: 0.0373s/iter; left time: 209.1385s
	iters: 200, epoch: 11 | loss: 0.1902418
	speed: 0.0105s/iter; left time: 57.5362s
	iters: 300, epoch: 11 | loss: 0.1466813
	speed: 0.0105s/iter; left time: 56.4607s
	iters: 400, epoch: 11 | loss: 0.2677454
	speed: 0.0105s/iter; left time: 55.4240s
	iters: 500, epoch: 11 | loss: 0.1518935
	speed: 0.0105s/iter; left time: 54.3813s
Epoch: 11 cost time: 6.273991346359253
Epoch: 11, Steps: 570 | Train Loss: 0.1808354 Vali Loss: 0.0372992 Test Loss: 0.1152959
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1153513640165329, mae:0.206453338265419
>>> MS_Raw LR=1e-4 DO=0.2 EL=2 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1828886
	speed: 0.0219s/iter; left time: 247.0193s
	iters: 200, epoch: 1 | loss: 0.2457823
	speed: 0.0102s/iter; left time: 114.5594s
	iters: 300, epoch: 1 | loss: 0.3082028
	speed: 0.0103s/iter; left time: 114.1620s
	iters: 400, epoch: 1 | loss: 0.2259460
	speed: 0.0103s/iter; left time: 112.8504s
	iters: 500, epoch: 1 | loss: 0.2219390
	speed: 0.0103s/iter; left time: 111.8842s
Epoch: 1 cost time: 7.051724195480347
Epoch: 1, Steps: 570 | Train Loss: 0.2199660 Vali Loss: 0.0366850 Test Loss: 0.1126287
Validation loss decreased (inf --> 0.036685).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1593059
	speed: 0.0365s/iter; left time: 391.8790s
	iters: 200, epoch: 2 | loss: 0.2054645
	speed: 0.0103s/iter; left time: 109.9468s
	iters: 300, epoch: 2 | loss: 0.1543722
	speed: 0.0104s/iter; left time: 109.3358s
	iters: 400, epoch: 2 | loss: 0.1701510
	speed: 0.0104s/iter; left time: 108.2065s
	iters: 500, epoch: 2 | loss: 0.2060413
	speed: 0.0103s/iter; left time: 106.2140s
Epoch: 2 cost time: 6.201563596725464
Epoch: 2, Steps: 570 | Train Loss: 0.1892942 Vali Loss: 0.0348876 Test Loss: 0.1103104
Validation loss decreased (0.036685 --> 0.034888).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1005346
	speed: 0.0367s/iter; left time: 373.2540s
	iters: 200, epoch: 3 | loss: 0.1503472
	speed: 0.0103s/iter; left time: 103.8605s
	iters: 300, epoch: 3 | loss: 0.3203785
	speed: 0.0103s/iter; left time: 102.8672s
	iters: 400, epoch: 3 | loss: 0.1883775
	speed: 0.0103s/iter; left time: 101.6203s
	iters: 500, epoch: 3 | loss: 0.1290856
	speed: 0.0103s/iter; left time: 100.6232s
Epoch: 3 cost time: 6.191552400588989
Epoch: 3, Steps: 570 | Train Loss: 0.1770942 Vali Loss: 0.0338217 Test Loss: 0.1093030
Validation loss decreased (0.034888 --> 0.033822).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1441337
	speed: 0.0374s/iter; left time: 358.9720s
	iters: 200, epoch: 4 | loss: 0.1593233
	speed: 0.0103s/iter; left time: 97.5930s
	iters: 300, epoch: 4 | loss: 0.1120121
	speed: 0.0103s/iter; left time: 96.4898s
	iters: 400, epoch: 4 | loss: 0.1324253
	speed: 0.0103s/iter; left time: 95.3952s
	iters: 500, epoch: 4 | loss: 0.2130708
	speed: 0.0103s/iter; left time: 94.5276s
Epoch: 4 cost time: 6.15379524230957
Epoch: 4, Steps: 570 | Train Loss: 0.1718756 Vali Loss: 0.0328530 Test Loss: 0.1078141
Validation loss decreased (0.033822 --> 0.032853).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1337461
	speed: 0.0363s/iter; left time: 327.4795s
	iters: 200, epoch: 5 | loss: 0.2215776
	speed: 0.0102s/iter; left time: 90.8933s
	iters: 300, epoch: 5 | loss: 0.1527465
	speed: 0.0102s/iter; left time: 89.8472s
	iters: 400, epoch: 5 | loss: 0.1537911
	speed: 0.0102s/iter; left time: 88.7998s
	iters: 500, epoch: 5 | loss: 0.1676764
	speed: 0.0102s/iter; left time: 87.8580s
Epoch: 5 cost time: 6.11283016204834
Epoch: 5, Steps: 570 | Train Loss: 0.1691386 Vali Loss: 0.0326039 Test Loss: 0.1077918
Validation loss decreased (0.032853 --> 0.032604).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1157265
	speed: 0.0364s/iter; left time: 307.8819s
	iters: 200, epoch: 6 | loss: 0.2231238
	speed: 0.0103s/iter; left time: 85.8440s
	iters: 300, epoch: 6 | loss: 0.1714498
	speed: 0.0103s/iter; left time: 84.6785s
	iters: 400, epoch: 6 | loss: 0.1467870
	speed: 0.0102s/iter; left time: 83.3794s
	iters: 500, epoch: 6 | loss: 0.1083220
	speed: 0.0102s/iter; left time: 82.1794s
Epoch: 6 cost time: 6.120543718338013
Epoch: 6, Steps: 570 | Train Loss: 0.1677612 Vali Loss: 0.0324452 Test Loss: 0.1069785
Validation loss decreased (0.032604 --> 0.032445).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1656626
	speed: 0.0370s/iter; left time: 291.3520s
	iters: 200, epoch: 7 | loss: 0.1971352
	speed: 0.0103s/iter; left time: 80.3269s
	iters: 300, epoch: 7 | loss: 0.2850979
	speed: 0.0103s/iter; left time: 79.2873s
	iters: 400, epoch: 7 | loss: 0.2115485
	speed: 0.0103s/iter; left time: 78.2250s
	iters: 500, epoch: 7 | loss: 0.1697742
	speed: 0.0103s/iter; left time: 77.1582s
Epoch: 7 cost time: 6.1693713665008545
Epoch: 7, Steps: 570 | Train Loss: 0.1670734 Vali Loss: 0.0323769 Test Loss: 0.1075213
Validation loss decreased (0.032445 --> 0.032377).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1333192
	speed: 0.0358s/iter; left time: 261.9326s
	iters: 200, epoch: 8 | loss: 0.1212558
	speed: 0.0102s/iter; left time: 73.4021s
	iters: 300, epoch: 8 | loss: 0.1591988
	speed: 0.0102s/iter; left time: 72.3692s
	iters: 400, epoch: 8 | loss: 0.1547630
	speed: 0.0102s/iter; left time: 71.3831s
	iters: 500, epoch: 8 | loss: 0.1005236
	speed: 0.0102s/iter; left time: 70.3470s
Epoch: 8 cost time: 6.1146204471588135
Epoch: 8, Steps: 570 | Train Loss: 0.1678574 Vali Loss: 0.0322266 Test Loss: 0.1071254
Validation loss decreased (0.032377 --> 0.032227).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1429574
	speed: 0.0360s/iter; left time: 243.0037s
	iters: 200, epoch: 9 | loss: 0.1759467
	speed: 0.0103s/iter; left time: 68.1228s
	iters: 300, epoch: 9 | loss: 0.1407218
	speed: 0.0102s/iter; left time: 66.9584s
	iters: 400, epoch: 9 | loss: 0.2024473
	speed: 0.0102s/iter; left time: 65.8938s
	iters: 500, epoch: 9 | loss: 0.1664674
	speed: 0.0102s/iter; left time: 64.7624s
Epoch: 9 cost time: 6.122709512710571
Epoch: 9, Steps: 570 | Train Loss: 0.1662162 Vali Loss: 0.0323011 Test Loss: 0.1072334
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1816216
	speed: 0.0367s/iter; left time: 226.5989s
	iters: 200, epoch: 10 | loss: 0.1361496
	speed: 0.0115s/iter; left time: 70.0965s
	iters: 300, epoch: 10 | loss: 0.1309139
	speed: 0.0115s/iter; left time: 68.7973s
	iters: 400, epoch: 10 | loss: 0.1110898
	speed: 0.0108s/iter; left time: 63.4293s
	iters: 500, epoch: 10 | loss: 0.1107252
	speed: 0.0102s/iter; left time: 59.0878s
Epoch: 10 cost time: 6.563042163848877
Epoch: 10, Steps: 570 | Train Loss: 0.1679023 Vali Loss: 0.0323042 Test Loss: 0.1072503
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1647340
	speed: 0.0347s/iter; left time: 194.5855s
	iters: 200, epoch: 11 | loss: 0.1793726
	speed: 0.0102s/iter; left time: 56.1540s
	iters: 300, epoch: 11 | loss: 0.1983196
	speed: 0.0102s/iter; left time: 55.2272s
	iters: 400, epoch: 11 | loss: 0.1548596
	speed: 0.0102s/iter; left time: 54.3082s
	iters: 500, epoch: 11 | loss: 0.1399179
	speed: 0.0102s/iter; left time: 53.2546s
Epoch: 11 cost time: 6.106904983520508
Epoch: 11, Steps: 570 | Train Loss: 0.1657922 Vali Loss: 0.0321813 Test Loss: 0.1072216
Validation loss decreased (0.032227 --> 0.032181).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1445267
	speed: 0.0361s/iter; left time: 181.5789s
	iters: 200, epoch: 12 | loss: 0.1725959
	speed: 0.0102s/iter; left time: 50.4624s
	iters: 300, epoch: 12 | loss: 0.1363489
	speed: 0.0103s/iter; left time: 49.8083s
	iters: 400, epoch: 12 | loss: 0.2557544
	speed: 0.0104s/iter; left time: 49.0061s
	iters: 500, epoch: 12 | loss: 0.1478703
	speed: 0.0103s/iter; left time: 47.9181s
Epoch: 12 cost time: 6.152496099472046
Epoch: 12, Steps: 570 | Train Loss: 0.1666862 Vali Loss: 0.0322796 Test Loss: 0.1072213
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2649360
	speed: 0.0357s/iter; left time: 159.4009s
	iters: 200, epoch: 13 | loss: 0.2243658
	speed: 0.0103s/iter; left time: 45.0616s
	iters: 300, epoch: 13 | loss: 0.1305198
	speed: 0.0103s/iter; left time: 44.0525s
	iters: 400, epoch: 13 | loss: 0.1820780
	speed: 0.0103s/iter; left time: 43.0465s
	iters: 500, epoch: 13 | loss: 0.1925435
	speed: 0.0104s/iter; left time: 42.0558s
Epoch: 13 cost time: 6.246624231338501
Epoch: 13, Steps: 570 | Train Loss: 0.1665053 Vali Loss: 0.0321626 Test Loss: 0.1072109
Validation loss decreased (0.032181 --> 0.032163).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1634994
	speed: 0.0362s/iter; left time: 140.9213s
	iters: 200, epoch: 14 | loss: 0.1243813
	speed: 0.0102s/iter; left time: 38.8138s
	iters: 300, epoch: 14 | loss: 0.1844851
	speed: 0.0102s/iter; left time: 37.7473s
	iters: 400, epoch: 14 | loss: 0.1706056
	speed: 0.0102s/iter; left time: 36.7763s
	iters: 500, epoch: 14 | loss: 0.1824636
	speed: 0.0102s/iter; left time: 35.6860s
Epoch: 14 cost time: 6.097046375274658
Epoch: 14, Steps: 570 | Train Loss: 0.1669251 Vali Loss: 0.0322283 Test Loss: 0.1072074
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1038841
	speed: 0.0346s/iter; left time: 115.0507s
	iters: 200, epoch: 15 | loss: 0.1738171
	speed: 0.0102s/iter; left time: 32.9477s
	iters: 300, epoch: 15 | loss: 0.1616683
	speed: 0.0102s/iter; left time: 31.8905s
	iters: 400, epoch: 15 | loss: 0.1510081
	speed: 0.0102s/iter; left time: 30.8729s
	iters: 500, epoch: 15 | loss: 0.1392745
	speed: 0.0102s/iter; left time: 29.8708s
Epoch: 15 cost time: 6.123384237289429
Epoch: 15, Steps: 570 | Train Loss: 0.1655932 Vali Loss: 0.0321591 Test Loss: 0.1072100
Validation loss decreased (0.032163 --> 0.032159).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2543693
	speed: 0.0358s/iter; left time: 98.3567s
	iters: 200, epoch: 16 | loss: 0.1520774
	speed: 0.0102s/iter; left time: 27.1166s
	iters: 300, epoch: 16 | loss: 0.2085544
	speed: 0.0102s/iter; left time: 26.1133s
	iters: 400, epoch: 16 | loss: 0.1595235
	speed: 0.0103s/iter; left time: 25.1502s
	iters: 500, epoch: 16 | loss: 0.2832646
	speed: 0.0103s/iter; left time: 24.1191s
Epoch: 16 cost time: 6.137059926986694
Epoch: 16, Steps: 570 | Train Loss: 0.1666242 Vali Loss: 0.0321436 Test Loss: 0.1072102
Validation loss decreased (0.032159 --> 0.032144).  Saving model ...
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1185087
	speed: 0.0361s/iter; left time: 78.7859s
	iters: 200, epoch: 17 | loss: 0.1497921
	speed: 0.0103s/iter; left time: 21.5216s
	iters: 300, epoch: 17 | loss: 0.1590874
	speed: 0.0103s/iter; left time: 20.4168s
	iters: 400, epoch: 17 | loss: 0.1416201
	speed: 0.0103s/iter; left time: 19.4237s
	iters: 500, epoch: 17 | loss: 0.1077986
	speed: 0.0103s/iter; left time: 18.3919s
Epoch: 17 cost time: 6.195679426193237
Epoch: 17, Steps: 570 | Train Loss: 0.1670342 Vali Loss: 0.0322758 Test Loss: 0.1072100
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.2016373
	speed: 0.0361s/iter; left time: 58.1427s
	iters: 200, epoch: 18 | loss: 0.1689910
	speed: 0.0103s/iter; left time: 15.5491s
	iters: 300, epoch: 18 | loss: 0.1362761
	speed: 0.0102s/iter; left time: 14.4424s
	iters: 400, epoch: 18 | loss: 0.2473616
	speed: 0.0103s/iter; left time: 13.4426s
	iters: 500, epoch: 18 | loss: 0.1303532
	speed: 0.0103s/iter; left time: 12.4434s
Epoch: 18 cost time: 6.146579742431641
Epoch: 18, Steps: 570 | Train Loss: 0.1664147 Vali Loss: 0.0322466 Test Loss: 0.1072100
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1495986
	speed: 0.0352s/iter; left time: 36.5980s
	iters: 200, epoch: 19 | loss: 0.1992128
	speed: 0.0103s/iter; left time: 9.6771s
	iters: 300, epoch: 19 | loss: 0.1432451
	speed: 0.0103s/iter; left time: 8.6509s
	iters: 400, epoch: 19 | loss: 0.1850358
	speed: 0.0103s/iter; left time: 7.6358s
	iters: 500, epoch: 19 | loss: 0.1601970
	speed: 0.0103s/iter; left time: 6.6072s
Epoch: 19 cost time: 6.143698453903198
Epoch: 19, Steps: 570 | Train Loss: 0.1664159 Vali Loss: 0.0322582 Test Loss: 0.1072100
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1073606014251709, mae:0.19618366658687592
>>> MS_Raw LR=1e-4 DO=0.2 EL=2 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2698248
	speed: 0.0220s/iter; left time: 248.1237s
	iters: 200, epoch: 1 | loss: 0.1963461
	speed: 0.0103s/iter; left time: 115.1373s
	iters: 300, epoch: 1 | loss: 0.1730838
	speed: 0.0103s/iter; left time: 114.3203s
	iters: 400, epoch: 1 | loss: 0.1825804
	speed: 0.0102s/iter; left time: 112.6410s
	iters: 500, epoch: 1 | loss: 0.2201471
	speed: 0.0103s/iter; left time: 111.7809s
Epoch: 1 cost time: 7.07037091255188
Epoch: 1, Steps: 570 | Train Loss: 0.2553634 Vali Loss: 0.0487838 Test Loss: 0.1375273
Validation loss decreased (inf --> 0.048784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2197944
	speed: 0.0365s/iter; left time: 391.3895s
	iters: 200, epoch: 2 | loss: 0.2865478
	speed: 0.0104s/iter; left time: 110.8027s
	iters: 300, epoch: 2 | loss: 0.2022398
	speed: 0.0104s/iter; left time: 109.7375s
	iters: 400, epoch: 2 | loss: 0.2947821
	speed: 0.0104s/iter; left time: 108.4003s
	iters: 500, epoch: 2 | loss: 0.2457532
	speed: 0.0104s/iter; left time: 107.5984s
Epoch: 2 cost time: 6.2481982707977295
Epoch: 2, Steps: 570 | Train Loss: 0.2137631 Vali Loss: 0.0405234 Test Loss: 0.1260065
Validation loss decreased (0.048784 --> 0.040523).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1453066
	speed: 0.0360s/iter; left time: 365.8177s
	iters: 200, epoch: 3 | loss: 0.1868069
	speed: 0.0104s/iter; left time: 104.5549s
	iters: 300, epoch: 3 | loss: 0.2248434
	speed: 0.0104s/iter; left time: 103.4490s
	iters: 400, epoch: 3 | loss: 0.1697673
	speed: 0.0104s/iter; left time: 102.1783s
	iters: 500, epoch: 3 | loss: 0.1538604
	speed: 0.0104s/iter; left time: 101.1915s
Epoch: 3 cost time: 6.224148273468018
Epoch: 3, Steps: 570 | Train Loss: 0.2001636 Vali Loss: 0.0395559 Test Loss: 0.1234830
Validation loss decreased (0.040523 --> 0.039556).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1186689
	speed: 0.0367s/iter; left time: 351.5545s
	iters: 200, epoch: 4 | loss: 0.1220308
	speed: 0.0104s/iter; left time: 98.6100s
	iters: 300, epoch: 4 | loss: 0.1631663
	speed: 0.0104s/iter; left time: 97.8915s
	iters: 400, epoch: 4 | loss: 0.2533978
	speed: 0.0104s/iter; left time: 96.8378s
	iters: 500, epoch: 4 | loss: 0.1756260
	speed: 0.0104s/iter; left time: 95.8816s
Epoch: 4 cost time: 6.236478567123413
Epoch: 4, Steps: 570 | Train Loss: 0.1933635 Vali Loss: 0.0392864 Test Loss: 0.1252249
Validation loss decreased (0.039556 --> 0.039286).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1849314
	speed: 0.0356s/iter; left time: 320.8436s
	iters: 200, epoch: 5 | loss: 0.1326260
	speed: 0.0103s/iter; left time: 92.0696s
	iters: 300, epoch: 5 | loss: 0.2090940
	speed: 0.0102s/iter; left time: 90.1255s
	iters: 400, epoch: 5 | loss: 0.1819342
	speed: 0.0102s/iter; left time: 89.2926s
	iters: 500, epoch: 5 | loss: 0.2528400
	speed: 0.0103s/iter; left time: 88.4119s
Epoch: 5 cost time: 6.147118091583252
Epoch: 5, Steps: 570 | Train Loss: 0.1899995 Vali Loss: 0.0387793 Test Loss: 0.1243352
Validation loss decreased (0.039286 --> 0.038779).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1329355
	speed: 0.0367s/iter; left time: 310.1204s
	iters: 200, epoch: 6 | loss: 0.1990060
	speed: 0.0103s/iter; left time: 85.9468s
	iters: 300, epoch: 6 | loss: 0.1675856
	speed: 0.0103s/iter; left time: 85.0888s
	iters: 400, epoch: 6 | loss: 0.1494978
	speed: 0.0103s/iter; left time: 84.2806s
	iters: 500, epoch: 6 | loss: 0.1950927
	speed: 0.0103s/iter; left time: 83.1224s
Epoch: 6 cost time: 6.177678108215332
Epoch: 6, Steps: 570 | Train Loss: 0.1885858 Vali Loss: 0.0383679 Test Loss: 0.1227845
Validation loss decreased (0.038779 --> 0.038368).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1334369
	speed: 0.0359s/iter; left time: 282.5682s
	iters: 200, epoch: 7 | loss: 0.1708986
	speed: 0.0103s/iter; left time: 79.9623s
	iters: 300, epoch: 7 | loss: 0.1579319
	speed: 0.0103s/iter; left time: 78.8644s
	iters: 400, epoch: 7 | loss: 0.1086935
	speed: 0.0103s/iter; left time: 77.8679s
	iters: 500, epoch: 7 | loss: 0.2146642
	speed: 0.0103s/iter; left time: 76.8192s
Epoch: 7 cost time: 6.136704206466675
Epoch: 7, Steps: 570 | Train Loss: 0.1858311 Vali Loss: 0.0383617 Test Loss: 0.1226782
Validation loss decreased (0.038368 --> 0.038362).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1608976
	speed: 0.0368s/iter; left time: 268.8417s
	iters: 200, epoch: 8 | loss: 0.1631071
	speed: 0.0104s/iter; left time: 74.6689s
	iters: 300, epoch: 8 | loss: 0.2231359
	speed: 0.0104s/iter; left time: 73.7900s
	iters: 400, epoch: 8 | loss: 0.2170218
	speed: 0.0104s/iter; left time: 72.9813s
	iters: 500, epoch: 8 | loss: 0.1870292
	speed: 0.0104s/iter; left time: 71.7239s
Epoch: 8 cost time: 6.236350774765015
Epoch: 8, Steps: 570 | Train Loss: 0.1859616 Vali Loss: 0.0384163 Test Loss: 0.1231131
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1614467
	speed: 0.0361s/iter; left time: 243.3964s
	iters: 200, epoch: 9 | loss: 0.2182490
	speed: 0.0103s/iter; left time: 68.6198s
	iters: 300, epoch: 9 | loss: 0.1493307
	speed: 0.0104s/iter; left time: 67.7176s
	iters: 400, epoch: 9 | loss: 0.1383214
	speed: 0.0103s/iter; left time: 66.6227s
	iters: 500, epoch: 9 | loss: 0.1916260
	speed: 0.0109s/iter; left time: 69.2644s
Epoch: 9 cost time: 6.331952810287476
Epoch: 9, Steps: 570 | Train Loss: 0.1843808 Vali Loss: 0.0384711 Test Loss: 0.1228933
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1567998
	speed: 0.0372s/iter; left time: 229.8274s
	iters: 200, epoch: 10 | loss: 0.2485952
	speed: 0.0104s/iter; left time: 62.8670s
	iters: 300, epoch: 10 | loss: 0.2517125
	speed: 0.0104s/iter; left time: 61.9345s
	iters: 400, epoch: 10 | loss: 0.2100986
	speed: 0.0104s/iter; left time: 60.8306s
	iters: 500, epoch: 10 | loss: 0.2018932
	speed: 0.0103s/iter; left time: 59.7179s
Epoch: 10 cost time: 6.240027666091919
Epoch: 10, Steps: 570 | Train Loss: 0.1854664 Vali Loss: 0.0385537 Test Loss: 0.1228057
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12285853922367096, mae:0.21647882461547852
>>> MS_Raw LR=1e-4 DO=0.2 EL=2 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2728188
	speed: 0.0252s/iter; left time: 284.6285s
	iters: 200, epoch: 1 | loss: 0.2574952
	speed: 0.0128s/iter; left time: 143.8559s
	iters: 300, epoch: 1 | loss: 0.1812697
	speed: 0.0119s/iter; left time: 131.7790s
	iters: 400, epoch: 1 | loss: 0.1532026
	speed: 0.0119s/iter; left time: 130.5321s
	iters: 500, epoch: 1 | loss: 0.2401675
	speed: 0.0119s/iter; left time: 129.5310s
Epoch: 1 cost time: 8.246328830718994
Epoch: 1, Steps: 570 | Train Loss: 0.2418825 Vali Loss: 0.0426715 Test Loss: 0.1281548
Validation loss decreased (inf --> 0.042671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2165265
	speed: 0.0403s/iter; left time: 432.7035s
	iters: 200, epoch: 2 | loss: 0.1754232
	speed: 0.0119s/iter; left time: 126.4943s
	iters: 300, epoch: 2 | loss: 0.1547919
	speed: 0.0119s/iter; left time: 125.5768s
	iters: 400, epoch: 2 | loss: 0.1172236
	speed: 0.0122s/iter; left time: 127.5625s
	iters: 500, epoch: 2 | loss: 0.2130183
	speed: 0.0129s/iter; left time: 133.7460s
Epoch: 2 cost time: 7.376681566238403
Epoch: 2, Steps: 570 | Train Loss: 0.2053043 Vali Loss: 0.0398624 Test Loss: 0.1240785
Validation loss decreased (0.042671 --> 0.039862).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2351242
	speed: 0.0410s/iter; left time: 416.3587s
	iters: 200, epoch: 3 | loss: 0.2170653
	speed: 0.0129s/iter; left time: 130.1418s
	iters: 300, epoch: 3 | loss: 0.1421339
	speed: 0.0124s/iter; left time: 123.4714s
	iters: 400, epoch: 3 | loss: 0.1911538
	speed: 0.0128s/iter; left time: 126.2918s
	iters: 500, epoch: 3 | loss: 0.1371060
	speed: 0.0128s/iter; left time: 124.9613s
Epoch: 3 cost time: 7.5858681201934814
Epoch: 3, Steps: 570 | Train Loss: 0.1833844 Vali Loss: 0.0381102 Test Loss: 0.1208010
Validation loss decreased (0.039862 --> 0.038110).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1335539
	speed: 0.0411s/iter; left time: 394.5717s
	iters: 200, epoch: 4 | loss: 0.2521101
	speed: 0.0128s/iter; left time: 121.2661s
	iters: 300, epoch: 4 | loss: 0.1180318
	speed: 0.0128s/iter; left time: 120.3766s
	iters: 400, epoch: 4 | loss: 0.1190270
	speed: 0.0119s/iter; left time: 110.8025s
	iters: 500, epoch: 4 | loss: 0.1296462
	speed: 0.0118s/iter; left time: 108.7242s
Epoch: 4 cost time: 7.320377826690674
Epoch: 4, Steps: 570 | Train Loss: 0.1727422 Vali Loss: 0.0359602 Test Loss: 0.1186741
Validation loss decreased (0.038110 --> 0.035960).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1812001
	speed: 0.0396s/iter; left time: 357.4207s
	iters: 200, epoch: 5 | loss: 0.1499797
	speed: 0.0118s/iter; left time: 105.6281s
	iters: 300, epoch: 5 | loss: 0.2162277
	speed: 0.0119s/iter; left time: 104.7490s
	iters: 400, epoch: 5 | loss: 0.1553775
	speed: 0.0119s/iter; left time: 103.4258s
	iters: 500, epoch: 5 | loss: 0.1368521
	speed: 0.0118s/iter; left time: 102.0748s
Epoch: 5 cost time: 7.08117413520813
Epoch: 5, Steps: 570 | Train Loss: 0.1688252 Vali Loss: 0.0367247 Test Loss: 0.1190778
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1485026
	speed: 0.0412s/iter; left time: 348.2744s
	iters: 200, epoch: 6 | loss: 0.0967241
	speed: 0.0129s/iter; left time: 107.6781s
	iters: 300, epoch: 6 | loss: 0.2068383
	speed: 0.0129s/iter; left time: 106.6169s
	iters: 400, epoch: 6 | loss: 0.2037544
	speed: 0.0130s/iter; left time: 105.6356s
	iters: 500, epoch: 6 | loss: 0.1254910
	speed: 0.0118s/iter; left time: 95.3282s
Epoch: 6 cost time: 7.556307792663574
Epoch: 6, Steps: 570 | Train Loss: 0.1657459 Vali Loss: 0.0353277 Test Loss: 0.1163611
Validation loss decreased (0.035960 --> 0.035328).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1641413
	speed: 0.0400s/iter; left time: 315.1026s
	iters: 200, epoch: 7 | loss: 0.1582499
	speed: 0.0118s/iter; left time: 91.8307s
	iters: 300, epoch: 7 | loss: 0.1567524
	speed: 0.0118s/iter; left time: 91.0062s
	iters: 400, epoch: 7 | loss: 0.1162649
	speed: 0.0118s/iter; left time: 89.6464s
	iters: 500, epoch: 7 | loss: 0.1505215
	speed: 0.0118s/iter; left time: 88.1922s
Epoch: 7 cost time: 7.045160293579102
Epoch: 7, Steps: 570 | Train Loss: 0.1633433 Vali Loss: 0.0350584 Test Loss: 0.1166410
Validation loss decreased (0.035328 --> 0.035058).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1034093
	speed: 0.0409s/iter; left time: 298.8656s
	iters: 200, epoch: 8 | loss: 0.1616497
	speed: 0.0118s/iter; left time: 85.3329s
	iters: 300, epoch: 8 | loss: 0.1574582
	speed: 0.0118s/iter; left time: 84.1354s
	iters: 400, epoch: 8 | loss: 0.1227569
	speed: 0.0118s/iter; left time: 82.7899s
	iters: 500, epoch: 8 | loss: 0.1155061
	speed: 0.0118s/iter; left time: 81.6932s
Epoch: 8 cost time: 7.024193286895752
Epoch: 8, Steps: 570 | Train Loss: 0.1651215 Vali Loss: 0.0351653 Test Loss: 0.1164627
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1255578
	speed: 0.0376s/iter; left time: 253.7866s
	iters: 200, epoch: 9 | loss: 0.1620957
	speed: 0.0118s/iter; left time: 78.5182s
	iters: 300, epoch: 9 | loss: 0.1645151
	speed: 0.0118s/iter; left time: 77.2202s
	iters: 400, epoch: 9 | loss: 0.1184326
	speed: 0.0118s/iter; left time: 76.0490s
	iters: 500, epoch: 9 | loss: 0.2043733
	speed: 0.0118s/iter; left time: 74.9062s
Epoch: 9 cost time: 7.00592303276062
Epoch: 9, Steps: 570 | Train Loss: 0.1640864 Vali Loss: 0.0350849 Test Loss: 0.1165322
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1445729
	speed: 0.0396s/iter; left time: 244.2260s
	iters: 200, epoch: 10 | loss: 0.1848298
	speed: 0.0118s/iter; left time: 71.7466s
	iters: 300, epoch: 10 | loss: 0.1493964
	speed: 0.0118s/iter; left time: 70.6851s
	iters: 400, epoch: 10 | loss: 0.1604544
	speed: 0.0118s/iter; left time: 69.3974s
	iters: 500, epoch: 10 | loss: 0.1954258
	speed: 0.0118s/iter; left time: 68.1276s
Epoch: 10 cost time: 7.043286561965942
Epoch: 10, Steps: 570 | Train Loss: 0.1638730 Vali Loss: 0.0352154 Test Loss: 0.1164913
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11679396778345108, mae:0.21177786588668823
>>> MS_Raw LR=1e-4 DO=0.2 EL=2 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1363186
	speed: 0.0251s/iter; left time: 283.6893s
	iters: 200, epoch: 1 | loss: 0.3413582
	speed: 0.0125s/iter; left time: 140.3397s
	iters: 300, epoch: 1 | loss: 0.1783569
	speed: 0.0122s/iter; left time: 135.0208s
	iters: 400, epoch: 1 | loss: 0.2139740
	speed: 0.0114s/iter; left time: 125.5539s
	iters: 500, epoch: 1 | loss: 0.1596255
	speed: 0.0114s/iter; left time: 124.7123s
Epoch: 1 cost time: 8.11401081085205
Epoch: 1, Steps: 570 | Train Loss: 0.2173056 Vali Loss: 0.0368995 Test Loss: 0.1138321
Validation loss decreased (inf --> 0.036899).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1699772
	speed: 0.0389s/iter; left time: 417.2075s
	iters: 200, epoch: 2 | loss: 0.1333708
	speed: 0.0114s/iter; left time: 121.3890s
	iters: 300, epoch: 2 | loss: 0.1933986
	speed: 0.0114s/iter; left time: 120.3295s
	iters: 400, epoch: 2 | loss: 0.2743535
	speed: 0.0114s/iter; left time: 119.0353s
	iters: 500, epoch: 2 | loss: 0.2752552
	speed: 0.0114s/iter; left time: 118.0238s
Epoch: 2 cost time: 6.847614765167236
Epoch: 2, Steps: 570 | Train Loss: 0.1849333 Vali Loss: 0.0353342 Test Loss: 0.1119078
Validation loss decreased (0.036899 --> 0.035334).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2045713
	speed: 0.0395s/iter; left time: 401.6793s
	iters: 200, epoch: 3 | loss: 0.1044277
	speed: 0.0114s/iter; left time: 114.7492s
	iters: 300, epoch: 3 | loss: 0.1900565
	speed: 0.0114s/iter; left time: 113.8498s
	iters: 400, epoch: 3 | loss: 0.1648793
	speed: 0.0114s/iter; left time: 112.6239s
	iters: 500, epoch: 3 | loss: 0.2183758
	speed: 0.0114s/iter; left time: 111.4941s
Epoch: 3 cost time: 6.839529514312744
Epoch: 3, Steps: 570 | Train Loss: 0.1719539 Vali Loss: 0.0331079 Test Loss: 0.1087243
Validation loss decreased (0.035334 --> 0.033108).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1481705
	speed: 0.0404s/iter; left time: 387.3739s
	iters: 200, epoch: 4 | loss: 0.1115734
	speed: 0.0115s/iter; left time: 109.3050s
	iters: 300, epoch: 4 | loss: 0.0927960
	speed: 0.0115s/iter; left time: 107.9780s
	iters: 400, epoch: 4 | loss: 0.1426336
	speed: 0.0115s/iter; left time: 106.8116s
	iters: 500, epoch: 4 | loss: 0.1575047
	speed: 0.0115s/iter; left time: 105.6646s
Epoch: 4 cost time: 6.853670597076416
Epoch: 4, Steps: 570 | Train Loss: 0.1625956 Vali Loss: 0.0322053 Test Loss: 0.1091411
Validation loss decreased (0.033108 --> 0.032205).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1714803
	speed: 0.0380s/iter; left time: 342.9240s
	iters: 200, epoch: 5 | loss: 0.1156754
	speed: 0.0115s/iter; left time: 102.3139s
	iters: 300, epoch: 5 | loss: 0.2285974
	speed: 0.0115s/iter; left time: 101.3275s
	iters: 400, epoch: 5 | loss: 0.1490882
	speed: 0.0115s/iter; left time: 99.9340s
	iters: 500, epoch: 5 | loss: 0.1352341
	speed: 0.0114s/iter; left time: 98.5072s
Epoch: 5 cost time: 6.812535285949707
Epoch: 5, Steps: 570 | Train Loss: 0.1591634 Vali Loss: 0.0319482 Test Loss: 0.1095468
Validation loss decreased (0.032205 --> 0.031948).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2010585
	speed: 0.0393s/iter; left time: 331.9218s
	iters: 200, epoch: 6 | loss: 0.1728979
	speed: 0.0126s/iter; left time: 104.8690s
	iters: 300, epoch: 6 | loss: 0.1127171
	speed: 0.0125s/iter; left time: 103.2252s
	iters: 400, epoch: 6 | loss: 0.1233015
	speed: 0.0125s/iter; left time: 101.9779s
	iters: 500, epoch: 6 | loss: 0.1220856
	speed: 0.0120s/iter; left time: 96.4524s
Epoch: 6 cost time: 7.304550409317017
Epoch: 6, Steps: 570 | Train Loss: 0.1572244 Vali Loss: 0.0312679 Test Loss: 0.1084600
Validation loss decreased (0.031948 --> 0.031268).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1036759
	speed: 0.0389s/iter; left time: 306.4704s
	iters: 200, epoch: 7 | loss: 0.1983109
	speed: 0.0114s/iter; left time: 89.0683s
	iters: 300, epoch: 7 | loss: 0.1038504
	speed: 0.0114s/iter; left time: 87.9022s
	iters: 400, epoch: 7 | loss: 0.1253054
	speed: 0.0114s/iter; left time: 86.7548s
	iters: 500, epoch: 7 | loss: 0.1448579
	speed: 0.0115s/iter; left time: 85.7180s
Epoch: 7 cost time: 6.843865871429443
Epoch: 7, Steps: 570 | Train Loss: 0.1564264 Vali Loss: 0.0313811 Test Loss: 0.1085556
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1076777
	speed: 0.0388s/iter; left time: 283.6195s
	iters: 200, epoch: 8 | loss: 0.1857146
	speed: 0.0115s/iter; left time: 82.6277s
	iters: 300, epoch: 8 | loss: 0.1267212
	speed: 0.0115s/iter; left time: 81.6677s
	iters: 400, epoch: 8 | loss: 0.1391076
	speed: 0.0115s/iter; left time: 80.6847s
	iters: 500, epoch: 8 | loss: 0.1148637
	speed: 0.0115s/iter; left time: 79.4824s
Epoch: 8 cost time: 6.805379390716553
Epoch: 8, Steps: 570 | Train Loss: 0.1560815 Vali Loss: 0.0314133 Test Loss: 0.1088604
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2353387
	speed: 0.0377s/iter; left time: 254.3657s
	iters: 200, epoch: 9 | loss: 0.1030874
	speed: 0.0114s/iter; left time: 75.7509s
	iters: 300, epoch: 9 | loss: 0.1714372
	speed: 0.0114s/iter; left time: 74.7420s
	iters: 400, epoch: 9 | loss: 0.1623469
	speed: 0.0114s/iter; left time: 73.4634s
	iters: 500, epoch: 9 | loss: 0.2412311
	speed: 0.0114s/iter; left time: 72.2614s
Epoch: 9 cost time: 6.821022987365723
Epoch: 9, Steps: 570 | Train Loss: 0.1555682 Vali Loss: 0.0312154 Test Loss: 0.1087304
Validation loss decreased (0.031268 --> 0.031215).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1525932
	speed: 0.0396s/iter; left time: 244.1954s
	iters: 200, epoch: 10 | loss: 0.1397904
	speed: 0.0114s/iter; left time: 69.3958s
	iters: 300, epoch: 10 | loss: 0.1151299
	speed: 0.0114s/iter; left time: 68.2519s
	iters: 400, epoch: 10 | loss: 0.1559325
	speed: 0.0114s/iter; left time: 67.0971s
	iters: 500, epoch: 10 | loss: 0.1672229
	speed: 0.0114s/iter; left time: 65.9402s
Epoch: 10 cost time: 6.839211940765381
Epoch: 10, Steps: 570 | Train Loss: 0.1566576 Vali Loss: 0.0312890 Test Loss: 0.1087427
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0999604
	speed: 0.0396s/iter; left time: 222.0008s
	iters: 200, epoch: 11 | loss: 0.1711862
	speed: 0.0126s/iter; left time: 69.1923s
	iters: 300, epoch: 11 | loss: 0.1427087
	speed: 0.0126s/iter; left time: 67.9222s
	iters: 400, epoch: 11 | loss: 0.1879228
	speed: 0.0126s/iter; left time: 66.6986s
	iters: 500, epoch: 11 | loss: 0.2188693
	speed: 0.0126s/iter; left time: 65.4456s
Epoch: 11 cost time: 7.500325441360474
Epoch: 11, Steps: 570 | Train Loss: 0.1565516 Vali Loss: 0.0312251 Test Loss: 0.1087238
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1394170
	speed: 0.0392s/iter; left time: 197.4025s
	iters: 200, epoch: 12 | loss: 0.1381668
	speed: 0.0115s/iter; left time: 56.4851s
	iters: 300, epoch: 12 | loss: 0.1242190
	speed: 0.0115s/iter; left time: 55.3595s
	iters: 400, epoch: 12 | loss: 0.2307628
	speed: 0.0114s/iter; left time: 54.0939s
	iters: 500, epoch: 12 | loss: 0.1490344
	speed: 0.0114s/iter; left time: 52.9391s
Epoch: 12 cost time: 6.803846120834351
Epoch: 12, Steps: 570 | Train Loss: 0.1558459 Vali Loss: 0.0314087 Test Loss: 0.1087496
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10887391120195389, mae:0.198089137673378
>>> MS_Raw LR=1e-4 DO=0.2 EL=2 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3059065
	speed: 0.0243s/iter; left time: 274.0830s
	iters: 200, epoch: 1 | loss: 0.2737502
	speed: 0.0122s/iter; left time: 136.6668s
	iters: 300, epoch: 1 | loss: 0.3231884
	speed: 0.0122s/iter; left time: 134.8818s
	iters: 400, epoch: 1 | loss: 0.2475859
	speed: 0.0121s/iter; left time: 133.6257s
	iters: 500, epoch: 1 | loss: 0.2284089
	speed: 0.0122s/iter; left time: 132.8620s
Epoch: 1 cost time: 8.198735237121582
Epoch: 1, Steps: 570 | Train Loss: 0.2450399 Vali Loss: 0.0431757 Test Loss: 0.1317969
Validation loss decreased (inf --> 0.043176).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2676797
	speed: 0.0399s/iter; left time: 428.6603s
	iters: 200, epoch: 2 | loss: 0.2882361
	speed: 0.0109s/iter; left time: 116.0687s
	iters: 300, epoch: 2 | loss: 0.1485207
	speed: 0.0110s/iter; left time: 115.3893s
	iters: 400, epoch: 2 | loss: 0.1523848
	speed: 0.0109s/iter; left time: 114.1462s
	iters: 500, epoch: 2 | loss: 0.1721504
	speed: 0.0109s/iter; left time: 112.8395s
Epoch: 2 cost time: 6.5626842975616455
Epoch: 2, Steps: 570 | Train Loss: 0.2084066 Vali Loss: 0.0420639 Test Loss: 0.1244295
Validation loss decreased (0.043176 --> 0.042064).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1705528
	speed: 0.0394s/iter; left time: 400.6438s
	iters: 200, epoch: 3 | loss: 0.1598030
	speed: 0.0109s/iter; left time: 109.8766s
	iters: 300, epoch: 3 | loss: 0.2289789
	speed: 0.0109s/iter; left time: 108.5759s
	iters: 400, epoch: 3 | loss: 0.1601818
	speed: 0.0109s/iter; left time: 107.6754s
	iters: 500, epoch: 3 | loss: 0.1804475
	speed: 0.0109s/iter; left time: 106.4125s
Epoch: 3 cost time: 6.501222848892212
Epoch: 3, Steps: 570 | Train Loss: 0.1902824 Vali Loss: 0.0413035 Test Loss: 0.1218363
Validation loss decreased (0.042064 --> 0.041304).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1751935
	speed: 0.0372s/iter; left time: 356.7200s
	iters: 200, epoch: 4 | loss: 0.1332253
	speed: 0.0110s/iter; left time: 104.0985s
	iters: 300, epoch: 4 | loss: 0.1604505
	speed: 0.0110s/iter; left time: 103.1643s
	iters: 400, epoch: 4 | loss: 0.2998212
	speed: 0.0110s/iter; left time: 101.7460s
	iters: 500, epoch: 4 | loss: 0.1957961
	speed: 0.0110s/iter; left time: 100.7654s
Epoch: 4 cost time: 6.57860803604126
Epoch: 4, Steps: 570 | Train Loss: 0.1811429 Vali Loss: 0.0391628 Test Loss: 0.1194913
Validation loss decreased (0.041304 --> 0.039163).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1672255
	speed: 0.0381s/iter; left time: 344.0762s
	iters: 200, epoch: 5 | loss: 0.1672589
	speed: 0.0109s/iter; left time: 97.5728s
	iters: 300, epoch: 5 | loss: 0.2072868
	speed: 0.0109s/iter; left time: 96.5124s
	iters: 400, epoch: 5 | loss: 0.1369065
	speed: 0.0109s/iter; left time: 95.3944s
	iters: 500, epoch: 5 | loss: 0.2729971
	speed: 0.0109s/iter; left time: 94.1825s
Epoch: 5 cost time: 6.558852195739746
Epoch: 5, Steps: 570 | Train Loss: 0.1767657 Vali Loss: 0.0388981 Test Loss: 0.1188247
Validation loss decreased (0.039163 --> 0.038898).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1614633
	speed: 0.0376s/iter; left time: 317.6327s
	iters: 200, epoch: 6 | loss: 0.1716885
	speed: 0.0108s/iter; left time: 90.6065s
	iters: 300, epoch: 6 | loss: 0.1799382
	speed: 0.0109s/iter; left time: 89.7006s
	iters: 400, epoch: 6 | loss: 0.1472095
	speed: 0.0109s/iter; left time: 88.6929s
	iters: 500, epoch: 6 | loss: 0.1638059
	speed: 0.0109s/iter; left time: 87.8612s
Epoch: 6 cost time: 6.497187852859497
Epoch: 6, Steps: 570 | Train Loss: 0.1739943 Vali Loss: 0.0392144 Test Loss: 0.1204562
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1445032
	speed: 0.0364s/iter; left time: 286.7756s
	iters: 200, epoch: 7 | loss: 0.1458511
	speed: 0.0109s/iter; left time: 85.1617s
	iters: 300, epoch: 7 | loss: 0.1075231
	speed: 0.0109s/iter; left time: 83.7396s
	iters: 400, epoch: 7 | loss: 0.1690814
	speed: 0.0109s/iter; left time: 82.6957s
	iters: 500, epoch: 7 | loss: 0.1312335
	speed: 0.0109s/iter; left time: 81.6205s
Epoch: 7 cost time: 6.506883859634399
Epoch: 7, Steps: 570 | Train Loss: 0.1724856 Vali Loss: 0.0389544 Test Loss: 0.1188632
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1433409
	speed: 0.0370s/iter; left time: 270.3322s
	iters: 200, epoch: 8 | loss: 0.2169636
	speed: 0.0109s/iter; left time: 78.6139s
	iters: 300, epoch: 8 | loss: 0.2177719
	speed: 0.0109s/iter; left time: 77.4449s
	iters: 400, epoch: 8 | loss: 0.1571627
	speed: 0.0109s/iter; left time: 76.3939s
	iters: 500, epoch: 8 | loss: 0.1202934
	speed: 0.0109s/iter; left time: 75.2515s
Epoch: 8 cost time: 6.495687246322632
Epoch: 8, Steps: 570 | Train Loss: 0.1722129 Vali Loss: 0.0385712 Test Loss: 0.1187824
Validation loss decreased (0.038898 --> 0.038571).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1691125
	speed: 0.0393s/iter; left time: 264.7598s
	iters: 200, epoch: 9 | loss: 0.1330729
	speed: 0.0109s/iter; left time: 72.1065s
	iters: 300, epoch: 9 | loss: 0.1934624
	speed: 0.0109s/iter; left time: 71.0296s
	iters: 400, epoch: 9 | loss: 0.2186877
	speed: 0.0109s/iter; left time: 69.9542s
	iters: 500, epoch: 9 | loss: 0.1144264
	speed: 0.0109s/iter; left time: 69.1520s
Epoch: 9 cost time: 6.504966497421265
Epoch: 9, Steps: 570 | Train Loss: 0.1712640 Vali Loss: 0.0386326 Test Loss: 0.1186360
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1872510
	speed: 0.0370s/iter; left time: 228.5175s
	iters: 200, epoch: 10 | loss: 0.1101950
	speed: 0.0109s/iter; left time: 65.9092s
	iters: 300, epoch: 10 | loss: 0.1981407
	speed: 0.0109s/iter; left time: 64.8456s
	iters: 400, epoch: 10 | loss: 0.1394067
	speed: 0.0109s/iter; left time: 63.7973s
	iters: 500, epoch: 10 | loss: 0.2065775
	speed: 0.0109s/iter; left time: 62.6763s
Epoch: 10 cost time: 6.548126220703125
Epoch: 10, Steps: 570 | Train Loss: 0.1707153 Vali Loss: 0.0387613 Test Loss: 0.1187380
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1338069
	speed: 0.0364s/iter; left time: 203.8956s
	iters: 200, epoch: 11 | loss: 0.1755780
	speed: 0.0110s/iter; left time: 60.3372s
	iters: 300, epoch: 11 | loss: 0.1517908
	speed: 0.0110s/iter; left time: 59.2318s
	iters: 400, epoch: 11 | loss: 0.1131015
	speed: 0.0110s/iter; left time: 58.1270s
	iters: 500, epoch: 11 | loss: 0.1341830
	speed: 0.0110s/iter; left time: 57.0062s
Epoch: 11 cost time: 6.523584842681885
Epoch: 11, Steps: 570 | Train Loss: 0.1710720 Vali Loss: 0.0387002 Test Loss: 0.1187326
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11894439905881882, mae:0.2141129970550537
>>> MS_Raw LR=1e-4 DO=0.2 EL=3 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2167726
	speed: 0.0285s/iter; left time: 322.2461s
	iters: 200, epoch: 1 | loss: 0.1834397
	speed: 0.0147s/iter; left time: 164.9100s
	iters: 300, epoch: 1 | loss: 0.3097599
	speed: 0.0146s/iter; left time: 161.7734s
	iters: 400, epoch: 1 | loss: 0.2252580
	speed: 0.0146s/iter; left time: 160.6555s
	iters: 500, epoch: 1 | loss: 0.1791959
	speed: 0.0146s/iter; left time: 159.4030s
Epoch: 1 cost time: 9.783592700958252
Epoch: 1, Steps: 570 | Train Loss: 0.2450417 Vali Loss: 0.0441765 Test Loss: 0.1331939
Validation loss decreased (inf --> 0.044177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2415560
	speed: 0.0468s/iter; left time: 502.3209s
	iters: 200, epoch: 2 | loss: 0.1884318
	speed: 0.0147s/iter; left time: 156.1511s
	iters: 300, epoch: 2 | loss: 0.1717824
	speed: 0.0146s/iter; left time: 154.2451s
	iters: 400, epoch: 2 | loss: 0.1287038
	speed: 0.0146s/iter; left time: 152.3252s
	iters: 500, epoch: 2 | loss: 0.2091839
	speed: 0.0146s/iter; left time: 151.1476s
Epoch: 2 cost time: 8.657119750976562
Epoch: 2, Steps: 570 | Train Loss: 0.2067083 Vali Loss: 0.0420786 Test Loss: 0.1339201
Validation loss decreased (0.044177 --> 0.042079).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3394342
	speed: 0.0470s/iter; left time: 477.2718s
	iters: 200, epoch: 3 | loss: 0.2081882
	speed: 0.0146s/iter; left time: 146.6534s
	iters: 300, epoch: 3 | loss: 0.1111782
	speed: 0.0145s/iter; left time: 144.4457s
	iters: 400, epoch: 3 | loss: 0.1616367
	speed: 0.0144s/iter; left time: 142.4734s
	iters: 500, epoch: 3 | loss: 0.1385147
	speed: 0.0144s/iter; left time: 140.6183s
Epoch: 3 cost time: 8.561525821685791
Epoch: 3, Steps: 570 | Train Loss: 0.1899784 Vali Loss: 0.0385048 Test Loss: 0.1220661
Validation loss decreased (0.042079 --> 0.038505).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1740040
	speed: 0.0458s/iter; left time: 439.0843s
	iters: 200, epoch: 4 | loss: 0.1524063
	speed: 0.0145s/iter; left time: 137.9866s
	iters: 300, epoch: 4 | loss: 0.1879634
	speed: 0.0145s/iter; left time: 136.4101s
	iters: 400, epoch: 4 | loss: 0.1962401
	speed: 0.0145s/iter; left time: 134.8021s
	iters: 500, epoch: 4 | loss: 0.1578258
	speed: 0.0145s/iter; left time: 133.3616s
Epoch: 4 cost time: 8.53992509841919
Epoch: 4, Steps: 570 | Train Loss: 0.1817282 Vali Loss: 0.0374422 Test Loss: 0.1222099
Validation loss decreased (0.038505 --> 0.037442).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1531262
	speed: 0.0462s/iter; left time: 416.6066s
	iters: 200, epoch: 5 | loss: 0.1575074
	speed: 0.0145s/iter; left time: 129.5091s
	iters: 300, epoch: 5 | loss: 0.1539699
	speed: 0.0145s/iter; left time: 128.0049s
	iters: 400, epoch: 5 | loss: 0.2075742
	speed: 0.0145s/iter; left time: 126.6690s
	iters: 500, epoch: 5 | loss: 0.2027942
	speed: 0.0145s/iter; left time: 125.3407s
Epoch: 5 cost time: 8.578953742980957
Epoch: 5, Steps: 570 | Train Loss: 0.1787642 Vali Loss: 0.0370470 Test Loss: 0.1194206
Validation loss decreased (0.037442 --> 0.037047).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1353499
	speed: 0.0459s/iter; left time: 388.0976s
	iters: 200, epoch: 6 | loss: 0.1671976
	speed: 0.0144s/iter; left time: 120.2448s
	iters: 300, epoch: 6 | loss: 0.1244141
	speed: 0.0144s/iter; left time: 118.7981s
	iters: 400, epoch: 6 | loss: 0.1210807
	speed: 0.0144s/iter; left time: 117.3356s
	iters: 500, epoch: 6 | loss: 0.1896802
	speed: 0.0144s/iter; left time: 115.9322s
Epoch: 6 cost time: 8.505103588104248
Epoch: 6, Steps: 570 | Train Loss: 0.1749954 Vali Loss: 0.0370123 Test Loss: 0.1199432
Validation loss decreased (0.037047 --> 0.037012).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1805391
	speed: 0.0483s/iter; left time: 380.9242s
	iters: 200, epoch: 7 | loss: 0.1321836
	speed: 0.0147s/iter; left time: 114.3651s
	iters: 300, epoch: 7 | loss: 0.1360212
	speed: 0.0152s/iter; left time: 117.0446s
	iters: 400, epoch: 7 | loss: 0.1530548
	speed: 0.0147s/iter; left time: 111.2198s
	iters: 500, epoch: 7 | loss: 0.2867018
	speed: 0.0147s/iter; left time: 109.7963s
Epoch: 7 cost time: 8.718667030334473
Epoch: 7, Steps: 570 | Train Loss: 0.1749006 Vali Loss: 0.0368639 Test Loss: 0.1194540
Validation loss decreased (0.037012 --> 0.036864).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2613420
	speed: 0.0457s/iter; left time: 334.1658s
	iters: 200, epoch: 8 | loss: 0.2187726
	speed: 0.0146s/iter; left time: 105.0895s
	iters: 300, epoch: 8 | loss: 0.2201245
	speed: 0.0146s/iter; left time: 103.7309s
	iters: 400, epoch: 8 | loss: 0.1328292
	speed: 0.0145s/iter; left time: 101.9811s
	iters: 500, epoch: 8 | loss: 0.1874684
	speed: 0.0146s/iter; left time: 100.7014s
Epoch: 8 cost time: 8.592652082443237
Epoch: 8, Steps: 570 | Train Loss: 0.1744350 Vali Loss: 0.0369365 Test Loss: 0.1196728
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2474883
	speed: 0.0452s/iter; left time: 304.7306s
	iters: 200, epoch: 9 | loss: 0.2378532
	speed: 0.0146s/iter; left time: 97.0625s
	iters: 300, epoch: 9 | loss: 0.2754472
	speed: 0.0146s/iter; left time: 95.4971s
	iters: 400, epoch: 9 | loss: 0.1970205
	speed: 0.0146s/iter; left time: 94.0656s
	iters: 500, epoch: 9 | loss: 0.1458042
	speed: 0.0146s/iter; left time: 92.5244s
Epoch: 9 cost time: 8.56498670578003
Epoch: 9, Steps: 570 | Train Loss: 0.1737375 Vali Loss: 0.0369257 Test Loss: 0.1192469
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1998157
	speed: 0.0481s/iter; left time: 296.6898s
	iters: 200, epoch: 10 | loss: 0.1477786
	speed: 0.0146s/iter; left time: 88.9171s
	iters: 300, epoch: 10 | loss: 0.1360759
	speed: 0.0146s/iter; left time: 87.2471s
	iters: 400, epoch: 10 | loss: 0.1441279
	speed: 0.0146s/iter; left time: 85.6116s
	iters: 500, epoch: 10 | loss: 0.2008854
	speed: 0.0146s/iter; left time: 84.1688s
Epoch: 10 cost time: 8.580540418624878
Epoch: 10, Steps: 570 | Train Loss: 0.1744781 Vali Loss: 0.0366690 Test Loss: 0.1191785
Validation loss decreased (0.036864 --> 0.036669).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1552098
	speed: 0.0458s/iter; left time: 256.5553s
	iters: 200, epoch: 11 | loss: 0.1430847
	speed: 0.0146s/iter; left time: 80.1412s
	iters: 300, epoch: 11 | loss: 0.1563972
	speed: 0.0146s/iter; left time: 78.7758s
	iters: 400, epoch: 11 | loss: 0.1357811
	speed: 0.0145s/iter; left time: 77.0431s
	iters: 500, epoch: 11 | loss: 0.1447430
	speed: 0.0146s/iter; left time: 76.0725s
Epoch: 11 cost time: 8.61048698425293
Epoch: 11, Steps: 570 | Train Loss: 0.1743035 Vali Loss: 0.0367894 Test Loss: 0.1191359
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1334599
	speed: 0.0471s/iter; left time: 237.1173s
	iters: 200, epoch: 12 | loss: 0.1164096
	speed: 0.0167s/iter; left time: 82.5175s
	iters: 300, epoch: 12 | loss: 0.2074345
	speed: 0.0167s/iter; left time: 80.8860s
	iters: 400, epoch: 12 | loss: 0.1870444
	speed: 0.0168s/iter; left time: 79.3361s
	iters: 500, epoch: 12 | loss: 0.1454222
	speed: 0.0168s/iter; left time: 77.8763s
Epoch: 12 cost time: 9.807340383529663
Epoch: 12, Steps: 570 | Train Loss: 0.1735718 Vali Loss: 0.0368066 Test Loss: 0.1192624
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1866234
	speed: 0.0498s/iter; left time: 222.3071s
	iters: 200, epoch: 13 | loss: 0.2737667
	speed: 0.0168s/iter; left time: 73.2801s
	iters: 300, epoch: 13 | loss: 0.2283096
	speed: 0.0168s/iter; left time: 71.5828s
	iters: 400, epoch: 13 | loss: 0.1208643
	speed: 0.0157s/iter; left time: 65.5060s
	iters: 500, epoch: 13 | loss: 0.1841916
	speed: 0.0146s/iter; left time: 59.1942s
Epoch: 13 cost time: 9.353566408157349
Epoch: 13, Steps: 570 | Train Loss: 0.1736273 Vali Loss: 0.0367905 Test Loss: 0.1192441
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11934473365545273, mae:0.2106429487466812
>>> MS_Raw LR=1e-4 DO=0.2 EL=3 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3230739
	speed: 0.0278s/iter; left time: 314.6148s
	iters: 200, epoch: 1 | loss: 0.2487925
	speed: 0.0143s/iter; left time: 160.5856s
	iters: 300, epoch: 1 | loss: 0.1291303
	speed: 0.0159s/iter; left time: 176.4139s
	iters: 400, epoch: 1 | loss: 0.3135703
	speed: 0.0165s/iter; left time: 181.1313s
	iters: 500, epoch: 1 | loss: 0.1859436
	speed: 0.0165s/iter; left time: 180.0101s
Epoch: 1 cost time: 10.312958717346191
Epoch: 1, Steps: 570 | Train Loss: 0.2187694 Vali Loss: 0.0367812 Test Loss: 0.1119486
Validation loss decreased (inf --> 0.036781).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1615953
	speed: 0.0502s/iter; left time: 538.9724s
	iters: 200, epoch: 2 | loss: 0.2700863
	speed: 0.0166s/iter; left time: 175.9501s
	iters: 300, epoch: 2 | loss: 0.1883779
	speed: 0.0166s/iter; left time: 174.6110s
	iters: 400, epoch: 2 | loss: 0.1708111
	speed: 0.0166s/iter; left time: 173.0219s
	iters: 500, epoch: 2 | loss: 0.1733276
	speed: 0.0166s/iter; left time: 171.0311s
Epoch: 2 cost time: 9.764145374298096
Epoch: 2, Steps: 570 | Train Loss: 0.1877026 Vali Loss: 0.0355086 Test Loss: 0.1129241
Validation loss decreased (0.036781 --> 0.035509).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1765935
	speed: 0.0513s/iter; left time: 521.7038s
	iters: 200, epoch: 3 | loss: 0.0953627
	speed: 0.0165s/iter; left time: 165.7286s
	iters: 300, epoch: 3 | loss: 0.2513504
	speed: 0.0164s/iter; left time: 163.8238s
	iters: 400, epoch: 3 | loss: 0.1355092
	speed: 0.0165s/iter; left time: 162.8200s
	iters: 500, epoch: 3 | loss: 0.1496388
	speed: 0.0164s/iter; left time: 160.4035s
Epoch: 3 cost time: 9.708708763122559
Epoch: 3, Steps: 570 | Train Loss: 0.1742259 Vali Loss: 0.0344777 Test Loss: 0.1114840
Validation loss decreased (0.035509 --> 0.034478).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1729999
	speed: 0.0499s/iter; left time: 478.3690s
	iters: 200, epoch: 4 | loss: 0.1659377
	speed: 0.0164s/iter; left time: 156.1076s
	iters: 300, epoch: 4 | loss: 0.2141808
	speed: 0.0164s/iter; left time: 154.3402s
	iters: 400, epoch: 4 | loss: 0.1064999
	speed: 0.0165s/iter; left time: 153.0120s
	iters: 500, epoch: 4 | loss: 0.1109399
	speed: 0.0165s/iter; left time: 151.2404s
Epoch: 4 cost time: 9.690350770950317
Epoch: 4, Steps: 570 | Train Loss: 0.1698102 Vali Loss: 0.0334893 Test Loss: 0.1089157
Validation loss decreased (0.034478 --> 0.033489).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0924286
	speed: 0.0506s/iter; left time: 456.1213s
	iters: 200, epoch: 5 | loss: 0.1825116
	speed: 0.0166s/iter; left time: 147.6881s
	iters: 300, epoch: 5 | loss: 0.2019356
	speed: 0.0165s/iter; left time: 145.8833s
	iters: 400, epoch: 5 | loss: 0.1343013
	speed: 0.0165s/iter; left time: 144.1431s
	iters: 500, epoch: 5 | loss: 0.1753863
	speed: 0.0164s/iter; left time: 141.5379s
Epoch: 5 cost time: 9.708093166351318
Epoch: 5, Steps: 570 | Train Loss: 0.1663471 Vali Loss: 0.0334223 Test Loss: 0.1087708
Validation loss decreased (0.033489 --> 0.033422).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1363288
	speed: 0.0477s/iter; left time: 402.7115s
	iters: 200, epoch: 6 | loss: 0.3008175
	speed: 0.0143s/iter; left time: 119.0686s
	iters: 300, epoch: 6 | loss: 0.2603256
	speed: 0.0143s/iter; left time: 117.5914s
	iters: 400, epoch: 6 | loss: 0.1751878
	speed: 0.0143s/iter; left time: 116.2029s
	iters: 500, epoch: 6 | loss: 0.1767675
	speed: 0.0143s/iter; left time: 114.8038s
Epoch: 6 cost time: 8.424954891204834
Epoch: 6, Steps: 570 | Train Loss: 0.1655399 Vali Loss: 0.0328816 Test Loss: 0.1075305
Validation loss decreased (0.033422 --> 0.032882).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1137792
	speed: 0.0456s/iter; left time: 359.1066s
	iters: 200, epoch: 7 | loss: 0.1645022
	speed: 0.0144s/iter; left time: 112.1034s
	iters: 300, epoch: 7 | loss: 0.2490925
	speed: 0.0144s/iter; left time: 110.7004s
	iters: 400, epoch: 7 | loss: 0.1427208
	speed: 0.0144s/iter; left time: 109.2182s
	iters: 500, epoch: 7 | loss: 0.2128087
	speed: 0.0144s/iter; left time: 107.7640s
Epoch: 7 cost time: 8.531184434890747
Epoch: 7, Steps: 570 | Train Loss: 0.1638563 Vali Loss: 0.0328501 Test Loss: 0.1075453
Validation loss decreased (0.032882 --> 0.032850).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1055184
	speed: 0.0461s/iter; left time: 337.1885s
	iters: 200, epoch: 8 | loss: 0.1524740
	speed: 0.0143s/iter; left time: 103.2789s
	iters: 300, epoch: 8 | loss: 0.2451741
	speed: 0.0143s/iter; left time: 101.7720s
	iters: 400, epoch: 8 | loss: 0.1768970
	speed: 0.0143s/iter; left time: 100.3266s
	iters: 500, epoch: 8 | loss: 0.1730819
	speed: 0.0143s/iter; left time: 98.9708s
Epoch: 8 cost time: 8.483083248138428
Epoch: 8, Steps: 570 | Train Loss: 0.1632265 Vali Loss: 0.0329301 Test Loss: 0.1077431
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1219473
	speed: 0.0485s/iter; left time: 327.0988s
	iters: 200, epoch: 9 | loss: 0.1291988
	speed: 0.0142s/iter; left time: 94.5984s
	iters: 300, epoch: 9 | loss: 0.1806177
	speed: 0.0143s/iter; left time: 93.4379s
	iters: 400, epoch: 9 | loss: 0.1606346
	speed: 0.0143s/iter; left time: 91.9438s
	iters: 500, epoch: 9 | loss: 0.1853399
	speed: 0.0143s/iter; left time: 90.3709s
Epoch: 9 cost time: 8.540616035461426
Epoch: 9, Steps: 570 | Train Loss: 0.1631130 Vali Loss: 0.0327687 Test Loss: 0.1077360
Validation loss decreased (0.032850 --> 0.032769).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1848225
	speed: 0.0498s/iter; left time: 307.3520s
	iters: 200, epoch: 10 | loss: 0.1568534
	speed: 0.0166s/iter; left time: 100.5824s
	iters: 300, epoch: 10 | loss: 0.1562719
	speed: 0.0158s/iter; left time: 94.4902s
	iters: 400, epoch: 10 | loss: 0.1687929
	speed: 0.0144s/iter; left time: 84.3676s
	iters: 500, epoch: 10 | loss: 0.2149202
	speed: 0.0142s/iter; left time: 82.1814s
Epoch: 10 cost time: 9.074214220046997
Epoch: 10, Steps: 570 | Train Loss: 0.1628169 Vali Loss: 0.0327760 Test Loss: 0.1076413
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2316905
	speed: 0.0453s/iter; left time: 253.7887s
	iters: 200, epoch: 11 | loss: 0.1681755
	speed: 0.0143s/iter; left time: 78.5666s
	iters: 300, epoch: 11 | loss: 0.1939025
	speed: 0.0143s/iter; left time: 77.1646s
	iters: 400, epoch: 11 | loss: 0.1152691
	speed: 0.0142s/iter; left time: 75.4145s
	iters: 500, epoch: 11 | loss: 0.2666770
	speed: 0.0143s/iter; left time: 74.1502s
Epoch: 11 cost time: 8.398173332214355
Epoch: 11, Steps: 570 | Train Loss: 0.1618295 Vali Loss: 0.0327559 Test Loss: 0.1076812
Validation loss decreased (0.032769 --> 0.032756).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2332382
	speed: 0.0456s/iter; left time: 229.3460s
	iters: 200, epoch: 12 | loss: 0.1990643
	speed: 0.0142s/iter; left time: 70.0798s
	iters: 300, epoch: 12 | loss: 0.1215841
	speed: 0.0142s/iter; left time: 68.5912s
	iters: 400, epoch: 12 | loss: 0.1708272
	speed: 0.0142s/iter; left time: 67.1084s
	iters: 500, epoch: 12 | loss: 0.1868755
	speed: 0.0142s/iter; left time: 65.7139s
Epoch: 12 cost time: 8.410656452178955
Epoch: 12, Steps: 570 | Train Loss: 0.1638072 Vali Loss: 0.0328175 Test Loss: 0.1076672
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1394779
	speed: 0.0483s/iter; left time: 215.5141s
	iters: 200, epoch: 13 | loss: 0.1236927
	speed: 0.0143s/iter; left time: 62.2927s
	iters: 300, epoch: 13 | loss: 0.1323943
	speed: 0.0143s/iter; left time: 60.8507s
	iters: 400, epoch: 13 | loss: 0.0949029
	speed: 0.0143s/iter; left time: 59.4406s
	iters: 500, epoch: 13 | loss: 0.1751146
	speed: 0.0143s/iter; left time: 57.9907s
Epoch: 13 cost time: 8.441561222076416
Epoch: 13, Steps: 570 | Train Loss: 0.1628508 Vali Loss: 0.0326996 Test Loss: 0.1076649
Validation loss decreased (0.032756 --> 0.032700).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1346692
	speed: 0.0477s/iter; left time: 185.5567s
	iters: 200, epoch: 14 | loss: 0.2459736
	speed: 0.0160s/iter; left time: 60.7473s
	iters: 300, epoch: 14 | loss: 0.1126859
	speed: 0.0160s/iter; left time: 59.1781s
	iters: 400, epoch: 14 | loss: 0.1289571
	speed: 0.0160s/iter; left time: 57.5926s
	iters: 500, epoch: 14 | loss: 0.1478224
	speed: 0.0160s/iter; left time: 55.9616s
Epoch: 14 cost time: 9.462474584579468
Epoch: 14, Steps: 570 | Train Loss: 0.1616575 Vali Loss: 0.0327439 Test Loss: 0.1076713
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1395341
	speed: 0.0477s/iter; left time: 158.5743s
	iters: 200, epoch: 15 | loss: 0.1093530
	speed: 0.0142s/iter; left time: 45.8838s
	iters: 300, epoch: 15 | loss: 0.1623834
	speed: 0.0142s/iter; left time: 44.4612s
	iters: 400, epoch: 15 | loss: 0.1505805
	speed: 0.0142s/iter; left time: 43.0368s
	iters: 500, epoch: 15 | loss: 0.2240412
	speed: 0.0143s/iter; left time: 41.6419s
Epoch: 15 cost time: 8.386676549911499
Epoch: 15, Steps: 570 | Train Loss: 0.1623262 Vali Loss: 0.0327374 Test Loss: 0.1076703
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1810603
	speed: 0.0468s/iter; left time: 128.7974s
	iters: 200, epoch: 16 | loss: 0.1773026
	speed: 0.0143s/iter; left time: 37.7881s
	iters: 300, epoch: 16 | loss: 0.1407213
	speed: 0.0143s/iter; left time: 36.4002s
	iters: 400, epoch: 16 | loss: 0.1876066
	speed: 0.0142s/iter; left time: 34.8623s
	iters: 500, epoch: 16 | loss: 0.1328565
	speed: 0.0142s/iter; left time: 33.3850s
Epoch: 16 cost time: 8.421300411224365
Epoch: 16, Steps: 570 | Train Loss: 0.1619266 Vali Loss: 0.0328557 Test Loss: 0.1076714
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1078135147690773, mae:0.1963559091091156
>>> MS_Raw LR=1e-4 DO=0.2 EL=3 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1469629
	speed: 0.0281s/iter; left time: 317.7597s
	iters: 200, epoch: 1 | loss: 0.3179166
	speed: 0.0160s/iter; left time: 179.1024s
	iters: 300, epoch: 1 | loss: 0.3197975
	speed: 0.0160s/iter; left time: 177.2400s
	iters: 400, epoch: 1 | loss: 0.2389847
	speed: 0.0160s/iter; left time: 176.4674s
	iters: 500, epoch: 1 | loss: 0.2648219
	speed: 0.0160s/iter; left time: 174.7380s
Epoch: 1 cost time: 10.384128093719482
Epoch: 1, Steps: 570 | Train Loss: 0.2509745 Vali Loss: 0.0440646 Test Loss: 0.1338914
Validation loss decreased (inf --> 0.044065).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1855400
	speed: 0.0478s/iter; left time: 513.0433s
	iters: 200, epoch: 2 | loss: 0.1298666
	speed: 0.0143s/iter; left time: 152.0134s
	iters: 300, epoch: 2 | loss: 0.1377157
	speed: 0.0143s/iter; left time: 150.2438s
	iters: 400, epoch: 2 | loss: 0.1488576
	speed: 0.0143s/iter; left time: 148.9075s
	iters: 500, epoch: 2 | loss: 0.2571372
	speed: 0.0143s/iter; left time: 147.4015s
Epoch: 2 cost time: 8.454795360565186
Epoch: 2, Steps: 570 | Train Loss: 0.2121049 Vali Loss: 0.0422762 Test Loss: 0.1261149
Validation loss decreased (0.044065 --> 0.042276).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2350141
	speed: 0.0461s/iter; left time: 468.1637s
	iters: 200, epoch: 3 | loss: 0.2209245
	speed: 0.0142s/iter; left time: 143.1121s
	iters: 300, epoch: 3 | loss: 0.1703092
	speed: 0.0143s/iter; left time: 142.1538s
	iters: 400, epoch: 3 | loss: 0.1649446
	speed: 0.0142s/iter; left time: 140.3875s
	iters: 500, epoch: 3 | loss: 0.2347749
	speed: 0.0143s/iter; left time: 139.1489s
Epoch: 3 cost time: 8.398794889450073
Epoch: 3, Steps: 570 | Train Loss: 0.1959081 Vali Loss: 0.0407369 Test Loss: 0.1245840
Validation loss decreased (0.042276 --> 0.040737).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2508076
	speed: 0.0454s/iter; left time: 435.6669s
	iters: 200, epoch: 4 | loss: 0.1658720
	speed: 0.0142s/iter; left time: 134.6473s
	iters: 300, epoch: 4 | loss: 0.2019032
	speed: 0.0142s/iter; left time: 133.5269s
	iters: 400, epoch: 4 | loss: 0.1830573
	speed: 0.0143s/iter; left time: 132.5477s
	iters: 500, epoch: 4 | loss: 0.1332845
	speed: 0.0143s/iter; left time: 131.1270s
Epoch: 4 cost time: 8.426564455032349
Epoch: 4, Steps: 570 | Train Loss: 0.1896349 Vali Loss: 0.0393675 Test Loss: 0.1208681
Validation loss decreased (0.040737 --> 0.039367).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1568950
	speed: 0.0460s/iter; left time: 415.3521s
	iters: 200, epoch: 5 | loss: 0.1988941
	speed: 0.0142s/iter; left time: 126.5710s
	iters: 300, epoch: 5 | loss: 0.1730237
	speed: 0.0142s/iter; left time: 125.1377s
	iters: 400, epoch: 5 | loss: 0.2516692
	speed: 0.0142s/iter; left time: 123.6952s
	iters: 500, epoch: 5 | loss: 0.1377376
	speed: 0.0142s/iter; left time: 122.1535s
Epoch: 5 cost time: 8.398852109909058
Epoch: 5, Steps: 570 | Train Loss: 0.1855682 Vali Loss: 0.0391606 Test Loss: 0.1201594
Validation loss decreased (0.039367 --> 0.039161).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2225715
	speed: 0.0467s/iter; left time: 394.7396s
	iters: 200, epoch: 6 | loss: 0.1699176
	speed: 0.0142s/iter; left time: 118.4813s
	iters: 300, epoch: 6 | loss: 0.1154262
	speed: 0.0142s/iter; left time: 117.3273s
	iters: 400, epoch: 6 | loss: 0.1992546
	speed: 0.0142s/iter; left time: 115.6494s
	iters: 500, epoch: 6 | loss: 0.1731847
	speed: 0.0142s/iter; left time: 114.4524s
Epoch: 6 cost time: 8.400786638259888
Epoch: 6, Steps: 570 | Train Loss: 0.1828942 Vali Loss: 0.0389261 Test Loss: 0.1218258
Validation loss decreased (0.039161 --> 0.038926).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2352667
	speed: 0.0478s/iter; left time: 376.4224s
	iters: 200, epoch: 7 | loss: 0.1074341
	speed: 0.0159s/iter; left time: 123.8867s
	iters: 300, epoch: 7 | loss: 0.1429074
	speed: 0.0160s/iter; left time: 122.7469s
	iters: 400, epoch: 7 | loss: 0.2743106
	speed: 0.0159s/iter; left time: 120.7188s
	iters: 500, epoch: 7 | loss: 0.1668637
	speed: 0.0159s/iter; left time: 119.3068s
Epoch: 7 cost time: 9.3802649974823
Epoch: 7, Steps: 570 | Train Loss: 0.1840404 Vali Loss: 0.0387647 Test Loss: 0.1200844
Validation loss decreased (0.038926 --> 0.038765).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1498211
	speed: 0.0470s/iter; left time: 343.5977s
	iters: 200, epoch: 8 | loss: 0.1567590
	speed: 0.0143s/iter; left time: 102.9059s
	iters: 300, epoch: 8 | loss: 0.1566342
	speed: 0.0143s/iter; left time: 101.5843s
	iters: 400, epoch: 8 | loss: 0.1933138
	speed: 0.0143s/iter; left time: 100.1171s
	iters: 500, epoch: 8 | loss: 0.1202289
	speed: 0.0143s/iter; left time: 98.6384s
Epoch: 8 cost time: 8.43186616897583
Epoch: 8, Steps: 570 | Train Loss: 0.1832267 Vali Loss: 0.0390567 Test Loss: 0.1209443
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2395315
	speed: 0.0471s/iter; left time: 317.5611s
	iters: 200, epoch: 9 | loss: 0.1514681
	speed: 0.0142s/iter; left time: 94.2113s
	iters: 300, epoch: 9 | loss: 0.1267509
	speed: 0.0141s/iter; left time: 92.1647s
	iters: 400, epoch: 9 | loss: 0.1650192
	speed: 0.0141s/iter; left time: 90.8449s
	iters: 500, epoch: 9 | loss: 0.1709631
	speed: 0.0141s/iter; left time: 89.2041s
Epoch: 9 cost time: 8.327977418899536
Epoch: 9, Steps: 570 | Train Loss: 0.1813043 Vali Loss: 0.0388237 Test Loss: 0.1210111
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2333269
	speed: 0.0458s/iter; left time: 282.8239s
	iters: 200, epoch: 10 | loss: 0.2065901
	speed: 0.0142s/iter; left time: 86.0382s
	iters: 300, epoch: 10 | loss: 0.1792526
	speed: 0.0141s/iter; left time: 84.4398s
	iters: 400, epoch: 10 | loss: 0.2072501
	speed: 0.0141s/iter; left time: 82.9469s
	iters: 500, epoch: 10 | loss: 0.1652863
	speed: 0.0141s/iter; left time: 81.5992s
Epoch: 10 cost time: 8.39095664024353
Epoch: 10, Steps: 570 | Train Loss: 0.1810540 Vali Loss: 0.0388431 Test Loss: 0.1207669
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12025460600852966, mae:0.21314102411270142
>>> MS_Raw LR=1e-4 DO=0.2 EL=3 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2807164
	speed: 0.0286s/iter; left time: 323.7368s
	iters: 200, epoch: 1 | loss: 0.1994449
	speed: 0.0169s/iter; left time: 189.1601s
	iters: 300, epoch: 1 | loss: 0.2542409
	speed: 0.0169s/iter; left time: 187.3633s
	iters: 400, epoch: 1 | loss: 0.2241962
	speed: 0.0169s/iter; left time: 185.9942s
	iters: 500, epoch: 1 | loss: 0.1999758
	speed: 0.0169s/iter; left time: 184.0706s
Epoch: 1 cost time: 10.858049631118774
Epoch: 1, Steps: 570 | Train Loss: 0.2381237 Vali Loss: 0.0437958 Test Loss: 0.1303702
Validation loss decreased (inf --> 0.043796).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2267788
	speed: 0.0518s/iter; left time: 556.1624s
	iters: 200, epoch: 2 | loss: 0.2498884
	speed: 0.0170s/iter; left time: 180.6560s
	iters: 300, epoch: 2 | loss: 0.2195622
	speed: 0.0170s/iter; left time: 179.0648s
	iters: 400, epoch: 2 | loss: 0.1399293
	speed: 0.0170s/iter; left time: 177.1892s
	iters: 500, epoch: 2 | loss: 0.1576113
	speed: 0.0177s/iter; left time: 183.0533s
Epoch: 2 cost time: 10.183614492416382
Epoch: 2, Steps: 570 | Train Loss: 0.1979245 Vali Loss: 0.0395067 Test Loss: 0.1271103
Validation loss decreased (0.043796 --> 0.039507).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1486230
	speed: 0.0557s/iter; left time: 565.7680s
	iters: 200, epoch: 3 | loss: 0.1651161
	speed: 0.0184s/iter; left time: 185.4586s
	iters: 300, epoch: 3 | loss: 0.2907280
	speed: 0.0184s/iter; left time: 183.4132s
	iters: 400, epoch: 3 | loss: 0.1437851
	speed: 0.0184s/iter; left time: 181.6110s
	iters: 500, epoch: 3 | loss: 0.1431609
	speed: 0.0184s/iter; left time: 179.8610s
Epoch: 3 cost time: 10.764304876327515
Epoch: 3, Steps: 570 | Train Loss: 0.1768802 Vali Loss: 0.0373004 Test Loss: 0.1236406
Validation loss decreased (0.039507 --> 0.037300).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1289243
	speed: 0.0548s/iter; left time: 525.6534s
	iters: 200, epoch: 4 | loss: 0.1872966
	speed: 0.0170s/iter; left time: 161.0438s
	iters: 300, epoch: 4 | loss: 0.1971416
	speed: 0.0169s/iter; left time: 158.8774s
	iters: 400, epoch: 4 | loss: 0.2076066
	speed: 0.0169s/iter; left time: 157.1947s
	iters: 500, epoch: 4 | loss: 0.1533278
	speed: 0.0169s/iter; left time: 155.4485s
Epoch: 4 cost time: 9.971718788146973
Epoch: 4, Steps: 570 | Train Loss: 0.1660419 Vali Loss: 0.0349997 Test Loss: 0.1204328
Validation loss decreased (0.037300 --> 0.035000).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1321922
	speed: 0.0512s/iter; left time: 461.5276s
	iters: 200, epoch: 5 | loss: 0.2033115
	speed: 0.0170s/iter; left time: 151.6136s
	iters: 300, epoch: 5 | loss: 0.1826844
	speed: 0.0170s/iter; left time: 149.8985s
	iters: 400, epoch: 5 | loss: 0.1735277
	speed: 0.0170s/iter; left time: 148.1754s
	iters: 500, epoch: 5 | loss: 0.1227321
	speed: 0.0170s/iter; left time: 146.5762s
Epoch: 5 cost time: 9.999081134796143
Epoch: 5, Steps: 570 | Train Loss: 0.1602384 Vali Loss: 0.0347689 Test Loss: 0.1204603
Validation loss decreased (0.035000 --> 0.034769).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1950388
	speed: 0.0537s/iter; left time: 453.9382s
	iters: 200, epoch: 6 | loss: 0.1227389
	speed: 0.0170s/iter; left time: 141.7622s
	iters: 300, epoch: 6 | loss: 0.1735075
	speed: 0.0169s/iter; left time: 139.8434s
	iters: 400, epoch: 6 | loss: 0.2130548
	speed: 0.0169s/iter; left time: 137.9501s
	iters: 500, epoch: 6 | loss: 0.1318509
	speed: 0.0169s/iter; left time: 136.2810s
Epoch: 6 cost time: 9.95775294303894
Epoch: 6, Steps: 570 | Train Loss: 0.1573654 Vali Loss: 0.0346455 Test Loss: 0.1200864
Validation loss decreased (0.034769 --> 0.034646).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1442911
	speed: 0.0541s/iter; left time: 426.2674s
	iters: 200, epoch: 7 | loss: 0.1986550
	speed: 0.0184s/iter; left time: 143.2815s
	iters: 300, epoch: 7 | loss: 0.1928933
	speed: 0.0184s/iter; left time: 141.5019s
	iters: 400, epoch: 7 | loss: 0.1173649
	speed: 0.0184s/iter; left time: 139.6418s
	iters: 500, epoch: 7 | loss: 0.1246245
	speed: 0.0180s/iter; left time: 134.4260s
Epoch: 7 cost time: 10.65998911857605
Epoch: 7, Steps: 570 | Train Loss: 0.1556588 Vali Loss: 0.0342328 Test Loss: 0.1201242
Validation loss decreased (0.034646 --> 0.034233).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1714974
	speed: 0.0515s/iter; left time: 376.2992s
	iters: 200, epoch: 8 | loss: 0.1074537
	speed: 0.0180s/iter; left time: 129.4755s
	iters: 300, epoch: 8 | loss: 0.1497885
	speed: 0.0184s/iter; left time: 130.8756s
	iters: 400, epoch: 8 | loss: 0.0966494
	speed: 0.0184s/iter; left time: 129.0315s
	iters: 500, epoch: 8 | loss: 0.1098924
	speed: 0.0184s/iter; left time: 127.2526s
Epoch: 8 cost time: 10.677744388580322
Epoch: 8, Steps: 570 | Train Loss: 0.1553105 Vali Loss: 0.0344104 Test Loss: 0.1205098
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1266415
	speed: 0.0506s/iter; left time: 341.3686s
	iters: 200, epoch: 9 | loss: 0.0931378
	speed: 0.0169s/iter; left time: 112.3777s
	iters: 300, epoch: 9 | loss: 0.1561387
	speed: 0.0169s/iter; left time: 110.7940s
	iters: 400, epoch: 9 | loss: 0.1585056
	speed: 0.0169s/iter; left time: 109.1477s
	iters: 500, epoch: 9 | loss: 0.2204621
	speed: 0.0170s/iter; left time: 107.5298s
Epoch: 9 cost time: 9.919126272201538
Epoch: 9, Steps: 570 | Train Loss: 0.1537810 Vali Loss: 0.0342483 Test Loss: 0.1203181
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2070161
	speed: 0.0514s/iter; left time: 316.9470s
	iters: 200, epoch: 10 | loss: 0.0768331
	speed: 0.0184s/iter; left time: 111.8271s
	iters: 300, epoch: 10 | loss: 0.2067846
	speed: 0.0184s/iter; left time: 110.1034s
	iters: 400, epoch: 10 | loss: 0.1695709
	speed: 0.0184s/iter; left time: 108.2223s
	iters: 500, epoch: 10 | loss: 0.1195202
	speed: 0.0184s/iter; left time: 106.3808s
Epoch: 10 cost time: 10.790267705917358
Epoch: 10, Steps: 570 | Train Loss: 0.1544903 Vali Loss: 0.0344964 Test Loss: 0.1203680
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12027682363986969, mae:0.21584366261959076
>>> MS_Raw LR=1e-4 DO=0.2 EL=3 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1919311
	speed: 0.0281s/iter; left time: 317.9885s
	iters: 200, epoch: 1 | loss: 0.1355707
	speed: 0.0164s/iter; left time: 183.1430s
	iters: 300, epoch: 1 | loss: 0.2324904
	speed: 0.0163s/iter; left time: 181.4801s
	iters: 400, epoch: 1 | loss: 0.2188273
	speed: 0.0164s/iter; left time: 179.8689s
	iters: 500, epoch: 1 | loss: 0.1164604
	speed: 0.0163s/iter; left time: 178.2134s
Epoch: 1 cost time: 10.550661325454712
Epoch: 1, Steps: 570 | Train Loss: 0.2136093 Vali Loss: 0.0361288 Test Loss: 0.1138234
Validation loss decreased (inf --> 0.036129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1510792
	speed: 0.0509s/iter; left time: 546.0571s
	iters: 200, epoch: 2 | loss: 0.1406453
	speed: 0.0163s/iter; left time: 173.6600s
	iters: 300, epoch: 2 | loss: 0.2300675
	speed: 0.0163s/iter; left time: 172.1184s
	iters: 400, epoch: 2 | loss: 0.2397196
	speed: 0.0163s/iter; left time: 170.5234s
	iters: 500, epoch: 2 | loss: 0.1692325
	speed: 0.0163s/iter; left time: 168.5786s
Epoch: 2 cost time: 9.625909805297852
Epoch: 2, Steps: 570 | Train Loss: 0.1819060 Vali Loss: 0.0354373 Test Loss: 0.1129405
Validation loss decreased (0.036129 --> 0.035437).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1561161
	speed: 0.0548s/iter; left time: 556.6167s
	iters: 200, epoch: 3 | loss: 0.1524493
	speed: 0.0176s/iter; left time: 176.6527s
	iters: 300, epoch: 3 | loss: 0.1533091
	speed: 0.0165s/iter; left time: 163.9981s
	iters: 400, epoch: 3 | loss: 0.2105260
	speed: 0.0164s/iter; left time: 162.0433s
	iters: 500, epoch: 3 | loss: 0.1116992
	speed: 0.0164s/iter; left time: 160.3188s
Epoch: 3 cost time: 9.946867227554321
Epoch: 3, Steps: 570 | Train Loss: 0.1655874 Vali Loss: 0.0329602 Test Loss: 0.1078570
Validation loss decreased (0.035437 --> 0.032960).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1438631
	speed: 0.0508s/iter; left time: 487.1727s
	iters: 200, epoch: 4 | loss: 0.2944773
	speed: 0.0164s/iter; left time: 155.7729s
	iters: 300, epoch: 4 | loss: 0.1522587
	speed: 0.0164s/iter; left time: 154.1628s
	iters: 400, epoch: 4 | loss: 0.1090287
	speed: 0.0164s/iter; left time: 152.1471s
	iters: 500, epoch: 4 | loss: 0.1948645
	speed: 0.0164s/iter; left time: 150.6886s
Epoch: 4 cost time: 9.623430252075195
Epoch: 4, Steps: 570 | Train Loss: 0.1562246 Vali Loss: 0.0324491 Test Loss: 0.1078768
Validation loss decreased (0.032960 --> 0.032449).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1842611
	speed: 0.0491s/iter; left time: 443.0659s
	iters: 200, epoch: 5 | loss: 0.1855548
	speed: 0.0165s/iter; left time: 147.0167s
	iters: 300, epoch: 5 | loss: 0.1641506
	speed: 0.0165s/iter; left time: 145.3801s
	iters: 400, epoch: 5 | loss: 0.1029566
	speed: 0.0165s/iter; left time: 143.7344s
	iters: 500, epoch: 5 | loss: 0.2050424
	speed: 0.0165s/iter; left time: 142.0704s
Epoch: 5 cost time: 9.681009292602539
Epoch: 5, Steps: 570 | Train Loss: 0.1526626 Vali Loss: 0.0320908 Test Loss: 0.1077455
Validation loss decreased (0.032449 --> 0.032091).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1627000
	speed: 0.0496s/iter; left time: 418.9780s
	iters: 200, epoch: 6 | loss: 0.1896338
	speed: 0.0164s/iter; left time: 136.9735s
	iters: 300, epoch: 6 | loss: 0.2693917
	speed: 0.0164s/iter; left time: 135.3640s
	iters: 400, epoch: 6 | loss: 0.1517547
	speed: 0.0164s/iter; left time: 133.7305s
	iters: 500, epoch: 6 | loss: 0.1533870
	speed: 0.0164s/iter; left time: 132.1258s
Epoch: 6 cost time: 9.666680097579956
Epoch: 6, Steps: 570 | Train Loss: 0.1504282 Vali Loss: 0.0319907 Test Loss: 0.1079596
Validation loss decreased (0.032091 --> 0.031991).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2064373
	speed: 0.0519s/iter; left time: 409.2560s
	iters: 200, epoch: 7 | loss: 0.0981622
	speed: 0.0165s/iter; left time: 128.2735s
	iters: 300, epoch: 7 | loss: 0.1423584
	speed: 0.0165s/iter; left time: 126.6548s
	iters: 400, epoch: 7 | loss: 0.2041747
	speed: 0.0165s/iter; left time: 124.9676s
	iters: 500, epoch: 7 | loss: 0.2211102
	speed: 0.0165s/iter; left time: 123.3423s
Epoch: 7 cost time: 9.685073852539062
Epoch: 7, Steps: 570 | Train Loss: 0.1502212 Vali Loss: 0.0320323 Test Loss: 0.1082623
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0899850
	speed: 0.0517s/iter; left time: 377.7389s
	iters: 200, epoch: 8 | loss: 0.2159691
	speed: 0.0164s/iter; left time: 118.2851s
	iters: 300, epoch: 8 | loss: 0.1730623
	speed: 0.0164s/iter; left time: 116.7358s
	iters: 400, epoch: 8 | loss: 0.1780045
	speed: 0.0164s/iter; left time: 114.9101s
	iters: 500, epoch: 8 | loss: 0.1362632
	speed: 0.0164s/iter; left time: 113.2825s
Epoch: 8 cost time: 9.622935771942139
Epoch: 8, Steps: 570 | Train Loss: 0.1481123 Vali Loss: 0.0319850 Test Loss: 0.1078942
Validation loss decreased (0.031991 --> 0.031985).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0998281
	speed: 0.0505s/iter; left time: 340.4192s
	iters: 200, epoch: 9 | loss: 0.1439245
	speed: 0.0163s/iter; left time: 108.5603s
	iters: 300, epoch: 9 | loss: 0.0975575
	speed: 0.0164s/iter; left time: 107.0518s
	iters: 400, epoch: 9 | loss: 0.1241299
	speed: 0.0163s/iter; left time: 105.2738s
	iters: 500, epoch: 9 | loss: 0.0834725
	speed: 0.0163s/iter; left time: 103.6736s
Epoch: 9 cost time: 9.637350082397461
Epoch: 9, Steps: 570 | Train Loss: 0.1485585 Vali Loss: 0.0319350 Test Loss: 0.1079367
Validation loss decreased (0.031985 --> 0.031935).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1683648
	speed: 0.0528s/iter; left time: 326.0543s
	iters: 200, epoch: 10 | loss: 0.1398911
	speed: 0.0164s/iter; left time: 99.4901s
	iters: 300, epoch: 10 | loss: 0.1231320
	speed: 0.0164s/iter; left time: 97.8131s
	iters: 400, epoch: 10 | loss: 0.1850924
	speed: 0.0164s/iter; left time: 96.4595s
	iters: 500, epoch: 10 | loss: 0.1255039
	speed: 0.0164s/iter; left time: 94.8503s
Epoch: 10 cost time: 9.648694515228271
Epoch: 10, Steps: 570 | Train Loss: 0.1485522 Vali Loss: 0.0318961 Test Loss: 0.1078511
Validation loss decreased (0.031935 --> 0.031896).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0992068
	speed: 0.0497s/iter; left time: 278.2731s
	iters: 200, epoch: 11 | loss: 0.1115770
	speed: 0.0164s/iter; left time: 90.1229s
	iters: 300, epoch: 11 | loss: 0.0927474
	speed: 0.0164s/iter; left time: 88.4750s
	iters: 400, epoch: 11 | loss: 0.1755264
	speed: 0.0164s/iter; left time: 86.8361s
	iters: 500, epoch: 11 | loss: 0.1436180
	speed: 0.0164s/iter; left time: 85.1940s
Epoch: 11 cost time: 9.65380048751831
Epoch: 11, Steps: 570 | Train Loss: 0.1481259 Vali Loss: 0.0320139 Test Loss: 0.1077969
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0950868
	speed: 0.0488s/iter; left time: 245.4801s
	iters: 200, epoch: 12 | loss: 0.1472794
	speed: 0.0164s/iter; left time: 80.7724s
	iters: 300, epoch: 12 | loss: 0.0909319
	speed: 0.0164s/iter; left time: 79.1505s
	iters: 400, epoch: 12 | loss: 0.1409163
	speed: 0.0164s/iter; left time: 77.4684s
	iters: 500, epoch: 12 | loss: 0.2169520
	speed: 0.0164s/iter; left time: 75.8160s
Epoch: 12 cost time: 9.591531753540039
Epoch: 12, Steps: 570 | Train Loss: 0.1475296 Vali Loss: 0.0319398 Test Loss: 0.1078073
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2090934
	speed: 0.0486s/iter; left time: 216.8594s
	iters: 200, epoch: 13 | loss: 0.2313940
	speed: 0.0164s/iter; left time: 71.4141s
	iters: 300, epoch: 13 | loss: 0.1662891
	speed: 0.0164s/iter; left time: 69.8231s
	iters: 400, epoch: 13 | loss: 0.1259979
	speed: 0.0164s/iter; left time: 68.2790s
	iters: 500, epoch: 13 | loss: 0.1475657
	speed: 0.0164s/iter; left time: 66.6030s
Epoch: 13 cost time: 9.619513511657715
Epoch: 13, Steps: 570 | Train Loss: 0.1476226 Vali Loss: 0.0320234 Test Loss: 0.1078198
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1079949215054512, mae:0.19775967299938202
>>> MS_Raw LR=1e-4 DO=0.2 EL=3 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2413167
	speed: 0.0271s/iter; left time: 305.8475s
	iters: 200, epoch: 1 | loss: 0.2447659
	speed: 0.0155s/iter; left time: 173.1674s
	iters: 300, epoch: 1 | loss: 0.1951623
	speed: 0.0154s/iter; left time: 171.4453s
	iters: 400, epoch: 1 | loss: 0.2647790
	speed: 0.0155s/iter; left time: 170.0348s
	iters: 500, epoch: 1 | loss: 0.4042602
	speed: 0.0155s/iter; left time: 168.4952s
Epoch: 1 cost time: 10.029227256774902
Epoch: 1, Steps: 570 | Train Loss: 0.2468356 Vali Loss: 0.0431872 Test Loss: 0.1299762
Validation loss decreased (inf --> 0.043187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2797507
	speed: 0.0486s/iter; left time: 521.2548s
	iters: 200, epoch: 2 | loss: 0.1393885
	speed: 0.0154s/iter; left time: 163.4489s
	iters: 300, epoch: 2 | loss: 0.2722968
	speed: 0.0154s/iter; left time: 161.8452s
	iters: 400, epoch: 2 | loss: 0.1652651
	speed: 0.0154s/iter; left time: 160.8276s
	iters: 500, epoch: 2 | loss: 0.2828748
	speed: 0.0154s/iter; left time: 159.4269s
Epoch: 2 cost time: 9.098963022232056
Epoch: 2, Steps: 570 | Train Loss: 0.2045503 Vali Loss: 0.0416179 Test Loss: 0.1277904
Validation loss decreased (0.043187 --> 0.041618).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2099430
	speed: 0.0516s/iter; left time: 524.1458s
	iters: 200, epoch: 3 | loss: 0.1105419
	speed: 0.0170s/iter; left time: 171.2996s
	iters: 300, epoch: 3 | loss: 0.1900432
	speed: 0.0158s/iter; left time: 157.4468s
	iters: 400, epoch: 3 | loss: 0.1622627
	speed: 0.0154s/iter; left time: 151.8219s
	iters: 500, epoch: 3 | loss: 0.1956563
	speed: 0.0154s/iter; left time: 150.3584s
Epoch: 3 cost time: 9.437560081481934
Epoch: 3, Steps: 570 | Train Loss: 0.1829635 Vali Loss: 0.0392807 Test Loss: 0.1231934
Validation loss decreased (0.041618 --> 0.039281).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1368286
	speed: 0.0475s/iter; left time: 455.9655s
	iters: 200, epoch: 4 | loss: 0.2423485
	speed: 0.0154s/iter; left time: 146.1057s
	iters: 300, epoch: 4 | loss: 0.1873889
	speed: 0.0154s/iter; left time: 144.3820s
	iters: 400, epoch: 4 | loss: 0.1467016
	speed: 0.0154s/iter; left time: 142.7052s
	iters: 500, epoch: 4 | loss: 0.2073897
	speed: 0.0154s/iter; left time: 141.1680s
Epoch: 4 cost time: 9.082495212554932
Epoch: 4, Steps: 570 | Train Loss: 0.1739222 Vali Loss: 0.0375154 Test Loss: 0.1216830
Validation loss decreased (0.039281 --> 0.037515).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1482170
	speed: 0.0480s/iter; left time: 432.7562s
	iters: 200, epoch: 5 | loss: 0.1361156
	speed: 0.0154s/iter; left time: 137.6548s
	iters: 300, epoch: 5 | loss: 0.1386197
	speed: 0.0154s/iter; left time: 136.0069s
	iters: 400, epoch: 5 | loss: 0.1360067
	speed: 0.0154s/iter; left time: 134.2518s
	iters: 500, epoch: 5 | loss: 0.1387597
	speed: 0.0154s/iter; left time: 132.7601s
Epoch: 5 cost time: 9.087947368621826
Epoch: 5, Steps: 570 | Train Loss: 0.1657920 Vali Loss: 0.0373320 Test Loss: 0.1218878
Validation loss decreased (0.037515 --> 0.037332).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1826727
	speed: 0.0492s/iter; left time: 416.0907s
	iters: 200, epoch: 6 | loss: 0.1267354
	speed: 0.0154s/iter; left time: 128.6006s
	iters: 300, epoch: 6 | loss: 0.0930751
	speed: 0.0163s/iter; left time: 134.7976s
	iters: 400, epoch: 6 | loss: 0.1173369
	speed: 0.0174s/iter; left time: 141.6934s
	iters: 500, epoch: 6 | loss: 0.1261780
	speed: 0.0154s/iter; left time: 123.9473s
Epoch: 6 cost time: 9.369808912277222
Epoch: 6, Steps: 570 | Train Loss: 0.1635939 Vali Loss: 0.0366563 Test Loss: 0.1212485
Validation loss decreased (0.037332 --> 0.036656).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1912948
	speed: 0.0500s/iter; left time: 393.9405s
	iters: 200, epoch: 7 | loss: 0.1365837
	speed: 0.0155s/iter; left time: 120.4074s
	iters: 300, epoch: 7 | loss: 0.1388618
	speed: 0.0173s/iter; left time: 133.2071s
	iters: 400, epoch: 7 | loss: 0.1891867
	speed: 0.0177s/iter; left time: 133.9348s
	iters: 500, epoch: 7 | loss: 0.1679867
	speed: 0.0177s/iter; left time: 132.1747s
Epoch: 7 cost time: 9.891201257705688
Epoch: 7, Steps: 570 | Train Loss: 0.1611788 Vali Loss: 0.0365083 Test Loss: 0.1210062
Validation loss decreased (0.036656 --> 0.036508).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1519459
	speed: 0.0515s/iter; left time: 376.2129s
	iters: 200, epoch: 8 | loss: 0.1881487
	speed: 0.0153s/iter; left time: 110.5172s
	iters: 300, epoch: 8 | loss: 0.1068528
	speed: 0.0153s/iter; left time: 108.9331s
	iters: 400, epoch: 8 | loss: 0.1606441
	speed: 0.0153s/iter; left time: 107.3550s
	iters: 500, epoch: 8 | loss: 0.1078089
	speed: 0.0153s/iter; left time: 105.6997s
Epoch: 8 cost time: 9.117723941802979
Epoch: 8, Steps: 570 | Train Loss: 0.1593887 Vali Loss: 0.0366137 Test Loss: 0.1212772
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1538752
	speed: 0.0486s/iter; left time: 327.7306s
	iters: 200, epoch: 9 | loss: 0.1486090
	speed: 0.0154s/iter; left time: 101.9626s
	iters: 300, epoch: 9 | loss: 0.1573620
	speed: 0.0153s/iter; left time: 100.3113s
	iters: 400, epoch: 9 | loss: 0.1237305
	speed: 0.0153s/iter; left time: 98.7815s
	iters: 500, epoch: 9 | loss: 0.1568079
	speed: 0.0153s/iter; left time: 97.1096s
Epoch: 9 cost time: 9.024101972579956
Epoch: 9, Steps: 570 | Train Loss: 0.1593239 Vali Loss: 0.0365885 Test Loss: 0.1213836
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1925525
	speed: 0.0486s/iter; left time: 299.7114s
	iters: 200, epoch: 10 | loss: 0.1895633
	speed: 0.0171s/iter; left time: 103.6187s
	iters: 300, epoch: 10 | loss: 0.1333423
	speed: 0.0171s/iter; left time: 102.1450s
	iters: 400, epoch: 10 | loss: 0.1853685
	speed: 0.0178s/iter; left time: 104.2513s
	iters: 500, epoch: 10 | loss: 0.2689129
	speed: 0.0177s/iter; left time: 102.2579s
Epoch: 10 cost time: 10.057009935379028
Epoch: 10, Steps: 570 | Train Loss: 0.1621295 Vali Loss: 0.0365173 Test Loss: 0.1213550
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1211564838886261, mae:0.2156672477722168
>>> MS_Raw LR=1e-4 DO=0.2 EL=4 DM=256 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1701213
	speed: 0.0328s/iter; left time: 370.4260s
	iters: 200, epoch: 1 | loss: 0.2276553
	speed: 0.0208s/iter; left time: 232.5295s
	iters: 300, epoch: 1 | loss: 0.3742180
	speed: 0.0208s/iter; left time: 230.4575s
	iters: 400, epoch: 1 | loss: 0.2055091
	speed: 0.0208s/iter; left time: 228.6284s
	iters: 500, epoch: 1 | loss: 0.1715035
	speed: 0.0208s/iter; left time: 226.9329s
Epoch: 1 cost time: 13.10127568244934
Epoch: 1, Steps: 570 | Train Loss: 0.2427779 Vali Loss: 0.0438735 Test Loss: 0.1348092
Validation loss decreased (inf --> 0.043874).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3773701
	speed: 0.0620s/iter; left time: 665.1293s
	iters: 200, epoch: 2 | loss: 0.1882428
	speed: 0.0186s/iter; left time: 198.0586s
	iters: 300, epoch: 2 | loss: 0.1453577
	speed: 0.0186s/iter; left time: 195.6724s
	iters: 400, epoch: 2 | loss: 0.1704081
	speed: 0.0191s/iter; left time: 199.1782s
	iters: 500, epoch: 2 | loss: 0.1764275
	speed: 0.0208s/iter; left time: 215.1196s
Epoch: 2 cost time: 11.355310440063477
Epoch: 2, Steps: 570 | Train Loss: 0.2056473 Vali Loss: 0.0413137 Test Loss: 0.1240067
Validation loss decreased (0.043874 --> 0.041314).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1649174
	speed: 0.0578s/iter; left time: 587.7552s
	iters: 200, epoch: 3 | loss: 0.1766003
	speed: 0.0186s/iter; left time: 186.8563s
	iters: 300, epoch: 3 | loss: 0.1858291
	speed: 0.0186s/iter; left time: 185.1346s
	iters: 400, epoch: 3 | loss: 0.1261468
	speed: 0.0186s/iter; left time: 183.0682s
	iters: 500, epoch: 3 | loss: 0.1542312
	speed: 0.0186s/iter; left time: 181.1551s
Epoch: 3 cost time: 10.88612174987793
Epoch: 3, Steps: 570 | Train Loss: 0.1867160 Vali Loss: 0.0395584 Test Loss: 0.1199562
Validation loss decreased (0.041314 --> 0.039558).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2248079
	speed: 0.0565s/iter; left time: 542.2855s
	iters: 200, epoch: 4 | loss: 0.2410038
	speed: 0.0185s/iter; left time: 176.0215s
	iters: 300, epoch: 4 | loss: 0.2181978
	speed: 0.0186s/iter; left time: 174.2327s
	iters: 400, epoch: 4 | loss: 0.1244966
	speed: 0.0185s/iter; left time: 172.1258s
	iters: 500, epoch: 4 | loss: 0.1746538
	speed: 0.0186s/iter; left time: 170.4950s
Epoch: 4 cost time: 10.861785173416138
Epoch: 4, Steps: 570 | Train Loss: 0.1779401 Vali Loss: 0.0380415 Test Loss: 0.1196130
Validation loss decreased (0.039558 --> 0.038041).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1850338
	speed: 0.0579s/iter; left time: 522.7231s
	iters: 200, epoch: 5 | loss: 0.1880086
	speed: 0.0185s/iter; left time: 165.1929s
	iters: 300, epoch: 5 | loss: 0.1586958
	speed: 0.0185s/iter; left time: 163.2462s
	iters: 400, epoch: 5 | loss: 0.1390885
	speed: 0.0185s/iter; left time: 161.1075s
	iters: 500, epoch: 5 | loss: 0.1527496
	speed: 0.0185s/iter; left time: 159.7912s
Epoch: 5 cost time: 10.858372211456299
Epoch: 5, Steps: 570 | Train Loss: 0.1739779 Vali Loss: 0.0368697 Test Loss: 0.1180260
Validation loss decreased (0.038041 --> 0.036870).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0908256
	speed: 0.0589s/iter; left time: 498.0699s
	iters: 200, epoch: 6 | loss: 0.1706789
	speed: 0.0186s/iter; left time: 155.2650s
	iters: 300, epoch: 6 | loss: 0.1332409
	speed: 0.0185s/iter; left time: 152.9476s
	iters: 400, epoch: 6 | loss: 0.1949337
	speed: 0.0185s/iter; left time: 150.8895s
	iters: 500, epoch: 6 | loss: 0.1837593
	speed: 0.0185s/iter; left time: 148.7933s
Epoch: 6 cost time: 10.84045124053955
Epoch: 6, Steps: 570 | Train Loss: 0.1713157 Vali Loss: 0.0367580 Test Loss: 0.1180002
Validation loss decreased (0.036870 --> 0.036758).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1275187
	speed: 0.0561s/iter; left time: 442.4394s
	iters: 200, epoch: 7 | loss: 0.1628376
	speed: 0.0185s/iter; left time: 144.2003s
	iters: 300, epoch: 7 | loss: 0.1614579
	speed: 0.0185s/iter; left time: 142.3112s
	iters: 400, epoch: 7 | loss: 0.1849743
	speed: 0.0185s/iter; left time: 140.4117s
	iters: 500, epoch: 7 | loss: 0.2650965
	speed: 0.0185s/iter; left time: 138.3904s
Epoch: 7 cost time: 10.880882740020752
Epoch: 7, Steps: 570 | Train Loss: 0.1693896 Vali Loss: 0.0368110 Test Loss: 0.1179816
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1658965
	speed: 0.0596s/iter; left time: 435.6662s
	iters: 200, epoch: 8 | loss: 0.1343313
	speed: 0.0185s/iter; left time: 133.4211s
	iters: 300, epoch: 8 | loss: 0.1295584
	speed: 0.0185s/iter; left time: 131.7082s
	iters: 400, epoch: 8 | loss: 0.2085418
	speed: 0.0185s/iter; left time: 129.5452s
	iters: 500, epoch: 8 | loss: 0.1509864
	speed: 0.0185s/iter; left time: 127.7328s
Epoch: 8 cost time: 10.850558042526245
Epoch: 8, Steps: 570 | Train Loss: 0.1687659 Vali Loss: 0.0365846 Test Loss: 0.1179681
Validation loss decreased (0.036758 --> 0.036585).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0972329
	speed: 0.0570s/iter; left time: 384.0616s
	iters: 200, epoch: 9 | loss: 0.2183301
	speed: 0.0184s/iter; left time: 122.4780s
	iters: 300, epoch: 9 | loss: 0.0979860
	speed: 0.0184s/iter; left time: 120.6520s
	iters: 400, epoch: 9 | loss: 0.1908693
	speed: 0.0184s/iter; left time: 118.7317s
	iters: 500, epoch: 9 | loss: 0.0836755
	speed: 0.0185s/iter; left time: 117.0331s
Epoch: 9 cost time: 10.953027248382568
Epoch: 9, Steps: 570 | Train Loss: 0.1694459 Vali Loss: 0.0367797 Test Loss: 0.1178907
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1670914
	speed: 0.0562s/iter; left time: 346.5019s
	iters: 200, epoch: 10 | loss: 0.2010027
	speed: 0.0187s/iter; left time: 113.6093s
	iters: 300, epoch: 10 | loss: 0.1051348
	speed: 0.0208s/iter; left time: 123.9209s
	iters: 400, epoch: 10 | loss: 0.1393016
	speed: 0.0208s/iter; left time: 122.1156s
	iters: 500, epoch: 10 | loss: 0.1491832
	speed: 0.0208s/iter; left time: 119.8906s
Epoch: 10 cost time: 11.70388150215149
Epoch: 10, Steps: 570 | Train Loss: 0.1686444 Vali Loss: 0.0364459 Test Loss: 0.1173587
Validation loss decreased (0.036585 --> 0.036446).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1405297
	speed: 0.0581s/iter; left time: 325.5974s
	iters: 200, epoch: 11 | loss: 0.2319062
	speed: 0.0185s/iter; left time: 101.6323s
	iters: 300, epoch: 11 | loss: 0.1606440
	speed: 0.0185s/iter; left time: 99.6506s
	iters: 400, epoch: 11 | loss: 0.1128259
	speed: 0.0184s/iter; left time: 97.8006s
	iters: 500, epoch: 11 | loss: 0.2395503
	speed: 0.0186s/iter; left time: 96.5781s
Epoch: 11 cost time: 10.828749179840088
Epoch: 11, Steps: 570 | Train Loss: 0.1688100 Vali Loss: 0.0364996 Test Loss: 0.1175109
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1831477
	speed: 0.0557s/iter; left time: 280.1123s
	iters: 200, epoch: 12 | loss: 0.2048599
	speed: 0.0186s/iter; left time: 91.5954s
	iters: 300, epoch: 12 | loss: 0.0970611
	speed: 0.0186s/iter; left time: 89.8766s
	iters: 400, epoch: 12 | loss: 0.1759743
	speed: 0.0190s/iter; left time: 89.7903s
	iters: 500, epoch: 12 | loss: 0.1466150
	speed: 0.0203s/iter; left time: 94.2387s
Epoch: 12 cost time: 11.076517820358276
Epoch: 12, Steps: 570 | Train Loss: 0.1692958 Vali Loss: 0.0363186 Test Loss: 0.1174844
Validation loss decreased (0.036446 --> 0.036319).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1935764
	speed: 0.0560s/iter; left time: 249.8241s
	iters: 200, epoch: 13 | loss: 0.1432235
	speed: 0.0186s/iter; left time: 81.0617s
	iters: 300, epoch: 13 | loss: 0.1678448
	speed: 0.0186s/iter; left time: 79.1886s
	iters: 400, epoch: 13 | loss: 0.1233341
	speed: 0.0186s/iter; left time: 77.2643s
	iters: 500, epoch: 13 | loss: 0.2573188
	speed: 0.0186s/iter; left time: 75.5173s
Epoch: 13 cost time: 10.926567077636719
Epoch: 13, Steps: 570 | Train Loss: 0.1691465 Vali Loss: 0.0364455 Test Loss: 0.1174650
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1777302
	speed: 0.0565s/iter; left time: 219.6740s
	iters: 200, epoch: 14 | loss: 0.1110812
	speed: 0.0186s/iter; left time: 70.5715s
	iters: 300, epoch: 14 | loss: 0.1335861
	speed: 0.0185s/iter; left time: 68.4651s
	iters: 400, epoch: 14 | loss: 0.1736268
	speed: 0.0186s/iter; left time: 66.6314s
	iters: 500, epoch: 14 | loss: 0.2093794
	speed: 0.0185s/iter; left time: 64.6879s
Epoch: 14 cost time: 10.855242252349854
Epoch: 14, Steps: 570 | Train Loss: 0.1693446 Vali Loss: 0.0364211 Test Loss: 0.1174515
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1223397
	speed: 0.0561s/iter; left time: 186.2640s
	iters: 200, epoch: 15 | loss: 0.1927694
	speed: 0.0187s/iter; left time: 60.2990s
	iters: 300, epoch: 15 | loss: 0.1334334
	speed: 0.0187s/iter; left time: 58.3690s
	iters: 400, epoch: 15 | loss: 0.2074654
	speed: 0.0186s/iter; left time: 56.1165s
	iters: 500, epoch: 15 | loss: 0.1467664
	speed: 0.0186s/iter; left time: 54.2105s
Epoch: 15 cost time: 10.932761669158936
Epoch: 15, Steps: 570 | Train Loss: 0.1696263 Vali Loss: 0.0364447 Test Loss: 0.1174427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11763672530651093, mae:0.2096700668334961
>>> MS_Raw LR=1e-4 DO=0.2 EL=4 DM=256 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4402836
	speed: 0.0302s/iter; left time: 340.9226s
	iters: 200, epoch: 1 | loss: 0.2280317
	speed: 0.0203s/iter; left time: 227.4419s
	iters: 300, epoch: 1 | loss: 0.2163184
	speed: 0.0187s/iter; left time: 207.8003s
	iters: 400, epoch: 1 | loss: 0.1716065
	speed: 0.0183s/iter; left time: 200.9438s
	iters: 500, epoch: 1 | loss: 0.2263470
	speed: 0.0183s/iter; left time: 199.1696s
Epoch: 1 cost time: 11.903881788253784
Epoch: 1, Steps: 570 | Train Loss: 0.2177778 Vali Loss: 0.0359990 Test Loss: 0.1144829
Validation loss decreased (inf --> 0.035999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1530267
	speed: 0.0554s/iter; left time: 594.4315s
	iters: 200, epoch: 2 | loss: 0.2354390
	speed: 0.0181s/iter; left time: 192.4564s
	iters: 300, epoch: 2 | loss: 0.2974493
	speed: 0.0181s/iter; left time: 190.4540s
	iters: 400, epoch: 2 | loss: 0.1610678
	speed: 0.0181s/iter; left time: 188.8177s
	iters: 500, epoch: 2 | loss: 0.1318150
	speed: 0.0181s/iter; left time: 186.9472s
Epoch: 2 cost time: 10.6271390914917
Epoch: 2, Steps: 570 | Train Loss: 0.1872759 Vali Loss: 0.0355785 Test Loss: 0.1103872
Validation loss decreased (0.035999 --> 0.035578).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1258722
	speed: 0.0554s/iter; left time: 562.9068s
	iters: 200, epoch: 3 | loss: 0.1638420
	speed: 0.0181s/iter; left time: 182.5071s
	iters: 300, epoch: 3 | loss: 0.1729170
	speed: 0.0181s/iter; left time: 180.7116s
	iters: 400, epoch: 3 | loss: 0.1569908
	speed: 0.0181s/iter; left time: 178.8491s
	iters: 500, epoch: 3 | loss: 0.1315092
	speed: 0.0181s/iter; left time: 177.0997s
Epoch: 3 cost time: 10.655782222747803
Epoch: 3, Steps: 570 | Train Loss: 0.1725716 Vali Loss: 0.0344700 Test Loss: 0.1102411
Validation loss decreased (0.035578 --> 0.034470).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1933473
	speed: 0.0555s/iter; left time: 532.4875s
	iters: 200, epoch: 4 | loss: 0.1183194
	speed: 0.0182s/iter; left time: 172.6365s
	iters: 300, epoch: 4 | loss: 0.3026279
	speed: 0.0182s/iter; left time: 170.8681s
	iters: 400, epoch: 4 | loss: 0.1547152
	speed: 0.0182s/iter; left time: 168.9008s
	iters: 500, epoch: 4 | loss: 0.1303916
	speed: 0.0182s/iter; left time: 167.1564s
Epoch: 4 cost time: 10.663581848144531
Epoch: 4, Steps: 570 | Train Loss: 0.1665681 Vali Loss: 0.0332996 Test Loss: 0.1072504
Validation loss decreased (0.034470 --> 0.033300).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1343402
	speed: 0.0585s/iter; left time: 527.3729s
	iters: 200, epoch: 5 | loss: 0.1484613
	speed: 0.0182s/iter; left time: 162.3905s
	iters: 300, epoch: 5 | loss: 0.1597691
	speed: 0.0182s/iter; left time: 160.8611s
	iters: 400, epoch: 5 | loss: 0.1628501
	speed: 0.0182s/iter; left time: 158.5012s
	iters: 500, epoch: 5 | loss: 0.1543639
	speed: 0.0182s/iter; left time: 156.8548s
Epoch: 5 cost time: 10.688756227493286
Epoch: 5, Steps: 570 | Train Loss: 0.1636487 Vali Loss: 0.0330104 Test Loss: 0.1068674
Validation loss decreased (0.033300 --> 0.033010).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2362644
	speed: 0.0586s/iter; left time: 495.4271s
	iters: 200, epoch: 6 | loss: 0.1262991
	speed: 0.0211s/iter; left time: 175.8961s
	iters: 300, epoch: 6 | loss: 0.1783826
	speed: 0.0210s/iter; left time: 173.4327s
	iters: 400, epoch: 6 | loss: 0.1358697
	speed: 0.0210s/iter; left time: 171.1272s
	iters: 500, epoch: 6 | loss: 0.0978378
	speed: 0.0210s/iter; left time: 168.8443s
Epoch: 6 cost time: 12.294877052307129
Epoch: 6, Steps: 570 | Train Loss: 0.1615609 Vali Loss: 0.0325446 Test Loss: 0.1063081
Validation loss decreased (0.033010 --> 0.032545).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1607695
	speed: 0.0591s/iter; left time: 465.8876s
	iters: 200, epoch: 7 | loss: 0.2219531
	speed: 0.0192s/iter; left time: 149.5879s
	iters: 300, epoch: 7 | loss: 0.1253432
	speed: 0.0204s/iter; left time: 156.4568s
	iters: 400, epoch: 7 | loss: 0.1608795
	speed: 0.0204s/iter; left time: 154.3681s
	iters: 500, epoch: 7 | loss: 0.1382012
	speed: 0.0204s/iter; left time: 152.4695s
Epoch: 7 cost time: 11.767274379730225
Epoch: 7, Steps: 570 | Train Loss: 0.1585845 Vali Loss: 0.0325666 Test Loss: 0.1066777
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1129051
	speed: 0.0584s/iter; left time: 427.1067s
	iters: 200, epoch: 8 | loss: 0.1330525
	speed: 0.0182s/iter; left time: 131.4646s
	iters: 300, epoch: 8 | loss: 0.1465790
	speed: 0.0182s/iter; left time: 129.3394s
	iters: 400, epoch: 8 | loss: 0.1551302
	speed: 0.0182s/iter; left time: 127.5001s
	iters: 500, epoch: 8 | loss: 0.2000866
	speed: 0.0182s/iter; left time: 125.7038s
Epoch: 8 cost time: 10.809611082077026
Epoch: 8, Steps: 570 | Train Loss: 0.1580343 Vali Loss: 0.0326724 Test Loss: 0.1066297
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0877338
	speed: 0.0547s/iter; left time: 368.6420s
	iters: 200, epoch: 9 | loss: 0.1193765
	speed: 0.0205s/iter; left time: 135.9459s
	iters: 300, epoch: 9 | loss: 0.1743827
	speed: 0.0210s/iter; left time: 137.5288s
	iters: 400, epoch: 9 | loss: 0.1482083
	speed: 0.0211s/iter; left time: 135.5950s
	iters: 500, epoch: 9 | loss: 0.1290707
	speed: 0.0210s/iter; left time: 133.4453s
Epoch: 9 cost time: 11.96477222442627
Epoch: 9, Steps: 570 | Train Loss: 0.1584717 Vali Loss: 0.0326634 Test Loss: 0.1063355
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10645223408937454, mae:0.19559837877750397
>>> MS_Raw LR=1e-4 DO=0.2 EL=4 DM=256 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2651801
	speed: 0.0299s/iter; left time: 338.2830s
	iters: 200, epoch: 1 | loss: 0.2061377
	speed: 0.0184s/iter; left time: 205.5932s
	iters: 300, epoch: 1 | loss: 0.2616118
	speed: 0.0184s/iter; left time: 203.8596s
	iters: 400, epoch: 1 | loss: 0.2890184
	speed: 0.0183s/iter; left time: 201.4768s
	iters: 500, epoch: 1 | loss: 0.3381493
	speed: 0.0184s/iter; left time: 200.5710s
Epoch: 1 cost time: 11.6715247631073
Epoch: 1, Steps: 570 | Train Loss: 0.2511811 Vali Loss: 0.0428458 Test Loss: 0.1402139
Validation loss decreased (inf --> 0.042846).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2722202
	speed: 0.0564s/iter; left time: 604.7527s
	iters: 200, epoch: 2 | loss: 0.3023338
	speed: 0.0184s/iter; left time: 195.4046s
	iters: 300, epoch: 2 | loss: 0.4220283
	speed: 0.0183s/iter; left time: 192.9251s
	iters: 400, epoch: 2 | loss: 0.1778596
	speed: 0.0183s/iter; left time: 190.6387s
	iters: 500, epoch: 2 | loss: 0.1238796
	speed: 0.0183s/iter; left time: 188.6240s
Epoch: 2 cost time: 10.733560800552368
Epoch: 2, Steps: 570 | Train Loss: 0.2115823 Vali Loss: 0.0441549 Test Loss: 0.1311648
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1402862
	speed: 0.0557s/iter; left time: 566.2152s
	iters: 200, epoch: 3 | loss: 0.1880560
	speed: 0.0183s/iter; left time: 184.1941s
	iters: 300, epoch: 3 | loss: 0.2121368
	speed: 0.0183s/iter; left time: 181.9027s
	iters: 400, epoch: 3 | loss: 0.2370778
	speed: 0.0183s/iter; left time: 180.0837s
	iters: 500, epoch: 3 | loss: 0.1820183
	speed: 0.0183s/iter; left time: 178.1978s
Epoch: 3 cost time: 10.883720636367798
Epoch: 3, Steps: 570 | Train Loss: 0.1936986 Vali Loss: 0.0395063 Test Loss: 0.1265240
Validation loss decreased (0.042846 --> 0.039506).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1352281
	speed: 0.0575s/iter; left time: 551.3573s
	iters: 200, epoch: 4 | loss: 0.1846642
	speed: 0.0183s/iter; left time: 174.0411s
	iters: 300, epoch: 4 | loss: 0.1713757
	speed: 0.0183s/iter; left time: 171.9967s
	iters: 400, epoch: 4 | loss: 0.2349405
	speed: 0.0183s/iter; left time: 169.9006s
	iters: 500, epoch: 4 | loss: 0.1164267
	speed: 0.0183s/iter; left time: 168.0325s
Epoch: 4 cost time: 10.742396831512451
Epoch: 4, Steps: 570 | Train Loss: 0.1848535 Vali Loss: 0.0393417 Test Loss: 0.1241873
Validation loss decreased (0.039506 --> 0.039342).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1429969
	speed: 0.0559s/iter; left time: 504.0800s
	iters: 200, epoch: 5 | loss: 0.1879042
	speed: 0.0182s/iter; left time: 162.3732s
	iters: 300, epoch: 5 | loss: 0.1457430
	speed: 0.0182s/iter; left time: 160.7527s
	iters: 400, epoch: 5 | loss: 0.1728651
	speed: 0.0183s/iter; left time: 159.5557s
	iters: 500, epoch: 5 | loss: 0.0938167
	speed: 0.0183s/iter; left time: 157.8568s
Epoch: 5 cost time: 10.727407455444336
Epoch: 5, Steps: 570 | Train Loss: 0.1798460 Vali Loss: 0.0385588 Test Loss: 0.1223332
Validation loss decreased (0.039342 --> 0.038559).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2298993
	speed: 0.0572s/iter; left time: 483.4075s
	iters: 200, epoch: 6 | loss: 0.1317866
	speed: 0.0183s/iter; left time: 153.0324s
	iters: 300, epoch: 6 | loss: 0.3391422
	speed: 0.0183s/iter; left time: 151.1721s
	iters: 400, epoch: 6 | loss: 0.1500954
	speed: 0.0183s/iter; left time: 149.3218s
	iters: 500, epoch: 6 | loss: 0.1802107
	speed: 0.0183s/iter; left time: 147.5411s
Epoch: 6 cost time: 10.76362943649292
Epoch: 6, Steps: 570 | Train Loss: 0.1778498 Vali Loss: 0.0386358 Test Loss: 0.1219048
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1515136
	speed: 0.0553s/iter; left time: 435.8618s
	iters: 200, epoch: 7 | loss: 0.1496806
	speed: 0.0183s/iter; left time: 142.4491s
	iters: 300, epoch: 7 | loss: 0.1845922
	speed: 0.0183s/iter; left time: 140.5673s
	iters: 400, epoch: 7 | loss: 0.1701262
	speed: 0.0183s/iter; left time: 138.5129s
	iters: 500, epoch: 7 | loss: 0.1152266
	speed: 0.0183s/iter; left time: 136.9935s
Epoch: 7 cost time: 10.712601661682129
Epoch: 7, Steps: 570 | Train Loss: 0.1774723 Vali Loss: 0.0386863 Test Loss: 0.1224025
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1423626
	speed: 0.0575s/iter; left time: 420.5011s
	iters: 200, epoch: 8 | loss: 0.1177387
	speed: 0.0205s/iter; left time: 148.0575s
	iters: 300, epoch: 8 | loss: 0.1614120
	speed: 0.0205s/iter; left time: 145.4605s
	iters: 400, epoch: 8 | loss: 0.2179567
	speed: 0.0204s/iter; left time: 143.3674s
	iters: 500, epoch: 8 | loss: 0.1504788
	speed: 0.0205s/iter; left time: 141.4075s
Epoch: 8 cost time: 11.935675621032715
Epoch: 8, Steps: 570 | Train Loss: 0.1768888 Vali Loss: 0.0385472 Test Loss: 0.1227081
Validation loss decreased (0.038559 --> 0.038547).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1685435
	speed: 0.0569s/iter; left time: 383.3893s
	iters: 200, epoch: 9 | loss: 0.2040238
	speed: 0.0183s/iter; left time: 121.5074s
	iters: 300, epoch: 9 | loss: 0.2436899
	speed: 0.0183s/iter; left time: 119.5245s
	iters: 400, epoch: 9 | loss: 0.3090192
	speed: 0.0183s/iter; left time: 117.8329s
	iters: 500, epoch: 9 | loss: 0.1248585
	speed: 0.0183s/iter; left time: 115.9151s
Epoch: 9 cost time: 10.72638463973999
Epoch: 9, Steps: 570 | Train Loss: 0.1764126 Vali Loss: 0.0386066 Test Loss: 0.1222442
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1617981
	speed: 0.0554s/iter; left time: 342.0695s
	iters: 200, epoch: 10 | loss: 0.1409273
	speed: 0.0182s/iter; left time: 110.6402s
	iters: 300, epoch: 10 | loss: 0.1977402
	speed: 0.0182s/iter; left time: 108.8377s
	iters: 400, epoch: 10 | loss: 0.1650602
	speed: 0.0182s/iter; left time: 107.0640s
	iters: 500, epoch: 10 | loss: 0.1825350
	speed: 0.0182s/iter; left time: 105.2135s
Epoch: 10 cost time: 10.662612438201904
Epoch: 10, Steps: 570 | Train Loss: 0.1764346 Vali Loss: 0.0383638 Test Loss: 0.1220553
Validation loss decreased (0.038547 --> 0.038364).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1726952
	speed: 0.0583s/iter; left time: 326.3526s
	iters: 200, epoch: 11 | loss: 0.1705813
	speed: 0.0183s/iter; left time: 100.9128s
	iters: 300, epoch: 11 | loss: 0.1822181
	speed: 0.0183s/iter; left time: 98.8236s
	iters: 400, epoch: 11 | loss: 0.1932990
	speed: 0.0183s/iter; left time: 97.1747s
	iters: 500, epoch: 11 | loss: 0.1583101
	speed: 0.0183s/iter; left time: 95.2128s
Epoch: 11 cost time: 10.913398504257202
Epoch: 11, Steps: 570 | Train Loss: 0.1773822 Vali Loss: 0.0383823 Test Loss: 0.1220864
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1290665
	speed: 0.0545s/iter; left time: 274.2700s
	iters: 200, epoch: 12 | loss: 0.2061146
	speed: 0.0181s/iter; left time: 89.4135s
	iters: 300, epoch: 12 | loss: 0.1524406
	speed: 0.0181s/iter; left time: 87.6325s
	iters: 400, epoch: 12 | loss: 0.1417967
	speed: 0.0182s/iter; left time: 85.9892s
	iters: 500, epoch: 12 | loss: 0.2068213
	speed: 0.0182s/iter; left time: 84.1836s
Epoch: 12 cost time: 10.618582487106323
Epoch: 12, Steps: 570 | Train Loss: 0.1763787 Vali Loss: 0.0384361 Test Loss: 0.1220857
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1596949
	speed: 0.0568s/iter; left time: 253.3791s
	iters: 200, epoch: 13 | loss: 0.1017286
	speed: 0.0183s/iter; left time: 79.8464s
	iters: 300, epoch: 13 | loss: 0.1444184
	speed: 0.0183s/iter; left time: 77.8099s
	iters: 400, epoch: 13 | loss: 0.1134202
	speed: 0.0183s/iter; left time: 76.0149s
	iters: 500, epoch: 13 | loss: 0.1189065
	speed: 0.0183s/iter; left time: 74.1692s
Epoch: 13 cost time: 10.713420391082764
Epoch: 13, Steps: 570 | Train Loss: 0.1760794 Vali Loss: 0.0385588 Test Loss: 0.1220563
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12221644818782806, mae:0.21517717838287354
>>> MS_Raw LR=1e-4 DO=0.2 EL=4 DM=512 PL=16
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2293160
	speed: 0.0337s/iter; left time: 380.3749s
	iters: 200, epoch: 1 | loss: 0.2001203
	speed: 0.0221s/iter; left time: 247.2048s
	iters: 300, epoch: 1 | loss: 0.2317519
	speed: 0.0221s/iter; left time: 244.9045s
	iters: 400, epoch: 1 | loss: 0.3238974
	speed: 0.0221s/iter; left time: 242.6496s
	iters: 500, epoch: 1 | loss: 0.2662609
	speed: 0.0221s/iter; left time: 240.4333s
Epoch: 1 cost time: 13.78130316734314
Epoch: 1, Steps: 570 | Train Loss: 0.2369264 Vali Loss: 0.0448870 Test Loss: 0.1381774
Validation loss decreased (inf --> 0.044887).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2949812
	speed: 0.0636s/iter; left time: 682.0180s
	iters: 200, epoch: 2 | loss: 0.1773820
	speed: 0.0221s/iter; left time: 235.2886s
	iters: 300, epoch: 2 | loss: 0.1580946
	speed: 0.0221s/iter; left time: 232.8334s
	iters: 400, epoch: 2 | loss: 0.1641154
	speed: 0.0221s/iter; left time: 230.5333s
	iters: 500, epoch: 2 | loss: 0.1876259
	speed: 0.0221s/iter; left time: 228.4904s
Epoch: 2 cost time: 12.917776346206665
Epoch: 2, Steps: 570 | Train Loss: 0.1964609 Vali Loss: 0.0406355 Test Loss: 0.1257435
Validation loss decreased (0.044887 --> 0.040636).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3679785
	speed: 0.0660s/iter; left time: 670.5354s
	iters: 200, epoch: 3 | loss: 0.1269350
	speed: 0.0222s/iter; left time: 223.6536s
	iters: 300, epoch: 3 | loss: 0.2260499
	speed: 0.0222s/iter; left time: 221.3391s
	iters: 400, epoch: 3 | loss: 0.1312096
	speed: 0.0222s/iter; left time: 219.2701s
	iters: 500, epoch: 3 | loss: 0.1155650
	speed: 0.0222s/iter; left time: 216.8196s
Epoch: 3 cost time: 12.995733976364136
Epoch: 3, Steps: 570 | Train Loss: 0.1737390 Vali Loss: 0.0379185 Test Loss: 0.1199889
Validation loss decreased (0.040636 --> 0.037919).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1278060
	speed: 0.0660s/iter; left time: 633.0735s
	iters: 200, epoch: 4 | loss: 0.1287254
	speed: 0.0220s/iter; left time: 209.2709s
	iters: 300, epoch: 4 | loss: 0.1430790
	speed: 0.0220s/iter; left time: 206.7732s
	iters: 400, epoch: 4 | loss: 0.1266261
	speed: 0.0221s/iter; left time: 204.9171s
	iters: 500, epoch: 4 | loss: 0.1892242
	speed: 0.0220s/iter; left time: 202.5704s
Epoch: 4 cost time: 12.8877272605896
Epoch: 4, Steps: 570 | Train Loss: 0.1611997 Vali Loss: 0.0359299 Test Loss: 0.1203324
Validation loss decreased (0.037919 --> 0.035930).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1713608
	speed: 0.0670s/iter; left time: 604.7369s
	iters: 200, epoch: 5 | loss: 0.1498552
	speed: 0.0221s/iter; left time: 196.9527s
	iters: 300, epoch: 5 | loss: 0.1025852
	speed: 0.0221s/iter; left time: 194.5835s
	iters: 400, epoch: 5 | loss: 0.1424865
	speed: 0.0220s/iter; left time: 192.2132s
	iters: 500, epoch: 5 | loss: 0.1350143
	speed: 0.0221s/iter; left time: 190.1143s
Epoch: 5 cost time: 12.911835193634033
Epoch: 5, Steps: 570 | Train Loss: 0.1554374 Vali Loss: 0.0349023 Test Loss: 0.1193037
Validation loss decreased (0.035930 --> 0.034902).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1344327
	speed: 0.0664s/iter; left time: 561.0380s
	iters: 200, epoch: 6 | loss: 0.1777411
	speed: 0.0221s/iter; left time: 184.7390s
	iters: 300, epoch: 6 | loss: 0.1242370
	speed: 0.0221s/iter; left time: 182.5180s
	iters: 400, epoch: 6 | loss: 0.1273502
	speed: 0.0221s/iter; left time: 180.3932s
	iters: 500, epoch: 6 | loss: 0.2024987
	speed: 0.0222s/iter; left time: 178.5668s
Epoch: 6 cost time: 12.944385051727295
Epoch: 6, Steps: 570 | Train Loss: 0.1519231 Vali Loss: 0.0356104 Test Loss: 0.1197865
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1739931
	speed: 0.0629s/iter; left time: 495.3716s
	iters: 200, epoch: 7 | loss: 0.1780449
	speed: 0.0222s/iter; left time: 172.7224s
	iters: 300, epoch: 7 | loss: 0.1181497
	speed: 0.0222s/iter; left time: 170.4336s
	iters: 400, epoch: 7 | loss: 0.1467361
	speed: 0.0222s/iter; left time: 168.1919s
	iters: 500, epoch: 7 | loss: 0.1584349
	speed: 0.0222s/iter; left time: 165.9286s
Epoch: 7 cost time: 12.942581176757812
Epoch: 7, Steps: 570 | Train Loss: 0.1489323 Vali Loss: 0.0355754 Test Loss: 0.1189778
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1233920
	speed: 0.0645s/iter; left time: 471.9019s
	iters: 200, epoch: 8 | loss: 0.3557206
	speed: 0.0221s/iter; left time: 159.5327s
	iters: 300, epoch: 8 | loss: 0.1108116
	speed: 0.0221s/iter; left time: 157.3090s
	iters: 400, epoch: 8 | loss: 0.1410093
	speed: 0.0221s/iter; left time: 155.0408s
	iters: 500, epoch: 8 | loss: 0.1274756
	speed: 0.0221s/iter; left time: 152.8182s
Epoch: 8 cost time: 12.906883716583252
Epoch: 8, Steps: 570 | Train Loss: 0.1493372 Vali Loss: 0.0346900 Test Loss: 0.1187895
Validation loss decreased (0.034902 --> 0.034690).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1598254
	speed: 0.0633s/iter; left time: 426.7628s
	iters: 200, epoch: 9 | loss: 0.1528068
	speed: 0.0221s/iter; left time: 146.6555s
	iters: 300, epoch: 9 | loss: 0.1569958
	speed: 0.0221s/iter; left time: 144.6590s
	iters: 400, epoch: 9 | loss: 0.1132833
	speed: 0.0221s/iter; left time: 142.2066s
	iters: 500, epoch: 9 | loss: 0.1267483
	speed: 0.0221s/iter; left time: 140.3096s
Epoch: 9 cost time: 12.909960269927979
Epoch: 9, Steps: 570 | Train Loss: 0.1495864 Vali Loss: 0.0347729 Test Loss: 0.1186510
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1693633
	speed: 0.0619s/iter; left time: 382.2812s
	iters: 200, epoch: 10 | loss: 0.1689127
	speed: 0.0222s/iter; left time: 134.8499s
	iters: 300, epoch: 10 | loss: 0.1406300
	speed: 0.0222s/iter; left time: 132.5092s
	iters: 400, epoch: 10 | loss: 0.2072676
	speed: 0.0222s/iter; left time: 130.2268s
	iters: 500, epoch: 10 | loss: 0.1296462
	speed: 0.0222s/iter; left time: 127.9817s
Epoch: 10 cost time: 12.902405261993408
Epoch: 10, Steps: 570 | Train Loss: 0.1483664 Vali Loss: 0.0349972 Test Loss: 0.1186653
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1339197
	speed: 0.0641s/iter; left time: 358.9013s
	iters: 200, epoch: 11 | loss: 0.1176230
	speed: 0.0221s/iter; left time: 121.4691s
	iters: 300, epoch: 11 | loss: 0.0925952
	speed: 0.0221s/iter; left time: 119.2028s
	iters: 400, epoch: 11 | loss: 0.1302447
	speed: 0.0221s/iter; left time: 116.9663s
	iters: 500, epoch: 11 | loss: 0.1341548
	speed: 0.0221s/iter; left time: 114.7739s
Epoch: 11 cost time: 12.846724510192871
Epoch: 11, Steps: 570 | Train Loss: 0.1501437 Vali Loss: 0.0350755 Test Loss: 0.1187449
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11892738938331604, mae:0.21354109048843384
>>> MS_Raw LR=1e-4 DO=0.2 EL=4 DM=512 PL=24
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2284682
	speed: 0.0334s/iter; left time: 377.6344s
	iters: 200, epoch: 1 | loss: 0.1140975
	speed: 0.0213s/iter; left time: 238.4084s
	iters: 300, epoch: 1 | loss: 0.1872586
	speed: 0.0213s/iter; left time: 236.2906s
	iters: 400, epoch: 1 | loss: 0.1804277
	speed: 0.0213s/iter; left time: 234.0449s
	iters: 500, epoch: 1 | loss: 0.1918750
	speed: 0.0213s/iter; left time: 232.4209s
Epoch: 1 cost time: 13.40576434135437
Epoch: 1, Steps: 570 | Train Loss: 0.2124422 Vali Loss: 0.0370007 Test Loss: 0.1144546
Validation loss decreased (inf --> 0.037001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1790348
	speed: 0.0626s/iter; left time: 671.2730s
	iters: 200, epoch: 2 | loss: 0.1375379
	speed: 0.0231s/iter; left time: 245.1892s
	iters: 300, epoch: 2 | loss: 0.2338322
	speed: 0.0224s/iter; left time: 236.3756s
	iters: 400, epoch: 2 | loss: 0.1661720
	speed: 0.0213s/iter; left time: 222.0968s
	iters: 500, epoch: 2 | loss: 0.1245318
	speed: 0.0213s/iter; left time: 219.7076s
Epoch: 2 cost time: 12.857577085494995
Epoch: 2, Steps: 570 | Train Loss: 0.1824991 Vali Loss: 0.0336115 Test Loss: 0.1110842
Validation loss decreased (0.037001 --> 0.033611).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1640447
	speed: 0.0629s/iter; left time: 639.2205s
	iters: 200, epoch: 3 | loss: 0.1281942
	speed: 0.0214s/iter; left time: 215.1518s
	iters: 300, epoch: 3 | loss: 0.1569435
	speed: 0.0214s/iter; left time: 213.1200s
	iters: 400, epoch: 3 | loss: 0.1140294
	speed: 0.0214s/iter; left time: 211.0169s
	iters: 500, epoch: 3 | loss: 0.1418954
	speed: 0.0214s/iter; left time: 208.7518s
Epoch: 3 cost time: 12.497360944747925
Epoch: 3, Steps: 570 | Train Loss: 0.1628980 Vali Loss: 0.0330244 Test Loss: 0.1112351
Validation loss decreased (0.033611 --> 0.033024).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1311267
	speed: 0.0620s/iter; left time: 594.1760s
	iters: 200, epoch: 4 | loss: 0.1572121
	speed: 0.0214s/iter; left time: 202.8127s
	iters: 300, epoch: 4 | loss: 0.1599234
	speed: 0.0214s/iter; left time: 200.8262s
	iters: 400, epoch: 4 | loss: 0.1857014
	speed: 0.0214s/iter; left time: 198.5191s
	iters: 500, epoch: 4 | loss: 0.1329582
	speed: 0.0214s/iter; left time: 196.4845s
Epoch: 4 cost time: 12.500741243362427
Epoch: 4, Steps: 570 | Train Loss: 0.1534347 Vali Loss: 0.0313272 Test Loss: 0.1073021
Validation loss decreased (0.033024 --> 0.031327).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1965039
	speed: 0.0612s/iter; left time: 551.7892s
	iters: 200, epoch: 5 | loss: 0.1252093
	speed: 0.0214s/iter; left time: 190.8026s
	iters: 300, epoch: 5 | loss: 0.1540219
	speed: 0.0213s/iter; left time: 188.1555s
	iters: 400, epoch: 5 | loss: 0.1737693
	speed: 0.0213s/iter; left time: 185.9668s
	iters: 500, epoch: 5 | loss: 0.1343280
	speed: 0.0213s/iter; left time: 183.7766s
Epoch: 5 cost time: 12.487655878067017
Epoch: 5, Steps: 570 | Train Loss: 0.1480673 Vali Loss: 0.0314623 Test Loss: 0.1069397
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1305945
	speed: 0.0610s/iter; left time: 515.7638s
	iters: 200, epoch: 6 | loss: 0.1698483
	speed: 0.0214s/iter; left time: 178.9146s
	iters: 300, epoch: 6 | loss: 0.2030552
	speed: 0.0214s/iter; left time: 176.7696s
	iters: 400, epoch: 6 | loss: 0.1135494
	speed: 0.0214s/iter; left time: 174.4998s
	iters: 500, epoch: 6 | loss: 0.0988165
	speed: 0.0214s/iter; left time: 172.4442s
Epoch: 6 cost time: 12.497831106185913
Epoch: 6, Steps: 570 | Train Loss: 0.1447756 Vali Loss: 0.0306504 Test Loss: 0.1057928
Validation loss decreased (0.031327 --> 0.030650).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1269063
	speed: 0.0618s/iter; left time: 487.2011s
	iters: 200, epoch: 7 | loss: 0.1763606
	speed: 0.0213s/iter; left time: 165.8238s
	iters: 300, epoch: 7 | loss: 0.1897619
	speed: 0.0213s/iter; left time: 163.6527s
	iters: 400, epoch: 7 | loss: 0.1130605
	speed: 0.0213s/iter; left time: 161.5483s
	iters: 500, epoch: 7 | loss: 0.1624167
	speed: 0.0213s/iter; left time: 159.4241s
Epoch: 7 cost time: 12.463121175765991
Epoch: 7, Steps: 570 | Train Loss: 0.1435283 Vali Loss: 0.0310711 Test Loss: 0.1057043
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1158329
	speed: 0.0628s/iter; left time: 458.8187s
	iters: 200, epoch: 8 | loss: 0.1492592
	speed: 0.0214s/iter; left time: 154.2436s
	iters: 300, epoch: 8 | loss: 0.1385576
	speed: 0.0214s/iter; left time: 152.0892s
	iters: 400, epoch: 8 | loss: 0.1291806
	speed: 0.0214s/iter; left time: 149.9406s
	iters: 500, epoch: 8 | loss: 0.2251658
	speed: 0.0227s/iter; left time: 156.6188s
Epoch: 8 cost time: 12.777708530426025
Epoch: 8, Steps: 570 | Train Loss: 0.1441585 Vali Loss: 0.0307371 Test Loss: 0.1055154
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1272317
	speed: 0.0618s/iter; left time: 416.5207s
	iters: 200, epoch: 9 | loss: 0.1994877
	speed: 0.0215s/iter; left time: 142.7881s
	iters: 300, epoch: 9 | loss: 0.1821720
	speed: 0.0215s/iter; left time: 140.4915s
	iters: 400, epoch: 9 | loss: 0.1311061
	speed: 0.0215s/iter; left time: 138.3264s
	iters: 500, epoch: 9 | loss: 0.0953144
	speed: 0.0215s/iter; left time: 136.1503s
Epoch: 9 cost time: 12.544227600097656
Epoch: 9, Steps: 570 | Train Loss: 0.1427759 Vali Loss: 0.0307497 Test Loss: 0.1055081
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10591603815555573, mae:0.1953425258398056
>>> MS_Raw LR=1e-4 DO=0.2 EL=4 DM=512 PL=48
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24_MS_Raw   Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tune-MS-Raw         Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2562765
	speed: 0.0342s/iter; left time: 387.0392s
	iters: 200, epoch: 1 | loss: 0.2157764
	speed: 0.0222s/iter; left time: 248.3230s
	iters: 300, epoch: 1 | loss: 0.2481079
	speed: 0.0221s/iter; left time: 245.6943s
	iters: 400, epoch: 1 | loss: 0.2475539
	speed: 0.0201s/iter; left time: 221.3161s
	iters: 500, epoch: 1 | loss: 0.2619237
	speed: 0.0201s/iter; left time: 218.7888s
Epoch: 1 cost time: 13.33509612083435
Epoch: 1, Steps: 570 | Train Loss: 0.2410248 Vali Loss: 0.0453150 Test Loss: 0.1347040
Validation loss decreased (inf --> 0.045315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1065180
	speed: 0.0597s/iter; left time: 640.3034s
	iters: 200, epoch: 2 | loss: 0.3174434
	speed: 0.0202s/iter; left time: 214.2283s
	iters: 300, epoch: 2 | loss: 0.1810112
	speed: 0.0202s/iter; left time: 212.2037s
	iters: 400, epoch: 2 | loss: 0.1442247
	speed: 0.0202s/iter; left time: 210.6137s
	iters: 500, epoch: 2 | loss: 0.1641787
	speed: 0.0231s/iter; left time: 238.4040s
Epoch: 2 cost time: 12.311249732971191
Epoch: 2, Steps: 570 | Train Loss: 0.2043236 Vali Loss: 0.0404540 Test Loss: 0.1295821
Validation loss decreased (0.045315 --> 0.040454).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1248439
	speed: 0.0642s/iter; left time: 652.2700s
	iters: 200, epoch: 3 | loss: 0.1446200
	speed: 0.0231s/iter; left time: 231.9684s
	iters: 300, epoch: 3 | loss: 0.1604957
	speed: 0.0201s/iter; left time: 200.4761s
	iters: 400, epoch: 3 | loss: 0.1915502
	speed: 0.0201s/iter; left time: 198.2887s
	iters: 500, epoch: 3 | loss: 0.1480977
	speed: 0.0201s/iter; left time: 196.0856s
Epoch: 3 cost time: 12.329867839813232
Epoch: 3, Steps: 570 | Train Loss: 0.1780425 Vali Loss: 0.0381560 Test Loss: 0.1222825
Validation loss decreased (0.040454 --> 0.038156).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1330593
	speed: 0.0593s/iter; left time: 568.5480s
	iters: 200, epoch: 4 | loss: 0.2623751
	speed: 0.0199s/iter; left time: 188.7756s
	iters: 300, epoch: 4 | loss: 0.1235647
	speed: 0.0199s/iter; left time: 186.5265s
	iters: 400, epoch: 4 | loss: 0.1763392
	speed: 0.0199s/iter; left time: 184.6992s
	iters: 500, epoch: 4 | loss: 0.1472546
	speed: 0.0199s/iter; left time: 182.6337s
Epoch: 4 cost time: 11.645780086517334
Epoch: 4, Steps: 570 | Train Loss: 0.1684250 Vali Loss: 0.0369960 Test Loss: 0.1230981
Validation loss decreased (0.038156 --> 0.036996).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1510783
	speed: 0.0605s/iter; left time: 545.3881s
	iters: 200, epoch: 5 | loss: 0.2297237
	speed: 0.0201s/iter; left time: 179.2766s
	iters: 300, epoch: 5 | loss: 0.1699297
	speed: 0.0201s/iter; left time: 176.8618s
	iters: 400, epoch: 5 | loss: 0.1289299
	speed: 0.0200s/iter; left time: 174.7059s
	iters: 500, epoch: 5 | loss: 0.1482836
	speed: 0.0200s/iter; left time: 172.8035s
Epoch: 5 cost time: 11.717178583145142
Epoch: 5, Steps: 570 | Train Loss: 0.1612471 Vali Loss: 0.0358364 Test Loss: 0.1210869
Validation loss decreased (0.036996 --> 0.035836).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1806330
	speed: 0.0607s/iter; left time: 513.1255s
	iters: 200, epoch: 6 | loss: 0.1296096
	speed: 0.0201s/iter; left time: 167.6063s
	iters: 300, epoch: 6 | loss: 0.1711587
	speed: 0.0200s/iter; left time: 164.9373s
	iters: 400, epoch: 6 | loss: 0.1098421
	speed: 0.0200s/iter; left time: 163.2371s
	iters: 500, epoch: 6 | loss: 0.2536576
	speed: 0.0200s/iter; left time: 160.9545s
Epoch: 6 cost time: 11.73576021194458
Epoch: 6, Steps: 570 | Train Loss: 0.1581290 Vali Loss: 0.0355851 Test Loss: 0.1205030
Validation loss decreased (0.035836 --> 0.035585).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1820057
	speed: 0.0617s/iter; left time: 486.1511s
	iters: 200, epoch: 7 | loss: 0.1551099
	speed: 0.0202s/iter; left time: 156.8799s
	iters: 300, epoch: 7 | loss: 0.1663122
	speed: 0.0199s/iter; left time: 152.6483s
	iters: 400, epoch: 7 | loss: 0.1852769
	speed: 0.0199s/iter; left time: 150.8198s
	iters: 500, epoch: 7 | loss: 0.1291391
	speed: 0.0199s/iter; left time: 148.8373s
Epoch: 7 cost time: 11.882060527801514
Epoch: 7, Steps: 570 | Train Loss: 0.1576374 Vali Loss: 0.0353794 Test Loss: 0.1205120
Validation loss decreased (0.035585 --> 0.035379).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2096474
	speed: 0.0589s/iter; left time: 430.5977s
	iters: 200, epoch: 8 | loss: 0.2134181
	speed: 0.0200s/iter; left time: 144.4360s
	iters: 300, epoch: 8 | loss: 0.1830942
	speed: 0.0200s/iter; left time: 142.4740s
	iters: 400, epoch: 8 | loss: 0.1176649
	speed: 0.0200s/iter; left time: 140.2952s
	iters: 500, epoch: 8 | loss: 0.1991496
	speed: 0.0200s/iter; left time: 138.3182s
Epoch: 8 cost time: 11.694242477416992
Epoch: 8, Steps: 570 | Train Loss: 0.1570029 Vali Loss: 0.0353128 Test Loss: 0.1201875
Validation loss decreased (0.035379 --> 0.035313).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1775825
	speed: 0.0604s/iter; left time: 407.3120s
	iters: 200, epoch: 9 | loss: 0.1360510
	speed: 0.0201s/iter; left time: 133.5438s
	iters: 300, epoch: 9 | loss: 0.2114218
	speed: 0.0200s/iter; left time: 130.9545s
	iters: 400, epoch: 9 | loss: 0.1251161
	speed: 0.0201s/iter; left time: 129.5396s
	iters: 500, epoch: 9 | loss: 0.0949787
	speed: 0.0201s/iter; left time: 127.2286s
Epoch: 9 cost time: 11.757611989974976
Epoch: 9, Steps: 570 | Train Loss: 0.1550673 Vali Loss: 0.0352326 Test Loss: 0.1203308
Validation loss decreased (0.035313 --> 0.035233).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1661598
	speed: 0.0603s/iter; left time: 372.3440s
	iters: 200, epoch: 10 | loss: 0.1141818
	speed: 0.0200s/iter; left time: 121.2085s
	iters: 300, epoch: 10 | loss: 0.2880810
	speed: 0.0200s/iter; left time: 119.4769s
	iters: 400, epoch: 10 | loss: 0.1969699
	speed: 0.0199s/iter; left time: 117.0982s
	iters: 500, epoch: 10 | loss: 0.1559758
	speed: 0.0200s/iter; left time: 115.1922s
Epoch: 10 cost time: 11.68447732925415
Epoch: 10, Steps: 570 | Train Loss: 0.1543263 Vali Loss: 0.0353549 Test Loss: 0.1202883
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1343611
	speed: 0.0580s/iter; left time: 324.8992s
	iters: 200, epoch: 11 | loss: 0.1319569
	speed: 0.0201s/iter; left time: 110.6096s
	iters: 300, epoch: 11 | loss: 0.1341392
	speed: 0.0201s/iter; left time: 108.6161s
	iters: 400, epoch: 11 | loss: 0.2018586
	speed: 0.0200s/iter; left time: 106.2560s
	iters: 500, epoch: 11 | loss: 0.1080743
	speed: 0.0201s/iter; left time: 104.4618s
Epoch: 11 cost time: 11.734838724136353
Epoch: 11, Steps: 570 | Train Loss: 0.1560429 Vali Loss: 0.0352690 Test Loss: 0.1202708
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1515093
	speed: 0.0592s/iter; left time: 297.6636s
	iters: 200, epoch: 12 | loss: 0.1632299
	speed: 0.0200s/iter; left time: 98.8148s
	iters: 300, epoch: 12 | loss: 0.2150737
	speed: 0.0201s/iter; left time: 97.0159s
	iters: 400, epoch: 12 | loss: 0.1359158
	speed: 0.0201s/iter; left time: 94.8884s
	iters: 500, epoch: 12 | loss: 0.2216803
	speed: 0.0200s/iter; left time: 92.7719s
Epoch: 12 cost time: 11.746884822845459
Epoch: 12, Steps: 570 | Train Loss: 0.1539562 Vali Loss: 0.0352557 Test Loss: 0.1203630
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_MS_Raw_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tune-MS-Raw_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12048591673374176, mae:0.21578265726566315
