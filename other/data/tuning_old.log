True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1668184
	speed: 0.0213s/iter; left time: 241.2037s
	iters: 200, epoch: 1 | loss: 0.1968358
	speed: 0.0099s/iter; left time: 111.0739s
	iters: 300, epoch: 1 | loss: 0.1832968
	speed: 0.0099s/iter; left time: 110.2240s
	iters: 400, epoch: 1 | loss: 0.1859085
	speed: 0.0099s/iter; left time: 109.0041s
	iters: 500, epoch: 1 | loss: 0.2158217
	speed: 0.0099s/iter; left time: 108.0766s
Epoch: 1 cost time: 6.830486297607422
Epoch: 1, Steps: 570 | Train Loss: 0.2083975 Vali Loss: 0.0515174 Test Loss: 0.1629780
Validation loss decreased (inf --> 0.051517).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3291485
	speed: 0.0336s/iter; left time: 360.5552s
	iters: 200, epoch: 2 | loss: 0.2241254
	speed: 0.0100s/iter; left time: 106.0544s
	iters: 300, epoch: 2 | loss: 0.1987359
	speed: 0.0099s/iter; left time: 104.4111s
	iters: 400, epoch: 2 | loss: 0.2423836
	speed: 0.0099s/iter; left time: 103.7201s
	iters: 500, epoch: 2 | loss: 0.2867766
	speed: 0.0099s/iter; left time: 102.7065s
Epoch: 2 cost time: 5.86667799949646
Epoch: 2, Steps: 570 | Train Loss: 0.2576519 Vali Loss: 0.0684576 Test Loss: 0.1809007
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1952623
	speed: 0.0337s/iter; left time: 342.6485s
	iters: 200, epoch: 3 | loss: 0.2611968
	speed: 0.0101s/iter; left time: 101.6956s
	iters: 300, epoch: 3 | loss: 0.1721100
	speed: 0.0099s/iter; left time: 98.8333s
	iters: 400, epoch: 3 | loss: 0.2667773
	speed: 0.0100s/iter; left time: 98.2234s
	iters: 500, epoch: 3 | loss: 0.3224335
	speed: 0.0100s/iter; left time: 97.2234s
Epoch: 3 cost time: 5.996889352798462
Epoch: 3, Steps: 570 | Train Loss: 0.2467329 Vali Loss: 0.0648856 Test Loss: 0.1647076
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3145069
	speed: 0.0337s/iter; left time: 323.6653s
	iters: 200, epoch: 4 | loss: 0.1908078
	speed: 0.0100s/iter; left time: 94.4537s
	iters: 300, epoch: 4 | loss: 0.2720823
	speed: 0.0099s/iter; left time: 93.2326s
	iters: 400, epoch: 4 | loss: 0.2160956
	speed: 0.0100s/iter; left time: 92.7789s
	iters: 500, epoch: 4 | loss: 0.2266363
	speed: 0.0099s/iter; left time: 91.3901s
Epoch: 4 cost time: 5.864826917648315
Epoch: 4, Steps: 570 | Train Loss: 0.2179058 Vali Loss: 0.0635907 Test Loss: 0.1608318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1631806194782257, mae:0.26068833470344543
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1879944
	speed: 0.0226s/iter; left time: 255.0970s
	iters: 200, epoch: 1 | loss: 0.1874471
	speed: 0.0101s/iter; left time: 113.3831s
	iters: 300, epoch: 1 | loss: 0.2482666
	speed: 0.0099s/iter; left time: 110.1326s
	iters: 400, epoch: 1 | loss: 0.1488428
	speed: 0.0099s/iter; left time: 108.5883s
	iters: 500, epoch: 1 | loss: 0.1444412
	speed: 0.0098s/iter; left time: 107.3352s
Epoch: 1 cost time: 6.9548985958099365
Epoch: 1, Steps: 570 | Train Loss: 0.1682830 Vali Loss: 0.0436042 Test Loss: 0.1377011
Validation loss decreased (inf --> 0.043604).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1398871
	speed: 0.0349s/iter; left time: 374.0091s
	iters: 200, epoch: 2 | loss: 0.1850255
	speed: 0.0099s/iter; left time: 104.7994s
	iters: 300, epoch: 2 | loss: 0.1077379
	speed: 0.0098s/iter; left time: 103.3861s
	iters: 400, epoch: 2 | loss: 0.1096446
	speed: 0.0098s/iter; left time: 102.5993s
	iters: 500, epoch: 2 | loss: 0.2028266
	speed: 0.0098s/iter; left time: 101.4126s
Epoch: 2 cost time: 5.920338153839111
Epoch: 2, Steps: 570 | Train Loss: 0.1612543 Vali Loss: 0.0431032 Test Loss: 0.1407291
Validation loss decreased (0.043604 --> 0.043103).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0767745
	speed: 0.0347s/iter; left time: 352.1841s
	iters: 200, epoch: 3 | loss: 0.1207427
	speed: 0.0112s/iter; left time: 112.7991s
	iters: 300, epoch: 3 | loss: 0.2777740
	speed: 0.0112s/iter; left time: 111.9568s
	iters: 400, epoch: 3 | loss: 0.1337653
	speed: 0.0112s/iter; left time: 110.8008s
	iters: 500, epoch: 3 | loss: 0.1266848
	speed: 0.0112s/iter; left time: 109.7876s
Epoch: 3 cost time: 6.618976593017578
Epoch: 3, Steps: 570 | Train Loss: 0.1380364 Vali Loss: 0.0397742 Test Loss: 0.1264060
Validation loss decreased (0.043103 --> 0.039774).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0792852
	speed: 0.0360s/iter; left time: 345.4458s
	iters: 200, epoch: 4 | loss: 0.0799794
	speed: 0.0099s/iter; left time: 93.7976s
	iters: 300, epoch: 4 | loss: 0.0885246
	speed: 0.0099s/iter; left time: 92.6969s
	iters: 400, epoch: 4 | loss: 0.0728028
	speed: 0.0099s/iter; left time: 91.7547s
	iters: 500, epoch: 4 | loss: 0.1350426
	speed: 0.0099s/iter; left time: 90.8933s
Epoch: 4 cost time: 5.9707629680633545
Epoch: 4, Steps: 570 | Train Loss: 0.1146851 Vali Loss: 0.0357869 Test Loss: 0.1162586
Validation loss decreased (0.039774 --> 0.035787).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1119463
	speed: 0.0325s/iter; left time: 293.1011s
	iters: 200, epoch: 5 | loss: 0.1653396
	speed: 0.0098s/iter; left time: 87.1483s
	iters: 300, epoch: 5 | loss: 0.1019746
	speed: 0.0098s/iter; left time: 86.1653s
	iters: 400, epoch: 5 | loss: 0.1152093
	speed: 0.0098s/iter; left time: 85.1980s
	iters: 500, epoch: 5 | loss: 0.0985917
	speed: 0.0098s/iter; left time: 84.2455s
Epoch: 5 cost time: 5.77421760559082
Epoch: 5, Steps: 570 | Train Loss: 0.1009639 Vali Loss: 0.0364314 Test Loss: 0.1136684
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0581600
	speed: 0.0325s/iter; left time: 274.5205s
	iters: 200, epoch: 6 | loss: 0.1095032
	speed: 0.0098s/iter; left time: 81.8542s
	iters: 300, epoch: 6 | loss: 0.1278585
	speed: 0.0098s/iter; left time: 80.7805s
	iters: 400, epoch: 6 | loss: 0.0641890
	speed: 0.0098s/iter; left time: 79.9376s
	iters: 500, epoch: 6 | loss: 0.0766375
	speed: 0.0098s/iter; left time: 78.9274s
Epoch: 6 cost time: 5.876809597015381
Epoch: 6, Steps: 570 | Train Loss: 0.0925622 Vali Loss: 0.0370014 Test Loss: 0.1155212
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0849662
	speed: 0.0365s/iter; left time: 287.2691s
	iters: 200, epoch: 7 | loss: 0.0992069
	speed: 0.0114s/iter; left time: 88.4608s
	iters: 300, epoch: 7 | loss: 0.1484343
	speed: 0.0113s/iter; left time: 86.9833s
	iters: 400, epoch: 7 | loss: 0.1500152
	speed: 0.0113s/iter; left time: 85.9140s
	iters: 500, epoch: 7 | loss: 0.1286581
	speed: 0.0113s/iter; left time: 84.8957s
Epoch: 7 cost time: 6.679283380508423
Epoch: 7, Steps: 570 | Train Loss: 0.0875537 Vali Loss: 0.0360128 Test Loss: 0.1157063
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11642131209373474, mae:0.20923534035682678
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2429955
	speed: 0.0210s/iter; left time: 237.5884s
	iters: 200, epoch: 1 | loss: 0.1262257
	speed: 0.0097s/iter; left time: 109.0855s
	iters: 300, epoch: 1 | loss: 0.1267452
	speed: 0.0098s/iter; left time: 108.3424s
	iters: 400, epoch: 1 | loss: 0.1871254
	speed: 0.0097s/iter; left time: 107.2319s
	iters: 500, epoch: 1 | loss: 0.2177178
	speed: 0.0098s/iter; left time: 106.3435s
Epoch: 1 cost time: 6.726196050643921
Epoch: 1, Steps: 570 | Train Loss: 0.2265803 Vali Loss: 0.0527771 Test Loss: 0.1677906
Validation loss decreased (inf --> 0.052777).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1989672
	speed: 0.0345s/iter; left time: 370.3691s
	iters: 200, epoch: 2 | loss: 0.2996998
	speed: 0.0097s/iter; left time: 103.5929s
	iters: 300, epoch: 2 | loss: 0.1947185
	speed: 0.0097s/iter; left time: 102.4406s
	iters: 400, epoch: 2 | loss: 0.2522361
	speed: 0.0098s/iter; left time: 101.7210s
	iters: 500, epoch: 2 | loss: 0.2612756
	speed: 0.0097s/iter; left time: 100.5756s
Epoch: 2 cost time: 5.764389276504517
Epoch: 2, Steps: 570 | Train Loss: 0.2259816 Vali Loss: 0.0574514 Test Loss: 0.1699410
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1365477
	speed: 0.0331s/iter; left time: 336.5405s
	iters: 200, epoch: 3 | loss: 0.1770229
	speed: 0.0098s/iter; left time: 98.3457s
	iters: 300, epoch: 3 | loss: 0.2543505
	speed: 0.0098s/iter; left time: 97.5193s
	iters: 400, epoch: 3 | loss: 0.1783216
	speed: 0.0098s/iter; left time: 96.3296s
	iters: 500, epoch: 3 | loss: 0.1370625
	speed: 0.0098s/iter; left time: 95.3635s
Epoch: 3 cost time: 5.8141090869903564
Epoch: 3, Steps: 570 | Train Loss: 0.2107144 Vali Loss: 0.0469428 Test Loss: 0.1451066
Validation loss decreased (0.052777 --> 0.046943).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1333973
	speed: 0.0333s/iter; left time: 319.0624s
	iters: 200, epoch: 4 | loss: 0.0943953
	speed: 0.0097s/iter; left time: 92.0817s
	iters: 300, epoch: 4 | loss: 0.1297451
	speed: 0.0097s/iter; left time: 90.7225s
	iters: 400, epoch: 4 | loss: 0.2211343
	speed: 0.0097s/iter; left time: 89.7495s
	iters: 500, epoch: 4 | loss: 0.1433680
	speed: 0.0097s/iter; left time: 88.7410s
Epoch: 4 cost time: 5.73934268951416
Epoch: 4, Steps: 570 | Train Loss: 0.1749125 Vali Loss: 0.0473251 Test Loss: 0.1498124
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1313210
	speed: 0.0347s/iter; left time: 312.8310s
	iters: 200, epoch: 5 | loss: 0.1570131
	speed: 0.0097s/iter; left time: 86.5760s
	iters: 300, epoch: 5 | loss: 0.2370802
	speed: 0.0097s/iter; left time: 85.6548s
	iters: 400, epoch: 5 | loss: 0.1019689
	speed: 0.0097s/iter; left time: 84.5957s
	iters: 500, epoch: 5 | loss: 0.2425003
	speed: 0.0097s/iter; left time: 83.4581s
Epoch: 5 cost time: 5.737771034240723
Epoch: 5, Steps: 570 | Train Loss: 0.1612860 Vali Loss: 0.0438437 Test Loss: 0.1477919
Validation loss decreased (0.046943 --> 0.043844).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1151529
	speed: 0.0331s/iter; left time: 279.3732s
	iters: 200, epoch: 6 | loss: 0.1784842
	speed: 0.0097s/iter; left time: 80.7293s
	iters: 300, epoch: 6 | loss: 0.1698503
	speed: 0.0097s/iter; left time: 79.6698s
	iters: 400, epoch: 6 | loss: 0.1325180
	speed: 0.0097s/iter; left time: 78.7779s
	iters: 500, epoch: 6 | loss: 0.1904864
	speed: 0.0097s/iter; left time: 78.4857s
Epoch: 6 cost time: 5.744234561920166
Epoch: 6, Steps: 570 | Train Loss: 0.1502975 Vali Loss: 0.0432721 Test Loss: 0.1421744
Validation loss decreased (0.043844 --> 0.043272).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0912671
	speed: 0.0328s/iter; left time: 258.6680s
	iters: 200, epoch: 7 | loss: 0.1507141
	speed: 0.0097s/iter; left time: 75.4060s
	iters: 300, epoch: 7 | loss: 0.1111932
	speed: 0.0097s/iter; left time: 74.4711s
	iters: 400, epoch: 7 | loss: 0.0750316
	speed: 0.0097s/iter; left time: 73.5131s
	iters: 500, epoch: 7 | loss: 0.1784825
	speed: 0.0097s/iter; left time: 72.5437s
Epoch: 7 cost time: 5.749779224395752
Epoch: 7, Steps: 570 | Train Loss: 0.1443310 Vali Loss: 0.0433332 Test Loss: 0.1409613
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0878188
	speed: 0.0363s/iter; left time: 265.0254s
	iters: 200, epoch: 8 | loss: 0.1318479
	speed: 0.0103s/iter; left time: 74.2189s
	iters: 300, epoch: 8 | loss: 0.1270279
	speed: 0.0098s/iter; left time: 69.6035s
	iters: 400, epoch: 8 | loss: 0.1578188
	speed: 0.0097s/iter; left time: 68.2532s
	iters: 500, epoch: 8 | loss: 0.1500511
	speed: 0.0097s/iter; left time: 67.2541s
Epoch: 8 cost time: 5.964056730270386
Epoch: 8, Steps: 570 | Train Loss: 0.1401656 Vali Loss: 0.0427601 Test Loss: 0.1404220
Validation loss decreased (0.043272 --> 0.042760).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1381372
	speed: 0.0345s/iter; left time: 232.3346s
	iters: 200, epoch: 9 | loss: 0.1403579
	speed: 0.0097s/iter; left time: 64.2357s
	iters: 300, epoch: 9 | loss: 0.1187568
	speed: 0.0097s/iter; left time: 63.1746s
	iters: 400, epoch: 9 | loss: 0.0885384
	speed: 0.0097s/iter; left time: 62.2483s
	iters: 500, epoch: 9 | loss: 0.1417777
	speed: 0.0097s/iter; left time: 61.3291s
Epoch: 9 cost time: 5.726182699203491
Epoch: 9, Steps: 570 | Train Loss: 0.1382025 Vali Loss: 0.0433924 Test Loss: 0.1427714
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1171558
	speed: 0.0345s/iter; left time: 212.9772s
	iters: 200, epoch: 10 | loss: 0.1783067
	speed: 0.0097s/iter; left time: 59.1097s
	iters: 300, epoch: 10 | loss: 0.1544783
	speed: 0.0097s/iter; left time: 58.1312s
	iters: 400, epoch: 10 | loss: 0.1501161
	speed: 0.0098s/iter; left time: 57.2947s
	iters: 500, epoch: 10 | loss: 0.1953642
	speed: 0.0098s/iter; left time: 56.3105s
Epoch: 10 cost time: 5.791765928268433
Epoch: 10, Steps: 570 | Train Loss: 0.1372004 Vali Loss: 0.0433279 Test Loss: 0.1432870
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1529302
	speed: 0.0335s/iter; left time: 187.5239s
	iters: 200, epoch: 11 | loss: 0.1255644
	speed: 0.0097s/iter; left time: 53.3651s
	iters: 300, epoch: 11 | loss: 0.1809491
	speed: 0.0097s/iter; left time: 52.3711s
	iters: 400, epoch: 11 | loss: 0.1512925
	speed: 0.0097s/iter; left time: 51.3945s
	iters: 500, epoch: 11 | loss: 0.1629266
	speed: 0.0097s/iter; left time: 50.4634s
Epoch: 11 cost time: 5.7402119636535645
Epoch: 11, Steps: 570 | Train Loss: 0.1363042 Vali Loss: 0.0431477 Test Loss: 0.1432028
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1405969113111496, mae:0.24108478426933289
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2673554
	speed: 0.0231s/iter; left time: 261.5837s
	iters: 200, epoch: 1 | loss: 0.2358598
	speed: 0.0114s/iter; left time: 128.0445s
	iters: 300, epoch: 1 | loss: 0.1605896
	speed: 0.0114s/iter; left time: 126.9595s
	iters: 400, epoch: 1 | loss: 0.2092649
	speed: 0.0114s/iter; left time: 125.7232s
	iters: 500, epoch: 1 | loss: 0.3037598
	speed: 0.0114s/iter; left time: 124.5696s
Epoch: 1 cost time: 7.735670804977417
Epoch: 1, Steps: 570 | Train Loss: 0.2843307 Vali Loss: 0.0668196 Test Loss: 0.1870127
Validation loss decreased (inf --> 0.066820).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2432782
	speed: 0.0366s/iter; left time: 393.1873s
	iters: 200, epoch: 2 | loss: 0.1925197
	speed: 0.0114s/iter; left time: 121.3626s
	iters: 300, epoch: 2 | loss: 0.1782432
	speed: 0.0114s/iter; left time: 120.1133s
	iters: 400, epoch: 2 | loss: 0.1232579
	speed: 0.0114s/iter; left time: 119.0043s
	iters: 500, epoch: 2 | loss: 0.2400337
	speed: 0.0114s/iter; left time: 117.8198s
Epoch: 2 cost time: 6.749845266342163
Epoch: 2, Steps: 570 | Train Loss: 0.2810881 Vali Loss: 0.0608437 Test Loss: 0.1798609
Validation loss decreased (0.066820 --> 0.060844).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3295406
	speed: 0.0379s/iter; left time: 385.2246s
	iters: 200, epoch: 3 | loss: 0.4188828
	speed: 0.0125s/iter; left time: 125.8578s
	iters: 300, epoch: 3 | loss: 0.1578331
	speed: 0.0125s/iter; left time: 124.2030s
	iters: 400, epoch: 3 | loss: 0.2161615
	speed: 0.0124s/iter; left time: 122.7628s
	iters: 500, epoch: 3 | loss: 0.2143182
	speed: 0.0125s/iter; left time: 121.5414s
Epoch: 3 cost time: 7.360805034637451
Epoch: 3, Steps: 570 | Train Loss: 0.2520068 Vali Loss: 0.0636789 Test Loss: 0.1797697
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1728122
	speed: 0.0367s/iter; left time: 352.0598s
	iters: 200, epoch: 4 | loss: 0.2393166
	speed: 0.0115s/iter; left time: 109.1585s
	iters: 300, epoch: 4 | loss: 0.1626475
	speed: 0.0115s/iter; left time: 107.9873s
	iters: 400, epoch: 4 | loss: 0.1333545
	speed: 0.0115s/iter; left time: 106.5788s
	iters: 500, epoch: 4 | loss: 0.1654302
	speed: 0.0115s/iter; left time: 105.4602s
Epoch: 4 cost time: 6.779788017272949
Epoch: 4, Steps: 570 | Train Loss: 0.2222100 Vali Loss: 0.0608348 Test Loss: 0.1682695
Validation loss decreased (0.060844 --> 0.060835).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1581249
	speed: 0.0365s/iter; left time: 329.4255s
	iters: 200, epoch: 5 | loss: 0.1555440
	speed: 0.0114s/iter; left time: 101.6177s
	iters: 300, epoch: 5 | loss: 0.2902546
	speed: 0.0114s/iter; left time: 100.5844s
	iters: 400, epoch: 5 | loss: 0.1749023
	speed: 0.0114s/iter; left time: 99.4020s
	iters: 500, epoch: 5 | loss: 0.2035597
	speed: 0.0114s/iter; left time: 98.4659s
Epoch: 5 cost time: 6.7447168827056885
Epoch: 5, Steps: 570 | Train Loss: 0.2089508 Vali Loss: 0.0620068 Test Loss: 0.1694303
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1826471
	speed: 0.0367s/iter; left time: 310.5705s
	iters: 200, epoch: 6 | loss: 0.1136283
	speed: 0.0114s/iter; left time: 95.4310s
	iters: 300, epoch: 6 | loss: 0.2019654
	speed: 0.0114s/iter; left time: 94.1900s
	iters: 400, epoch: 6 | loss: 0.1772547
	speed: 0.0114s/iter; left time: 93.1046s
	iters: 500, epoch: 6 | loss: 0.1489908
	speed: 0.0114s/iter; left time: 91.8281s
Epoch: 6 cost time: 6.737531661987305
Epoch: 6, Steps: 570 | Train Loss: 0.2033361 Vali Loss: 0.0616341 Test Loss: 0.1669102
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2622835
	speed: 0.0361s/iter; left time: 284.3210s
	iters: 200, epoch: 7 | loss: 0.2151243
	speed: 0.0115s/iter; left time: 89.1354s
	iters: 300, epoch: 7 | loss: 0.2167960
	speed: 0.0115s/iter; left time: 88.0449s
	iters: 400, epoch: 7 | loss: 0.1562091
	speed: 0.0115s/iter; left time: 86.9290s
	iters: 500, epoch: 7 | loss: 0.2143835
	speed: 0.0114s/iter; left time: 85.6479s
Epoch: 7 cost time: 6.75153112411499
Epoch: 7, Steps: 570 | Train Loss: 0.1996851 Vali Loss: 0.0609210 Test Loss: 0.1667071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1685466766357422, mae:0.27037519216537476
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1208526
	speed: 0.0236s/iter; left time: 267.0632s
	iters: 200, epoch: 1 | loss: 0.2859458
	speed: 0.0114s/iter; left time: 127.9504s
	iters: 300, epoch: 1 | loss: 0.1719414
	speed: 0.0110s/iter; left time: 122.3893s
	iters: 400, epoch: 1 | loss: 0.2156864
	speed: 0.0110s/iter; left time: 121.2770s
	iters: 500, epoch: 1 | loss: 0.1559027
	speed: 0.0110s/iter; left time: 120.2797s
Epoch: 1 cost time: 7.6299285888671875
Epoch: 1, Steps: 570 | Train Loss: 0.2086973 Vali Loss: 0.0515904 Test Loss: 0.1532065
Validation loss decreased (inf --> 0.051590).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2164857
	speed: 0.0361s/iter; left time: 387.5033s
	iters: 200, epoch: 2 | loss: 0.1621193
	speed: 0.0111s/iter; left time: 117.6473s
	iters: 300, epoch: 2 | loss: 0.2461625
	speed: 0.0111s/iter; left time: 116.7843s
	iters: 400, epoch: 2 | loss: 0.3248372
	speed: 0.0111s/iter; left time: 115.5855s
	iters: 500, epoch: 2 | loss: 0.3872446
	speed: 0.0111s/iter; left time: 114.4761s
Epoch: 2 cost time: 6.553614616394043
Epoch: 2, Steps: 570 | Train Loss: 0.2381216 Vali Loss: 0.0526147 Test Loss: 0.1589930
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2298876
	speed: 0.0374s/iter; left time: 379.6254s
	iters: 200, epoch: 3 | loss: 0.0892347
	speed: 0.0120s/iter; left time: 120.6324s
	iters: 300, epoch: 3 | loss: 0.2041319
	speed: 0.0119s/iter; left time: 119.0321s
	iters: 400, epoch: 3 | loss: 0.2050402
	speed: 0.0119s/iter; left time: 117.6313s
	iters: 500, epoch: 3 | loss: 0.2003963
	speed: 0.0120s/iter; left time: 117.0341s
Epoch: 3 cost time: 7.035787343978882
Epoch: 3, Steps: 570 | Train Loss: 0.1838980 Vali Loss: 0.0454281 Test Loss: 0.1411109
Validation loss decreased (0.051590 --> 0.045428).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1862133
	speed: 0.0388s/iter; left time: 372.2845s
	iters: 200, epoch: 4 | loss: 0.1526703
	speed: 0.0111s/iter; left time: 105.2885s
	iters: 300, epoch: 4 | loss: 0.0859537
	speed: 0.0111s/iter; left time: 104.1985s
	iters: 400, epoch: 4 | loss: 0.1531971
	speed: 0.0111s/iter; left time: 103.0892s
	iters: 500, epoch: 4 | loss: 0.1257672
	speed: 0.0111s/iter; left time: 102.0762s
Epoch: 4 cost time: 6.581146001815796
Epoch: 4, Steps: 570 | Train Loss: 0.1588286 Vali Loss: 0.0467338 Test Loss: 0.1424807
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1165126
	speed: 0.0376s/iter; left time: 339.0539s
	iters: 200, epoch: 5 | loss: 0.1202716
	speed: 0.0116s/iter; left time: 103.1735s
	iters: 300, epoch: 5 | loss: 0.1846251
	speed: 0.0111s/iter; left time: 97.9644s
	iters: 400, epoch: 5 | loss: 0.1324604
	speed: 0.0111s/iter; left time: 96.9412s
	iters: 500, epoch: 5 | loss: 0.1090243
	speed: 0.0111s/iter; left time: 95.8799s
Epoch: 5 cost time: 6.692414045333862
Epoch: 5, Steps: 570 | Train Loss: 0.1417700 Vali Loss: 0.0407827 Test Loss: 0.1379961
Validation loss decreased (0.045428 --> 0.040783).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1700202
	speed: 0.0371s/iter; left time: 313.5736s
	iters: 200, epoch: 6 | loss: 0.1496533
	speed: 0.0110s/iter; left time: 92.1254s
	iters: 300, epoch: 6 | loss: 0.0920784
	speed: 0.0110s/iter; left time: 91.0524s
	iters: 400, epoch: 6 | loss: 0.0841550
	speed: 0.0110s/iter; left time: 90.0602s
	iters: 500, epoch: 6 | loss: 0.1100778
	speed: 0.0110s/iter; left time: 88.7976s
Epoch: 6 cost time: 6.540194034576416
Epoch: 6, Steps: 570 | Train Loss: 0.1324151 Vali Loss: 0.0401964 Test Loss: 0.1361016
Validation loss decreased (0.040783 --> 0.040196).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0873016
	speed: 0.0383s/iter; left time: 302.0633s
	iters: 200, epoch: 7 | loss: 0.1881062
	speed: 0.0121s/iter; left time: 94.2573s
	iters: 300, epoch: 7 | loss: 0.1087534
	speed: 0.0122s/iter; left time: 93.3399s
	iters: 400, epoch: 7 | loss: 0.1095457
	speed: 0.0114s/iter; left time: 86.6650s
	iters: 500, epoch: 7 | loss: 0.0909741
	speed: 0.0111s/iter; left time: 82.9269s
Epoch: 7 cost time: 6.922253608703613
Epoch: 7, Steps: 570 | Train Loss: 0.1267670 Vali Loss: 0.0402969 Test Loss: 0.1349403
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1074128
	speed: 0.0351s/iter; left time: 256.3502s
	iters: 200, epoch: 8 | loss: 0.1466217
	speed: 0.0111s/iter; left time: 79.7917s
	iters: 300, epoch: 8 | loss: 0.1092096
	speed: 0.0111s/iter; left time: 78.6658s
	iters: 400, epoch: 8 | loss: 0.0924052
	speed: 0.0111s/iter; left time: 77.5522s
	iters: 500, epoch: 8 | loss: 0.1204413
	speed: 0.0111s/iter; left time: 76.4513s
Epoch: 8 cost time: 6.542129993438721
Epoch: 8, Steps: 570 | Train Loss: 0.1230836 Vali Loss: 0.0399046 Test Loss: 0.1353944
Validation loss decreased (0.040196 --> 0.039905).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1407759
	speed: 0.0366s/iter; left time: 247.0140s
	iters: 200, epoch: 9 | loss: 0.0852659
	speed: 0.0116s/iter; left time: 77.3643s
	iters: 300, epoch: 9 | loss: 0.1555552
	speed: 0.0121s/iter; left time: 79.1813s
	iters: 400, epoch: 9 | loss: 0.1433156
	speed: 0.0121s/iter; left time: 77.9629s
	iters: 500, epoch: 9 | loss: 0.1607147
	speed: 0.0121s/iter; left time: 76.7952s
Epoch: 9 cost time: 7.051724195480347
Epoch: 9, Steps: 570 | Train Loss: 0.1213381 Vali Loss: 0.0391797 Test Loss: 0.1352211
Validation loss decreased (0.039905 --> 0.039180).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1191340
	speed: 0.0368s/iter; left time: 227.1956s
	iters: 200, epoch: 10 | loss: 0.0910964
	speed: 0.0111s/iter; left time: 67.0883s
	iters: 300, epoch: 10 | loss: 0.1056505
	speed: 0.0111s/iter; left time: 65.9846s
	iters: 400, epoch: 10 | loss: 0.1334907
	speed: 0.0111s/iter; left time: 64.9160s
	iters: 500, epoch: 10 | loss: 0.1398455
	speed: 0.0111s/iter; left time: 63.7950s
Epoch: 10 cost time: 6.5347840785980225
Epoch: 10, Steps: 570 | Train Loss: 0.1202429 Vali Loss: 0.0395060 Test Loss: 0.1355136
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.0820738
	speed: 0.0357s/iter; left time: 199.8266s
	iters: 200, epoch: 11 | loss: 0.0953467
	speed: 0.0111s/iter; left time: 60.9338s
	iters: 300, epoch: 11 | loss: 0.1034635
	speed: 0.0111s/iter; left time: 59.8571s
	iters: 400, epoch: 11 | loss: 0.1124705
	speed: 0.0111s/iter; left time: 58.9121s
	iters: 500, epoch: 11 | loss: 0.1682471
	speed: 0.0111s/iter; left time: 57.7273s
Epoch: 11 cost time: 6.554744243621826
Epoch: 11, Steps: 570 | Train Loss: 0.1195659 Vali Loss: 0.0396204 Test Loss: 0.1359874
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1432239
	speed: 0.0380s/iter; left time: 191.3159s
	iters: 200, epoch: 12 | loss: 0.0984666
	speed: 0.0121s/iter; left time: 59.6910s
	iters: 300, epoch: 12 | loss: 0.0857073
	speed: 0.0121s/iter; left time: 58.5361s
	iters: 400, epoch: 12 | loss: 0.1472204
	speed: 0.0121s/iter; left time: 57.3473s
	iters: 500, epoch: 12 | loss: 0.1346401
	speed: 0.0121s/iter; left time: 56.0539s
Epoch: 12 cost time: 7.154144763946533
Epoch: 12, Steps: 570 | Train Loss: 0.1190357 Vali Loss: 0.0397651 Test Loss: 0.1360321
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13543544709682465, mae:0.23163580894470215
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2081373
	speed: 0.0219s/iter; left time: 247.9061s
	iters: 200, epoch: 1 | loss: 0.3531043
	speed: 0.0103s/iter; left time: 114.9837s
	iters: 300, epoch: 1 | loss: 0.3283095
	speed: 0.0103s/iter; left time: 114.3498s
	iters: 400, epoch: 1 | loss: 0.2961910
	speed: 0.0103s/iter; left time: 113.1692s
	iters: 500, epoch: 1 | loss: 0.2852784
	speed: 0.0103s/iter; left time: 112.0970s
Epoch: 1 cost time: 7.066309452056885
Epoch: 1, Steps: 570 | Train Loss: 0.2701385 Vali Loss: 0.0734769 Test Loss: 0.2123958
Validation loss decreased (inf --> 0.073477).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2973227
	speed: 0.0356s/iter; left time: 381.9123s
	iters: 200, epoch: 2 | loss: 0.2906811
	speed: 0.0103s/iter; left time: 109.7761s
	iters: 300, epoch: 2 | loss: 0.1953369
	speed: 0.0103s/iter; left time: 108.7747s
	iters: 400, epoch: 2 | loss: 0.2043611
	speed: 0.0104s/iter; left time: 108.0218s
	iters: 500, epoch: 2 | loss: 0.2483530
	speed: 0.0103s/iter; left time: 106.7987s
Epoch: 2 cost time: 6.131552457809448
Epoch: 2, Steps: 570 | Train Loss: 0.2728299 Vali Loss: 0.0679701 Test Loss: 0.1997746
Validation loss decreased (0.073477 --> 0.067970).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1554442
	speed: 0.0371s/iter; left time: 377.0280s
	iters: 200, epoch: 3 | loss: 0.1863188
	speed: 0.0114s/iter; left time: 115.1063s
	iters: 300, epoch: 3 | loss: 0.2836081
	speed: 0.0115s/iter; left time: 114.1072s
	iters: 400, epoch: 3 | loss: 0.2544675
	speed: 0.0112s/iter; left time: 110.9334s
	iters: 500, epoch: 3 | loss: 0.2589924
	speed: 0.0111s/iter; left time: 108.7125s
Epoch: 3 cost time: 6.644105911254883
Epoch: 3, Steps: 570 | Train Loss: 0.2451306 Vali Loss: 0.0637612 Test Loss: 0.1744619
Validation loss decreased (0.067970 --> 0.063761).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2316469
	speed: 0.0366s/iter; left time: 350.5918s
	iters: 200, epoch: 4 | loss: 0.1120871
	speed: 0.0104s/iter; left time: 98.4399s
	iters: 300, epoch: 4 | loss: 0.2192818
	speed: 0.0103s/iter; left time: 97.0587s
	iters: 400, epoch: 4 | loss: 0.3106847
	speed: 0.0104s/iter; left time: 96.1759s
	iters: 500, epoch: 4 | loss: 0.2026028
	speed: 0.0104s/iter; left time: 95.1642s
Epoch: 4 cost time: 6.153026580810547
Epoch: 4, Steps: 570 | Train Loss: 0.2175378 Vali Loss: 0.0593487 Test Loss: 0.1607444
Validation loss decreased (0.063761 --> 0.059349).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1770361
	speed: 0.0351s/iter; left time: 316.7171s
	iters: 200, epoch: 5 | loss: 0.1810164
	speed: 0.0104s/iter; left time: 92.5908s
	iters: 300, epoch: 5 | loss: 0.2119149
	speed: 0.0104s/iter; left time: 91.3285s
	iters: 400, epoch: 5 | loss: 0.1309484
	speed: 0.0104s/iter; left time: 90.4534s
	iters: 500, epoch: 5 | loss: 0.2969440
	speed: 0.0104s/iter; left time: 89.2276s
Epoch: 5 cost time: 6.152244329452515
Epoch: 5, Steps: 570 | Train Loss: 0.1965188 Vali Loss: 0.0559909 Test Loss: 0.1539086
Validation loss decreased (0.059349 --> 0.055991).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1419153
	speed: 0.0367s/iter; left time: 309.8364s
	iters: 200, epoch: 6 | loss: 0.1659421
	speed: 0.0113s/iter; left time: 94.2184s
	iters: 300, epoch: 6 | loss: 0.2197290
	speed: 0.0112s/iter; left time: 92.3898s
	iters: 400, epoch: 6 | loss: 0.1411058
	speed: 0.0104s/iter; left time: 84.7576s
	iters: 500, epoch: 6 | loss: 0.1455500
	speed: 0.0104s/iter; left time: 83.6682s
Epoch: 6 cost time: 6.459191560745239
Epoch: 6, Steps: 570 | Train Loss: 0.1863750 Vali Loss: 0.0566236 Test Loss: 0.1557629
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1294671
	speed: 0.0351s/iter; left time: 276.8662s
	iters: 200, epoch: 7 | loss: 0.1749182
	speed: 0.0104s/iter; left time: 80.7424s
	iters: 300, epoch: 7 | loss: 0.1338294
	speed: 0.0104s/iter; left time: 79.7072s
	iters: 400, epoch: 7 | loss: 0.2332579
	speed: 0.0104s/iter; left time: 78.5182s
	iters: 500, epoch: 7 | loss: 0.1354468
	speed: 0.0104s/iter; left time: 77.6445s
Epoch: 7 cost time: 6.158773899078369
Epoch: 7, Steps: 570 | Train Loss: 0.1792891 Vali Loss: 0.0548309 Test Loss: 0.1546936
Validation loss decreased (0.055991 --> 0.054831).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1518206
	speed: 0.0357s/iter; left time: 261.3381s
	iters: 200, epoch: 8 | loss: 0.2262946
	speed: 0.0104s/iter; left time: 74.6587s
	iters: 300, epoch: 8 | loss: 0.2203848
	speed: 0.0103s/iter; left time: 73.4322s
	iters: 400, epoch: 8 | loss: 0.1756611
	speed: 0.0103s/iter; left time: 72.4085s
	iters: 500, epoch: 8 | loss: 0.1367280
	speed: 0.0103s/iter; left time: 71.3309s
Epoch: 8 cost time: 6.1276562213897705
Epoch: 8, Steps: 570 | Train Loss: 0.1763261 Vali Loss: 0.0542998 Test Loss: 0.1541872
Validation loss decreased (0.054831 --> 0.054300).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1023468
	speed: 0.0350s/iter; left time: 235.7364s
	iters: 200, epoch: 9 | loss: 0.1155551
	speed: 0.0104s/iter; left time: 68.9528s
	iters: 300, epoch: 9 | loss: 0.2510663
	speed: 0.0104s/iter; left time: 67.9867s
	iters: 400, epoch: 9 | loss: 0.2702790
	speed: 0.0104s/iter; left time: 66.9858s
	iters: 500, epoch: 9 | loss: 0.0944196
	speed: 0.0104s/iter; left time: 65.8844s
Epoch: 9 cost time: 6.163362503051758
Epoch: 9, Steps: 570 | Train Loss: 0.1741916 Vali Loss: 0.0551400 Test Loss: 0.1549536
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2340378
	speed: 0.0351s/iter; left time: 216.4858s
	iters: 200, epoch: 10 | loss: 0.0925931
	speed: 0.0114s/iter; left time: 69.3875s
	iters: 300, epoch: 10 | loss: 0.1878417
	speed: 0.0114s/iter; left time: 68.2264s
	iters: 400, epoch: 10 | loss: 0.0969002
	speed: 0.0114s/iter; left time: 67.1188s
	iters: 500, epoch: 10 | loss: 0.1904809
	speed: 0.0114s/iter; left time: 65.9349s
Epoch: 10 cost time: 6.741227865219116
Epoch: 10, Steps: 570 | Train Loss: 0.1730067 Vali Loss: 0.0548287 Test Loss: 0.1543280
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1151982
	speed: 0.0355s/iter; left time: 198.8272s
	iters: 200, epoch: 11 | loss: 0.1987495
	speed: 0.0103s/iter; left time: 56.5897s
	iters: 300, epoch: 11 | loss: 0.1097980
	speed: 0.0103s/iter; left time: 55.7925s
	iters: 400, epoch: 11 | loss: 0.1088090
	speed: 0.0103s/iter; left time: 54.8008s
	iters: 500, epoch: 11 | loss: 0.1258720
	speed: 0.0103s/iter; left time: 53.6374s
Epoch: 11 cost time: 6.105431318283081
Epoch: 11, Steps: 570 | Train Loss: 0.1726455 Vali Loss: 0.0548595 Test Loss: 0.1545657
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15438935160636902, mae:0.2481307089328766
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1910524
	speed: 0.0254s/iter; left time: 287.1595s
	iters: 200, epoch: 1 | loss: 0.1724668
	speed: 0.0139s/iter; left time: 155.2723s
	iters: 300, epoch: 1 | loss: 0.2917525
	speed: 0.0139s/iter; left time: 153.8870s
	iters: 400, epoch: 1 | loss: 0.1924879
	speed: 0.0139s/iter; left time: 152.5495s
	iters: 500, epoch: 1 | loss: 0.1730633
	speed: 0.0139s/iter; left time: 151.2350s
Epoch: 1 cost time: 9.104316473007202
Epoch: 1, Steps: 570 | Train Loss: 0.2224579 Vali Loss: 0.0565231 Test Loss: 0.1590333
Validation loss decreased (inf --> 0.056523).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2762584
	speed: 0.0442s/iter; left time: 474.0393s
	iters: 200, epoch: 2 | loss: 0.2946938
	speed: 0.0139s/iter; left time: 147.8919s
	iters: 300, epoch: 2 | loss: 0.2403137
	speed: 0.0139s/iter; left time: 146.7038s
	iters: 400, epoch: 2 | loss: 0.2267851
	speed: 0.0139s/iter; left time: 145.1629s
	iters: 500, epoch: 2 | loss: 0.3126200
	speed: 0.0139s/iter; left time: 143.7732s
Epoch: 2 cost time: 8.185847520828247
Epoch: 2, Steps: 570 | Train Loss: 0.2804122 Vali Loss: 0.0803362 Test Loss: 0.2180425
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4174822
	speed: 0.0435s/iter; left time: 441.7827s
	iters: 200, epoch: 3 | loss: 0.3376241
	speed: 0.0138s/iter; left time: 139.1182s
	iters: 300, epoch: 3 | loss: 0.1651516
	speed: 0.0138s/iter; left time: 137.4213s
	iters: 400, epoch: 3 | loss: 0.2693733
	speed: 0.0138s/iter; left time: 135.9736s
	iters: 500, epoch: 3 | loss: 0.2479194
	speed: 0.0138s/iter; left time: 134.5453s
Epoch: 3 cost time: 8.086046695709229
Epoch: 3, Steps: 570 | Train Loss: 0.2874916 Vali Loss: 0.0774770 Test Loss: 0.1967589
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2508566
	speed: 0.0478s/iter; left time: 458.2956s
	iters: 200, epoch: 4 | loss: 0.2272388
	speed: 0.0155s/iter; left time: 147.3812s
	iters: 300, epoch: 4 | loss: 0.2643112
	speed: 0.0154s/iter; left time: 144.9778s
	iters: 400, epoch: 4 | loss: 0.2609861
	speed: 0.0138s/iter; left time: 127.9217s
	iters: 500, epoch: 4 | loss: 0.2996611
	speed: 0.0137s/iter; left time: 126.3400s
Epoch: 4 cost time: 8.619013547897339
Epoch: 4, Steps: 570 | Train Loss: 0.2648740 Vali Loss: 0.0613281 Test Loss: 0.1687082
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1592792421579361, mae:0.2639329433441162
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2919293
	speed: 0.0250s/iter; left time: 282.8792s
	iters: 200, epoch: 1 | loss: 0.1859017
	speed: 0.0134s/iter; left time: 150.3004s
	iters: 300, epoch: 1 | loss: 0.1094763
	speed: 0.0134s/iter; left time: 148.6813s
	iters: 400, epoch: 1 | loss: 0.2039593
	speed: 0.0134s/iter; left time: 147.2777s
	iters: 500, epoch: 1 | loss: 0.2330858
	speed: 0.0134s/iter; left time: 146.3428s
Epoch: 1 cost time: 8.855769634246826
Epoch: 1, Steps: 570 | Train Loss: 0.1849884 Vali Loss: 0.0479409 Test Loss: 0.1547139
Validation loss decreased (inf --> 0.047941).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1143082
	speed: 0.0429s/iter; left time: 460.1821s
	iters: 200, epoch: 2 | loss: 0.3537095
	speed: 0.0134s/iter; left time: 142.3710s
	iters: 300, epoch: 2 | loss: 0.3505127
	speed: 0.0134s/iter; left time: 141.2168s
	iters: 400, epoch: 2 | loss: 0.2553155
	speed: 0.0134s/iter; left time: 139.7414s
	iters: 500, epoch: 2 | loss: 0.2997040
	speed: 0.0134s/iter; left time: 137.9657s
Epoch: 2 cost time: 7.882343292236328
Epoch: 2, Steps: 570 | Train Loss: 0.2630000 Vali Loss: 0.0724070 Test Loss: 0.1898956
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2477942
	speed: 0.0433s/iter; left time: 440.2343s
	iters: 200, epoch: 3 | loss: 0.1261086
	speed: 0.0133s/iter; left time: 134.0534s
	iters: 300, epoch: 3 | loss: 0.2619452
	speed: 0.0140s/iter; left time: 139.9117s
	iters: 400, epoch: 3 | loss: 0.1103649
	speed: 0.0139s/iter; left time: 136.8608s
	iters: 500, epoch: 3 | loss: 0.2083330
	speed: 0.0133s/iter; left time: 130.0145s
Epoch: 3 cost time: 8.148589611053467
Epoch: 3, Steps: 570 | Train Loss: 0.2439919 Vali Loss: 0.0668979 Test Loss: 0.1739569
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1651082
	speed: 0.0463s/iter; left time: 443.8706s
	iters: 200, epoch: 4 | loss: 0.2440787
	speed: 0.0133s/iter; left time: 126.6991s
	iters: 300, epoch: 4 | loss: 0.3100405
	speed: 0.0134s/iter; left time: 125.4229s
	iters: 400, epoch: 4 | loss: 0.1410217
	speed: 0.0133s/iter; left time: 123.7789s
	iters: 500, epoch: 4 | loss: 0.1318116
	speed: 0.0133s/iter; left time: 122.6159s
Epoch: 4 cost time: 7.838792324066162
Epoch: 4, Steps: 570 | Train Loss: 0.2142600 Vali Loss: 0.0600810 Test Loss: 0.1641871
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1549413502216339, mae:0.2512667179107666
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1190500
	speed: 0.0269s/iter; left time: 304.5462s
	iters: 200, epoch: 1 | loss: 0.3118449
	speed: 0.0151s/iter; left time: 169.1396s
	iters: 300, epoch: 1 | loss: 0.3297839
	speed: 0.0151s/iter; left time: 167.9098s
	iters: 400, epoch: 1 | loss: 0.2602028
	speed: 0.0151s/iter; left time: 166.1699s
	iters: 500, epoch: 1 | loss: 0.2521578
	speed: 0.0149s/iter; left time: 162.1804s
Epoch: 1 cost time: 9.710272550582886
Epoch: 1, Steps: 570 | Train Loss: 0.2388101 Vali Loss: 0.0638805 Test Loss: 0.1876526
Validation loss decreased (inf --> 0.063880).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2265279
	speed: 0.0433s/iter; left time: 464.3182s
	iters: 200, epoch: 2 | loss: 0.1576295
	speed: 0.0135s/iter; left time: 143.6059s
	iters: 300, epoch: 2 | loss: 0.1770525
	speed: 0.0135s/iter; left time: 142.2828s
	iters: 400, epoch: 2 | loss: 0.2324228
	speed: 0.0135s/iter; left time: 140.7320s
	iters: 500, epoch: 2 | loss: 0.3294505
	speed: 0.0135s/iter; left time: 139.2526s
Epoch: 2 cost time: 7.94345498085022
Epoch: 2, Steps: 570 | Train Loss: 0.2661254 Vali Loss: 0.0713454 Test Loss: 0.1848145
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2670662
	speed: 0.0440s/iter; left time: 446.5930s
	iters: 200, epoch: 3 | loss: 0.2732421
	speed: 0.0135s/iter; left time: 135.9631s
	iters: 300, epoch: 3 | loss: 0.2004428
	speed: 0.0135s/iter; left time: 134.5322s
	iters: 400, epoch: 3 | loss: 0.1749303
	speed: 0.0135s/iter; left time: 133.2497s
	iters: 500, epoch: 3 | loss: 0.2124099
	speed: 0.0135s/iter; left time: 131.3149s
Epoch: 3 cost time: 8.045276403427124
Epoch: 3, Steps: 570 | Train Loss: 0.2391176 Vali Loss: 0.0647277 Test Loss: 0.1720510
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2196204
	speed: 0.0459s/iter; left time: 439.8856s
	iters: 200, epoch: 4 | loss: 0.1945581
	speed: 0.0156s/iter; left time: 147.9151s
	iters: 300, epoch: 4 | loss: 0.1817180
	speed: 0.0156s/iter; left time: 146.3598s
	iters: 400, epoch: 4 | loss: 0.1947605
	speed: 0.0156s/iter; left time: 144.6849s
	iters: 500, epoch: 4 | loss: 0.1333836
	speed: 0.0156s/iter; left time: 143.3818s
Epoch: 4 cost time: 9.005319356918335
Epoch: 4, Steps: 570 | Train Loss: 0.2129358 Vali Loss: 0.0605438 Test Loss: 0.1664300
Validation loss decreased (0.063880 --> 0.060544).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1738715
	speed: 0.0464s/iter; left time: 418.1358s
	iters: 200, epoch: 5 | loss: 0.2195346
	speed: 0.0155s/iter; left time: 138.0778s
	iters: 300, epoch: 5 | loss: 0.1826030
	speed: 0.0155s/iter; left time: 136.6323s
	iters: 400, epoch: 5 | loss: 0.2756516
	speed: 0.0155s/iter; left time: 135.3275s
	iters: 500, epoch: 5 | loss: 0.1223429
	speed: 0.0155s/iter; left time: 133.8109s
Epoch: 5 cost time: 9.087207555770874
Epoch: 5, Steps: 570 | Train Loss: 0.1918286 Vali Loss: 0.0575880 Test Loss: 0.1577104
Validation loss decreased (0.060544 --> 0.057588).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2719165
	speed: 0.0461s/iter; left time: 389.6876s
	iters: 200, epoch: 6 | loss: 0.1927407
	speed: 0.0156s/iter; left time: 129.9493s
	iters: 300, epoch: 6 | loss: 0.0962062
	speed: 0.0156s/iter; left time: 128.4204s
	iters: 400, epoch: 6 | loss: 0.2174937
	speed: 0.0156s/iter; left time: 126.8108s
	iters: 500, epoch: 6 | loss: 0.1846272
	speed: 0.0156s/iter; left time: 125.3126s
Epoch: 6 cost time: 9.10450530052185
Epoch: 6, Steps: 570 | Train Loss: 0.1781630 Vali Loss: 0.0573460 Test Loss: 0.1543588
Validation loss decreased (0.057588 --> 0.057346).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1491029
	speed: 0.0480s/iter; left time: 378.4794s
	iters: 200, epoch: 7 | loss: 0.0993516
	speed: 0.0155s/iter; left time: 120.5697s
	iters: 300, epoch: 7 | loss: 0.1379019
	speed: 0.0155s/iter; left time: 119.0457s
	iters: 400, epoch: 7 | loss: 0.2205217
	speed: 0.0155s/iter; left time: 117.4967s
	iters: 500, epoch: 7 | loss: 0.1336048
	speed: 0.0155s/iter; left time: 115.9590s
Epoch: 7 cost time: 9.090817928314209
Epoch: 7, Steps: 570 | Train Loss: 0.1709848 Vali Loss: 0.0576333 Test Loss: 0.1552133
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1184507
	speed: 0.0463s/iter; left time: 338.7966s
	iters: 200, epoch: 8 | loss: 0.1265137
	speed: 0.0135s/iter; left time: 97.1527s
	iters: 300, epoch: 8 | loss: 0.1915678
	speed: 0.0135s/iter; left time: 95.7793s
	iters: 400, epoch: 8 | loss: 0.2026834
	speed: 0.0135s/iter; left time: 94.3853s
	iters: 500, epoch: 8 | loss: 0.1000716
	speed: 0.0135s/iter; left time: 93.0867s
Epoch: 8 cost time: 8.069302558898926
Epoch: 8, Steps: 570 | Train Loss: 0.1666280 Vali Loss: 0.0592988 Test Loss: 0.1568683
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1650104
	speed: 0.0429s/iter; left time: 289.3531s
	iters: 200, epoch: 9 | loss: 0.1470891
	speed: 0.0134s/iter; left time: 89.1130s
	iters: 300, epoch: 9 | loss: 0.1308380
	speed: 0.0134s/iter; left time: 87.7531s
	iters: 400, epoch: 9 | loss: 0.1730627
	speed: 0.0155s/iter; left time: 99.8005s
	iters: 500, epoch: 9 | loss: 0.1253441
	speed: 0.0155s/iter; left time: 98.3577s
Epoch: 9 cost time: 8.44125509262085
Epoch: 9, Steps: 570 | Train Loss: 0.1645545 Vali Loss: 0.0580829 Test Loss: 0.1555741
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15459345281124115, mae:0.2520411014556885
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2702464
	speed: 0.0284s/iter; left time: 321.3471s
	iters: 200, epoch: 1 | loss: 0.2674955
	speed: 0.0164s/iter; left time: 183.5208s
	iters: 300, epoch: 1 | loss: 0.3488625
	speed: 0.0163s/iter; left time: 181.1784s
	iters: 400, epoch: 1 | loss: 0.2293683
	speed: 0.0163s/iter; left time: 179.7220s
	iters: 500, epoch: 1 | loss: 0.2553122
	speed: 0.0163s/iter; left time: 178.1441s
Epoch: 1 cost time: 10.576723575592041
Epoch: 1, Steps: 570 | Train Loss: 0.3194285 Vali Loss: 0.0671749 Test Loss: 0.1898966
Validation loss decreased (inf --> 0.067175).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3389419
	speed: 0.0485s/iter; left time: 520.1703s
	iters: 200, epoch: 2 | loss: 0.3397476
	speed: 0.0163s/iter; left time: 173.2533s
	iters: 300, epoch: 2 | loss: 0.3092797
	speed: 0.0163s/iter; left time: 171.4726s
	iters: 400, epoch: 2 | loss: 0.2053859
	speed: 0.0163s/iter; left time: 169.8084s
	iters: 500, epoch: 2 | loss: 0.2841223
	speed: 0.0163s/iter; left time: 168.8500s
Epoch: 2 cost time: 9.542523860931396
Epoch: 2, Steps: 570 | Train Loss: 0.2695681 Vali Loss: 0.0684227 Test Loss: 0.1898351
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2059644
	speed: 0.0478s/iter; left time: 486.1042s
	iters: 200, epoch: 3 | loss: 0.2477117
	speed: 0.0164s/iter; left time: 165.0489s
	iters: 300, epoch: 3 | loss: 0.3639211
	speed: 0.0164s/iter; left time: 162.9861s
	iters: 400, epoch: 3 | loss: 0.2139793
	speed: 0.0163s/iter; left time: 160.7393s
	iters: 500, epoch: 3 | loss: 0.2109823
	speed: 0.0164s/iter; left time: 159.8019s
Epoch: 3 cost time: 9.583325147628784
Epoch: 3, Steps: 570 | Train Loss: 0.2380238 Vali Loss: 0.0639201 Test Loss: 0.1737082
Validation loss decreased (0.067175 --> 0.063920).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2504411
	speed: 0.0485s/iter; left time: 464.8567s
	iters: 200, epoch: 4 | loss: 0.1834994
	speed: 0.0164s/iter; left time: 155.3344s
	iters: 300, epoch: 4 | loss: 0.2105092
	speed: 0.0163s/iter; left time: 153.4297s
	iters: 400, epoch: 4 | loss: 0.2755169
	speed: 0.0163s/iter; left time: 151.6705s
	iters: 500, epoch: 4 | loss: 0.2003397
	speed: 0.0163s/iter; left time: 150.2000s
Epoch: 4 cost time: 9.569450855255127
Epoch: 4, Steps: 570 | Train Loss: 0.2210738 Vali Loss: 0.0653202 Test Loss: 0.1676902
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1212686
	speed: 0.0478s/iter; left time: 431.3858s
	iters: 200, epoch: 5 | loss: 0.2460476
	speed: 0.0163s/iter; left time: 145.4298s
	iters: 300, epoch: 5 | loss: 0.1491101
	speed: 0.0163s/iter; left time: 143.7303s
	iters: 400, epoch: 5 | loss: 0.1874050
	speed: 0.0163s/iter; left time: 142.2134s
	iters: 500, epoch: 5 | loss: 0.1471154
	speed: 0.0163s/iter; left time: 140.6062s
Epoch: 5 cost time: 9.537915229797363
Epoch: 5, Steps: 570 | Train Loss: 0.2057814 Vali Loss: 0.0583800 Test Loss: 0.1598453
Validation loss decreased (0.063920 --> 0.058380).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2401012
	speed: 0.0479s/iter; left time: 404.6475s
	iters: 200, epoch: 6 | loss: 0.1714445
	speed: 0.0163s/iter; left time: 136.0632s
	iters: 300, epoch: 6 | loss: 0.2459915
	speed: 0.0164s/iter; left time: 135.2890s
	iters: 400, epoch: 6 | loss: 0.1931977
	speed: 0.0164s/iter; left time: 133.7709s
	iters: 500, epoch: 6 | loss: 0.1885254
	speed: 0.0163s/iter; left time: 131.4184s
Epoch: 6 cost time: 9.556966066360474
Epoch: 6, Steps: 570 | Train Loss: 0.1941076 Vali Loss: 0.0599090 Test Loss: 0.1608659
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1485454
	speed: 0.0503s/iter; left time: 396.0769s
	iters: 200, epoch: 7 | loss: 0.2220893
	speed: 0.0177s/iter; left time: 137.9213s
	iters: 300, epoch: 7 | loss: 0.2589035
	speed: 0.0177s/iter; left time: 136.1119s
	iters: 400, epoch: 7 | loss: 0.1114334
	speed: 0.0177s/iter; left time: 134.3763s
	iters: 500, epoch: 7 | loss: 0.1242444
	speed: 0.0177s/iter; left time: 132.5198s
Epoch: 7 cost time: 10.35298490524292
Epoch: 7, Steps: 570 | Train Loss: 0.1875073 Vali Loss: 0.0603522 Test Loss: 0.1618410
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1701197
	speed: 0.0486s/iter; left time: 355.4794s
	iters: 200, epoch: 8 | loss: 0.1515106
	speed: 0.0163s/iter; left time: 117.7738s
	iters: 300, epoch: 8 | loss: 0.2233585
	speed: 0.0163s/iter; left time: 115.8866s
	iters: 400, epoch: 8 | loss: 0.0997724
	speed: 0.0163s/iter; left time: 114.3073s
	iters: 500, epoch: 8 | loss: 0.1245760
	speed: 0.0163s/iter; left time: 112.7131s
Epoch: 8 cost time: 9.535839080810547
Epoch: 8, Steps: 570 | Train Loss: 0.1838400 Vali Loss: 0.0598232 Test Loss: 0.1601604
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1600600779056549, mae:0.25847792625427246
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2592842
	speed: 0.0276s/iter; left time: 312.3622s
	iters: 200, epoch: 1 | loss: 0.1940206
	speed: 0.0158s/iter; left time: 177.4149s
	iters: 300, epoch: 1 | loss: 0.3411418
	speed: 0.0158s/iter; left time: 175.8013s
	iters: 400, epoch: 1 | loss: 0.2999641
	speed: 0.0158s/iter; left time: 174.1552s
	iters: 500, epoch: 1 | loss: 0.1544883
	speed: 0.0158s/iter; left time: 172.5403s
Epoch: 1 cost time: 10.25948166847229
Epoch: 1, Steps: 570 | Train Loss: 0.3029523 Vali Loss: 0.0649792 Test Loss: 0.1817163
Validation loss decreased (inf --> 0.064979).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2204731
	speed: 0.0501s/iter; left time: 537.6709s
	iters: 200, epoch: 2 | loss: 0.2015020
	speed: 0.0158s/iter; left time: 167.4436s
	iters: 300, epoch: 2 | loss: 0.3120509
	speed: 0.0157s/iter; left time: 165.6793s
	iters: 400, epoch: 2 | loss: 0.4567918
	speed: 0.0158s/iter; left time: 164.3152s
	iters: 500, epoch: 2 | loss: 0.2119895
	speed: 0.0158s/iter; left time: 163.4528s
Epoch: 2 cost time: 9.25087308883667
Epoch: 2, Steps: 570 | Train Loss: 0.2555726 Vali Loss: 0.0691800 Test Loss: 0.1844113
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2225079
	speed: 0.0471s/iter; left time: 478.9666s
	iters: 200, epoch: 3 | loss: 0.2669656
	speed: 0.0160s/iter; left time: 161.1711s
	iters: 300, epoch: 3 | loss: 0.1537148
	speed: 0.0169s/iter; left time: 168.3559s
	iters: 400, epoch: 3 | loss: 0.2292681
	speed: 0.0168s/iter; left time: 166.0100s
	iters: 500, epoch: 3 | loss: 0.2172293
	speed: 0.0162s/iter; left time: 158.3916s
Epoch: 3 cost time: 9.53176760673523
Epoch: 3, Steps: 570 | Train Loss: 0.2331770 Vali Loss: 0.0565890 Test Loss: 0.1642408
Validation loss decreased (0.064979 --> 0.056589).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2177852
	speed: 0.0505s/iter; left time: 484.3780s
	iters: 200, epoch: 4 | loss: 0.3362504
	speed: 0.0169s/iter; left time: 160.4055s
	iters: 300, epoch: 4 | loss: 0.2126502
	speed: 0.0165s/iter; left time: 154.5279s
	iters: 400, epoch: 4 | loss: 0.1504691
	speed: 0.0169s/iter; left time: 157.2183s
	iters: 500, epoch: 4 | loss: 0.3105541
	speed: 0.0163s/iter; left time: 150.1666s
Epoch: 4 cost time: 9.74505090713501
Epoch: 4, Steps: 570 | Train Loss: 0.2091449 Vali Loss: 0.0589450 Test Loss: 0.1651395
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2018463
	speed: 0.0483s/iter; left time: 435.6236s
	iters: 200, epoch: 5 | loss: 0.3313251
	speed: 0.0158s/iter; left time: 141.1629s
	iters: 300, epoch: 5 | loss: 0.2012002
	speed: 0.0158s/iter; left time: 139.2284s
	iters: 400, epoch: 5 | loss: 0.1302354
	speed: 0.0158s/iter; left time: 137.8530s
	iters: 500, epoch: 5 | loss: 0.2003354
	speed: 0.0158s/iter; left time: 136.3335s
Epoch: 5 cost time: 9.283507108688354
Epoch: 5, Steps: 570 | Train Loss: 0.1946756 Vali Loss: 0.0567082 Test Loss: 0.1582989
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2129356
	speed: 0.0478s/iter; left time: 404.1332s
	iters: 200, epoch: 6 | loss: 0.2304875
	speed: 0.0159s/iter; left time: 132.4458s
	iters: 300, epoch: 6 | loss: 0.2754611
	speed: 0.0159s/iter; left time: 130.8302s
	iters: 400, epoch: 6 | loss: 0.1710404
	speed: 0.0159s/iter; left time: 129.2586s
	iters: 500, epoch: 6 | loss: 0.1663898
	speed: 0.0158s/iter; left time: 127.3010s
Epoch: 6 cost time: 9.303524732589722
Epoch: 6, Steps: 570 | Train Loss: 0.1853511 Vali Loss: 0.0544491 Test Loss: 0.1538800
Validation loss decreased (0.056589 --> 0.054449).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2040665
	speed: 0.0483s/iter; left time: 380.2973s
	iters: 200, epoch: 7 | loss: 0.1018395
	speed: 0.0159s/iter; left time: 123.4034s
	iters: 300, epoch: 7 | loss: 0.1823076
	speed: 0.0159s/iter; left time: 121.7728s
	iters: 400, epoch: 7 | loss: 0.1981986
	speed: 0.0158s/iter; left time: 120.1544s
	iters: 500, epoch: 7 | loss: 0.3003233
	speed: 0.0158s/iter; left time: 118.4830s
Epoch: 7 cost time: 9.326466083526611
Epoch: 7, Steps: 570 | Train Loss: 0.1801386 Vali Loss: 0.0555357 Test Loss: 0.1576312
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1524271
	speed: 0.0482s/iter; left time: 352.2133s
	iters: 200, epoch: 8 | loss: 0.2910529
	speed: 0.0158s/iter; left time: 114.2205s
	iters: 300, epoch: 8 | loss: 0.2003015
	speed: 0.0158s/iter; left time: 112.5732s
	iters: 400, epoch: 8 | loss: 0.1914104
	speed: 0.0163s/iter; left time: 114.2208s
	iters: 500, epoch: 8 | loss: 0.1669760
	speed: 0.0158s/iter; left time: 109.3902s
Epoch: 8 cost time: 9.333168268203735
Epoch: 8, Steps: 570 | Train Loss: 0.1769568 Vali Loss: 0.0551039 Test Loss: 0.1566411
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1595635
	speed: 0.0477s/iter; left time: 321.8038s
	iters: 200, epoch: 9 | loss: 0.1816410
	speed: 0.0165s/iter; left time: 109.8646s
	iters: 300, epoch: 9 | loss: 0.0986668
	speed: 0.0162s/iter; left time: 105.9167s
	iters: 400, epoch: 9 | loss: 0.1745072
	speed: 0.0159s/iter; left time: 102.1921s
	iters: 500, epoch: 9 | loss: 0.1041569
	speed: 0.0159s/iter; left time: 100.5252s
Epoch: 9 cost time: 9.471447467803955
Epoch: 9, Steps: 570 | Train Loss: 0.1748284 Vali Loss: 0.0550290 Test Loss: 0.1563157
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15406329929828644, mae:0.2528390884399414
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3087568
	speed: 0.0264s/iter; left time: 298.3431s
	iters: 200, epoch: 1 | loss: 0.3462889
	speed: 0.0146s/iter; left time: 163.4437s
	iters: 300, epoch: 1 | loss: 0.2530968
	speed: 0.0145s/iter; left time: 160.9240s
	iters: 400, epoch: 1 | loss: 0.3330573
	speed: 0.0145s/iter; left time: 159.7118s
	iters: 500, epoch: 1 | loss: 0.4840830
	speed: 0.0145s/iter; left time: 158.3923s
Epoch: 1 cost time: 9.522202491760254
Epoch: 1, Steps: 570 | Train Loss: 0.2991262 Vali Loss: 0.0749524 Test Loss: 0.2021642
Validation loss decreased (inf --> 0.074952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4184516
	speed: 0.0453s/iter; left time: 486.5083s
	iters: 200, epoch: 2 | loss: 0.1698274
	speed: 0.0145s/iter; left time: 154.5418s
	iters: 300, epoch: 2 | loss: 0.3770357
	speed: 0.0146s/iter; left time: 153.2623s
	iters: 400, epoch: 2 | loss: 0.2762246
	speed: 0.0146s/iter; left time: 151.8268s
	iters: 500, epoch: 2 | loss: 0.2991737
	speed: 0.0145s/iter; left time: 149.6499s
Epoch: 2 cost time: 8.525974988937378
Epoch: 2, Steps: 570 | Train Loss: 0.2748205 Vali Loss: 0.0604024 Test Loss: 0.1754508
Validation loss decreased (0.074952 --> 0.060402).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2303173
	speed: 0.0450s/iter; left time: 457.6918s
	iters: 200, epoch: 3 | loss: 0.1447184
	speed: 0.0146s/iter; left time: 146.4448s
	iters: 300, epoch: 3 | loss: 0.2395865
	speed: 0.0145s/iter; left time: 144.5658s
	iters: 400, epoch: 3 | loss: 0.3493069
	speed: 0.0145s/iter; left time: 143.4560s
	iters: 500, epoch: 3 | loss: 0.2475004
	speed: 0.0145s/iter; left time: 141.6909s
Epoch: 3 cost time: 8.52150821685791
Epoch: 3, Steps: 570 | Train Loss: 0.2622324 Vali Loss: 0.0659564 Test Loss: 0.1945945
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1808744
	speed: 0.0442s/iter; left time: 423.9618s
	iters: 200, epoch: 4 | loss: 0.3168277
	speed: 0.0146s/iter; left time: 138.3629s
	iters: 300, epoch: 4 | loss: 0.3154862
	speed: 0.0146s/iter; left time: 136.9650s
	iters: 400, epoch: 4 | loss: 0.2198539
	speed: 0.0146s/iter; left time: 135.7513s
	iters: 500, epoch: 4 | loss: 0.2445161
	speed: 0.0146s/iter; left time: 133.8446s
Epoch: 4 cost time: 8.538766860961914
Epoch: 4, Steps: 570 | Train Loss: 0.2500855 Vali Loss: 0.0656367 Test Loss: 0.1755282
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2021067
	speed: 0.0444s/iter; left time: 400.2793s
	iters: 200, epoch: 5 | loss: 0.1661894
	speed: 0.0146s/iter; left time: 130.1716s
	iters: 300, epoch: 5 | loss: 0.1782910
	speed: 0.0145s/iter; left time: 128.1015s
	iters: 400, epoch: 5 | loss: 0.1894042
	speed: 0.0145s/iter; left time: 126.3191s
	iters: 500, epoch: 5 | loss: 0.2144025
	speed: 0.0145s/iter; left time: 124.6133s
Epoch: 5 cost time: 8.490573167800903
Epoch: 5, Steps: 570 | Train Loss: 0.2293930 Vali Loss: 0.0615150 Test Loss: 0.1702067
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.175662562251091, mae:0.26966238021850586
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2576005
	speed: 0.0297s/iter; left time: 335.8499s
	iters: 200, epoch: 1 | loss: 0.3177054
	speed: 0.0174s/iter; left time: 194.5502s
	iters: 300, epoch: 1 | loss: 0.4582160
	speed: 0.0174s/iter; left time: 193.4464s
	iters: 400, epoch: 1 | loss: 0.2453062
	speed: 0.0175s/iter; left time: 192.4838s
	iters: 500, epoch: 1 | loss: 0.1802820
	speed: 0.0174s/iter; left time: 189.8903s
Epoch: 1 cost time: 11.206317663192749
Epoch: 1, Steps: 570 | Train Loss: 0.2986423 Vali Loss: 0.0624207 Test Loss: 0.1859441
Validation loss decreased (inf --> 0.062421).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3728313
	speed: 0.0549s/iter; left time: 588.9637s
	iters: 200, epoch: 2 | loss: 0.1625194
	speed: 0.0175s/iter; left time: 185.7969s
	iters: 300, epoch: 2 | loss: 0.2098111
	speed: 0.0193s/iter; left time: 202.9277s
	iters: 400, epoch: 2 | loss: 0.2316139
	speed: 0.0184s/iter; left time: 192.2134s
	iters: 500, epoch: 2 | loss: 0.2099084
	speed: 0.0190s/iter; left time: 196.2704s
Epoch: 2 cost time: 10.658440113067627
Epoch: 2, Steps: 570 | Train Loss: 0.2463334 Vali Loss: 0.0672368 Test Loss: 0.1854389
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1567222
	speed: 0.0547s/iter; left time: 555.7211s
	iters: 200, epoch: 3 | loss: 0.2328888
	speed: 0.0175s/iter; left time: 176.5596s
	iters: 300, epoch: 3 | loss: 0.2081664
	speed: 0.0190s/iter; left time: 189.4887s
	iters: 400, epoch: 3 | loss: 0.1160073
	speed: 0.0183s/iter; left time: 180.8855s
	iters: 500, epoch: 3 | loss: 0.1852383
	speed: 0.0175s/iter; left time: 170.6408s
Epoch: 3 cost time: 10.469424486160278
Epoch: 3, Steps: 570 | Train Loss: 0.2161097 Vali Loss: 0.0575502 Test Loss: 0.1623097
Validation loss decreased (0.062421 --> 0.057550).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2091047
	speed: 0.0537s/iter; left time: 514.7785s
	iters: 200, epoch: 4 | loss: 0.1903538
	speed: 0.0175s/iter; left time: 166.1957s
	iters: 300, epoch: 4 | loss: 0.2823515
	speed: 0.0175s/iter; left time: 164.4218s
	iters: 400, epoch: 4 | loss: 0.1222386
	speed: 0.0175s/iter; left time: 162.6878s
	iters: 500, epoch: 4 | loss: 0.2279944
	speed: 0.0175s/iter; left time: 160.9021s
Epoch: 4 cost time: 10.235992431640625
Epoch: 4, Steps: 570 | Train Loss: 0.1895393 Vali Loss: 0.0610897 Test Loss: 0.1650018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2419203
	speed: 0.0552s/iter; left time: 497.9696s
	iters: 200, epoch: 5 | loss: 0.1397381
	speed: 0.0175s/iter; left time: 155.9017s
	iters: 300, epoch: 5 | loss: 0.1961470
	speed: 0.0174s/iter; left time: 153.7449s
	iters: 400, epoch: 5 | loss: 0.2142258
	speed: 0.0175s/iter; left time: 152.3859s
	iters: 500, epoch: 5 | loss: 0.2020703
	speed: 0.0175s/iter; left time: 150.8768s
Epoch: 5 cost time: 10.215934753417969
Epoch: 5, Steps: 570 | Train Loss: 0.1776697 Vali Loss: 0.0597592 Test Loss: 0.1574803
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1256947
	speed: 0.0553s/iter; left time: 467.4402s
	iters: 200, epoch: 6 | loss: 0.1939256
	speed: 0.0175s/iter; left time: 146.2460s
	iters: 300, epoch: 6 | loss: 0.1321706
	speed: 0.0174s/iter; left time: 143.7865s
	iters: 400, epoch: 6 | loss: 0.1912255
	speed: 0.0173s/iter; left time: 141.3807s
	iters: 500, epoch: 6 | loss: 0.1801842
	speed: 0.0173s/iter; left time: 139.4803s
Epoch: 6 cost time: 10.249757528305054
Epoch: 6, Steps: 570 | Train Loss: 0.1691510 Vali Loss: 0.0597679 Test Loss: 0.1599545
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16255781054496765, mae:0.2579495906829834
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4043203
	speed: 0.0312s/iter; left time: 352.6677s
	iters: 200, epoch: 1 | loss: 0.1992670
	speed: 0.0172s/iter; left time: 193.0135s
	iters: 300, epoch: 1 | loss: 0.1797327
	speed: 0.0199s/iter; left time: 221.1423s
	iters: 400, epoch: 1 | loss: 0.1445734
	speed: 0.0182s/iter; left time: 200.3565s
	iters: 500, epoch: 1 | loss: 0.1533082
	speed: 0.0172s/iter; left time: 187.7463s
Epoch: 1 cost time: 11.650950908660889
Epoch: 1, Steps: 570 | Train Loss: 0.2059793 Vali Loss: 0.0638378 Test Loss: 0.1858505
Validation loss decreased (inf --> 0.063838).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3128408
	speed: 0.0539s/iter; left time: 578.1439s
	iters: 200, epoch: 2 | loss: 0.3340852
	speed: 0.0174s/iter; left time: 184.7561s
	iters: 300, epoch: 2 | loss: 0.4815163
	speed: 0.0173s/iter; left time: 181.8174s
	iters: 400, epoch: 2 | loss: 0.2596833
	speed: 0.0198s/iter; left time: 206.8084s
	iters: 500, epoch: 2 | loss: 0.1839698
	speed: 0.0199s/iter; left time: 206.0810s
Epoch: 2 cost time: 10.858459949493408
Epoch: 2, Steps: 570 | Train Loss: 0.2772075 Vali Loss: 0.0627708 Test Loss: 0.1783495
Validation loss decreased (0.063838 --> 0.062771).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1760170
	speed: 0.0582s/iter; left time: 591.2984s
	iters: 200, epoch: 3 | loss: 0.1966718
	speed: 0.0200s/iter; left time: 200.8118s
	iters: 300, epoch: 3 | loss: 0.1913995
	speed: 0.0199s/iter; left time: 198.4681s
	iters: 400, epoch: 3 | loss: 0.1781942
	speed: 0.0199s/iter; left time: 196.6143s
	iters: 500, epoch: 3 | loss: 0.1715818
	speed: 0.0199s/iter; left time: 194.5560s
Epoch: 3 cost time: 11.646062135696411
Epoch: 3, Steps: 570 | Train Loss: 0.2209164 Vali Loss: 0.0596031 Test Loss: 0.1728491
Validation loss decreased (0.062771 --> 0.059603).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1805340
	speed: 0.0588s/iter; left time: 564.1011s
	iters: 200, epoch: 4 | loss: 0.0905904
	speed: 0.0173s/iter; left time: 164.4389s
	iters: 300, epoch: 4 | loss: 0.2791197
	speed: 0.0173s/iter; left time: 162.5148s
	iters: 400, epoch: 4 | loss: 0.1629296
	speed: 0.0173s/iter; left time: 160.4514s
	iters: 500, epoch: 4 | loss: 0.1282458
	speed: 0.0173s/iter; left time: 158.7134s
Epoch: 4 cost time: 10.304103136062622
Epoch: 4, Steps: 570 | Train Loss: 0.1975164 Vali Loss: 0.0578438 Test Loss: 0.1621911
Validation loss decreased (0.059603 --> 0.057844).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1482425
	speed: 0.0552s/iter; left time: 497.7346s
	iters: 200, epoch: 5 | loss: 0.1782770
	speed: 0.0193s/iter; left time: 172.0097s
	iters: 300, epoch: 5 | loss: 0.1629610
	speed: 0.0188s/iter; left time: 166.0570s
	iters: 400, epoch: 5 | loss: 0.1764713
	speed: 0.0180s/iter; left time: 157.0201s
	iters: 500, epoch: 5 | loss: 0.1842960
	speed: 0.0173s/iter; left time: 148.9631s
Epoch: 5 cost time: 10.768644094467163
Epoch: 5, Steps: 570 | Train Loss: 0.1851035 Vali Loss: 0.0581966 Test Loss: 0.1593677
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2247585
	speed: 0.0531s/iter; left time: 448.4959s
	iters: 200, epoch: 6 | loss: 0.1118122
	speed: 0.0171s/iter; left time: 142.9453s
	iters: 300, epoch: 6 | loss: 0.1594950
	speed: 0.0171s/iter; left time: 141.2828s
	iters: 400, epoch: 6 | loss: 0.1419411
	speed: 0.0171s/iter; left time: 139.4413s
	iters: 500, epoch: 6 | loss: 0.1376313
	speed: 0.0171s/iter; left time: 137.6913s
Epoch: 6 cost time: 10.045849800109863
Epoch: 6, Steps: 570 | Train Loss: 0.1773759 Vali Loss: 0.0558292 Test Loss: 0.1570787
Validation loss decreased (0.057844 --> 0.055829).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1612963
	speed: 0.0535s/iter; left time: 421.4033s
	iters: 200, epoch: 7 | loss: 0.1753921
	speed: 0.0173s/iter; left time: 134.2516s
	iters: 300, epoch: 7 | loss: 0.1152870
	speed: 0.0172s/iter; left time: 132.3725s
	iters: 400, epoch: 7 | loss: 0.1577708
	speed: 0.0172s/iter; left time: 130.7275s
	iters: 500, epoch: 7 | loss: 0.1604751
	speed: 0.0197s/iter; left time: 147.5970s
Epoch: 7 cost time: 10.53983473777771
Epoch: 7, Steps: 570 | Train Loss: 0.1730504 Vali Loss: 0.0571969 Test Loss: 0.1591050
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1169839
	speed: 0.0566s/iter; left time: 413.9164s
	iters: 200, epoch: 8 | loss: 0.1007759
	speed: 0.0194s/iter; left time: 140.2131s
	iters: 300, epoch: 8 | loss: 0.2006591
	speed: 0.0198s/iter; left time: 141.0467s
	iters: 400, epoch: 8 | loss: 0.2258077
	speed: 0.0198s/iter; left time: 139.0592s
	iters: 500, epoch: 8 | loss: 0.2066380
	speed: 0.0199s/iter; left time: 137.2429s
Epoch: 8 cost time: 11.498283863067627
Epoch: 8, Steps: 570 | Train Loss: 0.1705565 Vali Loss: 0.0568154 Test Loss: 0.1585337
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1093133
	speed: 0.0574s/iter; left time: 386.8060s
	iters: 200, epoch: 9 | loss: 0.1208550
	speed: 0.0199s/iter; left time: 132.0124s
	iters: 300, epoch: 9 | loss: 0.1547902
	speed: 0.0199s/iter; left time: 129.9036s
	iters: 400, epoch: 9 | loss: 0.1336278
	speed: 0.0199s/iter; left time: 128.0164s
	iters: 500, epoch: 9 | loss: 0.1185609
	speed: 0.0199s/iter; left time: 125.9550s
Epoch: 9 cost time: 11.605529546737671
Epoch: 9, Steps: 570 | Train Loss: 0.1690572 Vali Loss: 0.0568122 Test Loss: 0.1580576
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15728867053985596, mae:0.2547375559806824
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2556352
	speed: 0.0313s/iter; left time: 354.0244s
	iters: 200, epoch: 1 | loss: 0.1872244
	speed: 0.0200s/iter; left time: 224.3390s
	iters: 300, epoch: 1 | loss: 0.2462130
	speed: 0.0201s/iter; left time: 222.7921s
	iters: 400, epoch: 1 | loss: 0.2578883
	speed: 0.0200s/iter; left time: 220.0233s
	iters: 500, epoch: 1 | loss: 0.3866651
	speed: 0.0200s/iter; left time: 218.3598s
Epoch: 1 cost time: 12.603454828262329
Epoch: 1, Steps: 570 | Train Loss: 0.2572709 Vali Loss: 0.0606518 Test Loss: 0.1839672
Validation loss decreased (inf --> 0.060652).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4579217
	speed: 0.0579s/iter; left time: 621.2029s
	iters: 200, epoch: 2 | loss: 0.3687385
	speed: 0.0200s/iter; left time: 213.1456s
	iters: 300, epoch: 2 | loss: 0.3783978
	speed: 0.0201s/iter; left time: 211.2701s
	iters: 400, epoch: 2 | loss: 0.2041424
	speed: 0.0197s/iter; left time: 205.5901s
	iters: 500, epoch: 2 | loss: 0.3030787
	speed: 0.0194s/iter; left time: 200.2351s
Epoch: 2 cost time: 11.52196717262268
Epoch: 2, Steps: 570 | Train Loss: 0.2547372 Vali Loss: 0.0611325 Test Loss: 0.1727885
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1552677
	speed: 0.0568s/iter; left time: 576.6585s
	iters: 200, epoch: 3 | loss: 0.2073597
	speed: 0.0172s/iter; left time: 173.2307s
	iters: 300, epoch: 3 | loss: 0.2164321
	speed: 0.0172s/iter; left time: 171.5602s
	iters: 400, epoch: 3 | loss: 0.2554320
	speed: 0.0172s/iter; left time: 169.6766s
	iters: 500, epoch: 3 | loss: 0.2286625
	speed: 0.0172s/iter; left time: 168.3042s
Epoch: 3 cost time: 10.075936794281006
Epoch: 3, Steps: 570 | Train Loss: 0.2108641 Vali Loss: 0.0606534 Test Loss: 0.1671809
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1449989
	speed: 0.0553s/iter; left time: 530.6455s
	iters: 200, epoch: 4 | loss: 0.1873359
	speed: 0.0172s/iter; left time: 163.3583s
	iters: 300, epoch: 4 | loss: 0.1576527
	speed: 0.0172s/iter; left time: 161.5102s
	iters: 400, epoch: 4 | loss: 0.2044394
	speed: 0.0172s/iter; left time: 159.7752s
	iters: 500, epoch: 4 | loss: 0.1120493
	speed: 0.0172s/iter; left time: 158.0880s
Epoch: 4 cost time: 10.083813190460205
Epoch: 4, Steps: 570 | Train Loss: 0.1912532 Vali Loss: 0.0578707 Test Loss: 0.1583105
Validation loss decreased (0.060652 --> 0.057871).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1316964
	speed: 0.0538s/iter; left time: 485.2558s
	iters: 200, epoch: 5 | loss: 0.1546748
	speed: 0.0174s/iter; left time: 155.0252s
	iters: 300, epoch: 5 | loss: 0.1557725
	speed: 0.0174s/iter; left time: 153.2227s
	iters: 400, epoch: 5 | loss: 0.2160063
	speed: 0.0173s/iter; left time: 150.4385s
	iters: 500, epoch: 5 | loss: 0.1194131
	speed: 0.0173s/iter; left time: 148.7314s
Epoch: 5 cost time: 10.152634382247925
Epoch: 5, Steps: 570 | Train Loss: 0.1778205 Vali Loss: 0.0576764 Test Loss: 0.1575596
Validation loss decreased (0.057871 --> 0.057676).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2322009
	speed: 0.0535s/iter; left time: 451.8531s
	iters: 200, epoch: 6 | loss: 0.1299272
	speed: 0.0172s/iter; left time: 143.9672s
	iters: 300, epoch: 6 | loss: 0.3989783
	speed: 0.0172s/iter; left time: 142.2352s
	iters: 400, epoch: 6 | loss: 0.1361643
	speed: 0.0172s/iter; left time: 140.5216s
	iters: 500, epoch: 6 | loss: 0.2072702
	speed: 0.0172s/iter; left time: 138.8267s
Epoch: 6 cost time: 10.10404658317566
Epoch: 6, Steps: 570 | Train Loss: 0.1666638 Vali Loss: 0.0567906 Test Loss: 0.1548798
Validation loss decreased (0.057676 --> 0.056791).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1350531
	speed: 0.0535s/iter; left time: 421.6684s
	iters: 200, epoch: 7 | loss: 0.1668256
	speed: 0.0197s/iter; left time: 153.1850s
	iters: 300, epoch: 7 | loss: 0.1984801
	speed: 0.0199s/iter; left time: 152.8190s
	iters: 400, epoch: 7 | loss: 0.1426664
	speed: 0.0199s/iter; left time: 150.7576s
	iters: 500, epoch: 7 | loss: 0.1303774
	speed: 0.0200s/iter; left time: 149.8272s
Epoch: 7 cost time: 11.178615808486938
Epoch: 7, Steps: 570 | Train Loss: 0.1604715 Vali Loss: 0.0566994 Test Loss: 0.1539143
Validation loss decreased (0.056791 --> 0.056699).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0793495
	speed: 0.0538s/iter; left time: 393.2915s
	iters: 200, epoch: 8 | loss: 0.0816441
	speed: 0.0173s/iter; left time: 124.7026s
	iters: 300, epoch: 8 | loss: 0.1428428
	speed: 0.0173s/iter; left time: 122.8246s
	iters: 400, epoch: 8 | loss: 0.1213741
	speed: 0.0172s/iter; left time: 120.8443s
	iters: 500, epoch: 8 | loss: 0.1387340
	speed: 0.0172s/iter; left time: 118.8952s
Epoch: 8 cost time: 10.100126504898071
Epoch: 8, Steps: 570 | Train Loss: 0.1568428 Vali Loss: 0.0571787 Test Loss: 0.1558457
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2026256
	speed: 0.0533s/iter; left time: 359.2948s
	iters: 200, epoch: 9 | loss: 0.1673106
	speed: 0.0171s/iter; left time: 113.5427s
	iters: 300, epoch: 9 | loss: 0.1801844
	speed: 0.0171s/iter; left time: 112.1383s
	iters: 400, epoch: 9 | loss: 0.2959049
	speed: 0.0172s/iter; left time: 110.4693s
	iters: 500, epoch: 9 | loss: 0.1356361
	speed: 0.0172s/iter; left time: 108.7952s
Epoch: 9 cost time: 10.026670932769775
Epoch: 9, Steps: 570 | Train Loss: 0.1549962 Vali Loss: 0.0568263 Test Loss: 0.1550211
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1370055
	speed: 0.0536s/iter; left time: 331.0250s
	iters: 200, epoch: 10 | loss: 0.1289415
	speed: 0.0175s/iter; left time: 106.0927s
	iters: 300, epoch: 10 | loss: 0.1983363
	speed: 0.0173s/iter; left time: 103.5936s
	iters: 400, epoch: 10 | loss: 0.1467326
	speed: 0.0173s/iter; left time: 101.7714s
	iters: 500, epoch: 10 | loss: 0.1663210
	speed: 0.0192s/iter; left time: 111.0646s
Epoch: 10 cost time: 10.623488903045654
Epoch: 10, Steps: 570 | Train Loss: 0.1536804 Vali Loss: 0.0567571 Test Loss: 0.1549835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15411075949668884, mae:0.2524541914463043
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2633941
	speed: 0.0331s/iter; left time: 374.0978s
	iters: 200, epoch: 1 | loss: 0.2882230
	speed: 0.0214s/iter; left time: 239.3866s
	iters: 300, epoch: 1 | loss: 0.3079577
	speed: 0.0213s/iter; left time: 236.8079s
	iters: 400, epoch: 1 | loss: 0.4719545
	speed: 0.0213s/iter; left time: 234.6780s
	iters: 500, epoch: 1 | loss: 0.3473301
	speed: 0.0213s/iter; left time: 232.4125s
Epoch: 1 cost time: 13.392061948776245
Epoch: 1, Steps: 570 | Train Loss: 0.3496201 Vali Loss: 0.0691530 Test Loss: 0.2032876
Validation loss decreased (inf --> 0.069153).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3026515
	speed: 0.0623s/iter; left time: 668.5103s
	iters: 200, epoch: 2 | loss: 0.2586778
	speed: 0.0214s/iter; left time: 227.3466s
	iters: 300, epoch: 2 | loss: 0.2658741
	speed: 0.0213s/iter; left time: 224.6427s
	iters: 400, epoch: 2 | loss: 0.3067841
	speed: 0.0214s/iter; left time: 222.7741s
	iters: 500, epoch: 2 | loss: 0.2336292
	speed: 0.0213s/iter; left time: 220.0898s
Epoch: 2 cost time: 12.472235679626465
Epoch: 2, Steps: 570 | Train Loss: 0.2770482 Vali Loss: 0.0684681 Test Loss: 0.1803966
Validation loss decreased (0.069153 --> 0.068468).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5014133
	speed: 0.0618s/iter; left time: 627.9293s
	iters: 200, epoch: 3 | loss: 0.3132436
	speed: 0.0214s/iter; left time: 215.4905s
	iters: 300, epoch: 3 | loss: 0.3100383
	speed: 0.0214s/iter; left time: 213.3257s
	iters: 400, epoch: 3 | loss: 0.2355167
	speed: 0.0214s/iter; left time: 211.0424s
	iters: 500, epoch: 3 | loss: 0.2293372
	speed: 0.0214s/iter; left time: 208.8323s
Epoch: 3 cost time: 12.48382306098938
Epoch: 3, Steps: 570 | Train Loss: 0.2852790 Vali Loss: 0.0618621 Test Loss: 0.1858376
Validation loss decreased (0.068468 --> 0.061862).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1910913
	speed: 0.0627s/iter; left time: 601.0592s
	iters: 200, epoch: 4 | loss: 0.2064937
	speed: 0.0224s/iter; left time: 212.5664s
	iters: 300, epoch: 4 | loss: 0.3060553
	speed: 0.0214s/iter; left time: 200.8438s
	iters: 400, epoch: 4 | loss: 0.2156951
	speed: 0.0227s/iter; left time: 210.4433s
	iters: 500, epoch: 4 | loss: 0.2605067
	speed: 0.0231s/iter; left time: 212.4625s
Epoch: 4 cost time: 13.135343790054321
Epoch: 4, Steps: 570 | Train Loss: 0.2557708 Vali Loss: 0.0617414 Test Loss: 0.1765215
Validation loss decreased (0.061862 --> 0.061741).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2731111
	speed: 0.0623s/iter; left time: 562.1240s
	iters: 200, epoch: 5 | loss: 0.1924176
	speed: 0.0212s/iter; left time: 189.5618s
	iters: 300, epoch: 5 | loss: 0.1932702
	speed: 0.0213s/iter; left time: 187.5757s
	iters: 400, epoch: 5 | loss: 0.2116029
	speed: 0.0213s/iter; left time: 185.3899s
	iters: 500, epoch: 5 | loss: 0.2595659
	speed: 0.0212s/iter; left time: 183.1712s
Epoch: 5 cost time: 12.426280498504639
Epoch: 5, Steps: 570 | Train Loss: 0.2348923 Vali Loss: 0.0627406 Test Loss: 0.1726262
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2130222
	speed: 0.0622s/iter; left time: 526.0522s
	iters: 200, epoch: 6 | loss: 0.3572890
	speed: 0.0213s/iter; left time: 177.8559s
	iters: 300, epoch: 6 | loss: 0.2064936
	speed: 0.0213s/iter; left time: 175.6872s
	iters: 400, epoch: 6 | loss: 0.2617048
	speed: 0.0213s/iter; left time: 173.3674s
	iters: 500, epoch: 6 | loss: 0.3124670
	speed: 0.0213s/iter; left time: 171.4600s
Epoch: 6 cost time: 12.433152437210083
Epoch: 6, Steps: 570 | Train Loss: 0.2221600 Vali Loss: 0.0617320 Test Loss: 0.1794897
Validation loss decreased (0.061741 --> 0.061732).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2988350
	speed: 0.0616s/iter; left time: 485.1310s
	iters: 200, epoch: 7 | loss: 0.1856506
	speed: 0.0215s/iter; left time: 166.9678s
	iters: 300, epoch: 7 | loss: 0.1715053
	speed: 0.0214s/iter; left time: 164.7519s
	iters: 400, epoch: 7 | loss: 0.2193801
	speed: 0.0214s/iter; left time: 162.2608s
	iters: 500, epoch: 7 | loss: 0.2082414
	speed: 0.0214s/iter; left time: 160.3924s
Epoch: 7 cost time: 12.50333046913147
Epoch: 7, Steps: 570 | Train Loss: 0.2201508 Vali Loss: 0.0617448 Test Loss: 0.1733547
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1307898
	speed: 0.0605s/iter; left time: 442.1634s
	iters: 200, epoch: 8 | loss: 0.3508490
	speed: 0.0213s/iter; left time: 153.6159s
	iters: 300, epoch: 8 | loss: 0.1427951
	speed: 0.0213s/iter; left time: 151.3713s
	iters: 400, epoch: 8 | loss: 0.1989607
	speed: 0.0213s/iter; left time: 149.2062s
	iters: 500, epoch: 8 | loss: 0.2051648
	speed: 0.0213s/iter; left time: 147.0964s
Epoch: 8 cost time: 12.411915302276611
Epoch: 8, Steps: 570 | Train Loss: 0.2198184 Vali Loss: 0.0605993 Test Loss: 0.1703959
Validation loss decreased (0.061732 --> 0.060599).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2086617
	speed: 0.0611s/iter; left time: 411.7840s
	iters: 200, epoch: 9 | loss: 0.1701879
	speed: 0.0214s/iter; left time: 142.2678s
	iters: 300, epoch: 9 | loss: 0.2340400
	speed: 0.0214s/iter; left time: 139.9729s
	iters: 400, epoch: 9 | loss: 0.2145180
	speed: 0.0214s/iter; left time: 137.8207s
	iters: 500, epoch: 9 | loss: 0.1757907
	speed: 0.0214s/iter; left time: 135.6428s
Epoch: 9 cost time: 12.47000765800476
Epoch: 9, Steps: 570 | Train Loss: 0.2117511 Vali Loss: 0.0595498 Test Loss: 0.1690634
Validation loss decreased (0.060599 --> 0.059550).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1913969
	speed: 0.0625s/iter; left time: 385.5304s
	iters: 200, epoch: 10 | loss: 0.1887120
	speed: 0.0213s/iter; left time: 129.5771s
	iters: 300, epoch: 10 | loss: 0.1581029
	speed: 0.0214s/iter; left time: 127.5005s
	iters: 400, epoch: 10 | loss: 0.3914342
	speed: 0.0214s/iter; left time: 125.3487s
	iters: 500, epoch: 10 | loss: 0.2320722
	speed: 0.0214s/iter; left time: 123.4251s
Epoch: 10 cost time: 12.461288213729858
Epoch: 10, Steps: 570 | Train Loss: 0.2091234 Vali Loss: 0.0599943 Test Loss: 0.1690989
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1834012
	speed: 0.0598s/iter; left time: 334.8299s
	iters: 200, epoch: 11 | loss: 0.1807611
	speed: 0.0213s/iter; left time: 117.0462s
	iters: 300, epoch: 11 | loss: 0.1376544
	speed: 0.0213s/iter; left time: 115.0198s
	iters: 400, epoch: 11 | loss: 0.1764182
	speed: 0.0213s/iter; left time: 112.8554s
	iters: 500, epoch: 11 | loss: 0.1822242
	speed: 0.0213s/iter; left time: 110.9320s
Epoch: 11 cost time: 12.405365943908691
Epoch: 11, Steps: 570 | Train Loss: 0.2081567 Vali Loss: 0.0601298 Test Loss: 0.1693076
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2462718
	speed: 0.0605s/iter; left time: 304.2019s
	iters: 200, epoch: 12 | loss: 0.1744411
	speed: 0.0228s/iter; left time: 112.5262s
	iters: 300, epoch: 12 | loss: 0.3393806
	speed: 0.0228s/iter; left time: 110.0560s
	iters: 400, epoch: 12 | loss: 0.1140367
	speed: 0.0214s/iter; left time: 101.0166s
	iters: 500, epoch: 12 | loss: 0.2412114
	speed: 0.0214s/iter; left time: 99.0478s
Epoch: 12 cost time: 12.719259977340698
Epoch: 12, Steps: 570 | Train Loss: 0.2077105 Vali Loss: 0.0600915 Test Loss: 0.1693314
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16930536925792694, mae:0.26500973105430603
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.5048662
	speed: 0.0348s/iter; left time: 393.4610s
	iters: 200, epoch: 1 | loss: 0.1369040
	speed: 0.0224s/iter; left time: 250.8901s
	iters: 300, epoch: 1 | loss: 0.2355949
	speed: 0.0224s/iter; left time: 248.6666s
	iters: 400, epoch: 1 | loss: 0.2787115
	speed: 0.0224s/iter; left time: 246.3301s
	iters: 500, epoch: 1 | loss: 0.2199036
	speed: 0.0224s/iter; left time: 243.7099s
Epoch: 1 cost time: 14.058667421340942
Epoch: 1, Steps: 570 | Train Loss: 0.3321772 Vali Loss: 0.0685171 Test Loss: 0.1871986
Validation loss decreased (inf --> 0.068517).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2593084
	speed: 0.0616s/iter; left time: 661.5346s
	iters: 200, epoch: 2 | loss: 0.1782596
	speed: 0.0206s/iter; left time: 219.1538s
	iters: 300, epoch: 2 | loss: 0.3906453
	speed: 0.0206s/iter; left time: 217.0573s
	iters: 400, epoch: 2 | loss: 0.1749899
	speed: 0.0206s/iter; left time: 215.2865s
	iters: 500, epoch: 2 | loss: 0.2072232
	speed: 0.0206s/iter; left time: 212.9955s
Epoch: 2 cost time: 12.076322317123413
Epoch: 2, Steps: 570 | Train Loss: 0.2578903 Vali Loss: 0.0668498 Test Loss: 0.1912969
Validation loss decreased (0.068517 --> 0.066850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2249382
	speed: 0.0618s/iter; left time: 628.3880s
	iters: 200, epoch: 3 | loss: 0.1607056
	speed: 0.0207s/iter; left time: 208.3861s
	iters: 300, epoch: 3 | loss: 0.1565936
	speed: 0.0206s/iter; left time: 205.2988s
	iters: 400, epoch: 3 | loss: 0.1524085
	speed: 0.0206s/iter; left time: 202.8948s
	iters: 500, epoch: 3 | loss: 0.1550296
	speed: 0.0206s/iter; left time: 200.8311s
Epoch: 3 cost time: 12.060786962509155
Epoch: 3, Steps: 570 | Train Loss: 0.2275447 Vali Loss: 0.0636690 Test Loss: 0.1738327
Validation loss decreased (0.066850 --> 0.063669).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1582057
	speed: 0.0605s/iter; left time: 580.7175s
	iters: 200, epoch: 4 | loss: 0.2079531
	speed: 0.0206s/iter; left time: 195.5467s
	iters: 300, epoch: 4 | loss: 0.1579667
	speed: 0.0206s/iter; left time: 193.3662s
	iters: 400, epoch: 4 | loss: 0.2145253
	speed: 0.0206s/iter; left time: 191.0488s
	iters: 500, epoch: 4 | loss: 0.1629684
	speed: 0.0206s/iter; left time: 189.3363s
Epoch: 4 cost time: 12.028275728225708
Epoch: 4, Steps: 570 | Train Loss: 0.1952149 Vali Loss: 0.0597343 Test Loss: 0.1581925
Validation loss decreased (0.063669 --> 0.059734).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2804677
	speed: 0.0597s/iter; left time: 538.8806s
	iters: 200, epoch: 5 | loss: 0.1796376
	speed: 0.0206s/iter; left time: 183.4971s
	iters: 300, epoch: 5 | loss: 0.1583485
	speed: 0.0206s/iter; left time: 181.3023s
	iters: 400, epoch: 5 | loss: 0.1763235
	speed: 0.0206s/iter; left time: 179.2840s
	iters: 500, epoch: 5 | loss: 0.1554981
	speed: 0.0205s/iter; left time: 176.9939s
Epoch: 5 cost time: 12.021808385848999
Epoch: 5, Steps: 570 | Train Loss: 0.1784757 Vali Loss: 0.0619457 Test Loss: 0.1574815
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1472059
	speed: 0.0590s/iter; left time: 498.9621s
	iters: 200, epoch: 6 | loss: 0.1663551
	speed: 0.0205s/iter; left time: 171.3895s
	iters: 300, epoch: 6 | loss: 0.1644344
	speed: 0.0205s/iter; left time: 169.3114s
	iters: 400, epoch: 6 | loss: 0.1136185
	speed: 0.0205s/iter; left time: 167.3118s
	iters: 500, epoch: 6 | loss: 0.1272855
	speed: 0.0205s/iter; left time: 165.3388s
Epoch: 6 cost time: 12.013638973236084
Epoch: 6, Steps: 570 | Train Loss: 0.1690723 Vali Loss: 0.0634737 Test Loss: 0.1590462
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1238686
	speed: 0.0613s/iter; left time: 483.0819s
	iters: 200, epoch: 7 | loss: 0.1984115
	speed: 0.0206s/iter; left time: 160.0883s
	iters: 300, epoch: 7 | loss: 0.1817501
	speed: 0.0206s/iter; left time: 158.0131s
	iters: 400, epoch: 7 | loss: 0.1394706
	speed: 0.0206s/iter; left time: 155.9077s
	iters: 500, epoch: 7 | loss: 0.1559870
	speed: 0.0206s/iter; left time: 153.8108s
Epoch: 7 cost time: 12.005765676498413
Epoch: 7, Steps: 570 | Train Loss: 0.1623321 Vali Loss: 0.0616060 Test Loss: 0.1566058
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1584259569644928, mae:0.2586020827293396
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3459812
	speed: 0.0305s/iter; left time: 344.2893s
	iters: 200, epoch: 1 | loss: 0.2204933
	speed: 0.0189s/iter; left time: 211.7845s
	iters: 300, epoch: 1 | loss: 0.3470292
	speed: 0.0189s/iter; left time: 209.8168s
	iters: 400, epoch: 1 | loss: 0.3688976
	speed: 0.0189s/iter; left time: 208.2046s
	iters: 500, epoch: 1 | loss: 0.3242333
	speed: 0.0190s/iter; left time: 206.8872s
Epoch: 1 cost time: 12.0018630027771
Epoch: 1, Steps: 570 | Train Loss: 0.3072776 Vali Loss: 0.0635447 Test Loss: 0.1786053
Validation loss decreased (inf --> 0.063545).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1897742
	speed: 0.0589s/iter; left time: 631.5924s
	iters: 200, epoch: 2 | loss: 0.5891153
	speed: 0.0190s/iter; left time: 202.3055s
	iters: 300, epoch: 2 | loss: 0.2883355
	speed: 0.0191s/iter; left time: 201.0397s
	iters: 400, epoch: 2 | loss: 0.1507711
	speed: 0.0190s/iter; left time: 198.5945s
	iters: 500, epoch: 2 | loss: 0.1833827
	speed: 0.0190s/iter; left time: 196.2544s
Epoch: 2 cost time: 11.161938667297363
Epoch: 2, Steps: 570 | Train Loss: 0.2681090 Vali Loss: 0.0624694 Test Loss: 0.1786789
Validation loss decreased (0.063545 --> 0.062469).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1649375
	speed: 0.0606s/iter; left time: 615.6755s
	iters: 200, epoch: 3 | loss: 0.1788609
	speed: 0.0192s/iter; left time: 192.8960s
	iters: 300, epoch: 3 | loss: 0.1947482
	speed: 0.0193s/iter; left time: 191.8587s
	iters: 400, epoch: 3 | loss: 0.2425351
	speed: 0.0205s/iter; left time: 201.7787s
	iters: 500, epoch: 3 | loss: 0.2817035
	speed: 0.0209s/iter; left time: 204.0355s
Epoch: 3 cost time: 11.716686964035034
Epoch: 3, Steps: 570 | Train Loss: 0.2410358 Vali Loss: 0.0631183 Test Loss: 0.1702424
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1540900
	speed: 0.0571s/iter; left time: 547.3773s
	iters: 200, epoch: 4 | loss: 0.2941101
	speed: 0.0190s/iter; left time: 179.9596s
	iters: 300, epoch: 4 | loss: 0.1636501
	speed: 0.0190s/iter; left time: 177.9732s
	iters: 400, epoch: 4 | loss: 0.2417484
	speed: 0.0190s/iter; left time: 176.1851s
	iters: 500, epoch: 4 | loss: 0.1856163
	speed: 0.0189s/iter; left time: 174.0945s
Epoch: 4 cost time: 11.075124740600586
Epoch: 4, Steps: 570 | Train Loss: 0.2178987 Vali Loss: 0.0632832 Test Loss: 0.1700603
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1762531
	speed: 0.0558s/iter; left time: 503.4598s
	iters: 200, epoch: 5 | loss: 0.3220015
	speed: 0.0189s/iter; left time: 168.9900s
	iters: 300, epoch: 5 | loss: 0.1489344
	speed: 0.0190s/iter; left time: 167.6524s
	iters: 400, epoch: 5 | loss: 0.1708648
	speed: 0.0190s/iter; left time: 165.3145s
	iters: 500, epoch: 5 | loss: 0.1593254
	speed: 0.0190s/iter; left time: 163.3905s
Epoch: 5 cost time: 11.076996564865112
Epoch: 5, Steps: 570 | Train Loss: 0.2111658 Vali Loss: 0.0593761 Test Loss: 0.1635990
Validation loss decreased (0.062469 --> 0.059376).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2397203
	speed: 0.0564s/iter; left time: 476.5202s
	iters: 200, epoch: 6 | loss: 0.2457219
	speed: 0.0189s/iter; left time: 158.2310s
	iters: 300, epoch: 6 | loss: 0.1633635
	speed: 0.0189s/iter; left time: 155.8967s
	iters: 400, epoch: 6 | loss: 0.1521265
	speed: 0.0189s/iter; left time: 154.2069s
	iters: 500, epoch: 6 | loss: 0.2515264
	speed: 0.0195s/iter; left time: 157.2770s
Epoch: 6 cost time: 11.294106483459473
Epoch: 6, Steps: 570 | Train Loss: 0.2006975 Vali Loss: 0.0586759 Test Loss: 0.1642092
Validation loss decreased (0.059376 --> 0.058676).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2224349
	speed: 0.0607s/iter; left time: 478.2777s
	iters: 200, epoch: 7 | loss: 0.2338411
	speed: 0.0189s/iter; left time: 147.0338s
	iters: 300, epoch: 7 | loss: 0.2719557
	speed: 0.0189s/iter; left time: 144.9113s
	iters: 400, epoch: 7 | loss: 0.3161416
	speed: 0.0189s/iter; left time: 143.3217s
	iters: 500, epoch: 7 | loss: 0.1665621
	speed: 0.0190s/iter; left time: 141.8032s
Epoch: 7 cost time: 11.12330150604248
Epoch: 7, Steps: 570 | Train Loss: 0.1945284 Vali Loss: 0.0596985 Test Loss: 0.1651743
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2725866
	speed: 0.0559s/iter; left time: 408.9454s
	iters: 200, epoch: 8 | loss: 0.2585613
	speed: 0.0190s/iter; left time: 136.8215s
	iters: 300, epoch: 8 | loss: 0.2563990
	speed: 0.0190s/iter; left time: 135.0441s
	iters: 400, epoch: 8 | loss: 0.1603610
	speed: 0.0190s/iter; left time: 133.2683s
	iters: 500, epoch: 8 | loss: 0.2072012
	speed: 0.0190s/iter; left time: 131.4145s
Epoch: 8 cost time: 11.07132077217102
Epoch: 8, Steps: 570 | Train Loss: 0.1912372 Vali Loss: 0.0585950 Test Loss: 0.1643800
Validation loss decreased (0.058676 --> 0.058595).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1484015
	speed: 0.0599s/iter; left time: 403.6408s
	iters: 200, epoch: 9 | loss: 0.1572453
	speed: 0.0189s/iter; left time: 125.8209s
	iters: 300, epoch: 9 | loss: 0.2903929
	speed: 0.0189s/iter; left time: 123.5534s
	iters: 400, epoch: 9 | loss: 0.1727037
	speed: 0.0189s/iter; left time: 121.9342s
	iters: 500, epoch: 9 | loss: 0.1098155
	speed: 0.0189s/iter; left time: 120.0428s
Epoch: 9 cost time: 11.056737422943115
Epoch: 9, Steps: 570 | Train Loss: 0.1892703 Vali Loss: 0.0585207 Test Loss: 0.1643788
Validation loss decreased (0.058595 --> 0.058521).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2391348
	speed: 0.0581s/iter; left time: 358.4766s
	iters: 200, epoch: 10 | loss: 0.1191047
	speed: 0.0189s/iter; left time: 114.8620s
	iters: 300, epoch: 10 | loss: 0.2457750
	speed: 0.0189s/iter; left time: 112.8502s
	iters: 400, epoch: 10 | loss: 0.2172185
	speed: 0.0189s/iter; left time: 110.8236s
	iters: 500, epoch: 10 | loss: 0.1814567
	speed: 0.0189s/iter; left time: 108.8034s
Epoch: 10 cost time: 11.030076265335083
Epoch: 10, Steps: 570 | Train Loss: 0.1883511 Vali Loss: 0.0584853 Test Loss: 0.1639752
Validation loss decreased (0.058521 --> 0.058485).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1710032
	speed: 0.0572s/iter; left time: 320.1464s
	iters: 200, epoch: 11 | loss: 0.1714001
	speed: 0.0189s/iter; left time: 103.9846s
	iters: 300, epoch: 11 | loss: 0.1431176
	speed: 0.0189s/iter; left time: 102.1294s
	iters: 400, epoch: 11 | loss: 0.2365137
	speed: 0.0189s/iter; left time: 100.0444s
	iters: 500, epoch: 11 | loss: 0.1492564
	speed: 0.0189s/iter; left time: 98.0806s
Epoch: 11 cost time: 11.048706769943237
Epoch: 11, Steps: 570 | Train Loss: 0.1880311 Vali Loss: 0.0585991 Test Loss: 0.1641587
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1611707
	speed: 0.0556s/iter; left time: 279.8559s
	iters: 200, epoch: 12 | loss: 0.1814352
	speed: 0.0189s/iter; left time: 93.2477s
	iters: 300, epoch: 12 | loss: 0.3350646
	speed: 0.0189s/iter; left time: 91.2981s
	iters: 400, epoch: 12 | loss: 0.2441531
	speed: 0.0189s/iter; left time: 89.3126s
	iters: 500, epoch: 12 | loss: 0.2772302
	speed: 0.0189s/iter; left time: 87.4272s
Epoch: 12 cost time: 11.025453090667725
Epoch: 12, Steps: 570 | Train Loss: 0.1877626 Vali Loss: 0.0584666 Test Loss: 0.1642219
Validation loss decreased (0.058485 --> 0.058467).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1725542
	speed: 0.0571s/iter; left time: 254.9167s
	iters: 200, epoch: 13 | loss: 0.1736616
	speed: 0.0189s/iter; left time: 82.5101s
	iters: 300, epoch: 13 | loss: 0.1994443
	speed: 0.0189s/iter; left time: 80.6705s
	iters: 400, epoch: 13 | loss: 0.1422995
	speed: 0.0189s/iter; left time: 78.6675s
	iters: 500, epoch: 13 | loss: 0.1748704
	speed: 0.0189s/iter; left time: 76.7632s
Epoch: 13 cost time: 11.070146083831787
Epoch: 13, Steps: 570 | Train Loss: 0.1873977 Vali Loss: 0.0586605 Test Loss: 0.1642319
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2812103
	speed: 0.0560s/iter; left time: 217.9010s
	iters: 200, epoch: 14 | loss: 0.2077650
	speed: 0.0190s/iter; left time: 71.8791s
	iters: 300, epoch: 14 | loss: 0.1620535
	speed: 0.0189s/iter; left time: 69.7771s
	iters: 400, epoch: 14 | loss: 0.1186182
	speed: 0.0188s/iter; left time: 67.6851s
	iters: 500, epoch: 14 | loss: 0.1526008
	speed: 0.0189s/iter; left time: 65.8300s
Epoch: 14 cost time: 11.048658847808838
Epoch: 14, Steps: 570 | Train Loss: 0.1874303 Vali Loss: 0.0584769 Test Loss: 0.1642397
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1220352
	speed: 0.0588s/iter; left time: 195.2897s
	iters: 200, epoch: 15 | loss: 0.2429871
	speed: 0.0203s/iter; left time: 65.3831s
	iters: 300, epoch: 15 | loss: 0.1776120
	speed: 0.0190s/iter; left time: 59.2424s
	iters: 400, epoch: 15 | loss: 0.1808693
	speed: 0.0190s/iter; left time: 57.3458s
	iters: 500, epoch: 15 | loss: 0.1404826
	speed: 0.0190s/iter; left time: 55.4263s
Epoch: 15 cost time: 11.469205141067505
Epoch: 15, Steps: 570 | Train Loss: 0.1875341 Vali Loss: 0.0586241 Test Loss: 0.1642427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16442342102527618, mae:0.2625240385532379
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1777191
	speed: 0.0238s/iter; left time: 268.9202s
	iters: 200, epoch: 1 | loss: 0.1935108
	speed: 0.0121s/iter; left time: 135.5033s
	iters: 300, epoch: 1 | loss: 0.2110804
	speed: 0.0121s/iter; left time: 134.6341s
	iters: 400, epoch: 1 | loss: 0.2278834
	speed: 0.0110s/iter; left time: 121.5409s
	iters: 500, epoch: 1 | loss: 0.2286975
	speed: 0.0106s/iter; left time: 115.3439s
Epoch: 1 cost time: 7.752419710159302
Epoch: 1, Steps: 570 | Train Loss: 0.2393754 Vali Loss: 0.0499301 Test Loss: 0.1551164
Validation loss decreased (inf --> 0.049930).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3729154
	speed: 0.0368s/iter; left time: 394.4019s
	iters: 200, epoch: 2 | loss: 0.3245559
	speed: 0.0105s/iter; left time: 111.3671s
	iters: 300, epoch: 2 | loss: 0.2269728
	speed: 0.0104s/iter; left time: 109.8291s
	iters: 400, epoch: 2 | loss: 0.1790629
	speed: 0.0105s/iter; left time: 109.1040s
	iters: 500, epoch: 2 | loss: 0.2005681
	speed: 0.0105s/iter; left time: 108.0501s
Epoch: 2 cost time: 6.268818378448486
Epoch: 2, Steps: 570 | Train Loss: 0.2194005 Vali Loss: 0.0467984 Test Loss: 0.1458801
Validation loss decreased (0.049930 --> 0.046798).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1609079
	speed: 0.0380s/iter; left time: 386.5270s
	iters: 200, epoch: 3 | loss: 0.2279218
	speed: 0.0120s/iter; left time: 120.7985s
	iters: 300, epoch: 3 | loss: 0.1517598
	speed: 0.0120s/iter; left time: 119.9730s
	iters: 400, epoch: 3 | loss: 0.1926924
	speed: 0.0120s/iter; left time: 118.7692s
	iters: 500, epoch: 3 | loss: 0.2619040
	speed: 0.0105s/iter; left time: 102.9504s
Epoch: 3 cost time: 6.8958868980407715
Epoch: 3, Steps: 570 | Train Loss: 0.1928285 Vali Loss: 0.0434940 Test Loss: 0.1316906
Validation loss decreased (0.046798 --> 0.043494).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1974011
	speed: 0.0361s/iter; left time: 346.2621s
	iters: 200, epoch: 4 | loss: 0.0997751
	speed: 0.0106s/iter; left time: 100.1460s
	iters: 300, epoch: 4 | loss: 0.1813466
	speed: 0.0106s/iter; left time: 99.9863s
	iters: 400, epoch: 4 | loss: 0.1814042
	speed: 0.0107s/iter; left time: 98.9833s
	iters: 500, epoch: 4 | loss: 0.1456451
	speed: 0.0106s/iter; left time: 97.3676s
Epoch: 4 cost time: 6.322227239608765
Epoch: 4, Steps: 570 | Train Loss: 0.1741642 Vali Loss: 0.0419364 Test Loss: 0.1319740
Validation loss decreased (0.043494 --> 0.041936).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2005041
	speed: 0.0374s/iter; left time: 337.3694s
	iters: 200, epoch: 5 | loss: 0.1612382
	speed: 0.0106s/iter; left time: 94.3749s
	iters: 300, epoch: 5 | loss: 0.1828484
	speed: 0.0106s/iter; left time: 93.2346s
	iters: 400, epoch: 5 | loss: 0.1539630
	speed: 0.0106s/iter; left time: 92.3336s
	iters: 500, epoch: 5 | loss: 0.1531187
	speed: 0.0106s/iter; left time: 91.4658s
Epoch: 5 cost time: 6.323783874511719
Epoch: 5, Steps: 570 | Train Loss: 0.1631698 Vali Loss: 0.0412901 Test Loss: 0.1334837
Validation loss decreased (0.041936 --> 0.041290).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1511397
	speed: 0.0362s/iter; left time: 305.8715s
	iters: 200, epoch: 6 | loss: 0.1123220
	speed: 0.0105s/iter; left time: 88.0235s
	iters: 300, epoch: 6 | loss: 0.2148315
	speed: 0.0105s/iter; left time: 86.9359s
	iters: 400, epoch: 6 | loss: 0.1687021
	speed: 0.0106s/iter; left time: 86.1881s
	iters: 500, epoch: 6 | loss: 0.1469876
	speed: 0.0106s/iter; left time: 85.1792s
Epoch: 6 cost time: 6.304595708847046
Epoch: 6, Steps: 570 | Train Loss: 0.1537006 Vali Loss: 0.0401119 Test Loss: 0.1313482
Validation loss decreased (0.041290 --> 0.040112).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1674063
	speed: 0.0362s/iter; left time: 285.6566s
	iters: 200, epoch: 7 | loss: 0.2014802
	speed: 0.0106s/iter; left time: 82.4307s
	iters: 300, epoch: 7 | loss: 0.1516421
	speed: 0.0106s/iter; left time: 81.3933s
	iters: 400, epoch: 7 | loss: 0.1144426
	speed: 0.0106s/iter; left time: 80.2846s
	iters: 500, epoch: 7 | loss: 0.1227431
	speed: 0.0106s/iter; left time: 79.2461s
Epoch: 7 cost time: 6.340215682983398
Epoch: 7, Steps: 570 | Train Loss: 0.1511042 Vali Loss: 0.0403949 Test Loss: 0.1302827
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1535092
	speed: 0.0360s/iter; left time: 263.0849s
	iters: 200, epoch: 8 | loss: 0.1330004
	speed: 0.0105s/iter; left time: 75.5065s
	iters: 300, epoch: 8 | loss: 0.1745556
	speed: 0.0105s/iter; left time: 74.3918s
	iters: 400, epoch: 8 | loss: 0.2076908
	speed: 0.0105s/iter; left time: 73.3394s
	iters: 500, epoch: 8 | loss: 0.1386951
	speed: 0.0105s/iter; left time: 72.4341s
Epoch: 8 cost time: 6.258642673492432
Epoch: 8, Steps: 570 | Train Loss: 0.1473867 Vali Loss: 0.0400983 Test Loss: 0.1308237
Validation loss decreased (0.040112 --> 0.040098).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2033126
	speed: 0.0361s/iter; left time: 243.0848s
	iters: 200, epoch: 9 | loss: 0.1391253
	speed: 0.0105s/iter; left time: 69.8943s
	iters: 300, epoch: 9 | loss: 0.0781884
	speed: 0.0105s/iter; left time: 68.8972s
	iters: 400, epoch: 9 | loss: 0.1423060
	speed: 0.0105s/iter; left time: 67.9119s
	iters: 500, epoch: 9 | loss: 0.1406676
	speed: 0.0105s/iter; left time: 66.5778s
Epoch: 9 cost time: 6.297163248062134
Epoch: 9, Steps: 570 | Train Loss: 0.1468509 Vali Loss: 0.0405770 Test Loss: 0.1315916
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1316060
	speed: 0.0358s/iter; left time: 221.1025s
	iters: 200, epoch: 10 | loss: 0.1492279
	speed: 0.0106s/iter; left time: 64.1196s
	iters: 300, epoch: 10 | loss: 0.1004063
	speed: 0.0106s/iter; left time: 63.1361s
	iters: 400, epoch: 10 | loss: 0.1272062
	speed: 0.0106s/iter; left time: 62.0683s
	iters: 500, epoch: 10 | loss: 0.1947585
	speed: 0.0106s/iter; left time: 61.0463s
Epoch: 10 cost time: 6.268905878067017
Epoch: 10, Steps: 570 | Train Loss: 0.1463307 Vali Loss: 0.0401553 Test Loss: 0.1311446
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1390495
	speed: 0.0360s/iter; left time: 201.4882s
	iters: 200, epoch: 11 | loss: 0.1162399
	speed: 0.0105s/iter; left time: 57.8756s
	iters: 300, epoch: 11 | loss: 0.1146599
	speed: 0.0105s/iter; left time: 56.8185s
	iters: 400, epoch: 11 | loss: 0.1900888
	speed: 0.0106s/iter; left time: 55.9588s
	iters: 500, epoch: 11 | loss: 0.1377741
	speed: 0.0105s/iter; left time: 54.4807s
Epoch: 11 cost time: 6.2658257484436035
Epoch: 11, Steps: 570 | Train Loss: 0.1467670 Vali Loss: 0.0401198 Test Loss: 0.1309380
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1310017704963684, mae:0.22413523495197296
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2011288
	speed: 0.0234s/iter; left time: 264.7549s
	iters: 200, epoch: 1 | loss: 0.2121019
	speed: 0.0116s/iter; left time: 129.9359s
	iters: 300, epoch: 1 | loss: 0.2554605
	speed: 0.0116s/iter; left time: 129.1522s
	iters: 400, epoch: 1 | loss: 0.2007774
	speed: 0.0116s/iter; left time: 127.6245s
	iters: 500, epoch: 1 | loss: 0.1596668
	speed: 0.0116s/iter; left time: 126.9803s
Epoch: 1 cost time: 7.8594982624053955
Epoch: 1, Steps: 570 | Train Loss: 0.1986092 Vali Loss: 0.0408514 Test Loss: 0.1363988
Validation loss decreased (inf --> 0.040851).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1544909
	speed: 0.0371s/iter; left time: 397.6135s
	iters: 200, epoch: 2 | loss: 0.1977520
	speed: 0.0103s/iter; left time: 109.6560s
	iters: 300, epoch: 2 | loss: 0.1335832
	speed: 0.0103s/iter; left time: 108.2704s
	iters: 400, epoch: 2 | loss: 0.1909222
	speed: 0.0103s/iter; left time: 107.4477s
	iters: 500, epoch: 2 | loss: 0.1895629
	speed: 0.0103s/iter; left time: 106.2021s
Epoch: 2 cost time: 6.185486078262329
Epoch: 2, Steps: 570 | Train Loss: 0.1816486 Vali Loss: 0.0411289 Test Loss: 0.1282441
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0831251
	speed: 0.0361s/iter; left time: 366.9576s
	iters: 200, epoch: 3 | loss: 0.1447144
	speed: 0.0103s/iter; left time: 103.5916s
	iters: 300, epoch: 3 | loss: 0.3137289
	speed: 0.0103s/iter; left time: 102.4793s
	iters: 400, epoch: 3 | loss: 0.1911944
	speed: 0.0103s/iter; left time: 101.5514s
	iters: 500, epoch: 3 | loss: 0.1429696
	speed: 0.0103s/iter; left time: 100.7683s
Epoch: 3 cost time: 6.148857831954956
Epoch: 3, Steps: 570 | Train Loss: 0.1624195 Vali Loss: 0.0374713 Test Loss: 0.1170176
Validation loss decreased (0.040851 --> 0.037471).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1103782
	speed: 0.0380s/iter; left time: 364.3522s
	iters: 200, epoch: 4 | loss: 0.1187697
	speed: 0.0103s/iter; left time: 97.8902s
	iters: 300, epoch: 4 | loss: 0.0884880
	speed: 0.0103s/iter; left time: 96.6539s
	iters: 400, epoch: 4 | loss: 0.0976685
	speed: 0.0103s/iter; left time: 95.2522s
	iters: 500, epoch: 4 | loss: 0.1811225
	speed: 0.0103s/iter; left time: 94.2544s
Epoch: 4 cost time: 6.189178943634033
Epoch: 4, Steps: 570 | Train Loss: 0.1434960 Vali Loss: 0.0341161 Test Loss: 0.1104835
Validation loss decreased (0.037471 --> 0.034116).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1103035
	speed: 0.0359s/iter; left time: 323.9673s
	iters: 200, epoch: 5 | loss: 0.1790779
	speed: 0.0103s/iter; left time: 91.6705s
	iters: 300, epoch: 5 | loss: 0.1173813
	speed: 0.0103s/iter; left time: 90.6466s
	iters: 400, epoch: 5 | loss: 0.1384535
	speed: 0.0103s/iter; left time: 89.5840s
	iters: 500, epoch: 5 | loss: 0.1380685
	speed: 0.0103s/iter; left time: 88.5185s
Epoch: 5 cost time: 6.165667533874512
Epoch: 5, Steps: 570 | Train Loss: 0.1332018 Vali Loss: 0.0354310 Test Loss: 0.1137024
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0893482
	speed: 0.0369s/iter; left time: 311.9228s
	iters: 200, epoch: 6 | loss: 0.1794420
	speed: 0.0103s/iter; left time: 86.1360s
	iters: 300, epoch: 6 | loss: 0.1483492
	speed: 0.0103s/iter; left time: 84.7973s
	iters: 400, epoch: 6 | loss: 0.0914391
	speed: 0.0103s/iter; left time: 83.9036s
	iters: 500, epoch: 6 | loss: 0.0890388
	speed: 0.0103s/iter; left time: 82.7081s
Epoch: 6 cost time: 6.1496453285217285
Epoch: 6, Steps: 570 | Train Loss: 0.1277808 Vali Loss: 0.0344818 Test Loss: 0.1114692
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1217993
	speed: 0.0355s/iter; left time: 279.9894s
	iters: 200, epoch: 7 | loss: 0.1507055
	speed: 0.0103s/iter; left time: 80.1510s
	iters: 300, epoch: 7 | loss: 0.2469890
	speed: 0.0103s/iter; left time: 79.0531s
	iters: 400, epoch: 7 | loss: 0.1859451
	speed: 0.0103s/iter; left time: 77.9231s
	iters: 500, epoch: 7 | loss: 0.1438853
	speed: 0.0103s/iter; left time: 76.9853s
Epoch: 7 cost time: 6.158804178237915
Epoch: 7, Steps: 570 | Train Loss: 0.1256190 Vali Loss: 0.0339808 Test Loss: 0.1099915
Validation loss decreased (0.034116 --> 0.033981).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1184343
	speed: 0.0358s/iter; left time: 261.7182s
	iters: 200, epoch: 8 | loss: 0.0885658
	speed: 0.0103s/iter; left time: 74.2666s
	iters: 300, epoch: 8 | loss: 0.1112555
	speed: 0.0103s/iter; left time: 73.0912s
	iters: 400, epoch: 8 | loss: 0.1127180
	speed: 0.0103s/iter; left time: 71.9605s
	iters: 500, epoch: 8 | loss: 0.0920499
	speed: 0.0103s/iter; left time: 70.9784s
Epoch: 8 cost time: 6.137487411499023
Epoch: 8, Steps: 570 | Train Loss: 0.1232764 Vali Loss: 0.0343710 Test Loss: 0.1123049
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1152850
	speed: 0.0364s/iter; left time: 245.5019s
	iters: 200, epoch: 9 | loss: 0.1366268
	speed: 0.0103s/iter; left time: 68.2267s
	iters: 300, epoch: 9 | loss: 0.1035083
	speed: 0.0103s/iter; left time: 67.0681s
	iters: 400, epoch: 9 | loss: 0.1578759
	speed: 0.0102s/iter; left time: 65.9932s
	iters: 500, epoch: 9 | loss: 0.1022582
	speed: 0.0103s/iter; left time: 65.0175s
Epoch: 9 cost time: 6.108844041824341
Epoch: 9, Steps: 570 | Train Loss: 0.1214196 Vali Loss: 0.0341249 Test Loss: 0.1114252
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1141844
	speed: 0.0368s/iter; left time: 227.3996s
	iters: 200, epoch: 10 | loss: 0.1014069
	speed: 0.0104s/iter; left time: 62.9745s
	iters: 300, epoch: 10 | loss: 0.1240180
	speed: 0.0103s/iter; left time: 61.6584s
	iters: 400, epoch: 10 | loss: 0.0875974
	speed: 0.0104s/iter; left time: 60.7895s
	iters: 500, epoch: 10 | loss: 0.0761100
	speed: 0.0103s/iter; left time: 59.7288s
Epoch: 10 cost time: 6.301466464996338
Epoch: 10, Steps: 570 | Train Loss: 0.1217547 Vali Loss: 0.0341139 Test Loss: 0.1113909
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11014990508556366, mae:0.20213402807712555
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2760210
	speed: 0.0218s/iter; left time: 246.7949s
	iters: 200, epoch: 1 | loss: 0.1569620
	speed: 0.0102s/iter; left time: 114.5410s
	iters: 300, epoch: 1 | loss: 0.1703339
	speed: 0.0102s/iter; left time: 113.7514s
	iters: 400, epoch: 1 | loss: 0.1834075
	speed: 0.0102s/iter; left time: 112.4777s
	iters: 500, epoch: 1 | loss: 0.2316654
	speed: 0.0103s/iter; left time: 112.0850s
Epoch: 1 cost time: 7.05786395072937
Epoch: 1, Steps: 570 | Train Loss: 0.2487522 Vali Loss: 0.0535518 Test Loss: 0.1598241
Validation loss decreased (inf --> 0.053552).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2102094
	speed: 0.0360s/iter; left time: 386.6367s
	iters: 200, epoch: 2 | loss: 0.5037255
	speed: 0.0103s/iter; left time: 109.4009s
	iters: 300, epoch: 2 | loss: 0.3371377
	speed: 0.0103s/iter; left time: 108.5280s
	iters: 400, epoch: 2 | loss: 0.4152882
	speed: 0.0103s/iter; left time: 107.2727s
	iters: 500, epoch: 2 | loss: 0.3067176
	speed: 0.0103s/iter; left time: 106.6653s
Epoch: 2 cost time: 6.172447443008423
Epoch: 2, Steps: 570 | Train Loss: 0.2717112 Vali Loss: 0.0605821 Test Loss: 0.1763985
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1737072
	speed: 0.0380s/iter; left time: 385.7898s
	iters: 200, epoch: 3 | loss: 0.2173738
	speed: 0.0104s/iter; left time: 104.3124s
	iters: 300, epoch: 3 | loss: 0.3133671
	speed: 0.0103s/iter; left time: 102.8407s
	iters: 400, epoch: 3 | loss: 0.2098190
	speed: 0.0103s/iter; left time: 101.2277s
	iters: 500, epoch: 3 | loss: 0.2057551
	speed: 0.0103s/iter; left time: 100.2669s
Epoch: 3 cost time: 6.175764560699463
Epoch: 3, Steps: 570 | Train Loss: 0.2512181 Vali Loss: 0.0534191 Test Loss: 0.1621263
Validation loss decreased (0.053552 --> 0.053419).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1413024
	speed: 0.0377s/iter; left time: 361.4350s
	iters: 200, epoch: 4 | loss: 0.1723188
	speed: 0.0102s/iter; left time: 97.0642s
	iters: 300, epoch: 4 | loss: 0.1920038
	speed: 0.0103s/iter; left time: 96.3669s
	iters: 400, epoch: 4 | loss: 0.3015375
	speed: 0.0103s/iter; left time: 95.4532s
	iters: 500, epoch: 4 | loss: 0.1878215
	speed: 0.0103s/iter; left time: 94.6603s
Epoch: 4 cost time: 6.114684104919434
Epoch: 4, Steps: 570 | Train Loss: 0.2239809 Vali Loss: 0.0535721 Test Loss: 0.1619853
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2102711
	speed: 0.0357s/iter; left time: 321.8175s
	iters: 200, epoch: 5 | loss: 0.1812565
	speed: 0.0103s/iter; left time: 91.6078s
	iters: 300, epoch: 5 | loss: 0.2270057
	speed: 0.0103s/iter; left time: 90.7893s
	iters: 400, epoch: 5 | loss: 0.1802817
	speed: 0.0103s/iter; left time: 89.6809s
	iters: 500, epoch: 5 | loss: 0.3264125
	speed: 0.0103s/iter; left time: 88.4506s
Epoch: 5 cost time: 6.129375219345093
Epoch: 5, Steps: 570 | Train Loss: 0.2111830 Vali Loss: 0.0497295 Test Loss: 0.1540494
Validation loss decreased (0.053419 --> 0.049729).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1856858
	speed: 0.0377s/iter; left time: 318.7472s
	iters: 200, epoch: 6 | loss: 0.2089431
	speed: 0.0104s/iter; left time: 86.6383s
	iters: 300, epoch: 6 | loss: 0.1692455
	speed: 0.0104s/iter; left time: 85.6884s
	iters: 400, epoch: 6 | loss: 0.1765668
	speed: 0.0104s/iter; left time: 84.6236s
	iters: 500, epoch: 6 | loss: 0.2485469
	speed: 0.0104s/iter; left time: 83.5188s
Epoch: 6 cost time: 6.188523054122925
Epoch: 6, Steps: 570 | Train Loss: 0.2018977 Vali Loss: 0.0494379 Test Loss: 0.1522202
Validation loss decreased (0.049729 --> 0.049438).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1340874
	speed: 0.0378s/iter; left time: 298.2077s
	iters: 200, epoch: 7 | loss: 0.1357253
	speed: 0.0103s/iter; left time: 79.9638s
	iters: 300, epoch: 7 | loss: 0.1856140
	speed: 0.0103s/iter; left time: 79.0075s
	iters: 400, epoch: 7 | loss: 0.1292744
	speed: 0.0103s/iter; left time: 77.8833s
	iters: 500, epoch: 7 | loss: 0.2150543
	speed: 0.0103s/iter; left time: 76.7577s
Epoch: 7 cost time: 6.143115758895874
Epoch: 7, Steps: 570 | Train Loss: 0.1983729 Vali Loss: 0.0494550 Test Loss: 0.1508071
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1108174
	speed: 0.0370s/iter; left time: 270.3019s
	iters: 200, epoch: 8 | loss: 0.1593016
	speed: 0.0103s/iter; left time: 73.9682s
	iters: 300, epoch: 8 | loss: 0.1904207
	speed: 0.0103s/iter; left time: 73.0146s
	iters: 400, epoch: 8 | loss: 0.1893917
	speed: 0.0103s/iter; left time: 72.1365s
	iters: 500, epoch: 8 | loss: 0.1773364
	speed: 0.0102s/iter; left time: 70.8345s
Epoch: 8 cost time: 6.121063470840454
Epoch: 8, Steps: 570 | Train Loss: 0.1954682 Vali Loss: 0.0490171 Test Loss: 0.1501433
Validation loss decreased (0.049438 --> 0.049017).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1811720
	speed: 0.0362s/iter; left time: 244.1310s
	iters: 200, epoch: 9 | loss: 0.2337634
	speed: 0.0102s/iter; left time: 68.0644s
	iters: 300, epoch: 9 | loss: 0.1826662
	speed: 0.0102s/iter; left time: 67.0384s
	iters: 400, epoch: 9 | loss: 0.1685027
	speed: 0.0103s/iter; left time: 66.0676s
	iters: 500, epoch: 9 | loss: 0.2114587
	speed: 0.0103s/iter; left time: 65.1635s
Epoch: 9 cost time: 6.162268400192261
Epoch: 9, Steps: 570 | Train Loss: 0.1932855 Vali Loss: 0.0489839 Test Loss: 0.1497300
Validation loss decreased (0.049017 --> 0.048984).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1468959
	speed: 0.0360s/iter; left time: 222.2793s
	iters: 200, epoch: 10 | loss: 0.2943932
	speed: 0.0104s/iter; left time: 62.8841s
	iters: 300, epoch: 10 | loss: 0.2734065
	speed: 0.0103s/iter; left time: 61.6084s
	iters: 400, epoch: 10 | loss: 0.2248660
	speed: 0.0103s/iter; left time: 60.4980s
	iters: 500, epoch: 10 | loss: 0.2291971
	speed: 0.0103s/iter; left time: 59.6292s
Epoch: 10 cost time: 6.2003562450408936
Epoch: 10, Steps: 570 | Train Loss: 0.1929867 Vali Loss: 0.0490412 Test Loss: 0.1497344
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2016304
	speed: 0.0355s/iter; left time: 198.9469s
	iters: 200, epoch: 11 | loss: 0.1890531
	speed: 0.0104s/iter; left time: 57.2362s
	iters: 300, epoch: 11 | loss: 0.2562253
	speed: 0.0104s/iter; left time: 56.0980s
	iters: 400, epoch: 11 | loss: 0.1936106
	speed: 0.0104s/iter; left time: 54.9590s
	iters: 500, epoch: 11 | loss: 0.1959444
	speed: 0.0103s/iter; left time: 53.5385s
Epoch: 11 cost time: 6.196860074996948
Epoch: 11, Steps: 570 | Train Loss: 0.1928420 Vali Loss: 0.0488997 Test Loss: 0.1497000
Validation loss decreased (0.048984 --> 0.048900).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1751735
	speed: 0.0363s/iter; left time: 182.3906s
	iters: 200, epoch: 12 | loss: 0.2051178
	speed: 0.0103s/iter; left time: 50.6253s
	iters: 300, epoch: 12 | loss: 0.1418368
	speed: 0.0103s/iter; left time: 49.6258s
	iters: 400, epoch: 12 | loss: 0.1730569
	speed: 0.0103s/iter; left time: 48.4953s
	iters: 500, epoch: 12 | loss: 0.0879592
	speed: 0.0103s/iter; left time: 47.4730s
Epoch: 12 cost time: 6.13531494140625
Epoch: 12, Steps: 570 | Train Loss: 0.1935263 Vali Loss: 0.0489174 Test Loss: 0.1497241
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1612099
	speed: 0.0367s/iter; left time: 163.8705s
	iters: 200, epoch: 13 | loss: 0.2018778
	speed: 0.0103s/iter; left time: 44.9823s
	iters: 300, epoch: 13 | loss: 0.1750134
	speed: 0.0103s/iter; left time: 43.9811s
	iters: 400, epoch: 13 | loss: 0.2200643
	speed: 0.0103s/iter; left time: 43.0243s
	iters: 500, epoch: 13 | loss: 0.1767964
	speed: 0.0103s/iter; left time: 41.9909s
Epoch: 13 cost time: 6.167438507080078
Epoch: 13, Steps: 570 | Train Loss: 0.1924223 Vali Loss: 0.0490513 Test Loss: 0.1496656
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1728437
	speed: 0.0365s/iter; left time: 142.1364s
	iters: 200, epoch: 14 | loss: 0.2402483
	speed: 0.0102s/iter; left time: 38.8365s
	iters: 300, epoch: 14 | loss: 0.1398079
	speed: 0.0103s/iter; left time: 37.8496s
	iters: 400, epoch: 14 | loss: 0.1153657
	speed: 0.0103s/iter; left time: 36.8432s
	iters: 500, epoch: 14 | loss: 0.2750791
	speed: 0.0103s/iter; left time: 35.8245s
Epoch: 14 cost time: 6.112223863601685
Epoch: 14, Steps: 570 | Train Loss: 0.1909967 Vali Loss: 0.0488073 Test Loss: 0.1496678
Validation loss decreased (0.048900 --> 0.048807).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1617509
	speed: 0.0367s/iter; left time: 121.7193s
	iters: 200, epoch: 15 | loss: 0.2353400
	speed: 0.0103s/iter; left time: 33.2493s
	iters: 300, epoch: 15 | loss: 0.1058330
	speed: 0.0103s/iter; left time: 32.2646s
	iters: 400, epoch: 15 | loss: 0.0849429
	speed: 0.0103s/iter; left time: 31.1705s
	iters: 500, epoch: 15 | loss: 0.2182889
	speed: 0.0103s/iter; left time: 30.1941s
Epoch: 15 cost time: 6.192059516906738
Epoch: 15, Steps: 570 | Train Loss: 0.1929903 Vali Loss: 0.0488566 Test Loss: 0.1496770
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.1995316
	speed: 0.0355s/iter; left time: 97.7388s
	iters: 200, epoch: 16 | loss: 0.1273779
	speed: 0.0103s/iter; left time: 27.2695s
	iters: 300, epoch: 16 | loss: 0.1738085
	speed: 0.0103s/iter; left time: 26.1546s
	iters: 400, epoch: 16 | loss: 0.1989763
	speed: 0.0103s/iter; left time: 25.1810s
	iters: 500, epoch: 16 | loss: 0.1810515
	speed: 0.0103s/iter; left time: 24.1620s
Epoch: 16 cost time: 6.131420850753784
Epoch: 16, Steps: 570 | Train Loss: 0.1922915 Vali Loss: 0.0491062 Test Loss: 0.1496811
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.1572271
	speed: 0.0375s/iter; left time: 81.7958s
	iters: 200, epoch: 17 | loss: 0.1318000
	speed: 0.0116s/iter; left time: 24.1305s
	iters: 300, epoch: 17 | loss: 0.1215536
	speed: 0.0116s/iter; left time: 22.9077s
	iters: 400, epoch: 17 | loss: 0.1946611
	speed: 0.0116s/iter; left time: 21.8021s
	iters: 500, epoch: 17 | loss: 0.1164205
	speed: 0.0116s/iter; left time: 20.6652s
Epoch: 17 cost time: 6.922452449798584
Epoch: 17, Steps: 570 | Train Loss: 0.1921213 Vali Loss: 0.0491891 Test Loss: 0.1496846
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14987124502658844, mae:0.24645471572875977
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3265904
	speed: 0.0236s/iter; left time: 266.2868s
	iters: 200, epoch: 1 | loss: 0.2824314
	speed: 0.0119s/iter; left time: 133.1106s
	iters: 300, epoch: 1 | loss: 0.2027302
	speed: 0.0119s/iter; left time: 132.0395s
	iters: 400, epoch: 1 | loss: 0.1829416
	speed: 0.0119s/iter; left time: 130.7299s
	iters: 500, epoch: 1 | loss: 0.2720419
	speed: 0.0119s/iter; left time: 129.6923s
Epoch: 1 cost time: 7.9935197830200195
Epoch: 1, Steps: 570 | Train Loss: 0.2819023 Vali Loss: 0.0710527 Test Loss: 0.1796554
Validation loss decreased (inf --> 0.071053).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2995609
	speed: 0.0402s/iter; left time: 431.4182s
	iters: 200, epoch: 2 | loss: 0.2093853
	speed: 0.0129s/iter; left time: 137.5814s
	iters: 300, epoch: 2 | loss: 0.2064758
	speed: 0.0129s/iter; left time: 136.1142s
	iters: 400, epoch: 2 | loss: 0.1652062
	speed: 0.0128s/iter; left time: 133.6310s
	iters: 500, epoch: 2 | loss: 0.2448857
	speed: 0.0127s/iter; left time: 131.3982s
Epoch: 2 cost time: 7.6550750732421875
Epoch: 2, Steps: 570 | Train Loss: 0.3054748 Vali Loss: 0.0641825 Test Loss: 0.1975380
Validation loss decreased (0.071053 --> 0.064182).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3358017
	speed: 0.0412s/iter; left time: 418.9136s
	iters: 200, epoch: 3 | loss: 0.4676081
	speed: 0.0128s/iter; left time: 128.6543s
	iters: 300, epoch: 3 | loss: 0.1594378
	speed: 0.0128s/iter; left time: 127.4465s
	iters: 400, epoch: 3 | loss: 0.2910548
	speed: 0.0128s/iter; left time: 126.0807s
	iters: 500, epoch: 3 | loss: 0.2464300
	speed: 0.0128s/iter; left time: 124.6235s
Epoch: 3 cost time: 7.577352285385132
Epoch: 3, Steps: 570 | Train Loss: 0.2865843 Vali Loss: 0.0679678 Test Loss: 0.1888290
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1879116
	speed: 0.0404s/iter; left time: 387.1622s
	iters: 200, epoch: 4 | loss: 0.3424387
	speed: 0.0128s/iter; left time: 121.6570s
	iters: 300, epoch: 4 | loss: 0.1733771
	speed: 0.0128s/iter; left time: 120.3757s
	iters: 400, epoch: 4 | loss: 0.1620296
	speed: 0.0128s/iter; left time: 119.0433s
	iters: 500, epoch: 4 | loss: 0.2221527
	speed: 0.0128s/iter; left time: 117.7860s
Epoch: 4 cost time: 7.5949506759643555
Epoch: 4, Steps: 570 | Train Loss: 0.2680516 Vali Loss: 0.0610722 Test Loss: 0.1731480
Validation loss decreased (0.064182 --> 0.061072).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2432520
	speed: 0.0424s/iter; left time: 382.4869s
	iters: 200, epoch: 5 | loss: 0.2601934
	speed: 0.0129s/iter; left time: 114.8846s
	iters: 300, epoch: 5 | loss: 0.2983795
	speed: 0.0129s/iter; left time: 113.6109s
	iters: 400, epoch: 5 | loss: 0.2202662
	speed: 0.0128s/iter; left time: 112.0282s
	iters: 500, epoch: 5 | loss: 0.2291308
	speed: 0.0128s/iter; left time: 110.5043s
Epoch: 5 cost time: 7.620111703872681
Epoch: 5, Steps: 570 | Train Loss: 0.2547676 Vali Loss: 0.0613823 Test Loss: 0.1707520
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2284081
	speed: 0.0402s/iter; left time: 340.1192s
	iters: 200, epoch: 6 | loss: 0.1313824
	speed: 0.0118s/iter; left time: 98.7320s
	iters: 300, epoch: 6 | loss: 0.2413198
	speed: 0.0118s/iter; left time: 97.6341s
	iters: 400, epoch: 6 | loss: 0.3221701
	speed: 0.0119s/iter; left time: 96.7003s
	iters: 500, epoch: 6 | loss: 0.1760595
	speed: 0.0119s/iter; left time: 95.7048s
Epoch: 6 cost time: 7.090245485305786
Epoch: 6, Steps: 570 | Train Loss: 0.2456368 Vali Loss: 0.0611322 Test Loss: 0.1657845
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2951231
	speed: 0.0398s/iter; left time: 313.8312s
	iters: 200, epoch: 7 | loss: 0.2469725
	speed: 0.0129s/iter; left time: 100.7156s
	iters: 300, epoch: 7 | loss: 0.2372079
	speed: 0.0130s/iter; left time: 99.7396s
	iters: 400, epoch: 7 | loss: 0.1685892
	speed: 0.0129s/iter; left time: 98.1408s
	iters: 500, epoch: 7 | loss: 0.2855080
	speed: 0.0129s/iter; left time: 96.6784s
Epoch: 7 cost time: 7.698976993560791
Epoch: 7, Steps: 570 | Train Loss: 0.2416486 Vali Loss: 0.0592097 Test Loss: 0.1649025
Validation loss decreased (0.061072 --> 0.059210).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1336527
	speed: 0.0401s/iter; left time: 293.4065s
	iters: 200, epoch: 8 | loss: 0.2625571
	speed: 0.0119s/iter; left time: 85.7087s
	iters: 300, epoch: 8 | loss: 0.1553656
	speed: 0.0119s/iter; left time: 84.4816s
	iters: 400, epoch: 8 | loss: 0.1543682
	speed: 0.0119s/iter; left time: 83.2852s
	iters: 500, epoch: 8 | loss: 0.2160325
	speed: 0.0119s/iter; left time: 82.0836s
Epoch: 8 cost time: 7.0823445320129395
Epoch: 8, Steps: 570 | Train Loss: 0.2399890 Vali Loss: 0.0591067 Test Loss: 0.1641041
Validation loss decreased (0.059210 --> 0.059107).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1801660
	speed: 0.0405s/iter; left time: 272.8266s
	iters: 200, epoch: 9 | loss: 0.1819342
	speed: 0.0119s/iter; left time: 79.1104s
	iters: 300, epoch: 9 | loss: 0.2147153
	speed: 0.0119s/iter; left time: 77.9025s
	iters: 400, epoch: 9 | loss: 0.2052983
	speed: 0.0119s/iter; left time: 76.7300s
	iters: 500, epoch: 9 | loss: 0.2915892
	speed: 0.0119s/iter; left time: 75.5423s
Epoch: 9 cost time: 7.099531173706055
Epoch: 9, Steps: 570 | Train Loss: 0.2384743 Vali Loss: 0.0582299 Test Loss: 0.1634074
Validation loss decreased (0.059107 --> 0.058230).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1885498
	speed: 0.0410s/iter; left time: 253.2495s
	iters: 200, epoch: 10 | loss: 0.2248306
	speed: 0.0129s/iter; left time: 78.3151s
	iters: 300, epoch: 10 | loss: 0.1583959
	speed: 0.0130s/iter; left time: 77.3848s
	iters: 400, epoch: 10 | loss: 0.2134813
	speed: 0.0129s/iter; left time: 75.8564s
	iters: 500, epoch: 10 | loss: 0.4080054
	speed: 0.0129s/iter; left time: 74.4594s
Epoch: 10 cost time: 7.674607753753662
Epoch: 10, Steps: 570 | Train Loss: 0.2358646 Vali Loss: 0.0583463 Test Loss: 0.1634760
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1674199
	speed: 0.0400s/iter; left time: 224.0886s
	iters: 200, epoch: 11 | loss: 0.3668125
	speed: 0.0118s/iter; left time: 65.0907s
	iters: 300, epoch: 11 | loss: 0.2715604
	speed: 0.0119s/iter; left time: 64.0274s
	iters: 400, epoch: 11 | loss: 0.2415816
	speed: 0.0118s/iter; left time: 62.8112s
	iters: 500, epoch: 11 | loss: 0.2843077
	speed: 0.0118s/iter; left time: 61.4950s
Epoch: 11 cost time: 7.059962511062622
Epoch: 11, Steps: 570 | Train Loss: 0.2364390 Vali Loss: 0.0585822 Test Loss: 0.1633486
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2286063
	speed: 0.0388s/iter; left time: 195.4520s
	iters: 200, epoch: 12 | loss: 0.1283193
	speed: 0.0118s/iter; left time: 58.2506s
	iters: 300, epoch: 12 | loss: 0.2065744
	speed: 0.0118s/iter; left time: 57.0910s
	iters: 400, epoch: 12 | loss: 0.2635843
	speed: 0.0118s/iter; left time: 55.8720s
	iters: 500, epoch: 12 | loss: 0.2058234
	speed: 0.0118s/iter; left time: 54.6911s
Epoch: 12 cost time: 7.025933504104614
Epoch: 12, Steps: 570 | Train Loss: 0.2372949 Vali Loss: 0.0585811 Test Loss: 0.1633064
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16357727348804474, mae:0.25873905420303345
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1796685
	speed: 0.0234s/iter; left time: 264.3280s
	iters: 200, epoch: 1 | loss: 0.3203726
	speed: 0.0115s/iter; left time: 129.2047s
	iters: 300, epoch: 1 | loss: 0.2118618
	speed: 0.0115s/iter; left time: 127.6743s
	iters: 400, epoch: 1 | loss: 0.2701736
	speed: 0.0115s/iter; left time: 126.8347s
	iters: 500, epoch: 1 | loss: 0.2387635
	speed: 0.0115s/iter; left time: 125.6170s
Epoch: 1 cost time: 7.8071465492248535
Epoch: 1, Steps: 570 | Train Loss: 0.2496155 Vali Loss: 0.0789338 Test Loss: 0.2181921
Validation loss decreased (inf --> 0.078934).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2929499
	speed: 0.0393s/iter; left time: 421.3863s
	iters: 200, epoch: 2 | loss: 0.2174159
	speed: 0.0115s/iter; left time: 121.9142s
	iters: 300, epoch: 2 | loss: 0.2474419
	speed: 0.0115s/iter; left time: 120.9087s
	iters: 400, epoch: 2 | loss: 0.3588068
	speed: 0.0115s/iter; left time: 119.5871s
	iters: 500, epoch: 2 | loss: 0.5979308
	speed: 0.0115s/iter; left time: 118.5506s
Epoch: 2 cost time: 6.874336242675781
Epoch: 2, Steps: 570 | Train Loss: 0.3421846 Vali Loss: 0.0665686 Test Loss: 0.1938915
Validation loss decreased (0.078934 --> 0.066569).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3956637
	speed: 0.0389s/iter; left time: 395.1999s
	iters: 200, epoch: 3 | loss: 0.1582731
	speed: 0.0115s/iter; left time: 115.9027s
	iters: 300, epoch: 3 | loss: 0.3669603
	speed: 0.0115s/iter; left time: 114.6235s
	iters: 400, epoch: 3 | loss: 0.2793542
	speed: 0.0115s/iter; left time: 113.5073s
	iters: 500, epoch: 3 | loss: 0.3144830
	speed: 0.0115s/iter; left time: 112.2974s
Epoch: 3 cost time: 6.877509117126465
Epoch: 3, Steps: 570 | Train Loss: 0.2952531 Vali Loss: 0.0628071 Test Loss: 0.1831682
Validation loss decreased (0.066569 --> 0.062807).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2594198
	speed: 0.0394s/iter; left time: 377.4492s
	iters: 200, epoch: 4 | loss: 0.1618074
	speed: 0.0115s/iter; left time: 108.8489s
	iters: 300, epoch: 4 | loss: 0.1491181
	speed: 0.0115s/iter; left time: 107.6535s
	iters: 400, epoch: 4 | loss: 0.2702274
	speed: 0.0115s/iter; left time: 106.4256s
	iters: 500, epoch: 4 | loss: 0.2366442
	speed: 0.0114s/iter; left time: 105.1258s
Epoch: 4 cost time: 6.862708330154419
Epoch: 4, Steps: 570 | Train Loss: 0.2701998 Vali Loss: 0.0637959 Test Loss: 0.1755745
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2900212
	speed: 0.0381s/iter; left time: 343.9830s
	iters: 200, epoch: 5 | loss: 0.2182794
	speed: 0.0115s/iter; left time: 102.2402s
	iters: 300, epoch: 5 | loss: 0.3421086
	speed: 0.0115s/iter; left time: 101.0645s
	iters: 400, epoch: 5 | loss: 0.1955701
	speed: 0.0114s/iter; left time: 99.7393s
	iters: 500, epoch: 5 | loss: 0.2884355
	speed: 0.0114s/iter; left time: 98.5806s
Epoch: 5 cost time: 6.837055921554565
Epoch: 5, Steps: 570 | Train Loss: 0.2586808 Vali Loss: 0.0617454 Test Loss: 0.1717319
Validation loss decreased (0.062807 --> 0.061745).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2905227
	speed: 0.0405s/iter; left time: 341.8478s
	iters: 200, epoch: 6 | loss: 0.2730651
	speed: 0.0115s/iter; left time: 95.6328s
	iters: 300, epoch: 6 | loss: 0.1626481
	speed: 0.0115s/iter; left time: 94.4938s
	iters: 400, epoch: 6 | loss: 0.1758117
	speed: 0.0115s/iter; left time: 93.3478s
	iters: 500, epoch: 6 | loss: 0.2027135
	speed: 0.0114s/iter; left time: 92.1707s
Epoch: 6 cost time: 6.850890636444092
Epoch: 6, Steps: 570 | Train Loss: 0.2503739 Vali Loss: 0.0603163 Test Loss: 0.1696076
Validation loss decreased (0.061745 --> 0.060316).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1629372
	speed: 0.0390s/iter; left time: 307.2557s
	iters: 200, epoch: 7 | loss: 0.4093698
	speed: 0.0115s/iter; left time: 89.2057s
	iters: 300, epoch: 7 | loss: 0.2375754
	speed: 0.0115s/iter; left time: 88.0898s
	iters: 400, epoch: 7 | loss: 0.1748221
	speed: 0.0115s/iter; left time: 86.9479s
	iters: 500, epoch: 7 | loss: 0.1773041
	speed: 0.0115s/iter; left time: 85.7660s
Epoch: 7 cost time: 6.871272325515747
Epoch: 7, Steps: 570 | Train Loss: 0.2470633 Vali Loss: 0.0601705 Test Loss: 0.1683172
Validation loss decreased (0.060316 --> 0.060171).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1559660
	speed: 0.0404s/iter; left time: 295.3649s
	iters: 200, epoch: 8 | loss: 0.2440483
	speed: 0.0115s/iter; left time: 83.2524s
	iters: 300, epoch: 8 | loss: 0.2035100
	speed: 0.0115s/iter; left time: 81.9869s
	iters: 400, epoch: 8 | loss: 0.2517019
	speed: 0.0115s/iter; left time: 80.6658s
	iters: 500, epoch: 8 | loss: 0.1877975
	speed: 0.0115s/iter; left time: 79.3569s
Epoch: 8 cost time: 6.883461236953735
Epoch: 8, Steps: 570 | Train Loss: 0.2481832 Vali Loss: 0.0595144 Test Loss: 0.1678012
Validation loss decreased (0.060171 --> 0.059514).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3043793
	speed: 0.0399s/iter; left time: 269.1428s
	iters: 200, epoch: 9 | loss: 0.1733602
	speed: 0.0126s/iter; left time: 83.5311s
	iters: 300, epoch: 9 | loss: 0.3501782
	speed: 0.0126s/iter; left time: 82.6483s
	iters: 400, epoch: 9 | loss: 0.3207723
	speed: 0.0126s/iter; left time: 81.0793s
	iters: 500, epoch: 9 | loss: 0.3596117
	speed: 0.0126s/iter; left time: 79.8454s
Epoch: 9 cost time: 7.482785224914551
Epoch: 9, Steps: 570 | Train Loss: 0.2453948 Vali Loss: 0.0594102 Test Loss: 0.1675649
Validation loss decreased (0.059514 --> 0.059410).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1794396
	speed: 0.0414s/iter; left time: 255.4380s
	iters: 200, epoch: 10 | loss: 0.2279155
	speed: 0.0126s/iter; left time: 76.4346s
	iters: 300, epoch: 10 | loss: 0.1558017
	speed: 0.0126s/iter; left time: 75.2337s
	iters: 400, epoch: 10 | loss: 0.2411603
	speed: 0.0122s/iter; left time: 71.7407s
	iters: 500, epoch: 10 | loss: 0.2668256
	speed: 0.0115s/iter; left time: 66.2896s
Epoch: 10 cost time: 7.2960474491119385
Epoch: 10, Steps: 570 | Train Loss: 0.2453270 Vali Loss: 0.0596609 Test Loss: 0.1673820
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1222677
	speed: 0.0383s/iter; left time: 214.6352s
	iters: 200, epoch: 11 | loss: 0.1957473
	speed: 0.0115s/iter; left time: 63.1627s
	iters: 300, epoch: 11 | loss: 0.2241580
	speed: 0.0115s/iter; left time: 61.9962s
	iters: 400, epoch: 11 | loss: 0.2861233
	speed: 0.0115s/iter; left time: 60.7988s
	iters: 500, epoch: 11 | loss: 0.3761418
	speed: 0.0115s/iter; left time: 59.7100s
Epoch: 11 cost time: 6.849255084991455
Epoch: 11, Steps: 570 | Train Loss: 0.2456568 Vali Loss: 0.0596132 Test Loss: 0.1673657
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2111523
	speed: 0.0396s/iter; left time: 199.3380s
	iters: 200, epoch: 12 | loss: 0.1821611
	speed: 0.0125s/iter; left time: 61.8137s
	iters: 300, epoch: 12 | loss: 0.1647033
	speed: 0.0116s/iter; left time: 55.8772s
	iters: 400, epoch: 12 | loss: 0.3011793
	speed: 0.0115s/iter; left time: 54.5603s
	iters: 500, epoch: 12 | loss: 0.2388800
	speed: 0.0115s/iter; left time: 53.2559s
Epoch: 12 cost time: 7.077351093292236
Epoch: 12, Steps: 570 | Train Loss: 0.2440781 Vali Loss: 0.0597405 Test Loss: 0.1674265
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16781757771968842, mae:0.2611628472805023
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3327174
	speed: 0.0224s/iter; left time: 252.7297s
	iters: 200, epoch: 1 | loss: 0.3182364
	speed: 0.0107s/iter; left time: 120.2609s
	iters: 300, epoch: 1 | loss: 0.3426073
	speed: 0.0107s/iter; left time: 119.3052s
	iters: 400, epoch: 1 | loss: 0.3059278
	speed: 0.0107s/iter; left time: 117.9327s
	iters: 500, epoch: 1 | loss: 0.4027936
	speed: 0.0107s/iter; left time: 116.9564s
Epoch: 1 cost time: 7.333016633987427
Epoch: 1, Steps: 570 | Train Loss: 0.3039419 Vali Loss: 0.0807907 Test Loss: 0.2209334
Validation loss decreased (inf --> 0.080791).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3536313
	speed: 0.0380s/iter; left time: 407.5686s
	iters: 200, epoch: 2 | loss: 0.3966191
	speed: 0.0108s/iter; left time: 114.7497s
	iters: 300, epoch: 2 | loss: 0.2305571
	speed: 0.0108s/iter; left time: 113.8881s
	iters: 400, epoch: 2 | loss: 0.2279711
	speed: 0.0108s/iter; left time: 112.7206s
	iters: 500, epoch: 2 | loss: 0.2820280
	speed: 0.0110s/iter; left time: 113.1368s
Epoch: 2 cost time: 6.6476891040802
Epoch: 2, Steps: 570 | Train Loss: 0.3421060 Vali Loss: 0.0724195 Test Loss: 0.1958509
Validation loss decreased (0.080791 --> 0.072419).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2353123
	speed: 0.0401s/iter; left time: 407.6811s
	iters: 200, epoch: 3 | loss: 0.2257837
	speed: 0.0108s/iter; left time: 108.8855s
	iters: 300, epoch: 3 | loss: 0.2265708
	speed: 0.0108s/iter; left time: 107.8223s
	iters: 400, epoch: 3 | loss: 0.2759785
	speed: 0.0108s/iter; left time: 106.8726s
	iters: 500, epoch: 3 | loss: 0.2378863
	speed: 0.0108s/iter; left time: 105.6019s
Epoch: 3 cost time: 6.477308750152588
Epoch: 3, Steps: 570 | Train Loss: 0.2737085 Vali Loss: 0.0630089 Test Loss: 0.1675890
Validation loss decreased (0.072419 --> 0.063009).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2410200
	speed: 0.0369s/iter; left time: 353.6827s
	iters: 200, epoch: 4 | loss: 0.1390311
	speed: 0.0108s/iter; left time: 102.7994s
	iters: 300, epoch: 4 | loss: 0.2606155
	speed: 0.0108s/iter; left time: 101.5144s
	iters: 400, epoch: 4 | loss: 0.4015678
	speed: 0.0108s/iter; left time: 100.7296s
	iters: 500, epoch: 4 | loss: 0.2342789
	speed: 0.0109s/iter; left time: 99.8402s
Epoch: 4 cost time: 6.490089178085327
Epoch: 4, Steps: 570 | Train Loss: 0.2503709 Vali Loss: 0.0647304 Test Loss: 0.1658181
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2422166
	speed: 0.0369s/iter; left time: 332.5827s
	iters: 200, epoch: 5 | loss: 0.1894854
	speed: 0.0108s/iter; left time: 96.5027s
	iters: 300, epoch: 5 | loss: 0.2011713
	speed: 0.0109s/iter; left time: 95.7158s
	iters: 400, epoch: 5 | loss: 0.1729721
	speed: 0.0109s/iter; left time: 94.6368s
	iters: 500, epoch: 5 | loss: 0.3241611
	speed: 0.0108s/iter; left time: 93.3218s
Epoch: 5 cost time: 6.42744779586792
Epoch: 5, Steps: 570 | Train Loss: 0.2379840 Vali Loss: 0.0632330 Test Loss: 0.1627935
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1657743
	speed: 0.0368s/iter; left time: 311.0912s
	iters: 200, epoch: 6 | loss: 0.2104838
	speed: 0.0120s/iter; left time: 100.6118s
	iters: 300, epoch: 6 | loss: 0.2671312
	speed: 0.0120s/iter; left time: 99.1668s
	iters: 400, epoch: 6 | loss: 0.2211233
	speed: 0.0120s/iter; left time: 97.8038s
	iters: 500, epoch: 6 | loss: 0.1637257
	speed: 0.0120s/iter; left time: 96.5522s
Epoch: 6 cost time: 7.116463899612427
Epoch: 6, Steps: 570 | Train Loss: 0.2299352 Vali Loss: 0.0637382 Test Loss: 0.1610361
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16782337427139282, mae:0.265283465385437
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2021424
	speed: 0.0261s/iter; left time: 295.4831s
	iters: 200, epoch: 1 | loss: 0.1925161
	speed: 0.0149s/iter; left time: 166.4269s
	iters: 300, epoch: 1 | loss: 0.3646648
	speed: 0.0161s/iter; left time: 178.7709s
	iters: 400, epoch: 1 | loss: 0.3172990
	speed: 0.0163s/iter; left time: 178.9028s
	iters: 500, epoch: 1 | loss: 0.1780760
	speed: 0.0162s/iter; left time: 177.1047s
Epoch: 1 cost time: 10.13577914237976
Epoch: 1, Steps: 570 | Train Loss: 0.2514787 Vali Loss: 0.0618211 Test Loss: 0.1670834
Validation loss decreased (inf --> 0.061821).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3758127
	speed: 0.0487s/iter; left time: 522.3844s
	iters: 200, epoch: 2 | loss: 0.2328117
	speed: 0.0146s/iter; left time: 155.2524s
	iters: 300, epoch: 2 | loss: 0.2166753
	speed: 0.0146s/iter; left time: 153.7696s
	iters: 400, epoch: 2 | loss: 0.1600483
	speed: 0.0146s/iter; left time: 152.0925s
	iters: 500, epoch: 2 | loss: 0.2440310
	speed: 0.0145s/iter; left time: 149.7966s
Epoch: 2 cost time: 8.609283447265625
Epoch: 2, Steps: 570 | Train Loss: 0.2545696 Vali Loss: 0.0566529 Test Loss: 0.1636013
Validation loss decreased (0.061821 --> 0.056653).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3808836
	speed: 0.0473s/iter; left time: 480.1604s
	iters: 200, epoch: 3 | loss: 0.2466947
	speed: 0.0146s/iter; left time: 146.3890s
	iters: 300, epoch: 3 | loss: 0.1148460
	speed: 0.0145s/iter; left time: 144.3908s
	iters: 400, epoch: 3 | loss: 0.1709522
	speed: 0.0145s/iter; left time: 142.8327s
	iters: 500, epoch: 3 | loss: 0.1981073
	speed: 0.0144s/iter; left time: 141.0258s
Epoch: 3 cost time: 8.535670042037964
Epoch: 3, Steps: 570 | Train Loss: 0.2202817 Vali Loss: 0.0512793 Test Loss: 0.1501765
Validation loss decreased (0.056653 --> 0.051279).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1944005
	speed: 0.0468s/iter; left time: 448.7181s
	iters: 200, epoch: 4 | loss: 0.1566377
	speed: 0.0146s/iter; left time: 138.3710s
	iters: 300, epoch: 4 | loss: 0.2081069
	speed: 0.0146s/iter; left time: 136.7889s
	iters: 400, epoch: 4 | loss: 0.1892206
	speed: 0.0146s/iter; left time: 135.5481s
	iters: 500, epoch: 4 | loss: 0.2124998
	speed: 0.0146s/iter; left time: 133.9848s
Epoch: 4 cost time: 8.614907026290894
Epoch: 4, Steps: 570 | Train Loss: 0.1995000 Vali Loss: 0.0463360 Test Loss: 0.1446078
Validation loss decreased (0.051279 --> 0.046336).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1876682
	speed: 0.0461s/iter; left time: 415.7079s
	iters: 200, epoch: 5 | loss: 0.1668259
	speed: 0.0146s/iter; left time: 130.4522s
	iters: 300, epoch: 5 | loss: 0.1381411
	speed: 0.0146s/iter; left time: 128.4487s
	iters: 400, epoch: 5 | loss: 0.2317812
	speed: 0.0145s/iter; left time: 126.8898s
	iters: 500, epoch: 5 | loss: 0.1862955
	speed: 0.0146s/iter; left time: 125.5394s
Epoch: 5 cost time: 8.609616994857788
Epoch: 5, Steps: 570 | Train Loss: 0.1858906 Vali Loss: 0.0453545 Test Loss: 0.1382442
Validation loss decreased (0.046336 --> 0.045354).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1635985
	speed: 0.0456s/iter; left time: 385.3825s
	iters: 200, epoch: 6 | loss: 0.1883183
	speed: 0.0145s/iter; left time: 121.1226s
	iters: 300, epoch: 6 | loss: 0.1240506
	speed: 0.0145s/iter; left time: 119.5246s
	iters: 400, epoch: 6 | loss: 0.1124600
	speed: 0.0144s/iter; left time: 117.5318s
	iters: 500, epoch: 6 | loss: 0.1650752
	speed: 0.0144s/iter; left time: 116.1037s
Epoch: 6 cost time: 8.53345251083374
Epoch: 6, Steps: 570 | Train Loss: 0.1777709 Vali Loss: 0.0447077 Test Loss: 0.1378238
Validation loss decreased (0.045354 --> 0.044708).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1421961
	speed: 0.0489s/iter; left time: 385.5535s
	iters: 200, epoch: 7 | loss: 0.1592079
	speed: 0.0163s/iter; left time: 126.6373s
	iters: 300, epoch: 7 | loss: 0.1536149
	speed: 0.0162s/iter; left time: 124.7953s
	iters: 400, epoch: 7 | loss: 0.1435184
	speed: 0.0162s/iter; left time: 123.0241s
	iters: 500, epoch: 7 | loss: 0.1989434
	speed: 0.0162s/iter; left time: 121.1031s
Epoch: 7 cost time: 9.523902893066406
Epoch: 7, Steps: 570 | Train Loss: 0.1743078 Vali Loss: 0.0442103 Test Loss: 0.1381981
Validation loss decreased (0.044708 --> 0.044210).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2754486
	speed: 0.0501s/iter; left time: 366.0589s
	iters: 200, epoch: 8 | loss: 0.1697963
	speed: 0.0153s/iter; left time: 110.1116s
	iters: 300, epoch: 8 | loss: 0.2003881
	speed: 0.0144s/iter; left time: 102.2669s
	iters: 400, epoch: 8 | loss: 0.1058447
	speed: 0.0144s/iter; left time: 100.7546s
	iters: 500, epoch: 8 | loss: 0.2092163
	speed: 0.0144s/iter; left time: 99.3471s
Epoch: 8 cost time: 8.75621223449707
Epoch: 8, Steps: 570 | Train Loss: 0.1720699 Vali Loss: 0.0444646 Test Loss: 0.1381192
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2775129
	speed: 0.0453s/iter; left time: 305.2790s
	iters: 200, epoch: 9 | loss: 0.1869513
	speed: 0.0145s/iter; left time: 96.6039s
	iters: 300, epoch: 9 | loss: 0.2404243
	speed: 0.0145s/iter; left time: 95.0619s
	iters: 400, epoch: 9 | loss: 0.1877683
	speed: 0.0145s/iter; left time: 93.1437s
	iters: 500, epoch: 9 | loss: 0.1491519
	speed: 0.0145s/iter; left time: 91.6437s
Epoch: 9 cost time: 8.518932342529297
Epoch: 9, Steps: 570 | Train Loss: 0.1709610 Vali Loss: 0.0442922 Test Loss: 0.1373717
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1937200
	speed: 0.0457s/iter; left time: 281.9314s
	iters: 200, epoch: 10 | loss: 0.1355558
	speed: 0.0145s/iter; left time: 87.8745s
	iters: 300, epoch: 10 | loss: 0.1136709
	speed: 0.0145s/iter; left time: 86.6496s
	iters: 400, epoch: 10 | loss: 0.1265586
	speed: 0.0145s/iter; left time: 85.0258s
	iters: 500, epoch: 10 | loss: 0.2174215
	speed: 0.0145s/iter; left time: 83.7299s
Epoch: 10 cost time: 8.561594724655151
Epoch: 10, Steps: 570 | Train Loss: 0.1704257 Vali Loss: 0.0441107 Test Loss: 0.1373031
Validation loss decreased (0.044210 --> 0.044111).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1637001
	speed: 0.0470s/iter; left time: 263.0941s
	iters: 200, epoch: 11 | loss: 0.1189625
	speed: 0.0146s/iter; left time: 80.0991s
	iters: 300, epoch: 11 | loss: 0.1546430
	speed: 0.0146s/iter; left time: 78.7612s
	iters: 400, epoch: 11 | loss: 0.1115248
	speed: 0.0146s/iter; left time: 77.3783s
	iters: 500, epoch: 11 | loss: 0.1244606
	speed: 0.0145s/iter; left time: 75.6639s
Epoch: 11 cost time: 8.624287605285645
Epoch: 11, Steps: 570 | Train Loss: 0.1703624 Vali Loss: 0.0442272 Test Loss: 0.1372467
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1294420
	speed: 0.0461s/iter; left time: 231.8664s
	iters: 200, epoch: 12 | loss: 0.1040739
	speed: 0.0145s/iter; left time: 71.4425s
	iters: 300, epoch: 12 | loss: 0.1994811
	speed: 0.0145s/iter; left time: 70.0134s
	iters: 400, epoch: 12 | loss: 0.1641083
	speed: 0.0145s/iter; left time: 68.4898s
	iters: 500, epoch: 12 | loss: 0.1259927
	speed: 0.0145s/iter; left time: 67.0517s
Epoch: 12 cost time: 8.521199226379395
Epoch: 12, Steps: 570 | Train Loss: 0.1692939 Vali Loss: 0.0441475 Test Loss: 0.1371971
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2209660
	speed: 0.0455s/iter; left time: 203.1341s
	iters: 200, epoch: 13 | loss: 0.2390860
	speed: 0.0144s/iter; left time: 62.8219s
	iters: 300, epoch: 13 | loss: 0.2171553
	speed: 0.0144s/iter; left time: 61.3206s
	iters: 400, epoch: 13 | loss: 0.1052573
	speed: 0.0144s/iter; left time: 59.9723s
	iters: 500, epoch: 13 | loss: 0.1743914
	speed: 0.0144s/iter; left time: 58.4082s
Epoch: 13 cost time: 8.455994606018066
Epoch: 13, Steps: 570 | Train Loss: 0.1694824 Vali Loss: 0.0442130 Test Loss: 0.1371884
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13750919699668884, mae:0.2309766709804535
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3579784
	speed: 0.0277s/iter; left time: 312.8905s
	iters: 200, epoch: 1 | loss: 0.2492652
	speed: 0.0160s/iter; left time: 178.9026s
	iters: 300, epoch: 1 | loss: 0.1267075
	speed: 0.0159s/iter; left time: 176.9214s
	iters: 400, epoch: 1 | loss: 0.2885725
	speed: 0.0160s/iter; left time: 175.6811s
	iters: 500, epoch: 1 | loss: 0.1961450
	speed: 0.0159s/iter; left time: 173.8484s
Epoch: 1 cost time: 10.321907997131348
Epoch: 1, Steps: 570 | Train Loss: 0.2143978 Vali Loss: 0.0422654 Test Loss: 0.1404254
Validation loss decreased (inf --> 0.042265).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1853428
	speed: 0.0469s/iter; left time: 502.9530s
	iters: 200, epoch: 2 | loss: 0.3092574
	speed: 0.0142s/iter; left time: 151.3551s
	iters: 300, epoch: 2 | loss: 0.2416447
	speed: 0.0143s/iter; left time: 150.4347s
	iters: 400, epoch: 2 | loss: 0.1907769
	speed: 0.0142s/iter; left time: 148.4494s
	iters: 500, epoch: 2 | loss: 0.3004417
	speed: 0.0143s/iter; left time: 147.3943s
Epoch: 2 cost time: 8.407721519470215
Epoch: 2, Steps: 570 | Train Loss: 0.2455699 Vali Loss: 0.0700985 Test Loss: 0.1969756
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3261602
	speed: 0.0458s/iter; left time: 465.8118s
	iters: 200, epoch: 3 | loss: 0.1153121
	speed: 0.0142s/iter; left time: 143.1272s
	iters: 300, epoch: 3 | loss: 0.3054507
	speed: 0.0142s/iter; left time: 141.7771s
	iters: 400, epoch: 3 | loss: 0.1318701
	speed: 0.0153s/iter; left time: 151.1852s
	iters: 500, epoch: 3 | loss: 0.2147380
	speed: 0.0165s/iter; left time: 160.9711s
Epoch: 3 cost time: 8.904938220977783
Epoch: 3, Steps: 570 | Train Loss: 0.2506641 Vali Loss: 0.0531762 Test Loss: 0.1599999
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2274706
	speed: 0.0483s/iter; left time: 463.2524s
	iters: 200, epoch: 4 | loss: 0.1663541
	speed: 0.0153s/iter; left time: 145.3886s
	iters: 300, epoch: 4 | loss: 0.3156635
	speed: 0.0142s/iter; left time: 133.4678s
	iters: 400, epoch: 4 | loss: 0.1417001
	speed: 0.0142s/iter; left time: 131.6773s
	iters: 500, epoch: 4 | loss: 0.1505014
	speed: 0.0142s/iter; left time: 130.2347s
Epoch: 4 cost time: 8.691866397857666
Epoch: 4, Steps: 570 | Train Loss: 0.2101283 Vali Loss: 0.0509230 Test Loss: 0.1516359
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1406233012676239, mae:0.23075206577777863
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1255287
	speed: 0.0260s/iter; left time: 293.3913s
	iters: 200, epoch: 1 | loss: 0.3506041
	speed: 0.0143s/iter; left time: 160.2603s
	iters: 300, epoch: 1 | loss: 0.3245904
	speed: 0.0143s/iter; left time: 158.6814s
	iters: 400, epoch: 1 | loss: 0.2325457
	speed: 0.0143s/iter; left time: 157.5253s
	iters: 500, epoch: 1 | loss: 0.2726045
	speed: 0.0143s/iter; left time: 156.3285s
Epoch: 1 cost time: 9.372231006622314
Epoch: 1, Steps: 570 | Train Loss: 0.2607614 Vali Loss: 0.0578785 Test Loss: 0.1718232
Validation loss decreased (inf --> 0.057879).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2770151
	speed: 0.0506s/iter; left time: 542.6456s
	iters: 200, epoch: 2 | loss: 0.2334131
	speed: 0.0160s/iter; left time: 170.4086s
	iters: 300, epoch: 2 | loss: 0.1974951
	speed: 0.0161s/iter; left time: 169.3040s
	iters: 400, epoch: 2 | loss: 0.2227008
	speed: 0.0161s/iter; left time: 167.4661s
	iters: 500, epoch: 2 | loss: 0.3233249
	speed: 0.0160s/iter; left time: 165.5200s
Epoch: 2 cost time: 9.452913761138916
Epoch: 2, Steps: 570 | Train Loss: 0.2962000 Vali Loss: 0.0627234 Test Loss: 0.1698018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2439906
	speed: 0.0490s/iter; left time: 497.5363s
	iters: 200, epoch: 3 | loss: 0.3127278
	speed: 0.0161s/iter; left time: 161.7126s
	iters: 300, epoch: 3 | loss: 0.2239275
	speed: 0.0142s/iter; left time: 141.7785s
	iters: 400, epoch: 3 | loss: 0.2060677
	speed: 0.0142s/iter; left time: 139.5722s
	iters: 500, epoch: 3 | loss: 0.2406228
	speed: 0.0142s/iter; left time: 138.1937s
Epoch: 3 cost time: 8.742047786712646
Epoch: 3, Steps: 570 | Train Loss: 0.2465655 Vali Loss: 0.0627705 Test Loss: 0.1686419
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3114236
	speed: 0.0459s/iter; left time: 440.1801s
	iters: 200, epoch: 4 | loss: 0.1990649
	speed: 0.0143s/iter; left time: 135.7442s
	iters: 300, epoch: 4 | loss: 0.2273496
	speed: 0.0143s/iter; left time: 134.3094s
	iters: 400, epoch: 4 | loss: 0.2008995
	speed: 0.0143s/iter; left time: 132.9020s
	iters: 500, epoch: 4 | loss: 0.1867630
	speed: 0.0143s/iter; left time: 131.4626s
Epoch: 4 cost time: 8.43689227104187
Epoch: 4, Steps: 570 | Train Loss: 0.2317419 Vali Loss: 0.0565305 Test Loss: 0.1541988
Validation loss decreased (0.057879 --> 0.056530).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1827768
	speed: 0.0476s/iter; left time: 429.6215s
	iters: 200, epoch: 5 | loss: 0.2424145
	speed: 0.0143s/iter; left time: 127.3910s
	iters: 300, epoch: 5 | loss: 0.1769633
	speed: 0.0143s/iter; left time: 126.0091s
	iters: 400, epoch: 5 | loss: 0.3183462
	speed: 0.0142s/iter; left time: 124.2563s
	iters: 500, epoch: 5 | loss: 0.1517796
	speed: 0.0142s/iter; left time: 122.5869s
Epoch: 5 cost time: 8.45310926437378
Epoch: 5, Steps: 570 | Train Loss: 0.2206718 Vali Loss: 0.0559052 Test Loss: 0.1531190
Validation loss decreased (0.056530 --> 0.055905).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2887405
	speed: 0.0479s/iter; left time: 404.9665s
	iters: 200, epoch: 6 | loss: 0.2290369
	speed: 0.0161s/iter; left time: 134.1014s
	iters: 300, epoch: 6 | loss: 0.1388823
	speed: 0.0159s/iter; left time: 130.9054s
	iters: 400, epoch: 6 | loss: 0.2632432
	speed: 0.0143s/iter; left time: 116.2822s
	iters: 500, epoch: 6 | loss: 0.2012624
	speed: 0.0143s/iter; left time: 115.2269s
Epoch: 6 cost time: 8.947103500366211
Epoch: 6, Steps: 570 | Train Loss: 0.2157504 Vali Loss: 0.0545692 Test Loss: 0.1535233
Validation loss decreased (0.055905 --> 0.054569).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2609769
	speed: 0.0475s/iter; left time: 374.1550s
	iters: 200, epoch: 7 | loss: 0.1198593
	speed: 0.0143s/iter; left time: 111.3879s
	iters: 300, epoch: 7 | loss: 0.1548982
	speed: 0.0143s/iter; left time: 110.1155s
	iters: 400, epoch: 7 | loss: 0.2881845
	speed: 0.0143s/iter; left time: 108.4778s
	iters: 500, epoch: 7 | loss: 0.1886747
	speed: 0.0143s/iter; left time: 107.1238s
Epoch: 7 cost time: 8.47185230255127
Epoch: 7, Steps: 570 | Train Loss: 0.2104953 Vali Loss: 0.0552722 Test Loss: 0.1542632
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1520666
	speed: 0.0468s/iter; left time: 341.9201s
	iters: 200, epoch: 8 | loss: 0.1610115
	speed: 0.0143s/iter; left time: 102.9019s
	iters: 300, epoch: 8 | loss: 0.2201933
	speed: 0.0142s/iter; left time: 100.7326s
	iters: 400, epoch: 8 | loss: 0.1989685
	speed: 0.0141s/iter; left time: 99.1871s
	iters: 500, epoch: 8 | loss: 0.1495541
	speed: 0.0142s/iter; left time: 97.9377s
Epoch: 8 cost time: 8.410669326782227
Epoch: 8, Steps: 570 | Train Loss: 0.2098225 Vali Loss: 0.0553594 Test Loss: 0.1540214
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2585093
	speed: 0.0455s/iter; left time: 306.7893s
	iters: 200, epoch: 9 | loss: 0.1992339
	speed: 0.0142s/iter; left time: 94.4599s
	iters: 300, epoch: 9 | loss: 0.1346188
	speed: 0.0142s/iter; left time: 92.8848s
	iters: 400, epoch: 9 | loss: 0.1820253
	speed: 0.0142s/iter; left time: 91.4743s
	iters: 500, epoch: 9 | loss: 0.1771368
	speed: 0.0142s/iter; left time: 90.0396s
Epoch: 9 cost time: 8.393941879272461
Epoch: 9, Steps: 570 | Train Loss: 0.2070904 Vali Loss: 0.0549729 Test Loss: 0.1534572
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15372373163700104, mae:0.25145941972732544
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3330847
	speed: 0.0290s/iter; left time: 327.7584s
	iters: 200, epoch: 1 | loss: 0.4218915
	speed: 0.0170s/iter; left time: 189.9956s
	iters: 300, epoch: 1 | loss: 0.2805955
	speed: 0.0170s/iter; left time: 188.5472s
	iters: 400, epoch: 1 | loss: 0.3035471
	speed: 0.0169s/iter; left time: 186.3460s
	iters: 500, epoch: 1 | loss: 0.2725039
	speed: 0.0169s/iter; left time: 184.0657s
Epoch: 1 cost time: 10.915311574935913
Epoch: 1, Steps: 570 | Train Loss: 0.3454965 Vali Loss: 0.0697863 Test Loss: 0.1908302
Validation loss decreased (inf --> 0.069786).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4603559
	speed: 0.0516s/iter; left time: 553.2431s
	iters: 200, epoch: 2 | loss: 0.3383348
	speed: 0.0181s/iter; left time: 192.6896s
	iters: 300, epoch: 2 | loss: 0.2927231
	speed: 0.0180s/iter; left time: 190.0654s
	iters: 400, epoch: 2 | loss: 0.3209269
	speed: 0.0180s/iter; left time: 187.9980s
	iters: 500, epoch: 2 | loss: 0.3092749
	speed: 0.0180s/iter; left time: 186.2786s
Epoch: 2 cost time: 10.530222177505493
Epoch: 2, Steps: 570 | Train Loss: 0.2911564 Vali Loss: 0.0641279 Test Loss: 0.1778177
Validation loss decreased (0.069786 --> 0.064128).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2104033
	speed: 0.0560s/iter; left time: 568.6721s
	iters: 200, epoch: 3 | loss: 0.2310549
	speed: 0.0181s/iter; left time: 182.4344s
	iters: 300, epoch: 3 | loss: 0.4158018
	speed: 0.0181s/iter; left time: 180.3146s
	iters: 400, epoch: 3 | loss: 0.2733926
	speed: 0.0179s/iter; left time: 176.4718s
	iters: 500, epoch: 3 | loss: 0.2293164
	speed: 0.0169s/iter; left time: 165.3396s
Epoch: 3 cost time: 10.383117198944092
Epoch: 3, Steps: 570 | Train Loss: 0.2670521 Vali Loss: 0.0600581 Test Loss: 0.1713327
Validation loss decreased (0.064128 --> 0.060058).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3341044
	speed: 0.0538s/iter; left time: 516.4654s
	iters: 200, epoch: 4 | loss: 0.2223510
	speed: 0.0180s/iter; left time: 171.1491s
	iters: 300, epoch: 4 | loss: 0.2641203
	speed: 0.0177s/iter; left time: 166.3319s
	iters: 400, epoch: 4 | loss: 0.3035638
	speed: 0.0184s/iter; left time: 171.0603s
	iters: 500, epoch: 4 | loss: 0.2579872
	speed: 0.0184s/iter; left time: 169.3141s
Epoch: 4 cost time: 10.660863637924194
Epoch: 4, Steps: 570 | Train Loss: 0.2549842 Vali Loss: 0.0583454 Test Loss: 0.1644505
Validation loss decreased (0.060058 --> 0.058345).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1485283
	speed: 0.0535s/iter; left time: 482.2782s
	iters: 200, epoch: 5 | loss: 0.3071730
	speed: 0.0184s/iter; left time: 164.2444s
	iters: 300, epoch: 5 | loss: 0.2212565
	speed: 0.0184s/iter; left time: 162.4304s
	iters: 400, epoch: 5 | loss: 0.2692057
	speed: 0.0177s/iter; left time: 154.5860s
	iters: 500, epoch: 5 | loss: 0.1740633
	speed: 0.0184s/iter; left time: 158.6820s
Epoch: 5 cost time: 10.679895162582397
Epoch: 5, Steps: 570 | Train Loss: 0.2406700 Vali Loss: 0.0549469 Test Loss: 0.1616737
Validation loss decreased (0.058345 --> 0.054947).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3004594
	speed: 0.0522s/iter; left time: 441.5272s
	iters: 200, epoch: 6 | loss: 0.2355074
	speed: 0.0169s/iter; left time: 141.1865s
	iters: 300, epoch: 6 | loss: 0.3626229
	speed: 0.0169s/iter; left time: 139.7849s
	iters: 400, epoch: 6 | loss: 0.2579860
	speed: 0.0169s/iter; left time: 137.9362s
	iters: 500, epoch: 6 | loss: 0.2163518
	speed: 0.0169s/iter; left time: 136.2478s
Epoch: 6 cost time: 9.936220645904541
Epoch: 6, Steps: 570 | Train Loss: 0.2339336 Vali Loss: 0.0543129 Test Loss: 0.1576901
Validation loss decreased (0.054947 --> 0.054313).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1825576
	speed: 0.0507s/iter; left time: 399.2094s
	iters: 200, epoch: 7 | loss: 0.2221727
	speed: 0.0169s/iter; left time: 131.4279s
	iters: 300, epoch: 7 | loss: 0.3218852
	speed: 0.0169s/iter; left time: 129.9132s
	iters: 400, epoch: 7 | loss: 0.1682148
	speed: 0.0170s/iter; left time: 128.5252s
	iters: 500, epoch: 7 | loss: 0.1819262
	speed: 0.0169s/iter; left time: 126.4857s
Epoch: 7 cost time: 9.950610160827637
Epoch: 7, Steps: 570 | Train Loss: 0.2284274 Vali Loss: 0.0537960 Test Loss: 0.1573032
Validation loss decreased (0.054313 --> 0.053796).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2675963
	speed: 0.0516s/iter; left time: 376.9889s
	iters: 200, epoch: 8 | loss: 0.1502899
	speed: 0.0170s/iter; left time: 122.3493s
	iters: 300, epoch: 8 | loss: 0.2123189
	speed: 0.0170s/iter; left time: 120.7772s
	iters: 400, epoch: 8 | loss: 0.1475389
	speed: 0.0169s/iter; left time: 118.7521s
	iters: 500, epoch: 8 | loss: 0.1974163
	speed: 0.0169s/iter; left time: 117.0609s
Epoch: 8 cost time: 9.964040040969849
Epoch: 8, Steps: 570 | Train Loss: 0.2272331 Vali Loss: 0.0537581 Test Loss: 0.1568641
Validation loss decreased (0.053796 --> 0.053758).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2166151
	speed: 0.0528s/iter; left time: 356.0533s
	iters: 200, epoch: 9 | loss: 0.1553343
	speed: 0.0169s/iter; left time: 112.5538s
	iters: 300, epoch: 9 | loss: 0.2586129
	speed: 0.0169s/iter; left time: 110.4761s
	iters: 400, epoch: 9 | loss: 0.2952958
	speed: 0.0168s/iter; left time: 108.4290s
	iters: 500, epoch: 9 | loss: 0.3034004
	speed: 0.0169s/iter; left time: 106.9183s
Epoch: 9 cost time: 9.932249069213867
Epoch: 9, Steps: 570 | Train Loss: 0.2247944 Vali Loss: 0.0537391 Test Loss: 0.1563775
Validation loss decreased (0.053758 --> 0.053739).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3168563
	speed: 0.0525s/iter; left time: 324.0684s
	iters: 200, epoch: 10 | loss: 0.0878856
	speed: 0.0171s/iter; left time: 103.5454s
	iters: 300, epoch: 10 | loss: 0.3373968
	speed: 0.0170s/iter; left time: 101.3596s
	iters: 400, epoch: 10 | loss: 0.2689933
	speed: 0.0170s/iter; left time: 99.6348s
	iters: 500, epoch: 10 | loss: 0.2301403
	speed: 0.0170s/iter; left time: 97.8200s
Epoch: 10 cost time: 10.013245582580566
Epoch: 10, Steps: 570 | Train Loss: 0.2245514 Vali Loss: 0.0535284 Test Loss: 0.1562473
Validation loss decreased (0.053739 --> 0.053528).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1871051
	speed: 0.0506s/iter; left time: 283.2794s
	iters: 200, epoch: 11 | loss: 0.2793106
	speed: 0.0169s/iter; left time: 92.9518s
	iters: 300, epoch: 11 | loss: 0.1377579
	speed: 0.0169s/iter; left time: 91.2840s
	iters: 400, epoch: 11 | loss: 0.2009258
	speed: 0.0169s/iter; left time: 89.5297s
	iters: 500, epoch: 11 | loss: 0.3015958
	speed: 0.0169s/iter; left time: 87.8634s
Epoch: 11 cost time: 9.950321197509766
Epoch: 11, Steps: 570 | Train Loss: 0.2249263 Vali Loss: 0.0536926 Test Loss: 0.1561432
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2742327
	speed: 0.0502s/iter; left time: 252.7344s
	iters: 200, epoch: 12 | loss: 0.2219787
	speed: 0.0169s/iter; left time: 83.4300s
	iters: 300, epoch: 12 | loss: 0.1666441
	speed: 0.0170s/iter; left time: 81.9292s
	iters: 400, epoch: 12 | loss: 0.2601201
	speed: 0.0170s/iter; left time: 80.2319s
	iters: 500, epoch: 12 | loss: 0.2562214
	speed: 0.0169s/iter; left time: 78.4406s
Epoch: 12 cost time: 9.945672988891602
Epoch: 12, Steps: 570 | Train Loss: 0.2220818 Vali Loss: 0.0534947 Test Loss: 0.1561710
Validation loss decreased (0.053528 --> 0.053495).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2680194
	speed: 0.0513s/iter; left time: 228.9612s
	iters: 200, epoch: 13 | loss: 0.2794768
	speed: 0.0169s/iter; left time: 73.4930s
	iters: 300, epoch: 13 | loss: 0.2121294
	speed: 0.0170s/iter; left time: 72.2807s
	iters: 400, epoch: 13 | loss: 0.1974308
	speed: 0.0170s/iter; left time: 70.6165s
	iters: 500, epoch: 13 | loss: 0.1572743
	speed: 0.0170s/iter; left time: 68.9495s
Epoch: 13 cost time: 9.943744897842407
Epoch: 13, Steps: 570 | Train Loss: 0.2236310 Vali Loss: 0.0535584 Test Loss: 0.1561416
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2315268
	speed: 0.0514s/iter; left time: 199.9147s
	iters: 200, epoch: 14 | loss: 0.1732250
	speed: 0.0169s/iter; left time: 64.0149s
	iters: 300, epoch: 14 | loss: 0.3574424
	speed: 0.0169s/iter; left time: 62.3994s
	iters: 400, epoch: 14 | loss: 0.1625539
	speed: 0.0169s/iter; left time: 60.6901s
	iters: 500, epoch: 14 | loss: 0.1681940
	speed: 0.0169s/iter; left time: 59.0757s
Epoch: 14 cost time: 10.011796951293945
Epoch: 14, Steps: 570 | Train Loss: 0.2241748 Vali Loss: 0.0537431 Test Loss: 0.1561242
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2904820
	speed: 0.0510s/iter; left time: 169.5029s
	iters: 200, epoch: 15 | loss: 0.2192653
	speed: 0.0169s/iter; left time: 54.5439s
	iters: 300, epoch: 15 | loss: 0.2122760
	speed: 0.0170s/iter; left time: 52.9750s
	iters: 400, epoch: 15 | loss: 0.2134637
	speed: 0.0170s/iter; left time: 51.2103s
	iters: 500, epoch: 15 | loss: 0.1997483
	speed: 0.0170s/iter; left time: 49.6584s
Epoch: 15 cost time: 9.967105627059937
Epoch: 15, Steps: 570 | Train Loss: 0.2233492 Vali Loss: 0.0536967 Test Loss: 0.1561356
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15627369284629822, mae:0.25418999791145325
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2144737
	speed: 0.0299s/iter; left time: 337.7738s
	iters: 200, epoch: 1 | loss: 0.3402271
	speed: 0.0179s/iter; left time: 199.9915s
	iters: 300, epoch: 1 | loss: 0.4058509
	speed: 0.0178s/iter; left time: 197.9943s
	iters: 400, epoch: 1 | loss: 0.2971203
	speed: 0.0179s/iter; left time: 196.3783s
	iters: 500, epoch: 1 | loss: 0.1734860
	speed: 0.0179s/iter; left time: 194.6604s
Epoch: 1 cost time: 11.436915636062622
Epoch: 1, Steps: 570 | Train Loss: 0.3428784 Vali Loss: 0.0651933 Test Loss: 0.1866074
Validation loss decreased (inf --> 0.065193).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2711714
	speed: 0.0512s/iter; left time: 549.5044s
	iters: 200, epoch: 2 | loss: 0.1883248
	speed: 0.0164s/iter; left time: 174.3023s
	iters: 300, epoch: 2 | loss: 0.2948382
	speed: 0.0164s/iter; left time: 172.7332s
	iters: 400, epoch: 2 | loss: 0.3790845
	speed: 0.0164s/iter; left time: 170.9711s
	iters: 500, epoch: 2 | loss: 0.2702579
	speed: 0.0164s/iter; left time: 169.3399s
Epoch: 2 cost time: 9.677000999450684
Epoch: 2, Steps: 570 | Train Loss: 0.2971498 Vali Loss: 0.0673031 Test Loss: 0.1794859
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2691230
	speed: 0.0486s/iter; left time: 493.9500s
	iters: 200, epoch: 3 | loss: 0.2847893
	speed: 0.0163s/iter; left time: 164.0302s
	iters: 300, epoch: 3 | loss: 0.1823582
	speed: 0.0163s/iter; left time: 162.5988s
	iters: 400, epoch: 3 | loss: 0.3311642
	speed: 0.0163s/iter; left time: 160.9761s
	iters: 500, epoch: 3 | loss: 0.1644257
	speed: 0.0164s/iter; left time: 159.9197s
Epoch: 3 cost time: 9.567793607711792
Epoch: 3, Steps: 570 | Train Loss: 0.2645965 Vali Loss: 0.0609325 Test Loss: 0.1718027
Validation loss decreased (0.065193 --> 0.060933).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2358768
	speed: 0.0514s/iter; left time: 493.4164s
	iters: 200, epoch: 4 | loss: 0.5337734
	speed: 0.0163s/iter; left time: 154.9209s
	iters: 300, epoch: 4 | loss: 0.2043590
	speed: 0.0163s/iter; left time: 153.2302s
	iters: 400, epoch: 4 | loss: 0.1743312
	speed: 0.0163s/iter; left time: 151.7143s
	iters: 500, epoch: 4 | loss: 0.3348444
	speed: 0.0163s/iter; left time: 149.9871s
Epoch: 4 cost time: 9.623189926147461
Epoch: 4, Steps: 570 | Train Loss: 0.2481150 Vali Loss: 0.0584789 Test Loss: 0.1644980
Validation loss decreased (0.060933 --> 0.058479).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2391319
	speed: 0.0504s/iter; left time: 454.7635s
	iters: 200, epoch: 5 | loss: 0.3235899
	speed: 0.0163s/iter; left time: 145.3319s
	iters: 300, epoch: 5 | loss: 0.1979586
	speed: 0.0163s/iter; left time: 143.6726s
	iters: 400, epoch: 5 | loss: 0.1689177
	speed: 0.0163s/iter; left time: 142.1817s
	iters: 500, epoch: 5 | loss: 0.2987221
	speed: 0.0163s/iter; left time: 140.5519s
Epoch: 5 cost time: 9.715510606765747
Epoch: 5, Steps: 570 | Train Loss: 0.2362265 Vali Loss: 0.0601912 Test Loss: 0.1622988
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2104980
	speed: 0.0515s/iter; left time: 435.4017s
	iters: 200, epoch: 6 | loss: 0.3277321
	speed: 0.0179s/iter; left time: 149.4187s
	iters: 300, epoch: 6 | loss: 0.4561567
	speed: 0.0179s/iter; left time: 147.6687s
	iters: 400, epoch: 6 | loss: 0.2088858
	speed: 0.0179s/iter; left time: 145.9596s
	iters: 500, epoch: 6 | loss: 0.2088178
	speed: 0.0179s/iter; left time: 143.9811s
Epoch: 6 cost time: 10.484382629394531
Epoch: 6, Steps: 570 | Train Loss: 0.2292538 Vali Loss: 0.0588901 Test Loss: 0.1615104
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3115033
	speed: 0.0507s/iter; left time: 399.5167s
	iters: 200, epoch: 7 | loss: 0.1426938
	speed: 0.0164s/iter; left time: 127.4448s
	iters: 300, epoch: 7 | loss: 0.2557999
	speed: 0.0164s/iter; left time: 125.7853s
	iters: 400, epoch: 7 | loss: 0.3230401
	speed: 0.0164s/iter; left time: 124.1696s
	iters: 500, epoch: 7 | loss: 0.3296988
	speed: 0.0164s/iter; left time: 122.5001s
Epoch: 7 cost time: 9.61618185043335
Epoch: 7, Steps: 570 | Train Loss: 0.2278809 Vali Loss: 0.0594008 Test Loss: 0.1616243
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16471463441848755, mae:0.2595165967941284
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2977015
	speed: 0.0270s/iter; left time: 304.6271s
	iters: 200, epoch: 1 | loss: 0.3025633
	speed: 0.0154s/iter; left time: 171.9514s
	iters: 300, epoch: 1 | loss: 0.2813328
	speed: 0.0153s/iter; left time: 170.1427s
	iters: 400, epoch: 1 | loss: 0.3453762
	speed: 0.0154s/iter; left time: 168.8853s
	iters: 500, epoch: 1 | loss: 0.6158192
	speed: 0.0153s/iter; left time: 167.1520s
Epoch: 1 cost time: 9.965268850326538
Epoch: 1, Steps: 570 | Train Loss: 0.3398425 Vali Loss: 0.0795060 Test Loss: 0.2115769
Validation loss decreased (inf --> 0.079506).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4421618
	speed: 0.0483s/iter; left time: 518.7490s
	iters: 200, epoch: 2 | loss: 0.1749569
	speed: 0.0155s/iter; left time: 164.8145s
	iters: 300, epoch: 2 | loss: 0.2967185
	speed: 0.0155s/iter; left time: 163.0474s
	iters: 400, epoch: 2 | loss: 0.2667936
	speed: 0.0155s/iter; left time: 161.5114s
	iters: 500, epoch: 2 | loss: 0.3372166
	speed: 0.0155s/iter; left time: 159.8994s
Epoch: 2 cost time: 9.139402866363525
Epoch: 2, Steps: 570 | Train Loss: 0.2999388 Vali Loss: 0.0653191 Test Loss: 0.1817264
Validation loss decreased (0.079506 --> 0.065319).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2608772
	speed: 0.0483s/iter; left time: 490.5442s
	iters: 200, epoch: 3 | loss: 0.1706884
	speed: 0.0154s/iter; left time: 154.4896s
	iters: 300, epoch: 3 | loss: 0.3815733
	speed: 0.0153s/iter; left time: 152.8722s
	iters: 400, epoch: 3 | loss: 0.2664266
	speed: 0.0154s/iter; left time: 151.4610s
	iters: 500, epoch: 3 | loss: 0.2473663
	speed: 0.0153s/iter; left time: 149.7760s
Epoch: 3 cost time: 9.065750122070312
Epoch: 3, Steps: 570 | Train Loss: 0.2685149 Vali Loss: 0.0612395 Test Loss: 0.1667740
Validation loss decreased (0.065319 --> 0.061240).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2239064
	speed: 0.0485s/iter; left time: 464.9356s
	iters: 200, epoch: 4 | loss: 0.2824219
	speed: 0.0154s/iter; left time: 145.9323s
	iters: 300, epoch: 4 | loss: 0.3538493
	speed: 0.0154s/iter; left time: 144.3565s
	iters: 400, epoch: 4 | loss: 0.2288669
	speed: 0.0154s/iter; left time: 142.9081s
	iters: 500, epoch: 4 | loss: 0.3610906
	speed: 0.0154s/iter; left time: 141.3496s
Epoch: 4 cost time: 9.073383092880249
Epoch: 4, Steps: 570 | Train Loss: 0.2505508 Vali Loss: 0.0605412 Test Loss: 0.1656972
Validation loss decreased (0.061240 --> 0.060541).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2240075
	speed: 0.0481s/iter; left time: 433.7307s
	iters: 200, epoch: 5 | loss: 0.2118904
	speed: 0.0153s/iter; left time: 136.8497s
	iters: 300, epoch: 5 | loss: 0.2205756
	speed: 0.0153s/iter; left time: 135.0694s
	iters: 400, epoch: 5 | loss: 0.2091028
	speed: 0.0153s/iter; left time: 133.5348s
	iters: 500, epoch: 5 | loss: 0.1949403
	speed: 0.0153s/iter; left time: 132.0068s
Epoch: 5 cost time: 9.050579309463501
Epoch: 5, Steps: 570 | Train Loss: 0.2422824 Vali Loss: 0.0583978 Test Loss: 0.1641003
Validation loss decreased (0.060541 --> 0.058398).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2339019
	speed: 0.0485s/iter; left time: 409.5797s
	iters: 200, epoch: 6 | loss: 0.1755083
	speed: 0.0154s/iter; left time: 128.7014s
	iters: 300, epoch: 6 | loss: 0.1500492
	speed: 0.0154s/iter; left time: 127.0835s
	iters: 400, epoch: 6 | loss: 0.1486233
	speed: 0.0154s/iter; left time: 125.6263s
	iters: 500, epoch: 6 | loss: 0.2213362
	speed: 0.0154s/iter; left time: 124.0902s
Epoch: 6 cost time: 9.08841323852539
Epoch: 6, Steps: 570 | Train Loss: 0.2372961 Vali Loss: 0.0585612 Test Loss: 0.1626155
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3091866
	speed: 0.0493s/iter; left time: 388.5770s
	iters: 200, epoch: 7 | loss: 0.2188091
	speed: 0.0154s/iter; left time: 119.5949s
	iters: 300, epoch: 7 | loss: 0.1809100
	speed: 0.0153s/iter; left time: 117.8848s
	iters: 400, epoch: 7 | loss: 0.2696238
	speed: 0.0153s/iter; left time: 116.3001s
	iters: 500, epoch: 7 | loss: 0.3083701
	speed: 0.0154s/iter; left time: 114.9005s
Epoch: 7 cost time: 9.029694080352783
Epoch: 7, Steps: 570 | Train Loss: 0.2330361 Vali Loss: 0.0587148 Test Loss: 0.1625889
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2236156
	speed: 0.0486s/iter; left time: 355.1244s
	iters: 200, epoch: 8 | loss: 0.2934226
	speed: 0.0154s/iter; left time: 110.9197s
	iters: 300, epoch: 8 | loss: 0.1606408
	speed: 0.0154s/iter; left time: 109.2378s
	iters: 400, epoch: 8 | loss: 0.2432509
	speed: 0.0154s/iter; left time: 107.7939s
	iters: 500, epoch: 8 | loss: 0.1970395
	speed: 0.0154s/iter; left time: 106.1521s
Epoch: 8 cost time: 9.066486835479736
Epoch: 8, Steps: 570 | Train Loss: 0.2315208 Vali Loss: 0.0578444 Test Loss: 0.1620613
Validation loss decreased (0.058398 --> 0.057844).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1934782
	speed: 0.0480s/iter; left time: 323.8708s
	iters: 200, epoch: 9 | loss: 0.2204364
	speed: 0.0154s/iter; left time: 102.0107s
	iters: 300, epoch: 9 | loss: 0.2244284
	speed: 0.0154s/iter; left time: 100.4870s
	iters: 400, epoch: 9 | loss: 0.1628443
	speed: 0.0154s/iter; left time: 99.3362s
	iters: 500, epoch: 9 | loss: 0.2247437
	speed: 0.0154s/iter; left time: 97.3435s
Epoch: 9 cost time: 9.065080165863037
Epoch: 9, Steps: 570 | Train Loss: 0.2303209 Vali Loss: 0.0581975 Test Loss: 0.1621438
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2562991
	speed: 0.0485s/iter; left time: 299.5120s
	iters: 200, epoch: 10 | loss: 0.2500834
	speed: 0.0154s/iter; left time: 93.3983s
	iters: 300, epoch: 10 | loss: 0.2114974
	speed: 0.0154s/iter; left time: 91.6750s
	iters: 400, epoch: 10 | loss: 0.2712291
	speed: 0.0154s/iter; left time: 90.2081s
	iters: 500, epoch: 10 | loss: 0.3080527
	speed: 0.0154s/iter; left time: 88.6194s
Epoch: 10 cost time: 9.031496286392212
Epoch: 10, Steps: 570 | Train Loss: 0.2312544 Vali Loss: 0.0581431 Test Loss: 0.1621729
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2140190
	speed: 0.0466s/iter; left time: 260.8890s
	iters: 200, epoch: 11 | loss: 0.1459406
	speed: 0.0154s/iter; left time: 84.4553s
	iters: 300, epoch: 11 | loss: 0.2325401
	speed: 0.0153s/iter; left time: 82.8210s
	iters: 400, epoch: 11 | loss: 0.2320054
	speed: 0.0154s/iter; left time: 81.8945s
	iters: 500, epoch: 11 | loss: 0.3245713
	speed: 0.0154s/iter; left time: 79.9384s
Epoch: 11 cost time: 9.04107666015625
Epoch: 11, Steps: 570 | Train Loss: 0.2307453 Vali Loss: 0.0582252 Test Loss: 0.1622383
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16231337189674377, mae:0.25703009963035583
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1897985
	speed: 0.0302s/iter; left time: 341.4175s
	iters: 200, epoch: 1 | loss: 0.2887057
	speed: 0.0187s/iter; left time: 209.5214s
	iters: 300, epoch: 1 | loss: 0.4413811
	speed: 0.0187s/iter; left time: 208.0012s
	iters: 400, epoch: 1 | loss: 0.2888007
	speed: 0.0187s/iter; left time: 206.0313s
	iters: 500, epoch: 1 | loss: 0.2090833
	speed: 0.0188s/iter; left time: 204.4520s
Epoch: 1 cost time: 11.873567581176758
Epoch: 1, Steps: 570 | Train Loss: 0.2503787 Vali Loss: 0.0560616 Test Loss: 0.1611836
Validation loss decreased (inf --> 0.056062).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3634200
	speed: 0.0577s/iter; left time: 619.6034s
	iters: 200, epoch: 2 | loss: 0.2976031
	speed: 0.0189s/iter; left time: 200.9422s
	iters: 300, epoch: 2 | loss: 0.2022951
	speed: 0.0188s/iter; left time: 198.5031s
	iters: 400, epoch: 2 | loss: 0.2796339
	speed: 0.0188s/iter; left time: 196.2489s
	iters: 500, epoch: 2 | loss: 0.2375820
	speed: 0.0188s/iter; left time: 193.9311s
Epoch: 2 cost time: 11.07320237159729
Epoch: 2, Steps: 570 | Train Loss: 0.2878703 Vali Loss: 0.0673999 Test Loss: 0.1945417
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1964109
	speed: 0.0589s/iter; left time: 598.1876s
	iters: 200, epoch: 3 | loss: 0.2394517
	speed: 0.0208s/iter; left time: 209.6902s
	iters: 300, epoch: 3 | loss: 0.2163593
	speed: 0.0209s/iter; left time: 207.7165s
	iters: 400, epoch: 3 | loss: 0.1630104
	speed: 0.0208s/iter; left time: 205.5253s
	iters: 500, epoch: 3 | loss: 0.2052260
	speed: 0.0188s/iter; left time: 183.5460s
Epoch: 3 cost time: 11.841167688369751
Epoch: 3, Steps: 570 | Train Loss: 0.2572694 Vali Loss: 0.0582203 Test Loss: 0.1707456
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2638965
	speed: 0.0572s/iter; left time: 548.4662s
	iters: 200, epoch: 4 | loss: 0.2769852
	speed: 0.0187s/iter; left time: 177.6522s
	iters: 300, epoch: 4 | loss: 0.2741510
	speed: 0.0187s/iter; left time: 175.7048s
	iters: 400, epoch: 4 | loss: 0.1484838
	speed: 0.0187s/iter; left time: 173.8169s
	iters: 500, epoch: 4 | loss: 0.2438200
	speed: 0.0187s/iter; left time: 172.0478s
Epoch: 4 cost time: 11.008790016174316
Epoch: 4, Steps: 570 | Train Loss: 0.2353540 Vali Loss: 0.0568876 Test Loss: 0.1671759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16143308579921722, mae:0.261800080537796
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4577753
	speed: 0.0299s/iter; left time: 337.4111s
	iters: 200, epoch: 1 | loss: 0.1889921
	speed: 0.0183s/iter; left time: 204.6829s
	iters: 300, epoch: 1 | loss: 0.1929015
	speed: 0.0182s/iter; left time: 202.5273s
	iters: 400, epoch: 1 | loss: 0.1672915
	speed: 0.0183s/iter; left time: 200.7760s
	iters: 500, epoch: 1 | loss: 0.3148077
	speed: 0.0183s/iter; left time: 199.0971s
Epoch: 1 cost time: 11.61776614189148
Epoch: 1, Steps: 570 | Train Loss: 0.2371157 Vali Loss: 0.0581155 Test Loss: 0.1931640
Validation loss decreased (inf --> 0.058115).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1904044
	speed: 0.0559s/iter; left time: 600.0165s
	iters: 200, epoch: 2 | loss: 0.3319464
	speed: 0.0183s/iter; left time: 195.0237s
	iters: 300, epoch: 2 | loss: 0.5493437
	speed: 0.0183s/iter; left time: 193.1479s
	iters: 400, epoch: 2 | loss: 0.2594875
	speed: 0.0183s/iter; left time: 191.0955s
	iters: 500, epoch: 2 | loss: 0.1825258
	speed: 0.0183s/iter; left time: 189.0684s
Epoch: 2 cost time: 10.756470918655396
Epoch: 2, Steps: 570 | Train Loss: 0.2861869 Vali Loss: 0.0610071 Test Loss: 0.1707035
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1784080
	speed: 0.0571s/iter; left time: 580.5772s
	iters: 200, epoch: 3 | loss: 0.1907181
	speed: 0.0194s/iter; left time: 194.7726s
	iters: 300, epoch: 3 | loss: 0.2150978
	speed: 0.0185s/iter; left time: 184.4459s
	iters: 400, epoch: 3 | loss: 0.1987578
	speed: 0.0183s/iter; left time: 180.8183s
	iters: 500, epoch: 3 | loss: 0.1934327
	speed: 0.0193s/iter; left time: 188.6903s
Epoch: 3 cost time: 11.01572036743164
Epoch: 3, Steps: 570 | Train Loss: 0.2373628 Vali Loss: 0.0554212 Test Loss: 0.1654473
Validation loss decreased (0.058115 --> 0.055421).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2528630
	speed: 0.0557s/iter; left time: 534.1706s
	iters: 200, epoch: 4 | loss: 0.1235906
	speed: 0.0183s/iter; left time: 173.2503s
	iters: 300, epoch: 4 | loss: 0.2539161
	speed: 0.0182s/iter; left time: 171.3088s
	iters: 400, epoch: 4 | loss: 0.1838807
	speed: 0.0182s/iter; left time: 169.4970s
	iters: 500, epoch: 4 | loss: 0.1295810
	speed: 0.0183s/iter; left time: 168.1744s
Epoch: 4 cost time: 10.707305192947388
Epoch: 4, Steps: 570 | Train Loss: 0.2169620 Vali Loss: 0.0554162 Test Loss: 0.1523077
Validation loss decreased (0.055421 --> 0.055416).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1547552
	speed: 0.0561s/iter; left time: 505.8499s
	iters: 200, epoch: 5 | loss: 0.2026396
	speed: 0.0183s/iter; left time: 163.5621s
	iters: 300, epoch: 5 | loss: 0.1919032
	speed: 0.0183s/iter; left time: 161.5846s
	iters: 400, epoch: 5 | loss: 0.2043490
	speed: 0.0183s/iter; left time: 159.7645s
	iters: 500, epoch: 5 | loss: 0.1990732
	speed: 0.0183s/iter; left time: 157.8234s
Epoch: 5 cost time: 10.733757495880127
Epoch: 5, Steps: 570 | Train Loss: 0.2062961 Vali Loss: 0.0577610 Test Loss: 0.1532470
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2716459
	speed: 0.0565s/iter; left time: 477.6480s
	iters: 200, epoch: 6 | loss: 0.1615687
	speed: 0.0183s/iter; left time: 153.1051s
	iters: 300, epoch: 6 | loss: 0.2168526
	speed: 0.0183s/iter; left time: 151.1631s
	iters: 400, epoch: 6 | loss: 0.1593640
	speed: 0.0183s/iter; left time: 149.3560s
	iters: 500, epoch: 6 | loss: 0.1377405
	speed: 0.0183s/iter; left time: 147.5432s
Epoch: 6 cost time: 10.76628828048706
Epoch: 6, Steps: 570 | Train Loss: 0.2025473 Vali Loss: 0.0542774 Test Loss: 0.1501711
Validation loss decreased (0.055416 --> 0.054277).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1793858
	speed: 0.0560s/iter; left time: 441.0344s
	iters: 200, epoch: 7 | loss: 0.3043558
	speed: 0.0182s/iter; left time: 141.4773s
	iters: 300, epoch: 7 | loss: 0.1265976
	speed: 0.0182s/iter; left time: 139.6327s
	iters: 400, epoch: 7 | loss: 0.2142242
	speed: 0.0182s/iter; left time: 137.8376s
	iters: 500, epoch: 7 | loss: 0.1831573
	speed: 0.0182s/iter; left time: 135.9618s
Epoch: 7 cost time: 10.675867319107056
Epoch: 7, Steps: 570 | Train Loss: 0.1984276 Vali Loss: 0.0547133 Test Loss: 0.1501346
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1364244
	speed: 0.0548s/iter; left time: 400.5291s
	iters: 200, epoch: 8 | loss: 0.1428776
	speed: 0.0183s/iter; left time: 132.0111s
	iters: 300, epoch: 8 | loss: 0.2285191
	speed: 0.0183s/iter; left time: 130.0545s
	iters: 400, epoch: 8 | loss: 0.2212646
	speed: 0.0183s/iter; left time: 128.1680s
	iters: 500, epoch: 8 | loss: 0.2518257
	speed: 0.0183s/iter; left time: 126.6403s
Epoch: 8 cost time: 10.687090396881104
Epoch: 8, Steps: 570 | Train Loss: 0.1964491 Vali Loss: 0.0545418 Test Loss: 0.1491979
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1176716
	speed: 0.0566s/iter; left time: 381.6915s
	iters: 200, epoch: 9 | loss: 0.2062732
	speed: 0.0185s/iter; left time: 122.6133s
	iters: 300, epoch: 9 | loss: 0.2390584
	speed: 0.0184s/iter; left time: 120.5081s
	iters: 400, epoch: 9 | loss: 0.1789776
	speed: 0.0183s/iter; left time: 117.7881s
	iters: 500, epoch: 9 | loss: 0.1672723
	speed: 0.0182s/iter; left time: 115.7222s
Epoch: 9 cost time: 10.774792671203613
Epoch: 9, Steps: 570 | Train Loss: 0.1971224 Vali Loss: 0.0542637 Test Loss: 0.1488945
Validation loss decreased (0.054277 --> 0.054264).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1279312
	speed: 0.0557s/iter; left time: 343.4339s
	iters: 200, epoch: 10 | loss: 0.1533802
	speed: 0.0183s/iter; left time: 111.1480s
	iters: 300, epoch: 10 | loss: 0.2471815
	speed: 0.0183s/iter; left time: 109.3874s
	iters: 400, epoch: 10 | loss: 0.2247956
	speed: 0.0183s/iter; left time: 107.5294s
	iters: 500, epoch: 10 | loss: 0.2233932
	speed: 0.0183s/iter; left time: 105.6984s
Epoch: 10 cost time: 10.74770975112915
Epoch: 10, Steps: 570 | Train Loss: 0.1957112 Vali Loss: 0.0542442 Test Loss: 0.1490749
Validation loss decreased (0.054264 --> 0.054244).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2585023
	speed: 0.0584s/iter; left time: 326.9067s
	iters: 200, epoch: 11 | loss: 0.2559385
	speed: 0.0205s/iter; left time: 112.6402s
	iters: 300, epoch: 11 | loss: 0.1487543
	speed: 0.0205s/iter; left time: 110.5736s
	iters: 400, epoch: 11 | loss: 0.2045055
	speed: 0.0205s/iter; left time: 108.5089s
	iters: 500, epoch: 11 | loss: 0.1912563
	speed: 0.0205s/iter; left time: 106.3737s
Epoch: 11 cost time: 11.973850727081299
Epoch: 11, Steps: 570 | Train Loss: 0.1963690 Vali Loss: 0.0544495 Test Loss: 0.1492017
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2479386
	speed: 0.0561s/iter; left time: 282.3239s
	iters: 200, epoch: 12 | loss: 0.2418561
	speed: 0.0182s/iter; left time: 89.9427s
	iters: 300, epoch: 12 | loss: 0.1374248
	speed: 0.0182s/iter; left time: 88.1194s
	iters: 400, epoch: 12 | loss: 0.1622343
	speed: 0.0183s/iter; left time: 86.3600s
	iters: 500, epoch: 12 | loss: 0.1916432
	speed: 0.0183s/iter; left time: 84.5197s
Epoch: 12 cost time: 10.687935829162598
Epoch: 12, Steps: 570 | Train Loss: 0.1951744 Vali Loss: 0.0542789 Test Loss: 0.1491429
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1677894
	speed: 0.0556s/iter; left time: 248.0950s
	iters: 200, epoch: 13 | loss: 0.2673208
	speed: 0.0183s/iter; left time: 79.9255s
	iters: 300, epoch: 13 | loss: 0.1751967
	speed: 0.0182s/iter; left time: 77.4333s
	iters: 400, epoch: 13 | loss: 0.2055026
	speed: 0.0182s/iter; left time: 75.8584s
	iters: 500, epoch: 13 | loss: 0.2717972
	speed: 0.0182s/iter; left time: 73.9348s
Epoch: 13 cost time: 10.71845030784607
Epoch: 13, Steps: 570 | Train Loss: 0.1961132 Vali Loss: 0.0543760 Test Loss: 0.1491305
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14925047755241394, mae:0.24429486691951752
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3445646
	speed: 0.0325s/iter; left time: 367.5071s
	iters: 200, epoch: 1 | loss: 0.1877764
	speed: 0.0209s/iter; left time: 234.3439s
	iters: 300, epoch: 1 | loss: 0.3729849
	speed: 0.0209s/iter; left time: 232.4118s
	iters: 400, epoch: 1 | loss: 0.3171844
	speed: 0.0210s/iter; left time: 230.5459s
	iters: 500, epoch: 1 | loss: 0.3730814
	speed: 0.0209s/iter; left time: 227.8800s
Epoch: 1 cost time: 13.147491216659546
Epoch: 1, Steps: 570 | Train Loss: 0.2813609 Vali Loss: 0.0633417 Test Loss: 0.1786923
Validation loss decreased (inf --> 0.063342).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3185824
	speed: 0.0601s/iter; left time: 644.9160s
	iters: 200, epoch: 2 | loss: 0.3732510
	speed: 0.0210s/iter; left time: 223.1100s
	iters: 300, epoch: 2 | loss: 0.4587632
	speed: 0.0210s/iter; left time: 220.7202s
	iters: 400, epoch: 2 | loss: 0.2056504
	speed: 0.0210s/iter; left time: 218.5979s
	iters: 500, epoch: 2 | loss: 0.1887688
	speed: 0.0210s/iter; left time: 216.5527s
Epoch: 2 cost time: 12.259498596191406
Epoch: 2, Steps: 570 | Train Loss: 0.2697050 Vali Loss: 0.0622225 Test Loss: 0.1683851
Validation loss decreased (0.063342 --> 0.062223).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1565359
	speed: 0.0603s/iter; left time: 613.0545s
	iters: 200, epoch: 3 | loss: 0.2706599
	speed: 0.0209s/iter; left time: 210.7677s
	iters: 300, epoch: 3 | loss: 0.2815258
	speed: 0.0209s/iter; left time: 208.2688s
	iters: 400, epoch: 3 | loss: 0.3146517
	speed: 0.0209s/iter; left time: 205.9058s
	iters: 500, epoch: 3 | loss: 0.2551386
	speed: 0.0209s/iter; left time: 204.2763s
Epoch: 3 cost time: 12.19207763671875
Epoch: 3, Steps: 570 | Train Loss: 0.2377717 Vali Loss: 0.0598904 Test Loss: 0.1628170
Validation loss decreased (0.062223 --> 0.059890).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2135967
	speed: 0.0599s/iter; left time: 574.4865s
	iters: 200, epoch: 4 | loss: 0.2030511
	speed: 0.0210s/iter; left time: 199.1187s
	iters: 300, epoch: 4 | loss: 0.1808579
	speed: 0.0209s/iter; left time: 196.6963s
	iters: 400, epoch: 4 | loss: 0.2235925
	speed: 0.0210s/iter; left time: 194.6805s
	iters: 500, epoch: 4 | loss: 0.1414864
	speed: 0.0209s/iter; left time: 192.5174s
Epoch: 4 cost time: 12.257015943527222
Epoch: 4, Steps: 570 | Train Loss: 0.2207926 Vali Loss: 0.0544014 Test Loss: 0.1543365
Validation loss decreased (0.059890 --> 0.054401).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1340903
	speed: 0.0597s/iter; left time: 538.8949s
	iters: 200, epoch: 5 | loss: 0.2077597
	speed: 0.0209s/iter; left time: 186.7808s
	iters: 300, epoch: 5 | loss: 0.1357080
	speed: 0.0209s/iter; left time: 184.6088s
	iters: 400, epoch: 5 | loss: 0.1882963
	speed: 0.0209s/iter; left time: 182.4303s
	iters: 500, epoch: 5 | loss: 0.1163111
	speed: 0.0209s/iter; left time: 180.4169s
Epoch: 5 cost time: 12.211029052734375
Epoch: 5, Steps: 570 | Train Loss: 0.2083121 Vali Loss: 0.0520057 Test Loss: 0.1467012
Validation loss decreased (0.054401 --> 0.052006).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2263478
	speed: 0.0632s/iter; left time: 533.9268s
	iters: 200, epoch: 6 | loss: 0.1294562
	speed: 0.0185s/iter; left time: 154.8164s
	iters: 300, epoch: 6 | loss: 0.4127450
	speed: 0.0182s/iter; left time: 150.3984s
	iters: 400, epoch: 6 | loss: 0.1523789
	speed: 0.0182s/iter; left time: 148.3754s
	iters: 500, epoch: 6 | loss: 0.2137214
	speed: 0.0182s/iter; left time: 146.5145s
Epoch: 6 cost time: 10.937878131866455
Epoch: 6, Steps: 570 | Train Loss: 0.1999501 Vali Loss: 0.0507813 Test Loss: 0.1440697
Validation loss decreased (0.052006 --> 0.050781).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1522244
	speed: 0.0557s/iter; left time: 438.8332s
	iters: 200, epoch: 7 | loss: 0.1638225
	speed: 0.0183s/iter; left time: 142.0820s
	iters: 300, epoch: 7 | loss: 0.2337635
	speed: 0.0182s/iter; left time: 140.0604s
	iters: 400, epoch: 7 | loss: 0.1708054
	speed: 0.0182s/iter; left time: 138.1213s
	iters: 500, epoch: 7 | loss: 0.1548209
	speed: 0.0182s/iter; left time: 136.2622s
Epoch: 7 cost time: 10.684828042984009
Epoch: 7, Steps: 570 | Train Loss: 0.1966750 Vali Loss: 0.0515746 Test Loss: 0.1437420
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1198446
	speed: 0.0591s/iter; left time: 431.9049s
	iters: 200, epoch: 8 | loss: 0.1399414
	speed: 0.0204s/iter; left time: 147.0753s
	iters: 300, epoch: 8 | loss: 0.1922701
	speed: 0.0204s/iter; left time: 145.2110s
	iters: 400, epoch: 8 | loss: 0.2479041
	speed: 0.0204s/iter; left time: 142.9566s
	iters: 500, epoch: 8 | loss: 0.1562815
	speed: 0.0204s/iter; left time: 141.0627s
Epoch: 8 cost time: 11.939346551895142
Epoch: 8, Steps: 570 | Train Loss: 0.1939699 Vali Loss: 0.0508912 Test Loss: 0.1437241
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2116522
	speed: 0.0612s/iter; left time: 412.5643s
	iters: 200, epoch: 9 | loss: 0.2552299
	speed: 0.0209s/iter; left time: 138.9193s
	iters: 300, epoch: 9 | loss: 0.2623025
	speed: 0.0209s/iter; left time: 136.7958s
	iters: 400, epoch: 9 | loss: 0.3542818
	speed: 0.0209s/iter; left time: 134.6630s
	iters: 500, epoch: 9 | loss: 0.1560402
	speed: 0.0209s/iter; left time: 132.5362s
Epoch: 9 cost time: 12.205559015274048
Epoch: 9, Steps: 570 | Train Loss: 0.1923798 Vali Loss: 0.0505789 Test Loss: 0.1431689
Validation loss decreased (0.050781 --> 0.050579).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1748650
	speed: 0.0618s/iter; left time: 381.6656s
	iters: 200, epoch: 10 | loss: 0.1834387
	speed: 0.0209s/iter; left time: 127.1624s
	iters: 300, epoch: 10 | loss: 0.2298550
	speed: 0.0209s/iter; left time: 124.5912s
	iters: 400, epoch: 10 | loss: 0.2008950
	speed: 0.0209s/iter; left time: 122.4858s
	iters: 500, epoch: 10 | loss: 0.2051430
	speed: 0.0209s/iter; left time: 120.4190s
Epoch: 10 cost time: 12.18502163887024
Epoch: 10, Steps: 570 | Train Loss: 0.1923975 Vali Loss: 0.0504339 Test Loss: 0.1432166
Validation loss decreased (0.050579 --> 0.050434).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1846491
	speed: 0.0599s/iter; left time: 335.5044s
	iters: 200, epoch: 11 | loss: 0.2004280
	speed: 0.0209s/iter; left time: 114.7853s
	iters: 300, epoch: 11 | loss: 0.1794293
	speed: 0.0209s/iter; left time: 112.6900s
	iters: 400, epoch: 11 | loss: 0.1951572
	speed: 0.0209s/iter; left time: 110.8263s
	iters: 500, epoch: 11 | loss: 0.1286800
	speed: 0.0209s/iter; left time: 108.6107s
Epoch: 11 cost time: 12.176588296890259
Epoch: 11, Steps: 570 | Train Loss: 0.1942597 Vali Loss: 0.0503781 Test Loss: 0.1431744
Validation loss decreased (0.050434 --> 0.050378).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1566080
	speed: 0.0589s/iter; left time: 296.3549s
	iters: 200, epoch: 12 | loss: 0.2663315
	speed: 0.0182s/iter; left time: 89.6838s
	iters: 300, epoch: 12 | loss: 0.1894167
	speed: 0.0182s/iter; left time: 87.8640s
	iters: 400, epoch: 12 | loss: 0.1221318
	speed: 0.0182s/iter; left time: 86.0054s
	iters: 500, epoch: 12 | loss: 0.2709911
	speed: 0.0182s/iter; left time: 84.1019s
Epoch: 12 cost time: 10.774144172668457
Epoch: 12, Steps: 570 | Train Loss: 0.1917216 Vali Loss: 0.0504367 Test Loss: 0.1431719
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1706440
	speed: 0.0568s/iter; left time: 253.2221s
	iters: 200, epoch: 13 | loss: 0.1085223
	speed: 0.0186s/iter; left time: 80.9659s
	iters: 300, epoch: 13 | loss: 0.1748090
	speed: 0.0192s/iter; left time: 81.9142s
	iters: 400, epoch: 13 | loss: 0.1320335
	speed: 0.0204s/iter; left time: 84.8512s
	iters: 500, epoch: 13 | loss: 0.1230229
	speed: 0.0204s/iter; left time: 82.6921s
Epoch: 13 cost time: 11.611348867416382
Epoch: 13, Steps: 570 | Train Loss: 0.1911351 Vali Loss: 0.0506621 Test Loss: 0.1431873
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1293672
	speed: 0.0608s/iter; left time: 236.5323s
	iters: 200, epoch: 14 | loss: 0.1320582
	speed: 0.0209s/iter; left time: 79.1022s
	iters: 300, epoch: 14 | loss: 0.1745252
	speed: 0.0209s/iter; left time: 76.9651s
	iters: 400, epoch: 14 | loss: 0.1491092
	speed: 0.0209s/iter; left time: 74.9028s
	iters: 500, epoch: 14 | loss: 0.1423359
	speed: 0.0209s/iter; left time: 72.7985s
Epoch: 14 cost time: 12.185254335403442
Epoch: 14, Steps: 570 | Train Loss: 0.1921796 Vali Loss: 0.0504895 Test Loss: 0.1431945
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14335070550441742, mae:0.24025031924247742
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2392795
	speed: 0.0343s/iter; left time: 387.8176s
	iters: 200, epoch: 1 | loss: 0.3235706
	speed: 0.0222s/iter; left time: 248.1742s
	iters: 300, epoch: 1 | loss: 0.2933561
	speed: 0.0222s/iter; left time: 246.0044s
	iters: 400, epoch: 1 | loss: 0.4406134
	speed: 0.0222s/iter; left time: 243.8248s
	iters: 500, epoch: 1 | loss: 0.4308271
	speed: 0.0221s/iter; left time: 241.2581s
Epoch: 1 cost time: 13.903225898742676
Epoch: 1, Steps: 570 | Train Loss: 0.3484697 Vali Loss: 0.0637454 Test Loss: 0.1881898
Validation loss decreased (inf --> 0.063745).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3287198
	speed: 0.0657s/iter; left time: 704.6571s
	iters: 200, epoch: 2 | loss: 0.2529510
	speed: 0.0240s/iter; left time: 255.1172s
	iters: 300, epoch: 2 | loss: 0.2642837
	speed: 0.0240s/iter; left time: 252.9995s
	iters: 400, epoch: 2 | loss: 0.2760209
	speed: 0.0240s/iter; left time: 250.3376s
	iters: 500, epoch: 2 | loss: 0.2563839
	speed: 0.0240s/iter; left time: 248.0970s
Epoch: 2 cost time: 13.998886346817017
Epoch: 2, Steps: 570 | Train Loss: 0.2911943 Vali Loss: 0.0618177 Test Loss: 0.1784082
Validation loss decreased (0.063745 --> 0.061818).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5450932
	speed: 0.0680s/iter; left time: 690.9515s
	iters: 200, epoch: 3 | loss: 0.2047932
	speed: 0.0220s/iter; left time: 221.7746s
	iters: 300, epoch: 3 | loss: 0.3956991
	speed: 0.0220s/iter; left time: 219.3778s
	iters: 400, epoch: 3 | loss: 0.2368403
	speed: 0.0220s/iter; left time: 217.3105s
	iters: 500, epoch: 3 | loss: 0.2099386
	speed: 0.0220s/iter; left time: 215.1210s
Epoch: 3 cost time: 12.864713668823242
Epoch: 3, Steps: 570 | Train Loss: 0.2846029 Vali Loss: 0.0579255 Test Loss: 0.1641819
Validation loss decreased (0.061818 --> 0.057925).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2046410
	speed: 0.0629s/iter; left time: 603.7329s
	iters: 200, epoch: 4 | loss: 0.2222010
	speed: 0.0220s/iter; left time: 208.7906s
	iters: 300, epoch: 4 | loss: 0.2790974
	speed: 0.0220s/iter; left time: 206.4901s
	iters: 400, epoch: 4 | loss: 0.2107026
	speed: 0.0220s/iter; left time: 204.5055s
	iters: 500, epoch: 4 | loss: 0.3143312
	speed: 0.0220s/iter; left time: 202.4739s
Epoch: 4 cost time: 12.887407541275024
Epoch: 4, Steps: 570 | Train Loss: 0.2583972 Vali Loss: 0.0568851 Test Loss: 0.1662834
Validation loss decreased (0.057925 --> 0.056885).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2783979
	speed: 0.0633s/iter; left time: 571.4105s
	iters: 200, epoch: 5 | loss: 0.2492633
	speed: 0.0221s/iter; left time: 197.0368s
	iters: 300, epoch: 5 | loss: 0.1835204
	speed: 0.0221s/iter; left time: 194.8929s
	iters: 400, epoch: 5 | loss: 0.2364521
	speed: 0.0221s/iter; left time: 192.6282s
	iters: 500, epoch: 5 | loss: 0.2786642
	speed: 0.0221s/iter; left time: 190.5702s
Epoch: 5 cost time: 12.889318943023682
Epoch: 5, Steps: 570 | Train Loss: 0.2471538 Vali Loss: 0.0547942 Test Loss: 0.1584070
Validation loss decreased (0.056885 --> 0.054794).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2043900
	speed: 0.0652s/iter; left time: 550.6114s
	iters: 200, epoch: 6 | loss: 0.3686359
	speed: 0.0220s/iter; left time: 183.9377s
	iters: 300, epoch: 6 | loss: 0.2122341
	speed: 0.0220s/iter; left time: 181.7354s
	iters: 400, epoch: 6 | loss: 0.1944636
	speed: 0.0220s/iter; left time: 179.5275s
	iters: 500, epoch: 6 | loss: 0.3643658
	speed: 0.0220s/iter; left time: 177.2790s
Epoch: 6 cost time: 12.86254596710205
Epoch: 6, Steps: 570 | Train Loss: 0.2404939 Vali Loss: 0.0540997 Test Loss: 0.1588474
Validation loss decreased (0.054794 --> 0.054100).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2972192
	speed: 0.0651s/iter; left time: 513.3508s
	iters: 200, epoch: 7 | loss: 0.1989725
	speed: 0.0221s/iter; left time: 172.3042s
	iters: 300, epoch: 7 | loss: 0.1605517
	speed: 0.0221s/iter; left time: 170.0443s
	iters: 400, epoch: 7 | loss: 0.1990369
	speed: 0.0221s/iter; left time: 167.9161s
	iters: 500, epoch: 7 | loss: 0.1980347
	speed: 0.0221s/iter; left time: 165.6793s
Epoch: 7 cost time: 12.9523344039917
Epoch: 7, Steps: 570 | Train Loss: 0.2361313 Vali Loss: 0.0534070 Test Loss: 0.1574572
Validation loss decreased (0.054100 --> 0.053407).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1609631
	speed: 0.0634s/iter; left time: 463.7313s
	iters: 200, epoch: 8 | loss: 0.6042265
	speed: 0.0221s/iter; left time: 159.4751s
	iters: 300, epoch: 8 | loss: 0.1642970
	speed: 0.0221s/iter; left time: 157.3586s
	iters: 400, epoch: 8 | loss: 0.2039292
	speed: 0.0221s/iter; left time: 155.0844s
	iters: 500, epoch: 8 | loss: 0.2035870
	speed: 0.0221s/iter; left time: 152.8276s
Epoch: 8 cost time: 12.929905891418457
Epoch: 8, Steps: 570 | Train Loss: 0.2348030 Vali Loss: 0.0534884 Test Loss: 0.1569922
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2348224
	speed: 0.0619s/iter; left time: 417.1533s
	iters: 200, epoch: 9 | loss: 0.1998831
	speed: 0.0220s/iter; left time: 146.3185s
	iters: 300, epoch: 9 | loss: 0.3595006
	speed: 0.0220s/iter; left time: 144.1156s
	iters: 400, epoch: 9 | loss: 0.1851474
	speed: 0.0220s/iter; left time: 141.8334s
	iters: 500, epoch: 9 | loss: 0.2093672
	speed: 0.0220s/iter; left time: 139.6174s
Epoch: 9 cost time: 12.820004940032959
Epoch: 9, Steps: 570 | Train Loss: 0.2342727 Vali Loss: 0.0532538 Test Loss: 0.1566123
Validation loss decreased (0.053407 --> 0.053254).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2134637
	speed: 0.0626s/iter; left time: 386.0652s
	iters: 200, epoch: 10 | loss: 0.2708219
	speed: 0.0221s/iter; left time: 133.9152s
	iters: 300, epoch: 10 | loss: 0.2378317
	speed: 0.0221s/iter; left time: 131.6851s
	iters: 400, epoch: 10 | loss: 0.3833191
	speed: 0.0220s/iter; left time: 129.3859s
	iters: 500, epoch: 10 | loss: 0.2913111
	speed: 0.0220s/iter; left time: 127.2452s
Epoch: 10 cost time: 12.890914916992188
Epoch: 10, Steps: 570 | Train Loss: 0.2342428 Vali Loss: 0.0534238 Test Loss: 0.1564279
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1943801
	speed: 0.0639s/iter; left time: 357.9947s
	iters: 200, epoch: 11 | loss: 0.1655978
	speed: 0.0221s/iter; left time: 121.4604s
	iters: 300, epoch: 11 | loss: 0.1294974
	speed: 0.0221s/iter; left time: 119.1229s
	iters: 400, epoch: 11 | loss: 0.2129554
	speed: 0.0221s/iter; left time: 116.9546s
	iters: 500, epoch: 11 | loss: 0.1963433
	speed: 0.0221s/iter; left time: 114.6920s
Epoch: 11 cost time: 12.851131677627563
Epoch: 11, Steps: 570 | Train Loss: 0.2345260 Vali Loss: 0.0532203 Test Loss: 0.1563416
Validation loss decreased (0.053254 --> 0.053220).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2545201
	speed: 0.0654s/iter; left time: 329.2623s
	iters: 200, epoch: 12 | loss: 0.1851709
	speed: 0.0221s/iter; left time: 109.1787s
	iters: 300, epoch: 12 | loss: 0.3137481
	speed: 0.0221s/iter; left time: 106.8944s
	iters: 400, epoch: 12 | loss: 0.1479778
	speed: 0.0221s/iter; left time: 104.6490s
	iters: 500, epoch: 12 | loss: 0.2617011
	speed: 0.0221s/iter; left time: 102.4211s
Epoch: 12 cost time: 12.937089443206787
Epoch: 12, Steps: 570 | Train Loss: 0.2333996 Vali Loss: 0.0531982 Test Loss: 0.1563964
Validation loss decreased (0.053220 --> 0.053198).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3771702
	speed: 0.0633s/iter; left time: 282.6025s
	iters: 200, epoch: 13 | loss: 0.1694183
	speed: 0.0222s/iter; left time: 96.8051s
	iters: 300, epoch: 13 | loss: 0.1437278
	speed: 0.0222s/iter; left time: 94.5270s
	iters: 400, epoch: 13 | loss: 0.2160377
	speed: 0.0222s/iter; left time: 92.3110s
	iters: 500, epoch: 13 | loss: 0.4250709
	speed: 0.0222s/iter; left time: 90.2093s
Epoch: 13 cost time: 12.963280200958252
Epoch: 13, Steps: 570 | Train Loss: 0.2338304 Vali Loss: 0.0532326 Test Loss: 0.1563705
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2406413
	speed: 0.0625s/iter; left time: 243.2995s
	iters: 200, epoch: 14 | loss: 0.3010644
	speed: 0.0221s/iter; left time: 83.6922s
	iters: 300, epoch: 14 | loss: 0.2287150
	speed: 0.0221s/iter; left time: 81.4516s
	iters: 400, epoch: 14 | loss: 0.1924923
	speed: 0.0221s/iter; left time: 79.3316s
	iters: 500, epoch: 14 | loss: 0.1605249
	speed: 0.0221s/iter; left time: 77.2702s
Epoch: 14 cost time: 12.875060319900513
Epoch: 14, Steps: 570 | Train Loss: 0.2321255 Vali Loss: 0.0534521 Test Loss: 0.1563781
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2224185
	speed: 0.0643s/iter; left time: 213.7006s
	iters: 200, epoch: 15 | loss: 0.2126149
	speed: 0.0222s/iter; left time: 71.3906s
	iters: 300, epoch: 15 | loss: 0.1061153
	speed: 0.0221s/iter; left time: 69.0753s
	iters: 400, epoch: 15 | loss: 0.2380839
	speed: 0.0221s/iter; left time: 66.8805s
	iters: 500, epoch: 15 | loss: 0.2103924
	speed: 0.0221s/iter; left time: 64.6511s
Epoch: 15 cost time: 12.938843488693237
Epoch: 15, Steps: 570 | Train Loss: 0.2347845 Vali Loss: 0.0533193 Test Loss: 0.1563731
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1566171944141388, mae:0.2542649507522583
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3377392
	speed: 0.0330s/iter; left time: 373.4224s
	iters: 200, epoch: 1 | loss: 0.1646500
	speed: 0.0214s/iter; left time: 239.2884s
	iters: 300, epoch: 1 | loss: 0.2190873
	speed: 0.0214s/iter; left time: 237.4184s
	iters: 400, epoch: 1 | loss: 0.2957370
	speed: 0.0214s/iter; left time: 234.8769s
	iters: 500, epoch: 1 | loss: 0.2291556
	speed: 0.0214s/iter; left time: 233.2782s
Epoch: 1 cost time: 13.408550500869751
Epoch: 1, Steps: 570 | Train Loss: 0.3399138 Vali Loss: 0.0699984 Test Loss: 0.1897158
Validation loss decreased (inf --> 0.069998).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2779487
	speed: 0.0642s/iter; left time: 688.6223s
	iters: 200, epoch: 2 | loss: 0.2231273
	speed: 0.0214s/iter; left time: 227.9705s
	iters: 300, epoch: 2 | loss: 0.3795634
	speed: 0.0214s/iter; left time: 225.6746s
	iters: 400, epoch: 2 | loss: 0.2643101
	speed: 0.0214s/iter; left time: 223.2013s
	iters: 500, epoch: 2 | loss: 0.2047420
	speed: 0.0214s/iter; left time: 221.5478s
Epoch: 2 cost time: 12.529194831848145
Epoch: 2, Steps: 570 | Train Loss: 0.2844722 Vali Loss: 0.0626669 Test Loss: 0.1898932
Validation loss decreased (0.069998 --> 0.062667).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2739033
	speed: 0.0652s/iter; left time: 662.1446s
	iters: 200, epoch: 3 | loss: 0.2690250
	speed: 0.0214s/iter; left time: 214.8658s
	iters: 300, epoch: 3 | loss: 0.1724478
	speed: 0.0213s/iter; left time: 212.6239s
	iters: 400, epoch: 3 | loss: 0.1621042
	speed: 0.0213s/iter; left time: 210.3601s
	iters: 500, epoch: 3 | loss: 0.2729535
	speed: 0.0213s/iter; left time: 208.3490s
Epoch: 3 cost time: 12.476640701293945
Epoch: 3, Steps: 570 | Train Loss: 0.2619222 Vali Loss: 0.0608310 Test Loss: 0.1616126
Validation loss decreased (0.062667 --> 0.060831).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1626700
	speed: 0.0616s/iter; left time: 590.9157s
	iters: 200, epoch: 4 | loss: 0.2158362
	speed: 0.0213s/iter; left time: 202.2244s
	iters: 300, epoch: 4 | loss: 0.2240596
	speed: 0.0213s/iter; left time: 200.2874s
	iters: 400, epoch: 4 | loss: 0.3337071
	speed: 0.0213s/iter; left time: 197.9642s
	iters: 500, epoch: 4 | loss: 0.1876449
	speed: 0.0213s/iter; left time: 195.8913s
Epoch: 4 cost time: 12.451783180236816
Epoch: 4, Steps: 570 | Train Loss: 0.2398474 Vali Loss: 0.0581919 Test Loss: 0.1548366
Validation loss decreased (0.060831 --> 0.058192).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3035271
	speed: 0.0615s/iter; left time: 554.6474s
	iters: 200, epoch: 5 | loss: 0.1793818
	speed: 0.0213s/iter; left time: 189.8101s
	iters: 300, epoch: 5 | loss: 0.2417612
	speed: 0.0213s/iter; left time: 187.8336s
	iters: 400, epoch: 5 | loss: 0.2484414
	speed: 0.0213s/iter; left time: 185.4268s
	iters: 500, epoch: 5 | loss: 0.1850076
	speed: 0.0213s/iter; left time: 183.4114s
Epoch: 5 cost time: 12.440310955047607
Epoch: 5, Steps: 570 | Train Loss: 0.2259612 Vali Loss: 0.0581790 Test Loss: 0.1517878
Validation loss decreased (0.058192 --> 0.058179).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2080330
	speed: 0.0618s/iter; left time: 522.2266s
	iters: 200, epoch: 6 | loss: 0.3204569
	speed: 0.0214s/iter; left time: 179.1110s
	iters: 300, epoch: 6 | loss: 0.2294517
	speed: 0.0215s/iter; left time: 177.0775s
	iters: 400, epoch: 6 | loss: 0.1415012
	speed: 0.0214s/iter; left time: 174.6666s
	iters: 500, epoch: 6 | loss: 0.1335572
	speed: 0.0214s/iter; left time: 172.4935s
Epoch: 6 cost time: 12.524194955825806
Epoch: 6, Steps: 570 | Train Loss: 0.2220644 Vali Loss: 0.0585967 Test Loss: 0.1529160
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1969465
	speed: 0.0634s/iter; left time: 499.8249s
	iters: 200, epoch: 7 | loss: 0.2675973
	speed: 0.0214s/iter; left time: 166.5159s
	iters: 300, epoch: 7 | loss: 0.2175160
	speed: 0.0214s/iter; left time: 164.4299s
	iters: 400, epoch: 7 | loss: 0.1372379
	speed: 0.0214s/iter; left time: 162.2041s
	iters: 500, epoch: 7 | loss: 0.1875855
	speed: 0.0214s/iter; left time: 160.0782s
Epoch: 7 cost time: 12.494813919067383
Epoch: 7, Steps: 570 | Train Loss: 0.2186270 Vali Loss: 0.0573958 Test Loss: 0.1515518
Validation loss decreased (0.058179 --> 0.057396).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2150478
	speed: 0.0621s/iter; left time: 453.8890s
	iters: 200, epoch: 8 | loss: 0.2058710
	speed: 0.0214s/iter; left time: 154.6078s
	iters: 300, epoch: 8 | loss: 0.2225778
	speed: 0.0214s/iter; left time: 152.4315s
	iters: 400, epoch: 8 | loss: 0.2368623
	speed: 0.0214s/iter; left time: 150.2796s
	iters: 500, epoch: 8 | loss: 0.2915786
	speed: 0.0214s/iter; left time: 148.1124s
Epoch: 8 cost time: 12.534618616104126
Epoch: 8, Steps: 570 | Train Loss: 0.2145763 Vali Loss: 0.0559872 Test Loss: 0.1507481
Validation loss decreased (0.057396 --> 0.055987).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1523317
	speed: 0.0637s/iter; left time: 429.3513s
	iters: 200, epoch: 9 | loss: 0.3080234
	speed: 0.0233s/iter; left time: 154.6424s
	iters: 300, epoch: 9 | loss: 0.1853736
	speed: 0.0233s/iter; left time: 152.1523s
	iters: 400, epoch: 9 | loss: 0.1888307
	speed: 0.0233s/iter; left time: 149.8180s
	iters: 500, epoch: 9 | loss: 0.1443109
	speed: 0.0233s/iter; left time: 147.5173s
Epoch: 9 cost time: 13.59677267074585
Epoch: 9, Steps: 570 | Train Loss: 0.2150063 Vali Loss: 0.0561404 Test Loss: 0.1507259
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1206441
	speed: 0.0623s/iter; left time: 384.1791s
	iters: 200, epoch: 10 | loss: 0.2277396
	speed: 0.0215s/iter; left time: 130.3027s
	iters: 300, epoch: 10 | loss: 0.1638017
	speed: 0.0215s/iter; left time: 128.1167s
	iters: 400, epoch: 10 | loss: 0.2121173
	speed: 0.0214s/iter; left time: 125.8528s
	iters: 500, epoch: 10 | loss: 0.2538242
	speed: 0.0214s/iter; left time: 123.6605s
Epoch: 10 cost time: 12.512019157409668
Epoch: 10, Steps: 570 | Train Loss: 0.2131337 Vali Loss: 0.0561769 Test Loss: 0.1508286
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2837865
	speed: 0.0615s/iter; left time: 344.6421s
	iters: 200, epoch: 11 | loss: 0.2379410
	speed: 0.0214s/iter; left time: 117.7934s
	iters: 300, epoch: 11 | loss: 0.1742121
	speed: 0.0214s/iter; left time: 115.6572s
	iters: 400, epoch: 11 | loss: 0.1710873
	speed: 0.0214s/iter; left time: 113.2421s
	iters: 500, epoch: 11 | loss: 0.2518443
	speed: 0.0213s/iter; left time: 111.0156s
Epoch: 11 cost time: 12.460595846176147
Epoch: 11, Steps: 570 | Train Loss: 0.2131534 Vali Loss: 0.0561333 Test Loss: 0.1507716
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15090881288051605, mae:0.2482869029045105
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3404231
	speed: 0.0320s/iter; left time: 361.5946s
	iters: 200, epoch: 1 | loss: 0.2426745
	speed: 0.0202s/iter; left time: 225.8984s
	iters: 300, epoch: 1 | loss: 0.4168512
	speed: 0.0202s/iter; left time: 223.6939s
	iters: 400, epoch: 1 | loss: 0.3796895
	speed: 0.0201s/iter; left time: 221.1340s
	iters: 500, epoch: 1 | loss: 0.2751806
	speed: 0.0200s/iter; left time: 218.0853s
Epoch: 1 cost time: 12.824127435684204
Epoch: 1, Steps: 570 | Train Loss: 0.3250057 Vali Loss: 0.0661804 Test Loss: 0.1876831
Validation loss decreased (inf --> 0.066180).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1786113
	speed: 0.0608s/iter; left time: 651.9142s
	iters: 200, epoch: 2 | loss: 0.5230356
	speed: 0.0200s/iter; left time: 212.8684s
	iters: 300, epoch: 2 | loss: 0.3196713
	speed: 0.0200s/iter; left time: 210.9458s
	iters: 400, epoch: 2 | loss: 0.1660084
	speed: 0.0200s/iter; left time: 209.1379s
	iters: 500, epoch: 2 | loss: 0.1820250
	speed: 0.0200s/iter; left time: 207.1260s
Epoch: 2 cost time: 11.740784168243408
Epoch: 2, Steps: 570 | Train Loss: 0.2875961 Vali Loss: 0.0598336 Test Loss: 0.1854444
Validation loss decreased (0.066180 --> 0.059834).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1814147
	speed: 0.0596s/iter; left time: 605.8869s
	iters: 200, epoch: 3 | loss: 0.1833535
	speed: 0.0201s/iter; left time: 201.9345s
	iters: 300, epoch: 3 | loss: 0.2722208
	speed: 0.0201s/iter; left time: 200.0327s
	iters: 400, epoch: 3 | loss: 0.2516907
	speed: 0.0201s/iter; left time: 197.7144s
	iters: 500, epoch: 3 | loss: 0.2900542
	speed: 0.0200s/iter; left time: 195.4708s
Epoch: 3 cost time: 11.74783992767334
Epoch: 3, Steps: 570 | Train Loss: 0.2670503 Vali Loss: 0.0646542 Test Loss: 0.1743281
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1391644
	speed: 0.0593s/iter; left time: 568.4444s
	iters: 200, epoch: 4 | loss: 0.4543982
	speed: 0.0202s/iter; left time: 191.2701s
	iters: 300, epoch: 4 | loss: 0.1633909
	speed: 0.0201s/iter; left time: 189.0386s
	iters: 400, epoch: 4 | loss: 0.2394994
	speed: 0.0201s/iter; left time: 186.5756s
	iters: 500, epoch: 4 | loss: 0.2080919
	speed: 0.0201s/iter; left time: 185.0088s
Epoch: 4 cost time: 11.755877017974854
Epoch: 4, Steps: 570 | Train Loss: 0.2490871 Vali Loss: 0.0620873 Test Loss: 0.1656219
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2104890
	speed: 0.0590s/iter; left time: 531.8204s
	iters: 200, epoch: 5 | loss: 0.4366803
	speed: 0.0202s/iter; left time: 180.1585s
	iters: 300, epoch: 5 | loss: 0.2191622
	speed: 0.0201s/iter; left time: 177.7410s
	iters: 400, epoch: 5 | loss: 0.2156383
	speed: 0.0202s/iter; left time: 175.7948s
	iters: 500, epoch: 5 | loss: 0.2265786
	speed: 0.0202s/iter; left time: 173.8781s
Epoch: 5 cost time: 11.794955015182495
Epoch: 5, Steps: 570 | Train Loss: 0.2388819 Vali Loss: 0.0566011 Test Loss: 0.1586045
Validation loss decreased (0.059834 --> 0.056601).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2559460
	speed: 0.0600s/iter; left time: 507.4240s
	iters: 200, epoch: 6 | loss: 0.2333039
	speed: 0.0201s/iter; left time: 168.1653s
	iters: 300, epoch: 6 | loss: 0.2261849
	speed: 0.0201s/iter; left time: 166.2005s
	iters: 400, epoch: 6 | loss: 0.1795142
	speed: 0.0201s/iter; left time: 164.2310s
	iters: 500, epoch: 6 | loss: 0.3686235
	speed: 0.0202s/iter; left time: 162.3055s
Epoch: 6 cost time: 11.75473928451538
Epoch: 6, Steps: 570 | Train Loss: 0.2322234 Vali Loss: 0.0568356 Test Loss: 0.1558356
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2439669
	speed: 0.0580s/iter; left time: 456.9707s
	iters: 200, epoch: 7 | loss: 0.2223335
	speed: 0.0201s/iter; left time: 156.5674s
	iters: 300, epoch: 7 | loss: 0.2759081
	speed: 0.0201s/iter; left time: 154.3387s
	iters: 400, epoch: 7 | loss: 0.4412869
	speed: 0.0201s/iter; left time: 152.2563s
	iters: 500, epoch: 7 | loss: 0.1374561
	speed: 0.0201s/iter; left time: 150.0643s
Epoch: 7 cost time: 11.749794483184814
Epoch: 7, Steps: 570 | Train Loss: 0.2276247 Vali Loss: 0.0568543 Test Loss: 0.1559284
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2687363
	speed: 0.0588s/iter; left time: 429.7600s
	iters: 200, epoch: 8 | loss: 0.3044820
	speed: 0.0202s/iter; left time: 145.3933s
	iters: 300, epoch: 8 | loss: 0.2953758
	speed: 0.0201s/iter; left time: 143.2161s
	iters: 400, epoch: 8 | loss: 0.1874395
	speed: 0.0202s/iter; left time: 141.3380s
	iters: 500, epoch: 8 | loss: 0.2586952
	speed: 0.0202s/iter; left time: 139.3845s
Epoch: 8 cost time: 11.819557428359985
Epoch: 8, Steps: 570 | Train Loss: 0.2268142 Vali Loss: 0.0565078 Test Loss: 0.1549985
Validation loss decreased (0.056601 --> 0.056508).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2243491
	speed: 0.0621s/iter; left time: 418.3213s
	iters: 200, epoch: 9 | loss: 0.1885431
	speed: 0.0201s/iter; left time: 133.7745s
	iters: 300, epoch: 9 | loss: 0.2734574
	speed: 0.0201s/iter; left time: 131.5854s
	iters: 400, epoch: 9 | loss: 0.1793066
	speed: 0.0201s/iter; left time: 129.4760s
	iters: 500, epoch: 9 | loss: 0.1427067
	speed: 0.0201s/iter; left time: 127.7219s
Epoch: 9 cost time: 11.781221628189087
Epoch: 9, Steps: 570 | Train Loss: 0.2260832 Vali Loss: 0.0563967 Test Loss: 0.1547564
Validation loss decreased (0.056508 --> 0.056397).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2403950
	speed: 0.0596s/iter; left time: 367.7644s
	iters: 200, epoch: 10 | loss: 0.1651448
	speed: 0.0201s/iter; left time: 122.0587s
	iters: 300, epoch: 10 | loss: 0.2896049
	speed: 0.0201s/iter; left time: 119.8959s
	iters: 400, epoch: 10 | loss: 0.3092924
	speed: 0.0201s/iter; left time: 117.8504s
	iters: 500, epoch: 10 | loss: 0.2361620
	speed: 0.0201s/iter; left time: 115.8818s
Epoch: 10 cost time: 11.741727352142334
Epoch: 10, Steps: 570 | Train Loss: 0.2255608 Vali Loss: 0.0564119 Test Loss: 0.1546019
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2059657
	speed: 0.0627s/iter; left time: 351.0879s
	iters: 200, epoch: 11 | loss: 0.1982250
	speed: 0.0223s/iter; left time: 122.7408s
	iters: 300, epoch: 11 | loss: 0.1643462
	speed: 0.0223s/iter; left time: 120.1812s
	iters: 400, epoch: 11 | loss: 0.2687558
	speed: 0.0212s/iter; left time: 112.6201s
	iters: 500, epoch: 11 | loss: 0.1734656
	speed: 0.0202s/iter; left time: 104.8308s
Epoch: 11 cost time: 12.523143529891968
Epoch: 11, Steps: 570 | Train Loss: 0.2242707 Vali Loss: 0.0564297 Test Loss: 0.1546341
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2062238
	speed: 0.0583s/iter; left time: 293.3372s
	iters: 200, epoch: 12 | loss: 0.1974917
	speed: 0.0201s/iter; left time: 99.0675s
	iters: 300, epoch: 12 | loss: 0.3693649
	speed: 0.0201s/iter; left time: 97.1088s
	iters: 400, epoch: 12 | loss: 0.2459300
	speed: 0.0201s/iter; left time: 94.9773s
	iters: 500, epoch: 12 | loss: 0.3968561
	speed: 0.0201s/iter; left time: 93.0425s
Epoch: 12 cost time: 11.709505796432495
Epoch: 12, Steps: 570 | Train Loss: 0.2242734 Vali Loss: 0.0563085 Test Loss: 0.1546287
Validation loss decreased (0.056397 --> 0.056308).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2222096
	speed: 0.0594s/iter; left time: 265.0717s
	iters: 200, epoch: 13 | loss: 0.1883194
	speed: 0.0202s/iter; left time: 87.9550s
	iters: 300, epoch: 13 | loss: 0.2055316
	speed: 0.0201s/iter; left time: 85.7852s
	iters: 400, epoch: 13 | loss: 0.1621581
	speed: 0.0202s/iter; left time: 83.8509s
	iters: 500, epoch: 13 | loss: 0.3007304
	speed: 0.0202s/iter; left time: 81.8581s
Epoch: 13 cost time: 11.773485898971558
Epoch: 13, Steps: 570 | Train Loss: 0.2250128 Vali Loss: 0.0565566 Test Loss: 0.1546288
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.2919002
	speed: 0.0583s/iter; left time: 227.0343s
	iters: 200, epoch: 14 | loss: 0.2277680
	speed: 0.0201s/iter; left time: 76.2789s
	iters: 300, epoch: 14 | loss: 0.2307416
	speed: 0.0201s/iter; left time: 74.3616s
	iters: 400, epoch: 14 | loss: 0.1529334
	speed: 0.0201s/iter; left time: 72.3353s
	iters: 500, epoch: 14 | loss: 0.1951609
	speed: 0.0201s/iter; left time: 70.2578s
Epoch: 14 cost time: 11.743305921554565
Epoch: 14, Steps: 570 | Train Loss: 0.2229430 Vali Loss: 0.0564357 Test Loss: 0.1546331
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1179616
	speed: 0.0597s/iter; left time: 198.3964s
	iters: 200, epoch: 15 | loss: 0.2970698
	speed: 0.0201s/iter; left time: 64.7917s
	iters: 300, epoch: 15 | loss: 0.2058809
	speed: 0.0201s/iter; left time: 62.6177s
	iters: 400, epoch: 15 | loss: 0.2033745
	speed: 0.0201s/iter; left time: 60.5911s
	iters: 500, epoch: 15 | loss: 0.2084622
	speed: 0.0200s/iter; left time: 58.5561s
Epoch: 15 cost time: 11.737856388092041
Epoch: 15, Steps: 570 | Train Loss: 0.2243458 Vali Loss: 0.0565327 Test Loss: 0.1546283
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15482033789157867, mae:0.25201061367988586
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2117237
	speed: 0.0220s/iter; left time: 248.8152s
	iters: 200, epoch: 1 | loss: 0.1962214
	speed: 0.0105s/iter; left time: 117.1434s
	iters: 300, epoch: 1 | loss: 0.2084974
	speed: 0.0105s/iter; left time: 116.3532s
	iters: 400, epoch: 1 | loss: 0.2296560
	speed: 0.0105s/iter; left time: 115.0132s
	iters: 500, epoch: 1 | loss: 0.2272920
	speed: 0.0105s/iter; left time: 114.2215s
Epoch: 1 cost time: 7.171305179595947
Epoch: 1, Steps: 570 | Train Loss: 0.2698223 Vali Loss: 0.0505259 Test Loss: 0.1521214
Validation loss decreased (inf --> 0.050526).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5054663
	speed: 0.0362s/iter; left time: 388.5442s
	iters: 200, epoch: 2 | loss: 0.3730318
	speed: 0.0104s/iter; left time: 110.9767s
	iters: 300, epoch: 2 | loss: 0.2677314
	speed: 0.0104s/iter; left time: 109.7926s
	iters: 400, epoch: 2 | loss: 0.2034914
	speed: 0.0104s/iter; left time: 108.8417s
	iters: 500, epoch: 2 | loss: 0.2365679
	speed: 0.0104s/iter; left time: 107.7636s
Epoch: 2 cost time: 6.234140396118164
Epoch: 2, Steps: 570 | Train Loss: 0.2636143 Vali Loss: 0.0675508 Test Loss: 0.1951685
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2460580
	speed: 0.0364s/iter; left time: 369.8823s
	iters: 200, epoch: 3 | loss: 0.3752654
	speed: 0.0104s/iter; left time: 104.8366s
	iters: 300, epoch: 3 | loss: 0.2134835
	speed: 0.0104s/iter; left time: 104.0087s
	iters: 400, epoch: 3 | loss: 0.2111763
	speed: 0.0104s/iter; left time: 102.8978s
	iters: 500, epoch: 3 | loss: 0.2905028
	speed: 0.0104s/iter; left time: 101.8983s
Epoch: 3 cost time: 6.264663457870483
Epoch: 3, Steps: 570 | Train Loss: 0.2672945 Vali Loss: 0.0502162 Test Loss: 0.1495679
Validation loss decreased (0.050526 --> 0.050216).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4105504
	speed: 0.0376s/iter; left time: 360.9838s
	iters: 200, epoch: 4 | loss: 0.1554852
	speed: 0.0104s/iter; left time: 98.8073s
	iters: 300, epoch: 4 | loss: 0.2539790
	speed: 0.0104s/iter; left time: 97.9731s
	iters: 400, epoch: 4 | loss: 0.2332794
	speed: 0.0104s/iter; left time: 96.9278s
	iters: 500, epoch: 4 | loss: 0.2072173
	speed: 0.0104s/iter; left time: 95.7301s
Epoch: 4 cost time: 6.259564161300659
Epoch: 4, Steps: 570 | Train Loss: 0.2372657 Vali Loss: 0.0477580 Test Loss: 0.1426489
Validation loss decreased (0.050216 --> 0.047758).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2328312
	speed: 0.0356s/iter; left time: 320.7285s
	iters: 200, epoch: 5 | loss: 0.2216953
	speed: 0.0104s/iter; left time: 92.8863s
	iters: 300, epoch: 5 | loss: 0.1907568
	speed: 0.0104s/iter; left time: 91.7870s
	iters: 400, epoch: 5 | loss: 0.1760155
	speed: 0.0104s/iter; left time: 91.1016s
	iters: 500, epoch: 5 | loss: 0.2505337
	speed: 0.0105s/iter; left time: 90.2355s
Epoch: 5 cost time: 6.247252464294434
Epoch: 5, Steps: 570 | Train Loss: 0.2250188 Vali Loss: 0.0460322 Test Loss: 0.1390025
Validation loss decreased (0.047758 --> 0.046032).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1989035
	speed: 0.0378s/iter; left time: 319.8456s
	iters: 200, epoch: 6 | loss: 0.1535221
	speed: 0.0105s/iter; left time: 87.2908s
	iters: 300, epoch: 6 | loss: 0.2412390
	speed: 0.0105s/iter; left time: 86.2707s
	iters: 400, epoch: 6 | loss: 0.2632490
	speed: 0.0105s/iter; left time: 85.1997s
	iters: 500, epoch: 6 | loss: 0.2396662
	speed: 0.0104s/iter; left time: 84.1275s
Epoch: 6 cost time: 6.246135711669922
Epoch: 6, Steps: 570 | Train Loss: 0.2193443 Vali Loss: 0.0450908 Test Loss: 0.1399323
Validation loss decreased (0.046032 --> 0.045091).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2661636
	speed: 0.0366s/iter; left time: 288.7899s
	iters: 200, epoch: 7 | loss: 0.2804905
	speed: 0.0105s/iter; left time: 81.4527s
	iters: 300, epoch: 7 | loss: 0.1554718
	speed: 0.0105s/iter; left time: 80.3677s
	iters: 400, epoch: 7 | loss: 0.1617900
	speed: 0.0105s/iter; left time: 79.3304s
	iters: 500, epoch: 7 | loss: 0.1971248
	speed: 0.0105s/iter; left time: 78.2625s
Epoch: 7 cost time: 6.25324559211731
Epoch: 7, Steps: 570 | Train Loss: 0.2169546 Vali Loss: 0.0455527 Test Loss: 0.1369280
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2547485
	speed: 0.0357s/iter; left time: 261.2762s
	iters: 200, epoch: 8 | loss: 0.2095753
	speed: 0.0105s/iter; left time: 75.6768s
	iters: 300, epoch: 8 | loss: 0.2478575
	speed: 0.0105s/iter; left time: 74.6272s
	iters: 400, epoch: 8 | loss: 0.2990359
	speed: 0.0105s/iter; left time: 73.5842s
	iters: 500, epoch: 8 | loss: 0.1562864
	speed: 0.0105s/iter; left time: 72.4651s
Epoch: 8 cost time: 6.3018388748168945
Epoch: 8, Steps: 570 | Train Loss: 0.2126635 Vali Loss: 0.0449546 Test Loss: 0.1366721
Validation loss decreased (0.045091 --> 0.044955).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2795043
	speed: 0.0364s/iter; left time: 245.5225s
	iters: 200, epoch: 9 | loss: 0.1916270
	speed: 0.0105s/iter; left time: 69.8932s
	iters: 300, epoch: 9 | loss: 0.1030944
	speed: 0.0105s/iter; left time: 68.5353s
	iters: 400, epoch: 9 | loss: 0.1902943
	speed: 0.0105s/iter; left time: 67.6586s
	iters: 500, epoch: 9 | loss: 0.1884133
	speed: 0.0105s/iter; left time: 66.8493s
Epoch: 9 cost time: 6.327685117721558
Epoch: 9, Steps: 570 | Train Loss: 0.2139503 Vali Loss: 0.0453385 Test Loss: 0.1365460
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1995925
	speed: 0.0367s/iter; left time: 226.5458s
	iters: 200, epoch: 10 | loss: 0.1834594
	speed: 0.0104s/iter; left time: 63.3855s
	iters: 300, epoch: 10 | loss: 0.1525384
	speed: 0.0105s/iter; left time: 62.4762s
	iters: 400, epoch: 10 | loss: 0.1993958
	speed: 0.0104s/iter; left time: 61.3487s
	iters: 500, epoch: 10 | loss: 0.3330832
	speed: 0.0105s/iter; left time: 60.4912s
Epoch: 10 cost time: 6.369235992431641
Epoch: 10, Steps: 570 | Train Loss: 0.2125980 Vali Loss: 0.0449574 Test Loss: 0.1366582
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2353677
	speed: 0.0367s/iter; left time: 205.4235s
	iters: 200, epoch: 11 | loss: 0.1963727
	speed: 0.0105s/iter; left time: 57.6356s
	iters: 300, epoch: 11 | loss: 0.1679645
	speed: 0.0105s/iter; left time: 56.4705s
	iters: 400, epoch: 11 | loss: 0.3239220
	speed: 0.0104s/iter; left time: 55.3630s
	iters: 500, epoch: 11 | loss: 0.1685197
	speed: 0.0104s/iter; left time: 54.2857s
Epoch: 11 cost time: 6.238062143325806
Epoch: 11, Steps: 570 | Train Loss: 0.2125218 Vali Loss: 0.0449107 Test Loss: 0.1366072
Validation loss decreased (0.044955 --> 0.044911).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2075755
	speed: 0.0372s/iter; left time: 186.9113s
	iters: 200, epoch: 12 | loss: 0.2189093
	speed: 0.0105s/iter; left time: 51.7587s
	iters: 300, epoch: 12 | loss: 0.1716382
	speed: 0.0105s/iter; left time: 50.6757s
	iters: 400, epoch: 12 | loss: 0.1820216
	speed: 0.0105s/iter; left time: 49.6273s
	iters: 500, epoch: 12 | loss: 0.3031299
	speed: 0.0105s/iter; left time: 48.5636s
Epoch: 12 cost time: 6.281940937042236
Epoch: 12, Steps: 570 | Train Loss: 0.2114540 Vali Loss: 0.0450061 Test Loss: 0.1366529
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1022834
	speed: 0.0353s/iter; left time: 157.5550s
	iters: 200, epoch: 13 | loss: 0.2675892
	speed: 0.0105s/iter; left time: 45.7415s
	iters: 300, epoch: 13 | loss: 0.1558159
	speed: 0.0105s/iter; left time: 44.6781s
	iters: 400, epoch: 13 | loss: 0.1571575
	speed: 0.0105s/iter; left time: 43.6360s
	iters: 500, epoch: 13 | loss: 0.2214960
	speed: 0.0105s/iter; left time: 42.5514s
Epoch: 13 cost time: 6.258947372436523
Epoch: 13, Steps: 570 | Train Loss: 0.2133635 Vali Loss: 0.0450953 Test Loss: 0.1366360
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1524723
	speed: 0.0361s/iter; left time: 140.5357s
	iters: 200, epoch: 14 | loss: 0.1994179
	speed: 0.0105s/iter; left time: 39.7153s
	iters: 300, epoch: 14 | loss: 0.2454288
	speed: 0.0105s/iter; left time: 38.6802s
	iters: 400, epoch: 14 | loss: 0.2762757
	speed: 0.0105s/iter; left time: 37.6347s
	iters: 500, epoch: 14 | loss: 0.2121911
	speed: 0.0105s/iter; left time: 36.6224s
Epoch: 14 cost time: 6.263035535812378
Epoch: 14, Steps: 570 | Train Loss: 0.2123307 Vali Loss: 0.0449673 Test Loss: 0.1366275
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13682235777378082, mae:0.23013094067573547
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2720160
	speed: 0.0235s/iter; left time: 265.8249s
	iters: 200, epoch: 1 | loss: 0.2550612
	speed: 0.0116s/iter; left time: 130.2905s
	iters: 300, epoch: 1 | loss: 0.2996303
	speed: 0.0111s/iter; left time: 123.7416s
	iters: 400, epoch: 1 | loss: 0.2450242
	speed: 0.0104s/iter; left time: 114.0813s
	iters: 500, epoch: 1 | loss: 0.2024878
	speed: 0.0104s/iter; left time: 112.9372s
Epoch: 1 cost time: 7.476855278015137
Epoch: 1, Steps: 570 | Train Loss: 0.2292420 Vali Loss: 0.0406269 Test Loss: 0.1289614
Validation loss decreased (inf --> 0.040627).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1660670
	speed: 0.0369s/iter; left time: 395.9932s
	iters: 200, epoch: 2 | loss: 0.2225348
	speed: 0.0103s/iter; left time: 109.0103s
	iters: 300, epoch: 2 | loss: 0.1696781
	speed: 0.0103s/iter; left time: 108.2404s
	iters: 400, epoch: 2 | loss: 0.2024043
	speed: 0.0103s/iter; left time: 107.0188s
	iters: 500, epoch: 2 | loss: 0.2608290
	speed: 0.0103s/iter; left time: 106.2111s
Epoch: 2 cost time: 6.1616668701171875
Epoch: 2, Steps: 570 | Train Loss: 0.2151188 Vali Loss: 0.0432774 Test Loss: 0.1319082
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1073155
	speed: 0.0384s/iter; left time: 390.2057s
	iters: 200, epoch: 3 | loss: 0.2045198
	speed: 0.0118s/iter; left time: 118.7316s
	iters: 300, epoch: 3 | loss: 0.3562557
	speed: 0.0119s/iter; left time: 118.1520s
	iters: 400, epoch: 3 | loss: 0.1984722
	speed: 0.0118s/iter; left time: 116.2431s
	iters: 500, epoch: 3 | loss: 0.1355830
	speed: 0.0118s/iter; left time: 115.0998s
Epoch: 3 cost time: 7.003190994262695
Epoch: 3, Steps: 570 | Train Loss: 0.1942021 Vali Loss: 0.0354472 Test Loss: 0.1168530
Validation loss decreased (0.040627 --> 0.035447).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1595048
	speed: 0.0382s/iter; left time: 366.5038s
	iters: 200, epoch: 4 | loss: 0.1545954
	speed: 0.0118s/iter; left time: 111.8431s
	iters: 300, epoch: 4 | loss: 0.1039984
	speed: 0.0118s/iter; left time: 110.9109s
	iters: 400, epoch: 4 | loss: 0.1309091
	speed: 0.0118s/iter; left time: 109.7568s
	iters: 500, epoch: 4 | loss: 0.2197086
	speed: 0.0118s/iter; left time: 108.6915s
Epoch: 4 cost time: 7.0193305015563965
Epoch: 4, Steps: 570 | Train Loss: 0.1774322 Vali Loss: 0.0345319 Test Loss: 0.1144773
Validation loss decreased (0.035447 --> 0.034532).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1512218
	speed: 0.0380s/iter; left time: 342.7783s
	iters: 200, epoch: 5 | loss: 0.2394757
	speed: 0.0118s/iter; left time: 105.1550s
	iters: 300, epoch: 5 | loss: 0.1671902
	speed: 0.0118s/iter; left time: 103.7674s
	iters: 400, epoch: 5 | loss: 0.1594759
	speed: 0.0118s/iter; left time: 102.9081s
	iters: 500, epoch: 5 | loss: 0.1756693
	speed: 0.0118s/iter; left time: 101.6771s
Epoch: 5 cost time: 6.997888565063477
Epoch: 5, Steps: 570 | Train Loss: 0.1706449 Vali Loss: 0.0340808 Test Loss: 0.1143026
Validation loss decreased (0.034532 --> 0.034081).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1132660
	speed: 0.0390s/iter; left time: 329.7496s
	iters: 200, epoch: 6 | loss: 0.2210791
	speed: 0.0103s/iter; left time: 86.1760s
	iters: 300, epoch: 6 | loss: 0.1718553
	speed: 0.0103s/iter; left time: 85.2981s
	iters: 400, epoch: 6 | loss: 0.1357596
	speed: 0.0107s/iter; left time: 87.2708s
	iters: 500, epoch: 6 | loss: 0.1047990
	speed: 0.0109s/iter; left time: 87.9465s
Epoch: 6 cost time: 6.389994382858276
Epoch: 6, Steps: 570 | Train Loss: 0.1650022 Vali Loss: 0.0340683 Test Loss: 0.1121477
Validation loss decreased (0.034081 --> 0.034068).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1775665
	speed: 0.0366s/iter; left time: 288.7427s
	iters: 200, epoch: 7 | loss: 0.1840083
	speed: 0.0103s/iter; left time: 80.0612s
	iters: 300, epoch: 7 | loss: 0.3098571
	speed: 0.0103s/iter; left time: 79.0619s
	iters: 400, epoch: 7 | loss: 0.2166393
	speed: 0.0103s/iter; left time: 78.0445s
	iters: 500, epoch: 7 | loss: 0.1808318
	speed: 0.0103s/iter; left time: 76.9403s
Epoch: 7 cost time: 6.1598474979400635
Epoch: 7, Steps: 570 | Train Loss: 0.1634188 Vali Loss: 0.0334270 Test Loss: 0.1127313
Validation loss decreased (0.034068 --> 0.033427).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1337667
	speed: 0.0381s/iter; left time: 278.7151s
	iters: 200, epoch: 8 | loss: 0.1220730
	speed: 0.0103s/iter; left time: 74.2404s
	iters: 300, epoch: 8 | loss: 0.1137987
	speed: 0.0103s/iter; left time: 73.1457s
	iters: 400, epoch: 8 | loss: 0.1611990
	speed: 0.0103s/iter; left time: 72.3715s
	iters: 500, epoch: 8 | loss: 0.1009670
	speed: 0.0103s/iter; left time: 70.9555s
Epoch: 8 cost time: 6.242177248001099
Epoch: 8, Steps: 570 | Train Loss: 0.1629380 Vali Loss: 0.0332468 Test Loss: 0.1121480
Validation loss decreased (0.033427 --> 0.033247).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1463883
	speed: 0.0404s/iter; left time: 272.1419s
	iters: 200, epoch: 9 | loss: 0.1533737
	speed: 0.0105s/iter; left time: 69.4982s
	iters: 300, epoch: 9 | loss: 0.1479795
	speed: 0.0103s/iter; left time: 67.4730s
	iters: 400, epoch: 9 | loss: 0.2016435
	speed: 0.0103s/iter; left time: 66.4097s
	iters: 500, epoch: 9 | loss: 0.1387911
	speed: 0.0103s/iter; left time: 65.4533s
Epoch: 9 cost time: 6.322438955307007
Epoch: 9, Steps: 570 | Train Loss: 0.1612467 Vali Loss: 0.0334340 Test Loss: 0.1120927
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2028267
	speed: 0.0373s/iter; left time: 229.8721s
	iters: 200, epoch: 10 | loss: 0.1325454
	speed: 0.0116s/iter; left time: 70.3941s
	iters: 300, epoch: 10 | loss: 0.1501399
	speed: 0.0116s/iter; left time: 69.1704s
	iters: 400, epoch: 10 | loss: 0.1044933
	speed: 0.0116s/iter; left time: 68.0528s
	iters: 500, epoch: 10 | loss: 0.1074002
	speed: 0.0116s/iter; left time: 66.9036s
Epoch: 10 cost time: 6.903021574020386
Epoch: 10, Steps: 570 | Train Loss: 0.1624086 Vali Loss: 0.0333549 Test Loss: 0.1120792
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1523762
	speed: 0.0370s/iter; left time: 207.4273s
	iters: 200, epoch: 11 | loss: 0.1533564
	speed: 0.0104s/iter; left time: 56.9614s
	iters: 300, epoch: 11 | loss: 0.1951946
	speed: 0.0103s/iter; left time: 55.8297s
	iters: 400, epoch: 11 | loss: 0.1608341
	speed: 0.0103s/iter; left time: 54.7370s
	iters: 500, epoch: 11 | loss: 0.1590894
	speed: 0.0103s/iter; left time: 53.6618s
Epoch: 11 cost time: 6.180590629577637
Epoch: 11, Steps: 570 | Train Loss: 0.1606826 Vali Loss: 0.0332173 Test Loss: 0.1120477
Validation loss decreased (0.033247 --> 0.033217).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1488593
	speed: 0.0369s/iter; left time: 185.4573s
	iters: 200, epoch: 12 | loss: 0.1528861
	speed: 0.0103s/iter; left time: 51.0015s
	iters: 300, epoch: 12 | loss: 0.1186375
	speed: 0.0104s/iter; left time: 50.0501s
	iters: 400, epoch: 12 | loss: 0.2596448
	speed: 0.0103s/iter; left time: 48.9312s
	iters: 500, epoch: 12 | loss: 0.1406447
	speed: 0.0104s/iter; left time: 47.9749s
Epoch: 12 cost time: 6.193445920944214
Epoch: 12, Steps: 570 | Train Loss: 0.1614960 Vali Loss: 0.0332660 Test Loss: 0.1121420
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2797479
	speed: 0.0376s/iter; left time: 167.5491s
	iters: 200, epoch: 13 | loss: 0.2159488
	speed: 0.0103s/iter; left time: 44.7488s
	iters: 300, epoch: 13 | loss: 0.1232705
	speed: 0.0104s/iter; left time: 44.5129s
	iters: 400, epoch: 13 | loss: 0.1761489
	speed: 0.0116s/iter; left time: 48.0704s
	iters: 500, epoch: 13 | loss: 0.1888717
	speed: 0.0116s/iter; left time: 46.9914s
Epoch: 13 cost time: 6.527817964553833
Epoch: 13, Steps: 570 | Train Loss: 0.1612591 Vali Loss: 0.0332204 Test Loss: 0.1121158
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1898113
	speed: 0.0368s/iter; left time: 143.1451s
	iters: 200, epoch: 14 | loss: 0.1162388
	speed: 0.0103s/iter; left time: 39.1596s
	iters: 300, epoch: 14 | loss: 0.1605986
	speed: 0.0103s/iter; left time: 38.0982s
	iters: 400, epoch: 14 | loss: 0.1655512
	speed: 0.0103s/iter; left time: 37.1168s
	iters: 500, epoch: 14 | loss: 0.1636503
	speed: 0.0106s/iter; left time: 37.0080s
Epoch: 14 cost time: 6.282956123352051
Epoch: 14, Steps: 570 | Train Loss: 0.1613626 Vali Loss: 0.0332831 Test Loss: 0.1121289
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11220263689756393, mae:0.20432178676128387
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2665744
	speed: 0.0221s/iter; left time: 249.3126s
	iters: 200, epoch: 1 | loss: 0.1625039
	speed: 0.0102s/iter; left time: 114.6148s
	iters: 300, epoch: 1 | loss: 0.1715275
	speed: 0.0102s/iter; left time: 113.7618s
	iters: 400, epoch: 1 | loss: 0.2192196
	speed: 0.0102s/iter; left time: 112.3898s
	iters: 500, epoch: 1 | loss: 0.2436446
	speed: 0.0102s/iter; left time: 111.6684s
Epoch: 1 cost time: 7.059645891189575
Epoch: 1, Steps: 570 | Train Loss: 0.2679370 Vali Loss: 0.0518775 Test Loss: 0.1528189
Validation loss decreased (inf --> 0.051878).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3995857
	speed: 0.0363s/iter; left time: 389.7174s
	iters: 200, epoch: 2 | loss: 0.3813215
	speed: 0.0103s/iter; left time: 109.8620s
	iters: 300, epoch: 2 | loss: 0.2108474
	speed: 0.0104s/iter; left time: 109.1688s
	iters: 400, epoch: 2 | loss: 0.3423056
	speed: 0.0103s/iter; left time: 107.7693s
	iters: 500, epoch: 2 | loss: 0.3010347
	speed: 0.0103s/iter; left time: 106.5234s
Epoch: 2 cost time: 6.186953067779541
Epoch: 2, Steps: 570 | Train Loss: 0.2640337 Vali Loss: 0.0516810 Test Loss: 0.1591369
Validation loss decreased (0.051878 --> 0.051681).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1683755
	speed: 0.0378s/iter; left time: 383.7513s
	iters: 200, epoch: 3 | loss: 0.2236179
	speed: 0.0102s/iter; left time: 103.0676s
	iters: 300, epoch: 3 | loss: 0.2537792
	speed: 0.0102s/iter; left time: 101.7648s
	iters: 400, epoch: 3 | loss: 0.1891318
	speed: 0.0103s/iter; left time: 101.2828s
	iters: 500, epoch: 3 | loss: 0.1693430
	speed: 0.0103s/iter; left time: 100.0649s
Epoch: 3 cost time: 6.13559365272522
Epoch: 3, Steps: 570 | Train Loss: 0.2363307 Vali Loss: 0.0479477 Test Loss: 0.1425689
Validation loss decreased (0.051681 --> 0.047948).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1491272
	speed: 0.0360s/iter; left time: 345.6987s
	iters: 200, epoch: 4 | loss: 0.1335760
	speed: 0.0103s/iter; left time: 97.9722s
	iters: 300, epoch: 4 | loss: 0.1788428
	speed: 0.0103s/iter; left time: 96.6884s
	iters: 400, epoch: 4 | loss: 0.2666694
	speed: 0.0103s/iter; left time: 95.5644s
	iters: 500, epoch: 4 | loss: 0.1612497
	speed: 0.0103s/iter; left time: 94.4866s
Epoch: 4 cost time: 6.171074390411377
Epoch: 4, Steps: 570 | Train Loss: 0.2194571 Vali Loss: 0.0480028 Test Loss: 0.1399659
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1819476
	speed: 0.0380s/iter; left time: 342.4094s
	iters: 200, epoch: 5 | loss: 0.1414169
	speed: 0.0102s/iter; left time: 91.3245s
	iters: 300, epoch: 5 | loss: 0.2882839
	speed: 0.0103s/iter; left time: 90.5997s
	iters: 400, epoch: 5 | loss: 0.1805757
	speed: 0.0102s/iter; left time: 89.2999s
	iters: 500, epoch: 5 | loss: 0.3003975
	speed: 0.0102s/iter; left time: 88.2836s
Epoch: 5 cost time: 6.185537338256836
Epoch: 5, Steps: 570 | Train Loss: 0.2111736 Vali Loss: 0.0444598 Test Loss: 0.1373426
Validation loss decreased (0.047948 --> 0.044460).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1481559
	speed: 0.0370s/iter; left time: 312.7998s
	iters: 200, epoch: 6 | loss: 0.2157323
	speed: 0.0103s/iter; left time: 85.7641s
	iters: 300, epoch: 6 | loss: 0.2078682
	speed: 0.0103s/iter; left time: 84.8313s
	iters: 400, epoch: 6 | loss: 0.1530166
	speed: 0.0103s/iter; left time: 83.7108s
	iters: 500, epoch: 6 | loss: 0.1808219
	speed: 0.0103s/iter; left time: 82.7146s
Epoch: 6 cost time: 6.147995948791504
Epoch: 6, Steps: 570 | Train Loss: 0.2026788 Vali Loss: 0.0443465 Test Loss: 0.1363007
Validation loss decreased (0.044460 --> 0.044347).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2109874
	speed: 0.0356s/iter; left time: 280.8406s
	iters: 200, epoch: 7 | loss: 0.1694206
	speed: 0.0103s/iter; left time: 79.9159s
	iters: 300, epoch: 7 | loss: 0.1643476
	speed: 0.0103s/iter; left time: 78.8259s
	iters: 400, epoch: 7 | loss: 0.1253503
	speed: 0.0103s/iter; left time: 77.9279s
	iters: 500, epoch: 7 | loss: 0.2321343
	speed: 0.0117s/iter; left time: 87.1845s
Epoch: 7 cost time: 6.3664140701293945
Epoch: 7, Steps: 570 | Train Loss: 0.2003247 Vali Loss: 0.0449832 Test Loss: 0.1369952
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1437660
	speed: 0.0389s/iter; left time: 284.6403s
	iters: 200, epoch: 8 | loss: 0.1740367
	speed: 0.0117s/iter; left time: 84.6288s
	iters: 300, epoch: 8 | loss: 0.2138445
	speed: 0.0118s/iter; left time: 83.8251s
	iters: 400, epoch: 8 | loss: 0.2274852
	speed: 0.0118s/iter; left time: 82.5468s
	iters: 500, epoch: 8 | loss: 0.2640571
	speed: 0.0117s/iter; left time: 81.2022s
Epoch: 8 cost time: 6.819082260131836
Epoch: 8, Steps: 570 | Train Loss: 0.1992223 Vali Loss: 0.0450322 Test Loss: 0.1366178
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1558319
	speed: 0.0361s/iter; left time: 243.2239s
	iters: 200, epoch: 9 | loss: 0.2155426
	speed: 0.0103s/iter; left time: 68.1510s
	iters: 300, epoch: 9 | loss: 0.1660830
	speed: 0.0102s/iter; left time: 66.9928s
	iters: 400, epoch: 9 | loss: 0.1353658
	speed: 0.0103s/iter; left time: 66.2040s
	iters: 500, epoch: 9 | loss: 0.2189843
	speed: 0.0115s/iter; left time: 73.1943s
Epoch: 9 cost time: 6.383540153503418
Epoch: 9, Steps: 570 | Train Loss: 0.1988193 Vali Loss: 0.0453159 Test Loss: 0.1367790
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1364724338054657, mae:0.23290593922138214
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3146958
	speed: 0.0242s/iter; left time: 273.4582s
	iters: 200, epoch: 1 | loss: 0.2838693
	speed: 0.0127s/iter; left time: 142.4738s
	iters: 300, epoch: 1 | loss: 0.1965312
	speed: 0.0126s/iter; left time: 140.1263s
	iters: 400, epoch: 1 | loss: 0.1757296
	speed: 0.0118s/iter; left time: 129.3803s
	iters: 500, epoch: 1 | loss: 0.2426057
	speed: 0.0118s/iter; left time: 128.2061s
Epoch: 1 cost time: 8.176191806793213
Epoch: 1, Steps: 570 | Train Loss: 0.3048955 Vali Loss: 0.0569524 Test Loss: 0.1670164
Validation loss decreased (inf --> 0.056952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3564685
	speed: 0.0403s/iter; left time: 432.7631s
	iters: 200, epoch: 2 | loss: 0.2490194
	speed: 0.0118s/iter; left time: 125.8648s
	iters: 300, epoch: 2 | loss: 0.2912205
	speed: 0.0118s/iter; left time: 124.4098s
	iters: 400, epoch: 2 | loss: 0.2075615
	speed: 0.0118s/iter; left time: 123.3239s
	iters: 500, epoch: 2 | loss: 0.3259264
	speed: 0.0118s/iter; left time: 121.9133s
Epoch: 2 cost time: 7.056912660598755
Epoch: 2, Steps: 570 | Train Loss: 0.3621097 Vali Loss: 0.0655616 Test Loss: 0.2010690
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4145622
	speed: 0.0392s/iter; left time: 397.9353s
	iters: 200, epoch: 3 | loss: 0.4263114
	speed: 0.0119s/iter; left time: 119.6298s
	iters: 300, epoch: 3 | loss: 0.1655468
	speed: 0.0119s/iter; left time: 118.1937s
	iters: 400, epoch: 3 | loss: 0.3101531
	speed: 0.0119s/iter; left time: 116.9034s
	iters: 500, epoch: 3 | loss: 0.2383604
	speed: 0.0119s/iter; left time: 115.7429s
Epoch: 3 cost time: 7.07227087020874
Epoch: 3, Steps: 570 | Train Loss: 0.3143142 Vali Loss: 0.0663429 Test Loss: 0.1853718
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2161061
	speed: 0.0381s/iter; left time: 365.8391s
	iters: 200, epoch: 4 | loss: 0.3722821
	speed: 0.0119s/iter; left time: 112.5736s
	iters: 300, epoch: 4 | loss: 0.2015136
	speed: 0.0118s/iter; left time: 111.1767s
	iters: 400, epoch: 4 | loss: 0.1925986
	speed: 0.0119s/iter; left time: 110.1929s
	iters: 500, epoch: 4 | loss: 0.2151652
	speed: 0.0119s/iter; left time: 109.0253s
Epoch: 4 cost time: 7.038574695587158
Epoch: 4, Steps: 570 | Train Loss: 0.2983768 Vali Loss: 0.0602570 Test Loss: 0.1767666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16728396713733673, mae:0.26014572381973267
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1621534
	speed: 0.0234s/iter; left time: 264.6818s
	iters: 200, epoch: 1 | loss: 0.4235111
	speed: 0.0114s/iter; left time: 127.9585s
	iters: 300, epoch: 1 | loss: 0.2352856
	speed: 0.0114s/iter; left time: 127.0495s
	iters: 400, epoch: 1 | loss: 0.4525290
	speed: 0.0114s/iter; left time: 125.6618s
	iters: 500, epoch: 1 | loss: 0.2929428
	speed: 0.0114s/iter; left time: 124.6577s
Epoch: 1 cost time: 7.771124601364136
Epoch: 1, Steps: 570 | Train Loss: 0.3089340 Vali Loss: 0.0703744 Test Loss: 0.2047924
Validation loss decreased (inf --> 0.070374).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2462121
	speed: 0.0386s/iter; left time: 413.7616s
	iters: 200, epoch: 2 | loss: 0.1961503
	speed: 0.0114s/iter; left time: 121.5595s
	iters: 300, epoch: 2 | loss: 0.1915278
	speed: 0.0114s/iter; left time: 120.5134s
	iters: 400, epoch: 2 | loss: 0.3650100
	speed: 0.0114s/iter; left time: 119.2229s
	iters: 500, epoch: 2 | loss: 0.5563440
	speed: 0.0114s/iter; left time: 117.9995s
Epoch: 2 cost time: 6.828376531600952
Epoch: 2, Steps: 570 | Train Loss: 0.3197718 Vali Loss: 0.0647909 Test Loss: 0.1861613
Validation loss decreased (0.070374 --> 0.064791).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3419395
	speed: 0.0407s/iter; left time: 413.1509s
	iters: 200, epoch: 3 | loss: 0.1741049
	speed: 0.0117s/iter; left time: 117.6734s
	iters: 300, epoch: 3 | loss: 0.3266390
	speed: 0.0115s/iter; left time: 114.6748s
	iters: 400, epoch: 3 | loss: 0.2794829
	speed: 0.0115s/iter; left time: 113.4718s
	iters: 500, epoch: 3 | loss: 0.4134959
	speed: 0.0115s/iter; left time: 112.2739s
Epoch: 3 cost time: 6.994849920272827
Epoch: 3, Steps: 570 | Train Loss: 0.3013770 Vali Loss: 0.0672429 Test Loss: 0.1973960
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2597378
	speed: 0.0384s/iter; left time: 367.9706s
	iters: 200, epoch: 4 | loss: 0.1957911
	speed: 0.0115s/iter; left time: 109.1189s
	iters: 300, epoch: 4 | loss: 0.2042681
	speed: 0.0115s/iter; left time: 107.9369s
	iters: 400, epoch: 4 | loss: 0.2713029
	speed: 0.0115s/iter; left time: 106.7900s
	iters: 500, epoch: 4 | loss: 0.2831668
	speed: 0.0114s/iter; left time: 105.1600s
Epoch: 4 cost time: 6.843238592147827
Epoch: 4, Steps: 570 | Train Loss: 0.3059611 Vali Loss: 0.0696376 Test Loss: 0.1842965
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3049182
	speed: 0.0395s/iter; left time: 356.1554s
	iters: 200, epoch: 5 | loss: 0.2351806
	speed: 0.0116s/iter; left time: 103.5231s
	iters: 300, epoch: 5 | loss: 0.4495172
	speed: 0.0114s/iter; left time: 100.7109s
	iters: 400, epoch: 5 | loss: 0.2376069
	speed: 0.0114s/iter; left time: 99.6074s
	iters: 500, epoch: 5 | loss: 0.2409071
	speed: 0.0114s/iter; left time: 98.4990s
Epoch: 5 cost time: 6.929037570953369
Epoch: 5, Steps: 570 | Train Loss: 0.2914947 Vali Loss: 0.0645789 Test Loss: 0.1771692
Validation loss decreased (0.064791 --> 0.064579).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3137941
	speed: 0.0386s/iter; left time: 326.4873s
	iters: 200, epoch: 6 | loss: 0.3051760
	speed: 0.0114s/iter; left time: 95.5179s
	iters: 300, epoch: 6 | loss: 0.1748664
	speed: 0.0115s/iter; left time: 94.5557s
	iters: 400, epoch: 6 | loss: 0.2137271
	speed: 0.0114s/iter; left time: 93.2933s
	iters: 500, epoch: 6 | loss: 0.2155635
	speed: 0.0114s/iter; left time: 92.0205s
Epoch: 6 cost time: 6.855357646942139
Epoch: 6, Steps: 570 | Train Loss: 0.2856273 Vali Loss: 0.0634681 Test Loss: 0.1763937
Validation loss decreased (0.064579 --> 0.063468).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2200189
	speed: 0.0393s/iter; left time: 309.6146s
	iters: 200, epoch: 7 | loss: 0.3610333
	speed: 0.0118s/iter; left time: 92.1319s
	iters: 300, epoch: 7 | loss: 0.2429709
	speed: 0.0115s/iter; left time: 88.0622s
	iters: 400, epoch: 7 | loss: 0.2551625
	speed: 0.0115s/iter; left time: 87.0207s
	iters: 500, epoch: 7 | loss: 0.2693877
	speed: 0.0115s/iter; left time: 85.8250s
Epoch: 7 cost time: 6.9770965576171875
Epoch: 7, Steps: 570 | Train Loss: 0.2844154 Vali Loss: 0.0636506 Test Loss: 0.1754195
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1919257
	speed: 0.0372s/iter; left time: 272.1269s
	iters: 200, epoch: 8 | loss: 0.2944022
	speed: 0.0114s/iter; left time: 82.2368s
	iters: 300, epoch: 8 | loss: 0.2542833
	speed: 0.0114s/iter; left time: 81.1956s
	iters: 400, epoch: 8 | loss: 0.2601533
	speed: 0.0114s/iter; left time: 80.0300s
	iters: 500, epoch: 8 | loss: 0.2570642
	speed: 0.0114s/iter; left time: 78.7942s
Epoch: 8 cost time: 6.788907766342163
Epoch: 8, Steps: 570 | Train Loss: 0.2814559 Vali Loss: 0.0634190 Test Loss: 0.1761353
Validation loss decreased (0.063468 --> 0.063419).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3800250
	speed: 0.0383s/iter; left time: 258.1400s
	iters: 200, epoch: 9 | loss: 0.1612675
	speed: 0.0115s/iter; left time: 76.4463s
	iters: 300, epoch: 9 | loss: 0.3236064
	speed: 0.0115s/iter; left time: 75.2265s
	iters: 400, epoch: 9 | loss: 0.3164397
	speed: 0.0115s/iter; left time: 73.9621s
	iters: 500, epoch: 9 | loss: 0.3997166
	speed: 0.0115s/iter; left time: 72.8525s
Epoch: 9 cost time: 6.874089956283569
Epoch: 9, Steps: 570 | Train Loss: 0.2817927 Vali Loss: 0.0627447 Test Loss: 0.1758721
Validation loss decreased (0.063419 --> 0.062745).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2104461
	speed: 0.0400s/iter; left time: 246.9523s
	iters: 200, epoch: 10 | loss: 0.2363057
	speed: 0.0114s/iter; left time: 69.3621s
	iters: 300, epoch: 10 | loss: 0.2046684
	speed: 0.0114s/iter; left time: 68.1243s
	iters: 400, epoch: 10 | loss: 0.2702019
	speed: 0.0114s/iter; left time: 66.9980s
	iters: 500, epoch: 10 | loss: 0.2903891
	speed: 0.0114s/iter; left time: 65.7189s
Epoch: 10 cost time: 6.789546966552734
Epoch: 10, Steps: 570 | Train Loss: 0.2824371 Vali Loss: 0.0631095 Test Loss: 0.1755162
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1698792
	speed: 0.0397s/iter; left time: 222.1401s
	iters: 200, epoch: 11 | loss: 0.2862641
	speed: 0.0114s/iter; left time: 62.7640s
	iters: 300, epoch: 11 | loss: 0.2626987
	speed: 0.0114s/iter; left time: 61.6441s
	iters: 400, epoch: 11 | loss: 0.3237939
	speed: 0.0114s/iter; left time: 60.5997s
	iters: 500, epoch: 11 | loss: 0.4603405
	speed: 0.0114s/iter; left time: 59.2909s
Epoch: 11 cost time: 6.833332777023315
Epoch: 11, Steps: 570 | Train Loss: 0.2805423 Vali Loss: 0.0631211 Test Loss: 0.1755228
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2366856
	speed: 0.0401s/iter; left time: 201.7135s
	iters: 200, epoch: 12 | loss: 0.2605909
	speed: 0.0114s/iter; left time: 56.4373s
	iters: 300, epoch: 12 | loss: 0.1787814
	speed: 0.0115s/iter; left time: 55.3514s
	iters: 400, epoch: 12 | loss: 0.3991050
	speed: 0.0115s/iter; left time: 54.2596s
	iters: 500, epoch: 12 | loss: 0.2452077
	speed: 0.0114s/iter; left time: 52.9997s
Epoch: 12 cost time: 6.804385423660278
Epoch: 12, Steps: 570 | Train Loss: 0.2828113 Vali Loss: 0.0631685 Test Loss: 0.1755223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17613042891025543, mae:0.26716727018356323
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3310875
	speed: 0.0242s/iter; left time: 273.8603s
	iters: 200, epoch: 1 | loss: 0.3205411
	speed: 0.0118s/iter; left time: 131.9012s
	iters: 300, epoch: 1 | loss: 0.4598767
	speed: 0.0109s/iter; left time: 120.6346s
	iters: 400, epoch: 1 | loss: 0.3615898
	speed: 0.0109s/iter; left time: 119.8226s
	iters: 500, epoch: 1 | loss: 0.2669631
	speed: 0.0109s/iter; left time: 118.6929s
Epoch: 1 cost time: 7.677866220474243
Epoch: 1, Steps: 570 | Train Loss: 0.3139204 Vali Loss: 0.0577420 Test Loss: 0.1718128
Validation loss decreased (inf --> 0.057742).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2738406
	speed: 0.0376s/iter; left time: 403.8103s
	iters: 200, epoch: 2 | loss: 0.3333329
	speed: 0.0109s/iter; left time: 116.1550s
	iters: 300, epoch: 2 | loss: 0.1958640
	speed: 0.0109s/iter; left time: 115.1513s
	iters: 400, epoch: 2 | loss: 0.2421278
	speed: 0.0109s/iter; left time: 114.2103s
	iters: 500, epoch: 2 | loss: 0.2657471
	speed: 0.0109s/iter; left time: 112.7485s
Epoch: 2 cost time: 6.545705795288086
Epoch: 2, Steps: 570 | Train Loss: 0.3191139 Vali Loss: 0.0683331 Test Loss: 0.1963060
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1974169
	speed: 0.0376s/iter; left time: 382.4663s
	iters: 200, epoch: 3 | loss: 0.2441244
	speed: 0.0109s/iter; left time: 109.3179s
	iters: 300, epoch: 3 | loss: 0.3068202
	speed: 0.0109s/iter; left time: 108.3313s
	iters: 400, epoch: 3 | loss: 0.3356909
	speed: 0.0109s/iter; left time: 107.4054s
	iters: 500, epoch: 3 | loss: 0.3248774
	speed: 0.0109s/iter; left time: 106.0497s
Epoch: 3 cost time: 6.51710844039917
Epoch: 3, Steps: 570 | Train Loss: 0.2982767 Vali Loss: 0.0630827 Test Loss: 0.1717639
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2849285
	speed: 0.0367s/iter; left time: 351.6023s
	iters: 200, epoch: 4 | loss: 0.1341906
	speed: 0.0109s/iter; left time: 103.7643s
	iters: 300, epoch: 4 | loss: 0.3374710
	speed: 0.0109s/iter; left time: 102.5677s
	iters: 400, epoch: 4 | loss: 0.4772728
	speed: 0.0109s/iter; left time: 101.2983s
	iters: 500, epoch: 4 | loss: 0.3229633
	speed: 0.0109s/iter; left time: 100.4007s
Epoch: 4 cost time: 6.5179595947265625
Epoch: 4, Steps: 570 | Train Loss: 0.2769645 Vali Loss: 0.0623952 Test Loss: 0.1707577
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17203237116336823, mae:0.27029332518577576
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2435709
	speed: 0.0261s/iter; left time: 295.0062s
	iters: 200, epoch: 1 | loss: 0.1911342
	speed: 0.0145s/iter; left time: 162.0989s
	iters: 300, epoch: 1 | loss: 0.3567736
	speed: 0.0144s/iter; left time: 160.3979s
	iters: 400, epoch: 1 | loss: 0.2810073
	speed: 0.0144s/iter; left time: 158.8049s
	iters: 500, epoch: 1 | loss: 0.2252716
	speed: 0.0144s/iter; left time: 157.2939s
Epoch: 1 cost time: 9.455031871795654
Epoch: 1, Steps: 570 | Train Loss: 0.2713187 Vali Loss: 0.0512629 Test Loss: 0.1473980
Validation loss decreased (inf --> 0.051263).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3252781
	speed: 0.0463s/iter; left time: 497.3670s
	iters: 200, epoch: 2 | loss: 0.2741295
	speed: 0.0145s/iter; left time: 153.8609s
	iters: 300, epoch: 2 | loss: 0.2366938
	speed: 0.0145s/iter; left time: 152.3350s
	iters: 400, epoch: 2 | loss: 0.1830042
	speed: 0.0145s/iter; left time: 151.1744s
	iters: 500, epoch: 2 | loss: 0.3432406
	speed: 0.0145s/iter; left time: 149.3079s
Epoch: 2 cost time: 8.576072931289673
Epoch: 2, Steps: 570 | Train Loss: 0.2852060 Vali Loss: 0.0700450 Test Loss: 0.2050198
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5130218
	speed: 0.0457s/iter; left time: 464.2633s
	iters: 200, epoch: 3 | loss: 0.3435275
	speed: 0.0145s/iter; left time: 146.3541s
	iters: 300, epoch: 3 | loss: 0.1621601
	speed: 0.0145s/iter; left time: 144.4962s
	iters: 400, epoch: 3 | loss: 0.2179836
	speed: 0.0145s/iter; left time: 142.8208s
	iters: 500, epoch: 3 | loss: 0.2560741
	speed: 0.0145s/iter; left time: 141.4166s
Epoch: 3 cost time: 8.536221027374268
Epoch: 3, Steps: 570 | Train Loss: 0.3024391 Vali Loss: 0.0615400 Test Loss: 0.1726220
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2690701
	speed: 0.0457s/iter; left time: 438.0855s
	iters: 200, epoch: 4 | loss: 0.2230475
	speed: 0.0144s/iter; left time: 136.7752s
	iters: 300, epoch: 4 | loss: 0.2580901
	speed: 0.0144s/iter; left time: 135.4510s
	iters: 400, epoch: 4 | loss: 0.2845585
	speed: 0.0144s/iter; left time: 134.0913s
	iters: 500, epoch: 4 | loss: 0.2436915
	speed: 0.0144s/iter; left time: 132.5368s
Epoch: 4 cost time: 8.505971908569336
Epoch: 4, Steps: 570 | Train Loss: 0.2748295 Vali Loss: 0.0567464 Test Loss: 0.1649906
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14764295518398285, mae:0.2447245717048645
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3579422
	speed: 0.0274s/iter; left time: 310.0821s
	iters: 200, epoch: 1 | loss: 0.3188561
	speed: 0.0151s/iter; left time: 169.5132s
	iters: 300, epoch: 1 | loss: 0.1412449
	speed: 0.0160s/iter; left time: 177.7719s
	iters: 400, epoch: 1 | loss: 0.3408230
	speed: 0.0160s/iter; left time: 176.4226s
	iters: 500, epoch: 1 | loss: 0.2369466
	speed: 0.0161s/iter; left time: 175.3783s
Epoch: 1 cost time: 10.247586965560913
Epoch: 1, Steps: 570 | Train Loss: 0.2422368 Vali Loss: 0.0484057 Test Loss: 0.1495427
Validation loss decreased (inf --> 0.048406).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1942520
	speed: 0.0499s/iter; left time: 535.7525s
	iters: 200, epoch: 2 | loss: 0.2967184
	speed: 0.0161s/iter; left time: 171.0242s
	iters: 300, epoch: 2 | loss: 0.2182838
	speed: 0.0161s/iter; left time: 169.2719s
	iters: 400, epoch: 2 | loss: 0.2311323
	speed: 0.0160s/iter; left time: 167.3987s
	iters: 500, epoch: 2 | loss: 0.2057789
	speed: 0.0160s/iter; left time: 165.7068s
Epoch: 2 cost time: 9.442594289779663
Epoch: 2, Steps: 570 | Train Loss: 0.2377276 Vali Loss: 0.0728795 Test Loss: 0.2161092
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3237036
	speed: 0.0459s/iter; left time: 466.8108s
	iters: 200, epoch: 3 | loss: 0.1564135
	speed: 0.0143s/iter; left time: 143.4069s
	iters: 300, epoch: 3 | loss: 0.3661249
	speed: 0.0142s/iter; left time: 141.7708s
	iters: 400, epoch: 3 | loss: 0.1727637
	speed: 0.0142s/iter; left time: 140.0997s
	iters: 500, epoch: 3 | loss: 0.2421882
	speed: 0.0142s/iter; left time: 139.0593s
Epoch: 3 cost time: 8.394636631011963
Epoch: 3, Steps: 570 | Train Loss: 0.2786699 Vali Loss: 0.0570485 Test Loss: 0.1763236
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2777259
	speed: 0.0452s/iter; left time: 433.1026s
	iters: 200, epoch: 4 | loss: 0.2660138
	speed: 0.0144s/iter; left time: 136.2677s
	iters: 300, epoch: 4 | loss: 0.3011681
	speed: 0.0143s/iter; left time: 134.5965s
	iters: 400, epoch: 4 | loss: 0.1803908
	speed: 0.0143s/iter; left time: 133.1639s
	iters: 500, epoch: 4 | loss: 0.1449819
	speed: 0.0143s/iter; left time: 131.8775s
Epoch: 4 cost time: 8.459372997283936
Epoch: 4, Steps: 570 | Train Loss: 0.2481087 Vali Loss: 0.0525879 Test Loss: 0.1558835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.149746373295784, mae:0.24280180037021637
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1354365
	speed: 0.0259s/iter; left time: 292.9644s
	iters: 200, epoch: 1 | loss: 0.3682787
	speed: 0.0143s/iter; left time: 159.9192s
	iters: 300, epoch: 1 | loss: 0.2754350
	speed: 0.0142s/iter; left time: 158.1848s
	iters: 400, epoch: 1 | loss: 0.2626590
	speed: 0.0143s/iter; left time: 156.9163s
	iters: 500, epoch: 1 | loss: 0.2970988
	speed: 0.0143s/iter; left time: 155.4790s
Epoch: 1 cost time: 9.34536099433899
Epoch: 1, Steps: 570 | Train Loss: 0.2840688 Vali Loss: 0.0640136 Test Loss: 0.1812901
Validation loss decreased (inf --> 0.064014).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2767709
	speed: 0.0469s/iter; left time: 503.2788s
	iters: 200, epoch: 2 | loss: 0.1961362
	speed: 0.0142s/iter; left time: 150.6724s
	iters: 300, epoch: 2 | loss: 0.1926715
	speed: 0.0142s/iter; left time: 149.9131s
	iters: 400, epoch: 2 | loss: 0.2650085
	speed: 0.0142s/iter; left time: 148.2225s
	iters: 500, epoch: 2 | loss: 0.3407041
	speed: 0.0142s/iter; left time: 146.2601s
Epoch: 2 cost time: 8.407214164733887
Epoch: 2, Steps: 570 | Train Loss: 0.2870881 Vali Loss: 0.0582459 Test Loss: 0.1693398
Validation loss decreased (0.064014 --> 0.058246).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2637312
	speed: 0.0459s/iter; left time: 465.9714s
	iters: 200, epoch: 3 | loss: 0.3161782
	speed: 0.0143s/iter; left time: 143.9818s
	iters: 300, epoch: 3 | loss: 0.2022959
	speed: 0.0143s/iter; left time: 142.4436s
	iters: 400, epoch: 3 | loss: 0.2054545
	speed: 0.0142s/iter; left time: 140.5093s
	iters: 500, epoch: 3 | loss: 0.2705434
	speed: 0.0143s/iter; left time: 139.4784s
Epoch: 3 cost time: 8.445943117141724
Epoch: 3, Steps: 570 | Train Loss: 0.2598173 Vali Loss: 0.0578059 Test Loss: 0.1630261
Validation loss decreased (0.058246 --> 0.057806).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2894474
	speed: 0.0453s/iter; left time: 434.7688s
	iters: 200, epoch: 4 | loss: 0.2260659
	speed: 0.0143s/iter; left time: 135.8088s
	iters: 300, epoch: 4 | loss: 0.2424885
	speed: 0.0143s/iter; left time: 134.3188s
	iters: 400, epoch: 4 | loss: 0.2020031
	speed: 0.0143s/iter; left time: 132.6442s
	iters: 500, epoch: 4 | loss: 0.1781809
	speed: 0.0143s/iter; left time: 131.1891s
Epoch: 4 cost time: 8.451119661331177
Epoch: 4, Steps: 570 | Train Loss: 0.2434683 Vali Loss: 0.0540485 Test Loss: 0.1607744
Validation loss decreased (0.057806 --> 0.054049).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2027901
	speed: 0.0462s/iter; left time: 416.3939s
	iters: 200, epoch: 5 | loss: 0.3091655
	speed: 0.0143s/iter; left time: 127.1686s
	iters: 300, epoch: 5 | loss: 0.1973173
	speed: 0.0142s/iter; left time: 125.2724s
	iters: 400, epoch: 5 | loss: 0.3333797
	speed: 0.0142s/iter; left time: 123.7756s
	iters: 500, epoch: 5 | loss: 0.2070854
	speed: 0.0142s/iter; left time: 122.3613s
Epoch: 5 cost time: 8.393794298171997
Epoch: 5, Steps: 570 | Train Loss: 0.2325874 Vali Loss: 0.0519195 Test Loss: 0.1577916
Validation loss decreased (0.054049 --> 0.051919).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2825751
	speed: 0.0457s/iter; left time: 386.2805s
	iters: 200, epoch: 6 | loss: 0.2050829
	speed: 0.0143s/iter; left time: 119.1941s
	iters: 300, epoch: 6 | loss: 0.1434190
	speed: 0.0143s/iter; left time: 117.7702s
	iters: 400, epoch: 6 | loss: 0.2691714
	speed: 0.0143s/iter; left time: 116.3568s
	iters: 500, epoch: 6 | loss: 0.1810805
	speed: 0.0143s/iter; left time: 114.8823s
Epoch: 6 cost time: 8.42814564704895
Epoch: 6, Steps: 570 | Train Loss: 0.2260295 Vali Loss: 0.0501509 Test Loss: 0.1582185
Validation loss decreased (0.051919 --> 0.050151).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3239396
	speed: 0.0460s/iter; left time: 362.1967s
	iters: 200, epoch: 7 | loss: 0.1413668
	speed: 0.0142s/iter; left time: 110.8559s
	iters: 300, epoch: 7 | loss: 0.1768094
	speed: 0.0142s/iter; left time: 109.4038s
	iters: 400, epoch: 7 | loss: 0.3414020
	speed: 0.0142s/iter; left time: 107.9637s
	iters: 500, epoch: 7 | loss: 0.2191450
	speed: 0.0142s/iter; left time: 106.5354s
Epoch: 7 cost time: 8.431467771530151
Epoch: 7, Steps: 570 | Train Loss: 0.2243734 Vali Loss: 0.0499334 Test Loss: 0.1556317
Validation loss decreased (0.050151 --> 0.049933).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1709580
	speed: 0.0490s/iter; left time: 357.9293s
	iters: 200, epoch: 8 | loss: 0.2004823
	speed: 0.0161s/iter; left time: 116.0104s
	iters: 300, epoch: 8 | loss: 0.2172453
	speed: 0.0161s/iter; left time: 114.3865s
	iters: 400, epoch: 8 | loss: 0.1888614
	speed: 0.0161s/iter; left time: 112.6980s
	iters: 500, epoch: 8 | loss: 0.1446288
	speed: 0.0161s/iter; left time: 111.1555s
Epoch: 8 cost time: 9.511318683624268
Epoch: 8, Steps: 570 | Train Loss: 0.2232421 Vali Loss: 0.0503342 Test Loss: 0.1561412
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2895650
	speed: 0.0490s/iter; left time: 330.0108s
	iters: 200, epoch: 9 | loss: 0.1684789
	speed: 0.0142s/iter; left time: 94.3206s
	iters: 300, epoch: 9 | loss: 0.1635505
	speed: 0.0142s/iter; left time: 92.8680s
	iters: 400, epoch: 9 | loss: 0.1515073
	speed: 0.0142s/iter; left time: 91.2289s
	iters: 500, epoch: 9 | loss: 0.2116920
	speed: 0.0142s/iter; left time: 89.8840s
Epoch: 9 cost time: 8.374700546264648
Epoch: 9, Steps: 570 | Train Loss: 0.2210441 Vali Loss: 0.0499185 Test Loss: 0.1554581
Validation loss decreased (0.049933 --> 0.049918).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2955706
	speed: 0.0464s/iter; left time: 286.5725s
	iters: 200, epoch: 10 | loss: 0.2255763
	speed: 0.0142s/iter; left time: 85.9365s
	iters: 300, epoch: 10 | loss: 0.1939872
	speed: 0.0142s/iter; left time: 84.6102s
	iters: 400, epoch: 10 | loss: 0.2501310
	speed: 0.0142s/iter; left time: 83.2627s
	iters: 500, epoch: 10 | loss: 0.2223947
	speed: 0.0142s/iter; left time: 81.7398s
Epoch: 10 cost time: 8.37479043006897
Epoch: 10, Steps: 570 | Train Loss: 0.2197289 Vali Loss: 0.0500757 Test Loss: 0.1554331
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2479482
	speed: 0.0471s/iter; left time: 264.0562s
	iters: 200, epoch: 11 | loss: 0.1726053
	speed: 0.0161s/iter; left time: 88.7794s
	iters: 300, epoch: 11 | loss: 0.1634731
	speed: 0.0161s/iter; left time: 86.9523s
	iters: 400, epoch: 11 | loss: 0.2541782
	speed: 0.0161s/iter; left time: 85.1654s
	iters: 500, epoch: 11 | loss: 0.1446469
	speed: 0.0161s/iter; left time: 83.6115s
Epoch: 11 cost time: 9.45587420463562
Epoch: 11, Steps: 570 | Train Loss: 0.2199666 Vali Loss: 0.0500236 Test Loss: 0.1554699
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1390455
	speed: 0.0498s/iter; left time: 250.3068s
	iters: 200, epoch: 12 | loss: 0.1907740
	speed: 0.0142s/iter; left time: 70.2486s
	iters: 300, epoch: 12 | loss: 0.2275511
	speed: 0.0142s/iter; left time: 68.6784s
	iters: 400, epoch: 12 | loss: 0.1400598
	speed: 0.0143s/iter; left time: 67.6628s
	iters: 500, epoch: 12 | loss: 0.2891672
	speed: 0.0143s/iter; left time: 66.1112s
Epoch: 12 cost time: 8.400589227676392
Epoch: 12, Steps: 570 | Train Loss: 0.2222741 Vali Loss: 0.0498362 Test Loss: 0.1554103
Validation loss decreased (0.049918 --> 0.049836).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1693378
	speed: 0.0463s/iter; left time: 206.3497s
	iters: 200, epoch: 13 | loss: 0.1841998
	speed: 0.0144s/iter; left time: 62.5835s
	iters: 300, epoch: 13 | loss: 0.2378055
	speed: 0.0143s/iter; left time: 61.0003s
	iters: 400, epoch: 13 | loss: 0.2329025
	speed: 0.0143s/iter; left time: 59.5530s
	iters: 500, epoch: 13 | loss: 0.2395816
	speed: 0.0143s/iter; left time: 57.9883s
Epoch: 13 cost time: 8.464636325836182
Epoch: 13, Steps: 570 | Train Loss: 0.2195402 Vali Loss: 0.0501228 Test Loss: 0.1554241
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1925913
	speed: 0.0459s/iter; left time: 178.7762s
	iters: 200, epoch: 14 | loss: 0.2345678
	speed: 0.0143s/iter; left time: 54.1413s
	iters: 300, epoch: 14 | loss: 0.1716644
	speed: 0.0142s/iter; left time: 52.5894s
	iters: 400, epoch: 14 | loss: 0.2786288
	speed: 0.0143s/iter; left time: 51.1817s
	iters: 500, epoch: 14 | loss: 0.2081250
	speed: 0.0143s/iter; left time: 49.7656s
Epoch: 14 cost time: 8.430323600769043
Epoch: 14, Steps: 570 | Train Loss: 0.2213041 Vali Loss: 0.0503268 Test Loss: 0.1554163
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2340338
	speed: 0.0461s/iter; left time: 153.1772s
	iters: 200, epoch: 15 | loss: 0.1625172
	speed: 0.0142s/iter; left time: 45.8491s
	iters: 300, epoch: 15 | loss: 0.2733411
	speed: 0.0142s/iter; left time: 44.4438s
	iters: 400, epoch: 15 | loss: 0.2272985
	speed: 0.0142s/iter; left time: 42.9286s
	iters: 500, epoch: 15 | loss: 0.1665039
	speed: 0.0141s/iter; left time: 41.2492s
Epoch: 15 cost time: 8.40393328666687
Epoch: 15, Steps: 570 | Train Loss: 0.2200371 Vali Loss: 0.0499670 Test Loss: 0.1554104
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15562692284584045, mae:0.2503296732902527
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4231477
	speed: 0.0306s/iter; left time: 345.5087s
	iters: 200, epoch: 1 | loss: 0.2990322
	speed: 0.0184s/iter; left time: 205.6859s
	iters: 300, epoch: 1 | loss: 0.4513031
	speed: 0.0184s/iter; left time: 204.2628s
	iters: 400, epoch: 1 | loss: 0.2904619
	speed: 0.0184s/iter; left time: 202.2220s
	iters: 500, epoch: 1 | loss: 0.2761419
	speed: 0.0183s/iter; left time: 200.0073s
Epoch: 1 cost time: 11.746707916259766
Epoch: 1, Steps: 570 | Train Loss: 0.3566688 Vali Loss: 0.0702681 Test Loss: 0.1946494
Validation loss decreased (inf --> 0.070268).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4136405
	speed: 0.0552s/iter; left time: 592.3144s
	iters: 200, epoch: 2 | loss: 0.3237491
	speed: 0.0170s/iter; left time: 180.9636s
	iters: 300, epoch: 2 | loss: 0.3927438
	speed: 0.0169s/iter; left time: 178.3693s
	iters: 400, epoch: 2 | loss: 0.2460304
	speed: 0.0169s/iter; left time: 176.4321s
	iters: 500, epoch: 2 | loss: 0.3138577
	speed: 0.0169s/iter; left time: 174.7214s
Epoch: 2 cost time: 10.150765180587769
Epoch: 2, Steps: 570 | Train Loss: 0.3107000 Vali Loss: 0.0631987 Test Loss: 0.1842450
Validation loss decreased (0.070268 --> 0.063199).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2380202
	speed: 0.0510s/iter; left time: 517.8157s
	iters: 200, epoch: 3 | loss: 0.2695333
	speed: 0.0174s/iter; left time: 175.3056s
	iters: 300, epoch: 3 | loss: 0.4293661
	speed: 0.0180s/iter; left time: 179.4267s
	iters: 400, epoch: 3 | loss: 0.2429115
	speed: 0.0180s/iter; left time: 177.5047s
	iters: 500, epoch: 3 | loss: 0.2631704
	speed: 0.0180s/iter; left time: 175.8834s
Epoch: 3 cost time: 10.416537523269653
Epoch: 3, Steps: 570 | Train Loss: 0.2844806 Vali Loss: 0.0596799 Test Loss: 0.1749096
Validation loss decreased (0.063199 --> 0.059680).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3597705
	speed: 0.0536s/iter; left time: 514.0755s
	iters: 200, epoch: 4 | loss: 0.3170551
	speed: 0.0170s/iter; left time: 161.4208s
	iters: 300, epoch: 4 | loss: 0.2862722
	speed: 0.0170s/iter; left time: 159.6554s
	iters: 400, epoch: 4 | loss: 0.3588545
	speed: 0.0170s/iter; left time: 157.9697s
	iters: 500, epoch: 4 | loss: 0.2317751
	speed: 0.0170s/iter; left time: 156.2252s
Epoch: 4 cost time: 10.15993070602417
Epoch: 4, Steps: 570 | Train Loss: 0.2729959 Vali Loss: 0.0586416 Test Loss: 0.1634108
Validation loss decreased (0.059680 --> 0.058642).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1480240
	speed: 0.0536s/iter; left time: 483.4674s
	iters: 200, epoch: 5 | loss: 0.2854924
	speed: 0.0169s/iter; left time: 150.5535s
	iters: 300, epoch: 5 | loss: 0.2601712
	speed: 0.0180s/iter; left time: 158.4383s
	iters: 400, epoch: 5 | loss: 0.2432022
	speed: 0.0193s/iter; left time: 168.2534s
	iters: 500, epoch: 5 | loss: 0.2031509
	speed: 0.0191s/iter; left time: 164.5058s
Epoch: 5 cost time: 10.707136631011963
Epoch: 5, Steps: 570 | Train Loss: 0.2617277 Vali Loss: 0.0552872 Test Loss: 0.1606847
Validation loss decreased (0.058642 --> 0.055287).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3094109
	speed: 0.0524s/iter; left time: 442.4519s
	iters: 200, epoch: 6 | loss: 0.2309000
	speed: 0.0169s/iter; left time: 141.3523s
	iters: 300, epoch: 6 | loss: 0.2965054
	speed: 0.0169s/iter; left time: 139.6711s
	iters: 400, epoch: 6 | loss: 0.3793553
	speed: 0.0169s/iter; left time: 137.8828s
	iters: 500, epoch: 6 | loss: 0.1989893
	speed: 0.0169s/iter; left time: 136.1486s
Epoch: 6 cost time: 9.964446067810059
Epoch: 6, Steps: 570 | Train Loss: 0.2568656 Vali Loss: 0.0557706 Test Loss: 0.1589244
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1992728
	speed: 0.0516s/iter; left time: 406.6682s
	iters: 200, epoch: 7 | loss: 0.2386451
	speed: 0.0168s/iter; left time: 131.1062s
	iters: 300, epoch: 7 | loss: 0.3433176
	speed: 0.0168s/iter; left time: 129.3997s
	iters: 400, epoch: 7 | loss: 0.1856261
	speed: 0.0168s/iter; left time: 127.7197s
	iters: 500, epoch: 7 | loss: 0.2049061
	speed: 0.0168s/iter; left time: 126.0427s
Epoch: 7 cost time: 9.898459911346436
Epoch: 7, Steps: 570 | Train Loss: 0.2552189 Vali Loss: 0.0553833 Test Loss: 0.1578540
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2772514
	speed: 0.0501s/iter; left time: 365.9273s
	iters: 200, epoch: 8 | loss: 0.1852691
	speed: 0.0169s/iter; left time: 122.0043s
	iters: 300, epoch: 8 | loss: 0.2553893
	speed: 0.0169s/iter; left time: 120.3039s
	iters: 400, epoch: 8 | loss: 0.1523726
	speed: 0.0169s/iter; left time: 118.6058s
	iters: 500, epoch: 8 | loss: 0.1697097
	speed: 0.0169s/iter; left time: 116.9172s
Epoch: 8 cost time: 9.953924417495728
Epoch: 8, Steps: 570 | Train Loss: 0.2544855 Vali Loss: 0.0552160 Test Loss: 0.1583025
Validation loss decreased (0.055287 --> 0.055216).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2468323
	speed: 0.0534s/iter; left time: 360.1663s
	iters: 200, epoch: 9 | loss: 0.1402135
	speed: 0.0169s/iter; left time: 112.3977s
	iters: 300, epoch: 9 | loss: 0.2766612
	speed: 0.0169s/iter; left time: 110.6968s
	iters: 400, epoch: 9 | loss: 0.2861530
	speed: 0.0169s/iter; left time: 109.0347s
	iters: 500, epoch: 9 | loss: 0.3543449
	speed: 0.0169s/iter; left time: 107.4426s
Epoch: 9 cost time: 9.971363544464111
Epoch: 9, Steps: 570 | Train Loss: 0.2515577 Vali Loss: 0.0554824 Test Loss: 0.1580071
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3629105
	speed: 0.0524s/iter; left time: 323.4762s
	iters: 200, epoch: 10 | loss: 0.1137268
	speed: 0.0184s/iter; left time: 111.9460s
	iters: 300, epoch: 10 | loss: 0.3536044
	speed: 0.0184s/iter; left time: 109.8502s
	iters: 400, epoch: 10 | loss: 0.3374973
	speed: 0.0184s/iter; left time: 108.1767s
	iters: 500, epoch: 10 | loss: 0.2181917
	speed: 0.0184s/iter; left time: 106.3519s
Epoch: 10 cost time: 10.836272954940796
Epoch: 10, Steps: 570 | Train Loss: 0.2517068 Vali Loss: 0.0553969 Test Loss: 0.1578377
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1954637
	speed: 0.0514s/iter; left time: 287.7707s
	iters: 200, epoch: 11 | loss: 0.2611381
	speed: 0.0169s/iter; left time: 93.0945s
	iters: 300, epoch: 11 | loss: 0.1358562
	speed: 0.0169s/iter; left time: 91.3509s
	iters: 400, epoch: 11 | loss: 0.2665876
	speed: 0.0169s/iter; left time: 89.7095s
	iters: 500, epoch: 11 | loss: 0.3374287
	speed: 0.0169s/iter; left time: 87.9472s
Epoch: 11 cost time: 9.93829345703125
Epoch: 11, Steps: 570 | Train Loss: 0.2517991 Vali Loss: 0.0553704 Test Loss: 0.1576126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15853843092918396, mae:0.2533927857875824
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2764733
	speed: 0.0284s/iter; left time: 321.2808s
	iters: 200, epoch: 1 | loss: 0.2327543
	speed: 0.0165s/iter; left time: 184.5093s
	iters: 300, epoch: 1 | loss: 0.3357033
	speed: 0.0165s/iter; left time: 182.9302s
	iters: 400, epoch: 1 | loss: 0.3047566
	speed: 0.0165s/iter; left time: 181.5058s
	iters: 500, epoch: 1 | loss: 0.1972861
	speed: 0.0164s/iter; left time: 179.1272s
Epoch: 1 cost time: 10.633033037185669
Epoch: 1, Steps: 570 | Train Loss: 0.3256827 Vali Loss: 0.0674371 Test Loss: 0.1923324
Validation loss decreased (inf --> 0.067437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2472515
	speed: 0.0528s/iter; left time: 566.6611s
	iters: 200, epoch: 2 | loss: 0.1821082
	speed: 0.0164s/iter; left time: 174.7526s
	iters: 300, epoch: 2 | loss: 0.3611526
	speed: 0.0170s/iter; left time: 178.6492s
	iters: 400, epoch: 2 | loss: 0.4608039
	speed: 0.0179s/iter; left time: 186.9937s
	iters: 500, epoch: 2 | loss: 0.3331698
	speed: 0.0179s/iter; left time: 185.3542s
Epoch: 2 cost time: 10.206190586090088
Epoch: 2, Steps: 570 | Train Loss: 0.3138315 Vali Loss: 0.0646692 Test Loss: 0.1826266
Validation loss decreased (0.067437 --> 0.064669).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3125826
	speed: 0.0515s/iter; left time: 523.7181s
	iters: 200, epoch: 3 | loss: 0.3133857
	speed: 0.0165s/iter; left time: 165.6985s
	iters: 300, epoch: 3 | loss: 0.1997578
	speed: 0.0165s/iter; left time: 164.3144s
	iters: 400, epoch: 3 | loss: 0.3287965
	speed: 0.0165s/iter; left time: 162.4516s
	iters: 500, epoch: 3 | loss: 0.1674982
	speed: 0.0165s/iter; left time: 160.7747s
Epoch: 3 cost time: 9.714487314224243
Epoch: 3, Steps: 570 | Train Loss: 0.2841374 Vali Loss: 0.0582497 Test Loss: 0.1715780
Validation loss decreased (0.064669 --> 0.058250).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1959866
	speed: 0.0527s/iter; left time: 505.8210s
	iters: 200, epoch: 4 | loss: 0.6555514
	speed: 0.0164s/iter; left time: 155.6889s
	iters: 300, epoch: 4 | loss: 0.2739381
	speed: 0.0164s/iter; left time: 154.0855s
	iters: 400, epoch: 4 | loss: 0.1755477
	speed: 0.0164s/iter; left time: 152.3424s
	iters: 500, epoch: 4 | loss: 0.3965024
	speed: 0.0164s/iter; left time: 150.6855s
Epoch: 4 cost time: 9.721477270126343
Epoch: 4, Steps: 570 | Train Loss: 0.2689576 Vali Loss: 0.0583956 Test Loss: 0.1655976
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2582152
	speed: 0.0502s/iter; left time: 452.6956s
	iters: 200, epoch: 5 | loss: 0.3659150
	speed: 0.0165s/iter; left time: 147.1776s
	iters: 300, epoch: 5 | loss: 0.2310751
	speed: 0.0165s/iter; left time: 145.5506s
	iters: 400, epoch: 5 | loss: 0.1816646
	speed: 0.0169s/iter; left time: 147.3480s
	iters: 500, epoch: 5 | loss: 0.3596244
	speed: 0.0179s/iter; left time: 154.4648s
Epoch: 5 cost time: 9.969182968139648
Epoch: 5, Steps: 570 | Train Loss: 0.2582919 Vali Loss: 0.0567488 Test Loss: 0.1616790
Validation loss decreased (0.058250 --> 0.056749).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2957802
	speed: 0.0530s/iter; left time: 448.1704s
	iters: 200, epoch: 6 | loss: 0.3656701
	speed: 0.0165s/iter; left time: 137.4922s
	iters: 300, epoch: 6 | loss: 0.5005087
	speed: 0.0164s/iter; left time: 135.7051s
	iters: 400, epoch: 6 | loss: 0.2646871
	speed: 0.0164s/iter; left time: 134.0102s
	iters: 500, epoch: 6 | loss: 0.2224196
	speed: 0.0164s/iter; left time: 132.3379s
Epoch: 6 cost time: 9.686028003692627
Epoch: 6, Steps: 570 | Train Loss: 0.2525463 Vali Loss: 0.0566615 Test Loss: 0.1613017
Validation loss decreased (0.056749 --> 0.056661).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2991766
	speed: 0.0504s/iter; left time: 396.9280s
	iters: 200, epoch: 7 | loss: 0.1717590
	speed: 0.0164s/iter; left time: 127.5285s
	iters: 300, epoch: 7 | loss: 0.2409506
	speed: 0.0164s/iter; left time: 125.8645s
	iters: 400, epoch: 7 | loss: 0.3314831
	speed: 0.0164s/iter; left time: 124.2097s
	iters: 500, epoch: 7 | loss: 0.3442245
	speed: 0.0164s/iter; left time: 122.5719s
Epoch: 7 cost time: 9.657699346542358
Epoch: 7, Steps: 570 | Train Loss: 0.2513187 Vali Loss: 0.0563184 Test Loss: 0.1605487
Validation loss decreased (0.056661 --> 0.056318).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1689795
	speed: 0.0524s/iter; left time: 382.9443s
	iters: 200, epoch: 8 | loss: 0.3971741
	speed: 0.0170s/iter; left time: 122.6406s
	iters: 300, epoch: 8 | loss: 0.3039874
	speed: 0.0170s/iter; left time: 120.9830s
	iters: 400, epoch: 8 | loss: 0.2689097
	speed: 0.0170s/iter; left time: 119.1412s
	iters: 500, epoch: 8 | loss: 0.2332681
	speed: 0.0170s/iter; left time: 117.2994s
Epoch: 8 cost time: 10.080722093582153
Epoch: 8, Steps: 570 | Train Loss: 0.2480591 Vali Loss: 0.0560904 Test Loss: 0.1599616
Validation loss decreased (0.056318 --> 0.056090).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1714244
	speed: 0.0537s/iter; left time: 362.0410s
	iters: 200, epoch: 9 | loss: 0.2399662
	speed: 0.0170s/iter; left time: 112.8379s
	iters: 300, epoch: 9 | loss: 0.1432478
	speed: 0.0170s/iter; left time: 111.2237s
	iters: 400, epoch: 9 | loss: 0.2058955
	speed: 0.0170s/iter; left time: 109.4103s
	iters: 500, epoch: 9 | loss: 0.1150765
	speed: 0.0170s/iter; left time: 107.7701s
Epoch: 9 cost time: 10.075819730758667
Epoch: 9, Steps: 570 | Train Loss: 0.2479948 Vali Loss: 0.0558472 Test Loss: 0.1595002
Validation loss decreased (0.056090 --> 0.055847).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3212492
	speed: 0.0539s/iter; left time: 332.3499s
	iters: 200, epoch: 10 | loss: 0.2343052
	speed: 0.0171s/iter; left time: 103.5956s
	iters: 300, epoch: 10 | loss: 0.1787103
	speed: 0.0171s/iter; left time: 101.8208s
	iters: 400, epoch: 10 | loss: 0.2474824
	speed: 0.0171s/iter; left time: 100.1453s
	iters: 500, epoch: 10 | loss: 0.1732036
	speed: 0.0170s/iter; left time: 98.3844s
Epoch: 10 cost time: 10.119998216629028
Epoch: 10, Steps: 570 | Train Loss: 0.2465933 Vali Loss: 0.0556785 Test Loss: 0.1596540
Validation loss decreased (0.055847 --> 0.055678).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1643394
	speed: 0.0508s/iter; left time: 284.6066s
	iters: 200, epoch: 11 | loss: 0.1678609
	speed: 0.0165s/iter; left time: 90.5127s
	iters: 300, epoch: 11 | loss: 0.2018326
	speed: 0.0165s/iter; left time: 88.9557s
	iters: 400, epoch: 11 | loss: 0.2276821
	speed: 0.0165s/iter; left time: 87.2942s
	iters: 500, epoch: 11 | loss: 0.1991215
	speed: 0.0165s/iter; left time: 85.5826s
Epoch: 11 cost time: 9.675696849822998
Epoch: 11, Steps: 570 | Train Loss: 0.2476586 Vali Loss: 0.0559690 Test Loss: 0.1596856
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1573327
	speed: 0.0508s/iter; left time: 255.4432s
	iters: 200, epoch: 12 | loss: 0.2785705
	speed: 0.0165s/iter; left time: 81.4327s
	iters: 300, epoch: 12 | loss: 0.1592060
	speed: 0.0165s/iter; left time: 79.6397s
	iters: 400, epoch: 12 | loss: 0.2363529
	speed: 0.0164s/iter; left time: 77.7211s
	iters: 500, epoch: 12 | loss: 0.3511350
	speed: 0.0164s/iter; left time: 76.0188s
Epoch: 12 cost time: 9.695243120193481
Epoch: 12, Steps: 570 | Train Loss: 0.2443652 Vali Loss: 0.0558417 Test Loss: 0.1596739
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3338568
	speed: 0.0507s/iter; left time: 226.3470s
	iters: 200, epoch: 13 | loss: 0.2935806
	speed: 0.0165s/iter; left time: 72.0322s
	iters: 300, epoch: 13 | loss: 0.2703342
	speed: 0.0165s/iter; left time: 70.3909s
	iters: 400, epoch: 13 | loss: 0.1846772
	speed: 0.0165s/iter; left time: 68.7028s
	iters: 500, epoch: 13 | loss: 0.2558920
	speed: 0.0165s/iter; left time: 67.0546s
Epoch: 13 cost time: 9.709242343902588
Epoch: 13, Steps: 570 | Train Loss: 0.2451861 Vali Loss: 0.0559950 Test Loss: 0.1596886
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15988914668560028, mae:0.255709171295166
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3528516
	speed: 0.0271s/iter; left time: 306.0206s
	iters: 200, epoch: 1 | loss: 0.3574461
	speed: 0.0154s/iter; left time: 172.3646s
	iters: 300, epoch: 1 | loss: 0.2459876
	speed: 0.0154s/iter; left time: 171.1494s
	iters: 400, epoch: 1 | loss: 0.3437310
	speed: 0.0154s/iter; left time: 169.8759s
	iters: 500, epoch: 1 | loss: 0.5735512
	speed: 0.0154s/iter; left time: 168.1850s
Epoch: 1 cost time: 10.006650447845459
Epoch: 1, Steps: 570 | Train Loss: 0.3299547 Vali Loss: 0.0726970 Test Loss: 0.1894750
Validation loss decreased (inf --> 0.072697).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4155256
	speed: 0.0489s/iter; left time: 524.3369s
	iters: 200, epoch: 2 | loss: 0.1897063
	speed: 0.0155s/iter; left time: 164.4406s
	iters: 300, epoch: 2 | loss: 0.3088529
	speed: 0.0154s/iter; left time: 162.2002s
	iters: 400, epoch: 2 | loss: 0.3127601
	speed: 0.0154s/iter; left time: 160.7928s
	iters: 500, epoch: 2 | loss: 0.4591195
	speed: 0.0154s/iter; left time: 158.8397s
Epoch: 2 cost time: 9.121246814727783
Epoch: 2, Steps: 570 | Train Loss: 0.3048152 Vali Loss: 0.0728215 Test Loss: 0.1978776
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3362475
	speed: 0.0481s/iter; left time: 488.5240s
	iters: 200, epoch: 3 | loss: 0.1796288
	speed: 0.0154s/iter; left time: 154.6876s
	iters: 300, epoch: 3 | loss: 0.3259010
	speed: 0.0154s/iter; left time: 152.9149s
	iters: 400, epoch: 3 | loss: 0.3156268
	speed: 0.0153s/iter; left time: 151.2696s
	iters: 500, epoch: 3 | loss: 0.2664908
	speed: 0.0153s/iter; left time: 149.7044s
Epoch: 3 cost time: 9.010859251022339
Epoch: 3, Steps: 570 | Train Loss: 0.3005098 Vali Loss: 0.0633868 Test Loss: 0.1851613
Validation loss decreased (0.072697 --> 0.063387).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2100977
	speed: 0.0486s/iter; left time: 466.1330s
	iters: 200, epoch: 4 | loss: 0.3616856
	speed: 0.0154s/iter; left time: 146.1287s
	iters: 300, epoch: 4 | loss: 0.4346203
	speed: 0.0154s/iter; left time: 144.6251s
	iters: 400, epoch: 4 | loss: 0.2474310
	speed: 0.0154s/iter; left time: 143.1588s
	iters: 500, epoch: 4 | loss: 0.3295820
	speed: 0.0154s/iter; left time: 141.3630s
Epoch: 4 cost time: 9.090102910995483
Epoch: 4, Steps: 570 | Train Loss: 0.2913144 Vali Loss: 0.0619122 Test Loss: 0.1752462
Validation loss decreased (0.063387 --> 0.061912).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3288084
	speed: 0.0505s/iter; left time: 455.7724s
	iters: 200, epoch: 5 | loss: 0.2195111
	speed: 0.0170s/iter; left time: 151.6599s
	iters: 300, epoch: 5 | loss: 0.2494730
	speed: 0.0170s/iter; left time: 149.9155s
	iters: 400, epoch: 5 | loss: 0.1984664
	speed: 0.0170s/iter; left time: 148.2146s
	iters: 500, epoch: 5 | loss: 0.2411065
	speed: 0.0170s/iter; left time: 146.6223s
Epoch: 5 cost time: 10.013183116912842
Epoch: 5, Steps: 570 | Train Loss: 0.2832449 Vali Loss: 0.0608572 Test Loss: 0.1716351
Validation loss decreased (0.061912 --> 0.060857).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3289462
	speed: 0.0490s/iter; left time: 414.3797s
	iters: 200, epoch: 6 | loss: 0.2251569
	speed: 0.0155s/iter; left time: 129.1671s
	iters: 300, epoch: 6 | loss: 0.1530811
	speed: 0.0154s/iter; left time: 127.3723s
	iters: 400, epoch: 6 | loss: 0.1735361
	speed: 0.0154s/iter; left time: 125.6056s
	iters: 500, epoch: 6 | loss: 0.2480948
	speed: 0.0154s/iter; left time: 123.9927s
Epoch: 6 cost time: 9.09894061088562
Epoch: 6, Steps: 570 | Train Loss: 0.2769288 Vali Loss: 0.0607782 Test Loss: 0.1672092
Validation loss decreased (0.060857 --> 0.060778).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2894515
	speed: 0.0534s/iter; left time: 420.8073s
	iters: 200, epoch: 7 | loss: 0.2232478
	speed: 0.0170s/iter; left time: 132.6380s
	iters: 300, epoch: 7 | loss: 0.2083797
	speed: 0.0170s/iter; left time: 130.8375s
	iters: 400, epoch: 7 | loss: 0.2925494
	speed: 0.0170s/iter; left time: 129.0303s
	iters: 500, epoch: 7 | loss: 0.2986919
	speed: 0.0170s/iter; left time: 127.3218s
Epoch: 7 cost time: 10.030033826828003
Epoch: 7, Steps: 570 | Train Loss: 0.2726304 Vali Loss: 0.0607205 Test Loss: 0.1663236
Validation loss decreased (0.060778 --> 0.060720).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2765966
	speed: 0.0503s/iter; left time: 367.6474s
	iters: 200, epoch: 8 | loss: 0.3518615
	speed: 0.0154s/iter; left time: 111.1154s
	iters: 300, epoch: 8 | loss: 0.1765554
	speed: 0.0154s/iter; left time: 109.6330s
	iters: 400, epoch: 8 | loss: 0.2702326
	speed: 0.0155s/iter; left time: 108.3424s
	iters: 500, epoch: 8 | loss: 0.2131765
	speed: 0.0155s/iter; left time: 106.8930s
Epoch: 8 cost time: 9.13086462020874
Epoch: 8, Steps: 570 | Train Loss: 0.2694661 Vali Loss: 0.0601330 Test Loss: 0.1655186
Validation loss decreased (0.060720 --> 0.060133).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2739267
	speed: 0.0490s/iter; left time: 330.1429s
	iters: 200, epoch: 9 | loss: 0.3057661
	speed: 0.0154s/iter; left time: 102.5001s
	iters: 300, epoch: 9 | loss: 0.2766374
	speed: 0.0154s/iter; left time: 100.9189s
	iters: 400, epoch: 9 | loss: 0.1855141
	speed: 0.0154s/iter; left time: 99.3716s
	iters: 500, epoch: 9 | loss: 0.2378395
	speed: 0.0154s/iter; left time: 97.7737s
Epoch: 9 cost time: 9.108590126037598
Epoch: 9, Steps: 570 | Train Loss: 0.2694652 Vali Loss: 0.0601589 Test Loss: 0.1652751
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2965716
	speed: 0.0488s/iter; left time: 301.0228s
	iters: 200, epoch: 10 | loss: 0.3119071
	speed: 0.0154s/iter; left time: 93.6897s
	iters: 300, epoch: 10 | loss: 0.1638429
	speed: 0.0154s/iter; left time: 92.1525s
	iters: 400, epoch: 10 | loss: 0.3317775
	speed: 0.0154s/iter; left time: 90.5573s
	iters: 500, epoch: 10 | loss: 0.5118732
	speed: 0.0154s/iter; left time: 89.0324s
Epoch: 10 cost time: 9.111079931259155
Epoch: 10, Steps: 570 | Train Loss: 0.2700157 Vali Loss: 0.0602742 Test Loss: 0.1647697
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2693446
	speed: 0.0490s/iter; left time: 274.3350s
	iters: 200, epoch: 11 | loss: 0.1961205
	speed: 0.0154s/iter; left time: 84.8021s
	iters: 300, epoch: 11 | loss: 0.2544862
	speed: 0.0154s/iter; left time: 83.2305s
	iters: 400, epoch: 11 | loss: 0.2897861
	speed: 0.0154s/iter; left time: 81.7152s
	iters: 500, epoch: 11 | loss: 0.3234709
	speed: 0.0154s/iter; left time: 80.2791s
Epoch: 11 cost time: 9.070013284683228
Epoch: 11, Steps: 570 | Train Loss: 0.2692987 Vali Loss: 0.0602649 Test Loss: 0.1648742
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16577757894992828, mae:0.26132142543792725
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2132039
	speed: 0.0323s/iter; left time: 364.6002s
	iters: 200, epoch: 1 | loss: 0.2482248
	speed: 0.0186s/iter; left time: 208.0448s
	iters: 300, epoch: 1 | loss: 0.4155103
	speed: 0.0186s/iter; left time: 206.5562s
	iters: 400, epoch: 1 | loss: 0.2788582
	speed: 0.0186s/iter; left time: 204.3457s
	iters: 500, epoch: 1 | loss: 0.2421324
	speed: 0.0186s/iter; left time: 202.8496s
Epoch: 1 cost time: 12.01831841468811
Epoch: 1, Steps: 570 | Train Loss: 0.2878056 Vali Loss: 0.0654367 Test Loss: 0.1771272
Validation loss decreased (inf --> 0.065437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5202433
	speed: 0.0581s/iter; left time: 623.8222s
	iters: 200, epoch: 2 | loss: 0.2306121
	speed: 0.0187s/iter; left time: 198.4425s
	iters: 300, epoch: 2 | loss: 0.2242718
	speed: 0.0187s/iter; left time: 196.5491s
	iters: 400, epoch: 2 | loss: 0.2614449
	speed: 0.0193s/iter; left time: 201.2080s
	iters: 500, epoch: 2 | loss: 0.2152333
	speed: 0.0189s/iter; left time: 194.8100s
Epoch: 2 cost time: 11.017516613006592
Epoch: 2, Steps: 570 | Train Loss: 0.2904823 Vali Loss: 0.0628499 Test Loss: 0.1861763
Validation loss decreased (0.065437 --> 0.062850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2092441
	speed: 0.0582s/iter; left time: 591.5626s
	iters: 200, epoch: 3 | loss: 0.3344850
	speed: 0.0188s/iter; left time: 188.8330s
	iters: 300, epoch: 3 | loss: 0.2349855
	speed: 0.0188s/iter; left time: 186.9083s
	iters: 400, epoch: 3 | loss: 0.1700952
	speed: 0.0188s/iter; left time: 185.0032s
	iters: 500, epoch: 3 | loss: 0.2035912
	speed: 0.0188s/iter; left time: 183.0751s
Epoch: 3 cost time: 10.990633726119995
Epoch: 3, Steps: 570 | Train Loss: 0.2683181 Vali Loss: 0.0603431 Test Loss: 0.1769986
Validation loss decreased (0.062850 --> 0.060343).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2909709
	speed: 0.0559s/iter; left time: 535.7454s
	iters: 200, epoch: 4 | loss: 0.3411694
	speed: 0.0186s/iter; left time: 176.1713s
	iters: 300, epoch: 4 | loss: 0.3257471
	speed: 0.0186s/iter; left time: 174.5046s
	iters: 400, epoch: 4 | loss: 0.1559393
	speed: 0.0186s/iter; left time: 172.5918s
	iters: 500, epoch: 4 | loss: 0.2574477
	speed: 0.0186s/iter; left time: 170.6779s
Epoch: 4 cost time: 10.881583452224731
Epoch: 4, Steps: 570 | Train Loss: 0.2628267 Vali Loss: 0.0567002 Test Loss: 0.1610373
Validation loss decreased (0.060343 --> 0.056700).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2836421
	speed: 0.0585s/iter; left time: 527.4131s
	iters: 200, epoch: 5 | loss: 0.2339277
	speed: 0.0187s/iter; left time: 166.7652s
	iters: 300, epoch: 5 | loss: 0.2372324
	speed: 0.0188s/iter; left time: 165.5256s
	iters: 400, epoch: 5 | loss: 0.2867775
	speed: 0.0187s/iter; left time: 163.1377s
	iters: 500, epoch: 5 | loss: 0.2466409
	speed: 0.0197s/iter; left time: 170.1039s
Epoch: 5 cost time: 11.265970945358276
Epoch: 5, Steps: 570 | Train Loss: 0.2554568 Vali Loss: 0.0538172 Test Loss: 0.1566114
Validation loss decreased (0.056700 --> 0.053817).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1382849
	speed: 0.0637s/iter; left time: 538.5668s
	iters: 200, epoch: 6 | loss: 0.2312297
	speed: 0.0216s/iter; left time: 180.5285s
	iters: 300, epoch: 6 | loss: 0.2006404
	speed: 0.0216s/iter; left time: 178.3596s
	iters: 400, epoch: 6 | loss: 0.2580297
	speed: 0.0196s/iter; left time: 159.4689s
	iters: 500, epoch: 6 | loss: 0.2003629
	speed: 0.0188s/iter; left time: 151.1968s
Epoch: 6 cost time: 11.943485021591187
Epoch: 6, Steps: 570 | Train Loss: 0.2458913 Vali Loss: 0.0522738 Test Loss: 0.1558172
Validation loss decreased (0.053817 --> 0.052274).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1853729
	speed: 0.0567s/iter; left time: 447.0929s
	iters: 200, epoch: 7 | loss: 0.2679348
	speed: 0.0187s/iter; left time: 145.5315s
	iters: 300, epoch: 7 | loss: 0.1970098
	speed: 0.0187s/iter; left time: 143.4610s
	iters: 400, epoch: 7 | loss: 0.2792156
	speed: 0.0187s/iter; left time: 141.4528s
	iters: 500, epoch: 7 | loss: 0.3566693
	speed: 0.0187s/iter; left time: 139.7199s
Epoch: 7 cost time: 10.927425384521484
Epoch: 7, Steps: 570 | Train Loss: 0.2409843 Vali Loss: 0.0515541 Test Loss: 0.1536989
Validation loss decreased (0.052274 --> 0.051554).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2299775
	speed: 0.0576s/iter; left time: 421.4555s
	iters: 200, epoch: 8 | loss: 0.2109481
	speed: 0.0186s/iter; left time: 134.0440s
	iters: 300, epoch: 8 | loss: 0.1976876
	speed: 0.0185s/iter; left time: 131.8753s
	iters: 400, epoch: 8 | loss: 0.3727143
	speed: 0.0186s/iter; left time: 130.2679s
	iters: 500, epoch: 8 | loss: 0.2535819
	speed: 0.0186s/iter; left time: 128.2140s
Epoch: 8 cost time: 10.883481740951538
Epoch: 8, Steps: 570 | Train Loss: 0.2374367 Vali Loss: 0.0513114 Test Loss: 0.1529048
Validation loss decreased (0.051554 --> 0.051311).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1614419
	speed: 0.0584s/iter; left time: 393.7680s
	iters: 200, epoch: 9 | loss: 0.3201469
	speed: 0.0187s/iter; left time: 124.0993s
	iters: 300, epoch: 9 | loss: 0.1190581
	speed: 0.0187s/iter; left time: 122.3018s
	iters: 400, epoch: 9 | loss: 0.2792606
	speed: 0.0187s/iter; left time: 120.1952s
	iters: 500, epoch: 9 | loss: 0.1153495
	speed: 0.0187s/iter; left time: 118.4546s
Epoch: 9 cost time: 10.930221796035767
Epoch: 9, Steps: 570 | Train Loss: 0.2353253 Vali Loss: 0.0511915 Test Loss: 0.1528212
Validation loss decreased (0.051311 --> 0.051191).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2203282
	speed: 0.0559s/iter; left time: 344.9658s
	iters: 200, epoch: 10 | loss: 0.2659106
	speed: 0.0186s/iter; left time: 112.9778s
	iters: 300, epoch: 10 | loss: 0.1446058
	speed: 0.0186s/iter; left time: 111.1993s
	iters: 400, epoch: 10 | loss: 0.2124428
	speed: 0.0186s/iter; left time: 109.3725s
	iters: 500, epoch: 10 | loss: 0.2000332
	speed: 0.0186s/iter; left time: 107.3548s
Epoch: 10 cost time: 10.883831262588501
Epoch: 10, Steps: 570 | Train Loss: 0.2360373 Vali Loss: 0.0511895 Test Loss: 0.1525097
Validation loss decreased (0.051191 --> 0.051189).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1884583
	speed: 0.0571s/iter; left time: 319.9631s
	iters: 200, epoch: 11 | loss: 0.3364536
	speed: 0.0186s/iter; left time: 102.5493s
	iters: 300, epoch: 11 | loss: 0.2422140
	speed: 0.0187s/iter; left time: 100.9253s
	iters: 400, epoch: 11 | loss: 0.1363387
	speed: 0.0187s/iter; left time: 98.9280s
	iters: 500, epoch: 11 | loss: 0.3151762
	speed: 0.0187s/iter; left time: 97.0557s
Epoch: 11 cost time: 10.955337762832642
Epoch: 11, Steps: 570 | Train Loss: 0.2365175 Vali Loss: 0.0511866 Test Loss: 0.1524168
Validation loss decreased (0.051189 --> 0.051187).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3024474
	speed: 0.0592s/iter; left time: 297.9320s
	iters: 200, epoch: 12 | loss: 0.3122122
	speed: 0.0216s/iter; left time: 106.3847s
	iters: 300, epoch: 12 | loss: 0.1375531
	speed: 0.0216s/iter; left time: 104.1938s
	iters: 400, epoch: 12 | loss: 0.2285809
	speed: 0.0216s/iter; left time: 102.0114s
	iters: 500, epoch: 12 | loss: 0.1865078
	speed: 0.0216s/iter; left time: 99.9848s
Epoch: 12 cost time: 12.59106993675232
Epoch: 12, Steps: 570 | Train Loss: 0.2352742 Vali Loss: 0.0509963 Test Loss: 0.1524491
Validation loss decreased (0.051187 --> 0.050996).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.3926801
	speed: 0.0614s/iter; left time: 274.0999s
	iters: 200, epoch: 13 | loss: 0.2231462
	speed: 0.0214s/iter; left time: 93.4529s
	iters: 300, epoch: 13 | loss: 0.2874231
	speed: 0.0197s/iter; left time: 83.8805s
	iters: 400, epoch: 13 | loss: 0.1770340
	speed: 0.0187s/iter; left time: 77.6139s
	iters: 500, epoch: 13 | loss: 0.2780897
	speed: 0.0187s/iter; left time: 75.7574s
Epoch: 13 cost time: 11.596874237060547
Epoch: 13, Steps: 570 | Train Loss: 0.2350211 Vali Loss: 0.0510677 Test Loss: 0.1524323
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.3067077
	speed: 0.0574s/iter; left time: 223.2718s
	iters: 200, epoch: 14 | loss: 0.1708578
	speed: 0.0208s/iter; left time: 79.0421s
	iters: 300, epoch: 14 | loss: 0.1416878
	speed: 0.0208s/iter; left time: 76.9228s
	iters: 400, epoch: 14 | loss: 0.2449211
	speed: 0.0208s/iter; left time: 74.8480s
	iters: 500, epoch: 14 | loss: 0.2723967
	speed: 0.0208s/iter; left time: 72.7538s
Epoch: 14 cost time: 12.155897855758667
Epoch: 14, Steps: 570 | Train Loss: 0.2351534 Vali Loss: 0.0510622 Test Loss: 0.1524382
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.1750597
	speed: 0.0570s/iter; left time: 189.4467s
	iters: 200, epoch: 15 | loss: 0.2392311
	speed: 0.0186s/iter; left time: 59.9501s
	iters: 300, epoch: 15 | loss: 0.1884887
	speed: 0.0186s/iter; left time: 58.1498s
	iters: 400, epoch: 15 | loss: 0.2420480
	speed: 0.0186s/iter; left time: 56.2470s
	iters: 500, epoch: 15 | loss: 0.1719001
	speed: 0.0186s/iter; left time: 54.3605s
Epoch: 15 cost time: 10.87500262260437
Epoch: 15, Steps: 570 | Train Loss: 0.2347518 Vali Loss: 0.0510754 Test Loss: 0.1524345
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15269137918949127, mae:0.24526135623455048
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4440405
	speed: 0.0299s/iter; left time: 338.0613s
	iters: 200, epoch: 1 | loss: 0.2563414
	speed: 0.0181s/iter; left time: 203.0248s
	iters: 300, epoch: 1 | loss: 0.2045213
	speed: 0.0181s/iter; left time: 201.1423s
	iters: 400, epoch: 1 | loss: 0.1961407
	speed: 0.0181s/iter; left time: 199.5981s
	iters: 500, epoch: 1 | loss: 0.2555127
	speed: 0.0182s/iter; left time: 197.8534s
Epoch: 1 cost time: 11.566752672195435
Epoch: 1, Steps: 570 | Train Loss: 0.2561358 Vali Loss: 0.0489382 Test Loss: 0.1559181
Validation loss decreased (inf --> 0.048938).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1675851
	speed: 0.0579s/iter; left time: 621.4693s
	iters: 200, epoch: 2 | loss: 0.3353744
	speed: 0.0183s/iter; left time: 194.5502s
	iters: 300, epoch: 2 | loss: 0.5020998
	speed: 0.0182s/iter; left time: 192.0259s
	iters: 400, epoch: 2 | loss: 0.2674504
	speed: 0.0182s/iter; left time: 189.9468s
	iters: 500, epoch: 2 | loss: 0.2010202
	speed: 0.0182s/iter; left time: 188.2211s
Epoch: 2 cost time: 10.695012092590332
Epoch: 2, Steps: 570 | Train Loss: 0.2872678 Vali Loss: 0.0682885 Test Loss: 0.1902094
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2125782
	speed: 0.0553s/iter; left time: 561.9494s
	iters: 200, epoch: 3 | loss: 0.2854894
	speed: 0.0180s/iter; left time: 181.1935s
	iters: 300, epoch: 3 | loss: 0.2461788
	speed: 0.0180s/iter; left time: 179.1923s
	iters: 400, epoch: 3 | loss: 0.2213762
	speed: 0.0180s/iter; left time: 177.4602s
	iters: 500, epoch: 3 | loss: 0.1950367
	speed: 0.0180s/iter; left time: 175.3926s
Epoch: 3 cost time: 10.515527486801147
Epoch: 3, Steps: 570 | Train Loss: 0.2838300 Vali Loss: 0.0612267 Test Loss: 0.1770139
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2848371
	speed: 0.0550s/iter; left time: 527.1302s
	iters: 200, epoch: 4 | loss: 0.1449135
	speed: 0.0182s/iter; left time: 172.5543s
	iters: 300, epoch: 4 | loss: 0.4600289
	speed: 0.0182s/iter; left time: 170.9985s
	iters: 400, epoch: 4 | loss: 0.1936486
	speed: 0.0181s/iter; left time: 168.3854s
	iters: 500, epoch: 4 | loss: 0.1924767
	speed: 0.0181s/iter; left time: 166.5596s
Epoch: 4 cost time: 10.63205075263977
Epoch: 4, Steps: 570 | Train Loss: 0.2692256 Vali Loss: 0.0593378 Test Loss: 0.1638209
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15614116191864014, mae:0.2531272768974304
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3439945
	speed: 0.0325s/iter; left time: 367.7251s
	iters: 200, epoch: 1 | loss: 0.2224072
	speed: 0.0206s/iter; left time: 230.3047s
	iters: 300, epoch: 1 | loss: 0.2982511
	speed: 0.0207s/iter; left time: 229.3575s
	iters: 400, epoch: 1 | loss: 0.3607741
	speed: 0.0206s/iter; left time: 226.8367s
	iters: 500, epoch: 1 | loss: 0.4477174
	speed: 0.0206s/iter; left time: 224.5508s
Epoch: 1 cost time: 12.995243072509766
Epoch: 1, Steps: 570 | Train Loss: 0.2980871 Vali Loss: 0.0661756 Test Loss: 0.1882649
Validation loss decreased (inf --> 0.066176).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3172938
	speed: 0.0605s/iter; left time: 648.8206s
	iters: 200, epoch: 2 | loss: 0.4120645
	speed: 0.0184s/iter; left time: 195.4045s
	iters: 300, epoch: 2 | loss: 0.5728456
	speed: 0.0184s/iter; left time: 193.4565s
	iters: 400, epoch: 2 | loss: 0.2337411
	speed: 0.0184s/iter; left time: 191.4185s
	iters: 500, epoch: 2 | loss: 0.2605494
	speed: 0.0187s/iter; left time: 193.5824s
Epoch: 2 cost time: 11.002652168273926
Epoch: 2, Steps: 570 | Train Loss: 0.3149009 Vali Loss: 0.0684825 Test Loss: 0.1888304
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1760447
	speed: 0.0625s/iter; left time: 634.5696s
	iters: 200, epoch: 3 | loss: 0.3244613
	speed: 0.0211s/iter; left time: 212.3612s
	iters: 300, epoch: 3 | loss: 0.3146085
	speed: 0.0211s/iter; left time: 210.5356s
	iters: 400, epoch: 3 | loss: 0.3546068
	speed: 0.0211s/iter; left time: 208.4058s
	iters: 500, epoch: 3 | loss: 0.3117248
	speed: 0.0206s/iter; left time: 201.4381s
Epoch: 3 cost time: 12.095808744430542
Epoch: 3, Steps: 570 | Train Loss: 0.2925788 Vali Loss: 0.0609396 Test Loss: 0.1662711
Validation loss decreased (0.066176 --> 0.060940).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2310022
	speed: 0.0581s/iter; left time: 557.6276s
	iters: 200, epoch: 4 | loss: 0.2679229
	speed: 0.0185s/iter; left time: 175.9002s
	iters: 300, epoch: 4 | loss: 0.2043655
	speed: 0.0185s/iter; left time: 173.8590s
	iters: 400, epoch: 4 | loss: 0.2407873
	speed: 0.0185s/iter; left time: 171.8941s
	iters: 500, epoch: 4 | loss: 0.1919197
	speed: 0.0185s/iter; left time: 169.8261s
Epoch: 4 cost time: 10.939177751541138
Epoch: 4, Steps: 570 | Train Loss: 0.2716240 Vali Loss: 0.0596362 Test Loss: 0.1630546
Validation loss decreased (0.060940 --> 0.059636).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2280511
	speed: 0.0559s/iter; left time: 504.1322s
	iters: 200, epoch: 5 | loss: 0.2428658
	speed: 0.0184s/iter; left time: 164.4224s
	iters: 300, epoch: 5 | loss: 0.2224826
	speed: 0.0184s/iter; left time: 162.4681s
	iters: 400, epoch: 5 | loss: 0.2465171
	speed: 0.0184s/iter; left time: 160.6571s
	iters: 500, epoch: 5 | loss: 0.1690178
	speed: 0.0184s/iter; left time: 158.7230s
Epoch: 5 cost time: 10.788768768310547
Epoch: 5, Steps: 570 | Train Loss: 0.2609641 Vali Loss: 0.0581607 Test Loss: 0.1598530
Validation loss decreased (0.059636 --> 0.058161).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4152997
	speed: 0.0578s/iter; left time: 488.4949s
	iters: 200, epoch: 6 | loss: 0.1902053
	speed: 0.0184s/iter; left time: 153.3553s
	iters: 300, epoch: 6 | loss: 0.4684936
	speed: 0.0183s/iter; left time: 151.3576s
	iters: 400, epoch: 6 | loss: 0.1891903
	speed: 0.0184s/iter; left time: 149.5965s
	iters: 500, epoch: 6 | loss: 0.2699345
	speed: 0.0184s/iter; left time: 147.8087s
Epoch: 6 cost time: 10.771824836730957
Epoch: 6, Steps: 570 | Train Loss: 0.2563190 Vali Loss: 0.0575713 Test Loss: 0.1564931
Validation loss decreased (0.058161 --> 0.057571).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1933302
	speed: 0.0568s/iter; left time: 447.3859s
	iters: 200, epoch: 7 | loss: 0.2402638
	speed: 0.0185s/iter; left time: 143.7249s
	iters: 300, epoch: 7 | loss: 0.2761043
	speed: 0.0185s/iter; left time: 141.8148s
	iters: 400, epoch: 7 | loss: 0.2309266
	speed: 0.0185s/iter; left time: 139.9671s
	iters: 500, epoch: 7 | loss: 0.1958035
	speed: 0.0184s/iter; left time: 138.0105s
Epoch: 7 cost time: 10.824069499969482
Epoch: 7, Steps: 570 | Train Loss: 0.2547132 Vali Loss: 0.0579028 Test Loss: 0.1565990
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1519305
	speed: 0.0591s/iter; left time: 431.8992s
	iters: 200, epoch: 8 | loss: 0.1581205
	speed: 0.0206s/iter; left time: 148.7560s
	iters: 300, epoch: 8 | loss: 0.2114730
	speed: 0.0206s/iter; left time: 146.6769s
	iters: 400, epoch: 8 | loss: 0.2588448
	speed: 0.0206s/iter; left time: 144.5011s
	iters: 500, epoch: 8 | loss: 0.1707231
	speed: 0.0206s/iter; left time: 142.4705s
Epoch: 8 cost time: 12.071088075637817
Epoch: 8, Steps: 570 | Train Loss: 0.2521554 Vali Loss: 0.0575652 Test Loss: 0.1560879
Validation loss decreased (0.057571 --> 0.057565).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2606703
	speed: 0.0598s/iter; left time: 403.0335s
	iters: 200, epoch: 9 | loss: 0.2921563
	speed: 0.0182s/iter; left time: 120.9184s
	iters: 300, epoch: 9 | loss: 0.2700184
	speed: 0.0182s/iter; left time: 119.0223s
	iters: 400, epoch: 9 | loss: 0.4152758
	speed: 0.0182s/iter; left time: 117.4950s
	iters: 500, epoch: 9 | loss: 0.2096159
	speed: 0.0182s/iter; left time: 115.6548s
Epoch: 9 cost time: 10.68292236328125
Epoch: 9, Steps: 570 | Train Loss: 0.2526055 Vali Loss: 0.0574870 Test Loss: 0.1556351
Validation loss decreased (0.057565 --> 0.057487).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2231581
	speed: 0.0565s/iter; left time: 348.4104s
	iters: 200, epoch: 10 | loss: 0.2138534
	speed: 0.0185s/iter; left time: 112.0533s
	iters: 300, epoch: 10 | loss: 0.3480861
	speed: 0.0185s/iter; left time: 110.3376s
	iters: 400, epoch: 10 | loss: 0.2435866
	speed: 0.0185s/iter; left time: 108.3702s
	iters: 500, epoch: 10 | loss: 0.2342066
	speed: 0.0185s/iter; left time: 106.5149s
Epoch: 10 cost time: 10.852468729019165
Epoch: 10, Steps: 570 | Train Loss: 0.2514910 Vali Loss: 0.0572551 Test Loss: 0.1555971
Validation loss decreased (0.057487 --> 0.057255).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2281349
	speed: 0.0569s/iter; left time: 318.5186s
	iters: 200, epoch: 11 | loss: 0.2650180
	speed: 0.0184s/iter; left time: 101.2528s
	iters: 300, epoch: 11 | loss: 0.2456894
	speed: 0.0184s/iter; left time: 99.4122s
	iters: 400, epoch: 11 | loss: 0.2605615
	speed: 0.0184s/iter; left time: 97.5569s
	iters: 500, epoch: 11 | loss: 0.1960399
	speed: 0.0184s/iter; left time: 95.6858s
Epoch: 11 cost time: 10.805077314376831
Epoch: 11, Steps: 570 | Train Loss: 0.2525947 Vali Loss: 0.0572932 Test Loss: 0.1556307
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.1464265
	speed: 0.0594s/iter; left time: 298.8416s
	iters: 200, epoch: 12 | loss: 0.3264920
	speed: 0.0196s/iter; left time: 96.7420s
	iters: 300, epoch: 12 | loss: 0.2778126
	speed: 0.0184s/iter; left time: 88.9651s
	iters: 400, epoch: 12 | loss: 0.1597119
	speed: 0.0191s/iter; left time: 90.5441s
	iters: 500, epoch: 12 | loss: 0.3305517
	speed: 0.0206s/iter; left time: 95.3987s
Epoch: 12 cost time: 11.557821273803711
Epoch: 12, Steps: 570 | Train Loss: 0.2501300 Vali Loss: 0.0573288 Test Loss: 0.1556164
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.2810948
	speed: 0.0597s/iter; left time: 266.3176s
	iters: 200, epoch: 13 | loss: 0.1267352
	speed: 0.0206s/iter; left time: 89.7114s
	iters: 300, epoch: 13 | loss: 0.1804745
	speed: 0.0206s/iter; left time: 87.7820s
	iters: 400, epoch: 13 | loss: 0.1703719
	speed: 0.0206s/iter; left time: 85.5666s
	iters: 500, epoch: 13 | loss: 0.1641101
	speed: 0.0205s/iter; left time: 83.3649s
Epoch: 13 cost time: 12.047001838684082
Epoch: 13, Steps: 570 | Train Loss: 0.2510339 Vali Loss: 0.0575678 Test Loss: 0.1556001
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15581247210502625, mae:0.2524816393852234
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2820024
	speed: 0.0341s/iter; left time: 385.6921s
	iters: 200, epoch: 1 | loss: 0.3506850
	speed: 0.0220s/iter; left time: 246.3864s
	iters: 300, epoch: 1 | loss: 0.3158914
	speed: 0.0228s/iter; left time: 252.6402s
	iters: 400, epoch: 1 | loss: 0.4694290
	speed: 0.0240s/iter; left time: 263.6715s
	iters: 500, epoch: 1 | loss: 0.4384179
	speed: 0.0239s/iter; left time: 260.6969s
Epoch: 1 cost time: 14.407434225082397
Epoch: 1, Steps: 570 | Train Loss: 0.3687771 Vali Loss: 0.0628052 Test Loss: 0.1830931
Validation loss decreased (inf --> 0.062805).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3938585
	speed: 0.0648s/iter; left time: 695.0129s
	iters: 200, epoch: 2 | loss: 0.2715237
	speed: 0.0236s/iter; left time: 250.7559s
	iters: 300, epoch: 2 | loss: 0.2369220
	speed: 0.0237s/iter; left time: 249.0882s
	iters: 400, epoch: 2 | loss: 0.2923615
	speed: 0.0236s/iter; left time: 246.6088s
	iters: 500, epoch: 2 | loss: 0.2706907
	speed: 0.0237s/iter; left time: 244.3491s
Epoch: 2 cost time: 13.652963399887085
Epoch: 2, Steps: 570 | Train Loss: 0.3097597 Vali Loss: 0.0641888 Test Loss: 0.1786072
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.6045175
	speed: 0.0651s/iter; left time: 661.1789s
	iters: 200, epoch: 3 | loss: 0.1884619
	speed: 0.0236s/iter; left time: 237.8792s
	iters: 300, epoch: 3 | loss: 0.3644444
	speed: 0.0236s/iter; left time: 235.3123s
	iters: 400, epoch: 3 | loss: 0.2941984
	speed: 0.0236s/iter; left time: 232.7604s
	iters: 500, epoch: 3 | loss: 0.2039631
	speed: 0.0236s/iter; left time: 230.6823s
Epoch: 3 cost time: 13.785388469696045
Epoch: 3, Steps: 570 | Train Loss: 0.2877696 Vali Loss: 0.0594068 Test Loss: 0.1651690
Validation loss decreased (0.062805 --> 0.059407).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2447802
	speed: 0.0693s/iter; left time: 664.1949s
	iters: 200, epoch: 4 | loss: 0.1950940
	speed: 0.0240s/iter; left time: 227.5534s
	iters: 300, epoch: 4 | loss: 0.2962869
	speed: 0.0240s/iter; left time: 225.0400s
	iters: 400, epoch: 4 | loss: 0.2045498
	speed: 0.0240s/iter; left time: 223.1150s
	iters: 500, epoch: 4 | loss: 0.3095154
	speed: 0.0240s/iter; left time: 220.2865s
Epoch: 4 cost time: 13.991017818450928
Epoch: 4, Steps: 570 | Train Loss: 0.2705669 Vali Loss: 0.0570208 Test Loss: 0.1616229
Validation loss decreased (0.059407 --> 0.057021).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2788117
	speed: 0.0645s/iter; left time: 582.0475s
	iters: 200, epoch: 5 | loss: 0.2860644
	speed: 0.0220s/iter; left time: 196.6196s
	iters: 300, epoch: 5 | loss: 0.2103918
	speed: 0.0220s/iter; left time: 194.3719s
	iters: 400, epoch: 5 | loss: 0.2173960
	speed: 0.0220s/iter; left time: 192.0365s
	iters: 500, epoch: 5 | loss: 0.2649921
	speed: 0.0220s/iter; left time: 190.0333s
Epoch: 5 cost time: 12.887232542037964
Epoch: 5, Steps: 570 | Train Loss: 0.2607152 Vali Loss: 0.0576824 Test Loss: 0.1600697
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1931576
	speed: 0.0633s/iter; left time: 535.1060s
	iters: 200, epoch: 6 | loss: 0.3377065
	speed: 0.0220s/iter; left time: 184.0431s
	iters: 300, epoch: 6 | loss: 0.1976932
	speed: 0.0220s/iter; left time: 181.7521s
	iters: 400, epoch: 6 | loss: 0.1933704
	speed: 0.0228s/iter; left time: 185.5289s
	iters: 500, epoch: 6 | loss: 0.3341262
	speed: 0.0240s/iter; left time: 193.1173s
Epoch: 6 cost time: 13.282084465026855
Epoch: 6, Steps: 570 | Train Loss: 0.2561844 Vali Loss: 0.0569983 Test Loss: 0.1571478
Validation loss decreased (0.057021 --> 0.056998).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3503615
	speed: 0.0649s/iter; left time: 511.7222s
	iters: 200, epoch: 7 | loss: 0.2650831
	speed: 0.0221s/iter; left time: 172.1655s
	iters: 300, epoch: 7 | loss: 0.1854428
	speed: 0.0221s/iter; left time: 169.6822s
	iters: 400, epoch: 7 | loss: 0.2032392
	speed: 0.0221s/iter; left time: 167.4948s
	iters: 500, epoch: 7 | loss: 0.2495519
	speed: 0.0221s/iter; left time: 165.5382s
Epoch: 7 cost time: 12.925457954406738
Epoch: 7, Steps: 570 | Train Loss: 0.2529105 Vali Loss: 0.0565248 Test Loss: 0.1552147
Validation loss decreased (0.056998 --> 0.056525).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1709098
	speed: 0.0642s/iter; left time: 469.6872s
	iters: 200, epoch: 8 | loss: 0.5014006
	speed: 0.0220s/iter; left time: 158.5240s
	iters: 300, epoch: 8 | loss: 0.1560250
	speed: 0.0220s/iter; left time: 156.2533s
	iters: 400, epoch: 8 | loss: 0.2622548
	speed: 0.0220s/iter; left time: 154.0322s
	iters: 500, epoch: 8 | loss: 0.2482225
	speed: 0.0220s/iter; left time: 151.8253s
Epoch: 8 cost time: 12.829472303390503
Epoch: 8, Steps: 570 | Train Loss: 0.2526525 Vali Loss: 0.0563946 Test Loss: 0.1553344
Validation loss decreased (0.056525 --> 0.056395).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2847161
	speed: 0.0655s/iter; left time: 441.7660s
	iters: 200, epoch: 9 | loss: 0.2171539
	speed: 0.0221s/iter; left time: 147.0125s
	iters: 300, epoch: 9 | loss: 0.3929270
	speed: 0.0221s/iter; left time: 144.6263s
	iters: 400, epoch: 9 | loss: 0.2341013
	speed: 0.0221s/iter; left time: 142.6536s
	iters: 500, epoch: 9 | loss: 0.1879824
	speed: 0.0221s/iter; left time: 140.2170s
Epoch: 9 cost time: 12.910869598388672
Epoch: 9, Steps: 570 | Train Loss: 0.2493533 Vali Loss: 0.0561724 Test Loss: 0.1555994
Validation loss decreased (0.056395 --> 0.056172).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2559296
	speed: 0.0660s/iter; left time: 407.2262s
	iters: 200, epoch: 10 | loss: 0.2823784
	speed: 0.0221s/iter; left time: 134.2113s
	iters: 300, epoch: 10 | loss: 0.2442188
	speed: 0.0221s/iter; left time: 131.7520s
	iters: 400, epoch: 10 | loss: 0.3683121
	speed: 0.0221s/iter; left time: 129.7680s
	iters: 500, epoch: 10 | loss: 0.2910262
	speed: 0.0220s/iter; left time: 127.1494s
Epoch: 10 cost time: 12.931173086166382
Epoch: 10, Steps: 570 | Train Loss: 0.2496015 Vali Loss: 0.0566815 Test Loss: 0.1553975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.1941482
	speed: 0.0637s/iter; left time: 356.6519s
	iters: 200, epoch: 11 | loss: 0.1915396
	speed: 0.0220s/iter; left time: 121.2064s
	iters: 300, epoch: 11 | loss: 0.1241986
	speed: 0.0220s/iter; left time: 118.9062s
	iters: 400, epoch: 11 | loss: 0.1996565
	speed: 0.0220s/iter; left time: 116.8219s
	iters: 500, epoch: 11 | loss: 0.1841637
	speed: 0.0220s/iter; left time: 114.5714s
Epoch: 11 cost time: 12.859290838241577
Epoch: 11, Steps: 570 | Train Loss: 0.2511690 Vali Loss: 0.0564752 Test Loss: 0.1553328
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2536335
	speed: 0.0640s/iter; left time: 321.7890s
	iters: 200, epoch: 12 | loss: 0.2307326
	speed: 0.0221s/iter; left time: 109.1946s
	iters: 300, epoch: 12 | loss: 0.3589673
	speed: 0.0221s/iter; left time: 106.8491s
	iters: 400, epoch: 12 | loss: 0.1117583
	speed: 0.0221s/iter; left time: 104.6963s
	iters: 500, epoch: 12 | loss: 0.2942688
	speed: 0.0221s/iter; left time: 102.4175s
Epoch: 12 cost time: 12.931370735168457
Epoch: 12, Steps: 570 | Train Loss: 0.2487588 Vali Loss: 0.0564325 Test Loss: 0.1553530
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15584561228752136, mae:0.2539593577384949
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3483191
	speed: 0.0331s/iter; left time: 373.5096s
	iters: 200, epoch: 1 | loss: 0.1764646
	speed: 0.0213s/iter; left time: 238.7167s
	iters: 300, epoch: 1 | loss: 0.2731398
	speed: 0.0213s/iter; left time: 236.5706s
	iters: 400, epoch: 1 | loss: 0.3596932
	speed: 0.0213s/iter; left time: 234.6394s
	iters: 500, epoch: 1 | loss: 0.2425520
	speed: 0.0213s/iter; left time: 232.3121s
Epoch: 1 cost time: 13.383516073226929
Epoch: 1, Steps: 570 | Train Loss: 0.3932763 Vali Loss: 0.0687599 Test Loss: 0.1930391
Validation loss decreased (inf --> 0.068760).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3420772
	speed: 0.0639s/iter; left time: 685.5531s
	iters: 200, epoch: 2 | loss: 0.2079389
	speed: 0.0232s/iter; left time: 246.7263s
	iters: 300, epoch: 2 | loss: 0.4470553
	speed: 0.0232s/iter; left time: 244.6926s
	iters: 400, epoch: 2 | loss: 0.2903394
	speed: 0.0233s/iter; left time: 242.6212s
	iters: 500, epoch: 2 | loss: 0.2193912
	speed: 0.0221s/iter; left time: 228.1391s
Epoch: 2 cost time: 13.170797348022461
Epoch: 2, Steps: 570 | Train Loss: 0.3195452 Vali Loss: 0.0677651 Test Loss: 0.1936957
Validation loss decreased (0.068760 --> 0.067765).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2322346
	speed: 0.0626s/iter; left time: 635.9053s
	iters: 200, epoch: 3 | loss: 0.2921307
	speed: 0.0215s/iter; left time: 216.2617s
	iters: 300, epoch: 3 | loss: 0.1781242
	speed: 0.0215s/iter; left time: 213.9341s
	iters: 400, epoch: 3 | loss: 0.1827128
	speed: 0.0215s/iter; left time: 211.7461s
	iters: 500, epoch: 3 | loss: 0.2208113
	speed: 0.0215s/iter; left time: 209.5536s
Epoch: 3 cost time: 12.586251258850098
Epoch: 3, Steps: 570 | Train Loss: 0.2932154 Vali Loss: 0.0649118 Test Loss: 0.1745840
Validation loss decreased (0.067765 --> 0.064912).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2069071
	speed: 0.0629s/iter; left time: 603.2570s
	iters: 200, epoch: 4 | loss: 0.2678215
	speed: 0.0214s/iter; left time: 203.3189s
	iters: 300, epoch: 4 | loss: 0.2591911
	speed: 0.0214s/iter; left time: 201.3335s
	iters: 400, epoch: 4 | loss: 0.3349337
	speed: 0.0214s/iter; left time: 198.8994s
	iters: 500, epoch: 4 | loss: 0.1894222
	speed: 0.0214s/iter; left time: 196.7450s
Epoch: 4 cost time: 12.52560806274414
Epoch: 4, Steps: 570 | Train Loss: 0.2769989 Vali Loss: 0.0618164 Test Loss: 0.1722599
Validation loss decreased (0.064912 --> 0.061816).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4016593
	speed: 0.0652s/iter; left time: 587.8599s
	iters: 200, epoch: 5 | loss: 0.1939733
	speed: 0.0214s/iter; left time: 191.2290s
	iters: 300, epoch: 5 | loss: 0.3224022
	speed: 0.0214s/iter; left time: 189.1261s
	iters: 400, epoch: 5 | loss: 0.2390254
	speed: 0.0214s/iter; left time: 186.6897s
	iters: 500, epoch: 5 | loss: 0.2287242
	speed: 0.0214s/iter; left time: 184.6540s
Epoch: 5 cost time: 12.553574085235596
Epoch: 5, Steps: 570 | Train Loss: 0.2684514 Vali Loss: 0.0615603 Test Loss: 0.1668281
Validation loss decreased (0.061816 --> 0.061560).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2436883
	speed: 0.0629s/iter; left time: 531.5315s
	iters: 200, epoch: 6 | loss: 0.3324875
	speed: 0.0214s/iter; left time: 178.5228s
	iters: 300, epoch: 6 | loss: 0.2827042
	speed: 0.0214s/iter; left time: 176.3970s
	iters: 400, epoch: 6 | loss: 0.1656434
	speed: 0.0214s/iter; left time: 174.2341s
	iters: 500, epoch: 6 | loss: 0.1709646
	speed: 0.0214s/iter; left time: 171.9657s
Epoch: 6 cost time: 12.502390146255493
Epoch: 6, Steps: 570 | Train Loss: 0.2631734 Vali Loss: 0.0609450 Test Loss: 0.1660672
Validation loss decreased (0.061560 --> 0.060945).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2456770
	speed: 0.0626s/iter; left time: 493.2266s
	iters: 200, epoch: 7 | loss: 0.3631036
	speed: 0.0213s/iter; left time: 165.6497s
	iters: 300, epoch: 7 | loss: 0.3073087
	speed: 0.0213s/iter; left time: 163.5840s
	iters: 400, epoch: 7 | loss: 0.1740722
	speed: 0.0213s/iter; left time: 161.4689s
	iters: 500, epoch: 7 | loss: 0.2432873
	speed: 0.0213s/iter; left time: 159.3229s
Epoch: 7 cost time: 12.454591989517212
Epoch: 7, Steps: 570 | Train Loss: 0.2611012 Vali Loss: 0.0604223 Test Loss: 0.1646789
Validation loss decreased (0.060945 --> 0.060422).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2533799
	speed: 0.0629s/iter; left time: 460.1789s
	iters: 200, epoch: 8 | loss: 0.2918572
	speed: 0.0213s/iter; left time: 153.8919s
	iters: 300, epoch: 8 | loss: 0.2444859
	speed: 0.0213s/iter; left time: 151.7778s
	iters: 400, epoch: 8 | loss: 0.2939004
	speed: 0.0213s/iter; left time: 149.6167s
	iters: 500, epoch: 8 | loss: 0.3102149
	speed: 0.0213s/iter; left time: 147.4563s
Epoch: 8 cost time: 12.489131450653076
Epoch: 8, Steps: 570 | Train Loss: 0.2591132 Vali Loss: 0.0587517 Test Loss: 0.1642147
Validation loss decreased (0.060422 --> 0.058752).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2027416
	speed: 0.0631s/iter; left time: 425.2815s
	iters: 200, epoch: 9 | loss: 0.3553377
	speed: 0.0214s/iter; left time: 142.2365s
	iters: 300, epoch: 9 | loss: 0.2911352
	speed: 0.0214s/iter; left time: 140.1132s
	iters: 400, epoch: 9 | loss: 0.2423984
	speed: 0.0214s/iter; left time: 137.9988s
	iters: 500, epoch: 9 | loss: 0.1473337
	speed: 0.0214s/iter; left time: 135.8209s
Epoch: 9 cost time: 12.532773733139038
Epoch: 9, Steps: 570 | Train Loss: 0.2591514 Vali Loss: 0.0583740 Test Loss: 0.1639684
Validation loss decreased (0.058752 --> 0.058374).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1709135
	speed: 0.0622s/iter; left time: 383.7393s
	iters: 200, epoch: 10 | loss: 0.2414147
	speed: 0.0213s/iter; left time: 129.3851s
	iters: 300, epoch: 10 | loss: 0.1864398
	speed: 0.0213s/iter; left time: 127.1677s
	iters: 400, epoch: 10 | loss: 0.2411635
	speed: 0.0213s/iter; left time: 125.0189s
	iters: 500, epoch: 10 | loss: 0.3385921
	speed: 0.0213s/iter; left time: 123.0806s
Epoch: 10 cost time: 12.46562933921814
Epoch: 10, Steps: 570 | Train Loss: 0.2577685 Vali Loss: 0.0582898 Test Loss: 0.1638390
Validation loss decreased (0.058374 --> 0.058290).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.4224576
	speed: 0.0632s/iter; left time: 354.2378s
	iters: 200, epoch: 11 | loss: 0.2363219
	speed: 0.0214s/iter; left time: 117.5685s
	iters: 300, epoch: 11 | loss: 0.2084909
	speed: 0.0214s/iter; left time: 115.3943s
	iters: 400, epoch: 11 | loss: 0.1982952
	speed: 0.0214s/iter; left time: 113.2963s
	iters: 500, epoch: 11 | loss: 0.2825384
	speed: 0.0214s/iter; left time: 111.0623s
Epoch: 11 cost time: 12.593770503997803
Epoch: 11, Steps: 570 | Train Loss: 0.2576231 Vali Loss: 0.0584254 Test Loss: 0.1637842
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.3107935
	speed: 0.0630s/iter; left time: 317.1349s
	iters: 200, epoch: 12 | loss: 0.2872938
	speed: 0.0213s/iter; left time: 105.1231s
	iters: 300, epoch: 12 | loss: 0.2831005
	speed: 0.0213s/iter; left time: 102.9150s
	iters: 400, epoch: 12 | loss: 0.4618843
	speed: 0.0213s/iter; left time: 100.8120s
	iters: 500, epoch: 12 | loss: 0.1982855
	speed: 0.0213s/iter; left time: 98.6468s
Epoch: 12 cost time: 12.502469778060913
Epoch: 12, Steps: 570 | Train Loss: 0.2571457 Vali Loss: 0.0585422 Test Loss: 0.1637864
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1983078
	speed: 0.0656s/iter; left time: 292.7464s
	iters: 200, epoch: 13 | loss: 0.3412160
	speed: 0.0233s/iter; left time: 101.4738s
	iters: 300, epoch: 13 | loss: 0.3556422
	speed: 0.0226s/iter; left time: 96.1091s
	iters: 400, epoch: 13 | loss: 0.2023166
	speed: 0.0214s/iter; left time: 89.0920s
	iters: 500, epoch: 13 | loss: 0.2963874
	speed: 0.0214s/iter; left time: 86.8644s
Epoch: 13 cost time: 12.971540451049805
Epoch: 13, Steps: 570 | Train Loss: 0.2576762 Vali Loss: 0.0589034 Test Loss: 0.1637957
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16409872472286224, mae:0.2606174945831299
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3804397
	speed: 0.0341s/iter; left time: 385.0031s
	iters: 200, epoch: 1 | loss: 0.3089974
	speed: 0.0222s/iter; left time: 248.5842s
	iters: 300, epoch: 1 | loss: 0.3638180
	speed: 0.0222s/iter; left time: 246.2041s
	iters: 400, epoch: 1 | loss: 0.4387281
	speed: 0.0222s/iter; left time: 244.0192s
	iters: 500, epoch: 1 | loss: 0.3337742
	speed: 0.0222s/iter; left time: 241.7443s
Epoch: 1 cost time: 13.891973972320557
Epoch: 1, Steps: 570 | Train Loss: 0.3645407 Vali Loss: 0.0670480 Test Loss: 0.1957417
Validation loss decreased (inf --> 0.067048).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2270536
	speed: 0.0615s/iter; left time: 659.9578s
	iters: 200, epoch: 2 | loss: 0.5691278
	speed: 0.0202s/iter; left time: 214.6213s
	iters: 300, epoch: 2 | loss: 0.2426668
	speed: 0.0202s/iter; left time: 212.4459s
	iters: 400, epoch: 2 | loss: 0.2305209
	speed: 0.0202s/iter; left time: 210.3474s
	iters: 500, epoch: 2 | loss: 0.1968035
	speed: 0.0202s/iter; left time: 208.2809s
Epoch: 2 cost time: 11.82432770729065
Epoch: 2, Steps: 570 | Train Loss: 0.3082443 Vali Loss: 0.0630910 Test Loss: 0.1835305
Validation loss decreased (0.067048 --> 0.063091).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1988384
	speed: 0.0617s/iter; left time: 626.5061s
	iters: 200, epoch: 3 | loss: 0.2185974
	speed: 0.0202s/iter; left time: 202.7395s
	iters: 300, epoch: 3 | loss: 0.2903170
	speed: 0.0201s/iter; left time: 200.4387s
	iters: 400, epoch: 3 | loss: 0.3049778
	speed: 0.0201s/iter; left time: 198.5071s
	iters: 500, epoch: 3 | loss: 0.2555400
	speed: 0.0201s/iter; left time: 196.3211s
Epoch: 3 cost time: 11.794127941131592
Epoch: 3, Steps: 570 | Train Loss: 0.2866641 Vali Loss: 0.0612436 Test Loss: 0.1738186
Validation loss decreased (0.063091 --> 0.061244).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1943121
	speed: 0.0622s/iter; left time: 596.6749s
	iters: 200, epoch: 4 | loss: 0.4831101
	speed: 0.0201s/iter; left time: 190.6399s
	iters: 300, epoch: 4 | loss: 0.1913214
	speed: 0.0201s/iter; left time: 188.4711s
	iters: 400, epoch: 4 | loss: 0.2798837
	speed: 0.0201s/iter; left time: 186.4224s
	iters: 500, epoch: 4 | loss: 0.2258324
	speed: 0.0201s/iter; left time: 184.6538s
Epoch: 4 cost time: 11.766197681427002
Epoch: 4, Steps: 570 | Train Loss: 0.2727965 Vali Loss: 0.0597988 Test Loss: 0.1625510
Validation loss decreased (0.061244 --> 0.059799).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2511033
	speed: 0.0623s/iter; left time: 562.4297s
	iters: 200, epoch: 5 | loss: 0.6101279
	speed: 0.0233s/iter; left time: 207.7919s
	iters: 300, epoch: 5 | loss: 0.2532804
	speed: 0.0232s/iter; left time: 204.8087s
	iters: 400, epoch: 5 | loss: 0.2133041
	speed: 0.0232s/iter; left time: 202.4649s
	iters: 500, epoch: 5 | loss: 0.2544225
	speed: 0.0232s/iter; left time: 199.9604s
Epoch: 5 cost time: 13.459649562835693
Epoch: 5, Steps: 570 | Train Loss: 0.2646309 Vali Loss: 0.0560531 Test Loss: 0.1614465
Validation loss decreased (0.059799 --> 0.056053).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2450040
	speed: 0.0677s/iter; left time: 572.4231s
	iters: 200, epoch: 6 | loss: 0.3549562
	speed: 0.0231s/iter; left time: 193.1098s
	iters: 300, epoch: 6 | loss: 0.2124002
	speed: 0.0231s/iter; left time: 190.7210s
	iters: 400, epoch: 6 | loss: 0.1401052
	speed: 0.0231s/iter; left time: 188.4062s
	iters: 500, epoch: 6 | loss: 0.4268948
	speed: 0.0231s/iter; left time: 186.0937s
Epoch: 6 cost time: 13.490031719207764
Epoch: 6, Steps: 570 | Train Loss: 0.2608943 Vali Loss: 0.0560516 Test Loss: 0.1611834
Validation loss decreased (0.056053 --> 0.056052).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2776586
	speed: 0.0645s/iter; left time: 507.9943s
	iters: 200, epoch: 7 | loss: 0.2870423
	speed: 0.0232s/iter; left time: 180.7517s
	iters: 300, epoch: 7 | loss: 0.3501499
	speed: 0.0232s/iter; left time: 178.0090s
	iters: 400, epoch: 7 | loss: 0.4562049
	speed: 0.0232s/iter; left time: 175.7171s
	iters: 500, epoch: 7 | loss: 0.2012505
	speed: 0.0232s/iter; left time: 173.3941s
Epoch: 7 cost time: 13.505961656570435
Epoch: 7, Steps: 570 | Train Loss: 0.2569121 Vali Loss: 0.0560550 Test Loss: 0.1617218
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3294926
	speed: 0.0637s/iter; left time: 465.7291s
	iters: 200, epoch: 8 | loss: 0.4140672
	speed: 0.0230s/iter; left time: 166.0453s
	iters: 300, epoch: 8 | loss: 0.3153934
	speed: 0.0230s/iter; left time: 163.7205s
	iters: 400, epoch: 8 | loss: 0.1939416
	speed: 0.0230s/iter; left time: 161.3855s
	iters: 500, epoch: 8 | loss: 0.2573278
	speed: 0.0230s/iter; left time: 159.0880s
Epoch: 8 cost time: 13.437071084976196
Epoch: 8, Steps: 570 | Train Loss: 0.2557399 Vali Loss: 0.0562486 Test Loss: 0.1602705
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2525150
	speed: 0.0643s/iter; left time: 433.2965s
	iters: 200, epoch: 9 | loss: 0.2477296
	speed: 0.0231s/iter; left time: 153.5171s
	iters: 300, epoch: 9 | loss: 0.3376626
	speed: 0.0231s/iter; left time: 151.3282s
	iters: 400, epoch: 9 | loss: 0.1935522
	speed: 0.0231s/iter; left time: 148.9798s
	iters: 500, epoch: 9 | loss: 0.1374224
	speed: 0.0231s/iter; left time: 146.6622s
Epoch: 9 cost time: 13.501768350601196
Epoch: 9, Steps: 570 | Train Loss: 0.2557171 Vali Loss: 0.0556010 Test Loss: 0.1605741
Validation loss decreased (0.056052 --> 0.055601).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2737424
	speed: 0.0653s/iter; left time: 402.7719s
	iters: 200, epoch: 10 | loss: 0.1813244
	speed: 0.0231s/iter; left time: 140.5382s
	iters: 300, epoch: 10 | loss: 0.4009261
	speed: 0.0231s/iter; left time: 138.2169s
	iters: 400, epoch: 10 | loss: 0.3548692
	speed: 0.0231s/iter; left time: 135.8010s
	iters: 500, epoch: 10 | loss: 0.2752964
	speed: 0.0231s/iter; left time: 133.4847s
Epoch: 10 cost time: 13.479889631271362
Epoch: 10, Steps: 570 | Train Loss: 0.2539065 Vali Loss: 0.0560734 Test Loss: 0.1604954
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.2159983
	speed: 0.0633s/iter; left time: 354.5469s
	iters: 200, epoch: 11 | loss: 0.2328295
	speed: 0.0230s/iter; left time: 126.7338s
	iters: 300, epoch: 11 | loss: 0.1948394
	speed: 0.0230s/iter; left time: 124.3820s
	iters: 400, epoch: 11 | loss: 0.2906358
	speed: 0.0230s/iter; left time: 121.9739s
	iters: 500, epoch: 11 | loss: 0.2166879
	speed: 0.0230s/iter; left time: 119.6646s
Epoch: 11 cost time: 13.439470767974854
Epoch: 11, Steps: 570 | Train Loss: 0.2556766 Vali Loss: 0.0561369 Test Loss: 0.1604189
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2205788
	speed: 0.0643s/iter; left time: 323.5204s
	iters: 200, epoch: 12 | loss: 0.2239135
	speed: 0.0231s/iter; left time: 113.8641s
	iters: 300, epoch: 12 | loss: 0.4537135
	speed: 0.0231s/iter; left time: 111.6032s
	iters: 400, epoch: 12 | loss: 0.2867092
	speed: 0.0231s/iter; left time: 109.2001s
	iters: 500, epoch: 12 | loss: 0.3965144
	speed: 0.0231s/iter; left time: 106.8991s
Epoch: 12 cost time: 13.4809889793396
Epoch: 12, Steps: 570 | Train Loss: 0.2542800 Vali Loss: 0.0559142 Test Loss: 0.1604519
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16082032024860382, mae:0.2550908029079437
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1944437
	speed: 0.0216s/iter; left time: 243.9524s
	iters: 200, epoch: 1 | loss: 0.1642704
	speed: 0.0099s/iter; left time: 111.0251s
	iters: 300, epoch: 1 | loss: 0.2080029
	speed: 0.0099s/iter; left time: 110.2856s
	iters: 400, epoch: 1 | loss: 0.1865716
	speed: 0.0099s/iter; left time: 108.9345s
	iters: 500, epoch: 1 | loss: 0.1544829
	speed: 0.0099s/iter; left time: 108.1734s
Epoch: 1 cost time: 6.8672003746032715
Epoch: 1, Steps: 570 | Train Loss: 0.1804872 Vali Loss: 0.0488531 Test Loss: 0.1410827
Validation loss decreased (inf --> 0.048853).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1664304
	speed: 0.0367s/iter; left time: 393.8329s
	iters: 200, epoch: 2 | loss: 0.2020042
	speed: 0.0100s/iter; left time: 106.5745s
	iters: 300, epoch: 2 | loss: 0.1241654
	speed: 0.0100s/iter; left time: 105.0727s
	iters: 400, epoch: 2 | loss: 0.1342875
	speed: 0.0100s/iter; left time: 104.5519s
	iters: 500, epoch: 2 | loss: 0.1565352
	speed: 0.0100s/iter; left time: 103.5943s
Epoch: 2 cost time: 5.9860358238220215
Epoch: 2, Steps: 570 | Train Loss: 0.1322044 Vali Loss: 0.0428261 Test Loss: 0.1458761
Validation loss decreased (0.048853 --> 0.042826).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0983299
	speed: 0.0383s/iter; left time: 389.2814s
	iters: 200, epoch: 3 | loss: 0.0833045
	speed: 0.0112s/iter; left time: 113.1309s
	iters: 300, epoch: 3 | loss: 0.0775792
	speed: 0.0112s/iter; left time: 111.6394s
	iters: 400, epoch: 3 | loss: 0.1087999
	speed: 0.0112s/iter; left time: 110.6030s
	iters: 500, epoch: 3 | loss: 0.1334865
	speed: 0.0112s/iter; left time: 109.0829s
Epoch: 3 cost time: 6.70125937461853
Epoch: 3, Steps: 570 | Train Loss: 0.0894185 Vali Loss: 0.0405665 Test Loss: 0.1412212
Validation loss decreased (0.042826 --> 0.040567).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0738157
	speed: 0.0357s/iter; left time: 342.4441s
	iters: 200, epoch: 4 | loss: 0.0421157
	speed: 0.0099s/iter; left time: 94.4128s
	iters: 300, epoch: 4 | loss: 0.0593118
	speed: 0.0100s/iter; left time: 93.4989s
	iters: 400, epoch: 4 | loss: 0.0594450
	speed: 0.0100s/iter; left time: 92.5498s
	iters: 500, epoch: 4 | loss: 0.0589572
	speed: 0.0099s/iter; left time: 91.3903s
Epoch: 4 cost time: 5.962709188461304
Epoch: 4, Steps: 570 | Train Loss: 0.0601401 Vali Loss: 0.0413942 Test Loss: 0.1406739
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0557960
	speed: 0.0371s/iter; left time: 334.4861s
	iters: 200, epoch: 5 | loss: 0.0553470
	speed: 0.0099s/iter; left time: 88.2350s
	iters: 300, epoch: 5 | loss: 0.0386101
	speed: 0.0099s/iter; left time: 87.2026s
	iters: 400, epoch: 5 | loss: 0.0521770
	speed: 0.0099s/iter; left time: 86.3898s
	iters: 500, epoch: 5 | loss: 0.0316364
	speed: 0.0099s/iter; left time: 85.2588s
Epoch: 5 cost time: 5.886400461196899
Epoch: 5, Steps: 570 | Train Loss: 0.0463121 Vali Loss: 0.0392300 Test Loss: 0.1354600
Validation loss decreased (0.040567 --> 0.039230).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0314671
	speed: 0.0365s/iter; left time: 308.3248s
	iters: 200, epoch: 6 | loss: 0.0347356
	speed: 0.0112s/iter; left time: 93.3634s
	iters: 300, epoch: 6 | loss: 0.0368734
	speed: 0.0112s/iter; left time: 92.1858s
	iters: 400, epoch: 6 | loss: 0.0429091
	speed: 0.0112s/iter; left time: 91.4468s
	iters: 500, epoch: 6 | loss: 0.0451638
	speed: 0.0100s/iter; left time: 80.7693s
Epoch: 6 cost time: 6.474477529525757
Epoch: 6, Steps: 570 | Train Loss: 0.0389716 Vali Loss: 0.0409728 Test Loss: 0.1399496
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0390323
	speed: 0.0352s/iter; left time: 277.4459s
	iters: 200, epoch: 7 | loss: 0.0337189
	speed: 0.0100s/iter; left time: 78.0340s
	iters: 300, epoch: 7 | loss: 0.0284107
	speed: 0.0100s/iter; left time: 76.8720s
	iters: 400, epoch: 7 | loss: 0.0361575
	speed: 0.0100s/iter; left time: 75.9162s
	iters: 500, epoch: 7 | loss: 0.0334786
	speed: 0.0100s/iter; left time: 74.8320s
Epoch: 7 cost time: 6.009105443954468
Epoch: 7, Steps: 570 | Train Loss: 0.0354632 Vali Loss: 0.0407551 Test Loss: 0.1402271
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0376807
	speed: 0.0368s/iter; left time: 269.2798s
	iters: 200, epoch: 8 | loss: 0.0568481
	speed: 0.0099s/iter; left time: 71.7046s
	iters: 300, epoch: 8 | loss: 0.0314264
	speed: 0.0099s/iter; left time: 70.5287s
	iters: 400, epoch: 8 | loss: 0.0443626
	speed: 0.0099s/iter; left time: 69.4805s
	iters: 500, epoch: 8 | loss: 0.0328621
	speed: 0.0099s/iter; left time: 68.4779s
Epoch: 8 cost time: 5.9290711879730225
Epoch: 8, Steps: 570 | Train Loss: 0.0336702 Vali Loss: 0.0409307 Test Loss: 0.1423887
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.135650172829628, mae:0.23488344252109528
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1940793
	speed: 0.0232s/iter; left time: 261.9338s
	iters: 200, epoch: 1 | loss: 0.1388180
	speed: 0.0110s/iter; left time: 122.6937s
	iters: 300, epoch: 1 | loss: 0.2141243
	speed: 0.0109s/iter; left time: 121.0699s
	iters: 400, epoch: 1 | loss: 0.1099621
	speed: 0.0109s/iter; left time: 120.2068s
	iters: 500, epoch: 1 | loss: 0.1165200
	speed: 0.0110s/iter; left time: 119.6131s
Epoch: 1 cost time: 7.506651401519775
Epoch: 1, Steps: 570 | Train Loss: 0.1467942 Vali Loss: 0.0391663 Test Loss: 0.1277200
Validation loss decreased (inf --> 0.039166).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1055574
	speed: 0.0363s/iter; left time: 389.7991s
	iters: 200, epoch: 2 | loss: 0.1487699
	speed: 0.0098s/iter; left time: 104.2087s
	iters: 300, epoch: 2 | loss: 0.0745109
	speed: 0.0098s/iter; left time: 102.8560s
	iters: 400, epoch: 2 | loss: 0.0588041
	speed: 0.0098s/iter; left time: 101.8545s
	iters: 500, epoch: 2 | loss: 0.0908444
	speed: 0.0098s/iter; left time: 101.1650s
Epoch: 2 cost time: 5.89277195930481
Epoch: 2, Steps: 570 | Train Loss: 0.1147852 Vali Loss: 0.0365444 Test Loss: 0.1178358
Validation loss decreased (0.039166 --> 0.036544).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0494687
	speed: 0.0355s/iter; left time: 360.7674s
	iters: 200, epoch: 3 | loss: 0.0652063
	speed: 0.0098s/iter; left time: 98.5235s
	iters: 300, epoch: 3 | loss: 0.1403556
	speed: 0.0098s/iter; left time: 97.2392s
	iters: 400, epoch: 3 | loss: 0.0767204
	speed: 0.0098s/iter; left time: 96.2017s
	iters: 500, epoch: 3 | loss: 0.0613843
	speed: 0.0097s/iter; left time: 94.8913s
Epoch: 3 cost time: 5.855514764785767
Epoch: 3, Steps: 570 | Train Loss: 0.0810848 Vali Loss: 0.0354074 Test Loss: 0.1190029
Validation loss decreased (0.036544 --> 0.035407).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0427368
	speed: 0.0348s/iter; left time: 333.3381s
	iters: 200, epoch: 4 | loss: 0.0439321
	speed: 0.0097s/iter; left time: 92.4714s
	iters: 300, epoch: 4 | loss: 0.0371526
	speed: 0.0097s/iter; left time: 91.2928s
	iters: 400, epoch: 4 | loss: 0.0446692
	speed: 0.0097s/iter; left time: 90.3391s
	iters: 500, epoch: 4 | loss: 0.0675589
	speed: 0.0097s/iter; left time: 89.5732s
Epoch: 4 cost time: 5.838128089904785
Epoch: 4, Steps: 570 | Train Loss: 0.0567281 Vali Loss: 0.0344380 Test Loss: 0.1204967
Validation loss decreased (0.035407 --> 0.034438).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0475336
	speed: 0.0360s/iter; left time: 324.7179s
	iters: 200, epoch: 5 | loss: 0.0603414
	speed: 0.0097s/iter; left time: 86.9224s
	iters: 300, epoch: 5 | loss: 0.0557232
	speed: 0.0097s/iter; left time: 86.0028s
	iters: 400, epoch: 5 | loss: 0.0629306
	speed: 0.0097s/iter; left time: 84.6850s
	iters: 500, epoch: 5 | loss: 0.0599310
	speed: 0.0097s/iter; left time: 83.8580s
Epoch: 5 cost time: 5.8611767292022705
Epoch: 5, Steps: 570 | Train Loss: 0.0443423 Vali Loss: 0.0358920 Test Loss: 0.1261836
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0302408
	speed: 0.0358s/iter; left time: 302.9484s
	iters: 200, epoch: 6 | loss: 0.0627531
	speed: 0.0109s/iter; left time: 91.3887s
	iters: 300, epoch: 6 | loss: 0.0530466
	speed: 0.0110s/iter; left time: 90.5554s
	iters: 400, epoch: 6 | loss: 0.0300475
	speed: 0.0110s/iter; left time: 89.2760s
	iters: 500, epoch: 6 | loss: 0.0230651
	speed: 0.0109s/iter; left time: 88.1561s
Epoch: 6 cost time: 6.521501302719116
Epoch: 6, Steps: 570 | Train Loss: 0.0382273 Vali Loss: 0.0365799 Test Loss: 0.1277658
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0277006
	speed: 0.0371s/iter; left time: 292.3464s
	iters: 200, epoch: 7 | loss: 0.0329772
	speed: 0.0109s/iter; left time: 84.8347s
	iters: 300, epoch: 7 | loss: 0.0540259
	speed: 0.0109s/iter; left time: 84.0546s
	iters: 400, epoch: 7 | loss: 0.0743621
	speed: 0.0110s/iter; left time: 83.0373s
	iters: 500, epoch: 7 | loss: 0.0309425
	speed: 0.0109s/iter; left time: 81.5113s
Epoch: 7 cost time: 6.518216609954834
Epoch: 7, Steps: 570 | Train Loss: 0.0351306 Vali Loss: 0.0364887 Test Loss: 0.1271494
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12067621946334839, mae:0.216682568192482
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1714890
	speed: 0.0230s/iter; left time: 259.6935s
	iters: 200, epoch: 1 | loss: 0.1268095
	speed: 0.0109s/iter; left time: 122.6289s
	iters: 300, epoch: 1 | loss: 0.1375185
	speed: 0.0109s/iter; left time: 121.1786s
	iters: 400, epoch: 1 | loss: 0.0977060
	speed: 0.0109s/iter; left time: 120.1579s
	iters: 500, epoch: 1 | loss: 0.1776273
	speed: 0.0110s/iter; left time: 119.4933s
Epoch: 1 cost time: 7.435278415679932
Epoch: 1, Steps: 570 | Train Loss: 0.1847429 Vali Loss: 0.0443673 Test Loss: 0.1467872
Validation loss decreased (inf --> 0.044367).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1578133
	speed: 0.0351s/iter; left time: 376.6848s
	iters: 200, epoch: 2 | loss: 0.2252475
	speed: 0.0098s/iter; left time: 104.3801s
	iters: 300, epoch: 2 | loss: 0.1275061
	speed: 0.0098s/iter; left time: 103.3713s
	iters: 400, epoch: 2 | loss: 0.1975546
	speed: 0.0098s/iter; left time: 102.4979s
	iters: 500, epoch: 2 | loss: 0.1235378
	speed: 0.0098s/iter; left time: 101.5167s
Epoch: 2 cost time: 5.892151594161987
Epoch: 2, Steps: 570 | Train Loss: 0.1313124 Vali Loss: 0.0441769 Test Loss: 0.1452591
Validation loss decreased (0.044367 --> 0.044177).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0545728
	speed: 0.0379s/iter; left time: 385.3396s
	iters: 200, epoch: 3 | loss: 0.0621531
	speed: 0.0110s/iter; left time: 110.5452s
	iters: 300, epoch: 3 | loss: 0.0807057
	speed: 0.0109s/iter; left time: 108.3753s
	iters: 400, epoch: 3 | loss: 0.0659295
	speed: 0.0097s/iter; left time: 95.8378s
	iters: 500, epoch: 3 | loss: 0.0607469
	speed: 0.0097s/iter; left time: 94.8027s
Epoch: 3 cost time: 6.209687948226929
Epoch: 3, Steps: 570 | Train Loss: 0.0804944 Vali Loss: 0.0399675 Test Loss: 0.1428847
Validation loss decreased (0.044177 --> 0.039968).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0398316
	speed: 0.0345s/iter; left time: 331.2750s
	iters: 200, epoch: 4 | loss: 0.0337781
	speed: 0.0097s/iter; left time: 92.2535s
	iters: 300, epoch: 4 | loss: 0.0411565
	speed: 0.0098s/iter; left time: 91.6014s
	iters: 400, epoch: 4 | loss: 0.0658094
	speed: 0.0097s/iter; left time: 90.5797s
	iters: 500, epoch: 4 | loss: 0.0430230
	speed: 0.0098s/iter; left time: 89.6909s
Epoch: 4 cost time: 5.823107719421387
Epoch: 4, Steps: 570 | Train Loss: 0.0502238 Vali Loss: 0.0407962 Test Loss: 0.1488430
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0395215
	speed: 0.0345s/iter; left time: 310.7845s
	iters: 200, epoch: 5 | loss: 0.0381135
	speed: 0.0098s/iter; left time: 87.1055s
	iters: 300, epoch: 5 | loss: 0.0297308
	speed: 0.0098s/iter; left time: 86.1259s
	iters: 400, epoch: 5 | loss: 0.0274207
	speed: 0.0098s/iter; left time: 85.0755s
	iters: 500, epoch: 5 | loss: 0.0346355
	speed: 0.0097s/iter; left time: 84.0463s
Epoch: 5 cost time: 5.828102350234985
Epoch: 5, Steps: 570 | Train Loss: 0.0374292 Vali Loss: 0.0404922 Test Loss: 0.1463897
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0315148
	speed: 0.0367s/iter; left time: 310.4911s
	iters: 200, epoch: 6 | loss: 0.0427770
	speed: 0.0098s/iter; left time: 81.7910s
	iters: 300, epoch: 6 | loss: 0.0287391
	speed: 0.0098s/iter; left time: 80.8093s
	iters: 400, epoch: 6 | loss: 0.0242794
	speed: 0.0098s/iter; left time: 80.2230s
	iters: 500, epoch: 6 | loss: 0.0340353
	speed: 0.0098s/iter; left time: 78.8886s
Epoch: 6 cost time: 5.873657941818237
Epoch: 6, Steps: 570 | Train Loss: 0.0319297 Vali Loss: 0.0407948 Test Loss: 0.1484461
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.143092542886734, mae:0.2408505529165268
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2388572
	speed: 0.0234s/iter; left time: 264.0797s
	iters: 200, epoch: 1 | loss: 0.2025720
	speed: 0.0114s/iter; left time: 127.8681s
	iters: 300, epoch: 1 | loss: 0.1443961
	speed: 0.0114s/iter; left time: 126.7699s
	iters: 400, epoch: 1 | loss: 0.0870342
	speed: 0.0114s/iter; left time: 125.7201s
	iters: 500, epoch: 1 | loss: 0.1572416
	speed: 0.0114s/iter; left time: 124.5562s
Epoch: 1 cost time: 7.754876375198364
Epoch: 1, Steps: 570 | Train Loss: 0.2009764 Vali Loss: 0.0460886 Test Loss: 0.1417371
Validation loss decreased (inf --> 0.046089).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1435807
	speed: 0.0395s/iter; left time: 423.4959s
	iters: 200, epoch: 2 | loss: 0.1392410
	speed: 0.0115s/iter; left time: 122.0293s
	iters: 300, epoch: 2 | loss: 0.1236219
	speed: 0.0115s/iter; left time: 120.9795s
	iters: 400, epoch: 2 | loss: 0.0819476
	speed: 0.0115s/iter; left time: 119.7288s
	iters: 500, epoch: 2 | loss: 0.1863607
	speed: 0.0115s/iter; left time: 118.7881s
Epoch: 2 cost time: 6.851367712020874
Epoch: 2, Steps: 570 | Train Loss: 0.1794212 Vali Loss: 0.0579344 Test Loss: 0.1662709
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1860282
	speed: 0.0400s/iter; left time: 406.2660s
	iters: 200, epoch: 3 | loss: 0.1703259
	speed: 0.0125s/iter; left time: 125.2826s
	iters: 300, epoch: 3 | loss: 0.1034399
	speed: 0.0123s/iter; left time: 122.5921s
	iters: 400, epoch: 3 | loss: 0.1257529
	speed: 0.0114s/iter; left time: 112.4954s
	iters: 500, epoch: 3 | loss: 0.1156912
	speed: 0.0114s/iter; left time: 111.6375s
Epoch: 3 cost time: 7.085433006286621
Epoch: 3, Steps: 570 | Train Loss: 0.1496666 Vali Loss: 0.0448545 Test Loss: 0.1353032
Validation loss decreased (0.046089 --> 0.044854).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1272880
	speed: 0.0392s/iter; left time: 375.6176s
	iters: 200, epoch: 4 | loss: 0.1286890
	speed: 0.0114s/iter; left time: 108.3654s
	iters: 300, epoch: 4 | loss: 0.0969923
	speed: 0.0114s/iter; left time: 107.3417s
	iters: 400, epoch: 4 | loss: 0.0714660
	speed: 0.0114s/iter; left time: 106.2038s
	iters: 500, epoch: 4 | loss: 0.1516775
	speed: 0.0114s/iter; left time: 104.9373s
Epoch: 4 cost time: 6.8412535190582275
Epoch: 4, Steps: 570 | Train Loss: 0.1244113 Vali Loss: 0.0458936 Test Loss: 0.1368112
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0831007
	speed: 0.0389s/iter; left time: 350.6518s
	iters: 200, epoch: 5 | loss: 0.0894234
	speed: 0.0114s/iter; left time: 101.6962s
	iters: 300, epoch: 5 | loss: 0.1539751
	speed: 0.0114s/iter; left time: 100.5978s
	iters: 400, epoch: 5 | loss: 0.0966540
	speed: 0.0114s/iter; left time: 99.4531s
	iters: 500, epoch: 5 | loss: 0.1262841
	speed: 0.0114s/iter; left time: 98.3530s
Epoch: 5 cost time: 6.832409381866455
Epoch: 5, Steps: 570 | Train Loss: 0.1050426 Vali Loss: 0.0450158 Test Loss: 0.1372498
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0814576
	speed: 0.0401s/iter; left time: 339.0279s
	iters: 200, epoch: 6 | loss: 0.0685639
	speed: 0.0125s/iter; left time: 104.0427s
	iters: 300, epoch: 6 | loss: 0.0879787
	speed: 0.0125s/iter; left time: 102.7554s
	iters: 400, epoch: 6 | loss: 0.0606897
	speed: 0.0125s/iter; left time: 101.6127s
	iters: 500, epoch: 6 | loss: 0.0625465
	speed: 0.0125s/iter; left time: 100.4680s
Epoch: 6 cost time: 7.40555739402771
Epoch: 6, Steps: 570 | Train Loss: 0.0924215 Vali Loss: 0.0437972 Test Loss: 0.1383720
Validation loss decreased (0.044854 --> 0.043797).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0925268
	speed: 0.0411s/iter; left time: 323.5902s
	iters: 200, epoch: 7 | loss: 0.0876379
	speed: 0.0114s/iter; left time: 88.5102s
	iters: 300, epoch: 7 | loss: 0.0903184
	speed: 0.0114s/iter; left time: 87.4879s
	iters: 400, epoch: 7 | loss: 0.0643708
	speed: 0.0114s/iter; left time: 86.2615s
	iters: 500, epoch: 7 | loss: 0.1023967
	speed: 0.0114s/iter; left time: 85.0131s
Epoch: 7 cost time: 6.802591800689697
Epoch: 7, Steps: 570 | Train Loss: 0.0852080 Vali Loss: 0.0439345 Test Loss: 0.1393003
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0709743
	speed: 0.0392s/iter; left time: 286.2819s
	iters: 200, epoch: 8 | loss: 0.0723450
	speed: 0.0114s/iter; left time: 82.5161s
	iters: 300, epoch: 8 | loss: 0.0668660
	speed: 0.0115s/iter; left time: 81.5556s
	iters: 400, epoch: 8 | loss: 0.0706788
	speed: 0.0114s/iter; left time: 80.1151s
	iters: 500, epoch: 8 | loss: 0.0804036
	speed: 0.0114s/iter; left time: 78.9973s
Epoch: 8 cost time: 6.848761796951294
Epoch: 8, Steps: 570 | Train Loss: 0.0810429 Vali Loss: 0.0440970 Test Loss: 0.1393788
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0490901
	speed: 0.0382s/iter; left time: 257.6584s
	iters: 200, epoch: 9 | loss: 0.0777733
	speed: 0.0115s/iter; left time: 76.1239s
	iters: 300, epoch: 9 | loss: 0.0971335
	speed: 0.0115s/iter; left time: 74.9420s
	iters: 400, epoch: 9 | loss: 0.0591456
	speed: 0.0114s/iter; left time: 73.6806s
	iters: 500, epoch: 9 | loss: 0.0914075
	speed: 0.0115s/iter; left time: 72.6064s
Epoch: 9 cost time: 6.830945253372192
Epoch: 9, Steps: 570 | Train Loss: 0.0786846 Vali Loss: 0.0439969 Test Loss: 0.1393926
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13855166733264923, mae:0.23596133291721344
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.0974500
	speed: 0.0240s/iter; left time: 271.7190s
	iters: 200, epoch: 1 | loss: 0.2052382
	speed: 0.0121s/iter; left time: 135.0763s
	iters: 300, epoch: 1 | loss: 0.1459617
	speed: 0.0120s/iter; left time: 133.5560s
	iters: 400, epoch: 1 | loss: 0.1657365
	speed: 0.0121s/iter; left time: 132.6139s
	iters: 500, epoch: 1 | loss: 0.1082806
	speed: 0.0121s/iter; left time: 131.6581s
Epoch: 1 cost time: 8.123446226119995
Epoch: 1, Steps: 570 | Train Loss: 0.1601642 Vali Loss: 0.0422012 Test Loss: 0.1301945
Validation loss decreased (inf --> 0.042201).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1238574
	speed: 0.0389s/iter; left time: 417.9184s
	iters: 200, epoch: 2 | loss: 0.0918113
	speed: 0.0110s/iter; left time: 117.2048s
	iters: 300, epoch: 2 | loss: 0.1213746
	speed: 0.0110s/iter; left time: 116.1282s
	iters: 400, epoch: 2 | loss: 0.1729004
	speed: 0.0110s/iter; left time: 114.9492s
	iters: 500, epoch: 2 | loss: 0.1869538
	speed: 0.0110s/iter; left time: 113.8546s
Epoch: 2 cost time: 6.615189552307129
Epoch: 2, Steps: 570 | Train Loss: 0.1370953 Vali Loss: 0.0412954 Test Loss: 0.1261017
Validation loss decreased (0.042201 --> 0.041295).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1401310
	speed: 0.0380s/iter; left time: 385.8802s
	iters: 200, epoch: 3 | loss: 0.0646986
	speed: 0.0110s/iter; left time: 111.0025s
	iters: 300, epoch: 3 | loss: 0.1279343
	speed: 0.0110s/iter; left time: 109.9729s
	iters: 400, epoch: 3 | loss: 0.1239163
	speed: 0.0110s/iter; left time: 108.8499s
	iters: 500, epoch: 3 | loss: 0.1246570
	speed: 0.0110s/iter; left time: 107.5986s
Epoch: 3 cost time: 6.617619037628174
Epoch: 3, Steps: 570 | Train Loss: 0.1077242 Vali Loss: 0.0355741 Test Loss: 0.1213372
Validation loss decreased (0.041295 --> 0.035574).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0936984
	speed: 0.0394s/iter; left time: 378.0878s
	iters: 200, epoch: 4 | loss: 0.0660693
	speed: 0.0110s/iter; left time: 104.5968s
	iters: 300, epoch: 4 | loss: 0.0422177
	speed: 0.0110s/iter; left time: 103.4819s
	iters: 400, epoch: 4 | loss: 0.1038613
	speed: 0.0110s/iter; left time: 102.4296s
	iters: 500, epoch: 4 | loss: 0.0759548
	speed: 0.0110s/iter; left time: 101.2962s
Epoch: 4 cost time: 6.601496696472168
Epoch: 4, Steps: 570 | Train Loss: 0.0860111 Vali Loss: 0.0350507 Test Loss: 0.1255417
Validation loss decreased (0.035574 --> 0.035051).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0573087
	speed: 0.0391s/iter; left time: 352.7485s
	iters: 200, epoch: 5 | loss: 0.0602667
	speed: 0.0110s/iter; left time: 98.0710s
	iters: 300, epoch: 5 | loss: 0.0824649
	speed: 0.0110s/iter; left time: 97.2937s
	iters: 400, epoch: 5 | loss: 0.0633375
	speed: 0.0111s/iter; left time: 96.3934s
	iters: 500, epoch: 5 | loss: 0.0625824
	speed: 0.0110s/iter; left time: 95.2429s
Epoch: 5 cost time: 6.624646902084351
Epoch: 5, Steps: 570 | Train Loss: 0.0691570 Vali Loss: 0.0333579 Test Loss: 0.1244702
Validation loss decreased (0.035051 --> 0.033358).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0775955
	speed: 0.0391s/iter; left time: 330.3599s
	iters: 200, epoch: 6 | loss: 0.0551258
	speed: 0.0121s/iter; left time: 100.6359s
	iters: 300, epoch: 6 | loss: 0.0558651
	speed: 0.0121s/iter; left time: 99.4394s
	iters: 400, epoch: 6 | loss: 0.0444722
	speed: 0.0121s/iter; left time: 98.2616s
	iters: 500, epoch: 6 | loss: 0.0528609
	speed: 0.0121s/iter; left time: 97.1117s
Epoch: 6 cost time: 7.18257212638855
Epoch: 6, Steps: 570 | Train Loss: 0.0584916 Vali Loss: 0.0337634 Test Loss: 0.1316425
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0433577
	speed: 0.0381s/iter; left time: 300.0263s
	iters: 200, epoch: 7 | loss: 0.0621938
	speed: 0.0110s/iter; left time: 85.6881s
	iters: 300, epoch: 7 | loss: 0.0465754
	speed: 0.0110s/iter; left time: 84.5875s
	iters: 400, epoch: 7 | loss: 0.0555614
	speed: 0.0110s/iter; left time: 83.4877s
	iters: 500, epoch: 7 | loss: 0.0376010
	speed: 0.0110s/iter; left time: 82.3665s
Epoch: 7 cost time: 6.654365539550781
Epoch: 7, Steps: 570 | Train Loss: 0.0522816 Vali Loss: 0.0336066 Test Loss: 0.1316548
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0479672
	speed: 0.0392s/iter; left time: 286.8140s
	iters: 200, epoch: 8 | loss: 0.0504123
	speed: 0.0119s/iter; left time: 85.9681s
	iters: 300, epoch: 8 | loss: 0.0374279
	speed: 0.0119s/iter; left time: 84.8628s
	iters: 400, epoch: 8 | loss: 0.0494475
	speed: 0.0119s/iter; left time: 83.6622s
	iters: 500, epoch: 8 | loss: 0.0504735
	speed: 0.0119s/iter; left time: 82.5162s
Epoch: 8 cost time: 7.094576120376587
Epoch: 8, Steps: 570 | Train Loss: 0.0490019 Vali Loss: 0.0342471 Test Loss: 0.1331143
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12465690076351166, mae:0.21787424385547638
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2019889
	speed: 0.0220s/iter; left time: 248.3764s
	iters: 200, epoch: 1 | loss: 0.2130914
	speed: 0.0102s/iter; left time: 114.6444s
	iters: 300, epoch: 1 | loss: 0.1833379
	speed: 0.0103s/iter; left time: 113.8172s
	iters: 400, epoch: 1 | loss: 0.1353990
	speed: 0.0102s/iter; left time: 112.5470s
	iters: 500, epoch: 1 | loss: 0.1589779
	speed: 0.0102s/iter; left time: 111.5283s
Epoch: 1 cost time: 7.063090562820435
Epoch: 1, Steps: 570 | Train Loss: 0.1984546 Vali Loss: 0.0496909 Test Loss: 0.1584453
Validation loss decreased (inf --> 0.049691).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1731774
	speed: 0.0374s/iter; left time: 401.1218s
	iters: 200, epoch: 2 | loss: 0.2615232
	speed: 0.0107s/iter; left time: 113.9208s
	iters: 300, epoch: 2 | loss: 0.1243211
	speed: 0.0103s/iter; left time: 108.9235s
	iters: 400, epoch: 2 | loss: 0.1666401
	speed: 0.0104s/iter; left time: 108.1774s
	iters: 500, epoch: 2 | loss: 0.1445317
	speed: 0.0105s/iter; left time: 108.6392s
Epoch: 2 cost time: 6.43419623374939
Epoch: 2, Steps: 570 | Train Loss: 0.2028869 Vali Loss: 0.0559001 Test Loss: 0.1606367
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1585160
	speed: 0.0385s/iter; left time: 391.4463s
	iters: 200, epoch: 3 | loss: 0.1345448
	speed: 0.0103s/iter; left time: 103.8703s
	iters: 300, epoch: 3 | loss: 0.1909739
	speed: 0.0104s/iter; left time: 103.3879s
	iters: 400, epoch: 3 | loss: 0.1253612
	speed: 0.0104s/iter; left time: 102.1881s
	iters: 500, epoch: 3 | loss: 0.1260650
	speed: 0.0103s/iter; left time: 100.7332s
Epoch: 3 cost time: 6.233942985534668
Epoch: 3, Steps: 570 | Train Loss: 0.1610141 Vali Loss: 0.0496181 Test Loss: 0.1464581
Validation loss decreased (0.049691 --> 0.049618).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1535898
	speed: 0.0377s/iter; left time: 361.2503s
	iters: 200, epoch: 4 | loss: 0.1112829
	speed: 0.0103s/iter; left time: 97.4193s
	iters: 300, epoch: 4 | loss: 0.1107739
	speed: 0.0103s/iter; left time: 96.3130s
	iters: 400, epoch: 4 | loss: 0.2499674
	speed: 0.0103s/iter; left time: 96.0191s
	iters: 500, epoch: 4 | loss: 0.0918426
	speed: 0.0103s/iter; left time: 94.9645s
Epoch: 4 cost time: 6.194323778152466
Epoch: 4, Steps: 570 | Train Loss: 0.1255826 Vali Loss: 0.0450062 Test Loss: 0.1426192
Validation loss decreased (0.049618 --> 0.045006).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1097186
	speed: 0.0375s/iter; left time: 338.1759s
	iters: 200, epoch: 5 | loss: 0.1317494
	speed: 0.0113s/iter; left time: 100.7827s
	iters: 300, epoch: 5 | loss: 0.1488588
	speed: 0.0113s/iter; left time: 99.7319s
	iters: 400, epoch: 5 | loss: 0.0857320
	speed: 0.0113s/iter; left time: 98.5327s
	iters: 500, epoch: 5 | loss: 0.1473603
	speed: 0.0113s/iter; left time: 97.3864s
Epoch: 5 cost time: 6.745983839035034
Epoch: 5, Steps: 570 | Train Loss: 0.1054959 Vali Loss: 0.0452785 Test Loss: 0.1415697
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0955923
	speed: 0.0371s/iter; left time: 313.5378s
	iters: 200, epoch: 6 | loss: 0.0796199
	speed: 0.0102s/iter; left time: 85.5339s
	iters: 300, epoch: 6 | loss: 0.0931741
	speed: 0.0102s/iter; left time: 84.5007s
	iters: 400, epoch: 6 | loss: 0.0931934
	speed: 0.0102s/iter; left time: 83.4679s
	iters: 500, epoch: 6 | loss: 0.1077420
	speed: 0.0102s/iter; left time: 82.3767s
Epoch: 6 cost time: 6.143591403961182
Epoch: 6, Steps: 570 | Train Loss: 0.0928161 Vali Loss: 0.0452328 Test Loss: 0.1478300
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0777740
	speed: 0.0363s/iter; left time: 286.0977s
	iters: 200, epoch: 7 | loss: 0.0906318
	speed: 0.0102s/iter; left time: 79.4876s
	iters: 300, epoch: 7 | loss: 0.0649016
	speed: 0.0102s/iter; left time: 78.4390s
	iters: 400, epoch: 7 | loss: 0.0970137
	speed: 0.0102s/iter; left time: 77.4313s
	iters: 500, epoch: 7 | loss: 0.0612615
	speed: 0.0102s/iter; left time: 76.3589s
Epoch: 7 cost time: 6.1871562004089355
Epoch: 7, Steps: 570 | Train Loss: 0.0846187 Vali Loss: 0.0453729 Test Loss: 0.1449361
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1428108662366867, mae:0.2442036122083664
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1978606
	speed: 0.0252s/iter; left time: 284.5164s
	iters: 200, epoch: 1 | loss: 0.1406488
	speed: 0.0137s/iter; left time: 153.8186s
	iters: 300, epoch: 1 | loss: 0.2377709
	speed: 0.0137s/iter; left time: 152.1388s
	iters: 400, epoch: 1 | loss: 0.1688309
	speed: 0.0137s/iter; left time: 150.9829s
	iters: 500, epoch: 1 | loss: 0.1429378
	speed: 0.0137s/iter; left time: 149.6757s
Epoch: 1 cost time: 9.015490531921387
Epoch: 1, Steps: 570 | Train Loss: 0.1824579 Vali Loss: 0.0461201 Test Loss: 0.1406951
Validation loss decreased (inf --> 0.046120).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1808321
	speed: 0.0451s/iter; left time: 484.4288s
	iters: 200, epoch: 2 | loss: 0.1237853
	speed: 0.0138s/iter; left time: 146.7176s
	iters: 300, epoch: 2 | loss: 0.1161452
	speed: 0.0138s/iter; left time: 145.3968s
	iters: 400, epoch: 2 | loss: 0.0831951
	speed: 0.0138s/iter; left time: 144.0438s
	iters: 500, epoch: 2 | loss: 0.1708268
	speed: 0.0138s/iter; left time: 142.7003s
Epoch: 2 cost time: 8.162977933883667
Epoch: 2, Steps: 570 | Train Loss: 0.1403602 Vali Loss: 0.0479635 Test Loss: 0.1585671
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1754857
	speed: 0.0469s/iter; left time: 476.3062s
	iters: 200, epoch: 3 | loss: 0.0950794
	speed: 0.0155s/iter; left time: 155.6985s
	iters: 300, epoch: 3 | loss: 0.0790503
	speed: 0.0155s/iter; left time: 154.1198s
	iters: 400, epoch: 3 | loss: 0.0907891
	speed: 0.0155s/iter; left time: 152.6054s
	iters: 500, epoch: 3 | loss: 0.0887034
	speed: 0.0155s/iter; left time: 151.0641s
Epoch: 3 cost time: 9.13390302658081
Epoch: 3, Steps: 570 | Train Loss: 0.1063732 Vali Loss: 0.0409150 Test Loss: 0.1384491
Validation loss decreased (0.046120 --> 0.040915).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0839169
	speed: 0.0476s/iter; left time: 456.0979s
	iters: 200, epoch: 4 | loss: 0.0629344
	speed: 0.0139s/iter; left time: 131.6066s
	iters: 300, epoch: 4 | loss: 0.0953755
	speed: 0.0138s/iter; left time: 129.9858s
	iters: 400, epoch: 4 | loss: 0.0753769
	speed: 0.0139s/iter; left time: 128.7796s
	iters: 500, epoch: 4 | loss: 0.0546866
	speed: 0.0139s/iter; left time: 127.3964s
Epoch: 4 cost time: 8.168796062469482
Epoch: 4, Steps: 570 | Train Loss: 0.0716987 Vali Loss: 0.0403713 Test Loss: 0.1423966
Validation loss decreased (0.040915 --> 0.040371).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0682062
	speed: 0.0474s/iter; left time: 427.8376s
	iters: 200, epoch: 5 | loss: 0.0543592
	speed: 0.0150s/iter; left time: 133.6711s
	iters: 300, epoch: 5 | loss: 0.0492750
	speed: 0.0138s/iter; left time: 122.1231s
	iters: 400, epoch: 5 | loss: 0.0439108
	speed: 0.0138s/iter; left time: 120.2250s
	iters: 500, epoch: 5 | loss: 0.0325127
	speed: 0.0138s/iter; left time: 118.9963s
Epoch: 5 cost time: 8.467384576797485
Epoch: 5, Steps: 570 | Train Loss: 0.0540604 Vali Loss: 0.0405654 Test Loss: 0.1445131
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0450938
	speed: 0.0468s/iter; left time: 395.5412s
	iters: 200, epoch: 6 | loss: 0.0751078
	speed: 0.0138s/iter; left time: 115.1195s
	iters: 300, epoch: 6 | loss: 0.0407169
	speed: 0.0138s/iter; left time: 113.9771s
	iters: 400, epoch: 6 | loss: 0.0473953
	speed: 0.0137s/iter; left time: 112.0704s
	iters: 500, epoch: 6 | loss: 0.0438990
	speed: 0.0138s/iter; left time: 110.7789s
Epoch: 6 cost time: 8.157188177108765
Epoch: 6, Steps: 570 | Train Loss: 0.0449369 Vali Loss: 0.0414444 Test Loss: 0.1482243
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0427545
	speed: 0.0441s/iter; left time: 347.6286s
	iters: 200, epoch: 7 | loss: 0.0429754
	speed: 0.0137s/iter; left time: 106.7805s
	iters: 300, epoch: 7 | loss: 0.0315846
	speed: 0.0137s/iter; left time: 105.4841s
	iters: 400, epoch: 7 | loss: 0.0442837
	speed: 0.0137s/iter; left time: 104.2180s
	iters: 500, epoch: 7 | loss: 0.0533348
	speed: 0.0137s/iter; left time: 102.7178s
Epoch: 7 cost time: 8.095173835754395
Epoch: 7, Steps: 570 | Train Loss: 0.0403531 Vali Loss: 0.0424153 Test Loss: 0.1492263
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1425885260105133, mae:0.24156534671783447
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2268765
	speed: 0.0266s/iter; left time: 300.4014s
	iters: 200, epoch: 1 | loss: 0.1184546
	speed: 0.0136s/iter; left time: 152.7133s
	iters: 300, epoch: 1 | loss: 0.1239855
	speed: 0.0136s/iter; left time: 150.9392s
	iters: 400, epoch: 1 | loss: 0.1680717
	speed: 0.0136s/iter; left time: 149.7068s
	iters: 500, epoch: 1 | loss: 0.1292608
	speed: 0.0137s/iter; left time: 148.8004s
Epoch: 1 cost time: 9.116556882858276
Epoch: 1, Steps: 570 | Train Loss: 0.1520934 Vali Loss: 0.0372690 Test Loss: 0.1163540
Validation loss decreased (inf --> 0.037269).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0825776
	speed: 0.0445s/iter; left time: 477.7519s
	iters: 200, epoch: 2 | loss: 0.2555671
	speed: 0.0135s/iter; left time: 143.3585s
	iters: 300, epoch: 2 | loss: 0.1489368
	speed: 0.0135s/iter; left time: 141.7336s
	iters: 400, epoch: 2 | loss: 0.0923580
	speed: 0.0135s/iter; left time: 140.5407s
	iters: 500, epoch: 2 | loss: 0.0957127
	speed: 0.0135s/iter; left time: 139.0985s
Epoch: 2 cost time: 7.99338960647583
Epoch: 2, Steps: 570 | Train Loss: 0.1173969 Vali Loss: 0.0392548 Test Loss: 0.1194504
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1095200
	speed: 0.0452s/iter; left time: 458.9152s
	iters: 200, epoch: 3 | loss: 0.0508968
	speed: 0.0134s/iter; left time: 134.9168s
	iters: 300, epoch: 3 | loss: 0.0897601
	speed: 0.0135s/iter; left time: 134.5506s
	iters: 400, epoch: 3 | loss: 0.0699842
	speed: 0.0135s/iter; left time: 133.4063s
	iters: 500, epoch: 3 | loss: 0.0651250
	speed: 0.0135s/iter; left time: 132.0639s
Epoch: 3 cost time: 8.0017991065979
Epoch: 3, Steps: 570 | Train Loss: 0.0834549 Vali Loss: 0.0350599 Test Loss: 0.1154133
Validation loss decreased (0.037269 --> 0.035060).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0440067
	speed: 0.0448s/iter; left time: 430.0453s
	iters: 200, epoch: 4 | loss: 0.0632474
	speed: 0.0135s/iter; left time: 128.2031s
	iters: 300, epoch: 4 | loss: 0.0656902
	speed: 0.0135s/iter; left time: 127.0534s
	iters: 400, epoch: 4 | loss: 0.0422224
	speed: 0.0135s/iter; left time: 125.5288s
	iters: 500, epoch: 4 | loss: 0.0366644
	speed: 0.0135s/iter; left time: 124.0117s
Epoch: 4 cost time: 8.020142555236816
Epoch: 4, Steps: 570 | Train Loss: 0.0564874 Vali Loss: 0.0340818 Test Loss: 0.1165414
Validation loss decreased (0.035060 --> 0.034082).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0329393
	speed: 0.0483s/iter; left time: 435.7397s
	iters: 200, epoch: 5 | loss: 0.0378728
	speed: 0.0135s/iter; left time: 120.5428s
	iters: 300, epoch: 5 | loss: 0.0312857
	speed: 0.0135s/iter; left time: 119.0727s
	iters: 400, epoch: 5 | loss: 0.0266005
	speed: 0.0135s/iter; left time: 117.9157s
	iters: 500, epoch: 5 | loss: 0.0470453
	speed: 0.0135s/iter; left time: 116.5017s
Epoch: 5 cost time: 7.997188568115234
Epoch: 5, Steps: 570 | Train Loss: 0.0417427 Vali Loss: 0.0357250 Test Loss: 0.1175037
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0335595
	speed: 0.0451s/iter; left time: 380.8601s
	iters: 200, epoch: 6 | loss: 0.0529354
	speed: 0.0135s/iter; left time: 112.8326s
	iters: 300, epoch: 6 | loss: 0.0342036
	speed: 0.0135s/iter; left time: 111.0444s
	iters: 400, epoch: 6 | loss: 0.0658579
	speed: 0.0135s/iter; left time: 109.8630s
	iters: 500, epoch: 6 | loss: 0.0367821
	speed: 0.0135s/iter; left time: 108.4982s
Epoch: 6 cost time: 7.98458194732666
Epoch: 6, Steps: 570 | Train Loss: 0.0348177 Vali Loss: 0.0363659 Test Loss: 0.1205297
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0248893
	speed: 0.0475s/iter; left time: 374.5458s
	iters: 200, epoch: 7 | loss: 0.0280079
	speed: 0.0143s/iter; left time: 111.4508s
	iters: 300, epoch: 7 | loss: 0.0273204
	speed: 0.0136s/iter; left time: 104.3841s
	iters: 400, epoch: 7 | loss: 0.0482202
	speed: 0.0136s/iter; left time: 102.9567s
	iters: 500, epoch: 7 | loss: 0.0353472
	speed: 0.0136s/iter; left time: 101.3804s
Epoch: 7 cost time: 8.264543294906616
Epoch: 7, Steps: 570 | Train Loss: 0.0313630 Vali Loss: 0.0362975 Test Loss: 0.1222203
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11669544130563736, mae:0.2160900980234146
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1069971
	speed: 0.0271s/iter; left time: 306.0480s
	iters: 200, epoch: 1 | loss: 0.2587161
	speed: 0.0151s/iter; left time: 169.3594s
	iters: 300, epoch: 1 | loss: 0.2063680
	speed: 0.0151s/iter; left time: 167.2523s
	iters: 400, epoch: 1 | loss: 0.2087482
	speed: 0.0151s/iter; left time: 165.9465s
	iters: 500, epoch: 1 | loss: 0.2114511
	speed: 0.0152s/iter; left time: 165.1563s
Epoch: 1 cost time: 9.867110252380371
Epoch: 1, Steps: 570 | Train Loss: 0.1899124 Vali Loss: 0.0503171 Test Loss: 0.1435419
Validation loss decreased (inf --> 0.050317).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1118510
	speed: 0.0479s/iter; left time: 514.0981s
	iters: 200, epoch: 2 | loss: 0.1333888
	speed: 0.0135s/iter; left time: 143.2243s
	iters: 300, epoch: 2 | loss: 0.0712786
	speed: 0.0135s/iter; left time: 142.0308s
	iters: 400, epoch: 2 | loss: 0.0988185
	speed: 0.0135s/iter; left time: 140.3518s
	iters: 500, epoch: 2 | loss: 0.1156343
	speed: 0.0135s/iter; left time: 139.0606s
Epoch: 2 cost time: 7.990076303482056
Epoch: 2, Steps: 570 | Train Loss: 0.1346016 Vali Loss: 0.0433708 Test Loss: 0.1410017
Validation loss decreased (0.050317 --> 0.043371).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0975002
	speed: 0.0444s/iter; left time: 451.4016s
	iters: 200, epoch: 3 | loss: 0.1073149
	speed: 0.0135s/iter; left time: 135.7469s
	iters: 300, epoch: 3 | loss: 0.0861029
	speed: 0.0135s/iter; left time: 134.0896s
	iters: 400, epoch: 3 | loss: 0.0734350
	speed: 0.0135s/iter; left time: 132.6987s
	iters: 500, epoch: 3 | loss: 0.0743892
	speed: 0.0135s/iter; left time: 131.9272s
Epoch: 3 cost time: 7.98084020614624
Epoch: 3, Steps: 570 | Train Loss: 0.0793540 Vali Loss: 0.0424974 Test Loss: 0.1376587
Validation loss decreased (0.043371 --> 0.042497).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0444206
	speed: 0.0444s/iter; left time: 426.0962s
	iters: 200, epoch: 4 | loss: 0.0393224
	speed: 0.0138s/iter; left time: 131.2382s
	iters: 300, epoch: 4 | loss: 0.0441419
	speed: 0.0135s/iter; left time: 126.5927s
	iters: 400, epoch: 4 | loss: 0.0433377
	speed: 0.0134s/iter; left time: 124.5695s
	iters: 500, epoch: 4 | loss: 0.0273443
	speed: 0.0134s/iter; left time: 123.0173s
Epoch: 4 cost time: 7.9930644035339355
Epoch: 4, Steps: 570 | Train Loss: 0.0454741 Vali Loss: 0.0429966 Test Loss: 0.1436175
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0456207
	speed: 0.0438s/iter; left time: 395.3243s
	iters: 200, epoch: 5 | loss: 0.0484772
	speed: 0.0134s/iter; left time: 119.6799s
	iters: 300, epoch: 5 | loss: 0.0314100
	speed: 0.0134s/iter; left time: 118.3707s
	iters: 400, epoch: 5 | loss: 0.0519954
	speed: 0.0134s/iter; left time: 116.8141s
	iters: 500, epoch: 5 | loss: 0.0293121
	speed: 0.0134s/iter; left time: 115.7003s
Epoch: 5 cost time: 7.9003684520721436
Epoch: 5, Steps: 570 | Train Loss: 0.0318291 Vali Loss: 0.0437204 Test Loss: 0.1449698
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0287018
	speed: 0.0451s/iter; left time: 381.4086s
	iters: 200, epoch: 6 | loss: 0.0228253
	speed: 0.0135s/iter; left time: 112.3586s
	iters: 300, epoch: 6 | loss: 0.0222545
	speed: 0.0134s/iter; left time: 110.6221s
	iters: 400, epoch: 6 | loss: 0.0427278
	speed: 0.0134s/iter; left time: 109.4231s
	iters: 500, epoch: 6 | loss: 0.0231968
	speed: 0.0134s/iter; left time: 107.9060s
Epoch: 6 cost time: 7.933849811553955
Epoch: 6, Steps: 570 | Train Loss: 0.0262436 Vali Loss: 0.0438920 Test Loss: 0.1476728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13781242072582245, mae:0.24142491817474365
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1986155
	speed: 0.0284s/iter; left time: 320.6945s
	iters: 200, epoch: 1 | loss: 0.1691805
	speed: 0.0164s/iter; left time: 183.6541s
	iters: 300, epoch: 1 | loss: 0.2655474
	speed: 0.0164s/iter; left time: 181.8990s
	iters: 400, epoch: 1 | loss: 0.1940346
	speed: 0.0164s/iter; left time: 180.4830s
	iters: 500, epoch: 1 | loss: 0.1390540
	speed: 0.0164s/iter; left time: 178.9719s
Epoch: 1 cost time: 10.597198247909546
Epoch: 1, Steps: 570 | Train Loss: 0.1975997 Vali Loss: 0.0505389 Test Loss: 0.1476364
Validation loss decreased (inf --> 0.050539).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2220080
	speed: 0.0504s/iter; left time: 540.7710s
	iters: 200, epoch: 2 | loss: 0.2834747
	speed: 0.0163s/iter; left time: 173.7810s
	iters: 300, epoch: 2 | loss: 0.3231107
	speed: 0.0163s/iter; left time: 172.1140s
	iters: 400, epoch: 2 | loss: 0.2974539
	speed: 0.0164s/iter; left time: 170.6724s
	iters: 500, epoch: 2 | loss: 0.2700153
	speed: 0.0163s/iter; left time: 168.8354s
Epoch: 2 cost time: 9.643572568893433
Epoch: 2, Steps: 570 | Train Loss: 0.2516783 Vali Loss: 0.0667279 Test Loss: 0.1820506
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1836330
	speed: 0.0515s/iter; left time: 522.9636s
	iters: 200, epoch: 3 | loss: 0.2148254
	speed: 0.0163s/iter; left time: 164.4332s
	iters: 300, epoch: 3 | loss: 0.3247426
	speed: 0.0164s/iter; left time: 162.9853s
	iters: 400, epoch: 3 | loss: 0.1836453
	speed: 0.0163s/iter; left time: 161.0802s
	iters: 500, epoch: 3 | loss: 0.1678694
	speed: 0.0163s/iter; left time: 159.5793s
Epoch: 3 cost time: 9.654511213302612
Epoch: 3, Steps: 570 | Train Loss: 0.2291430 Vali Loss: 0.0621862 Test Loss: 0.1663595
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2186916
	speed: 0.0491s/iter; left time: 471.2547s
	iters: 200, epoch: 4 | loss: 0.1787783
	speed: 0.0166s/iter; left time: 157.2546s
	iters: 300, epoch: 4 | loss: 0.1733173
	speed: 0.0178s/iter; left time: 166.7911s
	iters: 400, epoch: 4 | loss: 0.1957897
	speed: 0.0178s/iter; left time: 164.9873s
	iters: 500, epoch: 4 | loss: 0.1448365
	speed: 0.0165s/iter; left time: 151.7243s
Epoch: 4 cost time: 9.913108587265015
Epoch: 4, Steps: 570 | Train Loss: 0.1949281 Vali Loss: 0.0626483 Test Loss: 0.1643371
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14789031445980072, mae:0.24401988089084625
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1967783
	speed: 0.0292s/iter; left time: 330.4450s
	iters: 200, epoch: 1 | loss: 0.0812769
	speed: 0.0173s/iter; left time: 193.2694s
	iters: 300, epoch: 1 | loss: 0.2097766
	speed: 0.0172s/iter; left time: 191.2928s
	iters: 400, epoch: 1 | loss: 0.1258427
	speed: 0.0173s/iter; left time: 190.1571s
	iters: 500, epoch: 1 | loss: 0.0920935
	speed: 0.0173s/iter; left time: 188.0967s
Epoch: 1 cost time: 11.086338758468628
Epoch: 1, Steps: 570 | Train Loss: 0.1694094 Vali Loss: 0.0414194 Test Loss: 0.1318534
Validation loss decreased (inf --> 0.041419).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1300433
	speed: 0.0550s/iter; left time: 589.6944s
	iters: 200, epoch: 2 | loss: 0.1766018
	speed: 0.0173s/iter; left time: 184.0545s
	iters: 300, epoch: 2 | loss: 0.1776148
	speed: 0.0173s/iter; left time: 182.0856s
	iters: 400, epoch: 2 | loss: 0.6121952
	speed: 0.0173s/iter; left time: 180.0713s
	iters: 500, epoch: 2 | loss: 0.2668276
	speed: 0.0173s/iter; left time: 178.4023s
Epoch: 2 cost time: 10.202077627182007
Epoch: 2, Steps: 570 | Train Loss: 0.2193054 Vali Loss: 0.0827282 Test Loss: 0.2201046
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2272870
	speed: 0.0509s/iter; left time: 517.4685s
	iters: 200, epoch: 3 | loss: 0.2946670
	speed: 0.0172s/iter; left time: 173.5090s
	iters: 300, epoch: 3 | loss: 0.1645177
	speed: 0.0172s/iter; left time: 171.4346s
	iters: 400, epoch: 3 | loss: 0.2846656
	speed: 0.0172s/iter; left time: 169.6711s
	iters: 500, epoch: 3 | loss: 0.1483205
	speed: 0.0172s/iter; left time: 168.0480s
Epoch: 3 cost time: 10.095296144485474
Epoch: 3, Steps: 570 | Train Loss: 0.2507399 Vali Loss: 0.0618857 Test Loss: 0.1737114
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1715246
	speed: 0.0496s/iter; left time: 476.1442s
	iters: 200, epoch: 4 | loss: 0.3059893
	speed: 0.0158s/iter; left time: 149.9786s
	iters: 300, epoch: 4 | loss: 0.2712645
	speed: 0.0158s/iter; left time: 148.2795s
	iters: 400, epoch: 4 | loss: 0.1277343
	speed: 0.0158s/iter; left time: 146.6325s
	iters: 500, epoch: 4 | loss: 0.2868744
	speed: 0.0158s/iter; left time: 144.9743s
Epoch: 4 cost time: 9.31934142112732
Epoch: 4, Steps: 570 | Train Loss: 0.2091032 Vali Loss: 0.0661804 Test Loss: 0.1758471
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1320623755455017, mae:0.23152689635753632
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1846964
	speed: 0.0264s/iter; left time: 297.9309s
	iters: 200, epoch: 1 | loss: 0.1534819
	speed: 0.0146s/iter; left time: 163.2188s
	iters: 300, epoch: 1 | loss: 0.1390241
	speed: 0.0146s/iter; left time: 161.5374s
	iters: 400, epoch: 1 | loss: 0.1953725
	speed: 0.0146s/iter; left time: 160.5391s
	iters: 500, epoch: 1 | loss: 0.3213199
	speed: 0.0146s/iter; left time: 159.0320s
Epoch: 1 cost time: 9.53222370147705
Epoch: 1, Steps: 570 | Train Loss: 0.2022955 Vali Loss: 0.0596252 Test Loss: 0.1810754
Validation loss decreased (inf --> 0.059625).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3014162
	speed: 0.0473s/iter; left time: 507.8568s
	iters: 200, epoch: 2 | loss: 0.1825785
	speed: 0.0146s/iter; left time: 155.4732s
	iters: 300, epoch: 2 | loss: 0.2656878
	speed: 0.0146s/iter; left time: 153.6460s
	iters: 400, epoch: 2 | loss: 0.2396755
	speed: 0.0146s/iter; left time: 152.2644s
	iters: 500, epoch: 2 | loss: 0.3102220
	speed: 0.0146s/iter; left time: 150.4895s
Epoch: 2 cost time: 8.654357433319092
Epoch: 2, Steps: 570 | Train Loss: 0.2341447 Vali Loss: 0.0562900 Test Loss: 0.1692586
Validation loss decreased (0.059625 --> 0.056290).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2520309
	speed: 0.0467s/iter; left time: 474.8179s
	iters: 200, epoch: 3 | loss: 0.1126558
	speed: 0.0146s/iter; left time: 146.9254s
	iters: 300, epoch: 3 | loss: 0.2455842
	speed: 0.0146s/iter; left time: 145.3135s
	iters: 400, epoch: 3 | loss: 0.1633121
	speed: 0.0146s/iter; left time: 144.0681s
	iters: 500, epoch: 3 | loss: 0.1875406
	speed: 0.0146s/iter; left time: 142.4853s
Epoch: 3 cost time: 8.60222315788269
Epoch: 3, Steps: 570 | Train Loss: 0.1976280 Vali Loss: 0.0501224 Test Loss: 0.1469226
Validation loss decreased (0.056290 --> 0.050122).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1423798
	speed: 0.0484s/iter; left time: 464.3953s
	iters: 200, epoch: 4 | loss: 0.1833380
	speed: 0.0146s/iter; left time: 138.7320s
	iters: 300, epoch: 4 | loss: 0.1767692
	speed: 0.0146s/iter; left time: 137.3469s
	iters: 400, epoch: 4 | loss: 0.1392000
	speed: 0.0146s/iter; left time: 135.8123s
	iters: 500, epoch: 4 | loss: 0.1467425
	speed: 0.0146s/iter; left time: 134.2155s
Epoch: 4 cost time: 8.607679843902588
Epoch: 4, Steps: 570 | Train Loss: 0.1538924 Vali Loss: 0.0479066 Test Loss: 0.1444010
Validation loss decreased (0.050122 --> 0.047907).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0917977
	speed: 0.0480s/iter; left time: 433.4023s
	iters: 200, epoch: 5 | loss: 0.1277048
	speed: 0.0145s/iter; left time: 129.7752s
	iters: 300, epoch: 5 | loss: 0.1231754
	speed: 0.0146s/iter; left time: 128.4556s
	iters: 400, epoch: 5 | loss: 0.0834559
	speed: 0.0146s/iter; left time: 126.9163s
	iters: 500, epoch: 5 | loss: 0.1487637
	speed: 0.0146s/iter; left time: 125.4476s
Epoch: 5 cost time: 8.576813220977783
Epoch: 5, Steps: 570 | Train Loss: 0.1337128 Vali Loss: 0.0466142 Test Loss: 0.1435483
Validation loss decreased (0.047907 --> 0.046614).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1269798
	speed: 0.0461s/iter; left time: 389.7284s
	iters: 200, epoch: 6 | loss: 0.1186455
	speed: 0.0145s/iter; left time: 121.1454s
	iters: 300, epoch: 6 | loss: 0.0984075
	speed: 0.0145s/iter; left time: 119.6655s
	iters: 400, epoch: 6 | loss: 0.0881625
	speed: 0.0145s/iter; left time: 118.2629s
	iters: 500, epoch: 6 | loss: 0.1166409
	speed: 0.0145s/iter; left time: 116.8277s
Epoch: 6 cost time: 8.550525665283203
Epoch: 6, Steps: 570 | Train Loss: 0.1221631 Vali Loss: 0.0458232 Test Loss: 0.1406332
Validation loss decreased (0.046614 --> 0.045823).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1413343
	speed: 0.0476s/iter; left time: 374.9272s
	iters: 200, epoch: 7 | loss: 0.0839411
	speed: 0.0146s/iter; left time: 113.2287s
	iters: 300, epoch: 7 | loss: 0.1261159
	speed: 0.0146s/iter; left time: 111.9662s
	iters: 400, epoch: 7 | loss: 0.0824899
	speed: 0.0146s/iter; left time: 110.4479s
	iters: 500, epoch: 7 | loss: 0.1464380
	speed: 0.0146s/iter; left time: 108.9528s
Epoch: 7 cost time: 8.60797119140625
Epoch: 7, Steps: 570 | Train Loss: 0.1152028 Vali Loss: 0.0455213 Test Loss: 0.1399625
Validation loss decreased (0.045823 --> 0.045521).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0983356
	speed: 0.0469s/iter; left time: 343.0705s
	iters: 200, epoch: 8 | loss: 0.1660734
	speed: 0.0146s/iter; left time: 105.1737s
	iters: 300, epoch: 8 | loss: 0.0982681
	speed: 0.0146s/iter; left time: 103.6796s
	iters: 400, epoch: 8 | loss: 0.1109750
	speed: 0.0146s/iter; left time: 102.2066s
	iters: 500, epoch: 8 | loss: 0.0811666
	speed: 0.0146s/iter; left time: 100.7839s
Epoch: 8 cost time: 8.598613739013672
Epoch: 8, Steps: 570 | Train Loss: 0.1107535 Vali Loss: 0.0446388 Test Loss: 0.1394486
Validation loss decreased (0.045521 --> 0.044639).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0843178
	speed: 0.0466s/iter; left time: 313.9934s
	iters: 200, epoch: 9 | loss: 0.0957296
	speed: 0.0146s/iter; left time: 96.8947s
	iters: 300, epoch: 9 | loss: 0.0958310
	speed: 0.0146s/iter; left time: 95.4071s
	iters: 400, epoch: 9 | loss: 0.0913657
	speed: 0.0146s/iter; left time: 93.9191s
	iters: 500, epoch: 9 | loss: 0.1282018
	speed: 0.0146s/iter; left time: 92.4556s
Epoch: 9 cost time: 8.619352579116821
Epoch: 9, Steps: 570 | Train Loss: 0.1083913 Vali Loss: 0.0448575 Test Loss: 0.1397041
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1445305
	speed: 0.0465s/iter; left time: 287.1902s
	iters: 200, epoch: 10 | loss: 0.1169368
	speed: 0.0146s/iter; left time: 88.4042s
	iters: 300, epoch: 10 | loss: 0.0864425
	speed: 0.0146s/iter; left time: 86.9185s
	iters: 400, epoch: 10 | loss: 0.1313425
	speed: 0.0145s/iter; left time: 85.4152s
	iters: 500, epoch: 10 | loss: 0.1608877
	speed: 0.0145s/iter; left time: 83.9432s
Epoch: 10 cost time: 8.588130235671997
Epoch: 10, Steps: 570 | Train Loss: 0.1071333 Vali Loss: 0.0449487 Test Loss: 0.1401038
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1228852
	speed: 0.0457s/iter; left time: 255.9256s
	iters: 200, epoch: 11 | loss: 0.0852268
	speed: 0.0145s/iter; left time: 80.0296s
	iters: 300, epoch: 11 | loss: 0.0976405
	speed: 0.0145s/iter; left time: 78.5214s
	iters: 400, epoch: 11 | loss: 0.1279954
	speed: 0.0145s/iter; left time: 77.0949s
	iters: 500, epoch: 11 | loss: 0.1509469
	speed: 0.0145s/iter; left time: 75.6197s
Epoch: 11 cost time: 8.567837953567505
Epoch: 11, Steps: 570 | Train Loss: 0.1064138 Vali Loss: 0.0450237 Test Loss: 0.1398980
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13961860537528992, mae:0.2440221607685089
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1424365
	speed: 0.0296s/iter; left time: 334.0397s
	iters: 200, epoch: 1 | loss: 0.1840478
	speed: 0.0175s/iter; left time: 196.0982s
	iters: 300, epoch: 1 | loss: 0.2390462
	speed: 0.0175s/iter; left time: 194.4126s
	iters: 400, epoch: 1 | loss: 0.1257376
	speed: 0.0175s/iter; left time: 192.7160s
	iters: 500, epoch: 1 | loss: 0.1427562
	speed: 0.0175s/iter; left time: 190.4853s
Epoch: 1 cost time: 11.234099864959717
Epoch: 1, Steps: 570 | Train Loss: 0.1878913 Vali Loss: 0.0468647 Test Loss: 0.1412132
Validation loss decreased (inf --> 0.046865).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2610076
	speed: 0.0562s/iter; left time: 602.6827s
	iters: 200, epoch: 2 | loss: 0.1107580
	speed: 0.0176s/iter; left time: 186.8321s
	iters: 300, epoch: 2 | loss: 0.1036385
	speed: 0.0176s/iter; left time: 185.0130s
	iters: 400, epoch: 2 | loss: 0.1070925
	speed: 0.0176s/iter; left time: 183.0846s
	iters: 500, epoch: 2 | loss: 0.1219436
	speed: 0.0176s/iter; left time: 181.3749s
Epoch: 2 cost time: 10.31496787071228
Epoch: 2, Steps: 570 | Train Loss: 0.1391301 Vali Loss: 0.0438123 Test Loss: 0.1367771
Validation loss decreased (0.046865 --> 0.043812).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0830769
	speed: 0.0560s/iter; left time: 568.7082s
	iters: 200, epoch: 3 | loss: 0.0651449
	speed: 0.0174s/iter; left time: 174.7894s
	iters: 300, epoch: 3 | loss: 0.0848362
	speed: 0.0173s/iter; left time: 172.6054s
	iters: 400, epoch: 3 | loss: 0.0720099
	speed: 0.0173s/iter; left time: 170.8772s
	iters: 500, epoch: 3 | loss: 0.0553302
	speed: 0.0174s/iter; left time: 169.6702s
Epoch: 3 cost time: 10.217609167098999
Epoch: 3, Steps: 570 | Train Loss: 0.0927919 Vali Loss: 0.0406958 Test Loss: 0.1434521
Validation loss decreased (0.043812 --> 0.040696).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0647112
	speed: 0.0569s/iter; left time: 546.1732s
	iters: 200, epoch: 4 | loss: 0.0716239
	speed: 0.0175s/iter; left time: 166.2836s
	iters: 300, epoch: 4 | loss: 0.0661048
	speed: 0.0175s/iter; left time: 164.6064s
	iters: 400, epoch: 4 | loss: 0.0359052
	speed: 0.0175s/iter; left time: 163.0471s
	iters: 500, epoch: 4 | loss: 0.0596870
	speed: 0.0175s/iter; left time: 161.0673s
Epoch: 4 cost time: 10.272650480270386
Epoch: 4, Steps: 570 | Train Loss: 0.0583398 Vali Loss: 0.0424002 Test Loss: 0.1405669
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0493537
	speed: 0.0566s/iter; left time: 510.2105s
	iters: 200, epoch: 5 | loss: 0.0440921
	speed: 0.0175s/iter; left time: 156.4399s
	iters: 300, epoch: 5 | loss: 0.0384487
	speed: 0.0175s/iter; left time: 154.1832s
	iters: 400, epoch: 5 | loss: 0.0319154
	speed: 0.0175s/iter; left time: 152.5485s
	iters: 500, epoch: 5 | loss: 0.0568911
	speed: 0.0175s/iter; left time: 150.8815s
Epoch: 5 cost time: 10.264096021652222
Epoch: 5, Steps: 570 | Train Loss: 0.0422725 Vali Loss: 0.0417912 Test Loss: 0.1395553
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0277847
	speed: 0.0563s/iter; left time: 475.5051s
	iters: 200, epoch: 6 | loss: 0.0349614
	speed: 0.0210s/iter; left time: 175.3171s
	iters: 300, epoch: 6 | loss: 0.0368796
	speed: 0.0175s/iter; left time: 144.5615s
	iters: 400, epoch: 6 | loss: 0.0483236
	speed: 0.0175s/iter; left time: 142.8929s
	iters: 500, epoch: 6 | loss: 0.0325147
	speed: 0.0175s/iter; left time: 141.2039s
Epoch: 6 cost time: 10.864749193191528
Epoch: 6, Steps: 570 | Train Loss: 0.0343979 Vali Loss: 0.0434447 Test Loss: 0.1454348
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14360164105892181, mae:0.24396653473377228
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3013273
	speed: 0.0291s/iter; left time: 328.9242s
	iters: 200, epoch: 1 | loss: 0.1627599
	speed: 0.0173s/iter; left time: 193.8114s
	iters: 300, epoch: 1 | loss: 0.1636733
	speed: 0.0173s/iter; left time: 191.7704s
	iters: 400, epoch: 1 | loss: 0.1275357
	speed: 0.0172s/iter; left time: 189.5011s
	iters: 500, epoch: 1 | loss: 0.1798341
	speed: 0.0172s/iter; left time: 187.6757s
Epoch: 1 cost time: 11.068463802337646
Epoch: 1, Steps: 570 | Train Loss: 0.1556122 Vali Loss: 0.0425841 Test Loss: 0.1366059
Validation loss decreased (inf --> 0.042584).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1080536
	speed: 0.0568s/iter; left time: 609.4106s
	iters: 200, epoch: 2 | loss: 0.1725593
	speed: 0.0174s/iter; left time: 185.0891s
	iters: 300, epoch: 2 | loss: 0.1873654
	speed: 0.0174s/iter; left time: 183.3103s
	iters: 400, epoch: 2 | loss: 0.1795883
	speed: 0.0174s/iter; left time: 181.4925s
	iters: 500, epoch: 2 | loss: 0.1130972
	speed: 0.0172s/iter; left time: 178.0487s
Epoch: 2 cost time: 10.214637994766235
Epoch: 2, Steps: 570 | Train Loss: 0.1257417 Vali Loss: 0.0436001 Test Loss: 0.1318278
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0872726
	speed: 0.0525s/iter; left time: 533.0209s
	iters: 200, epoch: 3 | loss: 0.0909489
	speed: 0.0172s/iter; left time: 172.9166s
	iters: 300, epoch: 3 | loss: 0.1098259
	speed: 0.0172s/iter; left time: 171.4080s
	iters: 400, epoch: 3 | loss: 0.0617533
	speed: 0.0172s/iter; left time: 169.2316s
	iters: 500, epoch: 3 | loss: 0.0701032
	speed: 0.0172s/iter; left time: 168.0404s
Epoch: 3 cost time: 10.081186056137085
Epoch: 3, Steps: 570 | Train Loss: 0.0934521 Vali Loss: 0.0351826 Test Loss: 0.1203531
Validation loss decreased (0.042584 --> 0.035183).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0649448
	speed: 0.0537s/iter; left time: 515.4898s
	iters: 200, epoch: 4 | loss: 0.0549003
	speed: 0.0172s/iter; left time: 163.5482s
	iters: 300, epoch: 4 | loss: 0.0712037
	speed: 0.0172s/iter; left time: 161.9404s
	iters: 400, epoch: 4 | loss: 0.0707857
	speed: 0.0172s/iter; left time: 159.9485s
	iters: 500, epoch: 4 | loss: 0.0471515
	speed: 0.0172s/iter; left time: 158.3487s
Epoch: 4 cost time: 10.118118286132812
Epoch: 4, Steps: 570 | Train Loss: 0.0624750 Vali Loss: 0.0335348 Test Loss: 0.1206524
Validation loss decreased (0.035183 --> 0.033535).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0518756
	speed: 0.0540s/iter; left time: 487.3786s
	iters: 200, epoch: 5 | loss: 0.0462244
	speed: 0.0173s/iter; left time: 153.9782s
	iters: 300, epoch: 5 | loss: 0.0481729
	speed: 0.0172s/iter; left time: 152.1555s
	iters: 400, epoch: 5 | loss: 0.0416372
	speed: 0.0172s/iter; left time: 150.3791s
	iters: 500, epoch: 5 | loss: 0.0582077
	speed: 0.0172s/iter; left time: 148.5392s
Epoch: 5 cost time: 10.142864465713501
Epoch: 5, Steps: 570 | Train Loss: 0.0454446 Vali Loss: 0.0346301 Test Loss: 0.1202264
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0512787
	speed: 0.0565s/iter; left time: 477.6111s
	iters: 200, epoch: 6 | loss: 0.0321706
	speed: 0.0193s/iter; left time: 161.1671s
	iters: 300, epoch: 6 | loss: 0.0402475
	speed: 0.0182s/iter; left time: 150.0400s
	iters: 400, epoch: 6 | loss: 0.0389622
	speed: 0.0173s/iter; left time: 140.7214s
	iters: 500, epoch: 6 | loss: 0.0262756
	speed: 0.0173s/iter; left time: 139.0547s
Epoch: 6 cost time: 10.614771842956543
Epoch: 6, Steps: 570 | Train Loss: 0.0372056 Vali Loss: 0.0347524 Test Loss: 0.1218830
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0415928
	speed: 0.0534s/iter; left time: 420.8277s
	iters: 200, epoch: 7 | loss: 0.0410634
	speed: 0.0172s/iter; left time: 134.0206s
	iters: 300, epoch: 7 | loss: 0.0310007
	speed: 0.0172s/iter; left time: 132.2524s
	iters: 400, epoch: 7 | loss: 0.0346273
	speed: 0.0172s/iter; left time: 130.5292s
	iters: 500, epoch: 7 | loss: 0.0262612
	speed: 0.0172s/iter; left time: 128.8181s
Epoch: 7 cost time: 10.124592781066895
Epoch: 7, Steps: 570 | Train Loss: 0.0329937 Vali Loss: 0.0353262 Test Loss: 0.1226116
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12082037329673767, mae:0.21284867823123932
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2177885
	speed: 0.0314s/iter; left time: 354.9021s
	iters: 200, epoch: 1 | loss: 0.1740898
	speed: 0.0193s/iter; left time: 216.6819s
	iters: 300, epoch: 1 | loss: 0.2318988
	speed: 0.0193s/iter; left time: 214.2933s
	iters: 400, epoch: 1 | loss: 0.1778409
	speed: 0.0194s/iter; left time: 213.1538s
	iters: 500, epoch: 1 | loss: 0.2104654
	speed: 0.0193s/iter; left time: 210.8893s
Epoch: 1 cost time: 12.274818181991577
Epoch: 1, Steps: 570 | Train Loss: 0.1894304 Vali Loss: 0.0450520 Test Loss: 0.1393649
Validation loss decreased (inf --> 0.045052).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2218399
	speed: 0.0593s/iter; left time: 636.1939s
	iters: 200, epoch: 2 | loss: 0.2031770
	speed: 0.0194s/iter; left time: 206.7164s
	iters: 300, epoch: 2 | loss: 0.2917352
	speed: 0.0194s/iter; left time: 203.9995s
	iters: 400, epoch: 2 | loss: 0.1115078
	speed: 0.0193s/iter; left time: 201.7982s
	iters: 500, epoch: 2 | loss: 0.0887230
	speed: 0.0193s/iter; left time: 199.8775s
Epoch: 2 cost time: 11.36694049835205
Epoch: 2, Steps: 570 | Train Loss: 0.1400354 Vali Loss: 0.0453597 Test Loss: 0.1389147
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0976101
	speed: 0.0554s/iter; left time: 563.3419s
	iters: 200, epoch: 3 | loss: 0.0790695
	speed: 0.0172s/iter; left time: 173.4214s
	iters: 300, epoch: 3 | loss: 0.0755557
	speed: 0.0172s/iter; left time: 171.5011s
	iters: 400, epoch: 3 | loss: 0.0531154
	speed: 0.0172s/iter; left time: 170.0479s
	iters: 500, epoch: 3 | loss: 0.0669597
	speed: 0.0172s/iter; left time: 168.2180s
Epoch: 3 cost time: 10.140873193740845
Epoch: 3, Steps: 570 | Train Loss: 0.0817688 Vali Loss: 0.0419895 Test Loss: 0.1375994
Validation loss decreased (0.045052 --> 0.041990).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0431753
	speed: 0.0537s/iter; left time: 514.8466s
	iters: 200, epoch: 4 | loss: 0.0574122
	speed: 0.0172s/iter; left time: 163.3992s
	iters: 300, epoch: 4 | loss: 0.0522037
	speed: 0.0171s/iter; left time: 161.0555s
	iters: 400, epoch: 4 | loss: 0.0496517
	speed: 0.0171s/iter; left time: 159.1858s
	iters: 500, epoch: 4 | loss: 0.0428037
	speed: 0.0172s/iter; left time: 158.2593s
Epoch: 4 cost time: 10.105591535568237
Epoch: 4, Steps: 570 | Train Loss: 0.0467967 Vali Loss: 0.0405782 Test Loss: 0.1369759
Validation loss decreased (0.041990 --> 0.040578).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0329710
	speed: 0.0543s/iter; left time: 489.8735s
	iters: 200, epoch: 5 | loss: 0.0373534
	speed: 0.0172s/iter; left time: 153.5074s
	iters: 300, epoch: 5 | loss: 0.0254652
	speed: 0.0172s/iter; left time: 151.7855s
	iters: 400, epoch: 5 | loss: 0.0320666
	speed: 0.0172s/iter; left time: 149.7968s
	iters: 500, epoch: 5 | loss: 0.0248615
	speed: 0.0172s/iter; left time: 147.8571s
Epoch: 5 cost time: 10.10209035873413
Epoch: 5, Steps: 570 | Train Loss: 0.0323576 Vali Loss: 0.0408936 Test Loss: 0.1396430
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0270176
	speed: 0.0553s/iter; left time: 466.9849s
	iters: 200, epoch: 6 | loss: 0.0235493
	speed: 0.0196s/iter; left time: 163.5587s
	iters: 300, epoch: 6 | loss: 0.0301357
	speed: 0.0200s/iter; left time: 165.0559s
	iters: 400, epoch: 6 | loss: 0.0253702
	speed: 0.0200s/iter; left time: 162.9960s
	iters: 500, epoch: 6 | loss: 0.0251508
	speed: 0.0200s/iter; left time: 161.3113s
Epoch: 6 cost time: 11.5802640914917
Epoch: 6, Steps: 570 | Train Loss: 0.0259659 Vali Loss: 0.0409562 Test Loss: 0.1410119
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0220625
	speed: 0.0583s/iter; left time: 459.0770s
	iters: 200, epoch: 7 | loss: 0.0194717
	speed: 0.0200s/iter; left time: 155.7008s
	iters: 300, epoch: 7 | loss: 0.0231270
	speed: 0.0200s/iter; left time: 153.3603s
	iters: 400, epoch: 7 | loss: 0.0367678
	speed: 0.0200s/iter; left time: 151.3739s
	iters: 500, epoch: 7 | loss: 0.0201000
	speed: 0.0200s/iter; left time: 149.3371s
Epoch: 7 cost time: 11.680776357650757
Epoch: 7, Steps: 570 | Train Loss: 0.0229394 Vali Loss: 0.0413790 Test Loss: 0.1412562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13710694015026093, mae:0.2393602728843689
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1982598
	speed: 0.0351s/iter; left time: 397.0552s
	iters: 200, epoch: 1 | loss: 0.1722663
	speed: 0.0231s/iter; left time: 258.5510s
	iters: 300, epoch: 1 | loss: 0.2368596
	speed: 0.0231s/iter; left time: 256.5817s
	iters: 400, epoch: 1 | loss: 0.2784756
	speed: 0.0231s/iter; left time: 254.6179s
	iters: 500, epoch: 1 | loss: 0.2624359
	speed: 0.0231s/iter; left time: 252.2754s
Epoch: 1 cost time: 14.436309814453125
Epoch: 1, Steps: 570 | Train Loss: 0.2215046 Vali Loss: 0.0689446 Test Loss: 0.2047751
Validation loss decreased (inf --> 0.068945).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3135594
	speed: 0.0641s/iter; left time: 687.7538s
	iters: 200, epoch: 2 | loss: 0.2461600
	speed: 0.0213s/iter; left time: 226.8361s
	iters: 300, epoch: 2 | loss: 0.1640294
	speed: 0.0213s/iter; left time: 224.5727s
	iters: 400, epoch: 2 | loss: 0.2334460
	speed: 0.0213s/iter; left time: 222.4586s
	iters: 500, epoch: 2 | loss: 0.1787507
	speed: 0.0213s/iter; left time: 220.2469s
Epoch: 2 cost time: 12.496492147445679
Epoch: 2, Steps: 570 | Train Loss: 0.2409333 Vali Loss: 0.0579337 Test Loss: 0.1650611
Validation loss decreased (0.068945 --> 0.057934).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3445709
	speed: 0.0634s/iter; left time: 643.7861s
	iters: 200, epoch: 3 | loss: 0.1344387
	speed: 0.0214s/iter; left time: 215.4934s
	iters: 300, epoch: 3 | loss: 0.1870665
	speed: 0.0214s/iter; left time: 212.9924s
	iters: 400, epoch: 3 | loss: 0.1502970
	speed: 0.0214s/iter; left time: 210.7641s
	iters: 500, epoch: 3 | loss: 0.1235990
	speed: 0.0214s/iter; left time: 208.4927s
Epoch: 3 cost time: 12.529727220535278
Epoch: 3, Steps: 570 | Train Loss: 0.1725269 Vali Loss: 0.0474227 Test Loss: 0.1467401
Validation loss decreased (0.057934 --> 0.047423).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1178306
	speed: 0.0648s/iter; left time: 621.3064s
	iters: 200, epoch: 4 | loss: 0.1037992
	speed: 0.0214s/iter; left time: 202.7695s
	iters: 300, epoch: 4 | loss: 0.1877244
	speed: 0.0213s/iter; left time: 200.4343s
	iters: 400, epoch: 4 | loss: 0.1446683
	speed: 0.0213s/iter; left time: 198.0124s
	iters: 500, epoch: 4 | loss: 0.1847490
	speed: 0.0213s/iter; left time: 195.9914s
Epoch: 4 cost time: 12.534107208251953
Epoch: 4, Steps: 570 | Train Loss: 0.1489754 Vali Loss: 0.0459652 Test Loss: 0.1424586
Validation loss decreased (0.047423 --> 0.045965).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1684721
	speed: 0.0672s/iter; left time: 606.3727s
	iters: 200, epoch: 5 | loss: 0.2174387
	speed: 0.0214s/iter; left time: 190.5443s
	iters: 300, epoch: 5 | loss: 0.1022878
	speed: 0.0219s/iter; left time: 193.1059s
	iters: 400, epoch: 5 | loss: 0.1460482
	speed: 0.0231s/iter; left time: 201.4535s
	iters: 500, epoch: 5 | loss: 0.1213383
	speed: 0.0231s/iter; left time: 199.1193s
Epoch: 5 cost time: 13.19725251197815
Epoch: 5, Steps: 570 | Train Loss: 0.1338308 Vali Loss: 0.0453069 Test Loss: 0.1409828
Validation loss decreased (0.045965 --> 0.045307).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1173596
	speed: 0.0681s/iter; left time: 575.8399s
	iters: 200, epoch: 6 | loss: 0.1838098
	speed: 0.0220s/iter; left time: 183.3305s
	iters: 300, epoch: 6 | loss: 0.1131455
	speed: 0.0214s/iter; left time: 176.4253s
	iters: 400, epoch: 6 | loss: 0.0865408
	speed: 0.0213s/iter; left time: 173.9709s
	iters: 500, epoch: 6 | loss: 0.1666597
	speed: 0.0213s/iter; left time: 171.7410s
Epoch: 6 cost time: 12.76200532913208
Epoch: 6, Steps: 570 | Train Loss: 0.1246720 Vali Loss: 0.0451699 Test Loss: 0.1443853
Validation loss decreased (0.045307 --> 0.045170).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1408811
	speed: 0.0679s/iter; left time: 535.4304s
	iters: 200, epoch: 7 | loss: 0.1244936
	speed: 0.0222s/iter; left time: 172.4591s
	iters: 300, epoch: 7 | loss: 0.1025622
	speed: 0.0214s/iter; left time: 164.4443s
	iters: 400, epoch: 7 | loss: 0.1524026
	speed: 0.0214s/iter; left time: 162.2732s
	iters: 500, epoch: 7 | loss: 0.1064116
	speed: 0.0214s/iter; left time: 159.9515s
Epoch: 7 cost time: 12.810815572738647
Epoch: 7, Steps: 570 | Train Loss: 0.1183561 Vali Loss: 0.0456586 Test Loss: 0.1454745
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1128823
	speed: 0.0631s/iter; left time: 461.5600s
	iters: 200, epoch: 8 | loss: 0.1403389
	speed: 0.0214s/iter; left time: 154.4493s
	iters: 300, epoch: 8 | loss: 0.0930431
	speed: 0.0214s/iter; left time: 152.0799s
	iters: 400, epoch: 8 | loss: 0.0984493
	speed: 0.0214s/iter; left time: 149.7835s
	iters: 500, epoch: 8 | loss: 0.0983002
	speed: 0.0214s/iter; left time: 147.7480s
Epoch: 8 cost time: 12.589613676071167
Epoch: 8, Steps: 570 | Train Loss: 0.1149548 Vali Loss: 0.0459172 Test Loss: 0.1456573
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1132303
	speed: 0.0640s/iter; left time: 431.1019s
	iters: 200, epoch: 9 | loss: 0.1282349
	speed: 0.0213s/iter; left time: 141.7252s
	iters: 300, epoch: 9 | loss: 0.1326363
	speed: 0.0213s/iter; left time: 139.4704s
	iters: 400, epoch: 9 | loss: 0.0945258
	speed: 0.0213s/iter; left time: 137.3532s
	iters: 500, epoch: 9 | loss: 0.1243167
	speed: 0.0213s/iter; left time: 135.0818s
Epoch: 9 cost time: 12.48659372329712
Epoch: 9, Steps: 570 | Train Loss: 0.1132426 Vali Loss: 0.0457194 Test Loss: 0.1453414
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14455336332321167, mae:0.23860737681388855
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1611827
	speed: 0.0350s/iter; left time: 395.9074s
	iters: 200, epoch: 1 | loss: 0.0880886
	speed: 0.0224s/iter; left time: 250.9847s
	iters: 300, epoch: 1 | loss: 0.1551008
	speed: 0.0224s/iter; left time: 248.6656s
	iters: 400, epoch: 1 | loss: 0.1174971
	speed: 0.0224s/iter; left time: 246.5601s
	iters: 500, epoch: 1 | loss: 0.1570380
	speed: 0.0224s/iter; left time: 244.2053s
Epoch: 1 cost time: 14.085506677627563
Epoch: 1, Steps: 570 | Train Loss: 0.1819967 Vali Loss: 0.0417195 Test Loss: 0.1302326
Validation loss decreased (inf --> 0.041720).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2005797
	speed: 0.0621s/iter; left time: 666.4194s
	iters: 200, epoch: 2 | loss: 0.1317277
	speed: 0.0207s/iter; left time: 219.6524s
	iters: 300, epoch: 2 | loss: 0.2992740
	speed: 0.0206s/iter; left time: 217.0322s
	iters: 400, epoch: 2 | loss: 0.2557242
	speed: 0.0206s/iter; left time: 214.7338s
	iters: 500, epoch: 2 | loss: 0.1844640
	speed: 0.0206s/iter; left time: 212.6493s
Epoch: 2 cost time: 12.067293643951416
Epoch: 2, Steps: 570 | Train Loss: 0.2159472 Vali Loss: 0.0691888 Test Loss: 0.2015038
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1917845
	speed: 0.0598s/iter; left time: 607.9796s
	iters: 200, epoch: 3 | loss: 0.1939210
	speed: 0.0206s/iter; left time: 207.2197s
	iters: 300, epoch: 3 | loss: 0.1543978
	speed: 0.0206s/iter; left time: 205.0060s
	iters: 400, epoch: 3 | loss: 0.1578405
	speed: 0.0206s/iter; left time: 202.9015s
	iters: 500, epoch: 3 | loss: 0.1485855
	speed: 0.0206s/iter; left time: 201.1393s
Epoch: 3 cost time: 12.027798414230347
Epoch: 3, Steps: 570 | Train Loss: 0.2254620 Vali Loss: 0.0597600 Test Loss: 0.1643411
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1238583
	speed: 0.0597s/iter; left time: 572.6615s
	iters: 200, epoch: 4 | loss: 0.1780287
	speed: 0.0206s/iter; left time: 195.8218s
	iters: 300, epoch: 4 | loss: 0.1466343
	speed: 0.0206s/iter; left time: 193.5541s
	iters: 400, epoch: 4 | loss: 0.2122630
	speed: 0.0206s/iter; left time: 191.4763s
	iters: 500, epoch: 4 | loss: 0.1696354
	speed: 0.0206s/iter; left time: 189.4052s
Epoch: 4 cost time: 12.049728870391846
Epoch: 4, Steps: 570 | Train Loss: 0.1947377 Vali Loss: 0.0546327 Test Loss: 0.1529316
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13044115900993347, mae:0.23281407356262207
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2434345
	speed: 0.0308s/iter; left time: 348.2356s
	iters: 200, epoch: 1 | loss: 0.1531063
	speed: 0.0191s/iter; left time: 213.6830s
	iters: 300, epoch: 1 | loss: 0.2530334
	speed: 0.0191s/iter; left time: 211.4828s
	iters: 400, epoch: 1 | loss: 0.2281839
	speed: 0.0191s/iter; left time: 209.7404s
	iters: 500, epoch: 1 | loss: 0.2358771
	speed: 0.0191s/iter; left time: 207.9804s
Epoch: 1 cost time: 12.098169326782227
Epoch: 1, Steps: 570 | Train Loss: 0.2170983 Vali Loss: 0.0559171 Test Loss: 0.1756478
Validation loss decreased (inf --> 0.055917).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1163736
	speed: 0.0589s/iter; left time: 631.8317s
	iters: 200, epoch: 2 | loss: 0.4850007
	speed: 0.0191s/iter; left time: 203.1564s
	iters: 300, epoch: 2 | loss: 0.2708116
	speed: 0.0191s/iter; left time: 201.5027s
	iters: 400, epoch: 2 | loss: 0.1452087
	speed: 0.0191s/iter; left time: 199.3243s
	iters: 500, epoch: 2 | loss: 0.1954087
	speed: 0.0191s/iter; left time: 197.2320s
Epoch: 2 cost time: 11.210079193115234
Epoch: 2, Steps: 570 | Train Loss: 0.2521133 Vali Loss: 0.0596861 Test Loss: 0.1777243
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1769210
	speed: 0.0565s/iter; left time: 574.0230s
	iters: 200, epoch: 3 | loss: 0.1579297
	speed: 0.0191s/iter; left time: 192.2845s
	iters: 300, epoch: 3 | loss: 0.2444570
	speed: 0.0191s/iter; left time: 190.0683s
	iters: 400, epoch: 3 | loss: 0.1686455
	speed: 0.0205s/iter; left time: 202.0262s
	iters: 500, epoch: 3 | loss: 0.2149357
	speed: 0.0203s/iter; left time: 198.1292s
Epoch: 3 cost time: 11.398840427398682
Epoch: 3, Steps: 570 | Train Loss: 0.2108717 Vali Loss: 0.0600512 Test Loss: 0.1710273
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1616878
	speed: 0.0583s/iter; left time: 559.1112s
	iters: 200, epoch: 4 | loss: 0.2954238
	speed: 0.0191s/iter; left time: 181.2606s
	iters: 300, epoch: 4 | loss: 0.1252136
	speed: 0.0191s/iter; left time: 179.1363s
	iters: 400, epoch: 4 | loss: 0.1872400
	speed: 0.0191s/iter; left time: 177.3856s
	iters: 500, epoch: 4 | loss: 0.1753382
	speed: 0.0192s/iter; left time: 176.0083s
Epoch: 4 cost time: 11.14454460144043
Epoch: 4, Steps: 570 | Train Loss: 0.1836865 Vali Loss: 0.0583106 Test Loss: 0.1626222
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.17591072618961334, mae:0.27432191371917725
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1875591
	speed: 0.0234s/iter; left time: 264.9097s
	iters: 200, epoch: 1 | loss: 0.1685902
	speed: 0.0121s/iter; left time: 135.0400s
	iters: 300, epoch: 1 | loss: 0.2426253
	speed: 0.0120s/iter; left time: 133.2741s
	iters: 400, epoch: 1 | loss: 0.2055227
	speed: 0.0120s/iter; left time: 132.1271s
	iters: 500, epoch: 1 | loss: 0.1781254
	speed: 0.0120s/iter; left time: 131.3377s
Epoch: 1 cost time: 8.046347618103027
Epoch: 1, Steps: 570 | Train Loss: 0.2129296 Vali Loss: 0.0461688 Test Loss: 0.1384224
Validation loss decreased (inf --> 0.046169).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2534581
	speed: 0.0401s/iter; left time: 429.8816s
	iters: 200, epoch: 2 | loss: 0.2095187
	speed: 0.0120s/iter; left time: 127.4822s
	iters: 300, epoch: 2 | loss: 0.1648936
	speed: 0.0120s/iter; left time: 126.3407s
	iters: 400, epoch: 2 | loss: 0.1565098
	speed: 0.0120s/iter; left time: 124.6881s
	iters: 500, epoch: 2 | loss: 0.1552203
	speed: 0.0120s/iter; left time: 123.6012s
Epoch: 2 cost time: 7.1346213817596436
Epoch: 2, Steps: 570 | Train Loss: 0.1706752 Vali Loss: 0.0441416 Test Loss: 0.1367652
Validation loss decreased (0.046169 --> 0.044142).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1195780
	speed: 0.0396s/iter; left time: 402.1755s
	iters: 200, epoch: 3 | loss: 0.1630878
	speed: 0.0120s/iter; left time: 121.0289s
	iters: 300, epoch: 3 | loss: 0.1316595
	speed: 0.0120s/iter; left time: 119.7274s
	iters: 400, epoch: 3 | loss: 0.1441677
	speed: 0.0120s/iter; left time: 118.5215s
	iters: 500, epoch: 3 | loss: 0.1832184
	speed: 0.0120s/iter; left time: 117.1723s
Epoch: 3 cost time: 7.129286766052246
Epoch: 3, Steps: 570 | Train Loss: 0.1405180 Vali Loss: 0.0383746 Test Loss: 0.1244795
Validation loss decreased (0.044142 --> 0.038375).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1192791
	speed: 0.0381s/iter; left time: 365.3903s
	iters: 200, epoch: 4 | loss: 0.0985092
	speed: 0.0119s/iter; left time: 113.3303s
	iters: 300, epoch: 4 | loss: 0.1505321
	speed: 0.0120s/iter; left time: 112.4095s
	iters: 400, epoch: 4 | loss: 0.1254500
	speed: 0.0120s/iter; left time: 111.1167s
	iters: 500, epoch: 4 | loss: 0.1224056
	speed: 0.0119s/iter; left time: 109.6381s
Epoch: 4 cost time: 7.078660488128662
Epoch: 4, Steps: 570 | Train Loss: 0.1215223 Vali Loss: 0.0378357 Test Loss: 0.1281882
Validation loss decreased (0.038375 --> 0.037836).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1180496
	speed: 0.0381s/iter; left time: 343.3340s
	iters: 200, epoch: 5 | loss: 0.1264121
	speed: 0.0120s/iter; left time: 107.2321s
	iters: 300, epoch: 5 | loss: 0.0851760
	speed: 0.0120s/iter; left time: 105.8008s
	iters: 400, epoch: 5 | loss: 0.1103657
	speed: 0.0120s/iter; left time: 104.5831s
	iters: 500, epoch: 5 | loss: 0.1040657
	speed: 0.0120s/iter; left time: 103.5305s
Epoch: 5 cost time: 7.130844831466675
Epoch: 5, Steps: 570 | Train Loss: 0.1098918 Vali Loss: 0.0366639 Test Loss: 0.1306551
Validation loss decreased (0.037836 --> 0.036664).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0982700
	speed: 0.0391s/iter; left time: 330.6801s
	iters: 200, epoch: 6 | loss: 0.1011713
	speed: 0.0120s/iter; left time: 100.5461s
	iters: 300, epoch: 6 | loss: 0.1064663
	speed: 0.0120s/iter; left time: 98.9876s
	iters: 400, epoch: 6 | loss: 0.1059360
	speed: 0.0120s/iter; left time: 97.9214s
	iters: 500, epoch: 6 | loss: 0.1032415
	speed: 0.0120s/iter; left time: 96.8903s
Epoch: 6 cost time: 7.150566101074219
Epoch: 6, Steps: 570 | Train Loss: 0.1038395 Vali Loss: 0.0361007 Test Loss: 0.1349440
Validation loss decreased (0.036664 --> 0.036101).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1149267
	speed: 0.0394s/iter; left time: 310.6609s
	iters: 200, epoch: 7 | loss: 0.1476670
	speed: 0.0121s/iter; left time: 93.7614s
	iters: 300, epoch: 7 | loss: 0.0790868
	speed: 0.0120s/iter; left time: 92.5366s
	iters: 400, epoch: 7 | loss: 0.0798678
	speed: 0.0120s/iter; left time: 91.1381s
	iters: 500, epoch: 7 | loss: 0.1045000
	speed: 0.0120s/iter; left time: 89.7775s
Epoch: 7 cost time: 7.115288734436035
Epoch: 7, Steps: 570 | Train Loss: 0.1021100 Vali Loss: 0.0367107 Test Loss: 0.1336253
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0942366
	speed: 0.0365s/iter; left time: 266.6786s
	iters: 200, epoch: 8 | loss: 0.0988189
	speed: 0.0105s/iter; left time: 75.7822s
	iters: 300, epoch: 8 | loss: 0.1260353
	speed: 0.0105s/iter; left time: 74.6857s
	iters: 400, epoch: 8 | loss: 0.1617311
	speed: 0.0105s/iter; left time: 73.6057s
	iters: 500, epoch: 8 | loss: 0.0782998
	speed: 0.0105s/iter; left time: 72.4807s
Epoch: 8 cost time: 6.265992641448975
Epoch: 8, Steps: 570 | Train Loss: 0.0995351 Vali Loss: 0.0362384 Test Loss: 0.1333975
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1689786
	speed: 0.0359s/iter; left time: 241.8912s
	iters: 200, epoch: 9 | loss: 0.0877496
	speed: 0.0105s/iter; left time: 69.7528s
	iters: 300, epoch: 9 | loss: 0.0617598
	speed: 0.0105s/iter; left time: 68.7684s
	iters: 400, epoch: 9 | loss: 0.0963161
	speed: 0.0105s/iter; left time: 67.6133s
	iters: 500, epoch: 9 | loss: 0.0842207
	speed: 0.0105s/iter; left time: 66.5166s
Epoch: 9 cost time: 6.270616769790649
Epoch: 9, Steps: 570 | Train Loss: 0.0986069 Vali Loss: 0.0366251 Test Loss: 0.1347573
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13512693345546722, mae:0.23280654847621918
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2258161
	speed: 0.0217s/iter; left time: 245.0681s
	iters: 200, epoch: 1 | loss: 0.1745539
	speed: 0.0103s/iter; left time: 115.1452s
	iters: 300, epoch: 1 | loss: 0.2272285
	speed: 0.0103s/iter; left time: 114.1274s
	iters: 400, epoch: 1 | loss: 0.1798825
	speed: 0.0103s/iter; left time: 112.8720s
	iters: 500, epoch: 1 | loss: 0.1475461
	speed: 0.0103s/iter; left time: 112.0986s
Epoch: 1 cost time: 7.050638198852539
Epoch: 1, Steps: 570 | Train Loss: 0.1818829 Vali Loss: 0.0384824 Test Loss: 0.1245723
Validation loss decreased (inf --> 0.038482).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1269545
	speed: 0.0368s/iter; left time: 394.6591s
	iters: 200, epoch: 2 | loss: 0.1704410
	speed: 0.0103s/iter; left time: 108.9933s
	iters: 300, epoch: 2 | loss: 0.1202096
	speed: 0.0103s/iter; left time: 108.3156s
	iters: 400, epoch: 2 | loss: 0.1311851
	speed: 0.0102s/iter; left time: 106.8829s
	iters: 500, epoch: 2 | loss: 0.1385412
	speed: 0.0103s/iter; left time: 105.9551s
Epoch: 2 cost time: 6.250487565994263
Epoch: 2, Steps: 570 | Train Loss: 0.1543717 Vali Loss: 0.0365131 Test Loss: 0.1147417
Validation loss decreased (0.038482 --> 0.036513).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0716504
	speed: 0.0363s/iter; left time: 368.6101s
	iters: 200, epoch: 3 | loss: 0.1160610
	speed: 0.0103s/iter; left time: 103.9708s
	iters: 300, epoch: 3 | loss: 0.2342663
	speed: 0.0103s/iter; left time: 102.4367s
	iters: 400, epoch: 3 | loss: 0.1401396
	speed: 0.0103s/iter; left time: 101.5022s
	iters: 500, epoch: 3 | loss: 0.0908380
	speed: 0.0103s/iter; left time: 100.5357s
Epoch: 3 cost time: 6.195517301559448
Epoch: 3, Steps: 570 | Train Loss: 0.1285174 Vali Loss: 0.0326620 Test Loss: 0.1128577
Validation loss decreased (0.036513 --> 0.032662).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1006823
	speed: 0.0359s/iter; left time: 344.7395s
	iters: 200, epoch: 4 | loss: 0.0886865
	speed: 0.0103s/iter; left time: 97.9268s
	iters: 300, epoch: 4 | loss: 0.0701043
	speed: 0.0104s/iter; left time: 97.2572s
	iters: 400, epoch: 4 | loss: 0.0819835
	speed: 0.0104s/iter; left time: 96.1739s
	iters: 500, epoch: 4 | loss: 0.1388223
	speed: 0.0103s/iter; left time: 94.7922s
Epoch: 4 cost time: 6.181354284286499
Epoch: 4, Steps: 570 | Train Loss: 0.1119747 Vali Loss: 0.0325327 Test Loss: 0.1104302
Validation loss decreased (0.032662 --> 0.032533).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0873269
	speed: 0.0362s/iter; left time: 326.4210s
	iters: 200, epoch: 5 | loss: 0.1224051
	speed: 0.0103s/iter; left time: 91.6257s
	iters: 300, epoch: 5 | loss: 0.0985460
	speed: 0.0102s/iter; left time: 90.3039s
	iters: 400, epoch: 5 | loss: 0.1158594
	speed: 0.0102s/iter; left time: 89.2650s
	iters: 500, epoch: 5 | loss: 0.0986964
	speed: 0.0103s/iter; left time: 88.5719s
Epoch: 5 cost time: 6.132014751434326
Epoch: 5, Steps: 570 | Train Loss: 0.1033130 Vali Loss: 0.0320356 Test Loss: 0.1119445
Validation loss decreased (0.032533 --> 0.032036).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0776036
	speed: 0.0367s/iter; left time: 310.4741s
	iters: 200, epoch: 6 | loss: 0.1331430
	speed: 0.0103s/iter; left time: 85.9255s
	iters: 300, epoch: 6 | loss: 0.1295920
	speed: 0.0103s/iter; left time: 85.2736s
	iters: 400, epoch: 6 | loss: 0.0783443
	speed: 0.0103s/iter; left time: 84.1185s
	iters: 500, epoch: 6 | loss: 0.0676099
	speed: 0.0103s/iter; left time: 82.7413s
Epoch: 6 cost time: 6.169672966003418
Epoch: 6, Steps: 570 | Train Loss: 0.0982573 Vali Loss: 0.0314279 Test Loss: 0.1120153
Validation loss decreased (0.032036 --> 0.031428).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0900342
	speed: 0.0361s/iter; left time: 284.6052s
	iters: 200, epoch: 7 | loss: 0.1217557
	speed: 0.0103s/iter; left time: 80.1715s
	iters: 300, epoch: 7 | loss: 0.1556553
	speed: 0.0103s/iter; left time: 79.2896s
	iters: 400, epoch: 7 | loss: 0.1425365
	speed: 0.0103s/iter; left time: 78.4230s
	iters: 500, epoch: 7 | loss: 0.0993003
	speed: 0.0103s/iter; left time: 77.1838s
Epoch: 7 cost time: 6.191269159317017
Epoch: 7, Steps: 570 | Train Loss: 0.0967970 Vali Loss: 0.0316864 Test Loss: 0.1134103
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0859262
	speed: 0.0363s/iter; left time: 265.0621s
	iters: 200, epoch: 8 | loss: 0.0744396
	speed: 0.0103s/iter; left time: 74.6170s
	iters: 300, epoch: 8 | loss: 0.0877784
	speed: 0.0104s/iter; left time: 73.7141s
	iters: 400, epoch: 8 | loss: 0.0967927
	speed: 0.0104s/iter; left time: 72.7200s
	iters: 500, epoch: 8 | loss: 0.0578659
	speed: 0.0104s/iter; left time: 71.6744s
Epoch: 8 cost time: 6.186060667037964
Epoch: 8, Steps: 570 | Train Loss: 0.0951235 Vali Loss: 0.0315706 Test Loss: 0.1138512
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0745744
	speed: 0.0355s/iter; left time: 239.5742s
	iters: 200, epoch: 9 | loss: 0.1081465
	speed: 0.0104s/iter; left time: 68.9393s
	iters: 300, epoch: 9 | loss: 0.0850372
	speed: 0.0103s/iter; left time: 67.5631s
	iters: 400, epoch: 9 | loss: 0.1032244
	speed: 0.0103s/iter; left time: 66.3980s
	iters: 500, epoch: 9 | loss: 0.0823691
	speed: 0.0103s/iter; left time: 65.5128s
Epoch: 9 cost time: 6.150758504867554
Epoch: 9, Steps: 570 | Train Loss: 0.0938647 Vali Loss: 0.0316149 Test Loss: 0.1139777
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11217200011014938, mae:0.20515543222427368
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2126052
	speed: 0.0222s/iter; left time: 250.6611s
	iters: 200, epoch: 1 | loss: 0.1374715
	speed: 0.0104s/iter; left time: 116.0345s
	iters: 300, epoch: 1 | loss: 0.1647153
	speed: 0.0104s/iter; left time: 115.2550s
	iters: 400, epoch: 1 | loss: 0.1097612
	speed: 0.0104s/iter; left time: 113.9420s
	iters: 500, epoch: 1 | loss: 0.2070301
	speed: 0.0104s/iter; left time: 113.0576s
Epoch: 1 cost time: 7.149724006652832
Epoch: 1, Steps: 570 | Train Loss: 0.2159055 Vali Loss: 0.0433398 Test Loss: 0.1446968
Validation loss decreased (inf --> 0.043340).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1930389
	speed: 0.0377s/iter; left time: 404.1384s
	iters: 200, epoch: 2 | loss: 0.2482810
	speed: 0.0103s/iter; left time: 109.7552s
	iters: 300, epoch: 2 | loss: 0.1856881
	speed: 0.0103s/iter; left time: 108.8988s
	iters: 400, epoch: 2 | loss: 0.2534928
	speed: 0.0103s/iter; left time: 107.6128s
	iters: 500, epoch: 2 | loss: 0.1951734
	speed: 0.0103s/iter; left time: 106.6489s
Epoch: 2 cost time: 6.174974679946899
Epoch: 2, Steps: 570 | Train Loss: 0.1715210 Vali Loss: 0.0442632 Test Loss: 0.1414142
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0967074
	speed: 0.0372s/iter; left time: 378.1847s
	iters: 200, epoch: 3 | loss: 0.1278625
	speed: 0.0104s/iter; left time: 104.6664s
	iters: 300, epoch: 3 | loss: 0.1800192
	speed: 0.0104s/iter; left time: 103.9152s
	iters: 400, epoch: 3 | loss: 0.1153174
	speed: 0.0104s/iter; left time: 102.8561s
	iters: 500, epoch: 3 | loss: 0.0864907
	speed: 0.0104s/iter; left time: 101.3042s
Epoch: 3 cost time: 6.203191518783569
Epoch: 3, Steps: 570 | Train Loss: 0.1365773 Vali Loss: 0.0402464 Test Loss: 0.1316162
Validation loss decreased (0.043340 --> 0.040246).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0689162
	speed: 0.0357s/iter; left time: 342.7688s
	iters: 200, epoch: 4 | loss: 0.0810238
	speed: 0.0104s/iter; left time: 98.9623s
	iters: 300, epoch: 4 | loss: 0.0791520
	speed: 0.0104s/iter; left time: 97.8095s
	iters: 400, epoch: 4 | loss: 0.1398570
	speed: 0.0104s/iter; left time: 96.7048s
	iters: 500, epoch: 4 | loss: 0.0956015
	speed: 0.0104s/iter; left time: 96.0391s
Epoch: 4 cost time: 6.252525329589844
Epoch: 4, Steps: 570 | Train Loss: 0.1136333 Vali Loss: 0.0403347 Test Loss: 0.1356540
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1071966
	speed: 0.0365s/iter; left time: 329.0613s
	iters: 200, epoch: 5 | loss: 0.0704997
	speed: 0.0104s/iter; left time: 92.9254s
	iters: 300, epoch: 5 | loss: 0.0892456
	speed: 0.0104s/iter; left time: 91.7665s
	iters: 400, epoch: 5 | loss: 0.1097680
	speed: 0.0104s/iter; left time: 90.6897s
	iters: 500, epoch: 5 | loss: 0.1410007
	speed: 0.0104s/iter; left time: 89.4025s
Epoch: 5 cost time: 6.179366588592529
Epoch: 5, Steps: 570 | Train Loss: 0.1049160 Vali Loss: 0.0393753 Test Loss: 0.1345298
Validation loss decreased (0.040246 --> 0.039375).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0837624
	speed: 0.0361s/iter; left time: 305.4277s
	iters: 200, epoch: 6 | loss: 0.0961889
	speed: 0.0103s/iter; left time: 86.2678s
	iters: 300, epoch: 6 | loss: 0.1093323
	speed: 0.0103s/iter; left time: 84.9472s
	iters: 400, epoch: 6 | loss: 0.0809935
	speed: 0.0103s/iter; left time: 84.1944s
	iters: 500, epoch: 6 | loss: 0.1131487
	speed: 0.0103s/iter; left time: 83.1896s
Epoch: 6 cost time: 6.181368827819824
Epoch: 6, Steps: 570 | Train Loss: 0.0989067 Vali Loss: 0.0389056 Test Loss: 0.1327591
Validation loss decreased (0.039375 --> 0.038906).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0908248
	speed: 0.0382s/iter; left time: 301.3770s
	iters: 200, epoch: 7 | loss: 0.0762231
	speed: 0.0103s/iter; left time: 80.2606s
	iters: 300, epoch: 7 | loss: 0.0909373
	speed: 0.0104s/iter; left time: 79.5695s
	iters: 400, epoch: 7 | loss: 0.0681608
	speed: 0.0103s/iter; left time: 78.4035s
	iters: 500, epoch: 7 | loss: 0.0986060
	speed: 0.0103s/iter; left time: 77.1839s
Epoch: 7 cost time: 6.180460453033447
Epoch: 7, Steps: 570 | Train Loss: 0.0962614 Vali Loss: 0.0390874 Test Loss: 0.1329040
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0775798
	speed: 0.0367s/iter; left time: 268.1453s
	iters: 200, epoch: 8 | loss: 0.1064886
	speed: 0.0104s/iter; left time: 74.6881s
	iters: 300, epoch: 8 | loss: 0.0902569
	speed: 0.0103s/iter; left time: 73.5335s
	iters: 400, epoch: 8 | loss: 0.0937475
	speed: 0.0103s/iter; left time: 72.5195s
	iters: 500, epoch: 8 | loss: 0.0717437
	speed: 0.0103s/iter; left time: 71.4916s
Epoch: 8 cost time: 6.224544286727905
Epoch: 8, Steps: 570 | Train Loss: 0.0940405 Vali Loss: 0.0391326 Test Loss: 0.1337127
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0720170
	speed: 0.0353s/iter; left time: 237.7538s
	iters: 200, epoch: 9 | loss: 0.1180055
	speed: 0.0102s/iter; left time: 68.0475s
	iters: 300, epoch: 9 | loss: 0.0763217
	speed: 0.0102s/iter; left time: 66.9755s
	iters: 400, epoch: 9 | loss: 0.0791094
	speed: 0.0102s/iter; left time: 65.9521s
	iters: 500, epoch: 9 | loss: 0.0849110
	speed: 0.0102s/iter; left time: 64.9089s
Epoch: 9 cost time: 6.103687524795532
Epoch: 9, Steps: 570 | Train Loss: 0.0928958 Vali Loss: 0.0394123 Test Loss: 0.1342105
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13295453786849976, mae:0.23362568020820618
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2748502
	speed: 0.0235s/iter; left time: 265.7195s
	iters: 200, epoch: 1 | loss: 0.2084380
	speed: 0.0118s/iter; left time: 132.4330s
	iters: 300, epoch: 1 | loss: 0.2147193
	speed: 0.0118s/iter; left time: 131.1377s
	iters: 400, epoch: 1 | loss: 0.1102636
	speed: 0.0118s/iter; left time: 130.3029s
	iters: 500, epoch: 1 | loss: 0.2449139
	speed: 0.0119s/iter; left time: 129.1860s
Epoch: 1 cost time: 7.964558362960815
Epoch: 1, Steps: 570 | Train Loss: 0.2353376 Vali Loss: 0.0468720 Test Loss: 0.1393561
Validation loss decreased (inf --> 0.046872).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1956535
	speed: 0.0409s/iter; left time: 439.3856s
	iters: 200, epoch: 2 | loss: 0.1641064
	speed: 0.0119s/iter; left time: 126.6514s
	iters: 300, epoch: 2 | loss: 0.1314635
	speed: 0.0119s/iter; left time: 125.7177s
	iters: 400, epoch: 2 | loss: 0.1056886
	speed: 0.0119s/iter; left time: 124.1607s
	iters: 500, epoch: 2 | loss: 0.1730652
	speed: 0.0119s/iter; left time: 122.9280s
Epoch: 2 cost time: 7.1383562088012695
Epoch: 2, Steps: 570 | Train Loss: 0.1995923 Vali Loss: 0.0450163 Test Loss: 0.1359542
Validation loss decreased (0.046872 --> 0.045016).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1934972
	speed: 0.0407s/iter; left time: 413.5040s
	iters: 200, epoch: 3 | loss: 0.2169630
	speed: 0.0118s/iter; left time: 119.0773s
	iters: 300, epoch: 3 | loss: 0.1213193
	speed: 0.0118s/iter; left time: 118.0213s
	iters: 400, epoch: 3 | loss: 0.1498200
	speed: 0.0119s/iter; left time: 116.8669s
	iters: 500, epoch: 3 | loss: 0.1662777
	speed: 0.0118s/iter; left time: 115.6200s
Epoch: 3 cost time: 7.070978403091431
Epoch: 3, Steps: 570 | Train Loss: 0.1741398 Vali Loss: 0.0422012 Test Loss: 0.1378659
Validation loss decreased (0.045016 --> 0.042201).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1304682
	speed: 0.0395s/iter; left time: 378.6890s
	iters: 200, epoch: 4 | loss: 0.1854112
	speed: 0.0118s/iter; left time: 112.3851s
	iters: 300, epoch: 4 | loss: 0.1072130
	speed: 0.0118s/iter; left time: 110.9767s
	iters: 400, epoch: 4 | loss: 0.0934103
	speed: 0.0118s/iter; left time: 109.8028s
	iters: 500, epoch: 4 | loss: 0.1440407
	speed: 0.0118s/iter; left time: 108.5896s
Epoch: 4 cost time: 7.035829544067383
Epoch: 4, Steps: 570 | Train Loss: 0.1554324 Vali Loss: 0.0426190 Test Loss: 0.1270937
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1229717
	speed: 0.0395s/iter; left time: 355.9402s
	iters: 200, epoch: 5 | loss: 0.1247959
	speed: 0.0119s/iter; left time: 105.9007s
	iters: 300, epoch: 5 | loss: 0.1960773
	speed: 0.0119s/iter; left time: 104.7369s
	iters: 400, epoch: 5 | loss: 0.1387040
	speed: 0.0119s/iter; left time: 103.5477s
	iters: 500, epoch: 5 | loss: 0.1279780
	speed: 0.0119s/iter; left time: 102.3289s
Epoch: 5 cost time: 7.060994625091553
Epoch: 5, Steps: 570 | Train Loss: 0.1429132 Vali Loss: 0.0403843 Test Loss: 0.1261380
Validation loss decreased (0.042201 --> 0.040384).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1534443
	speed: 0.0402s/iter; left time: 339.7507s
	iters: 200, epoch: 6 | loss: 0.0734791
	speed: 0.0118s/iter; left time: 98.8749s
	iters: 300, epoch: 6 | loss: 0.1539678
	speed: 0.0118s/iter; left time: 97.6618s
	iters: 400, epoch: 6 | loss: 0.1341914
	speed: 0.0118s/iter; left time: 96.4895s
	iters: 500, epoch: 6 | loss: 0.1050217
	speed: 0.0118s/iter; left time: 95.2850s
Epoch: 6 cost time: 7.065880298614502
Epoch: 6, Steps: 570 | Train Loss: 0.1340782 Vali Loss: 0.0394809 Test Loss: 0.1283349
Validation loss decreased (0.040384 --> 0.039481).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1350735
	speed: 0.0390s/iter; left time: 307.5795s
	iters: 200, epoch: 7 | loss: 0.1328423
	speed: 0.0119s/iter; left time: 92.3058s
	iters: 300, epoch: 7 | loss: 0.1311206
	speed: 0.0119s/iter; left time: 91.1159s
	iters: 400, epoch: 7 | loss: 0.0903304
	speed: 0.0118s/iter; left time: 89.8167s
	iters: 500, epoch: 7 | loss: 0.1177615
	speed: 0.0119s/iter; left time: 88.6957s
Epoch: 7 cost time: 7.051419973373413
Epoch: 7, Steps: 570 | Train Loss: 0.1292391 Vali Loss: 0.0397825 Test Loss: 0.1285097
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0874919
	speed: 0.0379s/iter; left time: 277.4223s
	iters: 200, epoch: 8 | loss: 0.1236357
	speed: 0.0119s/iter; left time: 85.8632s
	iters: 300, epoch: 8 | loss: 0.1306811
	speed: 0.0119s/iter; left time: 84.6447s
	iters: 400, epoch: 8 | loss: 0.1075007
	speed: 0.0119s/iter; left time: 83.4889s
	iters: 500, epoch: 8 | loss: 0.1073734
	speed: 0.0119s/iter; left time: 82.2770s
Epoch: 8 cost time: 7.074612855911255
Epoch: 8, Steps: 570 | Train Loss: 0.1282189 Vali Loss: 0.0393154 Test Loss: 0.1281180
Validation loss decreased (0.039481 --> 0.039315).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1067264
	speed: 0.0404s/iter; left time: 272.3901s
	iters: 200, epoch: 9 | loss: 0.1032476
	speed: 0.0118s/iter; left time: 78.6119s
	iters: 300, epoch: 9 | loss: 0.1405332
	speed: 0.0118s/iter; left time: 77.4064s
	iters: 400, epoch: 9 | loss: 0.0929061
	speed: 0.0118s/iter; left time: 76.2429s
	iters: 500, epoch: 9 | loss: 0.1268479
	speed: 0.0118s/iter; left time: 75.0450s
Epoch: 9 cost time: 7.064804315567017
Epoch: 9, Steps: 570 | Train Loss: 0.1259667 Vali Loss: 0.0393005 Test Loss: 0.1285784
Validation loss decreased (0.039315 --> 0.039301).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1167146
	speed: 0.0396s/iter; left time: 244.4144s
	iters: 200, epoch: 10 | loss: 0.1376054
	speed: 0.0119s/iter; left time: 72.2437s
	iters: 300, epoch: 10 | loss: 0.1336108
	speed: 0.0119s/iter; left time: 71.0661s
	iters: 400, epoch: 10 | loss: 0.1067017
	speed: 0.0119s/iter; left time: 69.8734s
	iters: 500, epoch: 10 | loss: 0.1816334
	speed: 0.0119s/iter; left time: 68.7409s
Epoch: 10 cost time: 7.0794453620910645
Epoch: 10, Steps: 570 | Train Loss: 0.1260375 Vali Loss: 0.0393978 Test Loss: 0.1289789
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1116521
	speed: 0.0391s/iter; left time: 219.2319s
	iters: 200, epoch: 11 | loss: 0.1775654
	speed: 0.0119s/iter; left time: 65.2114s
	iters: 300, epoch: 11 | loss: 0.1322004
	speed: 0.0118s/iter; left time: 63.9316s
	iters: 400, epoch: 11 | loss: 0.1197584
	speed: 0.0118s/iter; left time: 62.8013s
	iters: 500, epoch: 11 | loss: 0.1856377
	speed: 0.0119s/iter; left time: 61.6501s
Epoch: 11 cost time: 7.029090642929077
Epoch: 11, Steps: 570 | Train Loss: 0.1244359 Vali Loss: 0.0394877 Test Loss: 0.1293370
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0919617
	speed: 0.0389s/iter; left time: 195.7739s
	iters: 200, epoch: 12 | loss: 0.0905452
	speed: 0.0119s/iter; left time: 58.5223s
	iters: 300, epoch: 12 | loss: 0.1048527
	speed: 0.0119s/iter; left time: 57.4372s
	iters: 400, epoch: 12 | loss: 0.1121643
	speed: 0.0119s/iter; left time: 56.2277s
	iters: 500, epoch: 12 | loss: 0.1147581
	speed: 0.0119s/iter; left time: 55.0299s
Epoch: 12 cost time: 7.065691232681274
Epoch: 12, Steps: 570 | Train Loss: 0.1251730 Vali Loss: 0.0395623 Test Loss: 0.1292676
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12871778011322021, mae:0.22809365391731262
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1300711
	speed: 0.0233s/iter; left time: 263.7516s
	iters: 200, epoch: 1 | loss: 0.3094113
	speed: 0.0115s/iter; left time: 128.4812s
	iters: 300, epoch: 1 | loss: 0.1772321
	speed: 0.0115s/iter; left time: 127.4936s
	iters: 400, epoch: 1 | loss: 0.1927970
	speed: 0.0115s/iter; left time: 126.1468s
	iters: 500, epoch: 1 | loss: 0.1227823
	speed: 0.0115s/iter; left time: 125.0119s
Epoch: 1 cost time: 7.766777753829956
Epoch: 1, Steps: 570 | Train Loss: 0.1955146 Vali Loss: 0.0420059 Test Loss: 0.1293657
Validation loss decreased (inf --> 0.042006).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1480882
	speed: 0.0389s/iter; left time: 416.9936s
	iters: 200, epoch: 2 | loss: 0.1168805
	speed: 0.0115s/iter; left time: 122.5068s
	iters: 300, epoch: 2 | loss: 0.1539083
	speed: 0.0115s/iter; left time: 121.1540s
	iters: 400, epoch: 2 | loss: 0.2182992
	speed: 0.0115s/iter; left time: 120.1261s
	iters: 500, epoch: 2 | loss: 0.6056554
	speed: 0.0115s/iter; left time: 118.8211s
Epoch: 2 cost time: 6.878265857696533
Epoch: 2, Steps: 570 | Train Loss: 0.1892001 Vali Loss: 0.0559730 Test Loss: 0.1621517
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2122157
	speed: 0.0384s/iter; left time: 390.6663s
	iters: 200, epoch: 3 | loss: 0.0970625
	speed: 0.0114s/iter; left time: 114.5622s
	iters: 300, epoch: 3 | loss: 0.1917423
	speed: 0.0114s/iter; left time: 113.5637s
	iters: 400, epoch: 3 | loss: 0.1587247
	speed: 0.0114s/iter; left time: 112.5778s
	iters: 500, epoch: 3 | loss: 0.2420566
	speed: 0.0114s/iter; left time: 111.2139s
Epoch: 3 cost time: 6.811446666717529
Epoch: 3, Steps: 570 | Train Loss: 0.1813456 Vali Loss: 0.0372267 Test Loss: 0.1250522
Validation loss decreased (0.042006 --> 0.037227).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1855680
	speed: 0.0387s/iter; left time: 371.2121s
	iters: 200, epoch: 4 | loss: 0.0917098
	speed: 0.0115s/iter; left time: 108.8252s
	iters: 300, epoch: 4 | loss: 0.0880305
	speed: 0.0115s/iter; left time: 107.9340s
	iters: 400, epoch: 4 | loss: 0.1410631
	speed: 0.0115s/iter; left time: 106.6410s
	iters: 500, epoch: 4 | loss: 0.1505861
	speed: 0.0115s/iter; left time: 105.7133s
Epoch: 4 cost time: 6.865068674087524
Epoch: 4, Steps: 570 | Train Loss: 0.1574655 Vali Loss: 0.0376252 Test Loss: 0.1238940
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1433762
	speed: 0.0376s/iter; left time: 339.1052s
	iters: 200, epoch: 5 | loss: 0.1362560
	speed: 0.0114s/iter; left time: 101.6624s
	iters: 300, epoch: 5 | loss: 0.2190448
	speed: 0.0114s/iter; left time: 100.6620s
	iters: 400, epoch: 5 | loss: 0.1679020
	speed: 0.0114s/iter; left time: 99.3978s
	iters: 500, epoch: 5 | loss: 0.1148061
	speed: 0.0114s/iter; left time: 98.4048s
Epoch: 5 cost time: 6.768932819366455
Epoch: 5, Steps: 570 | Train Loss: 0.1475436 Vali Loss: 0.0346353 Test Loss: 0.1169233
Validation loss decreased (0.037227 --> 0.034635).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1732468
	speed: 0.0405s/iter; left time: 342.6527s
	iters: 200, epoch: 6 | loss: 0.1484320
	speed: 0.0125s/iter; left time: 104.6449s
	iters: 300, epoch: 6 | loss: 0.0845025
	speed: 0.0125s/iter; left time: 103.3248s
	iters: 400, epoch: 6 | loss: 0.0988227
	speed: 0.0125s/iter; left time: 102.1495s
	iters: 500, epoch: 6 | loss: 0.1221070
	speed: 0.0125s/iter; left time: 100.8603s
Epoch: 6 cost time: 7.463322401046753
Epoch: 6, Steps: 570 | Train Loss: 0.1396978 Vali Loss: 0.0338739 Test Loss: 0.1158155
Validation loss decreased (0.034635 --> 0.033874).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1004824
	speed: 0.0395s/iter; left time: 311.3446s
	iters: 200, epoch: 7 | loss: 0.2261177
	speed: 0.0115s/iter; left time: 89.5220s
	iters: 300, epoch: 7 | loss: 0.1112074
	speed: 0.0115s/iter; left time: 88.3918s
	iters: 400, epoch: 7 | loss: 0.1229349
	speed: 0.0115s/iter; left time: 87.2351s
	iters: 500, epoch: 7 | loss: 0.1122292
	speed: 0.0115s/iter; left time: 86.0742s
Epoch: 7 cost time: 6.886261701583862
Epoch: 7, Steps: 570 | Train Loss: 0.1377403 Vali Loss: 0.0337382 Test Loss: 0.1156678
Validation loss decreased (0.033874 --> 0.033738).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1037824
	speed: 0.0397s/iter; left time: 290.5652s
	iters: 200, epoch: 8 | loss: 0.1524660
	speed: 0.0122s/iter; left time: 88.0027s
	iters: 300, epoch: 8 | loss: 0.1183857
	speed: 0.0116s/iter; left time: 82.2604s
	iters: 400, epoch: 8 | loss: 0.1234620
	speed: 0.0115s/iter; left time: 80.5012s
	iters: 500, epoch: 8 | loss: 0.1097233
	speed: 0.0115s/iter; left time: 79.3966s
Epoch: 8 cost time: 6.972746849060059
Epoch: 8, Steps: 570 | Train Loss: 0.1357162 Vali Loss: 0.0336374 Test Loss: 0.1146246
Validation loss decreased (0.033738 --> 0.033637).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1797483
	speed: 0.0382s/iter; left time: 257.6013s
	iters: 200, epoch: 9 | loss: 0.0966282
	speed: 0.0115s/iter; left time: 76.0498s
	iters: 300, epoch: 9 | loss: 0.1592433
	speed: 0.0115s/iter; left time: 74.9188s
	iters: 400, epoch: 9 | loss: 0.1242249
	speed: 0.0115s/iter; left time: 73.7696s
	iters: 500, epoch: 9 | loss: 0.2368679
	speed: 0.0115s/iter; left time: 72.6109s
Epoch: 9 cost time: 6.836431264877319
Epoch: 9, Steps: 570 | Train Loss: 0.1345700 Vali Loss: 0.0333215 Test Loss: 0.1144174
Validation loss decreased (0.033637 --> 0.033322).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1224813
	speed: 0.0389s/iter; left time: 240.2340s
	iters: 200, epoch: 10 | loss: 0.0959411
	speed: 0.0114s/iter; left time: 69.3292s
	iters: 300, epoch: 10 | loss: 0.1260364
	speed: 0.0114s/iter; left time: 68.1881s
	iters: 400, epoch: 10 | loss: 0.1690525
	speed: 0.0114s/iter; left time: 67.0398s
	iters: 500, epoch: 10 | loss: 0.1556181
	speed: 0.0114s/iter; left time: 65.9190s
Epoch: 10 cost time: 6.844830751419067
Epoch: 10, Steps: 570 | Train Loss: 0.1346377 Vali Loss: 0.0333686 Test Loss: 0.1149346
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1144761
	speed: 0.0376s/iter; left time: 210.8094s
	iters: 200, epoch: 11 | loss: 0.1198494
	speed: 0.0114s/iter; left time: 62.8194s
	iters: 300, epoch: 11 | loss: 0.1082775
	speed: 0.0114s/iter; left time: 61.6691s
	iters: 400, epoch: 11 | loss: 0.1738293
	speed: 0.0114s/iter; left time: 60.6711s
	iters: 500, epoch: 11 | loss: 0.1408115
	speed: 0.0114s/iter; left time: 59.4628s
Epoch: 11 cost time: 6.780963897705078
Epoch: 11, Steps: 570 | Train Loss: 0.1339782 Vali Loss: 0.0333226 Test Loss: 0.1150690
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1342557
	speed: 0.0381s/iter; left time: 191.6814s
	iters: 200, epoch: 12 | loss: 0.1216956
	speed: 0.0115s/iter; left time: 56.6495s
	iters: 300, epoch: 12 | loss: 0.1211447
	speed: 0.0115s/iter; left time: 55.6580s
	iters: 400, epoch: 12 | loss: 0.1809108
	speed: 0.0115s/iter; left time: 54.2437s
	iters: 500, epoch: 12 | loss: 0.1421872
	speed: 0.0115s/iter; left time: 53.1163s
Epoch: 12 cost time: 6.844978332519531
Epoch: 12, Steps: 570 | Train Loss: 0.1330528 Vali Loss: 0.0335861 Test Loss: 0.1150666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11457356065511703, mae:0.2082524299621582
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2563054
	speed: 0.0226s/iter; left time: 255.3514s
	iters: 200, epoch: 1 | loss: 0.3060882
	speed: 0.0108s/iter; left time: 120.8458s
	iters: 300, epoch: 1 | loss: 0.2427146
	speed: 0.0108s/iter; left time: 119.4700s
	iters: 400, epoch: 1 | loss: 0.1704900
	speed: 0.0108s/iter; left time: 118.2840s
	iters: 500, epoch: 1 | loss: 0.1884707
	speed: 0.0108s/iter; left time: 117.4456s
Epoch: 1 cost time: 7.3687968254089355
Epoch: 1, Steps: 570 | Train Loss: 0.2254649 Vali Loss: 0.0460251 Test Loss: 0.1410485
Validation loss decreased (inf --> 0.046025).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2278082
	speed: 0.0372s/iter; left time: 399.4518s
	iters: 200, epoch: 2 | loss: 0.2863010
	speed: 0.0109s/iter; left time: 115.5182s
	iters: 300, epoch: 2 | loss: 0.1574631
	speed: 0.0109s/iter; left time: 114.6582s
	iters: 400, epoch: 2 | loss: 0.1781293
	speed: 0.0109s/iter; left time: 113.4891s
	iters: 500, epoch: 2 | loss: 0.3219774
	speed: 0.0109s/iter; left time: 112.5544s
Epoch: 2 cost time: 6.509297132492065
Epoch: 2, Steps: 570 | Train Loss: 0.2344164 Vali Loss: 0.0522266 Test Loss: 0.1590629
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1617962
	speed: 0.0378s/iter; left time: 384.2378s
	iters: 200, epoch: 3 | loss: 0.1521518
	speed: 0.0120s/iter; left time: 121.1606s
	iters: 300, epoch: 3 | loss: 0.2234536
	speed: 0.0121s/iter; left time: 120.1279s
	iters: 400, epoch: 3 | loss: 0.1817826
	speed: 0.0120s/iter; left time: 118.3029s
	iters: 500, epoch: 3 | loss: 0.2091747
	speed: 0.0120s/iter; left time: 117.5001s
Epoch: 3 cost time: 7.110620737075806
Epoch: 3, Steps: 570 | Train Loss: 0.2069548 Vali Loss: 0.0490118 Test Loss: 0.1398464
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2131798
	speed: 0.0368s/iter; left time: 352.4722s
	iters: 200, epoch: 4 | loss: 0.1151125
	speed: 0.0108s/iter; left time: 102.7735s
	iters: 300, epoch: 4 | loss: 0.1875534
	speed: 0.0108s/iter; left time: 101.6030s
	iters: 400, epoch: 4 | loss: 0.2876613
	speed: 0.0108s/iter; left time: 100.4944s
	iters: 500, epoch: 4 | loss: 0.1665280
	speed: 0.0108s/iter; left time: 99.6420s
Epoch: 4 cost time: 6.4387311935424805
Epoch: 4, Steps: 570 | Train Loss: 0.1805104 Vali Loss: 0.0436446 Test Loss: 0.1359658
Validation loss decreased (0.046025 --> 0.043645).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1752025
	speed: 0.0403s/iter; left time: 363.6989s
	iters: 200, epoch: 5 | loss: 0.1700835
	speed: 0.0118s/iter; left time: 105.1755s
	iters: 300, epoch: 5 | loss: 0.1537457
	speed: 0.0108s/iter; left time: 95.4229s
	iters: 400, epoch: 5 | loss: 0.1103722
	speed: 0.0108s/iter; left time: 94.3092s
	iters: 500, epoch: 5 | loss: 0.2354374
	speed: 0.0108s/iter; left time: 93.4912s
Epoch: 5 cost time: 6.709837198257446
Epoch: 5, Steps: 570 | Train Loss: 0.1616194 Vali Loss: 0.0424842 Test Loss: 0.1335908
Validation loss decreased (0.043645 --> 0.042484).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1213849
	speed: 0.0390s/iter; left time: 329.2897s
	iters: 200, epoch: 6 | loss: 0.1398307
	speed: 0.0109s/iter; left time: 90.6425s
	iters: 300, epoch: 6 | loss: 0.1669592
	speed: 0.0108s/iter; left time: 89.0590s
	iters: 400, epoch: 6 | loss: 0.1325021
	speed: 0.0108s/iter; left time: 88.2550s
	iters: 500, epoch: 6 | loss: 0.1601461
	speed: 0.0108s/iter; left time: 87.2531s
Epoch: 6 cost time: 6.489863395690918
Epoch: 6, Steps: 570 | Train Loss: 0.1514458 Vali Loss: 0.0423038 Test Loss: 0.1384318
Validation loss decreased (0.042484 --> 0.042304).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1293175
	speed: 0.0388s/iter; left time: 306.0930s
	iters: 200, epoch: 7 | loss: 0.1011876
	speed: 0.0120s/iter; left time: 92.9888s
	iters: 300, epoch: 7 | loss: 0.0974072
	speed: 0.0109s/iter; left time: 83.7856s
	iters: 400, epoch: 7 | loss: 0.1650061
	speed: 0.0108s/iter; left time: 82.1222s
	iters: 500, epoch: 7 | loss: 0.1089765
	speed: 0.0108s/iter; left time: 81.0422s
Epoch: 7 cost time: 6.706374883651733
Epoch: 7, Steps: 570 | Train Loss: 0.1461564 Vali Loss: 0.0408922 Test Loss: 0.1339641
Validation loss decreased (0.042304 --> 0.040892).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1181434
	speed: 0.0380s/iter; left time: 277.8933s
	iters: 200, epoch: 8 | loss: 0.1858453
	speed: 0.0121s/iter; left time: 86.9867s
	iters: 300, epoch: 8 | loss: 0.1627850
	speed: 0.0120s/iter; left time: 85.1612s
	iters: 400, epoch: 8 | loss: 0.1537389
	speed: 0.0120s/iter; left time: 84.2176s
	iters: 500, epoch: 8 | loss: 0.1267983
	speed: 0.0120s/iter; left time: 83.0692s
Epoch: 8 cost time: 7.147031545639038
Epoch: 8, Steps: 570 | Train Loss: 0.1429851 Vali Loss: 0.0401977 Test Loss: 0.1338758
Validation loss decreased (0.040892 --> 0.040198).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1155324
	speed: 0.0391s/iter; left time: 263.7250s
	iters: 200, epoch: 9 | loss: 0.1059210
	speed: 0.0108s/iter; left time: 71.6843s
	iters: 300, epoch: 9 | loss: 0.1898012
	speed: 0.0108s/iter; left time: 70.7281s
	iters: 400, epoch: 9 | loss: 0.1801835
	speed: 0.0108s/iter; left time: 69.4991s
	iters: 500, epoch: 9 | loss: 0.0898061
	speed: 0.0108s/iter; left time: 68.3072s
Epoch: 9 cost time: 6.453861951828003
Epoch: 9, Steps: 570 | Train Loss: 0.1410465 Vali Loss: 0.0404282 Test Loss: 0.1336343
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1446062
	speed: 0.0369s/iter; left time: 227.4205s
	iters: 200, epoch: 10 | loss: 0.0783195
	speed: 0.0109s/iter; left time: 66.1783s
	iters: 300, epoch: 10 | loss: 0.1531917
	speed: 0.0109s/iter; left time: 64.9092s
	iters: 400, epoch: 10 | loss: 0.1077531
	speed: 0.0108s/iter; left time: 63.6635s
	iters: 500, epoch: 10 | loss: 0.1898513
	speed: 0.0109s/iter; left time: 62.7093s
Epoch: 10 cost time: 6.458868980407715
Epoch: 10, Steps: 570 | Train Loss: 0.1413932 Vali Loss: 0.0402531 Test Loss: 0.1331305
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0896061
	speed: 0.0364s/iter; left time: 203.7285s
	iters: 200, epoch: 11 | loss: 0.1391569
	speed: 0.0108s/iter; left time: 59.5048s
	iters: 300, epoch: 11 | loss: 0.1467878
	speed: 0.0108s/iter; left time: 58.4358s
	iters: 400, epoch: 11 | loss: 0.1015909
	speed: 0.0108s/iter; left time: 57.3249s
	iters: 500, epoch: 11 | loss: 0.1169378
	speed: 0.0108s/iter; left time: 56.2655s
Epoch: 11 cost time: 6.4444739818573
Epoch: 11, Steps: 570 | Train Loss: 0.1408087 Vali Loss: 0.0402770 Test Loss: 0.1330332
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13402952253818512, mae:0.23121598362922668
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1887528
	speed: 0.0272s/iter; left time: 306.8602s
	iters: 200, epoch: 1 | loss: 0.1745297
	speed: 0.0146s/iter; left time: 163.0998s
	iters: 300, epoch: 1 | loss: 0.2686448
	speed: 0.0146s/iter; left time: 161.9206s
	iters: 400, epoch: 1 | loss: 0.1905873
	speed: 0.0146s/iter; left time: 160.7657s
	iters: 500, epoch: 1 | loss: 0.1562005
	speed: 0.0146s/iter; left time: 159.2930s
Epoch: 1 cost time: 9.623996257781982
Epoch: 1, Steps: 570 | Train Loss: 0.2121014 Vali Loss: 0.0457071 Test Loss: 0.1369302
Validation loss decreased (inf --> 0.045707).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2004817
	speed: 0.0476s/iter; left time: 511.0625s
	iters: 200, epoch: 2 | loss: 0.1453238
	speed: 0.0147s/iter; left time: 156.1764s
	iters: 300, epoch: 2 | loss: 0.1475892
	speed: 0.0147s/iter; left time: 154.3497s
	iters: 400, epoch: 2 | loss: 0.0873680
	speed: 0.0146s/iter; left time: 152.7661s
	iters: 500, epoch: 2 | loss: 0.1953811
	speed: 0.0146s/iter; left time: 151.2690s
Epoch: 2 cost time: 8.714062213897705
Epoch: 2, Steps: 570 | Train Loss: 0.1697742 Vali Loss: 0.0448095 Test Loss: 0.1532207
Validation loss decreased (0.045707 --> 0.044810).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2172320
	speed: 0.0521s/iter; left time: 528.9069s
	iters: 200, epoch: 3 | loss: 0.1722004
	speed: 0.0168s/iter; left time: 169.4061s
	iters: 300, epoch: 3 | loss: 0.0974896
	speed: 0.0168s/iter; left time: 167.5319s
	iters: 400, epoch: 3 | loss: 0.1056065
	speed: 0.0169s/iter; left time: 166.4217s
	iters: 500, epoch: 3 | loss: 0.0902604
	speed: 0.0169s/iter; left time: 164.5120s
Epoch: 3 cost time: 9.910758018493652
Epoch: 3, Steps: 570 | Train Loss: 0.1363809 Vali Loss: 0.0369532 Test Loss: 0.1324762
Validation loss decreased (0.044810 --> 0.036953).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1073803
	speed: 0.0500s/iter; left time: 479.8787s
	iters: 200, epoch: 4 | loss: 0.0982647
	speed: 0.0164s/iter; left time: 155.9398s
	iters: 300, epoch: 4 | loss: 0.1236442
	speed: 0.0163s/iter; left time: 153.4475s
	iters: 400, epoch: 4 | loss: 0.1236129
	speed: 0.0163s/iter; left time: 151.8091s
	iters: 500, epoch: 4 | loss: 0.0928323
	speed: 0.0164s/iter; left time: 150.5421s
Epoch: 4 cost time: 9.52298092842102
Epoch: 4, Steps: 570 | Train Loss: 0.1142296 Vali Loss: 0.0382205 Test Loss: 0.1314452
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1057231
	speed: 0.0497s/iter; left time: 448.2169s
	iters: 200, epoch: 5 | loss: 0.0959686
	speed: 0.0147s/iter; left time: 130.9693s
	iters: 300, epoch: 5 | loss: 0.1053961
	speed: 0.0146s/iter; left time: 129.1204s
	iters: 400, epoch: 5 | loss: 0.0760272
	speed: 0.0147s/iter; left time: 127.9728s
	iters: 500, epoch: 5 | loss: 0.0985045
	speed: 0.0146s/iter; left time: 126.2629s
Epoch: 5 cost time: 8.648949146270752
Epoch: 5, Steps: 570 | Train Loss: 0.1028115 Vali Loss: 0.0374991 Test Loss: 0.1352442
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0769622
	speed: 0.0497s/iter; left time: 420.1575s
	iters: 200, epoch: 6 | loss: 0.1111268
	speed: 0.0165s/iter; left time: 138.0798s
	iters: 300, epoch: 6 | loss: 0.0763125
	speed: 0.0164s/iter; left time: 135.6954s
	iters: 400, epoch: 6 | loss: 0.0836025
	speed: 0.0149s/iter; left time: 121.6780s
	iters: 500, epoch: 6 | loss: 0.0896173
	speed: 0.0147s/iter; left time: 118.0556s
Epoch: 6 cost time: 9.201226711273193
Epoch: 6, Steps: 570 | Train Loss: 0.0954362 Vali Loss: 0.0381863 Test Loss: 0.1341667
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1326751559972763, mae:0.23089633882045746
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2571278
	speed: 0.0259s/iter; left time: 292.6718s
	iters: 200, epoch: 1 | loss: 0.1795674
	speed: 0.0143s/iter; left time: 159.7418s
	iters: 300, epoch: 1 | loss: 0.1446693
	speed: 0.0142s/iter; left time: 158.1180s
	iters: 400, epoch: 1 | loss: 0.2394119
	speed: 0.0143s/iter; left time: 156.8041s
	iters: 500, epoch: 1 | loss: 0.1704829
	speed: 0.0142s/iter; left time: 155.2685s
Epoch: 1 cost time: 9.33791470527649
Epoch: 1, Steps: 570 | Train Loss: 0.1852389 Vali Loss: 0.0390686 Test Loss: 0.1200361
Validation loss decreased (inf --> 0.039069).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1506557
	speed: 0.0463s/iter; left time: 496.5390s
	iters: 200, epoch: 2 | loss: 0.2355483
	speed: 0.0142s/iter; left time: 151.3605s
	iters: 300, epoch: 2 | loss: 0.1674860
	speed: 0.0143s/iter; left time: 150.2184s
	iters: 400, epoch: 2 | loss: 0.1498764
	speed: 0.0143s/iter; left time: 148.8538s
	iters: 500, epoch: 2 | loss: 0.1291158
	speed: 0.0143s/iter; left time: 147.2481s
Epoch: 2 cost time: 8.43352746963501
Epoch: 2, Steps: 570 | Train Loss: 0.1558052 Vali Loss: 0.0364324 Test Loss: 0.1229202
Validation loss decreased (0.039069 --> 0.036432).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1597399
	speed: 0.0459s/iter; left time: 466.4397s
	iters: 200, epoch: 3 | loss: 0.0761815
	speed: 0.0142s/iter; left time: 142.6813s
	iters: 300, epoch: 3 | loss: 0.1524725
	speed: 0.0142s/iter; left time: 141.2594s
	iters: 400, epoch: 3 | loss: 0.1095894
	speed: 0.0142s/iter; left time: 139.7952s
	iters: 500, epoch: 3 | loss: 0.1125388
	speed: 0.0142s/iter; left time: 138.4411s
Epoch: 3 cost time: 8.398529529571533
Epoch: 3, Steps: 570 | Train Loss: 0.1273141 Vali Loss: 0.0354726 Test Loss: 0.1159626
Validation loss decreased (0.036432 --> 0.035473).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1125436
	speed: 0.0452s/iter; left time: 433.5622s
	iters: 200, epoch: 4 | loss: 0.1218719
	speed: 0.0142s/iter; left time: 135.0975s
	iters: 300, epoch: 4 | loss: 0.1170438
	speed: 0.0142s/iter; left time: 133.7025s
	iters: 400, epoch: 4 | loss: 0.0681171
	speed: 0.0142s/iter; left time: 132.2755s
	iters: 500, epoch: 4 | loss: 0.0770603
	speed: 0.0142s/iter; left time: 130.8619s
Epoch: 4 cost time: 8.419173240661621
Epoch: 4, Steps: 570 | Train Loss: 0.1111331 Vali Loss: 0.0332167 Test Loss: 0.1165192
Validation loss decreased (0.035473 --> 0.033217).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0582938
	speed: 0.0486s/iter; left time: 438.5705s
	iters: 200, epoch: 5 | loss: 0.0808735
	speed: 0.0160s/iter; left time: 142.5927s
	iters: 300, epoch: 5 | loss: 0.1255110
	speed: 0.0160s/iter; left time: 141.0132s
	iters: 400, epoch: 5 | loss: 0.0846190
	speed: 0.0153s/iter; left time: 133.3303s
	iters: 500, epoch: 5 | loss: 0.1239723
	speed: 0.0143s/iter; left time: 123.6621s
Epoch: 5 cost time: 9.097311735153198
Epoch: 5, Steps: 570 | Train Loss: 0.0998496 Vali Loss: 0.0335846 Test Loss: 0.1124407
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0829497
	speed: 0.0460s/iter; left time: 388.5676s
	iters: 200, epoch: 6 | loss: 0.1824692
	speed: 0.0143s/iter; left time: 119.2851s
	iters: 300, epoch: 6 | loss: 0.1384225
	speed: 0.0143s/iter; left time: 117.8735s
	iters: 400, epoch: 6 | loss: 0.1213723
	speed: 0.0143s/iter; left time: 116.4018s
	iters: 500, epoch: 6 | loss: 0.1057120
	speed: 0.0143s/iter; left time: 114.9526s
Epoch: 6 cost time: 8.416188716888428
Epoch: 6, Steps: 570 | Train Loss: 0.0947269 Vali Loss: 0.0343582 Test Loss: 0.1162853
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0796793
	speed: 0.0450s/iter; left time: 354.3130s
	iters: 200, epoch: 7 | loss: 0.1019718
	speed: 0.0143s/iter; left time: 111.1999s
	iters: 300, epoch: 7 | loss: 0.1382055
	speed: 0.0143s/iter; left time: 109.8127s
	iters: 400, epoch: 7 | loss: 0.1120844
	speed: 0.0143s/iter; left time: 108.3584s
	iters: 500, epoch: 7 | loss: 0.1253088
	speed: 0.0143s/iter; left time: 106.9453s
Epoch: 7 cost time: 8.43242883682251
Epoch: 7, Steps: 570 | Train Loss: 0.0917960 Vali Loss: 0.0335369 Test Loss: 0.1151851
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11667660623788834, mae:0.2073177695274353
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1167674
	speed: 0.0261s/iter; left time: 294.4935s
	iters: 200, epoch: 1 | loss: 0.2955054
	speed: 0.0143s/iter; left time: 159.9117s
	iters: 300, epoch: 1 | loss: 0.2616664
	speed: 0.0143s/iter; left time: 158.4688s
	iters: 400, epoch: 1 | loss: 0.2577615
	speed: 0.0143s/iter; left time: 157.1499s
	iters: 500, epoch: 1 | loss: 0.2450613
	speed: 0.0142s/iter; left time: 155.3118s
Epoch: 1 cost time: 9.366874933242798
Epoch: 1, Steps: 570 | Train Loss: 0.2198592 Vali Loss: 0.0458057 Test Loss: 0.1364354
Validation loss decreased (inf --> 0.045806).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1457091
	speed: 0.0466s/iter; left time: 499.8325s
	iters: 200, epoch: 2 | loss: 0.1517224
	speed: 0.0143s/iter; left time: 151.7486s
	iters: 300, epoch: 2 | loss: 0.1078367
	speed: 0.0142s/iter; left time: 149.6932s
	iters: 400, epoch: 2 | loss: 0.1300821
	speed: 0.0142s/iter; left time: 148.3622s
	iters: 500, epoch: 2 | loss: 0.1867114
	speed: 0.0142s/iter; left time: 146.6534s
Epoch: 2 cost time: 8.44642162322998
Epoch: 2, Steps: 570 | Train Loss: 0.1734601 Vali Loss: 0.0465346 Test Loss: 0.1419535
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1603560
	speed: 0.0470s/iter; left time: 477.6462s
	iters: 200, epoch: 3 | loss: 0.1496567
	speed: 0.0144s/iter; left time: 144.7196s
	iters: 300, epoch: 3 | loss: 0.1131109
	speed: 0.0144s/iter; left time: 143.1720s
	iters: 400, epoch: 3 | loss: 0.1033980
	speed: 0.0143s/iter; left time: 141.4619s
	iters: 500, epoch: 3 | loss: 0.1396991
	speed: 0.0144s/iter; left time: 140.2634s
Epoch: 3 cost time: 8.475270509719849
Epoch: 3, Steps: 570 | Train Loss: 0.1330556 Vali Loss: 0.0399300 Test Loss: 0.1306822
Validation loss decreased (0.045806 --> 0.039930).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1255874
	speed: 0.0462s/iter; left time: 443.3614s
	iters: 200, epoch: 4 | loss: 0.0922611
	speed: 0.0143s/iter; left time: 136.0771s
	iters: 300, epoch: 4 | loss: 0.1204252
	speed: 0.0143s/iter; left time: 134.5702s
	iters: 400, epoch: 4 | loss: 0.0807351
	speed: 0.0143s/iter; left time: 133.0586s
	iters: 500, epoch: 4 | loss: 0.0890441
	speed: 0.0143s/iter; left time: 131.4948s
Epoch: 4 cost time: 8.472286701202393
Epoch: 4, Steps: 570 | Train Loss: 0.1093582 Vali Loss: 0.0405465 Test Loss: 0.1377843
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1012835
	speed: 0.0494s/iter; left time: 445.7559s
	iters: 200, epoch: 5 | loss: 0.1233751
	speed: 0.0143s/iter; left time: 127.5593s
	iters: 300, epoch: 5 | loss: 0.0911026
	speed: 0.0143s/iter; left time: 125.8734s
	iters: 400, epoch: 5 | loss: 0.1299900
	speed: 0.0143s/iter; left time: 124.4614s
	iters: 500, epoch: 5 | loss: 0.0800860
	speed: 0.0143s/iter; left time: 122.9775s
Epoch: 5 cost time: 8.452622890472412
Epoch: 5, Steps: 570 | Train Loss: 0.0979579 Vali Loss: 0.0395616 Test Loss: 0.1374321
Validation loss decreased (0.039930 --> 0.039562).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1015463
	speed: 0.0482s/iter; left time: 407.3940s
	iters: 200, epoch: 6 | loss: 0.0948733
	speed: 0.0142s/iter; left time: 118.9988s
	iters: 300, epoch: 6 | loss: 0.0730019
	speed: 0.0142s/iter; left time: 117.5535s
	iters: 400, epoch: 6 | loss: 0.1324817
	speed: 0.0142s/iter; left time: 116.0931s
	iters: 500, epoch: 6 | loss: 0.0903305
	speed: 0.0142s/iter; left time: 114.5675s
Epoch: 6 cost time: 8.445652723312378
Epoch: 6, Steps: 570 | Train Loss: 0.0920441 Vali Loss: 0.0392771 Test Loss: 0.1379205
Validation loss decreased (0.039562 --> 0.039277).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1402810
	speed: 0.0459s/iter; left time: 362.0360s
	iters: 200, epoch: 7 | loss: 0.0584416
	speed: 0.0143s/iter; left time: 111.4629s
	iters: 300, epoch: 7 | loss: 0.0678023
	speed: 0.0143s/iter; left time: 109.9770s
	iters: 400, epoch: 7 | loss: 0.1021162
	speed: 0.0143s/iter; left time: 108.5975s
	iters: 500, epoch: 7 | loss: 0.0978183
	speed: 0.0143s/iter; left time: 107.2040s
Epoch: 7 cost time: 8.471689939498901
Epoch: 7, Steps: 570 | Train Loss: 0.0904201 Vali Loss: 0.0401387 Test Loss: 0.1376490
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0721863
	speed: 0.0468s/iter; left time: 342.4328s
	iters: 200, epoch: 8 | loss: 0.0762913
	speed: 0.0143s/iter; left time: 103.3164s
	iters: 300, epoch: 8 | loss: 0.0771560
	speed: 0.0143s/iter; left time: 101.7902s
	iters: 400, epoch: 8 | loss: 0.0905376
	speed: 0.0143s/iter; left time: 100.4699s
	iters: 500, epoch: 8 | loss: 0.0657823
	speed: 0.0143s/iter; left time: 98.8914s
Epoch: 8 cost time: 8.469254732131958
Epoch: 8, Steps: 570 | Train Loss: 0.0885404 Vali Loss: 0.0401814 Test Loss: 0.1384605
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1196062
	speed: 0.0463s/iter; left time: 311.8071s
	iters: 200, epoch: 9 | loss: 0.0744827
	speed: 0.0144s/iter; left time: 95.6021s
	iters: 300, epoch: 9 | loss: 0.0610878
	speed: 0.0144s/iter; left time: 94.1285s
	iters: 400, epoch: 9 | loss: 0.0683761
	speed: 0.0144s/iter; left time: 92.5881s
	iters: 500, epoch: 9 | loss: 0.0821749
	speed: 0.0144s/iter; left time: 91.1061s
Epoch: 9 cost time: 8.51870846748352
Epoch: 9, Steps: 570 | Train Loss: 0.0874677 Vali Loss: 0.0394991 Test Loss: 0.1376500
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1380898505449295, mae:0.2346818745136261
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2557442
	speed: 0.0305s/iter; left time: 344.2001s
	iters: 200, epoch: 1 | loss: 0.2155398
	speed: 0.0172s/iter; left time: 192.7067s
	iters: 300, epoch: 1 | loss: 0.2420019
	speed: 0.0168s/iter; left time: 186.4554s
	iters: 400, epoch: 1 | loss: 0.2215629
	speed: 0.0168s/iter; left time: 185.0204s
	iters: 500, epoch: 1 | loss: 0.1729687
	speed: 0.0168s/iter; left time: 183.4209s
Epoch: 1 cost time: 11.03813362121582
Epoch: 1, Steps: 570 | Train Loss: 0.2311400 Vali Loss: 0.0515341 Test Loss: 0.1655550
Validation loss decreased (inf --> 0.051534).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2657224
	speed: 0.0533s/iter; left time: 572.2477s
	iters: 200, epoch: 2 | loss: 0.2257499
	speed: 0.0185s/iter; left time: 196.3086s
	iters: 300, epoch: 2 | loss: 0.3500930
	speed: 0.0170s/iter; left time: 178.8398s
	iters: 400, epoch: 2 | loss: 0.2537546
	speed: 0.0170s/iter; left time: 176.8780s
	iters: 500, epoch: 2 | loss: 0.2537118
	speed: 0.0170s/iter; left time: 175.2521s
Epoch: 2 cost time: 10.306124448776245
Epoch: 2, Steps: 570 | Train Loss: 0.2654837 Vali Loss: 0.0593745 Test Loss: 0.1681601
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2091331
	speed: 0.0530s/iter; left time: 538.8381s
	iters: 200, epoch: 3 | loss: 0.2144510
	speed: 0.0170s/iter; left time: 170.8935s
	iters: 300, epoch: 3 | loss: 0.3650085
	speed: 0.0170s/iter; left time: 168.9901s
	iters: 400, epoch: 3 | loss: 0.2017132
	speed: 0.0170s/iter; left time: 167.4332s
	iters: 500, epoch: 3 | loss: 0.1605293
	speed: 0.0170s/iter; left time: 165.7372s
Epoch: 3 cost time: 9.978131532669067
Epoch: 3, Steps: 570 | Train Loss: 0.2349367 Vali Loss: 0.0586023 Test Loss: 0.1637388
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1823092
	speed: 0.0505s/iter; left time: 483.8852s
	iters: 200, epoch: 4 | loss: 0.1900171
	speed: 0.0169s/iter; left time: 160.6804s
	iters: 300, epoch: 4 | loss: 0.2166175
	speed: 0.0169s/iter; left time: 159.1010s
	iters: 400, epoch: 4 | loss: 0.2219737
	speed: 0.0169s/iter; left time: 157.2406s
	iters: 500, epoch: 4 | loss: 0.2073140
	speed: 0.0169s/iter; left time: 155.7220s
Epoch: 4 cost time: 9.966561794281006
Epoch: 4, Steps: 570 | Train Loss: 0.2113202 Vali Loss: 0.0572437 Test Loss: 0.1619374
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.16583923995494843, mae:0.2654508650302887
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1760582
	speed: 0.0301s/iter; left time: 340.3405s
	iters: 200, epoch: 1 | loss: 0.1070482
	speed: 0.0178s/iter; left time: 199.5382s
	iters: 300, epoch: 1 | loss: 0.2112269
	speed: 0.0179s/iter; left time: 198.4176s
	iters: 400, epoch: 1 | loss: 0.1858908
	speed: 0.0179s/iter; left time: 196.9589s
	iters: 500, epoch: 1 | loss: 0.1099274
	speed: 0.0167s/iter; left time: 182.1474s
Epoch: 1 cost time: 11.24231219291687
Epoch: 1, Steps: 570 | Train Loss: 0.2009359 Vali Loss: 0.0405242 Test Loss: 0.1315651
Validation loss decreased (inf --> 0.040524).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2052581
	speed: 0.0524s/iter; left time: 562.5326s
	iters: 200, epoch: 2 | loss: 0.1780758
	speed: 0.0164s/iter; left time: 174.1761s
	iters: 300, epoch: 2 | loss: 0.3228746
	speed: 0.0164s/iter; left time: 172.3092s
	iters: 400, epoch: 2 | loss: 0.3696241
	speed: 0.0164s/iter; left time: 171.1124s
	iters: 500, epoch: 2 | loss: 0.2204932
	speed: 0.0164s/iter; left time: 169.0029s
Epoch: 2 cost time: 9.785012245178223
Epoch: 2, Steps: 570 | Train Loss: 0.2766150 Vali Loss: 0.0629898 Test Loss: 0.1795397
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2809814
	speed: 0.0538s/iter; left time: 546.5740s
	iters: 200, epoch: 3 | loss: 0.2335446
	speed: 0.0178s/iter; left time: 179.1486s
	iters: 300, epoch: 3 | loss: 0.1699868
	speed: 0.0164s/iter; left time: 163.5342s
	iters: 400, epoch: 3 | loss: 0.2662534
	speed: 0.0164s/iter; left time: 161.8228s
	iters: 500, epoch: 3 | loss: 0.1413514
	speed: 0.0164s/iter; left time: 160.1694s
Epoch: 3 cost time: 10.005398273468018
Epoch: 3, Steps: 570 | Train Loss: 0.2469185 Vali Loss: 0.0556733 Test Loss: 0.1584507
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1767578
	speed: 0.0497s/iter; left time: 476.9929s
	iters: 200, epoch: 4 | loss: 0.4568399
	speed: 0.0163s/iter; left time: 154.8795s
	iters: 300, epoch: 4 | loss: 0.2135920
	speed: 0.0163s/iter; left time: 153.1766s
	iters: 400, epoch: 4 | loss: 0.1967251
	speed: 0.0163s/iter; left time: 151.5406s
	iters: 500, epoch: 4 | loss: 0.3326260
	speed: 0.0163s/iter; left time: 149.9364s
Epoch: 4 cost time: 9.641014814376831
Epoch: 4, Steps: 570 | Train Loss: 0.2256985 Vali Loss: 0.0552150 Test Loss: 0.1522728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13178963959217072, mae:0.22601796686649323
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2132356
	speed: 0.0295s/iter; left time: 333.7509s
	iters: 200, epoch: 1 | loss: 0.2197873
	speed: 0.0155s/iter; left time: 173.5191s
	iters: 300, epoch: 1 | loss: 0.1616414
	speed: 0.0155s/iter; left time: 171.8612s
	iters: 400, epoch: 1 | loss: 0.2144824
	speed: 0.0155s/iter; left time: 170.3002s
	iters: 500, epoch: 1 | loss: 0.3870519
	speed: 0.0155s/iter; left time: 168.9087s
Epoch: 1 cost time: 10.290083169937134
Epoch: 1, Steps: 570 | Train Loss: 0.2323277 Vali Loss: 0.0471214 Test Loss: 0.1549581
Validation loss decreased (inf --> 0.047121).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2906809
	speed: 0.0506s/iter; left time: 542.9137s
	iters: 200, epoch: 2 | loss: 0.1560972
	speed: 0.0156s/iter; left time: 166.1875s
	iters: 300, epoch: 2 | loss: 0.3482560
	speed: 0.0155s/iter; left time: 163.2635s
	iters: 400, epoch: 2 | loss: 0.2620814
	speed: 0.0155s/iter; left time: 161.5942s
	iters: 500, epoch: 2 | loss: 0.3732356
	speed: 0.0155s/iter; left time: 159.7182s
Epoch: 2 cost time: 9.4132399559021
Epoch: 2, Steps: 570 | Train Loss: 0.2595969 Vali Loss: 0.0632168 Test Loss: 0.1850292
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2194456
	speed: 0.0482s/iter; left time: 489.2828s
	iters: 200, epoch: 3 | loss: 0.1570438
	speed: 0.0154s/iter; left time: 154.4942s
	iters: 300, epoch: 3 | loss: 0.4517294
	speed: 0.0154s/iter; left time: 152.9053s
	iters: 400, epoch: 3 | loss: 0.2757720
	speed: 0.0153s/iter; left time: 151.2359s
	iters: 500, epoch: 3 | loss: 0.2946413
	speed: 0.0153s/iter; left time: 149.6427s
Epoch: 3 cost time: 9.027586698532104
Epoch: 3, Steps: 570 | Train Loss: 0.2807978 Vali Loss: 0.0621568 Test Loss: 0.1712141
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2104102
	speed: 0.0477s/iter; left time: 457.3395s
	iters: 200, epoch: 4 | loss: 0.3161986
	speed: 0.0177s/iter; left time: 167.8232s
	iters: 300, epoch: 4 | loss: 0.3023233
	speed: 0.0177s/iter; left time: 165.8644s
	iters: 400, epoch: 4 | loss: 0.1917839
	speed: 0.0177s/iter; left time: 164.1686s
	iters: 500, epoch: 4 | loss: 0.2984703
	speed: 0.0176s/iter; left time: 162.2195s
Epoch: 4 cost time: 10.167400121688843
Epoch: 4, Steps: 570 | Train Loss: 0.2446291 Vali Loss: 0.0604046 Test Loss: 0.1626612
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15516559779644012, mae:0.24410508573055267
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1601215
	speed: 0.0303s/iter; left time: 342.7496s
	iters: 200, epoch: 1 | loss: 0.2679668
	speed: 0.0187s/iter; left time: 209.6383s
	iters: 300, epoch: 1 | loss: 0.3529364
	speed: 0.0187s/iter; left time: 207.7015s
	iters: 400, epoch: 1 | loss: 0.1937822
	speed: 0.0187s/iter; left time: 205.6082s
	iters: 500, epoch: 1 | loss: 0.1617287
	speed: 0.0187s/iter; left time: 204.2164s
Epoch: 1 cost time: 11.879122972488403
Epoch: 1, Steps: 570 | Train Loss: 0.2158539 Vali Loss: 0.0480296 Test Loss: 0.1407557
Validation loss decreased (inf --> 0.048030).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3049391
	speed: 0.0564s/iter; left time: 605.1569s
	iters: 200, epoch: 2 | loss: 0.1487861
	speed: 0.0187s/iter; left time: 198.3648s
	iters: 300, epoch: 2 | loss: 0.1564662
	speed: 0.0187s/iter; left time: 196.4306s
	iters: 400, epoch: 2 | loss: 0.1327024
	speed: 0.0186s/iter; left time: 194.4379s
	iters: 500, epoch: 2 | loss: 0.1627572
	speed: 0.0186s/iter; left time: 192.6105s
Epoch: 2 cost time: 10.923125982284546
Epoch: 2, Steps: 570 | Train Loss: 0.1726822 Vali Loss: 0.0468829 Test Loss: 0.1471639
Validation loss decreased (0.048030 --> 0.046883).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1179763
	speed: 0.0572s/iter; left time: 581.6917s
	iters: 200, epoch: 3 | loss: 0.1013117
	speed: 0.0188s/iter; left time: 189.0720s
	iters: 300, epoch: 3 | loss: 0.1304374
	speed: 0.0188s/iter; left time: 187.1011s
	iters: 400, epoch: 3 | loss: 0.1004486
	speed: 0.0187s/iter; left time: 184.7347s
	iters: 500, epoch: 3 | loss: 0.0968303
	speed: 0.0187s/iter; left time: 182.8719s
Epoch: 3 cost time: 10.9925057888031
Epoch: 3, Steps: 570 | Train Loss: 0.1370727 Vali Loss: 0.0421463 Test Loss: 0.1415687
Validation loss decreased (0.046883 --> 0.042146).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1208971
	speed: 0.0589s/iter; left time: 564.7744s
	iters: 200, epoch: 4 | loss: 0.1769108
	speed: 0.0186s/iter; left time: 176.6597s
	iters: 300, epoch: 4 | loss: 0.1254952
	speed: 0.0186s/iter; left time: 174.4812s
	iters: 400, epoch: 4 | loss: 0.0638355
	speed: 0.0186s/iter; left time: 172.8335s
	iters: 500, epoch: 4 | loss: 0.1190091
	speed: 0.0186s/iter; left time: 171.1606s
Epoch: 4 cost time: 10.879269123077393
Epoch: 4, Steps: 570 | Train Loss: 0.1120965 Vali Loss: 0.0393526 Test Loss: 0.1339446
Validation loss decreased (0.042146 --> 0.039353).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1096135
	speed: 0.0571s/iter; left time: 515.2317s
	iters: 200, epoch: 5 | loss: 0.1083995
	speed: 0.0187s/iter; left time: 166.7830s
	iters: 300, epoch: 5 | loss: 0.1029091
	speed: 0.0187s/iter; left time: 165.1256s
	iters: 400, epoch: 5 | loss: 0.0780801
	speed: 0.0188s/iter; left time: 163.7382s
	iters: 500, epoch: 5 | loss: 0.0935497
	speed: 0.0188s/iter; left time: 162.2470s
Epoch: 5 cost time: 10.982906103134155
Epoch: 5, Steps: 570 | Train Loss: 0.0984703 Vali Loss: 0.0383031 Test Loss: 0.1369257
Validation loss decreased (0.039353 --> 0.038303).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0612615
	speed: 0.0561s/iter; left time: 473.8905s
	iters: 200, epoch: 6 | loss: 0.0969343
	speed: 0.0188s/iter; left time: 156.5931s
	iters: 300, epoch: 6 | loss: 0.0809905
	speed: 0.0187s/iter; left time: 154.4263s
	iters: 400, epoch: 6 | loss: 0.1350560
	speed: 0.0187s/iter; left time: 152.6021s
	iters: 500, epoch: 6 | loss: 0.0834133
	speed: 0.0187s/iter; left time: 150.8452s
Epoch: 6 cost time: 10.982553720474243
Epoch: 6, Steps: 570 | Train Loss: 0.0927784 Vali Loss: 0.0386098 Test Loss: 0.1366741
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0775667
	speed: 0.0572s/iter; left time: 450.8748s
	iters: 200, epoch: 7 | loss: 0.0709670
	speed: 0.0187s/iter; left time: 145.6733s
	iters: 300, epoch: 7 | loss: 0.0941858
	speed: 0.0187s/iter; left time: 143.7602s
	iters: 400, epoch: 7 | loss: 0.0993690
	speed: 0.0187s/iter; left time: 141.7781s
	iters: 500, epoch: 7 | loss: 0.1505994
	speed: 0.0187s/iter; left time: 139.9394s
Epoch: 7 cost time: 10.964020252227783
Epoch: 7, Steps: 570 | Train Loss: 0.0896315 Vali Loss: 0.0384480 Test Loss: 0.1356376
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0899162
	speed: 0.0554s/iter; left time: 404.7903s
	iters: 200, epoch: 8 | loss: 0.0799357
	speed: 0.0185s/iter; left time: 133.6262s
	iters: 300, epoch: 8 | loss: 0.0750812
	speed: 0.0185s/iter; left time: 131.8597s
	iters: 400, epoch: 8 | loss: 0.1160712
	speed: 0.0185s/iter; left time: 129.9446s
	iters: 500, epoch: 8 | loss: 0.0674134
	speed: 0.0185s/iter; left time: 128.1110s
Epoch: 8 cost time: 10.824750423431396
Epoch: 8, Steps: 570 | Train Loss: 0.0882210 Vali Loss: 0.0388550 Test Loss: 0.1363302
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13711073994636536, mae:0.23102308809757233
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3742481
	speed: 0.0325s/iter; left time: 367.4734s
	iters: 200, epoch: 1 | loss: 0.1943786
	speed: 0.0204s/iter; left time: 229.0242s
	iters: 300, epoch: 1 | loss: 0.1684622
	speed: 0.0204s/iter; left time: 226.9080s
	iters: 400, epoch: 1 | loss: 0.1639359
	speed: 0.0205s/iter; left time: 225.2671s
	iters: 500, epoch: 1 | loss: 0.1772284
	speed: 0.0205s/iter; left time: 223.2409s
Epoch: 1 cost time: 12.921253681182861
Epoch: 1, Steps: 570 | Train Loss: 0.1876974 Vali Loss: 0.0407946 Test Loss: 0.1276755
Validation loss decreased (inf --> 0.040795).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1380969
	speed: 0.0572s/iter; left time: 613.9304s
	iters: 200, epoch: 2 | loss: 0.2264183
	speed: 0.0184s/iter; left time: 195.3691s
	iters: 300, epoch: 2 | loss: 0.2026057
	speed: 0.0184s/iter; left time: 193.5174s
	iters: 400, epoch: 2 | loss: 0.2185692
	speed: 0.0184s/iter; left time: 191.8396s
	iters: 500, epoch: 2 | loss: 0.1197596
	speed: 0.0184s/iter; left time: 189.8151s
Epoch: 2 cost time: 10.784347295761108
Epoch: 2, Steps: 570 | Train Loss: 0.1580204 Vali Loss: 0.0412605 Test Loss: 0.1215693
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0871293
	speed: 0.0582s/iter; left time: 590.9478s
	iters: 200, epoch: 3 | loss: 0.1306126
	speed: 0.0183s/iter; left time: 183.9942s
	iters: 300, epoch: 3 | loss: 0.1405563
	speed: 0.0183s/iter; left time: 182.1344s
	iters: 400, epoch: 3 | loss: 0.0955729
	speed: 0.0183s/iter; left time: 180.2149s
	iters: 500, epoch: 3 | loss: 0.1021546
	speed: 0.0182s/iter; left time: 178.0728s
Epoch: 3 cost time: 10.696298360824585
Epoch: 3, Steps: 570 | Train Loss: 0.1316289 Vali Loss: 0.0364323 Test Loss: 0.1165626
Validation loss decreased (0.040795 --> 0.036432).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1236294
	speed: 0.0571s/iter; left time: 547.6592s
	iters: 200, epoch: 4 | loss: 0.0730140
	speed: 0.0182s/iter; left time: 172.7960s
	iters: 300, epoch: 4 | loss: 0.1182805
	speed: 0.0182s/iter; left time: 170.7003s
	iters: 400, epoch: 4 | loss: 0.0956322
	speed: 0.0182s/iter; left time: 168.9297s
	iters: 500, epoch: 4 | loss: 0.0843183
	speed: 0.0182s/iter; left time: 167.0674s
Epoch: 4 cost time: 10.656893491744995
Epoch: 4, Steps: 570 | Train Loss: 0.1119665 Vali Loss: 0.0349799 Test Loss: 0.1142847
Validation loss decreased (0.036432 --> 0.034980).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0831127
	speed: 0.0568s/iter; left time: 512.1725s
	iters: 200, epoch: 5 | loss: 0.0967013
	speed: 0.0181s/iter; left time: 161.6125s
	iters: 300, epoch: 5 | loss: 0.0894479
	speed: 0.0181s/iter; left time: 159.8880s
	iters: 400, epoch: 5 | loss: 0.0886109
	speed: 0.0181s/iter; left time: 157.8841s
	iters: 500, epoch: 5 | loss: 0.0990796
	speed: 0.0181s/iter; left time: 156.0124s
Epoch: 5 cost time: 10.655960083007812
Epoch: 5, Steps: 570 | Train Loss: 0.0984995 Vali Loss: 0.0343408 Test Loss: 0.1158925
Validation loss decreased (0.034980 --> 0.034341).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1077913
	speed: 0.0603s/iter; left time: 509.8612s
	iters: 200, epoch: 6 | loss: 0.0714055
	speed: 0.0211s/iter; left time: 176.4485s
	iters: 300, epoch: 6 | loss: 0.1109908
	speed: 0.0211s/iter; left time: 173.8855s
	iters: 400, epoch: 6 | loss: 0.0810228
	speed: 0.0211s/iter; left time: 171.9710s
	iters: 500, epoch: 6 | loss: 0.0629373
	speed: 0.0211s/iter; left time: 169.5412s
Epoch: 6 cost time: 12.360519409179688
Epoch: 6, Steps: 570 | Train Loss: 0.0925016 Vali Loss: 0.0345410 Test Loss: 0.1169708
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0780927
	speed: 0.0616s/iter; left time: 485.4844s
	iters: 200, epoch: 7 | loss: 0.1124896
	speed: 0.0210s/iter; left time: 163.1867s
	iters: 300, epoch: 7 | loss: 0.0596608
	speed: 0.0209s/iter; left time: 160.8299s
	iters: 400, epoch: 7 | loss: 0.1044410
	speed: 0.0209s/iter; left time: 158.6093s
	iters: 500, epoch: 7 | loss: 0.0788359
	speed: 0.0209s/iter; left time: 156.5751s
Epoch: 7 cost time: 12.26069974899292
Epoch: 7, Steps: 570 | Train Loss: 0.0886925 Vali Loss: 0.0339803 Test Loss: 0.1164838
Validation loss decreased (0.034341 --> 0.033980).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0700560
	speed: 0.0630s/iter; left time: 460.5910s
	iters: 200, epoch: 8 | loss: 0.0891792
	speed: 0.0210s/iter; left time: 151.3859s
	iters: 300, epoch: 8 | loss: 0.0794379
	speed: 0.0210s/iter; left time: 149.0178s
	iters: 400, epoch: 8 | loss: 0.0846472
	speed: 0.0209s/iter; left time: 146.7876s
	iters: 500, epoch: 8 | loss: 0.1003609
	speed: 0.0210s/iter; left time: 144.8850s
Epoch: 8 cost time: 12.238821268081665
Epoch: 8, Steps: 570 | Train Loss: 0.0865921 Vali Loss: 0.0339551 Test Loss: 0.1166554
Validation loss decreased (0.033980 --> 0.033955).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0524424
	speed: 0.0612s/iter; left time: 412.5142s
	iters: 200, epoch: 9 | loss: 0.0777009
	speed: 0.0211s/iter; left time: 140.0419s
	iters: 300, epoch: 9 | loss: 0.0828364
	speed: 0.0210s/iter; left time: 137.6133s
	iters: 400, epoch: 9 | loss: 0.0816082
	speed: 0.0210s/iter; left time: 135.3715s
	iters: 500, epoch: 9 | loss: 0.0778431
	speed: 0.0210s/iter; left time: 133.2647s
Epoch: 9 cost time: 12.32104778289795
Epoch: 9, Steps: 570 | Train Loss: 0.0863239 Vali Loss: 0.0340197 Test Loss: 0.1164078
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0703812
	speed: 0.0605s/iter; left time: 373.3626s
	iters: 200, epoch: 10 | loss: 0.0600727
	speed: 0.0211s/iter; left time: 127.9195s
	iters: 300, epoch: 10 | loss: 0.1222803
	speed: 0.0211s/iter; left time: 125.9477s
	iters: 400, epoch: 10 | loss: 0.0940767
	speed: 0.0211s/iter; left time: 123.7525s
	iters: 500, epoch: 10 | loss: 0.0836515
	speed: 0.0211s/iter; left time: 121.6088s
Epoch: 10 cost time: 12.307207822799683
Epoch: 10, Steps: 570 | Train Loss: 0.0867250 Vali Loss: 0.0338425 Test Loss: 0.1164990
Validation loss decreased (0.033955 --> 0.033843).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0886704
	speed: 0.0616s/iter; left time: 345.1280s
	iters: 200, epoch: 11 | loss: 0.0949598
	speed: 0.0211s/iter; left time: 116.2663s
	iters: 300, epoch: 11 | loss: 0.0609087
	speed: 0.0211s/iter; left time: 114.0834s
	iters: 400, epoch: 11 | loss: 0.1235714
	speed: 0.0211s/iter; left time: 111.7734s
	iters: 500, epoch: 11 | loss: 0.1064821
	speed: 0.0210s/iter; left time: 109.1169s
Epoch: 11 cost time: 12.351275444030762
Epoch: 11, Steps: 570 | Train Loss: 0.0859769 Vali Loss: 0.0337616 Test Loss: 0.1164080
Validation loss decreased (0.033843 --> 0.033762).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1195657
	speed: 0.0606s/iter; left time: 305.0120s
	iters: 200, epoch: 12 | loss: 0.0771970
	speed: 0.0210s/iter; left time: 103.3625s
	iters: 300, epoch: 12 | loss: 0.0692294
	speed: 0.0209s/iter; left time: 101.2034s
	iters: 400, epoch: 12 | loss: 0.0837279
	speed: 0.0210s/iter; left time: 99.1873s
	iters: 500, epoch: 12 | loss: 0.0855555
	speed: 0.0209s/iter; left time: 96.9875s
Epoch: 12 cost time: 12.267935991287231
Epoch: 12, Steps: 570 | Train Loss: 0.0858482 Vali Loss: 0.0338301 Test Loss: 0.1163966
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0759818
	speed: 0.0629s/iter; left time: 280.4835s
	iters: 200, epoch: 13 | loss: 0.0878199
	speed: 0.0205s/iter; left time: 89.4098s
	iters: 300, epoch: 13 | loss: 0.0670783
	speed: 0.0205s/iter; left time: 87.3390s
	iters: 400, epoch: 13 | loss: 0.1085088
	speed: 0.0205s/iter; left time: 85.1557s
	iters: 500, epoch: 13 | loss: 0.1070844
	speed: 0.0205s/iter; left time: 83.2459s
Epoch: 13 cost time: 12.063522815704346
Epoch: 13, Steps: 570 | Train Loss: 0.0867677 Vali Loss: 0.0338175 Test Loss: 0.1164519
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.0902542
	speed: 0.0579s/iter; left time: 225.3214s
	iters: 200, epoch: 14 | loss: 0.0839087
	speed: 0.0182s/iter; left time: 69.1584s
	iters: 300, epoch: 14 | loss: 0.0895629
	speed: 0.0182s/iter; left time: 67.3035s
	iters: 400, epoch: 14 | loss: 0.0804068
	speed: 0.0182s/iter; left time: 65.4194s
	iters: 500, epoch: 14 | loss: 0.0657523
	speed: 0.0182s/iter; left time: 63.5942s
Epoch: 14 cost time: 10.650235414505005
Epoch: 14, Steps: 570 | Train Loss: 0.0862531 Vali Loss: 0.0338502 Test Loss: 0.1164589
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11655744165182114, mae:0.20830540359020233
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2465455
	speed: 0.0324s/iter; left time: 366.1038s
	iters: 200, epoch: 1 | loss: 0.1742174
	speed: 0.0198s/iter; left time: 221.3247s
	iters: 300, epoch: 1 | loss: 0.2763492
	speed: 0.0183s/iter; left time: 203.2631s
	iters: 400, epoch: 1 | loss: 0.2178470
	speed: 0.0183s/iter; left time: 201.3144s
	iters: 500, epoch: 1 | loss: 0.2626901
	speed: 0.0183s/iter; left time: 199.7825s
Epoch: 1 cost time: 12.047883749008179
Epoch: 1, Steps: 570 | Train Loss: 0.2196197 Vali Loss: 0.0462815 Test Loss: 0.1330467
Validation loss decreased (inf --> 0.046282).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2293462
	speed: 0.0565s/iter; left time: 606.7097s
	iters: 200, epoch: 2 | loss: 0.1865129
	speed: 0.0182s/iter; left time: 193.7774s
	iters: 300, epoch: 2 | loss: 0.3665048
	speed: 0.0183s/iter; left time: 192.2446s
	iters: 400, epoch: 2 | loss: 0.1814012
	speed: 0.0182s/iter; left time: 190.1764s
	iters: 500, epoch: 2 | loss: 0.1074840
	speed: 0.0182s/iter; left time: 188.1639s
Epoch: 2 cost time: 10.697796821594238
Epoch: 2, Steps: 570 | Train Loss: 0.1843974 Vali Loss: 0.0468489 Test Loss: 0.1434171
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1040126
	speed: 0.0557s/iter; left time: 565.9234s
	iters: 200, epoch: 3 | loss: 0.1511192
	speed: 0.0203s/iter; left time: 204.6775s
	iters: 300, epoch: 3 | loss: 0.1757332
	speed: 0.0211s/iter; left time: 210.5087s
	iters: 400, epoch: 3 | loss: 0.1398604
	speed: 0.0211s/iter; left time: 207.8076s
	iters: 500, epoch: 3 | loss: 0.1326717
	speed: 0.0210s/iter; left time: 204.5822s
Epoch: 3 cost time: 11.935862064361572
Epoch: 3, Steps: 570 | Train Loss: 0.1427732 Vali Loss: 0.0422266 Test Loss: 0.1323110
Validation loss decreased (0.046282 --> 0.042227).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0990643
	speed: 0.0609s/iter; left time: 583.8546s
	iters: 200, epoch: 4 | loss: 0.1284356
	speed: 0.0211s/iter; left time: 200.4051s
	iters: 300, epoch: 4 | loss: 0.1189185
	speed: 0.0211s/iter; left time: 197.8686s
	iters: 400, epoch: 4 | loss: 0.1148597
	speed: 0.0211s/iter; left time: 195.9909s
	iters: 500, epoch: 4 | loss: 0.0875525
	speed: 0.0212s/iter; left time: 194.6029s
Epoch: 4 cost time: 12.266483068466187
Epoch: 4, Steps: 570 | Train Loss: 0.1152169 Vali Loss: 0.0403422 Test Loss: 0.1315215
Validation loss decreased (0.042227 --> 0.040342).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0930144
	speed: 0.0589s/iter; left time: 531.2176s
	iters: 200, epoch: 5 | loss: 0.1091283
	speed: 0.0204s/iter; left time: 182.1463s
	iters: 300, epoch: 5 | loss: 0.0675936
	speed: 0.0204s/iter; left time: 180.1528s
	iters: 400, epoch: 5 | loss: 0.0938081
	speed: 0.0204s/iter; left time: 177.9487s
	iters: 500, epoch: 5 | loss: 0.0558497
	speed: 0.0191s/iter; left time: 164.8052s
Epoch: 5 cost time: 11.660802841186523
Epoch: 5, Steps: 570 | Train Loss: 0.1007919 Vali Loss: 0.0410147 Test Loss: 0.1349144
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1119724
	speed: 0.0582s/iter; left time: 491.9399s
	iters: 200, epoch: 6 | loss: 0.0632188
	speed: 0.0181s/iter; left time: 151.5656s
	iters: 300, epoch: 6 | loss: 0.1177115
	speed: 0.0181s/iter; left time: 149.5166s
	iters: 400, epoch: 6 | loss: 0.0846691
	speed: 0.0181s/iter; left time: 147.6917s
	iters: 500, epoch: 6 | loss: 0.0950823
	speed: 0.0181s/iter; left time: 145.8109s
Epoch: 6 cost time: 10.661482810974121
Epoch: 6, Steps: 570 | Train Loss: 0.0944268 Vali Loss: 0.0401300 Test Loss: 0.1352709
Validation loss decreased (0.040342 --> 0.040130).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0799287
	speed: 0.0571s/iter; left time: 450.1676s
	iters: 200, epoch: 7 | loss: 0.0747626
	speed: 0.0182s/iter; left time: 141.3067s
	iters: 300, epoch: 7 | loss: 0.1034898
	speed: 0.0182s/iter; left time: 139.5888s
	iters: 400, epoch: 7 | loss: 0.0954349
	speed: 0.0182s/iter; left time: 137.6212s
	iters: 500, epoch: 7 | loss: 0.0578673
	speed: 0.0181s/iter; left time: 135.7694s
Epoch: 7 cost time: 10.66940450668335
Epoch: 7, Steps: 570 | Train Loss: 0.0923948 Vali Loss: 0.0397917 Test Loss: 0.1350439
Validation loss decreased (0.040130 --> 0.039792).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0772300
	speed: 0.0563s/iter; left time: 411.6069s
	iters: 200, epoch: 8 | loss: 0.0666272
	speed: 0.0181s/iter; left time: 130.6269s
	iters: 300, epoch: 8 | loss: 0.0906120
	speed: 0.0181s/iter; left time: 128.6785s
	iters: 400, epoch: 8 | loss: 0.1087127
	speed: 0.0181s/iter; left time: 126.8598s
	iters: 500, epoch: 8 | loss: 0.0791122
	speed: 0.0181s/iter; left time: 124.9690s
Epoch: 8 cost time: 10.652371168136597
Epoch: 8, Steps: 570 | Train Loss: 0.0900067 Vali Loss: 0.0397980 Test Loss: 0.1351777
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0902390
	speed: 0.0582s/iter; left time: 392.0867s
	iters: 200, epoch: 9 | loss: 0.1244761
	speed: 0.0182s/iter; left time: 121.1688s
	iters: 300, epoch: 9 | loss: 0.1000864
	speed: 0.0182s/iter; left time: 119.1941s
	iters: 400, epoch: 9 | loss: 0.1546550
	speed: 0.0182s/iter; left time: 117.4679s
	iters: 500, epoch: 9 | loss: 0.0599694
	speed: 0.0182s/iter; left time: 115.6064s
Epoch: 9 cost time: 10.722315788269043
Epoch: 9, Steps: 570 | Train Loss: 0.0894911 Vali Loss: 0.0397211 Test Loss: 0.1346833
Validation loss decreased (0.039792 --> 0.039721).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0847079
	speed: 0.0589s/iter; left time: 363.4001s
	iters: 200, epoch: 10 | loss: 0.0722764
	speed: 0.0182s/iter; left time: 110.5794s
	iters: 300, epoch: 10 | loss: 0.0958148
	speed: 0.0182s/iter; left time: 108.8148s
	iters: 400, epoch: 10 | loss: 0.0959902
	speed: 0.0182s/iter; left time: 106.8564s
	iters: 500, epoch: 10 | loss: 0.0901856
	speed: 0.0182s/iter; left time: 105.0173s
Epoch: 10 cost time: 10.688402891159058
Epoch: 10, Steps: 570 | Train Loss: 0.0890617 Vali Loss: 0.0394520 Test Loss: 0.1355194
Validation loss decreased (0.039721 --> 0.039452).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.0883052
	speed: 0.0586s/iter; left time: 328.1863s
	iters: 200, epoch: 11 | loss: 0.0981652
	speed: 0.0182s/iter; left time: 100.0518s
	iters: 300, epoch: 11 | loss: 0.0668945
	speed: 0.0182s/iter; left time: 98.2616s
	iters: 400, epoch: 11 | loss: 0.1120059
	speed: 0.0182s/iter; left time: 96.4966s
	iters: 500, epoch: 11 | loss: 0.0745076
	speed: 0.0182s/iter; left time: 94.5600s
Epoch: 11 cost time: 10.71007227897644
Epoch: 11, Steps: 570 | Train Loss: 0.0892274 Vali Loss: 0.0395513 Test Loss: 0.1355649
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.0855307
	speed: 0.0555s/iter; left time: 279.0495s
	iters: 200, epoch: 12 | loss: 0.1050664
	speed: 0.0182s/iter; left time: 89.7752s
	iters: 300, epoch: 12 | loss: 0.0800592
	speed: 0.0182s/iter; left time: 87.8551s
	iters: 400, epoch: 12 | loss: 0.0910716
	speed: 0.0182s/iter; left time: 86.0254s
	iters: 500, epoch: 12 | loss: 0.0960518
	speed: 0.0182s/iter; left time: 84.2407s
Epoch: 12 cost time: 10.63636040687561
Epoch: 12, Steps: 570 | Train Loss: 0.0887536 Vali Loss: 0.0395426 Test Loss: 0.1356473
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.0758656
	speed: 0.0548s/iter; left time: 244.3714s
	iters: 200, epoch: 13 | loss: 0.0575939
	speed: 0.0181s/iter; left time: 78.9768s
	iters: 300, epoch: 13 | loss: 0.0811126
	speed: 0.0181s/iter; left time: 77.1289s
	iters: 400, epoch: 13 | loss: 0.0636982
	speed: 0.0181s/iter; left time: 75.2688s
	iters: 500, epoch: 13 | loss: 0.0718686
	speed: 0.0181s/iter; left time: 73.4426s
Epoch: 13 cost time: 10.613798141479492
Epoch: 13, Steps: 570 | Train Loss: 0.0880837 Vali Loss: 0.0396148 Test Loss: 0.1357707
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1356518715620041, mae:0.23420971632003784
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2044321
	speed: 0.0348s/iter; left time: 393.7906s
	iters: 200, epoch: 1 | loss: 0.1907370
	speed: 0.0222s/iter; left time: 248.1550s
	iters: 300, epoch: 1 | loss: 0.2209329
	speed: 0.0222s/iter; left time: 246.3069s
	iters: 400, epoch: 1 | loss: 0.3088663
	speed: 0.0222s/iter; left time: 244.3902s
	iters: 500, epoch: 1 | loss: 0.3752808
	speed: 0.0222s/iter; left time: 242.0083s
Epoch: 1 cost time: 13.964753866195679
Epoch: 1, Steps: 570 | Train Loss: 0.2527241 Vali Loss: 0.0623574 Test Loss: 0.1859929
Validation loss decreased (inf --> 0.062357).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3072649
	speed: 0.0677s/iter; left time: 726.4734s
	iters: 200, epoch: 2 | loss: 0.2502496
	speed: 0.0221s/iter; left time: 235.4238s
	iters: 300, epoch: 2 | loss: 0.1918114
	speed: 0.0221s/iter; left time: 232.5461s
	iters: 400, epoch: 2 | loss: 0.3376081
	speed: 0.0221s/iter; left time: 230.8149s
	iters: 500, epoch: 2 | loss: 0.2363885
	speed: 0.0221s/iter; left time: 228.6066s
Epoch: 2 cost time: 12.943378210067749
Epoch: 2, Steps: 570 | Train Loss: 0.2683277 Vali Loss: 0.0661320 Test Loss: 0.1890021
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4923572
	speed: 0.0629s/iter; left time: 639.4905s
	iters: 200, epoch: 3 | loss: 0.1829364
	speed: 0.0222s/iter; left time: 223.0454s
	iters: 300, epoch: 3 | loss: 0.2508573
	speed: 0.0222s/iter; left time: 220.7379s
	iters: 400, epoch: 3 | loss: 0.2537628
	speed: 0.0222s/iter; left time: 218.5207s
	iters: 500, epoch: 3 | loss: 0.1679934
	speed: 0.0222s/iter; left time: 216.8828s
Epoch: 3 cost time: 12.941113233566284
Epoch: 3, Steps: 570 | Train Loss: 0.2455218 Vali Loss: 0.0570564 Test Loss: 0.1525956
Validation loss decreased (0.062357 --> 0.057056).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1775687
	speed: 0.0644s/iter; left time: 617.4761s
	iters: 200, epoch: 4 | loss: 0.1459089
	speed: 0.0237s/iter; left time: 224.5874s
	iters: 300, epoch: 4 | loss: 0.2227755
	speed: 0.0231s/iter; left time: 216.9227s
	iters: 400, epoch: 4 | loss: 0.1869705
	speed: 0.0222s/iter; left time: 206.1780s
	iters: 500, epoch: 4 | loss: 0.2770719
	speed: 0.0223s/iter; left time: 204.6866s
Epoch: 4 cost time: 13.20621657371521
Epoch: 4, Steps: 570 | Train Loss: 0.2214344 Vali Loss: 0.0565339 Test Loss: 0.1514897
Validation loss decreased (0.057056 --> 0.056534).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2272343
	speed: 0.0642s/iter; left time: 578.9842s
	iters: 200, epoch: 5 | loss: 0.1697168
	speed: 0.0222s/iter; left time: 198.3256s
	iters: 300, epoch: 5 | loss: 0.1575013
	speed: 0.0222s/iter; left time: 196.0691s
	iters: 400, epoch: 5 | loss: 0.2007736
	speed: 0.0222s/iter; left time: 193.4654s
	iters: 500, epoch: 5 | loss: 0.2119050
	speed: 0.0222s/iter; left time: 191.3156s
Epoch: 5 cost time: 12.96788763999939
Epoch: 5, Steps: 570 | Train Loss: 0.2082672 Vali Loss: 0.0547199 Test Loss: 0.1453940
Validation loss decreased (0.056534 --> 0.054720).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1648124
	speed: 0.0645s/iter; left time: 545.4505s
	iters: 200, epoch: 6 | loss: 0.3070776
	speed: 0.0221s/iter; left time: 184.8704s
	iters: 300, epoch: 6 | loss: 0.1929084
	speed: 0.0222s/iter; left time: 182.9220s
	iters: 400, epoch: 6 | loss: 0.1536869
	speed: 0.0221s/iter; left time: 180.3386s
	iters: 500, epoch: 6 | loss: 0.2804589
	speed: 0.0222s/iter; left time: 178.4076s
Epoch: 6 cost time: 12.936241388320923
Epoch: 6, Steps: 570 | Train Loss: 0.2023327 Vali Loss: 0.0543583 Test Loss: 0.1462831
Validation loss decreased (0.054720 --> 0.054358).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2472715
	speed: 0.0630s/iter; left time: 496.2784s
	iters: 200, epoch: 7 | loss: 0.1912365
	speed: 0.0222s/iter; left time: 172.5475s
	iters: 300, epoch: 7 | loss: 0.1569330
	speed: 0.0222s/iter; left time: 170.2641s
	iters: 400, epoch: 7 | loss: 0.1843344
	speed: 0.0222s/iter; left time: 167.9421s
	iters: 500, epoch: 7 | loss: 0.2040082
	speed: 0.0222s/iter; left time: 165.7570s
Epoch: 7 cost time: 12.928608179092407
Epoch: 7, Steps: 570 | Train Loss: 0.1976341 Vali Loss: 0.0550024 Test Loss: 0.1458890
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1246326
	speed: 0.0623s/iter; left time: 455.4281s
	iters: 200, epoch: 8 | loss: 0.4012249
	speed: 0.0222s/iter; left time: 159.8991s
	iters: 300, epoch: 8 | loss: 0.1279386
	speed: 0.0222s/iter; left time: 157.5786s
	iters: 400, epoch: 8 | loss: 0.1646966
	speed: 0.0222s/iter; left time: 155.5474s
	iters: 500, epoch: 8 | loss: 0.1723369
	speed: 0.0222s/iter; left time: 153.1679s
Epoch: 8 cost time: 12.937358617782593
Epoch: 8, Steps: 570 | Train Loss: 0.1953455 Vali Loss: 0.0543657 Test Loss: 0.1452569
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1745945
	speed: 0.0636s/iter; left time: 428.4245s
	iters: 200, epoch: 9 | loss: 0.1344898
	speed: 0.0221s/iter; left time: 146.9791s
	iters: 300, epoch: 9 | loss: 0.2274153
	speed: 0.0221s/iter; left time: 144.2567s
	iters: 400, epoch: 9 | loss: 0.1888725
	speed: 0.0221s/iter; left time: 142.0337s
	iters: 500, epoch: 9 | loss: 0.1694360
	speed: 0.0221s/iter; left time: 139.8344s
Epoch: 9 cost time: 13.030063152313232
Epoch: 9, Steps: 570 | Train Loss: 0.1939532 Vali Loss: 0.0545372 Test Loss: 0.1449776
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14646118879318237, mae:0.24671439826488495
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2160419
	speed: 0.0332s/iter; left time: 374.8642s
	iters: 200, epoch: 1 | loss: 0.1162213
	speed: 0.0213s/iter; left time: 238.8341s
	iters: 300, epoch: 1 | loss: 0.1844167
	speed: 0.0213s/iter; left time: 236.5788s
	iters: 400, epoch: 1 | loss: 0.1534699
	speed: 0.0213s/iter; left time: 234.5786s
	iters: 500, epoch: 1 | loss: 0.1646366
	speed: 0.0213s/iter; left time: 232.5264s
Epoch: 1 cost time: 13.395633697509766
Epoch: 1, Steps: 570 | Train Loss: 0.2125935 Vali Loss: 0.0405905 Test Loss: 0.1299499
Validation loss decreased (inf --> 0.040591).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2203218
	speed: 0.0624s/iter; left time: 669.8842s
	iters: 200, epoch: 2 | loss: 0.2456415
	speed: 0.0215s/iter; left time: 228.0922s
	iters: 300, epoch: 2 | loss: 0.5099041
	speed: 0.0214s/iter; left time: 225.5234s
	iters: 400, epoch: 2 | loss: 0.2630272
	speed: 0.0214s/iter; left time: 223.7348s
	iters: 500, epoch: 2 | loss: 0.2143973
	speed: 0.0214s/iter; left time: 221.5816s
Epoch: 2 cost time: 12.534577369689941
Epoch: 2, Steps: 570 | Train Loss: 0.2649165 Vali Loss: 0.0637003 Test Loss: 0.1830065
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2386678
	speed: 0.0625s/iter; left time: 635.1895s
	iters: 200, epoch: 3 | loss: 0.2139221
	speed: 0.0213s/iter; left time: 214.5852s
	iters: 300, epoch: 3 | loss: 0.1634926
	speed: 0.0213s/iter; left time: 212.3975s
	iters: 400, epoch: 3 | loss: 0.1910556
	speed: 0.0213s/iter; left time: 210.2869s
	iters: 500, epoch: 3 | loss: 0.2340789
	speed: 0.0213s/iter; left time: 208.0941s
Epoch: 3 cost time: 12.42756175994873
Epoch: 3, Steps: 570 | Train Loss: 0.2446887 Vali Loss: 0.0576729 Test Loss: 0.1636531
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1887436
	speed: 0.0635s/iter; left time: 609.0140s
	iters: 200, epoch: 4 | loss: 0.2005028
	speed: 0.0233s/iter; left time: 220.9902s
	iters: 300, epoch: 4 | loss: 0.2122133
	speed: 0.0233s/iter; left time: 218.6237s
	iters: 400, epoch: 4 | loss: 0.2909198
	speed: 0.0233s/iter; left time: 216.3010s
	iters: 500, epoch: 4 | loss: 0.1725634
	speed: 0.0233s/iter; left time: 213.9175s
Epoch: 4 cost time: 13.571258783340454
Epoch: 4, Steps: 570 | Train Loss: 0.2258179 Vali Loss: 0.0539668 Test Loss: 0.1522814
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13016191124916077, mae:0.22739572823047638
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2422605
	speed: 0.0344s/iter; left time: 389.2361s
	iters: 200, epoch: 1 | loss: 0.1829510
	speed: 0.0222s/iter; left time: 249.0684s
	iters: 300, epoch: 1 | loss: 0.2373776
	speed: 0.0223s/iter; left time: 247.1206s
	iters: 400, epoch: 1 | loss: 0.3229593
	speed: 0.0223s/iter; left time: 244.8079s
	iters: 500, epoch: 1 | loss: 0.4051868
	speed: 0.0222s/iter; left time: 242.0636s
Epoch: 1 cost time: 13.946796655654907
Epoch: 1, Steps: 570 | Train Loss: 0.2792140 Vali Loss: 0.0759798 Test Loss: 0.2162345
Validation loss decreased (inf --> 0.075980).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2276985
	speed: 0.0616s/iter; left time: 661.3075s
	iters: 200, epoch: 2 | loss: 0.4476156
	speed: 0.0203s/iter; left time: 215.5625s
	iters: 300, epoch: 2 | loss: 0.2548041
	speed: 0.0203s/iter; left time: 213.6173s
	iters: 400, epoch: 2 | loss: 0.1816117
	speed: 0.0203s/iter; left time: 211.4127s
	iters: 500, epoch: 2 | loss: 0.1685787
	speed: 0.0203s/iter; left time: 209.2311s
Epoch: 2 cost time: 11.863142013549805
Epoch: 2, Steps: 570 | Train Loss: 0.2823152 Vali Loss: 0.0623125 Test Loss: 0.1725155
Validation loss decreased (0.075980 --> 0.062312).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1956048
	speed: 0.0625s/iter; left time: 635.3620s
	iters: 200, epoch: 3 | loss: 0.1986732
	speed: 0.0202s/iter; left time: 203.0452s
	iters: 300, epoch: 3 | loss: 0.2300066
	speed: 0.0202s/iter; left time: 201.4185s
	iters: 400, epoch: 3 | loss: 0.2127498
	speed: 0.0202s/iter; left time: 199.0181s
	iters: 500, epoch: 3 | loss: 0.2054931
	speed: 0.0202s/iter; left time: 196.9022s
Epoch: 3 cost time: 11.829272508621216
Epoch: 3, Steps: 570 | Train Loss: 0.2416417 Vali Loss: 0.0628371 Test Loss: 0.1696558
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1648703
	speed: 0.0590s/iter; left time: 565.5856s
	iters: 200, epoch: 4 | loss: 0.4601944
	speed: 0.0202s/iter; left time: 191.4833s
	iters: 300, epoch: 4 | loss: 0.1544110
	speed: 0.0202s/iter; left time: 189.3047s
	iters: 400, epoch: 4 | loss: 0.2180265
	speed: 0.0202s/iter; left time: 187.2272s
	iters: 500, epoch: 4 | loss: 0.1886454
	speed: 0.0201s/iter; left time: 185.0209s
Epoch: 4 cost time: 11.774162769317627
Epoch: 4, Steps: 570 | Train Loss: 0.2286725 Vali Loss: 0.0597612 Test Loss: 0.1620128
Validation loss decreased (0.062312 --> 0.059761).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1822467
	speed: 0.0619s/iter; left time: 558.3106s
	iters: 200, epoch: 5 | loss: 0.2959248
	speed: 0.0216s/iter; left time: 192.9844s
	iters: 300, epoch: 5 | loss: 0.1727977
	speed: 0.0232s/iter; left time: 204.4879s
	iters: 400, epoch: 5 | loss: 0.1904349
	speed: 0.0232s/iter; left time: 202.3166s
	iters: 500, epoch: 5 | loss: 0.2039821
	speed: 0.0232s/iter; left time: 200.0187s
Epoch: 5 cost time: 13.081918239593506
Epoch: 5, Steps: 570 | Train Loss: 0.2188623 Vali Loss: 0.0574483 Test Loss: 0.1568991
Validation loss decreased (0.059761 --> 0.057448).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2260060
	speed: 0.0670s/iter; left time: 566.1330s
	iters: 200, epoch: 6 | loss: 0.2270817
	speed: 0.0233s/iter; left time: 194.5966s
	iters: 300, epoch: 6 | loss: 0.2142158
	speed: 0.0232s/iter; left time: 191.5469s
	iters: 400, epoch: 6 | loss: 0.1900075
	speed: 0.0232s/iter; left time: 189.2476s
	iters: 500, epoch: 6 | loss: 0.2526564
	speed: 0.0232s/iter; left time: 186.6272s
Epoch: 6 cost time: 13.553377389907837
Epoch: 6, Steps: 570 | Train Loss: 0.2127382 Vali Loss: 0.0570407 Test Loss: 0.1548477
Validation loss decreased (0.057448 --> 0.057041).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1727831
	speed: 0.0650s/iter; left time: 511.8919s
	iters: 200, epoch: 7 | loss: 0.2374889
	speed: 0.0232s/iter; left time: 180.3978s
	iters: 300, epoch: 7 | loss: 0.2728970
	speed: 0.0232s/iter; left time: 178.0920s
	iters: 400, epoch: 7 | loss: 0.2354636
	speed: 0.0232s/iter; left time: 176.0367s
	iters: 500, epoch: 7 | loss: 0.1577698
	speed: 0.0232s/iter; left time: 173.6389s
Epoch: 7 cost time: 13.518157243728638
Epoch: 7, Steps: 570 | Train Loss: 0.2092387 Vali Loss: 0.0582214 Test Loss: 0.1559023
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2333621
	speed: 0.0644s/iter; left time: 471.0419s
	iters: 200, epoch: 8 | loss: 0.3190812
	speed: 0.0232s/iter; left time: 167.0594s
	iters: 300, epoch: 8 | loss: 0.2758017
	speed: 0.0232s/iter; left time: 164.9546s
	iters: 400, epoch: 8 | loss: 0.1584807
	speed: 0.0231s/iter; left time: 162.3019s
	iters: 500, epoch: 8 | loss: 0.2110446
	speed: 0.0232s/iter; left time: 160.3319s
Epoch: 8 cost time: 13.521850109100342
Epoch: 8, Steps: 570 | Train Loss: 0.2084264 Vali Loss: 0.0572500 Test Loss: 0.1541620
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1923905
	speed: 0.0644s/iter; left time: 433.9296s
	iters: 200, epoch: 9 | loss: 0.1711386
	speed: 0.0232s/iter; left time: 153.7570s
	iters: 300, epoch: 9 | loss: 0.2769994
	speed: 0.0231s/iter; left time: 151.2511s
	iters: 400, epoch: 9 | loss: 0.1681122
	speed: 0.0231s/iter; left time: 148.8555s
	iters: 500, epoch: 9 | loss: 0.1237359
	speed: 0.0231s/iter; left time: 146.6113s
Epoch: 9 cost time: 13.448994636535645
Epoch: 9, Steps: 570 | Train Loss: 0.2062991 Vali Loss: 0.0573906 Test Loss: 0.1547263
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1550510972738266, mae:0.25246042013168335
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1968861
	speed: 0.0223s/iter; left time: 251.5105s
	iters: 200, epoch: 1 | loss: 0.2074055
	speed: 0.0105s/iter; left time: 117.7557s
	iters: 300, epoch: 1 | loss: 0.2668394
	speed: 0.0105s/iter; left time: 116.9208s
	iters: 400, epoch: 1 | loss: 0.2510618
	speed: 0.0105s/iter; left time: 115.7013s
	iters: 500, epoch: 1 | loss: 0.1887305
	speed: 0.0106s/iter; left time: 115.2722s
Epoch: 1 cost time: 7.230496406555176
Epoch: 1, Steps: 570 | Train Loss: 0.2436748 Vali Loss: 0.0457816 Test Loss: 0.1451397
Validation loss decreased (inf --> 0.045782).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3275155
	speed: 0.0378s/iter; left time: 405.9966s
	iters: 200, epoch: 2 | loss: 0.1967727
	speed: 0.0106s/iter; left time: 112.3138s
	iters: 300, epoch: 2 | loss: 0.1991920
	speed: 0.0106s/iter; left time: 111.2752s
	iters: 400, epoch: 2 | loss: 0.1718873
	speed: 0.0106s/iter; left time: 110.3815s
	iters: 500, epoch: 2 | loss: 0.2023968
	speed: 0.0105s/iter; left time: 108.9513s
Epoch: 2 cost time: 6.342720031738281
Epoch: 2, Steps: 570 | Train Loss: 0.2031243 Vali Loss: 0.0430505 Test Loss: 0.1352728
Validation loss decreased (0.045782 --> 0.043050).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1456728
	speed: 0.0371s/iter; left time: 377.1707s
	iters: 200, epoch: 3 | loss: 0.2073755
	speed: 0.0106s/iter; left time: 106.3063s
	iters: 300, epoch: 3 | loss: 0.1619648
	speed: 0.0106s/iter; left time: 105.7312s
	iters: 400, epoch: 3 | loss: 0.1799439
	speed: 0.0106s/iter; left time: 104.5877s
	iters: 500, epoch: 3 | loss: 0.2282066
	speed: 0.0106s/iter; left time: 103.2700s
Epoch: 3 cost time: 6.340687036514282
Epoch: 3, Steps: 570 | Train Loss: 0.1790444 Vali Loss: 0.0378854 Test Loss: 0.1217924
Validation loss decreased (0.043050 --> 0.037885).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1916265
	speed: 0.0395s/iter; left time: 378.7161s
	iters: 200, epoch: 4 | loss: 0.0987980
	speed: 0.0119s/iter; left time: 112.9162s
	iters: 300, epoch: 4 | loss: 0.1622420
	speed: 0.0119s/iter; left time: 111.8076s
	iters: 400, epoch: 4 | loss: 0.1659676
	speed: 0.0119s/iter; left time: 110.3716s
	iters: 500, epoch: 4 | loss: 0.1543243
	speed: 0.0119s/iter; left time: 109.1986s
Epoch: 4 cost time: 7.094507932662964
Epoch: 4, Steps: 570 | Train Loss: 0.1644141 Vali Loss: 0.0373587 Test Loss: 0.1246603
Validation loss decreased (0.037885 --> 0.037359).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1373155
	speed: 0.0377s/iter; left time: 340.4070s
	iters: 200, epoch: 5 | loss: 0.1544386
	speed: 0.0106s/iter; left time: 94.6474s
	iters: 300, epoch: 5 | loss: 0.1008306
	speed: 0.0106s/iter; left time: 93.6482s
	iters: 400, epoch: 5 | loss: 0.1563086
	speed: 0.0106s/iter; left time: 92.5716s
	iters: 500, epoch: 5 | loss: 0.1853543
	speed: 0.0106s/iter; left time: 91.0413s
Epoch: 5 cost time: 6.3216705322265625
Epoch: 5, Steps: 570 | Train Loss: 0.1551671 Vali Loss: 0.0357990 Test Loss: 0.1252222
Validation loss decreased (0.037359 --> 0.035799).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1380461
	speed: 0.0362s/iter; left time: 306.3121s
	iters: 200, epoch: 6 | loss: 0.1179587
	speed: 0.0106s/iter; left time: 88.1776s
	iters: 300, epoch: 6 | loss: 0.1492406
	speed: 0.0105s/iter; left time: 86.5055s
	iters: 400, epoch: 6 | loss: 0.1771906
	speed: 0.0104s/iter; left time: 84.8026s
	iters: 500, epoch: 6 | loss: 0.1527208
	speed: 0.0104s/iter; left time: 83.8862s
Epoch: 6 cost time: 6.280951023101807
Epoch: 6, Steps: 570 | Train Loss: 0.1508814 Vali Loss: 0.0361586 Test Loss: 0.1267179
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1690600
	speed: 0.0367s/iter; left time: 289.2177s
	iters: 200, epoch: 7 | loss: 0.2181375
	speed: 0.0105s/iter; left time: 81.6168s
	iters: 300, epoch: 7 | loss: 0.1134887
	speed: 0.0105s/iter; left time: 80.4568s
	iters: 400, epoch: 7 | loss: 0.1205991
	speed: 0.0105s/iter; left time: 79.8276s
	iters: 500, epoch: 7 | loss: 0.1330346
	speed: 0.0105s/iter; left time: 78.6729s
Epoch: 7 cost time: 6.260112762451172
Epoch: 7, Steps: 570 | Train Loss: 0.1488097 Vali Loss: 0.0360066 Test Loss: 0.1266913
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1359771
	speed: 0.0368s/iter; left time: 269.0481s
	iters: 200, epoch: 8 | loss: 0.1457441
	speed: 0.0105s/iter; left time: 75.9177s
	iters: 300, epoch: 8 | loss: 0.1882059
	speed: 0.0105s/iter; left time: 74.9331s
	iters: 400, epoch: 8 | loss: 0.2122235
	speed: 0.0105s/iter; left time: 73.9300s
	iters: 500, epoch: 8 | loss: 0.0939350
	speed: 0.0105s/iter; left time: 72.8608s
Epoch: 8 cost time: 6.31174373626709
Epoch: 8, Steps: 570 | Train Loss: 0.1469399 Vali Loss: 0.0357397 Test Loss: 0.1275342
Validation loss decreased (0.035799 --> 0.035740).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2393412
	speed: 0.0363s/iter; left time: 245.0087s
	iters: 200, epoch: 9 | loss: 0.1287752
	speed: 0.0106s/iter; left time: 70.2962s
	iters: 300, epoch: 9 | loss: 0.0813232
	speed: 0.0106s/iter; left time: 69.1659s
	iters: 400, epoch: 9 | loss: 0.1237925
	speed: 0.0106s/iter; left time: 68.1192s
	iters: 500, epoch: 9 | loss: 0.1202961
	speed: 0.0106s/iter; left time: 67.0384s
Epoch: 9 cost time: 6.348202228546143
Epoch: 9, Steps: 570 | Train Loss: 0.1460428 Vali Loss: 0.0362367 Test Loss: 0.1276402
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1430824
	speed: 0.0382s/iter; left time: 235.7023s
	iters: 200, epoch: 10 | loss: 0.1595148
	speed: 0.0105s/iter; left time: 63.7387s
	iters: 300, epoch: 10 | loss: 0.1019429
	speed: 0.0105s/iter; left time: 62.8777s
	iters: 400, epoch: 10 | loss: 0.1213916
	speed: 0.0105s/iter; left time: 61.7939s
	iters: 500, epoch: 10 | loss: 0.2282617
	speed: 0.0104s/iter; left time: 60.1725s
Epoch: 10 cost time: 6.338618755340576
Epoch: 10, Steps: 570 | Train Loss: 0.1460244 Vali Loss: 0.0359605 Test Loss: 0.1277746
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1593354
	speed: 0.0356s/iter; left time: 199.4401s
	iters: 200, epoch: 11 | loss: 0.1470495
	speed: 0.0105s/iter; left time: 57.5566s
	iters: 300, epoch: 11 | loss: 0.1202945
	speed: 0.0105s/iter; left time: 56.6788s
	iters: 400, epoch: 11 | loss: 0.2002390
	speed: 0.0105s/iter; left time: 55.6845s
	iters: 500, epoch: 11 | loss: 0.1476796
	speed: 0.0105s/iter; left time: 54.6795s
Epoch: 11 cost time: 6.259170055389404
Epoch: 11, Steps: 570 | Train Loss: 0.1469775 Vali Loss: 0.0358628 Test Loss: 0.1277538
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1277076005935669, mae:0.22084355354309082
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2401721
	speed: 0.0237s/iter; left time: 267.4126s
	iters: 200, epoch: 1 | loss: 0.2424997
	speed: 0.0112s/iter; left time: 125.6385s
	iters: 300, epoch: 1 | loss: 0.3234658
	speed: 0.0118s/iter; left time: 131.2988s
	iters: 400, epoch: 1 | loss: 0.1961393
	speed: 0.0118s/iter; left time: 130.1446s
	iters: 500, epoch: 1 | loss: 0.1873902
	speed: 0.0107s/iter; left time: 116.8745s
Epoch: 1 cost time: 7.704045057296753
Epoch: 1, Steps: 570 | Train Loss: 0.2151568 Vali Loss: 0.0361725 Test Loss: 0.1191960
Validation loss decreased (inf --> 0.036173).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1610263
	speed: 0.0373s/iter; left time: 400.4697s
	iters: 200, epoch: 2 | loss: 0.2114646
	speed: 0.0104s/iter; left time: 110.9437s
	iters: 300, epoch: 2 | loss: 0.1568907
	speed: 0.0104s/iter; left time: 109.1707s
	iters: 400, epoch: 2 | loss: 0.1601709
	speed: 0.0103s/iter; left time: 107.6690s
	iters: 500, epoch: 2 | loss: 0.1835256
	speed: 0.0103s/iter; left time: 106.0008s
Epoch: 2 cost time: 6.210586071014404
Epoch: 2, Steps: 570 | Train Loss: 0.1871854 Vali Loss: 0.0372932 Test Loss: 0.1156548
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0921855
	speed: 0.0381s/iter; left time: 387.5690s
	iters: 200, epoch: 3 | loss: 0.1439721
	speed: 0.0110s/iter; left time: 110.1907s
	iters: 300, epoch: 3 | loss: 0.2918147
	speed: 0.0104s/iter; left time: 103.5695s
	iters: 400, epoch: 3 | loss: 0.1909704
	speed: 0.0104s/iter; left time: 102.6474s
	iters: 500, epoch: 3 | loss: 0.1056564
	speed: 0.0104s/iter; left time: 101.1697s
Epoch: 3 cost time: 6.407537221908569
Epoch: 3, Steps: 570 | Train Loss: 0.1657281 Vali Loss: 0.0321570 Test Loss: 0.1056891
Validation loss decreased (0.036173 --> 0.032157).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1245359
	speed: 0.0368s/iter; left time: 353.3772s
	iters: 200, epoch: 4 | loss: 0.1304310
	speed: 0.0114s/iter; left time: 107.8577s
	iters: 300, epoch: 4 | loss: 0.0928682
	speed: 0.0109s/iter; left time: 102.7018s
	iters: 400, epoch: 4 | loss: 0.1208657
	speed: 0.0103s/iter; left time: 95.4802s
	iters: 500, epoch: 4 | loss: 0.1988564
	speed: 0.0103s/iter; left time: 94.3402s
Epoch: 4 cost time: 6.369927883148193
Epoch: 4, Steps: 570 | Train Loss: 0.1537255 Vali Loss: 0.0323878 Test Loss: 0.1043980
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1135346
	speed: 0.0396s/iter; left time: 357.1419s
	iters: 200, epoch: 5 | loss: 0.1933572
	speed: 0.0118s/iter; left time: 105.3130s
	iters: 300, epoch: 5 | loss: 0.1349498
	speed: 0.0118s/iter; left time: 104.0932s
	iters: 400, epoch: 5 | loss: 0.1440819
	speed: 0.0118s/iter; left time: 102.9093s
	iters: 500, epoch: 5 | loss: 0.1472165
	speed: 0.0118s/iter; left time: 101.7130s
Epoch: 5 cost time: 7.020961046218872
Epoch: 5, Steps: 570 | Train Loss: 0.1476107 Vali Loss: 0.0316899 Test Loss: 0.1041419
Validation loss decreased (0.032157 --> 0.031690).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1084595
	speed: 0.0402s/iter; left time: 340.0537s
	iters: 200, epoch: 6 | loss: 0.1837830
	speed: 0.0118s/iter; left time: 98.8695s
	iters: 300, epoch: 6 | loss: 0.1503467
	speed: 0.0118s/iter; left time: 97.6613s
	iters: 400, epoch: 6 | loss: 0.1284380
	speed: 0.0118s/iter; left time: 96.4747s
	iters: 500, epoch: 6 | loss: 0.1001743
	speed: 0.0118s/iter; left time: 95.2110s
Epoch: 6 cost time: 7.043618679046631
Epoch: 6, Steps: 570 | Train Loss: 0.1432669 Vali Loss: 0.0317257 Test Loss: 0.1050080
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1394527
	speed: 0.0388s/iter; left time: 305.9851s
	iters: 200, epoch: 7 | loss: 0.1708174
	speed: 0.0118s/iter; left time: 91.9604s
	iters: 300, epoch: 7 | loss: 0.2254554
	speed: 0.0118s/iter; left time: 90.5479s
	iters: 400, epoch: 7 | loss: 0.1847659
	speed: 0.0118s/iter; left time: 89.4757s
	iters: 500, epoch: 7 | loss: 0.1539829
	speed: 0.0118s/iter; left time: 88.4636s
Epoch: 7 cost time: 7.045394420623779
Epoch: 7, Steps: 570 | Train Loss: 0.1421129 Vali Loss: 0.0313872 Test Loss: 0.1043943
Validation loss decreased (0.031690 --> 0.031387).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1260215
	speed: 0.0394s/iter; left time: 288.0099s
	iters: 200, epoch: 8 | loss: 0.0947148
	speed: 0.0118s/iter; left time: 85.0812s
	iters: 300, epoch: 8 | loss: 0.1159244
	speed: 0.0118s/iter; left time: 83.8805s
	iters: 400, epoch: 8 | loss: 0.1393307
	speed: 0.0118s/iter; left time: 82.9178s
	iters: 500, epoch: 8 | loss: 0.0789673
	speed: 0.0118s/iter; left time: 81.6546s
Epoch: 8 cost time: 7.062925100326538
Epoch: 8, Steps: 570 | Train Loss: 0.1416707 Vali Loss: 0.0313756 Test Loss: 0.1045958
Validation loss decreased (0.031387 --> 0.031376).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1174904
	speed: 0.0399s/iter; left time: 268.8533s
	iters: 200, epoch: 9 | loss: 0.1468606
	speed: 0.0119s/iter; left time: 78.7486s
	iters: 300, epoch: 9 | loss: 0.1139230
	speed: 0.0119s/iter; left time: 77.8259s
	iters: 400, epoch: 9 | loss: 0.1485003
	speed: 0.0119s/iter; left time: 76.7478s
	iters: 500, epoch: 9 | loss: 0.1246711
	speed: 0.0110s/iter; left time: 70.0216s
Epoch: 9 cost time: 6.896507501602173
Epoch: 9, Steps: 570 | Train Loss: 0.1395523 Vali Loss: 0.0313584 Test Loss: 0.1043669
Validation loss decreased (0.031376 --> 0.031358).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1400148
	speed: 0.0389s/iter; left time: 240.3028s
	iters: 200, epoch: 10 | loss: 0.1162626
	speed: 0.0117s/iter; left time: 71.2624s
	iters: 300, epoch: 10 | loss: 0.1198061
	speed: 0.0119s/iter; left time: 70.9776s
	iters: 400, epoch: 10 | loss: 0.1005436
	speed: 0.0119s/iter; left time: 69.6409s
	iters: 500, epoch: 10 | loss: 0.1011312
	speed: 0.0119s/iter; left time: 68.7025s
Epoch: 10 cost time: 7.020002841949463
Epoch: 10, Steps: 570 | Train Loss: 0.1411722 Vali Loss: 0.0313830 Test Loss: 0.1042795
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1380363
	speed: 0.0370s/iter; left time: 207.3663s
	iters: 200, epoch: 11 | loss: 0.1670581
	speed: 0.0104s/iter; left time: 57.0864s
	iters: 300, epoch: 11 | loss: 0.1588926
	speed: 0.0104s/iter; left time: 55.9736s
	iters: 400, epoch: 11 | loss: 0.1483600
	speed: 0.0103s/iter; left time: 54.8022s
	iters: 500, epoch: 11 | loss: 0.1227315
	speed: 0.0103s/iter; left time: 53.5605s
Epoch: 11 cost time: 6.219078779220581
Epoch: 11, Steps: 570 | Train Loss: 0.1392189 Vali Loss: 0.0312490 Test Loss: 0.1042706
Validation loss decreased (0.031358 --> 0.031249).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1175639
	speed: 0.0373s/iter; left time: 187.7327s
	iters: 200, epoch: 12 | loss: 0.1478161
	speed: 0.0116s/iter; left time: 57.2001s
	iters: 300, epoch: 12 | loss: 0.1135787
	speed: 0.0104s/iter; left time: 50.1579s
	iters: 400, epoch: 12 | loss: 0.1800499
	speed: 0.0104s/iter; left time: 49.0769s
	iters: 500, epoch: 12 | loss: 0.1252864
	speed: 0.0104s/iter; left time: 48.0171s
Epoch: 12 cost time: 6.45947003364563
Epoch: 12, Steps: 570 | Train Loss: 0.1398091 Vali Loss: 0.0313090 Test Loss: 0.1042849
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2295697
	speed: 0.0367s/iter; left time: 163.7777s
	iters: 200, epoch: 13 | loss: 0.1836542
	speed: 0.0104s/iter; left time: 45.2191s
	iters: 300, epoch: 13 | loss: 0.1145843
	speed: 0.0104s/iter; left time: 44.1456s
	iters: 400, epoch: 13 | loss: 0.1641874
	speed: 0.0103s/iter; left time: 42.8174s
	iters: 500, epoch: 13 | loss: 0.1717600
	speed: 0.0103s/iter; left time: 41.7636s
Epoch: 13 cost time: 6.220175266265869
Epoch: 13, Steps: 570 | Train Loss: 0.1398790 Vali Loss: 0.0312312 Test Loss: 0.1042820
Validation loss decreased (0.031249 --> 0.031231).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1311188
	speed: 0.0369s/iter; left time: 143.5396s
	iters: 200, epoch: 14 | loss: 0.1039703
	speed: 0.0114s/iter; left time: 43.3602s
	iters: 300, epoch: 14 | loss: 0.1311249
	speed: 0.0118s/iter; left time: 43.6976s
	iters: 400, epoch: 14 | loss: 0.1338442
	speed: 0.0118s/iter; left time: 42.4576s
	iters: 500, epoch: 14 | loss: 0.1419042
	speed: 0.0118s/iter; left time: 41.1697s
Epoch: 14 cost time: 6.883718729019165
Epoch: 14, Steps: 570 | Train Loss: 0.1398163 Vali Loss: 0.0312761 Test Loss: 0.1042791
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.0882273
	speed: 0.0397s/iter; left time: 131.9156s
	iters: 200, epoch: 15 | loss: 0.1478414
	speed: 0.0119s/iter; left time: 38.2137s
	iters: 300, epoch: 15 | loss: 0.1274982
	speed: 0.0118s/iter; left time: 36.8663s
	iters: 400, epoch: 15 | loss: 0.1245105
	speed: 0.0118s/iter; left time: 35.7140s
	iters: 500, epoch: 15 | loss: 0.1308725
	speed: 0.0118s/iter; left time: 34.5295s
Epoch: 15 cost time: 7.033627986907959
Epoch: 15, Steps: 570 | Train Loss: 0.1395391 Vali Loss: 0.0312022 Test Loss: 0.1042811
Validation loss decreased (0.031231 --> 0.031202).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.2173437
	speed: 0.0382s/iter; left time: 105.1200s
	iters: 200, epoch: 16 | loss: 0.1206843
	speed: 0.0102s/iter; left time: 27.1419s
	iters: 300, epoch: 16 | loss: 0.1893770
	speed: 0.0118s/iter; left time: 30.0912s
	iters: 400, epoch: 16 | loss: 0.1291029
	speed: 0.0118s/iter; left time: 28.8636s
	iters: 500, epoch: 16 | loss: 0.2286672
	speed: 0.0118s/iter; left time: 27.7066s
Epoch: 16 cost time: 6.72833776473999
Epoch: 16, Steps: 570 | Train Loss: 0.1400929 Vali Loss: 0.0311803 Test Loss: 0.1042822
Validation loss decreased (0.031202 --> 0.031180).  Saving model ...
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1043478
	speed: 0.0388s/iter; left time: 84.5351s
	iters: 200, epoch: 17 | loss: 0.1241303
	speed: 0.0118s/iter; left time: 24.5320s
	iters: 300, epoch: 17 | loss: 0.1408147
	speed: 0.0118s/iter; left time: 23.3598s
	iters: 400, epoch: 17 | loss: 0.1139410
	speed: 0.0118s/iter; left time: 22.1875s
	iters: 500, epoch: 17 | loss: 0.0959115
	speed: 0.0111s/iter; left time: 19.7775s
Epoch: 17 cost time: 6.854817628860474
Epoch: 17, Steps: 570 | Train Loss: 0.1397438 Vali Loss: 0.0313544 Test Loss: 0.1042828
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1547170
	speed: 0.0370s/iter; left time: 59.5919s
	iters: 200, epoch: 18 | loss: 0.1407096
	speed: 0.0103s/iter; left time: 15.5392s
	iters: 300, epoch: 18 | loss: 0.1202417
	speed: 0.0111s/iter; left time: 15.6139s
	iters: 400, epoch: 18 | loss: 0.2134871
	speed: 0.0103s/iter; left time: 13.5048s
	iters: 500, epoch: 18 | loss: 0.1240891
	speed: 0.0103s/iter; left time: 12.4882s
Epoch: 18 cost time: 6.249206304550171
Epoch: 18, Steps: 570 | Train Loss: 0.1396246 Vali Loss: 0.0312675 Test Loss: 0.1042829
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.814697265625e-09
	iters: 100, epoch: 19 | loss: 0.1086819
	speed: 0.0373s/iter; left time: 38.8543s
	iters: 200, epoch: 19 | loss: 0.1497446
	speed: 0.0104s/iter; left time: 9.7665s
	iters: 300, epoch: 19 | loss: 0.1158870
	speed: 0.0109s/iter; left time: 9.1455s
	iters: 400, epoch: 19 | loss: 0.1645359
	speed: 0.0116s/iter; left time: 8.5938s
	iters: 500, epoch: 19 | loss: 0.1304467
	speed: 0.0116s/iter; left time: 7.4132s
Epoch: 19 cost time: 6.631243944168091
Epoch: 19, Steps: 570 | Train Loss: 0.1395322 Vali Loss: 0.0313423 Test Loss: 0.1042826
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1044272854924202, mae:0.19677524268627167
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2458244
	speed: 0.0222s/iter; left time: 250.5426s
	iters: 200, epoch: 1 | loss: 0.1580599
	speed: 0.0103s/iter; left time: 115.7182s
	iters: 300, epoch: 1 | loss: 0.1607421
	speed: 0.0104s/iter; left time: 114.9211s
	iters: 400, epoch: 1 | loss: 0.1947172
	speed: 0.0103s/iter; left time: 113.5780s
	iters: 500, epoch: 1 | loss: 0.2462651
	speed: 0.0103s/iter; left time: 112.6955s
Epoch: 1 cost time: 7.1285459995269775
Epoch: 1, Steps: 570 | Train Loss: 0.2496192 Vali Loss: 0.0448467 Test Loss: 0.1367395
Validation loss decreased (inf --> 0.044847).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2090575
	speed: 0.0364s/iter; left time: 390.2529s
	iters: 200, epoch: 2 | loss: 0.2855562
	speed: 0.0104s/iter; left time: 110.2118s
	iters: 300, epoch: 2 | loss: 0.1796440
	speed: 0.0103s/iter; left time: 108.6663s
	iters: 400, epoch: 2 | loss: 0.3255115
	speed: 0.0103s/iter; left time: 107.8336s
	iters: 500, epoch: 2 | loss: 0.2540377
	speed: 0.0103s/iter; left time: 106.7753s
Epoch: 2 cost time: 6.18909215927124
Epoch: 2, Steps: 570 | Train Loss: 0.2090411 Vali Loss: 0.0425315 Test Loss: 0.1379918
Validation loss decreased (0.044847 --> 0.042531).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1236370
	speed: 0.0376s/iter; left time: 381.8572s
	iters: 200, epoch: 3 | loss: 0.1724854
	speed: 0.0103s/iter; left time: 103.9433s
	iters: 300, epoch: 3 | loss: 0.2191168
	speed: 0.0104s/iter; left time: 103.2758s
	iters: 400, epoch: 3 | loss: 0.1433497
	speed: 0.0103s/iter; left time: 101.7128s
	iters: 500, epoch: 3 | loss: 0.1347058
	speed: 0.0103s/iter; left time: 100.5048s
Epoch: 3 cost time: 6.29404354095459
Epoch: 3, Steps: 570 | Train Loss: 0.1822572 Vali Loss: 0.0381314 Test Loss: 0.1287609
Validation loss decreased (0.042531 --> 0.038131).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0993757
	speed: 0.0369s/iter; left time: 353.6213s
	iters: 200, epoch: 4 | loss: 0.1030221
	speed: 0.0103s/iter; left time: 97.9425s
	iters: 300, epoch: 4 | loss: 0.1255772
	speed: 0.0103s/iter; left time: 96.9451s
	iters: 400, epoch: 4 | loss: 0.1874091
	speed: 0.0103s/iter; left time: 95.8324s
	iters: 500, epoch: 4 | loss: 0.1362787
	speed: 0.0103s/iter; left time: 94.9608s
Epoch: 4 cost time: 6.180901765823364
Epoch: 4, Steps: 570 | Train Loss: 0.1654112 Vali Loss: 0.0390523 Test Loss: 0.1291916
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1629340
	speed: 0.0353s/iter; left time: 318.3818s
	iters: 200, epoch: 5 | loss: 0.1039051
	speed: 0.0102s/iter; left time: 91.3596s
	iters: 300, epoch: 5 | loss: 0.1660782
	speed: 0.0103s/iter; left time: 90.7414s
	iters: 400, epoch: 5 | loss: 0.1498400
	speed: 0.0103s/iter; left time: 89.6274s
	iters: 500, epoch: 5 | loss: 0.2172457
	speed: 0.0102s/iter; left time: 88.2993s
Epoch: 5 cost time: 6.123126745223999
Epoch: 5, Steps: 570 | Train Loss: 0.1577477 Vali Loss: 0.0375868 Test Loss: 0.1292249
Validation loss decreased (0.038131 --> 0.037587).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1206211
	speed: 0.0376s/iter; left time: 317.9655s
	iters: 200, epoch: 6 | loss: 0.1372995
	speed: 0.0116s/iter; left time: 96.8615s
	iters: 300, epoch: 6 | loss: 0.1432529
	speed: 0.0116s/iter; left time: 95.8719s
	iters: 400, epoch: 6 | loss: 0.1195650
	speed: 0.0116s/iter; left time: 94.6313s
	iters: 500, epoch: 6 | loss: 0.1516001
	speed: 0.0107s/iter; left time: 86.0623s
Epoch: 6 cost time: 6.7443482875823975
Epoch: 6, Steps: 570 | Train Loss: 0.1522886 Vali Loss: 0.0371695 Test Loss: 0.1265572
Validation loss decreased (0.037587 --> 0.037169).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1134902
	speed: 0.0374s/iter; left time: 294.9613s
	iters: 200, epoch: 7 | loss: 0.1240653
	speed: 0.0103s/iter; left time: 80.3330s
	iters: 300, epoch: 7 | loss: 0.1308912
	speed: 0.0103s/iter; left time: 79.4471s
	iters: 400, epoch: 7 | loss: 0.1020128
	speed: 0.0103s/iter; left time: 78.4002s
	iters: 500, epoch: 7 | loss: 0.1568721
	speed: 0.0103s/iter; left time: 77.2060s
Epoch: 7 cost time: 6.162172555923462
Epoch: 7, Steps: 570 | Train Loss: 0.1493799 Vali Loss: 0.0368687 Test Loss: 0.1266420
Validation loss decreased (0.037169 --> 0.036869).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1191704
	speed: 0.0355s/iter; left time: 259.8620s
	iters: 200, epoch: 8 | loss: 0.1438675
	speed: 0.0103s/iter; left time: 74.5605s
	iters: 300, epoch: 8 | loss: 0.1819857
	speed: 0.0103s/iter; left time: 73.5334s
	iters: 400, epoch: 8 | loss: 0.1481585
	speed: 0.0104s/iter; left time: 72.5717s
	iters: 500, epoch: 8 | loss: 0.1317616
	speed: 0.0103s/iter; left time: 71.4538s
Epoch: 8 cost time: 6.203297853469849
Epoch: 8, Steps: 570 | Train Loss: 0.1479293 Vali Loss: 0.0369548 Test Loss: 0.1264471
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1167659
	speed: 0.0371s/iter; left time: 250.1164s
	iters: 200, epoch: 9 | loss: 0.1701135
	speed: 0.0104s/iter; left time: 69.0401s
	iters: 300, epoch: 9 | loss: 0.1141123
	speed: 0.0103s/iter; left time: 67.5538s
	iters: 400, epoch: 9 | loss: 0.1052207
	speed: 0.0103s/iter; left time: 66.4365s
	iters: 500, epoch: 9 | loss: 0.1552950
	speed: 0.0103s/iter; left time: 65.6153s
Epoch: 9 cost time: 6.176050424575806
Epoch: 9, Steps: 570 | Train Loss: 0.1471686 Vali Loss: 0.0371080 Test Loss: 0.1267642
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1323274
	speed: 0.0378s/iter; left time: 233.0438s
	iters: 200, epoch: 10 | loss: 0.2113402
	speed: 0.0104s/iter; left time: 63.1022s
	iters: 300, epoch: 10 | loss: 0.2047139
	speed: 0.0104s/iter; left time: 61.8963s
	iters: 400, epoch: 10 | loss: 0.1622301
	speed: 0.0104s/iter; left time: 60.8663s
	iters: 500, epoch: 10 | loss: 0.1510198
	speed: 0.0104s/iter; left time: 60.0541s
Epoch: 10 cost time: 6.226138353347778
Epoch: 10, Steps: 570 | Train Loss: 0.1486454 Vali Loss: 0.0370910 Test Loss: 0.1269608
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12679612636566162, mae:0.22187824547290802
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3012963
	speed: 0.0236s/iter; left time: 266.2320s
	iters: 200, epoch: 1 | loss: 0.2677741
	speed: 0.0118s/iter; left time: 132.7142s
	iters: 300, epoch: 1 | loss: 0.1750219
	speed: 0.0119s/iter; left time: 131.6591s
	iters: 400, epoch: 1 | loss: 0.1297865
	speed: 0.0118s/iter; left time: 130.3185s
	iters: 500, epoch: 1 | loss: 0.2133226
	speed: 0.0118s/iter; left time: 129.1650s
Epoch: 1 cost time: 7.972729921340942
Epoch: 1, Steps: 570 | Train Loss: 0.2574803 Vali Loss: 0.0458579 Test Loss: 0.1352860
Validation loss decreased (inf --> 0.045858).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1982875
	speed: 0.0409s/iter; left time: 439.1126s
	iters: 200, epoch: 2 | loss: 0.1828269
	speed: 0.0118s/iter; left time: 125.3966s
	iters: 300, epoch: 2 | loss: 0.2175472
	speed: 0.0118s/iter; left time: 124.1808s
	iters: 400, epoch: 2 | loss: 0.1286643
	speed: 0.0118s/iter; left time: 123.0639s
	iters: 500, epoch: 2 | loss: 0.2117110
	speed: 0.0118s/iter; left time: 121.8574s
Epoch: 2 cost time: 7.171096324920654
Epoch: 2, Steps: 570 | Train Loss: 0.2258754 Vali Loss: 0.0447057 Test Loss: 0.1362181
Validation loss decreased (0.045858 --> 0.044706).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2756763
	speed: 0.0400s/iter; left time: 406.8645s
	iters: 200, epoch: 3 | loss: 0.2064056
	speed: 0.0128s/iter; left time: 128.3263s
	iters: 300, epoch: 3 | loss: 0.1095314
	speed: 0.0118s/iter; left time: 117.9139s
	iters: 400, epoch: 3 | loss: 0.2068678
	speed: 0.0119s/iter; left time: 117.2749s
	iters: 500, epoch: 3 | loss: 0.2011012
	speed: 0.0118s/iter; left time: 115.3225s
Epoch: 3 cost time: 7.277749300003052
Epoch: 3, Steps: 570 | Train Loss: 0.2037236 Vali Loss: 0.0462443 Test Loss: 0.1363997
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1503361
	speed: 0.0395s/iter; left time: 378.3864s
	iters: 200, epoch: 4 | loss: 0.2408571
	speed: 0.0119s/iter; left time: 112.5396s
	iters: 300, epoch: 4 | loss: 0.1057899
	speed: 0.0119s/iter; left time: 111.3208s
	iters: 400, epoch: 4 | loss: 0.1237857
	speed: 0.0118s/iter; left time: 110.0956s
	iters: 500, epoch: 4 | loss: 0.1619836
	speed: 0.0118s/iter; left time: 108.9041s
Epoch: 4 cost time: 7.0587286949157715
Epoch: 4, Steps: 570 | Train Loss: 0.1848698 Vali Loss: 0.0414682 Test Loss: 0.1244780
Validation loss decreased (0.044706 --> 0.041468).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1547678
	speed: 0.0397s/iter; left time: 358.3900s
	iters: 200, epoch: 5 | loss: 0.1490418
	speed: 0.0118s/iter; left time: 105.3133s
	iters: 300, epoch: 5 | loss: 0.2137638
	speed: 0.0118s/iter; left time: 104.1030s
	iters: 400, epoch: 5 | loss: 0.1746981
	speed: 0.0118s/iter; left time: 102.9757s
	iters: 500, epoch: 5 | loss: 0.1618993
	speed: 0.0118s/iter; left time: 101.7525s
Epoch: 5 cost time: 7.062108039855957
Epoch: 5, Steps: 570 | Train Loss: 0.1739019 Vali Loss: 0.0393822 Test Loss: 0.1224011
Validation loss decreased (0.041468 --> 0.039382).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1413294
	speed: 0.0397s/iter; left time: 335.6641s
	iters: 200, epoch: 6 | loss: 0.0935599
	speed: 0.0119s/iter; left time: 99.3474s
	iters: 300, epoch: 6 | loss: 0.2263413
	speed: 0.0119s/iter; left time: 98.0174s
	iters: 400, epoch: 6 | loss: 0.1823796
	speed: 0.0119s/iter; left time: 96.7480s
	iters: 500, epoch: 6 | loss: 0.1201744
	speed: 0.0119s/iter; left time: 95.6212s
Epoch: 6 cost time: 7.0867040157318115
Epoch: 6, Steps: 570 | Train Loss: 0.1673662 Vali Loss: 0.0386579 Test Loss: 0.1205866
Validation loss decreased (0.039382 --> 0.038658).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1570462
	speed: 0.0407s/iter; left time: 320.8636s
	iters: 200, epoch: 7 | loss: 0.1613402
	speed: 0.0119s/iter; left time: 92.2309s
	iters: 300, epoch: 7 | loss: 0.1535271
	speed: 0.0119s/iter; left time: 91.1234s
	iters: 400, epoch: 7 | loss: 0.1166422
	speed: 0.0119s/iter; left time: 90.0093s
	iters: 500, epoch: 7 | loss: 0.1554347
	speed: 0.0119s/iter; left time: 88.7571s
Epoch: 7 cost time: 7.095490217208862
Epoch: 7, Steps: 570 | Train Loss: 0.1631525 Vali Loss: 0.0386661 Test Loss: 0.1209979
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0983596
	speed: 0.0405s/iter; left time: 296.3244s
	iters: 200, epoch: 8 | loss: 0.1509856
	speed: 0.0129s/iter; left time: 93.0613s
	iters: 300, epoch: 8 | loss: 0.1772835
	speed: 0.0129s/iter; left time: 91.9275s
	iters: 400, epoch: 8 | loss: 0.1319452
	speed: 0.0130s/iter; left time: 90.9676s
	iters: 500, epoch: 8 | loss: 0.1221954
	speed: 0.0129s/iter; left time: 89.2086s
Epoch: 8 cost time: 7.684610843658447
Epoch: 8, Steps: 570 | Train Loss: 0.1622830 Vali Loss: 0.0382901 Test Loss: 0.1199921
Validation loss decreased (0.038658 --> 0.038290).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1114881
	speed: 0.0409s/iter; left time: 275.7673s
	iters: 200, epoch: 9 | loss: 0.1543981
	speed: 0.0118s/iter; left time: 78.6380s
	iters: 300, epoch: 9 | loss: 0.1817339
	speed: 0.0119s/iter; left time: 77.6167s
	iters: 400, epoch: 9 | loss: 0.1271408
	speed: 0.0118s/iter; left time: 76.2941s
	iters: 500, epoch: 9 | loss: 0.1836076
	speed: 0.0119s/iter; left time: 75.1612s
Epoch: 9 cost time: 7.084026098251343
Epoch: 9, Steps: 570 | Train Loss: 0.1617940 Vali Loss: 0.0380872 Test Loss: 0.1199515
Validation loss decreased (0.038290 --> 0.038087).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1570071
	speed: 0.0395s/iter; left time: 244.0621s
	iters: 200, epoch: 10 | loss: 0.1784642
	speed: 0.0118s/iter; left time: 71.7151s
	iters: 300, epoch: 10 | loss: 0.1366245
	speed: 0.0118s/iter; left time: 70.6905s
	iters: 400, epoch: 10 | loss: 0.1409702
	speed: 0.0118s/iter; left time: 69.4661s
	iters: 500, epoch: 10 | loss: 0.1993697
	speed: 0.0118s/iter; left time: 68.2208s
Epoch: 10 cost time: 7.046705007553101
Epoch: 10, Steps: 570 | Train Loss: 0.1603146 Vali Loss: 0.0381728 Test Loss: 0.1202390
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1282211
	speed: 0.0402s/iter; left time: 225.1029s
	iters: 200, epoch: 11 | loss: 0.2455364
	speed: 0.0120s/iter; left time: 65.7936s
	iters: 300, epoch: 11 | loss: 0.1538334
	speed: 0.0119s/iter; left time: 64.1864s
	iters: 400, epoch: 11 | loss: 0.1733185
	speed: 0.0119s/iter; left time: 63.0029s
	iters: 500, epoch: 11 | loss: 0.2067696
	speed: 0.0119s/iter; left time: 61.7831s
Epoch: 11 cost time: 7.1839683055877686
Epoch: 11, Steps: 570 | Train Loss: 0.1596519 Vali Loss: 0.0382238 Test Loss: 0.1203443
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1390537
	speed: 0.0413s/iter; left time: 208.0253s
	iters: 200, epoch: 12 | loss: 0.1245567
	speed: 0.0129s/iter; left time: 63.6074s
	iters: 300, epoch: 12 | loss: 0.1152004
	speed: 0.0129s/iter; left time: 62.3250s
	iters: 400, epoch: 12 | loss: 0.1446932
	speed: 0.0129s/iter; left time: 61.0293s
	iters: 500, epoch: 12 | loss: 0.1685894
	speed: 0.0122s/iter; left time: 56.6884s
Epoch: 12 cost time: 7.500365495681763
Epoch: 12, Steps: 570 | Train Loss: 0.1602082 Vali Loss: 0.0383167 Test Loss: 0.1203712
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12011267244815826, mae:0.2147633582353592
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1519469
	speed: 0.0233s/iter; left time: 263.5850s
	iters: 200, epoch: 1 | loss: 0.3518038
	speed: 0.0115s/iter; left time: 128.8856s
	iters: 300, epoch: 1 | loss: 0.1749141
	speed: 0.0115s/iter; left time: 127.8302s
	iters: 400, epoch: 1 | loss: 0.2966926
	speed: 0.0115s/iter; left time: 126.5019s
	iters: 500, epoch: 1 | loss: 0.1596343
	speed: 0.0115s/iter; left time: 125.4803s
Epoch: 1 cost time: 7.786570072174072
Epoch: 1, Steps: 570 | Train Loss: 0.2292013 Vali Loss: 0.0412115 Test Loss: 0.1274067
Validation loss decreased (inf --> 0.041211).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1706311
	speed: 0.0414s/iter; left time: 443.8939s
	iters: 200, epoch: 2 | loss: 0.1401508
	speed: 0.0126s/iter; left time: 133.6156s
	iters: 300, epoch: 2 | loss: 0.1847728
	speed: 0.0126s/iter; left time: 132.7553s
	iters: 400, epoch: 2 | loss: 0.2843027
	speed: 0.0126s/iter; left time: 131.7191s
	iters: 500, epoch: 2 | loss: 0.2906266
	speed: 0.0117s/iter; left time: 120.8972s
Epoch: 2 cost time: 7.355028390884399
Epoch: 2, Steps: 570 | Train Loss: 0.2022052 Vali Loss: 0.0417904 Test Loss: 0.1300673
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1933681
	speed: 0.0377s/iter; left time: 383.1887s
	iters: 200, epoch: 3 | loss: 0.0985367
	speed: 0.0115s/iter; left time: 115.4813s
	iters: 300, epoch: 3 | loss: 0.1996156
	speed: 0.0115s/iter; left time: 114.3173s
	iters: 400, epoch: 3 | loss: 0.1665078
	speed: 0.0115s/iter; left time: 113.5254s
	iters: 500, epoch: 3 | loss: 0.2089575
	speed: 0.0115s/iter; left time: 112.0292s
Epoch: 3 cost time: 6.827014923095703
Epoch: 3, Steps: 570 | Train Loss: 0.1803595 Vali Loss: 0.0353008 Test Loss: 0.1156385
Validation loss decreased (0.041211 --> 0.035301).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1596104
	speed: 0.0391s/iter; left time: 375.1551s
	iters: 200, epoch: 4 | loss: 0.1095146
	speed: 0.0115s/iter; left time: 109.0038s
	iters: 300, epoch: 4 | loss: 0.0954783
	speed: 0.0115s/iter; left time: 107.8649s
	iters: 400, epoch: 4 | loss: 0.1333924
	speed: 0.0115s/iter; left time: 106.7529s
	iters: 500, epoch: 4 | loss: 0.1625584
	speed: 0.0115s/iter; left time: 105.6813s
Epoch: 4 cost time: 6.873661756515503
Epoch: 4, Steps: 570 | Train Loss: 0.1650652 Vali Loss: 0.0338985 Test Loss: 0.1111508
Validation loss decreased (0.035301 --> 0.033899).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1666282
	speed: 0.0388s/iter; left time: 349.7922s
	iters: 200, epoch: 5 | loss: 0.1077879
	speed: 0.0115s/iter; left time: 102.7434s
	iters: 300, epoch: 5 | loss: 0.2390414
	speed: 0.0115s/iter; left time: 101.4003s
	iters: 400, epoch: 5 | loss: 0.1366075
	speed: 0.0115s/iter; left time: 100.4077s
	iters: 500, epoch: 5 | loss: 0.1202177
	speed: 0.0115s/iter; left time: 99.2298s
Epoch: 5 cost time: 6.872446775436401
Epoch: 5, Steps: 570 | Train Loss: 0.1558943 Vali Loss: 0.0339489 Test Loss: 0.1121132
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1796040
	speed: 0.0382s/iter; left time: 323.1573s
	iters: 200, epoch: 6 | loss: 0.1611378
	speed: 0.0115s/iter; left time: 96.0036s
	iters: 300, epoch: 6 | loss: 0.1117627
	speed: 0.0115s/iter; left time: 94.6717s
	iters: 400, epoch: 6 | loss: 0.1110432
	speed: 0.0115s/iter; left time: 93.7835s
	iters: 500, epoch: 6 | loss: 0.1269647
	speed: 0.0115s/iter; left time: 92.5573s
Epoch: 6 cost time: 6.859149217605591
Epoch: 6, Steps: 570 | Train Loss: 0.1512940 Vali Loss: 0.0335551 Test Loss: 0.1112797
Validation loss decreased (0.033899 --> 0.033555).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1086403
	speed: 0.0381s/iter; left time: 300.2245s
	iters: 200, epoch: 7 | loss: 0.1870593
	speed: 0.0115s/iter; left time: 89.3654s
	iters: 300, epoch: 7 | loss: 0.0947685
	speed: 0.0115s/iter; left time: 88.2036s
	iters: 400, epoch: 7 | loss: 0.1145303
	speed: 0.0115s/iter; left time: 87.1263s
	iters: 500, epoch: 7 | loss: 0.1414022
	speed: 0.0115s/iter; left time: 85.7781s
Epoch: 7 cost time: 6.852989435195923
Epoch: 7, Steps: 570 | Train Loss: 0.1482953 Vali Loss: 0.0331711 Test Loss: 0.1111351
Validation loss decreased (0.033555 --> 0.033171).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1101499
	speed: 0.0399s/iter; left time: 291.5127s
	iters: 200, epoch: 8 | loss: 0.1743105
	speed: 0.0126s/iter; left time: 90.9293s
	iters: 300, epoch: 8 | loss: 0.1020674
	speed: 0.0126s/iter; left time: 89.8658s
	iters: 400, epoch: 8 | loss: 0.1296077
	speed: 0.0126s/iter; left time: 88.0840s
	iters: 500, epoch: 8 | loss: 0.1146621
	speed: 0.0120s/iter; left time: 82.9420s
Epoch: 8 cost time: 7.365458965301514
Epoch: 8, Steps: 570 | Train Loss: 0.1471755 Vali Loss: 0.0333272 Test Loss: 0.1113495
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2292286
	speed: 0.0394s/iter; left time: 265.5992s
	iters: 200, epoch: 9 | loss: 0.1055641
	speed: 0.0126s/iter; left time: 83.9967s
	iters: 300, epoch: 9 | loss: 0.1617718
	speed: 0.0126s/iter; left time: 82.4814s
	iters: 400, epoch: 9 | loss: 0.1685493
	speed: 0.0125s/iter; left time: 80.8208s
	iters: 500, epoch: 9 | loss: 0.2229301
	speed: 0.0115s/iter; left time: 72.9083s
Epoch: 9 cost time: 7.310041666030884
Epoch: 9, Steps: 570 | Train Loss: 0.1456881 Vali Loss: 0.0330472 Test Loss: 0.1112786
Validation loss decreased (0.033171 --> 0.033047).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1415712
	speed: 0.0414s/iter; left time: 255.3575s
	iters: 200, epoch: 10 | loss: 0.1169592
	speed: 0.0126s/iter; left time: 76.6677s
	iters: 300, epoch: 10 | loss: 0.1292818
	speed: 0.0126s/iter; left time: 75.3224s
	iters: 400, epoch: 10 | loss: 0.1493463
	speed: 0.0126s/iter; left time: 73.9930s
	iters: 500, epoch: 10 | loss: 0.1628127
	speed: 0.0126s/iter; left time: 72.5650s
Epoch: 10 cost time: 7.508484363555908
Epoch: 10, Steps: 570 | Train Loss: 0.1465767 Vali Loss: 0.0331408 Test Loss: 0.1112651
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1133842
	speed: 0.0398s/iter; left time: 222.8890s
	iters: 200, epoch: 11 | loss: 0.1636380
	speed: 0.0126s/iter; left time: 69.3769s
	iters: 300, epoch: 11 | loss: 0.1353102
	speed: 0.0121s/iter; left time: 65.5575s
	iters: 400, epoch: 11 | loss: 0.1801481
	speed: 0.0115s/iter; left time: 61.1737s
	iters: 500, epoch: 11 | loss: 0.2217366
	speed: 0.0115s/iter; left time: 60.0034s
Epoch: 11 cost time: 7.143402576446533
Epoch: 11, Steps: 570 | Train Loss: 0.1468188 Vali Loss: 0.0330274 Test Loss: 0.1112319
Validation loss decreased (0.033047 --> 0.033027).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1327773
	speed: 0.0396s/iter; left time: 199.3454s
	iters: 200, epoch: 12 | loss: 0.1372503
	speed: 0.0126s/iter; left time: 62.1709s
	iters: 300, epoch: 12 | loss: 0.1172687
	speed: 0.0126s/iter; left time: 60.9538s
	iters: 400, epoch: 12 | loss: 0.2106243
	speed: 0.0126s/iter; left time: 59.5135s
	iters: 500, epoch: 12 | loss: 0.1307931
	speed: 0.0126s/iter; left time: 58.2949s
Epoch: 12 cost time: 7.501107215881348
Epoch: 12, Steps: 570 | Train Loss: 0.1459731 Vali Loss: 0.0332833 Test Loss: 0.1112486
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2057044
	speed: 0.0404s/iter; left time: 180.2818s
	iters: 200, epoch: 13 | loss: 0.1851881
	speed: 0.0115s/iter; left time: 49.9780s
	iters: 300, epoch: 13 | loss: 0.1428877
	speed: 0.0115s/iter; left time: 48.9197s
	iters: 400, epoch: 13 | loss: 0.1263070
	speed: 0.0115s/iter; left time: 47.7411s
	iters: 500, epoch: 13 | loss: 0.1877145
	speed: 0.0115s/iter; left time: 46.6300s
Epoch: 13 cost time: 6.820101737976074
Epoch: 13, Steps: 570 | Train Loss: 0.1447158 Vali Loss: 0.0331614 Test Loss: 0.1112201
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1153721
	speed: 0.0377s/iter; left time: 146.5508s
	iters: 200, epoch: 14 | loss: 0.2060436
	speed: 0.0115s/iter; left time: 43.5477s
	iters: 300, epoch: 14 | loss: 0.1331390
	speed: 0.0115s/iter; left time: 42.4999s
	iters: 400, epoch: 14 | loss: 0.1472175
	speed: 0.0115s/iter; left time: 41.3459s
	iters: 500, epoch: 14 | loss: 0.2155699
	speed: 0.0115s/iter; left time: 40.1754s
Epoch: 14 cost time: 6.863035440444946
Epoch: 14, Steps: 570 | Train Loss: 0.1452995 Vali Loss: 0.0329629 Test Loss: 0.1111845
Validation loss decreased (0.033027 --> 0.032963).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1701639
	speed: 0.0388s/iter; left time: 128.7652s
	iters: 200, epoch: 15 | loss: 0.1698841
	speed: 0.0115s/iter; left time: 37.0129s
	iters: 300, epoch: 15 | loss: 0.1489871
	speed: 0.0115s/iter; left time: 35.9622s
	iters: 400, epoch: 15 | loss: 0.1076717
	speed: 0.0115s/iter; left time: 34.7631s
	iters: 500, epoch: 15 | loss: 0.1245630
	speed: 0.0115s/iter; left time: 33.5168s
Epoch: 15 cost time: 6.843875408172607
Epoch: 15, Steps: 570 | Train Loss: 0.1444354 Vali Loss: 0.0330157 Test Loss: 0.1111896
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1521598
	speed: 0.0372s/iter; left time: 102.3204s
	iters: 200, epoch: 16 | loss: 0.1556416
	speed: 0.0115s/iter; left time: 30.4867s
	iters: 300, epoch: 16 | loss: 0.1187774
	speed: 0.0115s/iter; left time: 29.4222s
	iters: 400, epoch: 16 | loss: 0.0956007
	speed: 0.0115s/iter; left time: 28.1512s
	iters: 500, epoch: 16 | loss: 0.1450910
	speed: 0.0115s/iter; left time: 26.9614s
Epoch: 16 cost time: 6.830895900726318
Epoch: 16, Steps: 570 | Train Loss: 0.1461396 Vali Loss: 0.0330571 Test Loss: 0.1111890
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.1512654
	speed: 0.0379s/iter; left time: 82.5962s
	iters: 200, epoch: 17 | loss: 0.0914336
	speed: 0.0115s/iter; left time: 23.9053s
	iters: 300, epoch: 17 | loss: 0.1645135
	speed: 0.0115s/iter; left time: 22.7363s
	iters: 400, epoch: 17 | loss: 0.0635268
	speed: 0.0115s/iter; left time: 21.5541s
	iters: 500, epoch: 17 | loss: 0.1457991
	speed: 0.0115s/iter; left time: 20.4145s
Epoch: 17 cost time: 6.840854167938232
Epoch: 17, Steps: 570 | Train Loss: 0.1452971 Vali Loss: 0.0331200 Test Loss: 0.1111891
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11135132610797882, mae:0.20238979160785675
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3023773
	speed: 0.0242s/iter; left time: 273.6227s
	iters: 200, epoch: 1 | loss: 0.3520382
	speed: 0.0120s/iter; left time: 134.7686s
	iters: 300, epoch: 1 | loss: 0.3291507
	speed: 0.0120s/iter; left time: 133.0418s
	iters: 400, epoch: 1 | loss: 0.2533366
	speed: 0.0120s/iter; left time: 132.1250s
	iters: 500, epoch: 1 | loss: 0.2025783
	speed: 0.0120s/iter; left time: 131.0130s
Epoch: 1 cost time: 8.069112062454224
Epoch: 1, Steps: 570 | Train Loss: 0.2592653 Vali Loss: 0.0470340 Test Loss: 0.1491200
Validation loss decreased (inf --> 0.047034).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2725223
	speed: 0.0382s/iter; left time: 409.9496s
	iters: 200, epoch: 2 | loss: 0.3464039
	speed: 0.0109s/iter; left time: 115.6648s
	iters: 300, epoch: 2 | loss: 0.1615402
	speed: 0.0109s/iter; left time: 114.5526s
	iters: 400, epoch: 2 | loss: 0.1890907
	speed: 0.0109s/iter; left time: 113.2820s
	iters: 500, epoch: 2 | loss: 0.1945120
	speed: 0.0108s/iter; left time: 112.0606s
Epoch: 2 cost time: 6.507251977920532
Epoch: 2, Steps: 570 | Train Loss: 0.2294851 Vali Loss: 0.0506599 Test Loss: 0.1529285
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1668201
	speed: 0.0390s/iter; left time: 396.4676s
	iters: 200, epoch: 3 | loss: 0.1748754
	speed: 0.0116s/iter; left time: 117.0029s
	iters: 300, epoch: 3 | loss: 0.2789643
	speed: 0.0108s/iter; left time: 107.8836s
	iters: 400, epoch: 3 | loss: 0.1677472
	speed: 0.0108s/iter; left time: 106.7837s
	iters: 500, epoch: 3 | loss: 0.2055227
	speed: 0.0108s/iter; left time: 105.7056s
Epoch: 3 cost time: 6.590514183044434
Epoch: 3, Steps: 570 | Train Loss: 0.2052950 Vali Loss: 0.0422072 Test Loss: 0.1373033
Validation loss decreased (0.047034 --> 0.042207).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1818763
	speed: 0.0378s/iter; left time: 362.9290s
	iters: 200, epoch: 4 | loss: 0.1296567
	speed: 0.0108s/iter; left time: 102.9313s
	iters: 300, epoch: 4 | loss: 0.1650539
	speed: 0.0109s/iter; left time: 102.0760s
	iters: 400, epoch: 4 | loss: 0.3428080
	speed: 0.0109s/iter; left time: 100.8114s
	iters: 500, epoch: 4 | loss: 0.1801892
	speed: 0.0108s/iter; left time: 99.5819s
Epoch: 4 cost time: 6.505101680755615
Epoch: 4, Steps: 570 | Train Loss: 0.1827566 Vali Loss: 0.0414400 Test Loss: 0.1408591
Validation loss decreased (0.042207 --> 0.041440).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1668240
	speed: 0.0383s/iter; left time: 345.7220s
	iters: 200, epoch: 5 | loss: 0.1677529
	speed: 0.0120s/iter; left time: 107.3434s
	iters: 300, epoch: 5 | loss: 0.1709006
	speed: 0.0121s/iter; left time: 106.3883s
	iters: 400, epoch: 5 | loss: 0.1128015
	speed: 0.0120s/iter; left time: 105.0780s
	iters: 500, epoch: 5 | loss: 0.2561677
	speed: 0.0120s/iter; left time: 103.6698s
Epoch: 5 cost time: 7.180497884750366
Epoch: 5, Steps: 570 | Train Loss: 0.1705200 Vali Loss: 0.0390431 Test Loss: 0.1338034
Validation loss decreased (0.041440 --> 0.039043).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1403041
	speed: 0.0399s/iter; left time: 337.1706s
	iters: 200, epoch: 6 | loss: 0.1482296
	speed: 0.0109s/iter; left time: 90.6086s
	iters: 300, epoch: 6 | loss: 0.1887355
	speed: 0.0109s/iter; left time: 89.5781s
	iters: 400, epoch: 6 | loss: 0.1394947
	speed: 0.0109s/iter; left time: 88.5602s
	iters: 500, epoch: 6 | loss: 0.1561777
	speed: 0.0108s/iter; left time: 87.3424s
Epoch: 6 cost time: 6.529320478439331
Epoch: 6, Steps: 570 | Train Loss: 0.1623241 Vali Loss: 0.0388792 Test Loss: 0.1365796
Validation loss decreased (0.039043 --> 0.038879).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1332874
	speed: 0.0390s/iter; left time: 307.6743s
	iters: 200, epoch: 7 | loss: 0.1300848
	speed: 0.0109s/iter; left time: 84.6280s
	iters: 300, epoch: 7 | loss: 0.1099305
	speed: 0.0109s/iter; left time: 83.5531s
	iters: 400, epoch: 7 | loss: 0.1499352
	speed: 0.0108s/iter; left time: 82.1313s
	iters: 500, epoch: 7 | loss: 0.1161368
	speed: 0.0109s/iter; left time: 81.4321s
Epoch: 7 cost time: 6.5061774253845215
Epoch: 7, Steps: 570 | Train Loss: 0.1599118 Vali Loss: 0.0385099 Test Loss: 0.1332457
Validation loss decreased (0.038879 --> 0.038510).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1220800
	speed: 0.0378s/iter; left time: 276.6024s
	iters: 200, epoch: 8 | loss: 0.1919292
	speed: 0.0109s/iter; left time: 78.7503s
	iters: 300, epoch: 8 | loss: 0.2086399
	speed: 0.0111s/iter; left time: 78.7329s
	iters: 400, epoch: 8 | loss: 0.1443205
	speed: 0.0120s/iter; left time: 84.4548s
	iters: 500, epoch: 8 | loss: 0.0975310
	speed: 0.0120s/iter; left time: 83.1488s
Epoch: 8 cost time: 6.880667448043823
Epoch: 8, Steps: 570 | Train Loss: 0.1577346 Vali Loss: 0.0380855 Test Loss: 0.1331222
Validation loss decreased (0.038510 --> 0.038086).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1655697
	speed: 0.0386s/iter; left time: 260.4936s
	iters: 200, epoch: 9 | loss: 0.1161146
	speed: 0.0109s/iter; left time: 72.6438s
	iters: 300, epoch: 9 | loss: 0.2196243
	speed: 0.0109s/iter; left time: 71.6140s
	iters: 400, epoch: 9 | loss: 0.2073046
	speed: 0.0109s/iter; left time: 70.3972s
	iters: 500, epoch: 9 | loss: 0.1035316
	speed: 0.0109s/iter; left time: 69.2156s
Epoch: 9 cost time: 6.567201852798462
Epoch: 9, Steps: 570 | Train Loss: 0.1557757 Vali Loss: 0.0381641 Test Loss: 0.1334061
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1572970
	speed: 0.0377s/iter; left time: 232.7969s
	iters: 200, epoch: 10 | loss: 0.0930295
	speed: 0.0109s/iter; left time: 66.2792s
	iters: 300, epoch: 10 | loss: 0.1732631
	speed: 0.0109s/iter; left time: 65.2547s
	iters: 400, epoch: 10 | loss: 0.1366965
	speed: 0.0109s/iter; left time: 64.0827s
	iters: 500, epoch: 10 | loss: 0.1793620
	speed: 0.0109s/iter; left time: 62.8559s
Epoch: 10 cost time: 6.522702932357788
Epoch: 10, Steps: 570 | Train Loss: 0.1560762 Vali Loss: 0.0381785 Test Loss: 0.1330903
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1224089
	speed: 0.0381s/iter; left time: 213.4633s
	iters: 200, epoch: 11 | loss: 0.1424767
	speed: 0.0109s/iter; left time: 59.8913s
	iters: 300, epoch: 11 | loss: 0.1435373
	speed: 0.0109s/iter; left time: 58.9219s
	iters: 400, epoch: 11 | loss: 0.1171310
	speed: 0.0109s/iter; left time: 57.7617s
	iters: 500, epoch: 11 | loss: 0.1325386
	speed: 0.0109s/iter; left time: 56.5978s
Epoch: 11 cost time: 6.541114568710327
Epoch: 11, Steps: 570 | Train Loss: 0.1562124 Vali Loss: 0.0382650 Test Loss: 0.1332655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13330425322055817, mae:0.2314433604478836
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2088144
	speed: 0.0262s/iter; left time: 296.0795s
	iters: 200, epoch: 1 | loss: 0.1824291
	speed: 0.0145s/iter; left time: 162.7267s
	iters: 300, epoch: 1 | loss: 0.2788930
	speed: 0.0145s/iter; left time: 160.8681s
	iters: 400, epoch: 1 | loss: 0.2357036
	speed: 0.0145s/iter; left time: 159.7675s
	iters: 500, epoch: 1 | loss: 0.1783668
	speed: 0.0145s/iter; left time: 158.4819s
Epoch: 1 cost time: 9.4953932762146
Epoch: 1, Steps: 570 | Train Loss: 0.2419916 Vali Loss: 0.0462555 Test Loss: 0.1280871
Validation loss decreased (inf --> 0.046256).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3006781
	speed: 0.0467s/iter; left time: 501.2330s
	iters: 200, epoch: 2 | loss: 0.1948502
	speed: 0.0146s/iter; left time: 155.2263s
	iters: 300, epoch: 2 | loss: 0.1645432
	speed: 0.0146s/iter; left time: 153.7717s
	iters: 400, epoch: 2 | loss: 0.1193968
	speed: 0.0146s/iter; left time: 152.2712s
	iters: 500, epoch: 2 | loss: 0.2239374
	speed: 0.0146s/iter; left time: 150.7181s
Epoch: 2 cost time: 8.649644613265991
Epoch: 2, Steps: 570 | Train Loss: 0.2050041 Vali Loss: 0.0459917 Test Loss: 0.1426752
Validation loss decreased (0.046256 --> 0.045992).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3307565
	speed: 0.0468s/iter; left time: 475.6335s
	iters: 200, epoch: 3 | loss: 0.1560543
	speed: 0.0146s/iter; left time: 146.4645s
	iters: 300, epoch: 3 | loss: 0.0987948
	speed: 0.0146s/iter; left time: 145.1016s
	iters: 400, epoch: 3 | loss: 0.1366630
	speed: 0.0146s/iter; left time: 143.5745s
	iters: 500, epoch: 3 | loss: 0.1182564
	speed: 0.0146s/iter; left time: 142.2431s
Epoch: 3 cost time: 8.619805574417114
Epoch: 3, Steps: 570 | Train Loss: 0.1765109 Vali Loss: 0.0391808 Test Loss: 0.1271644
Validation loss decreased (0.045992 --> 0.039181).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1397561
	speed: 0.0494s/iter; left time: 474.0160s
	iters: 200, epoch: 4 | loss: 0.1401083
	speed: 0.0145s/iter; left time: 138.0070s
	iters: 300, epoch: 4 | loss: 0.1984763
	speed: 0.0145s/iter; left time: 136.5816s
	iters: 400, epoch: 4 | loss: 0.1807085
	speed: 0.0156s/iter; left time: 144.9647s
	iters: 500, epoch: 4 | loss: 0.1222808
	speed: 0.0163s/iter; left time: 149.7612s
Epoch: 4 cost time: 8.903204917907715
Epoch: 4, Steps: 570 | Train Loss: 0.1574438 Vali Loss: 0.0374154 Test Loss: 0.1241968
Validation loss decreased (0.039181 --> 0.037415).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1441234
	speed: 0.0461s/iter; left time: 415.6659s
	iters: 200, epoch: 5 | loss: 0.1478885
	speed: 0.0147s/iter; left time: 130.7705s
	iters: 300, epoch: 5 | loss: 0.1427533
	speed: 0.0146s/iter; left time: 129.0889s
	iters: 400, epoch: 5 | loss: 0.1568673
	speed: 0.0146s/iter; left time: 127.5483s
	iters: 500, epoch: 5 | loss: 0.1767756
	speed: 0.0146s/iter; left time: 126.0386s
Epoch: 5 cost time: 8.650763750076294
Epoch: 5, Steps: 570 | Train Loss: 0.1490328 Vali Loss: 0.0381137 Test Loss: 0.1268485
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1252706
	speed: 0.0461s/iter; left time: 389.8265s
	iters: 200, epoch: 6 | loss: 0.1413923
	speed: 0.0145s/iter; left time: 121.4084s
	iters: 300, epoch: 6 | loss: 0.1185930
	speed: 0.0145s/iter; left time: 119.9456s
	iters: 400, epoch: 6 | loss: 0.1176067
	speed: 0.0145s/iter; left time: 118.4480s
	iters: 500, epoch: 6 | loss: 0.1488429
	speed: 0.0145s/iter; left time: 116.9528s
Epoch: 6 cost time: 8.58096432685852
Epoch: 6, Steps: 570 | Train Loss: 0.1430332 Vali Loss: 0.0376692 Test Loss: 0.1223561
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1383386
	speed: 0.0468s/iter; left time: 369.1600s
	iters: 200, epoch: 7 | loss: 0.1056294
	speed: 0.0146s/iter; left time: 113.9510s
	iters: 300, epoch: 7 | loss: 0.1030869
	speed: 0.0147s/iter; left time: 112.6046s
	iters: 400, epoch: 7 | loss: 0.1361030
	speed: 0.0146s/iter; left time: 110.7500s
	iters: 500, epoch: 7 | loss: 0.2070615
	speed: 0.0146s/iter; left time: 109.2576s
Epoch: 7 cost time: 8.678980112075806
Epoch: 7, Steps: 570 | Train Loss: 0.1416667 Vali Loss: 0.0376299 Test Loss: 0.1246513
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12436190247535706, mae:0.21817733347415924
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3041493
	speed: 0.0278s/iter; left time: 314.4769s
	iters: 200, epoch: 1 | loss: 0.2585823
	speed: 0.0142s/iter; left time: 159.4398s
	iters: 300, epoch: 1 | loss: 0.1520086
	speed: 0.0142s/iter; left time: 157.2123s
	iters: 400, epoch: 1 | loss: 0.3295628
	speed: 0.0151s/iter; left time: 166.1192s
	iters: 500, epoch: 1 | loss: 0.1836459
	speed: 0.0157s/iter; left time: 171.6269s
Epoch: 1 cost time: 9.751925468444824
Epoch: 1, Steps: 570 | Train Loss: 0.2175849 Vali Loss: 0.0411615 Test Loss: 0.1243817
Validation loss decreased (inf --> 0.041161).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1491904
	speed: 0.0463s/iter; left time: 496.5073s
	iters: 200, epoch: 2 | loss: 0.2791035
	speed: 0.0143s/iter; left time: 152.0371s
	iters: 300, epoch: 2 | loss: 0.1883979
	speed: 0.0143s/iter; left time: 151.1155s
	iters: 400, epoch: 2 | loss: 0.1699372
	speed: 0.0143s/iter; left time: 149.2766s
	iters: 500, epoch: 2 | loss: 0.1642059
	speed: 0.0150s/iter; left time: 155.4252s
Epoch: 2 cost time: 8.685136795043945
Epoch: 2, Steps: 570 | Train Loss: 0.1894586 Vali Loss: 0.0383928 Test Loss: 0.1226561
Validation loss decreased (0.041161 --> 0.038393).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1771815
	speed: 0.0524s/iter; left time: 532.5170s
	iters: 200, epoch: 3 | loss: 0.0839687
	speed: 0.0164s/iter; left time: 164.7994s
	iters: 300, epoch: 3 | loss: 0.2152462
	speed: 0.0164s/iter; left time: 163.7541s
	iters: 400, epoch: 3 | loss: 0.1249974
	speed: 0.0164s/iter; left time: 161.8623s
	iters: 500, epoch: 3 | loss: 0.1507803
	speed: 0.0164s/iter; left time: 160.0737s
Epoch: 3 cost time: 9.664738893508911
Epoch: 3, Steps: 570 | Train Loss: 0.1661950 Vali Loss: 0.0359099 Test Loss: 0.1177011
Validation loss decreased (0.038393 --> 0.035910).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1583731
	speed: 0.0493s/iter; left time: 472.7751s
	iters: 200, epoch: 4 | loss: 0.1549593
	speed: 0.0164s/iter; left time: 155.8270s
	iters: 300, epoch: 4 | loss: 0.1846991
	speed: 0.0164s/iter; left time: 154.1214s
	iters: 400, epoch: 4 | loss: 0.0967964
	speed: 0.0164s/iter; left time: 152.5000s
	iters: 500, epoch: 4 | loss: 0.1095245
	speed: 0.0164s/iter; left time: 150.8979s
Epoch: 4 cost time: 9.676862239837646
Epoch: 4, Steps: 570 | Train Loss: 0.1546359 Vali Loss: 0.0341666 Test Loss: 0.1127359
Validation loss decreased (0.035910 --> 0.034167).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0815493
	speed: 0.0494s/iter; left time: 445.7467s
	iters: 200, epoch: 5 | loss: 0.1315108
	speed: 0.0164s/iter; left time: 146.7295s
	iters: 300, epoch: 5 | loss: 0.1942120
	speed: 0.0165s/iter; left time: 145.3322s
	iters: 400, epoch: 5 | loss: 0.1044161
	speed: 0.0164s/iter; left time: 143.3857s
	iters: 500, epoch: 5 | loss: 0.1637261
	speed: 0.0151s/iter; left time: 130.4375s
Epoch: 5 cost time: 9.391724586486816
Epoch: 5, Steps: 570 | Train Loss: 0.1448837 Vali Loss: 0.0341896 Test Loss: 0.1115746
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1139430
	speed: 0.0454s/iter; left time: 383.7172s
	iters: 200, epoch: 6 | loss: 0.2346027
	speed: 0.0142s/iter; left time: 118.5416s
	iters: 300, epoch: 6 | loss: 0.2354135
	speed: 0.0142s/iter; left time: 117.3476s
	iters: 400, epoch: 6 | loss: 0.1607544
	speed: 0.0142s/iter; left time: 115.8542s
	iters: 500, epoch: 6 | loss: 0.1464290
	speed: 0.0142s/iter; left time: 114.5482s
Epoch: 6 cost time: 8.380046844482422
Epoch: 6, Steps: 570 | Train Loss: 0.1417928 Vali Loss: 0.0337849 Test Loss: 0.1103700
Validation loss decreased (0.034167 --> 0.033785).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1030021
	speed: 0.0460s/iter; left time: 362.5501s
	iters: 200, epoch: 7 | loss: 0.1366124
	speed: 0.0142s/iter; left time: 110.4461s
	iters: 300, epoch: 7 | loss: 0.2279001
	speed: 0.0142s/iter; left time: 108.8823s
	iters: 400, epoch: 7 | loss: 0.1248613
	speed: 0.0142s/iter; left time: 107.4396s
	iters: 500, epoch: 7 | loss: 0.1861413
	speed: 0.0142s/iter; left time: 105.9620s
Epoch: 7 cost time: 8.392455816268921
Epoch: 7, Steps: 570 | Train Loss: 0.1395018 Vali Loss: 0.0332101 Test Loss: 0.1089533
Validation loss decreased (0.033785 --> 0.033210).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0943482
	speed: 0.0453s/iter; left time: 331.4455s
	iters: 200, epoch: 8 | loss: 0.1349510
	speed: 0.0143s/iter; left time: 102.9677s
	iters: 300, epoch: 8 | loss: 0.2093175
	speed: 0.0143s/iter; left time: 101.6882s
	iters: 400, epoch: 8 | loss: 0.1370911
	speed: 0.0143s/iter; left time: 100.2694s
	iters: 500, epoch: 8 | loss: 0.1521060
	speed: 0.0143s/iter; left time: 98.7586s
Epoch: 8 cost time: 8.435569047927856
Epoch: 8, Steps: 570 | Train Loss: 0.1379513 Vali Loss: 0.0333427 Test Loss: 0.1091910
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0990435
	speed: 0.0450s/iter; left time: 303.5137s
	iters: 200, epoch: 9 | loss: 0.1075702
	speed: 0.0142s/iter; left time: 94.1987s
	iters: 300, epoch: 9 | loss: 0.1758587
	speed: 0.0142s/iter; left time: 92.8158s
	iters: 400, epoch: 9 | loss: 0.1283492
	speed: 0.0142s/iter; left time: 91.3041s
	iters: 500, epoch: 9 | loss: 0.1375320
	speed: 0.0142s/iter; left time: 89.8476s
Epoch: 9 cost time: 8.337303638458252
Epoch: 9, Steps: 570 | Train Loss: 0.1371401 Vali Loss: 0.0331055 Test Loss: 0.1088744
Validation loss decreased (0.033210 --> 0.033106).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1440584
	speed: 0.0487s/iter; left time: 300.4675s
	iters: 200, epoch: 10 | loss: 0.1124659
	speed: 0.0143s/iter; left time: 86.9187s
	iters: 300, epoch: 10 | loss: 0.1372264
	speed: 0.0143s/iter; left time: 85.5947s
	iters: 400, epoch: 10 | loss: 0.1360071
	speed: 0.0158s/iter; left time: 92.7192s
	iters: 500, epoch: 10 | loss: 0.1742094
	speed: 0.0144s/iter; left time: 82.8457s
Epoch: 10 cost time: 8.739937782287598
Epoch: 10, Steps: 570 | Train Loss: 0.1371056 Vali Loss: 0.0330677 Test Loss: 0.1088897
Validation loss decreased (0.033106 --> 0.033068).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2021715
	speed: 0.0478s/iter; left time: 267.5538s
	iters: 200, epoch: 11 | loss: 0.1225517
	speed: 0.0164s/iter; left time: 90.2935s
	iters: 300, epoch: 11 | loss: 0.1704631
	speed: 0.0164s/iter; left time: 88.6577s
	iters: 400, epoch: 11 | loss: 0.0939213
	speed: 0.0164s/iter; left time: 86.8683s
	iters: 500, epoch: 11 | loss: 0.2140114
	speed: 0.0162s/iter; left time: 84.3539s
Epoch: 11 cost time: 9.482523202896118
Epoch: 11, Steps: 570 | Train Loss: 0.1350687 Vali Loss: 0.0329884 Test Loss: 0.1088659
Validation loss decreased (0.033068 --> 0.032988).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1625562
	speed: 0.0458s/iter; left time: 230.6408s
	iters: 200, epoch: 12 | loss: 0.1708721
	speed: 0.0142s/iter; left time: 70.2258s
	iters: 300, epoch: 12 | loss: 0.1148917
	speed: 0.0162s/iter; left time: 78.0379s
	iters: 400, epoch: 12 | loss: 0.1476015
	speed: 0.0164s/iter; left time: 77.7580s
	iters: 500, epoch: 12 | loss: 0.1615509
	speed: 0.0164s/iter; left time: 76.1156s
Epoch: 12 cost time: 9.228839874267578
Epoch: 12, Steps: 570 | Train Loss: 0.1370205 Vali Loss: 0.0331084 Test Loss: 0.1088943
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1212869
	speed: 0.0488s/iter; left time: 217.8987s
	iters: 200, epoch: 13 | loss: 0.0968870
	speed: 0.0165s/iter; left time: 71.7611s
	iters: 300, epoch: 13 | loss: 0.1208057
	speed: 0.0164s/iter; left time: 70.0833s
	iters: 400, epoch: 13 | loss: 0.0852482
	speed: 0.0165s/iter; left time: 68.4506s
	iters: 500, epoch: 13 | loss: 0.1432980
	speed: 0.0164s/iter; left time: 66.7831s
Epoch: 13 cost time: 9.651771545410156
Epoch: 13, Steps: 570 | Train Loss: 0.1366182 Vali Loss: 0.0329717 Test Loss: 0.1089000
Validation loss decreased (0.032988 --> 0.032972).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1207893
	speed: 0.0501s/iter; left time: 194.9690s
	iters: 200, epoch: 14 | loss: 0.2127361
	speed: 0.0159s/iter; left time: 60.4396s
	iters: 300, epoch: 14 | loss: 0.0937397
	speed: 0.0160s/iter; left time: 58.9600s
	iters: 400, epoch: 14 | loss: 0.0882648
	speed: 0.0160s/iter; left time: 57.3379s
	iters: 500, epoch: 14 | loss: 0.0805607
	speed: 0.0160s/iter; left time: 55.7877s
Epoch: 14 cost time: 9.391402244567871
Epoch: 14, Steps: 570 | Train Loss: 0.1345381 Vali Loss: 0.0330430 Test Loss: 0.1089277
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1321850
	speed: 0.0464s/iter; left time: 154.0604s
	iters: 200, epoch: 15 | loss: 0.1116377
	speed: 0.0143s/iter; left time: 45.9886s
	iters: 300, epoch: 15 | loss: 0.1358414
	speed: 0.0143s/iter; left time: 44.5702s
	iters: 400, epoch: 15 | loss: 0.1307736
	speed: 0.0143s/iter; left time: 43.1715s
	iters: 500, epoch: 15 | loss: 0.1802043
	speed: 0.0143s/iter; left time: 41.7262s
Epoch: 15 cost time: 8.393531799316406
Epoch: 15, Steps: 570 | Train Loss: 0.1356780 Vali Loss: 0.0330492 Test Loss: 0.1089440
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1402374
	speed: 0.0495s/iter; left time: 136.1815s
	iters: 200, epoch: 16 | loss: 0.1551928
	speed: 0.0141s/iter; left time: 37.4684s
	iters: 300, epoch: 16 | loss: 0.1137916
	speed: 0.0141s/iter; left time: 36.0806s
	iters: 400, epoch: 16 | loss: 0.1630017
	speed: 0.0142s/iter; left time: 34.7065s
	iters: 500, epoch: 16 | loss: 0.1067045
	speed: 0.0141s/iter; left time: 33.2273s
Epoch: 16 cost time: 8.530990600585938
Epoch: 16, Steps: 570 | Train Loss: 0.1356732 Vali Loss: 0.0331464 Test Loss: 0.1089477
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10903660207986832, mae:0.19916637241840363
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1381665
	speed: 0.0260s/iter; left time: 294.3041s
	iters: 200, epoch: 1 | loss: 0.3449165
	speed: 0.0142s/iter; left time: 159.5168s
	iters: 300, epoch: 1 | loss: 0.2914426
	speed: 0.0142s/iter; left time: 157.8268s
	iters: 400, epoch: 1 | loss: 0.2373642
	speed: 0.0142s/iter; left time: 156.4851s
	iters: 500, epoch: 1 | loss: 0.2826465
	speed: 0.0143s/iter; left time: 155.7019s
Epoch: 1 cost time: 9.355465173721313
Epoch: 1, Steps: 570 | Train Loss: 0.2493833 Vali Loss: 0.0467754 Test Loss: 0.1420881
Validation loss decreased (inf --> 0.046775).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1900936
	speed: 0.0463s/iter; left time: 497.1709s
	iters: 200, epoch: 2 | loss: 0.2193269
	speed: 0.0142s/iter; left time: 151.0666s
	iters: 300, epoch: 2 | loss: 0.1439174
	speed: 0.0142s/iter; left time: 149.7960s
	iters: 400, epoch: 2 | loss: 0.1681918
	speed: 0.0142s/iter; left time: 148.4570s
	iters: 500, epoch: 2 | loss: 0.2402062
	speed: 0.0142s/iter; left time: 146.9094s
Epoch: 2 cost time: 8.43770956993103
Epoch: 2, Steps: 570 | Train Loss: 0.2090211 Vali Loss: 0.0434395 Test Loss: 0.1385605
Validation loss decreased (0.046775 --> 0.043440).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2056979
	speed: 0.0470s/iter; left time: 477.7511s
	iters: 200, epoch: 3 | loss: 0.2125686
	speed: 0.0142s/iter; left time: 142.7031s
	iters: 300, epoch: 3 | loss: 0.1561041
	speed: 0.0142s/iter; left time: 141.1579s
	iters: 400, epoch: 3 | loss: 0.1571902
	speed: 0.0142s/iter; left time: 139.6252s
	iters: 500, epoch: 3 | loss: 0.2057050
	speed: 0.0141s/iter; left time: 137.9327s
Epoch: 3 cost time: 8.354428768157959
Epoch: 3, Steps: 570 | Train Loss: 0.1796085 Vali Loss: 0.0421454 Test Loss: 0.1335378
Validation loss decreased (0.043440 --> 0.042145).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2165372
	speed: 0.0479s/iter; left time: 459.0873s
	iters: 200, epoch: 4 | loss: 0.1942196
	speed: 0.0142s/iter; left time: 134.7607s
	iters: 300, epoch: 4 | loss: 0.1731071
	speed: 0.0142s/iter; left time: 133.6173s
	iters: 400, epoch: 4 | loss: 0.1457002
	speed: 0.0142s/iter; left time: 132.2323s
	iters: 500, epoch: 4 | loss: 0.1088841
	speed: 0.0142s/iter; left time: 130.6998s
Epoch: 4 cost time: 8.383462905883789
Epoch: 4, Steps: 570 | Train Loss: 0.1631498 Vali Loss: 0.0403996 Test Loss: 0.1263688
Validation loss decreased (0.042145 --> 0.040400).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1325023
	speed: 0.0457s/iter; left time: 412.2423s
	iters: 200, epoch: 5 | loss: 0.1555424
	speed: 0.0142s/iter; left time: 126.9137s
	iters: 300, epoch: 5 | loss: 0.1323898
	speed: 0.0143s/iter; left time: 125.7380s
	iters: 400, epoch: 5 | loss: 0.2263586
	speed: 0.0143s/iter; left time: 124.7091s
	iters: 500, epoch: 5 | loss: 0.1418733
	speed: 0.0143s/iter; left time: 123.3043s
Epoch: 5 cost time: 8.412789106369019
Epoch: 5, Steps: 570 | Train Loss: 0.1533076 Vali Loss: 0.0393731 Test Loss: 0.1267292
Validation loss decreased (0.040400 --> 0.039373).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1757096
	speed: 0.0461s/iter; left time: 389.6917s
	iters: 200, epoch: 6 | loss: 0.1593852
	speed: 0.0143s/iter; left time: 119.1973s
	iters: 300, epoch: 6 | loss: 0.1035415
	speed: 0.0143s/iter; left time: 117.8082s
	iters: 400, epoch: 6 | loss: 0.1843241
	speed: 0.0143s/iter; left time: 116.1755s
	iters: 500, epoch: 6 | loss: 0.1459927
	speed: 0.0142s/iter; left time: 114.6804s
Epoch: 6 cost time: 8.447590827941895
Epoch: 6, Steps: 570 | Train Loss: 0.1486886 Vali Loss: 0.0387617 Test Loss: 0.1253418
Validation loss decreased (0.039373 --> 0.038762).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1954851
	speed: 0.0480s/iter; left time: 378.0589s
	iters: 200, epoch: 7 | loss: 0.0975353
	speed: 0.0151s/iter; left time: 117.3457s
	iters: 300, epoch: 7 | loss: 0.0966628
	speed: 0.0141s/iter; left time: 108.3929s
	iters: 400, epoch: 7 | loss: 0.2145246
	speed: 0.0141s/iter; left time: 107.0146s
	iters: 500, epoch: 7 | loss: 0.1329321
	speed: 0.0141s/iter; left time: 105.6067s
Epoch: 7 cost time: 8.718824863433838
Epoch: 7, Steps: 570 | Train Loss: 0.1470587 Vali Loss: 0.0387335 Test Loss: 0.1235380
Validation loss decreased (0.038762 --> 0.038734).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1238119
	speed: 0.0484s/iter; left time: 354.2094s
	iters: 200, epoch: 8 | loss: 0.1432588
	speed: 0.0142s/iter; left time: 102.1763s
	iters: 300, epoch: 8 | loss: 0.1247279
	speed: 0.0141s/iter; left time: 100.5692s
	iters: 400, epoch: 8 | loss: 0.1522371
	speed: 0.0141s/iter; left time: 99.1054s
	iters: 500, epoch: 8 | loss: 0.0975019
	speed: 0.0141s/iter; left time: 97.6842s
Epoch: 8 cost time: 8.386362791061401
Epoch: 8, Steps: 570 | Train Loss: 0.1456697 Vali Loss: 0.0395853 Test Loss: 0.1261854
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.2091442
	speed: 0.0491s/iter; left time: 330.9766s
	iters: 200, epoch: 9 | loss: 0.1126706
	speed: 0.0159s/iter; left time: 105.8244s
	iters: 300, epoch: 9 | loss: 0.0992757
	speed: 0.0148s/iter; left time: 96.6632s
	iters: 400, epoch: 9 | loss: 0.1102065
	speed: 0.0143s/iter; left time: 91.8412s
	iters: 500, epoch: 9 | loss: 0.1507562
	speed: 0.0143s/iter; left time: 90.3879s
Epoch: 9 cost time: 8.81211233139038
Epoch: 9, Steps: 570 | Train Loss: 0.1442083 Vali Loss: 0.0391426 Test Loss: 0.1253360
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1900224
	speed: 0.0469s/iter; left time: 289.1788s
	iters: 200, epoch: 10 | loss: 0.1614278
	speed: 0.0142s/iter; left time: 86.3078s
	iters: 300, epoch: 10 | loss: 0.1242339
	speed: 0.0142s/iter; left time: 84.8878s
	iters: 400, epoch: 10 | loss: 0.1666936
	speed: 0.0142s/iter; left time: 83.4591s
	iters: 500, epoch: 10 | loss: 0.1359811
	speed: 0.0142s/iter; left time: 82.1738s
Epoch: 10 cost time: 8.376512289047241
Epoch: 10, Steps: 570 | Train Loss: 0.1436869 Vali Loss: 0.0391266 Test Loss: 0.1257459
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12369126081466675, mae:0.22086134552955627
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2958392
	speed: 0.0303s/iter; left time: 342.2269s
	iters: 200, epoch: 1 | loss: 0.1971780
	speed: 0.0181s/iter; left time: 202.6062s
	iters: 300, epoch: 1 | loss: 0.2727989
	speed: 0.0181s/iter; left time: 200.5571s
	iters: 400, epoch: 1 | loss: 0.2513632
	speed: 0.0181s/iter; left time: 198.7780s
	iters: 500, epoch: 1 | loss: 0.2136229
	speed: 0.0181s/iter; left time: 197.3126s
Epoch: 1 cost time: 11.584544658660889
Epoch: 1, Steps: 570 | Train Loss: 0.2550540 Vali Loss: 0.0474312 Test Loss: 0.1496193
Validation loss decreased (inf --> 0.047431).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2432267
	speed: 0.0540s/iter; left time: 579.4563s
	iters: 200, epoch: 2 | loss: 0.2498724
	speed: 0.0181s/iter; left time: 192.3322s
	iters: 300, epoch: 2 | loss: 0.2779619
	speed: 0.0180s/iter; left time: 190.0745s
	iters: 400, epoch: 2 | loss: 0.1651098
	speed: 0.0181s/iter; left time: 188.3289s
	iters: 500, epoch: 2 | loss: 0.1844755
	speed: 0.0181s/iter; left time: 186.6024s
Epoch: 2 cost time: 10.638998031616211
Epoch: 2, Steps: 570 | Train Loss: 0.2384399 Vali Loss: 0.0586837 Test Loss: 0.1700942
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2058848
	speed: 0.0555s/iter; left time: 564.1534s
	iters: 200, epoch: 3 | loss: 0.1983583
	speed: 0.0181s/iter; left time: 182.3391s
	iters: 300, epoch: 3 | loss: 0.3410145
	speed: 0.0181s/iter; left time: 180.1700s
	iters: 400, epoch: 3 | loss: 0.1681196
	speed: 0.0181s/iter; left time: 178.7537s
	iters: 500, epoch: 3 | loss: 0.1727709
	speed: 0.0175s/iter; left time: 170.8710s
Epoch: 3 cost time: 10.462732791900635
Epoch: 3, Steps: 570 | Train Loss: 0.2248720 Vali Loss: 0.0464250 Test Loss: 0.1407486
Validation loss decreased (0.047431 --> 0.046425).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1574557
	speed: 0.0521s/iter; left time: 499.7411s
	iters: 200, epoch: 4 | loss: 0.2051149
	speed: 0.0181s/iter; left time: 171.7190s
	iters: 300, epoch: 4 | loss: 0.2613001
	speed: 0.0181s/iter; left time: 169.6992s
	iters: 400, epoch: 4 | loss: 0.2122735
	speed: 0.0181s/iter; left time: 167.8244s
	iters: 500, epoch: 4 | loss: 0.2093787
	speed: 0.0181s/iter; left time: 166.0142s
Epoch: 4 cost time: 10.503705024719238
Epoch: 4, Steps: 570 | Train Loss: 0.1972890 Vali Loss: 0.0443675 Test Loss: 0.1331053
Validation loss decreased (0.046425 --> 0.044367).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1237682
	speed: 0.0542s/iter; left time: 488.6117s
	iters: 200, epoch: 5 | loss: 0.2852994
	speed: 0.0181s/iter; left time: 161.1551s
	iters: 300, epoch: 5 | loss: 0.1794762
	speed: 0.0181s/iter; left time: 159.2278s
	iters: 400, epoch: 5 | loss: 0.2154945
	speed: 0.0181s/iter; left time: 157.6994s
	iters: 500, epoch: 5 | loss: 0.1389254
	speed: 0.0181s/iter; left time: 155.6525s
Epoch: 5 cost time: 10.604403495788574
Epoch: 5, Steps: 570 | Train Loss: 0.1862711 Vali Loss: 0.0417370 Test Loss: 0.1288609
Validation loss decreased (0.044367 --> 0.041737).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2081187
	speed: 0.0529s/iter; left time: 447.3634s
	iters: 200, epoch: 6 | loss: 0.1423266
	speed: 0.0180s/iter; left time: 150.6615s
	iters: 300, epoch: 6 | loss: 0.2063590
	speed: 0.0181s/iter; left time: 149.4124s
	iters: 400, epoch: 6 | loss: 0.2357511
	speed: 0.0180s/iter; left time: 146.9401s
	iters: 500, epoch: 6 | loss: 0.1809550
	speed: 0.0181s/iter; left time: 145.3646s
Epoch: 6 cost time: 10.591111421585083
Epoch: 6, Steps: 570 | Train Loss: 0.1806376 Vali Loss: 0.0412314 Test Loss: 0.1279439
Validation loss decreased (0.041737 --> 0.041231).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1608773
	speed: 0.0534s/iter; left time: 420.7435s
	iters: 200, epoch: 7 | loss: 0.2030581
	speed: 0.0181s/iter; left time: 140.6077s
	iters: 300, epoch: 7 | loss: 0.2310962
	speed: 0.0181s/iter; left time: 138.8188s
	iters: 400, epoch: 7 | loss: 0.1222981
	speed: 0.0181s/iter; left time: 136.8526s
	iters: 500, epoch: 7 | loss: 0.1308530
	speed: 0.0181s/iter; left time: 135.5647s
Epoch: 7 cost time: 10.624607563018799
Epoch: 7, Steps: 570 | Train Loss: 0.1756744 Vali Loss: 0.0416139 Test Loss: 0.1276427
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1781857
	speed: 0.0555s/iter; left time: 406.0790s
	iters: 200, epoch: 8 | loss: 0.1287111
	speed: 0.0181s/iter; left time: 130.7216s
	iters: 300, epoch: 8 | loss: 0.1429879
	speed: 0.0181s/iter; left time: 128.6654s
	iters: 400, epoch: 8 | loss: 0.1149336
	speed: 0.0181s/iter; left time: 126.7060s
	iters: 500, epoch: 8 | loss: 0.1402981
	speed: 0.0181s/iter; left time: 125.1046s
Epoch: 8 cost time: 10.60359811782837
Epoch: 8, Steps: 570 | Train Loss: 0.1750025 Vali Loss: 0.0413127 Test Loss: 0.1273950
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1620007
	speed: 0.0537s/iter; left time: 362.2811s
	iters: 200, epoch: 9 | loss: 0.1230296
	speed: 0.0181s/iter; left time: 119.8763s
	iters: 300, epoch: 9 | loss: 0.1626625
	speed: 0.0180s/iter; left time: 117.7691s
	iters: 400, epoch: 9 | loss: 0.2064057
	speed: 0.0180s/iter; left time: 116.1454s
	iters: 500, epoch: 9 | loss: 0.2402835
	speed: 0.0180s/iter; left time: 114.2668s
Epoch: 9 cost time: 10.606595516204834
Epoch: 9, Steps: 570 | Train Loss: 0.1738157 Vali Loss: 0.0414313 Test Loss: 0.1275823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1281076818704605, mae:0.2205001711845398
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2068312
	speed: 0.0282s/iter; left time: 319.2306s
	iters: 200, epoch: 1 | loss: 0.1475040
	speed: 0.0164s/iter; left time: 184.0855s
	iters: 300, epoch: 1 | loss: 0.2655107
	speed: 0.0165s/iter; left time: 182.6220s
	iters: 400, epoch: 1 | loss: 0.1900390
	speed: 0.0165s/iter; left time: 181.2508s
	iters: 500, epoch: 1 | loss: 0.1433915
	speed: 0.0165s/iter; left time: 179.5374s
Epoch: 1 cost time: 10.611324548721313
Epoch: 1, Steps: 570 | Train Loss: 0.2343052 Vali Loss: 0.0426553 Test Loss: 0.1378862
Validation loss decreased (inf --> 0.042655).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1608283
	speed: 0.0522s/iter; left time: 560.0889s
	iters: 200, epoch: 2 | loss: 0.1833935
	speed: 0.0179s/iter; left time: 190.2395s
	iters: 300, epoch: 2 | loss: 0.2451425
	speed: 0.0179s/iter; left time: 188.6663s
	iters: 400, epoch: 2 | loss: 0.3889318
	speed: 0.0179s/iter; left time: 186.3894s
	iters: 500, epoch: 2 | loss: 0.2141431
	speed: 0.0179s/iter; left time: 184.5460s
Epoch: 2 cost time: 10.501088619232178
Epoch: 2, Steps: 570 | Train Loss: 0.2236655 Vali Loss: 0.0419637 Test Loss: 0.1399358
Validation loss decreased (0.042655 --> 0.041964).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2036266
	speed: 0.0520s/iter; left time: 528.2143s
	iters: 200, epoch: 3 | loss: 0.2122304
	speed: 0.0165s/iter; left time: 165.8269s
	iters: 300, epoch: 3 | loss: 0.1900365
	speed: 0.0165s/iter; left time: 163.8899s
	iters: 400, epoch: 3 | loss: 0.2440022
	speed: 0.0165s/iter; left time: 162.4087s
	iters: 500, epoch: 3 | loss: 0.1065650
	speed: 0.0165s/iter; left time: 160.9100s
Epoch: 3 cost time: 9.716574907302856
Epoch: 3, Steps: 570 | Train Loss: 0.1956232 Vali Loss: 0.0376617 Test Loss: 0.1246283
Validation loss decreased (0.041964 --> 0.037662).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1733230
	speed: 0.0519s/iter; left time: 497.8470s
	iters: 200, epoch: 4 | loss: 0.3698699
	speed: 0.0165s/iter; left time: 156.9292s
	iters: 300, epoch: 4 | loss: 0.1629041
	speed: 0.0165s/iter; left time: 154.7091s
	iters: 400, epoch: 4 | loss: 0.1191096
	speed: 0.0164s/iter; left time: 152.8353s
	iters: 500, epoch: 4 | loss: 0.2356152
	speed: 0.0165s/iter; left time: 151.4117s
Epoch: 4 cost time: 9.736165046691895
Epoch: 4, Steps: 570 | Train Loss: 0.1789920 Vali Loss: 0.0367390 Test Loss: 0.1175551
Validation loss decreased (0.037662 --> 0.036739).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1773712
	speed: 0.0534s/iter; left time: 482.1252s
	iters: 200, epoch: 5 | loss: 0.2478509
	speed: 0.0179s/iter; left time: 159.7023s
	iters: 300, epoch: 5 | loss: 0.1592406
	speed: 0.0179s/iter; left time: 157.5008s
	iters: 400, epoch: 5 | loss: 0.1151561
	speed: 0.0179s/iter; left time: 155.9672s
	iters: 500, epoch: 5 | loss: 0.2273076
	speed: 0.0179s/iter; left time: 154.1498s
Epoch: 5 cost time: 10.548929452896118
Epoch: 5, Steps: 570 | Train Loss: 0.1693784 Vali Loss: 0.0352099 Test Loss: 0.1135109
Validation loss decreased (0.036739 --> 0.035210).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1581204
	speed: 0.0526s/iter; left time: 444.7047s
	iters: 200, epoch: 6 | loss: 0.2331288
	speed: 0.0163s/iter; left time: 136.5174s
	iters: 300, epoch: 6 | loss: 0.2776801
	speed: 0.0163s/iter; left time: 134.8671s
	iters: 400, epoch: 6 | loss: 0.1604757
	speed: 0.0164s/iter; left time: 133.3745s
	iters: 500, epoch: 6 | loss: 0.1558830
	speed: 0.0164s/iter; left time: 131.6769s
Epoch: 6 cost time: 9.665111064910889
Epoch: 6, Steps: 570 | Train Loss: 0.1640407 Vali Loss: 0.0348077 Test Loss: 0.1118976
Validation loss decreased (0.035210 --> 0.034808).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2196183
	speed: 0.0520s/iter; left time: 410.0941s
	iters: 200, epoch: 7 | loss: 0.1099205
	speed: 0.0164s/iter; left time: 127.4045s
	iters: 300, epoch: 7 | loss: 0.1736868
	speed: 0.0163s/iter; left time: 125.2769s
	iters: 400, epoch: 7 | loss: 0.2072969
	speed: 0.0163s/iter; left time: 123.5751s
	iters: 500, epoch: 7 | loss: 0.2354021
	speed: 0.0164s/iter; left time: 122.6988s
Epoch: 7 cost time: 9.64059591293335
Epoch: 7, Steps: 570 | Train Loss: 0.1619769 Vali Loss: 0.0341742 Test Loss: 0.1114734
Validation loss decreased (0.034808 --> 0.034174).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0833036
	speed: 0.0503s/iter; left time: 367.7773s
	iters: 200, epoch: 8 | loss: 0.2457558
	speed: 0.0164s/iter; left time: 117.9258s
	iters: 300, epoch: 8 | loss: 0.1971235
	speed: 0.0163s/iter; left time: 116.2315s
	iters: 400, epoch: 8 | loss: 0.1781801
	speed: 0.0163s/iter; left time: 114.4968s
	iters: 500, epoch: 8 | loss: 0.1443961
	speed: 0.0163s/iter; left time: 112.9303s
Epoch: 8 cost time: 9.63207745552063
Epoch: 8, Steps: 570 | Train Loss: 0.1589763 Vali Loss: 0.0339690 Test Loss: 0.1106487
Validation loss decreased (0.034174 --> 0.033969).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0992123
	speed: 0.0518s/iter; left time: 349.3187s
	iters: 200, epoch: 9 | loss: 0.1586944
	speed: 0.0163s/iter; left time: 108.5423s
	iters: 300, epoch: 9 | loss: 0.0967666
	speed: 0.0178s/iter; left time: 116.7066s
	iters: 400, epoch: 9 | loss: 0.1272036
	speed: 0.0179s/iter; left time: 115.0043s
	iters: 500, epoch: 9 | loss: 0.0852321
	speed: 0.0179s/iter; left time: 113.2078s
Epoch: 9 cost time: 10.287617921829224
Epoch: 9, Steps: 570 | Train Loss: 0.1580761 Vali Loss: 0.0339173 Test Loss: 0.1107529
Validation loss decreased (0.033969 --> 0.033917).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1669910
	speed: 0.0540s/iter; left time: 333.0758s
	iters: 200, epoch: 10 | loss: 0.1650951
	speed: 0.0164s/iter; left time: 99.6554s
	iters: 300, epoch: 10 | loss: 0.1311248
	speed: 0.0164s/iter; left time: 97.7972s
	iters: 400, epoch: 10 | loss: 0.1945249
	speed: 0.0164s/iter; left time: 96.1639s
	iters: 500, epoch: 10 | loss: 0.1179071
	speed: 0.0164s/iter; left time: 94.5195s
Epoch: 10 cost time: 9.678165674209595
Epoch: 10, Steps: 570 | Train Loss: 0.1578447 Vali Loss: 0.0338990 Test Loss: 0.1106659
Validation loss decreased (0.033917 --> 0.033899).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1007985
	speed: 0.0515s/iter; left time: 288.4612s
	iters: 200, epoch: 11 | loss: 0.1268860
	speed: 0.0164s/iter; left time: 89.9666s
	iters: 300, epoch: 11 | loss: 0.1053247
	speed: 0.0164s/iter; left time: 88.3579s
	iters: 400, epoch: 11 | loss: 0.1901793
	speed: 0.0163s/iter; left time: 86.5345s
	iters: 500, epoch: 11 | loss: 0.1574086
	speed: 0.0163s/iter; left time: 84.8722s
Epoch: 11 cost time: 9.645182609558105
Epoch: 11, Steps: 570 | Train Loss: 0.1576925 Vali Loss: 0.0340112 Test Loss: 0.1106179
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1106339
	speed: 0.0500s/iter; left time: 251.3436s
	iters: 200, epoch: 12 | loss: 0.1610774
	speed: 0.0164s/iter; left time: 80.7318s
	iters: 300, epoch: 12 | loss: 0.0931303
	speed: 0.0164s/iter; left time: 79.1157s
	iters: 400, epoch: 12 | loss: 0.1648269
	speed: 0.0164s/iter; left time: 77.4771s
	iters: 500, epoch: 12 | loss: 0.2387092
	speed: 0.0164s/iter; left time: 75.8411s
Epoch: 12 cost time: 9.649921417236328
Epoch: 12, Steps: 570 | Train Loss: 0.1574193 Vali Loss: 0.0339695 Test Loss: 0.1105909
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2163615
	speed: 0.0512s/iter; left time: 228.3882s
	iters: 200, epoch: 13 | loss: 0.2399940
	speed: 0.0164s/iter; left time: 71.3858s
	iters: 300, epoch: 13 | loss: 0.2056655
	speed: 0.0164s/iter; left time: 69.7993s
	iters: 400, epoch: 13 | loss: 0.1324357
	speed: 0.0165s/iter; left time: 68.7965s
	iters: 500, epoch: 13 | loss: 0.1442983
	speed: 0.0179s/iter; left time: 72.4908s
Epoch: 13 cost time: 10.049834728240967
Epoch: 13, Steps: 570 | Train Loss: 0.1575063 Vali Loss: 0.0340451 Test Loss: 0.1105785
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11083490401506424, mae:0.20302008092403412
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2738749
	speed: 0.0292s/iter; left time: 330.4245s
	iters: 200, epoch: 1 | loss: 0.2410658
	speed: 0.0170s/iter; left time: 190.5798s
	iters: 300, epoch: 1 | loss: 0.1838185
	speed: 0.0171s/iter; left time: 189.5716s
	iters: 400, epoch: 1 | loss: 0.3203909
	speed: 0.0171s/iter; left time: 188.1951s
	iters: 500, epoch: 1 | loss: 0.3899314
	speed: 0.0158s/iter; left time: 172.5631s
Epoch: 1 cost time: 10.762296676635742
Epoch: 1, Steps: 570 | Train Loss: 0.2626514 Vali Loss: 0.0484837 Test Loss: 0.1565852
Validation loss decreased (inf --> 0.048484).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2507294
	speed: 0.0508s/iter; left time: 545.0885s
	iters: 200, epoch: 2 | loss: 0.1554500
	speed: 0.0155s/iter; left time: 164.3190s
	iters: 300, epoch: 2 | loss: 0.2832112
	speed: 0.0154s/iter; left time: 162.0583s
	iters: 400, epoch: 2 | loss: 0.2342743
	speed: 0.0154s/iter; left time: 160.6650s
	iters: 500, epoch: 2 | loss: 0.3202891
	speed: 0.0154s/iter; left time: 158.8916s
Epoch: 2 cost time: 9.18026065826416
Epoch: 2, Steps: 570 | Train Loss: 0.2514978 Vali Loss: 0.0754417 Test Loss: 0.2028981
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3472426
	speed: 0.0476s/iter; left time: 483.9405s
	iters: 200, epoch: 3 | loss: 0.1513417
	speed: 0.0154s/iter; left time: 155.2889s
	iters: 300, epoch: 3 | loss: 0.3537053
	speed: 0.0154s/iter; left time: 153.8164s
	iters: 400, epoch: 3 | loss: 0.2166460
	speed: 0.0154s/iter; left time: 151.9139s
	iters: 500, epoch: 3 | loss: 0.2753240
	speed: 0.0154s/iter; left time: 150.4456s
Epoch: 3 cost time: 9.07128357887268
Epoch: 3, Steps: 570 | Train Loss: 0.2626431 Vali Loss: 0.0480382 Test Loss: 0.1509399
Validation loss decreased (0.048484 --> 0.048038).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1961316
	speed: 0.0492s/iter; left time: 471.6767s
	iters: 200, epoch: 4 | loss: 0.2935966
	speed: 0.0155s/iter; left time: 147.0779s
	iters: 300, epoch: 4 | loss: 0.3480114
	speed: 0.0155s/iter; left time: 145.7484s
	iters: 400, epoch: 4 | loss: 0.2189986
	speed: 0.0155s/iter; left time: 144.0504s
	iters: 500, epoch: 4 | loss: 0.2833834
	speed: 0.0155s/iter; left time: 142.2614s
Epoch: 4 cost time: 9.147878170013428
Epoch: 4, Steps: 570 | Train Loss: 0.2311800 Vali Loss: 0.0482368 Test Loss: 0.1470153
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1678876
	speed: 0.0477s/iter; left time: 430.4962s
	iters: 200, epoch: 5 | loss: 0.1962808
	speed: 0.0154s/iter; left time: 137.2758s
	iters: 300, epoch: 5 | loss: 0.1936736
	speed: 0.0154s/iter; left time: 135.6552s
	iters: 400, epoch: 5 | loss: 0.1584071
	speed: 0.0154s/iter; left time: 134.2444s
	iters: 500, epoch: 5 | loss: 0.2072518
	speed: 0.0154s/iter; left time: 132.8328s
Epoch: 5 cost time: 9.102423667907715
Epoch: 5, Steps: 570 | Train Loss: 0.2162158 Vali Loss: 0.0466264 Test Loss: 0.1401968
Validation loss decreased (0.048038 --> 0.046626).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1975028
	speed: 0.0521s/iter; left time: 440.1814s
	iters: 200, epoch: 6 | loss: 0.1984609
	speed: 0.0171s/iter; left time: 142.5164s
	iters: 300, epoch: 6 | loss: 0.1290805
	speed: 0.0170s/iter; left time: 140.6034s
	iters: 400, epoch: 6 | loss: 0.1410978
	speed: 0.0167s/iter; left time: 135.8300s
	iters: 500, epoch: 6 | loss: 0.1558844
	speed: 0.0155s/iter; left time: 124.7038s
Epoch: 6 cost time: 9.744792222976685
Epoch: 6, Steps: 570 | Train Loss: 0.2068572 Vali Loss: 0.0456033 Test Loss: 0.1415516
Validation loss decreased (0.046626 --> 0.045603).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2529387
	speed: 0.0491s/iter; left time: 387.3464s
	iters: 200, epoch: 7 | loss: 0.1949639
	speed: 0.0154s/iter; left time: 120.0030s
	iters: 300, epoch: 7 | loss: 0.1584079
	speed: 0.0154s/iter; left time: 118.4326s
	iters: 400, epoch: 7 | loss: 0.2333105
	speed: 0.0154s/iter; left time: 116.5349s
	iters: 500, epoch: 7 | loss: 0.2131604
	speed: 0.0153s/iter; left time: 114.5144s
Epoch: 7 cost time: 9.073714971542358
Epoch: 7, Steps: 570 | Train Loss: 0.2030053 Vali Loss: 0.0455402 Test Loss: 0.1392490
Validation loss decreased (0.045603 --> 0.045540).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1815846
	speed: 0.0506s/iter; left time: 369.8982s
	iters: 200, epoch: 8 | loss: 0.2485581
	speed: 0.0154s/iter; left time: 110.7186s
	iters: 300, epoch: 8 | loss: 0.1278086
	speed: 0.0154s/iter; left time: 109.2119s
	iters: 400, epoch: 8 | loss: 0.1952574
	speed: 0.0153s/iter; left time: 107.4408s
	iters: 500, epoch: 8 | loss: 0.1229836
	speed: 0.0153s/iter; left time: 105.9393s
Epoch: 8 cost time: 9.06553864479065
Epoch: 8, Steps: 570 | Train Loss: 0.2005512 Vali Loss: 0.0445065 Test Loss: 0.1393705
Validation loss decreased (0.045540 --> 0.044507).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1886239
	speed: 0.0504s/iter; left time: 339.9592s
	iters: 200, epoch: 9 | loss: 0.1721874
	speed: 0.0155s/iter; left time: 102.7430s
	iters: 300, epoch: 9 | loss: 0.2327887
	speed: 0.0155s/iter; left time: 101.1658s
	iters: 400, epoch: 9 | loss: 0.1441329
	speed: 0.0155s/iter; left time: 99.6591s
	iters: 500, epoch: 9 | loss: 0.1836031
	speed: 0.0155s/iter; left time: 98.0881s
Epoch: 9 cost time: 9.128331899642944
Epoch: 9, Steps: 570 | Train Loss: 0.1996132 Vali Loss: 0.0446082 Test Loss: 0.1392387
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.2538546
	speed: 0.0478s/iter; left time: 294.9375s
	iters: 200, epoch: 10 | loss: 0.2266675
	speed: 0.0153s/iter; left time: 93.1360s
	iters: 300, epoch: 10 | loss: 0.1425828
	speed: 0.0153s/iter; left time: 91.5887s
	iters: 400, epoch: 10 | loss: 0.2254750
	speed: 0.0153s/iter; left time: 90.0371s
	iters: 500, epoch: 10 | loss: 0.3943844
	speed: 0.0153s/iter; left time: 88.5095s
Epoch: 10 cost time: 9.062186241149902
Epoch: 10, Steps: 570 | Train Loss: 0.2003246 Vali Loss: 0.0444149 Test Loss: 0.1389218
Validation loss decreased (0.044507 --> 0.044415).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.2145433
	speed: 0.0518s/iter; left time: 289.9967s
	iters: 200, epoch: 11 | loss: 0.1607526
	speed: 0.0154s/iter; left time: 84.7926s
	iters: 300, epoch: 11 | loss: 0.1815906
	speed: 0.0154s/iter; left time: 83.3375s
	iters: 400, epoch: 11 | loss: 0.2530977
	speed: 0.0154s/iter; left time: 81.5207s
	iters: 500, epoch: 11 | loss: 0.2577681
	speed: 0.0153s/iter; left time: 79.7163s
Epoch: 11 cost time: 9.098636627197266
Epoch: 11, Steps: 570 | Train Loss: 0.1997284 Vali Loss: 0.0445360 Test Loss: 0.1388688
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1345384
	speed: 0.0474s/iter; left time: 238.4263s
	iters: 200, epoch: 12 | loss: 0.3895433
	speed: 0.0153s/iter; left time: 75.6527s
	iters: 300, epoch: 12 | loss: 0.2682382
	speed: 0.0154s/iter; left time: 74.2959s
	iters: 400, epoch: 12 | loss: 0.1882094
	speed: 0.0154s/iter; left time: 72.8893s
	iters: 500, epoch: 12 | loss: 0.1769363
	speed: 0.0154s/iter; left time: 71.2368s
Epoch: 12 cost time: 9.029338598251343
Epoch: 12, Steps: 570 | Train Loss: 0.2000720 Vali Loss: 0.0445321 Test Loss: 0.1389161
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.2760415
	speed: 0.0469s/iter; left time: 209.1814s
	iters: 200, epoch: 13 | loss: 0.1822870
	speed: 0.0153s/iter; left time: 66.8248s
	iters: 300, epoch: 13 | loss: 0.1951600
	speed: 0.0153s/iter; left time: 65.3628s
	iters: 400, epoch: 13 | loss: 0.2494859
	speed: 0.0154s/iter; left time: 63.8787s
	iters: 500, epoch: 13 | loss: 0.1471906
	speed: 0.0153s/iter; left time: 62.1921s
Epoch: 13 cost time: 9.011364221572876
Epoch: 13, Steps: 570 | Train Loss: 0.2007352 Vali Loss: 0.0444837 Test Loss: 0.1388606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1390725076198578, mae:0.2316804677248001
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1979800
	speed: 0.0304s/iter; left time: 343.3097s
	iters: 200, epoch: 1 | loss: 0.2329361
	speed: 0.0187s/iter; left time: 209.3887s
	iters: 300, epoch: 1 | loss: 0.3890593
	speed: 0.0187s/iter; left time: 207.7155s
	iters: 400, epoch: 1 | loss: 0.1947859
	speed: 0.0187s/iter; left time: 206.0058s
	iters: 500, epoch: 1 | loss: 0.1655631
	speed: 0.0187s/iter; left time: 203.8076s
Epoch: 1 cost time: 11.883400678634644
Epoch: 1, Steps: 570 | Train Loss: 0.2447270 Vali Loss: 0.0476489 Test Loss: 0.1459083
Validation loss decreased (inf --> 0.047649).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3815386
	speed: 0.0566s/iter; left time: 607.1312s
	iters: 200, epoch: 2 | loss: 0.1765963
	speed: 0.0186s/iter; left time: 197.4937s
	iters: 300, epoch: 2 | loss: 0.1362110
	speed: 0.0186s/iter; left time: 195.5372s
	iters: 400, epoch: 2 | loss: 0.1704368
	speed: 0.0186s/iter; left time: 193.8894s
	iters: 500, epoch: 2 | loss: 0.1821329
	speed: 0.0186s/iter; left time: 192.3857s
Epoch: 2 cost time: 10.908458471298218
Epoch: 2, Steps: 570 | Train Loss: 0.2095919 Vali Loss: 0.0445460 Test Loss: 0.1347510
Validation loss decreased (0.047649 --> 0.044546).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1477922
	speed: 0.0582s/iter; left time: 591.0012s
	iters: 200, epoch: 3 | loss: 0.1658632
	speed: 0.0186s/iter; left time: 186.9425s
	iters: 300, epoch: 3 | loss: 0.2155154
	speed: 0.0186s/iter; left time: 185.4586s
	iters: 400, epoch: 3 | loss: 0.1262809
	speed: 0.0186s/iter; left time: 183.3533s
	iters: 500, epoch: 3 | loss: 0.1303732
	speed: 0.0187s/iter; left time: 182.0518s
Epoch: 3 cost time: 10.90052342414856
Epoch: 3, Steps: 570 | Train Loss: 0.1854190 Vali Loss: 0.0436595 Test Loss: 0.1318966
Validation loss decreased (0.044546 --> 0.043659).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1870910
	speed: 0.0560s/iter; left time: 537.0370s
	iters: 200, epoch: 4 | loss: 0.2351542
	speed: 0.0186s/iter; left time: 176.3182s
	iters: 300, epoch: 4 | loss: 0.1840209
	speed: 0.0185s/iter; left time: 173.9994s
	iters: 400, epoch: 4 | loss: 0.0944235
	speed: 0.0186s/iter; left time: 172.3667s
	iters: 500, epoch: 4 | loss: 0.1628318
	speed: 0.0185s/iter; left time: 170.1814s
Epoch: 4 cost time: 10.848828554153442
Epoch: 4, Steps: 570 | Train Loss: 0.1660591 Vali Loss: 0.0401228 Test Loss: 0.1307222
Validation loss decreased (0.043659 --> 0.040123).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2354830
	speed: 0.0597s/iter; left time: 538.7158s
	iters: 200, epoch: 5 | loss: 0.1616431
	speed: 0.0186s/iter; left time: 166.2975s
	iters: 300, epoch: 5 | loss: 0.1415432
	speed: 0.0187s/iter; left time: 164.5683s
	iters: 400, epoch: 5 | loss: 0.1302704
	speed: 0.0186s/iter; left time: 162.5723s
	iters: 500, epoch: 5 | loss: 0.1366715
	speed: 0.0186s/iter; left time: 160.4705s
Epoch: 5 cost time: 10.894646406173706
Epoch: 5, Steps: 570 | Train Loss: 0.1549483 Vali Loss: 0.0393205 Test Loss: 0.1318874
Validation loss decreased (0.040123 --> 0.039320).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0862106
	speed: 0.0562s/iter; left time: 475.2517s
	iters: 200, epoch: 6 | loss: 0.1426957
	speed: 0.0186s/iter; left time: 155.7222s
	iters: 300, epoch: 6 | loss: 0.1217947
	speed: 0.0186s/iter; left time: 153.8347s
	iters: 400, epoch: 6 | loss: 0.1642987
	speed: 0.0186s/iter; left time: 151.2122s
	iters: 500, epoch: 6 | loss: 0.1378561
	speed: 0.0185s/iter; left time: 149.1290s
Epoch: 6 cost time: 10.929916143417358
Epoch: 6, Steps: 570 | Train Loss: 0.1476896 Vali Loss: 0.0385074 Test Loss: 0.1282430
Validation loss decreased (0.039320 --> 0.038507).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1076406
	speed: 0.0598s/iter; left time: 470.9100s
	iters: 200, epoch: 7 | loss: 0.1230809
	speed: 0.0186s/iter; left time: 144.9959s
	iters: 300, epoch: 7 | loss: 0.1243722
	speed: 0.0186s/iter; left time: 142.8975s
	iters: 400, epoch: 7 | loss: 0.1548696
	speed: 0.0186s/iter; left time: 141.0774s
	iters: 500, epoch: 7 | loss: 0.2566475
	speed: 0.0186s/iter; left time: 139.1013s
Epoch: 7 cost time: 10.90614128112793
Epoch: 7, Steps: 570 | Train Loss: 0.1445968 Vali Loss: 0.0385820 Test Loss: 0.1284373
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1278794
	speed: 0.0562s/iter; left time: 410.5942s
	iters: 200, epoch: 8 | loss: 0.1256059
	speed: 0.0186s/iter; left time: 134.0446s
	iters: 300, epoch: 8 | loss: 0.1016735
	speed: 0.0186s/iter; left time: 132.1373s
	iters: 400, epoch: 8 | loss: 0.1710809
	speed: 0.0186s/iter; left time: 130.2310s
	iters: 500, epoch: 8 | loss: 0.1221571
	speed: 0.0186s/iter; left time: 128.3341s
Epoch: 8 cost time: 10.889902591705322
Epoch: 8, Steps: 570 | Train Loss: 0.1430321 Vali Loss: 0.0382561 Test Loss: 0.1283470
Validation loss decreased (0.038507 --> 0.038256).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0890513
	speed: 0.0586s/iter; left time: 395.0435s
	iters: 200, epoch: 9 | loss: 0.1911742
	speed: 0.0186s/iter; left time: 123.5529s
	iters: 300, epoch: 9 | loss: 0.0837665
	speed: 0.0186s/iter; left time: 121.7650s
	iters: 400, epoch: 9 | loss: 0.1713939
	speed: 0.0186s/iter; left time: 119.9300s
	iters: 500, epoch: 9 | loss: 0.0705790
	speed: 0.0186s/iter; left time: 117.8947s
Epoch: 9 cost time: 10.894598484039307
Epoch: 9, Steps: 570 | Train Loss: 0.1432252 Vali Loss: 0.0386749 Test Loss: 0.1292707
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1382120
	speed: 0.0584s/iter; left time: 360.6818s
	iters: 200, epoch: 10 | loss: 0.1594550
	speed: 0.0190s/iter; left time: 115.2172s
	iters: 300, epoch: 10 | loss: 0.1034489
	speed: 0.0187s/iter; left time: 111.9469s
	iters: 400, epoch: 10 | loss: 0.1186969
	speed: 0.0187s/iter; left time: 109.8453s
	iters: 500, epoch: 10 | loss: 0.1209665
	speed: 0.0187s/iter; left time: 107.9039s
Epoch: 10 cost time: 11.22367787361145
Epoch: 10, Steps: 570 | Train Loss: 0.1419138 Vali Loss: 0.0382800 Test Loss: 0.1293405
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1135975
	speed: 0.0555s/iter; left time: 310.8138s
	iters: 200, epoch: 11 | loss: 0.2162677
	speed: 0.0185s/iter; left time: 101.9567s
	iters: 300, epoch: 11 | loss: 0.1270639
	speed: 0.0186s/iter; left time: 100.2542s
	iters: 400, epoch: 11 | loss: 0.0953551
	speed: 0.0185s/iter; left time: 98.1621s
	iters: 500, epoch: 11 | loss: 0.2087691
	speed: 0.0185s/iter; left time: 96.2225s
Epoch: 11 cost time: 10.83960509300232
Epoch: 11, Steps: 570 | Train Loss: 0.1425096 Vali Loss: 0.0383815 Test Loss: 0.1293128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12851981818675995, mae:0.22300393879413605
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.4062195
	speed: 0.0304s/iter; left time: 343.0527s
	iters: 200, epoch: 1 | loss: 0.2367173
	speed: 0.0183s/iter; left time: 205.4180s
	iters: 300, epoch: 1 | loss: 0.1880140
	speed: 0.0184s/iter; left time: 204.1766s
	iters: 400, epoch: 1 | loss: 0.1825474
	speed: 0.0183s/iter; left time: 201.8166s
	iters: 500, epoch: 1 | loss: 0.2249993
	speed: 0.0184s/iter; left time: 200.6227s
Epoch: 1 cost time: 11.728650569915771
Epoch: 1, Steps: 570 | Train Loss: 0.2210236 Vali Loss: 0.0382343 Test Loss: 0.1270257
Validation loss decreased (inf --> 0.038234).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1443575
	speed: 0.0563s/iter; left time: 603.8906s
	iters: 200, epoch: 2 | loss: 0.2346351
	speed: 0.0184s/iter; left time: 196.0722s
	iters: 300, epoch: 2 | loss: 0.3214695
	speed: 0.0184s/iter; left time: 193.6431s
	iters: 400, epoch: 2 | loss: 0.1769039
	speed: 0.0184s/iter; left time: 192.3485s
	iters: 500, epoch: 2 | loss: 0.1559059
	speed: 0.0184s/iter; left time: 190.3425s
Epoch: 2 cost time: 10.815415143966675
Epoch: 2, Steps: 570 | Train Loss: 0.1931597 Vali Loss: 0.0417072 Test Loss: 0.1257905
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1181805
	speed: 0.0568s/iter; left time: 577.0389s
	iters: 200, epoch: 3 | loss: 0.1790282
	speed: 0.0185s/iter; left time: 185.6643s
	iters: 300, epoch: 3 | loss: 0.1843037
	speed: 0.0184s/iter; left time: 183.2296s
	iters: 400, epoch: 3 | loss: 0.1559345
	speed: 0.0184s/iter; left time: 181.6900s
	iters: 500, epoch: 3 | loss: 0.1333293
	speed: 0.0184s/iter; left time: 179.4039s
Epoch: 3 cost time: 10.77991509437561
Epoch: 3, Steps: 570 | Train Loss: 0.1680607 Vali Loss: 0.0361680 Test Loss: 0.1142172
Validation loss decreased (0.038234 --> 0.036168).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1780870
	speed: 0.0555s/iter; left time: 532.1133s
	iters: 200, epoch: 4 | loss: 0.1038720
	speed: 0.0184s/iter; left time: 174.6098s
	iters: 300, epoch: 4 | loss: 0.2237743
	speed: 0.0184s/iter; left time: 172.3771s
	iters: 400, epoch: 4 | loss: 0.1229403
	speed: 0.0183s/iter; left time: 169.8617s
	iters: 500, epoch: 4 | loss: 0.1177608
	speed: 0.0182s/iter; left time: 167.2656s
Epoch: 4 cost time: 10.752959728240967
Epoch: 4, Steps: 570 | Train Loss: 0.1538203 Vali Loss: 0.0342794 Test Loss: 0.1126993
Validation loss decreased (0.036168 --> 0.034279).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1363425
	speed: 0.0572s/iter; left time: 516.4073s
	iters: 200, epoch: 5 | loss: 0.1396369
	speed: 0.0183s/iter; left time: 163.3413s
	iters: 300, epoch: 5 | loss: 0.1429909
	speed: 0.0184s/iter; left time: 161.8782s
	iters: 400, epoch: 5 | loss: 0.1354701
	speed: 0.0184s/iter; left time: 160.1659s
	iters: 500, epoch: 5 | loss: 0.1390233
	speed: 0.0184s/iter; left time: 158.3864s
Epoch: 5 cost time: 10.771042346954346
Epoch: 5, Steps: 570 | Train Loss: 0.1457334 Vali Loss: 0.0337416 Test Loss: 0.1117296
Validation loss decreased (0.034279 --> 0.033742).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2053926
	speed: 0.0576s/iter; left time: 486.4908s
	iters: 200, epoch: 6 | loss: 0.1320635
	speed: 0.0182s/iter; left time: 152.2783s
	iters: 300, epoch: 6 | loss: 0.1648138
	speed: 0.0182s/iter; left time: 150.1161s
	iters: 400, epoch: 6 | loss: 0.1140018
	speed: 0.0182s/iter; left time: 148.2676s
	iters: 500, epoch: 6 | loss: 0.0900856
	speed: 0.0182s/iter; left time: 146.3664s
Epoch: 6 cost time: 10.65932846069336
Epoch: 6, Steps: 570 | Train Loss: 0.1408665 Vali Loss: 0.0336674 Test Loss: 0.1124479
Validation loss decreased (0.033742 --> 0.033667).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1324584
	speed: 0.0584s/iter; left time: 460.2924s
	iters: 200, epoch: 7 | loss: 0.1815987
	speed: 0.0182s/iter; left time: 141.4782s
	iters: 300, epoch: 7 | loss: 0.1007532
	speed: 0.0182s/iter; left time: 139.6235s
	iters: 400, epoch: 7 | loss: 0.1524494
	speed: 0.0182s/iter; left time: 137.8103s
	iters: 500, epoch: 7 | loss: 0.1171991
	speed: 0.0182s/iter; left time: 136.0599s
Epoch: 7 cost time: 10.656153678894043
Epoch: 7, Steps: 570 | Train Loss: 0.1371023 Vali Loss: 0.0332240 Test Loss: 0.1123765
Validation loss decreased (0.033667 --> 0.033224).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1047971
	speed: 0.0552s/iter; left time: 403.6625s
	iters: 200, epoch: 8 | loss: 0.1174079
	speed: 0.0183s/iter; left time: 131.8025s
	iters: 300, epoch: 8 | loss: 0.1243928
	speed: 0.0183s/iter; left time: 130.0273s
	iters: 400, epoch: 8 | loss: 0.1190089
	speed: 0.0183s/iter; left time: 128.1797s
	iters: 500, epoch: 8 | loss: 0.1612852
	speed: 0.0183s/iter; left time: 126.3364s
Epoch: 8 cost time: 10.737685203552246
Epoch: 8, Steps: 570 | Train Loss: 0.1349000 Vali Loss: 0.0330598 Test Loss: 0.1125979
Validation loss decreased (0.033224 --> 0.033060).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0788062
	speed: 0.0584s/iter; left time: 393.6135s
	iters: 200, epoch: 9 | loss: 0.1062236
	speed: 0.0192s/iter; left time: 127.6488s
	iters: 300, epoch: 9 | loss: 0.1499604
	speed: 0.0184s/iter; left time: 120.3126s
	iters: 400, epoch: 9 | loss: 0.1308397
	speed: 0.0184s/iter; left time: 118.5087s
	iters: 500, epoch: 9 | loss: 0.1163688
	speed: 0.0184s/iter; left time: 116.7561s
Epoch: 9 cost time: 11.10419249534607
Epoch: 9, Steps: 570 | Train Loss: 0.1347633 Vali Loss: 0.0328941 Test Loss: 0.1120978
Validation loss decreased (0.033060 --> 0.032894).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1081880
	speed: 0.0556s/iter; left time: 342.9346s
	iters: 200, epoch: 10 | loss: 0.0949696
	speed: 0.0183s/iter; left time: 110.9965s
	iters: 300, epoch: 10 | loss: 0.1786988
	speed: 0.0183s/iter; left time: 109.1668s
	iters: 400, epoch: 10 | loss: 0.1464879
	speed: 0.0183s/iter; left time: 107.4663s
	iters: 500, epoch: 10 | loss: 0.1142340
	speed: 0.0183s/iter; left time: 105.5238s
Epoch: 10 cost time: 10.707236051559448
Epoch: 10, Steps: 570 | Train Loss: 0.1351930 Vali Loss: 0.0327680 Test Loss: 0.1121678
Validation loss decreased (0.032894 --> 0.032768).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.1656882
	speed: 0.0567s/iter; left time: 317.5606s
	iters: 200, epoch: 11 | loss: 0.1380123
	speed: 0.0183s/iter; left time: 100.5420s
	iters: 300, epoch: 11 | loss: 0.0956098
	speed: 0.0183s/iter; left time: 98.7369s
	iters: 400, epoch: 11 | loss: 0.1846106
	speed: 0.0182s/iter; left time: 96.6628s
	iters: 500, epoch: 11 | loss: 0.1490075
	speed: 0.0182s/iter; left time: 94.8412s
Epoch: 11 cost time: 10.719211339950562
Epoch: 11, Steps: 570 | Train Loss: 0.1345975 Vali Loss: 0.0328031 Test Loss: 0.1123543
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.1867373
	speed: 0.0554s/iter; left time: 278.8406s
	iters: 200, epoch: 12 | loss: 0.1077482
	speed: 0.0183s/iter; left time: 90.2543s
	iters: 300, epoch: 12 | loss: 0.0930673
	speed: 0.0183s/iter; left time: 88.3143s
	iters: 400, epoch: 12 | loss: 0.1318797
	speed: 0.0183s/iter; left time: 86.4201s
	iters: 500, epoch: 12 | loss: 0.1422749
	speed: 0.0183s/iter; left time: 84.7086s
Epoch: 12 cost time: 10.71445083618164
Epoch: 12, Steps: 570 | Train Loss: 0.1345187 Vali Loss: 0.0327841 Test Loss: 0.1122793
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1140422
	speed: 0.0552s/iter; left time: 246.0310s
	iters: 200, epoch: 13 | loss: 0.1710508
	speed: 0.0182s/iter; left time: 79.5244s
	iters: 300, epoch: 13 | loss: 0.1083229
	speed: 0.0182s/iter; left time: 77.6160s
	iters: 400, epoch: 13 | loss: 0.1506232
	speed: 0.0182s/iter; left time: 75.7479s
	iters: 500, epoch: 13 | loss: 0.2035553
	speed: 0.0182s/iter; left time: 73.9074s
Epoch: 13 cost time: 10.69846510887146
Epoch: 13, Steps: 570 | Train Loss: 0.1355682 Vali Loss: 0.0328358 Test Loss: 0.1122939
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1123042106628418, mae:0.20286034047603607
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2797449
	speed: 0.0325s/iter; left time: 366.8529s
	iters: 200, epoch: 1 | loss: 0.1862150
	speed: 0.0205s/iter; left time: 229.3223s
	iters: 300, epoch: 1 | loss: 0.3039144
	speed: 0.0205s/iter; left time: 227.3624s
	iters: 400, epoch: 1 | loss: 0.2908368
	speed: 0.0205s/iter; left time: 225.9623s
	iters: 500, epoch: 1 | loss: 0.3222593
	speed: 0.0205s/iter; left time: 223.6544s
Epoch: 1 cost time: 12.94074010848999
Epoch: 1, Steps: 570 | Train Loss: 0.2490867 Vali Loss: 0.0448612 Test Loss: 0.1411850
Validation loss decreased (inf --> 0.044861).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3115781
	speed: 0.0597s/iter; left time: 640.5384s
	iters: 200, epoch: 2 | loss: 0.3009275
	speed: 0.0183s/iter; left time: 194.9364s
	iters: 300, epoch: 2 | loss: 0.4145051
	speed: 0.0183s/iter; left time: 193.1870s
	iters: 400, epoch: 2 | loss: 0.1729305
	speed: 0.0184s/iter; left time: 191.6454s
	iters: 500, epoch: 2 | loss: 0.1927388
	speed: 0.0184s/iter; left time: 189.6867s
Epoch: 2 cost time: 10.770537853240967
Epoch: 2, Steps: 570 | Train Loss: 0.2132458 Vali Loss: 0.0427954 Test Loss: 0.1374245
Validation loss decreased (0.044861 --> 0.042795).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1280790
	speed: 0.0559s/iter; left time: 568.3807s
	iters: 200, epoch: 3 | loss: 0.2055959
	speed: 0.0183s/iter; left time: 184.2526s
	iters: 300, epoch: 3 | loss: 0.2088492
	speed: 0.0183s/iter; left time: 182.2767s
	iters: 400, epoch: 3 | loss: 0.2187045
	speed: 0.0190s/iter; left time: 187.1080s
	iters: 500, epoch: 3 | loss: 0.1717113
	speed: 0.0211s/iter; left time: 205.7830s
Epoch: 3 cost time: 11.275119066238403
Epoch: 3, Steps: 570 | Train Loss: 0.1804804 Vali Loss: 0.0406638 Test Loss: 0.1281530
Validation loss decreased (0.042795 --> 0.040664).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1274240
	speed: 0.0602s/iter; left time: 576.9717s
	iters: 200, epoch: 4 | loss: 0.1697613
	speed: 0.0211s/iter; left time: 200.5047s
	iters: 300, epoch: 4 | loss: 0.1532433
	speed: 0.0211s/iter; left time: 198.3432s
	iters: 400, epoch: 4 | loss: 0.1963158
	speed: 0.0211s/iter; left time: 196.2255s
	iters: 500, epoch: 4 | loss: 0.1010367
	speed: 0.0211s/iter; left time: 194.0158s
Epoch: 4 cost time: 12.33368468284607
Epoch: 4, Steps: 570 | Train Loss: 0.1598551 Vali Loss: 0.0383151 Test Loss: 0.1256488
Validation loss decreased (0.040664 --> 0.038315).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1172608
	speed: 0.0619s/iter; left time: 558.7867s
	iters: 200, epoch: 5 | loss: 0.1494514
	speed: 0.0210s/iter; left time: 187.6397s
	iters: 300, epoch: 5 | loss: 0.1080816
	speed: 0.0210s/iter; left time: 185.5095s
	iters: 400, epoch: 5 | loss: 0.1401497
	speed: 0.0210s/iter; left time: 183.5318s
	iters: 500, epoch: 5 | loss: 0.0738565
	speed: 0.0210s/iter; left time: 181.3693s
Epoch: 5 cost time: 12.307719469070435
Epoch: 5, Steps: 570 | Train Loss: 0.1475491 Vali Loss: 0.0380924 Test Loss: 0.1269571
Validation loss decreased (0.038315 --> 0.038092).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1919727
	speed: 0.0610s/iter; left time: 515.7824s
	iters: 200, epoch: 6 | loss: 0.0946734
	speed: 0.0210s/iter; left time: 175.6424s
	iters: 300, epoch: 6 | loss: 0.2285027
	speed: 0.0210s/iter; left time: 173.4857s
	iters: 400, epoch: 6 | loss: 0.1166387
	speed: 0.0211s/iter; left time: 171.6239s
	iters: 500, epoch: 6 | loss: 0.1483490
	speed: 0.0210s/iter; left time: 169.2288s
Epoch: 6 cost time: 12.101080894470215
Epoch: 6, Steps: 570 | Train Loss: 0.1427690 Vali Loss: 0.0374106 Test Loss: 0.1276500
Validation loss decreased (0.038092 --> 0.037411).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1298775
	speed: 0.0564s/iter; left time: 444.8562s
	iters: 200, epoch: 7 | loss: 0.1101149
	speed: 0.0183s/iter; left time: 142.2841s
	iters: 300, epoch: 7 | loss: 0.1458274
	speed: 0.0183s/iter; left time: 140.5574s
	iters: 400, epoch: 7 | loss: 0.1348525
	speed: 0.0183s/iter; left time: 138.5433s
	iters: 500, epoch: 7 | loss: 0.1037479
	speed: 0.0183s/iter; left time: 136.6010s
Epoch: 7 cost time: 10.701912641525269
Epoch: 7, Steps: 570 | Train Loss: 0.1406734 Vali Loss: 0.0375035 Test Loss: 0.1276350
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1153444
	speed: 0.0558s/iter; left time: 408.1235s
	iters: 200, epoch: 8 | loss: 0.0958842
	speed: 0.0182s/iter; left time: 131.5591s
	iters: 300, epoch: 8 | loss: 0.1312107
	speed: 0.0182s/iter; left time: 129.7584s
	iters: 400, epoch: 8 | loss: 0.1608980
	speed: 0.0182s/iter; left time: 127.8687s
	iters: 500, epoch: 8 | loss: 0.1197002
	speed: 0.0182s/iter; left time: 126.0362s
Epoch: 8 cost time: 10.706734895706177
Epoch: 8, Steps: 570 | Train Loss: 0.1382457 Vali Loss: 0.0379177 Test Loss: 0.1280280
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1367284
	speed: 0.0569s/iter; left time: 383.6618s
	iters: 200, epoch: 9 | loss: 0.1761189
	speed: 0.0182s/iter; left time: 121.0432s
	iters: 300, epoch: 9 | loss: 0.1626104
	speed: 0.0182s/iter; left time: 119.1044s
	iters: 400, epoch: 9 | loss: 0.2542892
	speed: 0.0182s/iter; left time: 117.0429s
	iters: 500, epoch: 9 | loss: 0.1088795
	speed: 0.0182s/iter; left time: 115.2074s
Epoch: 9 cost time: 10.634943962097168
Epoch: 9, Steps: 570 | Train Loss: 0.1378798 Vali Loss: 0.0379509 Test Loss: 0.1280553
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12781256437301636, mae:0.22418509423732758
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2265389
	speed: 0.0351s/iter; left time: 397.1666s
	iters: 200, epoch: 1 | loss: 0.2037170
	speed: 0.0220s/iter; left time: 246.0457s
	iters: 300, epoch: 1 | loss: 0.2611356
	speed: 0.0220s/iter; left time: 243.8453s
	iters: 400, epoch: 1 | loss: 0.3736100
	speed: 0.0220s/iter; left time: 241.7193s
	iters: 500, epoch: 1 | loss: 0.3269736
	speed: 0.0220s/iter; left time: 239.4175s
Epoch: 1 cost time: 13.895604133605957
Epoch: 1, Steps: 570 | Train Loss: 0.2639419 Vali Loss: 0.0465951 Test Loss: 0.1468236
Validation loss decreased (inf --> 0.046595).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3247042
	speed: 0.0634s/iter; left time: 679.8546s
	iters: 200, epoch: 2 | loss: 0.2474189
	speed: 0.0220s/iter; left time: 233.4122s
	iters: 300, epoch: 2 | loss: 0.2419414
	speed: 0.0219s/iter; left time: 231.1049s
	iters: 400, epoch: 2 | loss: 0.3111796
	speed: 0.0219s/iter; left time: 228.9530s
	iters: 500, epoch: 2 | loss: 0.2558926
	speed: 0.0220s/iter; left time: 226.8309s
Epoch: 2 cost time: 12.83036494255066
Epoch: 2, Steps: 570 | Train Loss: 0.2886750 Vali Loss: 0.0646475 Test Loss: 0.1807764
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4931170
	speed: 0.0619s/iter; left time: 628.8194s
	iters: 200, epoch: 3 | loss: 0.2203465
	speed: 0.0221s/iter; left time: 221.9305s
	iters: 300, epoch: 3 | loss: 0.3041163
	speed: 0.0220s/iter; left time: 219.5328s
	iters: 400, epoch: 3 | loss: 0.2258451
	speed: 0.0220s/iter; left time: 217.3383s
	iters: 500, epoch: 3 | loss: 0.1609135
	speed: 0.0220s/iter; left time: 215.0009s
Epoch: 3 cost time: 12.845449686050415
Epoch: 3, Steps: 570 | Train Loss: 0.2678624 Vali Loss: 0.0592624 Test Loss: 0.1633920
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1885575
	speed: 0.0639s/iter; left time: 613.1158s
	iters: 200, epoch: 4 | loss: 0.2064136
	speed: 0.0222s/iter; left time: 210.4561s
	iters: 300, epoch: 4 | loss: 0.2522214
	speed: 0.0221s/iter; left time: 207.3696s
	iters: 400, epoch: 4 | loss: 0.2098793
	speed: 0.0221s/iter; left time: 205.1063s
	iters: 500, epoch: 4 | loss: 0.3203610
	speed: 0.0221s/iter; left time: 202.9010s
Epoch: 4 cost time: 13.10605502128601
Epoch: 4, Steps: 570 | Train Loss: 0.2464373 Vali Loss: 0.0537332 Test Loss: 0.1535708
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14701522886753082, mae:0.238888680934906
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2473196
	speed: 0.0353s/iter; left time: 398.6536s
	iters: 200, epoch: 1 | loss: 0.1257081
	speed: 0.0232s/iter; left time: 259.8141s
	iters: 300, epoch: 1 | loss: 0.1898378
	speed: 0.0233s/iter; left time: 258.2384s
	iters: 400, epoch: 1 | loss: 0.2509260
	speed: 0.0232s/iter; left time: 254.9653s
	iters: 500, epoch: 1 | loss: 0.2319994
	speed: 0.0232s/iter; left time: 252.6140s
Epoch: 1 cost time: 14.490164995193481
Epoch: 1, Steps: 570 | Train Loss: 0.2497239 Vali Loss: 0.0487074 Test Loss: 0.1458330
Validation loss decreased (inf --> 0.048707).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2340444
	speed: 0.0646s/iter; left time: 692.8995s
	iters: 200, epoch: 2 | loss: 0.1911051
	speed: 0.0214s/iter; left time: 227.7004s
	iters: 300, epoch: 2 | loss: 0.3099531
	speed: 0.0214s/iter; left time: 225.6109s
	iters: 400, epoch: 2 | loss: 0.2114587
	speed: 0.0214s/iter; left time: 223.1910s
	iters: 500, epoch: 2 | loss: 0.2178767
	speed: 0.0214s/iter; left time: 221.2444s
Epoch: 2 cost time: 12.524475574493408
Epoch: 2, Steps: 570 | Train Loss: 0.2483829 Vali Loss: 0.0637570 Test Loss: 0.1865307
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2303837
	speed: 0.0627s/iter; left time: 637.0914s
	iters: 200, epoch: 3 | loss: 0.2040206
	speed: 0.0233s/iter; left time: 234.4661s
	iters: 300, epoch: 3 | loss: 0.2155994
	speed: 0.0233s/iter; left time: 232.2606s
	iters: 400, epoch: 3 | loss: 0.1691144
	speed: 0.0233s/iter; left time: 229.4769s
	iters: 500, epoch: 3 | loss: 0.2280182
	speed: 0.0233s/iter; left time: 227.2830s
Epoch: 3 cost time: 13.536677598953247
Epoch: 3, Steps: 570 | Train Loss: 0.2552357 Vali Loss: 0.0537550 Test Loss: 0.1570746
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1636872
	speed: 0.0638s/iter; left time: 612.1449s
	iters: 200, epoch: 4 | loss: 0.2324255
	speed: 0.0232s/iter; left time: 220.3252s
	iters: 300, epoch: 4 | loss: 0.2311193
	speed: 0.0232s/iter; left time: 217.9078s
	iters: 400, epoch: 4 | loss: 0.2508463
	speed: 0.0232s/iter; left time: 215.6394s
	iters: 500, epoch: 4 | loss: 0.1465907
	speed: 0.0232s/iter; left time: 213.1369s
Epoch: 4 cost time: 13.496400117874146
Epoch: 4, Steps: 570 | Train Loss: 0.2251661 Vali Loss: 0.0478529 Test Loss: 0.1428172
Validation loss decreased (0.048707 --> 0.047853).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3381991
	speed: 0.0662s/iter; left time: 597.3159s
	iters: 200, epoch: 5 | loss: 0.1688681
	speed: 0.0233s/iter; left time: 208.1886s
	iters: 300, epoch: 5 | loss: 0.2440124
	speed: 0.0233s/iter; left time: 205.4333s
	iters: 400, epoch: 5 | loss: 0.2265646
	speed: 0.0233s/iter; left time: 202.9997s
	iters: 500, epoch: 5 | loss: 0.1937955
	speed: 0.0233s/iter; left time: 200.7527s
Epoch: 5 cost time: 13.576146841049194
Epoch: 5, Steps: 570 | Train Loss: 0.2147581 Vali Loss: 0.0463137 Test Loss: 0.1410170
Validation loss decreased (0.047853 --> 0.046314).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1619216
	speed: 0.0653s/iter; left time: 551.7464s
	iters: 200, epoch: 6 | loss: 0.2720591
	speed: 0.0233s/iter; left time: 194.7488s
	iters: 300, epoch: 6 | loss: 0.2588261
	speed: 0.0233s/iter; left time: 191.8974s
	iters: 400, epoch: 6 | loss: 0.1421844
	speed: 0.0233s/iter; left time: 189.5194s
	iters: 500, epoch: 6 | loss: 0.1271585
	speed: 0.0233s/iter; left time: 187.2925s
Epoch: 6 cost time: 13.571237087249756
Epoch: 6, Steps: 570 | Train Loss: 0.2085781 Vali Loss: 0.0456530 Test Loss: 0.1389347
Validation loss decreased (0.046314 --> 0.045653).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1957026
	speed: 0.0654s/iter; left time: 515.2826s
	iters: 200, epoch: 7 | loss: 0.2440834
	speed: 0.0233s/iter; left time: 181.2803s
	iters: 300, epoch: 7 | loss: 0.2426528
	speed: 0.0233s/iter; left time: 178.8299s
	iters: 400, epoch: 7 | loss: 0.1396694
	speed: 0.0233s/iter; left time: 176.5877s
	iters: 500, epoch: 7 | loss: 0.2076509
	speed: 0.0233s/iter; left time: 174.3031s
Epoch: 7 cost time: 13.60701584815979
Epoch: 7, Steps: 570 | Train Loss: 0.2040462 Vali Loss: 0.0450921 Test Loss: 0.1383753
Validation loss decreased (0.045653 --> 0.045092).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1679175
	speed: 0.0653s/iter; left time: 477.6291s
	iters: 200, epoch: 8 | loss: 0.2228707
	speed: 0.0232s/iter; left time: 167.4423s
	iters: 300, epoch: 8 | loss: 0.2266141
	speed: 0.0231s/iter; left time: 164.2244s
	iters: 400, epoch: 8 | loss: 0.1868207
	speed: 0.0213s/iter; left time: 149.5927s
	iters: 500, epoch: 8 | loss: 0.2489204
	speed: 0.0213s/iter; left time: 147.5495s
Epoch: 8 cost time: 13.00919222831726
Epoch: 8, Steps: 570 | Train Loss: 0.2040983 Vali Loss: 0.0444818 Test Loss: 0.1387045
Validation loss decreased (0.045092 --> 0.044482).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1514863
	speed: 0.0633s/iter; left time: 426.6607s
	iters: 200, epoch: 9 | loss: 0.3282959
	speed: 0.0232s/iter; left time: 154.3100s
	iters: 300, epoch: 9 | loss: 0.2165562
	speed: 0.0232s/iter; left time: 151.9408s
	iters: 400, epoch: 9 | loss: 0.1657842
	speed: 0.0232s/iter; left time: 149.4859s
	iters: 500, epoch: 9 | loss: 0.1373940
	speed: 0.0232s/iter; left time: 147.0737s
Epoch: 9 cost time: 13.532051801681519
Epoch: 9, Steps: 570 | Train Loss: 0.2025875 Vali Loss: 0.0441560 Test Loss: 0.1378595
Validation loss decreased (0.044482 --> 0.044156).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1225090
	speed: 0.0670s/iter; left time: 413.1492s
	iters: 200, epoch: 10 | loss: 0.2219221
	speed: 0.0233s/iter; left time: 141.5912s
	iters: 300, epoch: 10 | loss: 0.1584260
	speed: 0.0233s/iter; left time: 139.1048s
	iters: 400, epoch: 10 | loss: 0.1926998
	speed: 0.0233s/iter; left time: 136.6486s
	iters: 500, epoch: 10 | loss: 0.2200271
	speed: 0.0233s/iter; left time: 134.6092s
Epoch: 10 cost time: 13.593413591384888
Epoch: 10, Steps: 570 | Train Loss: 0.2016098 Vali Loss: 0.0441128 Test Loss: 0.1378013
Validation loss decreased (0.044156 --> 0.044113).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 11 | loss: 0.3134599
	speed: 0.0643s/iter; left time: 360.1511s
	iters: 200, epoch: 11 | loss: 0.2411440
	speed: 0.0213s/iter; left time: 116.9405s
	iters: 300, epoch: 11 | loss: 0.1653250
	speed: 0.0213s/iter; left time: 114.8080s
	iters: 400, epoch: 11 | loss: 0.1539716
	speed: 0.0213s/iter; left time: 112.6514s
	iters: 500, epoch: 11 | loss: 0.2373441
	speed: 0.0232s/iter; left time: 120.5475s
Epoch: 11 cost time: 12.899716854095459
Epoch: 11, Steps: 570 | Train Loss: 0.2021595 Vali Loss: 0.0440318 Test Loss: 0.1377459
Validation loss decreased (0.044113 --> 0.044032).  Saving model ...
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 12 | loss: 0.2353914
	speed: 0.0648s/iter; left time: 326.1478s
	iters: 200, epoch: 12 | loss: 0.3114094
	speed: 0.0233s/iter; left time: 114.9770s
	iters: 300, epoch: 12 | loss: 0.1593771
	speed: 0.0233s/iter; left time: 112.6726s
	iters: 400, epoch: 12 | loss: 0.3602030
	speed: 0.0233s/iter; left time: 110.1724s
	iters: 500, epoch: 12 | loss: 0.1722682
	speed: 0.0233s/iter; left time: 108.0088s
Epoch: 12 cost time: 13.593066692352295
Epoch: 12, Steps: 570 | Train Loss: 0.2014231 Vali Loss: 0.0440433 Test Loss: 0.1377519
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 13 | loss: 0.1846561
	speed: 0.0638s/iter; left time: 284.4261s
	iters: 200, epoch: 13 | loss: 0.2406921
	speed: 0.0223s/iter; left time: 97.1484s
	iters: 300, epoch: 13 | loss: 0.2706851
	speed: 0.0212s/iter; left time: 90.4857s
	iters: 400, epoch: 13 | loss: 0.1599784
	speed: 0.0212s/iter; left time: 88.3751s
	iters: 500, epoch: 13 | loss: 0.2028231
	speed: 0.0212s/iter; left time: 86.2093s
Epoch: 13 cost time: 12.68300986289978
Epoch: 13, Steps: 570 | Train Loss: 0.2015567 Vali Loss: 0.0441264 Test Loss: 0.1377645
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 14 | loss: 0.1936617
	speed: 0.0608s/iter; left time: 236.6772s
	iters: 200, epoch: 14 | loss: 0.2265234
	speed: 0.0214s/iter; left time: 81.1330s
	iters: 300, epoch: 14 | loss: 0.2004135
	speed: 0.0214s/iter; left time: 78.8454s
	iters: 400, epoch: 14 | loss: 0.1715649
	speed: 0.0214s/iter; left time: 76.7130s
	iters: 500, epoch: 14 | loss: 0.2285334
	speed: 0.0214s/iter; left time: 74.5824s
Epoch: 14 cost time: 12.462833642959595
Epoch: 14, Steps: 570 | Train Loss: 0.2025883 Vali Loss: 0.0440201 Test Loss: 0.1377260
Validation loss decreased (0.044032 --> 0.044020).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 15 | loss: 0.1840862
	speed: 0.0636s/iter; left time: 211.1392s
	iters: 200, epoch: 15 | loss: 0.1368307
	speed: 0.0232s/iter; left time: 74.6847s
	iters: 300, epoch: 15 | loss: 0.1548997
	speed: 0.0232s/iter; left time: 72.3874s
	iters: 400, epoch: 15 | loss: 0.1958587
	speed: 0.0232s/iter; left time: 70.1014s
	iters: 500, epoch: 15 | loss: 0.1892700
	speed: 0.0232s/iter; left time: 67.6616s
Epoch: 15 cost time: 13.542206048965454
Epoch: 15, Steps: 570 | Train Loss: 0.2019070 Vali Loss: 0.0439447 Test Loss: 0.1377172
Validation loss decreased (0.044020 --> 0.043945).  Saving model ...
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 16 | loss: 0.1813580
	speed: 0.0649s/iter; left time: 178.4514s
	iters: 200, epoch: 16 | loss: 0.1363460
	speed: 0.0214s/iter; left time: 56.6539s
	iters: 300, epoch: 16 | loss: 0.2831162
	speed: 0.0213s/iter; left time: 54.3488s
	iters: 400, epoch: 16 | loss: 0.2373928
	speed: 0.0213s/iter; left time: 52.1967s
	iters: 500, epoch: 16 | loss: 0.2242551
	speed: 0.0213s/iter; left time: 50.1016s
Epoch: 16 cost time: 12.528944730758667
Epoch: 16, Steps: 570 | Train Loss: 0.2016798 Vali Loss: 0.0439457 Test Loss: 0.1377160
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 17 | loss: 0.2514225
	speed: 0.0632s/iter; left time: 137.9263s
	iters: 200, epoch: 17 | loss: 0.3110075
	speed: 0.0214s/iter; left time: 44.4794s
	iters: 300, epoch: 17 | loss: 0.2045411
	speed: 0.0213s/iter; left time: 42.2202s
	iters: 400, epoch: 17 | loss: 0.2309391
	speed: 0.0213s/iter; left time: 40.0405s
	iters: 500, epoch: 17 | loss: 0.1832193
	speed: 0.0213s/iter; left time: 37.9171s
Epoch: 17 cost time: 12.470415353775024
Epoch: 17, Steps: 570 | Train Loss: 0.2015760 Vali Loss: 0.0441191 Test Loss: 0.1377131
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-09
	iters: 100, epoch: 18 | loss: 0.1943845
	speed: 0.0629s/iter; left time: 101.2517s
	iters: 200, epoch: 18 | loss: 0.3082238
	speed: 0.0214s/iter; left time: 32.3039s
	iters: 300, epoch: 18 | loss: 0.2240575
	speed: 0.0214s/iter; left time: 30.1362s
	iters: 400, epoch: 18 | loss: 0.2067386
	speed: 0.0214s/iter; left time: 28.0041s
	iters: 500, epoch: 18 | loss: 0.2080798
	speed: 0.0214s/iter; left time: 25.8699s
Epoch: 18 cost time: 12.660406827926636
Epoch: 18, Steps: 570 | Train Loss: 0.2016109 Vali Loss: 0.0440172 Test Loss: 0.1377118
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13791650533676147, mae:0.23043178021907806
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.2                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3004980
	speed: 0.0318s/iter; left time: 359.3059s
	iters: 200, epoch: 1 | loss: 0.1989134
	speed: 0.0200s/iter; left time: 224.4763s
	iters: 300, epoch: 1 | loss: 0.3044634
	speed: 0.0200s/iter; left time: 222.1053s
	iters: 400, epoch: 1 | loss: 0.2734650
	speed: 0.0200s/iter; left time: 220.4115s
	iters: 500, epoch: 1 | loss: 0.2556673
	speed: 0.0200s/iter; left time: 218.0886s
Epoch: 1 cost time: 12.643127202987671
Epoch: 1, Steps: 570 | Train Loss: 0.2702008 Vali Loss: 0.0588236 Test Loss: 0.1728681
Validation loss decreased (inf --> 0.058824).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1507782
	speed: 0.0591s/iter; left time: 633.8855s
	iters: 200, epoch: 2 | loss: 0.4606629
	speed: 0.0199s/iter; left time: 211.9307s
	iters: 300, epoch: 2 | loss: 0.3003632
	speed: 0.0199s/iter; left time: 209.8366s
	iters: 400, epoch: 2 | loss: 0.2307945
	speed: 0.0199s/iter; left time: 207.8509s
	iters: 500, epoch: 2 | loss: 0.1799846
	speed: 0.0199s/iter; left time: 205.7875s
Epoch: 2 cost time: 11.673454523086548
Epoch: 2, Steps: 570 | Train Loss: 0.2892339 Vali Loss: 0.0639202 Test Loss: 0.1825890
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2069496
	speed: 0.0578s/iter; left time: 587.3237s
	iters: 200, epoch: 3 | loss: 0.2117680
	speed: 0.0199s/iter; left time: 200.4126s
	iters: 300, epoch: 3 | loss: 0.2944541
	speed: 0.0199s/iter; left time: 198.4977s
	iters: 400, epoch: 3 | loss: 0.2844866
	speed: 0.0199s/iter; left time: 196.4444s
	iters: 500, epoch: 3 | loss: 0.2531351
	speed: 0.0199s/iter; left time: 194.4123s
Epoch: 3 cost time: 11.632629156112671
Epoch: 3, Steps: 570 | Train Loss: 0.2709073 Vali Loss: 0.0599584 Test Loss: 0.1668101
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1952371
	speed: 0.0590s/iter; left time: 566.1379s
	iters: 200, epoch: 4 | loss: 0.3761272
	speed: 0.0200s/iter; left time: 189.4557s
	iters: 300, epoch: 4 | loss: 0.1631347
	speed: 0.0199s/iter; left time: 186.9598s
	iters: 400, epoch: 4 | loss: 0.2734665
	speed: 0.0199s/iter; left time: 184.9284s
	iters: 500, epoch: 4 | loss: 0.1820910
	speed: 0.0199s/iter; left time: 182.8826s
Epoch: 4 cost time: 11.612287998199463
Epoch: 4, Steps: 570 | Train Loss: 0.2504997 Vali Loss: 0.0569234 Test Loss: 0.1600959
Validation loss decreased (0.058824 --> 0.056923).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2042698
	speed: 0.0590s/iter; left time: 531.9859s
	iters: 200, epoch: 5 | loss: 0.3836574
	speed: 0.0200s/iter; left time: 178.2830s
	iters: 300, epoch: 5 | loss: 0.2233628
	speed: 0.0200s/iter; left time: 176.2430s
	iters: 400, epoch: 5 | loss: 0.2100992
	speed: 0.0200s/iter; left time: 174.2359s
	iters: 500, epoch: 5 | loss: 0.2138872
	speed: 0.0203s/iter; left time: 174.9917s
Epoch: 5 cost time: 11.74637484550476
Epoch: 5, Steps: 570 | Train Loss: 0.2398774 Vali Loss: 0.0535849 Test Loss: 0.1552137
Validation loss decreased (0.056923 --> 0.053585).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2638490
	speed: 0.0608s/iter; left time: 514.1663s
	iters: 200, epoch: 6 | loss: 0.2066480
	speed: 0.0208s/iter; left time: 173.9817s
	iters: 300, epoch: 6 | loss: 0.2113417
	speed: 0.0221s/iter; left time: 182.4678s
	iters: 400, epoch: 6 | loss: 0.1573086
	speed: 0.0221s/iter; left time: 180.2088s
	iters: 500, epoch: 6 | loss: 0.3463879
	speed: 0.0221s/iter; left time: 177.9045s
Epoch: 6 cost time: 12.567992925643921
Epoch: 6, Steps: 570 | Train Loss: 0.2346667 Vali Loss: 0.0539009 Test Loss: 0.1536500
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2611862
	speed: 0.0605s/iter; left time: 476.4527s
	iters: 200, epoch: 7 | loss: 0.2718537
	speed: 0.0221s/iter; left time: 171.9939s
	iters: 300, epoch: 7 | loss: 0.2823459
	speed: 0.0213s/iter; left time: 163.9701s
	iters: 400, epoch: 7 | loss: 0.3576207
	speed: 0.0199s/iter; left time: 150.9061s
	iters: 500, epoch: 7 | loss: 0.1743409
	speed: 0.0199s/iter; left time: 148.8838s
Epoch: 7 cost time: 12.082859992980957
Epoch: 7, Steps: 570 | Train Loss: 0.2333656 Vali Loss: 0.0536834 Test Loss: 0.1523338
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2495489
	speed: 0.0623s/iter; left time: 455.4128s
	iters: 200, epoch: 8 | loss: 0.4250316
	speed: 0.0200s/iter; left time: 144.1982s
	iters: 300, epoch: 8 | loss: 0.2799234
	speed: 0.0200s/iter; left time: 142.4702s
	iters: 400, epoch: 8 | loss: 0.1764279
	speed: 0.0200s/iter; left time: 140.5093s
	iters: 500, epoch: 8 | loss: 0.2514960
	speed: 0.0200s/iter; left time: 138.3653s
Epoch: 8 cost time: 11.695039749145508
Epoch: 8, Steps: 570 | Train Loss: 0.2304643 Vali Loss: 0.0535885 Test Loss: 0.1519138
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.15540441870689392, mae:0.24983768165111542
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1513899
	speed: 0.0218s/iter; left time: 246.3004s
	iters: 200, epoch: 1 | loss: 0.1708261
	speed: 0.0100s/iter; left time: 111.7105s
	iters: 300, epoch: 1 | loss: 0.2072538
	speed: 0.0100s/iter; left time: 110.8285s
	iters: 400, epoch: 1 | loss: 0.1874213
	speed: 0.0099s/iter; left time: 109.3852s
	iters: 500, epoch: 1 | loss: 0.1462569
	speed: 0.0100s/iter; left time: 108.7865s
Epoch: 1 cost time: 6.911050319671631
Epoch: 1, Steps: 570 | Train Loss: 0.1782682 Vali Loss: 0.0488664 Test Loss: 0.1440767
Validation loss decreased (inf --> 0.048866).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1783890
	speed: 0.0356s/iter; left time: 381.9431s
	iters: 200, epoch: 2 | loss: 0.2236717
	speed: 0.0100s/iter; left time: 106.5063s
	iters: 300, epoch: 2 | loss: 0.1199877
	speed: 0.0100s/iter; left time: 105.2077s
	iters: 400, epoch: 2 | loss: 0.1373761
	speed: 0.0100s/iter; left time: 104.7091s
	iters: 500, epoch: 2 | loss: 0.1278298
	speed: 0.0100s/iter; left time: 103.7587s
Epoch: 2 cost time: 6.003725528717041
Epoch: 2, Steps: 570 | Train Loss: 0.1318140 Vali Loss: 0.0394691 Test Loss: 0.1216232
Validation loss decreased (0.048866 --> 0.039469).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0813655
	speed: 0.0370s/iter; left time: 376.0158s
	iters: 200, epoch: 3 | loss: 0.1225430
	speed: 0.0099s/iter; left time: 99.9350s
	iters: 300, epoch: 3 | loss: 0.0964295
	speed: 0.0100s/iter; left time: 99.1670s
	iters: 400, epoch: 3 | loss: 0.1345346
	speed: 0.0100s/iter; left time: 98.1471s
	iters: 500, epoch: 3 | loss: 0.1609011
	speed: 0.0099s/iter; left time: 96.9188s
Epoch: 3 cost time: 6.021456956863403
Epoch: 3, Steps: 570 | Train Loss: 0.1044723 Vali Loss: 0.0375850 Test Loss: 0.1230151
Validation loss decreased (0.039469 --> 0.037585).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1030105
	speed: 0.0364s/iter; left time: 348.7036s
	iters: 200, epoch: 4 | loss: 0.0546012
	speed: 0.0099s/iter; left time: 94.3217s
	iters: 300, epoch: 4 | loss: 0.0743815
	speed: 0.0100s/iter; left time: 93.6556s
	iters: 400, epoch: 4 | loss: 0.0863305
	speed: 0.0100s/iter; left time: 92.5803s
	iters: 500, epoch: 4 | loss: 0.0859571
	speed: 0.0100s/iter; left time: 91.4956s
Epoch: 4 cost time: 5.967909812927246
Epoch: 4, Steps: 570 | Train Loss: 0.0912220 Vali Loss: 0.0352333 Test Loss: 0.1292616
Validation loss decreased (0.037585 --> 0.035233).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0888323
	speed: 0.0352s/iter; left time: 317.4891s
	iters: 200, epoch: 5 | loss: 0.0870868
	speed: 0.0099s/iter; left time: 88.2498s
	iters: 300, epoch: 5 | loss: 0.0659903
	speed: 0.0099s/iter; left time: 87.1189s
	iters: 400, epoch: 5 | loss: 0.0912737
	speed: 0.0099s/iter; left time: 86.4218s
	iters: 500, epoch: 5 | loss: 0.0844885
	speed: 0.0099s/iter; left time: 85.4188s
Epoch: 5 cost time: 5.996942520141602
Epoch: 5, Steps: 570 | Train Loss: 0.0837980 Vali Loss: 0.0351836 Test Loss: 0.1282767
Validation loss decreased (0.035233 --> 0.035184).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0707374
	speed: 0.0361s/iter; left time: 305.2414s
	iters: 200, epoch: 6 | loss: 0.0545981
	speed: 0.0100s/iter; left time: 83.5742s
	iters: 300, epoch: 6 | loss: 0.0826763
	speed: 0.0100s/iter; left time: 82.6133s
	iters: 400, epoch: 6 | loss: 0.0825454
	speed: 0.0100s/iter; left time: 81.5377s
	iters: 500, epoch: 6 | loss: 0.0937315
	speed: 0.0100s/iter; left time: 80.2988s
Epoch: 6 cost time: 5.992112874984741
Epoch: 6, Steps: 570 | Train Loss: 0.0797587 Vali Loss: 0.0353576 Test Loss: 0.1341149
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0572066
	speed: 0.0360s/iter; left time: 283.3976s
	iters: 200, epoch: 7 | loss: 0.0860813
	speed: 0.0099s/iter; left time: 76.9901s
	iters: 300, epoch: 7 | loss: 0.0820051
	speed: 0.0099s/iter; left time: 76.0053s
	iters: 400, epoch: 7 | loss: 0.0914026
	speed: 0.0099s/iter; left time: 75.0007s
	iters: 500, epoch: 7 | loss: 0.0608955
	speed: 0.0099s/iter; left time: 73.9583s
Epoch: 7 cost time: 5.895593881607056
Epoch: 7, Steps: 570 | Train Loss: 0.0778621 Vali Loss: 0.0352114 Test Loss: 0.1327515
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0954885
	speed: 0.0363s/iter; left time: 265.1624s
	iters: 200, epoch: 8 | loss: 0.0881027
	speed: 0.0112s/iter; left time: 80.7317s
	iters: 300, epoch: 8 | loss: 0.0847088
	speed: 0.0112s/iter; left time: 79.6022s
	iters: 400, epoch: 8 | loss: 0.1198116
	speed: 0.0112s/iter; left time: 78.4532s
	iters: 500, epoch: 8 | loss: 0.0666076
	speed: 0.0112s/iter; left time: 77.3143s
Epoch: 8 cost time: 6.6564366817474365
Epoch: 8, Steps: 570 | Train Loss: 0.0767807 Vali Loss: 0.0349456 Test Loss: 0.1335279
Validation loss decreased (0.035184 --> 0.034946).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0757837
	speed: 0.0375s/iter; left time: 253.1225s
	iters: 200, epoch: 9 | loss: 0.0716201
	speed: 0.0099s/iter; left time: 65.9872s
	iters: 300, epoch: 9 | loss: 0.0531166
	speed: 0.0099s/iter; left time: 64.9821s
	iters: 400, epoch: 9 | loss: 0.0605998
	speed: 0.0099s/iter; left time: 63.8739s
	iters: 500, epoch: 9 | loss: 0.0825795
	speed: 0.0099s/iter; left time: 62.8846s
Epoch: 9 cost time: 5.938507795333862
Epoch: 9, Steps: 570 | Train Loss: 0.0762669 Vali Loss: 0.0351849 Test Loss: 0.1326815
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0987884
	speed: 0.0364s/iter; left time: 224.7884s
	iters: 200, epoch: 10 | loss: 0.0958489
	speed: 0.0100s/iter; left time: 60.4522s
	iters: 300, epoch: 10 | loss: 0.0612050
	speed: 0.0100s/iter; left time: 59.4677s
	iters: 400, epoch: 10 | loss: 0.0695738
	speed: 0.0100s/iter; left time: 58.7287s
	iters: 500, epoch: 10 | loss: 0.0914397
	speed: 0.0100s/iter; left time: 57.6907s
Epoch: 10 cost time: 5.978084087371826
Epoch: 10, Steps: 570 | Train Loss: 0.0759110 Vali Loss: 0.0349752 Test Loss: 0.1329615
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0891797
	speed: 0.0359s/iter; left time: 201.2044s
	iters: 200, epoch: 11 | loss: 0.0654194
	speed: 0.0099s/iter; left time: 54.3065s
	iters: 300, epoch: 11 | loss: 0.0499686
	speed: 0.0099s/iter; left time: 53.5169s
	iters: 400, epoch: 11 | loss: 0.0801086
	speed: 0.0099s/iter; left time: 52.5448s
	iters: 500, epoch: 11 | loss: 0.0725849
	speed: 0.0099s/iter; left time: 51.2588s
Epoch: 11 cost time: 5.887052059173584
Epoch: 11, Steps: 570 | Train Loss: 0.0758053 Vali Loss: 0.0349229 Test Loss: 0.1328993
Validation loss decreased (0.034946 --> 0.034923).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.0766716
	speed: 0.0349s/iter; left time: 175.4425s
	iters: 200, epoch: 12 | loss: 0.1050293
	speed: 0.0100s/iter; left time: 49.5113s
	iters: 300, epoch: 12 | loss: 0.0558165
	speed: 0.0101s/iter; left time: 48.6738s
	iters: 400, epoch: 12 | loss: 0.0781581
	speed: 0.0101s/iter; left time: 47.6298s
	iters: 500, epoch: 12 | loss: 0.1023269
	speed: 0.0100s/iter; left time: 46.2475s
Epoch: 12 cost time: 6.007117748260498
Epoch: 12, Steps: 570 | Train Loss: 0.0757633 Vali Loss: 0.0349610 Test Loss: 0.1328122
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0476927
	speed: 0.0370s/iter; left time: 165.1497s
	iters: 200, epoch: 13 | loss: 0.0836869
	speed: 0.0106s/iter; left time: 46.0298s
	iters: 300, epoch: 13 | loss: 0.0739400
	speed: 0.0103s/iter; left time: 44.0769s
	iters: 400, epoch: 13 | loss: 0.0708614
	speed: 0.0112s/iter; left time: 46.6802s
	iters: 500, epoch: 13 | loss: 0.0761347
	speed: 0.0112s/iter; left time: 45.6423s
Epoch: 13 cost time: 6.530152082443237
Epoch: 13, Steps: 570 | Train Loss: 0.0757305 Vali Loss: 0.0349727 Test Loss: 0.1329227
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.0647223
	speed: 0.0371s/iter; left time: 144.2329s
	iters: 200, epoch: 14 | loss: 0.0526018
	speed: 0.0100s/iter; left time: 37.8160s
	iters: 300, epoch: 14 | loss: 0.0859268
	speed: 0.0099s/iter; left time: 36.6997s
	iters: 400, epoch: 14 | loss: 0.0826752
	speed: 0.0099s/iter; left time: 35.7123s
	iters: 500, epoch: 14 | loss: 0.0700437
	speed: 0.0100s/iter; left time: 34.7480s
Epoch: 14 cost time: 5.960535764694214
Epoch: 14, Steps: 570 | Train Loss: 0.0756925 Vali Loss: 0.0349790 Test Loss: 0.1329065
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13309873640537262, mae:0.23310883343219757
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1296794
	speed: 0.0214s/iter; left time: 241.8310s
	iters: 200, epoch: 1 | loss: 0.1537673
	speed: 0.0098s/iter; left time: 110.0783s
	iters: 300, epoch: 1 | loss: 0.1868851
	speed: 0.0098s/iter; left time: 108.6446s
	iters: 400, epoch: 1 | loss: 0.1413876
	speed: 0.0098s/iter; left time: 107.8086s
	iters: 500, epoch: 1 | loss: 0.1430622
	speed: 0.0098s/iter; left time: 107.0308s
Epoch: 1 cost time: 6.793713569641113
Epoch: 1, Steps: 570 | Train Loss: 0.1467088 Vali Loss: 0.0350296 Test Loss: 0.1152290
Validation loss decreased (inf --> 0.035030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1114759
	speed: 0.0357s/iter; left time: 382.9954s
	iters: 200, epoch: 2 | loss: 0.1284230
	speed: 0.0097s/iter; left time: 103.1264s
	iters: 300, epoch: 2 | loss: 0.0688358
	speed: 0.0097s/iter; left time: 101.9539s
	iters: 400, epoch: 2 | loss: 0.1128854
	speed: 0.0097s/iter; left time: 101.1371s
	iters: 500, epoch: 2 | loss: 0.1115896
	speed: 0.0097s/iter; left time: 100.0091s
Epoch: 2 cost time: 5.836026191711426
Epoch: 2, Steps: 570 | Train Loss: 0.1114781 Vali Loss: 0.0329555 Test Loss: 0.1099542
Validation loss decreased (0.035030 --> 0.032956).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0609866
	speed: 0.0354s/iter; left time: 359.8601s
	iters: 200, epoch: 3 | loss: 0.0976384
	speed: 0.0098s/iter; left time: 98.2899s
	iters: 300, epoch: 3 | loss: 0.1724140
	speed: 0.0098s/iter; left time: 97.3679s
	iters: 400, epoch: 3 | loss: 0.0866911
	speed: 0.0097s/iter; left time: 96.0133s
	iters: 500, epoch: 3 | loss: 0.0692270
	speed: 0.0098s/iter; left time: 95.2227s
Epoch: 3 cost time: 5.846827030181885
Epoch: 3, Steps: 570 | Train Loss: 0.0921401 Vali Loss: 0.0308499 Test Loss: 0.1111345
Validation loss decreased (0.032956 --> 0.030850).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0585588
	speed: 0.0363s/iter; left time: 347.9494s
	iters: 200, epoch: 4 | loss: 0.0662341
	speed: 0.0097s/iter; left time: 92.3542s
	iters: 300, epoch: 4 | loss: 0.0571444
	speed: 0.0097s/iter; left time: 91.5263s
	iters: 400, epoch: 4 | loss: 0.0533146
	speed: 0.0098s/iter; left time: 90.7453s
	iters: 500, epoch: 4 | loss: 0.0809954
	speed: 0.0098s/iter; left time: 89.6768s
Epoch: 4 cost time: 5.854820013046265
Epoch: 4, Steps: 570 | Train Loss: 0.0807265 Vali Loss: 0.0310337 Test Loss: 0.1128686
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0621617
	speed: 0.0359s/iter; left time: 323.8459s
	iters: 200, epoch: 5 | loss: 0.1101965
	speed: 0.0098s/iter; left time: 87.0880s
	iters: 300, epoch: 5 | loss: 0.0706058
	speed: 0.0098s/iter; left time: 86.2239s
	iters: 400, epoch: 5 | loss: 0.0821538
	speed: 0.0097s/iter; left time: 85.0063s
	iters: 500, epoch: 5 | loss: 0.0852641
	speed: 0.0097s/iter; left time: 83.9870s
Epoch: 5 cost time: 5.88787841796875
Epoch: 5, Steps: 570 | Train Loss: 0.0744010 Vali Loss: 0.0319490 Test Loss: 0.1164137
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0432204
	speed: 0.0347s/iter; left time: 293.1205s
	iters: 200, epoch: 6 | loss: 0.1052784
	speed: 0.0097s/iter; left time: 80.9573s
	iters: 300, epoch: 6 | loss: 0.1071064
	speed: 0.0097s/iter; left time: 80.1610s
	iters: 400, epoch: 6 | loss: 0.0691435
	speed: 0.0097s/iter; left time: 79.1394s
	iters: 500, epoch: 6 | loss: 0.0560922
	speed: 0.0097s/iter; left time: 77.9755s
Epoch: 6 cost time: 5.808897972106934
Epoch: 6, Steps: 570 | Train Loss: 0.0713012 Vali Loss: 0.0315096 Test Loss: 0.1154929
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11129950731992722, mae:0.20474335551261902
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1780639
	speed: 0.0228s/iter; left time: 258.0103s
	iters: 200, epoch: 1 | loss: 0.1372520
	speed: 0.0109s/iter; left time: 122.1899s
	iters: 300, epoch: 1 | loss: 0.1191107
	speed: 0.0109s/iter; left time: 121.3336s
	iters: 400, epoch: 1 | loss: 0.0929553
	speed: 0.0109s/iter; left time: 119.9661s
	iters: 500, epoch: 1 | loss: 0.1663685
	speed: 0.0109s/iter; left time: 119.1672s
Epoch: 1 cost time: 7.4652252197265625
Epoch: 1, Steps: 570 | Train Loss: 0.1820953 Vali Loss: 0.0429141 Test Loss: 0.1349617
Validation loss decreased (inf --> 0.042914).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1548477
	speed: 0.0383s/iter; left time: 410.8134s
	iters: 200, epoch: 2 | loss: 0.2209670
	speed: 0.0111s/iter; left time: 117.8986s
	iters: 300, epoch: 2 | loss: 0.1052781
	speed: 0.0111s/iter; left time: 116.6775s
	iters: 400, epoch: 2 | loss: 0.1976978
	speed: 0.0110s/iter; left time: 115.2247s
	iters: 500, epoch: 2 | loss: 0.1454997
	speed: 0.0106s/iter; left time: 109.7139s
Epoch: 2 cost time: 6.472599744796753
Epoch: 2, Steps: 570 | Train Loss: 0.1344605 Vali Loss: 0.0395189 Test Loss: 0.1307461
Validation loss decreased (0.042914 --> 0.039519).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0897920
	speed: 0.0371s/iter; left time: 377.4194s
	iters: 200, epoch: 3 | loss: 0.0834154
	speed: 0.0109s/iter; left time: 109.7199s
	iters: 300, epoch: 3 | loss: 0.1152317
	speed: 0.0109s/iter; left time: 108.7243s
	iters: 400, epoch: 3 | loss: 0.0778258
	speed: 0.0109s/iter; left time: 107.6156s
	iters: 500, epoch: 3 | loss: 0.0889585
	speed: 0.0109s/iter; left time: 106.4009s
Epoch: 3 cost time: 6.5677101612091064
Epoch: 3, Steps: 570 | Train Loss: 0.1071869 Vali Loss: 0.0380230 Test Loss: 0.1316162
Validation loss decreased (0.039519 --> 0.038023).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0710069
	speed: 0.0367s/iter; left time: 351.8428s
	iters: 200, epoch: 4 | loss: 0.0664880
	speed: 0.0097s/iter; left time: 92.5239s
	iters: 300, epoch: 4 | loss: 0.0639720
	speed: 0.0097s/iter; left time: 91.2697s
	iters: 400, epoch: 4 | loss: 0.1217632
	speed: 0.0097s/iter; left time: 90.2531s
	iters: 500, epoch: 4 | loss: 0.0955939
	speed: 0.0097s/iter; left time: 89.2904s
Epoch: 4 cost time: 5.844275236129761
Epoch: 4, Steps: 570 | Train Loss: 0.0925274 Vali Loss: 0.0394200 Test Loss: 0.1415058
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0904921
	speed: 0.0356s/iter; left time: 320.9369s
	iters: 200, epoch: 5 | loss: 0.0606137
	speed: 0.0097s/iter; left time: 86.6527s
	iters: 300, epoch: 5 | loss: 0.0757486
	speed: 0.0097s/iter; left time: 85.6652s
	iters: 400, epoch: 5 | loss: 0.0715954
	speed: 0.0097s/iter; left time: 84.6651s
	iters: 500, epoch: 5 | loss: 0.0930780
	speed: 0.0097s/iter; left time: 83.6766s
Epoch: 5 cost time: 5.850264072418213
Epoch: 5, Steps: 570 | Train Loss: 0.0848515 Vali Loss: 0.0375565 Test Loss: 0.1370987
Validation loss decreased (0.038023 --> 0.037556).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0669339
	speed: 0.0353s/iter; left time: 298.4126s
	iters: 200, epoch: 6 | loss: 0.0817979
	speed: 0.0097s/iter; left time: 80.8213s
	iters: 300, epoch: 6 | loss: 0.0868388
	speed: 0.0097s/iter; left time: 79.8259s
	iters: 400, epoch: 6 | loss: 0.0847087
	speed: 0.0097s/iter; left time: 79.0305s
	iters: 500, epoch: 6 | loss: 0.0854470
	speed: 0.0097s/iter; left time: 78.1901s
Epoch: 6 cost time: 5.845348119735718
Epoch: 6, Steps: 570 | Train Loss: 0.0807174 Vali Loss: 0.0377012 Test Loss: 0.1391779
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0496188
	speed: 0.0359s/iter; left time: 283.0343s
	iters: 200, epoch: 7 | loss: 0.0840604
	speed: 0.0098s/iter; left time: 76.1433s
	iters: 300, epoch: 7 | loss: 0.0612264
	speed: 0.0098s/iter; left time: 75.1802s
	iters: 400, epoch: 7 | loss: 0.0641417
	speed: 0.0098s/iter; left time: 74.1172s
	iters: 500, epoch: 7 | loss: 0.0803898
	speed: 0.0098s/iter; left time: 73.1293s
Epoch: 7 cost time: 5.878122329711914
Epoch: 7, Steps: 570 | Train Loss: 0.0786098 Vali Loss: 0.0379949 Test Loss: 0.1402828
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0726003
	speed: 0.0357s/iter; left time: 261.1568s
	iters: 200, epoch: 8 | loss: 0.0959347
	speed: 0.0097s/iter; left time: 69.7637s
	iters: 300, epoch: 8 | loss: 0.0586260
	speed: 0.0097s/iter; left time: 68.6807s
	iters: 400, epoch: 8 | loss: 0.0814930
	speed: 0.0097s/iter; left time: 67.8754s
	iters: 500, epoch: 8 | loss: 0.0738687
	speed: 0.0097s/iter; left time: 67.0096s
Epoch: 8 cost time: 5.820334434509277
Epoch: 8, Steps: 570 | Train Loss: 0.0774923 Vali Loss: 0.0378750 Test Loss: 0.1392616
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13732154667377472, mae:0.2374982088804245
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2075656
	speed: 0.0231s/iter; left time: 261.1090s
	iters: 200, epoch: 1 | loss: 0.1891302
	speed: 0.0114s/iter; left time: 127.4100s
	iters: 300, epoch: 1 | loss: 0.1438425
	speed: 0.0114s/iter; left time: 126.0559s
	iters: 400, epoch: 1 | loss: 0.0960854
	speed: 0.0114s/iter; left time: 125.0615s
	iters: 500, epoch: 1 | loss: 0.1460082
	speed: 0.0114s/iter; left time: 124.6780s
Epoch: 1 cost time: 7.719037771224976
Epoch: 1, Steps: 570 | Train Loss: 0.1726389 Vali Loss: 0.0416023 Test Loss: 0.1333482
Validation loss decreased (inf --> 0.041602).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1125999
	speed: 0.0390s/iter; left time: 418.2467s
	iters: 200, epoch: 2 | loss: 0.1601015
	speed: 0.0115s/iter; left time: 121.9135s
	iters: 300, epoch: 2 | loss: 0.0863702
	speed: 0.0115s/iter; left time: 120.7772s
	iters: 400, epoch: 2 | loss: 0.0722242
	speed: 0.0115s/iter; left time: 119.5703s
	iters: 500, epoch: 2 | loss: 0.1252543
	speed: 0.0115s/iter; left time: 118.5673s
Epoch: 2 cost time: 6.856490135192871
Epoch: 2, Steps: 570 | Train Loss: 0.1206118 Vali Loss: 0.0371007 Test Loss: 0.1300596
Validation loss decreased (0.041602 --> 0.037101).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1112814
	speed: 0.0399s/iter; left time: 405.1475s
	iters: 200, epoch: 3 | loss: 0.1019169
	speed: 0.0115s/iter; left time: 115.2426s
	iters: 300, epoch: 3 | loss: 0.0533755
	speed: 0.0115s/iter; left time: 114.2295s
	iters: 400, epoch: 3 | loss: 0.0745492
	speed: 0.0115s/iter; left time: 112.9506s
	iters: 500, epoch: 3 | loss: 0.0664679
	speed: 0.0115s/iter; left time: 111.7697s
Epoch: 3 cost time: 6.845390796661377
Epoch: 3, Steps: 570 | Train Loss: 0.0850507 Vali Loss: 0.0382536 Test Loss: 0.1343134
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0650218
	speed: 0.0397s/iter; left time: 380.5708s
	iters: 200, epoch: 4 | loss: 0.0675176
	speed: 0.0114s/iter; left time: 107.8480s
	iters: 300, epoch: 4 | loss: 0.0475311
	speed: 0.0114s/iter; left time: 106.8736s
	iters: 400, epoch: 4 | loss: 0.0494996
	speed: 0.0114s/iter; left time: 105.6451s
	iters: 500, epoch: 4 | loss: 0.0569383
	speed: 0.0114s/iter; left time: 104.4804s
Epoch: 4 cost time: 6.790072917938232
Epoch: 4, Steps: 570 | Train Loss: 0.0661452 Vali Loss: 0.0368891 Test Loss: 0.1419170
Validation loss decreased (0.037101 --> 0.036889).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0638862
	speed: 0.0384s/iter; left time: 346.0693s
	iters: 200, epoch: 5 | loss: 0.0473970
	speed: 0.0114s/iter; left time: 101.6917s
	iters: 300, epoch: 5 | loss: 0.0737297
	speed: 0.0114s/iter; left time: 100.5639s
	iters: 400, epoch: 5 | loss: 0.0438493
	speed: 0.0114s/iter; left time: 99.3957s
	iters: 500, epoch: 5 | loss: 0.0572657
	speed: 0.0114s/iter; left time: 98.2505s
Epoch: 5 cost time: 6.831918001174927
Epoch: 5, Steps: 570 | Train Loss: 0.0570209 Vali Loss: 0.0372287 Test Loss: 0.1375001
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0528088
	speed: 0.0380s/iter; left time: 320.8675s
	iters: 200, epoch: 6 | loss: 0.0441225
	speed: 0.0114s/iter; left time: 95.3897s
	iters: 300, epoch: 6 | loss: 0.0589389
	speed: 0.0114s/iter; left time: 94.4198s
	iters: 400, epoch: 6 | loss: 0.0440373
	speed: 0.0114s/iter; left time: 92.9605s
	iters: 500, epoch: 6 | loss: 0.0396450
	speed: 0.0114s/iter; left time: 91.7200s
Epoch: 6 cost time: 6.808444023132324
Epoch: 6, Steps: 570 | Train Loss: 0.0524589 Vali Loss: 0.0373383 Test Loss: 0.1398008
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0418494
	speed: 0.0371s/iter; left time: 292.3338s
	iters: 200, epoch: 7 | loss: 0.0407792
	speed: 0.0114s/iter; left time: 88.9878s
	iters: 300, epoch: 7 | loss: 0.0543232
	speed: 0.0114s/iter; left time: 87.9391s
	iters: 400, epoch: 7 | loss: 0.0451226
	speed: 0.0114s/iter; left time: 86.6740s
	iters: 500, epoch: 7 | loss: 0.0532091
	speed: 0.0114s/iter; left time: 85.6423s
Epoch: 7 cost time: 6.7970662117004395
Epoch: 7, Steps: 570 | Train Loss: 0.0501880 Vali Loss: 0.0371221 Test Loss: 0.1395622
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1421547830104828, mae:0.2445380836725235
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.0821424
	speed: 0.0244s/iter; left time: 276.0178s
	iters: 200, epoch: 1 | loss: 0.2055272
	speed: 0.0121s/iter; left time: 135.4935s
	iters: 300, epoch: 1 | loss: 0.1187363
	speed: 0.0121s/iter; left time: 133.9655s
	iters: 400, epoch: 1 | loss: 0.1494484
	speed: 0.0121s/iter; left time: 132.8790s
	iters: 500, epoch: 1 | loss: 0.1010472
	speed: 0.0121s/iter; left time: 132.0276s
Epoch: 1 cost time: 8.176197290420532
Epoch: 1, Steps: 570 | Train Loss: 0.1439106 Vali Loss: 0.0382256 Test Loss: 0.1186200
Validation loss decreased (inf --> 0.038226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1050378
	speed: 0.0394s/iter; left time: 422.2665s
	iters: 200, epoch: 2 | loss: 0.0721160
	speed: 0.0110s/iter; left time: 117.2625s
	iters: 300, epoch: 2 | loss: 0.1025319
	speed: 0.0110s/iter; left time: 116.3265s
	iters: 400, epoch: 2 | loss: 0.1451430
	speed: 0.0111s/iter; left time: 115.2968s
	iters: 500, epoch: 2 | loss: 0.1316334
	speed: 0.0110s/iter; left time: 113.8296s
Epoch: 2 cost time: 6.623372793197632
Epoch: 2, Steps: 570 | Train Loss: 0.1032850 Vali Loss: 0.0366824 Test Loss: 0.1188014
Validation loss decreased (0.038226 --> 0.036682).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0892414
	speed: 0.0391s/iter; left time: 397.4793s
	iters: 200, epoch: 3 | loss: 0.0581202
	speed: 0.0111s/iter; left time: 111.7640s
	iters: 300, epoch: 3 | loss: 0.0749623
	speed: 0.0111s/iter; left time: 110.4746s
	iters: 400, epoch: 3 | loss: 0.0981017
	speed: 0.0111s/iter; left time: 109.1906s
	iters: 500, epoch: 3 | loss: 0.0787319
	speed: 0.0111s/iter; left time: 108.2012s
Epoch: 3 cost time: 6.660517692565918
Epoch: 3, Steps: 570 | Train Loss: 0.0738748 Vali Loss: 0.0344610 Test Loss: 0.1209547
Validation loss decreased (0.036682 --> 0.034461).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0760859
	speed: 0.0385s/iter; left time: 369.6381s
	iters: 200, epoch: 4 | loss: 0.0513707
	speed: 0.0111s/iter; left time: 105.5488s
	iters: 300, epoch: 4 | loss: 0.0340439
	speed: 0.0111s/iter; left time: 104.2960s
	iters: 400, epoch: 4 | loss: 0.0534885
	speed: 0.0111s/iter; left time: 103.2467s
	iters: 500, epoch: 4 | loss: 0.0699914
	speed: 0.0111s/iter; left time: 102.0638s
Epoch: 4 cost time: 6.665702819824219
Epoch: 4, Steps: 570 | Train Loss: 0.0581782 Vali Loss: 0.0338879 Test Loss: 0.1185862
Validation loss decreased (0.034461 --> 0.033888).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0432031
	speed: 0.0395s/iter; left time: 356.1895s
	iters: 200, epoch: 5 | loss: 0.0489614
	speed: 0.0121s/iter; left time: 107.8506s
	iters: 300, epoch: 5 | loss: 0.0570353
	speed: 0.0121s/iter; left time: 106.9057s
	iters: 400, epoch: 5 | loss: 0.0587425
	speed: 0.0121s/iter; left time: 105.4398s
	iters: 500, epoch: 5 | loss: 0.0486464
	speed: 0.0121s/iter; left time: 104.3042s
Epoch: 5 cost time: 7.242405414581299
Epoch: 5, Steps: 570 | Train Loss: 0.0501565 Vali Loss: 0.0345894 Test Loss: 0.1200429
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0685314
	speed: 0.0378s/iter; left time: 319.7258s
	iters: 200, epoch: 6 | loss: 0.0445221
	speed: 0.0110s/iter; left time: 91.9871s
	iters: 300, epoch: 6 | loss: 0.0449592
	speed: 0.0110s/iter; left time: 90.9270s
	iters: 400, epoch: 6 | loss: 0.0366026
	speed: 0.0110s/iter; left time: 89.8215s
	iters: 500, epoch: 6 | loss: 0.0413571
	speed: 0.0110s/iter; left time: 88.7078s
Epoch: 6 cost time: 6.565810680389404
Epoch: 6, Steps: 570 | Train Loss: 0.0462577 Vali Loss: 0.0350961 Test Loss: 0.1203088
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0393076
	speed: 0.0382s/iter; left time: 301.2521s
	iters: 200, epoch: 7 | loss: 0.0463046
	speed: 0.0111s/iter; left time: 86.0247s
	iters: 300, epoch: 7 | loss: 0.0442514
	speed: 0.0111s/iter; left time: 84.9276s
	iters: 400, epoch: 7 | loss: 0.0389046
	speed: 0.0111s/iter; left time: 83.8447s
	iters: 500, epoch: 7 | loss: 0.0392465
	speed: 0.0111s/iter; left time: 82.7298s
Epoch: 7 cost time: 6.645265579223633
Epoch: 7, Steps: 570 | Train Loss: 0.0443031 Vali Loss: 0.0349080 Test Loss: 0.1201539
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11877221614122391, mae:0.21709507703781128
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1887072
	speed: 0.0219s/iter; left time: 247.8981s
	iters: 200, epoch: 1 | loss: 0.1759307
	speed: 0.0103s/iter; left time: 114.8240s
	iters: 300, epoch: 1 | loss: 0.2258705
	speed: 0.0103s/iter; left time: 114.0519s
	iters: 400, epoch: 1 | loss: 0.1309080
	speed: 0.0103s/iter; left time: 112.9353s
	iters: 500, epoch: 1 | loss: 0.1294963
	speed: 0.0103s/iter; left time: 111.9383s
Epoch: 1 cost time: 7.0697784423828125
Epoch: 1, Steps: 570 | Train Loss: 0.1765686 Vali Loss: 0.0423134 Test Loss: 0.1332751
Validation loss decreased (inf --> 0.042313).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1715980
	speed: 0.0375s/iter; left time: 402.7249s
	iters: 200, epoch: 2 | loss: 0.1917507
	speed: 0.0103s/iter; left time: 109.8028s
	iters: 300, epoch: 2 | loss: 0.0993218
	speed: 0.0103s/iter; left time: 108.3572s
	iters: 400, epoch: 2 | loss: 0.0857142
	speed: 0.0103s/iter; left time: 107.6253s
	iters: 500, epoch: 2 | loss: 0.1163648
	speed: 0.0103s/iter; left time: 106.7131s
Epoch: 2 cost time: 6.2165491580963135
Epoch: 2, Steps: 570 | Train Loss: 0.1256958 Vali Loss: 0.0456945 Test Loss: 0.1378805
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1145572
	speed: 0.0377s/iter; left time: 383.3426s
	iters: 200, epoch: 3 | loss: 0.0797853
	speed: 0.0103s/iter; left time: 103.3550s
	iters: 300, epoch: 3 | loss: 0.0870536
	speed: 0.0103s/iter; left time: 102.5083s
	iters: 400, epoch: 3 | loss: 0.0757016
	speed: 0.0103s/iter; left time: 101.7502s
	iters: 500, epoch: 3 | loss: 0.1084943
	speed: 0.0103s/iter; left time: 100.4450s
Epoch: 3 cost time: 6.179216146469116
Epoch: 3, Steps: 570 | Train Loss: 0.0880999 Vali Loss: 0.0434391 Test Loss: 0.1412951
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0574450
	speed: 0.0356s/iter; left time: 341.2204s
	iters: 200, epoch: 4 | loss: 0.0721468
	speed: 0.0103s/iter; left time: 97.7148s
	iters: 300, epoch: 4 | loss: 0.0654138
	speed: 0.0103s/iter; left time: 96.5665s
	iters: 400, epoch: 4 | loss: 0.0990636
	speed: 0.0103s/iter; left time: 95.7119s
	iters: 500, epoch: 4 | loss: 0.0713094
	speed: 0.0103s/iter; left time: 94.4837s
Epoch: 4 cost time: 6.124274730682373
Epoch: 4, Steps: 570 | Train Loss: 0.0684439 Vali Loss: 0.0446042 Test Loss: 0.1375321
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1334594041109085, mae:0.23299375176429749
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1846062
	speed: 0.0261s/iter; left time: 295.4808s
	iters: 200, epoch: 1 | loss: 0.1460764
	speed: 0.0138s/iter; left time: 154.7184s
	iters: 300, epoch: 1 | loss: 0.2441318
	speed: 0.0153s/iter; left time: 169.6166s
	iters: 400, epoch: 1 | loss: 0.1463033
	speed: 0.0154s/iter; left time: 169.8305s
	iters: 500, epoch: 1 | loss: 0.1389970
	speed: 0.0154s/iter; left time: 168.1610s
Epoch: 1 cost time: 9.733242750167847
Epoch: 1, Steps: 570 | Train Loss: 0.1763569 Vali Loss: 0.0408216 Test Loss: 0.1298443
Validation loss decreased (inf --> 0.040822).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1671756
	speed: 0.0469s/iter; left time: 502.8866s
	iters: 200, epoch: 2 | loss: 0.1170338
	speed: 0.0138s/iter; left time: 146.2960s
	iters: 300, epoch: 2 | loss: 0.1050745
	speed: 0.0137s/iter; left time: 144.6303s
	iters: 400, epoch: 2 | loss: 0.1136662
	speed: 0.0137s/iter; left time: 142.6892s
	iters: 500, epoch: 2 | loss: 0.1486110
	speed: 0.0137s/iter; left time: 141.2727s
Epoch: 2 cost time: 8.143746137619019
Epoch: 2, Steps: 570 | Train Loss: 0.1301342 Vali Loss: 0.0375515 Test Loss: 0.1284046
Validation loss decreased (0.040822 --> 0.037552).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1702181
	speed: 0.0470s/iter; left time: 477.3676s
	iters: 200, epoch: 3 | loss: 0.0794896
	speed: 0.0137s/iter; left time: 138.0545s
	iters: 300, epoch: 3 | loss: 0.0642059
	speed: 0.0137s/iter; left time: 136.6395s
	iters: 400, epoch: 3 | loss: 0.0825356
	speed: 0.0137s/iter; left time: 135.0571s
	iters: 500, epoch: 3 | loss: 0.0720266
	speed: 0.0137s/iter; left time: 133.7010s
Epoch: 3 cost time: 8.108181953430176
Epoch: 3, Steps: 570 | Train Loss: 0.0985180 Vali Loss: 0.0344121 Test Loss: 0.1251863
Validation loss decreased (0.037552 --> 0.034412).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0837777
	speed: 0.0490s/iter; left time: 469.5353s
	iters: 200, epoch: 4 | loss: 0.0715140
	speed: 0.0154s/iter; left time: 146.4279s
	iters: 300, epoch: 4 | loss: 0.1077494
	speed: 0.0143s/iter; left time: 134.6733s
	iters: 400, epoch: 4 | loss: 0.0905709
	speed: 0.0137s/iter; left time: 127.3721s
	iters: 500, epoch: 4 | loss: 0.0786342
	speed: 0.0137s/iter; left time: 126.3451s
Epoch: 4 cost time: 8.539471626281738
Epoch: 4, Steps: 570 | Train Loss: 0.0826425 Vali Loss: 0.0340419 Test Loss: 0.1338193
Validation loss decreased (0.034412 --> 0.034042).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0822442
	speed: 0.0489s/iter; left time: 441.1925s
	iters: 200, epoch: 5 | loss: 0.0708540
	speed: 0.0154s/iter; left time: 137.7757s
	iters: 300, epoch: 5 | loss: 0.0620825
	speed: 0.0155s/iter; left time: 136.4932s
	iters: 400, epoch: 5 | loss: 0.0708510
	speed: 0.0154s/iter; left time: 134.2401s
	iters: 500, epoch: 5 | loss: 0.0573040
	speed: 0.0154s/iter; left time: 132.3609s
Epoch: 5 cost time: 9.076831817626953
Epoch: 5, Steps: 570 | Train Loss: 0.0745537 Vali Loss: 0.0338613 Test Loss: 0.1355065
Validation loss decreased (0.034042 --> 0.033861).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0625130
	speed: 0.0458s/iter; left time: 387.3798s
	iters: 200, epoch: 6 | loss: 0.1003545
	speed: 0.0137s/iter; left time: 114.1892s
	iters: 300, epoch: 6 | loss: 0.0615088
	speed: 0.0137s/iter; left time: 113.0349s
	iters: 400, epoch: 6 | loss: 0.0667660
	speed: 0.0137s/iter; left time: 111.7361s
	iters: 500, epoch: 6 | loss: 0.0611838
	speed: 0.0137s/iter; left time: 110.4292s
Epoch: 6 cost time: 8.11998701095581
Epoch: 6, Steps: 570 | Train Loss: 0.0702705 Vali Loss: 0.0333649 Test Loss: 0.1425450
Validation loss decreased (0.033861 --> 0.033365).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0654657
	speed: 0.0461s/iter; left time: 363.4200s
	iters: 200, epoch: 7 | loss: 0.0705935
	speed: 0.0138s/iter; left time: 107.2216s
	iters: 300, epoch: 7 | loss: 0.0509100
	speed: 0.0138s/iter; left time: 106.0751s
	iters: 400, epoch: 7 | loss: 0.0633409
	speed: 0.0137s/iter; left time: 104.1857s
	iters: 500, epoch: 7 | loss: 0.0975587
	speed: 0.0138s/iter; left time: 102.9758s
Epoch: 7 cost time: 8.155791282653809
Epoch: 7, Steps: 570 | Train Loss: 0.0681824 Vali Loss: 0.0336655 Test Loss: 0.1403572
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0956806
	speed: 0.0445s/iter; left time: 325.0548s
	iters: 200, epoch: 8 | loss: 0.0627450
	speed: 0.0137s/iter; left time: 98.9477s
	iters: 300, epoch: 8 | loss: 0.0663303
	speed: 0.0137s/iter; left time: 97.6096s
	iters: 400, epoch: 8 | loss: 0.0545766
	speed: 0.0137s/iter; left time: 96.2621s
	iters: 500, epoch: 8 | loss: 0.0640488
	speed: 0.0137s/iter; left time: 94.9963s
Epoch: 8 cost time: 8.114282608032227
Epoch: 8, Steps: 570 | Train Loss: 0.0669320 Vali Loss: 0.0336026 Test Loss: 0.1410938
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0882823
	speed: 0.0461s/iter; left time: 310.4282s
	iters: 200, epoch: 9 | loss: 0.0625098
	speed: 0.0147s/iter; left time: 97.5299s
	iters: 300, epoch: 9 | loss: 0.0696202
	speed: 0.0137s/iter; left time: 89.4622s
	iters: 400, epoch: 9 | loss: 0.0970610
	speed: 0.0137s/iter; left time: 88.1161s
	iters: 500, epoch: 9 | loss: 0.0535186
	speed: 0.0137s/iter; left time: 86.7883s
Epoch: 9 cost time: 8.346998691558838
Epoch: 9, Steps: 570 | Train Loss: 0.0663572 Vali Loss: 0.0335445 Test Loss: 0.1410328
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14278028905391693, mae:0.2392059564590454
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2086009
	speed: 0.0269s/iter; left time: 303.5026s
	iters: 200, epoch: 1 | loss: 0.1268833
	speed: 0.0151s/iter; left time: 169.4263s
	iters: 300, epoch: 1 | loss: 0.0825019
	speed: 0.0151s/iter; left time: 167.5031s
	iters: 400, epoch: 1 | loss: 0.1786777
	speed: 0.0152s/iter; left time: 166.8682s
	iters: 500, epoch: 1 | loss: 0.1494922
	speed: 0.0151s/iter; left time: 165.0966s
Epoch: 1 cost time: 9.847372770309448
Epoch: 1, Steps: 570 | Train Loss: 0.1467718 Vali Loss: 0.0342594 Test Loss: 0.1109782
Validation loss decreased (inf --> 0.034259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0795360
	speed: 0.0459s/iter; left time: 492.4158s
	iters: 200, epoch: 2 | loss: 0.1822288
	speed: 0.0135s/iter; left time: 142.9983s
	iters: 300, epoch: 2 | loss: 0.1266771
	speed: 0.0135s/iter; left time: 142.1528s
	iters: 400, epoch: 2 | loss: 0.0741273
	speed: 0.0135s/iter; left time: 140.4425s
	iters: 500, epoch: 2 | loss: 0.0941638
	speed: 0.0134s/iter; left time: 138.7434s
Epoch: 2 cost time: 7.985386848449707
Epoch: 2, Steps: 570 | Train Loss: 0.1086508 Vali Loss: 0.0347206 Test Loss: 0.1152831
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1089271
	speed: 0.0438s/iter; left time: 444.7230s
	iters: 200, epoch: 3 | loss: 0.0491227
	speed: 0.0135s/iter; left time: 135.5102s
	iters: 300, epoch: 3 | loss: 0.0805668
	speed: 0.0135s/iter; left time: 134.2271s
	iters: 400, epoch: 3 | loss: 0.0633435
	speed: 0.0135s/iter; left time: 132.7364s
	iters: 500, epoch: 3 | loss: 0.0806450
	speed: 0.0134s/iter; left time: 131.1357s
Epoch: 3 cost time: 7.9351561069488525
Epoch: 3, Steps: 570 | Train Loss: 0.0849287 Vali Loss: 0.0339566 Test Loss: 0.1128228
Validation loss decreased (0.034259 --> 0.033957).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0430873
	speed: 0.0442s/iter; left time: 423.7460s
	iters: 200, epoch: 4 | loss: 0.0846040
	speed: 0.0136s/iter; left time: 128.8513s
	iters: 300, epoch: 4 | loss: 0.0854110
	speed: 0.0136s/iter; left time: 127.6128s
	iters: 400, epoch: 4 | loss: 0.0510526
	speed: 0.0136s/iter; left time: 126.4209s
	iters: 500, epoch: 4 | loss: 0.0482591
	speed: 0.0136s/iter; left time: 125.0089s
Epoch: 4 cost time: 8.070059776306152
Epoch: 4, Steps: 570 | Train Loss: 0.0707148 Vali Loss: 0.0325064 Test Loss: 0.1138103
Validation loss decreased (0.033957 --> 0.032506).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0418888
	speed: 0.0455s/iter; left time: 410.6865s
	iters: 200, epoch: 5 | loss: 0.0535754
	speed: 0.0134s/iter; left time: 119.5364s
	iters: 300, epoch: 5 | loss: 0.0558173
	speed: 0.0134s/iter; left time: 118.6132s
	iters: 400, epoch: 5 | loss: 0.0423305
	speed: 0.0134s/iter; left time: 117.1849s
	iters: 500, epoch: 5 | loss: 0.0710006
	speed: 0.0134s/iter; left time: 115.5864s
Epoch: 5 cost time: 7.992184162139893
Epoch: 5, Steps: 570 | Train Loss: 0.0630975 Vali Loss: 0.0331896 Test Loss: 0.1157545
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0559983
	speed: 0.0440s/iter; left time: 371.9094s
	iters: 200, epoch: 6 | loss: 0.0775681
	speed: 0.0135s/iter; left time: 112.8285s
	iters: 300, epoch: 6 | loss: 0.0614349
	speed: 0.0135s/iter; left time: 111.4589s
	iters: 400, epoch: 6 | loss: 0.0877111
	speed: 0.0135s/iter; left time: 110.1107s
	iters: 500, epoch: 6 | loss: 0.0537601
	speed: 0.0135s/iter; left time: 108.6056s
Epoch: 6 cost time: 7.969736337661743
Epoch: 6, Steps: 570 | Train Loss: 0.0592694 Vali Loss: 0.0337582 Test Loss: 0.1174152
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0422037
	speed: 0.0468s/iter; left time: 368.8233s
	iters: 200, epoch: 7 | loss: 0.0650079
	speed: 0.0156s/iter; left time: 121.0199s
	iters: 300, epoch: 7 | loss: 0.0573400
	speed: 0.0155s/iter; left time: 119.3513s
	iters: 400, epoch: 7 | loss: 0.0773056
	speed: 0.0156s/iter; left time: 117.9019s
	iters: 500, epoch: 7 | loss: 0.0634231
	speed: 0.0155s/iter; left time: 116.2757s
Epoch: 7 cost time: 9.143394470214844
Epoch: 7, Steps: 570 | Train Loss: 0.0573789 Vali Loss: 0.0333042 Test Loss: 0.1173780
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1139611005783081, mae:0.2082395851612091
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1144149
	speed: 0.0254s/iter; left time: 287.1521s
	iters: 200, epoch: 1 | loss: 0.2406504
	speed: 0.0136s/iter; left time: 152.1221s
	iters: 300, epoch: 1 | loss: 0.2033081
	speed: 0.0136s/iter; left time: 150.4241s
	iters: 400, epoch: 1 | loss: 0.1833813
	speed: 0.0136s/iter; left time: 149.2219s
	iters: 500, epoch: 1 | loss: 0.2188929
	speed: 0.0136s/iter; left time: 147.9470s
Epoch: 1 cost time: 8.966982364654541
Epoch: 1, Steps: 570 | Train Loss: 0.1830724 Vali Loss: 0.0439534 Test Loss: 0.1360427
Validation loss decreased (inf --> 0.043953).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1161361
	speed: 0.0452s/iter; left time: 484.7631s
	iters: 200, epoch: 2 | loss: 0.1070751
	speed: 0.0135s/iter; left time: 143.6299s
	iters: 300, epoch: 2 | loss: 0.0788092
	speed: 0.0135s/iter; left time: 141.9702s
	iters: 400, epoch: 2 | loss: 0.1083257
	speed: 0.0135s/iter; left time: 140.5868s
	iters: 500, epoch: 2 | loss: 0.1613746
	speed: 0.0135s/iter; left time: 139.4492s
Epoch: 2 cost time: 8.012458562850952
Epoch: 2, Steps: 570 | Train Loss: 0.1330781 Vali Loss: 0.0425666 Test Loss: 0.1355622
Validation loss decreased (0.043953 --> 0.042567).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1262835
	speed: 0.0476s/iter; left time: 484.0278s
	iters: 200, epoch: 3 | loss: 0.1231543
	speed: 0.0135s/iter; left time: 135.8384s
	iters: 300, epoch: 3 | loss: 0.1130273
	speed: 0.0135s/iter; left time: 134.5116s
	iters: 400, epoch: 3 | loss: 0.0933835
	speed: 0.0135s/iter; left time: 133.1970s
	iters: 500, epoch: 3 | loss: 0.0828833
	speed: 0.0135s/iter; left time: 131.4686s
Epoch: 3 cost time: 7.970752000808716
Epoch: 3, Steps: 570 | Train Loss: 0.1018775 Vali Loss: 0.0402669 Test Loss: 0.1315529
Validation loss decreased (0.042567 --> 0.040267).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0914271
	speed: 0.0450s/iter; left time: 431.4423s
	iters: 200, epoch: 4 | loss: 0.0881497
	speed: 0.0135s/iter; left time: 128.3817s
	iters: 300, epoch: 4 | loss: 0.1122045
	speed: 0.0135s/iter; left time: 126.7946s
	iters: 400, epoch: 4 | loss: 0.0924591
	speed: 0.0135s/iter; left time: 125.3890s
	iters: 500, epoch: 4 | loss: 0.0600994
	speed: 0.0135s/iter; left time: 124.1717s
Epoch: 4 cost time: 8.00985050201416
Epoch: 4, Steps: 570 | Train Loss: 0.0849475 Vali Loss: 0.0398159 Test Loss: 0.1358591
Validation loss decreased (0.040267 --> 0.039816).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0953159
	speed: 0.0458s/iter; left time: 413.2375s
	iters: 200, epoch: 5 | loss: 0.0844836
	speed: 0.0135s/iter; left time: 120.8500s
	iters: 300, epoch: 5 | loss: 0.0806522
	speed: 0.0136s/iter; left time: 119.6739s
	iters: 400, epoch: 5 | loss: 0.1095421
	speed: 0.0136s/iter; left time: 118.3585s
	iters: 500, epoch: 5 | loss: 0.0639920
	speed: 0.0136s/iter; left time: 117.0391s
Epoch: 5 cost time: 8.033741235733032
Epoch: 5, Steps: 570 | Train Loss: 0.0758155 Vali Loss: 0.0397634 Test Loss: 0.1374840
Validation loss decreased (0.039816 --> 0.039763).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0751844
	speed: 0.0450s/iter; left time: 380.2091s
	iters: 200, epoch: 6 | loss: 0.0710672
	speed: 0.0136s/iter; left time: 113.1653s
	iters: 300, epoch: 6 | loss: 0.0579034
	speed: 0.0136s/iter; left time: 111.8779s
	iters: 400, epoch: 6 | loss: 0.1137909
	speed: 0.0135s/iter; left time: 110.4330s
	iters: 500, epoch: 6 | loss: 0.0788763
	speed: 0.0135s/iter; left time: 109.0721s
Epoch: 6 cost time: 8.00044870376587
Epoch: 6, Steps: 570 | Train Loss: 0.0710732 Vali Loss: 0.0392962 Test Loss: 0.1376793
Validation loss decreased (0.039763 --> 0.039296).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0663552
	speed: 0.0468s/iter; left time: 368.6887s
	iters: 200, epoch: 7 | loss: 0.0596826
	speed: 0.0136s/iter; left time: 106.1222s
	iters: 300, epoch: 7 | loss: 0.0695392
	speed: 0.0137s/iter; left time: 104.8674s
	iters: 400, epoch: 7 | loss: 0.0918856
	speed: 0.0136s/iter; left time: 103.3925s
	iters: 500, epoch: 7 | loss: 0.0480557
	speed: 0.0136s/iter; left time: 101.8550s
Epoch: 7 cost time: 8.188356399536133
Epoch: 7, Steps: 570 | Train Loss: 0.0685185 Vali Loss: 0.0394485 Test Loss: 0.1380076
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0535319
	speed: 0.0444s/iter; left time: 324.9272s
	iters: 200, epoch: 8 | loss: 0.0492976
	speed: 0.0136s/iter; left time: 98.0654s
	iters: 300, epoch: 8 | loss: 0.0699289
	speed: 0.0136s/iter; left time: 96.7324s
	iters: 400, epoch: 8 | loss: 0.0725985
	speed: 0.0136s/iter; left time: 95.3926s
	iters: 500, epoch: 8 | loss: 0.0543380
	speed: 0.0136s/iter; left time: 93.8839s
Epoch: 8 cost time: 8.032116651535034
Epoch: 8, Steps: 570 | Train Loss: 0.0673541 Vali Loss: 0.0400491 Test Loss: 0.1392234
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0756388
	speed: 0.0462s/iter; left time: 311.7130s
	iters: 200, epoch: 9 | loss: 0.0615586
	speed: 0.0135s/iter; left time: 89.4975s
	iters: 300, epoch: 9 | loss: 0.0448848
	speed: 0.0135s/iter; left time: 88.1384s
	iters: 400, epoch: 9 | loss: 0.0649287
	speed: 0.0135s/iter; left time: 86.7789s
	iters: 500, epoch: 9 | loss: 0.0648801
	speed: 0.0135s/iter; left time: 85.3952s
Epoch: 9 cost time: 7.943592309951782
Epoch: 9, Steps: 570 | Train Loss: 0.0667382 Vali Loss: 0.0394727 Test Loss: 0.1387659
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13790731132030487, mae:0.24107909202575684
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2078299
	speed: 0.0299s/iter; left time: 337.6181s
	iters: 200, epoch: 1 | loss: 0.1424055
	speed: 0.0168s/iter; left time: 188.5422s
	iters: 300, epoch: 1 | loss: 0.1897625
	speed: 0.0163s/iter; left time: 181.0576s
	iters: 400, epoch: 1 | loss: 0.1409163
	speed: 0.0163s/iter; left time: 179.6436s
	iters: 500, epoch: 1 | loss: 0.1303341
	speed: 0.0163s/iter; left time: 178.1641s
Epoch: 1 cost time: 10.756354570388794
Epoch: 1, Steps: 570 | Train Loss: 0.1713149 Vali Loss: 0.0450306 Test Loss: 0.1379519
Validation loss decreased (inf --> 0.045031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1361812
	speed: 0.0518s/iter; left time: 556.0741s
	iters: 200, epoch: 2 | loss: 0.1315437
	speed: 0.0174s/iter; left time: 184.7382s
	iters: 300, epoch: 2 | loss: 0.1162446
	speed: 0.0163s/iter; left time: 171.7494s
	iters: 400, epoch: 2 | loss: 0.0781730
	speed: 0.0163s/iter; left time: 170.1253s
	iters: 500, epoch: 2 | loss: 0.0761840
	speed: 0.0163s/iter; left time: 168.1779s
Epoch: 2 cost time: 9.858685731887817
Epoch: 2, Steps: 570 | Train Loss: 0.1173301 Vali Loss: 0.0351438 Test Loss: 0.1238170
Validation loss decreased (0.045031 --> 0.035144).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0778482
	speed: 0.0500s/iter; left time: 507.8258s
	iters: 200, epoch: 3 | loss: 0.0825490
	speed: 0.0163s/iter; left time: 164.4866s
	iters: 300, epoch: 3 | loss: 0.1426406
	speed: 0.0164s/iter; left time: 162.9999s
	iters: 400, epoch: 3 | loss: 0.0660927
	speed: 0.0163s/iter; left time: 161.1585s
	iters: 500, epoch: 3 | loss: 0.0541380
	speed: 0.0163s/iter; left time: 159.5571s
Epoch: 3 cost time: 9.611938953399658
Epoch: 3, Steps: 570 | Train Loss: 0.0766610 Vali Loss: 0.0350214 Test Loss: 0.1284641
Validation loss decreased (0.035144 --> 0.035021).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0515998
	speed: 0.0502s/iter; left time: 481.3074s
	iters: 200, epoch: 4 | loss: 0.0599067
	speed: 0.0163s/iter; left time: 154.6950s
	iters: 300, epoch: 4 | loss: 0.0413344
	speed: 0.0163s/iter; left time: 153.1628s
	iters: 400, epoch: 4 | loss: 0.0718858
	speed: 0.0163s/iter; left time: 151.0935s
	iters: 500, epoch: 4 | loss: 0.0584151
	speed: 0.0163s/iter; left time: 149.5000s
Epoch: 4 cost time: 9.617743015289307
Epoch: 4, Steps: 570 | Train Loss: 0.0558121 Vali Loss: 0.0368052 Test Loss: 0.1358294
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0419310
	speed: 0.0500s/iter; left time: 450.7432s
	iters: 200, epoch: 5 | loss: 0.0496591
	speed: 0.0163s/iter; left time: 145.6540s
	iters: 300, epoch: 5 | loss: 0.0489003
	speed: 0.0170s/iter; left time: 149.9195s
	iters: 400, epoch: 5 | loss: 0.0590560
	speed: 0.0170s/iter; left time: 148.3170s
	iters: 500, epoch: 5 | loss: 0.0397884
	speed: 0.0164s/iter; left time: 141.5396s
Epoch: 5 cost time: 9.779428243637085
Epoch: 5, Steps: 570 | Train Loss: 0.0466488 Vali Loss: 0.0354055 Test Loss: 0.1407815
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0395191
	speed: 0.0492s/iter; left time: 415.7760s
	iters: 200, epoch: 6 | loss: 0.0326661
	speed: 0.0163s/iter; left time: 135.7793s
	iters: 300, epoch: 6 | loss: 0.0438034
	speed: 0.0163s/iter; left time: 134.0866s
	iters: 400, epoch: 6 | loss: 0.0483762
	speed: 0.0163s/iter; left time: 132.4723s
	iters: 500, epoch: 6 | loss: 0.0372350
	speed: 0.0163s/iter; left time: 130.8755s
Epoch: 6 cost time: 9.553225040435791
Epoch: 6, Steps: 570 | Train Loss: 0.0420321 Vali Loss: 0.0355620 Test Loss: 0.1407559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12866666913032532, mae:0.23136582970619202
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1477773
	speed: 0.0276s/iter; left time: 311.4221s
	iters: 200, epoch: 1 | loss: 0.0753202
	speed: 0.0158s/iter; left time: 176.6321s
	iters: 300, epoch: 1 | loss: 0.1597915
	speed: 0.0158s/iter; left time: 175.0127s
	iters: 400, epoch: 1 | loss: 0.1282118
	speed: 0.0158s/iter; left time: 173.3450s
	iters: 500, epoch: 1 | loss: 0.0819353
	speed: 0.0158s/iter; left time: 171.9961s
Epoch: 1 cost time: 10.220461368560791
Epoch: 1, Steps: 570 | Train Loss: 0.1416919 Vali Loss: 0.0340319 Test Loss: 0.1118738
Validation loss decreased (inf --> 0.034032).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1035396
	speed: 0.0499s/iter; left time: 535.5446s
	iters: 200, epoch: 2 | loss: 0.0897047
	speed: 0.0158s/iter; left time: 168.1354s
	iters: 300, epoch: 2 | loss: 0.1571794
	speed: 0.0158s/iter; left time: 166.9000s
	iters: 400, epoch: 2 | loss: 0.0875617
	speed: 0.0158s/iter; left time: 164.9477s
	iters: 500, epoch: 2 | loss: 0.0733796
	speed: 0.0158s/iter; left time: 163.6464s
Epoch: 2 cost time: 9.347056865692139
Epoch: 2, Steps: 570 | Train Loss: 0.0999425 Vali Loss: 0.0362646 Test Loss: 0.1160469
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0676384
	speed: 0.0492s/iter; left time: 499.4163s
	iters: 200, epoch: 3 | loss: 0.0603915
	speed: 0.0170s/iter; left time: 171.2039s
	iters: 300, epoch: 3 | loss: 0.0641372
	speed: 0.0158s/iter; left time: 157.8411s
	iters: 400, epoch: 3 | loss: 0.0787638
	speed: 0.0159s/iter; left time: 156.3721s
	iters: 500, epoch: 3 | loss: 0.0494916
	speed: 0.0158s/iter; left time: 154.6424s
Epoch: 3 cost time: 9.570987462997437
Epoch: 3, Steps: 570 | Train Loss: 0.0663488 Vali Loss: 0.0348005 Test Loss: 0.1191276
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0568060
	speed: 0.0492s/iter; left time: 471.6696s
	iters: 200, epoch: 4 | loss: 0.0655669
	speed: 0.0158s/iter; left time: 150.0566s
	iters: 300, epoch: 4 | loss: 0.0402272
	speed: 0.0157s/iter; left time: 147.8605s
	iters: 400, epoch: 4 | loss: 0.0446116
	speed: 0.0157s/iter; left time: 146.0819s
	iters: 500, epoch: 4 | loss: 0.0549300
	speed: 0.0157s/iter; left time: 144.4756s
Epoch: 4 cost time: 9.302895545959473
Epoch: 4, Steps: 570 | Train Loss: 0.0491865 Vali Loss: 0.0349448 Test Loss: 0.1214562
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11205563694238663, mae:0.20530520379543304
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1708764
	speed: 0.0264s/iter; left time: 298.8679s
	iters: 200, epoch: 1 | loss: 0.1193258
	speed: 0.0147s/iter; left time: 164.2314s
	iters: 300, epoch: 1 | loss: 0.1656508
	speed: 0.0147s/iter; left time: 162.8241s
	iters: 400, epoch: 1 | loss: 0.1511722
	speed: 0.0147s/iter; left time: 161.7395s
	iters: 500, epoch: 1 | loss: 0.2388563
	speed: 0.0147s/iter; left time: 160.0216s
Epoch: 1 cost time: 9.596433639526367
Epoch: 1, Steps: 570 | Train Loss: 0.1793625 Vali Loss: 0.0441069 Test Loss: 0.1392629
Validation loss decreased (inf --> 0.044107).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1864589
	speed: 0.0477s/iter; left time: 511.6191s
	iters: 200, epoch: 2 | loss: 0.0733957
	speed: 0.0148s/iter; left time: 156.9551s
	iters: 300, epoch: 2 | loss: 0.1169123
	speed: 0.0148s/iter; left time: 155.5349s
	iters: 400, epoch: 2 | loss: 0.1325214
	speed: 0.0148s/iter; left time: 153.8665s
	iters: 500, epoch: 2 | loss: 0.1146732
	speed: 0.0147s/iter; left time: 152.3125s
Epoch: 2 cost time: 8.725805282592773
Epoch: 2, Steps: 570 | Train Loss: 0.1177451 Vali Loss: 0.0400731 Test Loss: 0.1421569
Validation loss decreased (0.044107 --> 0.040073).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0823320
	speed: 0.0475s/iter; left time: 482.9730s
	iters: 200, epoch: 3 | loss: 0.0564177
	speed: 0.0147s/iter; left time: 147.9563s
	iters: 300, epoch: 3 | loss: 0.0987329
	speed: 0.0147s/iter; left time: 146.4744s
	iters: 400, epoch: 3 | loss: 0.0602564
	speed: 0.0147s/iter; left time: 145.0209s
	iters: 500, epoch: 3 | loss: 0.0829141
	speed: 0.0147s/iter; left time: 143.5454s
Epoch: 3 cost time: 8.67487096786499
Epoch: 3, Steps: 570 | Train Loss: 0.0726184 Vali Loss: 0.0375189 Test Loss: 0.1363660
Validation loss decreased (0.040073 --> 0.037519).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0425757
	speed: 0.0480s/iter; left time: 460.4176s
	iters: 200, epoch: 4 | loss: 0.0856920
	speed: 0.0147s/iter; left time: 139.9568s
	iters: 300, epoch: 4 | loss: 0.0566378
	speed: 0.0147s/iter; left time: 137.8108s
	iters: 400, epoch: 4 | loss: 0.0437738
	speed: 0.0147s/iter; left time: 136.5454s
	iters: 500, epoch: 4 | loss: 0.0620285
	speed: 0.0147s/iter; left time: 135.0241s
Epoch: 4 cost time: 8.667943239212036
Epoch: 4, Steps: 570 | Train Loss: 0.0526851 Vali Loss: 0.0370105 Test Loss: 0.1403879
Validation loss decreased (0.037519 --> 0.037011).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0406114
	speed: 0.0468s/iter; left time: 422.1289s
	iters: 200, epoch: 5 | loss: 0.0422068
	speed: 0.0147s/iter; left time: 131.4009s
	iters: 300, epoch: 5 | loss: 0.0453009
	speed: 0.0147s/iter; left time: 129.7250s
	iters: 400, epoch: 5 | loss: 0.0435832
	speed: 0.0147s/iter; left time: 128.2108s
	iters: 500, epoch: 5 | loss: 0.0368674
	speed: 0.0147s/iter; left time: 126.8584s
Epoch: 5 cost time: 8.666273832321167
Epoch: 5, Steps: 570 | Train Loss: 0.0436435 Vali Loss: 0.0378411 Test Loss: 0.1423287
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0305940
	speed: 0.0478s/iter; left time: 403.7260s
	iters: 200, epoch: 6 | loss: 0.0309110
	speed: 0.0146s/iter; left time: 122.2153s
	iters: 300, epoch: 6 | loss: 0.0290665
	speed: 0.0146s/iter; left time: 120.7654s
	iters: 400, epoch: 6 | loss: 0.0337679
	speed: 0.0146s/iter; left time: 119.1185s
	iters: 500, epoch: 6 | loss: 0.0298539
	speed: 0.0146s/iter; left time: 117.6469s
Epoch: 6 cost time: 8.618802309036255
Epoch: 6, Steps: 570 | Train Loss: 0.0393141 Vali Loss: 0.0380284 Test Loss: 0.1433180
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0388735
	speed: 0.0459s/iter; left time: 361.8422s
	iters: 200, epoch: 7 | loss: 0.0317292
	speed: 0.0146s/iter; left time: 113.8060s
	iters: 300, epoch: 7 | loss: 0.0503877
	speed: 0.0146s/iter; left time: 112.3527s
	iters: 400, epoch: 7 | loss: 0.0319478
	speed: 0.0146s/iter; left time: 110.7869s
	iters: 500, epoch: 7 | loss: 0.0518978
	speed: 0.0146s/iter; left time: 109.3582s
Epoch: 7 cost time: 8.615338563919067
Epoch: 7, Steps: 570 | Train Loss: 0.0371862 Vali Loss: 0.0383767 Test Loss: 0.1444984
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14058546721935272, mae:0.2441914826631546
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1207708
	speed: 0.0315s/iter; left time: 355.8846s
	iters: 200, epoch: 1 | loss: 0.1658366
	speed: 0.0182s/iter; left time: 203.6576s
	iters: 300, epoch: 1 | loss: 0.2600677
	speed: 0.0176s/iter; left time: 194.8982s
	iters: 400, epoch: 1 | loss: 0.1324711
	speed: 0.0176s/iter; left time: 193.6093s
	iters: 500, epoch: 1 | loss: 0.1258223
	speed: 0.0176s/iter; left time: 192.1152s
Epoch: 1 cost time: 11.536066055297852
Epoch: 1, Steps: 570 | Train Loss: 0.1767459 Vali Loss: 0.0456234 Test Loss: 0.1338982
Validation loss decreased (inf --> 0.045623).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1645802
	speed: 0.0552s/iter; left time: 592.4459s
	iters: 200, epoch: 2 | loss: 0.1161484
	speed: 0.0176s/iter; left time: 187.2089s
	iters: 300, epoch: 2 | loss: 0.1286412
	speed: 0.0176s/iter; left time: 185.1962s
	iters: 400, epoch: 2 | loss: 0.1164942
	speed: 0.0176s/iter; left time: 183.8046s
	iters: 500, epoch: 2 | loss: 0.1442048
	speed: 0.0176s/iter; left time: 181.4330s
Epoch: 2 cost time: 10.399192571640015
Epoch: 2, Steps: 570 | Train Loss: 0.1249090 Vali Loss: 0.0433283 Test Loss: 0.1317271
Validation loss decreased (0.045623 --> 0.043328).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0977896
	speed: 0.0577s/iter; left time: 586.5457s
	iters: 200, epoch: 3 | loss: 0.0681730
	speed: 0.0201s/iter; left time: 202.3260s
	iters: 300, epoch: 3 | loss: 0.0849765
	speed: 0.0201s/iter; left time: 200.1293s
	iters: 400, epoch: 3 | loss: 0.0804550
	speed: 0.0201s/iter; left time: 198.6785s
	iters: 500, epoch: 3 | loss: 0.0725421
	speed: 0.0201s/iter; left time: 196.4736s
Epoch: 3 cost time: 11.788912534713745
Epoch: 3, Steps: 570 | Train Loss: 0.0941606 Vali Loss: 0.0353566 Test Loss: 0.1254870
Validation loss decreased (0.043328 --> 0.035357).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0793846
	speed: 0.0606s/iter; left time: 581.3496s
	iters: 200, epoch: 4 | loss: 0.0919872
	speed: 0.0202s/iter; left time: 192.1408s
	iters: 300, epoch: 4 | loss: 0.0671227
	speed: 0.0203s/iter; left time: 190.2016s
	iters: 400, epoch: 4 | loss: 0.0602730
	speed: 0.0203s/iter; left time: 188.3894s
	iters: 500, epoch: 4 | loss: 0.0878569
	speed: 0.0202s/iter; left time: 186.0652s
Epoch: 4 cost time: 11.852471828460693
Epoch: 4, Steps: 570 | Train Loss: 0.0772238 Vali Loss: 0.0342536 Test Loss: 0.1399447
Validation loss decreased (0.035357 --> 0.034254).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0656800
	speed: 0.0590s/iter; left time: 532.5329s
	iters: 200, epoch: 5 | loss: 0.0561583
	speed: 0.0201s/iter; left time: 179.5940s
	iters: 300, epoch: 5 | loss: 0.0804801
	speed: 0.0201s/iter; left time: 177.5356s
	iters: 400, epoch: 5 | loss: 0.0545313
	speed: 0.0201s/iter; left time: 175.3201s
	iters: 500, epoch: 5 | loss: 0.0810072
	speed: 0.0201s/iter; left time: 173.3436s
Epoch: 5 cost time: 11.775858163833618
Epoch: 5, Steps: 570 | Train Loss: 0.0680126 Vali Loss: 0.0335107 Test Loss: 0.1322938
Validation loss decreased (0.034254 --> 0.033511).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0404243
	speed: 0.0590s/iter; left time: 498.4312s
	iters: 200, epoch: 6 | loss: 0.0678751
	speed: 0.0202s/iter; left time: 168.6742s
	iters: 300, epoch: 6 | loss: 0.0676996
	speed: 0.0202s/iter; left time: 166.6787s
	iters: 400, epoch: 6 | loss: 0.0885342
	speed: 0.0202s/iter; left time: 164.5565s
	iters: 500, epoch: 6 | loss: 0.0566523
	speed: 0.0202s/iter; left time: 162.5612s
Epoch: 6 cost time: 11.806547403335571
Epoch: 6, Steps: 570 | Train Loss: 0.0635844 Vali Loss: 0.0332794 Test Loss: 0.1336828
Validation loss decreased (0.033511 --> 0.033279).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0589511
	speed: 0.0572s/iter; left time: 450.6698s
	iters: 200, epoch: 7 | loss: 0.0571943
	speed: 0.0174s/iter; left time: 135.0704s
	iters: 300, epoch: 7 | loss: 0.0717927
	speed: 0.0173s/iter; left time: 133.2322s
	iters: 400, epoch: 7 | loss: 0.0719622
	speed: 0.0173s/iter; left time: 131.4966s
	iters: 500, epoch: 7 | loss: 0.0520488
	speed: 0.0174s/iter; left time: 129.9712s
Epoch: 7 cost time: 10.21242356300354
Epoch: 7, Steps: 570 | Train Loss: 0.0611406 Vali Loss: 0.0330539 Test Loss: 0.1343281
Validation loss decreased (0.033279 --> 0.033054).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0647300
	speed: 0.0563s/iter; left time: 411.9439s
	iters: 200, epoch: 8 | loss: 0.0595467
	speed: 0.0175s/iter; left time: 125.9396s
	iters: 300, epoch: 8 | loss: 0.0460011
	speed: 0.0175s/iter; left time: 124.1192s
	iters: 400, epoch: 8 | loss: 0.0597768
	speed: 0.0174s/iter; left time: 122.3091s
	iters: 500, epoch: 8 | loss: 0.0478682
	speed: 0.0174s/iter; left time: 120.5109s
Epoch: 8 cost time: 10.27616572380066
Epoch: 8, Steps: 570 | Train Loss: 0.0599008 Vali Loss: 0.0333627 Test Loss: 0.1343927
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0450619
	speed: 0.0538s/iter; left time: 362.3760s
	iters: 200, epoch: 9 | loss: 0.0991942
	speed: 0.0174s/iter; left time: 115.3352s
	iters: 300, epoch: 9 | loss: 0.0457475
	speed: 0.0174s/iter; left time: 113.5359s
	iters: 400, epoch: 9 | loss: 0.0412745
	speed: 0.0174s/iter; left time: 111.8607s
	iters: 500, epoch: 9 | loss: 0.0411304
	speed: 0.0174s/iter; left time: 110.1161s
Epoch: 9 cost time: 10.205106258392334
Epoch: 9, Steps: 570 | Train Loss: 0.0593183 Vali Loss: 0.0332272 Test Loss: 0.1348051
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0575047
	speed: 0.0546s/iter; left time: 336.9763s
	iters: 200, epoch: 10 | loss: 0.0695797
	speed: 0.0174s/iter; left time: 105.8516s
	iters: 300, epoch: 10 | loss: 0.0439022
	speed: 0.0174s/iter; left time: 103.8646s
	iters: 400, epoch: 10 | loss: 0.0652481
	speed: 0.0174s/iter; left time: 102.1745s
	iters: 500, epoch: 10 | loss: 0.0322872
	speed: 0.0174s/iter; left time: 100.3637s
Epoch: 10 cost time: 10.224437713623047
Epoch: 10, Steps: 570 | Train Loss: 0.0589843 Vali Loss: 0.0331905 Test Loss: 0.1361058
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13452480733394623, mae:0.23368285596370697
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.3226862
	speed: 0.0287s/iter; left time: 324.8456s
	iters: 200, epoch: 1 | loss: 0.1668440
	speed: 0.0171s/iter; left time: 192.0673s
	iters: 300, epoch: 1 | loss: 0.1776613
	speed: 0.0171s/iter; left time: 190.2011s
	iters: 400, epoch: 1 | loss: 0.1115717
	speed: 0.0172s/iter; left time: 188.6897s
	iters: 500, epoch: 1 | loss: 0.1671815
	speed: 0.0171s/iter; left time: 186.8331s
Epoch: 1 cost time: 10.990800857543945
Epoch: 1, Steps: 570 | Train Loss: 0.1464359 Vali Loss: 0.0346369 Test Loss: 0.1122974
Validation loss decreased (inf --> 0.034637).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0989168
	speed: 0.0539s/iter; left time: 578.7761s
	iters: 200, epoch: 2 | loss: 0.1485835
	speed: 0.0171s/iter; left time: 182.0885s
	iters: 300, epoch: 2 | loss: 0.1692001
	speed: 0.0172s/iter; left time: 180.9079s
	iters: 400, epoch: 2 | loss: 0.0990008
	speed: 0.0171s/iter; left time: 178.6821s
	iters: 500, epoch: 2 | loss: 0.0971779
	speed: 0.0171s/iter; left time: 177.0269s
Epoch: 2 cost time: 10.109720230102539
Epoch: 2, Steps: 570 | Train Loss: 0.1085422 Vali Loss: 0.0356164 Test Loss: 0.1155539
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0768530
	speed: 0.0557s/iter; left time: 565.9163s
	iters: 200, epoch: 3 | loss: 0.0811924
	speed: 0.0172s/iter; left time: 172.8669s
	iters: 300, epoch: 3 | loss: 0.0978360
	speed: 0.0172s/iter; left time: 171.1942s
	iters: 400, epoch: 3 | loss: 0.0615743
	speed: 0.0172s/iter; left time: 169.1427s
	iters: 500, epoch: 3 | loss: 0.0687462
	speed: 0.0172s/iter; left time: 167.5609s
Epoch: 3 cost time: 10.098459482192993
Epoch: 3, Steps: 570 | Train Loss: 0.0823146 Vali Loss: 0.0338312 Test Loss: 0.1130264
Validation loss decreased (0.034637 --> 0.033831).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0664183
	speed: 0.0534s/iter; left time: 512.3058s
	iters: 200, epoch: 4 | loss: 0.0526979
	speed: 0.0172s/iter; left time: 162.8415s
	iters: 300, epoch: 4 | loss: 0.0824772
	speed: 0.0172s/iter; left time: 161.2442s
	iters: 400, epoch: 4 | loss: 0.0836798
	speed: 0.0171s/iter; left time: 159.1569s
	iters: 500, epoch: 4 | loss: 0.0645510
	speed: 0.0171s/iter; left time: 157.3931s
Epoch: 4 cost time: 10.071844339370728
Epoch: 4, Steps: 570 | Train Loss: 0.0654951 Vali Loss: 0.0329143 Test Loss: 0.1138199
Validation loss decreased (0.033831 --> 0.032914).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0522060
	speed: 0.0557s/iter; left time: 502.2308s
	iters: 200, epoch: 5 | loss: 0.0592664
	speed: 0.0192s/iter; left time: 171.3831s
	iters: 300, epoch: 5 | loss: 0.0512895
	speed: 0.0192s/iter; left time: 169.4563s
	iters: 400, epoch: 5 | loss: 0.0640452
	speed: 0.0192s/iter; left time: 167.5009s
	iters: 500, epoch: 5 | loss: 0.0600721
	speed: 0.0192s/iter; left time: 165.4613s
Epoch: 5 cost time: 11.255624771118164
Epoch: 5, Steps: 570 | Train Loss: 0.0567611 Vali Loss: 0.0334743 Test Loss: 0.1158179
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0593614
	speed: 0.0554s/iter; left time: 468.4867s
	iters: 200, epoch: 6 | loss: 0.0394505
	speed: 0.0173s/iter; left time: 144.2485s
	iters: 300, epoch: 6 | loss: 0.0592579
	speed: 0.0173s/iter; left time: 142.4552s
	iters: 400, epoch: 6 | loss: 0.0466528
	speed: 0.0173s/iter; left time: 140.7197s
	iters: 500, epoch: 6 | loss: 0.0352588
	speed: 0.0172s/iter; left time: 138.6235s
Epoch: 6 cost time: 10.150465250015259
Epoch: 6, Steps: 570 | Train Loss: 0.0526633 Vali Loss: 0.0331158 Test Loss: 0.1148413
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0470458
	speed: 0.0565s/iter; left time: 445.5645s
	iters: 200, epoch: 7 | loss: 0.0658160
	speed: 0.0192s/iter; left time: 149.4241s
	iters: 300, epoch: 7 | loss: 0.0436879
	speed: 0.0181s/iter; left time: 139.2962s
	iters: 400, epoch: 7 | loss: 0.0596417
	speed: 0.0172s/iter; left time: 130.7616s
	iters: 500, epoch: 7 | loss: 0.0392330
	speed: 0.0173s/iter; left time: 129.0794s
Epoch: 7 cost time: 10.635610342025757
Epoch: 7, Steps: 570 | Train Loss: 0.0504884 Vali Loss: 0.0333423 Test Loss: 0.1157486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11395978182554245, mae:0.20874567329883575
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2526689
	speed: 0.0313s/iter; left time: 353.7906s
	iters: 200, epoch: 1 | loss: 0.1506011
	speed: 0.0194s/iter; left time: 217.1471s
	iters: 300, epoch: 1 | loss: 0.1895043
	speed: 0.0194s/iter; left time: 215.6675s
	iters: 400, epoch: 1 | loss: 0.1955848
	speed: 0.0194s/iter; left time: 213.8754s
	iters: 500, epoch: 1 | loss: 0.2660136
	speed: 0.0194s/iter; left time: 211.2190s
Epoch: 1 cost time: 12.301667928695679
Epoch: 1, Steps: 570 | Train Loss: 0.1832555 Vali Loss: 0.0414752 Test Loss: 0.1353214
Validation loss decreased (inf --> 0.041475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1894857
	speed: 0.0588s/iter; left time: 630.7406s
	iters: 200, epoch: 2 | loss: 0.2140321
	speed: 0.0173s/iter; left time: 183.6757s
	iters: 300, epoch: 2 | loss: 0.2231693
	speed: 0.0173s/iter; left time: 181.8062s
	iters: 400, epoch: 2 | loss: 0.1023709
	speed: 0.0173s/iter; left time: 180.4059s
	iters: 500, epoch: 2 | loss: 0.0706140
	speed: 0.0173s/iter; left time: 178.5975s
Epoch: 2 cost time: 10.270910739898682
Epoch: 2, Steps: 570 | Train Loss: 0.1284721 Vali Loss: 0.0430929 Test Loss: 0.1399398
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1038830
	speed: 0.0549s/iter; left time: 557.7296s
	iters: 200, epoch: 3 | loss: 0.1072234
	speed: 0.0194s/iter; left time: 195.5055s
	iters: 300, epoch: 3 | loss: 0.0985372
	speed: 0.0200s/iter; left time: 199.4483s
	iters: 400, epoch: 3 | loss: 0.0693403
	speed: 0.0200s/iter; left time: 197.6306s
	iters: 500, epoch: 3 | loss: 0.0678159
	speed: 0.0189s/iter; left time: 184.8847s
Epoch: 3 cost time: 11.058108568191528
Epoch: 3, Steps: 570 | Train Loss: 0.0921640 Vali Loss: 0.0411940 Test Loss: 0.1413373
Validation loss decreased (0.041475 --> 0.041194).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0639332
	speed: 0.0569s/iter; left time: 546.0422s
	iters: 200, epoch: 4 | loss: 0.0903152
	speed: 0.0194s/iter; left time: 184.2020s
	iters: 300, epoch: 4 | loss: 0.0720685
	speed: 0.0194s/iter; left time: 182.2950s
	iters: 400, epoch: 4 | loss: 0.0802401
	speed: 0.0194s/iter; left time: 180.3670s
	iters: 500, epoch: 4 | loss: 0.0611074
	speed: 0.0194s/iter; left time: 178.4050s
Epoch: 4 cost time: 11.358631610870361
Epoch: 4, Steps: 570 | Train Loss: 0.0717763 Vali Loss: 0.0385932 Test Loss: 0.1380353
Validation loss decreased (0.041194 --> 0.038593).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0552789
	speed: 0.0565s/iter; left time: 509.8717s
	iters: 200, epoch: 5 | loss: 0.0573784
	speed: 0.0173s/iter; left time: 154.7055s
	iters: 300, epoch: 5 | loss: 0.0559159
	speed: 0.0173s/iter; left time: 152.7007s
	iters: 400, epoch: 5 | loss: 0.0563369
	speed: 0.0173s/iter; left time: 150.8240s
	iters: 500, epoch: 5 | loss: 0.0454566
	speed: 0.0173s/iter; left time: 149.2895s
Epoch: 5 cost time: 10.19694209098816
Epoch: 5, Steps: 570 | Train Loss: 0.0615526 Vali Loss: 0.0402327 Test Loss: 0.1463692
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0563857
	speed: 0.0565s/iter; left time: 477.2357s
	iters: 200, epoch: 6 | loss: 0.0544896
	speed: 0.0193s/iter; left time: 161.3685s
	iters: 300, epoch: 6 | loss: 0.0795186
	speed: 0.0192s/iter; left time: 158.6411s
	iters: 400, epoch: 6 | loss: 0.0644698
	speed: 0.0192s/iter; left time: 156.3005s
	iters: 500, epoch: 6 | loss: 0.0572942
	speed: 0.0193s/iter; left time: 155.5157s
Epoch: 6 cost time: 11.306349515914917
Epoch: 6, Steps: 570 | Train Loss: 0.0564596 Vali Loss: 0.0390845 Test Loss: 0.1458327
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0485623
	speed: 0.0584s/iter; left time: 460.0897s
	iters: 200, epoch: 7 | loss: 0.0468063
	speed: 0.0201s/iter; left time: 156.0798s
	iters: 300, epoch: 7 | loss: 0.0684707
	speed: 0.0200s/iter; left time: 153.6194s
	iters: 400, epoch: 7 | loss: 0.0643950
	speed: 0.0200s/iter; left time: 151.7115s
	iters: 500, epoch: 7 | loss: 0.0415587
	speed: 0.0200s/iter; left time: 149.6281s
Epoch: 7 cost time: 11.60454797744751
Epoch: 7, Steps: 570 | Train Loss: 0.0539953 Vali Loss: 0.0394990 Test Loss: 0.1465579
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13822001218795776, mae:0.23914697766304016
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1888228
	speed: 0.0330s/iter; left time: 373.4069s
	iters: 200, epoch: 1 | loss: 0.1582943
	speed: 0.0213s/iter; left time: 238.1746s
	iters: 300, epoch: 1 | loss: 0.1563228
	speed: 0.0212s/iter; left time: 235.7607s
	iters: 400, epoch: 1 | loss: 0.2523674
	speed: 0.0212s/iter; left time: 233.7124s
	iters: 500, epoch: 1 | loss: 0.2365478
	speed: 0.0213s/iter; left time: 231.8212s
Epoch: 1 cost time: 13.352354049682617
Epoch: 1, Steps: 570 | Train Loss: 0.1755242 Vali Loss: 0.0442618 Test Loss: 0.1377467
Validation loss decreased (inf --> 0.044262).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1871693
	speed: 0.0634s/iter; left time: 680.4544s
	iters: 200, epoch: 2 | loss: 0.0924348
	speed: 0.0213s/iter; left time: 226.2418s
	iters: 300, epoch: 2 | loss: 0.1252180
	speed: 0.0213s/iter; left time: 224.0350s
	iters: 400, epoch: 2 | loss: 0.1210898
	speed: 0.0213s/iter; left time: 221.8571s
	iters: 500, epoch: 2 | loss: 0.0729622
	speed: 0.0213s/iter; left time: 219.7002s
Epoch: 2 cost time: 12.45240592956543
Epoch: 2, Steps: 570 | Train Loss: 0.1170748 Vali Loss: 0.0391907 Test Loss: 0.1344381
Validation loss decreased (0.044262 --> 0.039191).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0959562
	speed: 0.0627s/iter; left time: 636.9416s
	iters: 200, epoch: 3 | loss: 0.0675417
	speed: 0.0213s/iter; left time: 214.5693s
	iters: 300, epoch: 3 | loss: 0.0984169
	speed: 0.0213s/iter; left time: 212.6383s
	iters: 400, epoch: 3 | loss: 0.0519896
	speed: 0.0213s/iter; left time: 210.1327s
	iters: 500, epoch: 3 | loss: 0.0565442
	speed: 0.0213s/iter; left time: 208.0683s
Epoch: 3 cost time: 12.452890157699585
Epoch: 3, Steps: 570 | Train Loss: 0.0725646 Vali Loss: 0.0358213 Test Loss: 0.1385621
Validation loss decreased (0.039191 --> 0.035821).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0500028
	speed: 0.0638s/iter; left time: 612.3572s
	iters: 200, epoch: 4 | loss: 0.0390338
	speed: 0.0213s/iter; left time: 202.1930s
	iters: 300, epoch: 4 | loss: 0.0459121
	speed: 0.0214s/iter; left time: 201.2188s
	iters: 400, epoch: 4 | loss: 0.0498361
	speed: 0.0215s/iter; left time: 199.3294s
	iters: 500, epoch: 4 | loss: 0.0820427
	speed: 0.0214s/iter; left time: 197.1320s
Epoch: 4 cost time: 12.546135425567627
Epoch: 4, Steps: 570 | Train Loss: 0.0506902 Vali Loss: 0.0382494 Test Loss: 0.1395986
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0575483
	speed: 0.0605s/iter; left time: 545.7770s
	iters: 200, epoch: 5 | loss: 0.0359831
	speed: 0.0214s/iter; left time: 190.8560s
	iters: 300, epoch: 5 | loss: 0.0293592
	speed: 0.0214s/iter; left time: 188.8994s
	iters: 400, epoch: 5 | loss: 0.0327550
	speed: 0.0214s/iter; left time: 186.5905s
	iters: 500, epoch: 5 | loss: 0.0358799
	speed: 0.0214s/iter; left time: 184.4448s
Epoch: 5 cost time: 12.495253562927246
Epoch: 5, Steps: 570 | Train Loss: 0.0410975 Vali Loss: 0.0380475 Test Loss: 0.1372982
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0283897
	speed: 0.0632s/iter; left time: 534.4561s
	iters: 200, epoch: 6 | loss: 0.0320395
	speed: 0.0232s/iter; left time: 193.6637s
	iters: 300, epoch: 6 | loss: 0.0325276
	speed: 0.0232s/iter; left time: 191.0877s
	iters: 400, epoch: 6 | loss: 0.0307756
	speed: 0.0232s/iter; left time: 188.8699s
	iters: 500, epoch: 6 | loss: 0.0497869
	speed: 0.0232s/iter; left time: 186.6592s
Epoch: 6 cost time: 13.485600233078003
Epoch: 6, Steps: 570 | Train Loss: 0.0364597 Vali Loss: 0.0385614 Test Loss: 0.1396468
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13873861730098724, mae:0.24120382964611053
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1323162
	speed: 0.0324s/iter; left time: 365.9606s
	iters: 200, epoch: 1 | loss: 0.0824137
	speed: 0.0205s/iter; left time: 229.9565s
	iters: 300, epoch: 1 | loss: 0.1541070
	speed: 0.0206s/iter; left time: 228.2453s
	iters: 400, epoch: 1 | loss: 0.1056086
	speed: 0.0207s/iter; left time: 227.9306s
	iters: 500, epoch: 1 | loss: 0.1541315
	speed: 0.0207s/iter; left time: 225.5029s
Epoch: 1 cost time: 12.992482662200928
Epoch: 1, Steps: 570 | Train Loss: 0.1440308 Vali Loss: 0.0353116 Test Loss: 0.1119556
Validation loss decreased (inf --> 0.035312).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1237014
	speed: 0.0629s/iter; left time: 674.7764s
	iters: 200, epoch: 2 | loss: 0.0813918
	speed: 0.0205s/iter; left time: 218.2935s
	iters: 300, epoch: 2 | loss: 0.1027531
	speed: 0.0205s/iter; left time: 216.0846s
	iters: 400, epoch: 2 | loss: 0.0933123
	speed: 0.0205s/iter; left time: 214.1870s
	iters: 500, epoch: 2 | loss: 0.0625068
	speed: 0.0205s/iter; left time: 212.0182s
Epoch: 2 cost time: 12.043232202529907
Epoch: 2, Steps: 570 | Train Loss: 0.0988597 Vali Loss: 0.0343631 Test Loss: 0.1173671
Validation loss decreased (0.035312 --> 0.034363).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0641420
	speed: 0.0610s/iter; left time: 619.9910s
	iters: 200, epoch: 3 | loss: 0.0536526
	speed: 0.0206s/iter; left time: 207.4061s
	iters: 300, epoch: 3 | loss: 0.0694883
	speed: 0.0206s/iter; left time: 205.4276s
	iters: 400, epoch: 3 | loss: 0.0559392
	speed: 0.0206s/iter; left time: 203.2567s
	iters: 500, epoch: 3 | loss: 0.0553465
	speed: 0.0206s/iter; left time: 201.1398s
Epoch: 3 cost time: 12.063308000564575
Epoch: 3, Steps: 570 | Train Loss: 0.0621782 Vali Loss: 0.0342525 Test Loss: 0.1219186
Validation loss decreased (0.034363 --> 0.034253).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0366462
	speed: 0.0624s/iter; left time: 598.9145s
	iters: 200, epoch: 4 | loss: 0.0427919
	speed: 0.0211s/iter; left time: 200.1421s
	iters: 300, epoch: 4 | loss: 0.0457355
	speed: 0.0206s/iter; left time: 193.1645s
	iters: 400, epoch: 4 | loss: 0.0432367
	speed: 0.0206s/iter; left time: 191.3034s
	iters: 500, epoch: 4 | loss: 0.0349271
	speed: 0.0206s/iter; left time: 189.0720s
Epoch: 4 cost time: 12.267435550689697
Epoch: 4, Steps: 570 | Train Loss: 0.0436198 Vali Loss: 0.0343519 Test Loss: 0.1205175
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0357755
	speed: 0.0618s/iter; left time: 557.1993s
	iters: 200, epoch: 5 | loss: 0.0355270
	speed: 0.0207s/iter; left time: 184.3108s
	iters: 300, epoch: 5 | loss: 0.0306037
	speed: 0.0207s/iter; left time: 182.3336s
	iters: 400, epoch: 5 | loss: 0.0420264
	speed: 0.0207s/iter; left time: 180.2034s
	iters: 500, epoch: 5 | loss: 0.0385151
	speed: 0.0207s/iter; left time: 178.3067s
Epoch: 5 cost time: 12.058452129364014
Epoch: 5, Steps: 570 | Train Loss: 0.0357689 Vali Loss: 0.0346102 Test Loss: 0.1223844
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0234594
	speed: 0.0595s/iter; left time: 502.6456s
	iters: 200, epoch: 6 | loss: 0.0269406
	speed: 0.0207s/iter; left time: 172.6149s
	iters: 300, epoch: 6 | loss: 0.0281651
	speed: 0.0206s/iter; left time: 170.2992s
	iters: 400, epoch: 6 | loss: 0.0390316
	speed: 0.0207s/iter; left time: 168.4123s
	iters: 500, epoch: 6 | loss: 0.0268994
	speed: 0.0207s/iter; left time: 166.3358s
Epoch: 6 cost time: 12.044403791427612
Epoch: 6, Steps: 570 | Train Loss: 0.0320021 Vali Loss: 0.0347968 Test Loss: 0.1230432
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12209206074476242, mae:0.2197163850069046
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1993479
	speed: 0.0313s/iter; left time: 353.9002s
	iters: 200, epoch: 1 | loss: 0.1782197
	speed: 0.0191s/iter; left time: 214.2549s
	iters: 300, epoch: 1 | loss: 0.1975592
	speed: 0.0191s/iter; left time: 212.4062s
	iters: 400, epoch: 1 | loss: 0.2005119
	speed: 0.0192s/iter; left time: 211.2888s
	iters: 500, epoch: 1 | loss: 0.1762355
	speed: 0.0191s/iter; left time: 208.7330s
Epoch: 1 cost time: 12.183826208114624
Epoch: 1, Steps: 570 | Train Loss: 0.1741566 Vali Loss: 0.0434220 Test Loss: 0.1350538
Validation loss decreased (inf --> 0.043422).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0638883
	speed: 0.0599s/iter; left time: 642.2771s
	iters: 200, epoch: 2 | loss: 0.1771397
	speed: 0.0192s/iter; left time: 203.6211s
	iters: 300, epoch: 2 | loss: 0.0777541
	speed: 0.0191s/iter; left time: 201.1651s
	iters: 400, epoch: 2 | loss: 0.0867392
	speed: 0.0191s/iter; left time: 199.4075s
	iters: 500, epoch: 2 | loss: 0.0822950
	speed: 0.0191s/iter; left time: 197.1210s
Epoch: 2 cost time: 11.251380681991577
Epoch: 2, Steps: 570 | Train Loss: 0.1135138 Vali Loss: 0.0410773 Test Loss: 0.1439481
Validation loss decreased (0.043422 --> 0.041077).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0571769
	speed: 0.0656s/iter; left time: 666.7367s
	iters: 200, epoch: 3 | loss: 0.0578771
	speed: 0.0211s/iter; left time: 212.3458s
	iters: 300, epoch: 3 | loss: 0.0776076
	speed: 0.0211s/iter; left time: 209.8417s
	iters: 400, epoch: 3 | loss: 0.0569135
	speed: 0.0198s/iter; left time: 194.9057s
	iters: 500, epoch: 3 | loss: 0.0758753
	speed: 0.0199s/iter; left time: 194.6192s
Epoch: 3 cost time: 12.129183769226074
Epoch: 3, Steps: 570 | Train Loss: 0.0699668 Vali Loss: 0.0388080 Test Loss: 0.1375320
Validation loss decreased (0.041077 --> 0.038808).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0319529
	speed: 0.0622s/iter; left time: 596.9635s
	iters: 200, epoch: 4 | loss: 0.0382339
	speed: 0.0192s/iter; left time: 181.8529s
	iters: 300, epoch: 4 | loss: 0.0422708
	speed: 0.0192s/iter; left time: 179.8590s
	iters: 400, epoch: 4 | loss: 0.0494687
	speed: 0.0192s/iter; left time: 177.9689s
	iters: 500, epoch: 4 | loss: 0.0360663
	speed: 0.0192s/iter; left time: 176.4502s
Epoch: 4 cost time: 11.298121690750122
Epoch: 4, Steps: 570 | Train Loss: 0.0483091 Vali Loss: 0.0379723 Test Loss: 0.1417125
Validation loss decreased (0.038808 --> 0.037972).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0414709
	speed: 0.0618s/iter; left time: 557.2423s
	iters: 200, epoch: 5 | loss: 0.0288012
	speed: 0.0192s/iter; left time: 171.6335s
	iters: 300, epoch: 5 | loss: 0.0336405
	speed: 0.0192s/iter; left time: 169.6984s
	iters: 400, epoch: 5 | loss: 0.0298387
	speed: 0.0192s/iter; left time: 167.4228s
	iters: 500, epoch: 5 | loss: 0.0345208
	speed: 0.0192s/iter; left time: 165.4227s
Epoch: 5 cost time: 11.44356894493103
Epoch: 5, Steps: 570 | Train Loss: 0.0384476 Vali Loss: 0.0387255 Test Loss: 0.1445214
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0388057
	speed: 0.0599s/iter; left time: 506.0071s
	iters: 200, epoch: 6 | loss: 0.0374171
	speed: 0.0192s/iter; left time: 160.3272s
	iters: 300, epoch: 6 | loss: 0.0292357
	speed: 0.0192s/iter; left time: 158.1825s
	iters: 400, epoch: 6 | loss: 0.0309061
	speed: 0.0191s/iter; left time: 155.9263s
	iters: 500, epoch: 6 | loss: 0.0376697
	speed: 0.0191s/iter; left time: 154.0442s
Epoch: 6 cost time: 11.293319702148438
Epoch: 6, Steps: 570 | Train Loss: 0.0338836 Vali Loss: 0.0390634 Test Loss: 0.1482659
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0233778
	speed: 0.0589s/iter; left time: 464.0918s
	iters: 200, epoch: 7 | loss: 0.0288248
	speed: 0.0193s/iter; left time: 149.8265s
	iters: 300, epoch: 7 | loss: 0.0329367
	speed: 0.0193s/iter; left time: 147.8818s
	iters: 400, epoch: 7 | loss: 0.0305000
	speed: 0.0192s/iter; left time: 145.7541s
	iters: 500, epoch: 7 | loss: 0.0248829
	speed: 0.0192s/iter; left time: 143.6645s
Epoch: 7 cost time: 11.314306735992432
Epoch: 7, Steps: 570 | Train Loss: 0.0316444 Vali Loss: 0.0388381 Test Loss: 0.1495141
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.14190757274627686, mae:0.24510309100151062
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1661820
	speed: 0.0222s/iter; left time: 250.6142s
	iters: 200, epoch: 1 | loss: 0.1882960
	speed: 0.0106s/iter; left time: 118.3839s
	iters: 300, epoch: 1 | loss: 0.2432883
	speed: 0.0106s/iter; left time: 117.4909s
	iters: 400, epoch: 1 | loss: 0.2106672
	speed: 0.0106s/iter; left time: 116.2514s
	iters: 500, epoch: 1 | loss: 0.1615628
	speed: 0.0106s/iter; left time: 115.7923s
Epoch: 1 cost time: 7.239778995513916
Epoch: 1, Steps: 570 | Train Loss: 0.2132680 Vali Loss: 0.0489154 Test Loss: 0.1486931
Validation loss decreased (inf --> 0.048915).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2554823
	speed: 0.0380s/iter; left time: 407.6740s
	iters: 200, epoch: 2 | loss: 0.2682980
	speed: 0.0119s/iter; left time: 126.4507s
	iters: 300, epoch: 2 | loss: 0.1647600
	speed: 0.0118s/iter; left time: 124.6689s
	iters: 400, epoch: 2 | loss: 0.1572925
	speed: 0.0119s/iter; left time: 123.8443s
	iters: 500, epoch: 2 | loss: 0.1673287
	speed: 0.0118s/iter; left time: 122.2583s
Epoch: 2 cost time: 7.06139349937439
Epoch: 2, Steps: 570 | Train Loss: 0.1726924 Vali Loss: 0.0418939 Test Loss: 0.1265778
Validation loss decreased (0.048915 --> 0.041894).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1181338
	speed: 0.0377s/iter; left time: 383.5674s
	iters: 200, epoch: 3 | loss: 0.2001222
	speed: 0.0106s/iter; left time: 106.4028s
	iters: 300, epoch: 3 | loss: 0.1377586
	speed: 0.0105s/iter; left time: 104.8992s
	iters: 400, epoch: 3 | loss: 0.1699878
	speed: 0.0105s/iter; left time: 103.9559s
	iters: 500, epoch: 3 | loss: 0.2055827
	speed: 0.0105s/iter; left time: 102.8905s
Epoch: 3 cost time: 6.316495180130005
Epoch: 3, Steps: 570 | Train Loss: 0.1537922 Vali Loss: 0.0383821 Test Loss: 0.1203843
Validation loss decreased (0.041894 --> 0.038382).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1481126
	speed: 0.0376s/iter; left time: 360.3226s
	iters: 200, epoch: 4 | loss: 0.0932456
	speed: 0.0105s/iter; left time: 99.7941s
	iters: 300, epoch: 4 | loss: 0.1380324
	speed: 0.0105s/iter; left time: 98.3991s
	iters: 400, epoch: 4 | loss: 0.1560184
	speed: 0.0105s/iter; left time: 97.8371s
	iters: 500, epoch: 4 | loss: 0.1368372
	speed: 0.0105s/iter; left time: 96.8480s
Epoch: 4 cost time: 6.35309910774231
Epoch: 4, Steps: 570 | Train Loss: 0.1447483 Vali Loss: 0.0380562 Test Loss: 0.1202246
Validation loss decreased (0.038382 --> 0.038056).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1547439
	speed: 0.0378s/iter; left time: 340.8727s
	iters: 200, epoch: 5 | loss: 0.1538793
	speed: 0.0106s/iter; left time: 94.2498s
	iters: 300, epoch: 5 | loss: 0.1062656
	speed: 0.0105s/iter; left time: 92.9775s
	iters: 400, epoch: 5 | loss: 0.1278121
	speed: 0.0105s/iter; left time: 91.7616s
	iters: 500, epoch: 5 | loss: 0.1534337
	speed: 0.0105s/iter; left time: 90.7040s
Epoch: 5 cost time: 6.323312759399414
Epoch: 5, Steps: 570 | Train Loss: 0.1410183 Vali Loss: 0.0372186 Test Loss: 0.1193272
Validation loss decreased (0.038056 --> 0.037219).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1385755
	speed: 0.0368s/iter; left time: 310.6411s
	iters: 200, epoch: 6 | loss: 0.0998583
	speed: 0.0106s/iter; left time: 88.4317s
	iters: 300, epoch: 6 | loss: 0.1453860
	speed: 0.0106s/iter; left time: 87.3720s
	iters: 400, epoch: 6 | loss: 0.1546631
	speed: 0.0106s/iter; left time: 86.1603s
	iters: 500, epoch: 6 | loss: 0.1294211
	speed: 0.0106s/iter; left time: 85.1284s
Epoch: 6 cost time: 6.296482801437378
Epoch: 6, Steps: 570 | Train Loss: 0.1377903 Vali Loss: 0.0368099 Test Loss: 0.1188920
Validation loss decreased (0.037219 --> 0.036810).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1413189
	speed: 0.0359s/iter; left time: 283.1596s
	iters: 200, epoch: 7 | loss: 0.2008557
	speed: 0.0105s/iter; left time: 81.7073s
	iters: 300, epoch: 7 | loss: 0.1179606
	speed: 0.0105s/iter; left time: 80.8587s
	iters: 400, epoch: 7 | loss: 0.1264820
	speed: 0.0105s/iter; left time: 79.9358s
	iters: 500, epoch: 7 | loss: 0.1174680
	speed: 0.0105s/iter; left time: 78.8463s
Epoch: 7 cost time: 6.268507242202759
Epoch: 7, Steps: 570 | Train Loss: 0.1374366 Vali Loss: 0.0371287 Test Loss: 0.1191760
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1442029
	speed: 0.0368s/iter; left time: 269.3503s
	iters: 200, epoch: 8 | loss: 0.1226638
	speed: 0.0106s/iter; left time: 76.4617s
	iters: 300, epoch: 8 | loss: 0.1857536
	speed: 0.0106s/iter; left time: 75.6486s
	iters: 400, epoch: 8 | loss: 0.1947010
	speed: 0.0106s/iter; left time: 74.3704s
	iters: 500, epoch: 8 | loss: 0.1027075
	speed: 0.0106s/iter; left time: 72.9932s
Epoch: 8 cost time: 6.318368911743164
Epoch: 8, Steps: 570 | Train Loss: 0.1363312 Vali Loss: 0.0368068 Test Loss: 0.1189497
Validation loss decreased (0.036810 --> 0.036807).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1744780
	speed: 0.0358s/iter; left time: 241.2950s
	iters: 200, epoch: 9 | loss: 0.1239212
	speed: 0.0105s/iter; left time: 70.0058s
	iters: 300, epoch: 9 | loss: 0.0659825
	speed: 0.0105s/iter; left time: 68.9620s
	iters: 400, epoch: 9 | loss: 0.1558087
	speed: 0.0105s/iter; left time: 67.9012s
	iters: 500, epoch: 9 | loss: 0.1267672
	speed: 0.0105s/iter; left time: 66.8203s
Epoch: 9 cost time: 6.302349805831909
Epoch: 9, Steps: 570 | Train Loss: 0.1359967 Vali Loss: 0.0371288 Test Loss: 0.1191462
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1579017
	speed: 0.0366s/iter; left time: 225.5972s
	iters: 200, epoch: 10 | loss: 0.1459462
	speed: 0.0105s/iter; left time: 63.5154s
	iters: 300, epoch: 10 | loss: 0.1129273
	speed: 0.0105s/iter; left time: 62.4484s
	iters: 400, epoch: 10 | loss: 0.1299830
	speed: 0.0105s/iter; left time: 61.4162s
	iters: 500, epoch: 10 | loss: 0.1774755
	speed: 0.0105s/iter; left time: 60.3617s
Epoch: 10 cost time: 6.251264572143555
Epoch: 10, Steps: 570 | Train Loss: 0.1356069 Vali Loss: 0.0369601 Test Loss: 0.1190087
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1467692
	speed: 0.0379s/iter; left time: 212.1115s
	iters: 200, epoch: 11 | loss: 0.1327035
	speed: 0.0105s/iter; left time: 57.8825s
	iters: 300, epoch: 11 | loss: 0.1024538
	speed: 0.0105s/iter; left time: 56.8103s
	iters: 400, epoch: 11 | loss: 0.1856325
	speed: 0.0105s/iter; left time: 55.7238s
	iters: 500, epoch: 11 | loss: 0.1188164
	speed: 0.0105s/iter; left time: 54.7720s
Epoch: 11 cost time: 6.27304220199585
Epoch: 11, Steps: 570 | Train Loss: 0.1367319 Vali Loss: 0.0368543 Test Loss: 0.1190960
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1191156804561615, mae:0.21371115744113922
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1632898
	speed: 0.0218s/iter; left time: 246.5830s
	iters: 200, epoch: 1 | loss: 0.1962866
	speed: 0.0102s/iter; left time: 114.3054s
	iters: 300, epoch: 1 | loss: 0.2366278
	speed: 0.0102s/iter; left time: 113.4205s
	iters: 400, epoch: 1 | loss: 0.1839257
	speed: 0.0102s/iter; left time: 111.7654s
	iters: 500, epoch: 1 | loss: 0.1764508
	speed: 0.0102s/iter; left time: 110.9079s
Epoch: 1 cost time: 7.018388271331787
Epoch: 1, Steps: 570 | Train Loss: 0.1842088 Vali Loss: 0.0355790 Test Loss: 0.1113996
Validation loss decreased (inf --> 0.035579).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1228776
	speed: 0.0367s/iter; left time: 394.2276s
	iters: 200, epoch: 2 | loss: 0.1663849
	speed: 0.0102s/iter; left time: 108.1300s
	iters: 300, epoch: 2 | loss: 0.1062605
	speed: 0.0102s/iter; left time: 107.2741s
	iters: 400, epoch: 2 | loss: 0.1292071
	speed: 0.0102s/iter; left time: 106.0506s
	iters: 500, epoch: 2 | loss: 0.1493803
	speed: 0.0102s/iter; left time: 105.0874s
Epoch: 2 cost time: 6.114845514297485
Epoch: 2, Steps: 570 | Train Loss: 0.1527847 Vali Loss: 0.0330815 Test Loss: 0.1088629
Validation loss decreased (0.035579 --> 0.033082).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0841182
	speed: 0.0391s/iter; left time: 397.7245s
	iters: 200, epoch: 3 | loss: 0.1208962
	speed: 0.0115s/iter; left time: 115.8434s
	iters: 300, epoch: 3 | loss: 0.2659534
	speed: 0.0116s/iter; left time: 115.3574s
	iters: 400, epoch: 3 | loss: 0.1304747
	speed: 0.0109s/iter; left time: 107.6394s
	iters: 500, epoch: 3 | loss: 0.1050824
	speed: 0.0102s/iter; left time: 99.1294s
Epoch: 3 cost time: 6.601623296737671
Epoch: 3, Steps: 570 | Train Loss: 0.1381241 Vali Loss: 0.0310028 Test Loss: 0.1073266
Validation loss decreased (0.033082 --> 0.031003).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1128397
	speed: 0.0357s/iter; left time: 342.4858s
	iters: 200, epoch: 4 | loss: 0.0994237
	speed: 0.0102s/iter; left time: 97.0915s
	iters: 300, epoch: 4 | loss: 0.1038814
	speed: 0.0102s/iter; left time: 96.2277s
	iters: 400, epoch: 4 | loss: 0.0991919
	speed: 0.0102s/iter; left time: 95.2095s
	iters: 500, epoch: 4 | loss: 0.1753294
	speed: 0.0102s/iter; left time: 93.8611s
Epoch: 4 cost time: 6.121987342834473
Epoch: 4, Steps: 570 | Train Loss: 0.1310582 Vali Loss: 0.0308950 Test Loss: 0.1073900
Validation loss decreased (0.031003 --> 0.030895).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0961585
	speed: 0.0362s/iter; left time: 327.0038s
	iters: 200, epoch: 5 | loss: 0.1698866
	speed: 0.0102s/iter; left time: 91.4142s
	iters: 300, epoch: 5 | loss: 0.1103002
	speed: 0.0104s/iter; left time: 92.0804s
	iters: 400, epoch: 5 | loss: 0.1169631
	speed: 0.0115s/iter; left time: 100.4042s
	iters: 500, epoch: 5 | loss: 0.1244035
	speed: 0.0104s/iter; left time: 89.6826s
Epoch: 5 cost time: 6.326802492141724
Epoch: 5, Steps: 570 | Train Loss: 0.1278323 Vali Loss: 0.0307792 Test Loss: 0.1089362
Validation loss decreased (0.030895 --> 0.030779).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0868208
	speed: 0.0354s/iter; left time: 299.5051s
	iters: 200, epoch: 6 | loss: 0.1824658
	speed: 0.0102s/iter; left time: 85.5613s
	iters: 300, epoch: 6 | loss: 0.1520076
	speed: 0.0103s/iter; left time: 84.6214s
	iters: 400, epoch: 6 | loss: 0.1010766
	speed: 0.0103s/iter; left time: 83.5593s
	iters: 500, epoch: 6 | loss: 0.0868167
	speed: 0.0103s/iter; left time: 82.6184s
Epoch: 6 cost time: 6.124037265777588
Epoch: 6, Steps: 570 | Train Loss: 0.1265988 Vali Loss: 0.0305154 Test Loss: 0.1082917
Validation loss decreased (0.030779 --> 0.030515).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1266780
	speed: 0.0364s/iter; left time: 287.2099s
	iters: 200, epoch: 7 | loss: 0.1439131
	speed: 0.0102s/iter; left time: 79.5050s
	iters: 300, epoch: 7 | loss: 0.2094483
	speed: 0.0102s/iter; left time: 78.6671s
	iters: 400, epoch: 7 | loss: 0.1722923
	speed: 0.0102s/iter; left time: 77.6778s
	iters: 500, epoch: 7 | loss: 0.1462710
	speed: 0.0102s/iter; left time: 76.6145s
Epoch: 7 cost time: 6.154587030410767
Epoch: 7, Steps: 570 | Train Loss: 0.1256750 Vali Loss: 0.0302904 Test Loss: 0.1083232
Validation loss decreased (0.030515 --> 0.030290).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1091781
	speed: 0.0361s/iter; left time: 263.6772s
	iters: 200, epoch: 8 | loss: 0.0930290
	speed: 0.0102s/iter; left time: 73.3987s
	iters: 300, epoch: 8 | loss: 0.1188539
	speed: 0.0102s/iter; left time: 72.3639s
	iters: 400, epoch: 8 | loss: 0.1192022
	speed: 0.0102s/iter; left time: 71.3404s
	iters: 500, epoch: 8 | loss: 0.0936297
	speed: 0.0102s/iter; left time: 70.3139s
Epoch: 8 cost time: 6.100367784500122
Epoch: 8, Steps: 570 | Train Loss: 0.1259217 Vali Loss: 0.0301730 Test Loss: 0.1081155
Validation loss decreased (0.030290 --> 0.030173).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1100343
	speed: 0.0385s/iter; left time: 259.3094s
	iters: 200, epoch: 9 | loss: 0.1464002
	speed: 0.0115s/iter; left time: 76.4908s
	iters: 300, epoch: 9 | loss: 0.1102298
	speed: 0.0116s/iter; left time: 75.7863s
	iters: 400, epoch: 9 | loss: 0.1361244
	speed: 0.0115s/iter; left time: 74.3426s
	iters: 500, epoch: 9 | loss: 0.1263459
	speed: 0.0115s/iter; left time: 73.1347s
Epoch: 9 cost time: 6.807799339294434
Epoch: 9, Steps: 570 | Train Loss: 0.1245330 Vali Loss: 0.0302652 Test Loss: 0.1083011
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1255611
	speed: 0.0364s/iter; left time: 224.3205s
	iters: 200, epoch: 10 | loss: 0.1017917
	speed: 0.0102s/iter; left time: 61.8935s
	iters: 300, epoch: 10 | loss: 0.1145379
	speed: 0.0102s/iter; left time: 60.9543s
	iters: 400, epoch: 10 | loss: 0.0913101
	speed: 0.0102s/iter; left time: 60.0854s
	iters: 500, epoch: 10 | loss: 0.0766238
	speed: 0.0102s/iter; left time: 58.9830s
Epoch: 10 cost time: 6.1081013679504395
Epoch: 10, Steps: 570 | Train Loss: 0.1257018 Vali Loss: 0.0302718 Test Loss: 0.1083023
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1139698
	speed: 0.0358s/iter; left time: 200.6467s
	iters: 200, epoch: 11 | loss: 0.1388310
	speed: 0.0102s/iter; left time: 56.0307s
	iters: 300, epoch: 11 | loss: 0.1469189
	speed: 0.0102s/iter; left time: 55.3534s
	iters: 400, epoch: 11 | loss: 0.1414951
	speed: 0.0102s/iter; left time: 54.3014s
	iters: 500, epoch: 11 | loss: 0.1077557
	speed: 0.0102s/iter; left time: 53.1065s
Epoch: 11 cost time: 6.127962827682495
Epoch: 11, Steps: 570 | Train Loss: 0.1238729 Vali Loss: 0.0301528 Test Loss: 0.1083141
Validation loss decreased (0.030173 --> 0.030153).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1152398
	speed: 0.0352s/iter; left time: 177.0054s
	iters: 200, epoch: 12 | loss: 0.1277250
	speed: 0.0102s/iter; left time: 50.2516s
	iters: 300, epoch: 12 | loss: 0.1104521
	speed: 0.0102s/iter; left time: 49.2282s
	iters: 400, epoch: 12 | loss: 0.1891102
	speed: 0.0102s/iter; left time: 48.2184s
	iters: 500, epoch: 12 | loss: 0.1129850
	speed: 0.0102s/iter; left time: 47.1954s
Epoch: 12 cost time: 6.116507291793823
Epoch: 12, Steps: 570 | Train Loss: 0.1244618 Vali Loss: 0.0302571 Test Loss: 0.1083152
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1319189
	speed: 0.0359s/iter; left time: 160.0878s
	iters: 200, epoch: 13 | loss: 0.1576452
	speed: 0.0102s/iter; left time: 44.6931s
	iters: 300, epoch: 13 | loss: 0.0837472
	speed: 0.0102s/iter; left time: 43.6319s
	iters: 400, epoch: 13 | loss: 0.1625548
	speed: 0.0102s/iter; left time: 42.6177s
	iters: 500, epoch: 13 | loss: 0.1285427
	speed: 0.0102s/iter; left time: 41.5922s
Epoch: 13 cost time: 6.156998872756958
Epoch: 13, Steps: 570 | Train Loss: 0.1248096 Vali Loss: 0.0301347 Test Loss: 0.1083239
Validation loss decreased (0.030153 --> 0.030135).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1196261
	speed: 0.0377s/iter; left time: 146.5662s
	iters: 200, epoch: 14 | loss: 0.0963889
	speed: 0.0102s/iter; left time: 38.4896s
	iters: 300, epoch: 14 | loss: 0.1159598
	speed: 0.0101s/iter; left time: 37.4628s
	iters: 400, epoch: 14 | loss: 0.1377869
	speed: 0.0102s/iter; left time: 36.5019s
	iters: 500, epoch: 14 | loss: 0.1410586
	speed: 0.0101s/iter; left time: 35.3945s
Epoch: 14 cost time: 6.097911357879639
Epoch: 14, Steps: 570 | Train Loss: 0.1254393 Vali Loss: 0.0301758 Test Loss: 0.1083240
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.0806293
	speed: 0.0353s/iter; left time: 117.2353s
	iters: 200, epoch: 15 | loss: 0.1490056
	speed: 0.0102s/iter; left time: 32.8127s
	iters: 300, epoch: 15 | loss: 0.1265745
	speed: 0.0102s/iter; left time: 31.8812s
	iters: 400, epoch: 15 | loss: 0.1200736
	speed: 0.0102s/iter; left time: 30.8237s
	iters: 500, epoch: 15 | loss: 0.0979574
	speed: 0.0102s/iter; left time: 29.7878s
Epoch: 15 cost time: 6.124320983886719
Epoch: 15, Steps: 570 | Train Loss: 0.1243336 Vali Loss: 0.0301346 Test Loss: 0.1083250
Validation loss decreased (0.030135 --> 0.030135).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1814100
	speed: 0.0385s/iter; left time: 105.9496s
	iters: 200, epoch: 16 | loss: 0.1212711
	speed: 0.0115s/iter; left time: 30.4974s
	iters: 300, epoch: 16 | loss: 0.1605145
	speed: 0.0115s/iter; left time: 29.4578s
	iters: 400, epoch: 16 | loss: 0.1443062
	speed: 0.0116s/iter; left time: 28.3126s
	iters: 500, epoch: 16 | loss: 0.2023915
	speed: 0.0115s/iter; left time: 27.0615s
Epoch: 16 cost time: 6.846858978271484
Epoch: 16, Steps: 570 | Train Loss: 0.1248819 Vali Loss: 0.0301262 Test Loss: 0.1083253
Validation loss decreased (0.030135 --> 0.030126).  Saving model ...
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.0958868
	speed: 0.0369s/iter; left time: 80.5308s
	iters: 200, epoch: 17 | loss: 0.1025478
	speed: 0.0102s/iter; left time: 21.2907s
	iters: 300, epoch: 17 | loss: 0.1280416
	speed: 0.0103s/iter; left time: 20.3369s
	iters: 400, epoch: 17 | loss: 0.1144716
	speed: 0.0102s/iter; left time: 19.1870s
	iters: 500, epoch: 17 | loss: 0.0766145
	speed: 0.0101s/iter; left time: 18.0249s
Epoch: 17 cost time: 6.1271374225616455
Epoch: 17, Steps: 570 | Train Loss: 0.1247482 Vali Loss: 0.0302355 Test Loss: 0.1083252
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1366455
	speed: 0.0362s/iter; left time: 58.3660s
	iters: 200, epoch: 18 | loss: 0.1215379
	speed: 0.0102s/iter; left time: 15.4759s
	iters: 300, epoch: 18 | loss: 0.0830668
	speed: 0.0102s/iter; left time: 14.4382s
	iters: 400, epoch: 18 | loss: 0.2063132
	speed: 0.0102s/iter; left time: 13.4203s
	iters: 500, epoch: 18 | loss: 0.1021243
	speed: 0.0102s/iter; left time: 12.3855s
Epoch: 18 cost time: 6.133134126663208
Epoch: 18, Steps: 570 | Train Loss: 0.1247364 Vali Loss: 0.0302222 Test Loss: 0.1083251
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1282438
	speed: 0.0368s/iter; left time: 38.3337s
	iters: 200, epoch: 19 | loss: 0.1352768
	speed: 0.0103s/iter; left time: 9.6458s
	iters: 300, epoch: 19 | loss: 0.1141587
	speed: 0.0103s/iter; left time: 8.6281s
	iters: 400, epoch: 19 | loss: 0.1481847
	speed: 0.0103s/iter; left time: 7.6227s
	iters: 500, epoch: 19 | loss: 0.1201239
	speed: 0.0102s/iter; left time: 6.5539s
Epoch: 19 cost time: 6.160877704620361
Epoch: 19, Steps: 570 | Train Loss: 0.1244544 Vali Loss: 0.0302172 Test Loss: 0.1083252
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10847773402929306, mae:0.19956164062023163
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2209077
	speed: 0.0233s/iter; left time: 262.9458s
	iters: 200, epoch: 1 | loss: 0.1631805
	speed: 0.0116s/iter; left time: 130.3035s
	iters: 300, epoch: 1 | loss: 0.1428613
	speed: 0.0116s/iter; left time: 128.7246s
	iters: 400, epoch: 1 | loss: 0.1150904
	speed: 0.0106s/iter; left time: 116.5211s
	iters: 500, epoch: 1 | loss: 0.2018290
	speed: 0.0105s/iter; left time: 114.4966s
Epoch: 1 cost time: 7.63770055770874
Epoch: 1, Steps: 570 | Train Loss: 0.2200478 Vali Loss: 0.0456244 Test Loss: 0.1333508
Validation loss decreased (inf --> 0.045624).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1866460
	speed: 0.0390s/iter; left time: 418.6787s
	iters: 200, epoch: 2 | loss: 0.2389505
	speed: 0.0118s/iter; left time: 124.9717s
	iters: 300, epoch: 2 | loss: 0.1493279
	speed: 0.0117s/iter; left time: 123.4916s
	iters: 400, epoch: 2 | loss: 0.2726944
	speed: 0.0117s/iter; left time: 122.0296s
	iters: 500, epoch: 2 | loss: 0.2013200
	speed: 0.0117s/iter; left time: 121.1357s
Epoch: 2 cost time: 7.014589786529541
Epoch: 2, Steps: 570 | Train Loss: 0.1774382 Vali Loss: 0.0395741 Test Loss: 0.1253181
Validation loss decreased (0.045624 --> 0.039574).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1207781
	speed: 0.0389s/iter; left time: 395.1414s
	iters: 200, epoch: 3 | loss: 0.1570719
	speed: 0.0118s/iter; left time: 118.7299s
	iters: 300, epoch: 3 | loss: 0.1950693
	speed: 0.0118s/iter; left time: 117.4065s
	iters: 400, epoch: 3 | loss: 0.1283651
	speed: 0.0118s/iter; left time: 116.1808s
	iters: 500, epoch: 3 | loss: 0.1199954
	speed: 0.0118s/iter; left time: 114.9246s
Epoch: 3 cost time: 7.022442102432251
Epoch: 3, Steps: 570 | Train Loss: 0.1601210 Vali Loss: 0.0392600 Test Loss: 0.1258912
Validation loss decreased (0.039574 --> 0.039260).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0857576
	speed: 0.0388s/iter; left time: 372.5799s
	iters: 200, epoch: 4 | loss: 0.1435241
	speed: 0.0116s/iter; left time: 110.3919s
	iters: 300, epoch: 4 | loss: 0.1204739
	speed: 0.0117s/iter; left time: 109.7021s
	iters: 400, epoch: 4 | loss: 0.1990416
	speed: 0.0117s/iter; left time: 108.4840s
	iters: 500, epoch: 4 | loss: 0.1360075
	speed: 0.0117s/iter; left time: 107.0969s
Epoch: 4 cost time: 6.952067136764526
Epoch: 4, Steps: 570 | Train Loss: 0.1509492 Vali Loss: 0.0388266 Test Loss: 0.1260145
Validation loss decreased (0.039260 --> 0.038827).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1325593
	speed: 0.0385s/iter; left time: 347.0304s
	iters: 200, epoch: 5 | loss: 0.1007131
	speed: 0.0104s/iter; left time: 93.0331s
	iters: 300, epoch: 5 | loss: 0.1569553
	speed: 0.0104s/iter; left time: 91.9492s
	iters: 400, epoch: 5 | loss: 0.1501538
	speed: 0.0104s/iter; left time: 90.8563s
	iters: 500, epoch: 5 | loss: 0.1873112
	speed: 0.0104s/iter; left time: 89.5338s
Epoch: 5 cost time: 6.2336156368255615
Epoch: 5, Steps: 570 | Train Loss: 0.1477954 Vali Loss: 0.0387457 Test Loss: 0.1248546
Validation loss decreased (0.038827 --> 0.038746).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1031383
	speed: 0.0381s/iter; left time: 321.7265s
	iters: 200, epoch: 6 | loss: 0.1437926
	speed: 0.0103s/iter; left time: 86.2350s
	iters: 300, epoch: 6 | loss: 0.1388285
	speed: 0.0104s/iter; left time: 85.4679s
	iters: 400, epoch: 6 | loss: 0.1307970
	speed: 0.0104s/iter; left time: 84.4752s
	iters: 500, epoch: 6 | loss: 0.1496309
	speed: 0.0103s/iter; left time: 83.3176s
Epoch: 6 cost time: 6.3297693729400635
Epoch: 6, Steps: 570 | Train Loss: 0.1451480 Vali Loss: 0.0380487 Test Loss: 0.1235802
Validation loss decreased (0.038746 --> 0.038049).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1069827
	speed: 0.0370s/iter; left time: 291.9795s
	iters: 200, epoch: 7 | loss: 0.1461647
	speed: 0.0103s/iter; left time: 80.2985s
	iters: 300, epoch: 7 | loss: 0.1125339
	speed: 0.0103s/iter; left time: 79.0755s
	iters: 400, epoch: 7 | loss: 0.0938165
	speed: 0.0103s/iter; left time: 78.1718s
	iters: 500, epoch: 7 | loss: 0.1562604
	speed: 0.0103s/iter; left time: 77.2716s
Epoch: 7 cost time: 6.203816175460815
Epoch: 7, Steps: 570 | Train Loss: 0.1428303 Vali Loss: 0.0379655 Test Loss: 0.1234711
Validation loss decreased (0.038049 --> 0.037965).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1077710
	speed: 0.0365s/iter; left time: 266.6859s
	iters: 200, epoch: 8 | loss: 0.1454666
	speed: 0.0104s/iter; left time: 74.8010s
	iters: 300, epoch: 8 | loss: 0.1180467
	speed: 0.0104s/iter; left time: 73.9666s
	iters: 400, epoch: 8 | loss: 0.1400131
	speed: 0.0104s/iter; left time: 72.9599s
	iters: 500, epoch: 8 | loss: 0.1238756
	speed: 0.0104s/iter; left time: 71.7593s
Epoch: 8 cost time: 6.227437973022461
Epoch: 8, Steps: 570 | Train Loss: 0.1415453 Vali Loss: 0.0379648 Test Loss: 0.1236288
Validation loss decreased (0.037965 --> 0.037965).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1197457
	speed: 0.0380s/iter; left time: 255.8434s
	iters: 200, epoch: 9 | loss: 0.1663950
	speed: 0.0104s/iter; left time: 68.7376s
	iters: 300, epoch: 9 | loss: 0.1219669
	speed: 0.0103s/iter; left time: 67.6192s
	iters: 400, epoch: 9 | loss: 0.1165582
	speed: 0.0103s/iter; left time: 66.5851s
	iters: 500, epoch: 9 | loss: 0.1473963
	speed: 0.0103s/iter; left time: 65.5674s
Epoch: 9 cost time: 6.219622373580933
Epoch: 9, Steps: 570 | Train Loss: 0.1408470 Vali Loss: 0.0381282 Test Loss: 0.1237652
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1218221
	speed: 0.0356s/iter; left time: 219.6921s
	iters: 200, epoch: 10 | loss: 0.1730519
	speed: 0.0103s/iter; left time: 62.7181s
	iters: 300, epoch: 10 | loss: 0.1865845
	speed: 0.0103s/iter; left time: 61.6895s
	iters: 400, epoch: 10 | loss: 0.1654164
	speed: 0.0103s/iter; left time: 60.6897s
	iters: 500, epoch: 10 | loss: 0.1427130
	speed: 0.0103s/iter; left time: 59.6842s
Epoch: 10 cost time: 6.18736720085144
Epoch: 10, Steps: 570 | Train Loss: 0.1427504 Vali Loss: 0.0381587 Test Loss: 0.1238057
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1540829
	speed: 0.0382s/iter; left time: 214.0318s
	iters: 200, epoch: 11 | loss: 0.1129410
	speed: 0.0103s/iter; left time: 56.5746s
	iters: 300, epoch: 11 | loss: 0.1937230
	speed: 0.0103s/iter; left time: 55.5420s
	iters: 400, epoch: 11 | loss: 0.1644548
	speed: 0.0103s/iter; left time: 54.4800s
	iters: 500, epoch: 11 | loss: 0.1550523
	speed: 0.0103s/iter; left time: 53.4269s
Epoch: 11 cost time: 6.195549726486206
Epoch: 11, Steps: 570 | Train Loss: 0.1425434 Vali Loss: 0.0379050 Test Loss: 0.1238274
Validation loss decreased (0.037965 --> 0.037905).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1438372
	speed: 0.0362s/iter; left time: 182.3562s
	iters: 200, epoch: 12 | loss: 0.1561584
	speed: 0.0104s/iter; left time: 51.1878s
	iters: 300, epoch: 12 | loss: 0.1043206
	speed: 0.0104s/iter; left time: 50.1231s
	iters: 400, epoch: 12 | loss: 0.1268635
	speed: 0.0104s/iter; left time: 49.0069s
	iters: 500, epoch: 12 | loss: 0.0814305
	speed: 0.0103s/iter; left time: 47.7420s
Epoch: 12 cost time: 6.220138788223267
Epoch: 12, Steps: 570 | Train Loss: 0.1417405 Vali Loss: 0.0379074 Test Loss: 0.1238480
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1408719
	speed: 0.0363s/iter; left time: 162.0342s
	iters: 200, epoch: 13 | loss: 0.1521952
	speed: 0.0104s/iter; left time: 45.2060s
	iters: 300, epoch: 13 | loss: 0.1613741
	speed: 0.0104s/iter; left time: 44.1122s
	iters: 400, epoch: 13 | loss: 0.1620815
	speed: 0.0104s/iter; left time: 43.1349s
	iters: 500, epoch: 13 | loss: 0.1417292
	speed: 0.0104s/iter; left time: 42.0515s
Epoch: 13 cost time: 6.22285008430481
Epoch: 13, Steps: 570 | Train Loss: 0.1424282 Vali Loss: 0.0379697 Test Loss: 0.1238488
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1171110
	speed: 0.0365s/iter; left time: 142.1003s
	iters: 200, epoch: 14 | loss: 0.1668206
	speed: 0.0103s/iter; left time: 39.1014s
	iters: 300, epoch: 14 | loss: 0.1107595
	speed: 0.0103s/iter; left time: 38.1605s
	iters: 400, epoch: 14 | loss: 0.0863452
	speed: 0.0103s/iter; left time: 37.1254s
	iters: 500, epoch: 14 | loss: 0.1830739
	speed: 0.0103s/iter; left time: 36.1073s
Epoch: 14 cost time: 6.163467884063721
Epoch: 14, Steps: 570 | Train Loss: 0.1414670 Vali Loss: 0.0378636 Test Loss: 0.1238594
Validation loss decreased (0.037905 --> 0.037864).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1206651
	speed: 0.0372s/iter; left time: 123.6651s
	iters: 200, epoch: 15 | loss: 0.1962299
	speed: 0.0104s/iter; left time: 33.5395s
	iters: 300, epoch: 15 | loss: 0.0880813
	speed: 0.0104s/iter; left time: 32.5267s
	iters: 400, epoch: 15 | loss: 0.0686535
	speed: 0.0104s/iter; left time: 31.4705s
	iters: 500, epoch: 15 | loss: 0.2198229
	speed: 0.0104s/iter; left time: 30.3425s
Epoch: 15 cost time: 6.245046854019165
Epoch: 15, Steps: 570 | Train Loss: 0.1417189 Vali Loss: 0.0379597 Test Loss: 0.1238618
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1515440
	speed: 0.0368s/iter; left time: 101.3102s
	iters: 200, epoch: 16 | loss: 0.1062499
	speed: 0.0104s/iter; left time: 27.4517s
	iters: 300, epoch: 16 | loss: 0.1378633
	speed: 0.0104s/iter; left time: 26.5151s
	iters: 400, epoch: 16 | loss: 0.1257110
	speed: 0.0104s/iter; left time: 25.5303s
	iters: 500, epoch: 16 | loss: 0.1545956
	speed: 0.0104s/iter; left time: 24.5022s
Epoch: 16 cost time: 6.189252138137817
Epoch: 16, Steps: 570 | Train Loss: 0.1420061 Vali Loss: 0.0381102 Test Loss: 0.1238612
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1119800
	speed: 0.0354s/iter; left time: 77.2569s
	iters: 200, epoch: 17 | loss: 0.0862425
	speed: 0.0103s/iter; left time: 21.5177s
	iters: 300, epoch: 17 | loss: 0.0969094
	speed: 0.0104s/iter; left time: 20.5051s
	iters: 400, epoch: 17 | loss: 0.1524913
	speed: 0.0104s/iter; left time: 19.4999s
	iters: 500, epoch: 17 | loss: 0.0960862
	speed: 0.0104s/iter; left time: 18.4637s
Epoch: 17 cost time: 6.191120862960815
Epoch: 17, Steps: 570 | Train Loss: 0.1422323 Vali Loss: 0.0381015 Test Loss: 0.1238618
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1240406259894371, mae:0.2200387865304947
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2494522
	speed: 0.0235s/iter; left time: 265.0232s
	iters: 200, epoch: 1 | loss: 0.2129330
	speed: 0.0118s/iter; left time: 132.5749s
	iters: 300, epoch: 1 | loss: 0.1523527
	speed: 0.0119s/iter; left time: 131.5559s
	iters: 400, epoch: 1 | loss: 0.1196123
	speed: 0.0118s/iter; left time: 130.1602s
	iters: 500, epoch: 1 | loss: 0.1970649
	speed: 0.0118s/iter; left time: 129.0262s
Epoch: 1 cost time: 7.964946746826172
Epoch: 1, Steps: 570 | Train Loss: 0.2074562 Vali Loss: 0.0426341 Test Loss: 0.1295917
Validation loss decreased (inf --> 0.042634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1755087
	speed: 0.0390s/iter; left time: 418.3246s
	iters: 200, epoch: 2 | loss: 0.1553559
	speed: 0.0118s/iter; left time: 125.8841s
	iters: 300, epoch: 2 | loss: 0.1324689
	speed: 0.0118s/iter; left time: 124.5494s
	iters: 400, epoch: 2 | loss: 0.0915983
	speed: 0.0118s/iter; left time: 123.4613s
	iters: 500, epoch: 2 | loss: 0.1688437
	speed: 0.0118s/iter; left time: 122.2389s
Epoch: 2 cost time: 7.054393768310547
Epoch: 2, Steps: 570 | Train Loss: 0.1654598 Vali Loss: 0.0396928 Test Loss: 0.1245952
Validation loss decreased (0.042634 --> 0.039693).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1581594
	speed: 0.0401s/iter; left time: 407.0415s
	iters: 200, epoch: 3 | loss: 0.1721560
	speed: 0.0119s/iter; left time: 120.0727s
	iters: 300, epoch: 3 | loss: 0.1140315
	speed: 0.0119s/iter; left time: 118.6418s
	iters: 400, epoch: 3 | loss: 0.1244937
	speed: 0.0119s/iter; left time: 117.2887s
	iters: 500, epoch: 3 | loss: 0.1060665
	speed: 0.0119s/iter; left time: 115.6736s
Epoch: 3 cost time: 7.101539373397827
Epoch: 3, Steps: 570 | Train Loss: 0.1411879 Vali Loss: 0.0367619 Test Loss: 0.1210644
Validation loss decreased (0.039693 --> 0.036762).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1151561
	speed: 0.0401s/iter; left time: 384.6031s
	iters: 200, epoch: 4 | loss: 0.1654308
	speed: 0.0119s/iter; left time: 112.4916s
	iters: 300, epoch: 4 | loss: 0.0820960
	speed: 0.0118s/iter; left time: 111.1506s
	iters: 400, epoch: 4 | loss: 0.0956668
	speed: 0.0118s/iter; left time: 110.0428s
	iters: 500, epoch: 4 | loss: 0.1009726
	speed: 0.0118s/iter; left time: 108.7345s
Epoch: 4 cost time: 7.0425145626068115
Epoch: 4, Steps: 570 | Train Loss: 0.1289499 Vali Loss: 0.0352489 Test Loss: 0.1231693
Validation loss decreased (0.036762 --> 0.035249).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1123193
	speed: 0.0408s/iter; left time: 368.0452s
	iters: 200, epoch: 5 | loss: 0.1100611
	speed: 0.0119s/iter; left time: 105.7735s
	iters: 300, epoch: 5 | loss: 0.1749112
	speed: 0.0118s/iter; left time: 104.5052s
	iters: 400, epoch: 5 | loss: 0.1129525
	speed: 0.0118s/iter; left time: 103.0954s
	iters: 500, epoch: 5 | loss: 0.1089170
	speed: 0.0118s/iter; left time: 102.1049s
Epoch: 5 cost time: 7.089262962341309
Epoch: 5, Steps: 570 | Train Loss: 0.1233984 Vali Loss: 0.0358403 Test Loss: 0.1185238
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1055258
	speed: 0.0402s/iter; left time: 340.1395s
	iters: 200, epoch: 6 | loss: 0.0744367
	speed: 0.0130s/iter; left time: 108.3538s
	iters: 300, epoch: 6 | loss: 0.1253520
	speed: 0.0120s/iter; left time: 99.4066s
	iters: 400, epoch: 6 | loss: 0.1410496
	speed: 0.0119s/iter; left time: 96.8267s
	iters: 500, epoch: 6 | loss: 0.0853137
	speed: 0.0119s/iter; left time: 95.6787s
Epoch: 6 cost time: 7.299660682678223
Epoch: 6, Steps: 570 | Train Loss: 0.1182106 Vali Loss: 0.0345302 Test Loss: 0.1180393
Validation loss decreased (0.035249 --> 0.034530).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1296884
	speed: 0.0399s/iter; left time: 314.0823s
	iters: 200, epoch: 7 | loss: 0.1308485
	speed: 0.0119s/iter; left time: 92.7475s
	iters: 300, epoch: 7 | loss: 0.1279680
	speed: 0.0119s/iter; left time: 91.6730s
	iters: 400, epoch: 7 | loss: 0.1000333
	speed: 0.0119s/iter; left time: 89.8781s
	iters: 500, epoch: 7 | loss: 0.1005313
	speed: 0.0118s/iter; left time: 88.2229s
Epoch: 7 cost time: 7.055084943771362
Epoch: 7, Steps: 570 | Train Loss: 0.1169174 Vali Loss: 0.0343042 Test Loss: 0.1196582
Validation loss decreased (0.034530 --> 0.034304).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0725371
	speed: 0.0387s/iter; left time: 282.6404s
	iters: 200, epoch: 8 | loss: 0.1225613
	speed: 0.0119s/iter; left time: 85.5749s
	iters: 300, epoch: 8 | loss: 0.0996163
	speed: 0.0119s/iter; left time: 84.5497s
	iters: 400, epoch: 8 | loss: 0.0855558
	speed: 0.0119s/iter; left time: 83.2841s
	iters: 500, epoch: 8 | loss: 0.0986222
	speed: 0.0119s/iter; left time: 82.1517s
Epoch: 8 cost time: 7.076983690261841
Epoch: 8, Steps: 570 | Train Loss: 0.1168448 Vali Loss: 0.0341010 Test Loss: 0.1192758
Validation loss decreased (0.034304 --> 0.034101).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0960807
	speed: 0.0405s/iter; left time: 272.8916s
	iters: 200, epoch: 9 | loss: 0.1103233
	speed: 0.0119s/iter; left time: 78.9928s
	iters: 300, epoch: 9 | loss: 0.1214779
	speed: 0.0119s/iter; left time: 77.6149s
	iters: 400, epoch: 9 | loss: 0.0919171
	speed: 0.0119s/iter; left time: 76.3894s
	iters: 500, epoch: 9 | loss: 0.1461041
	speed: 0.0119s/iter; left time: 75.2630s
Epoch: 9 cost time: 7.056760549545288
Epoch: 9, Steps: 570 | Train Loss: 0.1163970 Vali Loss: 0.0340609 Test Loss: 0.1190358
Validation loss decreased (0.034101 --> 0.034061).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1156739
	speed: 0.0388s/iter; left time: 239.7428s
	iters: 200, epoch: 10 | loss: 0.1168119
	speed: 0.0119s/iter; left time: 72.1330s
	iters: 300, epoch: 10 | loss: 0.0976095
	speed: 0.0119s/iter; left time: 70.8071s
	iters: 400, epoch: 10 | loss: 0.0884077
	speed: 0.0118s/iter; left time: 69.3088s
	iters: 500, epoch: 10 | loss: 0.1521445
	speed: 0.0118s/iter; left time: 68.1344s
Epoch: 10 cost time: 7.050570249557495
Epoch: 10, Steps: 570 | Train Loss: 0.1171683 Vali Loss: 0.0342109 Test Loss: 0.1189131
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0946117
	speed: 0.0383s/iter; left time: 214.5942s
	iters: 200, epoch: 11 | loss: 0.1715285
	speed: 0.0119s/iter; left time: 65.2749s
	iters: 300, epoch: 11 | loss: 0.1023363
	speed: 0.0119s/iter; left time: 64.0904s
	iters: 400, epoch: 11 | loss: 0.1114139
	speed: 0.0119s/iter; left time: 62.8651s
	iters: 500, epoch: 11 | loss: 0.1463158
	speed: 0.0119s/iter; left time: 61.7512s
Epoch: 11 cost time: 7.052458047866821
Epoch: 11, Steps: 570 | Train Loss: 0.1154145 Vali Loss: 0.0342090 Test Loss: 0.1189196
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1003364
	speed: 0.0389s/iter; left time: 195.7564s
	iters: 200, epoch: 12 | loss: 0.0884850
	speed: 0.0118s/iter; left time: 58.2721s
	iters: 300, epoch: 12 | loss: 0.0798764
	speed: 0.0118s/iter; left time: 57.2158s
	iters: 400, epoch: 12 | loss: 0.0917849
	speed: 0.0118s/iter; left time: 56.0417s
	iters: 500, epoch: 12 | loss: 0.1094390
	speed: 0.0118s/iter; left time: 54.7479s
Epoch: 12 cost time: 7.01141357421875
Epoch: 12, Steps: 570 | Train Loss: 0.1151760 Vali Loss: 0.0342856 Test Loss: 0.1188759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11919538676738739, mae:0.2178240269422531
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1061446
	speed: 0.0234s/iter; left time: 264.8686s
	iters: 200, epoch: 1 | loss: 0.2938389
	speed: 0.0115s/iter; left time: 128.5274s
	iters: 300, epoch: 1 | loss: 0.1393132
	speed: 0.0114s/iter; left time: 127.0863s
	iters: 400, epoch: 1 | loss: 0.1742748
	speed: 0.0115s/iter; left time: 126.0869s
	iters: 500, epoch: 1 | loss: 0.1219428
	speed: 0.0115s/iter; left time: 125.0517s
Epoch: 1 cost time: 7.786781549453735
Epoch: 1, Steps: 570 | Train Loss: 0.1809858 Vali Loss: 0.0358772 Test Loss: 0.1120169
Validation loss decreased (inf --> 0.035877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1285634
	speed: 0.0384s/iter; left time: 412.2877s
	iters: 200, epoch: 2 | loss: 0.1006706
	speed: 0.0114s/iter; left time: 121.4759s
	iters: 300, epoch: 2 | loss: 0.1497626
	speed: 0.0114s/iter; left time: 120.1753s
	iters: 400, epoch: 2 | loss: 0.2290181
	speed: 0.0114s/iter; left time: 119.3082s
	iters: 500, epoch: 2 | loss: 0.2421417
	speed: 0.0114s/iter; left time: 118.0904s
Epoch: 2 cost time: 6.823119401931763
Epoch: 2, Steps: 570 | Train Loss: 0.1469245 Vali Loss: 0.0362476 Test Loss: 0.1125096
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1461935
	speed: 0.0388s/iter; left time: 394.1486s
	iters: 200, epoch: 3 | loss: 0.0874312
	speed: 0.0115s/iter; left time: 115.8116s
	iters: 300, epoch: 3 | loss: 0.1629128
	speed: 0.0115s/iter; left time: 114.7367s
	iters: 400, epoch: 3 | loss: 0.1303105
	speed: 0.0115s/iter; left time: 113.3063s
	iters: 500, epoch: 3 | loss: 0.1554490
	speed: 0.0115s/iter; left time: 112.4466s
Epoch: 3 cost time: 6.865642070770264
Epoch: 3, Steps: 570 | Train Loss: 0.1299274 Vali Loss: 0.0332274 Test Loss: 0.1086616
Validation loss decreased (0.035877 --> 0.033227).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1100514
	speed: 0.0392s/iter; left time: 375.7712s
	iters: 200, epoch: 4 | loss: 0.0898602
	speed: 0.0115s/iter; left time: 109.0299s
	iters: 300, epoch: 4 | loss: 0.0719668
	speed: 0.0115s/iter; left time: 107.8533s
	iters: 400, epoch: 4 | loss: 0.1100080
	speed: 0.0115s/iter; left time: 106.7717s
	iters: 500, epoch: 4 | loss: 0.1275932
	speed: 0.0115s/iter; left time: 105.3988s
Epoch: 4 cost time: 6.853309869766235
Epoch: 4, Steps: 570 | Train Loss: 0.1192766 Vali Loss: 0.0334128 Test Loss: 0.1083727
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0998100
	speed: 0.0381s/iter; left time: 343.9719s
	iters: 200, epoch: 5 | loss: 0.0951665
	speed: 0.0114s/iter; left time: 102.0941s
	iters: 300, epoch: 5 | loss: 0.1616226
	speed: 0.0115s/iter; left time: 101.0238s
	iters: 400, epoch: 5 | loss: 0.0922074
	speed: 0.0114s/iter; left time: 99.8290s
	iters: 500, epoch: 5 | loss: 0.1030626
	speed: 0.0115s/iter; left time: 98.7641s
Epoch: 5 cost time: 6.813181638717651
Epoch: 5, Steps: 570 | Train Loss: 0.1137036 Vali Loss: 0.0332378 Test Loss: 0.1093978
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1444074
	speed: 0.0390s/iter; left time: 329.4091s
	iters: 200, epoch: 6 | loss: 0.1259873
	speed: 0.0114s/iter; left time: 95.3829s
	iters: 300, epoch: 6 | loss: 0.0823032
	speed: 0.0114s/iter; left time: 94.2001s
	iters: 400, epoch: 6 | loss: 0.0880875
	speed: 0.0114s/iter; left time: 93.0735s
	iters: 500, epoch: 6 | loss: 0.0839217
	speed: 0.0114s/iter; left time: 91.9036s
Epoch: 6 cost time: 6.773877859115601
Epoch: 6, Steps: 570 | Train Loss: 0.1108379 Vali Loss: 0.0329414 Test Loss: 0.1084211
Validation loss decreased (0.033227 --> 0.032941).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0801231
	speed: 0.0386s/iter; left time: 304.3710s
	iters: 200, epoch: 7 | loss: 0.1289176
	speed: 0.0115s/iter; left time: 89.1119s
	iters: 300, epoch: 7 | loss: 0.0806299
	speed: 0.0114s/iter; left time: 87.8314s
	iters: 400, epoch: 7 | loss: 0.0882797
	speed: 0.0114s/iter; left time: 86.7611s
	iters: 500, epoch: 7 | loss: 0.0941452
	speed: 0.0115s/iter; left time: 85.6820s
Epoch: 7 cost time: 6.853348255157471
Epoch: 7, Steps: 570 | Train Loss: 0.1095375 Vali Loss: 0.0327797 Test Loss: 0.1082623
Validation loss decreased (0.032941 --> 0.032780).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0955910
	speed: 0.0410s/iter; left time: 299.4672s
	iters: 200, epoch: 8 | loss: 0.1279755
	speed: 0.0126s/iter; left time: 90.6148s
	iters: 300, epoch: 8 | loss: 0.0893521
	speed: 0.0126s/iter; left time: 89.3987s
	iters: 400, epoch: 8 | loss: 0.1013135
	speed: 0.0125s/iter; left time: 87.9513s
	iters: 500, epoch: 8 | loss: 0.1093070
	speed: 0.0126s/iter; left time: 86.7835s
Epoch: 8 cost time: 7.4016640186309814
Epoch: 8, Steps: 570 | Train Loss: 0.1093392 Vali Loss: 0.0331353 Test Loss: 0.1088808
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1575224
	speed: 0.0382s/iter; left time: 257.5765s
	iters: 200, epoch: 9 | loss: 0.0802651
	speed: 0.0114s/iter; left time: 75.8035s
	iters: 300, epoch: 9 | loss: 0.1117401
	speed: 0.0114s/iter; left time: 74.7031s
	iters: 400, epoch: 9 | loss: 0.1396321
	speed: 0.0114s/iter; left time: 73.5536s
	iters: 500, epoch: 9 | loss: 0.1535444
	speed: 0.0114s/iter; left time: 72.3558s
Epoch: 9 cost time: 6.796843528747559
Epoch: 9, Steps: 570 | Train Loss: 0.1096551 Vali Loss: 0.0328618 Test Loss: 0.1087080
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1076999
	speed: 0.0385s/iter; left time: 237.6055s
	iters: 200, epoch: 10 | loss: 0.0950411
	speed: 0.0115s/iter; left time: 69.7585s
	iters: 300, epoch: 10 | loss: 0.0886016
	speed: 0.0115s/iter; left time: 68.5387s
	iters: 400, epoch: 10 | loss: 0.1124933
	speed: 0.0115s/iter; left time: 67.4635s
	iters: 500, epoch: 10 | loss: 0.1248781
	speed: 0.0115s/iter; left time: 66.3052s
Epoch: 10 cost time: 6.925210237503052
Epoch: 10, Steps: 570 | Train Loss: 0.1088378 Vali Loss: 0.0329134 Test Loss: 0.1087530
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10842026770114899, mae:0.19971726834774017
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2666608
	speed: 0.0239s/iter; left time: 270.6068s
	iters: 200, epoch: 1 | loss: 0.2344479
	speed: 0.0121s/iter; left time: 135.1357s
	iters: 300, epoch: 1 | loss: 0.2681766
	speed: 0.0120s/iter; left time: 133.5235s
	iters: 400, epoch: 1 | loss: 0.1758684
	speed: 0.0120s/iter; left time: 132.2285s
	iters: 500, epoch: 1 | loss: 0.1921344
	speed: 0.0120s/iter; left time: 130.9836s
Epoch: 1 cost time: 8.111766338348389
Epoch: 1, Steps: 570 | Train Loss: 0.2114521 Vali Loss: 0.0422289 Test Loss: 0.1334401
Validation loss decreased (inf --> 0.042229).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2222213
	speed: 0.0402s/iter; left time: 431.4816s
	iters: 200, epoch: 2 | loss: 0.2736513
	speed: 0.0109s/iter; left time: 115.7575s
	iters: 300, epoch: 2 | loss: 0.1277289
	speed: 0.0109s/iter; left time: 114.8668s
	iters: 400, epoch: 2 | loss: 0.1396603
	speed: 0.0109s/iter; left time: 113.8811s
	iters: 500, epoch: 2 | loss: 0.1350700
	speed: 0.0109s/iter; left time: 112.6880s
Epoch: 2 cost time: 6.547900676727295
Epoch: 2, Steps: 570 | Train Loss: 0.1713502 Vali Loss: 0.0425691 Test Loss: 0.1256566
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1520723
	speed: 0.0382s/iter; left time: 388.4952s
	iters: 200, epoch: 3 | loss: 0.1291768
	speed: 0.0109s/iter; left time: 109.5412s
	iters: 300, epoch: 3 | loss: 0.1434106
	speed: 0.0109s/iter; left time: 108.4263s
	iters: 400, epoch: 3 | loss: 0.1218131
	speed: 0.0109s/iter; left time: 107.4908s
	iters: 500, epoch: 3 | loss: 0.1572614
	speed: 0.0109s/iter; left time: 106.0547s
Epoch: 3 cost time: 6.531020879745483
Epoch: 3, Steps: 570 | Train Loss: 0.1472495 Vali Loss: 0.0413527 Test Loss: 0.1271744
Validation loss decreased (0.042229 --> 0.041353).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1284194
	speed: 0.0373s/iter; left time: 358.1311s
	iters: 200, epoch: 4 | loss: 0.1104371
	speed: 0.0108s/iter; left time: 102.8916s
	iters: 300, epoch: 4 | loss: 0.1248381
	speed: 0.0108s/iter; left time: 101.8034s
	iters: 400, epoch: 4 | loss: 0.2190025
	speed: 0.0108s/iter; left time: 100.7281s
	iters: 500, epoch: 4 | loss: 0.1397098
	speed: 0.0109s/iter; left time: 99.7418s
Epoch: 4 cost time: 6.483416557312012
Epoch: 4, Steps: 570 | Train Loss: 0.1364210 Vali Loss: 0.0399190 Test Loss: 0.1251965
Validation loss decreased (0.041353 --> 0.039919).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1347206
	speed: 0.0376s/iter; left time: 339.4459s
	iters: 200, epoch: 5 | loss: 0.1331736
	speed: 0.0109s/iter; left time: 97.4326s
	iters: 300, epoch: 5 | loss: 0.1527700
	speed: 0.0109s/iter; left time: 96.2058s
	iters: 400, epoch: 5 | loss: 0.1086815
	speed: 0.0109s/iter; left time: 95.3130s
	iters: 500, epoch: 5 | loss: 0.2206286
	speed: 0.0109s/iter; left time: 94.3051s
Epoch: 5 cost time: 6.539482831954956
Epoch: 5, Steps: 570 | Train Loss: 0.1303347 Vali Loss: 0.0386281 Test Loss: 0.1224689
Validation loss decreased (0.039919 --> 0.038628).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1115298
	speed: 0.0376s/iter; left time: 317.5938s
	iters: 200, epoch: 6 | loss: 0.1223001
	speed: 0.0109s/iter; left time: 91.4313s
	iters: 300, epoch: 6 | loss: 0.1253359
	speed: 0.0109s/iter; left time: 90.1247s
	iters: 400, epoch: 6 | loss: 0.1120289
	speed: 0.0109s/iter; left time: 89.0627s
	iters: 500, epoch: 6 | loss: 0.1296152
	speed: 0.0109s/iter; left time: 87.8042s
Epoch: 6 cost time: 6.572933197021484
Epoch: 6, Steps: 570 | Train Loss: 0.1268731 Vali Loss: 0.0391719 Test Loss: 0.1254759
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1168155
	speed: 0.0385s/iter; left time: 303.1453s
	iters: 200, epoch: 7 | loss: 0.1033156
	speed: 0.0109s/iter; left time: 85.1624s
	iters: 300, epoch: 7 | loss: 0.0881221
	speed: 0.0109s/iter; left time: 83.7601s
	iters: 400, epoch: 7 | loss: 0.1157171
	speed: 0.0109s/iter; left time: 82.5541s
	iters: 500, epoch: 7 | loss: 0.0893376
	speed: 0.0109s/iter; left time: 81.4827s
Epoch: 7 cost time: 6.508885145187378
Epoch: 7, Steps: 570 | Train Loss: 0.1247528 Vali Loss: 0.0385924 Test Loss: 0.1243976
Validation loss decreased (0.038628 --> 0.038592).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0976155
	speed: 0.0392s/iter; left time: 286.9121s
	iters: 200, epoch: 8 | loss: 0.1807430
	speed: 0.0109s/iter; left time: 78.7378s
	iters: 300, epoch: 8 | loss: 0.1563657
	speed: 0.0109s/iter; left time: 77.7113s
	iters: 400, epoch: 8 | loss: 0.1276036
	speed: 0.0109s/iter; left time: 76.5717s
	iters: 500, epoch: 8 | loss: 0.0864860
	speed: 0.0109s/iter; left time: 75.3454s
Epoch: 8 cost time: 6.530410051345825
Epoch: 8, Steps: 570 | Train Loss: 0.1243899 Vali Loss: 0.0384668 Test Loss: 0.1241978
Validation loss decreased (0.038592 --> 0.038467).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1099533
	speed: 0.0396s/iter; left time: 266.6070s
	iters: 200, epoch: 9 | loss: 0.0833538
	speed: 0.0109s/iter; left time: 72.3045s
	iters: 300, epoch: 9 | loss: 0.1339110
	speed: 0.0109s/iter; left time: 71.2093s
	iters: 400, epoch: 9 | loss: 0.1569254
	speed: 0.0109s/iter; left time: 70.0874s
	iters: 500, epoch: 9 | loss: 0.0781038
	speed: 0.0109s/iter; left time: 69.1190s
Epoch: 9 cost time: 6.561692237854004
Epoch: 9, Steps: 570 | Train Loss: 0.1230334 Vali Loss: 0.0385081 Test Loss: 0.1237361
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1158035
	speed: 0.0379s/iter; left time: 233.6552s
	iters: 200, epoch: 10 | loss: 0.0832513
	speed: 0.0109s/iter; left time: 65.8914s
	iters: 300, epoch: 10 | loss: 0.1323909
	speed: 0.0109s/iter; left time: 64.8823s
	iters: 400, epoch: 10 | loss: 0.0938356
	speed: 0.0109s/iter; left time: 63.9206s
	iters: 500, epoch: 10 | loss: 0.1200961
	speed: 0.0108s/iter; left time: 62.5934s
Epoch: 10 cost time: 6.487656831741333
Epoch: 10, Steps: 570 | Train Loss: 0.1232119 Vali Loss: 0.0384464 Test Loss: 0.1238844
Validation loss decreased (0.038467 --> 0.038446).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.0880294
	speed: 0.0375s/iter; left time: 209.9328s
	iters: 200, epoch: 11 | loss: 0.1333495
	speed: 0.0109s/iter; left time: 59.7905s
	iters: 300, epoch: 11 | loss: 0.1132784
	speed: 0.0108s/iter; left time: 58.5201s
	iters: 400, epoch: 11 | loss: 0.0909003
	speed: 0.0108s/iter; left time: 57.3680s
	iters: 500, epoch: 11 | loss: 0.0962447
	speed: 0.0108s/iter; left time: 56.2935s
Epoch: 11 cost time: 6.49623441696167
Epoch: 11, Steps: 570 | Train Loss: 0.1235934 Vali Loss: 0.0384384 Test Loss: 0.1238350
Validation loss decreased (0.038446 --> 0.038438).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1400836
	speed: 0.0377s/iter; left time: 189.6402s
	iters: 200, epoch: 12 | loss: 0.1498244
	speed: 0.0109s/iter; left time: 53.8549s
	iters: 300, epoch: 12 | loss: 0.1078468
	speed: 0.0109s/iter; left time: 52.7431s
	iters: 400, epoch: 12 | loss: 0.1485666
	speed: 0.0109s/iter; left time: 51.6569s
	iters: 500, epoch: 12 | loss: 0.1239595
	speed: 0.0109s/iter; left time: 50.5666s
Epoch: 12 cost time: 6.543392896652222
Epoch: 12, Steps: 570 | Train Loss: 0.1226309 Vali Loss: 0.0384481 Test Loss: 0.1238305
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.0807109
	speed: 0.0379s/iter; left time: 168.8785s
	iters: 200, epoch: 13 | loss: 0.1681882
	speed: 0.0108s/iter; left time: 47.1445s
	iters: 300, epoch: 13 | loss: 0.0886898
	speed: 0.0108s/iter; left time: 46.0921s
	iters: 400, epoch: 13 | loss: 0.0915739
	speed: 0.0108s/iter; left time: 45.0377s
	iters: 500, epoch: 13 | loss: 0.1158995
	speed: 0.0108s/iter; left time: 44.0430s
Epoch: 13 cost time: 6.503815174102783
Epoch: 13, Steps: 570 | Train Loss: 0.1236351 Vali Loss: 0.0384767 Test Loss: 0.1238470
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1881920
	speed: 0.0390s/iter; left time: 151.8588s
	iters: 200, epoch: 14 | loss: 0.1902320
	speed: 0.0110s/iter; left time: 41.5252s
	iters: 300, epoch: 14 | loss: 0.1145264
	speed: 0.0110s/iter; left time: 40.5510s
	iters: 400, epoch: 14 | loss: 0.1251795
	speed: 0.0110s/iter; left time: 39.4848s
	iters: 500, epoch: 14 | loss: 0.1174224
	speed: 0.0110s/iter; left time: 38.2404s
Epoch: 14 cost time: 6.58145546913147
Epoch: 14, Steps: 570 | Train Loss: 0.1234293 Vali Loss: 0.0384395 Test Loss: 0.1238526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1240076944231987, mae:0.22189994156360626
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2047569
	speed: 0.0260s/iter; left time: 293.4117s
	iters: 200, epoch: 1 | loss: 0.1721311
	speed: 0.0145s/iter; left time: 162.1858s
	iters: 300, epoch: 1 | loss: 0.2918872
	speed: 0.0145s/iter; left time: 160.4213s
	iters: 400, epoch: 1 | loss: 0.1840911
	speed: 0.0145s/iter; left time: 159.0711s
	iters: 500, epoch: 1 | loss: 0.1514521
	speed: 0.0145s/iter; left time: 157.9750s
Epoch: 1 cost time: 9.451337575912476
Epoch: 1, Steps: 570 | Train Loss: 0.2111790 Vali Loss: 0.0435493 Test Loss: 0.1358985
Validation loss decreased (inf --> 0.043549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2041141
	speed: 0.0475s/iter; left time: 509.7456s
	iters: 200, epoch: 2 | loss: 0.1462274
	speed: 0.0145s/iter; left time: 154.3992s
	iters: 300, epoch: 2 | loss: 0.1372207
	speed: 0.0145s/iter; left time: 153.0773s
	iters: 400, epoch: 2 | loss: 0.1192545
	speed: 0.0145s/iter; left time: 151.3126s
	iters: 500, epoch: 2 | loss: 0.1763059
	speed: 0.0145s/iter; left time: 150.0586s
Epoch: 2 cost time: 8.590759515762329
Epoch: 2, Steps: 570 | Train Loss: 0.1698193 Vali Loss: 0.0397341 Test Loss: 0.1301434
Validation loss decreased (0.043549 --> 0.039734).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2607693
	speed: 0.0501s/iter; left time: 509.1628s
	iters: 200, epoch: 3 | loss: 0.1628471
	speed: 0.0163s/iter; left time: 163.5324s
	iters: 300, epoch: 3 | loss: 0.1069581
	speed: 0.0162s/iter; left time: 161.6998s
	iters: 400, epoch: 3 | loss: 0.1171424
	speed: 0.0162s/iter; left time: 160.2218s
	iters: 500, epoch: 3 | loss: 0.1060702
	speed: 0.0163s/iter; left time: 158.6615s
Epoch: 3 cost time: 9.5415780544281
Epoch: 3, Steps: 570 | Train Loss: 0.1490578 Vali Loss: 0.0359175 Test Loss: 0.1201296
Validation loss decreased (0.039734 --> 0.035917).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1515058
	speed: 0.0476s/iter; left time: 456.5381s
	iters: 200, epoch: 4 | loss: 0.1164116
	speed: 0.0145s/iter; left time: 137.9265s
	iters: 300, epoch: 4 | loss: 0.1514658
	speed: 0.0145s/iter; left time: 136.4556s
	iters: 400, epoch: 4 | loss: 0.1478230
	speed: 0.0145s/iter; left time: 135.0452s
	iters: 500, epoch: 4 | loss: 0.1313840
	speed: 0.0145s/iter; left time: 133.5186s
Epoch: 4 cost time: 8.595931053161621
Epoch: 4, Steps: 570 | Train Loss: 0.1398823 Vali Loss: 0.0353378 Test Loss: 0.1230004
Validation loss decreased (0.035917 --> 0.035338).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1263737
	speed: 0.0477s/iter; left time: 430.7195s
	iters: 200, epoch: 5 | loss: 0.1141983
	speed: 0.0145s/iter; left time: 128.9838s
	iters: 300, epoch: 5 | loss: 0.1274197
	speed: 0.0145s/iter; left time: 127.5850s
	iters: 400, epoch: 5 | loss: 0.1358247
	speed: 0.0145s/iter; left time: 126.1657s
	iters: 500, epoch: 5 | loss: 0.1271198
	speed: 0.0145s/iter; left time: 124.6313s
Epoch: 5 cost time: 8.553182125091553
Epoch: 5, Steps: 570 | Train Loss: 0.1352223 Vali Loss: 0.0348664 Test Loss: 0.1199729
Validation loss decreased (0.035338 --> 0.034866).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0976155
	speed: 0.0473s/iter; left time: 400.1051s
	iters: 200, epoch: 6 | loss: 0.1496920
	speed: 0.0145s/iter; left time: 121.2702s
	iters: 300, epoch: 6 | loss: 0.1000441
	speed: 0.0145s/iter; left time: 119.8589s
	iters: 400, epoch: 6 | loss: 0.0984927
	speed: 0.0145s/iter; left time: 118.3952s
	iters: 500, epoch: 6 | loss: 0.1439775
	speed: 0.0145s/iter; left time: 116.9126s
Epoch: 6 cost time: 8.625679969787598
Epoch: 6, Steps: 570 | Train Loss: 0.1312461 Vali Loss: 0.0346095 Test Loss: 0.1215637
Validation loss decreased (0.034866 --> 0.034610).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1307121
	speed: 0.0488s/iter; left time: 384.2000s
	iters: 200, epoch: 7 | loss: 0.1020568
	speed: 0.0162s/iter; left time: 126.3758s
	iters: 300, epoch: 7 | loss: 0.1043422
	speed: 0.0162s/iter; left time: 124.7740s
	iters: 400, epoch: 7 | loss: 0.1314693
	speed: 0.0162s/iter; left time: 123.1365s
	iters: 500, epoch: 7 | loss: 0.2119968
	speed: 0.0163s/iter; left time: 122.1376s
Epoch: 7 cost time: 9.65189504623413
Epoch: 7, Steps: 570 | Train Loss: 0.1305236 Vali Loss: 0.0346760 Test Loss: 0.1211119
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1867866
	speed: 0.0465s/iter; left time: 340.2264s
	iters: 200, epoch: 8 | loss: 0.1295784
	speed: 0.0144s/iter; left time: 103.7992s
	iters: 300, epoch: 8 | loss: 0.1420640
	speed: 0.0144s/iter; left time: 102.5519s
	iters: 400, epoch: 8 | loss: 0.0948894
	speed: 0.0144s/iter; left time: 101.1137s
	iters: 500, epoch: 8 | loss: 0.1524995
	speed: 0.0144s/iter; left time: 99.5629s
Epoch: 8 cost time: 8.485867023468018
Epoch: 8, Steps: 570 | Train Loss: 0.1304179 Vali Loss: 0.0348385 Test Loss: 0.1214825
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1644307
	speed: 0.0502s/iter; left time: 338.2019s
	iters: 200, epoch: 9 | loss: 0.1492928
	speed: 0.0162s/iter; left time: 107.7062s
	iters: 300, epoch: 9 | loss: 0.1900343
	speed: 0.0157s/iter; left time: 102.8160s
	iters: 400, epoch: 9 | loss: 0.1507646
	speed: 0.0143s/iter; left time: 92.3838s
	iters: 500, epoch: 9 | loss: 0.1052462
	speed: 0.0144s/iter; left time: 91.1764s
Epoch: 9 cost time: 8.986774444580078
Epoch: 9, Steps: 570 | Train Loss: 0.1295061 Vali Loss: 0.0347421 Test Loss: 0.1210433
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12174582481384277, mae:0.21724450588226318
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2714466
	speed: 0.0282s/iter; left time: 318.7579s
	iters: 200, epoch: 1 | loss: 0.1833450
	speed: 0.0161s/iter; left time: 180.6746s
	iters: 300, epoch: 1 | loss: 0.1116743
	speed: 0.0161s/iter; left time: 179.0634s
	iters: 400, epoch: 1 | loss: 0.2457210
	speed: 0.0161s/iter; left time: 177.4160s
	iters: 500, epoch: 1 | loss: 0.1758959
	speed: 0.0161s/iter; left time: 175.6195s
Epoch: 1 cost time: 10.447259187698364
Epoch: 1, Steps: 570 | Train Loss: 0.1832130 Vali Loss: 0.0354777 Test Loss: 0.1102525
Validation loss decreased (inf --> 0.035478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1255521
	speed: 0.0489s/iter; left time: 525.1447s
	iters: 200, epoch: 2 | loss: 0.2327390
	speed: 0.0154s/iter; left time: 164.0590s
	iters: 300, epoch: 2 | loss: 0.1772514
	speed: 0.0161s/iter; left time: 170.0402s
	iters: 400, epoch: 2 | loss: 0.1205304
	speed: 0.0161s/iter; left time: 167.7539s
	iters: 500, epoch: 2 | loss: 0.1233689
	speed: 0.0161s/iter; left time: 166.4049s
Epoch: 2 cost time: 9.429375886917114
Epoch: 2, Steps: 570 | Train Loss: 0.1506715 Vali Loss: 0.0339201 Test Loss: 0.1126614
Validation loss decreased (0.035478 --> 0.033920).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1473355
	speed: 0.0470s/iter; left time: 477.8686s
	iters: 200, epoch: 3 | loss: 0.0864547
	speed: 0.0143s/iter; left time: 143.9958s
	iters: 300, epoch: 3 | loss: 0.1745018
	speed: 0.0143s/iter; left time: 142.2864s
	iters: 400, epoch: 3 | loss: 0.1090745
	speed: 0.0143s/iter; left time: 140.5964s
	iters: 500, epoch: 3 | loss: 0.1212042
	speed: 0.0142s/iter; left time: 139.0582s
Epoch: 3 cost time: 8.439759731292725
Epoch: 3, Steps: 570 | Train Loss: 0.1344462 Vali Loss: 0.0329960 Test Loss: 0.1109708
Validation loss decreased (0.033920 --> 0.032996).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1262608
	speed: 0.0474s/iter; left time: 454.4113s
	iters: 200, epoch: 4 | loss: 0.1213391
	speed: 0.0143s/iter; left time: 135.3385s
	iters: 300, epoch: 4 | loss: 0.1373242
	speed: 0.0143s/iter; left time: 134.2154s
	iters: 400, epoch: 4 | loss: 0.0776137
	speed: 0.0143s/iter; left time: 132.8094s
	iters: 500, epoch: 4 | loss: 0.0916152
	speed: 0.0143s/iter; left time: 131.4924s
Epoch: 4 cost time: 8.468201875686646
Epoch: 4, Steps: 570 | Train Loss: 0.1285917 Vali Loss: 0.0319500 Test Loss: 0.1105838
Validation loss decreased (0.032996 --> 0.031950).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0646266
	speed: 0.0453s/iter; left time: 408.4127s
	iters: 200, epoch: 5 | loss: 0.1230586
	speed: 0.0143s/iter; left time: 127.7471s
	iters: 300, epoch: 5 | loss: 0.1696747
	speed: 0.0143s/iter; left time: 126.3821s
	iters: 400, epoch: 5 | loss: 0.1049808
	speed: 0.0143s/iter; left time: 124.9197s
	iters: 500, epoch: 5 | loss: 0.1418797
	speed: 0.0143s/iter; left time: 123.3858s
Epoch: 5 cost time: 8.43315052986145
Epoch: 5, Steps: 570 | Train Loss: 0.1240557 Vali Loss: 0.0317498 Test Loss: 0.1098400
Validation loss decreased (0.031950 --> 0.031750).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1115341
	speed: 0.0466s/iter; left time: 393.9493s
	iters: 200, epoch: 6 | loss: 0.2230012
	speed: 0.0143s/iter; left time: 119.4400s
	iters: 300, epoch: 6 | loss: 0.1876464
	speed: 0.0143s/iter; left time: 118.0569s
	iters: 400, epoch: 6 | loss: 0.1356148
	speed: 0.0143s/iter; left time: 116.3375s
	iters: 500, epoch: 6 | loss: 0.1370379
	speed: 0.0143s/iter; left time: 114.9026s
Epoch: 6 cost time: 8.418618440628052
Epoch: 6, Steps: 570 | Train Loss: 0.1222151 Vali Loss: 0.0315075 Test Loss: 0.1099989
Validation loss decreased (0.031750 --> 0.031507).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0917359
	speed: 0.0474s/iter; left time: 373.4032s
	iters: 200, epoch: 7 | loss: 0.1327952
	speed: 0.0142s/iter; left time: 110.8711s
	iters: 300, epoch: 7 | loss: 0.1693450
	speed: 0.0143s/iter; left time: 109.5829s
	iters: 400, epoch: 7 | loss: 0.1225072
	speed: 0.0142s/iter; left time: 107.8454s
	iters: 500, epoch: 7 | loss: 0.1464634
	speed: 0.0143s/iter; left time: 106.6227s
Epoch: 7 cost time: 8.394713163375854
Epoch: 7, Steps: 570 | Train Loss: 0.1204937 Vali Loss: 0.0312481 Test Loss: 0.1096683
Validation loss decreased (0.031507 --> 0.031248).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0855149
	speed: 0.0450s/iter; left time: 329.2351s
	iters: 200, epoch: 8 | loss: 0.1063012
	speed: 0.0143s/iter; left time: 103.0597s
	iters: 300, epoch: 8 | loss: 0.1573913
	speed: 0.0143s/iter; left time: 101.6298s
	iters: 400, epoch: 8 | loss: 0.1176097
	speed: 0.0143s/iter; left time: 100.2037s
	iters: 500, epoch: 8 | loss: 0.1097314
	speed: 0.0143s/iter; left time: 98.7342s
Epoch: 8 cost time: 8.43489694595337
Epoch: 8, Steps: 570 | Train Loss: 0.1196738 Vali Loss: 0.0313694 Test Loss: 0.1097663
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0974496
	speed: 0.0476s/iter; left time: 320.5712s
	iters: 200, epoch: 9 | loss: 0.1121854
	speed: 0.0143s/iter; left time: 94.9717s
	iters: 300, epoch: 9 | loss: 0.1125480
	speed: 0.0143s/iter; left time: 93.6465s
	iters: 400, epoch: 9 | loss: 0.0968294
	speed: 0.0143s/iter; left time: 91.8920s
	iters: 500, epoch: 9 | loss: 0.1291035
	speed: 0.0143s/iter; left time: 90.4439s
Epoch: 9 cost time: 8.423711061477661
Epoch: 9, Steps: 570 | Train Loss: 0.1191862 Vali Loss: 0.0312849 Test Loss: 0.1098480
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1136008
	speed: 0.0468s/iter; left time: 288.7689s
	iters: 200, epoch: 10 | loss: 0.1118148
	speed: 0.0143s/iter; left time: 86.6982s
	iters: 300, epoch: 10 | loss: 0.1124306
	speed: 0.0143s/iter; left time: 85.1577s
	iters: 400, epoch: 10 | loss: 0.1297452
	speed: 0.0142s/iter; left time: 83.5469s
	iters: 500, epoch: 10 | loss: 0.1475537
	speed: 0.0143s/iter; left time: 82.2688s
Epoch: 10 cost time: 8.417852640151978
Epoch: 10, Steps: 570 | Train Loss: 0.1196228 Vali Loss: 0.0313251 Test Loss: 0.1098910
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.10982311517000198, mae:0.20000316202640533
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1340132
	speed: 0.0279s/iter; left time: 315.6928s
	iters: 200, epoch: 1 | loss: 0.2731330
	speed: 0.0161s/iter; left time: 179.9575s
	iters: 300, epoch: 1 | loss: 0.2700988
	speed: 0.0160s/iter; left time: 178.1332s
	iters: 400, epoch: 1 | loss: 0.2357663
	speed: 0.0161s/iter; left time: 176.6694s
	iters: 500, epoch: 1 | loss: 0.2441259
	speed: 0.0160s/iter; left time: 174.9165s
Epoch: 1 cost time: 10.319015741348267
Epoch: 1, Steps: 570 | Train Loss: 0.2175356 Vali Loss: 0.0434821 Test Loss: 0.1324463
Validation loss decreased (inf --> 0.043482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1540688
	speed: 0.0474s/iter; left time: 509.0747s
	iters: 200, epoch: 2 | loss: 0.1154824
	speed: 0.0142s/iter; left time: 151.4273s
	iters: 300, epoch: 2 | loss: 0.1036720
	speed: 0.0149s/iter; left time: 157.2018s
	iters: 400, epoch: 2 | loss: 0.1394471
	speed: 0.0164s/iter; left time: 171.1589s
	iters: 500, epoch: 2 | loss: 0.2109354
	speed: 0.0164s/iter; left time: 169.1343s
Epoch: 2 cost time: 9.077941179275513
Epoch: 2, Steps: 570 | Train Loss: 0.1765220 Vali Loss: 0.0419425 Test Loss: 0.1278307
Validation loss decreased (0.043482 --> 0.041942).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1866744
	speed: 0.0519s/iter; left time: 527.2743s
	iters: 200, epoch: 3 | loss: 0.1807503
	speed: 0.0164s/iter; left time: 165.0974s
	iters: 300, epoch: 3 | loss: 0.1508223
	speed: 0.0164s/iter; left time: 163.6765s
	iters: 400, epoch: 3 | loss: 0.1283116
	speed: 0.0164s/iter; left time: 161.7852s
	iters: 500, epoch: 3 | loss: 0.1517522
	speed: 0.0164s/iter; left time: 160.3386s
Epoch: 3 cost time: 9.642561197280884
Epoch: 3, Steps: 570 | Train Loss: 0.1552826 Vali Loss: 0.0393618 Test Loss: 0.1237901
Validation loss decreased (0.041942 --> 0.039362).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1693730
	speed: 0.0510s/iter; left time: 489.0691s
	iters: 200, epoch: 4 | loss: 0.1441906
	speed: 0.0166s/iter; left time: 157.4760s
	iters: 300, epoch: 4 | loss: 0.1830863
	speed: 0.0165s/iter; left time: 155.2422s
	iters: 400, epoch: 4 | loss: 0.1477285
	speed: 0.0165s/iter; left time: 153.5429s
	iters: 500, epoch: 4 | loss: 0.1046303
	speed: 0.0165s/iter; left time: 151.8226s
Epoch: 4 cost time: 9.749010562896729
Epoch: 4, Steps: 570 | Train Loss: 0.1463910 Vali Loss: 0.0377049 Test Loss: 0.1226720
Validation loss decreased (0.039362 --> 0.037705).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1406279
	speed: 0.0496s/iter; left time: 447.0917s
	iters: 200, epoch: 5 | loss: 0.1610852
	speed: 0.0143s/iter; left time: 127.7083s
	iters: 300, epoch: 5 | loss: 0.1367887
	speed: 0.0143s/iter; left time: 126.2480s
	iters: 400, epoch: 5 | loss: 0.1876882
	speed: 0.0143s/iter; left time: 124.9413s
	iters: 500, epoch: 5 | loss: 0.1052222
	speed: 0.0143s/iter; left time: 123.6347s
Epoch: 5 cost time: 8.63890266418457
Epoch: 5, Steps: 570 | Train Loss: 0.1414276 Vali Loss: 0.0380426 Test Loss: 0.1222891
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2116309
	speed: 0.0462s/iter; left time: 390.4115s
	iters: 200, epoch: 6 | loss: 0.1298434
	speed: 0.0163s/iter; left time: 136.3929s
	iters: 300, epoch: 6 | loss: 0.0935109
	speed: 0.0164s/iter; left time: 135.1040s
	iters: 400, epoch: 6 | loss: 0.1730927
	speed: 0.0163s/iter; left time: 133.1878s
	iters: 500, epoch: 6 | loss: 0.1374914
	speed: 0.0164s/iter; left time: 131.7060s
Epoch: 6 cost time: 9.425790309906006
Epoch: 6, Steps: 570 | Train Loss: 0.1391261 Vali Loss: 0.0377288 Test Loss: 0.1226217
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1686033
	speed: 0.0486s/iter; left time: 383.3123s
	iters: 200, epoch: 7 | loss: 0.0903399
	speed: 0.0161s/iter; left time: 125.0860s
	iters: 300, epoch: 7 | loss: 0.1061012
	speed: 0.0154s/iter; left time: 118.1236s
	iters: 400, epoch: 7 | loss: 0.1717959
	speed: 0.0143s/iter; left time: 108.1807s
	iters: 500, epoch: 7 | loss: 0.1215039
	speed: 0.0143s/iter; left time: 106.9074s
Epoch: 7 cost time: 8.920162916183472
Epoch: 7, Steps: 570 | Train Loss: 0.1389024 Vali Loss: 0.0375392 Test Loss: 0.1220629
Validation loss decreased (0.037705 --> 0.037539).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1050478
	speed: 0.0464s/iter; left time: 339.4073s
	iters: 200, epoch: 8 | loss: 0.1073643
	speed: 0.0143s/iter; left time: 103.2432s
	iters: 300, epoch: 8 | loss: 0.1274797
	speed: 0.0143s/iter; left time: 101.7857s
	iters: 400, epoch: 8 | loss: 0.1463042
	speed: 0.0143s/iter; left time: 100.3137s
	iters: 500, epoch: 8 | loss: 0.1025157
	speed: 0.0143s/iter; left time: 98.8370s
Epoch: 8 cost time: 8.488332986831665
Epoch: 8, Steps: 570 | Train Loss: 0.1376869 Vali Loss: 0.0380538 Test Loss: 0.1229385
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1774512
	speed: 0.0480s/iter; left time: 323.5725s
	iters: 200, epoch: 9 | loss: 0.1372954
	speed: 0.0164s/iter; left time: 108.7852s
	iters: 300, epoch: 9 | loss: 0.0735341
	speed: 0.0165s/iter; left time: 107.7589s
	iters: 400, epoch: 9 | loss: 0.1188553
	speed: 0.0165s/iter; left time: 106.5614s
	iters: 500, epoch: 9 | loss: 0.1156157
	speed: 0.0165s/iter; left time: 104.4837s
Epoch: 9 cost time: 9.6681649684906
Epoch: 9, Steps: 570 | Train Loss: 0.1363195 Vali Loss: 0.0376753 Test Loss: 0.1227020
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1548845
	speed: 0.0473s/iter; left time: 292.0595s
	iters: 200, epoch: 10 | loss: 0.1635989
	speed: 0.0144s/iter; left time: 87.4624s
	iters: 300, epoch: 10 | loss: 0.1354944
	speed: 0.0144s/iter; left time: 86.0314s
	iters: 400, epoch: 10 | loss: 0.1608072
	speed: 0.0144s/iter; left time: 84.5541s
	iters: 500, epoch: 10 | loss: 0.1307496
	speed: 0.0144s/iter; left time: 83.3068s
Epoch: 10 cost time: 8.510529518127441
Epoch: 10, Steps: 570 | Train Loss: 0.1368901 Vali Loss: 0.0376425 Test Loss: 0.1224218
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.12225611507892609, mae:0.21893946826457977
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2642496
	speed: 0.0302s/iter; left time: 341.5997s
	iters: 200, epoch: 1 | loss: 0.1672373
	speed: 0.0168s/iter; left time: 188.4413s
	iters: 300, epoch: 1 | loss: 0.2110314
	speed: 0.0168s/iter; left time: 186.7510s
	iters: 400, epoch: 1 | loss: 0.1752806
	speed: 0.0168s/iter; left time: 185.1820s
	iters: 500, epoch: 1 | loss: 0.1534884
	speed: 0.0169s/iter; left time: 183.7136s
Epoch: 1 cost time: 10.980354309082031
Epoch: 1, Steps: 570 | Train Loss: 0.2048573 Vali Loss: 0.0442407 Test Loss: 0.1334456
Validation loss decreased (inf --> 0.044241).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1922308
	speed: 0.0523s/iter; left time: 561.4676s
	iters: 200, epoch: 2 | loss: 0.1989005
	speed: 0.0170s/iter; left time: 180.2659s
	iters: 300, epoch: 2 | loss: 0.1904143
	speed: 0.0169s/iter; left time: 177.9666s
	iters: 400, epoch: 2 | loss: 0.1112681
	speed: 0.0169s/iter; left time: 176.2745s
	iters: 500, epoch: 2 | loss: 0.1280198
	speed: 0.0169s/iter; left time: 174.7552s
Epoch: 2 cost time: 9.96340560913086
Epoch: 2, Steps: 570 | Train Loss: 0.1616140 Vali Loss: 0.0378118 Test Loss: 0.1226735
Validation loss decreased (0.044241 --> 0.037812).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1237671
	speed: 0.0508s/iter; left time: 515.9404s
	iters: 200, epoch: 3 | loss: 0.1354339
	speed: 0.0169s/iter; left time: 169.5458s
	iters: 300, epoch: 3 | loss: 0.2374647
	speed: 0.0168s/iter; left time: 167.8121s
	iters: 400, epoch: 3 | loss: 0.1247521
	speed: 0.0169s/iter; left time: 166.3438s
	iters: 500, epoch: 3 | loss: 0.0987477
	speed: 0.0169s/iter; left time: 164.5028s
Epoch: 3 cost time: 9.898221492767334
Epoch: 3, Steps: 570 | Train Loss: 0.1346405 Vali Loss: 0.0368421 Test Loss: 0.1211564
Validation loss decreased (0.037812 --> 0.036842).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0937603
	speed: 0.0518s/iter; left time: 497.1729s
	iters: 200, epoch: 4 | loss: 0.1194085
	speed: 0.0171s/iter; left time: 162.0807s
	iters: 300, epoch: 4 | loss: 0.1261603
	speed: 0.0169s/iter; left time: 159.0545s
	iters: 400, epoch: 4 | loss: 0.1470387
	speed: 0.0169s/iter; left time: 157.3541s
	iters: 500, epoch: 4 | loss: 0.1260980
	speed: 0.0180s/iter; left time: 165.4955s
Epoch: 4 cost time: 10.345334529876709
Epoch: 4, Steps: 570 | Train Loss: 0.1197446 Vali Loss: 0.0364672 Test Loss: 0.1205641
Validation loss decreased (0.036842 --> 0.036467).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0868400
	speed: 0.0518s/iter; left time: 467.4152s
	iters: 200, epoch: 5 | loss: 0.1205349
	speed: 0.0169s/iter; left time: 151.1517s
	iters: 300, epoch: 5 | loss: 0.1141921
	speed: 0.0169s/iter; left time: 149.4298s
	iters: 400, epoch: 5 | loss: 0.1284914
	speed: 0.0169s/iter; left time: 147.6132s
	iters: 500, epoch: 5 | loss: 0.0882356
	speed: 0.0169s/iter; left time: 145.8724s
Epoch: 5 cost time: 9.9378342628479
Epoch: 5, Steps: 570 | Train Loss: 0.1131571 Vali Loss: 0.0348938 Test Loss: 0.1195340
Validation loss decreased (0.036467 --> 0.034894).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1147439
	speed: 0.0509s/iter; left time: 429.9195s
	iters: 200, epoch: 6 | loss: 0.0958291
	speed: 0.0169s/iter; left time: 141.0050s
	iters: 300, epoch: 6 | loss: 0.1061931
	speed: 0.0169s/iter; left time: 139.1984s
	iters: 400, epoch: 6 | loss: 0.1339055
	speed: 0.0169s/iter; left time: 137.6319s
	iters: 500, epoch: 6 | loss: 0.1064150
	speed: 0.0169s/iter; left time: 135.8044s
Epoch: 6 cost time: 9.927862167358398
Epoch: 6, Steps: 570 | Train Loss: 0.1091125 Vali Loss: 0.0349584 Test Loss: 0.1170439
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1292955
	speed: 0.0503s/iter; left time: 396.2937s
	iters: 200, epoch: 7 | loss: 0.1387319
	speed: 0.0169s/iter; left time: 131.4405s
	iters: 300, epoch: 7 | loss: 0.1260076
	speed: 0.0169s/iter; left time: 129.6388s
	iters: 400, epoch: 7 | loss: 0.0798721
	speed: 0.0169s/iter; left time: 127.9866s
	iters: 500, epoch: 7 | loss: 0.0855768
	speed: 0.0169s/iter; left time: 126.3074s
Epoch: 7 cost time: 9.940653562545776
Epoch: 7, Steps: 570 | Train Loss: 0.1072664 Vali Loss: 0.0340650 Test Loss: 0.1183059
Validation loss decreased (0.034894 --> 0.034065).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0993857
	speed: 0.0518s/iter; left time: 378.9113s
	iters: 200, epoch: 8 | loss: 0.0821224
	speed: 0.0169s/iter; left time: 121.9947s
	iters: 300, epoch: 8 | loss: 0.1028370
	speed: 0.0169s/iter; left time: 120.3873s
	iters: 400, epoch: 8 | loss: 0.0694930
	speed: 0.0169s/iter; left time: 118.6302s
	iters: 500, epoch: 8 | loss: 0.0738068
	speed: 0.0169s/iter; left time: 116.8483s
Epoch: 8 cost time: 9.95321798324585
Epoch: 8, Steps: 570 | Train Loss: 0.1070141 Vali Loss: 0.0343289 Test Loss: 0.1180926
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0767808
	speed: 0.0498s/iter; left time: 336.0337s
	iters: 200, epoch: 9 | loss: 0.0842962
	speed: 0.0169s/iter; left time: 112.0541s
	iters: 300, epoch: 9 | loss: 0.0946802
	speed: 0.0169s/iter; left time: 110.3749s
	iters: 400, epoch: 9 | loss: 0.0880783
	speed: 0.0169s/iter; left time: 108.5552s
	iters: 500, epoch: 9 | loss: 0.1501595
	speed: 0.0169s/iter; left time: 106.9095s
Epoch: 9 cost time: 9.906736612319946
Epoch: 9, Steps: 570 | Train Loss: 0.1058018 Vali Loss: 0.0342370 Test Loss: 0.1178512
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1148590
	speed: 0.0507s/iter; left time: 313.1653s
	iters: 200, epoch: 10 | loss: 0.0611055
	speed: 0.0169s/iter; left time: 102.7823s
	iters: 300, epoch: 10 | loss: 0.1586422
	speed: 0.0169s/iter; left time: 101.0901s
	iters: 400, epoch: 10 | loss: 0.0999018
	speed: 0.0169s/iter; left time: 99.3769s
	iters: 500, epoch: 10 | loss: 0.0855434
	speed: 0.0169s/iter; left time: 97.7803s
Epoch: 10 cost time: 9.921478748321533
Epoch: 10, Steps: 570 | Train Loss: 0.1060700 Vali Loss: 0.0345414 Test Loss: 0.1175926
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.1184559091925621, mae:0.21707218885421753
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1555285
	speed: 0.0301s/iter; left time: 339.9116s
	iters: 200, epoch: 1 | loss: 0.1058938
	speed: 0.0179s/iter; left time: 200.5435s
	iters: 300, epoch: 1 | loss: 0.1976846
	speed: 0.0179s/iter; left time: 198.7343s
	iters: 400, epoch: 1 | loss: 0.1717134
	speed: 0.0179s/iter; left time: 197.4091s
	iters: 500, epoch: 1 | loss: 0.1015578
	speed: 0.0179s/iter; left time: 195.5389s
Epoch: 1 cost time: 11.491021156311035
Epoch: 1, Steps: 570 | Train Loss: 0.1783853 Vali Loss: 0.0342684 Test Loss: 0.1115713
Validation loss decreased (inf --> 0.034268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1322298
	speed: 0.0543s/iter; left time: 582.1629s
	iters: 200, epoch: 2 | loss: 0.1116886
	speed: 0.0179s/iter; left time: 190.5898s
	iters: 300, epoch: 2 | loss: 0.2077729
	speed: 0.0177s/iter; left time: 185.9355s
	iters: 400, epoch: 2 | loss: 0.1784001
	speed: 0.0163s/iter; left time: 170.1066s
	iters: 500, epoch: 2 | loss: 0.1166745
	speed: 0.0163s/iter; left time: 168.4049s
Epoch: 2 cost time: 10.06808614730835
Epoch: 2, Steps: 570 | Train Loss: 0.1438919 Vali Loss: 0.0351572 Test Loss: 0.1138219
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1210392
	speed: 0.0494s/iter; left time: 501.7495s
	iters: 200, epoch: 3 | loss: 0.1237201
	speed: 0.0164s/iter; left time: 165.2665s
	iters: 300, epoch: 3 | loss: 0.1078374
	speed: 0.0164s/iter; left time: 163.6087s
	iters: 400, epoch: 3 | loss: 0.1568393
	speed: 0.0164s/iter; left time: 161.9879s
	iters: 500, epoch: 3 | loss: 0.0859967
	speed: 0.0164s/iter; left time: 160.4602s
Epoch: 3 cost time: 9.665194988250732
Epoch: 3, Steps: 570 | Train Loss: 0.1227649 Vali Loss: 0.0325438 Test Loss: 0.1098657
Validation loss decreased (0.034268 --> 0.032544).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1230057
	speed: 0.0524s/iter; left time: 502.3770s
	iters: 200, epoch: 4 | loss: 0.1713229
	speed: 0.0180s/iter; left time: 171.2377s
	iters: 300, epoch: 4 | loss: 0.0925769
	speed: 0.0180s/iter; left time: 169.1057s
	iters: 400, epoch: 4 | loss: 0.0831985
	speed: 0.0180s/iter; left time: 167.3569s
	iters: 500, epoch: 4 | loss: 0.1476100
	speed: 0.0180s/iter; left time: 165.8809s
Epoch: 4 cost time: 10.598434209823608
Epoch: 4, Steps: 570 | Train Loss: 0.1103549 Vali Loss: 0.0322846 Test Loss: 0.1100513
Validation loss decreased (0.032544 --> 0.032285).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1093887
	speed: 0.0537s/iter; left time: 484.2527s
	iters: 200, epoch: 5 | loss: 0.1200557
	speed: 0.0180s/iter; left time: 160.3581s
	iters: 300, epoch: 5 | loss: 0.1096876
	speed: 0.0180s/iter; left time: 158.3592s
	iters: 400, epoch: 5 | loss: 0.0723158
	speed: 0.0180s/iter; left time: 156.6069s
	iters: 500, epoch: 5 | loss: 0.1374758
	speed: 0.0180s/iter; left time: 154.7481s
Epoch: 5 cost time: 10.53821587562561
Epoch: 5, Steps: 570 | Train Loss: 0.1053676 Vali Loss: 0.0319508 Test Loss: 0.1103467
Validation loss decreased (0.032285 --> 0.031951).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0999631
	speed: 0.0542s/iter; left time: 457.9758s
	iters: 200, epoch: 6 | loss: 0.1338409
	speed: 0.0180s/iter; left time: 150.1585s
	iters: 300, epoch: 6 | loss: 0.1689444
	speed: 0.0180s/iter; left time: 148.4268s
	iters: 400, epoch: 6 | loss: 0.1071086
	speed: 0.0180s/iter; left time: 146.6259s
	iters: 500, epoch: 6 | loss: 0.1048287
	speed: 0.0180s/iter; left time: 144.5680s
Epoch: 6 cost time: 10.576935291290283
Epoch: 6, Steps: 570 | Train Loss: 0.1028331 Vali Loss: 0.0320684 Test Loss: 0.1101003
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1261138
	speed: 0.0549s/iter; left time: 432.6900s
	iters: 200, epoch: 7 | loss: 0.0776426
	speed: 0.0180s/iter; left time: 140.1582s
	iters: 300, epoch: 7 | loss: 0.0916797
	speed: 0.0180s/iter; left time: 138.3997s
	iters: 400, epoch: 7 | loss: 0.1496750
	speed: 0.0168s/iter; left time: 127.4012s
	iters: 500, epoch: 7 | loss: 0.0992560
	speed: 0.0164s/iter; left time: 122.5777s
Epoch: 7 cost time: 10.1607186794281
Epoch: 7, Steps: 570 | Train Loss: 0.1012986 Vali Loss: 0.0322577 Test Loss: 0.1099045
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0672307
	speed: 0.0505s/iter; left time: 369.3203s
	iters: 200, epoch: 8 | loss: 0.1146743
	speed: 0.0179s/iter; left time: 129.0838s
	iters: 300, epoch: 8 | loss: 0.1142103
	speed: 0.0179s/iter; left time: 127.2680s
	iters: 400, epoch: 8 | loss: 0.1174164
	speed: 0.0180s/iter; left time: 126.0899s
	iters: 500, epoch: 8 | loss: 0.0964760
	speed: 0.0180s/iter; left time: 124.4794s
Epoch: 8 cost time: 10.541171789169312
Epoch: 8, Steps: 570 | Train Loss: 0.0999613 Vali Loss: 0.0321173 Test Loss: 0.1101281
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.11049826443195343, mae:0.2042028158903122
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.2063830
	speed: 0.0291s/iter; left time: 329.3293s
	iters: 200, epoch: 1 | loss: 0.1870340
	speed: 0.0167s/iter; left time: 187.3994s
	iters: 300, epoch: 1 | loss: 0.1797046
	speed: 0.0154s/iter; left time: 170.8527s
	iters: 400, epoch: 1 | loss: 0.1959289
	speed: 0.0154s/iter; left time: 169.1877s
	iters: 500, epoch: 1 | loss: 0.3154422
	speed: 0.0154s/iter; left time: 168.0261s
Epoch: 1 cost time: 10.338882446289062
Epoch: 1, Steps: 570 | Train Loss: 0.2134551 Vali Loss: 0.0435308 Test Loss: 0.1349582
Validation loss decreased (inf --> 0.043531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2284414
	speed: 0.0485s/iter; left time: 520.7385s
	iters: 200, epoch: 2 | loss: 0.1208357
	speed: 0.0153s/iter; left time: 162.9941s
	iters: 300, epoch: 2 | loss: 0.1812132
	speed: 0.0153s/iter; left time: 161.2311s
	iters: 400, epoch: 2 | loss: 0.1583438
	speed: 0.0153s/iter; left time: 159.9648s
	iters: 500, epoch: 2 | loss: 0.2020065
	speed: 0.0153s/iter; left time: 158.4763s
Epoch: 2 cost time: 9.057844161987305
Epoch: 2, Steps: 570 | Train Loss: 0.1656884 Vali Loss: 0.0411948 Test Loss: 0.1304179
Validation loss decreased (0.043531 --> 0.041195).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1608097
	speed: 0.0503s/iter; left time: 510.7273s
	iters: 200, epoch: 3 | loss: 0.0874227
	speed: 0.0154s/iter; left time: 155.0900s
	iters: 300, epoch: 3 | loss: 0.1694377
	speed: 0.0154s/iter; left time: 153.4541s
	iters: 400, epoch: 3 | loss: 0.1177407
	speed: 0.0154s/iter; left time: 151.7225s
	iters: 500, epoch: 3 | loss: 0.1368724
	speed: 0.0154s/iter; left time: 150.1399s
Epoch: 3 cost time: 9.103183269500732
Epoch: 3, Steps: 570 | Train Loss: 0.1359576 Vali Loss: 0.0376442 Test Loss: 0.1299606
Validation loss decreased (0.041195 --> 0.037644).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0844448
	speed: 0.0497s/iter; left time: 477.0565s
	iters: 200, epoch: 4 | loss: 0.1618553
	speed: 0.0154s/iter; left time: 146.3004s
	iters: 300, epoch: 4 | loss: 0.1517792
	speed: 0.0154s/iter; left time: 144.5426s
	iters: 400, epoch: 4 | loss: 0.1055960
	speed: 0.0154s/iter; left time: 143.1420s
	iters: 500, epoch: 4 | loss: 0.1550536
	speed: 0.0154s/iter; left time: 141.9377s
Epoch: 4 cost time: 9.098902702331543
Epoch: 4, Steps: 570 | Train Loss: 0.1223496 Vali Loss: 0.0364399 Test Loss: 0.1311539
Validation loss decreased (0.037644 --> 0.036440).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1185952
	speed: 0.0503s/iter; left time: 454.0731s
	iters: 200, epoch: 5 | loss: 0.0921470
	speed: 0.0154s/iter; left time: 137.7245s
	iters: 300, epoch: 5 | loss: 0.0994880
	speed: 0.0154s/iter; left time: 135.9234s
	iters: 400, epoch: 5 | loss: 0.0897295
	speed: 0.0155s/iter; left time: 134.8051s
	iters: 500, epoch: 5 | loss: 0.0979272
	speed: 0.0154s/iter; left time: 132.7243s
Epoch: 5 cost time: 9.12540054321289
Epoch: 5, Steps: 570 | Train Loss: 0.1141438 Vali Loss: 0.0361733 Test Loss: 0.1294257
Validation loss decreased (0.036440 --> 0.036173).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0919634
	speed: 0.0491s/iter; left time: 414.8060s
	iters: 200, epoch: 6 | loss: 0.0713519
	speed: 0.0160s/iter; left time: 133.9540s
	iters: 300, epoch: 6 | loss: 0.0640771
	speed: 0.0170s/iter; left time: 140.4026s
	iters: 400, epoch: 6 | loss: 0.0877847
	speed: 0.0170s/iter; left time: 138.7133s
	iters: 500, epoch: 6 | loss: 0.0983191
	speed: 0.0170s/iter; left time: 136.7859s
Epoch: 6 cost time: 9.811263799667358
Epoch: 6, Steps: 570 | Train Loss: 0.1107003 Vali Loss: 0.0353952 Test Loss: 0.1319505
Validation loss decreased (0.036173 --> 0.035395).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1243195
	speed: 0.0499s/iter; left time: 392.8872s
	iters: 200, epoch: 7 | loss: 0.0919826
	speed: 0.0154s/iter; left time: 119.7491s
	iters: 300, epoch: 7 | loss: 0.1036018
	speed: 0.0154s/iter; left time: 118.3657s
	iters: 400, epoch: 7 | loss: 0.1400468
	speed: 0.0154s/iter; left time: 116.7107s
	iters: 500, epoch: 7 | loss: 0.1277194
	speed: 0.0154s/iter; left time: 114.9853s
Epoch: 7 cost time: 9.076128244400024
Epoch: 7, Steps: 570 | Train Loss: 0.1090898 Vali Loss: 0.0352193 Test Loss: 0.1302587
Validation loss decreased (0.035395 --> 0.035219).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0812892
	speed: 0.0488s/iter; left time: 356.5319s
	iters: 200, epoch: 8 | loss: 0.1107979
	speed: 0.0159s/iter; left time: 114.4833s
	iters: 300, epoch: 8 | loss: 0.0703831
	speed: 0.0176s/iter; left time: 125.4983s
	iters: 400, epoch: 8 | loss: 0.1055723
	speed: 0.0176s/iter; left time: 123.5370s
	iters: 500, epoch: 8 | loss: 0.0826987
	speed: 0.0176s/iter; left time: 121.7786s
Epoch: 8 cost time: 9.951010465621948
Epoch: 8, Steps: 570 | Train Loss: 0.1076544 Vali Loss: 0.0354851 Test Loss: 0.1311845
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0923762
	speed: 0.0511s/iter; left time: 344.1977s
	iters: 200, epoch: 9 | loss: 0.0993528
	speed: 0.0159s/iter; left time: 105.8591s
	iters: 300, epoch: 9 | loss: 0.1253577
	speed: 0.0153s/iter; left time: 100.2726s
	iters: 400, epoch: 9 | loss: 0.0924837
	speed: 0.0154s/iter; left time: 98.9087s
	iters: 500, epoch: 9 | loss: 0.1125001
	speed: 0.0153s/iter; left time: 97.2605s
Epoch: 9 cost time: 9.26792573928833
Epoch: 9, Steps: 570 | Train Loss: 0.1072153 Vali Loss: 0.0354216 Test Loss: 0.1312207
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1162508
	speed: 0.0473s/iter; left time: 291.8640s
	iters: 200, epoch: 10 | loss: 0.1318796
	speed: 0.0154s/iter; left time: 93.2581s
	iters: 300, epoch: 10 | loss: 0.0907145
	speed: 0.0154s/iter; left time: 91.9004s
	iters: 400, epoch: 10 | loss: 0.1265460
	speed: 0.0154s/iter; left time: 90.3571s
	iters: 500, epoch: 10 | loss: 0.1289427
	speed: 0.0154s/iter; left time: 88.6621s
Epoch: 10 cost time: 9.036757469177246
Epoch: 10, Steps: 570 | Train Loss: 0.1082149 Vali Loss: 0.0353202 Test Loss: 0.1312223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm512_nh8_el3_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
test shape: (5237, 24, 1) (5237, 24, 1)
test shape: (5237, 24, 1) (5237, 24, 1)
mse:0.13045193254947662, mae:0.23218737542629242
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           EPF_168_24          Model:              TimeXer             

[1mData Loader[0m
  Data:               custom              Root Path:          ./data              
  Data Path:          causal_data.csv     Features:           MS                  
  Target:             electricity_price   Freq:               h                   
  Checkpoints:        ./checkpoints/      
  Predictor(s):       solar_forecast,wind_forecast,total_load

[1mForecasting Task[0m
  Seq Len:            168                 Label Len:          48                  
  Pred Len:           24                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             4                   
  C Out:              1                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                tuning              Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_EPF_168_24_TimeXer_custom_ftMS_sl168_ll48_pl24_dm256_nh8_el4_dl1_df2048_expand2_dc4_fc1_ebtimeF_dtTrue_tuning_0>>>>>>>>>>>>>>>>>>>>>>>>>>
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
train 18219
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
val 2608
[DEBUG] kept columns: ['solar_forecast', 'total_load', 'wind_forecast']
test 5237
	iters: 100, epoch: 1 | loss: 0.1391820
	speed: 0.0304s/iter; left time: 344.0274s
	iters: 200, epoch: 1 | loss: 0.2029080
	speed: 0.0186s/iter; left time: 208.8357s
	iters: 300, epoch: 1 | loss: 0.3258815
	speed: 0.0186s/iter; left time: 206.9559s
	iters: 400, epoch: 1 | loss: 0.1845980
	speed: 0.0187s/iter; left time: 205.2170s
	iters: 500, epoch: 1 | loss: 0.1627738
	speed: 0.0186s/iter; left time: 203.1106s
Epoch: 1 cost time: 11.852343320846558
Epoch: 1, Steps: 570 | Train Loss: 0.2102097 Vali Loss: 0.0448969 Test Loss: 0.1337774
Validation loss decreased (inf --> 0.044897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2993554
	speed: 0.0566s/iter; left time: 606.9139s
	iters: 200, epoch: 2 | loss: 0.1644480
	speed: 0.0185s/iter; left time: 196.6065s
	iters: 300, epoch: 2 | loss: 0.1396863
	speed: 0.0185s/iter; left time: 194.5998s
	iters: 400, epoch: 2 | loss: 0.1331915
	speed: 0.0185s/iter; left time: 192.8035s
	iters: 500, epoch: 2 | loss: 0.1542030
	speed: 0.0185s/iter; left time: 191.1217s
Epoch: 2 cost time: 10.91523814201355
Epoch: 2, Steps: 570 | Train Loss: 0.1688071 Vali Loss: 0.0415520 Test Loss: 0.1278588
Validation loss decreased (0.044897 --> 0.041552).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1257951
	speed: 0.0558s/iter; left time: 566.6252s
	iters: 200, epoch: 3 | loss: 0.1143206
	speed: 0.0184s/iter; left time: 185.0097s
	iters: 300, epoch: 3 | loss: 0.1279311
	speed: 0.0184s/iter; left time: 183.2518s
	iters: 400, epoch: 3 | loss: 0.1258806
	speed: 0.0185s/iter; left time: 182.2606s
	iters: 500, epoch: 3 | loss: 0.0975429
	speed: 0.0185s/iter; left time: 180.2230s
Epoch: 3 cost time: 10.785451650619507
Epoch: 3, Steps: 570 | Train Loss: 0.1449889 Vali Loss: 0.0376083 Test Loss: 0.1195712
Validation loss decreased (0.041552 --> 0.037608).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1677614
	speed: 0.0580s/iter; left time: 555.9753s
	iters: 200, epoch: 4 | loss: 0.1814447
	speed: 0.0208s/iter; left time: 197.0320s
	iters: 300, epoch: 4 | loss: 0.1515219
	speed: 0.0207s/iter; left time: 194.3716s
	iters: 400, epoch: 4 | loss: 0.1079124
	speed: 0.0207s/iter; left time: 192.2521s
	iters: 500, epoch: 4 | loss: 0.1271523
	speed: 0.0188s/iter; left time: 172.5073s
Epoch: 4 cost time: 11.750059843063354
Epoch: 4, Steps: 570 | Train Loss: 0.1339066 Vali Loss: 0.0367072 Test Loss: 0.1212885
Validation loss decreased (0.037608 --> 0.036707).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1465802
	speed: 0.0581s/iter; left time: 524.2315s
	iters: 200, epoch: 5 | loss: 0.1292708
	speed: 0.0186s/iter; left time: 165.9253s
	iters: 300, epoch: 5 | loss: 0.1207413
	speed: 0.0185s/iter; left time: 163.4870s
	iters: 400, epoch: 5 | loss: 0.1002995
	speed: 0.0185s/iter; left time: 161.6094s
	iters: 500, epoch: 5 | loss: 0.1350384
	speed: 0.0185s/iter; left time: 159.5795s
Epoch: 5 cost time: 10.874135732650757
Epoch: 5, Steps: 570 | Train Loss: 0.1279273 Vali Loss: 0.0351292 Test Loss: 0.1215083
Validation loss decreased (0.036707 --> 0.035129).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0720300
	speed: 0.0567s/iter; left time: 479.3493s
	iters: 200, epoch: 6 | loss: 0.1259978
	speed: 0.0185s/iter; left time: 154.5039s
	iters: 300, epoch: 6 | loss: 0.0900185
	speed: 0.0185s/iter; left time: 152.3015s
	iters: 400, epoch: 6 | loss: 0.1716787
	speed: 0.0185s/iter; left time: 150.6424s
	iters: 500, epoch: 6 | loss: 0.1148341
	speed: 0.0185s/iter; left time: 148.6274s
Epoch: 6 cost time: 10.821367025375366
Epoch: 6, Steps: 570 | Train Loss: 0.1261035 Vali Loss: 0.0348515 Test Loss: 0.1216410
Validation loss decreased (0.035129 --> 0.034851).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0961893
	speed: 0.0574s/iter; left time: 452.6661s
	iters: 200, epoch: 7 | loss: 0.1358449
	speed: 0.0185s/iter; left time: 144.0250s
	iters: 300, epoch: 7 | loss: 0.1310754
	speed: 0.0184s/iter; left time: 141.6715s
	iters: 400, epoch: 7 | loss: 0.1342554
	speed: 0.0184s/iter; left time: 139.7000s
	iters: 500, epoch: 7 | loss: 0.1742030
	speed: 0.0185s/iter; left time: 138.2850s
Epoch: 7 cost time: 10.831374168395996
Epoch: 7, Steps: 570 | Train Loss: 0.1236303 Vali Loss: 0.0349391 Test Loss: 0.1203975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1173634
	speed: 0.0554s/iter; left time: 404.8872s
	iters: 200, epoch: 8 | loss: 0.0968303
	speed: 0.0186s/iter; left time: 134.1800s
	iters: 300, epoch: 8 | loss: 0.0950346
	speed: 0.0186s/iter; left time: 131.9296s
	iters: 400, epoch: 8 | loss: 0.1503787
	speed: 0.0186s/iter; left time: 130.1721s
	iters: 500, epoch: 8 | loss: 0.0932398
	speed: 0.0186s/iter; left time: 128.5278s
Epoch: 8 cost time: 10.870176076889038
Epoch: 8, Steps: 570 | Train Loss: 0.1230835 Vali Loss: 0.0348350 Test Loss: 0.1202207
Validation loss decreased (0.034851 --> 0.034835).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0810930
	speed: 0.0560s/iter; left time: 377.3352s
	iters: 200, epoch: 9 | loss: 0.1697227
	speed: 0.0184s/iter; left time: 122.4840s
